<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Communication Protocol Between the AD Control Server and the AD Edge Router of Inter-Domain Source Address Validation Architecture</title>
<meta content="Ke Xu" name="author">
<meta content="Xiaoliang Wang" name="author">
<meta content="Yangfei Guo" name="author">
<meta content="
       Because the Internet forwards packets according to the IP destination
address, packet forwarding typically takes place without inspection
of the source address and malicious attacks have been launched using
spoofed source addresses. The inter-domain source address validation
architecture is an effort to enhance the Internet by using
state machine to generate consistent tags. When communicating between
two end hosts at different ADs of IPv6 network, tags will be added to
the packets to identify the authenticity of the IPv6 source address. 
       This memo focus on the data plane of the SAVA-X mechanism. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-guo-intarea-savax-protocol-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-guo-savax-protocol-00-90wja8tq.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SAVA-X-Protocol</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Xu, et al.</td>
<td class="center">Expires 26 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Internet Area Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-guo-intarea-savax-protocol-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-23" class="published">23 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-26">26 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Xu</div>
<div class="org">Tsinghua University</div>
</div>
<div class="author">
      <div class="author-name">X. Wang</div>
<div class="org">Tsinghua University</div>
</div>
<div class="author">
      <div class="author-name">Y. Guo</div>
<div class="org">Tsinghua University</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Communication Protocol Between the AD Control Server and the AD Edge Router of Inter-Domain Source Address Validation Architecture</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Because the Internet forwards packets according to the IP destination
address, packet forwarding typically takes place without inspection
of the source address and malicious attacks have been launched using
spoofed source addresses. The inter-domain source address validation
architecture is an effort to enhance the Internet by using
state machine to generate consistent tags. When communicating between
two end hosts at different ADs of IPv6 network, tags will be added to
the packets to identify the authenticity of the IPv6 source address.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This memo focus on the data plane of the SAVA-X mechanism.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 26 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology-and-abbreviatio" class="xref">Terminology and Abbreviation</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-communication-protocol-form" class="xref">Communication Protocol Format</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-acs-acs-communication-proto" class="xref">ACS-ACS Communication Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-announcement-query-and-resp" class="xref">Announcement, Query and Response of State Machine Information</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-state-machine-information-a" class="xref">State Machine Information Announcement</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-state-machine-information-r" class="xref">State Machine Information Request</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-request-and-response-of-dia" class="xref">Request and Response of Diagnose Information</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-acs-aer-communication-proto" class="xref">ACS-AER Communication Protocol</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-deployment-request-and-resp" class="xref">Deployment, Request and Response of AD Registration information</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-deployment-of-ad-registrati" class="xref">Deployment of AD Registration Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-request-of-ad-registration-" class="xref">Request of AD Registration Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-reponse-of-ad-registration-" class="xref">Reponse of AD Registration Information</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-deployment-request-and-repl" class="xref">Deployment, Request and Reply of AD Prefix Information</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-deployment-of-ad-prefix-inf" class="xref">Deployment of AD Prefix Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-request-of-ad-prefix-inform" class="xref">Request of AD Prefix Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-response-of-ad-prefix-infor" class="xref">Response of AD Prefix Information</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-deployment-request-and-respo" class="xref">Deployment, Request and Response of State Machine Information</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-deployment-of-state-machine" class="xref">Deployment of State Machine Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-request-of-state-machine-in" class="xref">Request of State Machine Information</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="xref">5.3.3</a>.  <a href="#name-response-of-state-machine-i" class="xref">Response of State Machine Information</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-request-and-response-of-kee" class="xref">Request and Response of Keep-alive Information</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="xref">5.4.1</a>.  <a href="#name-response-of-keep-alive-info" class="xref">Response of Keep-alive Information</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-deployment-of-tag-informati" class="xref">Deployment of Tag Information</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-consideration" class="xref">Security Consideration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-consideration" class="xref">IANA Consideration</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Inter-Domain Source Address Validation Architecture (SAVA-X) mechanism
establishes a trust alliance among Address Domains (AD), maintains a
one-to-one state machine among ADs, generates a consistent tag, and
deploys the tag to the ADs' border router (AER). The AER of the
source AD adds a tag to identify the identity of the AD to the
packet originating from one AD and sinking in another AD. The AER of
the destination AD verifies the source address by validating the
correctness of the tag to determine whether it is a packet with a
forged source address.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">In the process of packet forwarding, if the source address and the
destination address of this packet both are addresses in the trust
alliance, however the tag is not added or incorrectly added, AER of
the destination AD determines that the source address is forged and
directly discards this packet. The destination AD forwards the
packet directly for packets whose source address is an address
outside the trust alliance.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document mainly studies the relevant specifications of the
data plane of the inter-domain source address validation
architecture mechanism between ADs, which will protect IPv6 networks
from being forged source address. You could see <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> for more 
details about IPv6. It stipulates the state machine,
tag generation and update, tag processing in AER, and packet signature
Its promotion and application can realize the standardization of 
the data plane in the SAVA-X to facilitate the related equipment
developed by different manufacturers and organizations to cooperate
to accomplish the inter-domain source address validation jointly.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in RFC 2119, BCP 14
<span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> and indicate requirement levels for compliant CoAP
implementations.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology-and-abbreviation">
<section id="section-2">
      <h2 id="name-terminology-and-abbreviatio">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology-and-abbreviatio" class="section-name selfRef">Terminology and Abbreviation</a>
      </h2>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Abbreviation</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">AD</td>
            <td class="text-left" rowspan="1" colspan="1">Address Domain, the unit of a trust alliance, which is an address set consisting of all IPv6 addresses corresponding to an IPv6 address prefix.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">TA</td>
            <td class="text-left" rowspan="1" colspan="1">Trust Alliance, the IPv6 network that uses the SAVA-X mechanism.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ACS</td>
            <td class="text-left" rowspan="1" colspan="1">AD Control Server, the server that matains state machine with other ACS and distribute information to AER.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">AER</td>
            <td class="text-left" rowspan="1" colspan="1">AD border router, which is placed at the boundary of an AD of STA.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ADID</td>
            <td class="text-left" rowspan="1" colspan="1">The identity of an AD.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ADID_Rec</td>
            <td class="text-left" rowspan="1" colspan="1">The record of a number of an AD.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ARI_Rec</td>
            <td class="text-left" rowspan="1" colspan="1">The record with relavent information of an AD or STA.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">API_Rec</td>
            <td class="text-left" rowspan="1" colspan="1">The record of prefix of an AD or STA.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">SM</td>
            <td class="text-left" rowspan="1" colspan="1">State Machine, which is maintained by a pair of ACS to generate tags.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">SMI_Rec</td>
            <td class="text-left" rowspan="1" colspan="1">The record of the state machine information.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Tag</td>
            <td class="text-left" rowspan="1" colspan="1">The authentic identification of source address of a packet.</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="pkt-format">
<section id="section-3">
      <h2 id="name-communication-protocol-form">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-communication-protocol-form" class="section-name selfRef">Communication Protocol Format</a>
      </h2>
<p id="section-3-1">Every AD should be placed at least one ACS, which is mainly responsible
for maintaining the relationship between ADs of the trust alliance,
establishing connections with other ACS, maintaining the synchronous
state machine, and sending the generated tags to the AER.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-2">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |    Version    |    Alliance   | I Type| S Type|   Operation   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                           Total Length                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Number of Records                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Transaction Number                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Acknowledge Number                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 ~                              Data                             ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-3-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-3-3">
        <dt id="section-3-3.1">Version:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.2">
  8-bit, the current version=0b1 of SAVA-X.<a href="#section-3-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.3">Alliance:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.4">
  8-bit, the sub-trust alliance number.<a href="#section-3-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.5">I Type:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.6">
  4-bit, Information type, 0 for G_REF_INFO, 1 for AD_REG_INFO, 2
for AD_PREFIX_INFO, 3 for STATE_MACHINE_INFO, 4 for DIAGNOSIS_INFO,
5 for RUNNING_STATE_INFO, 6 for STRATEGY_INFO, 7 for ALIVE_INFO, 8
for TAG_INFO, 9 for ALLI_TAG_INFO, 10 for AD_V_TAG_INFO and others
are unassigned.<a href="#section-3-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.7">S Type:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.8">
  4-bit, Session type, 1 for ANNOUNCEMENT or DEPLOYMENT, 2 for
REQUEST, 3 for REQUEST_ALL, 4 for ACK, 5 for NAK, 6 for AACK, 7 for
ANAK, 8 for RACK, 9 for RNAK and others are unassigned.<a href="#section-3-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.9">Operation:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.10">
  8-bit, the first 3 bits means for whether RENEW Type or not. First
bit: 0 for non-RENEW packet, 1 for RENEW packet. Second bit: 0 for
the first non-RENEW packet, 1 for the first RENEW packet. Third
bit: 0 for the last non-RENEW packet, 1 for the last RENEW packet.<a href="#section-3-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.11">Total Length:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.12">
  32-bit, the length of this packet: from Version to Data.<a href="#section-3-3.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.13">Number of Records:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.14">
  32-bit, he records in Data.<a href="#section-3-3.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.15">Transaction Number:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.16">
  32-bit, this is the identification of a publication, query or
response, and the value should increase monotonically. And
different I Types MUST have its own Transaction Number.<a href="#section-3-3.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.17">Acknowledge Number:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.18">
  32-bit, it is only be filled when S Type is ACK, NAK, AACK, ANAK,
RACK or RNAK. Otherwise it is should be filled as 0.<a href="#section-3-3.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-3-3.19">Data:</dt>
        <dd style="margin-left: 1.5em" id="section-3-3.20">
  Variable-length field. I Type and S Type specifies data jointly.<a href="#section-3-3.20" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-4">When S Type is ANNOUNCEMENT:<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">If I Type = AD_REG_INFO, Data field SHOULD be one or more ARI_Rec.<a href="#section-3-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-5.2">If I Type = AD_PREFIX_INFO, Data field SHOULD be one or more
API_Rec.<a href="#section-3-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-5.3">If I Type = STATE_MACHINE_INFO, Data field SHOULD be one or more
SMI_Rec.<a href="#section-3-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-5.4">If I Type = TAG_INFO, ALLI_TAG_INFO or AD_V_TAG_INFO, Data field
SHOULD be one or more TAG_Rec.<a href="#section-3-5.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-6">When S Type is REQUEST or REQUEST_ALL:<a href="#section-3-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-7.1">If I Type = REG_INFO, Data field SHOULD be one or more ADID_Rec.<a href="#section-3-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-7.2">If I Type = AD_PREFIX_INFO, Data field SHOULD be none or one or
more ADID_Rec.<a href="#section-3-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-7.3">If I Type = STATE_MACHINE_INFO, Data field SHOULD be none or one
or more ADID_Rec.<a href="#section-3-7.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-7.4">If I Type = DIAGNOSE_INFO, Data field SHOULD be a 32-bit diagnose
reqeust code.<a href="#section-3-7.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-7.5">If I Type = ALIVE_INFO, Data field SHOULD be none.<a href="#section-3-7.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-8">When S Type is ACK, AACK or RACK:<a href="#section-3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-9.1">If I Type = REG_INFO, Data field SHOULD be one or more ARI_Rec.<a href="#section-3-9.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-9.2">If I Type = AD_PREFIX_INFO, Data field SHOULD be one or more
API_Rec.<a href="#section-3-9.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-9.3">If I Type = STATE_MACHINE_INFO, Data field SHOULD be one or more
SMI_Rec.<a href="#section-3-9.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-9.4">If I Type = DIAGNOSE_INFO, Data field SHOULD be one 32-bit diagnose
response code.<a href="#section-3-9.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-9.5">If I Type = ALIVE_INFO, Data field SHOULD be none.<a href="#section-3-9.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-10">When S Type is NAK, ANAK or RNAK, Data field SHOULD be one 32-bit
error code:<a href="#section-3-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-11.1">1 for parameters are wrong which means the packet cannot resolve
correctly.<a href="#section-3-11.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-11.2">2 for member AD(s) in request packet does not exist in the
designative sub-trust alliance.<a href="#section-3-11.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-11.3">3 for algorithm for State Machine set by source ACS cannot
support by the destination ACS.<a href="#section-3-11.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="acs-acs-communication-protocol">
<section id="section-4">
      <h2 id="name-acs-acs-communication-proto">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-acs-acs-communication-proto" class="section-name selfRef">ACS-ACS Communication Protocol</a>
      </h2>
<p id="section-4-1">Since the blockchain is adopted in SAVA-X to maintain the information
of the trust alliance, ACS can query the address domain information
of relevant ADes of the trust alliance and the AD prefix information
corresponding to the address domain from the blockchain.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="announcement-query-and-response-of-state-machine-information">
<section id="section-4.1">
        <h3 id="name-announcement-query-and-resp">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-announcement-query-and-resp" class="section-name selfRef">Announcement, Query and Response of State Machine Information</a>
        </h3>
<p id="section-4.1-1">State machine information record (SMI_Rec) represents the packet
format used when state machine is negotiated between different
ordered pairs of ADs. When an ordered pair of ADs is negotiating the
state machine, ACS of AD with smaller ADID initiates the 
communication and ACS of AD with larger ADID uses SMI_Rec determines
the information to be used, such as initial state, tag generation
algorithm, state transition interval, etc. Compared to ARI_Rec and
API_Rec,SMI_Rec also needs an Expiring Time in addition to the Effecting Time. Expiration Time stands when the negotiated state machine is no longer valid.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.1-2">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+
 |     Action    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Source ADID_Rec                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                     Destination ADID_Rec                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       State Mathine ID                        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |        Algorithm            |             IS Length           |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 ~                        Initial State                          ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                      Transition Interval                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Effecting Time                         |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                        Expiring Time                          |
 |                                                               |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-4.1-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-4.1-3">
          <dt id="section-4.1-3.1">Action:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.2">
  8-bit, 1 for add or update this SMI_Rec.<a href="#section-4.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.3">Source ADID_Rec:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.4">
  Variable-length field. Refer to ADID_Rec <span>[<a href="#SAVA-X-Control" class="xref">SAVA-X-Control</a>]</span>.<a href="#section-4.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.5">Destination ADID_Rec:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.6">
  Variable-length field. Refer to ADID_Rec in <span>[<a href="#SAVA-X-Control" class="xref">SAVA-X-Control</a>]</span>.<a href="#section-4.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.7">State Mathine ID:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.8">
  32-bit, the ID used to identify the state machine, which is unique
to a specific ordered AD pair and grows monotonically in use. It is
used to distinguish the sequence before and after the generation of
multiple state machines.<a href="#section-4.1-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.9">Algorithm:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.10">
  16-bit, algorithm used in A-Box. 1 for KISS-99 32-bit, 2 for
KISS-99 64-bit Joint, 3 for OTP-2289 MD5 and others are unassigned.<a href="#section-4.1-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.11">IS Length:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.12">
  16-bit, the length of Initial State field.<a href="#section-4.1-3.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.13">Initial State:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.14">
  Variable-length field, the length of this filed is determined by IS
Length.<a href="#section-4.1-3.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.15">Transition Interval:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.16">
  32-bit, the milliseconds of interval of state transition.<a href="#section-4.1-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.17">Effecting Time:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.18">
  64-bit, when this field is 0, it means this State Machine should be
enabled after the last State Machine expired.<a href="#section-4.1-3.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.19">Expiring Time:</dt>
          <dd style="margin-left: 1.5em" id="section-4.1-3.20">
  64-bit, the end of this State Machine.<a href="#section-4.1-3.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<div id="state-machine-information-announcement">
<section id="section-4.1.1">
          <h4 id="name-state-machine-information-a">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-state-machine-information-a" class="section-name selfRef">State Machine Information Announcement</a>
          </h4>
<p id="section-4.1.1-1">State machine information announcement (SM_INFO-Announce) is sent
from source ACS to destination ACS. Source ACS fills in the following values for each field:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
            <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">SM_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">ANNOUNCEMENT</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL: source ACS updates part of the state machines information to destination ACS. RENEW: source ACS updates all the state machines information to destination ACS.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">The number of SMI_Recs in Data field.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent out where I Type is SM_INFO and ACS would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">One or more SMI_Recs.</td>
              </tr>
            </tbody>
          </table>
<p id="section-4.1.1-3">All SMI_Recs in Data field should have an unique SM_ID. When Action 
is ADD and SM_ID bigger than current used SM_ID, ACS should add the 
state machine defined in SMI_Rec. When Action is ADD and SM_ID equals 
to current used SM_ID, ACS should modify the state machine defined in 
SMI_Rec. Only Transition Interval and Expiring Time can be modified. 
Other SMI_Rec should be discarded and destination ACS should send a 
NAK message to source ACS.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">When receiving a non-RENEW packet, if it cannot resolve this message, 
destination ACS should send a NAK message to source ACS. When 
destination ACS can resolve the packet correctly, it SHOULD:<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1-5">
<li id="section-4.1.1-5.1">Compare the Transaction Number in this packet with Transaction 
Number received from the same ACS before. Otherwise, destination ACS 
would discard this packet and send a SM_INFO-Request to request the 
lastest information of state machine. SM_INFO-Request is defined at 
<a href="#SM_INFO-Request" class="xref">Section 4.1.2</a>. If bigger, destination ACS WOULD:<a href="#section-4.1.1-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-5.2">Accept every SMI_Rec and process them as following: 
  - If the SM_ID in SMI_Rec equals to current used SM_ID,
 destination ACS would update the current used SM_ID.
  - If the SM_ID in SMI_Rec bigger than current used SM_ID,
 destination ACS would add this state machine to its following
 used state machine list.<a href="#section-4.1.1-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-5.3">And then destination ACS will send an SM_INFO-AACK message to source ACS.<a href="#section-4.1.1-5.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4.1.1-6">When receiving a RENEW packet, if it cannot resolve this message, 
destination ACS should send a SM_INFO-ANAK message to source ACS. 
When destination ACS can resolve the packet correctly, it SHOULD:<a href="#section-4.1.1-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1-7">
<li id="section-4.1.1-7.1">Compare the Transaction Number in this packet with Transaction 
Number received from the same ACS before. Otherwise, destination ACS 
would discard this packet and send a SM_INFO-Request to request the 
lastest information of state machine. If bigger, destination ACS 
WOULD:<a href="#section-4.1.1-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-7.2">Accept every SMI_Rec and process them as following: 
  - If the SM_ID in SMI_Rec equals to current used SM_ID,
 destination ACS would update the current used SM_ID. 
  - If the SM_ID in SMI_Rec bigger than current used SM_ID, 
 destination ACS would add this state machine to its following 
 used state machine list. Especially, state machines will be 
 removed right now when they are not listed in the SMI_Recs but 
 they are in using.<a href="#section-4.1.1-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-7.3">And then destination ACS will send an SM_INFO-AACK message to
source ACS.<a href="#section-4.1.1-7.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4.1.1-8">There are two types of reply of SM_INFO-Annouce message. That is 
SM_INFO-AACK representing affirmative acknowledgement and 
SM_INFO-ANAK representing negative acknowledgement. These are sent 
from destination ACS to source ACS. The mainly part of packet is 
filled by destination ACS as follows:<a href="#section-4.1.1-8" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
            <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">SM_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">AACK if it is affirmative acknowledgement or ANAK if it is negative acknowledgement.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent out where I Type is SM_INFO and ACS would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">The Transaction Number of the response corresponding request.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = AACK: None. S Type = ANAK: a 32-bit error code defined in <a href="#pkt-format" class="xref">Section 3</a>.</td>
              </tr>
            </tbody>
          </table>
<p id="section-4.1.1-10">Nothing needs to do when source ACS receives an SM_INFO-AACK message
while it should regenerate a new state machine and announces to
destination ACS when source ACS receives an SM_INFO-ANAK message.<a href="#section-4.1.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SM_INFO-Request">
<section id="section-4.1.2">
          <h4 id="name-state-machine-information-r">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-state-machine-information-r" class="section-name selfRef">State Machine Information Request</a>
          </h4>
<p id="section-4.1.2-1">State machine information request (SM_INFO-Request) is sent from
source ACS to destination ACS. Source ACS fills in the following values for each field:<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
            <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">SM_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">REQUEST</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL: announce all state machine information to source ACS.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent out where I Type is SM_INFO and ACS would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">None</td>
              </tr>
            </tbody>
          </table>
<p id="section-4.1.2-3">When source ACS receives a SM_INFO-Request message, it would send a
SM_INFO-RNAK message to destination ACS if some fields are wrong. 
Otherwise, source ACS would send an SM_INFO-RACK message to 
destination ACS and process this SM_INFO-Request message. Source ACS 
should compare the Transaction Number in this message with 
Transaction Number received from the same destination ACS before. 
Otherwise, source ACS would discard this packet. If bigger, source 
ACS would send an SM_INFO-RACK message to destination ACS.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">There are two types of reply of SM_INFO-Request message, i.e. 
SM_INFO-RACK representing affirmative acknowledgement and 
SM_INFO-RNAK representing negative acknowledgement. These are sent 
from source ACS to destination ACS. The mainly part of packet is 
filled by source ACS as follows:
I Type is SM_INFO. S Type is RACK if it is affirmative 
acknowledgement or RNAK if it is negative acknowledgement. Operation 
is NULL. When S Type is RACK, Data field is a few of SMI_Recs. When S 
Type is RNAK, Data field is a 32-bit error code.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">When receiving a SM_INFO-RACK message, if it cannot resolve this 
message, destination ACS should send a SM_INFO-Request message to 
source ACS to acquire another state machine. When destination ACS can 
resolve the message correctly, it SHOULD:<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.2-6">
<li id="section-4.1.2-6.1">Compare the Transaction Number in this packet with Transaction 
Number received from the same source ACS before. Otherwise, 
destination ACS would discard this packet and send a SM_INFO-Request 
to request the lastest information of state machine. If bigger, destination ACS WOULD:<a href="#section-4.1.2-6.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.2-6.2">Accept every SMI_Rec and process them as following: 
  - If the SM_ID in SMI_Rec equals to current used SM_ID, destination ACS would update the current used SM_ID. 
  - If the SM_ID in SMI_Rec bigger than current used SM_ID, destination ACS would add this state machine to its following used state machine list.<a href="#section-4.1.2-6.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.2-6.3">And then destination ACS will send an SM_INFO-AACK message to source ACS.<a href="#section-4.1.2-6.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4.1.2-7">When receiving a SM_INFO-RNAK message, if it cannot resolve this 
message, destination ACS should send a SM_INFO-Request message to 
source ACS to acquire new state machine. When destination ACS can 
resolve the message correctly, it SHOULD compare the Transaction 
Number in this packet with Transaction Number received from the same 
source ACS before. Otherwise, destination ACS would discard this 
packet and send a SM_INFO-Request to request the lastest information 
of state machine. If bigger, destination ACS WOULD send a new correct 
SM_INFO-Request message to source ACS.<a href="#section-4.1.2-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="request-and-response-of-diagnose-information">
<section id="section-4.2">
        <h3 id="name-request-and-response-of-dia">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-request-and-response-of-dia" class="section-name selfRef">Request and Response of Diagnose Information</a>
        </h3>
<p id="section-4.2-1">Sent by destination ACS, request of diagnose information
(DIAG_INFO-Request) is used to require the source ACS to check its
configuration and source AERs' settings. Source ACS will response
with its result. Destination ACS fills in the following values for each field:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
          <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Field</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Version</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Alliance</td>
              <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">I Type</td>
              <td class="text-left" rowspan="1" colspan="1">DIAG_INFO</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">S Type</td>
              <td class="text-left" rowspan="1" colspan="1">REQUEST</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Operation</td>
              <td class="text-left" rowspan="1" colspan="1">NULL</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Total Length</td>
              <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
              <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent out where I Type is DIAG_INFO and ACS would keep it increasing monotonic.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Data</td>
              <td class="text-left" rowspan="1" colspan="1">a 32-bit error code defined below.</td>
            </tr>
          </tbody>
        </table>
<p id="section-4.2-3">Response of diagnose information (DIAG_INFO-Response) replys from
source ACS to destination ACS.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<table class="center" id="table-6">
          <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Field</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Version</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Alliance</td>
              <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">I Type</td>
              <td class="text-left" rowspan="1" colspan="1">DIAG_INFO</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">S Type</td>
              <td class="text-left" rowspan="1" colspan="1">ACK</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Operation</td>
              <td class="text-left" rowspan="1" colspan="1">NULL</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Total Length</td>
              <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
              <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent out where I Type is DIAG_INFO and ACS would keep it increasing monotonic.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
              <td class="text-left" rowspan="1" colspan="1">The Transaction Number of the response corresponding request.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Data</td>
              <td class="text-left" rowspan="1" colspan="1">a 32-bit error code defined below.</td>
            </tr>
          </tbody>
        </table>
<p id="section-4.2-5">Before it sends the DIAG_INFO-Request message, the destination ACS 
should check its own configuration and gurantee they are correct.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">If it receives a DIAG_INFO-Request message, the source ACS would 
check the communication with its own AER whether correct or not.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-7">
<li id="section-4.2-7.1">If it's wrong, source ACS would reply a DIAG_INFO-Response message
in which its Data filed is filled with 2 for fault cannot be repaired 
and alarm to administrator to deal with this problem.<a href="#section-4.2-7.1" class="pilcrow">¶</a>
</li>
          <li id="section-4.2-7.2">If it's right, source ACS would RENEW all the registration 
information, prefix information and state machine information to its 
all AERs. After that, source ACS will reply a DIAG_INFO-Response 
message in which its Data filed is filled with 1 for all runs 
correctly after repairing.<a href="#section-4.2-7.2" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
</section>
</div>
<div id="acs-aer-communication-protocol">
<section id="section-5">
      <h2 id="name-acs-aer-communication-proto">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-acs-aer-communication-proto" class="section-name selfRef">ACS-AER Communication Protocol</a>
      </h2>
<p id="section-5-1">ACS would periodically deploy AD registration information, AD prefix 
information, and state machine information of relevant ADes to its 
all AERs to guarantee all information are latest. And ACS also would 
deploy the tag information to its all AERs periodically.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="deployment-request-and-response-of-ad-registration-information">
<section id="section-5.1">
        <h3 id="name-deployment-request-and-resp">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-deployment-request-and-resp" class="section-name selfRef">Deployment, Request and Response of AD Registration information</a>
        </h3>
<div id="deployment-of-ad-registration-information">
<section id="section-5.1.1">
          <h4 id="name-deployment-of-ad-registrati">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-deployment-of-ad-registrati" class="section-name selfRef">Deployment of AD Registration Information</a>
          </h4>
<p id="section-5.1.1-1">After connecting with AER, ACS deploys the AD Registration 
Information (REG_INFO-Deploy) to AER peroidically. I Type is 
REG_INFO. S Type is Announcement. Operation is NULL when some ADes' 
information are joined, left or updated and Operation is RENEW when 
all ADes' information are deployed. Acknowledgement is 0. Data field 
is one or more ARI_Rec.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">It should be noted that when there are two ARI_Recs in Data fields 
responding to the same AD, one may effect right now and the other 
effects after passing Effecting Time. When AER receives this message, 
all of them should be restored in the trust alliance list and AER 
MUST process them orderly. Since the protocol processes the records 
in sequence, it is required that the ARI_Rec effecting at the current 
time for the same member AD should appear in front of another 
updating ARI_Rec.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">When receiving a non-RENEW packet, if it cannot resolve this message, 
AER could send a REG_INFO-Request message to acquire the latest AD 
registration information.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1.1-4">When AER can resolve this message correctly, it SHOULD:<a href="#section-5.1.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.1-5">
<li id="section-5.1.1-5.1">Compare the Transaction Number in this packet with Transaction 
Number received from the same ACS before. If bigger, AER WOULD accept 
every ARI_Rec and process them as follows. Otherwise, AER would 
discard this packet and send a REG_INFO-RequestAll message to acquire 
the lastest information of AD registration information.<a href="#section-5.1.1-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.1-5.2">Process every ARI_Rec:
  - If Action is ADD and the record does not exist in its maintained 
 trust alliance list, AER would add this record to its trust 
 alliance list.
  - If Action is ADD and the record exists in its maintained trust 
 alliance list but ACS Address is changed, AER would add this 
 record to its trust alliance list and delete original record 
 after passing Effecting Time in this ARI_Rec.
  - If Action is ADD and the record exists in its maintained trust 
 alliance list and ACS Address is not changed, AER would do 
 nothing.
  - If Action is DEL and the record exists in its maintained trust 
 alliance list, AER would remove this record from its trust 
 alliance list after passing Effecting Time in this ARI_Rec.<a href="#section-5.1.1-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.1-5.3">If a change is made in step 2, the update should take effect after 
passing the Effecting Time, which acts on the data plane. If the 
Effecting Time is earlier than the current time or is all 0, it will 
take effect immediately.<a href="#section-5.1.1-5.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.1.1-6">AER acts as following when receiving a RENEW packet. When ACS 
initiates RENEW, it would send a RENEW meesge with which the first 
bit of Operation field is 1. The second bit of Operation field 
identifies the begin of a procedure of RENEW and the third bit of 
Operation field identifies the end of a procedure of RENEW. ACS MUST 
NOT send a RENEW packet with which the first bit of Operation field 
is 0 in RENEWing. AER MUST process this procedure of RENEW after 
received all RENEW packets.
When AER can resolve this packet correctly, it SHOULD:<a href="#section-5.1.1-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.1-7">
<li id="section-5.1.1-7.1">Compare the Transaction Number in this packet with Transaction 
  Number received from the same ACS before. If bigger, AER would 
  accept every ARI_Rec and process them as follows. Otherwise, AER 
  would discard this packet and send a REG_INFO-RequestAll message to 
  acquire the lastest information of AD registration information.<a href="#section-5.1.1-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.1-7.2">Process every ARI_Rec:
- If the record does not exist in its maintained trust alliance list, 
  AER would add this record to its trust alliance list.
- If the record exists in its maintained trust alliance list but ACS 
  Address is changed, AER would add this record to its trust alliance 
  list and delete original record after passing Effecting Time in this ARI_Rec.
- If the record exists in its maintained trust alliance list and ACS 
  Address is not changed, AER would do nothing.
- If there are some records in the original trust alliance list that 
  do not appear in the Data field during this RENEW process, they 
  will be deleted immediately.<a href="#section-5.1.1-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.1-7.3">If a change is made in step 2, the update should take effect after 
  passing the Effecting Time, which acts on the data plane. If the 
  Effecting Time is earlier than the current time or is all 0, it 
  will take effect immediately.<a href="#section-5.1.1-7.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="request-of-ad-registration-information">
<section id="section-5.1.2">
          <h4 id="name-request-of-ad-registration-">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-request-of-ad-registration-" class="section-name selfRef">Request of AD Registration Information</a>
          </h4>
<p id="section-5.1.2-1">The request is sent by AER to ACS. There are two types of request of 
AD Registration Information message. When querying the information of 
all member ADs of the trust alliance, the type is REG_INFO-RequestAll 
and REG_INFO-Request is used when querying the information of partial 
member ADs of the trust alliance.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-7">
            <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">REG_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">REQUEST: for querying partial member ADs and S Type is REQUEST_ALL: for querying all member ADs.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = REQUEST: the number of ADID_Recs in Data field. S Type = REQUEST_ALL: 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. AER would maintain a global Transaction Number for packets sent out to ACS where I Type is REG_INFO and AER would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = REQUEST: one or more ADID_Recs. S Type = REQUEST_ALL: None.</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.1.2-3">When processing REG_INFO-Request(ALL) message, ACS would reply 
REG_INFO-NAK to AER if it holds some fields are wrong. For example, 
AER requests one ARI_Rec that does not exist. Otherwise, REG_INFO-ACK 
message will be replyed. ACS WOULD process as follows:<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.2-4">
<li id="section-5.1.2-4.1">ACS SHOULD compare the Transaction Number in this packet with 
Transaction Number received from the same AER before. If bigger, ACS 
would process as step 2. Otherwise, AER WOULD discard this packet and 
send a REG_INFO-NAK message to AER.<a href="#section-5.1.2-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.2-4.2">ACS processes every ADID_Rec. If the AD exists in its maintained 
trust alliance list, ACS would mark this record as "Reply". Otherwise 
ACS would mark this record as "Negative Reply". Especially, all 
records would be marked with "Reply" when Operation field is 
REQUEST_ALL.<a href="#section-5.1.2-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.2-4.3">If any case in step 2 is marked with "Negative Reply", ACS would 
construct a REG_INFO-NAK message to reply to the AER. Otherwise, a 
REG_INFO-ACK message is constructed to reply the AD registration 
information of all members marked with "Reply" to the AER.<a href="#section-5.1.2-4.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="reponse-of-ad-registration-information">
<section id="section-5.1.3">
          <h4 id="name-reponse-of-ad-registration-">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-reponse-of-ad-registration-" class="section-name selfRef">Reponse of AD Registration Information</a>
          </h4>
<p id="section-5.1.3-1">AD registration information response includs two types. That is 
REG_INFO-ACK and REG_INFO-NAK. ACS will reply to AER according to the 
request of registration information sent by AER to ACS.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-8">
            <caption><a href="#table-8" class="selfRef">Table 8</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">REG_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">ACK: representing affirmative acknowledgement. NAK: representing negative acknowledgement.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL: REG_INFO-Request message. RENEW: REG_INFO-RequestAll.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = ACK: the number of ARI_Recs in Data field. S Type = REQUEST_ALL: 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent out to AER where I Type is REG_INFO and ACS would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">The Transaction Number of the response corresponding request.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = ACK: one or more ARI_Recs. S Type = NAK: a 32-bit error code defined at <a href="#pkt-format" class="xref">Section 3</a>. There is no boundary identification between these ARI_Recs, which requires that the implementation of the protocol can process each record sequentially until the end of this message.</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.1.3-3">It should be noted that when there are two ARI_Recs in Data fields 
responding to the same AD, one may effect right now and the other 
effects after passing Effecting Time. When AER receives this message, 
all of them should be restored in the trust alliance list and AER 
MUST process them orderly. Since the protocol processes the records 
in sequence, it is required that the ARI_Rec effecting at the current 
time for the same member AD should appear in front of another 
updating ARI_Rec.<a href="#section-5.1.3-3" class="pilcrow">¶</a></p>
<p id="section-5.1.3-4">When receiving a non-RENEW REG_INFO-ACK message, if it holds that 
some fields are wrong, AER could send a REG_INFO-RequestAll message 
to acquire the latest AD registration information. Otherwise, AER 
would act as follows.<a href="#section-5.1.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.3-5">
<li id="section-5.1.3-5.1">AER SHOULD compare the Transaction Number in this packet with 
Transaction Number received from the same ACS before. If bigger, AER 
would process them as follows. Otherwise, AER would discard this 
packet and send a REG_INFO-RequestAll message to acquire the lastest 
information of AD registration information.<a href="#section-5.1.3-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.3-5.2">AER WOULD processes every ARI_Rec:
- If Action is ADD and the record does not exist in its maintained 
trust alliance list, AER would add this record to its trust alliance 
list.
  - If Action is ADD and the record exists in its maintained trust 
  alliance list but ACS Address is changed, AER would add this record 
  to its trust alliance list and delete original record after 
  passing 
  Effecting Time in this ARI_Rec.
  - If Action is ADD and the record exists in its maintained trust 
  alliance list and ACS Address is not changed, AER would do nothing.
  - If Action is DEL and the record exists in its maintained trust 
  alliance list, AER would remove this record from its trust 
  alliance 
  list after passing Effecting Time in this ARI_Rec.<a href="#section-5.1.3-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.3-5.3">If a change is made in step 2, the update should take effect after 
passing the Effecting Time, which acts on the data plane. If the 
Effecting Time is earlier than the current time or is all 0, it will 
take effect immediately.<a href="#section-5.1.3-5.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.1.3-6">AER acts as following when receiving a RENEW REG_INFO-ACK message. 
When ACS initiates RENEW, it would send a RENEW meesge with which the 
first bit of Operation field is 1. The second bit of Operation field 
identifies the begin of a procedure of RENEW and the third bit of 
Operation field identifies the end of a procedure of RENEW. ACS MUST 
NOT send a RENEW packet with which the first bit of Operation field 
is 0 in RENEWing. AER MUST process this procedure of RENEW after 
received all RENEW packets.
When AER can resolve this packet correctly, it SHOULD:<a href="#section-5.1.3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.1.3-7">
<li id="section-5.1.3-7.1">Compare the Transaction Number in this packet with Transaction 
Number received from the same ACS before. If bigger, AER would accept 
every ARI_Rec and process them as step 2. Otherwise, AER would 
discard this packet and send a REG_INFO-RequestAll message to acquire 
the lastest information of AD registration information.<a href="#section-5.1.3-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.3-7.2">Process every ARI_Rec:
  - If the record does not exist in its maintained trust alliance 
  list, AER would add this record to its trust alliance list.
  - If the record exists in its maintained trust alliance list but 
  ACS Address is changed, AER would add this record to its trust 
  alliance list and delete original record after passing Effecting 
  Time in this ARI_Rec.
  - If the record exists in its maintained trust alliance list and 
  ACS Address is not changed, AER would do nothing.
  -If there are some records in the original trust alliance list that 
  do not appear in the Data field during this RENEW process, they 
  will be deleted immediately.<a href="#section-5.1.3-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.1.3-7.3">If a change is made in step 2, the update should take effect after 
passing the Effecting Time, which acts on the data plane. If the 
Effecting Time is earlier than the current time or is all 0, it will 
take effect immediately.<a href="#section-5.1.3-7.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.1.3-8">When AER receives an REG_INFO-NAK message, it could send a 
REG_INFO-RequestAll message to ACS to acquire the latest AD 
registration information.<a href="#section-5.1.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="deployment-request-and-reply-of-ad-prefix-information">
<section id="section-5.2">
        <h3 id="name-deployment-request-and-repl">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-deployment-request-and-repl" class="section-name selfRef">Deployment, Request and Reply of AD Prefix Information</a>
        </h3>
<div id="deployment-of-ad-prefix-information">
<section id="section-5.2.1">
          <h4 id="name-deployment-of-ad-prefix-inf">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-deployment-of-ad-prefix-inf" class="section-name selfRef">Deployment of AD Prefix Information</a>
          </h4>
<p id="section-5.2.1-1">AD prefix information deployment (PFX_INFO-Deploy) is sent from ACS 
to AER. ACS fills in the following values for each field:<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-9">
            <caption><a href="#table-9" class="selfRef">Table 9</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">AD_PREFIX_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">DEPLOYMENT</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL: to publish partial update information of member ADs' prefix. RENEW: to publish all member ADs' prefix.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">The number of API_Recs in Data field.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent out to AER where I Type is AD_PREFIX_INFO and ACS would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">One or more API_Recs. There is no boundary identification between these API_Recs, which requires that the implementation of the protocol can process each record sequentially until the end of this message.</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.2.1-3">It should be noted that when there are two ARI_Recs in Data fields 
responding to the same AD, one may effect right now and the other is 
update message for ADD or DEL effecting after the Effecting Time. For 
example, if the current time is 5 and there are two records 
corresponding to the prefix P, in which the Effecting Time of record 
R1 is 1, the action is ADD, the Effecting Time of record R2 is 7 and 
the action is DEL, then it indicates that the prefix P is currently 
valid effective from time 1 and becomes invalid at time 7. When ACS 
or AER receives this message, all of them should be restored in the 
database and ACS should send them all when deploying. Since the 
protocol processes the records in sequence, it is required that the 
API_Rec effecting at the current time for the same member AD should 
appear in front of another updating API_Rec.<a href="#section-5.2.1-3" class="pilcrow">¶</a></p>
<p id="section-5.2.1-4">When receiving a non-RENEW PFX_INFO-Deploy message, if it holds that 
some fields are wrong, for example, it requires to delete a API_Rec 
that does not exist or to add some prefix that is conflict with other 
member ADs, AER could send a request message to acquire the latest AD 
prefix information. Otherwise, AER would act as follows.<a href="#section-5.2.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.1-5">
<li id="section-5.2.1-5.1">AER SHOULD compare the Transaction Number in this packet with 
Transaction Number received from the same ACS before. If bigger, AER 
WOULD process them as step 2. Otherwise, AER would discard this 
packet and send a PFX_INFO-RequestAll message to acquire the lastest 
information of AD prefix information.<a href="#section-5.2.1-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-5.2">AER processes every API_Rec:
  - If Action is ADD and the record does not exist in its maintained 
  prefix list, AER would add this record to its prefix list.
  - If Action is ADD and the record exists in its maintained prefix 
  list, AER would do nothing.
  - If Action is DEL and the record exists in its maintained prefix 
  list, AER would remove this record from its prefix list after 
  Effecting Time.<a href="#section-5.2.1-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-5.3">If a change is made in step 2, the update should take effect after 
the Effecting Time, which acts on the data plane. If the Effecting 
Time is earlier than the current time or is all 0, it will take 
effect immediately.<a href="#section-5.2.1-5.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.2.1-6">AER acts as following when receiving a RENEW PFX_INFO-Deploy message. 
When ACS initiates RENEW, it would send a RENEW meesge with which the 
first bit of Operation field is 1. The second bit of Operation field 
identifies the begin of a procedure of RENEW and the third bit of 
Operation field identifies the end of a procedure of RENEW. ACS MUST 
NOT send a RENEW packet with which the first bit of Operation field 
is 0 in RENEWing. AER SHOULD uniformly process all packets in this 
RENEW process after receiving all RENEW packets.<a href="#section-5.2.1-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.1-7">
<li id="section-5.2.1-7.1">AER SHOULD compare the Transaction Number in this packet with 
Transaction Number received from the same ACS before. If bigger, AER 
WOULD process as step 2. Otherwise, AER would discard this message 
and send a PFX_INFO-RequestAll message to acquire the lastest 
information of AD prefix information.<a href="#section-5.2.1-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-7.2">AER processes every API_Rec:
  - If the record does not exist in its maintained prefix list, AER 
  would add this record to its trust alliance list.
  - If the record exists in its maintained prefix list, AER would do 
  nothing.
  - If there are some records in the original prefix list that do not 
  appear in the Data field during this RENEW process, these records 
  will be deleted immediately.<a href="#section-5.2.1-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.1-7.3">If a change is made in step 2, the update should take effect after 
passing the Effecting Time, which acts on the data plane. If the 
Effecting Time is earlier than the current time or is all 0, it will 
take effect immediately.<a href="#section-5.2.1-7.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="request-of-ad-prefix-information">
<section id="section-5.2.2">
          <h4 id="name-request-of-ad-prefix-inform">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-request-of-ad-prefix-inform" class="section-name selfRef">Request of AD Prefix Information</a>
          </h4>
<p id="section-5.2.2-1">AD prefix information request (PFX_INFO-RequestAll) is sent from AER to 
ACS to query some member ADs', including itself, all latest AD prefix 
information. 
AER fills in the following values for each field:<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-10">
            <caption><a href="#table-10" class="selfRef">Table 10</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">AD_PREFIX_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">REQUEST_ALL: querying from ACS the latest AD prefix information of all member ADs.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. AER would maintain a global Transaction Number for packets sent out to ACS where I Type is AD_PREFIX_INFO and AER would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">None</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.2.2-3">When receiving a PFX_INFO-RequestAll message, if it holds that some 
fields are wrong, ACS could send a PFX_INFO-NAK. Otherwise, ACS would 
act as follows. The specific construction methods of PFX_INFO-ACK and 
PFX_INFO-NAK are described in <a href="#PFX_INFO-Response" class="xref">Section 5.2.3</a>.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.2-4">
<li id="section-5.2.2-4.1">ACS SHOULD compare the Transaction Number in this packet with 
Transaction Number whose I Type is PFX_INFO received from the same 
AER before. If bigger, ACS WOULD process them as step 2. Otherwise, 
ACS would discard this packet and send a PFX_INFO-NAK message.<a href="#section-5.2.2-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.2-4.2">ACS processes every ADID_Rec. If AD exists in the maintained trust 
alliance list, ACS would mark this record as "Reply". Otherwise, ACS 
wourld mark this rocord as "Negative Reply". Particularly, all 
records are marked with "Reply" when S Type is REQUEST_ALL.<a href="#section-5.2.2-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.2-4.3">If any case in step 2 is marked with "Negative Reply", ACS would 
construct a PFX_INFO-NAK message to reply to the AER. Otherwise, a 
PFX_INFO-ACK message is constructed to reply the AD prefix 
information of all members marked with "Reply" to the AER.<a href="#section-5.2.2-4.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="PFX_INFO-Response">
<section id="section-5.2.3">
          <h4 id="name-response-of-ad-prefix-infor">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-response-of-ad-prefix-infor" class="section-name selfRef">Response of AD Prefix Information</a>
          </h4>
<p id="section-5.2.3-1">AD prefix information response includs two types. That is 
PFX_INFO-ACK and PFX_INFO-NAK. According to the request sent by AER, 
if some fields are wrong, ACS will reply NAK, in which the error 
code is "parameter error". If a non-existent member AD is queried, 
the error code is "the requested member AD does not exist", which 
defined as before will not be repeated. The following mainly 
introduces PFX_INFO-ACK response. ACS fills in the following values 
for each field:<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-11">
            <caption><a href="#table-11" class="selfRef">Table 11</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">AD_PREFIX_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">ACK: representing affirmative acknowledgement. NAK: representing negative acknowledgement.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">RENEW: replying the latest AD prefix information to AER.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = ACK: the number of API_Rec in Data field. S Type = NAK: 0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent out to AER where I Type is AD_PREFIX_INFO and ACS would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">The Transaction Number of the response corresponding request.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = ACK: One or more latest requested API_Rec. S Type = NAK: a 32-bit error code defined in <a href="#pkt-format" class="xref">Section 3</a>. There is no boundary identification between these API_Recs, which requires that the implementation of the protocol can process each record sequentially until the end of this message.</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.2.3-3">When receiving a non-RENEW PFX_INFO-ACK message which is the 
positive reply to the request of AD prefix sent from ACS to AER, if 
it holds that some fields are wrong, AER could send a request 
message to acquire the latest AD prefix information. Otherwise, AER 
would act as follows.<a href="#section-5.2.3-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.3-4">
<li id="section-5.2.3-4.1">AER SHOULD compare the Transaction Number in this packet with 
Transaction Number whose I Type is PFX_INFO received from the same 
ACS before. If bigger, AER would process them as follows. Otherwise, 
AER would discard this packet and send REG_INFO-RequestAll and 
PFX_INFO-RequestAll messages to acquire the lastest information.<a href="#section-5.2.3-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.3-4.2">AER processes every API_Rec:
  - If Action is ADD and the record does not exist in its maintained 
  prefix list, AER would add this record to its prefix list.
  - If Action is ADD and the record exists in its maintained prefix 
  list, AER would do nothing.
  - If Action is DEL and the record exists in its maintained prefix 
  list, AER would remove this record from its prefix list after 
  Effecting Time.<a href="#section-5.2.3-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.3-4.3">If a change is made in step 2, the update should take effect 
after the Effecting Time, which acts on the data plane. If the 
Effecting Time is earlier than the current time or is all 0, it will 
take effect immediately.<a href="#section-5.2.3-4.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.2.3-5">AER acts as following when receiving a RENEW PFX_INFO-ACK message. 
When ACS initiates RENEW process, it would send a RENEW meesge with 
which the first bit of Operation field is 1. The second bit of 
Operation field identifies the begin of a procedure of RENEW and the 
third bit of Operation field identifies the end of a procedure of 
RENEW. ACS MUST NOT send a RENEW packet with which the first bit of 
Operation field is 0 in RENEW process. AER SHOULD uniformly process 
all packets in this RENEW process after receiving all RENEW packets.<a href="#section-5.2.3-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.2.3-6">
<li id="section-5.2.3-6.1">AER SHOULD compare the Transaction Number in this packet with 
Transaction Number whose I Type is PFX_INFO received from the same 
ACS before. If bigger, AER WOULD process as step 2. Otherwise, AER 
would discard this message and send REG_INFO-RequestAll and 
PFX_INFO-RequestAll messages to acquire the lastest information.<a href="#section-5.2.3-6.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.3-6.2">AER processes every API_Rec. All Action in API_Recs is ADD during 
RENEW process.
  - If the record does not exist in its maintained prefix list, AER 
  would add this record to its trust alliance list.
  - If the record exists in its maintained prefix list, AER would do 
  nothing.
  - If there are some records in the original prefix list that do 
  not appear in the Data field during this RENEW process, these 
  records will be deleted immediately.<a href="#section-5.2.3-6.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.2.3-6.3">If a change is made in step 2, the update message should take 
effect after the Effecting Time, which acts on the data plane. If 
the Effecting Time is earlier than current time or is all 0, it will 
take effect immediately.<a href="#section-5.2.3-6.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.2.3-7">When AER receives an PFX_INFO-NAK message, it could send 
REG_INFO-RequestAll and PFX_INFO-RequestAll messages to ACS to 
acquire the latest AD registration information and AD prefix 
information.<a href="#section-5.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="deployment-request-and-response-of-state-machine-information">
<section id="section-5.3">
        <h3 id="name-deployment-request-and-respo">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-deployment-request-and-respo" class="section-name selfRef">Deployment, Request and Response of State Machine Information</a>
        </h3>
<div id="deployment-of-state-machine-information">
<section id="section-5.3.1">
          <h4 id="name-deployment-of-state-machine">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-deployment-of-state-machine" class="section-name selfRef">Deployment of State Machine Information</a>
          </h4>
<p id="section-5.3.1-1">State machine information deployment (SM_INFO-Deploy) is sent from 
ACS to AER. ACS fills in the following values for each field:<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-12">
            <caption><a href="#table-12" class="selfRef">Table 12</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">SM_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">DEPLOYMENT</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL: to publish the partial update of state machine maintained by the pair of this AD and another AD and Operation is RENEW: to publish wholesome update of state machine maintained by the pair of this AD and another AD.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">The number of SMI_Recs in Data field</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent out to AER where I Type is SM_INFO and ACS would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">One or more SMI_Recs. There is no boundary identification between these ARI_Recs, which requires that the implementation of the protocol can process each record sequentially until the end of this message.</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.3.1-3">It should be noted that state machine is responding to a ordered AD 
pair. The state machine information mastered by ACS includes the 
state machine information from this AD to another member AD, and the 
state machine information from another member AD to this AD. When 
ACS deployment is partially updated, only some changed or newly 
added state machines are deployed. When ACS deploys the update of 
RENEW message, it is necessary to deploy all existing and updated 
information. For the same ordered AD pair, there cannot be two or 
more SMI_Recs using the same SM_ID in Data field. In addition, there 
are two actions for SMI_Rec: one is to add a SM whose SM_ID is 
bigger than current using state machine. The second is to modify an 
existing state machine whose SM_ID equals to current using state 
machine. Both of them are using Action ADD. Here we requires only 
Transition Interval and Expiring Time can be updated.<a href="#section-5.3.1-3" class="pilcrow">¶</a></p>
<p id="section-5.3.1-4">When receiving a non-RENEW SM_INFO-Deploy message sent from ACS to 
AER, if it holds that some fields are wrong, for example, Action is 
DEL or SM_ID is smaller than current state machine in using, AER 
could send a request message to acquire the latest information. 
Otherwise, AER would act as follows.<a href="#section-5.3.1-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3.1-5">
<li id="section-5.3.1-5.1">AER SHOULD compare the Transaction Number in this packet with 
Transaction Number whose I Type is SM_INFO received from the same 
ACS before. If bigger, AER WOULD process them as step 2. Otherwise, 
AER would discard this packet and send REG_INFO-RequestAll and 
request messages to acquire the lastest information.<a href="#section-5.3.1-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.3.1-5.2">AER processes every SMI_Rec:
  - If SM_ID equals to the current using state machine, AER should 
  update the state machine in use.
  - If SM_ID bigger than the current using state machine, AER should 
  add this state machine to its list.<a href="#section-5.3.1-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.3.1-5.3">If a change is made in step 2, the update message should take 
effect after the Effecting Time, which acts on the data plane. If 
the Effecting Time is earlier than the current time or is all 0, it 
will take effect immediately.<a href="#section-5.3.1-5.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.3.1-6">AER acts as following when receiving a RENEW SM_INFO-Deploy message. 
When ACS initiates RENEW process, it would send a RENEW meesge with 
which the first bit of Operation field is 1. The second bit of 
Operation field identifies the begin of a procedure of RENEW and the 
third bit of Operation field identifies the end of a procedure of 
RENEW. ACS MUST NOT send a RENEW packet with which the first bit of 
Operation field is 0 in RENEW process. AER SHOULD uniformly process 
all packets in this RENEW process after receiving all RENEW packets.<a href="#section-5.3.1-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3.1-7">
<li id="section-5.3.1-7.1">AER SHOULD compare the Transaction Number in this packet with 
Transaction Number whose I Type is SM_INFO received from the same 
ACS before. If bigger, AER WOULD process as step 2. Otherwise, AER
would discard this message and send a request messages to acquire the lastest information.<a href="#section-5.3.1-7.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.3.1-7.2">AER processes every SMI_Rec.
  - If SM_ID equals to the current using state machine, AER should 
  update the state machine in use.
  - If SM_ID bigger than the current using state machine, AER should 
  add this state machine to its list.
  - If there are some records of state machines in use that do not 
  appear in the Data field during this RENEW process, these state 
  machines will be deleted immediately.<a href="#section-5.3.1-7.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.3.1-7.3">If a change is made in step 2, the update message should take 
effect after the Effecting Time, which acts on the data plane. If 
the Effecting Time is earlier than current time or is all 0, it will 
take effect immediately.<a href="#section-5.3.1-7.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="request-of-state-machine-information">
<section id="section-5.3.2">
          <h4 id="name-request-of-state-machine-in">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-request-of-state-machine-in" class="section-name selfRef">Request of State Machine Information</a>
          </h4>
<p id="section-5.3.2-1">State machine information request (SM_INFO-Request) is sent from AER 
to ACS. AER fills in the following values for each field:<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-13">
            <caption><a href="#table-13" class="selfRef">Table 13</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">SM_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">REQUEST: querying the state machines maintained by the pair of this AD to another member AD and vice versa. These member ADs are specified by ADID_Rec defined in Data field. REQUEST_ALL: querying all state machines maintained by this AD with other member ADs.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = REQUEST: the number of ADID_Rec in Data field. S Type = REQUEST_ALL: 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. AER would maintain a global Transaction Number for packets sent out to ACS where I Type is SM_INFO and AER would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = REQUEST: One or more ADID_Recs. S Type = REQUEST_ALL: none. There is no boundary identification between these ADID_Recs, which requires that the implementation of the protocol can process each record sequentially until the end of this message.</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.3.2-3">For example, let this AD is AD1. When any ADID_Rec including in Data 
field, defined as AD2, it means that AER will request the SM(AD1, 
AD2) and SM(AD2, AD1). When ACS replies, it will reply these two 
state machines both.<a href="#section-5.3.2-3" class="pilcrow">¶</a></p>
<p id="section-5.3.2-4">When receiving a SM_INFO-Request(All) message, if it holds that some 
fields are wrong, ACS could send a PFX_INFO-NAK. Otherwise, ACS 
would act as follows. The specific construction methods of 
SM_INFO-ACK and SM_INFO-NAK are described in secion 3.2.3.3.<a href="#section-5.3.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3.2-5">
<li id="section-5.3.2-5.1">ACS SHOULD compare the Transaction Number in this packet with 
Transaction Number whose I Type is SM_INFO received from the same 
AER before. If bigger, ACS WOULD process them as step 2. Otherwise, 
ACS would discard this packet and send a SM_INFO-NAK message.<a href="#section-5.3.2-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.3.2-5.2">ACS processes every ADID_Rec. If AD exists in the maintained 
trust alliance list, ACS would mark this record as "Reply". 
Otherwise, ACS wourld mark this rocord as "Negative Reply". 
Particularly, all records are marked with "Reply" when S Type is 
REQUEST_ALL.<a href="#section-5.3.2-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.3.2-5.3">If any case in step 2 is marked with "Negative Reply", ACS would 
construct a SM_INFO-NAK message to reply to the AER. Otherwise, a 
SM_INFO-ACK message is constructed to reply the state machine 
information of all members marked with "Reply" to the AER.<a href="#section-5.3.2-5.3" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="response-of-state-machine-information">
<section id="section-5.3.3">
          <h4 id="name-response-of-state-machine-i">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-response-of-state-machine-i" class="section-name selfRef">Response of State Machine Information</a>
          </h4>
<p id="section-5.3.3-1">State machine information response includs two types. That is 
SM_INFO-ACK and SM_INFO-NAK. Both of them are sent from ACS to AER. 
ACS fills in the following values for each field:<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<table class="center" id="table-14">
            <caption><a href="#table-14" class="selfRef">Table 14</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">SM_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">ACK: representing affirmative acknowledgement. NAK: representing negative acknowledgement.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">RENEW: replying the latest state machine information to AER.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = ACK: the number of SMI_Recs in Data field. S Type = NAK: 0.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent to AER where I Type is SM_INFO and would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">The Transaction Number of the response corresponding request.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">S Type = ACK: one or more latest requested SMI_Rec. S Type = NAK: a 32-bit error code defined in <a href="#pkt-format" class="xref">Section 3</a>. There is no boundary identification between these ADID_Recs, which requires that the implementation of the protocol can process each record sequentially until the end of this message.</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.3.3-3">When receiving a non-RENEW SM_INFO-ACK message which is the positive 
reply to the request of AD prefix sent from ACS to AER, if it holds 
that some fields are wrong, AER could send a request message to 
acquire the latest state machine information. Otherwise, AER would 
act as follows.
1. AER SHOULD compare the Transaction Number in this packet with 
Transaction Number whose I Type is PFX_INFO received from the same 
ACS before. If bigger, AER WOULD process them as step 2. Otherwise, 
AER would discard this packet and send a SM_INFO-RequestAll message 
to acquire the lastest information.
2. AER processes every SMI_Rec:
  - If SM_ID equals to the current using state machine, AER should 
  update the state machine in use.
  - If SM_ID bigger than the current using state machine, AER should 
  add this state machine to its list.
3. If a change is made in step 2, the update should take effect 
after the Effecting Time, which acts on the data plane. If the 
Effecting Time is earlier than the current time or is all 0, it will 
take effect immediately.<a href="#section-5.3.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3.3-4">AER acts as following when receiving a RENEW SM_INFO-ACK message. 
When ACS initiates RENEW process, it would send a RENEW meesge with 
which the first bit of Operation field is 1. The second bit of 
Operation field identifies the begin of a procedure of RENEW and the 
third bit of Operation field identifies the end of a procedure of 
RENEW. ACS MUST NOT send a RENEW packet with which the first bit of 
Operation field is 0 in RENEW process. AER SHOULD uniformly process 
all packets in this RENEW process after receiving all RENEW packets.<a href="#section-5.3.3-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.3.3-5">
<li id="section-5.3.3-5.1">AER SHOULD compare the Transaction Number in this packet with 
Transaction Number whose I Type is SM_INFO received from the same 
ACS before. If bigger, AER WOULD process as step 2. Otherwise, AER 
would discard this message and send a SM_INFO-RequestAll message to 
acquire the lastest information.<a href="#section-5.3.3-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-5.3.3-5.2">AER processes every API_Rec. All Action in API_Recs is ADD during 
RENEW process.
  - If SM_ID equals to the current using state machine, AER should 
  update the state machine in use.
  - If SM_ID bigger than the current using state machine, AER should 
  add this state machine to its list.
  - If there are some records of state machines in use that do not 
  appear in the Data field during this RENEW process, these state 
  machines will be deleted immediately.<a href="#section-5.3.3-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-5.3.3-5.3">If a change is made in step 2, the update message should take 
effect after the Effecting Time, which acts on the data plane. If 
the Effecting Time is earlier than current time or is all 0, it will 
take effect immediately.<a href="#section-5.3.3-5.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-5.3.3-6">When AER receives an SM_INFO-NAK message, it could send a 
SM_INFO-RequestAll message to ACS to acquire the latest state 
machine information.<a href="#section-5.3.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="request-and-response-of-keep-alive-information">
<section id="section-5.4">
        <h3 id="name-request-and-response-of-kee">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-request-and-response-of-kee" class="section-name selfRef">Request and Response of Keep-alive Information</a>
        </h3>
<p id="section-5.4-1">In SAVA-X, ACS will periodically send Keep-alive request to query 
the availability of AER in SAVA-X mechanism.
### Request of Keep-alive Information
Keep-alive information request (ALIVE_INFO-Request) is sent by ACS 
to test the viability of AER. AER would reply to ACS when receiving 
a ALIVE_INFO-Request message. ACS considers that AER has gone wrong 
if it does not receive a response from AER within 60 seconds and ACS 
notifies the AD administrator of the failure information by email. 
ACS would keep sending ALIVE_INFO-Request to the fault AER at the 
same time. The filling values of each field in ACS request are as 
follows:<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<table class="center" id="table-15">
          <caption><a href="#table-15" class="selfRef">Table 15</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Field</th>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Version</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Alliance</td>
              <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">I Type</td>
              <td class="text-left" rowspan="1" colspan="1">ALIVE_INFO</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">S Type</td>
              <td class="text-left" rowspan="1" colspan="1">REQUEST</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Operation</td>
              <td class="text-left" rowspan="1" colspan="1">NULL</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Total Length</td>
              <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
              <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. ACS would maintain a global Transaction Number for packets sent to AER where I Type is ALIVE_INFO and would keep it increasing monotonic.</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Data</td>
              <td class="text-left" rowspan="1" colspan="1">None</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.4-3">ACS considers that AER has gone wrong if it does not receive a 
response from AER within 60 seconds and ACS notifies the AD 
administrator of the failure information by email. ACS would 
consider that AER has recovered from failure when AER reply to the 
request correctly. ACS performs the following steps to update AER:<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-5.4-4">
<li id="section-5.4-4.1">Keep time synchronization between AER and ACS.<a href="#section-5.4-4.1" class="pilcrow">¶</a>
</li>
          <li id="section-5.4-4.2">Deploy AD registration information, AD prefix information and 
state machine information to AER by the way of RENEW message.<a href="#section-5.4-4.2" class="pilcrow">¶</a>
</li>
        </ol>
<div id="response-of-keep-alive-information">
<section id="section-5.4.1">
          <h4 id="name-response-of-keep-alive-info">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-response-of-keep-alive-info" class="section-name selfRef">Response of Keep-alive Information</a>
          </h4>
<p id="section-5.4.1-1">Keep-alive information response (ALIVE_INFO-Response) is sent by AER 
to reply the ALIVE_INFO-Request message.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<p id="section-5.4.1-2">In response to ALIVE_INFO-Request, AER fills in the following values 
for each field in the response:<a href="#section-5.4.1-2" class="pilcrow">¶</a></p>
<table class="center" id="table-16">
            <caption><a href="#table-16" class="selfRef">Table 16</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Field</th>
                <th class="text-left" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Version</td>
                <td class="text-left" rowspan="1" colspan="1">1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Alliance</td>
                <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">I Type</td>
                <td class="text-left" rowspan="1" colspan="1">ALIVE_INFO</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">S Type</td>
                <td class="text-left" rowspan="1" colspan="1">ACK</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Operation</td>
                <td class="text-left" rowspan="1" colspan="1">NULL</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Total Length</td>
                <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
                <td class="text-left" rowspan="1" colspan="1">The last Transaction Number add 1. AER would maintain a global Transaction Number for packets sent to ACS where I Type is ALIVE_INFO and would keep it increasing monotonic.</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
                <td class="text-left" rowspan="1" colspan="1">0</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Data</td>
                <td class="text-left" rowspan="1" colspan="1">None</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="deployment-of-tag-information">
<section id="section-6">
      <h2 id="name-deployment-of-tag-informati">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-deployment-of-tag-informati" class="section-name selfRef">Deployment of Tag Information</a>
      </h2>
<p id="section-6-1">Tag information deployment (TAG_INFO-Deploy) is sent from ACS to AER 
and AER would add, verify and remove the tag to packet. When using 
sub trust alliance level tags and AD_V tags, the primary address 
domain ACS needs to distribute these two tags to the ACS of the 
boundary address domain first, and then the boundary address domain 
ACS will distribute these tags to their respective address domains' 
AERs. The sub trust alliance tag is used in the data plane to cross 
different address domain levels. The AD_V tag is used in the data 
plane when it is sent from the current address domain to the 
boundary address domain. Standard TAG_INFO is used in the data plane 
at the same level and under the same direct parent address field. 
The three types of tags use the same message format as follows.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-2">
<pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+
 |     Action    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                       Source ADID_Rec                         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                     Destination ADID_Rec                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Tag Len   |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 ~                             TAG                               ~
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                      Transition Interval                      |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6-2" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlParallel" id="section-6-3">
        <dt id="section-6-3.1">Action:</dt>
        <dd style="margin-left: 1.5em" id="section-6-3.2">
  8-bit filed. 1 for add (ADD=1) and 2 for delete (DEL=2).<a href="#section-6-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-3.3">Source ADID_Rec:</dt>
        <dd style="margin-left: 1.5em" id="section-6-3.4">
  Variable-length field. Refer to ADID_Rec in <span>[<a href="#SAVA-X-Control" class="xref">SAVA-X-Control</a>]</span>.<a href="#section-6-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-3.5">Destination ADID_Rec:</dt>
        <dd style="margin-left: 1.5em" id="section-6-3.6">
  Variable-length field. Refer to ADID_Rec.<a href="#section-6-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-3.7">Tag Len:</dt>
        <dd style="margin-left: 1.5em" id="section-6-3.8">
  The length of TAG. The equation for calculation is (Tag Len + 1) * 
8 bits. The length of TAG MUST be multiple times of 8 bits. The 
maximum length is 128 bits and the minimum length is 32 bits. So the 
minimum of Tag Len is 0011.<a href="#section-6-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-3.9">TAG:</dt>
        <dd style="margin-left: 1.5em" id="section-6-3.10">
  Variable-length field. The actual Tag or packet signature.<a href="#section-6-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-6-3.11">Transition Interval:</dt>
        <dd style="margin-left: 1.5em" id="section-6-3.12">
  32-bit, the milliseconds of interval of state transition.<a href="#section-6-3.12" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-6-4">When ACS announce tag to ACS or AER, it fills in the following 
values for each field:<a href="#section-6-4" class="pilcrow">¶</a></p>
<table class="center" id="table-17">
        <caption><a href="#table-17" class="selfRef">Table 17</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Field</th>
            <th class="text-left" rowspan="1" colspan="1">Value</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Version</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Alliance</td>
            <td class="text-left" rowspan="1" colspan="1">The sub-trust alliance number.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">I Type</td>
            <td class="text-left" rowspan="1" colspan="1">TAG_INFO, ALLI_TAG_INFO or AD_V_TAG_INFO</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">S Type</td>
            <td class="text-left" rowspan="1" colspan="1">ANNOUNCEMENT</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Operation</td>
            <td class="text-left" rowspan="1" colspan="1">NULL</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Total Length</td>
            <td class="text-left" rowspan="1" colspan="1">The length of this message.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Number of Records</td>
            <td class="text-left" rowspan="1" colspan="1">The number of TAG_Rec in Data field.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Transaction Number</td>
            <td class="text-left" rowspan="1" colspan="1">ACS would maintain a global Transaction Number for packets sent to ACS or AER where I Type is TAG_INFO and would keep it increasing monotonic. Acknowledgement Number is 0.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Acknowledgement Number</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Data</td>
            <td class="text-left" rowspan="1" colspan="1">One or more TAG_Recs. There is no boundary identification between these records, which requires that the implementation of the protocol can process each record sequentially until the end of this message.</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="security-consideration">
<section id="section-7">
      <h2 id="name-security-consideration">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-consideration" class="section-name selfRef">Security Consideration</a>
      </h2>
<p id="section-7-1">This present memo doesnot find any security problem.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-consideration">
<section id="section-8">
      <h2 id="name-iana-consideration">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-consideration" class="section-name selfRef">IANA Consideration</a>
      </h2>
<p id="section-8-1">There are two tcp ports, 23160 and 23161, are used in implementing 
SAVA-X mechanism. Port 23160 is used for the communication between 
ACS and ACS. Port 23161 is used for the communication between ACS 
and AER.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1">Much of the content of this document is the expansion of the IETF 
<span>[<a href="#RFC5210" class="xref">RFC5210</a>]</span> in inter-domain level. Thanks to the effort of pioneers.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-10.1">
        <h3 id="name-normative-references">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5210">[RFC5210]</dt>
        <dd>
<span class="refAuthor">Wu, J.</span>, <span class="refAuthor">Bi, J.</span>, <span class="refAuthor">Li, X.</span>, <span class="refAuthor">Ren, G.</span>, <span class="refAuthor">Xu, K.</span>, and <span class="refAuthor">M. Williams</span>, <span class="refTitle">"A Source Address Validation Architecture (SAVA) Testbed and Deployment Experience"</span>, <span class="seriesInfo">RFC 5210</span>, <span class="seriesInfo">DOI 10.17487/RFC5210</span>, <time datetime="2008-06" class="refDate">June 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5210">https://www.rfc-editor.org/info/rfc5210</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
      <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-10.2">
        <h3 id="name-informative-references">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="SAVA-X-Control">[SAVA-X-Control]</dt>
      <dd>
<span class="refAuthor">Computer Science, .</span>, <span class="refAuthor">Computer Science, .</span>, and <span class="refAuthor">. Institute for Network Sciences and Cyberspace</span>, <span class="refTitle">"Control Plane of Inter-Domain Source Address Validation Architecture"</span>, <time datetime="2021" class="refDate">2021</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ke Xu</span></div>
<div dir="auto" class="left"><span class="org">Computer Science, Tsinghua University</span></div>
<div dir="auto" class="left"><span class="street-address">Qinghuayuan street, Haidian District</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="postal-code">100084</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:xuke@tsinghua.edu.cn" class="email">xuke@tsinghua.edu.cn</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Xiaoliang Wang</span></div>
<div dir="auto" class="left"><span class="org">Computer Science, Tsinghua University</span></div>
<div dir="auto" class="left"><span class="street-address">Qinghuayuan street, Haidian District</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="postal-code">100084</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wangxiaoliang0623@foxmail.com" class="email">wangxiaoliang0623@foxmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yangfei Guo</span></div>
<div dir="auto" class="left"><span class="org">Institute for Network Sciences and Cyberspace, Tsinghua University</span></div>
<div dir="auto" class="left"><span class="street-address">Qinghuayuan street, Haidian District</span></div>
<div dir="auto" class="left"><span class="locality">Beijing</span></div>
<div dir="auto" class="left"><span class="postal-code">100084</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:guoyangf19@mails.tsinghua.edu.cn" class="email">guoyangf19@mails.tsinghua.edu.cn</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
