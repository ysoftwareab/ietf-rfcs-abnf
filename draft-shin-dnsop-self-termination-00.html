<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Self-termination Mechanism for Anycast DNS Service</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Self-termination Mechanism for Anycast DNS Service">
<meta name="keywords" content="Internet Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DNSOP Working Group</td><td class="header">S. Shin</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">H. Lee</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">C. Park</td></tr>
<tr><td class="header">Expires: April 19, 2010</td><td class="header">H. Paik</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Korea Internet & Security Agency</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">of Korea</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 16, 2009</td></tr>
</table></td></tr></table>
<h1><br />Self-termination Mechanism for Anycast DNS Service<br />draft-shin-dnsop-self-termination-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 19, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
	  Anycast has in recent years become popular for DNS servers and widely 
       applied to several root nams servers and to other commercial name 
       servers.  For Anycast-based DNS service reliability, this documents 
       describes the use of self-termination mechanism in Anycast-based DNS 
       service operation when the service becomes unavailable due to events 
       such as hardware failures
	  
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Self-termination Mechanism<br />
<a href="#Security">3.</a>&nbsp;
Security Considerations<br />
<a href="#IANA">4.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">5.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">5.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">5.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
	     DNS service is one of the most important factors in Internet 
       infrastructures.  Anycast-based[1] DNS service [2] has been discussed 
       within related areas for providing stable service to the users for 
       many years. 
	    
</p>
<p>
       Anycast-based DNS service has generally various advantages such as 
       effective dealing with DDoS attack, overcoming the limit of 
       authoritative name server's physical numbers and improving service 
       stability and performance through a distribution of DNS traffic. More 
       good points are described in other related documents.  
      
</p>
<p>
      For that reason, the number of DNS nodes (e.g., Root DNS, TLD DNS and 
      sub-level authoritative DNS) which ancyast-based DNS architecture 
      applied has been increased greatly.  
      
</p>
<p>
       In spite of these merits, one of the problems is that Anycast DNS 
       service system would keep advertising of its normal condition even 
       when it becomes unavailable.  Particularly, Anycast DNS service with 
       no self-monitoring system may not be able to respond to queries 
       regionally for some time. 
      
</p>
<p>
       In order to solve this problem, this documents describes self-
       termination mechanism of interfaces on hosts making queries go out to 
       other mirror sites automatically.  
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Self-termination Mechanism</h3>

<p>
       As the DNS Server has a trouble in responding to queries, it can be 
       self-monitored by using a simple script like the following.  This 
       script monitors the behavior of the DNS for 5 times and continuously 
       alerts the DNS Administrator.
     
</p>
<p>
       The Self-termination process by using OSPF Link State 
       Advertisements(LSAs), The DNS server itself could be Self-terminated 
       by simply setting down network interfaces(e.g lo0).
     
</p>
<p>
       Then queries from the Anycast DNS would be bypassed to the shortest 
       alternate Anycast DNS and the DNS Service would be reliable.
     
</p>
<p>
     #!/bin/ksh <br />
 
     
</p>
<p> 
       ExitProcess () <br />

       { <br />

         RETURN_STATUS=$1 <br />

         exit $RETURN_STATUS <br />

       } <br />

     
</p>
<p>   
       dig @127.0.0.1 soa kr <br />

       if [ $? -ne 0 ];then  <br />

          date >  /tmp/link_down.txt <br />

          echo "DNS Mirror Site  OUT OF SERVICE!! - 1 time" >> /tmp/link_down.txt <br />

          sleep 120 <br />

               dig @127.0.0.1 soa kr <br />

               if [ $? -ne 0 ];then <br />

                       date >>  /tmp/link_down.txt <br />

                       echo "DNS Mirror Site  OUT OF SERVICE!! - 2 time" >> /tmp/link_down.txt <br />

                       sleep 120 <br />

                               dig @127.0.0.1 soa kr <br />

                               if [ $? -ne 0 ];then <br />

                               date >>  /tmp/link_down.txt <br />

                                echo "DNS Mirror Site  OUT OF SERVICE!! - 3 time" >> /tmp/link_down.txt <br />

                               sleep 120 <br />

                                       dig @127.0.0.1 soa kr <br />

                                       if [ $? -ne 0 ];then  <br />

                                       date >>  /tmp/link_down.txt <br />

                                       echo "DNS Mirror Site  OUT OF SERVICE!! - 4 time" >> /tmp/link_down.txt <br />

                                       sleep 120 <br />

                                               dig @127.0.0.1 soa kr <br />

                                               if [ $? -ne 0 ];then <br />

                                               date >>  /tmp/link_down.txt <br />

                                               echo "DNS Mirror Site  OUT OF SERVICE!! - 5 time" >> /tmp/link_down.txt <br />

                               echo "Check the BIND Service!!" >> /tmp/link_down.txt <br />

                               echo "It will be down the Interface lo0." >> /tmp/link_down.txt <br />

                               echo "You will be follow after coming up the Server." >> /tmp/link_down.txt <br />

                               echo " === ifconfig lo0 up ===" >> /tmp/link_down.txt <br />

                               /bin/mailx -s "DNS Mirror Site  OUT OF SERVICE!!"  admin@dns.kr < /tmp/link_down.txt <br />

                               /usr/sbin/ifconfig lo0 down <br />

                               /usr/sbin/ifconfig  -a  >> /tmp/link_down.txt <br />

                               ExitProcess 1 <br />

                                               else <br />

                                               date <br />

                                               echo "DNS Mirror Site Runs Normally" <br />

                                               fi <br />

                                       else <br />

                                       date <br />

                                       echo "DNS Mirror Site Runs Normally" <br />

                                       fi <br />

                               else <br />

                               date <br />

                               echo "DNS Mirror Site Runs Normally" <br />

                               fi <br />

                                                  else <br />

                       date <br />

                       echo "DNS Mirror Site Runs Normally" <br />

                       fi <br />

       else <br />

          date <br />

          echo "DNS Mirror Site  Runs Normally" <br />

       fi <br />
                                             
     
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Security Considerations</h3>

<p>
	     This document describes a mechanism for self-termination of Anycast 
       DNS service on the Internet that can be used to cope with DDoS attack.  
      
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
IANA Considerations</h3>

<p>
       This document is only advisory, and does not have any IANA 
       considerations.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>5.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1546">[1]</a></td>
<td class="author-text"><a href="mailto:craig@bbn.com">Partridge, C.</a>, <a href="mailto:tmendez@bbn.com">Mendez, T.</a>, and <a href="mailto:milliken@bbn.com">W. Milliken</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1546">Host Anycasting Service</a>,&rdquo; RFC&nbsp;1546, November&nbsp;1993 (<a href="http://www.rfc-editor.org/rfc/rfc1546.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4786">[2]</a></td>
<td class="author-text">Abley, J. and K. Lindqvist, &ldquo;<a href="http://tools.ietf.org/html/rfc4786">Operation of Anycast Services</a>,&rdquo; BCP&nbsp;126, RFC&nbsp;4786, December&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4786.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>5.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="refs.Abbley">[3]</a></td>
<td class="author-text">Abbley, J., &ldquo;A Software Approach to Distributing Requests for DNS Service using GNU Zebra,&rdquo; 3&nbsp;2004.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sungwoo Shin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Korea Internet & Security Agency of Korea</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">11F 398 Seochoro Seocho-gu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seoul,   137-857</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Korea</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ssw@kisa.or.kr">ssw@kisa.or.kr</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hansang Lee</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Korea Internet & Security Agency of Korea</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">11F 398 Seochoro Seocho-gu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seoul,   137-857</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Korea</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:leehs@kisa.or.kr">leehs@kisa.or.kr</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chanki Park</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Korea Internet & Security Agency of Korea</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">11F 398 Seochoro Seocho-gu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seoul,   137-857</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Korea</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ckp@kisa.or.kr">ckp@kisa.or.kr</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hyongjong Paik</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Korea Internet & Security Agency of Korea</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">3F 398 Seochoro Seocho-gu</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seoul,   137-857</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Korea</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hjpaik@kisa.or.kr">hjpaik@kisa.or.kr</a></td></tr>
</table>
</body></html>
