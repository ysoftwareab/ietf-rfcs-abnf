<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Requirements for Adaptive DNS Discovery</title>
<meta content="Chris Box" name="author">
<meta content="Tommy Pauly" name="author">
<meta content="Christopher A. Wood" name="author">
<meta content="Tirumaleswar Reddy" name="author">
<meta content="
       Adaptive DNS Discovery is chartered to define mechanisms that allow clients to discover and select encrypted DNS resolvers.
This document describes several use cases for discovering DNS resolvers that support encrypted transports,
and lists requirements that any proposed discovery and selection mechanisms should address. 
    " name="description">
<meta content="xml2rfc 3.0.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-box-add-requirements-00" name="ietf.draft">
<link href="/tmp/draft-box-add-requirements-00-y9pwi6kc.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">ADDREQ</td>
<td class="right">September 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Box, et al.</td>
<td class="center">Expires March 8, 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ADD</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-box-add-requirements-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-09-04" class="published">September 4, 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-03-08">March 8, 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Box</div>
<div class="org">BT</div>
</div>
<div class="author">
      <div class="author-name">T. Pauly</div>
<div class="org">Apple</div>
</div>
<div class="author">
      <div class="author-name">C.A. Wood</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">T. Reddy</div>
<div class="org">McAfee</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Requirements for Adaptive DNS Discovery</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Adaptive DNS Discovery is chartered to define mechanisms that allow clients to discover and select encrypted DNS resolvers.
This document describes several use cases for discovering DNS resolvers that support encrypted transports,
and lists requirements that any proposed discovery and selection mechanisms should address.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/ietf-wg-add/draft-add-requirements">https://github.com/ietf-wg-add/draft-add-requirements</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on March 8, 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-discovery-of-associated-res" class="xref">Discovery of associated resolvers</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-network-provisioned-resolve" class="xref">Network-provisioned resolvers</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-unencrypted-forwarder" class="xref">Unencrypted forwarder</a><a href="#section-toc.1-1.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-encrypted-forwarder" class="xref">Encrypted forwarder</a><a href="#section-toc.1-1.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-client-selected-resolvers" class="xref">Client-selected resolvers</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-vpn-resolvers" class="xref">VPN resolvers</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-discovery-of-limited-domain" class="xref">Discovery of limited domain resolvers</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-discover-a-mapping-between-" class="xref">Discover a mapping between a locally-hosted domain and a resolver</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-encrypted-resolvers-for-loc" class="xref">Encrypted resolvers for local or home content</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-locally-cached-content" class="xref">Locally-cached content</a><a href="#section-toc.1-1.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-private-enterprise-names" class="xref">Private enterprise names</a><a href="#section-toc.1-1.4.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-encrypted-resolvers-for-con" class="xref">Encrypted resolvers for content providers</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-privacy-and-security-requir" class="xref">Privacy and security requirements</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-on-opportunistic-encryption" class="xref">On opportunistic encryption</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-handling-exceptions-and-fai" class="xref">Handling exceptions and failures</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-requirements-summary" class="xref">Requirements Summary</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Several protocols for protecting DNS traffic with encrypted transports have been defined,
such as DNS-over-TLS (DoT) <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span> and DNS-over-HTTPS (DoH) <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>.
Encrypted DNS can provide many security and privacy benefits for network clients.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">While it is possible for clients to hard-code encrypted DNS resolvers to use, dynamic
discovery and provisioning of encrypted resolvers can expand the usefulness and
applicability of encrypted DNS to many more use cases.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The Adaptive DNS Discovery (ADD) Working Group is chartered to define mechanisms that allow clients to automatically discover
and select encrypted DNS resolvers in a wide variety of network environments. This document describes several use cases
for discovering DNS resolvers that support encrypted transports, and lists requirements that any proposed discovery and
selection mechanisms should address. They can do this either by providing a solution, or by explicitly stating why it
is not in scope.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Use cases are described between <a href="#associated" class="xref">Section 3</a> and <a href="#cdn-content" class="xref">Section 4.2</a>.
Each use case contains a narrative and a set of requirements that apply in that case.
There are additional common requirements in <a href="#priv-sec" class="xref">Section 5</a>.
Each requirement is identified as "Ra.b" where a is the group number and b is the number within that group.
Both a and b are integers starting with 1.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">A summary of all requirements in listed in <a href="#requirements-summary" class="xref">Section 6</a>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="requirements-language">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
"SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span>
when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<p id="section-2-1">This document makes use of the following terms.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Encrypted DNS: DNS-over-HTTPS <span>[<a href="#RFC8484" class="xref">RFC8484</a>]</span>, DNS-over-TLS <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>, or any other encrypted DNS technology that
the IETF may publish, such as DNS-over-QUIC <span>[<a href="#I-D.ietf-dprive-dnsoquic" class="xref">I-D.ietf-dprive-dnsoquic</a>]</span>.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Associated resolver: A resolver operated by the same entity that provides the resolver the client started with. See <a href="#associated" class="xref">Section 3</a>.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">Equivalent associated resolver: An associated resolver that provides DNS responses that are identical to the ones served by the original unencrypted resolver.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">Alternative associated resolver: An associated resolver that serves different responses to some queries; see <a href="#associated" class="xref">Section 3</a> for examples.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="associated">
<section id="section-3">
      <h2 id="name-discovery-of-associated-res">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-discovery-of-associated-res" class="section-name selfRef">Discovery of associated resolvers</a>
      </h2>
<p id="section-3-1">A client may begin with information about unencrypted resolvers from the attached networks (<a href="#local-network" class="xref">Section 3.1</a>),
and/or unencrypted resolvers known from configuration (<a href="#client-selected" class="xref">Section 3.2</a>).
This information may be used to then discover one or more associated encrypted resolvers.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Associated resolvers are defined as resolvers operated by the same entity that provides the resolver the client started with.
Such associated resolvers may come in two forms:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3-3">
        <li id="section-3-3.1">Equivalent - these provide DNS responses that are identical to the ones served by the unencrypted resolver.<a href="#section-3-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-3-3.2">Alternative - these serve different responses to some queries. For example one entity may offer a set of encrypted resolvers with different levels of filtering (none, just malware, or malware &amp; adult content), or different proximity (local or central).<a href="#section-3-3.2" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-3-4">The client may wish to select an equivalent associated resolver, or select one of the alternatives.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Designs for resolver upgrade mechanisms can either add new parameters to existing provisioning mechanisms
(for example, adding necessary information to use DoT or DoH to options in DHCP, RAs, or IKEv2) or else provide a way
to communicate with a provisioned unencrypted DNS resolver and discover the associated encrypted DNS resolvers.<a href="#section-3-5" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Requirement</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">R1.1</td>
            <td class="text-left" rowspan="1" colspan="1">There must be a mechanism for a client to learn the set of encrypted resolvers that are associated with an unencrypted resolver.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">R1.2</td>
            <td class="text-left" rowspan="1" colspan="1">Discovery must be possible even when the IP address of the encrypted resolver is only valid locally.</td>
          </tr>
        </tbody>
      </table>
<div id="local-network">
<section id="section-3.1">
        <h3 id="name-network-provisioned-resolve">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-network-provisioned-resolve" class="section-name selfRef">Network-provisioned resolvers</a>
        </h3>
<p id="section-3.1-1">DNS servers are often provisioned by a network as part of DHCP options <span>[<a href="#RFC2132" class="xref">RFC2132</a>]</span>,
IPv6 Router Advertisement (RA) options <span>[<a href="#RFC8106" class="xref">RFC8106</a>]</span>, Point-to-Point Protocol (PPP) <span>[<a href="#RFC1877" class="xref">RFC1877</a>]</span>,
3GPP Protocol Configuration Options, or another mechanism. Historically this is usually one or
more DNS resolver IP addresses, to be used for traditional unencrypted DNS. However it could also
be a richer set of information.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Using an encrypted and authenticated resolver that is associated to the one provisioned by the network
can provide several benefits that are not possible if only unencrypted DNS is used:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">Prevent other devices on the network from observing client DNS messages<a href="#section-3.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.2">Verify that answers come from the selected DNS resolver<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.3">Authenticate that the DNS resolver is the one provisioned by the network<a href="#section-3.1-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-4">Frequently, network-provisioned resolvers are forwarders running on a local router. The discovered
encrypted resolvers in these cases may either be local forwarders themselves, or an associated
resolver that is in the network (thus bypassing the router's DNS forwarder).<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">R2.1</td>
              <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
            </tr>
          </tbody>
        </table>
<div id="unencrypted-forwarder">
<section id="section-3.1.1">
          <h4 id="name-unencrypted-forwarder">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-unencrypted-forwarder" class="section-name selfRef">Unencrypted forwarder</a>
          </h4>
<p id="section-3.1.1-1">If the resolver announced by the network is a classic unencrypted forwarder, it is frequently the case that such
forwarders are difficult to upgrade to support encrypted operation. In such cases it is useful for the resolver
provider to be able to declare which encrypted resolvers they provide, and for the client to be able to discover
them. If the client wishes to, it can then use one of those resolvers and bypass the local forwarder.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-3">
            <caption><a href="#table-3" class="selfRef">Table 3</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">R3.1</td>
                <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="encrypted-forwarder">
<section id="section-3.1.2">
          <h4 id="name-encrypted-forwarder">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-encrypted-forwarder" class="section-name selfRef">Encrypted forwarder</a>
          </h4>
<p id="section-3.1.2-1">If a subset of local resolvers supports encrypted DNS, the client may not initially be aware that its local resolver
supports it. Discovering this may require communication with the local resolver, or an upstream resolver, over an
unencrypted transport. Once discovered, the local encrypted forwarder may be selected by the client, gaining the
benefits of encryption while retaining the benefits of a local caching forwarder with knowledge of the local topology.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">Another benefit occurs with IoT devices. A common usage pattern for such devices is for it to "call home"
to a service that resides on the public Internet, where that service is referenced through a domain name
(A or AAAA record). As discussed in Manufacturer Usage Description Specification <span>[<a href="#RFC8520" class="xref">RFC8520</a>]</span>, because these devices
tend to require access to very few sites, all other access should be considered suspect. However, if the query
is not accessible for inspection, it becomes quite difficult for the infrastructure to suspect anything.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<table class="center" id="table-4">
            <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">R4.1</td>
                <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="client-selected">
<section id="section-3.2">
        <h3 id="name-client-selected-resolvers">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-client-selected-resolvers" class="section-name selfRef">Client-selected resolvers</a>
        </h3>
<p id="section-3.2-1">Client devices often allow the device administrator to select a specific DNS resolver to use
on certain networks, or on all networks. Historically, this selection was specified only with an
IP address.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">Discovering which equivalent encrypted resolvers are offered by the same entity allows the client
to "upgrade" connections to use encrypted DNS.
This can provide several benefits:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-3.1">Prevent devices along the network path to the selected resolver from observing client DNS messages<a href="#section-3.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-3.2">Verify that answers come from the selected DNS resolver<a href="#section-3.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.2-3.3">Authenticate that the DNS resolver is the one selected by the client<a href="#section-3.2-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.2-4">In doing so it is critical that the new resolver is an equivalent resolver. Switching to a non-equivalent
alternative resolver would break the expectation of the user who previously selected that resolver.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<table class="center" id="table-5">
          <caption><a href="#table-5" class="selfRef">Table 5</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">R5.1</td>
              <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="vpn">
<section id="section-3.3">
        <h3 id="name-vpn-resolvers">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-vpn-resolvers" class="section-name selfRef">VPN resolvers</a>
        </h3>
<p id="section-3.3-1">Virtual Private Networks (VPNs) also can provision DNS resolvers. In addition to being able to use
DHCP or RAs, VPNs can provision DNS information in an explicit configuration message. For example,
IKEv2 can provision DNS servers using Configuration Attributes <span>[<a href="#RFC7296" class="xref">RFC7296</a>]</span>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">VPNs can also configure Split DNS rules to limit the use of the configured resolvers to specific domain
names <span>[<a href="#RFC8598" class="xref">RFC8598</a>]</span>.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">Discovering an encrypted resolver that is provisioned by a VPN can provide the same benefits
as doing so for a local network, but applied to the private network. When using Split DNS, it becomes
possible to use one encrypted resolver for private domains, and another for other domains.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<table class="center" id="table-6">
          <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">R6.1</td>
              <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="discovery-of-limited-domain-resolvers">
<section id="section-4">
      <h2 id="name-discovery-of-limited-domain">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-discovery-of-limited-domain" class="section-name selfRef">Discovery of limited domain resolvers</a>
      </h2>
<p id="section-4-1">Similar to how VPN DNS configurations can use Split DNS for private names, other network environments
can support resolution of names that are specific to the local environment. For example, an enterprise-managed
Wi-Fi network might be able to access both the Internet and a private intranet. In such a scenario, the private
domains managed by the enterprise might only be resolvable using a specific DNS resolver.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Discovering an encrypted resolver for a subset of names allows a client to perform Split DNS while maintaining
the benefits of encrypted DNS. For example, a client could use a client-selected encrypted resolver for public
domains, but use a different encrypted resolver for enterprise-private domains.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">Such domain-specific resolver discovery mechanisms additionally need to provide some information about
the applicability and capabilities of encrypted resolvers. This information can either be provisioned or
can be discovered based on clients actively trying to access content.<a href="#section-4-3" class="pilcrow">¶</a></p>
<table class="center" id="table-7">
        <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Requirement</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">R7.1</td>
            <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
          </tr>
        </tbody>
      </table>
<div id="discover-a-mapping-between-a-locally-hosted-domain-and-a-resolver">
<section id="section-4.1">
        <h3 id="name-discover-a-mapping-between-">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-discover-a-mapping-between-" class="section-name selfRef">Discover a mapping between a locally-hosted domain and a resolver</a>
        </h3>
<p id="section-4.1-1">Narrative required.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-8">
          <caption><a href="#table-8" class="selfRef">Table 8</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">R8.1</td>
              <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
            </tr>
          </tbody>
        </table>
<div id="local-content">
<section id="section-4.1.1">
          <h4 id="name-encrypted-resolvers-for-loc">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-encrypted-resolvers-for-loc" class="section-name selfRef">Encrypted resolvers for local or home content</a>
          </h4>
<p id="section-4.1.1-1">Accessing locally-hosted content can require the use of a specific resolver. For example, captive networks
or networks with walled-garden content like media on airplane Wi-Fi networks can rely on using a
resolver hosted on the local network.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">In cases where a client is using an encrypted resolver provisioned by a network, and that encrypted resolver
is able to resolve names of local content, this can fall into the use case described in <a href="#local-network" class="xref">Section 3.1</a>. However,
it might be necessary to discover a local encrypted resolver along with specific domains if:<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.1.1-3.1">the network-provisioned encrypted resolver is not able to resolve local-only names, or<a href="#section-4.1.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-4.1.1-3.2">the client has a more-preferred encrypted resolver for generic traffic, and would otherwise not be able to access local content<a href="#section-4.1.1-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-4.1.1-4">The first point can occur in a hybrid deployment, e.g. when the local resolver is unencrypted but a central one is encrypted.
Clients choosing the encrypted resolver for most queries will need to be advised to refer to the local one for some names.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">This case also include accessing content specific to a home network.<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<table class="center" id="table-9">
            <caption><a href="#table-9" class="selfRef">Table 9</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">R9.1</td>
                <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="locally-cached-content">
<section id="section-4.1.2">
          <h4 id="name-locally-cached-content">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-locally-cached-content" class="section-name selfRef">Locally-cached content</a>
          </h4>
<p id="section-4.1.2-1">Narrative required.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<table class="center" id="table-10">
            <caption><a href="#table-10" class="selfRef">Table 10</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">R10.1</td>
                <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
<div id="private-enterprise-names">
<section id="section-4.1.3">
          <h4 id="name-private-enterprise-names">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-private-enterprise-names" class="section-name selfRef">Private enterprise names</a>
          </h4>
<p id="section-4.1.3-1">As stated above, an enterprise-managed Wi-Fi network might be able to access both the Internet and a private
intranet. The private domains managed by the enterprise might only be resolvable using a specific DNS resolver,
hence use of that resolver is essential for such domains. However it does not necessarily mean that all queries
for all domains have to flow through that resolver.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
<p id="section-4.1.3-2">Only sending the necessary queries through the enterprise resolver, and not generic Internet queries, has the privacy
benefit of only exposing traffic to the enterprise that fall within a limited set of domains.<a href="#section-4.1.3-2" class="pilcrow">¶</a></p>
<p id="section-4.1.3-3">Using encrypted DNS for private names also opens up the possibility of doing private name resolution outside
of the content of a VPN or managed network. If the DNS resolver authenticates clients, it can offer its resolver
for private names on a publicly accessible server, while still limiting the visibility of the DNS traffic.<a href="#section-4.1.3-3" class="pilcrow">¶</a></p>
<table class="center" id="table-11">
            <caption><a href="#table-11" class="selfRef">Table 11</a></caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Requirement</th>
                <th class="text-left" rowspan="1" colspan="1">Description</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">R11.1</td>
                <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
              </tr>
            </tbody>
          </table>
</section>
</div>
</section>
</div>
<div id="cdn-content">
<section id="section-4.2">
        <h3 id="name-encrypted-resolvers-for-con">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-encrypted-resolvers-for-con" class="section-name selfRef">Encrypted resolvers for content providers</a>
        </h3>
<p id="section-4.2-1">Content Delivery Networks (CDNs), and content-providers more broadly, can also provide encrypted DNS resolvers that can
be used by clients over the public Internet. These resolvers can either allow resolution of all public names (like
normal recursive resolvers), or be designed to serve a subset of names managed by the content provider (like an
authoritative resolver). Using these resolvers can allow the content provider to directly control how DNS answers are
used for load balancing and address selection, which could improve performance of connections to the content provider.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Using a content-provider's encrypted resolver can also provide several privacy and security benefits:<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-3.1">Prevent devices along the network path to the content-provider's resolver from observing client DNS messages<a href="#section-4.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-3.2">Verify that answers come from the entity that manages the domains being resolved<a href="#section-4.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-3.3">Reduce the number of entities able to monitor the specific names accessed by a client to only the client and the content provider, assuming that the content provider would already see the names upon a secure connection later being made based on the DNS answers (e.g., in the TLS SNI extension)<a href="#section-4.2-3.3" class="pilcrow">¶</a>
</li>
        </ul>
<table class="center" id="table-12">
          <caption><a href="#table-12" class="selfRef">Table 12</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Requirement</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">R12.1</td>
              <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="priv-sec">
<section id="section-5">
      <h2 id="name-privacy-and-security-requir">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-privacy-and-security-requir" class="section-name selfRef">Privacy and security requirements</a>
      </h2>
<p id="section-5-1">Encrypted (and authenticated) DNS improves the privacy and security of DNS queries and answers in the presence of malicious
attackers. Such attackers are assumed to interfere with or otherwise impede DNS traffic and corresponding
discovery mechanisms. They may be on-path or off-path between the client and entities with which the client
communicates <span>[<a href="#RFC3552" class="xref">RFC3552</a>]</span>. These attackers can inject, tamper, or otherwise interfere with traffic as needed.
Given these capabilities, an attacker may have a variety of goals, including, though not limited to:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">Monitor and profile clients by observing unencrypted DNS traffic<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-2.2">Modify unencrypted DNS traffic to filter or augment the user experience<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-2.3">Block encrypted DNS<a href="#section-5-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-3">Clients cannot assume that their network does not have such an attacker unless given some means of authenticating or otherwise
trusting the communication with their DNS resolver.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Given this type of attacker, resolver discovery mechanisms must be designed carefully to not worsen a client's security or
privacy posture. In particular, attackers must not be able to:<a href="#section-5-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-5.1">Redirect secure DNS traffic to themselves when they would not otherwise handle DNS traffic.<a href="#section-5-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.2">Override or interfere with the resolver preferences of a user or administrator.<a href="#section-5-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.3">Cause clients to use a discovered resolver which has no authenticated delegation from a client-known entity.<a href="#section-5-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-5.4">Influence automatic discovery mechanisms such that a client uses one or more resolvers that are not
otherwise involved with providing service to the client, such as: a network provider, a VPN server, a
content provider being accessed, or a server that the client has manually configured.<a href="#section-5-5.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-6">Beyond these requirements, standards describing resolver discovery mechanisms must not place any requirements
on clients to select particular resolvers over others.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">When discovering DNS resolvers on a local network, clients have no mechanism to distinguish between cases 
where an active attacker with the above capabilities is interfering with discovery, and situations wherein 
the network has no encrypted resolver. Absent such a mechanism, an attacker can always succeed in these
goals. Therefore, in such circumstances, viable solutions for local DNS resolver discovery should consider 
weaker attackers, such as those with only passive eavesdropping capabilities. It is unknown whether such
relaxations represent a realistic attacker in practice. Thus, local discovery solutions designed around
this threat model may have limited value.<a href="#section-5-7" class="pilcrow">¶</a></p>
<div id="on-opportunistic-encryption">
<section id="section-5.1">
        <h3 id="name-on-opportunistic-encryption">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-on-opportunistic-encryption" class="section-name selfRef">On opportunistic encryption</a>
        </h3>
<p id="section-5.1-1">Opportunistic encrypted DNS, when the client cannot authenticate the entity that provides encrypted DNS, does
not meet the requirements laid out here for resolver discovery. While opportunistic encryption can provide some
benefits, specifically in reducing the ability for other entities to observe traffic, it is not a viable solution
against an on-path attacker.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">Performing opportunistic encrypted DNS does not require specific discovery mechanisms. Section 4.1 of <span>[<a href="#RFC7858" class="xref">RFC7858</a>]</span>
already describes how to use DNS-over-TLS opportunistically.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="handling-exceptions-and-failures">
<section id="section-5.2">
        <h3 id="name-handling-exceptions-and-fai">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-handling-exceptions-and-fai" class="section-name selfRef">Handling exceptions and failures</a>
        </h3>
<p id="section-5.2-1">Even with encrypted DNS resolver discovery in place, clients must be prepared to handle certain scenarios where encrypted DNS
cannot be used. In these scenarios, clients must consider if it is appropriate to fail open by sending the DNS queries without
encryption, fail closed by not doing so, or presenting a choice to a user or administrator. The exact behavior is a
local client policy decision.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Some networks that use Captive Portals will not allow any Internet connectivity until a client has interacted with the portal
<span>[<a href="#I-D.ietf-capport-architecture" class="xref">I-D.ietf-capport-architecture</a>]</span>. If these networks do not use encrypted DNS for their own resolution, a client will need to perform
unencrypted DNS queries in order to get out of captivity. Many operating systems have specific client code responsible for detecting
and interacting with Captive Portals; these system components may be good candidates for failing open, since they do not generally
represent user traffic.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">Other networks may not allow any use of encrypted DNS, or any use of encrypted DNS to resolvers other than a network-provisioned
resolver. Clients should not silently fail open in these cases, but if these networks are trusted by or administered by the user, the user
may want to specifically follow the network's DNS policy instead of what the client would do on an unknown or untrusted network.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="requirements-summary">
<section id="section-6">
      <h2 id="name-requirements-summary">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-requirements-summary" class="section-name selfRef">Requirements Summary</a>
      </h2>
<p id="section-6-1">This sections lists the complete set of requirements described above, for ease of reference.<a href="#section-6-1" class="pilcrow">¶</a></p>
<table class="center" id="table-13">
        <caption><a href="#table-13" class="selfRef">Table 13</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Requirement</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">R1.1</td>
            <td class="text-left" rowspan="1" colspan="1">There must be a mechanism for a client to learn the set of encrypted resolvers that are associated with a resolver that is known only by its IP address.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">R1.2</td>
            <td class="text-left" rowspan="1" colspan="1">Discovery must be possible even when the IP address is only valid locally.</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">R1.3</td>
            <td class="text-left" rowspan="1" colspan="1">More to be added</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">R2.1</td>
            <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">R3.1</td>
            <td class="text-left" rowspan="1" colspan="1">Example requirement</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">All security considerations relevant to a particular use case are described under that section.
Additional considerations common to all of them are described in <a href="#priv-sec" class="xref">Section 5</a>.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-capport-architecture">[I-D.ietf-capport-architecture]</dt>
        <dd>
<span class="refAuthor">Larose, K.</span><span class="refAuthor">, Dolson, D.</span><span class="refAuthor">, and H. Liu</span>, <span class="refTitle">"Captive Portal Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-capport-architecture-09</span>, <time datetime="2020-08-08" class="refDate">August 8, 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-capport-architecture-09.txt">http://www.ietf.org/internet-drafts/draft-ietf-capport-architecture-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-dprive-dnsoquic">[I-D.ietf-dprive-dnsoquic]</dt>
        <dd>
<span class="refAuthor">Huitema, C.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, and S. Dickinson</span>, <span class="refTitle">"Specification of DNS over Dedicated QUIC Connections"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-dprive-dnsoquic-00</span>, <time datetime="2020-04-27" class="refDate">April 27, 2020</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dprive-dnsoquic-00.txt">http://www.ietf.org/internet-drafts/draft-ietf-dprive-dnsoquic-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1877">[RFC1877]</dt>
        <dd>
<span class="refAuthor">Cobb, S.</span>, <span class="refTitle">"PPP Internet Protocol Control Protocol Extensions for Name Server Addresses"</span>, <span class="seriesInfo">RFC 1877</span>, <span class="seriesInfo">DOI 10.17487/RFC1877</span>, <time datetime="1995-12" class="refDate">December 1995</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1877">https://www.rfc-editor.org/info/rfc1877</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2132">[RFC2132]</dt>
        <dd>
<span class="refAuthor">Alexander, S.</span><span class="refAuthor"> and R. Droms</span>, <span class="refTitle">"DHCP Options and BOOTP Vendor Extensions"</span>, <span class="seriesInfo">RFC 2132</span>, <span class="seriesInfo">DOI 10.17487/RFC2132</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2132">https://www.rfc-editor.org/info/rfc2132</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3552">[RFC3552]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span><span class="refAuthor"> and B. Korver</span>, <span class="refTitle">"Guidelines for Writing RFC Text on Security Considerations"</span>, <span class="seriesInfo">BCP 72</span>, <span class="seriesInfo">RFC 3552</span>, <span class="seriesInfo">DOI 10.17487/RFC3552</span>, <time datetime="2003-07" class="refDate">July 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3552">https://www.rfc-editor.org/info/rfc3552</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span><span class="refAuthor">, Hoffman, P.</span><span class="refAuthor">, Nir, Y.</span><span class="refAuthor">, Eronen, P.</span><span class="refAuthor">, and T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7858">[RFC7858]</dt>
        <dd>
<span class="refAuthor">Hu, Z.</span><span class="refAuthor">, Zhu, L.</span><span class="refAuthor">, Heidemann, J.</span><span class="refAuthor">, Mankin, A.</span><span class="refAuthor">, Wessels, D.</span><span class="refAuthor">, and P. Hoffman</span>, <span class="refTitle">"Specification for DNS over Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 7858</span>, <span class="seriesInfo">DOI 10.17487/RFC7858</span>, <time datetime="2016-05" class="refDate">May 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7858">https://www.rfc-editor.org/info/rfc7858</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8106">[RFC8106]</dt>
        <dd>
<span class="refAuthor">Jeong, J.</span><span class="refAuthor">, Park, S.</span><span class="refAuthor">, Beloeil, L.</span><span class="refAuthor">, and S. Madanapalli</span>, <span class="refTitle">"IPv6 Router Advertisement Options for DNS Configuration"</span>, <span class="seriesInfo">RFC 8106</span>, <span class="seriesInfo">DOI 10.17487/RFC8106</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8106">https://www.rfc-editor.org/info/rfc8106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8484">[RFC8484]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span><span class="refAuthor"> and P. McManus</span>, <span class="refTitle">"DNS Queries over HTTPS (DoH)"</span>, <span class="seriesInfo">RFC 8484</span>, <span class="seriesInfo">DOI 10.17487/RFC8484</span>, <time datetime="2018-10" class="refDate">October 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8484">https://www.rfc-editor.org/info/rfc8484</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8520">[RFC8520]</dt>
        <dd>
<span class="refAuthor">Lear, E.</span><span class="refAuthor">, Droms, R.</span><span class="refAuthor">, and D. Romascanu</span>, <span class="refTitle">"Manufacturer Usage Description Specification"</span>, <span class="seriesInfo">RFC 8520</span>, <span class="seriesInfo">DOI 10.17487/RFC8520</span>, <time datetime="2019-03" class="refDate">March 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8520">https://www.rfc-editor.org/info/rfc8520</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8598">[RFC8598]</dt>
      <dd>
<span class="refAuthor">Pauly, T.</span><span class="refAuthor"> and P. Wouters</span>, <span class="refTitle">"Split DNS Configuration for the Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">RFC 8598</span>, <span class="seriesInfo">DOI 10.17487/RFC8598</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8598">https://www.rfc-editor.org/info/rfc8598</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgments">
<section id="section-appendix.a">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-appendix.a-1">This document was started based on contributions during the ADD meeting of IETF108, on the list, and
from draft-pauly-add-requirements.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">More contributions are required! Please consider starting a github issue, submit a pull request, or simply
raise the topic on the ADD list.<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chris Box</span></div>
<div dir="auto" class="left"><span class="org">BT</span></div>
<div dir="auto" class="left"><span class="street-address">2000 Park Avenue</span></div>
<div dir="auto" class="left"><span class="locality">Bristol</span></div>
<div dir="auto" class="left"><span class="country-name">United Kingdom</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chris.box@bt.com" class="email">chris.box@bt.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tommy Pauly</span></div>
<div dir="auto" class="left"><span class="org">Apple</span></div>
<div dir="auto" class="left"><span class="street-address">One Apple Park Way</span></div>
<div dir="auto" class="left">
<span class="locality">Cupertino, California 95014</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tpauly@apple.com" class="email">tpauly@apple.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christopher A. Wood</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:caw@heapingbits.net" class="email">caw@heapingbits.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tirumaleswar Reddy</span></div>
<div dir="auto" class="left"><span class="org">McAfee</span></div>
<div dir="auto" class="left"><span class="street-address">Embassy Golf Link Business Park</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> </div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:TirumaleswarReddy_Konda@McAfee.com" class="email">TirumaleswarReddy_Konda@McAfee.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
