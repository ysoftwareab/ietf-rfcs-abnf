<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The RPKI/Router Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The RPKI/Router Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">R. Bush</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">IIJ</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">R. Austein</td></tr>
<tr><td class="header">Expires: October 22, 2009</td><td class="header">ISC</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">April 20, 2009</td></tr>
</table></td></tr></table>
<h1><br />The RPKI/Router Protocol<br />draft-ymbk-rpki-rtr-protocol-03</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may not be modified, and derivative works of it may
not be created, and it may not be published except as an Internet-Draft.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on October 22, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>In order to formally validate the origin ASes of BGP
        announcements, routers need a simple but reliable mechanism to
        receive RPKI <a class='info' href='#I-D.ietf-sidr-arch'>[I&#8209;D.ietf&#8209;sidr&#8209;arch]<span> (</span><span class='info'>Lepinski, M. and S. Kent, &ldquo;An Infrastructure to Support Secure Internet Routing,&rdquo; March&nbsp;2009.</span><span>)</span></a> or analogous
        prefix origin data from a trusted cache.  This document
        describes a protocol to deliver validated prefix origin data to
        routers over ssh.
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
        NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
        "OPTIONAL" in this document are to be interpreted as described
        in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#Intro">1.</a>&nbsp;
Introduction<br />
<a href="#Struct">2.</a>&nbsp;
Deployment Structure<br />
<a href="#OpOvr">3.</a>&nbsp;
Operational Overview<br />
<a href="#pdus">4.</a>&nbsp;
Protocol Data Units (PDUs)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#notify">4.1.</a>&nbsp;
Serial Notify<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#serialquery">4.2.</a>&nbsp;
Serial Query<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#resetquery">4.3.</a>&nbsp;
Reset Query<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#cacheresponse">4.4.</a>&nbsp;
Cache Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ipv4">4.5.</a>&nbsp;
IPv4 Prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ipv6">4.6.</a>&nbsp;
IPv6 Prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#eod">4.7.</a>&nbsp;
End of Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#cachereset">4.8.</a>&nbsp;
Cache Reset<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#error">4.9.</a>&nbsp;
Error Report<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fields">4.10.</a>&nbsp;
Fields of a PDU<br />
<a href="#protocol">5.</a>&nbsp;
Protocol Sequences<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#start">5.1.</a>&nbsp;
Start or Restart<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#query">5.2.</a>&nbsp;
Typical Exchange<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#nodiff">5.3.</a>&nbsp;
No Incremental Update Available <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#nodata">5.4.</a>&nbsp;
Cache has No Data Available<br />
<a href="#Transport">6.</a>&nbsp;
SSH Transport<br />
<a href="#Setup">7.</a>&nbsp;
Router-Cache Set-Up<br />
<a href="#Scenarios">8.</a>&nbsp;
Deployment Scenarios<br />
<a href="#errorcodes">9.</a>&nbsp;
Error Codes<br />
<a href="#Security">10.</a>&nbsp;
Security Considerations<br />
<a href="#Glossary">11.</a>&nbsp;
Glossary<br />
<a href="#IANA">12.</a>&nbsp;
IANA Considerations<br />
<a href="#Acknowledgments">13.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">14.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">14.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">14.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="Intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>In order to formally validate the origin ASes of BGP
        announcements, routers need a simple but reliable mechanism to
        receive RPKI <a class='info' href='#I-D.ietf-sidr-arch'>[I&#8209;D.ietf&#8209;sidr&#8209;arch]<span> (</span><span class='info'>Lepinski, M. and S. Kent, &ldquo;An Infrastructure to Support Secure Internet Routing,&rdquo; March&nbsp;2009.</span><span>)</span></a> or analogous
        formally validated prefix origin data from a trusted cache.
        This document describes a protocol to deliver validated prefix
        origin data to routers over ssh.
</p>
<p> <a class='info' href='#Struct'>Section&nbsp;2<span> (</span><span class='info'>Deployment Structure</span><span>)</span></a> describes the deployment structure and
        <a class='info' href='#OpOvr'>Section&nbsp;3<span> (</span><span class='info'>Operational Overview</span><span>)</span></a> then presents an operational overview.
        The binary payloads of the protocol are formally described in
        <a class='info' href='#pdus'>Section&nbsp;4<span> (</span><span class='info'>Protocol Data Units (PDUs)</span><span>)</span></a>, and the expected PDU sequences are
        described in <a class='info' href='#protocol'>Section&nbsp;5<span> (</span><span class='info'>Protocol Sequences</span><span>)</span></a>.  And the transport
        protocol is described in <a class='info' href='#Transport'>Section&nbsp;6<span> (</span><span class='info'>SSH Transport</span><span>)</span></a>.
        <a class='info' href='#Setup'>Section&nbsp;7<span> (</span><span class='info'>Router-Cache Set-Up</span><span>)</span></a> details how routers and caches are
        configured to connect and authenticate.
        <a class='info' href='#Scenarios'>Section&nbsp;8<span> (</span><span class='info'>Deployment Scenarios</span><span>)</span></a> describes likely deployment
        scenarios.  The traditional security and IANA considerations end
        the document.
</p>
<a name="Struct"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Deployment Structure</h3>

<p>Deployment of the RPKI to reach routers has a three level
        structure as follows:
      </p>
<blockquote class="text"><dl>
<dt>Global RPKI:</dt>
<dd>
          The authoritative data of the RPKI are published in a
          distributed set of servers, RPKI publication repositories,
          e.g. the IANA, RIRs, NIRs, and ISPs, see
          <a class='info' href='#I-D.ietf-sidr-repos-struct'>[I&#8209;D.ietf&#8209;sidr&#8209;repos&#8209;struct]<span> (</span><span class='info'>Huston, G., Loomans, R., and G. Michaelson, &ldquo;A Profile for Resource Certificate Repository Structure,&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</dd>
<dt>Local Caches:</dt>
<dd>
          A local set of one or more collected and verified
          non-authoritative caches.  A relying party, e.g. router or other
          client, MUST have a formally authenticated trust relationship
          with, and a secure transport channel to, any non-authoritative
          cache(s) it uses.
</dd>
<dt>Routers:</dt>
<dd>
          A router fetches data from a local cache using the protocol
          described in this document.  It is said to be a client of the
          cache.  There are mechanisms for the router to assure itself
          of the authenticity of the cache and to authenticate itself to
          the cache.
</dd>
</dl></blockquote>

<a name="OpOvr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Operational Overview</h3>

<p>A router establishes and keeps open an authenticated connection
        to a cache with which it has an client/server relationship.  It
        is configured with a semi-ordered list of caches, and
        establishes a connection to the highest preference cache that
        accepts one.
</p>
<p>Periodically, the router sends to the cache the serial number
        of the highest numbered data record it has received from that
        cache, i.e. the router's current serial number.  When a router
        establishes a new connection to a cache, or wishes to reset a
        current relationship, it sends a Reset Query.
</p>
<p>The Cache responds with all data records which have serial
        numbers greater than that in the router's query.  This may be
        the null set, in which case the End of Data PDU is still sent.
        Note that 'greater' must take wrap-around into account,
        see <a class='info' href='#RFC1982'>[RFC1982]<span> (</span><span class='info'>Elz, R. and R. Bush, &ldquo;Serial Number Arithmetic,&rdquo; August&nbsp;1996.</span><span>)</span></a>.
</p>
<p>When the router has received all data records from the cache,
        it sets its current serial number to that of the serial number
        in the End of Data PDU.
</p>
<p>When the cache updates its database, it sends a Notify
        message to every currently connected router.  This is a hint
        that now would be a good time for the router to poll for an
        update, but is only a hint.  The protocol requires the router
        to poll for updates periodically in any case.
</p>
<p>Strictly speaking, a router could track a cache simply by
        asking for a complete data set every time it updates, but this
        would be very inefficient.  The serial number based
        incremental update mechanism allows an efficient transfer of
        just the data records which have changed since last update.
        As with any update protocol based on incremental transfers,
        the router must be prepared to fall back to a full transfer if
        for any reason the cache is unable to provide the necessary
        incremental data.  Unlike some incremental transfer protocols,
        this protocol requires the router to make an explicit request
        to start the fallback process; this is deliberate, as the
        cache has no way of knowing whether the router has also
        established sessions with other caches that may be able to
        provide better service.
</p>
<a name="pdus"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Data Units (PDUs)</h3>

<p>The exchanges between the cache and the router are sequences of
        exchanges of the following PDUs according to the rules described
        in <a class='info' href='#protocol'>Section&nbsp;5<span> (</span><span class='info'>Protocol Sequences</span><span>)</span></a>.
</p>
<a name="notify"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Serial Notify</h3>

<p>The cache notifies the router that the cache has new
          data.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |   reserved = zero   |
|    0     |    0     |                     |
+-------------------------------------------+
|                                           |
|               Serial Number               |
|                                           |
`-------------------------------------------'
</pre></div>
<a name="serialquery"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Serial Query</h3>

<p>Serial Query: The router sends Serial Query to ask the cache
          for all payload PDUs which have serial numbers higher than the
          serial number in the Serial Query.
</p>
<p>The cache replys to this query with a Cache
        Response PDU (<a class='info' href='#cacheresponse'>Section&nbsp;4.4<span> (</span><span class='info'>Cache Response</span><span>)</span></a>)
	if the cache has a record of the changes since the
        serial number specified by the router; otherwise, the cache
        responds with a Cache Reset PDU (<a class='info' href='#cachereset'>Section&nbsp;4.8<span> (</span><span class='info'>Cache Reset</span><span>)</span></a>).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |   reserved = zero   |
|    0     |    1     |                     |
+-------------------------------------------+
|                                           |
|               Serial Number               |
|                                           |
`-------------------------------------------'
</pre></div>
<a name="resetquery"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Reset Query</h3>

<p>Reset Query: The router tells the cache that it wants to
          receive the total active, current, non-withdrawn, database.
          The cache responds with a Cache Response PDU
	  (<a class='info' href='#cacheresponse'>Section&nbsp;4.4<span> (</span><span class='info'>Cache Response</span><span>)</span></a>).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |    reserved = zero  |
|    0     |    2     |                     |
`-------------------------------------------'
</pre></div>
<a name="cacheresponse"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Cache Response</h3>

<p>Cache Response: The cache responds with zero or more
          payload PDUs.  When replying to a Serial Query request
          (<a class='info' href='#serialquery'>Section&nbsp;4.2<span> (</span><span class='info'>Serial Query</span><span>)</span></a>), the cache sends the set of
          all data records it has with serial numbers greater than
          that sent by the client router.  When replying to a Reset
          Query, the cache sends the set of all data records it has;
          in this case the announce/withdraw field in the payload PDUs
          MUST have the value 1 (announce).
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |   reserved = zero   |
|    0     |    3     |                     |
`-------------------------------------------'
</pre></div>
<a name="ipv4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
IPv4 Prefix</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |        Color        |
|    0     |    4     |                     |
+-------------------------------------------+
| Announce |  Prefix  |   Max    |  Data    |
| Withdraw |  Length  |  Length  |  Source  |
|   0/1    |   0..32  |   0..32  | RPKI/IRR |
+-------------------------------------------+
|                                           |
|                IPv4 prefix                |
|                                           |
+-------------------------------------------+
|                                           |
|         Autonomous System Number          |
|                                           |
`-------------------------------------------'
</pre></div>
<p>Due to the nature of the RPKI and the IRR, there can be
          multiple identical IPvX PDUs.  Hence the router will likely
          keep an internal ref-count on each IPvX PDU.
</p>
<p>In the RPKI, nothing prevents a signing certificate from
	  issuing two identical ROAs, and nothing prohibits the
	  existence of two identical route: or route6: objects in the
	  IRR.  In this case there would be no semantic difference
	  between the objects, merely a process redundancy.
</p>
<p>In the RPKI, there is also an actual need for what will
	  appear to the router as identical IPvX PDUs.  This occurs when
	  an upstream certificate is being reissued or a site is
	  changing providers, often a 'make and break' situation.  The
	  ROA is identical in the router sense, i.e. has the same
	  {prefix, len, max-len, asn}, but has a different validation
	  path in the RPKI.  This is important to the RPKI, but not to
	  the router.
</p>
<a name="ipv6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
IPv6 Prefix</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |        Color        |
|    0     |    6     |                     |
+-------------------------------------------+
| Announce |  Prefix  |   Max    |  Data    |
| Withdraw |  Length  |  Length  |  Source  |
|   0/1    |  0..128  |  0..128  | RPKI/IRR |
+-------------------------------------------+
|                                           |
+---                                     ---+
|                                           |
+---            IPv6 prefix              ---+
|                                           |
+---                                     ---+
|                                           |
+-------------------------------------------+
|                                           |
|         Autonomous System Number          |
|                                           |
`-------------------------------------------'
</pre></div>
<a name="eod"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
End of Data</h3>

<p>End of Data: Cache tells router it has no more data for the
          request.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |   reserved = zero   |
|    0     |    7     |                     |
+-------------------------------------------+
|                                           |
|               Serial Number               |
|                                           |
`-------------------------------------------'
</pre></div>
<a name="cachereset"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.8"></a><h3>4.8.&nbsp;
Cache Reset</h3>

<p>The cache may respond to a Serial Query informing the router
          that the cache cannot provide an incremental update
          starting from the serial number specified by the router.
          The router must decide whether to issue a Reset Query or
          switch to a different cache.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |    reserved = zero  |
|    0     |    8     |                     |
`-------------------------------------------'
</pre></div>
<a name="error"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.9"></a><h3>4.9.&nbsp;
Error Report</h3>

<p>This PDU is used by either party to report an error to the
          other.
</p>
<p>If the error is not associated with any particular PDU, the
	  Erroneous PDU field should be empty and the Length of
	  Encapsulated PDU field should be zero.
</p>
<p>The diagnostic text is optional, if not present the Length
	  of Error Text field should be zero.  If error text is
	  present, it SHOULD be a string in US-ASCII, for maximum
	  portability; if non-US-ASCII characters are absolutely
	  required, the error text MUST use UTF-8 encoding.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0          8          16         24        31
.-------------------------------------------.
| Protocol |   PDU    |                     |
| Version  |   Type   |    Error Number     |
|    0     |    10    |                     |
+-------------------------------------------+
|      Length of      |     Length of       |
|     Encapsulated    |       Error         |
|         PDU         |       Text          |
+-------------------------------------------+
|                                           |
~           Copy of Erroneous PDU           ~
|                                           |
+-------------------------------------------+
|                                           |
|              Arbitrary Text               |
|                    of                     |
~          Error Diagnostic Message         ~
|                                           |
`-------------------------------------------'
</pre></div>
<a name="fields"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.10"></a><h3>4.10.&nbsp;
Fields of a PDU</h3>

<p>PDUs contain the following data elements:
        </p>
<blockquote class="text"><dl>
<dt>Protocol Version:</dt>
<dd>
            A cardinal, currently 0, denoting the version of this
            protocol.
</dd>
<dt>Serial Number:</dt>
<dd>
            The serial number of the RPKI Cache when this ROA was
            received from the cache's up-stream cache server or gathered
            from the global RPKI.  A cache increments its serial number
            when completing an rcynic from a parent cache.
            See <a class='info' href='#RFC1982'>[RFC1982]<span> (</span><span class='info'>Elz, R. and R. Bush, &ldquo;Serial Number Arithmetic,&rdquo; August&nbsp;1996.</span><span>)</span></a> on DNS Serial Number
            Arithmetic for too much detail on serial number
            arithmetic.
</dd>
<dt>Color:</dt>
<dd>
            An arbitrary 16 bit field that might be used in some
            way.
</dd>
<dt>Announce/Withdraw:</dt>
<dd>
            Whether this PDU announces a new right to announce the
            prefix or withdraws a previously announced right.  The
            allowed values are 0 for withdraw and 1 for announce.
            A withdraw effectively deletes all previously announced
            IPvX Prefix PDUs with the exact same Prefix, Length,
            Max-Len, ASN, Data Source, and Color.
</dd>
<dt>Prefix Length:</dt>
<dd>
            A cardinal denoting the shortest prefix allowed for the
            prefix.
</dd>
<dt>Max Length:</dt>
<dd>
            A cardinal denoting the longest prefix allowed by the
            prefix.  This MUST NOT be less than the Prefix Length
            element.
</dd>
<dt>Data Source:</dt>
<dd>
            A cardinal denoting the source of the data, e.g. for RPKI
            data, it is 0, for IRR data it is 1.
</dd>
<dt>Prefix:</dt>
<dd>
            The IPv4 or IPv6 prefix of the ROA.
</dd>
<dt>Autonomous System Number:</dt>
<dd>
            ASN allowed to announce this prefix, a 32 bit cardinal.
</dd>
</dl></blockquote>

<a name="protocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Protocol Sequences</h3>

<p>The sequences of PDU transmissions fall into three
        conversations as follows:
</p>
<a name="start"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Start or Restart</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Cache                         Router
  ~                             ~
  | &lt;----- Reset Query -------- | R requests data
  |                             |
  | ----- Cache Response -----&gt; | C confirms request
  | ------- IPvX Prefix ------&gt; | C sends zero or more
  | ------- IPvX Prefix ------&gt; |   IPv4 and IPv6 Prefix
  | ------- IPvX Prefix ------&gt; |   Payload PDUs
  | ------  End of Data ------&gt; | C sends End of Data
  |                             |   and sends new serial
  ~                             ~
</pre></div>
<p>When a transport session is first established, the router
          sends a Reset Query and the cache responds with a data
          sequence of all data it contains.
</p>
<p>This Reset Query sequence is also used when the router
          receives a Cache Reset, chooses a new cache, or fears that
          it has otherwise lost its way.
</p>
<p>To limit the length of time a cache must keep the data
	  necessary to generate incremental updates, a router MUST
	  send either a Serial Query or a Reset Query no less
	  frequently than once an hour.  This also acts as a keep
	  alive at the application layer.
</p>
<a name="query"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Typical Exchange</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Cache                         Router
  ~                             ~
  | -------- Notify ----------&gt; |  (optional)
  |                             |
  | &lt;----- Serial Query ------- | R requests data
  |                             |
  | ----- Cache Response -----&gt; | C confirms request
  | ------- IPvX Prefix ------&gt; | C sends zero or more
  | ------- IPvX Prefix ------&gt; |   IPv4 and IPv6 Prefix
  | ------- IPvX Prefix ------&gt; |   Payload PDUs
  | ------  End of Data ------&gt; | C sends End of Data
  |                             |   and sends new serial
  ~                             ~
</pre></div>
<p>The cache server SHOULD send a notify PDU with its current
          serial number when the cache's serial changes, with the
          expectation that the router MAY then issue a serial query
          earlier than it otherwise might.  This is analogous to DNS
          NOTIFY in <a class='info' href='#RFC1996'>[RFC1996]<span> (</span><span class='info'>Vixie, P., &ldquo;A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY),&rdquo; August&nbsp;1996.</span><span>)</span></a>.  The cache SHOULD
          rate limit Serial Notifies to no more frequently than one per
          minute.
</p>
<p>When the transport layer is up and either a timer has gone
          off in the router, or the cache has sent a Notify, the router
          queries for new data by sending a Serial Query, and the cache
          sends all data newer than the serial in the Serial Query.
</p>
<p>To limit the length of time a cache must keep old withdraws, a
          router MUST send either a Serial Query or a Reset Query no
          less frequently than once an hour.
</p>
<a name="nodiff"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
No Incremental Update Available </h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Cache                         Router
  ~                             ~
  | &lt;-----  Serial Query ------ | R requests data
  | ------- Cache Reset ------&gt; | C cannot supply update
  |                             |   from specified serial
  | &lt;------ Reset Query ------- | R requests new data
  | ----- Cache Response -----&gt; | C confirms request
  | ------- IPvX Prefix ------&gt; | C sends zero or more
  | ------- IPvX Prefix ------&gt; |   IPv4 and IPv6 Prefix
  | ------- IPvX Prefix ------&gt; |   Payload PDUs
  | ------  End of Data ------&gt; | C sends End of Data
  |                             |   and sends new serial
  ~                             ~
</pre></div>
<p>The cache may respond to a Serial Query with a Cache Reset,
          informing the router that the cache cannot supply an
          incremental update from the serial number specified by the
          router.  This might be because the cache has lost state, or
          because the router has waited too long between polls and the
          cache has cleaned up old data that it no longer believes it
          needs, or because the cache has run out of storage space and
          had to expire some old data early.  Regardless of how this
          state arose, the cache replies with a Cache Reset to tell
          the router that it cannot honor the request.  When a router
          receives this, the router SHOULD attempt to connect to any
          more preferred caches in its cache list.  If there are no
          more preferred caches it MUST issue a Reset Query and get an
          entire new load from the cache
</p>
<a name="nodata"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Cache has No Data Available</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Cache                         Router
  ~                             ~
  | &lt;-----  Serial Query ------ | R requests data
  | ---- Error Report PDU ----&gt; | C cannot supply update
  ~                             ~

Cache                         Router
  ~                             ~
  | &lt;-----  Reset Query ------- | R requests data
  | ---- Error Report PDU ----&gt; | C cannot supply update
  ~                             ~
</pre></div>
<p>The cache may respond to either a Serial Query or a Reset
	  Query informing the router that the cache cannot supply any
	  update at all.  The most likely cause is that the cache has
	  lost state, perhaps due to a restart, and has not yet
	  recovered.  While it is possible that a cache might go into
	  such a state without dropping any of its active sessions,
	  a router is more likely to see this behavior when it
	  initially connects and issues a Reset Query while the cache
	  is still rebuilding its database.
</p>
<p>When a router receives this kind of error, the router
          SHOULD attempt to connect to any other caches in its cache
          list, in preference order.  If no other caches are
          available, the router MUST issue periodic Reset Queries
          until it gets a new usable load from the cache
</p>
<a name="Transport"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
SSH Transport</h3>

<p>The transport layer session between a router and a cache
        carries the binary Protocol Data Units (PDUs) in a persistent
        SSH session.
</p>
<p>To run over SSH, the client router first establishes an SSH
	transport connection using the SSH transport protocol, and the
	client and server exchange keys for message integrity and
	encryption.  The client then invokes the "ssh-userauth" service
	to authenticate the application, as described in the SSH
	authentication protocol <a class='info' href='#RFC4252'>RFC 4252<span> (</span><span class='info'>Ylonen, T. and C. Lonvick, &ldquo;The Secure Shell (SSH) Authentication Protocol,&rdquo; January&nbsp;2006.</span><span>)</span></a> [RFC4252].
	Once the application has been successfully authenticated, the
	client invokes the "ssh-connection" service, also known as the
	SSH connection protocol.
</p>
<p>After the ssh-connection service is established, the client
    	opens a channel of type "session", which results in an SSH
    	session.
</p>
<p>Once the SSH session has been established, the application
	invokes the application transport as an SSH subsystem called
	"rpki-rtr".  Subsystem support is a feature of SSH version 2
	(SSHv2) and is not included in SSHv1.  Running this protocol as
	an SSH subsystem avoids the need for the application to
	recognize shell prompts or skip over extraneous information,
	such as a system message that is sent at shell start-up.
</p>
<p>It is assumed that the router and cache have exchanged keys
        out of band by some reasonably secured means.
</p>
<a name="Setup"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Router-Cache Set-Up</h3>

<p>A cache has the public authentication data for each router it
        is configured to support.
</p>
<p>A router may be configured to peer with a selection of caches,
        and a cache may be configured to support a selection of routers.
        So each must have the name of each peer and authentication data
        for each.  In addition, in a router, this list has a non-unique
        preference value for each server in order of preference.  The
        client router attempts to establish a session with each
        potential serving cache in preference order, and then starts to
        load data from the highest preference cache to which it can
        connect and authenticate.  The router's list of caches has the
        following elements:
      </p>
<blockquote class="text"><dl>
<dt>Preference:</dt>
<dd>
          A cardinal denoting the router's preference to use that cache,
          the lower the value the more preferred.
</dd>
<dt>Name:</dt>
<dd>
          The IP Address or fully qualified domain name of the cache.
</dd>
<dt>Key:</dt>
<dd>
          The public ssh key of the cache.
</dd>
<dt>MyKey:</dt>
<dd>
          The private ssh key of this client.
</dd>
</dl></blockquote>

<p>As caches can not be rigorously synchronous, a client which
        changes servers can not combine data from different parent
        caches.  Therefore, when a lower preference cache becomes
        available, if resources allow, it would be prudent for the
        client to start a new buffer for that cache's data, and only
        switch to those data when that buffer is fully up to date.
</p>
<a name="Scenarios"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Deployment Scenarios</h3>

<p>For illustration, we present three likely deployment
      scenarios.
      </p>
<blockquote class="text"><dl>
<dt>Small End Site:</dt>
<dd>
          The small multi-homed end site may wish to outsource the RPKI
          cache to one or more of their upstream ISPs.  They would exchange
          authentication material with the ISP using some out of band
          mechanism, and their router(s) would connect to one or more
          up-streams' caches.  The ISPs would likely deploy caches intended
          for customer use separately from the caches with which their own
          BGP speakers peer.
</dd>
<dt>Large End Site:</dt>
<dd>
          A larger multi-homed end site might run one or more caches,
          arranging them in a hierarchy of client caches, each fetching
          from a serving cache which is closer to the global RPKI.  They
          might configure fall-back peerings to up-stream ISP caches.
</dd>
<dt>ISP Backbone:</dt>
<dd>
          A large ISP would likely have one or more redundant caches in
          each major PoP, and these caches would fetch from each other
          in an ISP-dependent topology so as not to place undue load on
          the global RPKI publication infrastructure. 
</dd>
</dl></blockquote>

<p>Experience with large DNS cache deployments has shown that
        complex topologies are ill-advised as it is easy to make errors
        in the graph, e.g. not maintaining a loop-free condition.
</p>
<p>Of course, these are illustrations and there are other possible
        deployment strategies.  It is expected that minimizing load on
        the global RPKI servers will be a major consideration.
</p>
<p>To keep load on global RPKI services from unnecessary peaks, it
        is recommended that primary caches which load from the
        distributed global RPKI not do so all at the same times, e.g. on
        the hour.  Choose a random time, perhaps the ISP's AS number
        modulo 60 and jitter the inter-fetch timing.
</p>
<a name="errorcodes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Error Codes</h3>

<p>This section contains a preliminary list of error codes.
        The authors expect additions to this section during
        development of the initial implementations.  Eventually, these
        error codes will probably need to reside in an IANA registry.
      </p>
<blockquote class="text"><dl>
<dt>0: Reserved.</dt>
<dd>
</dd>
<dt>1: Internal Error:</dt>
<dd>
	  The party reporting the error experienced some kind of
          internal error unrelated to protocol operation (ran out of
          memory, a coding assertion failued, etcetera).
</dd>
<dt>2: No Data Available:</dt>
<dd>
	  The cache believes itself to be in good working order, but
          is unable to answer either a Serial Query or a Reset Query
          because it has no useful data available at this time.  This
          is likely to be a temporary error, and most likely indicates
          that the cache has not yet completed pulling down an initial
          current data set from the global RPKI system after some kind
          of event that invalidated whatever data it might have
          previously held (reboot, network partition, etcetera).
</dd>
</dl></blockquote>

<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>As this document describes a security protocol, many aspects of
        security interest are described in the relevant sections.  This
        section points out issues which may not be obvious in other
        sections.
      </p>
<blockquote class="text"><dl>
<dt>Cache Validation:</dt>
<dd>
          In order for a collection of caches as described in
          <a class='info' href='#Scenarios'>Section&nbsp;8<span> (</span><span class='info'>Deployment Scenarios</span><span>)</span></a> to guarantee a consistent view,
          they need to be given consistent trust anchors to use in their
          internal validation process.  Distribution of a consistent
          trust anchor is assumed to be out of band.
</dd>
<dt>Cache Peer Identification:</dt>
<dd>
          As the router initiates an ssh transport session to a cache
          which it identifies by either IP address or fully qualified
          domain name, a DNS or address spoofing attack could make the
          correct cache unreachable.  No session would be established,
          as the authorization keys would not match.
</dd>
<dt>Transport Security:</dt>
<dd>
          The RPKI relies on object, not server or transport, trust.
          I.e. the IANA root trust anchor is distributed to all caches
          through some out of band means, and can then be used by each
          cache to validate certificates and ROAs all the way down the
          tree.  The inter-cache relationships are based on this object
          security model, hence the inter-cache transport can be lightly
          protected.
</dd>
<dt></dt>
<dd>But this protocol document assumes that the routers can not
          do the validation cryptography.  Hence the last link, from
          cache to router, is secured by server authentication and
          transport level security.  This is dangerous, as server
          authentication and transport have very different threat models
          than object security.
</dd>
<dt></dt>
<dd>So the strength of the trust relationship and the transport
          between the router(s) and the cache(s) are critical.  You're
          betting your routing on this.
</dd>
<dt></dt>
<dd>While we can not say the cache must be on the same LAN, if
          only due to the issue of an enterprise wanting to off-load the
          cache task to their upstream ISP(s), locality, trust, and
          control are very critical issues here.  The cache(s) really
          SHOULD be as close, in the sense of controlled and protected
          (against DDoS, MITM) transport, to the router(s) as possible.
          It also SHOULD be topologically close so that a minimum of
          validated routing data are needed to bootstrap a router's access
          to a cache.
</dd>
</dl></blockquote>

<a name="Glossary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Glossary</h3>

<p>The following terms are used with special meaning:
      </p>
<blockquote class="text"><dl>
<dt>Global RPKI:</dt>
<dd>
          The authoritative data of the RPKI are published in a
          distributed set of servers at the IANA, RIRs, NIRs, and ISPs,
          see <a class='info' href='#I-D.ietf-sidr-repos-struct'>[I&#8209;D.ietf&#8209;sidr&#8209;repos&#8209;struct]<span> (</span><span class='info'>Huston, G., Loomans, R., and G. Michaelson, &ldquo;A Profile for Resource Certificate Repository Structure,&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</dd>
<dt>Non-authorative Cache:</dt>
<dd>
          A coalesced copy of the RPKI which is periodically
          fetched/refreshed directly or indirectly from the global RPKI
          using the <a class='info' href='#rcynic'>[rcynic]<span> (</span><span class='info'>Austein, R., &ldquo;rcynic protocol,&rdquo; .</span><span>)</span></a> protocol/tools
</dd>
<dt>Cache:</dt>
<dd>
          The rcynic system is used to gather the distributed data of
          the RPKI into a validated cache.  Trusting this cache further
          is a matter between the provider of the cache and a relying
          party.
</dd>
<dt>Serial Number:</dt>
<dd>
          A 32-bit monotonically increasing, cardinal which wraps from
          2^32-1 to 0.  It denotes the logical version of a cache.  A
          cache increments the value by one when it successfully updates
          its data from a parent cache or from primary RPKI data.  As a
          cache is rcynicing, new incoming data, and implicit deletes,
          are marked with the new serial but MUST not be sent until the
          fetch is complete.  A serial number is not commensurate
          between caches, nor need it be maintained across resets of the
          cache server.  See <a class='info' href='#RFC1982'>[RFC1982]<span> (</span><span class='info'>Elz, R. and R. Bush, &ldquo;Serial Number Arithmetic,&rdquo; August&nbsp;1996.</span><span>)</span></a> on DNS
          Serial Number Arithmetic for too much detail on serial number
          arithmetic.
</dd>
</dl></blockquote>

<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<p>This document requests the IANA to create a registry for PDU
        types.
</p>
<p>This document requests the IANA to create a registry for Error
        Codes.
</p>
<p>In addition, a registry for Version Numbers would be needed if
        new Version Number is defined in a new RFC.
</p>
<p>Note to RFC Editor: this section may be replaced on publication
        as an RFC.
</p>
<a name="Acknowledgments"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Acknowledgments</h3>

<p>The authors wish to thank Steve Bellovin, Rex Fernando, Russ
      Housley, Pradosh Mohapatra, Sandy Murphy, Megumi Ninomiya,
      Robert Raszuk, John Scudder, Ruediger Volk, David Ward, and Bert
      Wijnen.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1982">[RFC1982]</a></td>
<td class="author-text">Elz, R. and R. Bush, &ldquo;<a href="http://tools.ietf.org/html/rfc1982">Serial Number Arithmetic</a>,&rdquo; RFC&nbsp;1982, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1982.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; RFC&nbsp;2119, BCP&nbsp;14, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4252">[RFC4252]</a></td>
<td class="author-text">Ylonen, T. and C. Lonvick, &ldquo;<a href="http://tools.ietf.org/html/rfc4252">The Secure Shell (SSH) Authentication Protocol</a>,&rdquo; RFC&nbsp;4252, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4252.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="rcynic">[rcynic]</a></td>
<td class="author-text">Austein, R., &ldquo;<a href="https://subvert-rpki.hactrn.net/rcynic/">rcynic protocol</a>.&rdquo;</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>14.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sidr-arch">[I-D.ietf-sidr-arch]</a></td>
<td class="author-text">Lepinski, M. and S. Kent, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-arch-06.txt">An Infrastructure to Support Secure Internet Routing</a>,&rdquo; draft-ietf-sidr-arch-06 (work in progress), March&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-arch-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sidr-repos-struct">[I-D.ietf-sidr-repos-struct]</a></td>
<td class="author-text">Huston, G., Loomans, R., and G. Michaelson, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-repos-struct-01.txt">A Profile for Resource Certificate Repository Structure</a>,&rdquo; draft-ietf-sidr-repos-struct-01 (work in progress), October&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sidr-repos-struct-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1996">[RFC1996]</a></td>
<td class="author-text">Vixie, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1996">A Mechanism for Prompt Notification of Zone Changes (DNS NOTIFY)</a>,&rdquo; RFC&nbsp;1996, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1996.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Randy Bush</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Internet Initiative Japan, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5147 Crystal Springs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bainbridge Island, Washington  98110</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 206 780 0431 x1</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:randy@psg.com">randy@psg.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Rob Austein</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Internet Systems Consortium</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">950 Charter Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redwood City, CA  94063</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:sra@isc.org">sra@isc.org</a></td></tr>
</table>
</body></html>
