<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>EAP Authentication Extensions for the
    Dynamic Host Configuration Protocol for Broadband</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="EAP Authentication Extensions for the
    Dynamic Host Configuration Protocol for Broadband">
<meta name="keywords" content="DHCP, EAP, PPP, CHAP, Authentication, Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Dynamic Host Configuration WG</td><td class="header">R. Pruss</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">G. Zorn</td></tr>
<tr><td class="header">Expires: November 1, 2009</td><td class="header">Network Zen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">April 30, 2009</td></tr>
</table></td></tr></table>
<h1><br />EAP Authentication Extensions for the
    Dynamic Host Configuration Protocol for Broadband<br />draft-pruss-dhcp-auth-dsl-05</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on November 1, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document defines Dynamic Host Configuration Protocol (DHCP)
      extensions that provide for end-user authentication prior to
      configuration of the host. The primary applicability is within a Digital
      Subscriber Line (DSL) Broadband network environment in order to enable a
      smooth migration from the Point to Point Protocol (PPP).
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#Intro">1.</a>&nbsp;
Introduction<br />
<a href="#Problem">2.</a>&nbsp;
Problem Statement<br />
<a href="#Architecture">3.</a>&nbsp;
Network Architecture and Terminology<br />
<a href="#Applicability">4.</a>&nbsp;
Applicability Statement<br />
<a href="#Protocol">5.</a>&nbsp;
Protocol Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Protocol-IPv4">5.1.</a>&nbsp;
Protocol Operation for IPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Protocol-IPv6">5.2.</a>&nbsp;
Protocol Operation for IPv6<br />
<a href="#DHCP-Options">6.</a>&nbsp;
DHCP Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DHCPEAP-Capability">6.1.</a>&nbsp;
DHCPEAP Capability Vendor-identifying Vendor-specific Suboption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DHCPEAP-Capability-v6">6.2.</a>&nbsp;
DHCPv6 DHCPEAP Capability Vendor-specific Suboption<br />
<a href="#DHCP-Messages">7.</a>&nbsp;
DHCP Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DHCPEAP-Message">7.1.</a>&nbsp;
DHCPv4 DHCPEAP Message type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DHCPEAP-Message-v6">7.2.</a>&nbsp;
DHCPv6 DHCPEAP Message<br />
<a href="#New-Messages">8.</a>&nbsp;
Messages for EAP operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">8.1.</a>&nbsp;
Messages for DHCPv4<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DHCPDISCOVER">8.1.1.</a>&nbsp;
Client's DHCPDISCOVER message<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EAPMESSAGE">8.1.2.</a>&nbsp;
DHCPEAP message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">8.2.</a>&nbsp;
Messages for DHCPv6<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SOLICIT">8.2.1.</a>&nbsp;
Client's SOLICIT message<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DHCPEAP">8.2.2.</a>&nbsp;
DHCPEAP message type<br />
<a href="#anchor3">9.</a>&nbsp;
Fragmentaion<br />
<a href="#Compatibility">10.</a>&nbsp;
Backwards Compatibility Considerations<br />
<a href="#Security">11.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">11.1.</a>&nbsp;
Message Authentication <br />
<a href="#IANA">12.</a>&nbsp;
IANA Considerations<br />
<a href="#Acknowledgements">13.</a>&nbsp;
Acknowledgements<br />
<a href="#Notice">14.</a>&nbsp;
Notice<br />
<a href="#rfc.references1">15.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">15.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">15.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="Intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document defines DHCP Options and procedures that allow for an
      Extensible Authentication Protocol (EAP) authentication exchange to
      occur in DHCP in order to enable smooth migration from Point-to-Point
      Protocol (PPP)<a class='info' href='#RFC1661'>[RFC1661]<span> (</span><span class='info'>Simpson, W., &ldquo;The Point-to-Point Protocol (PPP),&rdquo; July&nbsp;1994.</span><span>)</span></a> sessions to IP sessions in
      a DSL Broadband network environment. Primary goals are integration of
      authentication in such a way that it will operate seamlessly with
      existing RADIUS-based Authentication, Authorization and Accounting (AAA)
      infrastructure and Asynchronous Transfer Mode (ATM) or Ethernet based
      DSL Networks. As such, only the termination points of PPP in the DSL
      network are affected, both of which are devices that would logically
      need to be updated in any transition from PPP to IP sessions.
</p>
<p>It should be noted that <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> defines a
      mechanism that provides authentication of individual DHCP messages.
      While this mechanism does provide a method of authentication for a DHCP
      Client based on a shared secret, it does not do so in a manner that can
      be seamlessly integrated with existing RADIUS-based AAA
      infrastructure.
</p>
<a name="Problem"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Problem Statement</h3>

<p>Digital Subscriber Line (DSL) broadband service providers are
      witnessing a shift in the "last-mile" aggregation technologies and
      protocols which have traditionally been relied upon. Two primary
      transitions are from ATM to Ethernet in the access network, and from the
      PPP for multi-protocol framing and dynamic endpoint configuration to
      direct encapsulation of IP and DHCP for dynamic endpoint configuration
      for some devices. The term used by the DSL Forum for the network state
      associated with an authorized subscriber (that is using DHCP and IP
      rather than PPP) is "IP session" <a class='info' href='#WT-146'>[WT&#8209;146]<span> (</span><span class='info'>DSL Forum, &ldquo;Internet Protocol (IP) Sessions,&rdquo; April&nbsp;2007.</span><span>)</span></a>. While
      these trends can be readily witnessed, neither are occurring overnight.
      In addition, they are not necessarily implemented in lock-step. Thus,
      one may find ATM-based and Ethernet-based access networks running a
      combination of PPP sessions and IP sessions at any given time,
      particularly during transition periods. This coexistences will even
      occur for the same service subscriber.
</p>
<p>Removing PPP, Point-to-Point Protocol over ATM (PPPoA) <a class='info' href='#RFC2364'>[RFC2364]<span> (</span><span class='info'>Gross, G., Kaycee, M., Lin, A., Malis, A., and J. Stephens, &ldquo;PPP Over AAL5,&rdquo; July&nbsp;1998.</span><span>)</span></a>, and Point-to-Point Protocol over Ethernet
      (PPPoE) <a class='info' href='#RFC2516'>[RFC2516]<span> (</span><span class='info'>Mamakos, L., Lidl, K., Evarts, J., Carrel, D., Simone, D., and R. Wheeler, &ldquo;A Method for Transmitting PPP Over Ethernet (PPPoE),&rdquo; February&nbsp;1999.</span><span>)</span></a> from the subscriber access
      network is relatively straightforward in that most of the properties
      that DSL providers are interested in going forward are already present
      in DHCP and IP sessions. Luckily, there are some capabilities of PPP
      which the market does not continue to demand. For example, the Dynamic
      configuration in PPP for IPX or NETBEUI, is no longer of concern.
      Neither are the multi-link bonding capabilities of PPP <a class='info' href='#RFC1990'>[RFC1990]<span> (</span><span class='info'>Sklower, K., Lloyd, B., McGregor, G., Carr, D., and T. Coradetti, &ldquo;The PPP Multilink Protocol (MP),&rdquo; August&nbsp;1996.</span><span>)</span></a> commonly used on separate ISDN B-channels, and
      the myriad of other features that PPP developed as the "dial-based"
      access protocol of choice for framing, authentication, and dynamic
      configuration for IP and other network layer protocols. Missing from IP
      sessions and DHCP <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a>, however, are
      isomorphic methods for user authentication and session liveness probing
      (sometimes referred to as a session "keepalive"). For the latter,
      existence of a client using a given IP address can be detected by a
      number of means, including Address Resolution Protocol (ARP) <a class='info' href='#RFC0826'>[RFC0826]<span> (</span><span class='info'>Plummer, D., &ldquo;Ethernet Address Resolution Protocol: Or converting network protocol addresses to 48.bit Ethernet address for transmission on Ethernet hardware,&rdquo; November&nbsp;1982.</span><span>)</span></a>, ICMP Echo/Echo Response <a class='info' href='#RFC0792'>[RFC0792]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Control Message Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>, or Bidirectional Forwarding Detection (BFD)
      <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. , &ldquo;Bidirectional Forwarding Detection,&rdquo; 2005.</span><span>)</span></a>. This leaves authentication as
      an open issue needing resolution. Specifically, authentication based on
      a username and secret password must be covered. This is something that
      in PPP always occurs before dynamic configuration of an IP address and
      associated parameters.
</p>
<p>While most DSL deployments utilize a username and password to
      authenticate a subscriber and authorize access today, this is not the
      only method for authentication that has been adopted when moving to DHCP
      and IP sessions. "Option 82" <a class='info' href='#RFC3046'>[RFC3046]<span> (</span><span class='info'>Patrick, M., &ldquo;DHCP Relay Agent Information Option,&rdquo; January&nbsp;2001.</span><span>)</span></a> is commonly
      used with DHCP as a credential to authenticate a given subscriber line
      and authorize service. In this model, the DSL Access Node, which always
      sits between the DHCP Client and Server, snoops DHCP messages as they
      pass, and inserts pre-configured information for a given line (e.g., an
      ATM VPI/VCI, Ethernet VLAN, or other tag). That information, while
      provided in clear text, traverses what is considered a physically
      secured portion of the access network and is used to determine
      (typically via a request to an AAA server) whether the DHCP exchange can
      continue. This fits quite well with current DSL network architecture, as
      long as the subscriber line itself is all that needs be authorized.
      However, in some service models it is still necessary for the subscriber
      to provide credentials directly.
</p>
<p>From the perspective of the Network Access Server (NAS) where the
      DHCP Server resides, the extensions defined in this document are
      analogous to the commonly available "Option 82" method. The primary
      difference between using Option 82 line configuration and a username and
      password is that the authentication credentials are provided by the
      subscriber rather than inserted by intervening network equipment.
      Providing credentials from the subscriber rather than intervening
      network equipment is particularly important for cases where subscriber
      line information is unavailable, untrusted, or due to the terms of the
      service changing at any time. Further, different devices in the home may
      have different policies and require different credentials. Migration
      scenarios where PPPoE and DHCP operate on the same network for a period
      of time lend well to models which utilize identical authentication and
      authorization credentials across the different data plane
      encapsulations.
</p>
<a name="Architecture"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Network Architecture and Terminology</h3>

<p>The DSL Forum defines its ATM-based network architecture in <a class='info' href='#TR-059'>[TR&#8209;059]<span> (</span><span class='info'>DSL Forum, &ldquo;DSL Evolution - Architecture Requirements for the Support of           QoS-Enabled IP Services,&rdquo; September&nbsp;2003.</span><span>)</span></a> and Ethernet-based network architecture in <a class='info' href='#TR-101'>[TR&#8209;101]<span> (</span><span class='info'>DSL Forum, &ldquo;Migration to Ethernet Based DSL Aggregation,&rdquo; April&nbsp;2006.</span><span>)</span></a>. The extensions for DHCP defined in this
      document are designed to work identically on Ethernet or ATM
      architectures. The diagram in <a class='info' href='#Fig1'>Figure&nbsp;1<span> (</span><span class='info'>DSL Network Architecture</span><span>)</span></a> and following
      terminology will be used throughout: <br /><hr class="insert" />
<a name="Fig1"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                             +-----------+  +------------+
                             |   DHCP    |  | AAA/RADIUS |
                             |  Server   |  |   Server   |
                             +-----------+  +------------+
                                     |            |
                                     |            |
 Sub.     +-----+   +--------+       |         +-----+   +----------+
 Home  ---| HGW |---|        |       +---------|     |   |          |
Network   +-----+   | Access |                 |     |   |          |
                    |  Node  |--/Aggregation\--| NAS |---| Internet |
 Sub.     +-----+   |        |--\  Network  /--|     |   |          |
 Home  ---| HGW |---|        |                 |     |   |          |
Network   +-----+   +--------+                 +-----+   +----------+
             |                                     |
             |----------DSL Access Network --------|</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: DSL Network Architecture&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 </p>
<ul class="text">
<li>Access Node (AN): Network device, usually located at a service
          provider central office or street cabinet, that terminates Access
          Loop connections from Subscribers. In case the Access Loop is a
          Digital Subscriber Line (DSL), this is often referred to as a DSL
          Access Multiplexer (DSLAM). The AN may support one or more Access
          Loop technologies and allow them to inter-work with a common
          aggregation network technology.
</li>
<li>Network Access Server (NAS): Network device that aggregates
          multiplexed Subscriber traffic from a number of Access Nodes. The
          NAS plays a central role in per-subscriber policy enforcement and
          QoS. Often referred to as a Broadband Network Gateway (BNG) or
          Broadband Remote Access Server (BRAS). A detailed definition of the
          NAS is given in <a class='info' href='#RFC2881'>[RFC2881]<span> (</span><span class='info'>Mitton, D. and M. Beadles, &ldquo;Network Access Server Requirements Next Generation (NASREQNG) NAS Model,&rdquo; July&nbsp;2000.</span><span>)</span></a>.
</li>
<li>The Home Gateway (HGW) connects the different Customer Premises
          Equipment (CPE) to the Access Node and the access network. In case
          of DSL, the HGW is a DSL Network Termination (NT) that could either
          operate as a layer 2 bridge or as a layer 3 router. In the latter
          case, such a device is also referred to as a Routing Gateway
          (RG).
</li>
<li>Referring to the DSL network architecture depicted in <a class='info' href='#Fig1'>Figure&nbsp;1<span> (</span><span class='info'>DSL Network Architecture</span><span>)</span></a>, PPP (via PPPoA <a class='info' href='#RFC2364'>[RFC2364]<span> (</span><span class='info'>Gross, G., Kaycee, M., Lin, A., Malis, A., and J. Stephens, &ldquo;PPP Over AAL5,&rdquo; July&nbsp;1998.</span><span>)</span></a>
          or PPPoE <a class='info' href='#RFC2516'>[RFC2516]<span> (</span><span class='info'>Mamakos, L., Lidl, K., Evarts, J., Carrel, D., Simone, D., and R. Wheeler, &ldquo;A Method for Transmitting PPP Over Ethernet (PPPoE),&rdquo; February&nbsp;1999.</span><span>)</span></a>) operates over the DSL
          Access Network between the NAS and a device behind the HGW, or
          between the NAS and the HGW itself. The DHCP Client resides either
          on a home network device or the HGW, and the DHCP Server protocol
          state machine may reside fully on the NAS. The NAS obtains
          per-subscriber client configuration information either locally,
          relayed from a DHCP server or from the AAA infrastructure (which
          itself may consult external DHCP servers if necessary) after
          authentication is successfully completed.
</li>
</ul>

<a name="Applicability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Applicability Statement</h3>

<p>The primary target for this extension is for DSL service provider
      networks where PPP is being phased out to be replaced by native IP and
      DHCP, or where new devices are being added which will not utilize PPP.
      Very specific assumptions have been made with respect to the security
      model, operational methods, and integration requirements for existing
      AAA mechanisms during the design. It is understood that this mechanism
      may not be generally applicable in this form for all network
      environments where DHCP is deployed, though perhaps elements of it may
      be used to develop a more generic approach while still meeting the
      specific requirements set out by the DSL network architecture. Earlier
      revisions of this document included a method to embed PPP CHAP <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a> authentication as Options in existing DHCP
      messages. This method has been abandoned due to security vulnerabilities
      in CHAP, as well as a lack of extensibility. This document bases its
      authentication on EAP <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> which can be used
      with a large number of different authentication methods, including one
      backwards compatible with existing PPP CHAP.
</p>
<a name="Protocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Protocol Operation</h3>

<p>This section describes the protocol operation for EAP within DHCPv4
      <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> and DHCPv6 <a class='info' href='#RFC3315'>[RFC3315]<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a>. Options and message specifications used in
      these operation descriptions are detailed in later sections.
</p>
<p>If multiple DHCP exchanges are occurring with multiple servers, both
      IPv4 and IPv6 each needs to authenticate separately.
</p>
<a name="Protocol-IPv4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Protocol Operation for IPv4</h3>

<p>It is essential that the user/node authentication occurs before the
        assignment of an IP address and, further, that the assignment of the
        address depends upon the details of the successful authentication. .
        DHCP <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> is widely used as an address
        assignment method (among other things); EAP <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> has been widely adapted for authentication
        purposes, especially in those types of networks where DHCP is also
        used. This section describes how to combine the two in order to
        provide both strong authentication and authenticated address
        assignment in an efficient manner.
</p>
<p>A <a class='info' href='#DHCPEAP-Message'>Section&nbsp;7.1<span> (</span><span class='info'>DHCPv4 DHCPEAP Message type</span><span>)</span></a> (using the DHCP
        Vendor-specific Message <a class='info' href='#I-D.volz-dhc-dhcpv4-vendor-message'>[I&#8209;D.volz&#8209;dhc&#8209;dhcpv4&#8209;vendor&#8209;message]<span> (</span><span class='info'>Volz, B., &ldquo;DHCPv4 Vendor-specific Message,&rdquo; July&nbsp;2008.</span><span>)</span></a>) is used in the
        DHCP message flow to support the new EAP phase which occurs before a
        DHCPOFFER is sent by the Server. This message is used to integrate
        authentication methods supported by EAP, including CHAP and any other
        "in the clear" password mechanisms (for example, to support One-Time
        Password mechanisms), or to carry other EAP methods. EAP is widely
        used in other environments, outside of DSL Broadband, including 802.11
        "Wi-Fi" access networks and 3GPP to name a few.
</p>
<p>To request the assignment of an IPv4 address with authentication, a
        client first locates a DHCP server, then authenticates using EAP and
        then requests the assignment of an address and other configuration
        information from the server. The client sends a DHCPDISCOVER message
        with an option specifying that the client understands the DHCP User
        Authentication protocol using EAP, to find an available DHCP server.
        Any server that can that can authenticate and address it responds with
        a DHCPEAP message containing the first packet of the EAP protocol.
</p>
<p>Servers which support DHCP User Authentication will respond with a
        DHCPEAP message. The client may receive one or more DHCPEAP messages
        from one or more DHCP Servers or DHCP relays. The Client may also
        receive one or more DHCPOFFER messages from other DHCP Servers which
        may not understand, or choose not to employ the DHCP User
        Authentication protocol. The Client chooses one server to reply to. If
        the selected server has sent a DHCPEAP message, then the Client will
        send a DHCPEAP message in reply. The DHCPEAP message contains EAP
        packets which facilitate the EAP authentication exchange. The exchange
        may occur between the DHCP Client and DHCP Server embedded within a
        NAS, or be carried transparently to the AAA Server. Upon successful
        completion of the authentication phase, the DHCP server sends a
        DHCPOFFER with the appropriate IP configuration for the authenticated
        user. The client then follows the normal DHCP procedures of a
        successful DHCP exchange by sending a DHCPREQUEST, followed by a
        DHCPACK from the Server.
</p>
<p>If the authentication phase fails the DHCP server may choose to
        either terminate all communication with a client or offer some default
        address possibly with some limited access policy. (Configuration
        policy for this is outside of the scope of this document).
</p>
<p>The final EAP-Success or EAP-Failure message is always communicated
        using the DHCPEAP message type. If the Server will be sending a
        DHCPOFFER message, this message is sent immediately after the final
        DHCPEAP message.
</p>
<p>A typical message flow proceeds as shown in <a class='info' href='#Fig2'>Figure&nbsp;2<span> (</span><span class='info'>DHCP Message Flow with DHCPEAP messages</span><span>)</span></a>: The retransmission is handled by EAP as per
        Section 4.1 in <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>.
</p><br /><hr class="insert" />
<a name="Fig2"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    (HGW)                (NAS)                   (AAA)
 DHCP Client          DHCP Server/            RADIUS Server

DHCPDISCOVER -------&gt;
(w/DHCP-auth-proto EAP)

             &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)

                                            &lt;-------- RADIUS
                                Access-Challenge (w/EAP Message)

             &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)
(The last four messages repeat until EAP Success or EAP fail)

                                            &lt;-------- RADIUS
                                Access-Accept (w/EAP Message)
                               (Access-Reject (w/EAP Message)
                                             if unsuccessful)

             &lt;------- DHCPEAP (w/EAP success Message)


           (DHCP messages continue normally from
           this point forward if successful)


            &lt;-------- DHCPOFFER (w/yiaddr)

DHCPREQUEST  -------&gt;

             &lt;------- DHCPACK</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: DHCP Message Flow with DHCPEAP messages&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The message exchange presented in <a class='info' href='#Fig2'>Figure&nbsp;2<span> (</span><span class='info'>DHCP Message Flow with DHCPEAP messages</span><span>)</span></a> is an
        example of simple one-way user authentication, e.g. the Server
        verifies the credentials of the HGW Client. The client indicates the
        ability to have an EAP exchange and the NAS (which takes on the EAP
        authenticator role) initiates the first EAP request to the DHCP Client
        (which takes on the EAP peer role).
</p>
<p>When the NAS is acting as a DHCP Relay the BRAS may split the EAP
        Messages from DHCP and perform the AAA authentication with an AAA
        server. This allows use of existing DHCP servers and existing AAA
        servers.
</p>
<p>An example message flow for DHCP Relay proceeds as shown in <a class='info' href='#Fig3'>Figure&nbsp;3<span> (</span><span class='info'>DHCP Authentication Message Flow with DHCP relay NAS</span><span>)</span></a>: <a class='info' href='#RFC4014'>[RFC4014]<span> (</span><span class='info'>Droms, R. and J. Schnizlein, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option,&rdquo; February&nbsp;2005.</span><span>)</span></a>
</p><br /><hr class="insert" />
<a name="Fig3"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    (HGW)                (NAS)                (AAA)           (DHCP)
 DHCP Client           AAA Client        RADIUS Server   DHCP Server


DHCPDISCOVER -------&gt;
(w/DHCP-auth-proto EAP)

             &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)

                                    &lt;-------- RADIUS
                                    Access-Challenge
                                     (w/EAP Message)
             &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)

 (The last four messages repeat until EAP Success or EAP fail)

                                    &lt;-------- RADIUS
                       Access-Accept (w/EAP Message)
                      (Access-Reject (w/EAP Message)
                                    if unsuccessful)

             &lt;------- DHCPEAP (w/EAP success Message)


                      DHCPDISCOVER --------------------------&gt;
                      (w/o DHCP-auth-proto EAP)

           (DHCP messages continue normally from
           this point forward if successful)


                                 &lt;--------------------- DHCPOFFER
                                                       (w/yiaddr)

           (DHCP messages continue normally from
           this point forward if successful)


         &lt;----------- DHCPOFFER

DHCPREQUEST  ------------------------------------------&gt;

           &lt;------------------------------------------- DHCPACK</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: DHCP Authentication Message Flow with DHCP relay NAS&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>When the DHCP relay agent in the NAS receives a DHCP message from
        the client, it MAY append a DHCP Relay Agent Information option
        containing the RADIUS Attributes suboption, along with any other
        suboptions it is configured to supply. The RADIUS Attributes suboption
        is defined in <a class='info' href='#RFC4014'>[RFC4014]<span> (</span><span class='info'>Droms, R. and J. Schnizlein, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option,&rdquo; February&nbsp;2005.</span><span>)</span></a>.
</p>
<p>DHCP Authentication uses one suboption inside the
        Vendor-identifying vendor-specific message option and makes use of the
        Vendor-specific Message option<a class='info' href='#I-D.volz-dhc-dhcpv4-vendor-message'>[I&#8209;D.volz&#8209;dhc&#8209;dhcpv4&#8209;vendor&#8209;message]<span> (</span><span class='info'>Volz, B., &ldquo;DHCPv4 Vendor-specific Message,&rdquo; July&nbsp;2008.</span><span>)</span></a>:</p>
<ul class="text">
<li><a class='info' href='#DHCPEAP-Capability'>DHCPEAP Capability Vendor-identifying Vendor-specific Suboption<span> (</span><span class='info'>DHCPEAP Capability Vendor-identifying Vendor-specific Suboption</span><span>)</span></a> in the
            DHCPDISCOVER to specify the type of authentication exchange and
            makes use of a new DHCP Vendor-specific Message type
</li>
<li><a class='info' href='#DHCPEAP-Message'>DHCPv4 DHCPEAP Message type<span> (</span><span class='info'>DHCPv4 DHCPEAP Message type</span><span>)</span></a> to carry
            the EAP data in the DHCPEAP messages.
</li>
</ul>

<a name="Protocol-IPv6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Protocol Operation for IPv6</h3>

<p>This section describes the protocol operation for extending Dynamic
        Host Configuration Protocol for IPv6 <a class='info' href='#RFC3315'>[RFC3315]<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a>
        for an EAP phase.
</p>
<p>The same as the previous section on extending DHCP in IPv4 a new
        DHCP message, <a class='info' href='#DHCPEAP-Message-v6'>Section&nbsp;7.2<span> (</span><span class='info'>DHCPv6 DHCPEAP Message</span><span>)</span></a> is used to
        support EAP authentication before host configuration occurs. The
        mechanisms described here follow a similar methodology as that for
        DHCPv4 described in Section 5.1.
</p>
<p>The client sends a Solicit message with an Option specifying the
        session authentication protocol as EAP to the
        All_DHCP_Relay_Agents_and_Servers address to find available DHCP
        servers. Any server that can authenticate and address it responds with
        a DHCPEAP message.
</p>
<p>The client may receive one or more DHCPEAP messages from one or
        more DHCP Servers. The Client chooses one to reply to, and sends a
        DHCPEAP message, silently discarding DHCPEAP messages from other
        Servers (?? As per the question above, is there some type of EAP
        message which can be sent to the other servers to stop EAP there?).
        The DHCPEAP messages contain EAP packets which facilitate the EAP
        authentication exchange. The exchange may occur between the DHCP
        Client and DHCP Server embedded within a NAS, or be carried
        transparently to the AAA Server. Upon successful completion of the
        authentication phase, the DHCP server sends a ADVERTISE with the
        appropriate configuration for the authenticated user. The client then
        follows the normal DHCP procedures of a successful DHCP exchange by
        sending a REQUEST, followed by an ACK from the Server.
</p>
<p>If the authentication phase fails (e.g., the user does not provide
        appropriate credentials), then according to configured policy the DHCP
        Client is either denied any IP configuration with the DHCP Server
        sending a NAK accordingly, or the DHCP Client is given a "limited
        access" configuration profile and the DHCP exchange continues as if
        the authentication was successful.
</p>
<p>A typical message flow proceeds as shown in <a class='info' href='#Fig4'>Figure&nbsp;4<span> (</span><span class='info'>DHCP IPv6 with DHCPEAP message</span><span>)</span></a>:
</p><br /><hr class="insert" />
<a name="Fig4"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    (HGW)                (NAS)                   (AAA)
 DHCP Client          DHCP Server/            RADIUS Server

SOLICIT -------&gt;
(w/DHCP-auth-proto EAP)

             &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)

                                            &lt;-------- RADIUS
                                Access-Challange (w/EAP Message)
              &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)
  (The last four messages repeat until EAP Success or EAP fail)

                                            &lt;-------- RADIUS
                                Access-Accept (w/EAP Message)
                               (Access-Reject (w/EAP Message)
                                             if unsuccessful)

             &lt;------- DHCPEAP (w/EAP success Message)


          (DHCP messages continue normally from
           this point forward if successful)

             &lt;------- ADVERTISE

           (DHCP messages continue normally from
           this point forward if successful)


REQUEST  -------&gt;

             &lt;------- REPLY</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: DHCP IPv6 with DHCPEAP message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The retransmission is handled by EAP as per Section 4.1 in <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>.
</p>
<p>When the NAS is acting as a DHCPv6 Relay the BRAS may split the EAP
        Messages from DHCP and perform the AAA authentication with an AAA
        server. This allows use of existing DHCPv6 servers and existing AAA
        servers.
</p>
<p>The message following this exchange is an ADVERTISE, sent unchanged
        by the Server. A typical message flow proceeds as shown in <a class='info' href='#Fig5'>Figure&nbsp;5<span> (</span><span class='info'>Message Flow with new message and a DHCP relay</span><span>)</span></a>:
</p><br /><hr class="insert" />
<a name="Fig5"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    (HGW)                (NAS)                (AAA)           (DHCP)
 DHCP Client           AAA Client        RADIUS Server   DHCP Server


SOLICIT -------&gt;
(w/DHCP-auth-proto EAP)

             &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)

                                   &lt;-------- RADIUS
                                   Access-Challange (w/EAP Message)
              &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)
  (The last four messages repeat until EAP Success or EAP fail)

                                   &lt;-------- RADIUS
                                   Access-Accept (w/EAP Message)
                                  (Access-Reject (w/EAP Message)
                                                if unsuccessful)


             &lt;------- DHCPEAP (w/EAP success Message)
           (DHCP messages continue normally from
           this point forward if successful)

                      SOLICIT -------&gt;
                      (w/o DHCP-auth-proto EAP)

                                             &lt;------- ADVERTISE


           (DHCP messages continue normally from
           this point forward if successful)


REQUEST  -------&gt;

                                             &lt;------- REPLY</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Message Flow with new message and a DHCP relay&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>When the DHCP relay agent in the NAS receives a DHCP message from
        the client, it MAY append a DHCP Relay option or DHCP relay
        information suboption containing the RADIUS Attributes information,
        along with any other relay options or relay information suboptions it
        is configured to supply. The RADIUS Attributes suboption for DHCPv4 is
        defined in <a class='info' href='#RFC4014'>[RFC4014]<span> (</span><span class='info'>Droms, R. and J. Schnizlein, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option,&rdquo; February&nbsp;2005.</span><span>)</span></a>
</p>
<a name="DHCP-Options"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
DHCP Options</h3>

<p>One DHCP Vendor-specific suboption is defined in this section. The
      <a class='info' href='#DHCPEAP-Capability'>DHCPEAP Capability Vendor-identifying Vendor-specific Suboption<span> (</span><span class='info'>DHCPEAP Capability Vendor-identifying Vendor-specific Suboption</span><span>)</span></a> is included
      into the client's DHCPDISCOVER or SOLICIT message to specify that the
      client understand DHCPEAP messages, as defined below<a class='info' href='#New-Messages'>(see<span> (</span><span class='info'>Messages for EAP operation</span><span>)</span></a>).
</p>
<a name="DHCPEAP-Capability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
DHCPEAP Capability Vendor-identifying Vendor-specific Suboption</h3>

<p>The DHCPv4 DHCPEAP-Capability Vendor-identifying Vendor-specific
        suboption is sent from the DHCPv4 Client to the DHCPv4 Server to
        indicate that the client is capable of understanding DHCPv4 DHCPEAP
        Messages. This suboption is defined using the DHCPv4
        Vendor-identifying Vendor-specific option:
</p><br /><hr class="insert" />
<a name="Fig6"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Opt-code=125 |   Length=7    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Enterprise-ID=9           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Enterprise-ID (cont.)     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Data-length=2 | Suboption=14  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Subopt-length=0|
+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: DHCPv4 DHCPEAP Capability Vendor-identifying vendor-specific suboption&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text">
<p>Opt-code: 125
</p>
<p>Length: 7
</p>
<p>Enterprise-ID: 9 (Cisco Systems)
</p>
<p>Data-length: 2
</p>
<p>Suboption: 14 (DHCPEAP Capability suboption)
</p>
<p>Subopt-length: 0
</p>
</blockquote>

<a name="DHCPEAP-Capability-v6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
DHCPv6 DHCPEAP Capability Vendor-specific Suboption</h3>

<p>The DHCPv6 DHCPEAP-Capability Vendor-specific suboption is sent
        from the DHCPv6 Client to the DHCPv6 Server to indicate that the
        client is capable of understanding DHCPv6 DHCPEAP Messages. This
        suboption is defined using the DHCPv6 Vendor-specific option:
</p><br /><hr class="insert" />
<a name="Fig6b"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      OPTION_VENDOR_OPTS       |           option-len          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      enterprise-number=9                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Suboption=14  |Subopt-length=0|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: DHCPv6 DHCPEAP Capability Vendor-specific Suboption&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text">
<p>OPTION_VENDOR_OPTS: 17
</p>
<p>Length: 6
</p>
<p>Enterprise-ID: 9 (Cisco Systems)
</p>
<p>Suboption: 14 (DHCPEAP Capability suboption)
</p>
<p>Subopt-length: 0
</p>
</blockquote>

<a name="DHCP-Messages"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
DHCP Messages</h3>

<p>One new DHCPv4 message type and one new DHCPv6 message type are
      defined in order to carry the EAP messages between the client and the
      server. These messages make use of the Vendor-specific Message type and
      are defined using the Enterprise-ID for Cisco Systems.
</p>
<a name="DHCPEAP-Message"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
DHCPv4 DHCPEAP Message type</h3>

<p>The format of the DHCPEAP Message type for DHCPv4 follows the
        current draft <a class='info' href='#I-D.volz-dhc-dhcpv4-vendor-message'>[I&#8209;D.volz&#8209;dhc&#8209;dhcpv4&#8209;vendor&#8209;message]<span> (</span><span class='info'>Volz, B., &ldquo;DHCPv4 Vendor-specific Message,&rdquo; July&nbsp;2008.</span><span>)</span></a>, and is defined as
        follows:
</p><br /><hr class="insert" />
<a name="Fig10"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       53      |       1     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      254      |
+-+-+-+-+-+-+-+-+

...

+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Vendor-msg=TBD |  Length     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Enterprise-ID=9       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Enterprise-ID (cont.) |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Msg-type=1  | Suboption=1 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  EAP-length   | EAP msg ... |
+-+-+-+-+-+-+-+-+             .
.                             .
.                             .
|                             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: DHCPEAP Message type&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p></p>
<blockquote class="text">
<p>Vendor-msg: TBD
</p>
<p>Enterprise-ID: 9 (Cisco Systems)
</p>
<p>Msg-type: 1 (DHCPEAP)
</p>
<p>Suboption: 1 (DHCPEAP-Message)
</p>
<p>EAP-length: (length of the EAP message)
</p>
</blockquote>

<p>Note that according to the current DHCPv4 Vendor-specific Message
        draft, a "vendor-msg-type" field is the first octet after the
        enterprise-ID, and after this octet all data should be in
        "code/length/value" fields "identical to the DHCP options field".
        Thus, the "vendor-msg-type" field ("Msg-type" in the figure above) is
        set to "1" and the next field is the suboption value, which is also
        set to "1", followed one octet specifying the length of the EAP
        message, followed by the EAP message itself.
</p>
<p>The maximum size of a DHCP option is 255 octets. While in some
        cases (e.g., EAP MD5-Challenge <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>) a
        complete EAP message may fit in a single DHCP option, in general this
        is not the case. If an EAP message is too large to fit into a single
        DHCP Vendor-specific Message option, the method defined in <a class='info' href='#RFC3396'>[RFC3396]<span> (</span><span class='info'>Lemon, T. and S. Cheshire, &ldquo;Encoding Long Options in the Dynamic Host Configuration Protocol (DHCPv4),&rdquo; November&nbsp;2002.</span><span>)</span></a> MUST be used to split the EAP message into
        separate options for transmission. Similarly, EAP assumes a minimum
        MTU of 1020 octets while the minimum DHCP packet size is 576 octets,
        including 312 octets reserved for options. A DHCP client including the
        EAP-Message option SHOULD also include the 'maximum DHCP message size'
        option <a class='info' href='#RFC2132'>[RFC2132]<span> (</span><span class='info'>Alexander, S. and R. Droms, &ldquo;DHCP Options and BOOTP Vendor Extensions,&rdquo; March&nbsp;1997.</span><span>)</span></a> to set a suitable DHCP message
        size.
</p>
<p>If a DHCP message is received containing more than one DHCPEAP
        Message type option, the method defined in <a class='info' href='#RFC3396'>[RFC3396]<span> (</span><span class='info'>Lemon, T. and S. Cheshire, &ldquo;Encoding Long Options in the Dynamic Host Configuration Protocol (DHCPv4),&rdquo; November&nbsp;2002.</span><span>)</span></a> MUST be used to reassemble the separate
        options into the original EAP message. A DHCP server receiving an EAP
        message MAY forward it via a AAA protocol (such as RADIUS <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> <a class='info' href='#RFC3579'>[RFC3579]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a> or Diameter
        <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>] <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>).
</p>
<a name="DHCPEAP-Message-v6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
DHCPv6 DHCPEAP Message</h3>

<p>The format of the DHCPEAP Message type for DHCPv6 follows the
        current draft <a class='info' href='#I-D.volz-dhc-dhcpv6-vendor-message'>[I&#8209;D.volz&#8209;dhc&#8209;dhcpv6&#8209;vendor&#8209;message]<span> (</span><span class='info'>Volz, B., &ldquo;DHCP Vendor-specific Message,&rdquo; July&nbsp;2008.</span><span>)</span></a>, and is defined as
        follows:
</p><br /><hr class="insert" />
<a name="Fig10b"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Msg-type=TBD  |           Enterprise-ID=9               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Ent-ID (cont.) |   Msg-type=1  |      Suboption=1        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         EAP-msg-length        | Octets of EAP Msg ...   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                         .
.                                                         .
.                                                         .
|                                                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: DHCPEAP Message type&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Note that according to the current DHCPv6 Vendor-specific Message
        draft, a "vendor-msg-type" field is the first octet after the
        enterprise-ID, and after this octet all data should be in
        "code/length/value" fields "identical to the DHCPv6 options field".
        Thus, the "vendor-msg-type" field ("Msg-type" in the figure above) is
        set to "1" and the next field is the suboption value, which is also
        set to "1", followed two octets specifying the length of the EAP
        message, followed by the EAP message itself.
</p>
<a name="New-Messages"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Messages for EAP operation</h3>

<p>This section describes the overall DHCP message contents for all
      messages which are used in implementing the DHCP EAP User Authentication
      extensions.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Messages for DHCPv4</h3>

<p>The authentication data in a DHCPv4 DHCPEAP message is carried in a
        DHCPEAP-Messsage type <a class='info' href='#DHCPEAP-Message'>DHCPv4 DHCPEAP Message type<span> (</span><span class='info'>DHCPv4 DHCPEAP Message type</span><span>)</span></a>.
</p>
<a name="DHCPDISCOVER"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1.1"></a><h3>8.1.1.&nbsp;
Client's DHCPDISCOVER message</h3>

<p>As shown in <a class='info' href='#Fig2'>DHCP Message Flow with DHCPEAP messages<span> (</span><span class='info'>DHCP Message Flow with DHCPEAP messages</span><span>)</span></a> the DHCP
          Client starts the process by sending the DISCOVER to the MAC
          broadcast address. A client sending this EAP-Capability option in
          the DHCPDISCOVER is expected to be able to handle EAP messaging and
          the associated additional methods and fragmentation handling. The
          NAS that handles this request could be a DHCP server or a relay
          DHCP. As per <a class='info' href='#RFC3579'>[RFC3579]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a> the NAS can send the
          initial EAP-Request to the client or the NAS can send an EAP-Start
          to the server. The diagrams in this draft assume the NAS sends the
          initial EAP-Reqest as <a class='info' href='#RFC3579'>[RFC3579]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a> reads as if
          that is the recommended behaviour.
</p><br /><hr class="insert" />
<a name="Fig11"></a>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
DHCP Header
Opcode: BOOTREQUEST (1)

Message-type option(53): DISCOVER
Vendor-identifying vendor-specific option (125):
Enterprise: 9 (Cisco Systems)
Suboption 14 (EAP-Capability option):
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  Opt-code=125 |   Length=7    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Enterprise-ID=9           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Enterprise-ID (cont.)     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Data-length=2 | Suboption=14  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Subopt-length=0|
    +-+-+-+-+-+-+-+-+

</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: Client's DHCPDISCOVER message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p>
<a name="EAPMESSAGE"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1.2"></a><h3>8.1.2.&nbsp;
DHCPEAP message</h3>

<p>The NAS responds to DHCP Client by sending an initial DHCPEAP to
          the clients MAC address (unicast). Subsequent NAS DHCP messages
          would look the same; unicast response for these messages to avoid
          the EAP conversation being replicated to many downstream clients. As
          noted in <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>, if an EAP packet is lost in
          transit between the authenticating peer and the NAS (or vice versa),
          the NAS will retransmit.
</p><br /><hr class="insert" />
<a name="Fig12"></a>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
DHCP Header:
Opcode: BOOTREQUEST (1) or BOOTREPLY (2)

Message-type option(53): Vendor-specific-message-type (254)
Vendor-specific Message option (TBD)
(as described in draft-volz-dhc-dhcpv4-vendor-message):
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Vendor-msg=TBD |  Length     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       Enterprise-ID=9       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       Enterprise-ID (cont.) |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   msg-type=1  | Suboption=1 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |  EAP-length   | Octets of EAP Message ...
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
option-code=TBD
option-len=6
enterprise-number=9 (Cisco Systems)
vendor-message-data: (TLV format)
    Message-type code (1 octet): 1 (DHCPEAP)
    Suboption code (1 octet): 1 (DHCPEAP Message)

</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;11: NAS DHCPEAP message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Messages for DHCPv6</h3>

<p>The DHCPEAP messages for DHCPv6 follow the format for DHCP messages
        defined in <a class='info' href='#RFC2131'>RFC 2131<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2131] and is identified by
        the presence of a vendor specific DHCP Message Type option as per
        <a class='info' href='#I-D.volz-dhc-dhcpv6-vendor-message'>[I&#8209;D.volz&#8209;dhc&#8209;dhcpv6&#8209;vendor&#8209;message]<span> (</span><span class='info'>Volz, B., &ldquo;DHCP Vendor-specific Message,&rdquo; July&nbsp;2008.</span><span>)</span></a>, which
        encodes DHCPEAP message type.
</p>
<a name="SOLICIT"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2.1"></a><h3>8.2.1.&nbsp;
Client's SOLICIT message</h3>

<p>As shown in <a class='info' href='#Fig4'>DHCP IPv6 with DHCPEAP message<span> (</span><span class='info'>DHCP IPv6 with DHCPEAP message</span><span>)</span></a> the DHCP
          Client starts the process by sending the SOLICIT to the
          All_DHCP_Relay_Agents_and_Servers multicast address. The NAS that
          handles this request could be a DHCP server or a relay DHCP. A
          client sending this EAP-Capability option in the DHCPDISCOVER is
          expected to be able to handle EAP messaging and the associated
          additional methods and fragmentation handling. As per <a class='info' href='#RFC3579'>[RFC3579]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a> the NAS can send the initial EAP-Request to
          the client or the NAS can send an EAP-Start to the server. The
          diagrams in this draft assume the NAS sends the initial EAP-Reqest
          as <a class='info' href='#RFC3579'>[RFC3579]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a> reads as if that is the
          recommended behaviour.
</p><br /><hr class="insert" />
<a name="Fig13"></a>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
DHCPv6 Message:

    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    SOLICIT    |               transaction-id                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    .                            options                            .
    .                           (variable)                          .
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |      OPTION_VENDOR_OPTS       |           option-len          |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      enterprise-number=9                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Suboption=14  |Subopt-length=0|
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Vendor-specific option (17):
Enterprise: 9 (Cisco Systems)
Suboption 14 (EAP-Capability option):

</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;12: Client's SOLICIT message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p>
<a name="DHCPEAP"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2.2"></a><h3>8.2.2.&nbsp;
DHCPEAP message type</h3>

<p>The NAS responds to DHCP Client by sending an initial DHCPEAP to
          the clients MAC address (unicast). Subsequent NAS DHCP messages
          would look the same; unicast response for these messages to avoid
          the EAP conversation being replicated to many downstream clients. As
          noted in <a class='info' href='#RFC2284'>[RFC2284]<span> (</span><span class='info'>Blunk, L. and J. Vollbrecht, &ldquo;PPP Extensible Authentication Protocol (EAP),&rdquo; March&nbsp;1998.</span><span>)</span></a>[], if an EAP packet is lost
          in transit between the authenticating peer and the NAS (or vice
          versa), the NAS will retransmit.
</p><br /><hr class="insert" />
<a name="Fig14"></a>

<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
DHCPv6 Message

    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Msg-type=TBD  |           Enterprise-ID=9               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |Ent-ID (cont.) |  Msg-type=1   |      Suboption=1        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         EAP-msg-length        | Octets of EAP Msg ...   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                         .
    .                                                         .
    .                                                         .
    |                                                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Enterprise: 9 (Cisco Systems)
Msg-type: 1 (DHCPEAP)
Suboption 1 (EAP-Message)


</pre></div>
<p>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;13: DHCPv6 DHCPEAP message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Fragmentaion</h3>

<p>Encapsulating EAP messages within DHCP raises the question of whether
      there are potential difficulties with respect to the MTU sizes of the
      EAP and DHCP messages, as well as the underlying link MTU.
</p>
<p>EAP as defined in <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> Section 3.1
      says:
</p>
<p>[4] Minimum MTU. EAP is capable of functioning on lower layers that
      provide an EAP MTU size of 1020 octets or greater.
</p>
<p>DHCP as defined in <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> Section 2 says:
</p>
<p>... This requirement implies that a DHCP client must be
      prepared to receive a message of up to 576 octets, the minimum IP
      datagram size an IP host must be prepared to accept [3]. DHCP clients
      may negotiate the use of larger DHCP messages through the 'maximum DHCP
      message size' option. The options field may be further extended into the
      'file' and 'sname' fields.
</p>
<p>If we assume EAP MTU-sized packets, the overhead to pack an EAP
      packet into DHCP options is 2*(1020/255), or 8 octets. Adding the DHCP
      header (240 octets), UDP (8 octets), and the IP header (20 octets) gives
      278 octets total overhead. Since the Ethernet effective MTU is 1500
      octets, this 278 octet overhead leaves the DHCP protocol with 1222
      octets to carry EAP. This space is over 200 octets more than the EAP MTU
      of 1020 octets.
</p>
<p>If we add the SNAME and CHADDR fields to the option pool, then there
      are nearly 400 octets available for DHCP options in an Ethernet
      MTU-sized DHCP packet, encapsulating EAP.
</p>
<p>In short, when the 'maximum DHCP message size' option is used by the
      client, there is no problem carrying in EAP over DHCP. i.e. clients
      capable of performing EAP over DHCP should also advertise a maximum
      message that is capable of carrying EAP over DHCP.
</p>
<a name="Compatibility"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Backwards Compatibility Considerations</h3>

<p>This section is aimed at describing interoperability scenarios
      involving HGW and NAS with or without DHCP Authentication mechanism
      support in order to analyze compatibility issues that could be faced
      between newer and older products during the introduction of the DHCP
      Authentication functionally in current implemented network
      environments.
</p>
<p>Scenario 1: Both HGW and NAS do not support DHCP Authentication
</p>
<p>In this case the authentication process does not start,
      thus traditional DHCP message flow applies.
</p>
<p>Scenario 2: HGW does not support DHCP Authentication and NAS supports
      DHCP Authentication
</p>
<p>In this case the DHCP client does not start DHCP
      Authentication transaction, NAS MAY decide to respond to HGW without
      using DHCP Authentication, falling back to traditional DHCP message flow
      and assigning different network resources.
</p>
<p>Scenario 3: HGW supports the DHCP Authentication and NAS does not
      support DHCP Authentication.
</p>
<p>In this case the DHCP client inserts in the DHCPDISCOVER
      message sent to NAS, the DHCP Authentication Protocol Option described
      in the draft in order to communicate the NAS that it is able to perform
      authentication and for indicating the authentication algorithm preferred
      by the client. NAS on receiving a DHCPDISCOVER with unknown option
      silently discards unknown message. Alternatively NAS MAY ignore the
      unknown option, but still process the message and then reply to the DHCP
      client with traditional response. The HGW, that has upgraded software,
      realizes that the NAS does not support DHCP Authentication and can
      reverts back to normal DHCP message flow.
</p>
<p>Scenario 4 Both HGW and NAS support DHCP Authentication
</p>
<p>In this case DHCP client inserts in the DHCPDISCOVER
      message sent to NAS, the DHCP Authentication Protocol Option in order to
      communicate the NAS that it is able to perform authentication and for
      indicating the authentication algorithm preferred by the client, NAS
      replies according to the message flow described in this draft.
</p>
<p>The following table summarizes the behavior in the 4 described
      scenarios:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>Relay        Client       Support
-------------------------------------------------------------
No           No           No authentication
Yes          No           No authentication
No           Yes          No authentication
Yes          Yes          Authentication as per this document</pre></div>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Considerations</h3>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
Message Authentication </h3>

<p>RFC 3118 provides a mechanism to cryptographically protect DHCP
        messages using a key, K, shared between a DHCP client and Server,
        however no mechanism is defined to manage these keys. Authentication
        exchanges based on EAP have been built into authentication portions of
        network access protocols such as PPP, 802.1X, PANA, IKEv2, and now
        DHCP. EAP methods may provide for the derivation of shared key
        material, the MSK and the EMSK, on the EAP peer and EAP server. This
        dynamic key generation enables <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a>
        protection and allows modes of operation where messages are protected
        from DHCP client to DHCP relay which previously would be difficult to
        manage.
</p>
<p>A future document will look at how to derive the key, K, from the
        EMSK resulting from an EAP exchange and at how this mechanism
        interacts with the DHCP authentication or any EAP authentication prior
        to DHCP.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
IANA Considerations</h3>

<p>This specification requires three values to be assigned by IANA if
      non-Vendor message and option space is not use. Currently the draft
      needs no IANA specified number but this information is captured here
      incase that needs to change in the future.
</p>
<p>The three numbers that could be assigned by IANA are:
</p>
<p>Two are "BOOTP Vendor Extensions and DHCP Options" </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>TBA-1:</dt>
<dd>(DHCPAUTH-Protocol)
</dd>
<dt>TBA-2:</dt>
<dd>(DHCPAUTH-Data)
</dd>
</dl></blockquote>

</blockquote><p>Two DHCP Message Type 53 Values - per [RFC2132], for DHCPEAP
      message type.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Acknowledgements</h3>

<p>Many thanks to Carlos Pignataro for help editing this document.
</p>
<p>Thanks to Roberta Maglione for setting many of the requirements and
      network context for this work.
</p>
<p>Thanks to Richard Johnson, Alan DeKok, Wojciech Dec, Eric Voit, Mark
      Townsley and Ralph Droms for help with this document.
</p>
<p>Thanks to Amy Zhao and Yizhou Li for their work on DHCP
      Authentication and helping with laying the ground for this document.
</p>
<p>
</p>
<a name="Notice"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Notice</h3>

<p>This document may contain material from IETF Documents or IETF
      Contributions published or made publicly available before November 10,
      2008. The person(s) controlling the copyright in some of this material
      may not have granted the IETF Trust the right to allow modifications of
      such material outside the IETF Standards Process. Without obtaining an
      adequate license from the person(s) controlling the copyright in such
      materials, this document may not be modified outside the IETF Standards
      Process, and derivative works of it may not be created outside the IETF
      Standards Process, except to format it for publication as an RFC or to
      translate it into languages other than English.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1994">[RFC1994]</a></td>
<td class="author-text"><a href="mailto:wsimpson@GreenDragon.com">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1994">PPP Challenge Handshake Authentication Protocol (CHAP)</a>,&rdquo; RFC&nbsp;1994, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1994.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>15.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-bfd-base">[I-D.ietf-bfd-base]</a></td>
<td class="author-text">Katz, D. and D. , &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-base-08.txt">Bidirectional Forwarding Detection</a>,&rdquo; 2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.volz-dhc-dhcpv4-vendor-message">[I-D.volz-dhc-dhcpv4-vendor-message]</a></td>
<td class="author-text">Volz, B., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-volz-dhc-dhcpv4-vendor-message-00.txt">DHCPv4 Vendor-specific Message</a>,&rdquo; draft-volz-dhc-dhcpv4-vendor-message-00 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-volz-dhc-dhcpv4-vendor-message-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.volz-dhc-dhcpv6-vendor-message">[I-D.volz-dhc-dhcpv6-vendor-message]</a></td>
<td class="author-text">Volz, B., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-volz-dhc-dhcpv6-vendor-message-01.txt">DHCP Vendor-specific Message</a>,&rdquo; draft-volz-dhc-dhcpv6-vendor-message-01 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-volz-dhc-dhcpv6-vendor-message-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0792">[RFC0792]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc792">Internet Control Message Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;792, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc792.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0826">[RFC0826]</a></td>
<td class="author-text"><a href="mailto:DCP@MIT-MC">Plummer, D.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc826">Ethernet Address Resolution Protocol: Or converting network protocol addresses to 48.bit Ethernet address for transmission on Ethernet hardware</a>,&rdquo; STD&nbsp;37, RFC&nbsp;826, November&nbsp;1982 (<a href="http://www.rfc-editor.org/rfc/rfc826.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1661">[RFC1661]</a></td>
<td class="author-text"><a href="mailto:Bill.Simpson@um.cc.umich.edu">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1661">The Point-to-Point Protocol (PPP)</a>,&rdquo; STD&nbsp;51, RFC&nbsp;1661, July&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1661.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1990">[RFC1990]</a></td>
<td class="author-text"><a href="mailto:sklower@CS.Berkeley.EDU">Sklower, K.</a>, <a href="mailto:brian@lloyd.com">Lloyd, B.</a>, <a href="mailto:glenn@lloyd.com">McGregor, G.</a>, <a href="mailto:dcarr@Newbridge.COM">Carr, D.</a>, and <a href="mailto:70761.1664@compuserve.com">T. Coradetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1990">The PPP Multilink Protocol (MP)</a>,&rdquo; RFC&nbsp;1990, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1990.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2131">[RFC2131]</a></td>
<td class="author-text"><a href="mailto:droms@bucknell.edu">Droms, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>,&rdquo; RFC&nbsp;2131, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2131.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2131.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2131.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2132">[RFC2132]</a></td>
<td class="author-text"><a href="mailto:sca@engr.sgi.com">Alexander, S.</a> and <a href="mailto:droms@bucknell.edu">R. Droms</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2132">DHCP Options and BOOTP Vendor Extensions</a>,&rdquo; RFC&nbsp;2132, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2132.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2132.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2132.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2284">[RFC2284]</a></td>
<td class="author-text"><a href="mailto:ljb@merit.edu">Blunk, L.</a> and <a href="mailto:jrv@merit.edu">J. Vollbrecht</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2284">PPP Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;2284, March&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2284.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2284.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2284.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2364">[RFC2364]</a></td>
<td class="author-text"><a href="mailto:gmgross@lucent.com">Gross, G.</a>, <a href="mailto:mjk@nj.paradyne.com">Kaycee, M.</a>, <a href="mailto:alin@shastanets.com">Lin, A.</a>, <a href="mailto:malis@ascend.com">Malis, A.</a>, and <a href="mailto:john@cayman.com">J. Stephens</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2364">PPP Over AAL5</a>,&rdquo; RFC&nbsp;2364, July&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2364.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2364.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2364.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2516">[RFC2516]</a></td>
<td class="author-text"><a href="mailto:louie@uu.net">Mamakos, L.</a>, <a href="mailto:lidl@uu.net">Lidl, K.</a>, <a href="mailto:jde@uu.net">Evarts, J.</a>, <a href="mailto:carrel@RedBack.net">Carrel, D.</a>, <a href="mailto:dan@RedBack.net">Simone, D.</a>, and <a href="mailto:ross@routerware.com">R. Wheeler</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2516">A Method for Transmitting PPP Over Ethernet (PPPoE)</a>,&rdquo; RFC&nbsp;2516, February&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2516.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2881">[RFC2881]</a></td>
<td class="author-text">Mitton, D. and M. Beadles, &ldquo;<a href="http://tools.ietf.org/html/rfc2881">Network Access Server Requirements Next Generation (NASREQNG) NAS Model</a>,&rdquo; RFC&nbsp;2881, July&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2881.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3046">[RFC3046]</a></td>
<td class="author-text">Patrick, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3046">DHCP Relay Agent Information Option</a>,&rdquo; RFC&nbsp;3046, January&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3046.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3118">[RFC3118]</a></td>
<td class="author-text">Droms, R. and W. Arbaugh, &ldquo;<a href="http://tools.ietf.org/html/rfc3118">Authentication for DHCP Messages</a>,&rdquo; RFC&nbsp;3118, June&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3118.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3315">[RFC3315]</a></td>
<td class="author-text">Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>,&rdquo; RFC&nbsp;3315, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3315.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3396">[RFC3396]</a></td>
<td class="author-text">Lemon, T. and S. Cheshire, &ldquo;<a href="http://tools.ietf.org/html/rfc3396">Encoding Long Options in the Dynamic Host Configuration Protocol (DHCPv4)</a>,&rdquo; RFC&nbsp;3396, November&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3396.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3579">[RFC3579]</a></td>
<td class="author-text">Aboba, B. and P. Calhoun, &ldquo;<a href="http://tools.ietf.org/html/rfc3579">RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3579, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3579.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3588">[RFC3588]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4014">[RFC4014]</a></td>
<td class="author-text">Droms, R. and J. Schnizlein, &ldquo;<a href="http://tools.ietf.org/html/rfc4014">Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option</a>,&rdquo; RFC&nbsp;4014, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4014.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4072">[RFC4072]</a></td>
<td class="author-text">Eronen, P., Hiller, T., and G. Zorn, &ldquo;<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>,&rdquo; RFC&nbsp;4072, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4072.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TR-059">[TR-059]</a></td>
<td class="author-text">DSL Forum, &ldquo;<a href="http://www.dslforum.org/techwork/tr/TR-059.pdf">DSL Evolution - Architecture Requirements for the Support of
          QoS-Enabled IP Services</a>,&rdquo; TR&nbsp;059, September&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="TR-101">[TR-101]</a></td>
<td class="author-text">DSL Forum, &ldquo;<a href="http://www.dslforum.org/techwork/tr/TR-101.pdf">Migration to Ethernet Based DSL Aggregation</a>,&rdquo; TR&nbsp;101, April&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="WT-146">[WT-146]</a></td>
<td class="author-text">DSL Forum, &ldquo;<a href="http://www.dslforum.org/techwork/tworkinprogress.shtml">Internet Protocol (IP) Sessions</a>,&rdquo; WT&nbsp;146 (work in progress), April&nbsp;2007.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richard Pruss</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">80 Albert Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brisbane, Queensland  4000</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Australia</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+61 7 3238 8228</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+61 7 3211 3889</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ric@cisco.com">ric@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Glen Zorn</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Zen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1310 East Thomas Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">#306</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, Washington  98102</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 (206) 377-9035</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gwz@net-zen.net">gwz@net-zen.net</a></td></tr>
</table>
</body></html>
