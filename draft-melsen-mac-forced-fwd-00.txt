
Personal                                                       T. Melsen
Internet-Draft                                                  Ericsson
Expires: July 14, 2004                                  January 14, 2004


    MAC Forced Forwarding: An ARP proxy method for ensuring traffic
      separation between hosts sharing an Ethernet access network
                   draft-melsen-mac-forced-fwd-00.txt

Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at http://
   www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on July 14, 2004.

Copyright Notice

   Copyright (C) The Internet Society (2004). All Rights Reserved.

Abstract

   This document describes a mechanism to ensure layer-2 separation of
   LAN stations accessing an IP gateway over a shared Ethernet segment.

   The mechanism - called "MAC forced forwarding" - implements an ARP
   proxy function that in effect directs all upstream traffic to the IP
   gateway, also if a station is trying to obtain direct Ethernet
   connectivity to another station within the same IP subnet but located
   at another end-user premise.







Melsen                   Expires July 14, 2004                  [Page 1]

Internet-Draft           MAC Forced Forwarding              January 2004


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   1.1 Using Ethernet as Access Network Technology  . . . . . . . . .  3
   1.2 Solution Characteristics . . . . . . . . . . . . . . . . . . .  4
   2.  Conventions used in this document  . . . . . . . . . . . . . .  5
   3.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  5
   4.  Solution Aspects . . . . . . . . . . . . . . . . . . . . . . .  5
   4.1 Obtaining the IP and MAC address of the Access Router  . . . .  5
   4.2 Responding to ARP Requests . . . . . . . . . . . . . . . . . .  6
   4.3 Filtering Upstream Traffic . . . . . . . . . . . . . . . . . .  6
   5.  Access Router Considerations . . . . . . . . . . . . . . . . .  6
   6.  Security Considerations  . . . . . . . . . . . . . . . . . . .  6
   7.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . .  7
       References . . . . . . . . . . . . . . . . . . . . . . . . . .  7
       Author's Address . . . . . . . . . . . . . . . . . . . . . . .  7
       Intellectual Property and Copyright Statements . . . . . . . .  8


































Melsen                   Expires July 14, 2004                  [Page 2]

Internet-Draft           MAC Forced Forwarding              January 2004


1. Introduction

   The main task of a remote access network is to provide connectivity
   between end-user devices and access routers (AR), typically offering
   access to IP networks and/or IP-centric applications.

   A remote access network scenario may be decomposed into a subscriber
   line part and an aggregation network part. The subscriber line -
   often referred to as "the first mile" - is characterized by an
   individual physical connection to each end-user premise. The
   aggregation network - "the second mile" - performs aggregation and
   concentration of end-user traffic.

   The subscriber line and the aggregation network are separated by an
   Access Node (AN). Thus, the AN constitutes the border between
   individual subscriber lines and the common aggregation network.

   Traffic to and from end-user devices located at different premises
   (i.e. going via different subscriber lines) always go via an AR. This
   implies that within the aggregation network, no local traffic paths
   exist that circumvents the AR. This aspect enables the network
   service provider to let his AR(s) perform security filtering,
   policing and charging of all end-user traffic.

   In ATM-centric aggregation networks based on DSL technology, the
   separation of individual end-users' traffic is an intrinsic feature
   caused by the use of ATM permanent virtual circuits (PVCs) between
   the end-users' DSL modems and the AR (typically co-located/integrated
   with access control functionality in a broadband access server, BAS).
   In this case, the Access Node is an ATM-centric DSLAM.

   This document, however, is targeting traffic separation for Ethernet-
   centric aggregation networks, i.e. where other techniques than ATM
   PVCs are deployed to ensure the desired separation of traffic
   belonging to individual end-users.

1.1 Using Ethernet as Access Network Technology

   A major aspect of using Ethernet as aggregation network technology is
   that traffic pertaining to different end-users is conveyed over a
   shared broadcast network. To avoid IP routing in the access network,
   this Ethernet aggregation network is bridged via Access Nodes to
   individual Ethernet networks at the end-users' premises. This
   architecture, however, creates by nature the ability to have direct
   layer-2 visibility between Ethernet stations (hosts) located at
   different end-users' premises. Specifically, hosts located within the
   same IP subnet will have this functionality. This not only violates
   the requirement of sending all traffic via the IP gateway, it also



Melsen                   Expires July 14, 2004                  [Page 3]

Internet-Draft           MAC Forced Forwarding              January 2004


   introduces security issues, as a malicious host can attack another
   host directly on layer-2.

   Existing standardized solutions may be deployed to prevent layer-2
   visibility between stations:
   o  PPP over Ethernet. The use of PPPoE creates individual tunnels
      between hosts and one or more Access Concentrators (AC) over a
      bridged Ethernet topology. Traffic always flows between an AC and
      hosts, never between hosts. The Access Node can enforce that
      upstream traffic will only go to the AC initially selected by the
      host.
   o  VLAN per end-user. Individual traffic streams can be separated in
      different VLANs between the AN and the AR.

   Both solutions provide layer-2 isolation between end-users, but still
   they are not considered optimal for broadband remote access networks.
   o  PPPoE does not support efficient multicast, one of the major
      advantages of using Ethernet as access technology instead of ATM.
      Furthermore, the use of PPP seriously limits IP and Ethernet
      related QoS mechanisms.
   o  Using VLANs to separate individual end-users is not appealing,
      since that is regarded as requiring cumbersome provisioning.
      Furthermore, the basic limit of 4096 VLANs in an Ethernet network
      does not present a scalable solution. This limit is removed by
      deploying VLAN stacking techniques within the access network, but
      this solution only adds to the provisioning complexity.

1.2 Solution Characteristics

   The solution proposed in this document has the following main
   characteristics:
   1.  Traffic between individual end-users is isolated over the
       Ethernet access network. Traffic always goes between end-user
       device and AR, never directly between end-user devices on
       different premises.
   2.  IP addresses are assigned to end-users on an efficient basis.
       Specifically, individual IP subnets per end-user network is NOT a
       requirement for the solution to function. See RFC 3069 [3] for a
       discussion on why this requirement is relevant.
   3.  IP over Ethernet is used as access protocol, to ensure an
       efficient multicast architecture and support for adequate QoS
       mechanisms.
   4.  VLANs are NOT used to separate traffic pertaining to individual
       end-users, due to scalability and provisioning issues.
   5.  The solution works for both dynamically assigned IP addresses
       (via DHCP) and statically assigned IP addresses.





Melsen                   Expires July 14, 2004                  [Page 4]

Internet-Draft           MAC Forced Forwarding              January 2004


2. Conventions used in this document

   In this document, the key words "MUST", "MUST NOT", "REQUIRED",
   "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT
   RECOMMENDED", "MAY", and "OPTIONAL" are to be interpreted as
   described in BCP 14, RFC 2119 [2] and indicate requirement levels for
   compliant implementations.

3. Terminology

   Ethernet Access Node (EAN)
      The entity interfacing between individual subscriber lines and the
      shared access network. E.g. for xDSL access, the EAN is an
      Ethernet-centric DSLAM (Digital Subscriber Line Access
      Multiplexer).

4. Solution Aspects

   The basic property of the solution is to have the EAN ensure that
   upstream traffic is always sent to the designated AR, even if the IP
   traffic goes between end-users located in the same IP subnet.

   The solution may be described as having three major aspects:
   1.  Initially, the EAN obtains corresponding IP and MAC address of
       target AR.
   2.  The EAN replies with this MAC address to any upstream ARP request
       from end-user devices.
   3.  The EAN filters out any upstream traffic to other MAC addresses
       than the target AR.

   These aspects are discussed in the following sections.

4.1 Obtaining the IP and MAC address of the Access Router

   The AR is typically the default gateway of the host.

   The EAN may learn the IP address of the AR in one of two ways,
   depending on the host IP address assignment method. If the host uses
   DHCP, the AR IP address is dynamically learned by snooping the DHCP
   reply towards the host. Otherwise, the AR IP address is
   pre-provisioned by the network operator. In both cases, the EAN will
   need to resolve the corresponding MAC address, using ARP. This can be
   done immediately after the IP address is learned, or when the MAC
   address is first required.

   An access network may contain multiple ARs, and different hosts may
   be assigned different ARs. This implies that the EAN MUST register
   the allowed AR address on a per-user basis.



Melsen                   Expires July 14, 2004                  [Page 5]

Internet-Draft           MAC Forced Forwarding              January 2004


4.2 Responding to ARP Requests

   If all end-users were assigned individual IP subnets, all upstream
   traffic would normally go to an AR (typically the default gateway),
   and the EAN could validate all upstream traffic by checking that the
   destination MAC address matches the AR.

   However, to comply with requirement 2 of section 1.2, residential
   end-users are not assigned individual IP subnets. In other words,
   several hosts located at different premises share an IP subnet.
   Consequently, if a host wishes to communicate with a host on another
   premise, an ARP is issued to obtain the corresponding MAC address.
   This ARP request is intercepted by the EAN's ARP proxy, and responded
   to with an ARP reply, indicating the AR MAC address as the requested
   layer-2 destination. In this way, the ARP table of the requesting
   host will register the AR MAC address as the layer 2 destination for
   any host within that IP subnet.

   An exception is made when a host is ARPing for another host located
   within the same premise. If this ARP request reaches the EAN, it is
   discarded, because it is assumed to be answered directly by a host
   locally within the premise.

4.3 Filtering Upstream Traffic

   Since the EAN's ARP proxy will always reply with the MAC address of
   the AR, the requesting host will never learn MAC addresses of hosts
   located at other premises. However, malicious end-users or
   malfunctioning hosts may still try to send traffic using other
   destination MAC addresses. This traffic MUST be discarded by the EAN.

5. Access Router Considerations

   Traffic between hosts within same IP subnet but located at different
   premises will always go via an IP Gateway. In this case, the AR will
   forward the traffic to the originating network, i.e. down the same
   interface from where it was received. This normally results in an
   ICMP redirect message, RFC 0792 [4], being sent to the originating
   host. To prevent this behavior, the ICMP redirect function MUST be
   disabled in the AR.

6. Security Considerations

   MAC Forced Forwarding is by nature a security function, ensuring
   layer-2 isolation between end-users sharing a broadcast access media.

   The solution MUST ensure that only authentic DHCP replies are used in
   the dynamic learning of AR addresses. One way is to reject any



Melsen                   Expires July 14, 2004                  [Page 6]

Internet-Draft           MAC Forced Forwarding              January 2004


   upstream DHCP replies, i.e. replies from end-users.

7. Acknowledgements

   Add any acknowledgements.

References

   [1]  Bradner, S., "The Internet Standards Process -- Revision 3", BCP
        9, RFC 2026, October 1996.

   [2]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", BCP 14, RFC 2119, March 1997.

   [3]  McPherson, D. and B. Dykes, "VLAN Aggregation for Efficient IP
        Address Allocation", RFC 3069, February 2001.

   [4]  Postel, J., "Internet Control Message Protocol", STD 5, RFC 792,
        September 1981.


Author's Address

   Torben Melsen
   Ericsson
   Faelledvej
   Struer  DK-7600
   Denmark

   EMail: Torben.Melsen@ericsson.com





















Melsen                   Expires July 14, 2004                  [Page 7]

Internet-Draft           MAC Forced Forwarding              January 2004


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; neither does it represent that it
   has made any effort to identify any such rights. Information on the
   IETF's procedures with respect to rights in standards-track and
   standards-related documentation can be found in BCP-11. Copies of
   claims of rights made available for publication and any assurances of
   licenses to be made available, or the result of an attempt made to
   obtain a general license or permission for the use of such
   proprietary rights by implementors or users of this specification can
   be obtained from the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights which may cover technology that may be required to practice
   this standard. Please address the information to the IETF Executive
   Director.


Full Copyright Statement

   Copyright (C) The Internet Society (2004). All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assignees.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION



Melsen                   Expires July 14, 2004                  [Page 8]

Internet-Draft           MAC Forced Forwarding              January 2004


   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.











































Melsen                   Expires July 14, 2004                  [Page 9]
