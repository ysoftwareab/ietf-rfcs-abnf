
      Internet Engineering Task Force                           Stephen Thomas
      INTERNET DRAFT                                               AT&T Tridom
      <draft-ietf-ipng-token-ring-01.txt>                     January 22, 1996


       A Method for the Transmission of IPv6 Packets over Token Ring Networks



      Status of this Memo

	 This document is an Internet Draft. Internet Drafts are working
	 documents of the Internet Engineering Task Force (IETF), its Areas,
	 and its Working Groups. Note that other groups may also distribute
	 working documents as Internet Drafts.

	 Internet Drafts are draft documents valid for a maximum of six
	 months. Internet Drafts may be updated, replaced, or obsoleted by
	 other documents at any time. It is not appropriate to use Internet
	 Drafts as reference material or to cite them other than as a
	 "working draft" or "work in progress."

	 To learn the current status of any Internet-Draft, please check the
	 ``1id-abstracts.txt'' listing contained in the Internet Drafts
	 Shadow Directories on ds.internic.net (US East Coast), nic.nordu.net
	 (Europe), ftp.isi.edu (US  West  Coast), or munnari.oz.au (Pacific
	 Rim).

	 Distribution of this memo is unlimited.


      Introduction

	 This memo specifies the frame format for transmission of IPv6 [IPV6]
	 packets and the method of forming IPv6 link-local addresses on Token
	 Ring networks [802.5]. It also specifies the content of the
	 Source/Target Link-layer Address option used by the Router
	 Solicitation, Router Advertisement, Neighbor Solicitation, and
	 Neighbor Advertisement messages described in [DISC], when those
	 messages are transmitted on a Token Ring. The memo concludes with a
	 description of the mapping of IPv6 multicast addresses to Token Ring
	 functional addresses.


      Acknowledgments

	 Several members of the IEEE 802.5 Working Group contributed their
	 knowledge and experience to the drafting of this specification,
	 including Jim, Andrew Draper, George Lin, John Messenger, Kirk
	 Preiss, and Trevor Warwick. The author would also like to thank many
	 members of the IPng working group for their advice and suggestions,






      Thomas                     Expires July 1996                    [Page 1]



      INTERNET-DRAFT            IPv6 over Token Ring          January 11, 1996


	 including Ran Atkinson, Scott Bradner, Matt Crawford, Steve Deering,
	 Francis Dupont, Robert Elz, Thomnas Narten, and Matt Thomas.


      IPv6 Encapsulation

	 IPv6 packets are transmitted in LLC/SNAP frames.  The data field
	 contains the IPv6 header and payload. The following figure shows a
	 complete 802.5 frame containing an IPv6 datagram.

			 +-------+-------+-------+-------+
			 |  SD   |  AC   |  FC   |       |
			 +-----------------------+       |
			 |      Destination Address      |
			 |       +-----------------------+
			 |       |     Source            |
			 +-------+    Address    +-------+
			 |                       | DSAP  |
			 +-------+-------+-------+-------+
			 | SSAP  |  CTL  |      OUI      |
			 +-------+-------+-------+-------+
			 |  OUI  |   EtherType   |       |
			 +-------+---------------+       |
			 |                               |
			 ~  IPv6 header and payload...   ~
			 |                               |
			 +-------------------------------+
			 |              FCS              |
			 +-------+-------+---------------+
			 |  ED   |  FS   |
			 +-------+-------+



	 In the presence of source route bridges, a routing information field
	 (RIF) may appear immediately after the source address. A RIF is
	 present in frames when the most significant bit of the source
	 address is set to one. (This is the bit whose position corresponds
	 to that of the Individual/Group bit in the Destination Address.)


      Token Ring Header Fields

	 SD - Starting Delimiter

	 AC - Access Control

	 FC - Frame Control





      Thomas                      Expires July 1996                   [Page 2]



      INTERNET-DRAFT            IPv6 over Token Ring          January 11, 1996


	 Destination Address - 48-bit IEEE address of destination station

	 Source Address - 48-bit IEEE address of source station

	 DSAP - Destination Service Access Point (for LLC/SNAP format, shall
		always contain the value 0xAA)

	 SSAP - Source Service Access Point (for LLC/SNAP format, shall
		always contain the value 0xAA)

	 CTL - Control Field (for Unnumbered Information, shall always
	       contain the value 0x03)

	 OUI - Organizationally Unique Identifier (for EtherType encoding,
	       shall always contain the value 0x000000)

	 EtherType - Protocol type of encapsulated payload (for IPv6, shall
		     always contain the value 0x86DD)

	 FCS - Frame Check Sequence

	 ED - Ending Delimiter

	 FS - Frame Status


      Maximum Transmission Unit

	 IEEE 802.5 networks have a maximum frame size based on the maximum
	 time a node may hold the token. This time depends on many factors
	 including the data signaling rate and the number of nodes on the
	 ring. Because the maximum frame size varies, implementations must
	 rely on static configuration or router advertisements [DISC] to
	 determine actual MTU sizes. Common default values include
	 approximately 2000, 4000, and 8000 octets.

	 In the absence of any other information, an implementation should
	 use a default MTU of 1500 octets. This size offers compatibility
	 with all common 802.5 defaults, as well as with Ethernet LANs in an
	 environment using transparent bridging.

	 In an environment using source route bridging, the process of
	 discovering the MAC-level path to a neighbor can yield the MTU for
	 the path to that neighbor. The information is contained in the
	 largest frame (LF) subfield of the routing information field. This
	 field limits the size of the information field of frames to that
	 destination, and that information field includes both the LLC
	 [802.2] header and the IPv6 datagram. Since, for IPv6, the LLC





      Thomas                      Expires July 1996                   [Page 3]



      INTERNET-DRAFT            IPv6 over Token Ring          January 11, 1996


	 header is always 8 octets in length, the IPv6 MTU can be found by
	 subtracting 8 from the maximum frame size defined by the LF
	 subfield. If an implementation uses this information to determine
	 MTU sizes, it must maintain separate MTU values for each neighbor.

	 A detailed list of the LF values and the resulting maximum frame
	 size can be found in [802.1D]. To illustrate the calculation of IPv6
	 MTU, the following table lists several common values. Note that some
	 of the 802.1D LF values would result in an IP MTU less than 576
	 bytes. This size is less than the IPv6 minimum, and communication
	 across paths with those MTUs is generally not possible using IPv6.

		LF (base)  LF (extension)   MAC MTU      IP MTU

		    001          000         1470         1462
		    010          000         2052         2044
		    011          000         4399         4391
		    100          000         8130         8122
		    101          000        11407        11399
		    110          000        17749        17741
		    111          000        41600        41592

	 When presented with conflicting MTU values from several sources, an
	 implementation should choose from those sources according to the
	 following priorities:

	    1. Largest Frame values from source route bridging (only for
	       specific, unicast destinations)

	    2. Router advertisements

	    3. Static configuration

	    4. Default of 1500


      Stateless Autoconfiguration and Link-local Addresses

	 The address token [CONF] for a Token Ring interface is the built-in
	 48-bit IEEE 802 address associated with that interface, in canonical
	 bit order. (Note: multiple interfaces on a system may share the same
	 IEEE 802 address.) A different MAC address set manually or by
	 software should not be used as the address token.

	 An IPv6 address prefix used for stateless autoconfiguration of a
	 Token Ring interface must be 80 bits in length.







      Thomas                      Expires July 1996                   [Page 4]



      INTERNET-DRAFT            IPv6 over Token Ring          January 11, 1996


	 The IPv6 Link-local address [AARCH] for a Token Ring interface is
	 formed by appending the interface's IEEE 802 address to the 80-bit
	 prefix FE80::.

			 +-------+-------+-------+-------+
			 |  FE      80      00      00   |
			 +-------+-------+-------+-------+
			 |  00      00      00      00   |
			 +-------+-------+-------+-------+
			 |  00      00   |               |
			 +-------+-------+               |
			 |      Token Ring Address       |
			 +-------+-------+-------+-------+


      Address Mapping - Unicast

	 The procedure for mapping IPv6 addresses into Token Ring link layer
	 addresses is described in [DISC]. The Source/Target Link Layer
	 Address option has the following form when the link layer is Token
	 Ring.

			 +-------+-------+-------+-------+
			 | Type  |Length |               |
			 +-------+-------+               |
			 |      Token Ring Address       |
			 +-------+-------+-------+-------+

	 Option Fields:

	 Type    1 for Source Link Layer Address
		 2 for Target Link Layer Address

	 Length  1 (in units of 8 octets)

	 Token Ring Address
		 The 48-bit IEEE 802 address, in canonical bit order.


      Address Mapping - Multicast

	 All IPv6 packets with multicast destination addresses are
	 transmitted to Token Ring functional addresses. The following table
	 shows the specific mapping between the IPv6 addresses and Token Ring
	 functional addresses (in canonical form). Note that protocols other
	 than IPv6 may use these same functional addresses, so all Token Ring
	 frames destined to these functional addresses are not guaranteed to
	 be IPv6 datagrams.





      Thomas                      Expires July 1996                   [Page 5]



      INTERNET-DRAFT            IPv6 over Token Ring          January 11, 1996


	 MAC Func Addr (canonical)       IPv6 Multicast Addresses

	    03 00 80 00 00 00        all nodes (FF0X::1) and solicited
				     node (FF02::1:XXXX:XXXX) addresses

	    03 00 40 00 00 00        all routers addresses (FF0X::2)

	    03 00 00 80 00 00        any other multicast address with three
				     least significant bits = 000

	    03 00 00 40 00 00        any other multicast address with three
				     least significant bits = 001

	    03 00 00 20 00 00        any other multicast address with three
				     least significant bits = 010

	    03 00 00 10 00 00        any other multicast address with three
				     least significant bits = 011

	    03 00 00 08 00 00        any other multicast address with three
				     least significant bits = 100

	    03 00 00 04 00 00        any other multicast address with three
				     least significant bits = 101

	    03 00 00 02 00 00        any other multicast address with three
				     least significant bits = 110

	    03 00 00 01 00 00        any other multicast address with three
				     least significant bits = 111


      Security Considerations

	 Security considerations are not addressed in this memo.


      References

	 [802.1D] IEEE Standards for Local and Metropolitan Area Networks:
	      Media Access Control (MAC) Bridges. ANSI/IEEE Std 802.1D, 1993
	      Edition.

	 [802.2] IEEE Standards for Local Area Networks: Logical Link
	      Control. ANSI/IEEE Std 802.2-1985.








      Thomas                      Expires July 1996                   [Page 6]



      INTERNET-DRAFT            IPv6 over Token Ring          January 11, 1996


	 [802.5] IEEE Standards for Local and Metropolitan Area Networks:
	      Token Ring Access Method and Physical Layer Specifications.
	      IEEE Std 802.5-1995.

	 [AARCH] R. Hinden, S. Deering, IP Version 6 Addressing Architecture.
	      RFC 1884.

	 [CONF]  S. Thomson, IPv6 Stateless Address Autoconfiguration.
	      Currently draft-ietf-addrconf-ipv6-auto-07.txt.

	 [DISC]  T. Narten, E. Nordmark, W. A. Simpson, Neighbor Discovery
	      for IP Version 6 (IPv6).  Currently draft-ietf-ipngwg-
	      discovery-03.txt.

	 [IPV6]  S. Deering, R. Hinden, Internet Protocol, Version 6 (IPv6)
	      Specification.  RFC 1883.


      Author's Address

	 Stephen Thomas
	 AT&T Tridom                 Phone: (770) 514-3522
	 840 Franklin Court          Fax:   (770) 514-3491
	 Marietta, GA 30067  USA     Email: stephen.thomas@tridom.com
























      Thomas                      Expires July 1996                   [Page 7]



