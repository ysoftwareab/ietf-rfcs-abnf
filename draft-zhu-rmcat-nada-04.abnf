q_avg = alpha*q + (1-alpha)*q_avg. 

alpha=1 corresponds to performing no smoothing at all. 

p = 0, if q < q_lo; 

                   q_avg - q_lo
p = p_max*--------------, if q_lo <= q < q_hi; 
                   q_hi - q_lo

p = 1, if q >= q_hi. 

p = 0, if b-b_tk < b_lo; 

                    b-b_tk-b_lo
p = p_max* --------------, if b_lo<= b-b_tk <b_hi; 
                     b_hi-b_lo

p = 1, if b-b_tk>=b_hi. 

x_n = t_r,n - t_s,n.   

d_n = x_n - d_f. 
 




x_n = d_n + p_M d_M + p_L d_L,      (1) 

theta = w*(R_max - R_min)*x_ref.    (4)

x_hat = x_n + eta*tao_o* x'_n       (5)




 




R_v = R_n - beta_v * -------.       (6) 
                              tau_v

R_s = R_n + beta_s * -------.       (7) 
                              tau_v

