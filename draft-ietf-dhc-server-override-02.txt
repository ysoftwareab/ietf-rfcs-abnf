


Network Working Group                                         R. Johnson
Internet-Draft                                             J. Jumarasamy
Expires: December 31, 2005                                    K. Kinnear
                                                                M. Stapp
                                                     Cisco Systems, Inc.
                                                           June 29, 2005


                   DHCP Server-ID Override Suboption
                 draft-ietf-dhc-server-override-02.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on December 31, 2005.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   This memo defines a new suboption of the DHCP relay information
   option [6] which allows the DHCP relay to specify a new value for the
   Server-ID option, which is inserted by the DHCP Server.  In some
   cases it is convenient for the DHCP relay to act as the actual DHCP
   server such that DHCP RENEWAL requests will come to the relay instead
   of going to the server directly.  This gives the relay the



Johnson, et al.         Expires December 31, 2005               [Page 1]

Internet-Draft      DHCP Server-ID Override Suboption          June 2005


   opportunity to include the Relay Agent option with appropriate
   suboptions even on RENEWAL messages.

Table of Contents

   1.   Introduction . . . . . . . . . . . . . . . . . . . . . . . . . 3
   2.   Server-ID Override Suboption Definition  . . . . . . . . . . . 4
   3.   Security Considerations  . . . . . . . . . . . . . . . . . . . 5
   4.   IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 6
   5.   Intellectual Property Rights and Copyright . . . . . . . . . . 7
   6.   References . . . . . . . . . . . . . . . . . . . . . . . . . . 7
        Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . 8
        Intellectual Property and Copyright Statements . . . . . . . . 9






































Johnson, et al.         Expires December 31, 2005               [Page 2]

Internet-Draft      DHCP Server-ID Override Suboption          June 2005


1.  Introduction

   There are many situations where the DHCP relay is involved and can
   insert a relay agent option with appropriate suboptions easily into
   DHCP DISCOVER messages.  Once the lease has been granted, however,
   future DHCP RENEWAL messages are sent directly to the DHCP Server as
   specified in the Server-ID option.  This means that the relay may not
   see the DHCP RENEWAL messages (depending upon network topology) and
   thus can not provide the same relay agent option information in the
   RENEWAL messages.

   This new DHCP relay agent suboption, Server-ID override, allows the
   relay to tell the DHCP server what value to place into the Server-ID
   option.  Using this, the relay agent can force RENEWAL messages to
   come to it instead of the server.  The relay may then insert the
   relay agent option with appropriate suboptions and relay the request
   to the actual server.  In this fashion the DHCP server will be
   provided with the same relay agent information upon renewals (such as
   Circuit-ID, Remote-ID, Device Class, etc.) as was provided in the
   initial DISCOVER message.  In effect, this makes a RENEWAL into a
   REBINDING.

   This new suboption could also be used by the DHCP relay in order to
   allow the relay to appear as the actual DHCP server to the client.
   This has the advantage that the relay can more easily keep up-to-date
   information about leases granted, etc.

   In short, this new suboption allows the DHCPv4 relay to function in
   the same fashion as the DHCPv6 relay currently does.






















Johnson, et al.         Expires December 31, 2005               [Page 3]

Internet-Draft      DHCP Server-ID Override Suboption          June 2005


2.  Server-ID Override Suboption Definition

   The format of the suboption is:

   Code   Len    Overriding Server-ID address
   +-----+-----+-----+-----+-----+-----+
   | TBD |  n  | a1  | a2  | a3  | a4  |
   +-----+-----+-----+-----+-----+-----+


                                 Figure 1

   The option length (n) is 4.  The octets "a1" through "a4" specify the
   value which SHOULD be inserted into the Server-ID option by the DHCP
   Server upon reply.

   DHCP Servers SHOULD use this value, if present, as the value to
   insert into the Server-ID option whenever responding to a DHCP
   Client.

   When servicing a DHCP REQUEST packet the DHCP Server would normally
   look at the Server-ID option for verification that the address
   specified there is one of the addresses associated with the DHCP
   Server, silently ignoring the REQUEST if it does not match a
   configured DHCP Server interface address.  If the REQUEST packet
   contains a Server-ID Override Suboption, however, comparison should
   be made between this suboption and the Server-ID option.  If both of
   the Server-ID Override Suboption and the Server-ID Option specify the
   same address, then the Server should accept the REQUEST packet for
   processing, regardless of whether or not the Server-ID Option matchs
   a DHCP Server interface.




















Johnson, et al.         Expires December 31, 2005               [Page 4]

Internet-Draft      DHCP Server-ID Override Suboption          June 2005


3.  Security Considerations

   Message authentication in DHCP for intradomain use where the out-of-
   band exchange of a shared secret is feasible is defined in [3].
   Potential exposures to attack are discussed in section 7 of the DHCP
   protocol specification in [2].

   The DHCP Relay Agent option depends on a trusted relationship between
   the DHCP relay agent and the server, as described in section 5 of RFC
   3046.  While the introduction of fraudulent relay-agent options can
   be prevented by a perimeter defense that blocks these options unless
   the relay agent is trusted, a deeper defense using the authentication
   option for relay agent options [4] SHOULD be deployed as well.

   If a rogue DHCP relay were inserted between the client and the
   server, it could redirect clients to it using this suboption.  This
   would allow such a system to later deny renew requests and thus force
   clients to discontinue use of their allocated address.  This
   interception, however, would need to be done during the initial
   DISCOVER and OFFER phase, since the suboption value SHOULD be ignored
   by the server during RENEWAL state.  Either DHCP Authentication [3]
   or DHCP Relay Agent option authentication [4] would address this
   case.




























Johnson, et al.         Expires December 31, 2005               [Page 5]

Internet-Draft      DHCP Server-ID Override Suboption          June 2005


4.  IANA Considerations

   None.
















































Johnson, et al.         Expires December 31, 2005               [Page 6]

Internet-Draft      DHCP Server-ID Override Suboption          June 2005


5.  Intellectual Property Rights and Copyright

   The IETF has been notified of intellectual property rights claimed in
   regard to some or all of the specification contained in this
   document.  For more information consult the online list of claimed
   rights.

   Copyright (C) The Internet Society (2004).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights."

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

6.  References

   [1]  Bradner, S., "Key words for use in RFCs to Indicate Requirement
        Levels", RFC 2119, BCP 14, March 1997.

   [2]  Droms, R., "Dynamic Host Configuration Protocol", RFC 2131,
        March 1997.

   [3]  Droms, R., "Authentication for DHCP Messages", RFC 3118,
        June 2001.

   [4]  Stapp, M., "The Authentication Suboption for the DHCP Relay
        Agent Option", RFC 4030, March 2005.

   [5]  Narten, T. and H. Alvestrand, "Guidelines for Writing an IANA
        Considerations Section in RFCs", RFC 2434, October 1998.

   [6]  Patrick, M., "DHCP Relay Agent Information Option", RFC 3096,
        November 2004.













Johnson, et al.         Expires December 31, 2005               [Page 7]

Internet-Draft      DHCP Server-ID Override Suboption          June 2005


Authors' Addresses

   Richard A. Johnson
   Cisco Systems, Inc.
   170 W. Tasman Dr.
   San Jose, CA  95134
   US

   Phone: +1 408 526 4000
   Email: raj@cisco.com


   Jay Kumarasamy
   Cisco Systems, Inc.
   170 W. Tasman Dr.
   San Jose, CA  95134
   US

   Phone: +1 408 526 4000
   Email: jayk@cisco.com


   Kim Kinnear
   Cisco Systems, Inc.
   170 W. Tasman Dr.
   San Jose, CA  95134
   US

   Phone: +1 408 526 4000
   Email: kkinnear@cisco.com


   Mark Stapp
   Cisco Systems, Inc.
   170 W. Tasman Dr.
   San Jose, CA  95134
   US

   Phone: +1 408 526 4000
   Email: mjs@cisco.com











Johnson, et al.         Expires December 31, 2005               [Page 8]

Internet-Draft      DHCP Server-ID Override Suboption          June 2005


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Disclaimer of Validity

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Copyright Statement

   Copyright (C) The Internet Society (2005).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.




Johnson, et al.         Expires December 31, 2005               [Page 9]

