<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IP Flow Anonymisation Support</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IP Flow Anonymisation Support">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IPFIX Working Group</td><td class="header">E. Boschi</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">B. Trammell</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">Hitachi Europe</td></tr>
<tr><td class="header">Expires: July 16, 2009</td><td class="header">January 12, 2009</td></tr>
</table></td></tr></table>
<h1><br />IP Flow Anonymisation Support<br />draft-boschi-ipfix-anon-02.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 16, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document describes anonymisation techniques for IP flow data and
    the export of anonymised data using the IPFIX protocol. It provides a
    categorization of common anonymisation schemes and defines the parameters
    needed to describe them. It provides guidelines for the implementation of
    anonymised data export and storage over IPFIX, and describes an
    Options-based method for anonymization metadata export within the
    IPFIX protocol, providing the basis for the definition of information
    models for configuring anonymisation techniques within an IPFIX Metering
    or Exporting Process, and for reporting the technique in use to an IPFIX
    Collecting Process.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
IPFIX Protocol Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#intro-docs">1.2.</a>&nbsp;
IPFIX Documents Overview<br />
<a href="#anchor3">2.</a>&nbsp;
Terminology<br />
<a href="#anchor4">3.</a>&nbsp;
Categorisation of Anonymisation Techniques<br />
<a href="#anchor5">4.</a>&nbsp;
Anonymisation of IP Flow Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.</a>&nbsp;
IP Address Anonymisation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.1.1.</a>&nbsp;
Truncation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.1.2.</a>&nbsp;
Random Permutation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.1.3.</a>&nbsp;
Prefix-preserving Pseudonymisation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.2.</a>&nbsp;
Timestamp Anonymisation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.2.1.</a>&nbsp;
Precision Degradation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.2.2.</a>&nbsp;
Enumeration<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.2.3.</a>&nbsp;
Random Time Shifts<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.3.</a>&nbsp;
Counter Anonymisation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.3.1.</a>&nbsp;
Precision Degradation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.3.2.</a>&nbsp;
Binning<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.3.3.</a>&nbsp;
Random Noise Addition<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.4.</a>&nbsp;
Anonymisation of Other Flow Fields<br />
<a href="#anchor19">5.</a>&nbsp;
Applying Anonymisation Techniques to IPFIX Export and Storage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.1.</a>&nbsp;
Arrangement of Processes in IPFIX Anonymisation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#guidelines">5.2.</a>&nbsp;
IPFIX-Specific Anonymisation Guidelines<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#header-anon">5.2.1.</a>&nbsp;
Anonymisation of Header Data<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#opt-anon">5.2.2.</a>&nbsp;
Anonymisation of Options Data<br />
<a href="#anchor21">6.</a>&nbsp;
Parameters for the Description of Anonymisation Techniques<br />
<a href="#anchor22">7.</a>&nbsp;
Anonymisation Metadata Support in IPFIX<br />
<a href="#anchor23">8.</a>&nbsp;
Security Considerations<br />
<a href="#anchor24">9.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor25">10.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The standardisation of an IP flow information export protocol <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> and associated representations removes a
    technical barrier to the sharing of IP flow data across organizational
    boundaries and with network operations, security, and research communities
    for a wide variety of purposes. However, with wider dissemination comes
    greater risks to the privacy of the users of networks under measurement,
    and to the security of those networks. While it is not a complete solution
    to the issues posed by distribution of IP flow information, anonymisation
    is an important tool for the protection of privacy within network
    measurement infrastructures.
</p>
<p>This document presents a mechanism for representing anonymised data
    within IPFIX and guidelines for using it. It begins with a categorization
    of anonymisation techniques. It then describes applicability of each
    technique to commonly anonymisable fields of IP flow data, organized by
    information element data type and semantics as in <a class='info' href='#RFC5102'>[RFC5102]<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; January&nbsp;2008.</span><span>)</span></a>; enumerates the parameters required by each of
    the applicable anonymisation techniques; and provides guidelines for the
    use of each of these techniques in accordance with best practices in data
    protection. Finally, it specifies a mechanism for exporting anonymised
    data and binding anonymisation metadata to templates using IPFIX
    Options.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
IPFIX Protocol Overview</h3>

<p>In the IPFIX protocol, { type, length, value } tuples are expressed
      in templates containing { type, length } pairs, specifying which { value
      } fields are present in data records conforming to the Template, giving
      great flexibility as to what data is transmitted. Since Templates are
      sent very infrequently compared with Data Records, this results in
      significant bandwidth savings. Various different data formats may be
      transmitted simply by sending new Templates specifying the { type,
      length } pairs for the new data format. See <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> for more information.
</p>
<p>The <a class='info' href='#RFC5102'>IPFIX information model<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5102] defines a
      large number of standard Information Elements which provide the
      necessary { type } information for Templates. The use of standard
      elements enables interoperability among different vendors'
      implementations. Additionally, non-standard enterprise-specific elements
      may be defined for private use.
</p>
<a name="intro-docs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
IPFIX Documents Overview</h3>

<p><a class='info' href='#RFC5101'>"Specification of the IPFIX
      Protocol for the Exchange of IP Traffic Flow Information"<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5101]
      and its associated documents
      define the IPFIX Protocol, which provides network engineers and
      administrators with access to IP traffic flow information.
</p>
<p><a class='info' href='#I-D.ietf-ipfix-architecture'>"Architecture for IP Flow
      Information Export"<span> (</span><span class='info'>Sadasivan, G., &ldquo;Architecture for IP Flow Information Export,&rdquo; September&nbsp;2006.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;architecture] defines
      the architecture for the export of measured IP flow information out of
      an IPFIX Exporting Process to an IPFIX Collecting Process, and the
      basic terminology used to describe the elements of this architecture,
      per the requirements defined in <a class='info' href='#RFC3917'>"Requirements
      for IP Flow Information Export"<span> (</span><span class='info'>Quittek, J., Zseby, T., Claise, B., and S. Zander, &ldquo;Requirements for IP Flow Information Export (IPFIX),&rdquo; October&nbsp;2004.</span><span>)</span></a> [RFC3917]. The IPFIX Protocol document
      <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> then covers the details of the method for
      transporting IPFIX Data Records and Templates via a congestion-aware
      transport protocol from an IPFIX Exporting Process to an IPFIX
      Collecting Process.
</p>
<p><a class='info' href='#RFC5102'>"Information Model for IP Flow Information
      Export"<span> (</span><span class='info'>Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;Information Model for IP Flow Information Export,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5102] describes the Information Elements used by IPFIX,
      including details on Information Element naming, numbering, and data
      type encoding. Finally, <a class='info' href='#I-D.ietf-ipfix-as'>"IPFIX
      Applicability"<span> (</span><span class='info'>Zseby, T., &ldquo;IPFIX Applicability,&rdquo; July&nbsp;2007.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;as] describes the various applications of the IPFIX
      protocol and their use of information exported via IPFIX, and relates
      the IPFIX architecture to other measurement architectures and
      frameworks.
</p>
<p>Additionally, the <a class='info' href='#I-D.ietf-ipfix-file'>"Specification
      of the IPFIX File Format"<span> (</span><span class='info'>Trammell, B., Boschi, E., Mark, L., Zseby, T., and A. Wagner, &ldquo;Specification of the IPFIX File Format,&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;file] describes a file format based upon the
      IPFIX Protocol for the storage of flow data.
</p>
<p>This document references the Protocol and Architecture documents for
      terminology, and extends the IPFIX Information Model to provide new
      Information Elements for anonymisation metadata. The anonymisation
      techniques described herein are equally applicable to the IPFIX Protocol
      and data stored in IPFIX Files.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>Terms used in this document that are defined in the Terminology section
    of the <a class='info' href='#RFC5101'>IPFIX Protocol<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5101] document are to be
    interpreted as defined there.
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
    document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC
    2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Categorisation of Anonymisation Techniques</h3>

<p>Anonymisation modifies a data set in order to
    protect the identity of the people or entities described by the data set
    from disclosure. With respect to network traffic data, anonymisation
    generally attempts to preserve some set of properties of the network
    traffic useful for a given application or applications, while ensuring the
    data cannot be traced back to the specific networks, hosts, or users
    generating the traffic.
</p>
<p>Anonymisation may be broadly classified according to two properties:
    recoverability and countability. All anonymisation techniques map the real
    space of identifiers or values into a separate, anonymised space,
    according to some function. A technique is said to be recoverable when the
    function used is invertible or can otherwise be reversed and a real
    identifier can be recovered from a given replacement identifier.
</p>
<p>Countability compares the dimension of the anonymised space (N) to the
    dimension of the real space (M), and denotes how the count of unique
    values is preserved by the anonymisation function. If the anonymised space
    is smaller than the real space, then the function is said to generalise
    the input, mapping more than one input point to each anonymous value
    (e.g., as with aggregation). By definition, generalisation is not
    recoverable.
</p>
<p>If the dimensions of the anonymised and real spaces are the
    same, such that the count of unique values is preserved, then the function
    is said to be a direct substitution function. If the dimension of the
    anonymised space is larger, such that each real value maps to a set of
    anonymised values, then the function is said to be a set substitution
    function. Note that with set substitution functions, the sets of
    anonymised values are not necessarily disjoint. Either direct or set
    substitution functions are said to be one-way if there exists no method
    for recovering the real data point from an anonymised one.
</p>
<p>This classification is summarised in the table below.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Recoverability / Countability</th><th align="left">Recoverable</th><th align="left">Non-recoverable</th></tr>
<tr>
<td align="left">N &lt; M </td>
<td align="left">N.A.</td>
<td align="left">Generalisation</td>
</tr>
<tr>
<td align="left">N = M </td>
<td align="left">Direct Substitution</td>
<td align="left">One-way Direct Substitution</td>
</tr>
<tr>
<td align="left">N &gt; M </td>
<td align="left">Set Substitution</td>
<td align="left">One-way Set Substitution</td>
</tr>
</table>
<br clear="all" />

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Anonymisation of IP Flow Data</h3>

<p>Due to the restricted semantics of IP flow data, there are a relatively
    limited set of specific anonymisation techniques available on flow data,
    though each falls into the broad categories above. Each type of field that
    may commonly appear in a flow record may have its own applicable specific
    techniques.
</p>
<p>While anonymisation is generally applied at the resolution of single
    fields within a flow record, attacks against anonymisation use entire
    flows and relationships between hosts and flows within a given data set.
    Therefore, fields which may not necessarily be identifying by themselves
    may be anonymised in order to increase the anonymity of the data set as a
    whole.
</p>
<p>Of all the fields in an IP flow record, only IP addresses directly
    identify entities in the real world. Each IP address is associated with an
    interface on a network host, and can potentially be identified with a
    single user. Additionally, IP addresses are structured identifiers; that
    is, partial IP address prefixes may be used to identify networks just as
    full IP addresses identify hosts. This makes anonymisation of IP addresses
    particularly important.
</p>
<p>Port numbers identify abstract entities (applications) as opposed to
    real-world entities, but they can be used to classify hosts and user
    behavior. Passive port fingerprinting, both of well-known and ephemeral
    ports, can be used to determine the operating system running on a host.
    Relative data volumes by port can also be used to determine the host's
    function (workstation, web server, etc.); this information can be used to
    identify hosts and users.
</p>
<p>While not identifiers in and of themselves, timestamps and counters
    can reveal the behavior of the hosts and users on a network. Any given
    network activity is recognizable by a pattern of relative time differences
    and data volumes in the associated sequence of flows, even without host
    address information. They can therefore be used to identify hosts and
    users. Timestamps and counters are also vulnerable to traffic injection
    attacks, where traffic with a known pattern is injected into a network
    under measurement, and this pattern is later identified in the anonymised
    data set. 
</p>
<p>The simplest and most extreme form of anonymisation, which can be
    applied to any field of a flow record, is black-marker anonymisation, or
    complete deletion of a given field. Note that black-marker anonymisation
    is equivalent to simply not exporting the field(s) in question.
</p>
<p> While black-marker anonymisation completely protects the data in
    the deleted fields from the risk of disclosure, it also reduces the
    utility of the anonymised data set as a whole. Techniques that retain some
    information while reducing (though not eliminating) the disclosure risk
    will be extensively discussed in the following sections; note that the
    techniques specifically applicable to IP addresses, timestamps, and
    counters will be discussed in separate sections.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
IP Address Anonymisation</h3>

<p>The following table gives an overview of the schemes for IP address
      anonymization described in this document and their categorization.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Scheme</th><th align="left">Action</th><th align="left">Reversibility</th></tr>
<tr>
<td align="left">Truncation</td>
<td align="left">Generalisation</td>
<td align="left">N</td>
</tr>
<tr>
<td align="left">Random Permutation</td>
<td align="left">Direct Substitution</td>
<td align="left">Y/N</td>
</tr>
<tr>
<td align="left">Prefix-preserving Pseudonymisation</td>
<td align="left">Direct Substitution</td>
<td align="left">Y</td>
</tr>
</table>
<br clear="all" />

<p>Note that random permutations might be either reversible or not,
      depending on the function used.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Truncation</h3>

<p>Truncation removes "n" of the least significant bits from an IP
        address. Note that truncating 8 bits would replace an IP address with
        the corresponding class C network address.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Random Permutation</h3>

<p>Random permutation replaces each IP address with a unique address
        randomply selected from the set of possible IP addresses. The
        permutation function is implementable using a hash table to ensure
        uniqueness.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
Prefix-preserving Pseudonymisation</h3>

<p>Prefix-preserving pseudonymisation preserves the structure of
        subnets at each level while anonymising IP addresses. If two real IP
        addresses match on a prefix of "n" bits, the two anonymised IP
        addresses will match on a prefix of "n" bits as well.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Timestamp Anonymisation</h3>

<p>[TODO: introductory text]
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Scheme</th><th align="left">Action</th><th align="left">Reversibility</th></tr>
<tr>
<td align="left">Precision Degradation</td>
<td align="left">Generalisation</td>
<td align="left">N</td>
</tr>
<tr>
<td align="left">Enumeration</td>
<td align="left">Direct or Set Substitution</td>
<td align="left">Y</td>
</tr>
<tr>
<td align="left">Random Shifts</td>
<td align="left">Direct Substitution</td>
<td align="left">Y</td>
</tr>
</table>
<br clear="all" />

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Precision Degradation</h3>

<p>Precision Degradation removes the most precise components of a
        timestamp, accounting all events occurring in each given interval
        (e.g. one millisecond for millisecond level degradation) as
        simultaneous. This has the effect of potentially collapsing many
        timestamps into one. With this technique time precision is reduced,
        and sequencing may be lost, but the information at which time the
        event occurred is preserved.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Enumeration</h3>

<p>Enumeration keeps the chronological order in which events occurred
        while eliminating time information. Timestamps are substituted by
        equidistant timestamps (or numbers) starting from an randomly chosen
        start value.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Random Time Shifts</h3>

<p>Random Time Shifts keep the information on how far apart two events
        are from each other. This is achieved by shifting all timestamps by
        the same random number. Note that random time shifts also preserve
        chronological order.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Counter Anonymisation</h3>

<p>Counters (such as packet and octet volumes per flow) are subject to
      fingerprinting and injection attacks against anonymisation, as
      timestamps are, but relative magnitudes of activity can be useful for
      certain analysis tasks. [TODO: more intro text]
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Scheme</th><th align="left">Action</th><th align="left">Reversibility</th></tr>
<tr>
<td align="left">Precision Degradation</td>
<td align="left">Generalisation</td>
<td align="left">N</td>
</tr>
<tr>
<td align="left">Binning</td>
<td align="left">Generalisation</td>
<td align="left">N</td>
</tr>
<tr>
<td align="left">Random noise addition</td>
<td align="left">Direct or Set Substitution</td>
<td align="left">N</td>
</tr>
</table>
<br clear="all" />

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Precision Degradation</h3>

<p>As with precision degradation in timestamps, precision degradation of
    counters removes lower-order bits of the counters, treating all the
    counters in a given range as having the same value. Depending on the
    precision reduction, this loses information about the relationships
    between sizes of similarly-sized flows, but keeps relative magnitude
    information.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Binning</h3>

<p>Binning can be seen as a special case of precision degradation; the
    operation is identical, except for in precision degradation the counter
    ranges are uniform, and in binning they need not be. For example, a common
    counter binning scheme for packet counters could be to bin values 1-2
    together, and 3-infinity together, thereby separating potentially
    completely-opened TCP connections from unopened ones. Binning schemes are
    generally chosen to keep precisely the amount of information required in a
    counter for a given analysis task
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Random Noise Addition</h3>

<p>Random noise addition adds a random amount to a counter in each flow;
    this is used to keep relative magnitude information and minimize the
    disruption to size relationship information while avoiding fingerprinting
    attacks against anonymization.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Anonymisation of Other Flow Fields</h3>

<p>[TODO: as section 4.1]
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Applying Anonymisation Techniques to IPFIX Export and Storage</h3>

<p>When exporting or storing anonymised flow data using IPFIX, certain
    interactions between the IPFIX Protocol and the anonymisation techniques
    in use must be considered; these are treated in the subsections below.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Arrangement of Processes in IPFIX Anonymisation</h3>

<p>Anonymisation may be applied to IPFIX data at three stages within a
      the collection infrastructure: on initial export, at a mediator, or
      after collection, as shown in <a class='info' href='#loc-fig'>Figure&nbsp;1<span> (</span><span class='info'>Potential Anonymisation Locations</span><span>)</span></a>. Each of these
      locations has specific considerations and applicability.
</p><br /><hr class="insert" />
<a name="loc-fig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                    +--------------------+
                    | IPFIX File Storage |
                    +--------------------+
                      ^
                      | (Anonymised after collection)
                      |
            +=======================================+
            | Collecting Process                    |
            +=======================================+
              ^                                   ^
              | (Anonymised at mediator)          |
              |                                   |
            +=============================+       |
            | Mediator                    |       |
            +=============================+       |
              ^                                   |
              |    (Anonymised on initial export) |
              |                                   |
            +=======================================+
            | Exporting Process                     |
            +=======================================+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Potential Anonymisation Locations&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Anonymisation is generally performed before the wider dissemination
      or repurposing of a flow data set, e.g., adapting operational
      measurement data for research. Therefore, direct anonymisation of flow
      data on initial export is only applicable in certain restricted
      circumstances: when the Exporting Process is "publishing" data to a
      Collecting Process directly, and the Exporting Process and Collecting
      Process are operated by different entities. Note that certain guidelines
      in <a class='info' href='#header-anon'>Section&nbsp;5.2.1<span> (</span><span class='info'>Anonymisation of Header Data</span><span>)</span></a> with respect to timestamp anonymisation
      may not apply in this case, as the Collecting Process may be able to
      deduce certain timing information from the time at which each Message is
      received.
</p>
<p>A much more flexible arrangement is to anonymise data within a <a class='info' href='#I-D.ietf-ipfix-mediators-framework'>Mediator<span> (</span><span class='info'>Kobayashi, A., Claise, B., Muenz, G., and K. Ishibashi, &ldquo;IPFIX Mediation: Framework,&rdquo; April&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;mediators&#8209;framework]. Here,
      original data is sent to a Mediator, which performs the anonymisation
      function and re-exports the anonymised data. Such a Mediator could be
      located at the administrative domain boundary of the initial Exporting
      Process operator, exporting anonymised data to other consumers outside
      the organisation. In this case, the original Exporter SHOULD use TLS as
      specified in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> to secure the channel to the
      Mediator, and the Mediator should follow the guidelines in <a class='info' href='#guidelines'>Section&nbsp;5.2<span> (</span><span class='info'>IPFIX-Specific Anonymisation Guidelines</span><span>)</span></a>, to mitigate the risk of original data
      disclosure.
</p>
<p>When data is to be published as an anonymised data set in an <a class='info' href='#I-D.ietf-ipfix-file'>IPFIX File<span> (</span><span class='info'>Trammell, B., Boschi, E., Mark, L., Zseby, T., and A. Wagner, &ldquo;Specification of the IPFIX File Format,&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;file], the anonymisation may be
      done at the final Collecting Process before storage and dissemination,
      as well. In this case, the Collector should follow the guidelines in
      <a class='info' href='#guidelines'>Section&nbsp;5.2<span> (</span><span class='info'>IPFIX-Specific Anonymisation Guidelines</span><span>)</span></a>, especially as regards File-specific
      Options in <a class='info' href='#opt-anon'>Section&nbsp;5.2.2<span> (</span><span class='info'>Anonymisation of Options Data</span><span>)</span></a> 
</p>
<p>Note that anonymisation may occur at more than one location within a
      given collection infrastructure, to provide varying levels of
      anonymisation reversal risk and utility for specific purposes.
</p>
<a name="guidelines"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
IPFIX-Specific Anonymisation Guidelines</h3>

<p>In implementing and deploying the anonymisation techniques described
      in this document, care must be taken that data structures supporting the
      operation of the protocol itself do not leak data that could be used to
      reverse the anonymisation applied to the flow data. Such data structures
      may appear in the header, or within the data stream itself, especially
      as options data. Each of these and their impact on specific
      anonymisation techniques is noted in a separate subsection below.
</p>
<a name="header-anon"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Anonymisation of Header Data</h3>

<p>Each IPFIX Message contains a Message Header; within this Message
        Header are contained two fields which may be used to break certain
        anonymisation techniques: the Export Time, and the Observation Domain
        ID
</p>
<p>Export of IPFIX Messages containing anonymised timestamp data where
        the original Export Time Message header has some relationship to the
        anonymised timestamps SHOULD anonymise the Export Time header field
        using an equivalent technique, if possible. Otherwise, relationships
        between export and flow time could be used to partially or totally
        reverse timestamp anonymisation.
</p>
<p>The similarity in size between an Observation Domain ID and an IPv4
        address (32 bits) may lead to a temptation to use an IPv4 interface
        address on the Metering or Exporting Process as the Observation Domain
        ID. If this address bears some relation to the IP addresses in the
        flow data (e.g., shares a network prefix with internal addresses) and
        the IP addresses in the flow data are anonymised in a
        structure-preserving way, then the Observation Domain ID may be used
        to break the IP address anonymisation. Use of an IPv4 interface
        address on the Metering or Exporting Process as the Observation Domain
        ID is NOT RECOMMENDED in this case.
</p>
<p>[EDITOR'S NOTE: We might want to see if anyone is actually doing
        this with IPFIX. The example comes from other network measurement
        tools (e.g. Argus) which default to using an IPv4 address as a sensor
        ID.]
</p>
<a name="opt-anon"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
Anonymisation of Options Data</h3>

<p>IPFIX uses the Options mechanism to export, among other things,
        metadata about exported flows and the flow collection infrastructure.
        As with the IPFIX Message Header, certain Options recommended in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-ipfix-file'>the IPFIX
        File Format<span> (</span><span class='info'>Trammell, B., Boschi, E., Mark, L., Zseby, T., and A. Wagner, &ldquo;Specification of the IPFIX File Format,&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;file] containing flow timestamps and network addresses of
        Exporting and Collecting Processes may be used to break certain
        anonymisation techniques; care should be taken while using them with
        anonymised data export and storage.
</p>
<p>The Exporting Process Reliability Statistics Options Template,
        recommended in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>, contains an Exporting Process
        ID field, which may be an exportingProcessIPv4Address Information
        Element or an exportingProcessIPv6Address Information Element. If the
        Exporting Process address bears some relation to the IP addresses in
        the flow data (e.g., shares a network prefix with internal addresses)
        and the IP addresses in the flow data are anonymised in a
        structure-preserving way, then the Exporting Process address may be
        used to break the IP address anonymisation. Exporting Processes
        exporting anonymised data in this situation SHOULD mitigate the risk
        of attack either by omitting Options described by the Exporting
        Process Reliability Statistics Options Template, or by anonymising the
        Exporting Process address using a similar technique to that used to
        anonymise the IP addresses in the exported data.
</p>
<p>Similarly, the Export Session Details Options Template and Message
        Details Options Template specified for the <a class='info' href='#I-D.ietf-ipfix-file'>IPFIX File Format<span> (</span><span class='info'>Trammell, B., Boschi, E., Mark, L., Zseby, T., and A. Wagner, &ldquo;Specification of the IPFIX File Format,&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;file] may contain the
        exportingProcessIPv4Address Information Element or the
        exportingProcessIPv6Address Information Element to identify an
        Exporting Process from which a flow record was received, and the
        collectingProcessIPv4Address Information Element or the
        collectingProcessIPv6Address Information Element to identify the
        Collecting Process which received it. If the Exporting Process or
        Collecting Process address bears some relation to the IP addresses in
        the flow data (e.g., shares a network prefix with internal addresses)
        and the IP addresses in the flow data are anonymised in a
        structure-preserving way, then the Exporting Process or Collecting
        Process address may be used to break the IP address anonymisation.
        Since these Options Templates are primarily intended for storing IPFIX
        Transport Session data for auditing, replay, and testing purposes, it
        is NOT RECOMMENDED that storage of anonymised data include these
        Options Templates in order to mitigate the risk of attack.
</p>
<p>The Message Details Options Template specified for the <a class='info' href='#I-D.ietf-ipfix-file'>IPFIX File Format<span> (</span><span class='info'>Trammell, B., Boschi, E., Mark, L., Zseby, T., and A. Wagner, &ldquo;Specification of the IPFIX File Format,&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;file] also contains
        the collectionTimeMilliseconds Information Element. As with the Export
        Time Message Header field, if the exported flow data contains
        anonymised timestamp information, and the collectionTimeMilliseconds
        Information Element in a given Message has some relationship to the
        anonymised timestamp information, then this relationship can be
        exploited to reverse the timestamp anonymisation. Since this Options
        Template is primarily intended for storing IPFIX Transport Session
        data for auditing, replay, and testing purposes, it is NOT RECOMMENDED
        that storage of anonymised data include this Options Template in order
        to mitigate the risk of attack.
</p>
<p>Since the Time Window Options Template specified for the <a class='info' href='#I-D.ietf-ipfix-file'>IPFIX File Format<span> (</span><span class='info'>Trammell, B., Boschi, E., Mark, L., Zseby, T., and A. Wagner, &ldquo;Specification of the IPFIX File Format,&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.ietf&#8209;ipfix&#8209;file] refers to the
        timestamps within the flow data to provide partial table of contents
        information for an IPFIX File, care must be taken to ensure that
        Options described by this template are written using the anonymised
        timestamps instead of the original ones.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Parameters for the Description of Anonymisation Techniques</h3>

<p>[TODO: see corresponding section of draft-ietf-psamp-sample-tech for
    the proposed structure of this section.] 
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Anonymisation Metadata Support in IPFIX</h3>

<p>[TODO: Here we'll describe how the information specified above can be
    transmitted on the wire using an option template. The idea is to scope the
    option to the Template ID and for each field specify which are anonymised,
    providing info on the output characteristics of the technique, and which
    ones aren't.]
</p>
<p>[EDITOR'S NOTE: Multiple anon. techniques applied on an IE at the same
    time is indicated with multiple elements of the same type (in application
    order as in PSAMP)]
</p>
<p>[EDITOR'S NOTE: for blackmarking we'll recommend not to export the
    information at all following the data protection law principle that only
    necessary information should be exported.]
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>[TODO: write this section.]
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This document contains no actions for IANA.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgments</h3>

<p>We thank Paul Aitken for his comments and insight, and the PRISM
    project for its support of this work.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5101">[RFC5101]</a></td>
<td class="author-text">Claise, B., &ldquo;<a href="http://tools.ietf.org/html/rfc5101">Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information</a>,&rdquo; RFC&nbsp;5101, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5101.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5102">[RFC5102]</a></td>
<td class="author-text">Quittek, J., Bryant, S., Claise, B., Aitken, P., and J. Meyer, &ldquo;<a href="http://tools.ietf.org/html/rfc5102">Information Model for IP Flow Information Export</a>,&rdquo; RFC&nbsp;5102, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5102.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-as">[I-D.ietf-ipfix-as]</a></td>
<td class="author-text">Zseby, T., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-as-12.txt">IPFIX Applicability</a>,&rdquo; draft-ietf-ipfix-as-12 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-as-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-architecture">[I-D.ietf-ipfix-architecture]</a></td>
<td class="author-text">Sadasivan, G., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-architecture-12.txt">Architecture for IP Flow Information Export</a>,&rdquo; draft-ietf-ipfix-architecture-12 (work in progress), September&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-architecture-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-file">[I-D.ietf-ipfix-file]</a></td>
<td class="author-text">Trammell, B., Boschi, E., Mark, L., Zseby, T., and A. Wagner, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-file-05.txt">Specification of the IPFIX File Format</a>,&rdquo; draft-ietf-ipfix-file-05 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-file-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-mediators-framework">[I-D.ietf-ipfix-mediators-framework]</a></td>
<td class="author-text">Kobayashi, A., Claise, B., Muenz, G., and K. Ishibashi, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-mediators-framework-06.txt">IPFIX Mediation: Framework</a>,&rdquo; draft-ietf-ipfix-mediators-framework-06 (work in progress), April&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-mediators-framework-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3917">[RFC3917]</a></td>
<td class="author-text">Quittek, J., Zseby, T., Claise, B., and S. Zander, &ldquo;<a href="http://tools.ietf.org/html/rfc3917">Requirements for IP Flow Information Export (IPFIX)</a>,&rdquo; RFC&nbsp;3917, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3917.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Elisa Boschi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hitachi Europe</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">c/o ETH Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gloriastrasse 35</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">8092 Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Switzerland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+41 44 632 70 57</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:elisa.boschi@hitachi-eu.com">elisa.boschi@hitachi-eu.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Trammell</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hitachi Europe</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">c/o ETH Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gloriastrasse 35</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">8092 Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Switzerland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+41 44 632 70 13</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:brian.trammell@hitachi-eu.com">brian.trammell@hitachi-eu.com</a></td></tr>
</table>
</body></html>
