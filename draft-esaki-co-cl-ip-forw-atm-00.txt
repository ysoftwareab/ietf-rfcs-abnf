INTERNET DRAFT                                                   
draft-esaki-co-cl-ip-forw-atm-00.txt                            H. Esaki 
                                                               K. Nagami
                                                     Toshiba Corporation
                                                                 M. Ohta 
                                           Tokyo Institute of Technology 
                                                        October 14, 1994

           Connection Oriented and Connectionless IP Forwarding 
                         Over ATM Networks 

Status of this Memo

   This document is an Internet-Draft.  Internet-Drafts are working
   documents of the Internet Engineering Task Force (IETF), its areas,
   and its working groups.  Note that other groups may also distribute
   working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six
   months.  Internet-Drafts may be updated, replaced, or obsoleted by
   other documents at any time.  It is not appropriate to use Internet-
   Drafts as reference material or to cite them other than as a
   ``working draft'' or ``work in progress.''

   To learn the current status of any Internet-Draft, please check the
   1id-abstracts.txt listing contained in the Internet-Drafts Shadow
   Directories on ds.internic.net, nic.nordu.net, ftp.nisc.sri.com, or
   munnari.oz.au.

Abstract

   The framework of high throughput with small latent IP packet 
   delivery architecture using ATM technology in large scaled 
   heterogeneous internets keeping the current commubication  
   paradigm is studied.
   This memo discusses on how to carry TCP/IP over ATM, or,
   in general, how to carry connectionless and/or connection
   oriented network layer protocol over connection oriented
   QoS-ed datalink layer. Low latency property of ATM is fully
   extracted both for connectionless and connection oriented
   communication over TCP/IP without changing the current
   architecture of TCP/IP network.

   Regarding connection oriented IP packet forwarding, source host, 
   having the mapping functionality between flow-ID (e.g. in the 
   SIPP16 header)  and  VCI/VPI value, forwards connection oriented 
   IP packets cell-by-cell.

   Connectionless IP packets can be also transferred cell-by-cell
   through the dedicated (concatenated) ATM-VCCs which bypass IP 
   processing at the intermediate routers, when the cache for 
   re-directed ATM-VCCs is hit.  Otherwise, they will be forwarded 
   to the adjacent router (hop-by-hop IP forwarding).  
   Also, the active connectionless IP packet flow can use a 



Esaki, Nagami & Ohta    Expires on April. 20, 1995                [Page 1]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


   dedicated ATM-VCC as a IP forwarding cache.  Connectionless IP 
   packet is forwarded cell-by-cell, instead of packet-by-packet, 
   as far as the connectionless IP packet flow is in active state.   


1. Introduction 
---------------

ATM is recognized as one of the platforms to provide high speed QOS 
(Quality of Service) data-link layer service. Here, the QOS data-link 
layer service can be end-to-end, rather than link-by-link, in ATM 
networks. But, it should be still recognized as a data-link layer 
service, rather than network layer service.  ATM network provides 
both connection oriented service and connectionless network leyer 
service (e.g.current IP forwarding) topping on connection oriented 
VCCs, which could have a certain QOS.

Physical or logical data-link network segments, including ATM-LANs,
will be interconnected through routers (network layer entity), even 
when the ATM becomes major data-link platform.

This draft proposes high speed and small latent IP packet delivery
architecture over the Internet, using ATM technology. Regarding 
connectionless service, we can provide the small latent IP packet 
delivery using ATM bypass route, not only for IPv6 network but also 
for IPv4 network. And, connectionless IP packet can be forwarded 
cell-by-cell using the dedicated (concatenated) ATM-VCC, as far as 
the connectionless IP packet flow is in active state. 

Regarding connection oriented (network layer) service, we can 
provide high throughput small latent IP packet delivery using
end-station's mapping functionality between flow-ID in the IP packet
header and VCI/VPI value.  Also, when router has a mapping capability 
between the network layer QOS parameter (flow-spec) and the ATM's 
QOS parameter, end-to-end network layer QOS will be provided.

The proposed architecture can be applied to all of ATM network 
architecture discussed in IETF and in ATM Forum [LANE][CLIP][MBMA]
[NHRP].  The proposed architecture can improve the performance of 
IP forwarding beyond IP subnet and can include short cut routing 
discussed in [NHRP]. 

Here, though this draft only discusses regarding ATM technology, 
the technique discussed in this draft can be generally applied 
to other communication platforms that are based on connection 
oriented technology (e.g. Frame Relay).  


2. Internet Architecture including ATM-LANs
-------------------------------------------
2.1. Network Architecture in ATM Forum and IETF
  Models developed at LE-WG (LAN Emulation Working Group) of ATM


Esaki, Nagami & Ohta    Expires on April. 20, 1995                [Page 2]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


Forum and at ATM-WG and ROLC(Routing Over Large Cloud)-WG of IETF 
are discussed [CLIP][NBMA].

Basically following three architecture models are discussed. 
Let say them as CLIP-model, NBMA-model and COIP-model, in this 
draft. We did not discuss LAN Emulation Model of ATM Forum, because
the essential issue addressed here in LAN Emulation Model of ATM 
Forum is the same as the issue in CLIP-model. 

2.1.0. IP-model
    To operate a network with a lot of hosts and some redundant
paths, the network should divided into several data-link network
segments, which are interconnected by routers.  It would be
recommended that each data-link network segment should accommodates
only one IP subnet (network layer segment). This is the current
network architecture in the Internet. And, both from the
distributed application's point of view and from the network
management's point of view, the data-link network segment
(including ATM-LAN) should have broadcast capability. This is
because broadcast is the only way to communicate with other
end-stations (or routers) without prior knowledge of their
addresses.

2.1.1. CLIP-model [CLIP]
   Generally, (logical) IP subnets will overlay topping on a
single ATM network segment, which may be large scaled network.
This means that several end-stations which generally belong to
different IP subnets will exist on a single (ATM-ed) data-link
segment.
   IP subnets are interconnected by the routers, which are completely
the same as the current routers.  The router in [CLIP] has only IP
forwarding capability, but it does not have cell relaying capability.
This means that ATM-VCC shall be always terminated at router.
Therefore, it is impossible to provide end-to-end QOS-ed virtual
connection using CLIP-model, without some protocols discussed in
IETF, e.g.[RSVP].  Here, even when RSVP is applied in CLIP model,
datagram transferring is still performed by IP packet level and it
causes both delay and HOL (Head Of Line) blocking at router.
Also, since the IP packet must be always reassembled at the router
(i.e. packet-by-packet forwarding), every IP packet experiences IP 
packet reassembling delay.  

2.1.2. NBMA-model [NBMA][NHRP]
   Logical IP subnets will overlay on a single ATM data-link network 
segment.   NBMA-subnet is defined as that the network domain where 
end-to-end ATM-VCC can be established.  Within the NBMA-subnet, each 
end-station can establish (seamless) ATM-VCC toward any end-host that 
is located at other IP subnet, without passing through a router, 
i.e. short-cut routing.  However, when the IP packet should be 
transferred to out-side the NBMA-subnet, IP packet will be 
transferred to the boarder router between two NBMA-subnet. This means 
that, even if the neighbor NBMA-subnet


Esaki, Nagami & Ohta    Expires on April. 20, 1995                [Page 3]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


is also ATM network, it is impossible to establish end-to-end ATM-VCC
using IP address. Then, we can not obtain high performed IP packet 
forwarding beyond NBMA subnet.
   Here, the segmentation of the large scaled network into multiple 
NBMA subnets may be realized due to security concern.  Therefore, 
the routers locating at the edge of NBMA subnets may perform 
security functionaloties, e.g. fire-wall function.   

2.1.3. COIP-model [Ohta] 
   COIP-model is just same as IP-model for all the connectionless
and most of the connection oriented IP flows. But, some connection
oriented traffic may be mapped to multiple datalink layer ATM VCCs.
On routers, ATM-VCCs are conceptually terminated at router but
actually relayed cell-by-cell.
   As the model allows moderately small datalink layer without
losing direct connectivity of ATM, it is possible to introduce
subnet-wide broadcast capability.

2.2. Internet Architecture including ATM Platforms 
    The network segment (autonomous system) using ATM technology
will increase in the future. However, ATM-LANs are interconnected
each other vis routers, as well as other network platform (e.g.high 
speed Ethernet, FFOL or Fibre Channel).  And, the old network platform 
must be smoothly replaced by ATM technology or by the other high 
speed platforms. Also, from the network operation point of view, 
the each network segment would be rationally small, and be operated 
independently.
    Since transmission of cells over WAN may be costly, outgoing
(or incoming) cell VCCs would be aggregated into fewer VCCs.
In a WAN environment, the user may want to open very few VCs and
cell flows from a lot of end-stations would be connected to few
VCCs to cross the WAN. Also, the signaling protocol would be
different between the WAN environment and LAN environment.
    ATM-LAN is composed of switch nodes, and the interface between 
the adjacent network segment is UNI or NNI.  Data-link segment 
may be identical to IP subnet.  Or, the IP subnets may overlay 
over large cloud data-link network.  But, IP subnets are 
interconnected by routers.  And, data-link network segment may 
have multiple switching nodes (cell-relaying entities), or may have 
only a single switching node in it.  The latter case is that every 
switching node has both cell-relaying functionality and IP forwarding 
functionality so as to concatenate individual ATM-VCCs which are 
provided by ATM-LANs, while each switch node has its own IP subnet. 

The key functionalities of the proposed router, that interconnects
ATM networks (below represented as ATM router) are as follows.

 (1) Cell Relaying 
    Cells are relayed as ATM layer's function.  Since the
    assignment of VCI/VPI value is performed independently
    at individual ATM-LAN, router has the VCI/VPI translation
    functionality. Since IP processing can be bypassed by


Esaki, Nagami & Ohta    Expires on April. 20, 1995                [Page 4]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


    ATM layer cell relaying at router, the transmission
    latency to pass through the router can be sufficiently
    small, which is the same as an ATM switch node.
 (2) End-to-end connection oriented data transfer channel set-up
    During a set-up procedure of end-to-end connection oriented
    (or sometimes said as resource reservation oriented) data 
    transfer channel, e.g.RSVP with SIPP, routers co-operate
    with the connection (ATM-VCC as data-link connection)
    establishment servers' in the ATM-LANs. And, also, we can
    achieve higher throughput than the conventional hop-by-hop
    IP forwarding by the router can. For example, the VCI/VPI
    translation table that concatenates ATM-VCCs provided by 
    indvidual ATM-LANs will be established during the channel 
    set-up procedure.
 (3) VCC multiplexing/de-multiplexing
    When communication cost over the WAN is costly, cell flows
    crossing WAN would be aggregated at the router. And,
    aggregated packet flows into few ATM-VCC would be
    de-multiplexed at the router.
 (4) Security Functionality (if necessary)
    Since every cell (or could be say packet) passes through
    the router, the segmentation of subnet can be fulfilled as
    well as the current Internet architecture. For instance,
    the proposed router can equip security functionalities,
    e.g. packet filtering in fire-wall function. The proposed
    router can equip security functionalities, that is,
    unauthorized packets are filered just as usual firewall
    and unauthorized reservation request packets for cell
    relaying are rejected.

Routers are network entity which interconnect several IP subnets. 
Routers exchange routing information and maintain routing information 
tables to forward the received packet. Logically, each packet is 
relayed to the optimal interface by looking up the routing tables. 
But, actually, routers don't have to consult with routing table 
everytime they receive a packet. Implementations are free to have 
internal cache or bypass to minimize the packet routing delay of 
complex table looking up. Likewise, the proposed routers don't have 
to consult routing table everytime they receive a cell. 
Implementations are free to have internal bypass to remove the 
packet reconstruction delay and packet routing delay of complex 
table looking up.


3. Network Reference Model 
-------------------------- 

The following four are the network reference models discussed 
in this draft. In the following referenced models, every router 
in each model is the router that this draft proposes. 




Esaki, Nagami & Ohta    Expires on April. 20, 1995                [Page 5]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


3.1. CLIP model 
   Large cloud network accommodates multiple logical IP subnets 
   (LISs). In the figure, two sets of router and end-host 
   belonging to the different LISs are shown. IP packet from host A.1 
   toward host B.1 passes through Router A.0 and Router B.0.   
   When the IP packet flow from host A.1 to host B.1 is either 
   active flow or connection oriented IP transport flow, the 
   IP packet will be forwarded without IP forwarding process in 
   the router.  Also, IP packet can be forwarded through a direct 
   ATM-VCC from Router A.0 to Router B.0. 
   Here, IP packet may pass through the intermediate routers, that 
   forwards IP packet cell-by-cell (not packet-by-packet through 
   IP forwarding process), to reach at Router B.0. 


          < Router A.0 > 
         +----------------+ 
         | +------------+ |  
         | | IP forward | |  
         | +------+-----+ | 
         |        |       | 
         | +------+-----+ | 
         | | cell relay | |      +----------+  
         | +------------+ |      | Host_A.1 |   
         +----------------+      +----------+  
                  |                    |  
                  |                    |  
            +------------------------------+ 
            |                              | 
            |                              | 
            |      Large Cloud Network     | 
            |(ATM-VCC switching capability)| 
            |                              | 
            |                              | 
            +------------------------------+ 
                  |                    |  
                  |                    | 
         +----------------+      +----------+  
         | +------------+ |      | Host_B.1 |  
         | | cell relay | |      +----------+  
         | +------+-----+ | 
         |        |       | 
         | +------+-----+ | 
         | | IP forward | |  
         | +------+-----+ | 
         +----------------+ 
          < Router B.0 >  

                    (FIG.1  CLIP model) 
                     ^^^^^^^^^^^^^^^^^




Esaki, Nagami & Ohta    Expires on April. 20, 1995                [Page 6]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


3.2. NBMA model 
   NBMA subnet accommodates multiple logical IP subnets (LISs). 
   In the figure, two end-hosts belonging to the different LIS, but 
   belonging to the same NBMA subnet are shown.  In order to transfer 
   the IP packet (both connection oriented IP packet and connectionless 
   IP packet) from host A.x.1 to host A.y.1, host A.x.1 resolve the 
   ATM address of host A.y.1 or the ATM address of some entity 
   (e.g. router similar in CLIP model) relaying the IP packets to 
   host A.y.1 using NHRP server.  Then, IP packet from host A.x.1 to 
   host A.y.1 could pass through so called short-cut route.  Short-cut 
   route may bypass the intermediate router(s), physically. 
      IP packet from host A.x.1 toward host B.z.1 passes through 
   Router, which is located at the edge point of NBMA subnets. When 
   the IP packet flow from host A.x.1 to host B.z.1 is either active 
   flow or connection oriented IP transport flow, the IP packet will 
   be forwarded without IP forwarding process in the router, as well 
   as in the NBMA subnet.  

             +------------+ 
             | Host_A.x.1 |  
             +------------+ 
                  | 
           +-------------------+ 
           |                   |    +-------------+  
           |                   +----| NHRP Server | 
           |  NBMA subnet A.0  |    +-------------+  
           |                   |    +------------+  
           |                   +----| Host_A.y.1 | 
           |                   |    +------------+  
           +-------------------+ 
                  | 
               +-------------------------+ 
               | +-------+   +---------+ | 
               | | cell  |   |   IP    | |    <----------- Router  
               | | relay +---+ forward | |  
               | +-------+   +---------+ | 
               +-------------------------+ 
                  | 
           +-------------------+ 
           |                   |    +------------+  
           |                   +----| Host_B.z.1 | 
           |  NBMA subnet B.0  |    +------------+  
           |                   |    +-------------+
           |                   +----| NHRP Server |
           |                   |    +-------------+
           +-------------------+ 

                    (FIG.2  NMBA model) 
                     ^^^^^^^^^^^^^^^^^





Esaki, Nagami & Ohta    Expires on April. 20, 1995                [Page 7]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


3.3. COIP model 
   Data-link network segment is identical to IP subnet.  Therefore, 
   IP packet beyond IP subnet must always pass router which is 
   located at the edge of data-link network segments.  In order to 
   transfer the IP packet (both connection oriented IP packet and 
   connectionless IP packet) from host A.1 to host B.1, host A.1 
   may resolve the ATM address of Router. Router relay the received 
   IP packet toward host B.1. When the IP packet flow from host A.1 
   to host B.1 is either active flow or connection oriented IP 
   transport flow, the IP packet will be forwarded without IP 
   forwarding process in the router. 

                +----------+ 
         A      | Host_A.1 | 
         |      +----------+ 
         |           | 
         |      +---------------+ 
  Subnet |      |  Switch node  | 
   A.0   |      +---------------+ 
         |           | 
         |      +-------------------------+ 
         V      | +-------+   +---------+ | 
                | | cell  |   |   IP    | |  <------------- Router  
         A      | | relay +---+ forward | |  
         |      | +-------+   +---------+ | 
         |      +-------------------------+ 
         |           | 
         |      +---------------+ 
  Subbet |      |  Switch node  | 
   B.0   |      +---------------+ 
         |           | 
         |      +---------------+     +----------+  
         |      |  Switch node  |-----| Host_B.1 |  
         |      +---------------+     +----------+  
         |          | 
         |      +-------------------------+ 
         V      | +-------+   +---------+ | 
                | | cell  |   |   IP    | |  <------------- Router  
                | | relay +---+ forward | |  
                | +-------+   +---------+ | 
                +-------------------------+ 
                    | 
  
                    (FIG.3  COIP model) 
                     ^^^^^^^^^^^^^^^^^

3.4. Router Interconnection model 
   Data-link network segment is identical to a single switching 
   node and also is identical to IP subnet. Therefore, IP packet 
   beyond IP subnet must always pass router (i.e. switching node). 
   In order to transfer the IP packet (both connection oriented 
   IP packet and connectionless IP packet) from host A.1 to host 


Esaki, Nagami & Ohta    Expires on April. 20, 1995                [Page 8]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


   C.1, host A.1 transfer IP packet to the router (i.e. switching 
   node) whose subnet ID is A.0.  Routers (A.0, B.0 and C.0) relay 
   the received IP packet toward host C.1.  When the IP packet flow 
   from host A.1 to host C.1 is either active flow or connection 
   oriented IP transport flow, the IP packet will be forwarded 
   without IP forwarding process in the router. 


           < Subnet A.0 >         < Subnet B.0 >         < Subnet C.0 > 
         +----------------+     +----------------+     +----------------+ 
         | +------------+ |     | +------------+ |     | +------------+ |  
         | | IP forward | |     | | IP forward | |     | | IP forward | |  
         | +-----+------+ |     | +-----+------+ |     | +-----+------+ |  
         |       |        |     |       |        |     |       |        | 
         | +-----+------+ |     | +-----+------+ |     | +-----+------+ |  
    -----+ | cell relay | +-----+ | cell relay | +-----+ | cell relay | +---  
         | +------------+ |     | +------------+ |     | +------------+ | 
         +----------------+     +----------------+     +----------------+ 
              /                                              \  
             /                                                \ 
        +----------+                                     +----------+ 
        | Host_A.1 |                                     | Host_C.1 |  
        +----------+                                     +----------+  

                    (FIG.4  Router Interconnection model) 
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^



4. Connection Oriented Service Architecture
-------------------------------------------
    Currently, the connection oriented IP transport flow (i.e.
network layer connection oriented service or sometime said as 
resource reservation oriented service) has been discussed in
IETF, e.g. [RSVP][SIPP1].  The goal of connection oriented
communications is to provide end-to-end IP transport.  Such a
transport flow can have a certain QOS.  In such IP transport flow,
there is an admission policy at network layer level, that is
similar concept to CAC (Connection Admission Control) in ATM
network.  When the IP transport flow set up request is admitted,
the resource for the transport flow is reserved at corresponding
routers.  Here, in order to find out the next network (or can be
said router) that the IP transport flow should be routed, some
kind of routing protocol (e.g. similar to OSPF) is executed
among the routers.
    The architecture proposed in this section assumes QOS-ed 
communication over not only ATM but also other types of platform, 
using the concept of connection oriented IP transport.  In each 
router the connection oriented IP transport is mapped into data-link 
layer connection (ATM-VCC) provided by the ATM networks.
    Connection oriented data-link network (e.g.ATM) can provide
QOS-ed connection between any data-link SAPs (Service Access Point)


Esaki, Nagami & Ohta    Expires on April. 20, 1995                [Page 9]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


within the data-link network segment through connection set up
procedure. Communication beyond data-link network segment is
performed by QOS-ed IP transport flow to the router. When the
data-link network segment is connection oriented, router or
source end-station establishes QOS-ed data-link connection (e.g.
ATM-VCC) toward the router.  Router performs the same procedure,
until the IP transport flow setting up message is reached at the
destination end-station.
    After the IP transport flow is established, IP packets are
forwarded through the QOS-ed pipe. A unique identifier, called
flow-ID, could be used along the IP transport flow [SIPP1][RSVP].
Within the ATM network, VCI/VPI can be used instead of flow-ID
defined in IP layer.
    The IP packet forwarding procedure is as follows.

     (1) Packet arrives at router.
     (2) Flow-ID and IP address (source/destination) are
         checked and next hop router is determined.
     (3) TTL (Time To Live) is decremented.
     (4) Unless the router is destination end-station, packet
         is forwarded.

This procedure is not ATM specific and it is applicable to all
other platform. Three cases are discussed below.

 I. ATM-LAN --> ATM-LAN
    Router has mapping table between ingress VCI/VPI and
    egress VCI/VPI for each cell flow according to the
    appropriate IP transport flow. Then, it is unnecessary to
    examine the flow-ID and IP address in step (2) :
    "Re-direction" (concatenation) of ingress and egress data-link 
    connection.  Here, mapping table is established during connection
    set up procedure.

     (1) Cell arrives at router
     (2) VCI/VPI of ingress cell is examined and the next
         hop VCI/VPI of egress cell is determined (maybe by
         hardware)
     (3) TTL in IP header may not be decremented
     (4) Unless the router is destination end-station, cell is
         forwarded.

 II. ATM-LAN --> Other-LAN
    Router will just reassemble IP packet to forward it to the
    appropriate router or end-station.

     (1) Cell arrives at router
     (2) IP packet is reassembled (e.g. AAL5)
     (3) Flow-ID and IP address (source/destination) is examined
         and the next hop router is determined.
     (4) TTL in IP header is decremented
     (5) Unless the router is destination end-station, packet is
         forwarded.

Esaki, Nagami & Ohta    Expires on April. 20, 1995               [Page 10]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


 III. Other-LAN --> ATM-LAN
    Router has mapping table between ingress flow-ID/IP-address and
    egress VCI/VPI for each IP transport flow. Here, again, the
    mapping table is established during connection set up procedure.
    Here, the TTL decrement value in step 3 may not be one.
    This because, within the ATM-LANs, the TTL of IP packet header
    is not dealt with at the bypassed router, even when
    the IP packet passes through the router.

     (1) Packet arrives at router
     (2) Flow-ID and IP address (source/destination) is examined
         and the next hop VCI/VPI of egress cell is determined.
     (3) TTL in IP header is decremented (may not be one)

When ATM end-stations communicates purely over ATM-LANs, a seamless
end-to-end cell-relaying virtual channel can be established between
them.  It should be noted that, even though many ATM-VCCs (data-link
connection) are concatenated at data-link layer, the seamless connection
over ATM-LANs is at network layer connection (not data-link layer
connection).


5. Connectionless Service Architecture
--------------------------------------
5.1. Connectionless Service over ATM Networks
    Connection oriented service must perform IP level connection 
set-up procedure, before transferring the information.  It is said 
that connection set up latency for a large scaled ATM network would 
be small [Schmt].  On the contrary, connectionless service does not
require IP level connection set up procedure, basically. ATM-VCC 
(data-link connection), in order to provide connectionless service, 
has been established in advance.  Here, ATM-VCCs to provide 
connectionless (conventional IP forwarding) service would be SPVC
(Semi-Permanent VC) or SVC (Switched VC), rather than PVC (Permanent 
VC). Once the VC(s) for connectionless service is(are) established,
there will be no connection set up latency to transfer
connectionless IP packet. Therefore, even when ATM networks and
other networks provide end-to-end connection oriented data transmission
service, connectionless service will be still important.  And, from
the view point of co-existence with the data-link network that is not
connection oriented (e.g. FFOL), connectionless data transmission
service (i.e. conventional IP forwarding) must be provided by the
ATM networks.

5.2. Connectionless Services in Conventional Data Networks
    In IP networks, IP processing will be generally performed,
whenever the IP packet is transferred to other data-link network
segment [Comer].  This means that, in a large scaled network, the
IP packet will experience many IP processing points between source
and destination end-stations.  Therefore, in the large scaled 
network, the large delay for IP packet delivery is expected, due 
to large number of IP processing points.  This is similar to CLS 


Esaki, Nagami & Ohta    Expires on April. 20, 1995               [Page 11]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


(ConnectionLess Server) approach defined by ITU-T [I.364].
    Each router can directly recognize the destination subnet
(i.e.Net-ID) of the received IP packet, as the address view of 
routing domain. However, the network layer protocol (e.g. IP) is 
performed at every router to terminate data-link layer (i.e. MAC). 
As a result, even the distance associated with the address 
management view is small, the distance associated with the 
data-link layer's view is not small.

5.3. Proposed Connectionless Service Architecture
   Connectionless IP packet transmission in the proposed architecture
is fundamentally no different from that of existing IP forwarding.
Within the data-link network segment, end-station and routers
exchange the IP packet using data-link connection (e.g.ATM-VCC).
IP packet beyond the data-link segment is sent to a appropriate
router from source end-station.  If a router has some knowledge 
on local topology (e.g. topology information in routing domain) 
that it can determine not only the next but also the second or
third next hops, it is possible to bypass IP layer processing
on the intermediate routers, by having direct ATM connection
between distant routers.
    Routers exchange routing information and forward IP packets 
to the appropriate router.  Following discussion is regarding 
the network that has only ATM-LANs. Regarding toward the other 
types of platform from ATM network, ATM-VCC shall be always 
terminated at the router to execute conventional IP forwarding 
process.  On the contrary, regarding toward ATM network from 
the other types of platform, you can see the router as the
end-station in the following discussion.
    The proposed ATM router has both cell relaying and IP forwarding
capabilities.  IP packet toward the out-side ATM-LAN where the source
end-station belongs to is sent to a appropriate router from the
source end-station.  Routers exchange routing information and
forward packets to the appropriate router. Regarding the current
routing protocol (e.g. OSPF), every router does know all of
subnet IDs (Net-IDs) within the domain where the routing protocol
is applied.

5.3.1. Hop-by-hop ATM-VCC cacheing for active IP flow
    When the first (of session or of after idle period) IP packet
arrives at router (attaching to ATM), the next router is decided
using IP header, i.e.  route decision will be done based on IP
address (and flow-ID in IPv6). After certain next router is
decided, a dedicated ATM-VCC is picked up for the IP packet flow.  
When the packet is come from ATM (or connection-oriented platform,
e.g. Frame Relay), router maps between incoming VCI/VPI (or some 
flow-ID in data-link layer)and (picked up) outgoing VCI/VPI.  When 
the packet is coming from the conventional platform (e.g. 
Ethernet/FDDI), router always examine IP header in the case of IPv4 
(in IPv6, flow-ID could be mapped with outgoing VCI/VPI). When IP 
packet is come from ATM, the successive IP packet is forwarded 
based on incoming VCI/VPI value, without any usual IP processing.


Esaki, Nagami & Ohta    Expires on April. 20, 1995               [Page 12]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


    If the activity of IP packet flow is/becomes low, the mapping
information (i.e. cached information) is pushed out.  That means
that the pushed out IP packet flow from cache must be examined
usual IP processing (looking at IP header) at the router.
As a result, high activity IP packet flow can bypass a usual
IP processing at the router.
    Above procedure is performed at every router (e.g. intermediate
router that interconnects ATM networks). Then, intermediate
router can deal with high activity IP packet flow with very
small latency.  This is because IP packet forwarding is done by
cell relaying, which will be done by hardware. The job of router
is maintaining VCI/VPI mapping table in the cell switch, or is
maintaining mapping table between flow-ID and VCI/VPI, as a
cache (bypass) processing path for usual IP forwarding process.
    When every data-link segment is ATM, small latent IP packet
forwarding will be provided, even for connectionless IP packet.
This is because IP packet is relayed by cell-by-cell at every
routers, regarding active IP packet flow.

5.3.2. Bypassed ATM VCC for active transaction
    When routers knows that it will have or is having a lot of
communication with a certain router (or subnet), it may create
bypass ATM connection (ATM-VCC) which is seamlessly connects
the two routers.  This bypasses ATM-VCC cuts through the IP
processing at the intermediate routers along the cell
transmission route between the two routers.  On the other hand,
when router does not use bypassed ATM-VCC for datagram
forwarding, the datagram will be forwarded hop-by-hop way, that
is completely same approach as the current IP forwarding.
    When router can establish a seamless ATM-VCC bypassing
the intermediate router's network layer protocol processing
along the routing path to the destination end-station, we can
reduce the end-to-end datagram delivery latency due to
the reducing the number of network layer protocol processing
points at the intermediate routers.  Here, it is unnecessary
to propagate the information of such bypassed ATM-VCC for every
routers.  The information of bypassed ATM-VCC shall be maintained
by the source and destination routers associated with the
bypassed ATM-VCCs.  This means that the routing protocol and routing
information exchanged among routers is nothing different from the
existing routing protocol.
    The information and path regarding bypassed IP forwarding process
at the intermediate router(s) could be seen as a cache image 
associated with the information and path for hop-by-hop route (i.e. 
conventional IP forwarding route).  When the cache is missed (i.e. 
when there is no bypass route), the hop-by-hop information is 
referenced and the IP packet is forwarded to the adjacent router. 
On the contrary, when the cache is hit (i.e. when a bypass route 
exists associated with the destination subnet), the cache information
is referenced and the IP packet is forwarded using the bypass
route.
    The establishment of bypass route will be issued by the


Esaki, Nagami & Ohta    Expires on April. 20, 1995               [Page 13]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


following two cases.  Here, source router and destination router
used in this subsection can be intermediate router, from the
view point of end-stations.  This means that source (or
destination) router may not directly connected the source (or
destination) end-station through a single ATM-VCC. In other
words, in order to reach source router from source end-station
(or to reach destination end-station from destination router),
intermediate router(s) may be required.

 (1) Source router
    Source router has activity information regarding the
    destination subnet's.  When the IP forwarding activity
    toward the certain destination subnet is high, the source
    router establishes the bypass ATM-VCC toward the
    destination subnet's router. When the activity becomes
    low, the established bypass ATM-VCC will be teared down
    (i.e. cache information is pushed out).
    Bypassed ATM-VCC from the source router toward the  
    destination router can be established without activity 
    information.  This means that bypass ATM-VCC can be 
    established both dynamically and statistically based on 
    network's configurational information.     
    * Here, NBMA net's short-cut routing can be realized  
      when we assume that the creating bypass route is 
      performed at ATM-VCC establishment phase (i.e. signaling 
      phase) for connection oriented IP service or when we 
      assume that the creating bypass route is performed 
      during address  resolution procedure for connectionless 
      IP service.
      These procedure can be analogous to "re-direction" 
      procedure in RFC1620, or can be analogous to ARP 
      procedure in NHRP [RFC1620][NHRP].   

 (2) Intermediate router (cell-relay re-direction)
    When the intermediate router becomes high load, the
    intermediate router can create bypass routes that is
    bypassing itself.  The intermediate router establishes
    the bypass  ATM-VCC for active source and destination router
    pair.  After the establishment of two ATM-VCCs, that are
    (a) from source router to intermediate router and (b) from
    intermediate router to destination router, these two
    ATM-VCCs are coupled at the intermediate router.
    This procedure could be seen as re-direction of cell-relaying :
    i.e. the cell-relaying coming from the source router to IP
    forwarding entity in the intermediate router is "re-directed"
    to the cell-relaying entity toward the destination router.

The ideal and optimal case is full meshed ATM-VCCs are established
among all of routers that are exists in the routing entry of
routing information. 
    Obviously, the every host can act as same as the router discussed
above (i.e. you can see the router as a end-station).  Then, the


Esaki, Nagami & Ohta    Expires on April. 20, 1995               [Page 14]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


seamless cell transmission channel will be established, i.e.
(a) from source end-station to router, (b) from source end-station
to destination end-station, and (c) from router to destination
end-station.


6. Summary
----------
High throughput small latent datagram (IP packet) delivery
architecture using ATM technology is proposed in this contribution.
Using the ATM's cell relaying capability at router, we can provide
high throughput small latent end-to-end IP packet delivery. The 
proposed architecture can be generally applied to all of network 
reference model discussed in IETF and ATM Forum. 
    Regarding connection oriented IP packet transmission, since 
the router can map between flow-ID (and IP address) in the IP packet 
header and VCI/VPI, we can reduce the IP processing latency at the 
routes within the ATM network.
    Regarding connectionless IP packet transmission, we can also
reduce the IP processing latency at the routers within the ATM 
networks, through the re-direction (bypassing) technique at the 
routers.  When the proposed architecture is applied, we can reduce 
the processing load of each router, as well as reducing end-to-end 
packet delivery delay.  This is because, due to the bypassing IP 
processing by re-direct technique, the amount of IP processing for 
intermediate IP packets can be reduced.


Acknowledgement :
   The authors thanks to many ATM experts in JAIN consortium
in Japan for many discussion regarding the proposed architecture
in this paper.  And, the authors appreciate many discussions with
Mr.Oumar Ndiaye, who belonged to MIT in USA, regarding a primary 
consideration on the software implementation of the proposed 
architecture.



















Esaki, Nagami & Ohta    Expires on April. 20, 1995               [Page 15]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994


References
----------

[I.150] ITU-T Rec.I.150 : "BISDN Asynchronous Transfer Mode", 1990
[I.364] ITU-T Rec.I.364 : "Support of Broadband Connectionless
         Data Service on BISDN", June, 1992
[ATM Forum] ATM Forum : "ATM UNI Specification 3.0", Aug.1993
[Schmit] A.Schmidt, R.Campbell : "Internet Protocol Traffic
         Analysis with Applications for ATM Switch Design",
         Computer Communications Review, vol.23, No.2, pp.39-52,
         April, 1993
[CLIP] M.Laubach ;"Classical IP and ARP over ATM", RFC1577, Jan., 1994.
[NBMA] J.Heinanen ;"NBMA Address Resolution Protocol", (Internet-Draft),
       draft-ietf-atm-nbma-01.txt, June, 1993
[NHRP] D.Katz, D.Piscitello ;"NBMA Next Hop Resolution Protocol (NHRP)", 
       (Internet-Draft), draft-ietf-rolc-nhrp-02.txt, Aug., 1994    
[RFC1620] B.Braden, J.Postel, Y.Rekhter, "Internet Architecture
          Extensions for Shared Media", RFC 1620, May, 1994.
[SIPP1] S.Deering : "Simple Internet Protocol Plus (SIPP)
        Specification (128-bit address version)", (Internet-Draft),
        draft-ietf-sipp-spec-01.txt, July, 1994
[SIPP2] P.Francis, S.Deering, R.Hinden, R.Govindan : "Simple
        Internet Protocol Plus (SIPP) : Addressing Architecture",
        (Internet-Draft), draft-ietf-sipp-routing-addr-02.txt,
        July, 1994
[IPng] F.Kastenholz, C.Partridge : "Technical Criteria for Choosing
       IP:The Next Generation (IPng)" (Internet-Draft),
       draft-kastenholz-ipng-criteria-02.txt, May, 1994
[RSVP] L.Zhang ;"Resource ReSerVation Protocol (RSVP)", (Internet-Draft),
        draft-ietf-rsvp-spec-02.ps, May, 1994
[Ohta] M.Ohta, H.Esaki, K.Nagami ;"Conventional IP over ATM",
       (Internet-Draft) draft-ohta-ip-over-atm-01.txt, July, 1994
[Comer] D.E.Comer : "Internetworking with TCP/IP", Prentice Hall,
        1991
[Esaki1] H.Esaki, Y.Tsuda, T.Saito, S.Natsubori : "Class D Service
         Architecture in ATM-Internet", ICC'94, May, 1994.
[Esaki2] H.Esaki, Y.Tsuda, T.Saito, S.Natsubori : "Datagram
         Delivery in an ATM-Internet", IEICE Trans. on Communications,
         Special Issues for Future Private Networks, March, 1994















Esaki, Nagami & Ohta    Expires on April. 20, 1995               [Page 16]
 
INTERNET DRAFT      CO&CL IP Forwarding Over ATM Network       October1994

 
Authors' Addresses

      Hiroshi Esaki
      R&D Center, Toshiba Corporation
      1 Komukai-Toshiba-cho, Saiwai-ku
      Kawasaki 210, JAPAN

      Phone: +81-44-549-2238
      Fax:   +81-44-549-2262
      EMail: hiroshi@csl.rdc.toshiba.co.jp


      Ken-ichi Nagami
      R&D Center, Toshiba Corporation
      1 Komukai-Toshiba-cho, Saiwai-ku
      Kawasaki 210, JAPAN

      Phone: +81-44-549-2238
      Fax:   +81-44-549-2262
      EMail: nagami@csl.rdc.toshiba.co.jp

      Masataka Ohta
      Computer Center
      Tokyo Institute of Technology
      2-12-1, O-okayama, Meguro-ku
      Tokyo 152, JAPAN

      Phone: +81-3-5434-3299
      Fax: +81-3-5734-3415
      EMail: mohta@necom830.cc.titech.ac.jp
























Esaki, Nagami & Ohta    Expires on April. 20, 1995               [Page 17]
