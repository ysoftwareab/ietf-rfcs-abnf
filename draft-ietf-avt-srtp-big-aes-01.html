<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The use of AES-192 and AES-256 in Secure RTP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The use of AES-192 and AES-256 in Secure RTP">
<meta name="keywords" content="SRTP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. McGrew</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">July 06, 2009</td></tr>
<tr><td class="header">Expires: January 7, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />The use of AES-192 and AES-256 in Secure RTP<br />draft-ietf-avt-srtp-big-aes-01.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 7, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
This memo describes the use of the Advanced Encryption Standard (AES)
with 192 and 256 bit keys within the Secure RTP protocol.  It defines
Counter Mode encryption for SRTP and SRTCP and a new SRTP Key
Derivation Function (KDF) for AES-192 and AES-256.

</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Conventions Used In This Document<br />
<a href="#encryption">2.</a>&nbsp;
AES-192 and AES-256 Encryption<br />
<a href="#KDF">3.</a>&nbsp;
The AES_192_CM_PRF and AES_256_CM_PRF Key Derivation Functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IV">3.1.</a>&nbsp;
Usage Requirements<br />
<a href="#cryptosuites">4.</a>&nbsp;
Crypto Suties<br />
<a href="#iana">5.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">6.</a>&nbsp;
Security Considerations<br />
<a href="#testCases">7.</a>&nbsp;
Test Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">7.1.</a>&nbsp;
AES-256-CM Test Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">7.2.</a>&nbsp;
AES_256_CM_PRF Test Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">7.3.</a>&nbsp;
AES-192-CM Test Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">7.4.</a>&nbsp;
AES_192_CM_PRF Test Cases<br />
<a href="#anchor7">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
This memo describes the use of the Advanced Encryption Standard (AES)
<a class='info' href='#FIPS197'>[FIPS197]<span> (</span><span class='info'>, &ldquo;The Advanced Encryption Standard (AES),&rdquo; .</span><span>)</span></a> with 192 and 256 bit keys within the Secure
RTP protocol <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>.  Below those block ciphers are
referred to as AES-192 and AES-256, respectively, and the use of AES
with a 128 bit key is referred to as AES-128.  This document defines
Counter Mode encryption for SRTP and SRTCP and a new SRTP Key
Derivation Function for AES-192 and AES-256.  It also defines new
cryptosuites that use these new functions.

</p>
<p>
While AES-128 is widely regarded as more than adequately secure, some
users may be motivated to adopt AES-192 or AES-256.  One motivation is
conformance to the Suite B profile (which requires AES-256 for the
protection of TOP SECRET information) <a class='info' href='#suiteB'>[suiteB]<span> (</span><span class='info'>, &ldquo;Fact Sheet for NSA Suite B Cryptography,&rdquo; .</span><span>)</span></a>.  Others
may be motivated by a perceived need to purse a highly conservative
security strategy; see <a class='info' href='#Security'>Section&nbsp;6<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> for more discussion
of security issues.

</p>
<p>
The crypto functions defined in this document are an addition to, and not
a replacement for, the crypto functions defined in <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Conventions Used In This Document</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.

</p>
<a name="encryption"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
AES-192 and AES-256 Encryption</h3>

<p>
Section 4.1.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a> defines AES-128 counter mode
encryption, which it refers to as AES_CM.  
 AES-192 counter mode and AES-256 counter mode are defined in a
similar manner, and are denoted as AES_192_CM and AES_256_CM
respectively.  In both of these ciphers, the plaintext inputs to the
block cipher are formed as in AES_CM, and the block cipher outputs are
processed as in AES_CM.  The only difference in the processing is that
AES_192_CM uses AES-192, and AES_256_CM uses AES-256.  Both AES_192_CM
and AES_256_CM use a 112-bit salt as an input, as does AES_CM.

</p>
<p>
For the convenience of the reader, the structure of the counter blocks
in SRTP counter mode encryption is illustrated in <a class='info' href='#CMfig'>Figure&nbsp;1<span> (</span><span class='info'>AES Counter Mode.  </span><span>)</span></a>,
using the terminology from Section 4.1.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a> .
In this diagram, the symbol (+) denotes the bitwise exclusive-or operation, and
the AES encrypt operation uses AES-128, AES-192, or AES-256 for
AES_CM, AES_192_CM, and AES_256_CM, respectively.  The field labeled
b_c contains a block counter, the value of which increments once for
each invocation of the "AES Encrypt" function.

</p><br /><hr class="insert" />
<a name="CMfig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
one octet
 &lt;--&gt;
  0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
 |00|00|00|00|   SSRC    |   packet index  | b_c |---+
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+   |
                                                     |
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+   v
 |                  salt (k_s)             |00|00|-&gt;(+)
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+   |
                                                     |
                                                     v
                                              +-------------+
                      encryption key (k_e) -&gt; | AES encrypt |
                                              +-------------+
                                                     |
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+   |
 |                keystream block                |&lt;--+
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: AES Counter Mode.  &nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="KDF"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
The AES_192_CM_PRF and AES_256_CM_PRF Key Derivation Functions</h3>

<p>
Section 4.3.3 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a> defines AES-128 counter mode
key derivation function, which it refers to as "AES-CM PRF".  (That
specification uses the term PRF, or pseudo-random function,
interchangeably with the term "key derivation function".  )
 
The AES-192 counter mode PRF and AES-256 counter mode PRF are
defined in a similar manner, and are denoted as AES_192_CM_PRF and
AES_256_CM_PRF respectively.  In both of these PRFs, the plaintext
inputs to the block cipher are formed as in the AES-CM PRF, and the
block cipher outputs are processed as in the AES-CM PRF.  The only
difference in the processing is that AES_192_CM_PRF uses AES-192, and
AES_256_CM_PRF uses AES-256.  Both AES_192_CM_PRF and AES_256_CM_PRF
use a 112-bit salt as an input, as does the AES-CM PRF.

</p>
<p>
For the convenience of the reader, the structure of the counter blocks
in SRTP counter mode key derivation is illustrated in
<a class='info' href='#KDFfig'>Figure&nbsp;2<span> (</span><span class='info'>The AES counter mode Key Derivation Function</span><span>)</span></a>, using the terminology from Section 4.3.3 of
<a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>.  In this diagram, the symbol (+) denotes the
bitwise exclusive-or operation, and the "AES Encrypt" operation uses
AES-128, AES-192, or AES-256 for the "AES-CM PRF", AES_192_CM_PRF, and
AES_256_CM_PRF, respectively.  The field "LB" contains the 8-bit
constant "label" which is provided as an input to the key derivation
function (and which is distinct for each type of key generated by that
function).  The field labeled b_c contains a block counter, the value
of which increments once for each invocation of the "AES Encrypt"
function.

</p><br /><hr class="insert" />
<a name="KDFfig"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
one octet
 &lt;--&gt;
  0  1  2  3  4  5  6  7  8  9  10 11 12 13 14 15
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
 |00|00|00|00|00|00|00|LB| index DIV kdr   | b_c |---+
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+   |
                                                     |
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+   v
 |               master salt               |00|00|-&gt;(+)
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+   |
                                                     |
                                                     v
                                              +-------------+
                                master key -&gt; | AES encrypt |
                                              +-------------+
                                                     |
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+   |
 |                   output block                |&lt;--+
 +--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+--+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: The AES counter mode Key Derivation Function&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="IV"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Usage Requirements</h3>

<p>
When AES_192_CM is used for encryption, AES_192_CM SHOULD be used as
the key derivation function, and AES_128_CM MUST NOT be 
used as the key derivation function.

</p>
<p>
When AES_256_CM is used for encryption, AES_256_CM SHOULD be used as
the key derivation function.  Both AES_128_CM and AES_192_CM MUST NOT
be used as the key derivation function.

</p>
<p>
</p>
<blockquote class="text">
<p>
Rationale: it is essential that the cryptographic strength of the key
derivation meets or exceeds that of the encryption method.  
It is natural to use the same function for both encryption and
key derivation.  However, it is not required to do so
because it is desirable to allow these ciphers to be used
with alternative key derivation functions that may
be defined in the future.

</p>
</blockquote><p>

</p>
<a name="cryptosuites"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Crypto Suties</h3>

<p>
This section defines SRTP crypto suites that use the ciphers and key
derivation functions defined in this document.  These suites are
registered with IANA for use with the SDP Security Descriptions
attributes (Section 10.3.2.1 of
<a class='info' href='#RFC4568'>[RFC4568]<span> (</span><span class='info'>Andreasen, F., Baugher, M., and D. Wing, &ldquo;Session Description Protocol (SDP) Security Descriptions for Media Streams,&rdquo; July&nbsp;2006.</span><span>)</span></a>).  Other SRTP key
management methods that use the crypto functions defined in this
document are encouraged to also use these crypto suite definitions.

</p><br /><hr class="insert" />
<a name="AES_192_CM_HMAC_SHA1_80"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Parameter</th><th align="left">Value</th></tr>
<tr>
<td align="left">Master key length</td>
<td align="left"> 192 bits</td>
</tr>
<tr>
<td align="left">Master salt length</td>
<td align="left"> 112 bits</td>
</tr>
<tr>
<td align="left">Key Derivation Function</td>
<td align="left"> AES_192_CM_PRF (<a class='info' href='#KDF'>Section&nbsp;3<span> (</span><span class='info'>The AES_192_CM_PRF and AES_256_CM_PRF Key Derivation Functions</span><span>)</span></a>)</td>
</tr>
<tr>
<td align="left">Default key lifetime</td>
<td align="left"> 2^31 packets</td>
</tr>
<tr>
<td align="left">Cipher (for SRTP and SRTCP) </td>
<td align="left"> AES_192_CM (<a class='info' href='#encryption'>Section&nbsp;2<span> (</span><span class='info'>AES-192 and AES-256 Encryption</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="left">SRTP authentication function </td>
<td align="left"> HMAC-SHA1  (Section 4.2.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>)</td>
</tr>
<tr>
<td align="left">SRTP authentication key length </td>
<td align="left"> 160 bits  </td>
</tr>
<tr>
<td align="left">SRTP authentication tag length </td>
<td align="left"> 80 bits  </td>
</tr>
<tr>
<td align="left">SRTCP authentication function </td>
<td align="left"> HMAC-SHA1 (Section 4.2.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="left">SRTCP authentication key length</td>
<td align="left"> 160 bits  </td>
</tr>
<tr>
<td align="left">SRTCP authentication tag length</td>
<td align="left"> 80 bits  </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: The AES_192_CM_HMAC_SHA1_80 cryptosuite.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="AES_192_CM_HMAC_SHA1_32"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Parameter</th><th align="left">Value</th></tr>
<tr>
<td align="left">Master key length</td>
<td align="left"> 192 bits</td>
</tr>
<tr>
<td align="left">Master salt length</td>
<td align="left"> 112 bits</td>
</tr>
<tr>
<td align="left">Key Derivation Function</td>
<td align="left"> AES_192_CM_PRF (<a class='info' href='#KDF'>Section&nbsp;3<span> (</span><span class='info'>The AES_192_CM_PRF and AES_256_CM_PRF Key Derivation Functions</span><span>)</span></a>)</td>
</tr>
<tr>
<td align="left">Default key lifetime</td>
<td align="left"> 2^31 packets</td>
</tr>
<tr>
<td align="left">Cipher (for SRTP and SRTCP) </td>
<td align="left"> AES_192_CM (<a class='info' href='#encryption'>Section&nbsp;2<span> (</span><span class='info'>AES-192 and AES-256 Encryption</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="left">SRTP authentication function </td>
<td align="left"> HMAC-SHA1  (Section 4.2.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>)</td>
</tr>
<tr>
<td align="left">SRTP authentication key length </td>
<td align="left"> 160 bits  </td>
</tr>
<tr>
<td align="left">SRTP authentication tag length </td>
<td align="left"> 32 bits  </td>
</tr>
<tr>
<td align="left">SRTCP authentication function </td>
<td align="left"> HMAC-SHA1 (Section 4.2.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="left">SRTCP authentication key length</td>
<td align="left"> 160 bits  </td>
</tr>
<tr>
<td align="left">SRTCP authentication tag length</td>
<td align="left"> 80 bits  </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: The AES_192_CM_HMAC_SHA1_32 cryptosuite.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="AES_256_CM_HMAC_SHA1_80"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Parameter</th><th align="left">Value</th></tr>
<tr>
<td align="left">Master key length</td>
<td align="left"> 256 bits</td>
</tr>
<tr>
<td align="left">Master salt length</td>
<td align="left"> 112 bits</td>
</tr>
<tr>
<td align="left">Key Derivation Function</td>
<td align="left"> AES_256_CM_PRF (<a class='info' href='#KDF'>Section&nbsp;3<span> (</span><span class='info'>The AES_192_CM_PRF and AES_256_CM_PRF Key Derivation Functions</span><span>)</span></a>)</td>
</tr>
<tr>
<td align="left">Default key lifetime</td>
<td align="left"> 2^31 packets</td>
</tr>
<tr>
<td align="left">Cipher (for SRTP and SRTCP) </td>
<td align="left"> AES_256_CM (<a class='info' href='#encryption'>Section&nbsp;2<span> (</span><span class='info'>AES-192 and AES-256 Encryption</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="left">SRTP authentication function </td>
<td align="left"> HMAC-SHA1  (Section 4.2.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>)</td>
</tr>
<tr>
<td align="left">SRTP authentication key length </td>
<td align="left"> 160 bits  </td>
</tr>
<tr>
<td align="left">SRTP authentication tag length </td>
<td align="left"> 80 bits  </td>
</tr>
<tr>
<td align="left">SRTCP authentication function </td>
<td align="left"> HMAC-SHA1 (Section 4.2.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="left">SRTCP authentication key length</td>
<td align="left"> 160 bits  </td>
</tr>
<tr>
<td align="left">SRTCP authentication tag length</td>
<td align="left"> 80 bits  </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: The AES_256_CM_HMAC_SHA1_80 cryptosuite.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="AES_256_CM_HMAC_SHA1_32"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Parameter</th><th align="left">Value</th></tr>
<tr>
<td align="left">Master key length</td>
<td align="left"> 256 bits</td>
</tr>
<tr>
<td align="left">Master salt length</td>
<td align="left"> 112 bits</td>
</tr>
<tr>
<td align="left">Key Derivation Function</td>
<td align="left"> AES_256_CM_PRF (<a class='info' href='#KDF'>Section&nbsp;3<span> (</span><span class='info'>The AES_192_CM_PRF and AES_256_CM_PRF Key Derivation Functions</span><span>)</span></a>)</td>
</tr>
<tr>
<td align="left">Default key lifetime</td>
<td align="left"> 2^31 packets</td>
</tr>
<tr>
<td align="left">Cipher (for SRTP and SRTCP) </td>
<td align="left"> AES_256_CM (<a class='info' href='#encryption'>Section&nbsp;2<span> (</span><span class='info'>AES-192 and AES-256 Encryption</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="left">SRTP authentication function </td>
<td align="left"> HMAC-SHA1  (Section 4.2.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>)</td>
</tr>
<tr>
<td align="left">SRTP authentication key length </td>
<td align="left"> 160 bits  </td>
</tr>
<tr>
<td align="left">SRTP authentication tag length </td>
<td align="left"> 32 bits  </td>
</tr>
<tr>
<td align="left">SRTCP authentication function </td>
<td align="left"> HMAC-SHA1 (Section 4.2.1 of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>) </td>
</tr>
<tr>
<td align="left">SRTCP authentication key length</td>
<td align="left"> 160 bits  </td>
</tr>
<tr>
<td align="left">SRTCP authentication tag length</td>
<td align="left"> 80 bits  </td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: The AES_256_CM_HMAC_SHA1_32 cryptosuite.&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
IANA is expected to assign the following parameters for the SDP Security
Descriptions crypto suite attribute.
</p>
<blockquote class="text">
<p>  AES_192_CM_HMAC_SHA1_80 
</p>
<p>  AES_192_CM_HMAC_SHA1_32 
</p>
<p>  AES_256_CM_HMAC_SHA1_80 
</p>
<p>  AES_256_CM_HMAC_SHA1_32 
</p>
</blockquote><p>
The cryptosuites are as defined in <a class='info' href='#cryptosuites'>Section&nbsp;4<span> (</span><span class='info'>Crypto Suties</span><span>)</span></a>.

</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
AES-128 provides a level of security that is widely regarded as being
more than sufficient for providing confidentiality.  It is believed
that the economic cost of breaking AES-128 is significantly higher
than the cost of more direct approaches to violating system security,
e.g. theft, bribery, wiretapping, and other forms of malfeasance.

</p>
<p>
Future advances in the state of the art of cryptanalysis could
eliminate this confidence in AES-128, and motivate the use of AES-192
or AES-256.  AES-192 is regarded as being secure even against some
adversaries for which breaking AES-128 may be feasible.  Similarly,
AES-256 is regarded as being secure even against some adversaries for
which it may be feasible to break AES-192.  The availability
of the larger key size versions of AES provides a fallback plan
in case of unanticipated cryptanalytic results.

</p>
<p>
It is conjectured that AES-256 provides adequate security even against
adversaries that possess the ability to construct a quantum computer
that works on 256 or more quantum bits.  No such computer is known to
exist; its feasibility is an area of active speculation and research.

</p>
<p>
Despite the apparent sufficiency of AES-128, some users are interested
in the larger AES key sizes.  For some applications, the 40% increase
in computational cost for AES-256 over AES-128 is a worthwhile bargain
when traded for the security advantages outlined above.  These
applications include those with a perceived need for very high
security, e.g.  due to a desire for very long-term confidentiality.

</p>
<p>
As with any cipher, the conjectured security level of AES may change
over time.  The considerations in this section reflect the best
knowledge available at the time of publication of this document.

</p>
<p>
It is desirable that AES_192_CM and AES_192_CM_PRF be used with an
authentication function that uses a 192 bit key, and that AES_256_CM
and AES_256_CM_PRF be used with an authentication function that uses a
256 bit key.  However, this desire is not regarded as
security-critical.  Cryptographic authentication is resilient against
future advances in cryptanalysis, since the opportunity for a forgery
attack against a session closes when that session closes.

</p>
<a name="testCases"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Test Cases</h3>

<p>
The test cases in this section are based on Appendix B of <a class='info' href='#RFC3711'>[RFC3711]<span> (</span><span class='info'>Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;The Secure Real-time Transport Protocol (SRTP),&rdquo; March&nbsp;2004.</span><span>)</span></a>.

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
AES-256-CM Test Cases</h3>

<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Keystream segment length: 1044512 octets (65282 AES blocks)
    Session Key:      57f82fe3613fd170a85ec93c40b1f092
                      2ec4cb0dc025b58272147cc438944a98
    Rollover Counter: 00000000
    Sequence Number:  0000
    SSRC:             00000000
    Session Salt:     f0f1f2f3f4f5f6f7f8f9fafbfcfd0000 (already shifted)
    Offset:           f0f1f2f3f4f5f6f7f8f9fafbfcfd0000

    Counter                            Keystream

    f0f1f2f3f4f5f6f7f8f9fafbfcfd0000   92bdd28a93c3f52511c677d08b5515a4
    f0f1f2f3f4f5f6f7f8f9fafbfcfd0001   9da71b2378a854f67050756ded165bac
    f0f1f2f3f4f5f6f7f8f9fafbfcfd0002   63c4868b7096d88421b563b8c94c9a31
    ...                                ...
    f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff   cea518c90fd91ced9cbb18c078a54711
    f0f1f2f3f4f5f6f7f8f9fafbfcfdff00   b4d49c8aec7ccb7726f14f338d19d88a
    f0f1f2f3f4f5f6f7f8f9fafbfcfdff01   c6f6a4804386cf175903139119b4fbde
</pre></div><p>


</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
AES_256_CM_PRF Test Cases</h3>

<p>
   This section provides test data for the AES_256_CM_PRF key
   derivation function, which uses AES-256 in Counter Mode.  In the
   following, we walk through the initial key derivation for the
   AES-256 Counter Mode cipher, which requires a 32 octet session
   encryption key and a 14 octet session salt, and the HMAC-SHA1
   authentication function, which requires a 20-octet session
   authentication key.  These values are called the cipher key, the
   cipher salt, and the auth key in the following.  Since this is the
   initial key derivation and the key derivation rate is equal to
   zero, the value of (index DIV key_derivation_rate) is zero
   (actually, a six-octet string of zeros).  In the following, we
   shorten key_derivation_rate to kdr.

</p>
<p>
   The inputs to the key derivation function are the 32 octet master key
   and the 14 octet master salt:
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      master key:  f0f04914b513f2763a1b1fa130f10e29
                   98f6f6e43e4309d1e622a0e332b9f1b6
      master salt: 3b04803de51ee7c96423ab5b78d2
</pre></div><p>

   We first show how the cipher key is generated.  The input block for
   AES-256-CM is generated by exclusive-oring the master salt with the
   concatenation of the encryption key label 0x00 with (index DIV
   kdr), then padding on the right with two null octets (which
   implements the multiply-by-2^16 operation, see Section 4.3.3 of RFC
   3711).  The resulting value is then AES-256-CM- encrypted using the
   master key to get the cipher key.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      index DIV kdr:                 000000000000
      label:                       00
      master salt:   3b04803de51ee7c96423ab5b78d2
      -----------------------------------------------
      xor:           3b04803de51ee7c96423ab5b78d2     (x, PRF input)

      x*2^16:        3b04803de51ee7c96423ab5b78d20000 (AES-256-CM input)
      x*2^16 + 1:    3b04803de51ee7c96423ab5b78d20001 (2nd AES input)

      cipher key:    5ba1064e30ec51613cad926c5a28ef73 (1st AES output)
                     1ec7fb397f70a960653caf06554cd8c4 (2nd AES output)
</pre></div><p>

   Next, we show how the cipher salt is generated.  The input block for
   AES-256-CM is generated by exclusive-oring the master salt with the
   concatenation of the encryption salt label.  That value is padded and
   encrypted as above.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      index DIV kdr:                 000000000000
      label:                       02
      master salt:   3b04803de51ee7c96423ab5b78d2

      ----------------------------------------------
      xor:           3b04803de51ee7cb6423ab5b78d2     (x, PRF input)

      x*2^16:        3b04803de51ee7cb6423ab5b78d20000 (AES-256-CM input)

                     fa31791685ca444a9e07c6c64e93ae6b (AES-256 ouptut)

      cipher salt:   fa31791685ca444a9e07c6c64e93
</pre></div><p>
                     
   We now show how the auth key is generated.  The input block for
   AES-256-CM is generated as above, but using the authentication key
   label.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      index DIV kdr:                   000000000000
      label:                         01
      master salt:     3b04803de51ee7c96423ab5b78d2
      -----------------------------------------------
      xor:             3b04803de51ee7c86423ab5b78d2     (x, PRF input)

      x*2^16:          3b04803de51ee7c86423ab5b78d20000 (AES-256-CM in)

   Below, the AES-256 output blocks that form the auth key are shown
   on the left, while the corresponding AES-256 input blocks are shown
   on the right.  Note that the final AES-256 output is truncated to a
   four-byte length.  The final auth key is shown below.

   auth key blocks                    AES-256 input blocks
   fd9c32d39ed5fbb5a9dc96b30818454d   3b04803de51ee7c86423ab5b78d20000
   1313dc05                           3b04803de51ee7c86423ab5b78d20001

   auth key: fd9c32d39ed5fbb5a9dc96b30818454d1313dc05

</pre></div><p>


</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
AES-192-CM Test Cases</h3>

<p>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Keystream segment length: 1044512 octets (65282 AES blocks)
    Session Key:      eab234764e517b2d3d160d587d8c8621
                      9740f65f99b6bcf7
    Rollover Counter: 00000000
    Sequence Number:  0000
    SSRC:             00000000
    Session Salt:     f0f1f2f3f4f5f6f7f8f9fafbfcfd0000 (already shifted)
    Offset:           f0f1f2f3f4f5f6f7f8f9fafbfcfd0000

    Counter                            Keystream

    f0f1f2f3f4f5f6f7f8f9fafbfcfd0000   93853536732e0908a6cb28bd85b64776
    f0f1f2f3f4f5f6f7f8f9fafbfcfd0001   a7e18fa46613babe588100d39d7ecbdd
    f0f1f2f3f4f5f6f7f8f9fafbfcfd0002   1e39fa7aa435aa15bf5b607d44d1941d
    ...                                ...
    f0f1f2f3f4f5f6f7f8f9fafbfcfdfeff   cb82e54adb48c702633e2f757a2f4989
    f0f1f2f3f4f5f6f7f8f9fafbfcfdff00   a3b2f7e1a988b0a90bb495081f17022f
    f0f1f2f3f4f5f6f7f8f9fafbfcfdff01   3eeafd32fd6e4ee267f04e118a4b8f5b
</pre></div><p>


</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
AES_192_CM_PRF Test Cases</h3>

<p>
   This section provides test data for the AES_256_CM_PRF key
   derivation function, which uses AES-256 in Counter Mode.  In the
   following, we walk through the initial key derivation for the
   AES-256 Counter Mode cipher, which requires a 32 octet session
   encryption key and a 14 octet session salt, and the HMAC-SHA1
   authentication function, which requires a 20-octet session
   authentication key.  These values are called the cipher key, the
   cipher salt, and the auth key in the following.  Since this is the
   initial key derivation and the key derivation rate is equal to
   zero, the value of (index DIV key_derivation_rate) is zero
   (actually, a six-octet string of zeros).  In the following, we
   shorten key_derivation_rate to kdr.

</p>
<p>
   The inputs to the key derivation function are the 32 octet master key
   and the 14 octet master salt:
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      master key:  73edc66c4fa15776fb57f9505c171365
                   50ffda71f3e8e5f1
      master salt: c8522f3acd4ce86d5add78edbb11
</pre></div><p>

   We first show how the cipher key is generated.  The input block for
   AES-256-CM is generated by exclusive-oring the master salt with the
   concatenation of the encryption key label 0x00 with (index DIV
   kdr), then padding on the right with two null octets (which
   implements the multiply-by-2^16 operation, see Section 4.3.3 of RFC
   3711).  The resulting value is then AES-256-CM- encrypted using the
   master key to get the cipher key.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      index DIV kdr:                 000000000000
      label:                       00
      master salt:   c8522f3acd4ce86d5add78edbb11
      -----------------------------------------------
      xor:           c8522f3acd4ce86d5add78edbb11     (x, PRF input)

      x*2^16:        c8522f3acd4ce86d5add78edbb110000 (AES-256-CM input)
      x*2^16 + 1:    c8522f3acd4ce86d5add78edbb110001 (2nd AES input)

      cipher key:    6da8e1e082a06aa80e5cbb0661a5174a (1st AES output)
                     3b8636251d8e4c539e5923b5ddb30cd4 (2nd AES output)
</pre></div><p>

   Next, we show how the cipher salt is generated.  The input block for
   AES-256-CM is generated by exclusive-oring the master salt with the
   concatenation of the encryption salt label.  That value is padded and
   encrypted as above.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      index DIV kdr:                 000000000000
      label:                       02
      master salt:   c8522f3acd4ce86d5add78edbb11

      ----------------------------------------------
      xor:           c8522f3acd4ce86f5add78edbb11     (x, PRF input)

      x*2^16:        c8522f3acd4ce86f5add78edbb110000 (AES-256-CM input)

                     cf075c87408e8f8ad63fbd1ca9292eb4 (AES-256 ouptut)

      cipher salt:   cf075c87408e8f8ad63fbd1ca929
</pre></div><p>
                     
   We now show how the auth key is generated.  The input block for
   AES-256-CM is generated as above, but using the authentication key
   label.
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      index DIV kdr:                   000000000000
      label:                         01
      master salt:     c8522f3acd4ce86d5add78edbb11
      -----------------------------------------------
      xor:             c8522f3acd4ce86c5add78edbb11     (x, PRF input)

      x*2^16:          c8522f3acd4ce86c5add78edbb110000 (AES-256-CM in)

   Below, the AES-256 output blocks that form the auth key are shown
   on the left, while the corresponding AES-256 input blocks are shown
   on the right.  Note that the final AES-256 output is truncated to a
   four-byte length.  The final auth key is shown below.

   auth key blocks                    AES-256 input blocks
   95f57950398ac4241ef5760b54bc5579   c8522f3acd4ce86c5add78edbb110000
   6ae9adf7                           c8522f3acd4ce86c5add78edbb110001

   auth key: 95f57950398ac4241ef5760b54bc55796ae9adf7

</pre></div><p>


</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>
  Thanks are due to John Mattsson for verifying the test cases in the
  document, and to Bob Bell for feedback and encouragement.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS197">[FIPS197]</a></td>
<td class="author-text">&ldquo;The Advanced Encryption Standard (AES),&rdquo; FIPS-197&nbsp;Federal Information
        Processing Standard.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3711">[RFC3711]</a></td>
<td class="author-text">Baugher, M., McGrew, D., Naslund, M., Carrara, E., and K. Norrman, &ldquo;<a href="http://tools.ietf.org/html/rfc3711">The Secure Real-time Transport Protocol (SRTP)</a>,&rdquo; RFC&nbsp;3711, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3711.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4568">[RFC4568]</a></td>
<td class="author-text">Andreasen, F., Baugher, M., and D. Wing, &ldquo;<a href="http://tools.ietf.org/html/rfc4568">Session Description Protocol (SDP) Security Descriptions for Media Streams</a>,&rdquo; RFC&nbsp;4568, July&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4568.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="suiteB">[suiteB]</a></td>
<td class="author-text">&ldquo;Fact Sheet for NSA Suite B Cryptography,&rdquo; &nbsp;http://www.nsa.gov/ia/industry/crypto_suite_b.cfm.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David A. McGrew</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">510 McCarthy Blvd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Milpitas, CA  95035</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">(408) 525 8651</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcgrew@cisco.com">mcgrew@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.mindspring.com/~dmcgrew/dam.htm">http://www.mindspring.com/~dmcgrew/dam.htm</a></td></tr>
</table>
</body></html>
