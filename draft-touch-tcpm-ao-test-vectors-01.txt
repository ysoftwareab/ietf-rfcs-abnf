TCPM                                                           J. Touch
Internet Draft                                   Independent consultant
Intended status: Informational                            J. Kuusisaari
Expires: February 2021                                         Infinera
                                                         August 5, 2020


                            TCP-AO Test Vectors


                  draft-touch-tcpm-ao-test-vectors-01.txt


Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79. This document may not be modified,
   and derivative works of it may not be created, except to format it
   for publication as an RFC or to translate it into languages other
   than English.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six
   months and may be updated, replaced, or obsoleted by other documents
   at any time.  It is inappropriate to use Internet-Drafts as
   reference material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This Internet-Draft will expire on February 7, 2020.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents



Touch                  Expires February 5, 2021                [Page 1]

Internet-Draft           TCP-AO Test Vectors               August 2020


   carefully, as they describe your rights and restrictions with
   respect to this document. Code Components extracted from this
   document must include Simplified BSD License text as described in
   Section 4.e of the Trust Legal Provisions and are provided without
   warranty as described in the Simplified BSD License.

Abstract

   This document provides test vectors to validate implementations of
   the two mandatory authentication algorithms specified for the TCP
   Authentication Option over both IPv4 and IPv6. This includes
   validation of the key derivation function (KDF) based on a set of
   test connection parameters as well as validation of the message
   authentication code (MAC). Vectors are provided for both currently
   required pairs of KDF and MAC algorithms: one based on SHA-1 and the
   other on AES-128. The vectors also validate both whole TCP segments
   as well as segments whose options are excluded for NAT traversal.

Table of Contents


   1. Introduction...................................................3
   2. Conventions used in this document..............................3
   3. Background.....................................................3
   4. Input Test Vectors.............................................4
      4.1. TCP Connection Parameters.................................4
         4.1.1. TCP-AO parameters....................................4
         4.1.2. Active (client) side parameters......................4
         4.1.3. Passive (server) side parameters.....................4
         4.1.4. Other IP fields and options..........................4
         4.1.5. Other TCP fields and options.........................5
   5. IPv4 SHA-1 Output Test Vectors.................................5
      5.1. SHA-1 MAC (default - covers TCP options)..................5
         5.1.1. Send (client) SYN (covers options)...................5
         5.1.2. Receive (server) SYN-ACK (covers options)............6
         5.1.3. Send (client) non-SYN (covers options)...............6
         5.1.4. Receive (server) non-SYN (covers options)............7
      5.2. SHA-1 MAC (omits TCP options).............................7
         5.2.1. Send (client) SYN (omits options)....................7
         5.2.2. Receive (server) SYN-ACK (omits options).............8
         5.2.3. Send (client) non-SYN (omits options)................8
         5.2.4. Receive (server) non-SYN (omits options).............9
   6. IPv4 AES-128 Output Test Vectors...............................9
      6.1. AES MAC (default - covers TCP options)....................9
         6.1.1. Send (client) SYN (covers options)...................9
         6.1.2. Receive (server) SYN-ACK (covers options)...........10
         6.1.3. Send (client) non-SYN (covers options)..............10


Touch                  Expires February 5, 2021                [Page 2]

Internet-Draft           TCP-AO Test Vectors               August 2020


         6.1.4. Receive (server) non-SYN (covers options)...........11
      6.2. AES MAC (omits TCP options)..............................12
         6.2.1. Send (client) SYN (omits options)...................12
         6.2.2. Receive (server) SYN-ACK (omits options)............12
         6.2.3. Send (client) non-SYN (omits options)...............13
         6.2.4. Receive (server) non-SYN (omits options)............13
   7. IPv6 SHA-1 Output Test Vectors................................14
   8. IPv6 AES-128 Output Test Vectors..............................14
   9. Observed Implementation Errors................................14
      9.1. Algorithm issues.........................................14
      9.2. Algorithm parameters.....................................14
      9.3. String handling issues...................................14
      9.4. Header coverage issues...................................15
   10. Security Considerations......................................15
   11. IANA Considerations..........................................15
   12. References...................................................15
      12.1. Normative References....................................15
      12.2. Informative References..................................16
   13. Acknowledgments..............................................16

1. Introduction

   This document provides test vectors to validate the correct
   implementation of the TCP Authentication Option (TCP-AO) [RFC5925].
   It includes the specification of all endpoint parameters to generate
   the variety of TCP segments covered by different keys and MAC
   coverage, i.e., both the default case and the variant where TCP
   options are ignored. It also includes both default key derivation
   functions (KDFs) and MAC generation algorithms [RFC5926].

   The experimental extension to support NAT traversal is not included
   in the provided test vectors [RFC6978].

   This document provides test vectors from an implementation.

2. Conventions used in this document

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3. Background

   (TBD)



Touch                  Expires February 5, 2021                [Page 3]

Internet-Draft           TCP-AO Test Vectors               August 2020


4. Input Test Vectors

4.1. TCP Connection Parameters

   The following parameters are used throughout this suite of test
   vectors. The terms 'active' and 'passive' are used as defined for
   TCP [RFC793].

4.1.1. TCP-AO parameters

   The following values are used for all exchanges. This suite does not
   test key switchover. The KeyIDs are as indicated for TCP-AO
   [RFC5925]. The Master Key is used to derive the traffic keys
   [RFC5926].

      Active (client) side KeyID: 61 (3D)

      Passive (server) side KeyID: 84 (54)

      Master_key: "testvector" (length = 10 bytes)

4.1.2. Active (client) side parameters

   The following endpoint parameters are used on the active side of the
   TCP connection, i.e., the side that initiates the TCP SYN.

      For IPv4: 10.11.12.13

      For IPv6: (TBD)

      TCP port: 57969 (E271)

4.1.3. Passive (server) side parameters

   The following endpoint parameters are used for the passive side of
   the TCP connection, i.e., the side that responds with a TCP SYN-ACK.

      For IPv4: 172.27.28.29

      For IPv6: (TBD)

      TCP port = 179 (BGP)

4.1.4. Other IP fields and options

   No IP options are used in these test vectors.



Touch                  Expires February 5, 2021                [Page 4]

Internet-Draft           TCP-AO Test Vectors               August 2020


   All IPv4 packets use the following other parameters [RFC791]: DSCP =
   111000 (CS7) as is typical for BGP, ECN = 00, set DF, clear MF, and
   TTL of 255.

   All IPv6 use the following other parameters [RFC8200]: (TBD).

4.1.5. Other TCP fields and options

   The SYN and SYN-ACK segments include MSS [RFC793], NOP, WindowScale
   [RFC7323], SACK Permitted [RFC2018], TimeStamp [RFC7323], and TCP-AO
   [RFC5925], in that order.

   All other example segments include NOP, NOP, TimeStamp, and TCP-AO,
   in that order.

   All segment URG pointers are zero [RFC793]. All segments with data
   set the PSH flag [RFC793].

5. IPv4 SHA-1 Output Test Vectors

   SHA-1 is computed as specified for TCP-AO [RFC5926].

5.1. SHA-1 MAC (default - covers TCP options)

5.1.1. Send (client) SYN (covers options)

   Send_SYN_traffic_key:

     6d 63 ef 1b 02 fe 15 09 d4 b1 40 27 07 fd 7b 04
     16 ab b7 4f

   IPv4/TCP:

     45 e0 00 4c dd 0f 40 00 ff 06 bf 6b 0a 0b 0c 0d
     ac 1b 1c 1d e9 d7 00 b3 fb fb ab 5a 00 00 00 00
     e0 02 ff ff ca c4 00 00 02 04 05 b4 01 03 03 08
     04 02 08 0a 00 15 5a b7 00 00 00 00 1d 10 3d 54
     2e e4 37 c6 f8 ed e6 d7 c4 d6 02 e7


   MAC:

     2e e4 37 c6 f8 ed e6 d7 c4 d6 02 e7






Touch                  Expires February 5, 2021                [Page 5]

Internet-Draft           TCP-AO Test Vectors               August 2020


5.1.2. Receive (server) SYN-ACK (covers options)

   Receive_SYN_traffic_key:

     d9 e2 17 e4 83 4a 80 ca 2f 3f d8 de 2e 41 b8 e6
     79 7f ea 96


   IPv4/TCP:

     45 e0 00 4c 65 06 40 00 ff 06 37 75 ac 1b 1c 1d
     0a 0b 0c 0d 00 b3 e9 d7 11 c1 42 61 fb fb ab 5b
     e0 12 ff ff 37 76 00 00 02 04 05 b4 01 03 03 08
     04 02 08 0a 84 a5 0b eb 00 15 5a b7 1d 10 54 3d
     ee ab 0f e2 4c 30 10 81 51 16 b3 be


   MAC:

     ee ab 0f e2 4c 30 10 81 51 16 b3 be


5.1.3. Send (client) non-SYN (covers options)

   Send_other_traffic_key:

     d2 e5 9c 65 ff c7 b1 a3 93 47 65 64 63 b7 0e dc
     24 a1 3d 71


   IPv4/TCP:

     45 e0 00 87 36 a1 40 00 ff 06 65 9f 0a 0b 0c 0d
     ac 1b 1c 1d e9 d7 00 b3 fb fb ab 5b 11 c1 42 62
     c0 18 01 04 a1 62 00 00 01 01 08 0a 00 15 5a c1
     84 a5 0b eb 1d 10 3d 54 70 64 cf 99 8c c6 c3 15
     c2 c2 e2 bf ff ff ff ff ff ff ff ff ff ff ff ff
     ff ff ff ff 00 43 01 04 da bf 00 b4 0a 0b 0c 0d
     26 02 06 01 04 00 01 00 01 02 02 80 00 02 02 02
     00 02 02 42 00 02 06 41 04 00 00 da bf 02 08 40
     06 00 64 00 01 01 00


   MAC:

     70 64 cf 99 8c c6 c3 15 c2 c2 e2 bf



Touch                  Expires February 5, 2021                [Page 6]

Internet-Draft           TCP-AO Test Vectors               August 2020


5.1.4. Receive (server) non-SYN (covers options)

   Receive_other_traffic_key:

     d9 e2 17 e4 83 4a 80 ca 2f 3f d8 de 2e 41 b8 e6
     79 7f ea 96


   IPv4/TCP:

     45 e0 00 87 1f a9 40 00 ff 06 7c 97 ac 1b 1c 1d
     0a 0b 0c 0d 00 b3 e9 d7 11 c1 42 62 fb fb ab 9e
     c0 18 01 00 40 0c 00 00 01 01 08 0a 84 a5 0b f5
     00 15 5a c1 1d 10 54 3d a6 3f 0e cb bb 2e 63 5c
     95 4d ea c7 ff ff ff ff ff ff ff ff ff ff ff ff
     ff ff ff ff 00 43 01 04 da c0 00 b4 ac 1b 1c 1d
     26 02 06 01 04 00 01 00 01 02 02 80 00 02 02 02
     00 02 02 42 00 02 06 41 04 00 00 da c0 02 08 40
     06 00 64 00 01 01 00


   MAC:

     a6 3f 0e cb bb 2e 63 5c 95 4d ea c7


5.2. SHA-1 MAC (omits TCP options)

5.2.1. Send (client) SYN (omits options)

   Send_SYN_traffic_key:

     30 ea a1 56 0c f0 be 57 da b5 c0 45 22 9f b1 0a
     42 3c d7 ea


   IPv4/TCP:

     45 e0 00 4c 53 99 40 00 ff 06 48 e2 0a 0b 0c 0d
     ac 1b 1c 1d ff 12 00 b3 cb 0e fb ee 00 00 00 00
     e0 02 ff ff 54 1f 00 00 02 04 05 b4 01 03 03 08
     04 02 08 0a 00 02 4c ce 00 00 00 00 1d 10 3d 54
     80 af 3c fe b8 53 68 93 7b 8f 9e c2






Touch                  Expires February 5, 2021                [Page 7]

Internet-Draft           TCP-AO Test Vectors               August 2020


   MAC:

     80 af 3c fe b8 53 68 93 7b 8f 9e c2


5.2.2. Receive (server) SYN-ACK (omits options)

   Receive_SYN_traffic_key:

     b5 b2 89 6b b3 66 4e 81 76 b0 ed c6 e7 99 52 41a
     01 a8 30 7f


   IPv4/TCP:

     45 e0 00 4c 32 84 40 00 ff 06 69 f7 ac 1b 1c 1d
     0a 0b 0c 0d 00 b3 ff 12 ac d5 b5 e1 cb 0e fb ef
     e0 12 ff ff 38 8e 00 00 02 04 05 b4 01 03 03 08
     04 02 08 0a 57 67 72 f3 00 02 4c ce 1d 10 54 3d
     09 30 6f 9a ce a6 3a 8c 68 cb 9a 70


   MAC:

     09 30 6f 9a ce a6 3a 8c 68 cb 9a 70


5.2.3. Send (client) non-SYN (omits options)

   Send_other_traffic_key:

     f3 db 17 93 d7 91 0e cd 80 6c 34 f1 55 ea 1f 00
     34 59 53 e3


   IPv4/TCP:

     45 e0 00 87 a8 f5 40 00 ff 06 f3 4a 0a 0b 0c 0d
     ac 1b 1c 1d ff 12 00 b3 cb 0e fb ef ac d5 b5 e2
     c0 18 01 04 6c 45 00 00 01 01 08 0a 00 02 4c ce
     57 67 72 f3 1d 10 3d 54 71 06 08 cc 69 6c 03 a2
     71 c9 3a a5 ff ff ff ff ff ff ff ff ff ff ff ff
     ff ff ff ff 00 43 01 04 da bf 00 b4 0a 0b 0c 0d
     26 02 06 01 04 00 01 00 01 02 02 80 00 02 02 02
     00 02 02 42 00 02 06 41 04 00 00 da bf 02 08 40
     06 00 64 00 01 01 00



Touch                  Expires February 5, 2021                [Page 8]

Internet-Draft           TCP-AO Test Vectors               August 2020


   MAC:

     71 06 08 cc 69 6c 03 a2 71 c9 3a a5


5.2.4. Receive (server) non-SYN (omits options)

   Receive_other_traffic_key:

     b5 b2 89 6b b3 66 4e 81 76 b0 ed c6 e7 99 52 41 01 a8 30 7f


   IPv4/TCP:

     45 e0 00 87 54 37 40 00 ff 06 48 09 ac 1b 1c 1d
     0a 0b 0c 0d 00 b3 ff 12 ac d5 b5 e2 cb 0e fc 32
     c0 18 01 00 46 b6 00 00 01 01 08 0a 57 67 72 f3
     00 02 4c ce 1d 10 54 3d 97 76 6e 48 ac 26 2d e9
     ae 61 b4 f9 ff ff ff ff ff ff ff ff ff ff ff ff
     ff ff ff ff 00 43 01 04 da c0 00 b4 ac 1b 1c 1d
     26 02 06 01 04 00 01 00 01 02 02 80 00 02 02 02
     00 02 02 42 00 02 06 41 04 00 00 da c0 02 08 40
     06 00 64 00 01 01 00


   MAC:

     97 76 6e 48 ac 26 2d e9 ae 61 b4 f9


6. IPv4 AES-128 Output Test Vectors

   AES-128 is computed as required by TCP-AO [RFC5926].

6.1. AES MAC (default - covers TCP options)

6.1.1. Send (client) SYN (covers options)

   Send_SYN_traffic_key:

     f5 b8 b3 d5 f3 4f db b6 eb 8d 4a b9 66 0e 60 e3








Touch                  Expires February 5, 2021                [Page 9]

Internet-Draft           TCP-AO Test Vectors               August 2020


   IP/TCP:

     45 e0 00 4c 7b 9f 40 00 ff 06 20 dc 0a 0b 0c 0d
     ac 1b 1c 1d c4 fa 00 b3 78 7a 1d df 00 00 00 00
     e0 02 ff ff 5a 0f 00 00 02 04 05 b4 01 03 03 08
     04 02 08 0a 00 01 7e d0 00 00 00 00 1d 10 3d 54
     e4 77 e9 9c 80 40 76 54 98 e5 50 91


   MAC:

     e4 77 e9 9c 80 40 76 54 98 e5 50 91


6.1.2. Receive (server) SYN-ACK (covers options)

   Receive_SYN_traffic_key:

     4b c7 57 1a 48 6f 32 64 bb d8 88 47 40 66 b4 b1


   IPv4/TCP:

     45 e0 00 4c 4b ad 40 00 ff 06 50 ce ac 1b 1c 1d
     0a 0b 0c 0d 00 b3 c4 fa fa dd 6d e9 78 7a 1d e0
     e0 12 ff ff f3 f2 00 00 02 04 05 b4 01 03 03 08
     04 02 08 0a 93 f4 e9 e8 00 01 7e d0 1d 10 54 3d
     d6 ad a7 bc 4c dd 53 6d 17 69 db 5f


   MAC:

     d6 ad a7 bc 4c dd 53 6d 17 69 db 5f


6.1.3. Send (client) non-SYN (covers options)

   Send_other_traffic_key:

     8c 8a e0 e8 37 1e c5 cb b9 7e a7 9d 90 41 83 91









Touch                  Expires February 5, 2021               [Page 10]

Internet-Draft           TCP-AO Test Vectors               August 2020


   IPv4/TCP:

     45 e0 00 87 fb 4f 40 00 ff 06 a0 f0 0a 0b 0c 0d
     ac 1b 1c 1d c4 fa 00 b3 78 7a 1d e0 fa dd 6d ea
     c0 18 01 04 95 05 00 00 01 01 08 0a 00 01 7e d0
     93 f4 e9 e8 1d 10 3d 54 77 41 27 42 fa 4d c4 33
     ef f0 97 3e ff ff ff ff ff ff ff ff ff ff ff ff
     ff ff ff ff 00 43 01 04 da bf 00 b4 0a 0b 0c 0d
     26 02 06 01 04 00 01 00 01 02 02 80 00 02 02 02
     00 02 02 42 00 02 06 41 04 00 00 da bf 02 08 40
     06 00 64 00 01 01 00


   MAC:

     77 41 27 42 fa 4d c4 33 ef f0 97 3e


6.1.4. Receive (server) non-SYN (covers options)

   Receive_other_traffic_key:

     4b c7 57 1a 48 6f 32 64 bb d8 88 47 40 66 b4 b1


   IPv4/TCP:

     45 e0 00 87 b9 14 40 00 ff 06 e3 2b ac 1b 1c 1d
     0a 0b 0c 0d 00 b3 c4 fa fa dd 6d ea 78 7a 1e 23
     c0 18 01 00 e7 db 00 00 01 01 08 0a 93 f4 e9 e8
     00 01 7e d0 1d 10 54 3d f6 d9 65 a7 83 82 a7 48
     45 f7 2d ac ff ff ff ff ff ff ff ff ff ff ff ff
     ff ff ff ff 00 43 01 04 da c0 00 b4 ac 1b 1c 1d
     26 02 06 01 04 00 01 00 01 02 02 80 00 02 02 02
     00 02 02 42 00 02 06 41 04 00 00 da c0 02 08 40
     06 00 64 00 01 01 00


   MAC:

     f6 d9 65 a7 83 82 a7 48 45 f7 2d ac








Touch                  Expires February 5, 2021               [Page 11]

Internet-Draft           TCP-AO Test Vectors               August 2020


6.2. AES MAC (omits TCP options)

6.2.1. Send (client) SYN (omits options)

   Send_SYN_traffic_key:

     2c db ae 13 92 c4 94 49 fa 92 c4 50 97 35 d5 0e


   IPv4/TCP:

     45 e0 00 4c f2 2e 40 00 ff 06 aa 4c 0a 0b 0c 0d
     ac 1b 1c 1d da 1c 00 b3 38 9b ed 71 00 00 00 00
     e0 02 ff ff 70 bf 00 00 02 04 05 b4 01 03 03 08
     04 02 08 0a 00 01 85 e1 00 00 00 00 1d 10 3d 54
     c4 4e 60 cb 31 f7 c0 b1 de 3d 27 49


   MAC:

     c4 4e 60 cb 31 f7 c0 b1 de 3d 27 49


6.2.2. Receive (server) SYN-ACK (omits options)

   Receive_SYN_traffic_key:

     3c e6 7a 55 18 69 50 6b 63 47 b6 33 c5 0a 62 4a


   IPv4/TCP:

     45 e0 00 4c 6c c0 40 00 ff 06 2f bb ac 1b 1c 1d
     0a 0b 0c 0d 00 b3 da 1c d3 84 4a 6f 38 9b ed 72
     e0 12 ff ff e4 45 00 00 02 04 05 b4 01 03 03 08
     04 02 08 0a ce 45 98 38 00 01 85 e1 1d 10 54 3d
     3a 6a bb 20 7e 49 b1 be 71 36 db 90


   MAC:

     3a 6a bb 20 7e 49 b1 be 71 36 db 90







Touch                  Expires February 5, 2021               [Page 12]

Internet-Draft           TCP-AO Test Vectors               August 2020


6.2.3. Send (client) non-SYN (omits options)

   Send_other_traffic_key:

     03 5b c4 00 a3 41 ff e5 95 f5 9f 58 00 50 06 ca


   IPv4/TCP:

     45 e0 00 87 ee 91 40 00 ff 06 ad ae 0a 0b 0c 0d
     ac 1b 1c 1d da 1c 00 b3 38 9b ed 72 d3 84 4a 70
     c0 18 01 04 88 51 00 00 01 01 08 0a 00 01 85 e1
     ce 45 98 38 1d 10 3d 54 75 85 e9 e9 d5 c3 ec 85
     7b 96 f8 37 ff ff ff ff ff ff ff ff ff ff ff ff
     ff ff ff ff 00 43 01 04 da bf 00 b4 0a 0b 0c 0d
     26 02 06 01 04 00 01 00 01 02 02 80 00 02 02 02
     00 02 02 42 00 02 06 41 04 00 00 da bf 02 08 40
     06 00 64 00 01 01 00


   MAC:

     75 85 e9 e9 d5 c3 ec 85 7b 96 f8 37


6.2.4. Receive (server) non-SYN (omits options)

   Receive_other_traffic_key:

     3c e6 7a 55 18 69 50 6b 63 47 b6 33 c5 0a 62 4a


   IPv4/TCP:

     45 e0 00 87 6a 21 40 00 ff 06 32 1f ac 1b 1c 1d
     0a 0b 0c 0d 00 b3 da 1c d3 84 4a 70 38 9b ed 72
     c0 18 01 00 04 49 00 00 01 01 08 0a ce 45 98 38
     00 01 85 e1 1d 10 54 3d 5c 04 0f d9 23 33 04 76
     5c 09 82 f4 ff ff ff ff ff ff ff ff ff ff ff ff
     ff ff ff ff 00 43 01 04 da c0 00 b4 ac 1b 1c 1d
     26 02 06 01 04 00 01 00 01 02 02 80 00 02 02 02
     00 02 02 42 00 02 06 41 04 00 00 da c0 02 08 40
     06 00 64 00 01 01 00






Touch                  Expires February 5, 2021               [Page 13]

Internet-Draft           TCP-AO Test Vectors               August 2020


   MAC:

     5c 04 0f d9 23 33 04 76 5c 09 82 f4


7. IPv6 SHA-1 Output Test Vectors

   (TBD)

8. IPv6 AES-128 Output Test Vectors

   (TBD)

9. Observed Implementation Errors

   The following is a partial list of implementation errors that this
   set of test vectors is intended to validate.

9.1. Algorithm issues

   o  Underlying implementation of HMAC SHA1 or AES128 CMAC does not
      pass their corresponding test vectors [RFC2202] [RFC4493]

   o  SNE algorithm does not consider corner cases (the pseudocode in
      [RFC5925] was not intended as complete, as discussed in [To20])

9.2. Algorithm parameters

   o  KDF context length is incorrect, e.g. it does not include TCP
      header length + payload length (it should, per 5.2 of TCP-AO
      [RFC5925])

   o  KDF calculation does not start from counter i = 1 (it should, per
      Sec. 3.1.1 of the TCP-AO crypto algorithms [RFC5926])

   o  KDF calculation does not include output length in bits, contained
      in two bytes in network byte order (it should, per Sec. 3.1.1 of
      the TCP-AO crypto algorithms [RFC5926])

   o  KDF uses keys generated from current TCP segment sequence numbers
      (KDF should use only local and remote ISNs or zero, as indicated
      in Sec. 5.2 of TCP-AO [RFC5925])

9.3. String handling issues

   The strings indicated in TCP-AO and its algorithms are indicated as
   a sequence of bytes of known length. In some implementations, string


Touch                  Expires February 5, 2021               [Page 14]

Internet-Draft           TCP-AO Test Vectors               August 2020


   lengths are indicated by a terminal value (e.g., zero in C). This
   terminal value is not included as part of the string for
   calculations.

   o  Password includes the last zero-byte (it should not)

   o  Label "TCP-AO" includes the last zero byte (it should not)

9.4. Header coverage issues

   o  TCP checksum and/or MAC is not zeroed properly before calculation
      (both should be)

   o  TCP header is not included to the MAC calculation (it should be)

   o  TCP options are not included to the MAC calculation by default
      (there is a separate parameter in the master key tuple to ignore
      options; this document provides test vectors for both options-
      included and options-excluded cases)

10. Security Considerations

   This document is intended to assist in the validation of
   implementations of TCP-AO, to further enable its more widespread use
   as a security mechanism to authenticate not only TCP payload
   contents but the TCP headers and protocol.

   The master_key of "testvector" used here for test vector generation
   SHOULD NOT be used operationally.

11. IANA Considerations

   This document contains no IANA issues. This section should be
   removed upon publication as an RFC.

12. References

12.1. Normative References

   [RFC791]  Postel, J., "Internet Protocol," RFC 791, Sept. 1981.

   [RFC793]  Postel, J., "Transmission Control Protocol," RFC 793,
             September 1981.

   [RFC2018] Mathis, M., J. Mahdavi, S. Floyd, A. Romanow, "TCP
             Selective Acknowledgment Options," RFC 2018, Oct. 1996.



Touch                  Expires February 5, 2021               [Page 15]

Internet-Draft           TCP-AO Test Vectors               August 2020


   [RFC2119] Bradner, S., "Key words for use in RFCs to Indicate
             Requirement Levels," BCP 14, RFC 2119, March 1997.

   [RFC5925] Touch, J., A. Mankin, R. Bonica, "The TCP Authentication
             Option," RFC 5925, June 2010.

   [RFC5926] Lebovitz, G., and E. Rescorla, "Cryptographic Algorithms
             for the TCP Authentication Option (TCP-AO)," RFC 5925,
             June 2010.

   [RFC6978] Touch, J., "A TCP Authentication Option Extension for NAT
             Traversal," RFC 6978, July 2013.

   [RFC7323] Borman, D., B. Braden, V. Jacobson, R. Scheffenegger, Ed.,
             "TCP Extensions for High Performance," RFC 7323, Sept.
             2014.

   [RFC8174] Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
             2119 Key Words," RFC 2119, May 2017.

   [RFC8200] Deering, S., R. Hinden, "Internet Protocol Version 6
             (IPv6) Specification," RFC 8200, Jul. 2017.

12.2. Informative References

   [RFC2202] Cheng, P., and R. Glenn, "Test Cases for HMAC-MD5 and
             HMAC-SHA-1," RFC 2202, Sept. 1997.

   [RFC4493] Song, JH, R. Poovendran, J. Lee, T. Iwata, "The AES-CMAC
             Algorithm," RFC 4493, June 2006.

   [To20]    Touch, J., "Sequence Number Extension for Windowed
             Protocols," draft-tsvwg-touch-sne, Jun. 2020.

13. Acknowledgments

   (TBD)

   This document was prepared using 2-Word-v2.0.template.dot.










Touch                  Expires February 5, 2021               [Page 16]

Internet-Draft           TCP-AO Test Vectors               August 2020


Authors' Addresses

   Joe Touch
   Manhattan Beach, CA 90266 USA
   Phone: +1 (310) 560-0334
   Email: touch@strayalpha.com

   Juhamatti Kuusisaari
   Infinera Corporation
   Sinimaentie 6c
   FI-02630 Espoo, Finland
   Email: jkuusisaari@infinera.com





































Touch                  Expires February 5, 2021               [Page 17]

