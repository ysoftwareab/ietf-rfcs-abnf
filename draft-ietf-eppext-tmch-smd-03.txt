



Internet Engineering Task Force                                G. Lozano
Internet-Draft                                                     ICANN
Intended status: Standards Track                      September 28, 2015
Expires: March 31, 2016


                  Mark and Signed Mark Objects Mapping
                     draft-ietf-eppext-tmch-smd-03

Abstract

   This document describes the format of a mark and a digitally signed
   mark used by trademark holders for registering domain names during
   the sunrise phase of generic Top Level Domains (gTLDs).

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on March 31, 2016.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





Lozano                   Expires March 31, 2016                 [Page 1]

Internet-Draft            Mark and Signed Mark            September 2015


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Terminology . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Object Description  . . . . . . . . . . . . . . . . . . . . .   3
     2.1.  Holder and Contacts objects . . . . . . . . . . . . . . .   3
     2.2.  Mark  . . . . . . . . . . . . . . . . . . . . . . . . . .   5
     2.3.  Signed Mark . . . . . . . . . . . . . . . . . . . . . . .   8
     2.4.  Encoded Signed Mark . . . . . . . . . . . . . . . . . . .  12
     2.5.  Appendix A. base64 encoded signedMark . . . . . . . . . .  12
   3.  Formal Syntax . . . . . . . . . . . . . . . . . . . . . . . .  15
     3.1.  Signed Mark Schema  . . . . . . . . . . . . . . . . . . .  15
     3.2.  Mark Schema . . . . . . . . . . . . . . . . . . . . . . .  17
   4.  Implementation Status . . . . . . . . . . . . . . . . . . . .  23
     4.1.  Verisign EPP SDK  . . . . . . . . . . . . . . . . . . . .  24
     4.2.  Verisign Consolidated Top Level Domain (CTLD) SRS . . . .  24
     4.3.  Verisign .COM / .NET SRS  . . . . . . . . . . . . . . . .  25
     4.4.  REngin v3.7 . . . . . . . . . . . . . . . . . . . . . . .  25
     4.5.  Uniregistry Corp. Shared Registry System (uSRS) . . . . .  25
   5.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  26
   6.  Change History  . . . . . . . . . . . . . . . . . . . . . . .  26
   7.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  28
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .  29
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  29
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  29
     9.2.  Informative References  . . . . . . . . . . . . . . . . .  30
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .  30

1.  Introduction

   This document describes the format of a mark and a digitally signed
   mark, used to construct a Signed Mark Data (SMD) file, required by
   the Internet Corporation for Assigned Names and Numbers (ICANN)
   Trademark Clearinghouse, Rights Protection Mechanism (RPM)
   Requirements defined in [ICANN-TMCH].  This document provides a
   framework that can be referenced by application protocols like the
   Extensible Provisioning Protocol (EPP), defined in [RFC5730].

1.1.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

   XML is case sensitive.  Unless stated otherwise, XML specifications
   and examples provided in this document MUST be interpreted in the
   character case presented in order to develop a conforming
   implementation.



Lozano                   Expires March 31, 2016                 [Page 2]

Internet-Draft            Mark and Signed Mark            September 2015


   "signedMark-1.0" is used as an abbreviation for
   "urn:ietf:params:xml:ns:signedMark-1.0".  The XML namespace prefix
   "smd" is used, but implementations MUST NOT depend on it and instead
   employ a proper namespace-aware XML parser and serializer to
   interpret and output the XML documents.

   "mark-1.0" is used as an abbreviation for
   "urn:ietf:params:xml:ns:mark-1.0".  The XML namespace prefix "mark"
   is used, but implementations MUST NOT depend on it and instead employ
   a proper namespace-aware XML parser and serializer to interpret and
   output the XML documents.

2.  Object Description

   This section defines the objects associated with marks and signed
   marks.  Empty complex element types and abstract elements are defined
   to support additional mark and signed mark definition using XSD
   substitution groups.  Support for replacement through the XSD
   substitution groups is included in the descriptions of the objects.

2.1.  Holder and Contacts objects

   Marks are linked to Holder objects and optionally linked to Contacts
   objects.  This section defines the <mark:holder> and <mark:contact>
   objects.

   o  The child elements of <mark:holder> include:

      *  An OPTIONAL <mark:name> element that contains the name of the
         holder.  A <mark:name> MUST be specified in case <mark:org> is
         not specified.

      *  An OPTIONAL <mark:org> element that contains the name of the
         organization holder of the mark.  A <mark:org> MUST be
         specified in case <mark:name> is not specified.

      *  A <mark:addr> element that contains the address information of
         the holder of a mark.  A <mark:addr> contains the following
         child elements:

         +  One, two or three OPTIONAL <mark:street> elements that
            contains the organization's street address.

         +  A <mark:city> element that contains the organization's city.

         +  An OPTIONAL <mark:sp> element that contains the
            organization's state or province.




Lozano                   Expires March 31, 2016                 [Page 3]

Internet-Draft            Mark and Signed Mark            September 2015


         +  An OPTIONAL <mark:pc> element that contains the
            organization's postal code.

         +  A <mark:cc> element that contains the organization's country
            code.  This a two-character code from [ISO3166-2].

      *  An OPTIONAL <mark:voice> element that contains the
         organization's voice telephone number.

      *  An OPTIONAL <mark:fax> element that contains the organization's
         facsimile telephone number.

      *  An OPTIONAL <mark:email> element that contains the email
         address of the holder.

   o  The child elements of <mark:contact> include:

      *  A <mark:name> element that contains name of the responsible
         person.

      *  An OPTIONAL <mark:org> element that contains the name of the
         organization of the contact.

      *  A <mark:addr> element that contains the address information of
         the contact.  A <mark:addr> contains the following child
         elements:

         +  One, two or three OPTIONAL <mark:street> elements that
            contains the contact's street address.

         +  A <mark:city> element that contains the contact's city.

         +  An OPTIONAL <mark:sp> element that contains the contact's
            state or province.

         +  An OPTIONAL <mark:pc> element that contains the contact's
            postal code.

         +  A <mark:cc> element that contains the contact's country
            code.  This a two-character code from [ISO3166-2].

      *  A <mark:voice> element that contains the contact's voice
         telephone number.

      *  An OPTIONAL <mark:fax> element that contains the contact's
         facsimile telephone number.





Lozano                   Expires March 31, 2016                 [Page 4]

Internet-Draft            Mark and Signed Mark            September 2015


      *  A <mark:email> element that contains the contact's email
         address.

2.2.  Mark

   A <mark:mark> element that describes an applicant's prior right to a
   given domain name.

   A <mark:mark> element substitutes for the <mark:abstractMark>
   abstract element to define a concrete definition of a mark.  The
   <mark:abstractMark> element can be replaced by other mark definitions
   using the XML schema substitution groups feature.

   The child elements of the <mark:mark> element include:

   One or more <mark:trademark>, <mark:treatyOrStatute> and <mark:court>
   elements that contains the detailed information of marks.

   o  A <mark:trademark> element that contains the following child
      elements.

      *  A <mark:id> element that contains an identifier of the mark.
         The identifier MUST be globally unique in relation to the
         repository of marks.  A <mark:id> value is a concatenation of
         the local identifier, followed by a hyphen ("-", ASCII value
         0x002D), followed by the issuer identifier.

      *  A <mark:markName> element that contains the mark text string.

      *  One or more <mark:holder> elements that contains the
         information of the holder of the mark.  An "entitlement"
         attribute is used to identify the entitlement of the holder,
         possible values are: owner, assignee and licensee.

      *  Zero or more OPTIONAL <mark:contact> elements that contains the
         information of the representative of the mark registration.  A
         "type" attribute is used to identify the type of contact,
         possible values are: owner, agent or thirdparty.

      *  A <mark:jurisdiction> element that contains the two-character
         code of the jurisdiction where the trademark was registered.
         This is a two-character code from [WIPO.ST3].

      *  Zero or more OPTIONAL <mark:class> elements that contain the
         WIPO Nice Classification class numbers of the mark as defined
         in the WIPO Nice Classification [WIPO-NICE-CLASSES].





Lozano                   Expires March 31, 2016                 [Page 5]

Internet-Draft            Mark and Signed Mark            September 2015


      *  Zero or more OPTIONAL <mark:label> elements that contain the
         A-label form (as defined in [RFC5890]) of the label that
         correspond to the <mark:markName>.

      *  A <mark:goodsAndServices> element that contains the full
         description of the goods and services mentioned in the mark
         registration document.

      *  An OPTIONAL <mark:apId> element that contains the trademark
         application ID registered in the trademark office.

      *  An OPTIONAL <mark:apDate> element that contains the date the
         trademark was applied for.

      *  A <mark:regNum> element that contains the trademark
         registration number registered in the trademark office.

      *  A <mark:regDate> element that contains the date the trademark
         was registered.

      *  An OPTIONAL <mark:exDate> element that contains the expiration
         date of the trademark.

   o  A <mark:treatyOrStatute> element that contains the following child
      elements.

      *  A <mark:id> element that contains an identifier of the mark.
         The identifier MUST be globally unique in relation to the
         repository of marks.  A <mark:id> value is a concatenation of
         the local identifier, followed by a hyphen ("-", ASCII value
         0x002D), followed by the issuer identifier.

      *  A <mark:markName> element that contains the mark text string.

      *  One or more <mark:holder> elements that contains the
         information of the holder of the mark.  An "entitlement"
         attribute is used to identify the entitlement of the holder,
         possible values are: owner, assignee and licensee.

      *  Zero or more OPTIONAL <mark:contact> elements that contains the
         information of the representative of the mark registration.  A
         "type" attribute is used to identify the type of contact,
         possible values are: owner, agent or thirdparty.

      *  One or more <mark:protection> elements that contain the
         countries and region of the country where the mark is
         protected.  The <mark:protection> element contains the
         following child elements:



Lozano                   Expires March 31, 2016                 [Page 6]

Internet-Draft            Mark and Signed Mark            September 2015


         +  A <mark:cc> element that contains the two-character code of
            the country in which the mark is protected.  This is a two-
            character code from [ISO3166-2].

         +  An OPTIONAL <mark:region> element that contains the name of
            a city, state, province or other geographic region of
            <mark:country> in which the mark is protected.

         +  Zero or more OPTIONAL <mark:ruling> elements that contains
            the two-character code of the countries of the ruling.  This
            is a two-character code from [ISO3166-2].

      *  Zero or more OPTIONAL <mark:label> elements that contain the
         A-label form (as defined in [RFC5890]) of the label that
         correspond to the <mark:markName>.

      *  A <mark:goodsAndServices> element that contains the full
         description of the goods and services mentioned in the mark
         registration document.

      *  A <mark:refNum> element that contains the number of the mark of
         the treaty or statute.

      *  A <mark:proDate> element that contains the date of protection
         of the mark.

      *  A <mark:title> element that contains the title of the treaty or
         statute.

      *  A <mark:execDate> element that contains the execution date of
         the treaty or statute.

   o  A <mark:court> element that contains the following child elements.

      *  A <mark:id> element that contains an identifier of the mark.
         The identifier MUST be globally unique in relation to the
         repository of marks.  A <mark:id> value is a concatenation of
         the local identifier, followed by a hyphen ("-", ASCII value
         0x002D), followed by the issuer identifier.

      *  A <mark:markName> element that contains the mark text string.

      *  One or more <mark:holder> elements that contains the
         information of the holder of the mark.  An "entitlement"
         attribute is used to identify the entitlement of the holder,
         possible values are: owner, assignee and licensee.





Lozano                   Expires March 31, 2016                 [Page 7]

Internet-Draft            Mark and Signed Mark            September 2015


      *  Zero or more OPTIONAL <mark:contact> elements that contains the
         information of the representative of the mark registration.  A
         "type" attribute is used to identify the type of contact,
         possible values are: owner, agent or thirdparty.

      *  Zero or more OPTIONAL <mark:label> elements that contain the
         A-label form (as defined in [RFC5890]) of the label that
         correspond to the <mark:markName>.

      *  A <mark:goodsAndServices> element that contains the full
         description of the goods and services mentioned in the mark
         registration document.

      *  A <mark:refNum> element that contains the reference number of
         the court's opinion.

      *  A <mark:proDate> element that contains the date of protection
         of the mark.

      *  A <mark:cc> element that contains the two-character code of the
         country where the court is located.  This a two-character code
         from [ISO3166-2].

      *  Zero or more OPTIONAL <mark:region> elements that contains the
         name of a city, state, province or other geographic region of
         <mark:cc> in which the mark is protected.  In case
         <mark:region> is specified a default-deny approach MUST be
         assumed regarding the regions of a country.

      *  A <mark:courtName> element that contains the name of the court.

2.3.  Signed Mark

   The <smd:signedMark> is the fragment of XML that is digitally signed
   using XML Signature [XMLDSIG].  The <smd:signedMark> includes a
   required "id" attribute of type XSD ID for use with an IDREF URI from
   the Signature element.  The certificate of the issuer MAY be issued
   by a Certificate Authority (CA) that can be chained with the issuer's
   certificate by the validating client.

   A <smd:signedMark> element substitutes for the
   <smd:abstractSignedMark> abstract element to define a concrete
   definition of a signed mark.  The <smd:abstractSignedMark> element
   can be replaced by other signed mark definitions using the XML schema
   substitution groups feature.

   The child elements of the <smd:signedMark> element include:




Lozano                   Expires March 31, 2016                 [Page 8]

Internet-Draft            Mark and Signed Mark            September 2015


   o  The <smd:id> value is a concatenation of the local identifier,
      followed by a hyphen ("-", ASCII value 0x002D), followed by the
      issuer identifier.

   o  A <smd:issuerInfo> element that contains the information of the
      issuer of the mark registration.  A "issuerID" attribute is used
      to specify the issuer identifier.  The child elements include:

      *  A <smd:org> element that contains the organization name of the
         issuer.

      *  A <smd:email> element that contains the issuer customer support
         email address.

      *  An OPTIONAL <smd:url> element that contains the HTTP URL of the
         issuer's site.

      *  An OPTIONAL <smd:voice> element that contains the issuer's
         voice telephone number.

   o  A <smd:notBefore> element that contains the creation date and time
      of the signed mark.

   o  A <smd:notAfter> element that contains the expiration date and
      time of the signed mark.

   o  A <mark:mark> element that contains the mark information as
      defined in the Mark (Section 2.2) section.

   o  A <Signature> XML Signature [XMLDSIG] for the <smd:signedMark>.
      Use of a namespace prefix, like "dsig", is recommended for the
      "http://www.w3.org/TR/xmldsig-core/" elements.

   The following is an example <smd:signedMark> using the XML Signature
   [XMLDSIG] to sign all of the elements of <smd:signedMark> element.

 <?xml version="1.0" encoding="UTF-8"?>
 <smd:signedMark xmlns:smd="urn:ietf:params:xml:ns:signedMark-1.0"
 id="smd1">
   <smd:id>0000001751376056503931-65535</smd:id>
   <smd:issuerInfo issuerID="65535">
     <smd:org>ICANN TMCH TESTING TMV</smd:org>
     <smd:email>notavailable@example.com</smd:email>
     <smd:url>http://www.example.com</smd:url>
     <smd:voice>+32.000000</smd:voice>
   </smd:issuerInfo>
   <smd:notBefore>2013-08-09T13:55:03.931Z</smd:notBefore>
   <smd:notAfter>2017-07-23T22:00:00.000Z</smd:notAfter>



Lozano                   Expires March 31, 2016                 [Page 9]

Internet-Draft            Mark and Signed Mark            September 2015


   <mark:mark xmlns:mark="urn:ietf:params:xml:ns:mark-1.0">
     <mark:trademark>
       <mark:id>00052013734689731373468973-65535</mark:id>
       <mark:markName>Test &amp; Validate</mark:markName>
       <mark:holder entitlement="owner">
         <mark:org>Ag corporation</mark:org>
         <mark:addr>
           <mark:street>1305 Bright Avenue</mark:street>
           <mark:city>Arcadia</mark:city>
           <mark:sp>CA</mark:sp>
           <mark:pc>90028</mark:pc>
           <mark:cc>US</mark:cc>
         </mark:addr>
       </mark:holder>
       <mark:contact type="agent">
         <mark:name>Tony Holland</mark:name>
         <mark:org>Ag corporation</mark:org>
         <mark:addr>
           <mark:street>1305 Bright Avenue</mark:street>
           <mark:city>Arcadia</mark:city>
           <mark:sp>CA</mark:sp>
           <mark:pc>90028</mark:pc>
           <mark:cc>US</mark:cc>
         </mark:addr>
         <mark:voice>+1.2025562302</mark:voice>
         <mark:fax>+1.2025562301</mark:fax>
         <mark:email>info@agcorporation.com</mark:email>
       </mark:contact>
       <mark:jurisdiction>US</mark:jurisdiction>
       <mark:class>15</mark:class>
       <mark:label>testandvalidate</mark:label>
       <mark:label>test---validate</mark:label>
       <mark:label>testand-validate</mark:label>
       <mark:label>test-et-validate</mark:label>
       <mark:label>test-validate</mark:label>
       <mark:label>test--validate</mark:label>
       <mark:label>test-etvalidate</mark:label>
       <mark:label>testetvalidate</mark:label>
       <mark:label>testvalidate</mark:label>
       <mark:label>testet-validate</mark:label>
       <mark:goodsAndServices>guitar</mark:goodsAndServices>
       <mark:regNum>1234</mark:regNum>
       <mark:regDate>2012-12-31T23:00:00.000Z</mark:regDate>
     </mark:trademark>
   </mark:mark>
  <Signature xmlns="http://www.w3.org/2000/09/xmldsig#">
   <SignedInfo>
    <CanonicalizationMethod



Lozano                   Expires March 31, 2016                [Page 10]

Internet-Draft            Mark and Signed Mark            September 2015


 Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/>
    <SignatureMethod
 Algorithm="http://www.w3.org/2001/04/xmldsig-more#rsa-sha256"/>
    <Reference URI="#smd1">
     <Transforms>
      <Transform
 Algorithm="http://www.w3.org/2000/09/xmldsig#enveloped-signature"/>
     </Transforms>
     <DigestMethod
 Algorithm="http://www.w3.org/2001/04/xmlenc#sha256"/>
 <DigestValue>wgyW3nZPoEfpptlhRILKnOQnbdtU6ArM7ShrAfHgDFg=</DigestValue>
    </Reference>
   </SignedInfo>
   <SignatureValue>
 jMu4PfyQGiJBF0GWSEPFCJjmywCEqR2h4LD+ge6XQ+JnmKFFCuCZS/3SLKAx0L1w
 QDFO2e0Y69k2G7/LGE37X3vOflobFM1oGwja8+GMVraoto5xAd4/AF7eHukgAymD
 o9toxoa2h0yV4A4PmXzsU6S86XtCcUE+S/WM72nyn47zoUCzzPKHZBRyeWehVFQ+
 jYRMIAMzM57HHQA+6eaXefRvtPETgUO4aVIVSugc4OUAZZwbYcZrC6wOaQqqqAZi
 30aPOBYbAvHMSmWSS+hFkbshomJfHxb97TD2grlYNrQIzqXk7WbHWy2SYdA+sI/Z
 ipJsXNa6osTUw1CzA7jfwA==
   </SignatureValue>
   <KeyInfo>
    <X509Data>
    <X509Certificate>
 MIIESTCCAzGgAwIBAgIBAjANBgkqhkiG9w0BAQsFADBiMQswCQYDVQQGEwJVUzEL
 MAkGA1UECBMCQ0ExFDASBgNVBAcTC0xvcyBBbmdlbGVzMRMwEQYDVQQKEwpJQ0FO
 TiBUTUNIMRswGQYDVQQDExJJQ0FOTiBUTUNIIFRFU1QgQ0EwHhcNMTMwMjA4MDAw
 MDAwWhcNMTgwMjA3MjM1OTU5WjBsMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0Ex
 FDASBgNVBAcTC0xvcyBBbmdlbGVzMRcwFQYDVQQKEw5WYWxpZGF0b3IgVE1DSDEh
 MB8GA1UEAxMYVmFsaWRhdG9yIFRNQ0ggVEVTVCBDRVJUMIIBIjANBgkqhkiG9w0B
 AQEFAAOCAQ8AMIIBCgKCAQEAo/cwvXhbVYl0RDWWvoyeZpETVZVVcMCovUVNg/sw
 WinuMgEWgVQFrz0xA04pEhXCFVv4evbUpekJ5buqU1gmQyOsCKQlhOHTdPjvkC5u
 pDqa51Flk0TMaMkIQjs7aUKCmA4RG4tTTGK/EjR1ix8/D0gHYVRldy1YPrMP+ou7
 5bOVnIos+HifrAtrIv4qEqwLL4FTZAUpaCa2BmgXfy2CSRQbxD5Or1gcSa3vurh5
 sPMCNxqaXmIXmQipS+DuEBqMM8tldaN7RYojUEKrGVsNk5i9y2/7sjn1zyyUPf7v
 L4GgDYqhJYWV61DnXgx/Jd6CWxvsnDF6scscQzUTEl+hywIDAQABo4H/MIH8MAwG
 A1UdEwEB/wQCMAAwHQYDVR0OBBYEFPZEcIQcD/Bj2IFz/LERuo2ADJviMIGMBgNV
 HSMEgYQwgYGAFO0/7kEh3FuEKS+Q/kYHaD/W6wihoWakZDBiMQswCQYDVQQGEwJV
 UzELMAkGA1UECBMCQ0ExFDASBgNVBAcTC0xvcyBBbmdlbGVzMRMwEQYDVQQKEwpJ
 Q0FOTiBUTUNIMRswGQYDVQQDExJJQ0FOTiBUTUNIIFRFU1QgQ0GCAQEwDgYDVR0P
 AQH/BAQDAgeAMC4GA1UdHwQnMCUwI6AhoB+GHWh0dHA6Ly9jcmwuaWNhbm4ub3Jn
 L3RtY2guY3JsMA0GCSqGSIb3DQEBCwUAA4IBAQB2qSy7ui+43cebKUKwWPrzz9y/
 IkrMeJGKjo40n+9uekaw3DJ5EqiOf/qZ4pjBD++oR6BJCb6NQuQKwnoAz5lE4Ssu
 y5+i93oT3HfyVc4gNMIoHm1PS19l7DBKrbwbzAea/0jKWVzrvmV7TBfjxD3AQo1R
 bU5dBr6IjbdLFlnO5x0G0mrG7x5OUPuurihyiURpFDpwH8KAH1wMcCpXGXFRtGKk
 wydgyVYAty7otkl/z3bZkCVT34gPvF70sR6+QxUy8u0LzF5A/beYaZpxSYG31amL
 AdXitTWFipaIGea9lEGFM0L9+Bg7XzNn4nVLXokyEB3bgS4scG6QznX23FGk
   </X509Certificate>



Lozano                   Expires March 31, 2016                [Page 11]

Internet-Draft            Mark and Signed Mark            September 2015


   </X509Data>
   </KeyInfo>
  </Signature>
 </smd:signedMark>

   NOTE: The example shown above includes white-spaces for indentation
   purposes.  It is RECOMMENDED that SMDs do not include white-spaces
   between the XML elements, in order to mitigate risks of invalidating
   the digital signature when transferring of SMDs between applications
   takes place.

   NOTE: Exclusive XML canonicalization as defined in [XMLC14N] SHOULD
   be used when generating the SMD.  SHA256 as suggested by [RFC6194]
   and RSA-SHA256 SHOULD be used for digesting and signing respectively.
   The size of the RSA key SHOULD be at least 2048 bits.

2.4.  Encoded Signed Mark

   The <smd:encodedSignedMark> element contains an encoded form of the
   digitally signed <smd:signedMark> element, described in Section 2.3,
   with the encoding defined by the "encoding" attribute with the
   default "encoding" value of "base64".  The "base64" encoded text of
   the <smd:encodedSignedMark> element MUST conform to [RFC2045].  A
   full example of a <smd:encodedSignedMark> element is presented in
   Appendix A.

2.5.  Appendix A. base64 encoded signedMark

   The following is an example of a <smd:encodedSignedMark> element that
   uses the default "base64" for encoding a <smd:signedMark> element.

 <smd:encodedSignedMark
    xmlns:smd="urn:ietf:params:xml:ns:signedMark-1.0">
 PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHNtZDpzaWduZWRNYXJ
 rIHhtbG5zOnNtZD0idXJuOmlldGY6cGFyYW1zOnhtbDpuczpzaWduZWRNYXJrLTEuMCIgaW
 Q9Il84Yzk0ZjRmMS1jZTlmLTRjOTAtOTUzMS01MzE1ZDIzY2EzYmQiPgogIDxzbWQ6aWQ+M
 DAwMDAwMTc1MTM3NjA1NjUwMzkzMS02NTUzNTwvc21kOmlkPgogIDxzbWQ6aXNzdWVySW5m
 byBpc3N1ZXJJRD0iNjU1MzUiPgogICAgPHNtZDpvcmc+SUNBTk4gVE1DSCBURVNUSU5HIFR
 NVjwvc21kOm9yZz4KICAgIDxzbWQ6ZW1haWw+bm90YXZhaWxhYmxlQGV4YW1wbGUuY29tPC
 9zbWQ6ZW1haWw+CiAgICA8c21kOnVybD5odHRwOi8vd3d3LmV4YW1wbGUuY29tPC9zbWQ6d
 XJsPgogICAgPHNtZDp2b2ljZT4rMzIuMDAwMDAwPC9zbWQ6dm9pY2U+CiAgPC9zbWQ6aXNz
 dWVySW5mbz4KICA8c21kOm5vdEJlZm9yZT4yMDEzLTA4LTA5VDEzOjU1OjAzLjkzMVo8L3N
 tZDpub3RCZWZvcmU+CiAgPHNtZDpub3RBZnRlcj4yMDE3LTA3LTIzVDIyOjAwOjAwLjAwMF
 o8L3NtZDpub3RBZnRlcj4KICA8bWFyazptYXJrIHhtbG5zOm1hcms9InVybjppZXRmOnBhc
 mFtczp4bWw6bnM6bWFyay0xLjAiPgogICAgPG1hcms6dHJhZGVtYXJrPgogICAgICA8bWFy
 azppZD4wMDA1MjAxMzczNDY4OTczMTM3MzQ2ODk3My02NTUzNTwvbWFyazppZD4KICAgICA
 gPG1hcms6bWFya05hbWU+VGVzdCAmYW1wOyBWYWxpZGF0ZTwvbWFyazptYXJrTmFtZT4KIC
 AgICAgPG1hcms6aG9sZGVyIGVudGl0bGVtZW50PSJvd25lciI+CiAgICAgICAgPG1hcms6b



Lozano                   Expires March 31, 2016                [Page 12]

Internet-Draft            Mark and Signed Mark            September 2015


 3JnPkFnIGNvcnBvcmF0aW9uPC9tYXJrOm9yZz4KICAgICAgICA8bWFyazphZGRyPgogICAg
 ICAgICAgPG1hcms6c3RyZWV0PjEzMDUgQnJpZ2h0IEF2ZW51ZTwvbWFyazpzdHJlZXQ+CiA
 gICAgICAgICA8bWFyazpjaXR5PkFyY2FkaWE8L21hcms6Y2l0eT4KICAgICAgICAgIDxtYX
 JrOnNwPkNBPC9tYXJrOnNwPgogICAgICAgICAgPG1hcms6cGM+OTAwMjg8L21hcms6cGM+C
 iAgICAgICAgICA8bWFyazpjYz5VUzwvbWFyazpjYz4KICAgICAgICA8L21hcms6YWRkcj4K
 ICAgICAgPC9tYXJrOmhvbGRlcj4KICAgICAgPG1hcms6Y29udGFjdCB0eXBlPSJhZ2VudCI
 +CiAgICAgICAgPG1hcms6bmFtZT5Ub255IEhvbGxhbmQ8L21hcms6bmFtZT4KICAgICAgIC
 A8bWFyazpvcmc+QWcgY29ycG9yYXRpb248L21hcms6b3JnPgogICAgICAgIDxtYXJrOmFkZ
 HI+CiAgICAgICAgICA8bWFyazpzdHJlZXQ+MTMwNSBCcmlnaHQgQXZlbnVlPC9tYXJrOnN0
 cmVldD4KICAgICAgICAgIDxtYXJrOmNpdHk+QXJjYWRpYTwvbWFyazpjaXR5PgogICAgICA
 gICAgPG1hcms6c3A+Q0E8L21hcms6c3A+CiAgICAgICAgICA8bWFyazpwYz45MDAyODwvbW
 FyazpwYz4KICAgICAgICAgIDxtYXJrOmNjPlVTPC9tYXJrOmNjPgogICAgICAgIDwvbWFya
 zphZGRyPgogICAgICAgIDxtYXJrOnZvaWNlPisxLjIwMjU1NjIzMDI8L21hcms6dm9pY2U+
 CiAgICAgICAgPG1hcms6ZmF4PisxLjIwMjU1NjIzMDE8L21hcms6ZmF4PgogICAgICAgIDx
 tYXJrOmVtYWlsPmluZm9AYWdjb3Jwb3JhdGlvbi5jb208L21hcms6ZW1haWw+CiAgICAgID
 wvbWFyazpjb250YWN0PgogICAgICA8bWFyazpqdXJpc2RpY3Rpb24+VVM8L21hcms6anVya
 XNkaWN0aW9uPgogICAgICA8bWFyazpjbGFzcz4xNTwvbWFyazpjbGFzcz4KICAgICAgPG1h
 cms6bGFiZWw+dGVzdGFuZHZhbGlkYXRlPC9tYXJrOmxhYmVsPgogICAgICA8bWFyazpsYWJ
 lbD50ZXN0LS0tdmFsaWRhdGU8L21hcms6bGFiZWw+CiAgICAgIDxtYXJrOmxhYmVsPnRlc3
 RhbmQtdmFsaWRhdGU8L21hcms6bGFiZWw+CiAgICAgIDxtYXJrOmxhYmVsPnRlc3QtZXQtd
 mFsaWRhdGU8L21hcms6bGFiZWw+CiAgICAgIDxtYXJrOmxhYmVsPnRlc3QtdmFsaWRhdGU8
 L21hcms6bGFiZWw+CiAgICAgIDxtYXJrOmxhYmVsPnRlc3QtLXZhbGlkYXRlPC9tYXJrOmx
 hYmVsPgogICAgICA8bWFyazpsYWJlbD50ZXN0LWV0dmFsaWRhdGU8L21hcms6bGFiZWw+Ci
 AgICAgIDxtYXJrOmxhYmVsPnRlc3RldHZhbGlkYXRlPC9tYXJrOmxhYmVsPgogICAgICA8b
 WFyazpsYWJlbD50ZXN0dmFsaWRhdGU8L21hcms6bGFiZWw+CiAgICAgIDxtYXJrOmxhYmVs
 PnRlc3RldC12YWxpZGF0ZTwvbWFyazpsYWJlbD4KICAgICAgPG1hcms6Z29vZHNBbmRTZXJ
 2aWNlcz5ndWl0YXI8L21hcms6Z29vZHNBbmRTZXJ2aWNlcz4KICAgICAgPG1hcms6cmVnTn
 VtPjEyMzQ8L21hcms6cmVnTnVtPgogICAgICA8bWFyazpyZWdEYXRlPjIwMTItMTItMzFUM
 jM6MDA6MDAuMDAwWjwvbWFyazpyZWdEYXRlPgogICAgPC9tYXJrOnRyYWRlbWFyaz4KICA8
 L21hcms6bWFyaz4KPGRzOlNpZ25hdHVyZSB4bWxuczpkcz0iaHR0cDovL3d3dy53My5vcmc
 vMjAwMC8wOS94bWxkc2lnIyIgSWQ9Il81ODg5YzM5Zi1jMzM3LTQ0NzctOTU1Ni05NTNiZT
 A5Y2NkMTgiPjxkczpTaWduZWRJbmZvPjxkczpDYW5vbmljYWxpemF0aW9uTWV0aG9kIEFsZ
 29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PGRz
 OlNpZ25hdHVyZU1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQ
 veG1sZHNpZy1tb3JlI3JzYS1zaGEyNTYiLz48ZHM6UmVmZXJlbmNlIFVSST0iI184Yzk0Zj
 RmMS1jZTlmLTRjOTAtOTUzMS01MzE1ZDIzY2EzYmQiPjxkczpUcmFuc2Zvcm1zPjxkczpUc
 mFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcj
 ZW52ZWxvcGVkLXNpZ25hdHVyZSIvPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8
 vd3d3LnczLm9yZy8yMDAxLzEwL3htbC1leGMtYzE0biMiLz48L2RzOlRyYW5zZm9ybXM+PG
 RzOkRpZ2VzdE1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMDQve
 G1sZW5jI3NoYTI1NiIvPjxkczpEaWdlc3RWYWx1ZT5IdUdKYlZCWkVaVGlFelB2d0NObVFs
 NmFMZEExWHo1QzAzdnhDWFBIZW1BPTwvZHM6RGlnZXN0VmFsdWU+PC9kczpSZWZlcmVuY2U
 +PGRzOlJlZmVyZW5jZSBVUkk9IiNfMWRlNTg5OGMtNmY3Ny00ZDViLTlkZDgtMzE4MWM5MT
 E3Yzk3Ij48ZHM6VHJhbnNmb3Jtcz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL
 3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIi8+PC9kczpUcmFuc2Zvcm1zPjxk
 czpEaWdlc3RNZXRob2QgQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAxLzA0L3h
 tbGVuYyNzaGEyNTYiLz48ZHM6RGlnZXN0VmFsdWU+NHBiU0M2M2xObVBxelc3TDBNRDBxZ0
 5GNHc5SUE3YXQ3OWxEVE5VZjBndz08L2RzOkRpZ2VzdFZhbHVlPjwvZHM6UmVmZXJlbmNlP



Lozano                   Expires March 31, 2016                [Page 13]

Internet-Draft            Mark and Signed Mark            September 2015


 jwvZHM6U2lnbmVkSW5mbz48ZHM6U2lnbmF0dXJlVmFsdWUgSWQ9Il9hODAwZmIwNS02NjRh
 LTQ2OTItYjM5MS04OTM4NTlhNTM0OGQiPlc5VHAxQ09HeEk4dlZQNkZONEdpYlhtc3RRM1Z
 0bmpSZVN3VVdicFZCTEtmenZ1L1c1OGNoOUdxdnRQTm9HZTdXOXVvQUt0U1J0MUkKMzdPeD
 IwQmVQb2xGdWZmekVVR3NGMHBETkRoWmNiRUdEMlVWRTBpYnhIRkVDUU13d0ppK1NVb2ora
 3JIWmRXM0FybmNaZ0RkMkhXZgpudVJZSmVucnpCS2k2RG1YVlVRYlhXRFVkbGxzcjlDSmtB
 THYrd0s2V2RweE9Na0NTc2E0WUU2bEVNTjVXNGhzUXFlZ2N6ZGkwdUZ0CnZxQ2JLVnM3RTJ
 3c0VIZC94aUxzbldZNEUxNWdLNnI0UW9tWHJqdFI0ZkFyZ1lMTnRLK09NRCt6UktNeGNuNV
 F2QzJVeHlzNUV6RHcKNmhlenYrdXBxTldkRjRYL2lCNW1JY25DMzAraVBpY3lDb2JHUlE9P
 TwvZHM6U2lnbmF0dXJlVmFsdWU+PGRzOktleUluZm8gSWQ9Il8xZGU1ODk4Yy02Zjc3LTRk
 NWItOWRkOC0zMTgxYzkxMTdjOTciPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXR
 lPk1JSUZMekNDQkJlZ0F3SUJBZ0lnTHJBYmV2b2FlNTJ5M2Y2QzJ0QjBTbjNwN1hKbTBUMD
 JGb2d4S0NmTmhYb3dEUVlKS29aSWh2Y04KQVFFTEJRQXdmREVMTUFrR0ExVUVCaE1DVlZNe
 FBEQTZCZ05WQkFvVE0wbHVkR1Z5Ym1WMElFTnZjbkJ2Y21GMGFXOXVJR1p2Y2lCQgpjM05w
 WjI1bFpDQk9ZVzFsY3lCaGJtUWdUblZ0WW1WeWN6RXZNQzBHQTFVRUF4TW1TVU5CVGs0Z1Z
 ISmhaR1Z0WVhKcklFTnNaV0Z5CmFXNW5hRzkxYzJVZ1VHbHNiM1FnUTBFd0hoY05NVE13Tm
 pJMk1EQXdNREF3V2hjTk1UZ3dOakkxTWpNMU9UVTVXakNCanpFTE1Ba0cKQTFVRUJoTUNRa
 1V4SURBZUJnTlZCQWdURjBKeWRYTnpaV3h6TFVOaGNHbDBZV3dnVW1WbmFXOXVNUkV3RHdZ
 RFZRUUhFd2hDY25WegpjMlZzY3pFUk1BOEdBMVVFQ2hNSVJHVnNiMmwwZEdVeE9EQTJCZ05
 WQkFNVEwwbERRVTVPSUZSTlEwZ2dRWFYwYUc5eWFYcGxaQ0JVCmNtRmtaVzFoY21zZ1VHbH
 NiM1FnVm1Gc2FXUmhkRzl5TUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ
 2dLQ0FRRUEKeGxwM0twWUhYM1d5QXNGaFNrM0x3V2ZuR2x4blVERnFGWkEzVW91TVlqL1hp
 Z2JNa05lRVhJamxrUk9LVDRPUEdmUngvTEF5UmxRUQpqQ012NHFoYmtjWDFwN2FyNjNmbHE
 0U1pOVmNsMTVsN2gwdVQ1OEZ6U2ZubHowdTVya0hmSkltRDQzK21hUC84Z3YzNkZSMjdqVz
 hSCjl3WTRoaytXczRJQjBpRlNkOFNYdjFLcjh3L0ptTVFTRGtpdUcrUmZJaXVid1EvZnk3R
 WtqNVFXaFBadyttTXhOS25IVUx5M3hZejIKTHdWZmZ0andVdWVhY3ZxTlJDa01YbENsT0FE
 cWZUOG9TWm9lRFhlaEh2bFBzTENlbUdCb1RLdXJza0lTNjlGMHlQRUg1Z3plMEgrZgo4RlJ
 Pc0lvS1NzVlEzNEI0Uy9qb0U2N25wc0pQVGRLc05QSlR5UUlEQVFBQm80SUJoekNDQVlNd0
 RBWURWUjBUQVFIL0JBSXdBREFkCkJnTlZIUTRFRmdRVW9GcFk3NnA1eW9ORFJHdFFwelZ1U
 jgxVVdRMHdnY1lHQTFVZEl3U0J2akNCdTRBVXc2MCtwdFlSQUVXQVhEcFgKU29wdDNERU5u
 bkdoZ1lDa2ZqQjhNUXN3Q1FZRFZRUUdFd0pWVXpFOE1Eb0dBMVVFQ2hNelNXNTBaWEp1Wlh
 RZ1EyOXljRzl5WVhScApiMjRnWm05eUlFRnpjMmxuYm1Wa0lFNWhiV1Z6SUdGdVpDQk9kVz
 FpWlhKek1TOHdMUVlEVlFRREV5WkpRMEZPVGlCVWNtRmtaVzFoCmNtc2dRMnhsWVhKcGJtZ
 G9iM1Z6WlNCUWFXeHZkQ0JEUVlJZ0xyQWJldm9hZTUyeTNmNkMydEIwU24zcDdYSm0wVDAy
 Rm9neEtDZk4KaFhrd0RnWURWUjBQQVFIL0JBUURBZ2VBTURRR0ExVWRId1F0TUNzd0thQW5
 vQ1dHSTJoMGRIQTZMeTlqY213dWFXTmhibTR1YjNKbgpMM1J0WTJoZmNHbHNiM1F1WTNKc0
 1FVUdBMVVkSUFRK01Ed3dPZ1lES2dNRU1ETXdNUVlJS3dZQkJRVUhBZ0VXSldoMGRIQTZMe
 TkzCmQzY3VhV05oYm00dWIzSm5MM0JwYkc5MFgzSmxjRzl6YVhSdmNua3dEUVlKS29aSWh2
 Y05BUUVMQlFBRGdnRUJBSWVEWVlKcjYwVzMKeTlRcyszelJWSTlrZWtLb201dmtIT2FsQjN
 3SGFaSWFBRllwSTk4dFkwYVZOOWFHT04wdjZXUUYrbnZ6MUtSWlFiQXowMUJYdGFSSgo0bV
 BrYXJoaHVMbjlOa0J4cDhIUjVxY2MrS0g3Z3Y2ci9jMGlHM2JDTkorUVNyN1FmKzVNbE1vN
 npMNVVkZFUvVDJqaWJNWENqL2YyCjFRdzN4OVFnb3lYTEZKOW96YUxnUTlSTWtMbE9temtD
 QWlYTjVBYjQzYUo5ZjdOMmdFMk5uUmpOS21tQzlBQlEwVFJ3RUtWTGhWbDEKVUdxQ0hKM0F
 sQlhXSVhONXNqUFFjRC8rbkhlRVhNeFl2bEF5cXhYb0QzTVd0UVZqN2oyb3FsYWtPQk1nRz
 grcTJxWWxtQnRzNEZOaQp3NzQ4SWw1ODZIS0JScXhIdFpkUktXMlZxYVE9PC9kczpYNTA5Q
 2VydGlmaWNhdGU+PC9kczpYNTA5RGF0YT48L2RzOktleUluZm8+PC9kczpTaWduYXR1cmU+
 PC9zbWQ6c2lnbmVkTWFyaz4=
 </smd:encodedSignedMark>




Lozano                   Expires March 31, 2016                [Page 14]

Internet-Draft            Mark and Signed Mark            September 2015


3.  Formal Syntax

   Two schemas are presented here.  The first schema is the schema for
   the signed mark.  The second schema is the schema for the mark.

   The formal syntax presented here is a complete schema representation
   of the object mapping suitable for automated validation of EPP XML
   instances.  The BEGIN and END tags are not part of the schema; they
   are used to note the beginning and ending of the schema for URI
   registration purposes.

3.1.  Signed Mark Schema

   Copyright (c) 2012 IETF Trust and the persons identified as authors
   of the code.  All rights reserved.

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:

   o  Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

   o  Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in
      the documentation and/or other materials provided with the
      distribution.

   o  Neither the name of Internet Society, IETF or IETF Trust, nor the
      names of specific contributors, may be used to endorse or promote
      products derived from this software without specific prior written
      permission.

   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT
   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

  BEGIN
  <?xml version="1.0" encoding="UTF-8"?>
  <schema



Lozano                   Expires March 31, 2016                [Page 15]

Internet-Draft            Mark and Signed Mark            September 2015


    targetNamespace="urn:ietf:params:xml:ns:signedMark-1.0"
    xmlns:smd="urn:ietf:params:xml:ns:signedMark-1.0"
    xmlns:mark="urn:ietf:params:xml:ns:mark-1.0"
    xmlns:dsig="http://www.w3.org/2000/09/xmldsig#"
    xmlns="http://www.w3.org/2001/XMLSchema"
    elementFormDefault="qualified">

    <annotation>
      <documentation>
        Schema for representing a Signed Trademark.
      </documentation>
    </annotation>

    <import namespace="urn:ietf:params:xml:ns:mark-1.0"
      schemaLocation="mark-1.0.xsd" />
    <import namespace="http://www.w3.org/2000/09/xmldsig#"
      schemaLocation="xmldsig-core-schema.xsd"/>

    <!--
    Abstract signed mark for replacement via substitution.
    -->
    <element name="abstractSignedMark" type="smd:abstractSignedMarkType"
      abstract="true"/>

    <!--
    Empty type for use in extending for a signed mark
    -->
    <complexType name="abstractSignedMarkType"/>


    <element name="signedMark" type="smd:signedMarkType"
      substitutionGroup="smd:abstractSignedMark"/>

    <element name="encodedSignedMark" type="smd:encodedSignedMarkType"/>


    <complexType name="signedMarkType">
      <complexContent>
        <extension base="smd:abstractSignedMarkType">
          <sequence>
            <element name="id" type="mark:idType"/>
            <element name="issuerInfo" type="smd:issuerInfoType"/>
            <element name="notBefore" type="dateTime"/>
            <element name="notAfter" type="dateTime"/>
            <element ref="mark:abstractMark"/>
            <element ref="dsig:Signature"/>
          </sequence>
          <attribute name="id" type="ID" use="required"/>



Lozano                   Expires March 31, 2016                [Page 16]

Internet-Draft            Mark and Signed Mark            September 2015


        </extension>
      </complexContent>
    </complexType>

    <complexType name="issuerInfoType">
      <sequence>
        <element name="org" type="token"/>
        <element name="email" type="mark:minTokenType"/>
        <element name="url" type="token" minOccurs="0"/>
        <element name="voice" type="mark:e164Type" minOccurs="0"/>
      </sequence>
      <attribute name="issuerID" type="token" use="required"/>
    </complexType>


    <complexType name="encodedSignedMarkType">
      <simpleContent>
        <extension base="token">
          <attribute name="encoding" type="token" default="base64"/>
        </extension>
      </simpleContent>
    </complexType>
  </schema>
  END

3.2.  Mark Schema

   Copyright (c) 2012 IETF Trust and the persons identified as authors
   of the code.  All rights reserved.

   Redistribution and use in source and binary forms, with or without
   modification, are permitted provided that the following conditions
   are met:

   o  Redistributions of source code must retain the above copyright
      notice, this list of conditions and the following disclaimer.

   o  Redistributions in binary form must reproduce the above copyright
      notice, this list of conditions and the following disclaimer in
      the documentation and/or other materials provided with the
      distribution.

   o  Neither the name of Internet Society, IETF or IETF Trust, nor the
      names of specific contributors, may be used to endorse or promote
      products derived from this software without specific prior written
      permission.





Lozano                   Expires March 31, 2016                [Page 17]

Internet-Draft            Mark and Signed Mark            September 2015


   THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
   "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
   LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
   A PARTICULAR PURPOSE ARE DISCLAIMED.  IN NO EVENT SHALL THE COPYRIGHT
   OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
   SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
   LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
   DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
   THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
   (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
   OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.

 BEGIN
 <?xml version="1.0" encoding="UTF-8"?>
 <schema
   targetNamespace="urn:ietf:params:xml:ns:mark-1.0"
   xmlns:mark="urn:ietf:params:xml:ns:mark-1.0"
   xmlns="http://www.w3.org/2001/XMLSchema"
   elementFormDefault="qualified">

   <annotation>
     <documentation>
       Schema for representing a Trademark, also referred to
       as Mark.
     </documentation>
   </annotation>

   <!--
   Abstract mark for replacement via substitution.
   -->
   <element name="abstractMark" type="mark:abstractMarkType"
     abstract="true"/>

   <!--
   <mark:mark> element definition
   -->
   <element name="mark" type="mark:markType"
     substitutionGroup="mark:abstractMark"/>

   <!--
   Empty type for use in extending for a mark
   -->
   <complexType name="abstractMarkType"/>

   <!--
   <mark:mark> child elements
   -->
   <complexType name="markType">



Lozano                   Expires March 31, 2016                [Page 18]

Internet-Draft            Mark and Signed Mark            September 2015


     <complexContent>
       <extension base="mark:abstractMarkType">
         <sequence>
           <element name="trademark" type="mark:trademarkType"
             minOccurs="0" maxOccurs="unbounded"/>
           <element name="treatyOrStatute"
             type="mark:treatyOrStatuteType" minOccurs="0"
             maxOccurs="unbounded"/>
           <element name="court" type="mark:courtType" minOccurs="0"
             maxOccurs="unbounded"/>
         </sequence>
       </extension>
     </complexContent>
   </complexType>

   <complexType name="holderType">
     <sequence>
       <element name="name" type="token" minOccurs="0"/>
       <element name="org" type="token" minOccurs="0"/>
       <element name="addr" type="mark:addrType"/>
       <element name="voice" type="mark:e164Type" minOccurs="0"/>
       <element name="fax" type="mark:e164Type" minOccurs="0"/>
       <element name="email" type="mark:minTokenType" minOccurs="0"/>
     </sequence>
     <attribute name="entitlement" type="mark:entitlementType"/>
   </complexType>

   <complexType name="contactType">
     <sequence>
       <element name="name" type="token"/>
       <element name="org" type="token" minOccurs="0"/>
       <element name="addr" type="mark:addrType"/>
       <element name="voice" type="mark:e164Type"/>
       <element name="fax" type="mark:e164Type" minOccurs="0"/>
       <element name="email" type="mark:minTokenType"/>
     </sequence>
     <attribute name="type" type="mark:contactTypeType"/>
   </complexType>

   <complexType name="trademarkType">
     <sequence>
       <element name="id" type="mark:idType"/>
       <element name="markName" type="token"/>
       <element name="holder" type="mark:holderType"
         maxOccurs="unbounded" />
       <element name="contact" type="mark:contactType" minOccurs="0"
         maxOccurs="unbounded"/>
       <element name="jurisdiction" type="mark:ccType"/>



Lozano                   Expires March 31, 2016                [Page 19]

Internet-Draft            Mark and Signed Mark            September 2015


       <element name="class" type="integer" minOccurs="0"
         maxOccurs="unbounded"/>
       <element name="label" type="mark:labelType" minOccurs="0"
         maxOccurs="unbounded"/>
       <element name="goodsAndServices" type="token" />
       <element name="apId" type="token" minOccurs="0"/>
       <element name="apDate" type="dateTime" minOccurs="0"/>
       <element name="regNum" type="token"/>
       <element name="regDate" type="dateTime"/>
       <element name="exDate" type="dateTime" minOccurs="0"/>
     </sequence>
   </complexType>

   <complexType name="treatyOrStatuteType">
     <sequence>
       <element name="id" type="mark:idType"/>
       <element name="markName" type="token"/>
       <element name="holder" type="mark:holderType"
         maxOccurs="unbounded" />
       <element name="contact" type="mark:contactType" minOccurs="0"
         maxOccurs="unbounded"/>
       <element name="protection" type="mark:protectionType"
         maxOccurs="unbounded"/>
       <element name="label" type="mark:labelType" minOccurs="0"
         maxOccurs="unbounded"/>
       <element name="goodsAndServices" type="token" />
       <element name="refNum" type="token"/>
       <element name="proDate" type="dateTime"/>
       <element name="title" type="token"/>
       <element name="execDate" type="dateTime"/>
     </sequence>
   </complexType>

   <complexType name="courtType">
     <sequence>
       <element name="id" type="mark:idType"/>
       <element name="markName" type="token"/>
       <element name="holder" type="mark:holderType"
         maxOccurs="unbounded" />
       <element name="contact" type="mark:contactType" minOccurs="0"
         maxOccurs="unbounded"/>
       <element name="label" type="mark:labelType" minOccurs="0"
         maxOccurs="unbounded"/>
       <element name="goodsAndServices" type="token" />
       <element name="refNum" type="token"/>
       <element name="proDate" type="dateTime"/>
       <element name="cc" type="mark:ccType"/>
       <element name="region" type="token" minOccurs="0"



Lozano                   Expires March 31, 2016                [Page 20]

Internet-Draft            Mark and Signed Mark            September 2015


         maxOccurs="unbounded"/>
       <element name="courtName" type="token"/>
     </sequence>
   </complexType>

   <!--
   Address (<mark:addr>) child elements
   -->
   <complexType name="addrType">
     <sequence>
       <element name="street" type="token" minOccurs="1" maxOccurs="3"/>
       <element name="city" type="token"/>
       <element name="sp" type="token" minOccurs="0"/>
       <element name="pc" type="mark:pcType" minOccurs="0"/>
       <element name="cc" type="mark:ccType"/>
     </sequence>
   </complexType>

   <!--
   <mark:protection> child elements
   -->
   <complexType name="protectionType">
     <sequence>
       <element name="cc" type="mark:ccType"/>
       <element name="region" type="token" minOccurs="0"/>
       <element name="ruling" type="mark:ccType"
         minOccurs="0" maxOccurs="unbounded"/>
     </sequence>
   </complexType>

   <!--
   Postal code definition
   -->
   <simpleType name="pcType">
     <restriction base="token">
       <maxLength value="16"/>
     </restriction>
   </simpleType>

   <!--
   Country code definition
   -->
   <simpleType name="ccType">
     <restriction base="token">
       <length value="2"/>
     </restriction>
   </simpleType>




Lozano                   Expires March 31, 2016                [Page 21]

Internet-Draft            Mark and Signed Mark            September 2015


   <!--
   Phone number with extension definition
   -->
   <complexType name="e164Type">
     <simpleContent>
       <extension base="mark:e164StringType">
         <attribute name="x" type="token"/>
       </extension>
     </simpleContent>
   </complexType>

   <!--
   Phone number with extension definition
   -->
   <simpleType name="e164StringType">
     <restriction base="token">
       <pattern value="(\+[0-9]{1,3}\.[0-9]{1,14})?"/>
       <maxLength value="17"/>
     </restriction>
   </simpleType>

   <!--
   Id type definition
   -->
   <simpleType name="idType">
     <restriction base="token">
       <pattern value="\d+-\d+"/>
     </restriction>
   </simpleType>

   <!--
   DNS label type definition
   -->
   <simpleType name="labelType">
     <restriction base="token">
       <minLength value="1"/>
       <maxLength value="63"/>
       <pattern value="[a-zA-Z0-9]([a-zA-Z0-9\-]*[a-zA-Z0-9])?"/>
     </restriction>
   </simpleType>

   <!--
   Type used for email addresses
   -->
   <simpleType name="minTokenType">
     <restriction base="token">
       <minLength value="1"/>
     </restriction>



Lozano                   Expires March 31, 2016                [Page 22]

Internet-Draft            Mark and Signed Mark            September 2015


   </simpleType>

   <simpleType name="entitlementType">
     <restriction base="token">
       <enumeration value="owner"/>
       <enumeration value="assignee"/>
       <enumeration value="licensee"/>
     </restriction>
   </simpleType>

   <simpleType name="contactTypeType">
     <restriction base="token">
       <enumeration value="owner"/>
       <enumeration value="agent"/>
       <enumeration value="thirdparty"/>
     </restriction>
   </simpleType>
 </schema>
 END

4.  Implementation Status

   Note to RFC Editor: Please remove this section and the reference to
   RFC 6982 [RFC6982] before publication.

   This section records the status of known implementations of the
   format defined by this specification at the time of posting of this
   Internet-Draft, and is based on a proposal described in RFC 6982
   [RFC6982].  The description of implementations in this section is
   intended to assist the IETF in its decision processes in progressing
   drafts to RFCs.  Please note that the listing of any individual
   implementation here does not imply endorsement by the IETF.
   Furthermore, no effort has been spent to verify the information
   presented here that was supplied by IETF contributors.  This is not
   intended as, and must not be construed to be, a catalog of available
   implementations or their features.  Readers are advised to note that
   other implementations may exist.

   According to RFC 6982 [RFC6982], "this will allow reviewers and
   working groups to assign due consideration to documents that have the
   benefit of running code, which may serve as evidence of valuable
   experimentation and feedback that have made the implemented protocols
   more mature.  It is up to the individual working groups to use this
   information as they see fit".







Lozano                   Expires March 31, 2016                [Page 23]

Internet-Draft            Mark and Signed Mark            September 2015


4.1.  Verisign EPP SDK

   Organization: Verisign Inc.

   Name: Verisign EPP SDK

   Description: The Verisign EPP SDK includes both a full client
   implementation and a full server stub implementation of draft-ietf-
   eppext-tmch-smd.

   Level of maturity: Production

   Coverage: All aspects of the draft-ietf-eppext-tmch-smd are
   implemented.

   Licensing: GNU Lesser General Public License

   Contact: jgould@verisign.com

   URL: http://www.verisigninc.com/en_US/channel-resources/domain-
   registry-products/epp-sdks

4.2.  Verisign Consolidated Top Level Domain (CTLD) SRS

   Organization: Verisign Inc.

   Name: Verisign Consolidated Top Level Domain (CTLD) Shared Registry
   System (SRS)

   Description: The Verisign Consolidated Top Level Domain (CTLD) Shared
   Registry System (SRS) implements the server-side of draft-ietf-
   eppext-tmch-smd for a variety of Top Level Domains (TLD's).

   Level of maturity: Production

   Coverage: Implements parsing and validation of all aspects of draft-
   ietf-eppext-tmch-smd including the Signed Mark, the Encoded Signed
   Mark, and the contained Mark.  Implements the encoding of the Mark in
   supporting the response of draft-ietf-eppext-launchphase.

   Licensing: Proprietary

   Contact: jgould@verisign.com








Lozano                   Expires March 31, 2016                [Page 24]

Internet-Draft            Mark and Signed Mark            September 2015


4.3.  Verisign .COM / .NET SRS

   Organization: Verisign Inc.

   Name: Verisign .COM / .NET Shared Registry System (SRS)

   Description: The Verisign Shared Registry System (SRS) for .COM, .NET
   and other IDN TLD's implements the server-side of draft-ietf-eppext-
   tmch-smd.

   Level of maturity: Operational Test Environment (OTE)

   Coverage: Implements parsing and validation of all aspects of draft-
   ietf-eppext-tmch-smd including the Signed Mark, the Encoded Signed
   Mark, and the contained Mark.

   Licensing: Proprietary

   Contact: jgould@verisign.com

4.4.  REngin v3.7

   Organisation: Domain Name Services (Pty) Ltd

   Name: REngin v3.7

   Description: Server side implementation only

   Level of maturity: Production

   Coverage: All aspects of draft-ietf-eppext-tmch-smd have been
   implemented

   Licensing: Proprietary Licensing with Maintenance Contracts

   Contact: info@dnservices.co.za

   URL: http://domain-name.services

4.5.  Uniregistry Corp.  Shared Registry System (uSRS)

   Organization: Uniregistry Corp.

   Name: Uniregistry Corp.  Shared Registry System (uSRS)

   Description: Uniregistry's Shared Registry System implements the
   server-side of draft-ietf-eppext-tmch-smd for its TLD registry.




Lozano                   Expires March 31, 2016                [Page 25]

Internet-Draft            Mark and Signed Mark            September 2015


   Level of maturity: Production

   Coverage: Implements parsing and validation of all aspects of draft-
   ietf-eppext-tmch-smd including the Signed Mark, the Encoded Signed
   Mark, and the contained Mark.  Implements the encoding of the Mark in
   supporting the response of draft-ietf-eppext-launchphase.

   Licensing: Proprietary

   Contact: fobispo@uniregistry.link

5.  Acknowledgements

   Special thanks to Chris Wright for creating the first prototype of a
   SMD; James Gould, Wil Tan and Gavin Brown for creating the mark and
   SMD definitions in their EPP draft launch extension on which this
   draft is based.  Portions of the security section were shamefully
   copied from RFC5105.  Special suggestions that have been incorporated
   into this document were provided by Scott Hollenbeck.

6.  Change History

   [[RFC Editor: Please remove this section.]]

   Version draft-ietf-eppext-tmch-smd-02 to version draft-ietf-eppext-
   tmch-smd-03

      RFC6194 and RFC6982 moved to informative references section.

   Version draft-ietf-eppext-tmch-smd-01 to version draft-ietf-eppext-
   tmch-smd-02

      Security considerations section was updated.

      IANA considerations section was updated.

      Normative reference added for the ICANN Trademark Clearinghouse
      definition document.

      Editorial changes.

   Version draft-ietf-eppext-tmch-smd-00 to version draft-ietf-eppext-
   tmch-smd-01

      Implementation Status section added.

      Added type to the enconding element.




Lozano                   Expires March 31, 2016                [Page 26]

Internet-Draft            Mark and Signed Mark            September 2015


   Version draft-lozano-tmch-smd-03 to version draft-ietf-eppext-tmch-
   smd-00

      Internet-Draft resubmitted.

   Version 02 to version 03

      <smd:signedMark> example is now aligned with ICANN test SMDs.

      <smd:encodedSignedMark> example is replaced with a public ICANN
      test SMD.

      Several recommendations where added.

   Version 01 to version 02

      Change apID and regNum of trademark validated mark to token.

      Change refNum of treatyOrStatute validated mark to token.

      Change refNum of court validated mark to token.

   Version 00 to version 01

      Add missing email element to holderType.

      Change ruling from an attribute to an element.



   Version preview-01 to version 00

      signedMarkType now ref mark:abstractMark.

      Security section completed.



   Version preview-00 to preview-01

      Full example of an encodedSignedMark added.

      signedMark example now fully validates with XSD.

      Fixed labelType to allow two-character labels.

      Missing mark:protectionType added in the XSD.




Lozano                   Expires March 31, 2016                [Page 27]

Internet-Draft            Mark and Signed Mark            September 2015


      Issuer email is now required.



7.  IANA Considerations

   This document uses URNs to describe XML namespaces and XML schemas
   conforming to a registry mechanism described in [RFC3688].  Two URI
   assignments have been registered by the IANA.

   Registration request for the signed mark namespace:

      URI: urn:ietf:params:xml:ns:signedMark-1.0

      Registrant Contact: See the "Author's Address" section of this
      document.

      XML: None.  Namespace URIs do not represent an XML specification.

   Registration request for the signed mark schema:

      URI: urn:ietf:params:xml:schema:signedMark-1.0

      Registrant Contact: See the "Author's Address" section of this
      document.

      XML: See the "Formal Syntax" section of this document.

   Registration request for the mark namespace:

      URI: urn:ietf:params:xml:ns:mark-1.0

      Registrant Contact: See the "Author's Address" section of this
      document.

      XML: None.  Namespace URIs do not represent an XML specification.

   Registration request for the mark schema:

      URI: urn:ietf:params:xml:schema:mark-1.0

      Registrant Contact: See the "Author's Address" section of this
      document.

      XML: See the "Formal Syntax" section of this document.






Lozano                   Expires March 31, 2016                [Page 28]

Internet-Draft            Mark and Signed Mark            September 2015


8.  Security Considerations

   The security of a SMD file depends on the security of the underlying
   XML DSIG algorithms.  As such, all the security considerations from
   [XMLDSIG] apply here as well.  SMD files generated for the ICANN new
   gTLD program use the algorithms for digesting and signing recommended
   in this document.

   The SMD file is not encrypted.  If local policy dictates that the
   information contained within the SMD file should be confidential,
   then this has to be handled through a different mechanism.

   SMD files are used primarily for sunrise domain name registrations in
   gTLDs, but other third-parties might be using SMD files.  A party
   using a SMD file should verify that the SMD file is valid based on
   local policy.  In the case of gTLDs, the RPM Requirements
   [ICANN-TMCH] defines such policy.

9.  References

9.1.  Normative References

   [ICANN-TMCH]
              ICANN, "ICANN Trademark Clearinghouse, Rights Protection
              Mechanism Requirements", 2013,
              <http://newgtlds.icann.org/en/about/trademark-
              clearinghouse/rpm-requirements-30sep13-en.pdf>.

   [ISO3166-2]
              ISO, "International Standard for country codes and codes
              for their subdivisions", 2006,
              <http://www.iso.org/iso/home/standards/country_codes.htm>.

   [RFC2045]  Freed, N. and N. Borenstein, "Multipurpose Internet Mail
              Extensions (MIME) Part One: Format of Internet Message
              Bodies", RFC 2045, DOI 10.17487/RFC2045, November 1996,
              <http://www.rfc-editor.org/info/rfc2045>.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC3688]  Mealling, M., "The IETF XML Registry", BCP 81, RFC 3688,
              DOI 10.17487/RFC3688, January 2004,
              <http://www.rfc-editor.org/info/rfc3688>.





Lozano                   Expires March 31, 2016                [Page 29]

Internet-Draft            Mark and Signed Mark            September 2015


   [RFC5730]  Hollenbeck, S., "Extensible Provisioning Protocol (EPP)",
              STD 69, RFC 5730, DOI 10.17487/RFC5730, August 2009,
              <http://www.rfc-editor.org/info/rfc5730>.

   [RFC5890]  Klensin, J., "Internationalized Domain Names for
              Applications (IDNA): Definitions and Document Framework",
              RFC 5890, DOI 10.17487/RFC5890, August 2010,
              <http://www.rfc-editor.org/info/rfc5890>.

   [WIPO-NICE-CLASSES]
              WIPO, "WIPO Nice Classification", 2015,
              <http://www.wipo.int/classifications/nice/en>.

   [WIPO.ST3]
              WIPO, "Recommended standard on two-letter codes for the
              representation of states, other entities and
              intergovernmental organizations", March 2007,
              <http://www.wipo.int/standards/en/pdf/03-03-01.pdf>.

   [XMLC14N]  W3C Recommendation, "Exclusive XML Canonicalization
              Version 1.0", 2002,
              <http://www.w3.org/TR/2002/REC-xml-exc-c14n-20020718>.

   [XMLDSIG]  W3C Recommendation, "XML Signature Syntax and Processing
              (Second Edition)", 2008,
              <http://www.w3.org/TR/2008/REC-xmldsig-core-20080610>.

9.2.  Informative References

   [RFC6194]  Polk, T., Chen, L., Turner, S., and P. Hoffman, "Security
              Considerations for the SHA-0 and SHA-1 Message-Digest
              Algorithms", RFC 6194, DOI 10.17487/RFC6194, March 2011,
              <http://www.rfc-editor.org/info/rfc6194>.

   [RFC6982]  Sheffer, Y. and A. Farrel, "Improving Awareness of Running
              Code: The Implementation Status Section", RFC 6982,
              DOI 10.17487/RFC6982, July 2013,
              <http://www.rfc-editor.org/info/rfc6982>.

Author's Address











Lozano                   Expires March 31, 2016                [Page 30]

Internet-Draft            Mark and Signed Mark            September 2015


   Gustavo Lozano
   ICANN
   12025 Waterfront Drive, Suite 300
   Los Angeles  90292
   US

   Phone: +1.3103015800
   Email: gustavo.lozano@icann.org











































Lozano                   Expires March 31, 2016                [Page 31]
