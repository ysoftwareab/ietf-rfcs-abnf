



Network Working Group                        Lars-Erik Jonsson, Ericsson
INTERNET-DRAFT                              Ghyslain Pelletier, Ericsson
Expires: January 2002                                             Sweden
                                                           July 20, 2001







           A Link-Layer Assisted ROHC Profile for IP/UDP/RTP
                  <draft-jonsson-rohc-lla-rtp-01.txt>


Status of this memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet-Drafts as reference
   material or cite them other than as "work in progress".

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/lid-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html

   This document is an individual submission to the IETF. Comments
   should be directed to the authors.


Abstract

   This document defines a ROHC profile for compression of IP/UDP/RTP
   packets, utilizing functionality provided by the lower layers to
   increase compression efficiency by completely eliminating the header
   for most packets during normal operation. The profile is built as an
   extension to the  ROHC RTP profile [ROHC]. It defines additional
   mechanisms needed in ROHC, states requirements on the lower layer to
   guarantee transparency, and specifies general logic for compression
   and decompression making use of this header-free packet.





Jonsson, Pelletier                                              [Page 1]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


Table of contents

   1.  Introduction....................................................3

   2.  Terminology.....................................................5

   3.  Overview of the link-layer assisted profile.....................6
        3.1.  Providing packet type identification.....................6
        3.2.  Replacing the sequence number............................7
        3.3.  CRC replacement..........................................7
        3.4.  Applicability of this profile............................8

   4.  Additions and exceptions compared to ROHC RTP...................8
        4.1.  Additional packet types..................................8
               4.1.1.  A no-header packet (NHP)........................8
               4.1.2.  A context check packet (CCP)....................8
               4.1.3.  A context synchronization packet (CSP)..........9
        4.2.  Interfaces towards the assisting lower layers...........10
               4.2.1.  Interface between compressor and lower layer...11
               4.2.2.  Interface between lower layer and decompressor.12
        4.3.  Agreement on optimistic approach........................12
        4.4.  Feedback option RHP-REQUEST.............................13
        4.5.  Periodic context verification...........................13
        4.6.  Use of context identifiers..............................13

   5.  Implementation issues..........................................14
        5.1.  Implementation parameters and signals...................14
               5.1.1.  Implementation parameters at compressor........14
               5.1.2.  Implementation parameters at decompressor......15
        5.2.  Implementation structures...............................16
               5.2.1.  Compressor context.............................16
               5.2.2.  Decompressor context...........................16
        5.3.  Implementation over various link technologies...........16

   6.  IANA considerations............................................17

   7.  Security considerations........................................17

   8.  Acknowledgements...............................................17

   9.  References.....................................................17

   10. Authors addresses..............................................18












Jonsson, Pelletier                                              [Page 2]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


1.  Introduction

   Header compression is a technique used to compress and transparently
   decompress the header information of a packet on a per-hop basis,
   utilizing redundancy within individual packets and between
   consecutive packets within a packet stream. Over the years, several
   protocols [VJHC, IPHC] have been developed to compress the network
   and transport protocol headers [IP, IPv6, UDP, TCP] and these schemes
   have been successful at improving efficiency over many wired
   bottleneck links, such as modem connections over telephone networks.
   In addition to IP, UDP and TCP compression, an additional compression
   scheme called Compressed RTP [CRTP] has been developed to further
   improve compression efficiency for the case of real-time traffic
   using the Real-time Transport Protocol [RTP].

   The schemes mentioned above have all been designed taking into
   account normal assumptions about link characteristics, which
   traditionally have been based on wired links only. However, with an
   increasing number of wireless links in the Internet paths, these
   assumptions are not valid as general anymore. In wireless
   environments, especially wide coverage cellular environments, the
   error rates are relatively high to provide efficient usage of the
   radio resources. For real-time traffic, which is more sensitive to
   delays than to errors, this will be normal operating conditions over
   links such as the 3rd generation cellular links and header
   compression must therefore tolerate packet loss. However, with the
   previously mentioned schemes, especially for real-time traffic
   compressed by CRTP, high error rates have been shown to significantly
   reduce header compression performance [CRTPC]. This problem was the
   driving force for the creation of the RObust Header Compression
   (ROHC) WG in the IETF.

   The ROHC WG has developed a header compression framework on top of
   which various profiles can be defined for different protocol sets, or
   for different compression strategies. Due to the packet loss
   robustness problems of CRTP and the demands of the cellular industry
   for an efficient way of transporting voice over IP over wireless, the
   main focus of ROHC has so far been on compression of IP/UDP/RTP
   headers, which are generous in size, especially compared to the
   payloads often carried by the packets with these headers.

   ROHC RTP has become a very efficient, robust and capable compression
   scheme, able to compress the headers down to a total size of one
   octet only. Also, transparency is guaranteed to an extremely high
   extent even when residual bit errors are present in compressed
   headers delivered to the decompressor. The requirements for RTP
   compression [RTP-REQ], defined by the WG before and during the
   development process, has thus been fulfilled.

   As mentioned above, the 3rd generation cellular systems, where IP
   will be used end-to-end, has been one of the driving forces for ROHC




Jonsson, Pelletier                                              [Page 3]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


   RTP and the scheme has been designed to also suit new cellular air
   interfaces, such as WCDMA, making even speech services possible with
   an insignificantly lower spectrum efficiency than with existing one-
   service circuit switched solutions [VTC2000]. However, other existing
   air interfaces such as GSM and IS-95 will be used in all-IP networks,
   adding new implications to the header compression issue. These air
   interfaces are less flexible with radio bearers optimized for
   specific payload sizes. This means that not even a single octet of
   header can be added without using the next higher fixed packet size
   of the link and that is obviously very costly. For the already
   deployed speech vocoders, the spectrum efficiency over these links
   will thus be low compared to the existing circuit switched solutions.
   To achieve high spectrum efficiency overall with any application,
   more flexible air interfaces must be deployed and then the ROHC RTP
   scheme will be excellent, as shown for WCDMA [MOMUC01]. For
   deployment reasons, it is however important to also achieve
   efficiency with already existing vocoders and air interfaces, such as
   GSM and IS-95, with minimal effects on spectral efficiency.

   This document defines a new link-layer assisted ROHC RTP profile
   extending the ROHC RTP profile in [ROHC] (profile number 1). The
   purpose of this new profile is to provide a header free packet format
   that, for a certain application behavior, can replace a majority of
   the regular 1-octet header ROHC RTP packets during normal operation,
   while still being fully transparent and comply with all the
   requirements of ROHC RTP [RTP-REQ]. For other applications,
   compression will be carried out as with normal ROHC RTP. To
   completely eliminate the header, all functionality normally provided
   by the 1-octet header has to be provided by other means, typically by
   utilizing functionality provided by the lower layer and sacrificing
   efficiency for less frequently occurring larger header packets. The
   latter is not a contradiction since the argument for eliminating the
   last octet for most packets is not overall efficiency in general. It
   is important to remember that the purpose of this profile is to
   provide efficient matching of existing applications to existing link
   technologies, not efficiency in general. The additional complexity
   introduced by this profile, although minimized by a tight integration
   with already existing ROHC functionality, implies that it should
   therefore only be used to optimize performance of specific
   applications over specific links.

   When implementing this profile over various link technologies, care
   must be taken to guarantee that all the functionality needed is
   provided by ROHC and the lower layer together. Therefore, additional
   standards-track documents should specify how to incorporate this
   profile on top of various link technologies.









Jonsson, Pelletier                                              [Page 4]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


2.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119.

   CCP    Context Check Packet
   CRC    Cyclic Redundancy Check
   CSP    Context Synchronization Packet
   LL     Link Layer
   LLA    Link Layer Assisted ROHC RTP Profile
   MSB    Most Significant Bit
   NHP    No Header Packet
   ROHC   Robust Header Compression
   RHP    ROHC Header Packet (a non-NHP packet, i.e. RRP, CSP or CCP)
   RRP    ROHC RTP Packet as defined in [ROHC, profile 1]

   Link layer

     Link layer in this document refers to the physical link layer.

   Lower layer

     Lower layer in this document refers to any entity implementing the
     interface to ROHC as defined in section 4.2. It may, as an
     example, refer to a sub-layer between the ROHC implementation and
     the physical link layer used to adapt both implementations.

   ROHC RTP

     ROHC RTP in this document refers to the IP/UDP/RTP profile as
     defined in [ROHC].























Jonsson, Pelletier                                              [Page 5]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


3.  Overview of the link-layer assisted profile

   This ROHC IP/UDP/RTP profile is designed to be used over channels
   that have been optimized for specific payload sizes and therefore
   cannot efficiently accommodate header information to be transmitted
   together with payloads corresponding to these optimal sizes.

   The LLA profile extends, thus also inherits all functionality from,
   the ROCH RTP profile by defining some additional functionality and an
   interface between the ROHC component towards the lower layer.

                       +---------------------------------------+
                       |                                       |
                       |                                       |
        The LLA ROHC   |    ROHC RTP,        +-----------------+
          profile      |    Profile #1       |                 |
                       |                     |  LLA Additions  |
                       |                     |                 |
                       +---------------------+-----------------+

   By putting additional requirements on the lower layer compared to
   [RTP-LLG], it is possible for ROHC to infer the information needed to
   maintain robust and transparent header compression even though the
   headers are completely eliminated during most of the operation time.

   Basically, what this profile does is to replace the smallest ROHC
   header of one octet with a no-header format by providing the header
   functionality by other means.

        Smallest header in                 Smallest header in
        ROHC RTP (profile #1)              LLA ROHC RTP profile
      +--+--+--+--+--+--+--+--+              ++
      |        1 octet        |  ----->      ||  No Header
      +--+--+--+--+--+--+--+--+              ++
                  |
                  |                        Header field functionality
                  +------------------->    provided by other means

   The fields present in the one octet ROHC RTP header for PT0 are the
   packet type identifier, the sequence number and the CRC (optional in
   PT0 for Reliable mode). The subsequent sections elaborate more on the
   replacement of the functionality of these fields.


3.1.  Providing packet type identification

   All ROHC headers carry a packet type identifier, indicating to the
   decompressor which context the compressed packet belongs to and how
   it should be interpreted. This is a functionality that must be
   provided by some means. ROHC RTP packets with header will still be
   possible to distinguish between since they have this identifier, but




Jonsson, Pelletier                                              [Page 6]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


   what must be provided is a mechanism to separate those packets with
   header from the packets without header. This functionality MUST
   therefore be provided by the lower layer in one way or another.


3.2.  Replacing the sequence number

   From the sending application, the RTP sequence number is increased by
   one for each packet sent. The purpose of the sequence number is thus
   to cope with packet reordering and packet loss. If reordering or loss
   has occurred before the compression point, the compressor can easily
   avoid problems by not allowing usage of a header-free packet.
   However, the compressor can not in beforehand anticipate loss or
   reordering that may occur between compressor and decompressor.
   Therefore, the lower layer MUST guarantee in-order delivery and
   provide an indication of packet loss over the link. This is basically
   the same principle as VJ header compression [VJHC] relies on.

   Note that guarantees for in-order delivery and packet loss indication
   not only makes it possible to infer the sequence number information,
   it also supersedes the main functionality of the CRC, which normally
   takes care of errors due to long losses and bit errors in the
   compressed sequence number.


3.3.  CRC replacement

   All RRP packets carry a CRC calculated over the uncompressed header
   (optional in PT0 for Reliable mode). This CRC is used by the
   decompressor to verify that the decompressed header is correct. This
   verification serves three purposes:
    - Detection of longer losses than can be covered by the sequence
      number LSBs (this applies to Unidirectional and Optimistic mode)
    - Protection against failures caused by residual bit errors in the
      compressed header
    - Protection against faulty implementations or other causes of error

   Since this profile defines a NHP packet without this CRC, care must
   be taken to fulfill these purposes by other means. Detection of long
   losses is already covered since the lower layer MUST provide
   indication of all packet losses. Furthermore, the NHP packet has one
   important advantage compared to RHP packets because residual bit
   errors can not damage a header that is not even sent. It is thus
   reasonable to assume that compression and decompression transparency
   can be guaranteed even without a CRC in header-free packets. However,
   to detect also unexpected errors and thereby provide transparency in
   the ROHC class, periodical context checks SHOULD be performed.








Jonsson, Pelletier                                              [Page 7]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


3.4.  Applicability of this profile

   The LLA profile can be used on any link technology capable of
   providing the necessary required functionality described in previous
   sections. Whether LLA ROHC RTP or ROHC RTP profile #1 should be
   implemented thus depends on the characteristics of the link itself.
   For most RTP packet streams, LLA will work exactly as profile #1,
   while it will be more efficient for packet streams with certain
   characteristics. LLA will never be less efficient than ROHC RTP
   profile #1.

   Note as well that LLA, like all other ROHC profiles, is fully
   transparent to ANY packet stream reaching the compressor. LLA does
   not make any assumptions about the packet stream but will produce
   optimal performance for packet streams with certain characteristics,
   e.g. synchronized streams exactly matching the timing of the
   assisting link over which the LLA profile is implemented.


4.  Additions and exceptions compared to ROHC RTP


4.1.  Additional packet types

   The LLA profile defines three new packet types to be used in addition
   to the RRP packet types defined by [ROHC]. The following sections
   describe these packet types and their purpose in detail.


4.1.1.  A no-header packet (NHP)

   A no-header packet (NHP), thus a packet consisting only of a payload,
   is defined and MAY be used instead of ROHC RTP packet type 0 (PT0)
   when the sequence number has incremented with one from the previous
   packet. Note that the requirement for using PT0 in the first place is
   basically that all header fields must be unchanged or follow the
   currently established change pattern. In addition, there are some
   restrictions on when NHP should be used (see section 4.4 and 4.5).

   Note that since the lower layer is responsible of separating NHP
   packets from RHP packets, an indication from the compressor to the
   lower layer MUST be provided upon delivery of an NHP packet.


4.1.2.  A context check packet (CCP)

   A Context Check Packet (CCP), which does not carry any payload but
   only a CRC value in addition to the packet type identifier, is
   defined. The CCP packet MAY be created by the compressor in addition
   to the compressed packet and provided to the lower layer. Whether the





Jonsson, Pelletier                                              [Page 8]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


   packet is sent over the link and delivered to the decompressor is not
   decided by the compressor, but by the lower layer.

   The purpose of the CCP is to provide a useful packet that MAY be sent
   by a synchronized physical link layer in the case where data must be
   sent at fixed intervals, even if no compressed packet is available.
   The CCP has the following format:

     0   1   2   3   4   5   6   7
   +---+---+---+---+---+---+---+---+
   | 1   1   1   1   1   0   0   1 | Packet type identifier
   +---+---+---+---+---+---+---+---+
   | 0 |          CRC              |
   +---+---+---+---+---+---+---+---+


   This packet is defined by one of the unused packet type identifiers
   from ROHC RTP, carried in the first octet of the packet, and the
   first bit of the following octet being set to 0. As for any  ROHC
   packet, except NHP, the packet MAY begin with ROHC padding and/or
   carry context identification. The CRC is the 7-bits CRC over the
   original uncompressed header as described in [ROHC section 5.9.2].

   If the lower layer implementation makes use of the CCP feature, the
   last CCP packet received from the compressor MUST always be used,
   i.e. the CCP corresponding to the last data packet sent (NHP or RRP).
   Accordingly, if a CCP packet is received by the decompressor, it MUST
   be used as a context verification for the last packet decompressed
   unless a packet loss indication was previously received. The 7-bit
   CRC MUST always be calculated for all decompressed packets and saved
   in the decompressor context in order to use the CCP. Upon CRC
   failure, actions MUST be taken as specified in [ROHC, section
   5.3.2.2.3].

   Note that the usage of CCP is optional and depends on the
   characteristics of the actual link. Whether it is used or not MUST
   therefore be specified in the link layer implementation
   specifications for this profile.


4.1.3.  A context synchronization packet (CSP)

   The CCP packet can be used to ensure correctness of the decompressor
   context, but when this verification fails a request must be sent to
   get an update. All packets must then be discarded until the proper
   context is re-established.

   However, it would in many cases be beneficial to send not only the
   header verifying CRC of the previous packet but also the header
   itself without its associated payload. This would allow not only to





Jonsson, Pelletier                                              [Page 9]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


   perform a context verification but also to provide a context repair
   mechanism.

   Another situation when it could be useful to send a packet with only
   the header information is when the packet stream overruns the channel
   bandwidth and data must be discarded. Instead of discarding the whole
   packet at the compressor side, which would mean that the decompressor
   context might be invalidated, only the payload could be discarded and
   the header sent to keep the decompressor context synchronized while
   still saving bandwidth.

   Both cases above can be handled with the Context Synchronization
   Packet (CSP), which has the following format:

     0   1   2   3   4   5   6   7
   +---+---+---+---+---+---+---+---+
   | 1   1   1   1   1   0   0   1 | Packet type identifier
   +---+---+---+---+---+---+---+---+
   | 1 |          CRC              |
   +---+---+---+---+---+---+---+---+
   :  ROHC header without padding  :
   :   or context identification   :
   +---+---+---+---+---+---+---+---+


   The CSP packet is identified using the same packet type identifier as
   the CCP packet with the first bit of the second octet being set to 1,
   and it uses the same CRC. The first two octets of the CSP packet are
   thus identical to the CCP packet, except for the first bit of the
   second octet being set to 1 instead of 0. As for any  ROHC packet,
   except NHP, the packet MAY begin with ROHC padding and/or carry
   context identification.

   The difference of the CSP from the CCP packet is the presence of a
   compressed ROHC header that can be used to synchronize the
   decompressor context. Note that when the decompressor has received a
   CSP packet and updated the context accordingly, the packet including
   any possible data following the CSP encapsulated compressed header
   MUST be discarded.


4.2.  Interfaces towards the assisting lower layers

  This profile relies on the lower layers to provide the necessary
  functionality to allow NHP packets to be sent. This interaction
  between LLA and the lower layers is defined as interfaces between the
  ROHC LLA compressor/decompressor elements and the LLA applicable link
  technology. The figure below shows the various levels, as defined in
  [ROHC] and this document, making up for a complete implementation of
  the LLA profile.





Jonsson, Pelletier                                             [Page 10]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


                       |                              |
                       +                              +
            +---------------------+        +---------------------+
            |     ROHC RTP HC     |        |     ROHC RTP HD     |
            +---------------------+        +---------------------+
            |     LLA profile     |        |     LLA profile     |
            +=====================+        +=====================+
            | ROHC to lower layer |        | Lower layer to ROHC |
            |     interface       |        |      interface      |
            +=====================+        +=====================+
            |     Applicable      |        |     Applicable      |
            |   link technology   |        |   link technology   |
            +=====================+        +=====================+
                       |                              |
                       +------>---- CHANNEL ---->-----+

   The figure also underline the need for additional standards-track
   documents to specify how to fulfill these interfaces for a link
   technology for which this profile is relevant.


4.2.1.  Interface between compressor and lower layer

   This section defines the interface semantics between the compressor
   and the lower layer, providing rules for packet delivery from the
   compressor.

      +------------------+-----+-----+-----+-----+-----+-----+-----+
      |     \  Interface | RRP | Seg | NHP | CCP | Seq | Seg | NHP |
      | Case \ Parameter |     | RRP |     |     | Num | Flg | Flg |
      +------------------+-----+-----+-----+-----+-----+-----+-----+
      | 1 - NHP, No Seg. |  x  |     |  x  |  x  |  x  |     |  x  |
      +------------------+-----+-----+-----+-----+-----+-----+-----+
      | 2 - NHP, Seg.    |     |  x  |  x  |  x  |  x  |  x  |  x  |
      +------------------+-----+-----+-----+-----+-----+-----+-----+
      | 3 - No Seg.      |  x  |     |     |  x  |  x  |     |     |
      +------------------+-----+-----+-----+-----+-----+-----+-----+
      | 4 - Seg.         |     |  x  |     |  x  |  x  |  x  |     |
      +------------------+-----+-----+-----+-----+-----+-----+-----+
                Table 1: Data delivery from the compressor

   As seen in table 1, four different delivery scenarios are possible.
   Case 1 represent what needs to be delivered from compressor to lower
   layers when the compressor allows sending of an NHP packet, without
   any segmentation applied to the corresponding RRP packet. Case 2
   differs from case 1 in that a segmented RRP is being delivered. Case
   3 and case 4 are the cases where a packet without header cannot be
   delivered.

   If the compressor delivers a NHP packet to the lower layer, it MUST
   also provide the RRP packet, a CCP packet, the Sequence Number and




Jonsson, Pelletier                                             [Page 11]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


   the indication that a NHP packet MAY be used. Otherwise the RRP
   packet MUST be delivered together with a CCP packet.

   Furthermore, for the case where the RRP packet is delivered to the
   lower layer as a segmented ROHC packet according to the rules in
   chapter 5.5.1, an indication MUST be provided by the compressor.


4.2.2.  Interface between lower layer and decompressor

   The interface semantics between the lower layer and the decompressor
   are defined here, and provide simple rules for the delivery of
   received packets to the decompressor. The decompressor needs a way to
   identify NHP packets from RHP packets. Also, when receiving packets
   without headers, the decompressor needs a way to infer the sequencing
   information to keep synchronization between received payload and the
   sequence information of the decompressed headers. To achieve this,
   the lower layer MUST provide the following to the decompressor:

   - an indication of packet loss
   - the received packets together with a indication whether the packet
     received is an NHP or not


4.3.  Agreement on optimistic approach

   ROHC defines an optimistic approach for updates to reduce the header
   overhead. This approach is fully exploited in the Optimistic and
   Unidirectional modes of operation, but it may also be partially used
   in the Reliable mode. Due to the presence of a CRC in all compressed
   headers, the optimistic approach is defined as a compressor issue
   only because the decompressor will always be able to detect an
   invalid context through the CRC check.

   However, with the LLA profile the CRC is not present in the NHP
   packet and therefore the loss of an RHP packet updating the context
   may not always be detected. To avoid this problem, the compressor and
   decompressor must agree on the principles for the optimistic
   approach. If, for example, the compressor sends three consecutive
   updates to convey a header field change, the decompressor must know
   this and invalidate the context in case of three or more consecutive
   packet losses.

   It is REQUIRED that all documents describing how the LLA profile is
   implemented over a certain link technology MUST define how the
   optimistic approach is agreed between compressor and decompressor. It
   could be with a fixed principle, negotiation at startup or by other
   means but it must be unambiguously defined.

   An LLA decompressor MUST use the optimistic approach knowledge to
   detect possible context loss events. If context loss is suspected it




Jonsson, Pelletier                                             [Page 12]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


   MUST invalidate the context and not forward any packets before a
   context synchronization event has happened.

4.4.  Feedback option, RHP-REQUEST

   The RHP-REQUEST option could be used by the decompressor to request
   an RHP for context verification. This option should be used if only
   NHP have been received for a long time and the context therefore has
   not been verified recently. If the compressor receives a feedback
   packet with this option, at least one RRP with CRC SHOULD be sent
   immediately.

   +---+---+---+---+---+---+---+---+
   |  Opt Type = 8 |  Opt Len = 0  |
   +---+---+---+---+---+---+---+---+


4.5.  Periodic context verification

   As described in chapter 3.3, transparency is expected to be
   guaranteed by the functionality provided by the lower layer. This
   ROHC profile would therefore be at least as reliable as the older
   header compression schemes [VJHC, IPHC, CRTP], which do not make use
   of a header compression CRC. However, since ROHC RTP normally is
   extremely safe to use from a transparency point of view, it would be
   desirable if that also could be achieved with this profile. To
   provide an additional guarantee for transparency and also catch non
   expected errors, such as errors due to faulty implementations, it is
   RECOMMENDED that RRP packets (with the CRC present also for Reliable
   mode PT0 packets) be sent periodically (possibly with an increasing
   period), even when the normal logic allows for NHP packets to be
   used.

   Since a CCP packet serves the same purpose as a regular periodic
   verification with RRP, indication of CCP transmission is beneficial
   to the compressor, which can ignore some periodic RRP verifications.


4.6.  Use of context identifier

   Since a NHP can not carry a context identifier (CID), there is a
   restriction on how this profile may be used, related to context
   identification. Independent of which CID size has been negotiated,
   NHP packets can only be used for CID=0. If the decompressor receives
   a NHP packet, it can only belong to CID=0. Note that if multiple
   packet streams are handled by a compressor running LLA, the lower
   layers MUST in case of packet loss be able to tell for which CID the
   loss occurred, at least it must be able to tell if packets with CID 0
   (NHP packet stream) have been lost.






Jonsson, Pelletier                                             [Page 13]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


5.  Implementation issues

   This document specifies mechanisms for the protocol and leaves
   details on the use of these mechanisms to the implementers. This
   chapter aims to provide guidelines, ideas and suggestions for
   implementation of this profile.


5.1.  Implementation parameters and signals

   As described in [ROHC, section 6.3], implementations uses parameters
   to set up configuration information and to stipulate how a ROHC
   implementation is to operate. The following are additions to the ones
   used by ROHC RTP implementations, needed by this profile. Note that
   if the PREFERRED_PACKET_SIZES parameters defined here are used, they
   obsolete all PACKET_SIZE and PAYLOAD_SIZE parameters of ROHC RTP.


5.1.1.  Implementation parameters at compressor

   ALWAYS_PAD -- value: boolean

      This parameter may be set by an external entity to specify to the
      compressor that every RHP packet MUST be padded using the ROHC
      padding.

      The lower layer MUST provide a packet type identification. If no
      field is available for this purpose from the protocol at the link
      layer, then it is suggested to use a leading sequence to identify
      RHP packets from NHP packets. Although the use of a leading
      sequence is obviously not efficient since it sacrifices
      efficiency for RHP packets, this leading sequence applies only to
      packets with headers in order to favor the use of packets without
      headers. If a leading sequence is desired for RHP identification,
      the lower layer MAY use ROHC padding for this by setting the
      ALWAYS_PAD parameter.

      By default, this parameter is set to FALSE.

   PREFERRED PACKET SIZES -- list of: SIZE -- value: integer (octets)
                                      ONLY_NHP -- value: boolean

      This parameter set governs which packet sizes that are preferred
      by the lower layer. If this parameter set is used, all RHP
      packets MUST be padded to fit the smallest possible of the
      preferred sizes. If the unpadded packet size, or in the case of
      ALWAYS_PAD being set the packet with minimal one octet padding,
      is larger than the maximal preferred packet size, the compressor
      has two options. It may either deliver this larger packet with an
      arbitrary size or it may split the packet into several segments
      using ROHC segmentation and pad each segment to one of the




Jonsson, Pelletier                                             [Page 14]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


      preferred sizes. Which method to use depends on the value of the
      LARGE_PACKETS_ALLOWED parameter below. NHP packets can only be
      delivered to the lower layer if the payload size is part of the
      preferred packet size set. Furthermore, if ONLY_NHP is set to
      TRUE for any of the preferred packet sizes, that packet size is
      only allowed to be used for NHP packets.

      By default, no preferred packet sizes are specified and when used
      the default value of ONLY_NHP is FALSE for the specified sizes.

   LARGE_PACKETS_ALLOWED -- value: boolean

      This parameter may be set by an external entity to specify how to
      handle packets that can not fit in any of the preferred packet
      sizes specified. If set to TRUE, the compressor MUST deliver the
      larger packet as it is and not use segmentation. If set to FALSE,
      the ROHC segmentation scheme MUST be used to split the packet
      into two or more segments and each segment MUST further be padded
      to fit into any of the preferred packet sizes.

      By default, this parameter is set to TRUE, which means that
      segmentation is disabled.

   VERIFICATION_PERIOD -- value: integer (octets)

      This parameter may be set by an external entity to specify to the
      compressor the minimum frequency for which a packet that
      validates the context must be sent. This tells the compressor
      that a packet containing a CRC field MUST be sent at least every
      number of packets equals to this value. A value of 0 indicates
      that no periodical verification are needed.

      By default, this parameter is set to the value 1, which indicates
      that packets with the CRC field MUST always be sent.



5.1.2.  Implementation parameters at decompressor

   NHP_PACKET -- value: boolean

      This parameter informs the decompressor that the packet being
      delivered is a NHP packet. The decompressor MUST accept this
      packet type indicator from the lower layer. A lower layer MUST
      set this indicator for every NHP packet delivered to true, and to
      false for any other packet.









Jonsson, Pelletier                                             [Page 15]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


   PACKET_LOST -- signal

      This parameter indicates to the decompressor that a packet has
      been lost on the link between the compressor and the
      decompressor.


5.2.  Implementation structures

   This section provides some explanatory material on data structures
   specific to this profile that a ROHC implementation will have to
   maintain in one form or another. What is listed here are additions
   compared to ROHC RTP [ROHC section 6.5], imposed by this profile.


5.2.1.  Compressor context

   For the compressor context, this profile does not require any
   additions to the data structures needed for ROHC RTP.


5.2.2.  Decompressor context

   An additional field MUST for all modes be kept in memory to store a
   CRC value. The decompressor MUST calculate the CRC for every packet
   header decompressed and always keep in one form or another the value
   calculated for the last packet received.

   CRC_PREVIOUS: CRC calculated from the decompressed header of the last
   packet received


5.3.  Implementation over various link technologies

   This document provides the interface semantics and requirements
   needed from the ROHC compressor and decompressor towards the link
   layer to perform link-layer assisted header compression.

   However, the document does not provide any link layer specific
   operational information, except for some implementation suggestions.
   Further details about how this profile should be implemented over
   various link technologies must be described in additional standards
   track documents, where specific characteristics of each link layer
   can be taken into account to provide optimal usage of this profile.

   These specifications MAY use a packet type bit pattern unused by this
   profile to implement signaling on the lower layer. The pattern
   available to a lower layer implementations is [1111101].







Jonsson, Pelletier                                             [Page 16]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


6.  IANA considerations

   A ROHC profile identifier must be reserved by the IANA for the
   IP/UDP/RTP profile defined in this document. Since this additional
   profile will be used concurrent to the ROHC IP/UDP/RTP profile in
   [ROHC] and is part of the IETF standards track, an ordinary
   identifier in the range from 4 to 127 should be reserved.


7.  Security considerations

   The security considerations of ROHC RTP [ROHC section 7] apply also
   to this document with one addition: in the case of a denial-of-
   service attack scenario where an intruder inject bogus CCP packets
   onto the link using random CRC values, the CRC check will fail for
   incorrect reasons at the decompressor side. This would obviously
   greatly reduce the advantages of ROHC and any extra efficiency
   provided by this profile due to unnecessary context invalidation,
   feedback messages and refresh packets. However, the same remarks
   related to the presence of such an intruder applies.


8.  Acknowledgements

   The authors would like to thank Ulises Olvera-Hernandez and Francis
   Lupien for valuable inputs about the typical links that LLA can be
   applied to. Thanks also to Mikael Degermark and Zhigang Liu for
   fruitful discussions that led to improvements of this profile.


9.  References

   [ROHC]      C. Bormann, "Robust Header Compression (ROHC)",
               RFC 3095, July 2001.

   [VJHC]      V. Jacobson, "Compressing TCP/IP Headers for Low-Speed
               Serial Links", RFC 1144, February 1990.

   [IPHC]      M. Degermark, B. Nordgren, S. Pink, "IP Header
               Compression", RFC 2507, February 1999.

   [CRTP]      S. Casner, V. Jacobson, "Compressing IP/UDP/RTP Headers
               for Low-Speed Serial Links", RFC 2508, February 1999.


   [CRTPC]     M. Degermark, H. Hannu, L.-E. Jonsson, K. Svanbro,
               "Evaluation of CRTP Performance over Cellular Radio
               Networks", IEEE Personal Communications Magazine, Volume
               7, number 4, pp. 20-25, August 2000.






Jonsson, Pelletier                                             [Page 17]

INTERNET-DRAFT       A Link-Layer Assisted ROHC RTP        July 20, 2001


   [RTP-REQ]   M. Degermark, "Requirements for IP/UDP/RTP Header
               Compression", RFC 3096, July 2001.

   [RTP-LLG]   K. Svanbro, "Lower Layer Guidelines for Robust
               RTP/UDP/IP Header Compression", Internet draft (work in
               progress), February 2001.
               <draft-ietf-rohc-rtp-lower-layer-guidelines-01.txt>

   [IP]        J. Postel, "Internet Protocol", RFC 791, September 1981.

   [IPv6]      S. Deering, R. Hinden, "Internet Protocol, Version 6
               (IPv6) Specification", RFC 2460, December 1998.

   [UDP]       J. Postel, "User Datagram Protocol", RFC 768, August
               1980.

   [TCP]       J. Postel, "Transmission Control Protocol", RFC 793,
               September 1981.

   [RTP]       H. Schulzrinne, S. Casner, R. Frederick, V. Jacobson,
               "RTP: A Transport Protocol for Real-Time Applications",
               RFC 1889, January 1996.

   [VTC2000]   K. Svanbro, H. Hannu, L.-E. Jonsson, M. Degermark,
               "Wireless real time IP-services enabled by header
               compression", proceedings of IEEE VTC2000, May 2000.

   [MOMUC01]   G. Liu, et al., "Experimental field trials results of
               Voice-over IP over WCDMA links", MoMuC'01 - The
               International Workshop on Mobile Multimedia
               Communications, Conference proceedings, February 2001.


10.  Authors addresses

   Lars-Erik Jonsson           Tel: +46 920 20 21 07
   Ericsson Erisoft AB         Fax: +46 920 20 20 99
   Box 920
   SE-971 28 Lulea
   Sweden                      EMail: lars-erik.jonsson@ericsson.com

   Ghyslain Pelletier          Tel: +46 920 20 24 32
   Ericsson Erisoft AB         Fax: +46 920 20 20 99
   Box 920
   SE-971 28 Lulea
   Sweden                      EMail: ghyslain.pelletier@epl.ericsson.se



This Internet-Draft expires January 20, 2002.





Jonsson, Pelletier                                             [Page 18]
