  Network Working Group                                     T. Sanda 
  Internet Draft                                               T. Ue 
  Expires: August 2004                                     Panasonic 
                                                       February 2004 
      
      
            Pre CRN discovery from proxy on candidate new path 
                draft-sanda-nsis-mobility-qos-proxy-01.txt  
      
      
  Status of this Memo 
      
     This document is an Internet-Draft and is in full conformance 
     with all provisions of Section 10 of RFC2026 [1].  
      
     Internet-Drafts are working documents of the Internet 
     Engineering Task Force (IETF), its areas, and its working groups.  
     Note that other groups may also distribute working documents as 
     Internet-Drafts. 
      
     Internet-Drafts are draft documents valid for a maximum of six 
     months and may be updated, replaced, or obsoleted by other 
     documents at any time. It is inappropriate to use Internet-
     Drafts as reference material or to cite them other than as "work 
     in progress." 
      
     The list of current Internet-Drafts can be accessed at 
          http://www.ietf.org/ietf/1id-abstracts.txt 
     The list of Internet-Draft Shadow Directories can be accessed at 
          http://www.ietf.org/shadow.html. 
      
      
  Abstract 
      
     NSIS WG has been discussing the ways to minimize/avoid QoS 
     interruption during handover. One solution is to install new 
     path before MN's move (fast state installation).  
     This document proposes a procedure of pre CRN discovery for fast 
     state installation by using proxies on candidate new paths. An 
     example of fast state installation is shown. 
      
      
  Conventions used in this document 
      
     The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL 
     NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and 
     "OPTIONAL" in this document are to be interpreted as described 
     in RFC-2119 [2]. 
      
      
      
      


  Sanda et al.            Expires - August 2004              [Page 1] 
  Internet-Draft                                        February 2004 
   
  Table of Contents 
      
     1. Introduction................................................2 
        1.1 Terminology.............................................2 
        1.2 Assumption..............................................3 
     2. Proxy for Fast State Installation...........................3 
     3. Proxy discovery.............................................3 
     4. Pre CRN Discovery...........................................4 
     5. New path installation.......................................7 
        5.1 Fast state installation for downlink data flow..........7 
        5.2 Fast state installation for uplink data flow............8 
     6. Signaling messages for fast CRN discovery...................9 
     7. Security Considerations....................................10 
     References....................................................10 
     Author's Addresses............................................11 
      
      
  1. Introduction 
      
     When a MN performs L3 level handover with a QoS state, it is 
     required to establish new QoS paths before handover to 
     avoid/minimize QoS interruption in new subnetwork. Discussions 
     on this topic are taking place  in the NSIS WG and some drafts 
     are proposing "Fast State Installation", by which new QoS paths 
     are established in advance [3][5][6][8]. 
      
     The goal of this draft is to initiate discussion on concrete 
     solutions for Fast State Installation. An example is provided of 
     a procedure that includes crossover node (CRN) discovery. This 
     procedure utilizes a proxy entity on the candidate new path, to 
     perform CRN discovery and QoS state installation along the new 
     path prior to the MN's move to the new subnetwork. 
      
     Terminology definitions and assumptions in this document are 
     described in the following section. 
      
      
  1.1 Terminology 
      
     Uplink data flow: 
        data flow from MN to CN 
      
     Downlink data flow:   
        data flow from CN to MN 
      
     UCRN and DCRN: 
        The same as defined in [6] 
      
     mQNE: 
        The NSIS aware node supporting QoS and mobility 
     functionalities 
      


  Sanda et al.            Expires - August 2004              [Page 2] 
  Internet-Draft                                        February 2004 
   
      
  1.2 Assumption 
      
     o Signaling messages are path-coupled [8]. Signaling messages 
     from MN to CN are routed only through NEs that are in the Uplink 
     data path, and signaling messages from CN to MN are routed only 
     through NEs that are in the Downlink data path 
      
     o Network supports Mobile IPv6 [13] 
      
     o Only optimized route case is discussed in this document 
     although several routes are possible such as triangle route, 
     tunnel between OAR and NAR established by FMIP, and so on. 
      
     o MN and CN are mQNE 
      
  2. Proxy for Fast State Installation 
      
     MN cannot directly initiate resource reservation signaling on 
     candidate new paths before it actually moves. Therefore NSIS 
     proxy utilization will be necessary for fast state installation, 
     as described in [3]. 
      
     The proxy can be used for preparing new path installation, e.g. 
     discovering CRN in advance of the MN's move(pre CRN discovery). 
     Additionally the proxy may install the new path on behalf of the 
     MN. 
      
     The following section describes a procedure for pre CRN 
     discovery followed by fast state installation. 
      
      
  3. Proxy discovery 
      
     Either old (current) or candidate new adjacent mQNEs of MN (see 
     Figure1) can act as a proxy. 
     An example of the former case is described in an appendix of [5]. 
     Here we aim to consider the latter case, i.e. new adjacent mQNE 
     acts as a proxy and prepares new path creation. 
      
     If candidate NAR(s) has mQNE functionalities, the NAR(s) acts as 
     a proxy. 
      
      
      
      
      
      
      
      
      
      


  Sanda et al.            Expires - August 2004              [Page 3] 
  Internet-Draft                                        February 2004 
   
                               new 
                             adjacent 
                               mQNE   
               +..+   +---+   +----+                              
               .MN.---|NAR|---|mQNE|---...--------                
               +..+   +---+   +----+             |                
                ^                                |                
                |                                |                
               +--+   +---+  +-+  +----+       +----+       +--+  
               |MN|===|OAR|==|R|==|mQNE|==...==|mQNE|==...==|CN|  
               +--+   +---+  +-+  +----+       +----+       +--+  
                               old (current) 
                                 adjacent   
                                   mQNE   
                                                                  
                                           === current path 
                                           --- expected new path 
                                           R: Router or NE (not QNE) 
      
                    Figure1: New and old adjacent mQNE 
      
      
     If MN and network support suitable mobility protocol, such as 
     CARD [12], MN can obtain proxies information through the CARD 
     server. 
      
     When the network does not support CARD, the MN may have to rely 
     on pre-stored information. This information could be in the form 
     of tables contains mapping information between APs and their 
     connecting ARs, and neighboring mQNEs (proxies) of the ARs. The 
     MN would then be able to associate the information on candidate 
     APs to mQNEs that will likely be on the new path and would be 
     able to act as proxies. Given though that determining whether an 
     mQNE router will be on a data path to an arbitrary CN is 
     difficult, it is proposed that only access routers with mQNE 
     capabilities are used as proxies as described in [6]. This has 
     the added advantage that these routers will be able to perform 
     DAD on prospective new CoAs which would enable them to also 
     perform the state installation on behalf of the MN.  
      
      
  4. Pre CRN Discovery 
      
     The idea of pre CRN (both UCRN and DCRN) discovery is as follows. 
      
      a. After determining proxies, MN sends PROXY_INIT message to 
       the proxies. The PROXY_INIT message is a NSLP signaling 
       message and contains current flow identifier and session 
       identifier (for both uplink and downlink, or either) 
       information.  
       



  Sanda et al.            Expires - August 2004              [Page 4] 
  Internet-Draft                                        February 2004 
   
      b. On receipt of PROXY_INIT message, each proxy sends a 
      DCRN_DISCOVERY message to CN. A DCRN_DISCOVERY is NSLP 
      signaling message and containing the flow identifier and 
      session identifier received from the MN. An IP address of CN is 
      contained in flow identifier. 
       
      c. Each QNE belonging to the signaling path from proxy to CN 
      intercepts DCRN_DISCOVERY, and checks if any interface has 
      resource reservation for the pair of flow identifier and 
      session identifier for uplink. If one of interface has the 
      reservation, the QNE appends IP address of the interface to 
      DCRN_DISCOVERY. 
      When DCRN_DISCOVERY message arrives to CN, DCRN_DISCOVERY 
      message contains the information of all overlapping interfaces 
      belonging to current uplink QoS path (from MN to CN) and 
      expected new uplink path (from proxy to CN) in order. 
                          
                          
                              current path                           
                        =======================>                     
                                             IF1       IF2           
               +--+    +----+   +----+   +----+   +----+    +--+     
               |MN|>>>>|mQNE|>>>|mQNE|>>>|mQNE|>>>|mQNE|>>>>|CN|     
               +--+    +----+   +----+  >+----+>>>+----+>>>>+--+     
                                        ^                            
                                        ^ ----->                     
                                        ^ |                          
                   +-----+     +----+   ^ |                          
                   |Proxy|>>>>>|mQNE|>>>> |                          
                   +-----+     +----+     |                          
                                          |                          
                        -------------------                          
                        DCRN_DISCOVERY                               
                                          IF=Interface to be appended 
                                             to the message          
                          
       Figure2: Interfaces' information collected by DCRN_DISCOVERY 
      
      
      d. On receipt of DCRN_DISCOVERY message, CN sends a 
      UCRN_DISCOVERY to the proxy. A UCRN_DISCOVERY message is NSLP 
      signaling message and containing the flow identifier and 
      session identifier received from MN via DCRN_DISCOVERY message. 
      A UCRN_DISCOVERY message also contains the information of IP 
      addresses appended to DCRN_DISCOVERY message. 
       
      e. Each QNE belonging to the signaling path from CN to proxy 
      intercepts UCRN_DISCOVERY, and checks if any interface has 
      resource reservation for the pair of flow identifier and 
      session identifier for downlink. If one of interface has the 
      reservation, the QNE appends IP address of the interface to 
      UCRN_DISCOVERY. 


  Sanda et al.            Expires - August 2004              [Page 5] 
  Internet-Draft                                        February 2004 
   
      When UCRN_DISCOVERY message arrives to proxy, UCRN_DISCOVERY 
      message contains the information of all overlapping interfaces 
      belonging to current uplink QoS path (from MN to CN) and 
      expected new downlink path (from proxy to CN) in order. 
                       
                          
                              current path                           
                        <=======================                     
                                         IF4      IF3                
               +--+    +----+   +----+   +----+   +----+    +--+     
               |MN|<<<<|mQNE|<<<|mQNE|<<<|mQNE|<<<|mQNE|<<<<|CN|     
               +--+    +----+   +----+  <+----+<<<+----+<<<<+--+     
                                        v                            
                                        v ------                     
                                        v |                          
                   +-----+     +----+   v |                          
                   |Proxy|<<<<<|mQNE|<<<< |                          
                   +-----+     +----+     |                          
                                          |                          
                        <------------------                          
                         UCRN_DISCOVERY                              
                                          IF=Interface to be appended 
                                             to the message          
                          
       Figure3: Interfaces' information collected by UCRN_DISCOVERY 
      
       
      f. The proxy receiving UCRN_DISCOVERY from CN checks appended 
      information in UCRN_DISCOVERY and decides CRN(s). The first 
      interface IP address appended to DCRN_DISCOVERY (and set into 
      UCRN_DISCOVERY) is DCRN, and the last interface IP address 
      appended to UCRN_DISCOVERY is UCRN. 
       
      
                                                                     
                  collected by             collected by              
                 DCRN_DISCOVERY           UCRN_DISCOVERY             
                <===============>        <===============>           
                                                                     
        +------+--------+--------+------+--------+--------+          
        |up-   |IP addr.|IP addr.|down- |IP addr.|IP addr.|          
        |stream| of IF1 | of IF2 |stream| of IF1 | of IF2 |          
        +------+--------+--------+------+--------+--------+          
                                                                     
                   ^                                 ^               
                   |                                 |               
                  DCRN                              UCRN             
                                                                     
      
               Figure4: collected information and DCRN/UCRN 
                                                                  
                                                                  


  Sanda et al.            Expires - August 2004              [Page 6] 
  Internet-Draft                                        February 2004 
   
     The proxy sends PROXY_INIT_ACK message to the MN. PROXY_INIT_ACK 
     message is NSLP message and used for informing whether pre CRN 
     discovery is successfully done or failed. 
      
      
  5. New path installation 
      
     DCRN/UCRN discovered by proxy can be used for fast state 
     installation. For this purpose, it is required that RESERVE 
     message contains IP addresses of DCRN/UCRN. When the RESERVE 
     message reaches the DCRN, it is also required for the DCRN to 
     translate the RESERVE (create) message into RESERVE (update) 
     message and vice versa for UCRN in order to avoid duplicate 
     reservation of common QoS path (CN-UCRN/DCRN). 
      
     This section describes an example of fast state installation. 
      
  5.1 Fast state installation for downlink data flow 
      
     The following scenario assumes that the data flow is downlink 
     only. 
      
      a. When the MN listens to neighboring AP's beacons, MN refers a 
      proxy table (see Chapter 3). This table has mapping information 
      between APs and their connecting ARs, and whether the ARs have 
      mQNE functionalities. MN selects target subnetwork of which AR 
      has mQNE (proxy) functionalities. 
       
      b. MN configures NCoA from the AR's information in the table, 
      i.e. AR's IP address and prefix length. 
       
      c. MN sends PROXY_INIT message with NCoA to the new AR (NAR). 
      This PROXY_INIT message may contain IP address of MN's old 
      (current) mQNE as well.  
       
      d. The NAR executes DAD for NCoA. 
       
      e. Simultaneously with d., the NAR performs pre CRN discovery 
      as described in Chapter 4 and discovers UCRN. 
       
      f. If the NCoA is valid, the NAR send RESERVE message with UCRN 
      to CN. QSpec information may be obtained form mQNE in old 
      (current) path such as MN or old adjacent mQNE of MN. 
      
      
      
      
      
      
      
      
      


  Sanda et al.            Expires - August 2004              [Page 7] 
  Internet-Draft                                        February 2004 
   
                                                                     
                  MN                  NAR                   CN       
                                    (Proxy)                          
                  |                    |                    |        
              +--------+               |                    |        
              |HO      |               |                    |        
              |Decision|               |                    |        
              +--------+               |                    |        
            +-------------+            |                    |        
            |NCoA         |            |                    |        
            |Configuration|            |                    |        
            +-------------+            |                    |        
                  |                    |                    |        
                  |PROXY_INIT          |                    |        
                  |------------------->|                    |        
                  |                    |                    |        
                  |                +-------+                |        
                  |                |DAD for|                |        
                  |                |NCoA   |                |        
                  |                +-------+                |        
                  |                    |                    |        
                  |                    |DCRN_DISCOVERY      |        
                  |                    |------------------->|        
                  |                    |                    |        
                  |                    |      UCRN_DISCOVERY|        
                  |                    |<-------------------|        
                  |                    |                    |        
                  |                +---------+              |        
                  |                |Obtaining|              |        
                  |                |UCRN     |              |        
                  |                +---------+              |        
                  |                    |                    |        
                  |                    |RESERVE             |        
                  |                    |------------------->|        
                  |                    |                    |        
                  |                    |                    |        
                                                                     
      
       Figure5: An example of Fast state installation for downlink 
      
      
  5.2 Fast state installation for uplink data flow 
      
     If data flow is uplink only or duplicate, the following 
     procedure can be used in addition to downlink case. 
      
      o DCRN_DISCOVERY message contains NCoA (which is valid). 
       
      o The CN receiving DCRN_DISCOVERY message performs RESERVE 
      message to NAR (proxy) for uplink, as it can obtain DCRN and 
      MN's NCoA. 
      


  Sanda et al.            Expires - August 2004              [Page 8] 
  Internet-Draft                                        February 2004 
   
      
                                                                     
                  MN                  NAR                   CN       
                                    (Proxy)                          
                  |                    |                    |        
              +--------+               |                    |        
              |HO      |               |                    |        
              |Decision|               |                    |        
              +--------+               |                    |        
            +-------------+            |                    |        
            |NCoA         |            |                    |        
            |Configuration|            |                    |        
            +-------------+            |                    |        
                  |                    |                    |        
                  |PROXY_INIT          |                    |        
                  |------------------->|                    |        
                  |                    |                    |        
                  |                +-------+                |        
                  |                |DAD for|                |        
                  |                |NCoA   |                |        
                  |                +-------+                |        
                  |                    |                    |        
                  |                    |DCRN_DISCOVERY      |        
                  |                    |------------------->|        
                  |                    |                    |        
                  |                    |               +---------+   
                  |                    |               |Obtaining|   
                  |                    |               |DCRN and |   
                  |                    |               |NCoA     |   
                  |                    |               +---------+   
                  |                    |                    |        
                  |                    |             RESERVE|        
                  |                    |<-------------------|        
                  |                    |                    |        
                  |                    |      UCRN_DISCOVERY|        
                  |                    |<-------------------|        
                  |                    |                    |        
                  |                    |                    |        
                                                                     
        Figure6: An example of Fast state installation for uplink 
      
      
  6. Signaling messages for fast CRN discovery 
      
     PROXY_INIT, DCRN_DISCOVERY, UCRN_DISCOVERY and PROXY_INIT_ACK 
     may be extended existing QoS NSLP message, such as QUERY, 
     RESPONSE and NOTIFY [7]. If DCRN_DISCOVERY and UCRN_DISCOVERY 
     are QUERY and RESPONSE respectively, proxy can obtain downlink 
     path information simultaneously with UCRN discovery. 
      
      



  Sanda et al.            Expires - August 2004              [Page 9] 
  Internet-Draft                                        February 2004 
   
  7. Security Considerations 
      
     Security issues are addressed in section 12 of [6] but they are 
     not covering candidate proxies (mQNEs) which are described in 
     this document. Proper security handling must be provided in 
     candidate proxy discovery. It is also required to consider the 
     issues caused by sending PROXY_INIT which includes session and 
     flow identifiers from MN to candidate proxies, such as 
     session/reservation ownership. 
      
     Future draft will include these issues. 
      
      
  References 
      
     1. Bradner, S., "The Internet Standards Process -- Revision 3", 
     BCP 9, RFC 2026, October 1996. 
      
     2. Bradner, S., "Key words for use in RFCs to Indicate 
     Requirement Levels", BCP 14, RFC 2119, March 1997 
      
     3  X. Fu, et al., "Mobility Issues in Next Steps in Signaling 
     (NSIS)", Internet Draft (work in progress),  
     draft-fu-nsis-mobility-01.txt, October 2003 
      
     4  H. Chaskar, et al., "Requirements of a Quality of Service 
     (QoS) Solution for Mobile IP", RFC3583, September 2003 
      
     5  S. Lee, et al., "Mobility Functions in the QoS-NSLP", 
     Internet Draft (work in progress), draft-lee-nsis-mobility-nslp-
     01.txt, October 2003 
      
     6  Roland Bless, et al., "Mobility and Internet Signaling 
     Protocols", Internet Draft (work in progress), draft-manyfolks-
     signaling-protocol-mobility-00.txt, January 2004 
      
     7  Sven Van den Bosch (Editor), "NSLP for Quality-of-Service 
     signaling", Internet Draft (work in progress), draft-ietf-nsis-
     qos-nslp-01.txt, October 2003 
      
     8  Robert Hancock et al., "Next Step in Signaling: Framework", 
     Internet Draft (work in progress), draft-ietf-nsis-fw-05.txt, 
     October 2003 
      
     9  R. Hancock, et al., "Interactions of Routing and Mobility on 
     NTLP and NSLP", Internet Draft (work in progress), draft-
     hancock-nsis-routing-mobility-00.txt, October, 2003 
      
     10 S. Jeong, et al., "Mobility Functions in the NTLP", Internet 
     Draft (work in progress), draft-jeong-nsis-mobility-ntlp-01.txt, 
     October 2003 
      


  Sanda et al.            Expires - August 2004             [Page 10] 
  Internet-Draft                                        February 2004 
   
     11 H. Schulzrinne, et al., "GIMPS:  General Internet Messaging 
     Protocol for Signaling", Internet Draft (Work in progress), 
     draft-ietf-nsis-ntlp-00, October 2003 
      
     12 M. Liebsch, et al., "Candidate Access Router Discovery", 
     Internet Draft (work in progress), draft-ietf-seamoby-card-
     protocol-06.txt, December 2003 
      
     13 D.Johnson, C. Perkins and J. Arkko, "Mobility Support in 
     IPv6", Internet Draft (work in progress), draft-ietf-mobileip-
     ipv6-24.txt, June 2003 
      
  Author's Addresses 
      
     Takako Sanda 
     Panasonic (Matsushita Electric Industrial Co., Ltd.) 
     5-3, Hikarino-oka, Yokosuka City, Kanagawa 239-0847, Japan 
     Phone: (+81) 46 840 5764 
     Email: sanda.takako@jp.panasonic.com 
      
     Toyoki Ue 
     Panasonic (Matsushita Electric Industrial Co., Ltd.) 
     5-3, Hikarino-oka, Yokosuka City, Kanagawa 239-0847, Japan 
     Phone: (+81) 46 840 5816 
     Email: ue.toyoki@jp.panasonic.com 
      
      
     Full Copyright Statement 
      
     Copyright (C) The Internet Society (2003).  All Rights Reserved. 
      
     This document and translations of it may be copied and furnished 
     to others, and derivative works that comment on or otherwise 
     explain it or assist in its implementation may be prepared, 
     copied, published and distributed, in whole or in part, without 
     restriction of any kind, provided that the above copyright 
     notice and this paragraph are included on all such copies and 
     derivative works.  However, this document itself may not be 
     modified in any way, such as by removing the copyright notice or 
     references to the Internet Society or other Internet 
     organizations, except as needed for the purpose of developing 
     Internet standards in which case the procedures for copyrights 
     defined in the Internet Standards process must be followed, or 
     as required to translate it into languages other than English. 
      
     The limited permissions granted above are perpetual and will not 
     be revoked by the Internet Society or its successors or assigns. 
      
     This document and the information contained herein is provided 
     on an "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET 
     ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR 
     IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE 


  Sanda et al.            Expires - August 2004             [Page 11] 
  Internet-Draft                                        February 2004 
   
     OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY 
     IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A 
     PARTICULAR PURPOSE. 


















































  Sanda et al.            Expires - August 2004             [Page 12] 