<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>A SASL and GSS-API Mechanism for OAuth</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 OAuth SASL Mechanism Specification">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Channel Binding">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Initial Client Response">
<link href="#rfc.section.3.2.1" rel="Chapter" title="3.2.1 Query String in OAUTH-PLUS">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Server's Response">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Mapping to SASL Identities">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Discovery Information">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 Use of Signature Type Authorization">
<link href="#rfc.section.4" rel="Chapter" title="4 GSS-API OAuth Mechanism Specification">
<link href="#rfc.section.5" rel="Chapter" title="5 Examples">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Successful Bearer Token Exchange">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 MAC Authentication with Channel Binding">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Failed Exchange">
<link href="#rfc.section.5.4" rel="Chapter" title="5.4 Failed Channel Binding">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 SASL Registration">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 GSS-API Registration">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 Link Type Registration">
<link href="#rfc.section.7.3.1" rel="Chapter" title="7.3.1 OAuth 2 Authentication Endpoint">
<link href="#rfc.section.7.3.2" rel="Chapter" title="7.3.2 OAuth 2 Token Endpoint">
<link href="#rfc.section.7.3.3" rel="Chapter" title="7.3.3 OAuth 1.0a Request Initiation Endpoint">
<link href="#rfc.section.7.3.4" rel="Chapter" title="7.3.4 OAuth 1.0a Authorization Endpoint">
<link href="#rfc.section.7.3.5" rel="Chapter" title="7.3.5 OAuth 1.0a Token Endpoint">
<link href="#rfc.section.8" rel="Chapter" title="8 Appendix A -- Document History">
<link href="#rfc.references" rel="Chapter" title="9 References">
<link href="#rfc.references.1" rel="Chapter" title="9.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="9.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="OAuth enables a third-party application to obtain limited access to a protected resource, either on behalf of a resource owner by orchestrating an approval interaction, or by allowing the third-party application to obtain access on its own behalf.  " />
  <meta name="description" content="OAuth enables a third-party application to obtain limited access to a protected resource, either on behalf of a resource owner by orchestrating an approval interaction, or by allowing the third-party application to obtain access on its own behalf.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">KITTEN</td>
<td class="right">W. Mills</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">T. Showalter</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Yahoo! Inc.</td>
</tr>
<tr>
<td class="left">Expires: May 03, 2012</td>
<td class="right">H. Tschofenig</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Nokia Siemens Networks</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">A SASL and GSS-API Mechanism for OAuth<br />
  <span class="filename">draft-mills-kitten-sasl-oauth-04.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>OAuth enables a third-party application to obtain limited access to a protected resource, either on behalf of a resource owner by orchestrating an approval interaction, or by allowing the third-party application to obtain access on its own behalf.  </p>
<p>This document defines how an application client uses OAuth over the Simple Authentication and Security Layer (SASL) or the Generic Security Service Application Program Interface (GSS-API) to access a protected resource at a resource serve, and additionally defines authorization and token issuing endpoint discovery. Thereby, it enables schemes defined within the OAuth framework for non-HTTP-based application protocols.  </p>
<p>Clients typically store the user's long term credential. This does, however, lead to significant security vulnerabilities, for example, when such a credential leaks. A significant benefit of OAuth for usage in those clients is that the password is replaced by a token. Tokens typically provided limited access rights and can be managed and revoked separately from the user's long-term credential (password).  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 03, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">OAuth SASL Mechanism Specification</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Channel Binding</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Initial Client Response</a>
</li>
<li>3.2.1.   <a href="#rfc.section.3.2.1">Query String in OAUTH-PLUS</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Server's Response</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Mapping to SASL Identities</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Discovery Information</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">Use of Signature Type Authorization</a>
</li>
<li>4.   <a href="#rfc.section.4">GSS-API OAuth Mechanism Specification</a>
</li>
<li>5.   <a href="#rfc.section.5">Examples</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Successful Bearer Token Exchange</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">MAC Authentication with Channel Binding</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Failed Exchange</a>
</li>
<li>5.4.   <a href="#rfc.section.5.4">Failed Channel Binding</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">SASL Registration</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">GSS-API Registration</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">Link Type Registration</a>
</li>
<li>7.3.1.   <a href="#rfc.section.7.3.1">OAuth 2 Authentication Endpoint</a>
</li>
<li>7.3.2.   <a href="#rfc.section.7.3.2">OAuth 2 Token Endpoint</a>
</li>
<li>7.3.3.   <a href="#rfc.section.7.3.3">OAuth 1.0a Request Initiation Endpoint</a>
</li>
<li>7.3.4.   <a href="#rfc.section.7.3.4">OAuth 1.0a Authorization Endpoint</a>
</li>
<li>7.3.5.   <a href="#rfc.section.7.3.5">OAuth 1.0a Token Endpoint</a>
</li>
<li>8.   <a href="#rfc.section.8">Appendix A -- Document History</a>
</li>
<li>9.   <a href="#rfc.references">References</a>
</li>
<li>9.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>9.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">OAuth <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a> enables a third-party application to obtain limited access to a protected resource, either on behalf of a resource owner by orchestrating an approval interaction, or by allowing the third-party application to obtain access on its own behalf. The core OAuth specification <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a> does not define the interaction between the client and the resource server with the access to a protected resource using an Access Token.  This functionality is described in two separate specifications, namely <a href="#I-D.ietf-oauth-v2-bearer">[I-D.ietf-oauth-v2-bearer]</a>, and <a href="#I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</a>, whereby the focus is on an HTTP-based environment only.  </p>
<p><a href="#oauth-exchange">Figure 1</a> shows the abstract message flow as shown in Figure 1 of <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a>.</p>
<div id="#rfc.figure.1"></div>
<div id="#oauth-exchange"></div>
<pre>
     +--------+                               +---------------+
     |        |--(A)- Authorization Request -&gt;|   Resource    |
     |        |                               |     Owner     |
     |        |&lt;-(B)-- Authorization Grant ---|               |
     |        |                               +---------------+
     |        |
     |        |                               +---------------+
     |        |--(C)-- Authorization Grant --&gt;| Authorization |
     | Client |                               |     Server    |
     |        |&lt;-(D)----- Access Token -------|               |
     |        |                               +---------------+
     |        |
     |        |                               +---------------+
     |        |--(E)----- Access Token ------&gt;|    Resource   |
     |        |                               |     Server    |
     |        |&lt;-(F)--- Protected Resource ---|               |
     +--------+                               +---------------+
</pre>
<p></p>
<p id="rfc.section.1.p.4">This document  takes advantage of the OAuth protocol and its deployment base to provide a way to use SASL <a href="#RFC4422">[RFC4422]</a> as well as the GSS-API <a href="#RFC2743">[RFC2743]</a> to gain access to resources when using non-HTTP-based protocols, such as the Internet Message Access Protocol (IMAP) <a href="#RFC3501">[RFC3501]</a>, which is what this memo uses in the examples.</p>
<p id="rfc.section.1.p.5">The Simple Authentication and Security Layer (SASL) is a framework for providing authentication and data security services in connection-oriented protocols via replaceable mechanisms.  It provides a structured interface between protocols and mechanisms.  The resulting framework allows new protocols to reuse existing mechanisms and allows old protocols to make use of new mechanisms.  The framework also provides a protocol for securing subsequent protocol exchanges within a data security layer.</p>
<p id="rfc.section.1.p.6">The Generic Security Service Application Program Interface (GSS-API) <a href="#RFC2743">[RFC2743]</a> provides a framework for applications to support multiple authentication mechanisms through a unified interface. </p>
<p id="rfc.section.1.p.7">This document defines a SASL mechanism for OAuth, but it conforms to the new bridge between SASL and the GSS-API called GS2 <a href="#RFC5801">[RFC5801]</a>.  This means that this document defines both a SASL mechanism and a GSS-API mechanism.  Implementers may be interested in either the SASL, the GSS-API, or even both mechanisms. To faciliate these two variants, the description has been split into two parts, one part that provides normative references for those interested in the SASL OAuth mechanism (see <a href="#SASL-OAUTH">Section 3</a>), and a second part for those implementers that wish to implement the GSS-API portion (see <a href="#GSSAPI-OAUTH">Section 4</a>).  </p>
<p id="rfc.section.1.p.8">When OAuth is integrated into SASL and the GSS-API the high-level steps are as follows: </p>

<ul class="empty">
<li>(A)  The client requests authorization from the resource owner.  The authorization request can be made directly to the resource owner (as shown), or preferably indirectly via the authorization server as an intermediary.</li>
<li>(B)  The client receives an authorization grant which is a credential representing the resource owner's authorization, expressed using one of four grant types defined in this specification or using an extension grant type.  The authorization grant type depends on the method used by the client to request authorization and the types supported by the authorization server.</li>
<li>(C)  The client requests an access token by authenticating with the authorization server and presenting the authorization grant.</li>
<li>(D)  The authorization server authenticates the client and validates the authorization grant, and if valid issues an access token.</li>
<li>(E)  The client requests the protected resource from the resource server and authenticates by presenting the access token.</li>
<li>(F)  The resource server validates the access token, and if valid, serves the request.</li>
</ul>

<p> </p>
<p id="rfc.section.1.p.9">Steps (E) and (F) are not defined in <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a> and are the main functionality specified within this document.  Additionally, an optional discovery exchange is defined. Consequently, the message exchange shown in <a href="#overview">Figure 2</a> is the result of this specification.  (1) and (2) denote the optional discovery exchange steps that may happen before the OAuth 2.0 protocol exchange messages in steps (A)-(D) are executed. Steps (E) and (F) also defined in this specification.  </p>
<div id="#rfc.figure.2"></div>
<div id="#overview"></div>
<pre>
                                                              ----+
   +--------+                                  +---------------+  |
   |        |--(A)-- Authorization Request ---&gt;|   Resource    |  |
   |        |                                  |     Owner     |  |Plain
   |        |&lt;-(B)------ Access Grant ---------|               |  |OAuth
   |        |                                  +---------------+  |2.0
   |        |                                                     | 
   |        |         Client Credentials &amp;     +---------------+  |
   |        |--(C)------ Access Grant --------&gt;| Authorization |  |
   | Client |                                  |     Server    |  |
   |        |&lt;-(D)------ Access Token ---------|               |  |
   |        |      (w/ Optional Refresh Token) +---------------+  |
   |        |                                                 ----+
   |        |
   |        |                                                 ----+
   |        |        (Optional discovery)      +---------------+  |
   |        |--(1)------- User Name  ---------&gt;|               |  |
   | Client |                                  |               |  |
   |        |&lt;-(2)------ Authentication -------|               |  |
   |        |          endpoint information    |    Resource   |  |OAuth
   |        |                                  |     Server    |  |over
   |        |--(E)------ Access Token --------&gt;|               |  |SASL/
   |        |                                  |               |  |GSS-
   |        |&lt;-(F)---- Protected Resource -----|               |  |API
   +--------+                                  +---------------+  |
                                                              ----+
</pre>
<p></p>
<p></p>

<ul class="empty"><li>Note: The discovery procedure in OAuth is still work in progress. Hence, the discovery components described in this document should be considered incomplete and a tentative proposal. In general, there is a trade off between a generic, externally available defined discovery mechanisms (such as Webfinger using host-meta <a href="#I-D.hammer-hostmeta">[I-D.hammer-hostmeta]</a>, or <a href="#I-D.jones-simple-web-discovery">[I-D.jones-simple-web-discovery]</a>) and configuration information exchanged in-band between the SASL communication endpoints. </li></ul>

<p> </p>
<p id="rfc.section.1.p.12">It is worthwhile to note that this specification is also compatible with OAuth 1.0a <a href="#RFC5849">[RFC5849]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.2.p.2">The reader is assumed to be familiar with the terms used in the OAuth 2.0 specification <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a>.</p>
<p id="rfc.section.2.p.3">In examples, "C:" and "S:" indicate lines sent by the client and server respectively. Line breaks have been inserted for readability.</p>
<p id="rfc.section.2.p.4">Note that the IMAP SASL specification requires base64 encoding message, not this memo.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#SASL-OAUTH" id="SASL-OAUTH">OAuth SASL Mechanism Specification</a>
</h1>
<p id="rfc.section.3.p.1">SASL is used as a generalized authentication method in a variety of application layer protocols. This document defines two SASL mechanisms for usage with OAuth: "OAUTH" and "OAUTH-PLUS". The "OAUTH" SASL mechanism provides bearer token alike semantic for SASL while "OAUTH-PLUS" provides a semantic similar to OAuth MAC authentication by utilizing a channel binding mechanism <a href="#RFC5056">[RFC5056]</a>.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Channel Binding</h1>
<p id="rfc.section.3.1.p.1">If the specification for the underlying authorization scheme requires a security layer, such as TLS <a href="#RFC5246">[RFC5246]</a>, the server SHOULD only offer a mechanism where channel binding can be enabled.</p>
<p id="rfc.section.3.1.p.2">The channel binding data is computed by the client based on it's choice of preferred channel binding type.   As specified in <a href="#RFC5056">[RFC5056]</a>, the channel binding information MUST start with the channel binding unique prefix, followed by a colon (ASCII 0x3A), followed by a base64 encoded channel binding payload.  The channel binding payload is the raw data from the channel binding type if the raw channel binding data is less than 500 bytes. If the raw channel binding data is 500 bytes or larger then a SHA-1 <a href="#RFC3174">[RFC3174]</a> hash of the raw channel binding data is computed.</p>
<p id="rfc.section.3.1.p.3">If the client is using tls-unique for a channel binding then the raw channel binding data equals the first TLS finished message.  This is under the 500 byte limit, so the channel binding payload sent to the server would be the base64 encoded first TLS finished message.</p>
<p id="rfc.section.3.1.p.4">In the case where the client has chosen tls-endpoint, the raw channel binding data is the certificate of the server the client connected to, which will frequently be 500 bytes or more. If it is then the channel binding payload is the base64 encoded SHA-1 hash of the server certificate.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Initial Client Response</h1>
<p id="rfc.section.3.2.p.1">The SASL client response is formatted as an HTTP <a href="#RFC2616">[RFC2616]</a> request.  The HTTP request is limited in that the path MUST be "/".  In the OAUTH mechanism no query string is allowed.  The following  header lines are defined in the client response: </p>

<ul class="empty"><li>
<dl>
<dt>User (OPTIONAL):</dt>
<dd style="margin-left: 8">Contains the user identifier being authenticated, and is provided to allow correct discovery information to be returned.</dd>
<dt>Host (REQUIRED):</dt>
<dd style="margin-left: 8">Contains the host name to which the client connected.</dd>
<dt>Authorization (REQUIRED):</dt>
<dd style="margin-left: 8">An HTTP Authorization header.</dd>
</dl>
<p> </p>
</li></ul>

<p> </p>
<p id="rfc.section.3.2.p.2">The user name is provided by the client to allow the discovery information to be customized for the user, a given server could allow multiple authenticators and it needs to return the correct one. For instance, a large ISP could provide mail service for several domains who manage their own user information. For instance, users at foo-example.com could be authenticated by an OAuth service at https://oauth.foo-example.com/, and users at bar-example.com could be authenticated by https://oauth.bar-example.com, but both could be served by a hypothetical IMAP server running at a third domain, imap.example.net. </p>
<h1 id="rfc.section.3.2.1">
<a href="#rfc.section.3.2.1">3.2.1.</a> Query String in OAUTH-PLUS</h1>
<p id="rfc.section.3.2.1.p.1">In the OAUTH-PLUS mechanism the channel binding information is carried in the query string.  OAUTH-PLUS defines following query parameter(s): </p>

<ul class="empty"><li>
<dl>
<dt>cbdata (REQUIRED):</dt>
<dd style="margin-left: 8">Contains the base64 encoded channel binding data, properly escaped as an HTML query parameter value.</dd>
</dl>
<p> </p>
</li></ul>

<p> </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Server's Response</h1>
<p id="rfc.section.3.3.p.1">The server validates the response per the specification for the authorization scheme used. If the authorization scheme used includes signing of the request parameters the client must provide a complete HTTP style request that satisfies the data requirements for the scheme in use.  </p>
<p id="rfc.section.3.3.p.2">In the OAUTH-PLUS mechanism the server examines the channel binding data, extracts the channel binding unique prefix, and extracts the raw channel biding data based on the channel binding type used.  It then computes it's own copy of the channel binding payload and compares that to the payload sent by the client in the query parameters of the tunneled HTTP request.  Those two must be equal for channel binding to succeed.  </p>
<p id="rfc.section.3.3.p.3">The server responds to a successfully verified client message by completing the SASL negotiation. The authentication scheme MUST carry the user ID to be used as the authorization identity (identity to act as). The server MUST use that ID as the user being authorized, that is the user assertion we accept and not other information such as from the URL or "User:" header. </p>
<p id="rfc.section.3.3.p.4">The server responds to failed authentication by sending discovery information in an HTTP style response with the HTTP status code set to 401, and then failing the authentication.  </p>
<p id="rfc.section.3.3.p.5">If channel binding is in use and the channel binding fails the server responds with a minimal HTTP response without discovery information and the HTTP status code set to 412 to indicate that the channel binding precondition failed.  If the authentication scheme in use does not include signing the server SHOULD revoke the presented credential and the client SHOULD discard that credential.  </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Mapping to SASL Identities</h1>
<p id="rfc.section.3.4.p.1">Some OAuth mechanisms can provide both an authorization identity and an authentication identity.  An example of this is OAuth 1.0a <a href="#RFC5849">[RFC5849]</a> where the consumer key (oauth_consumer_key) identifies the entity using to token which equates to the SASL authentication identity, and is authenticated using the shared secret.  The authorization identity in the OAuth 1.0a case is carried in the token (per the requirement above), which SHOULD validated independently.  The server MAY use a consumer key or other comparable identity in the OAuth authorization scheme as the SASL authentication identity.  If an appropriate authentication identity is not available the server MUST use the identity asserted in the token.</p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> Discovery Information</h1>
<p id="rfc.section.3.5.p.1">The server MUST send discovery information in response to a failed authentication exchange or a request with an empty Authorization header. If discovery information is returned it MUST include an authentication endpoint appropriate for the user. If the "User" header is present the discovery information MUST be for that user. Discovery information is provided by the server to the client to allow a client to discover the appropriate OAuth authentication and token endpoints. The client then uses that information to obtain the access token needed for OAuth authentication. The client SHOULD cache and re-use the user specific discovery information for service endpoints. </p>
<p id="rfc.section.3.5.p.2">Discovery information makes use of both the WWW-Authenticate header as defined in HTTP Authentication: Basic and Digest Access Authentication  <a href="#RFC2617">[RFC2617]</a> and Link headers as defined in <a href="#RFC5988">[RFC5988]</a>.  The following elements are defined for discovery information: </p>

<dl>
<dt>WWW-Authenticate</dt>
<dd style="margin-left: 8">A WWW-Authenticate header for each authentication scheme supported by the server.  Authentication scheme names are case insensitive. The following <a href="#RFC2617">[RFC2617]</a> authentication parameters are defined: <dl>
<dt>realm</dt>
<dd style="margin-left: 8">REQUIRED -- (as defined by RFC2617)</dd>
<dt>scope</dt>
<dd style="margin-left: 8">OPTIONAL -- A quoted string.  This provides the client an OAuth 2 scope known to be valid for the resource.</dd>
</dl>
<p> </p>
</dd>
<dt>oauth2-authenticator</dt>
<dd style="margin-left: 8">An <a href="#RFC5988">[RFC5988]</a> Link header specifying the <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a> authentication endpoint.  This link has an OPTIONAL link-extension "scheme", if included this link applies ONLY to the specified scheme.  </dd>
<dt>oauth2-token</dt>
<dd style="margin-left: 8">An <a href="#RFC5988">[RFC5988]</a> Link header specifying the <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a> token endpoint.  This link has an OPTIONAL link-extension "scheme", if included this link applies ONLY to the specified scheme.  </dd>
<dt>oauth-initiate</dt>
<dd style="margin-left: 8">(Optional) An <a href="#RFC5988">[RFC5988]</a> Link header specifying the OAuth1.0a <a href="#RFC5849">[RFC5849]</a> initiation endpoint.  The server MUST send this if "OAuth"  is included in the supported list of HTTP authentication schemes for the server.  </dd>
<dt>oauth-authorize</dt>
<dd style="margin-left: 8">(Optional) An <a href="#RFC5988">[RFC5988]</a> Link header specifying the OAuth1.0a <a href="#RFC5849">[RFC5849]</a> authentication endpoint.  The server MUST send this if "OAuth"  is included in the supported list of HTTP authentication schemes for the server.  </dd>
<dt>oauth-token</dt>
<dd style="margin-left: 8">(Optional) An <a href="#RFC5988">[RFC5988]</a> Link header specifying the OAuth1.0a <a href="#RFC5849">[RFC5849]</a> token endpoint.  The server MUST send this if "OAuth"  is included in the supported list of HTTP authentication schemes for the server.  This link type has one link-extension "grant-types" which is a space separated list of the OAuth 2.0 grant types that can be used at the token endpoint to obtain a token.  </dd>
</dl>

<p> </p>
<p id="rfc.section.3.5.p.3">Usage of the URLs provided in the discovery information is defined in the relevant specifications. If the server supports multiple authenticators the discovery information returned for unknown users MUST be consistent with the discovery information for known users to prevent user enumeration. The OAuth 2.0 specification <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a> supports multiple types of authentication schemes and the server MUST specify at least one supported authentication scheme in the discovery information. The server MAY support multiple schemes and MAY support schemes not listed in the discovery information.</p>
<p id="rfc.section.3.5.p.4">If the resource server provides a scope the client SHOULD always request scoped tokens from the token endpoint.  The client MAY use a scope other than the one provided by the resource server.  Scopes other than those advertised by the resource server must be defined by the resource owner and provided in service documentation (which is beyond the scope of this memo).  </p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> Use of Signature Type Authorization</h1>
<p id="rfc.section.3.6.p.1">This mechanism  supports authorization using signatures, which requires that both client and server construct the string to be signed. OAuth 2 is designed for authentication/authorization to access specific URIs. SASL is designed for user authentication, and has no facility for being more specific. In this mechanism we require an HTTP style format specifically to support signature type authentication, but this is extremely limited. The HTTP style request is limited to a path of "/". This mechanism is in the SASL model, but is designed so that no changes are needed if there is a revision of SASL which supports more specific resource authorization, e.g. IMAP access to a specific folder or FTP access limited to a specific directory. </p>
<div id="#rfc.figure.3"></div>
<pre>
GET / HTTP/1.1 
Host: server.example.com 
User: user@example.com
Authorization: MAC token="h480djs93hd8",timestamp="137131200",
               nonce="dj83hs9s",signature="YTVjyNSujYs1WsDurFnvFi4JK6o="

</pre>
<p id="rfc.section.3.6.p.2">Using the example in the MAC specification <a href="#I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</a> as a starting point, on an IMAP server running on port 143 and given the MAC style authorization request (with long lines wrapped for readability) below: </p>
<div id="#rfc.figure.4"></div>
<pre>
h480djs93hi8\n
137131200\n
dj83hs9s\n
\n
GET\n
server.example.com\n
143\n
/\n
\n
</pre>
<p id="rfc.section.3.6.p.3">The normalized request string would be constructed per the MAC specification <a href="#I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</a>. In this example the normalized request string with the new line separator character is represented by "\n" for display purposes only would be:</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#GSSAPI-OAUTH" id="GSSAPI-OAUTH">GSS-API OAuth Mechanism Specification</a>
</h1>
<p id="rfc.section.4.p.1">Note: The normative references in this section are informational for SASL implementers, but they are normative for GSS-API implementers.</p>
<p id="rfc.section.4.p.2">The SASL OAuth mechanism is also a GSS-API mechanism and the messages described in <a href="#SASL-OAUTH">Section 3</a> are the same, but </p>

<ol>
<li>the GS2 header on the client's first message is excluded when OAUTH is used as a GSS-API mechanism, and</li>
<li>initial context token header is prefixed to the client's first authentication message (context token), as described in Section 3.1 of RFC 2743, </li>
</ol>

<p> </p>
<p id="rfc.section.4.p.3">The GSS-API mechanism OID for OAuth is [[TBD: IANA]].</p>
<p id="rfc.section.4.p.4">OAuth security contexts always have the mutual_state flag (GSS_C_MUTUAL_FLAG) set to TRUE.  OAuth supports credential delegation, therefore security contexts may have the deleg_state flag (GSS_C_DELEG_FLAG) set to either TRUE or FALSE.  </p>
<p id="rfc.section.4.p.5">The mutual authentication property of this mechanism relies on successfully comparing the TLS server identity with the negotiated target name.  Since the TLS channel is managed by the application outside of the GSS-API mechanism, the mechanism itself is unable to confirm the name while the application is able to perform this comparison for the mechanism.  For this reason, applications MUST match the TLS server identity with the target name, as discussed in <a href="#RFC6125">[RFC6125]</a>.</p>
<p id="rfc.section.4.p.6">The OAuth mechanism does not support per-message tokens or GSS_Pseudo_random.</p>
<p id="rfc.section.4.p.7">OAuth supports a standard generic name syntax for acceptors, such as GSS_C_NT_HOSTBASED_SERVICE (see <a href="#RFC2743">[RFC2743]</a>, Section 4.1).  These service names MUST be associated with the  "entityID" claimed by the RP.  OAuth supports only a single name type for initiators: GSS_C_NT_USER_NAME.  GSS_C_NT_USER_NAME is the default name type.  The query, display, and exported name syntaxes for OAuth principal names are all the same.  There is no OAuth-specific name syntax; applications SHOULD use generic GSS-API name types, such as GSS_C_NT_USER_NAME and GSS_C_NT_HOSTBASED_SERVICE (see <a href="#RFC2743">[RFC2743]</a>, Section 4).  The exported name token does, of course, conform to <a href="#RFC2743">[RFC2743]</a>, Section 3.2, but the "NAME" part of the token should be treated as a potential input string to the OAuth name normalization rules.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Examples</h1>
<p id="rfc.section.5.p.1">These example illustrate exchanges between an IMAP client and an IMAP server.</p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Successful Bearer Token Exchange</h1>
<p id="rfc.section.5.1.p.1">This example shows a successful OAuth 2.0 bearer token exchange with an initial client response. Note that line breaks are inserted for readability.</p>
<div id="#rfc.figure.5"></div>
<pre>
S: * IMAP4rev1 Server Ready 
C: t0 CAPABILITY 
S: * CAPABILITY IMAP4rev1 AUTH=OAUTH
S: t0 OK Completed
C: t1 AUTHENTICATE OAUTH R0VUIC8gSFRUUC8xLjENCkhvc3Q6IGltYXAuZXhhbXBs
      ZS5jb20NCkF1dGhvcml6YXRpb246IEJFQVJFUiAidkY5ZGZ0NHFtVGMyTnZiM1J
      sY2tCaGJIUmhkbWx6ZEdFdVkyOXRDZz09Ig0KDQo=
S: +
S: t1 OK SASL authentication succeeded
</pre>
<p></p>
<div id="#rfc.figure.6"></div>
<pre>
GET / HTTP/1.1 
Host: imap.example.com 
Authorization: BEARER "vF9dft4qmTc2Nvb3RlckBhbHRhdmlzdGEuY29tCg=="
</pre>
<p id="rfc.section.5.1.p.3">As required by IMAP <a href="#RFC3501">[RFC3501]</a>, the payloads are base64-encoded. The decoded initial client response is: </p>
<p id="rfc.section.5.1.p.4">The line containing just a "+" and a space is an empty response from the server. This response contains discovery information, and in the success case no discovery information is necessary so the response is empty. Like other messages, and in accordance with the IMAP SASL binding, the empty response is base64-encoded. </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> MAC Authentication with Channel Binding</h1>
<p id="rfc.section.5.2.p.1">This example shows a channel binding failure.  The example sends the same request as above, but in the context of an OAUTH-PLUS exchange the channel binding information is missing. Note that line breaks are inserted for readability.</p>
<div id="#rfc.figure.7"></div>
<pre>
S: * CAPABILITY IMAP4rev1 AUTH=OAUTH SASL-IR IMAP4rev1 Server Ready 
S: t0 OK Completed 
C: t1 AUTHENTICATE MAC R0VUIC8/Y2JkYXRhPSJTRzkzSUdKcFp5QnBjeUJoSUZSTVV5Q
   m1hVzVoYkNCdFpYTnpZV2RsUHdvPSIgSFRUUC8xLjENCkhvc3Q6IHNlcnZlci5leGFtcG
   xlLmNvbQ0KVXNlcjogdXNlckBleGFtcGxlLmNvbQ0KQXV0aG9yaXphdGlvbjogTUFDIHR
   va2VuPSJoNDgwZGpzOTNoZDgiLHRpbWVzdGFtcD0iMTM3MTMxMjAwIixub25jZT0iZGo4
   M2hzOXMiLHNpZ25hdHVyZT0iV1c5MUlHMTFjM1FnWW1VZ1ltOXlaV1F1SUFvPSINCg0K
S: +
S: t1 OK SASL authentication succeeded
</pre>
<p></p>
<div id="#rfc.figure.8"></div>
<pre>
GET /?cbdata="SG93IGJpZyBpcyBhIFRMUyBmaW5hbCBtZXNzYWdlPwo=" HTTP/1.1
Host: server.example.com
User: user@example.com
Authorization: MAC token="h480djs93hd8",timestamp="137131200",
               nonce="dj83hs9s",signature="WW91IG11c3QgYmUgYm9yZWQuIAo="
</pre>
<p id="rfc.section.5.2.p.3">As required by IMAP <a href="#RFC3501">[RFC3501]</a>, the payloads are base64-encoded. The decoded initial client response is: </p>
<p id="rfc.section.5.2.p.4">The line containing just a "+" and a space is an empty response from the server. This response contains discovery information, and in the success case no discovery information is necessary so the response is empty. Like other messages, and in accordance with the IMAP SASL binding, the empty response is base64-encoded.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Failed Exchange</h1>
<p id="rfc.section.5.3.p.1">This example shows a failed exchange because of the empty Authorization header, which is how a client can query for discovery information. Note that line breaks are inserted for readability.</p>
<div id="#rfc.figure.9"></div>
<pre>
S: * CAPABILITY IMAP4rev1 AUTH=OAUTH SASL-IR IMAP4rev1 Server Ready 
S: t0 OK Completed 
C: t1 AUTHENTICATE OAUTH R0VUIC8gSFRUUC8xLjENClVzZXI6IHNjb290ZXJAYW
   x0YXZpc3RhLmNvbQ0KSG9zdDogaW1hcC55YWhvby5jb20NCkF1dGhlbnRpY2F0ZT
   ogDQoNCg==
S: + SFRUUC8xLjEgNDAxIFVuYXV0aG9yaXplZA0KV1dXLUF1dGhlbnRpY2F0ZTogQk
   VBUkVSIHJlYWxtPSJleGFtcGxlLmNvbSINCkxpbms6IDxodHRwczovL2xvZ2luLn
   lhaG9vLmNvbS9vYXV0aD4gcmVsPSJvYXV0aDItYXV0aGVudGljYXRvciIgIA0KTG
   luazogPGh0dHBzOi8vbG9naW4ueWFob28uY29tL29hdXRoPiByZWw9Im91YXRoMi
   10b2tlbiINCg0K
S: t1 NO SASL authentication failed
</pre>
<p></p>
<div id="#rfc.figure.10"></div>
<pre>
GET / HTTP/1.1 
User: alice@example.com 
Host: imap.example.com 
Authorization: 
            </pre>
<p id="rfc.section.5.3.p.3">The decoded initial client response is: </p>
<div id="#rfc.figure.11"></div>
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: BEARER realm="example.com"
Link: &lt;https://login.example.com/oauth&gt; rel="oauth2-authenticator"
Link: &lt;https://login.example.com/oauth&gt; rel="oauth2-token"
            </pre>
<p id="rfc.section.5.3.p.4">The decoded server discovery response is: </p>
<h1 id="rfc.section.5.4">
<a href="#rfc.section.5.4">5.4.</a> Failed Channel Binding</h1>
<p id="rfc.section.5.4.p.1">This example shows a channel binding failure in a discovery request.  The channel binding information is empty.  Note that line breaks are inserted for readability.</p>
<div id="#rfc.figure.12"></div>
<pre>
S: * CAPABILITY IMAP4rev1 AUTH=OAUTH SASL-IR IMAP4rev1 Server Ready 
S: t0 OK Completed 
C: t1 AUTHENTICATE OAUTH R0VUIC8/Y2JkYXRhPSIiIEhUVFAvMS4xDQpVc2VyOi
   BhbGljZUBleGFtcGxlLmNvbQ0KSG9zdDogaW1hcC5leGFtcGxlLmNvbQ0KQXV0aG
   9yaXphdGlvbjoNCg0K
S: + SFRUUC8xLjEgNDEyIFByZWNvbmRpdGlvbiBGYWlsZWQNCg0KDQo=
S: t1 NO SASL authentication failed
</pre>
<p></p>
<div id="#rfc.figure.13"></div>
<pre>
GET /?cbdata="" HTTP/1.1 
User: alice@example.com 
Host: imap.example.com 
Authorization: 
            </pre>
<p id="rfc.section.5.4.p.3">The decoded initial client response is: </p>
<div id="#rfc.figure.14"></div>
<pre>
HTTP/1.1 412 Precondition Failed
            </pre>
<p id="rfc.section.5.4.p.4">The decoded server response is: </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Security Considerations</h1>
<p id="rfc.section.6.p.1">This mechanism does not provide a security layer, but does provide a provision for channel binding. The OAuth 2 specification <a href="#I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a> allows for a variety of usages, and the security properties of these profiles vary. The usage of bearer tokens, for example, provide security features similar to cookies. Applications using this mechanism SHOULD exercise the same level of care using this mechanism as they would in using the SASL PLAIN mechanism. In particular, TLS 1.2 or an equivalent secure channel MUST be implemented and its usage is RECOMMENDED.  </p>
<p id="rfc.section.6.p.2">Channel binding in this mechanism has different properties based on the authentication scheme used.  Channel binding to TLS with a bearer token provides only a binding to the TLS layer.  Authentication schemes like MAC tokens have a signature over the channel binding information. These provide additional protection against a man in the middle attacks, and the MAC authorization header is bound to the channel and only valid in that context.  </p>
<p id="rfc.section.6.p.3">It is possible that SASL will be authenticating a connection and the life of that connection may outlast the life of the token used to authenticate it. This is a common problem in application protocols where connections are long-lived, and not a problem with this mechanism per se.  Servers MAY unilaterally disconnect clients in accordance with the application protocol.  </p>
<p id="rfc.section.6.p.4">An OAuth credential is not equivalent to the password or primary account credential. There are protocols like  XMPP that allow actions like change password.  The server SHOULD ensure that actions taken in the authenticated channel are appropriate to the strength of the presented credential.  </p>
<p id="rfc.section.6.p.5">It is possible for an application server running on Evil.example.com to tell a client to request a token from Good.example.org. A client following these instructions will pass a token from Good to Evil. This is by design, since it is possible that Good and Evil are merely names, not descriptive, and that this is an innocuous activity between cooperating two servers in different domains. For instance, a site might operate their authentication service in-house, but outsource their mail systems to an external entity. </p>
<p id="rfc.section.6.p.6">Tokens have a lifetime associated with them. Reducing both the lifetime of a token provides security benefits in case that tokens leak. In addition a previously obtained token MAY be revoked or rendered invalid at any time. The client MAY request a new access token for each connection to a resource server, but it SHOULD cache and re-use access credentials that appear to be valid.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> IANA Considerations</h1>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> SASL Registration</h1>
<p id="rfc.section.7.1.p.1">The IANA is requested to register the following SASL profile: </p>

<ul class="empty">
<li>SASL mechanism profile: OAUTH</li>
<li>Security Considerations: See this document</li>
<li>Published Specification: See this document</li>
<li>For further information: Contact the authors of this document.</li>
<li>Owner/Change controller: the IETF</li>
<li>Note: None</li>
</ul>

<p> </p>
<p id="rfc.section.7.1.p.2">The IANA is requested to register the following SASL profile: </p>

<ul class="empty">
<li>SASL mechanism profile: OAUTH-PLUS</li>
<li>Security Considerations: See this document</li>
<li>Published Specification: See this document</li>
<li>For further information: Contact the authors of this document.</li>
<li>Owner/Change controller: the IETF</li>
<li>Note: None</li>
</ul>

<p> </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> GSS-API Registration</h1>
<p id="rfc.section.7.2.p.1">IANA is further requested to assign an OID for this GSS mechanism in the SMI numbers registry, with the prefix of iso.org.dod.internet.security.mechanisms (1.3.6.1.5.5) and to reference this specification in the registry.</p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> Link Type Registration</h1>
<p id="rfc.section.7.3.p.1">Pursuant to <a href="#RFC5988">[RFC5988]</a> The following link type registrations [[will be]] registered by mail to link-relations@ietf.org.  </p>
<h1 id="rfc.section.7.3.1">
<a href="#rfc.section.7.3.1">7.3.1.</a> OAuth 2 Authentication Endpoint</h1>
<p></p>

<ul>
<li>Relation Name: oauth2-authenticator </li>
<li>Description: An OAuth 2.0 authentication endpoint.  </li>
<li>Reference: </li>
<li>Notes: This link type indicates an OAuth 2.0 authentication endpoint that can be used for user authentication/authorization for the endpoint providing the link.  </li>
<li>Application Data: [optional] </li>
</ul>

<p> </p>
<h1 id="rfc.section.7.3.2">
<a href="#rfc.section.7.3.2">7.3.2.</a> OAuth 2 Token Endpoint</h1>
<p></p>

<ul>
<li>Relation Name: oauth2-token</li>
<li>Description: The OAuth token endpoint used to get tokens for access.  </li>
<li>Reference: </li>
<li>Notes: The OAuth 2.0 token endpoint to be used for obtaining tokens to access the endpoint providing the link.  </li>
<li>Application Data: This link type has one link-extension "grant-types", which is the OAuth 2.0 grant types that can be used at the token endpoint to obtain a token.  This is not an exclusive list, it provides a hint to the application of what SHOULD be valid.  A token endpoint MAY support additional grant types not advertised by a resource endpoint.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.7.3.3">
<a href="#rfc.section.7.3.3">7.3.3.</a> OAuth 1.0a Request Initiation Endpoint</h1>
<p></p>

<ul>
<li>Relation Name: oauth-initiate</li>
<li>Description: The OAuth 1.0a request initiation endpoint used to get tokens for access.  </li>
<li>Reference: </li>
<li>Notes: The OAuth 1.0a  endpoint used to initiate the sequence, this temporary request is what the user approves to grant access to the resource.  </li>
<li>Application Data: </li>
</ul>

<p> </p>
<h1 id="rfc.section.7.3.4">
<a href="#rfc.section.7.3.4">7.3.4.</a> OAuth 1.0a Authorization Endpoint</h1>
<p></p>

<ul>
<li>Relation Name: oauth-authorize</li>
<li>Description: The OAuth 1.0a authorization endpoint used to approve an access request.  </li>
<li>Reference: </li>
<li>Notes: </li>
<li>Application Data: </li>
</ul>

<p> </p>
<h1 id="rfc.section.7.3.5">
<a href="#rfc.section.7.3.5">7.3.5.</a> OAuth 1.0a Token Endpoint</h1>
<p></p>

<ul>
<li>Relation Name: oauth-token</li>
<li>Description: The OAuth 1.0a token endpoint used to get tokens for access.  </li>
<li>Reference: </li>
<li>Notes: </li>
<li>Application Data: </li>
</ul>

<p> </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Appendix A -- Document History</h1>
<p id="rfc.section.8.p.1">[[ to be removed by RFC editor before publication as an RFC ]] </p>
<p id="rfc.section.8.p.2">-04 </p>
<p></p>

<ul>
<li>Editorial clean-up and text in introduction improved.  </li>
<li>Added GSS-API support </li>
</ul>

<p> </p>
<p id="rfc.section.8.p.4">-03 </p>
<p></p>

<ul>
<li>Fixing channel binding, not tls-unique specific.  Also defining how the CB data is properly generated.  </li>
<li>Various small editorial changes and embarassing spelling fixes.  </li>
</ul>

<p> </p>
<p id="rfc.section.8.p.6">-02 </p>
<p></p>

<ul>
<li>Filling out Channel Binding </li>
<li>Added text clarifying how to bind to the 2 kinds of SASL identities.  </li>
</ul>

<p> </p>
<p id="rfc.section.8.p.8">-01 </p>
<p></p>

<ul>
<li>Bringing this into line with draft 12 of the core spec, the bearer token spec, and references the MAC token spec </li>
<li>Changing discovery over to using the Link header construct from RFC5988.  </li>
<li>Added the seeds of channel binding.  </li>
</ul>

<p> </p>
<p id="rfc.section.8.p.10">-00 </p>
<p></p>

<ul><li>Initial revision </li></ul>

<p> </p>
<h1 id="rfc.references">
<a href="#rfc.references">9.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">9.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="World Wide Web Consortium">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="World Wide Web Consortium">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="World Wide Web Consortium">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2617">[RFC2617]</b></td>
<td class="top">
<a href="mailto:john@math.nwu.edu" title="Northwestern University, Department of Mathematics">Franks, J.</a>, <a href="mailto:pbaker@verisign.com" title="Verisign Inc.">Hallam-Baker, P.M.</a>, <a href="mailto:jeff@AbiSource.com" title="AbiSource, Inc.">Hostetler, J.L.</a>, <a href="mailto:lawrence@agranat.com" title="Agranat Systems, Inc.">Lawrence, S.D.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.J.</a>, <a title="Netscape Communications Corporation">Luotonen, A.</a> and <a href="mailto:stewart@OpenMarket.com" title="Open Market, Inc.">L. Stewart</a>, "<a href="http://tools.ietf.org/html/rfc2617">HTTP Authentication: Basic and Digest Access Authentication</a>", RFC 2617, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3174">[RFC3174]</b></td>
<td class="top">
<a>Eastlake, D.</a> and <a>P. Jones</a>, "<a href="http://tools.ietf.org/html/rfc3174">US Secure Hash Algorithm 1 (SHA1)</a>", RFC 3174, September 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4422">[RFC4422]</b></td>
<td class="top">
<a>Melnikov, A.</a> and <a>K. Zeilenga</a>, "<a href="http://tools.ietf.org/html/rfc4422">Simple Authentication and Security Layer (SASL)</a>", RFC 4422, June 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5056">[RFC5056]</b></td>
<td class="top">
<a>Williams, N.</a>, "<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>", RFC 5056, November 2007.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5849">[RFC5849]</b></td>
<td class="top">
<a>Hammer-Lahav, E.</a>, "<a href="http://tools.ietf.org/html/rfc5849">The OAuth 1.0 Protocol</a>", RFC 5849, April 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5929">[RFC5929]</b></td>
<td class="top">
<a>Altman, J.</a>, <a>Williams, N.</a> and <a>L. Zhu</a>, "<a href="http://tools.ietf.org/html/rfc5929">Channel Bindings for TLS</a>", RFC 5929, July 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5988">[RFC5988]</b></td>
<td class="top">
<a>Nottingham, M.</a>, "<a href="http://tools.ietf.org/html/rfc5988">Web Linking</a>", RFC 5988, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2743">[RFC2743]</b></td>
<td class="top">
<a href="mailto:jlinn@rsasecurity.com" title="RSA Laboratories">Linn, J.</a>, "<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>", RFC 2743, January 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5801">[RFC5801]</b></td>
<td class="top">
<a>Josefsson, S.</a> and <a>N. Williams</a>, "<a href="http://tools.ietf.org/html/rfc5801">Using Generic Security Service Application Program Interface (GSS-API) Mechanisms in Simple Authentication and Security Layer (SASL): The GS2 Mechanism Family</a>", RFC 5801, July 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6125">[RFC6125]</b></td>
<td class="top">
<a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</b></td>
<td class="top">
<a>Hammer-Lahav, E</a>, <a>Recordon, D</a> and <a>D Hardt</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-22">The OAuth 2.0 Authorization Protocol</a>", Internet-Draft draft-ietf-oauth-v2-22, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-v2-bearer">[I-D.ietf-oauth-v2-bearer]</b></td>
<td class="top">
<a>Jones, M</a>, <a>Hardt, D</a> and <a>D Recordon</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-bearer-14">The OAuth 2.0 Authorization Protocol: Bearer Tokens</a>", Internet-Draft draft-ietf-oauth-v2-bearer-14, November 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-oauth-v2-http-mac">[I-D.ietf-oauth-v2-http-mac]</b></td>
<td class="top">
<a>Hammer-Lahav, E</a>, <a>Barth, A</a> and <a>B Adida</a>, "<a href="http://tools.ietf.org/html/draft-ietf-oauth-v2-http-mac-00">HTTP Authentication: MAC Access Authentication</a>", Internet-Draft draft-ietf-oauth-v2-http-mac-00, May 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">9.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3501">[RFC3501]</b></td>
<td class="top">
<a>Crispin, M.</a>, "<a href="http://tools.ietf.org/html/rfc3501">INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1</a>", RFC 3501, March 2003.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.hammer-hostmeta">[I-D.hammer-hostmeta]</b></td>
<td class="top">
<a>Hammer-Lahav, E</a> and <a>B Cook</a>, "<a href="http://tools.ietf.org/html/draft-hammer-hostmeta-17">Web Host Metadata</a>", Internet-Draft draft-hammer-hostmeta-17, September 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.jones-simple-web-discovery">[I-D.jones-simple-web-discovery]</b></td>
<td class="top">
<a>Jones, M</a> and <a>Y Goland</a>, "<a href="http://tools.ietf.org/html/draft-jones-simple-web-discovery-01">Simple Web Discovery (SWD)</a>", Internet-Draft draft-jones-simple-web-discovery-01, July 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">William Mills</span> 
	  <span class="n hidden">
		<span class="family-name">Mills</span>
	  </span>
	</span>
	<span class="org vcardline">Yahoo! Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:wmills@yahoo-inc.com%20">wmills@yahoo-inc.com </a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tim Showalter</span> 
	  <span class="n hidden">
		<span class="family-name">Showalter</span>
	  </span>
	</span>
	<span class="org vcardline">Yahoo! Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:timshow@yahoo-inc.com">timshow@yahoo-inc.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Hannes Tschofenig</span> 
	  <span class="n hidden">
		<span class="family-name">Tschofenig</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  <span>Linnoitustie 6</span>

	  <span class="vcardline">
		<span class="locality">Espoo</span>,  
		<span class="region"></span>
		<span class="code">02600</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">Phone: +358 (50) 4871445</span>

<span class="vcardline">EMail: <a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></span>

<span class="vcardline">URI: <a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></span>

  </address>
</div>

</body>
</html>