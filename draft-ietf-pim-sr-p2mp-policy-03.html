<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Segment Routing Point-to-Multipoint Policy</title>
<meta content="Daniel Voyer (editor)" name="author">
<meta content="Clarence Filsfils" name="author">
<meta content="Rishabh Parekh" name="author">
<meta content="Hooman Bidgoli" name="author">
<meta content="Zhaohui Zhang" name="author">
<meta content="
       This document describes an architecture to construct a
      Point-to-Multipoint (P2MP) tree to deliver Multi-point services in a
      Segment Routing domain. A SR P2MP tree is constructed by stitching a set
      of Replication segments together. A SR Point-to-Multipoint (SR P2MP)
      Policy is used to define and instantiate a P2MP tree which is computed
      by a PCE. 
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="draft-ietf-pim-sr-p2mp-policy-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-pim-sr-p2mp-policy-03-fd44jp0e.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SR P2MP Policy</td>
<td class="right">August 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Voyer, Ed., et al.</td>
<td class="center">Expires 24 February 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-pim-sr-p2mp-policy-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-08-23" class="published">23 August 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-02-24">24 February 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Voyer, Ed.</div>
<div class="org">Bell Canada</div>
</div>
<div class="author">
      <div class="author-name">C. Filsfils</div>
<div class="org">Cisco Systems, Inc.</div>
</div>
<div class="author">
      <div class="author-name">R. Parekh</div>
<div class="org">Cisco Systems, Inc.</div>
</div>
<div class="author">
      <div class="author-name">H. Bidgoli</div>
<div class="org">Nokia</div>
</div>
<div class="author">
      <div class="author-name">Z. Zhang</div>
<div class="org">Juniper Networks</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Segment Routing Point-to-Multipoint Policy</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes an architecture to construct a
      Point-to-Multipoint (P2MP) tree to deliver Multi-point services in a
      Segment Routing domain. A SR P2MP tree is constructed by stitching a set
      of Replication segments together. A SR Point-to-Multipoint (SR P2MP)
      Policy is used to define and instantiate a P2MP tree which is computed
      by a PCE.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-requirements-language">
<a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-note.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <span><a href="#RFC2119" class="xref">RFC 2119</a> [<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 24 February 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty ulBare compact">
<li class="toc ulEmpty ulBare compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-p2mp-tree" class="xref">P2MP Tree</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-sharing-replication-segment" class="xref">Sharing Replication segments across P2MP trees</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-sr-p2mp-policy" class="xref">SR P2MP Policy</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-using-controller-to-build-a" class="xref">Using Controller to build a P2MP Tree</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-provisioning-sr-p2mp-policy" class="xref">Provisioning SR P2MP Policy Creation</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-api" class="xref">API</a></p>
</li>
                  <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-invoking-api" class="xref">Invoking API</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-p2mp-tree-computation" class="xref">P2MP Tree Computation</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-topology-discovery" class="xref">Topology Discovery</a></p>
</li>
                  <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-capability-and-attribute-di" class="xref">Capability and Attribute Discovery</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-instantiating-p2mp-tree-on-" class="xref">Instantiating P2MP tree on nodes</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-pcep" class="xref">PCEP</a></p>
</li>
                  <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-bgp" class="xref">BGP</a></p>
</li>
                  <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.3.2.3">
                    <p id="section-toc.1-1.4.2.3.2.3.1"><a href="#section-4.3.3" class="xref">4.3.3</a>.  <a href="#name-netconf" class="xref">NetConf</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-protection" class="xref">Protection</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.  <a href="#name-local-protection" class="xref">Local Protection</a></p>
</li>
                  <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.  <a href="#name-path-protection" class="xref">Path Protection</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-illustration-of-sr-p2mp-pol" class="xref">Illustration of SR P2MP Policy and P2MP Tree</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-p2mp-tree-with-non-adjacent" class="xref">P2MP Tree with non-adjacent Replication Segments</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#appendix-A.1.1" class="xref">A.1.1</a>.  <a href="#name-sr-mpls" class="xref">SR-MPLS</a></p>
</li>
                  <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a href="#appendix-A.1.2" class="xref">A.1.2</a>.  <a href="#name-srv6" class="xref">SRv6</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-p2mp-tree-with-adjacent-rep" class="xref">P2MP Tree with adjacent Replication Segments</a></p>
<ul class="ulEmpty ulBare toc compact">
<li class="ulEmpty ulBare toc compact" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#appendix-A.2.1" class="xref">A.2.1</a>.  <a href="#name-sr-mpls-2" class="xref">SR-MPLS</a></p>
</li>
                  <li class="ulEmpty ulBare toc compact" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a href="#appendix-A.2.2" class="xref">A.2.2</a>.  <a href="#name-srv6-2" class="xref">SRv6</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="toc ulEmpty ulBare compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A Multi-point service delivery could be realized via P2MP trees in a
      Segment Routing domain <span>[<a href="#RFC8402" class="xref">RFC8402</a>]</span>. A P2MP tree spans from
      a Root node to a set of Leaf nodes via intermediate Replication Nodes.
      It consists of a Replication segment <span>[<a href="#I-D.ietf-spring-sr-replication-segment" class="xref">I-D.ietf-spring-sr-replication-segment</a>]</span> at the root node, one
      or more Replication segments at Leaf nodes and intermediate Replication
      Nodes. The Replication segments are stitched together.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">A Segment Routing P2MP policy, a variant of the SR Policy <span>[<a href="#I-D.ietf-spring-segment-routing-policy" class="xref">I-D.ietf-spring-segment-routing-policy</a>]</span>, is used to define a
      P2MP tree. A PCE is used to compute the tree from the Root node to the
      set of Leaf nodes via a set of Replication Nodes. The PCE then
      instantiates the P2MP tree in the SR domain by signaling Replication
      segments to Root, replication and Leaf nodes using various protocols
      (PCEP, BGP, NetConf etc.). Replication segments of a P2MP tree can be
      instantiated for SR-MPLS and SRv6 dataplanes.<a href="#section-1-2" class="pilcrow">¶</a></p>
</section>
<div id="P2MP_Tree">
<section id="section-2">
      <h2 id="name-p2mp-tree">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-p2mp-tree" class="section-name selfRef">P2MP Tree</a>
      </h2>
<p id="section-2-1">A P2MP tree in a SR domain connects a Root to a set of Leaf nodes via
      a set of intermediate Replication Nodes. It consists of a Replication
      segment at the root stitched to Replication segments at intermediate
      Replication Nodes eventually reaching the Leaf nodes.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The Replication SID of the Replication segment at Root node is called
      Tree-SID. The Tree-SID SHOULD also be used as Replication SID of
      Replication segments at Replication and Leaf nodes. The Replication
      segments at Replication and Leaf nodes MAY use Replication SIDs that are
      not same as the Tree-SID.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The Replication segment at Root of a P2MP tree MUST be associated
      with that P2MP tree (i.e. &lt;Root, Tree-ID&gt; identifier in SR P2MP
      policy section below) to map a Multi-point service to the tree. A
      Replication segment that terminates a P2MP tree at a Leaf node MUST be
      associated with the P2MP tree to determine the context for a Multi-point
      service. The The information that can be used to derive this association
      is specific to encoding of the protocol (PCEP, BGP, NetConf etc.) used
      to instantiate the Replication segment for a P2MP tree. Replication
      segments at intermediate Replication Nodes of a tree are also associated
      with that tree.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">For SR-MPLS, a PCE MAY decide not to instantiate Replication segments
      at Leaf nodes of a P2MP tree if it is known a priori that Multi-point
      services mapped to the P2MP tree can be identified using a context that
      is globally unique in SR domain. In this case, Replication Nodes
      connecting to Leaf nodes effectively does Penultimate-Hop Pop (PHP)
      behavior to pop Tree-SID from a packet. A Multi-point service context
      assigned from "Domain-wide Common Block" (DCB)
      [I-D.ietf-bess-mvpn-evpn-aggregation-label] is an example of globally
      unique context.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">A packet steered into a P2MP tree is replicated by the Replication
      segment at Root node to each downstream node in the Replication segment,
      with the Replication SID of the Replication segment at the downstream
      node. A downstream node could be a Leaf node or an intermediate
      Replication Node. In the latter case, replication continues with the
      Replication segments until all Leaf nodes are reached. A packet is
      steered into a P2MP tree in two ways:<a href="#section-2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-6.1">Based on a local policy-based routing at the Root node.<a href="#section-2-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-6.2">Based on steering via the Tree-SID at the Root node.<a href="#section-2-6.2" class="pilcrow">¶</a>
</li>
      </ul>
<section id="section-2.1">
        <h3 id="name-sharing-replication-segment">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-sharing-replication-segment" class="section-name selfRef">Sharing Replication segments across P2MP trees</a>
        </h3>
<p id="section-2.1-1">Two or more P2MP trees MAY share a Replication segment at Root or
        Replication Nodes if at minimum the first condition below is
        satisfied. A tree always has its own Replication segment at its root
        even if shares another Replication segment. A tree that shares another
        Replication segment may or may not have its own Replication segment on
        its Leaf nodes. If not, the second and third conditions apply to such
        situations.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1-2">
<li id="section-2.1-2.1">The Leaf nodes reached via a shared Replication segment must be
            subset of Leaf or Replication Nodes of the P2MP trees that share
            this segment. Note if a Replication segment is shared, all its
            downstream Replication segments are also shared.<a href="#section-2.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.2">Some Multi-point services realized by the P2MP trees may need
            service context (e.g. packets are for certain VPNs, and/or from
            certain nodes). If the trees do not have their own Replication
            segments at their Leaf nodes then the packets transported on the
            P2MP trees MUST carry a service context that does not rely on the
            tree or root identification, e.g. a service label assigned from
            Domain-wide Common Block or common SRGB for SR-MPLS.<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.3">For some Multi-point services using P2MP trees that share
            Replication segments, packets transported on these trees MAY
            require a Tree context (e.g. MVPN Extranet <span>[<a href="#RFC7900" class="xref">RFC7900</a>]</span> to avoid certain ambiguities - see Section
            2.3.1 of RFC 7900). In this case, the trees MUST have their own
            Replication segments on the Leaf nodes. For SR-MPLS, this is
            similar to "tunnel stacking" concept.<a href="#section-2.1-2.3" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.1-3">Sharing of a Replication segment for P2MP trees is OPTIONAL. Exact
        procedures to ensure validity of above conditions across PM2P services
        on nodes of a Segment Routing domain are outside the scope of this
        document.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-3">
      <h2 id="name-sr-p2mp-policy">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-sr-p2mp-policy" class="section-name selfRef">SR P2MP Policy</a>
      </h2>
<p id="section-3-1">The SR P2MP policy is a variant of an SR policy<span>[<a href="#I-D.ietf-spring-segment-routing-policy" class="xref">I-D.ietf-spring-segment-routing-policy</a>]</span> and is used to
      instantiate SR P2MP trees.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">A SR P2MP Policy is identified by the tuple &lt;Root, Tree-ID&gt;,
      where:<a href="#section-3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-3.1">Root: The address of Root node of P2MP tree instantiated by the
          SR P2MP Policy<a href="#section-3-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-3.2">Tree-ID: A identifier that is unique in context of the Root. This
          is an unsigned 32-bit number.<a href="#section-3-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-4">A SR P2MP Policy is defined by following elements:<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">Leaf nodes: A set of nodes that terminate the P2MP trees.<a href="#section-3-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-5.2">Candidate Paths: See below.<a href="#section-3-5.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-6">A SR P2MP policy is provisioned on a PCE to instantiate the P2MP
      tree. The Tree-SID SHOULD be used as Binding SID of the P2MP policy. A
      PCE computes the P2MP tree and instantiates Replication segments at
      Root, Replication and Leaf nodes. When Replication segments are not
      shared across P2MP trees, the Root and Tree-ID of the SR P2MP policy are
      mapped to Replication-ID element of the Replication segment identifier
      i.e the SR Replication segment identifier is &lt;Root, Tree-ID,
      Node-ID&gt;. A shared Replication segment MAY be identified with zero
      Root-ID address (0.0.0.0 for IPv4 and :: for IPv6) and a Replication-ID
      that is unique in context of Node address where the Replication segment
      is instantiated when it is not associated a particular tree.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">A SR P2MP Policy has one or more Candidate paths. The active
      Candidate path is selected based on the tie breaking rules amongst the
      candidate-paths as specified in<span>[<a href="#I-D.ietf-spring-segment-routing-policy" class="xref">I-D.ietf-spring-segment-routing-policy</a>]</span>. Each candidate path
      has a set of topological/resource constraints and/or optimization
      objectives which determine the P2MP tree for that Candidate path.
      Tree-SID is an identifier of the P2MP tree of the candidate path in the
      forwarding plane. It is instantiated in the forwarding plane at Root
      node, intermediate Replication Nodes and Leaf nodes. The Tree-SID MAY be
      different at Replication and Leaf nodes.<a href="#section-3-7" class="pilcrow">¶</a></p>
</section>
<section id="section-4">
      <h2 id="name-using-controller-to-build-a">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-using-controller-to-build-a" class="section-name selfRef">Using Controller to build a P2MP Tree</a>
      </h2>
<p id="section-4-1">A P2MP tree can be built using a Path Computation Element (PCE). This
      section outlines a high-level architecture for such an approach.<a href="#section-4-1" class="pilcrow">¶</a></p>
<span id="name-centralized-control-plane-m"></span><div id="Control-Plane">
<figure id="figure-1">
        <div class="artwork art-text alignCenter" id="section-4-2.1">
<pre>

                   North Bound                South Bound
                   Programming          ..... Programming
                   Interface                  Interface
                        |
                        |
                        v
                     +-----+ ..........................
        .............| PCE | .............             .
        .            +-----+             .             .
        .               .                .             .
        .               .                .             .
        .               .                .             .
        .               .                V             .
        .               .              +----+          .
        .               .              | N3 |          .
        .               .              +----+          .
        .               .                 | Leaf (L2)   .
        .               .                 |            .
        .               .                 |            .
        V               V                 |            V
      +----+          +----+ --------------          +----+
      | N1 |----------| N2 |-------------------------| N4 |
      +----+          +----+                         +----+
     Root (R)         Replication Node (M)           Leaf (L1)

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-centralized-control-plane-m" class="selfRef">Centralized Control Plane Model</a>
        </figcaption></figure>
</div>
<section id="section-4.1">
        <h3 id="name-provisioning-sr-p2mp-policy">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-provisioning-sr-p2mp-policy" class="section-name selfRef">Provisioning SR P2MP Policy Creation</a>
        </h3>
<p id="section-4.1-1">A SR P2MP policy can be instantiated and maintained in a
        centralized fashion using a Path Computation Element (PCE).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<section id="section-4.1.1">
          <h4 id="name-api">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-api" class="section-name selfRef">API</a>
          </h4>
<p id="section-4.1.1-1">North-bound APIs on a PCE can be used to:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.1.1-2">
<li id="section-4.1.1-2.1">Create SR P2MP policy: CreateSRP2MPPolicy&lt;Root,
              Tree-ID&gt;<a href="#section-4.1.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-2.2">Delete SR P2MP policy: DeleteSRP2MPPolicy&lt;Root,
              Tree-ID&gt;<a href="#section-4.1.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-2.3">Modify SR P2MP policy Leaf Set:
              SRP2MPPolicyLeafSetModify&lt;Root, Tree-ID, {Leaf Set}&gt;<a href="#section-4.1.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-2.4">Create a Candidate Path for SR P2MP policy:
              CreateSRP2MPCandidatePath&lt;Root, Tree-ID,
              &lt;CP-ID&gt;&gt;<a href="#section-4.1.1-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-2.5">Delete a Candidate Path for SR P2MP policy:
              DeleteSRP2MPCandidatePath&lt;Root, Tree-ID,
              &lt;CP-ID&gt;&gt;<a href="#section-4.1.1-2.5" class="pilcrow">¶</a>
</li>
            <li id="section-4.1.1-2.6">Update a Candidate Path for SR P2MP policy:
              UpdateSRP2MPCandidatePath&lt;Root, Tree-ID, &lt;CP-ID&gt;,
              Preference, [Constraints], [Optimization], ...&gt;<a href="#section-4.1.1-2.6" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4.1.1-3">CP-ID is identifier of a Candidate Path within a SR P2MP policy.
          One possible identifier is the tuple &lt;Protocol-Origin,
          originator, discriminator&gt; as specified in <span>[<a href="#I-D.ietf-spring-segment-routing-policy" class="xref">I-D.ietf-spring-segment-routing-policy</a>]</span>.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">Note these are conceptual APIs. Actual implementations may offer
          different APIs as long as they provide same functionality. For
          example, API might allow symbolic name to be assigned for a P2MP
          policy or APIs might allow individual Leaf nodes to be added or
          deleted from a policy instead of an update operation.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.2">
          <h4 id="name-invoking-api">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-invoking-api" class="section-name selfRef">Invoking API</a>
          </h4>
<p id="section-4.1.2-1">Interaction with a PCE can be via PCEP, REST, Netconf, gRPC, CLI.
          Yang model shall be be developed for this purpose as well.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4.2">
        <h3 id="name-p2mp-tree-computation">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-p2mp-tree-computation" class="section-name selfRef">P2MP Tree Computation</a>
        </h3>
<p id="section-4.2-1">An entity (an operator, a network node or a machine) provisions a
        SR P2MP policy by specifying the addresses of the root (R) and set of
        leaves {L} as well as Traffic Engineering (TE) attributes of Candidate
        paths via a suitable North-Bound API. The PCE computes the tree of
        Active candidate path. The PCE MAY compute P2MP trees for all
        Candidate paths., If tree computation is successful, PCE instantiates
        the P2MP tree(s) using Replication segments on Root, Replication, and
        Leaf nodes.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Candidate path constraints shall include link color affinity,
        bandwidth, disjointness (link, node, SRLG), delay bound, link loss,
        etc. Candidate path shall be optimized based on IGP or TE metric or
        link latency.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">The Tree SID of Candidate path of a SR P2MP policy can be either
        dynamically allocated by the PCE or statically assigned by entity
        provisioning the SR P2MP policy. Ideally, same Tree-SID SHOULD be used
        for Replication segments at Root, Replication, and Leaf nodes.
        Different Tree-SIDs MAY be used at Replication Node(s) if it is not
        feasible to use same Tree SID.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">A PCE can modify a P2MP tree following network element failure or
        in case a better path can be found based on the new network state. In
        this case, the PCE may want to setup the new instance of the tree and
        remove the old instance of the tree from the network in order to
        minimize traffic loss. In this case, the instances of trees for all
        the Candidate paths of a P2MP policy can be identified by an
        Instance-ID which is unique in context of the P2MP policy. As such,
        the identifier of non-shared Replication segments used to instantiate
        these trees becomes &lt;Root-ID, Tree-ID, Node-ID,
        Instance-ID&gt;.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">A PCE shall be capable of computing paths across multiple IGP areas
        or levels as well as Autonomous Systems (ASs).<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<section id="section-4.2.1">
          <h4 id="name-topology-discovery">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-topology-discovery" class="section-name selfRef">Topology Discovery</a>
          </h4>
<p id="section-4.2.1-1">A PCE shall learn network topology, TE attributes of link/node as
          well as SIDs via dynamic routing protocols (IGP and/or BGP-LS). It
          may be possible for entities to pass topology information to PCE via
          north-bound API.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.2">
          <h4 id="name-capability-and-attribute-di">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-capability-and-attribute-di" class="section-name selfRef">Capability and Attribute Discovery</a>
          </h4>
<p id="section-4.2.2-1">It shall be possible for a node to advertise SR P2MP tree
          capability via IGP and/or BGP-LS. Similarly, a PCE can also
          advertise its P2MP tree computation capability via IGP and/or
          BGP-LS. Capability advertisement allows a network node to
          dynamically choose one or more PCE(s) to obtain services pertaining
          to SR P2MP policies, as well a PCE to dynamically identify SR P2MP
          tree capable nodes.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4.3">
        <h3 id="name-instantiating-p2mp-tree-on-">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-instantiating-p2mp-tree-on-" class="section-name selfRef">Instantiating P2MP tree on nodes</a>
        </h3>
<p id="section-4.3-1">Once a PCE computes a P2MP tree for Candidate path of SR P2MP
        policy, it needs to instantiate the tree on the relevant network nodes
        via Replication segments. The PCE can use various protocols to program
        the Replication segments as described below.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<section id="section-4.3.1">
          <h4 id="name-pcep">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-pcep" class="section-name selfRef">PCEP</a>
          </h4>
<p id="section-4.3.1-1">PCE Protocol (PCEP)has been traditionally used:<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.3.1-2">
<li id="section-4.3.1-2.1">For a head-end to obtain paths from a PCE.<a href="#section-4.3.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.3.1-2.2">A PCE to instantiate SR policies.<a href="#section-4.3.1-2.2" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-4.3.1-3">PCEP protocol can be stateful in that a PCE can have a
          stateful control of an SR policy on a head-end which has delegated
          the control of the SR policy to the PCE. PCEP shall be extended to
          provision and maintain SR P2MP trees in a stateful fashion.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3.2">
          <h4 id="name-bgp">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-bgp" class="section-name selfRef">BGP</a>
          </h4>
<p id="section-4.3.2-1">BGP has been extended to instantiate and report SR policies. It
          shall be extended to instantiate and maintain P2MP trees for SR P2MP
          policies.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3.3">
          <h4 id="name-netconf">
<a href="#section-4.3.3" class="section-number selfRef">4.3.3. </a><a href="#name-netconf" class="section-name selfRef">NetConf</a>
          </h4>
<p id="section-4.3.3-1">TBD<a href="#section-4.3.3-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4.4">
        <h3 id="name-protection">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-protection" class="section-name selfRef">Protection</a>
        </h3>
<section id="section-4.4.1">
          <h4 id="name-local-protection">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-local-protection" class="section-name selfRef">Local Protection</a>
          </h4>
<p id="section-4.4.1-1">A network link, node or path on the tree of a P2MP tree can be
          protected using SR policies computed by PCE. The backup SR policies
          shall be programmed in forwarding plane in order to minimize traffic
          loss when the protected link/node fails. It is also possible to use
          node local Fast Re-Route protection mechanisms (LFA) to protect
          link/nodes of P2MP tree.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-4.4.2">
          <h4 id="name-path-protection">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-path-protection" class="section-name selfRef">Path Protection</a>
          </h4>
<p id="section-4.4.2-1">It is possible for PCE create a disjoint backup tree for
          providing end-to-end path protection.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">This document makes no request of IANA.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-6">
      <h2 id="name-security-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">There are no additional security risks introduced by this design.<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-7">
      <h2 id="name-acknowledgements">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-7-1">The authors would like to acknowledge Siva Sivabalan, Mike Koldychev
      and Vishnu Pavan Beeram for their valuable inputs..<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-contributors">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<p id="section-8-1"></p>
<p id="section-8-2">Clayton Hassen  Bell Canada  Vancouver  Canada<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Email: clayton.hassen@bell.ca<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">Kurtis Gillis  Bell Canada  Halifax  Canada<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">Email: kurtis.gillis@bell.ca<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">Arvind Venkateswaran  Cisco Systems, Inc.
       San Jose  US<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7">Email: arvvenka@cisco.com<a href="#section-8-7" class="pilcrow">¶</a></p>
<p id="section-8-8">Zafar Ali  Cisco Systems, Inc.  US<a href="#section-8-8" class="pilcrow">¶</a></p>
<p id="section-8-9">Email: zali@cisco.com<a href="#section-8-9" class="pilcrow">¶</a></p>
<p id="section-8-10">Swadesh Agrawal  Cisco Systems, Inc.  San Jose  US<a href="#section-8-10" class="pilcrow">¶</a></p>
<p id="section-8-11">Email: swaagraw@cisco.com<a href="#section-8-11" class="pilcrow">¶</a></p>
<p id="section-8-12">Jayant Kotalwar  Nokia  Mountain View  US<a href="#section-8-12" class="pilcrow">¶</a></p>
<p id="section-8-13">Email: jayant.kotalwar@nokia.com<a href="#section-8-13" class="pilcrow">¶</a></p>
<p id="section-8-14">Tanmoy Kundu  Nokia 
      Mountain View  US<a href="#section-8-14" class="pilcrow">¶</a></p>
<p id="section-8-15">Email: tanmoy.kundu@nokia.com<a href="#section-8-15" class="pilcrow">¶</a></p>
<p id="section-8-16">Andrew Stone  Nokia 
      Ottawa  Canada<a href="#section-8-16" class="pilcrow">¶</a></p>
<p id="section-8-17">Email: andrew.stone@nokia.com<a href="#section-8-17" class="pilcrow">¶</a></p>
<p id="section-8-18">Tarek Saad  Juniper Networks  Canada<a href="#section-8-18" class="pilcrow">¶</a></p>
<p id="section-8-19">Email:tsaad@juniper.net<a href="#section-8-19" class="pilcrow">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-spring-segment-routing-policy">[I-D.ietf-spring-segment-routing-policy]</dt>
        <dd>
<span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Talaulikar, K.</span>, <span class="refAuthor">Voyer, D.</span>, <span class="refAuthor">Bogdanov, A.</span>, and <span class="refAuthor">P. Mattes</span>, <span class="refTitle">"Segment Routing Policy Architecture"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-spring-segment-routing-policy-13</span>, <time datetime="2021-05-28" class="refDate">28 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-spring-segment-routing-policy-13.txt">https://www.ietf.org/archive/id/draft-ietf-spring-segment-routing-policy-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-spring-sr-replication-segment">[I-D.ietf-spring-sr-replication-segment]</dt>
        <dd>
<span class="refAuthor">(editor), D. V.</span>, <span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Parekh, R.</span>, <span class="refAuthor">Bidgoli, H.</span>, and <span class="refAuthor">Z. Zhang</span>, <span class="refTitle">"SR Replication Segment for Multi-point Service Delivery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-spring-sr-replication-segment-05</span>, <time datetime="2021-08-20" class="refDate">20 August 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-spring-sr-replication-segment-05.txt">https://www.ietf.org/archive/id/draft-ietf-spring-sr-replication-segment-05.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8402">[RFC8402]</dt>
      <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Previdi, S., Ed.</span>, <span class="refAuthor">Ginsberg, L.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Litkowski, S.</span>, and <span class="refAuthor">R. Shakir</span>, <span class="refTitle">"Segment Routing Architecture"</span>, <span class="seriesInfo">RFC 8402</span>, <span class="seriesInfo">DOI 10.17487/RFC8402</span>, <time datetime="2018-07" class="refDate">July 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8402">https://www.rfc-editor.org/info/rfc8402</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.filsfils-spring-srv6-net-pgm-illustration">[I-D.filsfils-spring-srv6-net-pgm-illustration]</dt>
        <dd>
<span class="refAuthor">Filsfils, C.</span>, <span class="refAuthor">Garvia, P. C.</span>, <span class="refAuthor">Li, Z.</span>, <span class="refAuthor">Matsushima, S.</span>, <span class="refAuthor">Decraene, B.</span>, <span class="refAuthor">Steinberg, D.</span>, <span class="refAuthor">Lebrun, D.</span>, <span class="refAuthor">Raszuk, R.</span>, and <span class="refAuthor">J. Leddy</span>, <span class="refTitle">"Illustrations for SRv6 Network Programming"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-filsfils-spring-srv6-net-pgm-illustration-04</span>, <time datetime="2021-03-30" class="refDate">30 March 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-filsfils-spring-srv6-net-pgm-illustration-04.txt">https://www.ietf.org/archive/id/draft-filsfils-spring-srv6-net-pgm-illustration-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-mvpn-evpn-aggregation-label">[I-D.ietf-bess-mvpn-evpn-aggregation-label]</dt>
        <dd>
<span class="refAuthor">Zhang, Z.</span>, <span class="refAuthor">Rosen, E.</span>, <span class="refAuthor">Lin, W.</span>, <span class="refAuthor">Li, Z.</span>, and <span class="refAuthor">I. Wijnands</span>, <span class="refTitle">"MVPN/EVPN Tunnel Aggregation with Common Labels"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-mvpn-evpn-aggregation-label-06</span>, <time datetime="2021-04-19" class="refDate">19 April 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-bess-mvpn-evpn-aggregation-label-06.txt">https://www.ietf.org/archive/id/draft-ietf-bess-mvpn-evpn-aggregation-label-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7900">[RFC7900]</dt>
        <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Rosen, E., Ed.</span>, <span class="refAuthor">Aggarwal, R.</span>, <span class="refAuthor">Cai, Y.</span>, and <span class="refAuthor">T. Morin</span>, <span class="refTitle">"Extranet Multicast in BGP/IP MPLS VPNs"</span>, <span class="seriesInfo">RFC 7900</span>, <span class="seriesInfo">DOI 10.17487/RFC7900</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7900">https://www.rfc-editor.org/info/rfc7900</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8986">[RFC8986]</dt>
      <dd>
<span class="refAuthor">Filsfils, C., Ed.</span>, <span class="refAuthor">Camarillo, P., Ed.</span>, <span class="refAuthor">Leddy, J.</span>, <span class="refAuthor">Voyer, D.</span>, <span class="refAuthor">Matsushima, S.</span>, and <span class="refAuthor">Z. Li</span>, <span class="refTitle">"Segment Routing over IPv6 (SRv6) Network Programming"</span>, <span class="seriesInfo">RFC 8986</span>, <span class="seriesInfo">DOI 10.17487/RFC8986</span>, <time datetime="2021-02" class="refDate">February 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8986">https://www.rfc-editor.org/info/rfc8986</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-illustration-of-sr-p2mp-pol">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-illustration-of-sr-p2mp-pol" class="section-name selfRef">Illustration of SR P2MP Policy and P2MP Tree</a>
      </h2>
<p id="appendix-A-1">Consider the following topology:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<span id="name-figure-1"></span><figure id="figure-2">
        <div class="artwork art-text alignLeft" id="appendix-A-2.1">
<pre>                               R3------R6
                         PCE--/         \
                      R1----R2----R5-----R7
                              \         /
                               +--R4---+</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-figure-1" class="selfRef">Figure 1</a>
        </figcaption></figure>
<p id="appendix-A-3">In these examples, the Node-SID of a node Rn is N-SIDn and
      Adjacency-SID from node Rm to node Rn is A-SIDmn. Interface between Rm
      and Rn is Lmn.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">For SRv6, the reader is expected to be familiar with SRv6 Network
      Programming <span>[<a href="#RFC8986" class="xref">RFC8986</a>]</span> to follow the examples. We use SID
      allocation scheme, reproduced below, from Illustrations for SRv6 Network
      Programming <span>[<a href="#I-D.filsfils-spring-srv6-net-pgm-illustration" class="xref">I-D.filsfils-spring-srv6-net-pgm-illustration</a>]</span><a href="#appendix-A-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-5.1">2001:db8::/32 is an IPv6 block allocated by a RIR to the
          operator<a href="#appendix-A-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.2">2001:db8:0::/48 is dedicated to the internal address space<a href="#appendix-A-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.3">2001:db8:cccc::/48 is dedicated to the internal SRv6 SID
          space<a href="#appendix-A-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.4">We assume a location expressed in 64 bits and a function
          expressed in 16 bits<a href="#appendix-A-5.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.5">Node k has a classic IPv6 loopback address 2001:db8::k/128 which
          is advertised in the IGP<a href="#appendix-A-5.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.6">Node k has 2001:db8:cccc:k::/64 for its local SID space. Its SIDs
          will be explicitly assigned from that block<a href="#appendix-A-5.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.7">Node k advertises 2001:db8:cccc:k::/64 in its IGP<a href="#appendix-A-5.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.8">Function :1:: (function 1, for short) represents the End function
          with PSP support<a href="#appendix-A-5.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.9">Function :Cn:: (function Cn, for short) represents the End.X
          function to Node n<a href="#appendix-A-5.9" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-5.10">Function :C1n: (function C1n for short) represents the End.X
          function to Node n with USD<a href="#appendix-A-5.10" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-6">Each node k has:<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-7.1">An explicit SID instantiation 2001:db8:cccc:k:1::/128 bound to an
          End function with additional support for PSP<a href="#appendix-A-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-7.2">An explicit SID instantiation 2001:db8:cccc:k:Cj::/128 bound to
          an End.X function to neighbor J with additional support for PSP<a href="#appendix-A-7.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-7.3">An explicit SID instantiation 2001:db8:cccc:k:C1j::/128 bound to
          an End.X function to neighbor J with additional support for USD<a href="#appendix-A-7.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-8">Assume PCE is provisioned following SR P2MP policy at Root R1 with
      Tree-ID T-ID:<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A-9">
<pre>SR P2MP Policy &lt;R1,T-ID&gt;:
 Leaf Nodes: {R2, R6, R7}
 Candidate-path 1:
   Optimize: IGP metric
   Tree-SID: T-SID1
</pre><a href="#appendix-A-9" class="pilcrow">¶</a>
</div>
<p id="appendix-A-10">The PCE is responsible for P2MP tree computation. Assume PCE
      instantiates P2MP trees by signalling non-shared Replication segments
      i.e. Replication-ID of these Replication segments is &lt;Root,
      Tree-ID&gt;. If a Candidate-path can have multiple instances of P2MP
      trees, the Replication-ID is &lt;Root, Tree-ID, Instance-ID&gt;. In this
      example, we assume one instance of P2MP tree for a candidate-path. All
      Replication segments use the Tree-SID T-SID1 as Replication-SID. For
      SRv6, assume the Replication SID at node k, bound to an End.Replcate
      function, is 2001:db8:cccc:k:FA::/128.<a href="#appendix-A-10" class="pilcrow">¶</a></p>
<section id="appendix-A.1">
        <h3 id="name-p2mp-tree-with-non-adjacent">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-p2mp-tree-with-non-adjacent" class="section-name selfRef">P2MP Tree with non-adjacent Replication Segments</a>
        </h3>
<p id="appendix-A.1-1">Assume PCE computes a P2MP tree with Root node R1, Intermediate and
        Leaf node R2, and Leaf nodes R6 and R7. The PCE instantiates the P2MP
        tree by stitching Replication segments at R1, R2, R6 and R7.
        Replication segment at R1 replicates to R2. Replication segment at R2
        replicates to R6 and R7. Note nodes R3, R4 and R5 do not have any
        Replication segment state for the tree.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<section id="appendix-A.1.1">
          <h4 id="name-sr-mpls">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-sr-mpls" class="section-name selfRef">SR-MPLS</a>
          </h4>
<p id="appendix-A.1.1-1">The Replication segment state at nodes R1, R2, R6 and R7 is shown
          below.<a href="#appendix-A.1.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-2">Replication segment at R1:<a href="#appendix-A.1.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.1.1-3">
<pre>Replication segment &lt;R1,T-ID,R1&gt;:
 Replication SID: T-SID1
 Replication State:
   R2: &lt;T-SID1-&gt;L12&gt;
</pre><a href="#appendix-A.1.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.1-4">Replication to R2 steers packet directly to the node on interface
          L12.<a href="#appendix-A.1.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-5">Replication segment at R2:<a href="#appendix-A.1.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.1.1-6">
<pre>Replication segment &lt;R1,T-ID,R2&gt;:
 Replication SID: T-SID1
 Replication State:
   R2: &lt;Leaf&gt;
   R6: &lt;N-SID6, T-SID1&gt;
   R7: &lt;N-SID7, T-SID1&gt;</pre><a href="#appendix-A.1.1-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.1-7">R2 is a Bud-Node. It performs role of Leaf as well as a transit
          node replicating to R6 and R7. Replication to R6, using N-SID6,
          steers packet via IGP shortest path to that node. Replication to R7,
          using N-SID7, steers packet via IGP shortest path to R7 via either
          R5 or R4 based on ECMP hashing.<a href="#appendix-A.1.1-7" class="pilcrow">¶</a></p>
<p id="appendix-A.1.1-8">Replication segment at R6:<a href="#appendix-A.1.1-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.1.1-9">
<pre>Replication segment &lt;R1,T-ID,R6&gt;:
 Replication SID: T-SID1
 Replication State:
   R6: &lt;Leaf&gt;</pre><a href="#appendix-A.1.1-9" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.1-10">Replication segment at R7:<a href="#appendix-A.1.1-10" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.1.1-11">
<pre>Replication segment &lt;R1,T-ID,R7&gt;:
 Replication SID: T-SID1
 Replication State:
   R7: &lt;Leaf&gt;</pre><a href="#appendix-A.1.1-11" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.1-12">When a packet is steered into the SR P2MP Policy at R1:<a href="#appendix-A.1.1-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1.1-13.1">Since R1 is directly connected to R2, R1 performs PUSH
              operation with just &lt;T-SID1&gt; label for the replicated copy
              and sends it to R2 on interface L12.<a href="#appendix-A.1.1-13.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.1.1-13.2">R2, as Leaf, performs NEXT operation, pops T-SID1 label and
              delivers the payload. For replication to R6, R2 performs a PUSH
              operation of N-SID6, to send &lt;N-SID6,T-SID1&gt; label stack
              to R3. R3 is the penultimate hop for N-SID6; it performs
              penultimate hop popping, which corresponds to the NEXT operation
              and the packet is then sent to R6 with &lt;T-SID1&gt; in the
              label stack. For replication to R7, R2 performs a PUSH operation
              of N-SID7, to send &lt;N-SID7,T-SID1&gt; label stack to R4, one
              of IGP ECMP nexthops towards R7. R4 is the penultimate hop for
              N-SID6; it performs penultimate hop popping, which corresponds
              to the NEXT operation and the packet is then sent to R7 with
              &lt;T-SID1&gt; in the label stack.<a href="#appendix-A.1.1-13.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.1.1-13.3">R6, as Leaf, performs NEXT operation, pops T-SID1 label and
              delivers the payload.<a href="#appendix-A.1.1-13.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.1.1-13.4">R7, as Leaf, performs NEXT operation, pops R-SID7 label and
              delivers the payload.<a href="#appendix-A.1.1-13.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
<section id="appendix-A.1.2">
          <h4 id="name-srv6">
<a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-srv6" class="section-name selfRef">SRv6</a>
          </h4>
<p id="appendix-A.1.2-1">For SRv6, the replicated packet from R2 to R7 has to traverse R4
          using a SR-TE policy, Policy27. The policy has one SID in segment
          list: End.X function with USD of R4 to R7 . The Replication segment
          state at nodes R1, R2, R6 and R7 is shown below.<a href="#appendix-A.1.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.1.2-2">
<pre>Policy27: &lt;2001:db8:cccc:4:C17::&gt;
</pre><a href="#appendix-A.1.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.2-3">Replication segment at R1:<a href="#appendix-A.1.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.1.2-4">
<pre>Replication segment &lt;R1,T-ID,R1&gt;:
 Replication SID: 2001:db8:cccc:1:FA::
 Replication State:
   R2: &lt;2001:db8:cccc:2:FA::-&gt;L12&gt;
</pre><a href="#appendix-A.1.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.2-5">Replication to R2 steers packet directly to the node on interface
          L12.<a href="#appendix-A.1.2-5" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-6">Replication segment at R2:<a href="#appendix-A.1.2-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.1.2-7">
<pre>Replication segment &lt;R1,T-ID,R2&gt;:
 Replication SID: 2001:db8:cccc:2:FA::
 Replication State:
   R2: &lt;Leaf&gt;
   R6: &lt;2001:db8:cccc:6:FA::&gt;
   R7: &lt;2001:db8:cccc:7:FA:: -&gt; Policy27&gt;</pre><a href="#appendix-A.1.2-7" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.2-8">R2 is a Bud-Node. It performs role of Leaf as well as a transit
          node replicating to R6 and R7. Replication to R6, steers packet via
          IGP shortest path to that node. Replication to R7, via SR-TE policy,
          first encapsulates the packet using H.Encaps and then steers the
          outer packet to R4. End.X USD on R4 decapsulates outer header and
          sends the original inner packet to R7.<a href="#appendix-A.1.2-8" class="pilcrow">¶</a></p>
<p id="appendix-A.1.2-9">Replication segment at R6:<a href="#appendix-A.1.2-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.1.2-10">
<pre>Replication segment &lt;R1,T-ID,R6&gt;:
 Replication SID: 2001:db8:cccc:6:FA::
 Replication State:
   R6: &lt;Leaf&gt;</pre><a href="#appendix-A.1.2-10" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.2-11">Replication segment at R7:<a href="#appendix-A.1.2-11" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.1.2-12">
<pre>Replication segment &lt;R1,T-ID,R7&gt;:
 Replication SID: 2001:db8:cccc:7:FA::
 Replication State:
   R7: &lt;Leaf&gt;</pre><a href="#appendix-A.1.2-12" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1.2-13">When a packet (A,B2) is steered into the SR P2MP Policy at R1
          using H.Encaps.Replicate behavior:<a href="#appendix-A.1.2-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.1.2-14.1">Since R1 is directly connected to R2, R1 sends replicated
              copy (2001:db8::1, 2001:db8:cccc:2:FA::) (A,B2) to R2 on
              interface L12.<a href="#appendix-A.1.2-14.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.1.2-14.2">R2, as Leaf removes outer IPv6 header and delivers the
              payload. R2, as a bud node, also replicates the packet.<a href="#appendix-A.1.2-14.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.1.2-14.3">
              <ul class="normal">
<li class="normal" id="appendix-A.1.2-14.3.1.1">For replication to R6, R2 sends (2001:db8::1,
                  2001:db8:cccc:6:FA::) (A,B2) to R3. R3 forwards the packet
                  using 2001:db8:cccc:6::/64 packet to R6.<a href="#appendix-A.1.2-14.3.1.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="appendix-A.1.2-14.3.1.2">For replication to R7 using Policy27, R2 encapsulates and
                  sends (2001:db8::2, 2001:db8:cccc:4:C17::) (2001:db8::1,
                  2001:db8:cccc:7:FA::) (A,B2) to R4. R4 performs End.X USD
                  behavior, decapsulates outer IPv6 header and sends
                  (2001:db8::1, 2001:db8:cccc:7:FA::) (A,B2) to R7.<a href="#appendix-A.1.2-14.3.1.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="appendix-A.1.2-14.4">R6, as Leaf, removes outer IPv6 header and delivers the
              payload.<a href="#appendix-A.1.2-14.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.1.2-14.5">R7, as Leaf, removes outer IPv6 header and delivers the
              payload.<a href="#appendix-A.1.2-14.5" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</section>
<section id="appendix-A.2">
        <h3 id="name-p2mp-tree-with-adjacent-rep">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-p2mp-tree-with-adjacent-rep" class="section-name selfRef">P2MP Tree with adjacent Replication Segments</a>
        </h3>
<p id="appendix-A.2-1">Assume PCE computes a P2MP tree with Root node R1, Intermediate and
        Leaf node R2, Intermediate nodes R3 and R5, and Leaf nodes R6 and R7.
        The PCE instantiates the P2MP tree by stitching Replication segments
        at R1, R2, R3, R5, R6 and R7. Replication segment at R1 replicates to
        R2. Replication segment at R2 replicates to R3 and R5. Replication
        segment at R3 replicates to R6. Replication segment at R5 replicates
        to R7. Note node R4 does not have any Replication segment state for
        the tree.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<section id="appendix-A.2.1">
          <h4 id="name-sr-mpls-2">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-sr-mpls-2" class="section-name selfRef">SR-MPLS</a>
          </h4>
<p id="appendix-A.2.1-1">The Replication segment state at nodes R1, R2, R3, R5, R6 and R7
          is shown below.<a href="#appendix-A.2.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.1-2">Replication segment at R1:<a href="#appendix-A.2.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.1-3">
<pre>Replication segment &lt;R1,T-ID,R1&gt;:
 Replication SID: T-SID1
 Replication State:
   R2: &lt;T-SID1-&gt;L12&gt;
</pre><a href="#appendix-A.2.1-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.1-4">Replication to R2 steers packet directly to the node on interface
          L12.<a href="#appendix-A.2.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2.1-5">Replication segment at R2:<a href="#appendix-A.2.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.1-6">
<pre>Replication segment &lt;R1,T-ID,R2&gt;:
 Replication SID: T-SID1
 Replication State:
   R2: &lt;Leaf&gt;
   R3: &lt;T-SID1-&gt;L23&gt;
   R5: &lt;T-SID1-&gt;L25&gt;</pre><a href="#appendix-A.2.1-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.1-7">R2 is a Bud-Node. It performs role of Leaf as well as a transit
          node replicating to R3 and R5. Replication to R3, steers packet
          directly to the node on L23. Replication to R5, steers packet
          directly to the node on L25.<a href="#appendix-A.2.1-7" class="pilcrow">¶</a></p>
<p id="appendix-A.2.1-8">Replication segment at R3:<a href="#appendix-A.2.1-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.1-9">
<pre>Replication segment &lt;R1,T-ID,R3&gt;:
 Replication SID: T-SID1
 Replication State:
   R6: &lt;T-SID1-&gt;L36&gt;
</pre><a href="#appendix-A.2.1-9" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.1-10">Replication to R6, steers packet directly to the node on L36.<a href="#appendix-A.2.1-10" class="pilcrow">¶</a></p>
<p id="appendix-A.2.1-11">Replication segment at R5:<a href="#appendix-A.2.1-11" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.1-12">
<pre>Replication segment &lt;R1,T-ID,R5&gt;:
 Replication SID: T-SID1
 Replication State:
   R7: &lt;T-SID1-&gt;L57&gt;
</pre><a href="#appendix-A.2.1-12" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.1-13">Replication to R7, steers packet directly to the node on L57.<a href="#appendix-A.2.1-13" class="pilcrow">¶</a></p>
<p id="appendix-A.2.1-14">Replication segment at R6:<a href="#appendix-A.2.1-14" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.1-15">
<pre>Replication segment &lt;R1,T-ID,R6&gt;:
 Replication SID: T-SID1
 Replication State:
   R6: &lt;Leaf&gt;</pre><a href="#appendix-A.2.1-15" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.1-16">Replication segment at R7:<a href="#appendix-A.2.1-16" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.1-17">
<pre>Replication segment &lt;R1,T-ID,R7&gt;:
 Replication SID: T-SID1
 Replication State:
   R7: &lt;Leaf&gt;</pre><a href="#appendix-A.2.1-17" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.1-18">When a packet is steered into the SR P2MP Policy at R1:<a href="#appendix-A.2.1-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.1-19.1">Since R1 is directly connected to R2, R1 performs PUSH
              operation with just &lt;T-SID1&gt; label for the replicated copy
              and sends it to R2 on interface L12.<a href="#appendix-A.2.1-19.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-19.2">R2, as Leaf, performs NEXT operation, pops T-SID1 label and
              delivers the payload. It also performs PUSH operation on T-SID1
              for replication to R3 and R5. For replication to R6, R2 sends
              &lt;T-SID1&gt; label stack to R3 on interface L23. For
              replication to R5, R2 sends &lt;T-SID1&gt; label stack to R5 on
              interface L25.<a href="#appendix-A.2.1-19.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-19.3">R3 performs NEXT operation on T-SID1 and performs a PUSH
              operation for replication to R6 and sends &lt;T-SID1&gt; label
              stack to R6 on interface L36.<a href="#appendix-A.2.1-19.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-19.4">R5 performs NEXT operation on T-SID1 and performs a PUSH
              operation for replication to R7 and sends &lt;T-SID1&gt; label
              stack to R7 on interface L57.<a href="#appendix-A.2.1-19.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-19.5">R6, as Leaf, performs NEXT operation, pops T-SID1 label and
              delivers the payload.<a href="#appendix-A.2.1-19.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-19.6">R7, as Leaf, performs NEXT operation, pops R-SID7 label and
              delivers the payload.<a href="#appendix-A.2.1-19.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
<section id="appendix-A.2.2">
          <h4 id="name-srv6-2">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-srv6-2" class="section-name selfRef">SRv6</a>
          </h4>
<p id="appendix-A.2.2-1">The Replication segment state at nodes R1, R2, R3, R5, R6 and R7
          is shown below.<a href="#appendix-A.2.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-2">Replication segment at R1:<a href="#appendix-A.2.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.2-3">
<pre>Replication segment &lt;R1,T-ID,R1&gt;:
 Replication SID: 2001:db8:cccc:1:FA::
 Replication State:
   R2: &lt;2001:db8:cccc:2:FA::-&gt;L12&gt;
</pre><a href="#appendix-A.2.2-3" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-4">Replication to R2 steers packet directly to the node on interface
          L12.<a href="#appendix-A.2.2-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-5">Replication segment at R2:<a href="#appendix-A.2.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.2-6">
<pre>Replication segment &lt;R1,T-ID,R2&gt;:
 Replication SID: 2001:db8:cccc:2:FA::
 Replication State:
   R2: &lt;Leaf&gt;
   R3: &lt;2001:db8:cccc:3:FA::-&gt;L23&gt;
   R5: &lt;2001:db8:cccc:5:FA::-&gt;L25&gt;</pre><a href="#appendix-A.2.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-7">R2 is a Bud-Node. It performs role of Leaf as well as a transit
          node replicating to R3 and R5. Replication to R3, steers packet
          directly to the node on L23. Replication to R5, steers packet
          directly to the node on L25.<a href="#appendix-A.2.2-7" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-8">Replication segment at R3:<a href="#appendix-A.2.2-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.2-9">
<pre>Replication segment &lt;R1,T-ID,R3&gt;:
 Replication SID: 2001:db8:cccc:3:FA::
 Replication State:
   R6: &lt;2001:db8:cccc:6:FA::-&gt;L36&gt;
</pre><a href="#appendix-A.2.2-9" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-10">Replication to R6, steers packet directly to the node on L36.<a href="#appendix-A.2.2-10" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-11">Replication segment at R5:<a href="#appendix-A.2.2-11" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.2-12">
<pre>Replication segment &lt;R1,T-ID,R5&gt;:
 Replication SID: 2001:db8:cccc:5:FA::
 Replication State:
   R7: &lt;2001:db8:cccc:7:FA::-&gt;L57&gt;
</pre><a href="#appendix-A.2.2-12" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-13">Replication to R7, steers packet directly to the node on L57.<a href="#appendix-A.2.2-13" class="pilcrow">¶</a></p>
<p id="appendix-A.2.2-14">Replication segment at R6:<a href="#appendix-A.2.2-14" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.2-15">
<pre>Replication segment &lt;R1,T-ID,R6&gt;:
 Replication SID: 2001:db8:cccc:6:FA::
 Replication State:
   R6: &lt;Leaf&gt;</pre><a href="#appendix-A.2.2-15" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-16">Replication segment at R7:<a href="#appendix-A.2.2-16" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-A.2.2-17">
<pre>Replication segment &lt;R1,T-ID,R7&gt;:
 Replication SID: 2001:db8:cccc:7:FA::
 Replication State:
   R7: &lt;Leaf&gt;</pre><a href="#appendix-A.2.2-17" class="pilcrow">¶</a>
</div>
<p id="appendix-A.2.2-18">When a packet (A,B2) is steered into the SR P2MP Policy at R1
          using H.Encaps.Replicate behavior:<a href="#appendix-A.2.2-18" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.2-19.1">Since R1 is directly connected to R2, R1 sends replicated
              copy (2001:db8::1, 2001:db8:cccc:2:FA::) (A,B2) to R2 on
              interface L12.<a href="#appendix-A.2.2-19.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.2-19.2">R2, as Leaf, removes outer IPv6 header and delivers the
              payload. R2, as a bud node, also replicates the packet. For
              replication to R3, R2 sends (2001:db8::1, 2001:db8:cccc:3:FA::)
              (A,B2) to R3 on interface L23. For replication to R5, R2 sends
              (2001:db8::1, 2001:db8:cccc:5:FA::) (A,B2) to R5 on interface
              L25.<a href="#appendix-A.2.2-19.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.2-19.3">R3 replicates and sends (2001:db8::1, 2001:db8:cccc:6:FA::)
              (A,B2) to R6 on interface L36.<a href="#appendix-A.2.2-19.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.2-19.4">R5 replicates and sends (2001:db8::1, 2001:db8:cccc:7:FA::)
              (A,B2) to R7 on interface L57.<a href="#appendix-A.2.2-19.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.2-19.5">R6, as Leaf, removes outer IPv6 header and delivers the
              payload.<a href="#appendix-A.2.2-19.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-A.2.2-19.6">R7, as Leaf, removes outer IPv6 header and delivers the
              payload.<a href="#appendix-A.2.2-19.6" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Voyer (editor)</span></div>
<div dir="auto" class="left"><span class="org">Bell Canada</span></div>
<div dir="auto" class="left">
<span class="locality">Montreal</span>  </div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:daniel.voyer@bell.ca" class="email">daniel.voyer@bell.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Clarence Filsfils</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div dir="auto" class="left"><span class="locality">Brussels</span></div>
<div dir="auto" class="left"><span class="country-name">Belgium</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:cfilsfil@cisco.com" class="email">cfilsfil@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rishabh Parekh</span></div>
<div dir="auto" class="left"><span class="org">Cisco Systems, Inc.</span></div>
<div dir="auto" class="left">
<span class="locality">San Jose</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:riparekh@cisco.com" class="email">riparekh@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hooman Bidgoli</span></div>
<div dir="auto" class="left"><span class="org">Nokia</span></div>
<div dir="auto" class="left">
<span class="locality">Ottawa</span>  </div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hooman.bidgoli@nokia.com" class="email">hooman.bidgoli@nokia.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Zhaohui Zhang</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:zzhang@juniper.net" class="email">zzhang@juniper.net</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
