Pub = scalar-op(priv, G)

secret = F(scalar-op(priv, PubPeer))

sig = Sign-Alice(cKEY | InitA | InitB)

sig = Sign-Bob(cKEY | InitB | InitA)

base = H(PSK | counter)

seed = KDF(base, "IKE PSK Hunting and Pecking")

found = 0
counter = 1
base = H(psk | counter)
seed = KDF(seed, "IKE PSK Hunting And Pecking")
x = seed
y = sqrt(x^3 + ax + b)
SKE = (x,y)
SKE = (x, p-y)
found = 1
counter = counter + 1
found = 0
counter = 1
base = H(psk | counter)
seed = KDF(base, "IKE SKE Hunting And Pecking")
SKE = seed ^ ((p-1)/r) mod p
found = 1
counter = counter + 1
scalar = (private + mask) mod q

Element = inverse(scalar-op(mask, SKE))

secret = F(scalar-op(private,
                            element-op(PeerElement,
                                       scalar-op(peerscalar, SKE))))

mac = HMAC-Hash(cKEY, InitA | InitB)

mac = HMAC-Hash(cKEY, InitB | InitA)

key = KDF(dKEY, "IPsec Key Derivation")

wait = (thresh - retrans) * retrans-period

