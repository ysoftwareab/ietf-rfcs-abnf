<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>QuicR - Media Delivery Protocol over QUIC</title>
<meta content="Cullen Jennings" name="author">
<meta content="Suhas Nandakumar" name="author">
<meta content="
       This specification outlines the design for a media delivery protocol
over QUIC. It aims at supporting multiple application classes with
varying latency requirements including ultra low latency applications
such as interactive communication and gaming. It is based on a
publish/subscribe metaphor where entities publish and subscribe to data
that is sent through, and received from, relays in the cloud. The
information subscribed to is named such that this forms an overlay
information centric network.  The relays allow for efficient large scale
deployments. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="realtime" name="keyword">
<meta content="quicr" name="keyword">
<meta content="draft-jennings-moq-quicr-arch-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-jennings-moq-quicr-architecture-ro0_s9q4.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">quicr</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Jennings &amp; Nandakumar</td>
<td class="center">Expires 5 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-jennings-moq-quicr-arch-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-04" class="published">4 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-05">5 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Jennings</div>
<div class="org">cisco</div>
</div>
<div class="author">
      <div class="author-name">S. Nandakumar</div>
<div class="org">Cisco</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">QuicR - Media Delivery Protocol over QUIC</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This specification outlines the design for a media delivery protocol
over QUIC. It aims at supporting multiple application classes with
varying latency requirements including ultra low latency applications
such as interactive communication and gaming. It is based on a
publish/subscribe metaphor where entities publish and subscribe to data
that is sent through, and received from, relays in the cloud. The
information subscribed to is named such that this forms an overlay
information centric network.  The relays allow for efficient large scale
deployments.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-2">
<a href="#name-status-of-this-memo-2" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-2">
<a href="#name-copyright-notice-2" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-2">
<a href="#name-table-of-contents-2" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-2" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-quicr" class="xref">QuicR</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-contributing" class="xref">Contributing</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-terminology-2" class="xref">Terminology</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-advantages-of-quicr" class="xref">Advantages of QuicR</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-quicr-architecture" class="xref">QuicR architecture</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-quicr-delivery-network-arch" class="xref">QuicR Delivery Network Architecture with Origin as the only Relay Function.</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-quicr-delivery-network-archi" class="xref">QuicR Delivery Network Architecture</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-names-and-named-objects" class="xref">Names and Named Objects</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-objects-groups" class="xref">Objects Groups</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-named-objects" class="xref">Named Objects</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-name-hashes" class="xref">Name Hashes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-wildcarding-with-names" class="xref">Wildcarding with Names</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-objects" class="xref">Objects</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-relays" class="xref">Relays</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-quicr-usage-design-patterns" class="xref">QuicR Usage Design Patterns</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-quicr-manifest-objects" class="xref">QuicR Manifest Objects</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-quicr-video-objects" class="xref">QuicR Video Objects</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="xref">9.2.1</a>.  <a href="#name-rush-over-quicr" class="xref">RUSH over QuicR</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.2">
                    <p id="section-toc.1-1.9.2.2.2.2.1"><a href="#section-9.2.2" class="xref">9.2.2</a>.  <a href="#name-warp-over-quicr" class="xref">Warp over QuicR</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-quicr-audio-objects" class="xref">QuicR Audio Objects</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-quicr-game-moves-objects" class="xref">QuicR Game Moves Objects</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="xref">9.5</a>.  <a href="#name-messaging-objects" class="xref">Messaging Objects</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations-2" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-protocol-design-considerati" class="xref">Protocol Design Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-http-3" class="xref">HTTP/3</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-quic-streams-and-datagrams" class="xref">QUIC Streams and Datagrams</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-quic-congestion-control" class="xref">QUIC Congestion Control</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="xref">11.4</a>.  <a href="#name-why-not-rtp" class="xref">Why not RTP</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses-2" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction-2">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Recently new usecases have emerged requiring higher scalability of
delivery for interactive realtime applications and much lower latency
for streaming applications and a combination thereof. On one side are
usecases such as normal web conferences wanting to distribute out to
millions of viewers and allow viewers to instantly move to
being a presenter. On the other side are usescases such as streaming a
soccer game to millions of people including people in the stadium
watching the game live. Viewers watching an e-sports event want to be
able to comment with mininal latency to ensure the interactivity aspects
between what different viewers are seeing is preserved. All of these usescases
push towards latencies that are in the order of 100ms over the
natural latency the network causes.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Interactive realtime applications, such as web conferencing systems,
require ultra low latency (&lt; 150ms). Such applications create their own
application specific delivery network over which latency requirements
can be met. Realtime transport protocols such as RTP over UDP provide
the basic elements needed for realtime communication, both contribution and
distribution, while leaving aspects such as resiliency and congestion
control to be provided by each application. On the other hand, media
streaming applications are much more tolerant to latency and require
highly scalable media distribution. Such applications leverage existing
CDN networks, used for optimizing web delivery, to distribute media.
Streaming protocols such as HLS and MPEG-DASH operates on top of HTTP and
gets transport-level resiliency and congestion control provided by TCP.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document outlines, QuicR, a unified architecture and protocol for
data delivery that enables a wide range of realtime applications with
different resiliency and latency needs without compromising the scalability
and cost effectiveness associated with content delivery networks.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="quicr">
<section id="section-1.1">
        <h3 id="name-quicr">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-quicr" class="section-name selfRef">QuicR</a>
        </h3>
<p id="section-1.1-1">The architecture defines and uses QuicR, a delivery
protocol that is based on a publish/subscribe metaphor where client
endpoints publish and subscribe to named objects that is sent to, and
received from relays, that forms an overlay delivery network similar to
what CDN provides today. The subscribe messages allow subscription to a
name that includes a wildcard to match multiple published names, so a
single subscribe can allow a client to receive publishes for a wide class
of named objects. Objects are named such that it is unique for the
relay/delivery network and scoped to an application.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">QuicrR provides services based on application requirements
(with the support of underlying transport, where necessary)
such as estimation of available bandwidth, fragmentation and
reassembly, resiliency, congestion control and prioritization of
data delivery based on data lifetime and importance of data. It is
designed to be NAT and firewall traversal friendly and can be fronted
with load balancers.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">The Relays are arranged in a logical tree (as shown below) where,
for a given application, there is an origin Relay at root of the tree
that controls the namespace. Publish messages are sent towards the
root of the tree and down the path of any subscribers to that
named object. QuicR is designed to make it easy to implement relays
so that fail over could happen between relays with minimal impact to
the clients and relays can redirect a client to a different relay.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<span id="name-quicr-delivery-tree"></span><figure id="figure-1">
          <div id="section-1.1-4.1">
<pre class="lang-ascii-art sourcecode">              ┌────────────┐
              │            │
              │            ▼
              │       ┌────────┐
              │   ▬ ▬▶│Relay-0 │ ◀▬▬ ▬▬ ▬▮
          pub │  ▮    │ Origin ├┐        ▮
              │  ▮    └────────┘│        ▮
              │  ▮ sub          │        ▮ sub
              │  ▮          pub │        ▮
              │  ▮              │        ▮
         ┌───────▮┐ ◀▬▮         │  ┌─────▮──┐
     ┌──▶│ Relay-1│   ▮         └─▶│ Relay-2│◀▮▮
     │   └─────┬──┘   ▮             ▲──┬────┤  ▮
 pub │         │      ▮ sub     sub ▮  │    │  ▮ sub
     │      pub│      ▮             ▮  │pub ▼  ▮
    ┌┴─────┐   │ ┌────▮─┐     ┌─────▮┐ │   ┌───▮──┐
    │Alice │   └▶│ Bob  │     │ Carl │◀┘   │Derek │
    └──────┘     └──────┘     └──────┘     └──────┘
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-quicr-delivery-tree" class="selfRef">QuicR Delivery Tree</a>
          </figcaption></figure>
<p id="section-1.1-5">The design supports sending media and other named objects between a set
of participants in a game or video call with under a hundred
milliseconds of latency and meets the needs of conferencing
systems. The design can also be used for large scale streaming to
millions of participants with latency ranging from a few seconds to
under a hundred milliseconds based on applications needs. It can
also be used as low latency publish/subscribe system for real time
systems such as messaging, gaming, and IoT.<a href="#section-1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="contributing">
<section id="section-2">
      <h2 id="name-contributing">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-contributing" class="section-name selfRef">Contributing</a>
      </h2>
<p id="section-2-1">All significant discussion of development of this protocol is in the
GitHub issue tracker at: <code>
https://github.com/fluffy/draft-jennings-moq-arch</code><a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">QuicR is pronounced something close to
<span class="unicode">“ (U+201C)</span>quicker<span class="unicode">” (U+201D)</span> but with more of a pirate "arrrr" at the end.<a href="#section-2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-3">
      <h2 id="name-terminology-2">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-terminology-2" class="section-name selfRef">Terminology</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-3-1.1">
          <p id="section-3-1.1.1">Relay Function: Functionality of the QuicR architecture, that
implements store and forward behavior at the minimum. Such a function
typically receives subscriptions and publishes data to the other
endpoints that have subscribed to the named data. Such functions may
cache the data as well for optimizing the delivery experience.<a href="#section-3-1.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-1.2">
          <p id="section-3-1.2.1">Relay: Server component (physical/logical) in the cloud that
implements the Relay Function.<a href="#section-3-1.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-1.3">
          <p id="section-3-1.3.1">Publisher: An endpoint that sends named objects to a
Relay. [ also referred to as producer of the named object]<a href="#section-3-1.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-1.4">
          <p id="section-3-1.4.1">Subscriber: An endpoint that subscribes and receives the named
objects. Relays can act as subscribers to other relays. Subscribers
can also be referred to as consumers.<a href="#section-3-1.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-1.5">
          <p id="section-3-1.5.1">Client/QuicR Client: An endpoint that acts as a Publisher, Subscriber,
or both. May also implement a Relay Function in certain contexts.<a href="#section-3-1.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-1.6">
          <p id="section-3-1.6.1">Named Object: Application level chunk of Data that has a unique Name,
a limited lifetime, priority and is transported via QuicR protocol.<a href="#section-3-1.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-1.7">
          <p id="section-3-1.7.1">Origin server: Component managing the QuicR namespace for a specific
application and is responsible for establishing trust between clients
and relays. Origin servers can implement other QuicR functions.<a href="#section-3-1.7.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="advantages-of-quicr">
<section id="section-4">
      <h2 id="name-advantages-of-quicr">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-advantages-of-quicr" class="section-name selfRef">Advantages of QuicR</a>
      </h2>
<p id="section-4-1">As its evident, QuicR and its architecture uses similar concepts and
delivery mechanisms to those used by streaming standards such as HLS and
MPEG-DASH. Specifically the use of a CDN-like delivery network, the use
of named objects and the receiver-triggered media/data delivery. However
there are fundamental characteristics that QuicR provides to enable
ultra low latency delivery for interactive applications such as
conferencing and gaming.<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">
          <p id="section-4-2.1.1">To support low latency the granularity of the delivered objects, in
terms of time duration, need to be quite small making it complicated
for clients to request each object individually. QuicR uses a publish
and subscription semantic along with a wildcard name to simplify and
speed object delivery for low latency applications. For latency-tolerant applications, larger granularity of data, aka group of objects, can be
individually requested and delivered without instantiating state in
the backend.<a href="#section-4-2.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.2">
          <p id="section-4-2.2.1">Some realtime applications operating in ultra low latency mode
require objects delivered as and when they are available without
having to wait for previous objects delayed due to network loss
or out of order network delivery. QuicR supports
Quic datagrams based object delivery for this purpose. Note that
QuicR also uses Quic stream for delivery of objects that are latency-tolerant.<a href="#section-4-2.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.3">
          <p id="section-4-2.3.1">QuicR supports resiliency mechanisms that are more suitable for
realtime delivery such as FEC and selective retransmission.<a href="#section-4-2.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.4">
          <p id="section-4-2.4.1">QUIC's current congestion control algorithms need to be evaluated for
efficacy in low latency interactive real-time contexts, specifically mechanisms such as slow start, multiplicative
decrease and queue buildup drainage during BBR probing. Based on the results of the evaluation work, QuicR can
select the congestion control algorithm suitable for the application's
class.<a href="#section-4-2.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.5">
          <p id="section-4-2.5.1">Published objects in QuicR have associated max-age that specifies the
validity of such objects. max-age influences relay's drop decisions
and can also be used by the underlying QUIC transport to cease retransmissions
associated with the named object.<a href="#section-4-2.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.6">
          <p id="section-4-2.6.1">Unlike streaming architectures where media contribution and media
distribution are treated differently, QuicR can be used for both
object contribution/publishing and distribution/subscribing as the
split does not exist for interactive communications.<a href="#section-4-2.6.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.7">
          <p id="section-4-2.7.1">QuicR supports "aggregation of subscriptions" to the named objects
where the subscriptions are aggregated at the relay functions and
allows "short-circuited" delivery of published objects when there is a
match at a given relay function.<a href="#section-4-2.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.8">
          <p id="section-4-2.8.1">QuicR allows publishers to associate a priority with
objects. Priorities can help the delivery network and the subscribers
to make decisions about resiliency, latency, drops etc. Priorities can
used to set relative importance between different qualities for
layered video encoding, for example.<a href="#section-4-2.8.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-4-2.9">
          <p id="section-4-2.9.1">QuicR is designed so that objects are encrypted end-to-end and will
pass transparently through the delivery network. Any information
required by the delivery network, e.g priorities, will be included as
part of the metadata that is accessible to the delivery network for
further processing as appropriate.<a href="#section-4-2.9.1" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="quicr-architecture">
<section id="section-5">
      <h2 id="name-quicr-architecture">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-quicr-architecture" class="section-name selfRef">QuicR architecture</a>
      </h2>
<p id="section-5-1">A typical media delivery architecture based on QuicR enables
delivery tree allowing :<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">Publishing entities to publish named data<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-2.2">Subscribers to express interest in the named objects<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-2.3">Delivery tree made up of one or more Relays to allow the flow of the named objects.<a href="#section-5-2.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-5-3">In the following subsections, 2 common QuicR delivery tree architectures are
non-normatively discussed<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="quicr-delivery-network-architecture-with-origin-as-the-only-relay-function">
<section id="section-5.1">
        <h3 id="name-quicr-delivery-network-arch">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-quicr-delivery-network-arch" class="section-name selfRef">QuicR Delivery Network Architecture with Origin as the only Relay Function.</a>
        </h3>
<div id="section-5.1-1">
<pre class="lang-ascii-art sourcecode">                       +-------------+
                       |Relay        |
    +----------------&gt; |Origin:tw.com|-----+
    |                  +-------------+     |
    |                                ^     |
    |pub:tw.com/ch22/3/1             |     |
    |                                |     |
    |               sub:tw.com/ch22/*|     |
    |                                |     |pub:tw.com/ch22/3/1
    |                                |     v
+-----------+                      +----------+
| Publisher |                      |Subscriber|
+-----------+                      +----------+
</pre><a href="#section-5.1-1" class="pilcrow">¶</a>
</div>
<p id="section-5.1-2">The above picture shows QuicR delivery network for an hypothetical
streaming architecture rooted at the Origin Relay (for the domain
tw.com). In this architecture, the media contribution is done by
publishing named objects corresponding to channel-22 to the ingest
server at the Origin Relay. Media consumption happens via
subscribes sent to the Origin Relay to the wildcarded name (ch22/*)
for all media streams happening over the named channel-22.
The media published either by the source publisher or the
Relay (as Publisher) might be encoded into multiple qualities.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quicr-delivery-network-architecture">
<section id="section-5.2">
        <h3 id="name-quicr-delivery-network-archi">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-quicr-delivery-network-archi" class="section-name selfRef">QuicR Delivery Network Architecture</a>
        </h3>
<div id="section-5.2-1">
<pre class="lang-ascii-art sourcecode">                  +--------+
           +----&gt; |Realay-O| &lt;----------------+
           |      +--------+                  |
           |       ^       |                  |sub:alice-low
 pub:alice-hi      |       pub:alice-hi       |sub:alice-hi
 pub:alice-low     |       pub:alice-low      |
           | sub:alice-low |                  |
           |       |       |                  |
          +---------+      |  +------------------------+
  +------&gt;| Relay-A |      +-&gt;|    Relay-B             |
  |       +---------+         +------------------------+
  |           |  ^              |    ^          |    ^
 pub1:alice-hi|  |              |    |          |    |
 pub2:alice-low  |              |    |          |    |
  |           |  |              |    |          |    |
  |          pub:alice-low     pub:alice-hi,low pub:alice-hi,low
  |           |  |              |    |          |    |
  |           | sub:alice-low   |   sub:alice*  |   sub:alice*
  |           v  |              v    |          v    |
  +------+    +---+              +----+         +-----+
  | Alice|    |Bob|              |Carl|         |Derek|
  +------+    +---+              +----+         +-----+
</pre><a href="#section-5.2-1" class="pilcrow">¶</a>
</div>
<p id="section-5.2-2">The above picture shows QuicR media delivery tree
formed with multiple relays in the network.
The example  has 4 participants with Alice
being the publisher and rest being the subscribers.
Alice's is capable of publishing video streams at 2 qualities identified
by their appropriate names. Bob subscribes to a low resolution
video feed from alice, where as Carl/Derek carryout wildcard
subscribes to all the qualities of video feed published by Alice.
All the subscribes are sent to the Origin Relay and are
saved at the on-path Relays, this allowing for "short-circuited"
delivery of published data at the relays. In the above example,
Bob gets Alice's published data directly from Relay-A instead
of hairpinning from the Origin Relay. Carl and Derek, however
get their video stream relayed from Alice via Origin Relay
and Relay-B.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="names-and-named-objects">
<section id="section-6">
      <h2 id="name-names-and-named-objects">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-names-and-named-objects" class="section-name selfRef">Names and Named Objects</a>
      </h2>
<p id="section-6-1">Names are basic elements with in the QuicR architecture and they
uniquely identify objects. Named objects can be cached in relays in a
way CDNs cache resources and thus can obtain similar benefits such
caching mechanisms would offer.<a href="#section-6-1" class="pilcrow">¶</a></p>
<div id="objects-groups">
<section id="section-6.1">
        <h3 id="name-objects-groups">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-objects-groups" class="section-name selfRef">Objects Groups</a>
        </h3>
<p id="section-6.1-1">Objects with in QuicR belong to a group. A group (a.k.a group of
objects) represent an independent composition of set of objects, where
there exists dependency relationship between the objects within the
group. Groups, thus can be independently consumable by the subscriber
applications.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">A typical example would be a group of pictures/video frames or group of
audio samples that represent synchronization point in the video
conferencing example.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">Latency-tolerant applications can request individual group of objects
allowing delivery of objects without instantiation of persistent state within the delivery network.
This is important for the preservation of the scalability of delivery networks at levels similar to what is currently available
when streaming protocols such as HLS/HTTP are used.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="named-objects">
<section id="section-6.2">
        <h3 id="name-named-objects">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-named-objects" class="section-name selfRef">Named Objects</a>
        </h3>
<p id="section-6.2-1">The names of each object in QuicR is composed of the following components:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-2">
<li id="section-6.2-2.1">Domain Component<a href="#section-6.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.2">Application Component<a href="#section-6.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.3">Group ID Component<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.4">Object ID Component<a href="#section-6.2-2.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.2-3">Domain component uniquely identifies a given application domain. This is
like a HTTP Origin and uniquely identifies the application and a root
relay function. This is a DNS domain name or IP address combined with a
UDP port number mapped to into the domain. Example: sfu.webex.com:5004.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Application component is scoped under a given Domain. This
component identifies aspects specific to a given application instance
hosted under a given domain (e.g.meeting identifier, which movie or
channel, media type or media quality identifier).<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">Inside each Application Component, there is a set of groups. Each
group is identified by a monotonically increasing integer. Inside of
each Group, each object is identified by another monotonically increasing
integer inside that group. The groupID and objectID start at 0 and are
limited to 16 bits long.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">Example: In the example below, the domain component identifies
acme.meeting.com domain, the application component identifies an
instance of a meeting under this domain, say "meeting123", and high
resolution camera stream from the user "alice". It also identifies the
object 17 under group 15.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-7">
<pre>quicr://acme.meeting.com/meeting123/alice/cam5/HiRes/15/17
</pre><a href="#section-6.2-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="name-hashes">
<section id="section-6.3">
        <h3 id="name-name-hashes">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-name-hashes" class="section-name selfRef">Name Hashes</a>
        </h3>
<p id="section-6.3-1">All Names need to hash or map down to 128 bits. This allows for:<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-2.1">
            <p id="section-6.3-2.1.1">compact representation for efficient transmission and storage,<a href="#section-6.3-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-2.2">
            <p id="section-6.3-2.2.1">cache friendly datatypes ( like Keys in CDN caches) for storage and
lookup purposes and,<a href="#section-6.3-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-2.3">
            <p id="section-6.3-2.3.1">enable rapid data lookup at the relays based on partial as well as
whole names ( wildcard support ).<a href="#section-6.3-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-quicr-name"></span><figure id="figure-2">
          <div id="section-6.3-3.1">
<pre class="lang-ascii-art sourcecode">┌─────────────┬───────────────┬───────────────┬─────────────┐
│ Domain      │ Application   │ GroupID       │ ObjectID    │
│ Component   │ Component     │ Component     │ Component   │
└─────────────┴───────────────┴───────────────┴─────────────┘
    48 bits        48 bits         16 bits       16 bits
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-quicr-name" class="selfRef">QuicR Name</a>
          </figcaption></figure>
<p id="section-6.3-4">This is done by hashing the origin to first 48 bits. Any relay that forms an
connection to an new origin needs to ensure this does not collide with
an existing origin. The application component is mapped to the next 48
bits and it is the responsibility of the application to ensure there are
no collisions within a given origin. Finally the group ID and object ID
each map to 16 bits.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">Design Note: It is possible to let each application define the
size of these boundaries as well as sub boundaries inside the application
component but for sake of simplicity it is described as fixed boundaries
for now.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">Wildcard search simply turns into a bitmask at the appropriate bit location
of the hashed name.<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<p id="section-6.3-7">The hash names are key part of the design for allowing small objects
without adding lots of overhead and for efficient implementation of
Relays.<a href="#section-6.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wildcarding-with-names">
<section id="section-6.4">
        <h3 id="name-wildcarding-with-names">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-wildcarding-with-names" class="section-name selfRef">Wildcarding with Names</a>
        </h3>
<p id="section-6.4-1">QuicR allows subscribers to request for media based on wildcard'ed
names. Wildcarding enables subscribes to be made as aggregates instead
of at the object level granularity. Wildcard names are formed by
skipping the right most segments of names.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">For example, in an web conferencing use case, the client may subscribe
to just the origin and meetingId to get all the media for a particular
conference as indicated by the example below. The example matches all
the named objects published as part of meeting123.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3"><code>quicr://acme.meeting.com/meeting123/*</code><a href="#section-6.4-3" class="pilcrow">¶</a></p>
<p id="section-6.4-4">When subscribing, there is an option to tell the relay to one of:<a href="#section-6.4-4" class="pilcrow">¶</a></p>
<p id="section-6.4-5">A. Deliver any new objects it receives that matches the name<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<p id="section-6.4-6">B. Deliver any new objects it receives and in addition send any previous
objects it has received that are in the same group that matches the name.<a href="#section-6.4-6" class="pilcrow">¶</a></p>
<p id="section-6.4-7">C. Wait until an object that has a objectID that matches the name is
received then start sending any objects that match the name.<a href="#section-6.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="objects">
<section id="section-7">
      <h2 id="name-objects">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-objects" class="section-name selfRef">Objects</a>
      </h2>
<p id="section-7-1">Once a named object is created, the content inside the named object can
never be changed. Objects have an expiry time after which they should be
discarded by caches. Objects have an priority that the relays and
clients can use to sequence the sending order. The data inside
an object is end-to-end encrypted whose keys are not available to
Relay(s).<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="relays">
<section id="section-8">
      <h2 id="name-relays">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-relays" class="section-name selfRef">Relays</a>
      </h2>
<p id="section-8-1">The Relays receive subscriptions and intent to publish request and
forward them towards the origin. This may send the messages
directly to the Origin Relay or possibly traverse another Relay. Replies
to theses message follow the reverse direction of the request and when
the Origin gives the OK to a subscription or intent to publish, the
Relay allows the subscription or future publishes to the Names in the
request.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Subscription received are aggregated. When a relay receives a publish
request with data, it will forward it both towards the Origin and to any
clients or relays that have a matching subscription. This "short
circuit" of distribution by a relay before the data has even reached the
Origin servers provides significant latency reduction for nearby client.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">The Relay keeps an outgoing queue of objects to be sent to the each
subscriber and objects are sent in priority order.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">Relays MAY cache some of the information for short period of time and
the time cached may depend on the Origin.<a href="#section-8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quicr-usage-design-patterns">
<section id="section-9">
      <h2 id="name-quicr-usage-design-patterns">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-quicr-usage-design-patterns" class="section-name selfRef">QuicR Usage Design Patterns</a>
      </h2>
<p id="section-9-1">This section explains design patters that can be use to build
applications on top of QuicR.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="quicr-manifest-objects">
<section id="section-9.1">
        <h3 id="name-quicr-manifest-objects">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-quicr-manifest-objects" class="section-name selfRef">QuicR Manifest Objects</a>
        </h3>
<p id="section-9.1-1">Names can optionally be discovered via manifests. In such cases, the
role of the manifest is to identify the names as well as aspects
pertaining to the associated data in a given usage context of the
application.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9.1-2.1">
            <p id="section-9.1-2.1.1">Typically a manifest identifies the domain and application aspects for
the set of names that can be published.<a href="#section-9.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.2">
            <p id="section-9.1-2.2.1">The content of Manifest is application defined and end-to-end
encrypted.<a href="#section-9.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.3">
            <p id="section-9.1-2.3.1">The manifest is owned by the application's origin server and are
accessed as a protected resources by the authorized QuicR clients.<a href="#section-9.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.4">
            <p id="section-9.1-2.4.1">The QuicR protocol treats Manifests as a named object, thus allowing
for clients to subscribe for the purposes of bootstrapping into the
session as well as to follow manifest changes during a session
[ new members joining a conference for example].<a href="#section-9.1-2.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-9.1-2.5">
            <p id="section-9.1-2.5.1">The manifest has well known name on the Origin server.<a href="#section-9.1-2.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-9.1-3">Also to note, a given application might provide non QuicR mechanisms to
retrieve the manifest.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quicr-video-objects">
<section id="section-9.2">
        <h3 id="name-quicr-video-objects">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-quicr-video-objects" class="section-name selfRef">QuicR Video Objects</a>
        </h3>
<p id="section-9.2-1">Most video applications would use the application component to identity
the video stream, as well as the encoding point such as
resolution and bitrate. Each independently decodable set of frames would go
in a single group, and each frame inside that group would go in a
separate named object inside the group. This allows an application to
receive a given encoding of the video by subscribing just to the application
component of the Name with a wildcard for group and object IDs.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">This also allows a subscription to get all the frames in the current group if
it joins lates, or wait until the next group before starting to get data, based on the subscription options. Changing to a different bitrate or
resolution would use a new subscription to the appropriate Name.<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2-3">The QUIC transport that QuicR is running on provides the congestion
control but the application can see what objects are received and
determine if it should change it's subscription to a different bitrate
application component.<a href="#section-9.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2-4">Todays video is often encoded with I-frames at a fixed internal but this
can result in pulsing video quality. Future system may want to insert I-frames at each change of scene resulting in groups with a variable
number of frames. QuicR easily supports that.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<div id="rush-over-quicr">
<section id="section-9.2.1">
          <h4 id="name-rush-over-quicr">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-rush-over-quicr" class="section-name selfRef">RUSH over QuicR</a>
          </h4>
<p id="section-9.2.1-1">RUSH is an application-level protocol for ingesting live video. This
section defines at a higher level how aspects of the RUSH protocol
could be realized with QuicR.<a href="#section-9.2.1-1" class="pilcrow">¶</a></p>
<p id="section-9.2.1-2">RUSH's video frame is equivalent to QuicR video object that represents
an instance of encoder output. For video ingestion, the RUSH publisher
can assign the same groupID for all the frames generated between the
I-Frame boundaries and the RUSH's frameID can be directly mapped to QuicR's object ID. RUSH multistream mode can enabled  by publishing each frame  over QUIC Stream indicated via QuicR API, since QuicR supports both
the QUIC Datagram and QUIC Stream modes of transport.<a href="#section-9.2.1-2" class="pilcrow">¶</a></p>
<p id="section-9.2.1-3">The identifiers for the track and session forms the application
component of the name.<a href="#section-9.2.1-3" class="pilcrow">¶</a></p>
<p id="section-9.2.1-4">Below is an example that shows RUSH's video frame mapped to
QuicR name for the session1, track 12 and video-id that maps
to a given encoding. The groupID and objectID follow the encoder
output. The payload of the published message will be formed by
the actual encoded data along with metadata such as
PresentationTimeStamp (PTS) and so on.<a href="#section-9.2.1-4" class="pilcrow">¶</a></p>
<p id="section-9.2.1-5"><code>quicr://rush-ingest-server/session1/track12/video-id/group1/object10</code><a href="#section-9.2.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="warp-over-quicr">
<section id="section-9.2.2">
          <h4 id="name-warp-over-quicr">
<a href="#section-9.2.2" class="section-number selfRef">9.2.2. </a><a href="#name-warp-over-quicr" class="section-name selfRef">Warp over QuicR</a>
          </h4>
<p id="section-9.2.2-1">Warp is a segmented live video transport protocol. Warp maps
live media to QUIC streams based on the underlying media encoding.<a href="#section-9.2.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2.2-2">Conceptually, each Warp video media segment maps to QuicR groupID
and frames within segment to QuicR objectID. Warp video media segments
are made up of I-Frames and zero or more related frames, which
corresponds to QuicR group of objects. QuicR named objects correspond
to these frames mapped to these segments and are published individually.
For a given channel and video quality, a segment and its frames can
be mapped to QuicR name as below:<a href="#section-9.2.2-2" class="pilcrow">¶</a></p>
<p id="section-9.2.2-3"><code>quicr://twitch.com/channel-fluffy/video-quality-id/group12/object0</code><a href="#section-9.2.2-3" class="pilcrow">¶</a></p>
<p id="section-9.2.2-4">In this example, groupID 12 maps to Warp segmentId 12 and objectID 0
corresponds to I-frame within that segment.<a href="#section-9.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="quicr-audio-objects">
<section id="section-9.3">
        <h3 id="name-quicr-audio-objects">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-quicr-audio-objects" class="section-name selfRef">QuicR Audio Objects</a>
        </h3>
<p id="section-9.3-1">Each small chuck of audio, such as 10 ms, can be its own QuicR object.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
<p id="section-9.3-2">Future sub 2 kbps audio codecs may take advantage of a rapidly
updated model that are needed to decode the audio which could result in
audio needing to use groups like video to ensure all the objects
needed to decode some audio are in the same group.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quicr-game-moves-objects">
<section id="section-9.4">
        <h3 id="name-quicr-game-moves-objects">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-quicr-game-moves-objects" class="section-name selfRef">QuicR Game Moves Objects</a>
        </h3>
<p id="section-9.4-1">Some games send out a base set of state information then incremental
deltas to this. Each time a new base set is sent, a new group can be
formed and each increment change as an Object in the group. When new
players join, they can subscribe to sync up to the latest state by
subscribing to the current group and the incremental changes that
follow.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="messaging-objects">
<section id="section-9.5">
        <h3 id="name-messaging-objects">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-messaging-objects" class="section-name selfRef">Messaging Objects</a>
        </h3>
<p id="section-9.5-1">Chat applications and messaging system can form a manifest representing
the roster of the people in a given channel or talk room. The manifest
can provide information on the application component of the Quicr Name for user that are contributing messages. A subscription to each application such component enables reception of each new message. Each message would be a single object. Typically QuicR would be used to get the recent messages and then a more traditional HTTP CDN approach could be used to retrieve copies of
all the older objects.<a href="#section-9.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations-2">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations-2" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">The links between Relay and other Relays or Clients can be encrypted,
however, this does not protect the content from Relays. To mitigate
this all the objects needs to be end-to-end encrypted with a
keying mechanism outside the scope of this protocol. For may
applications, simply getting the keys over HTTPS for a particular
object/group from the origin server will be adequate. For other
applicants keying based on MLS may be more appropriate. Many
applications can leverage the existing key managed schemes
used in HLS and DASH for DRM protected content.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Relays reachable on the Internet are assumed to have a burstiness
relationship with the Origin and the protocol provides a way to verify
that any data moved is on behalf of a give Origin.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Relays in a local network may choose to process content for any Origin
but since only local users can access them, their is a way to mange
which applications use them.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">Subscriptions need to be refreshed at least every 5 seconds to ensure
liveness and consent for the client to continue receiving data.<a href="#section-10-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="protocol-design-considerations">
<section id="section-11">
      <h2 id="name-protocol-design-considerati">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-protocol-design-considerati" class="section-name selfRef">Protocol Design Considerations</a>
      </h2>
<div id="http-3">
<section id="section-11.1">
        <h3 id="name-http-3">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-http-3" class="section-name selfRef">HTTP/3</a>
        </h3>
<p id="section-11.1-1">It is tempting to base this on HTTP but there are a few high level
architectural mismatches. HTTP is largely designed for a stateless
server in a client server architecture. The whole concept of the PUB/SUB
is that the relays are <em>not</em> stateless and keep the subscription
information and this is what allows for low latency and high throughput
on the relays.<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<p id="section-11.1-2">In todays CDN, the CDN nodes end up faking the credentials of the origin server and this limits how and where they can be a deployed. A design with explicitly designed relays that do not need to do this, while still assuming an end to end encrypted model so the relays did not have access to the content makes for a better design.<a href="#section-11.1-2" class="pilcrow">¶</a></p>
<p id="section-11.1-3">It would be possible to start with something that looked like HTTP as
the protocol between the relays with special conventions for wildcards
in URLs of a GET and ways to stream non final responses for any
responses perhaps using something like multipart MIME. However, most of
the existing code and logic for HTTP would not really be usable with the
low latency streaming of data. It is probably much simpler and more
scalable to simply define a PUB/SUB protocol directly on top of QUIC.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quic-streams-and-datagrams">
<section id="section-11.2">
        <h3 id="name-quic-streams-and-datagrams">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-quic-streams-and-datagrams" class="section-name selfRef">QUIC Streams and Datagrams</a>
        </h3>
<p id="section-11.2-1">There are pro and cons to mapping object transport on top of streams or
on top of QUIC datagrams. The working group would need to sort this out
and consider the possibility of using both for different types of data
and if there should be support for a semi-reliable transport of
data. Some objects, for example the manifest would
always want to be received in a reliable way while other objects
may have to be realtime.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="quic-congestion-control">
<section id="section-11.3">
        <h3 id="name-quic-congestion-control">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-quic-congestion-control" class="section-name selfRef">QUIC Congestion Control</a>
        </h3>
<p id="section-11.3-1">The basic idea in BBR of speeding up to probe then slowing down to drain
the queue build up caused during probe can work fine with real time
applications. However the the current implementations in QUIC do not
seem optimized for real time applications and have some times where the
slow down causes too much jitter. To not have playout drops, the jitter
buffers adds latency to compensate for this. Probing for the RTT has been
one of the phases that causes particular problems for this. To reduce
the latency of QUIC, this work should coordinate with the QUIC working
group to have the QUIC working group develop congestion control
optimizations for low latency use of QUIC.<a href="#section-11.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="why-not-rtp">
<section id="section-11.4">
        <h3 id="name-why-not-rtp">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-why-not-rtp" class="section-name selfRef">Why not RTP</a>
        </h3>
<p id="section-11.4-1">RTP has several desirable properties that optimize the transport of media
over networks, including media payload formats explicitly designed for
network packets, transport feedback, packet loss resilience mechanisms,
multiplexing, and strong security. It also has experimental congestion
control (CC) algorithms explicitly designed for media delivery (RMCAT),
without the issues described above in BBR.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
<p id="section-11.4-2">However, these properties have less value in the context of QuicR for
the following reasons. QUIC adequately handles multiplexing, security,
and transport feedback (except ack timestamps which require extensions
proposed in drafts that have not yet been adopted by the QUIC WG).
QUIC lacks CC and resilience mechanisms optimized for media, but direct
reuse of unaltered RTP mechanisms is not practical, so these aspects
must be redesigned in the context of QUIC anyway, although they can
leverage learnings from RTP.<a href="#section-11.4-2" class="pilcrow">¶</a></p>
<p id="section-11.4-3">Finally, and most significantly, RTP media payload formats that were
optimized for network packets are less useful in QuicR since a
primary goal is to unify the streaming and real-time media delivery
protocols. Streaming protocols use "container" formats like CMAF,
ISOBMFF, etc. Codecs always first define their core "elementary"
bitstream format, then define their container format binding, and
finally define their RTP payload format binding. These always differ.
The differences are not significant enough to justify supporting both,
so QuicR only supports the container format binding.<a href="#section-11.4-3" class="pilcrow">¶</a></p>
<p id="section-11.4-4">It is also interesting to observe that the use of RTP inadvertently
leads to media description and negotiation using SDP. Such complexity
is justifiable when huge variation exists between clients' capabilities
with very basic common lowest denominators. Today, and while variations
still exist, streamlining media capabilities into reasonable capability
sets that are declared by publishers and subscribed to by subscribers
is very feasible and is how the streaming applications do operate.
Simpler forms can and should be used for media declarations. As a
very wise guru once put it "RTP is an gateway drug to SDP and friends
done't let friends try to debug SDP".<a href="#section-11.4-4" class="pilcrow">¶</a></p>
<p id="section-11.4-5">In summary, the desirable aspects of RTP are absorbed into QUIC or
QuicR layers rather than direct encapsulation of RTP.<a href="#section-11.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-A">
      <h2 id="name-acknowledgments">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-A-1">Thanks to Nermeen Ismail, Mo Zanaty for contributions and suggestions to this specification.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses-2">
<a href="#name-authors-addresses-2" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Cullen Jennings</span></div>
<div dir="auto" class="left"><span class="org">cisco</span></div>
<div dir="auto" class="left"><span class="country-name">Canada</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:fluffy@iii.ca" class="email">fluffy@iii.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Suhas Nandakumar</span></div>
<div dir="auto" class="left"><span class="org">Cisco</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:snandaku@cisco.com" class="email">snandaku@cisco.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
