
Inter-Domain Routing Working Group			   J. Haas
Internet Draft						   NextHop
							  S. Hares
							   NextHop
						      W. Tackabury
					      Gold Wire Technology

						  January 12, 2004



		     Definitions of Managed Objects
       for the Fourth Version of Border Gateway Protocol (BGP-4),
			     Second Version
		   <draft-ietf-idr-bgp4-mibv2-04.txt>



Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference mate-
   rial or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

Copyright Notice

   Copyright (C) The Internet Society (2002).  All Rights Reserved.

Abstract

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in TCP/IP-based internets.
   In particular, this MIB defines objects that facilitate the



Various Authors		  Expires June 12, 2004		FORMFEED[Page 1]

Internet Draft		       BGP-MIB v2		January 12, 2004


   management of the Border Gateway Protocol Version 4 (BGP4).

   Distribution of this memo is unlimited.


1.  Introduction

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in the Internet community.
   In particular, it describes managed objects used for managing the
   Border Gateway Protocol Version 4.

   The Internet-Standard Management Framework

   For a detailed overview of the documents that describe the current
   Internet-Standard Management Framework, please refer to section 7 of
   RFC 3410 [RFC3410].

   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  MIB objects are generally
   accessed through the Simple Network Management Protocol (SNMP).
   Objects in the MIB are defined using the mechanisms defined in the
   Structure of Management Information (SMI).  This memo specifies a MIB
   module that is compliant to the SMIv2, which is described in STD 58,
   RFC 2578 [RFC2578], STD 58, RFC 2579 [RFC2579] and STD 58, RFC 2580



2.  Objectives

   This MIB Module is meant to broadly update and replace a prior MIB
   Module defined in RFC 1657 [RFC1657].  Additionally, there is another
   effort underway to address very specific limited objectives in updat-
   ing points in the RFC 1657 object definition and managed object
   attributes [MIB-DRAFT].  The MIB Module described herein is intended
   to fully serve the functions and scope of RFC 1657 and these RFC 1657
   updates.


2.1.  Protocol Extensions

   Additionally, however, there are a number of ways in which the BGP
   Protocol has been enhanced through its ability for added capabili-
   ties. Implementations of those capabilities have not been able to
   have any management capabilities present in RFC 1657-compliant MIB
   module agents, since the capabilities themselves postdated the adop-
   tion of RFC 1657.  For several significant capabilities, in the form
   of BGP Communities [RFC1997], Autonomous System Confederation



Various Authors		  Expires June 12, 2004		FORMFEED[Page 2]

Internet Draft		       BGP-MIB v2		January 12, 2004


   [RFC3065] , BGP Multiprotocol Extensions [RFC2858], and Route Reflec-
   tion [RFC2796], the MIB Module defined in this document exposes
   object types to manage those extended capabilities and their opera-
   tion.

   One of these extensions in particular (the multiprotocol extensions)
   requires a thorough redefinition of MIB table row indices from the
   RFC 1657 state.  This allows transport-independent address indices
   consistent with the Address Family Identifier (AFI) and Subsequent
   Address Family Identifier (SAFI) mechanisms of that extension.


2.2.  Mechanisms for MIB Extensibility

   Moreover, the requirement for the incremental update of support for
   capabilities such as these begs the issue of placing modular extensi-
   bility for protocol extensions within the framework of the MIB
   itself.  Going forward, it would be very desirable to have attributes
   of the MIB structure, and administrative procedures, to allow the
   incremental update of the MIB scope to cover any such new protocol
   extensions, without requiring a reissue of the entire MIB.  In this
   sense, we seek to structure the MIB much like the underlying BGP4
   itself, allowing capability-by-capability update.


2.3.  BGP Configuration

   Finally, the definition and adoption of Version 3 of the SNMP has
   occurred since the adoption of the RFC 1657 MIB.  As a result, the
   ability to deploy secure configuration of managed elements via SNMP
   in a standardized way has become a reality for managed networks.  In
   this MIB definition effort, we seek to expose a more thorough capac-
   ity for configuration of BGP4 and its capabilities than was present
   in RFC 1657 or than was common practice at the time of its adoption.


3.  MIB Organization

   The MIB is broken down into several top level sections.  This sec-
   tionalization is important to create an organization for extensibil-
   ity.

   In general, a top level section of the MIB module will identify some
   number of "core" scalar and tabular objects rooted off of it.  If
   there is sufficient depth within a subsection of one of these top-
   level sections, the "core" subdivision off of the top level section
   may provide multiple levels to the OBJECT IDENTIFIER scope necessary
   to define its management data.



Various Authors		  Expires June 12, 2004		FORMFEED[Page 3]

Internet Draft		       BGP-MIB v2		January 12, 2004


   Once this core section is defined, however, each top-level section
   has an explicit provision for an 'extensions' section OBJECT IDENTI-
   FIER.  The intent of the extensions section is to be containment for
   discrete per-extension sections.  By 'extension' here, we refer to
   protocol mechanisms, capabilities, and exchanges which are not
   defined in the base Border Gateway Protocol definition, or is not
   configuration for protocol operations of similarly 'core' status.
   Currently, we propose keying the identification within the per-exten-
   sion section in one of two ways.

   Where the extension is keyed to a defined capability which has an
   associated BGP capability number assigned by IANA (for example, mul-
   tiprotocol BGP extensions), the per extension section will be that
   defined IANA capability number.  Where the extension has management
   information suitable for a MIB extension but does not correspond to
   an exchanged protocol capability (for example, BGP Route Reflection),
   the extension section shall have its final OBJECT IDENTIFIER fragment
   correspond to the RFC number which first uniquely defined the exten-
   sion (i.e., not requiring renumbering at the time a defining RFC for
   a protocol mechanism is outdated by a later RFC).


3.1.  bgpM2BaseScalars

   The bgpM2BaseScalars section (and corresponding OBJECT IDENTIFIER) is
   used to delineate object types used for basic management and monitor-
   ing of the protocol implementation.	 These are core parameters for
   the local configuration.  While notifications are designed to be
   extensible into any other section in the MIB module, the currently
   defined traps are located here, in a subsection 'bgpM2BaseNotifica-
   tions'.  This is rooted at index level zero (0) here, owing to con-
   ventions established in [RFC2576].

   Support for multiple concurrently supported versions of BGP is
   exposed through the entries of the bgpM2VersionTable.  Similarly,
   support for multiple capabilities and authentication mechanisms, as
   identified by their assigned numbers, are reported in the bgpM2Sup-
   portedCapabilitiesTable and bgpM2SupportedAuthTable respectively.

   In the MIB document, there are currently scalar extension mechanisms
   to allow the agent to report membership of a local BGP Confederation
   [RFC3065] or Route Reflection Cluster ID [RFC2796], as well as
   whether these capabilities are in fact supported by the implementa-
   tion.  These are consistent with the non-capability based extension
   section indexing guidelines as presented above.

   bgpM2BaseScalars also is the root for a subsection, bgpM2BaseScalar-
   Configuration, which contains the companion configuration objects for



Various Authors		  Expires June 12, 2004		FORMFEED[Page 4]

Internet Draft		       BGP-MIB v2		January 12, 2004


   the base scalar objects delineated in the preceding paragraphs.
   These are presented as a series of scalar read-write objects, with a
   single OBJECT-TYPE of syntax StorageType to designate the persistence
   of the instance value data for these configuration scalars.


3.2.  bgpM2PeerData

   The bgpM2PeerData section is per-peer object type definitions. The
   predominant table of read-only STATUS object types in that section
   (bgpM2PeerTable) describes the session, negotiation state, and
   authentication state on a per peer basis.  A second table (bgpM2Pre-
   fixCountersTable) exposes information about individual route prefixes
   received over each peer session.  A separate subsection and its sub-
   ordinate table (bgpM2PeerErrorsTable) reports information about the
   last error encountered on a given peering session.

   Further subsections report authentication state with the peer, peer-
   ing session detected errors,	 and elapsed time it has taken to
   advance the peering session into various states defined in the proto-
   col FSM.

   The bgpM2PeerConfiguredTimersTable reports and allows dynamic reset
   of key timers on the peer session.  These currently allow reset of
   hold time and keepalive timer, for compatibility with the same capa-
   bilities in RFC 1657 [RFC1657]. For these resettable timers, their
   end-to-end negotiated current values are reflected in the
   bgpM2PeerNegotiatedTimersTable.

   As currently defined, these tables describing authentication, error
   state, and timer values (in addition to the configuration tables for
   session timers) are tightly coupled enough to the logical per-row
   view exposed in the bgpM2PeerTable row entries on a session that
   these subordinate "tables" are defined as AUGMENTing the
   bgpM2PeerTable itself.  The other primary design criterion behind
   this decision is that using this AUGMENTation does not increase the
   per-row-data requirements of bgpM2PeerTable instance retrieval so as
   to make such per-row retrieval unwieldy for the management applica-
   tion.


3.2.1.	bgpM2PeerCapabilities

   bgpM2PeerCapabilitiesData has objects and tables to describe BGP
   capabilities locally supported, and those reported and negotiated
   over each peer session.   For tables supporting each of these capa-
   bility sets, capability code and data value are provided.  Attention
   must be given to the fact that multiple instances of a given



Various Authors		  Expires June 12, 2004		FORMFEED[Page 5]

Internet Draft		       BGP-MIB v2		January 12, 2004


   capability can be transmitted between BGP speakers.


3.2.2.	bgpM2PeerCounters

   The bgpM2CountersTable and bgpM2PrefixCountersTable report protocol
   exchanges/FSM transitions, and discrete number of NLRIs exchanged per
   peering session, respectively.  This is independent of actual
   exchanged path attributes, which are tabularized later in the MIB
   module.  Note that session transitions as reflected in changes of
   instances within this table may also be reflected in issuance of
   bgpM2Established and bgpM2BackwardTransition NOTIFICATION-TYPE PDUs.

3.2.3.	Peering Data Extensions

   Route reflector status on a per-peer basis (whether the peer is a
   client or nonClient of  the local BGP router's reflected route propa-
   gation), and peer confederation membership is reported in non capa-
   bility extensions of the peering data section.

3.2.4.	Configuring Peering Sessions


   The MIB has several tables indexed on a per-peer level of granularity
   to control creation and activation of new peering sessions, and to
   allow control on running sessions (those reflected in bgpM2PeerTable
   row instances) regardless of what caused their creation in the BGP
   routing process.

   The bgpM2CfgPeerAdminStatusTable allows creation and specification of
   a row by a bgpM2PeerIndex value (which is how its associated row
   instance is identified in the bgpM2PeerTable).  For each such row
   instance, the set of the bgpM2CfgPeerAdminStatus OBJECT-TYPE of MAX-
   ACCESS read-write can allow management application start and stop of
   the session.

   This is contrasted with the function of the bgpM2CfgPeerTable, and
   its related AUGMENTed tables bgpM2CfgPeerTimersTable and bgpM2Cfg-
   PeerAuthTable.  These are used to facilitate direct creation of peer-
   ing sessions by the management application.	The function of columnar
   OBJECT-TYPEs within the bgpM2CfgPeerTable for local and remote
   address, version negotiation, and various row-administrative
   attributes (RowStatus and StorageType SYNTAXes) are straightforward
   enough.  The only subtlety with respect to how peering sessions are
   activated from usage of this table, and how the activated sessions
   are reflected through their bgpM2PeerTable and bgpM2CfgPeerAdminSta-
   tusTable entries, is in the usage of the bgpM2CfgPeerTable columnar
   object bgpM2CfgPeerStatus.  bgpM2CfgPeerStatus can take on two



Various Authors		  Expires June 12, 2004		FORMFEED[Page 6]

Internet Draft		       BGP-MIB v2		January 12, 2004


   values.  When a peering session, as reflected through its row
   instance in the bgpM2CfgPeerTable, has the bgpM2CfgPeerStatus
   instance value in that row set to running(2) at the time of the SYN-
   TAX RowStatus object instance of bgpM2CfgPeerRowEntryStatus set to
   active(1), the peering session will in fact be activated in the BGP
   routing process (in addition to having its row instance created in
   the bgpM2CfgPeerTable and bgpM2CfgPeerAdminStatusTable).  In this
   case, the associated row of the bgpM2CfgPeerAdminStatusTable row
   bgpM2CfgPeerAdminStatus instance would have the value of start(2).
   If, in the prior example, the bgpM2CfgPeerStatus is halted(1) at the
   time of the bgpM2CfgPeerRowEntryStatus instance set to active(1),
   only the peering table entries would be created at this time of acti-
   vation, without the peering session being automatically started.  The
   bgpM2CfgPeerAdminStatusTable row bgpM2CfgPeerAdminStatus instance
   associated with the session would in this case reflect a value of
   stop(1).

   Since the row entries of the per-peer configuration tables which AUG-
   MENT the bgpM2CfgPeerTable logically fate-share the row instances in
   the bgpM2CfgPeerTable which they are AUGMENTing, they also share the
   same StorageType and RowStatus SYNTAX object sense of the bgpM2Cfg-
   PeerTable rows which they augment.

3.3.  BGP Routing Information Base Data

   An important table for providing index information for other tables
   in the MIB module is the bgpM2NlriTable.  This discriminates on a
   given network prefix (by AFI/SAFI), and the peer which advertised the
   prefix (since it can be heard of from multiple speakers).  The
   bgpM2PathAttrIndex column which identifies each row in this table is
   used as an index for other per-attribute tables through the remainder
   of the MIB module.

   RFC 3107 [RFC3107] specifies a capability for exchanged routes
   between BGP peers to attach attribute information to a route indicat-
   ing, specifically, related MPLS label path information.  The MIB sup-
   ports the presentation of this attribute information by generalizing
   how these attributes are presented to accommodate further extensions
   of this particular type.  Within a given bgpM2NlriTable entry, we
   speak of attribute data of this type as being 'opaque' to BGP, and
   use the columnar OBJECT-TYPEs bgpM2NlriOpaqueType and bgpM2Nlri-
   OpaquePointer to refer to it.  In the case of the RFC 3107 MPLS label
   encoding (which is the only usage of these columnar fields in the
   bgpM2NlriTable right now), a MPLS label stack would be referenced by
   bgpM2NlriOpaquePointer by its per-NLRI instance pointing to a row
   instance in the MPLS LSR MIB mplsLabelStackTable, and the bgpM2Nlri-
   OpaqueType instance having a value of bgpMplsLabelStack(1).




Various Authors		  Expires June 12, 2004		FORMFEED[Page 7]

Internet Draft		       BGP-MIB v2		January 12, 2004


   The bgpM2AdjRibsOutTable row entries reflect data on routes which
   have been placed, per peering session, in the Adj-Rib-Out for adver-
   tisement to the associated peer.

   The bgpM2PathAttrTable provides discrete BGP NLRI attributes which
   were received with the advertisement of the prefix by its advertising
   peer.  Specific information about the autonomous system path (AS
   Path) advertised with the NLRI, on a per AS value, is to be found in
   the bgpM2AsPathTable.

   Finally, where attributes which were unable to be reported in the
   bgpM2PathAttrTable, the AS Path table, or any defined per-NLRI tables
   in the agent were received with the prefix, those attributes are
   reported via the bgpM2PathAttrUnknownTable.	Short of advertised
   attribute type, no semantic breakdown of the unknown attribute data
   is provided.	 That data is only available as a raw OCTET STRING in
   the bgpM2PathAttrUnknownValue column of this table.


3.3.1.	Routing Information Base Extensions

   There are two extension sections and five subordinate tables to the
   bgpM2PathAttrTable and RIB data OBJECT IDENTIFIER-delimited MIB mod-
   ule section. The bgpM2PathAttrRouteReflectionExts and its contained
   bgpM2PathAttrOriginatorIdTable report on the originating route
   reflector.  The bgpM2PathAttrClusterTable specifically reports on the
   reflection route a NLRI has traversed to get to the local BGP routing
   process.

   The bgpM2PathAttrCommunityExts section deals with extended and non-
   extended communities for network routes.  The bgpM2PathAttrCommTable
   bgpM2PathAttrExtCommTable  contained herein report community member-
   ship (if any) on a per network-prefix basis.

3.4.  Consideration On Table Indexing

   There are certain efficiency concerns for row index management for
   management applications which are useful to take into consideration,
   given the nature of some of the tables implied in the preceding sec-
   tion.

   In the first place, it is valuable to exploit the direct relationship
   of entries in, for example, the bgpM2PrefixCountersTable as they
   relate to the entry in the bgpM2PeerTable to which they are related.
   More compelling is the example case of the one-to-many relationship
   between a row entry in the bgpM2PeerTable and the bgpM2PathAttrTable,
   the latter of which maintains per-row entries for potentially many
   NLRIs as received from a peer in a BGP UPDATE message.  From the



Various Authors		  Expires June 12, 2004		FORMFEED[Page 8]

Internet Draft		       BGP-MIB v2		January 12, 2004


   point of view of normalizing these relationships, it would be useful
   to have a direct reference to the "governing" bgpM2PeerTable row
   entry for the peer which is a "dependency" for the subordinate table
   row entry for other peer data.

   Second, the nature of protocol-independent addressing makes the
   indexing of these entries indirectly even more compelling.  Even
   accounting for the addressing requirements of IPv6 and the provision
   of AFI and SAFI qualifiers, the logical addressing of a row in the
   bgpPathAttrClusterTable (for example) would extend out some 50 bytes
   if there was no direct index linkage to the "governing" bgpPathAt-
   trTable, and bgpPeerTable entries.

   For this reason, the tables are structured in such a way that, where
   there is such a linkage to a "dependent" table (where, for example,
   the bgpPrefixCountersTable "depends on" the bgpPeerTable), a table
   will contain a per-row numeric index (e.g., bgpPeerIndex), which the
   "dependent" table will use as one of its own row index values.  These
   indices are manufactured by the agent, and are otherwise opaque to
   the management application (or, for that matter, even to the organi-
   zation of the "dependent" table[s]).

   Where considerations of per-row retrieval overhead (in terms of typi-
   cal row instance data size, as a function of liability to have a sin-
   gle row retrieval exceed PDU size, for example), and those of general
   logical data organization permit, certain tables logically at the
   sub-peering-session level have been specified as AUGMENTing the pri-
   mary tables (bgpM2PeerTable and bgpM2CfgPeerTable) to which those
   sub-peering-session row entries relate.  This is to facilitate ease
   on the part of a management application of assembling (for example,
   via GET-BULK operations across a lexicographically contiguous row
   scope) a management image of control information on a given peering
   session.

4.  Definitions

BGP4-V2-MIB DEFINITIONS ::= BEGIN

    IMPORTS
	MODULE-IDENTITY, OBJECT-TYPE, NOTIFICATION-TYPE,
	Counter32, Gauge32, mib-2, Unsigned32, Integer32,
     TimeTicks
	    FROM SNMPv2-SMI
	InetAddressType, InetAddress, InetPortNumber,
	InetAutonomousSystemNumber, InetAddressPrefixLength
	    FROM INET-ADDRESS-MIB
	TEXTUAL-CONVENTION, TruthValue, RowPointer, StorageType,
	RowStatus



Various Authors		  Expires June 12, 2004		FORMFEED[Page 9]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    FROM SNMPv2-TC
	MODULE-COMPLIANCE, OBJECT-GROUP, NOTIFICATION-GROUP
	    FROM SNMPv2-CONF
	SnmpAdminString
	    FROM SNMP-FRAMEWORK-MIB;


    bgpM2 MODULE-IDENTITY
	LAST-UPDATED "200401120000Z"
	ORGANIZATION "IETF IDR Working Group"
	CONTACT-INFO "E-mail:  idr@merit.net

		      Jeffrey Haas  (Editor)
		      825 Victors Way, Suite 100
		      Ann Arbor, MI  48108
		      Tel: +1 734 222-1600
		      Fax: +1 734 222-1602
		      E-mail: jhaas@nexthop.com"

	DESCRIPTION
	    "This MIB module defines management objects for
	     the Border Gateway Protocol, Version 4."
	::= { mib-2 XXX }
-- RFC Ed.: replace XXX with IANA-assigned number & remove this note

    BgpM2Identifier ::= TEXTUAL-CONVENTION
	DISPLAY-HINT "1d."
	STATUS	     current
	DESCRIPTION
	    "The representation of a BGP Identifier.  The BGP
	     Identifier should be represented in the OCTET STRING
	     as with the first OCTET of the string containing
	     the first OCTET of the BGP Identifier received or sent
	     in the OPEN packet and so on.

	     Even though the BGP Identifier is trending away from
	     an IP address it is still displayed as if it was one,
	     even when it would be an illegal IP address."
	SYNTAX OCTET STRING(SIZE (4))


    BgpM2Afi ::= TEXTUAL-CONVENTION
	DISPLAY-HINT "d"
	STATUS	     current
	DESCRIPTION
	    "The representation of a BGP AFI"
	SYNTAX Unsigned32(0..65535)




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 10]

Internet Draft		       BGP-MIB v2		January 12, 2004


    BgpM2Safi ::= TEXTUAL-CONVENTION
	DISPLAY-HINT "d"
	STATUS	     current
	DESCRIPTION
	    "The representation of a BGP SAFI"
	SYNTAX Unsigned32(0..255)


    BgpM2Community ::= TEXTUAL-CONVENTION
	DISPLAY-HINT "2d:"
	STATUS	     current
	DESCRIPTION
	    "The representation of a BGP Community."
	SYNTAX OCTET STRING(SIZE(4))


    BgpM2ExtendedCommunity ::= TEXTUAL-CONVENTION
	DISPLAY-HINT "1x:"
	STATUS	     current
	DESCRIPTION
	    "The representation of a BGP Extended Community."
	SYNTAX OCTET STRING(SIZE(8))


    bgpM2BaseScalars
	OBJECT IDENTIFIER ::= { bgpM2 1 }


    --
    -- Notifications
    --

    bgpM2BaseNotifications
	OBJECT IDENTIFIER ::= { bgpM2BaseScalars 0 }


    bgpM2Established NOTIFICATION-TYPE
	OBJECTS {
	    bgpM2PeerLocalAddrType,
	    bgpM2PeerLocalAddr,
	    bgpM2PeerRemoteAddrType,
	    bgpM2PeerRemoteAddr,
	    bgpM2PeerLastErrorReceived,
	    bgpM2PeerState
	}
	STATUS	current
	DESCRIPTION
	    "The BGP Established event is generated when



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 11]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     the BGP FSM enters the ESTABLISHED state."
	::= { bgpM2BaseNotifications 1 }


    bgpM2BackwardTransition NOTIFICATION-TYPE
	OBJECTS {
	    bgpM2PeerLocalAddrType,
	    bgpM2PeerLocalAddr,
	    bgpM2PeerRemoteAddrType,
	    bgpM2PeerRemoteAddr,
	    bgpM2PeerLastErrorReceived,
	    bgpM2PeerLastErrorReceivedText,
	    bgpM2PeerState
	}
	STATUS	current
	DESCRIPTION
	    "The BGPBackwardTransition Event is generated
	     when the BGP FSM moves from a higher numbered
	     state to a lower numbered state."
	::= { bgpM2BaseNotifications 2 }


    --
    -- BGP Supported Version Table
    --

    bgpM2Version
	OBJECT IDENTIFIER ::= { bgpM2BaseScalars 1 }


    bgpM2VersionTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2VersionEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Table of supported BGP versions."
	::= { bgpM2Version 1 }


    bgpM2VersionEntry OBJECT-TYPE
	SYNTAX	   BgpM2VersionEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing data on a given supported version
	     of the Border Gateway Protocol and the level of
	     support provided.	It is expected that any agent
	     implementation supporting this MIB module will



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 12]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     report support for Version 4 of the Border Gateway
	     Protocol at the very minimum."
	INDEX {
	    bgpM2VersionIndex
	}
	::= { bgpM2VersionTable 1 }


    BgpM2VersionEntry ::= SEQUENCE {
	    bgpM2VersionIndex
		Unsigned32,
	    bgpM2VersionSupported
		TruthValue
    }


    bgpM2VersionIndex OBJECT-TYPE
	SYNTAX	   Unsigned32(0..255)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The version number of the BGP Protocol."
	::= { bgpM2VersionEntry 1 }


    bgpM2VersionSupported OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value is TRUE if this version of the BGP protocol
	     identified in 'bgpM2VersionIndex' is supported.  The absence
	     of a row for a particular bgpM2VersionIndex indicates that
	     that bgpM2VersionIndex protocol version number is not
	     supported."
	::= { bgpM2VersionEntry 2 }


    --
    -- Supported BGP Capabilities
    --

    bgpM2SupportedCapabilities
	OBJECT IDENTIFIER ::= { bgpM2BaseScalars 2 }


    bgpM2CapabilitySupportAvailable OBJECT-TYPE
	SYNTAX	   TruthValue



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 13]

Internet Draft		       BGP-MIB v2		January 12, 2004


	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value is TRUE if capability support is
	     available and is enabled."
	::= { bgpM2SupportedCapabilities 1 }


    bgpM2SupportedCapabilitiesTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2SupportedCapabilityEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Table of supported BGP-4 capabilities."
	::= { bgpM2SupportedCapabilities 2 }


    bgpM2SupportedCapabilitiesEntry OBJECT-TYPE
	SYNTAX	   BgpM2SupportedCapabilityEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Information about supported capabilities indexed
	     by capability number."
	INDEX {
	    bgpM2SupportedCapabilityCode
	}
	::= { bgpM2SupportedCapabilitiesTable 1 }


    BgpM2SupportedCapabilityEntry ::= SEQUENCE {
	bgpM2SupportedCapabilityCode
	    Unsigned32,
	bgpM2SupportedCapability
	    TruthValue
    }


    bgpM2SupportedCapabilityCode OBJECT-TYPE
	SYNTAX	   Unsigned32 (0..255)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Index of supported capability.  The index directly
	     corresponds with the BGP-4 Capability Advertisement
	     Capability Code."
	::= { bgpM2SupportedCapabilitiesEntry 1 }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 14]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2SupportedCapability OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value is True if this capability is supported,
	     False otherwise."
	::= { bgpM2SupportedCapabilitiesEntry 2 }


    --
    -- Base Scalars
    --


    bgpM2AsSize OBJECT-TYPE
	SYNTAX	   INTEGER {
	    twoOctet(1),
	    fourOctet(2)
	}
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The size of the AS value in this implementation.

	     The semantics of this are determined as per the
	     as-4bytes draft."
	REFERENCE
	    "draft-ietf-idr-as4bytes-04"
	::= { bgpM2BaseScalars 4 }


    bgpM2LocalAs OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The local autonomous system number.

	     If the bgpM2AsSize is twoOctet, then the range is
	     constrained to be 0-65535."
	::= { bgpM2BaseScalars 5 }


    bgpM2LocalIdentifier OBJECT-TYPE
	SYNTAX	   BgpM2Identifier
	MAX-ACCESS read-only
	STATUS	   current



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 15]

Internet Draft		       BGP-MIB v2		January 12, 2004


	DESCRIPTION
	    "The BGP Identifier of local system.

	     Current practice is trending away from this value being
	     treated as an IP address and more as a generic
	     identifier."
	::= { bgpM2BaseScalars 6 }


    --
    -- Base Scalar Extensions
    --

    bgpM2BaseScalarExtensions
	OBJECT IDENTIFIER ::= { bgpM2BaseScalars 7 }


    bgpM2BaseScalarNonCapExts
	OBJECT IDENTIFIER ::= { bgpM2BaseScalarExtensions 1 }


    bgpM2BaseScalarCapExts
	OBJECT IDENTIFIER ::= { bgpM2BaseScalarExtensions 2 }


    --
    -- Base Scalar Route Reflection Extensions
    --

    bgpM2BaseScalarRouteReflectExts OBJECT IDENTIFIER ::=
	{ bgpM2BaseScalarNonCapExts 2796 }


    bgpM2RouteReflector OBJECT-TYPE
	SYNTAX	    TruthValue
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "This value is TRUE if this implementation supports the
	     BGP Route Reflection Extension and is enabled as a
	     route reflector.  If the BGP Route Reflection extension
	     is not supported this value must be FALSE."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	::= { bgpM2BaseScalarRouteReflectExts 1 }


    bgpM2ClusterId OBJECT-TYPE



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 16]

Internet Draft		       BGP-MIB v2		January 12, 2004


	SYNTAX	    BgpM2Identifier
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "The configured Cluster-ID of the BGP Speaker.  This will
	     default to the BGP Speaker's BgpM2Identifier if this
	     speaker is functioning as a route reflector and an
	     explicit Cluster-ID has not been configured.

	     A value of 0.0.0.0 will be present if Route Reflection is
	     not enabled."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	::= { bgpM2BaseScalarRouteReflectExts 2 }


    --
    -- Base Scalar AS Confederation Extensions
    --

    bgpM2BaseScalarASConfedExts OBJECT IDENTIFIER ::=
	 { bgpM2BaseScalarNonCapExts 3065 }


    bgpM2ConfederationRouter OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value is TRUE if this implementation supports the
	     BGP AS Confederations Extension and this router is
	     configured to be in a confederation."
	REFERENCE
	    "RFC 3065 - Autonomous System Confederations for BGP"
	::= { bgpM2BaseScalarASConfedExts 1 }


    bgpM2ConfederationId OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The local Confederation Identification Number.

	     This value will be zero (0) if this BGP Speaker is not
	     a confederation router."
	REFERENCE
	    "RFC 3065 - Autonomous System Confederations for BGP"



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 17]

Internet Draft		       BGP-MIB v2		January 12, 2004


	::= { bgpM2BaseScalarASConfedExts 2 }


    --
    -- Base Configuration Objects
    --

    bgpM2BaseScalarConfiguration
	OBJECT IDENTIFIER ::= { bgpM2BaseScalars 8 }


    bgpM2CfgBaseScalarStorageType OBJECT-TYPE
	SYNTAX	   StorageType
	MAX-ACCESS read-write
	STATUS	   current
	DESCRIPTION
	    "This object specifies the intended storage type for
	     all configurable base scalars."
	::= { bgpM2BaseScalarConfiguration 1 }


    bgpM2CfgLocalAs OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-write
	STATUS	   current
	DESCRIPTION
	    "The local autonomous system number.

	     If the bgpM2AsSize is twoOctet, then the range is
	     constrained to be 0-65535."
	::= { bgpM2BaseScalarConfiguration 2 }


    bgpM2CfgLocalIdentifier OBJECT-TYPE
	SYNTAX	   BgpM2Identifier
	MAX-ACCESS read-write
	STATUS	   current
	DESCRIPTION
	    "The BGP Identifier of local system.

	     Current practice is trending away from this value being
	     treated as an IP address and more as a generic
	     identifier."
	::= { bgpM2BaseScalarConfiguration 3 }


    --
    -- Base Scalar Extensions



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 18]

Internet Draft		       BGP-MIB v2		January 12, 2004


    --

    bgpM2CfgBaseScalarExtensions
	OBJECT IDENTIFIER ::= { bgpM2BaseScalarConfiguration 4 }


    bgpM2CfgBaseScalarNonCapExts
	OBJECT IDENTIFIER ::= { bgpM2CfgBaseScalarExtensions 1 }


    bgpM2CfgBaseScalarCapExts
	OBJECT IDENTIFIER ::= { bgpM2CfgBaseScalarExtensions 2 }


    --
    -- Base Scalar Route Reflection Extensions
    --

    bgpM2CfgBaseScalarReflectorExts
	OBJECT IDENTIFIER ::= { bgpM2CfgBaseScalarNonCapExts 2796 }


    bgpM2CfgRouteReflector OBJECT-TYPE
	SYNTAX	    TruthValue
	MAX-ACCESS  read-write
	STATUS	    current
	DESCRIPTION
	    "This value is set to true if this implementation will
	     be supporting route reflection."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	::= { bgpM2CfgBaseScalarReflectorExts 1 }


    bgpM2CfgClusterId OBJECT-TYPE
	SYNTAX	    BgpM2Identifier
	MAX-ACCESS  read-write
	STATUS	    current
	DESCRIPTION
	    "The configured Cluster-ID of the BGP Speaker.  This will
	     default to the BGP Speaker's BgpM2Identifier if this
	     speaker is functioning as a route reflector and an
	     explicit Cluster-ID has not been configured.

	     A value of 0.0.0.0 will be present if Route Reflection is
	     not enabled."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 19]

Internet Draft		       BGP-MIB v2		January 12, 2004


	::= { bgpM2CfgBaseScalarReflectorExts 2 }


    --
    -- Base Scalar AS Confederation Extensions
    --

    bgpM2CfgBaseScalarASConfedExts
	OBJECT IDENTIFIER ::= { bgpM2CfgBaseScalarNonCapExts 3065 }


    bgpM2CfgConfederationRouter OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-write
	STATUS	   current
	DESCRIPTION
	    "This value is set to true if this implementation will be
	     supporting BGP AS Confederations."
	REFERENCE
	    "RFC 3065 - Autonomous System Confederations for BGP"
	::= { bgpM2CfgBaseScalarASConfedExts 1 }


    bgpM2CfgConfederationId OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-write
	STATUS	   current
	DESCRIPTION
	    "The local Confederation Identification Number.

	     This value will be zero (0) if this BGP Speaker is not
	     a confederation router."
	REFERENCE
	    "RFC 3065 - Autonomous System Confederations for BGP"
	::= { bgpM2CfgBaseScalarASConfedExts 2 }


    --
    -- BGP Peer Data
    --

    bgpM2Peer
	OBJECT IDENTIFIER ::= { bgpM2 2 }


    bgpM2PeerData
	OBJECT IDENTIFIER ::= { bgpM2Peer 1 }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 20]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PeerEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "BGP peer table.

	     This table contains, one entry per remote BGP peer,
	     any information about the connections with the remote
	     BGP peers."
	::= { bgpM2PeerData 1 }


    bgpM2PeerEntry OBJECT-TYPE
	SYNTAX	   BgpM2PeerEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing information about the connection with
	     a remote BGP peer."
	INDEX {
	 bgpM2PeerInstance,
	    bgpM2PeerLocalAddrType,
	    bgpM2PeerLocalAddr,
	    bgpM2PeerRemoteAddrType,
	    bgpM2PeerRemoteAddr
	}
	::= { bgpM2PeerTable 1 }


    BgpM2PeerEntry ::= SEQUENCE {
     bgpM2PeerInstance
	 Unsigned32,
	bgpM2PeerIdentifier
	    BgpM2Identifier,
	bgpM2PeerState
	    INTEGER,
	bgpM2PeerStatus
	    INTEGER,
	bgpM2PeerConfiguredVersion
	    Unsigned32,
	bgpM2PeerNegotiatedVersion
	    Unsigned32,
	bgpM2PeerLocalAddrType
	    InetAddressType,
	bgpM2PeerLocalAddr
	    InetAddress,
	bgpM2PeerLocalPort



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 21]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    InetPortNumber,
	bgpM2PeerLocalAs
	    InetAutonomousSystemNumber,
	bgpM2PeerRemoteAddrType
	    InetAddressType,
	bgpM2PeerRemoteAddr
	    InetAddress,
	bgpM2PeerRemotePort
	    InetPortNumber,
	bgpM2PeerRemoteAs
	    InetAutonomousSystemNumber,
	bgpM2PeerIndex
	    Unsigned32
    }


    bgpM2PeerInstance OBJECT-TYPE
     SYNTAX	Unsigned32
     MAX-ACCESS read-only
     STATUS	current
     DESCRIPTION
	 "The routing instance index.

	  Some BGP implementations permit the creation of
	  multiple instances of a BGP routing process.	An
	  example includes RFC 2547 PE-CE routers.

	  Implementations that do not support multiple
	  routing instances should return 1 for this object.

	  XXX TODO - We need to provide a way to configure these
	  in the peer configuration table."
	::= { bgpM2PeerEntry 1 }


    bgpM2PeerIdentifier OBJECT-TYPE
	SYNTAX	   BgpM2Identifier
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The BGP Identifier of this entry's remote BGP peer.

	     This entry should be 0.0.0.0 unless the bgpM2PeerState is
	     in the OpenConfirm or the Established state."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Sec. 4.2"
	::= { bgpM2PeerEntry 2 }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 22]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerState OBJECT-TYPE
	SYNTAX	   INTEGER {
	    idle(1),
	    connect(2),
	    active(3),
	    opensent(4),
	    openconfirm(5),
	    established(6)
	}
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The remote BGP peer's FSM state."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Sec. 8"
	::= { bgpM2PeerEntry 3 }


    bgpM2PeerStatus OBJECT-TYPE
	SYNTAX	   INTEGER {
	    halted(1),
	    running(2)
	}
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Whether or not the BGP FSM for this remote peer is halted
	     or running.  The BGP FSM for a remote peer is halted after
	     processing a Stop event.  Likewise, it is in the running
	     state after a Start event.

	     The bgpM2PeerState will generally be in the idle state when
	     the FSM is halted, although some extensions such as
	     Graceful Restart will leave the peer in the Idle state
	     but with the FSM running."
	::= { bgpM2PeerEntry 4 }


    bgpM2PeerConfiguredVersion OBJECT-TYPE
	SYNTAX	   Unsigned32 (1..255)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The configured version to originally start with this
	     remote peer.  The BGP speaker may permit negotiation to a
	     lower version number of the protocol."
	::= { bgpM2PeerEntry 5 }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 23]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerNegotiatedVersion OBJECT-TYPE
	SYNTAX	   Unsigned32 (1..255)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The negotiated version of BGP running between the two
	     peers."
	::= { bgpM2PeerEntry 6 }


    bgpM2PeerLocalAddrType OBJECT-TYPE
	SYNTAX	   InetAddressType
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The address family of the local end of the peering
	     session."
	::= { bgpM2PeerEntry 7 }


    bgpM2PeerLocalAddr OBJECT-TYPE
	SYNTAX	   InetAddress (SIZE(4..20))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The address of the local end of the peering session."
	::= { bgpM2PeerEntry 8 }


    bgpM2PeerLocalPort OBJECT-TYPE
	SYNTAX	   InetPortNumber
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The local port for the TCP connection between the BGP
	     peers."
	::= { bgpM2PeerEntry 9 }


    bgpM2PeerLocalAs OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Some implementations of BGP can represent themselves
	     as multiple ASs.  This is the AS that this peering
	     session is representing itself as to the remote peer."
	::= { bgpM2PeerEntry 10 }



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 24]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerRemoteAddrType OBJECT-TYPE
	SYNTAX	   InetAddressType
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The address family of the remote end of the peering
	     session."
	::= { bgpM2PeerEntry 11 }


    bgpM2PeerRemoteAddr OBJECT-TYPE
	SYNTAX	   InetAddress (SIZE(4..20))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The address of the remote end of the peering session."
	::= { bgpM2PeerEntry 12 }


    bgpM2PeerRemotePort OBJECT-TYPE
	SYNTAX	   InetPortNumber
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The remote port for the TCP connection between the BGP
	     peers.  In the case of a transport for which the notion
	     of 'port' is irrelevant, an instance value of -1
	     should be returned by the agent for this object.

	     Note that the objects bgpM2PeerLocalAddr,
	     bgpM2PeerLocalPort, bgpM2PeerRemoteAddr and
	     bgpM2PeerRemotePort provide the appropriate reference to
	     the standard MIB TCP connection table. or even the ipv6
	     TCP MIB as in rfc2452."
	REFERENCE
	    "RFC 2012 - SNMPv2 Management Information Base for the
	     Transmission Control Protocol using SMIv2.
	     RFC 2542 - IP Version 6 Management Information Base
	     for the Transmission Control Protocol."
	::= { bgpM2PeerEntry 13 }


    bgpM2PeerRemoteAs OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The remote autonomous system number."



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 25]

Internet Draft		       BGP-MIB v2		January 12, 2004


	::= { bgpM2PeerEntry 14 }


    bgpM2PeerIndex OBJECT-TYPE
	SYNTAX	    Unsigned32
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "This value is a unique index for the remote peer entry
	     in the bgpM2PeerTable.  It is assigned by the agent
	     at the point of creation of the bgpM2PeerTable row
	     entry.  While its value is guaranteed to be unique at
	     any time, it is otherwise opaque to the management
	     application with respect to its value or the contiguity
	     of bgpM2PeerIndex row instance values across rows of
	     the bgpM2PeerTable.  It is used to provide an index
	     structure for other tables whose data is logically
	     per-peer.

	     For explicitly configured peers, this value will remain
	     consistent until this row is deleted by deleting the
	     configured peers.	Unconfigured peers will generate
	     a monotonically increasing number when a BGP FSM is
	     built to process the peering session.  Values in the
	     bgpM2PeerTable and other tables utilizing bgpM2PeerIndex
	     are expected to remain in existence for an arbitrary
	     time after the unconfigured peer has been deleted
	     in order to allow management applications to extract
	     useful management information for those peers.  Thus,
	     an unconfigured peer using the same indices as the
	     bgpM2PeerTable that comes up while this row still
	     exists will re-utilize the same row."
	 ::= { bgpM2PeerEntry 15 }


    --
    -- Errors
    --

    bgpM2PeerErrors
	OBJECT IDENTIFIER ::= { bgpM2Peer 2 }

    bgpM2PeerErrorsTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PeerErrorsEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "On a per peer basis, this table reflects the last



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 26]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     protocol-defined error encountered and reported on
	     the peer session.	If no entry for a given peer,
	     by its bgpM2PeerIndex, exists in this table, then no
	     such errors have been observed, reported, and
	     recorded on the  session."
	::= { bgpM2PeerErrors 1 }


    bgpM2PeerErrorsEntry OBJECT-TYPE
	SYNTAX	   BgpM2PeerErrorsEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Each entry contains information about errors sent
	     and received for a particular BGP peer."
	AUGMENTS {
	    bgpM2PeerEntry
	}
	::= { bgpM2PeerErrorsTable 1 }


    BgpM2PeerErrorsEntry ::= SEQUENCE {
	bgpM2PeerLastErrorReceived
	    OCTET STRING,
	bgpM2PeerLastErrorSent
	    OCTET STRING,
	bgpM2PeerLastErrorReceivedTime
	    TimeTicks,
	bgpM2PeerLastErrorSentTime
	    TimeTicks,
	bgpM2PeerLastErrorReceivedText
	    SnmpAdminString,
	bgpM2PeerLastErrorSentText
	    SnmpAdminString,
	bgpM2PeerLastErrorReceivedData
	    OCTET STRING,
	bgpM2PeerLastErrorSentData
	    OCTET STRING
    }


    bgpM2PeerLastErrorReceived OBJECT-TYPE
	SYNTAX	   OCTET STRING (SIZE (2))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The last error code and subcode received by this BGP
	     Speaker via a NOTIFICATION message for this peer.



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 27]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     If no error has occurred, this field is zero.
	     Otherwise, the first byte of this two byte
	     OCTET STRING contains the error code, and the second
	     byte contains the subcode."
	REFERENCE
	    "draft-ietf-idr-bgp4-15.txt, Sec. 4.5"
	::= { bgpM2PeerErrorsEntry 1 }


    bgpM2PeerLastErrorSent OBJECT-TYPE
	SYNTAX	   OCTET STRING (SIZE (2))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The last error code and subcode sent by this BGP
	     Speaker via a NOTIFICATION message to this peer.
	     If no error has occurred, this field is zero.
	     Otherwise, the first byte of this two byte
	     OCTET STRING contains the error code, and the second
	     byte contains the subcode."
	REFERENCE
	    "draft-ietf-idr-bgp4-15.txt, Sec. 4.5"
	::= { bgpM2PeerErrorsEntry 2 }


    bgpM2PeerLastErrorReceivedTime OBJECT-TYPE
	SYNTAX	   TimeTicks
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The timestamp that the last NOTIFICATION was received from
	     this peer."
	REFERENCE
	    "draft-ietf-idr-bgp4-15.txt, Sec. 4.5"
	::= { bgpM2PeerErrorsEntry 3 }


    bgpM2PeerLastErrorSentTime OBJECT-TYPE
	SYNTAX	   TimeTicks
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The timestamp that the last NOTIFICATION was sent to
	     this peer."
	REFERENCE
	    "draft-ietf-idr-bgp4-15.txt, Sec. 4.5"
	::= { bgpM2PeerErrorsEntry 4 }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 28]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerLastErrorReceivedText OBJECT-TYPE
	SYNTAX	   SnmpAdminString
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This object contains an implementation specific
	     explanation of the error that was reported."
	::= { bgpM2PeerErrorsEntry 5 }


    bgpM2PeerLastErrorSentText OBJECT-TYPE
	SYNTAX	   SnmpAdminString
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This object contains an implementation specific
	     explanation of the error that is being reported."
	::= { bgpM2PeerErrorsEntry 6 }


    bgpM2PeerLastErrorReceivedData OBJECT-TYPE
	SYNTAX	   OCTET STRING (SIZE(0..4075))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The last error code's data seen by this peer."
	REFERENCE
	    "draft-ietf-idr-bgp4-15.txt, Sec. 4.5"
	::= { bgpM2PeerErrorsEntry 7 }


    bgpM2PeerLastErrorSentData OBJECT-TYPE
	SYNTAX	   OCTET STRING (SIZE(0..4075))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The last error code's data sent to this peer."
	REFERENCE
	    "draft-ietf-idr-bgp4-15.txt, Sec. 4.5"
	::= { bgpM2PeerErrorsEntry 8 }


    --
    -- Peer Event Times
    --

    bgpM2PeerTimers
	OBJECT IDENTIFIER ::= { bgpM2Peer 3 }



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 29]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerEventTimesTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PeerEventTimesEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "A table reporting the per-peering session amount
	     of time elapsed and update events since the peering
	     session advanced into the Established state."
	::= { bgpM2PeerTimers 1 }


    bgpM2PeerEventTimesEntry OBJECT-TYPE
	SYNTAX	   BgpM2PeerEventTimesEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Each row contains a set of statistics about time
	     spent and events encountered in the peer session
	     Established state."
	AUGMENTS {
	    bgpM2PeerEntry
	}
	::= { bgpM2PeerEventTimesTable 1 }


    BgpM2PeerEventTimesEntry ::= SEQUENCE {
	bgpM2PeerFsmEstablishedTime
	    Gauge32,
	bgpM2PeerInUpdatesElapsedTime
	    Gauge32
    }


    bgpM2PeerFsmEstablishedTime OBJECT-TYPE
	SYNTAX	   Gauge32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This timer indicates how long (in seconds) this
	     peer has been in the Established state or how long
	     since this peer was last in the Established state.
	     It is set to zero when a new peer is configured or
	     the router is booted."
	::= { bgpM2PeerEventTimesEntry 1 }


    bgpM2PeerInUpdatesElapsedTime OBJECT-TYPE
	SYNTAX	   Gauge32



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 30]

Internet Draft		       BGP-MIB v2		January 12, 2004


	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Elapsed time in seconds since the last BGP UPDATE
	     message was received from the peer.  Each time
	     bgpM2PeerInUpdates is incremented, the value of this
	     object is set to zero (0).	 This value shall also be
	     zero (0) when the peer is not in the Established state"
	::= { bgpM2PeerEventTimesEntry 2 }


    --
    -- Peer Configured Timers
    --

    bgpM2PeerConfiguredTimersTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PeerConfiguredTimersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Per peer management data on BGP session timers."
	::= { bgpM2PeerTimers 2 }

    bgpM2PeerConfiguredTimersEntry OBJECT-TYPE
	SYNTAX	   BgpM2PeerConfiguredTimersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Each entry corresponds to the current state of
	     BGP timers on a given peering session."
	AUGMENTS {
	    bgpM2PeerEntry
	}
	::= { bgpM2PeerConfiguredTimersTable 1 }


    BgpM2PeerConfiguredTimersEntry ::= SEQUENCE {
	bgpM2PeerConnectRetryInterval
	    Unsigned32,
	bgpM2PeerHoldTimeConfigured
	    Unsigned32,
	bgpM2PeerKeepAliveConfigured
	    Unsigned32,
	bgpM2PeerMinASOrigInterval
	    Unsigned32,
	bgpM2PeerMinRouteAdverInterval
	    Unsigned32
    }



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 31]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerConnectRetryInterval OBJECT-TYPE
	SYNTAX	   Unsigned32 (1..65535)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the ConnectRetry
	     timer.  The suggested value for this timer is 120
	     seconds."
	::= { bgpM2PeerConfiguredTimersEntry 1 }


    bgpM2PeerHoldTimeConfigured OBJECT-TYPE
	SYNTAX	   Unsigned32 ( 0 | 3..65535 )
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the Hold Time configured
	     for this BGP speaker with this peer.  This value
	     is placed in an OPEN message sent to this peer by
	     this BGP speaker, and is compared with the Hold
	     Time field in an OPEN message received from the
	     peer when determining the Hold Time (bgpM2PeerHoldTime)
	     with the peer.  This value must not be less than
	     three seconds if it is not zero (0) in which case
	     the Hold Time is NOT to be established with the
	     peer.  The suggested value for this timer is 90
	     seconds."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Appendix 6.4"
	::= { bgpM2PeerConfiguredTimersEntry 2 }


    bgpM2PeerKeepAliveConfigured OBJECT-TYPE
	SYNTAX	   Unsigned32 ( 0 | 1..21845 )
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the KeepAlive timer
	     configured for this BGP speaker with this peer.
	     The value of this object will only determine the
	     KEEPALIVE messages frequency relative to the value
	     specified in bgpM2PeerHoldTimeConfigured; the actual
	     time interval for the KEEPALIVE messages is indicated
	     by bgpM2PeerKeepAlive.  A reasonable maximum value
	     for this timer would be configured to be one third
	     of that of bgpM2PeerHoldTimeConfigured.

	     If the value of this object is zero (0), no



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 32]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     periodical KEEPALIVE messages are sent to the peer
	     after the BGP connection has been established.
	     The suggested value for this timer is 30 seconds."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Appendix 6.4"
	::= { bgpM2PeerConfiguredTimersEntry 3 }


    bgpM2PeerMinASOrigInterval OBJECT-TYPE
	SYNTAX	   Unsigned32 (0..65535)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the MinASOriginationInterval
	     timer.  The suggested value for this timer is 15
	     seconds."
	::= { bgpM2PeerConfiguredTimersEntry 4 }


    bgpM2PeerMinRouteAdverInterval OBJECT-TYPE
	SYNTAX	   Unsigned32 (0..65535)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the
	     MinRouteAdvertisementInterval timer.  The suggested
	     value for this timer is 30 seconds."
	::= { bgpM2PeerConfiguredTimersEntry 5 }


    --
    -- Peer Negotiated Timers
    --

    bgpM2PeerNegotiatedTimersTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PeerNegotiatedTimersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Current values of per-peer timers which can be
	     dynamically set in the bgpM2PeerConfiguredTimersTable.
	     Values reflected in this table are the current
	     operational values, after negotiation from values
	     derived from initial configuration or last set from
	     bgpM2PeerConfiguredTimersTable row instances."
	::= { bgpM2PeerTimers 3 }





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 33]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerNegotiatedTimersEntry OBJECT-TYPE
	SYNTAX	   BgpM2PeerNegotiatedTimersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Each entry reflects a value of the currently
	     operational, negotiated timers as reflected in the
	     BgpM2PeerNegotiatedTimersEntry."
	AUGMENTS {
	    bgpM2PeerEntry
	}
	::= { bgpM2PeerNegotiatedTimersTable 1 }


    BgpM2PeerNegotiatedTimersEntry ::= SEQUENCE {
	bgpM2PeerHoldTime
	    Unsigned32,
	bgpM2PeerKeepAlive
	    Unsigned32
    }


    bgpM2PeerHoldTime OBJECT-TYPE
	SYNTAX	   Unsigned32  ( 0 | 3..65535 )
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The value of this object is calculated by this BGP
	     Speaker as being;

	     zero (0) - if this was the value sent by the peer and
	     this value is permitted by this BGP Speaker.  In this
	     case, no keepalive messages are sent and the Hold Timer
	     is not set.

	     At least three (3).  This value is the smaller of
	     the value sent by this peer in the OPEN message and
	     bgpM2PeerHoldTimeConfigured for this peer.

	     This value is only defined when the peering session is
	     in the Established state."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Sec. 4.2"
	::= { bgpM2PeerNegotiatedTimersEntry 1 }


    bgpM2PeerKeepAlive OBJECT-TYPE
	SYNTAX	   Unsigned32 ( 0 | 1..21845 )



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 34]

Internet Draft		       BGP-MIB v2		January 12, 2004


	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the KeepAlive timer
	     established with the peer.	 The value of this object
	     is calculated by this BGP speaker such that, when
	     compared with bgpM2PeerHoldTime, it has the same
	     proportion as what bgpM2PeerKeepAliveConfigured has
	     when compared with bgpM2PeerHoldTimeConfigured.  If
	     the value of this object is zero (0), it indicates
	     that the KeepAlive timer has not been established
	     with the peer, or, the value of
	     bgpM2PeerKeepAliveConfigured is zero (0).

	     This value is only defined when the peering session is
	     in the Established state."
	REFERENCE
	    "draft-ietf-idr-bgp4-17, Sec. 4.4"
	::= { bgpM2PeerNegotiatedTimersEntry 2 }


    --
    -- Peer Capabilities
    --

    bgpM2PeerCapabilities
	OBJECT IDENTIFIER ::= { bgpM2Peer 4 }


    --
    -- Announced Capabilities
    --

    bgpM2PeerCapsAnnouncedTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PeerCapsAnnouncedEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "This table contains the capabilities
	     that are supported for a given peer."
	::= { bgpM2PeerCapabilities 1 }


    bgpM2PeerCapsAnnouncedEntry OBJECT-TYPE
	SYNTAX	   BgpM2PeerCapsAnnouncedEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 35]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    "These entries are keyed by a BGP-4 peer remote
	     address and the BGP Capability Code"
	INDEX {
	    bgpM2PeerIndex,
	    bgpM2PeerCapAnnouncedCode,
	    bgpM2PeerCapAnnouncedIndex
	}
	::= { bgpM2PeerCapsAnnouncedTable 1 }


    BgpM2PeerCapsAnnouncedEntry ::= SEQUENCE {
	bgpM2PeerCapAnnouncedCode
	    Unsigned32,
	bgpM2PeerCapAnnouncedIndex
	    Unsigned32,
	bgpM2PeerCapAnnouncedValue
	    OCTET STRING
    }


    bgpM2PeerCapAnnouncedCode OBJECT-TYPE
	SYNTAX	   Unsigned32 (0..255)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The BGP Capability Advertisement Capability Code."
	::= { bgpM2PeerCapsAnnouncedEntry 1 }


    bgpM2PeerCapAnnouncedIndex OBJECT-TYPE
	SYNTAX	   Unsigned32 (1..128)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Multiple instances of a given capability may be sent
	     bgp a BGP speaker.	 This variable is used to index them."
	::= { bgpM2PeerCapsAnnouncedEntry 2 }


    bgpM2PeerCapAnnouncedValue OBJECT-TYPE
	SYNTAX	   OCTET STRING (SIZE(0..255))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The value of the announced capability."
	::= { bgpM2PeerCapsAnnouncedEntry 3 }





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 36]

Internet Draft		       BGP-MIB v2		January 12, 2004


    --
    -- Received Capabilities
    --

    bgpM2PeerCapsReceivedTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM24PeerCapsReceivedEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "This table contains the capabilities
	    that are supported for a given peer."
	::= { bgpM2PeerCapabilities 2 }


    bgpM2PeerCapsReceivedEntry OBJECT-TYPE
	SYNTAX	   BgpM24PeerCapsReceivedEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "These entries are keyed by a BGP-4 peer remote
	    address and the BGP Capability Code"
	INDEX {
	    bgpM2PeerIndex,
	    bgpM2PeerCapReceivedCode,
	    bgpM2PeerCapReceivedIndex
	}
	::= { bgpM2PeerCapsReceivedTable 1 }


    BgpM24PeerCapsReceivedEntry ::= SEQUENCE {
	bgpM2PeerCapReceivedCode
	    Unsigned32,
	bgpM2PeerCapReceivedIndex
	    Unsigned32,
	bgpM2PeerCapReceivedValue
	    OCTET STRING
    }


    bgpM2PeerCapReceivedCode OBJECT-TYPE
	SYNTAX	   Unsigned32 (0..255)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The BGP Capability Advertisement Capability Code."
	::= { bgpM2PeerCapsReceivedEntry 1 }





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 37]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerCapReceivedIndex OBJECT-TYPE
	SYNTAX	   Unsigned32 (1..128)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Multiple instances of a given capability may be sent
	     bgp a BGP speaker.	 This variable is used to index them."
	::= { bgpM2PeerCapsReceivedEntry 2 }


    bgpM2PeerCapReceivedValue OBJECT-TYPE
	SYNTAX	   OCTET STRING (SIZE(0..255))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The value of the announced capability."
	::= { bgpM2PeerCapsReceivedEntry 3 }


    --
    -- Per-peer counters
    --

    bgpM2PeerCounters
	OBJECT IDENTIFIER ::= { bgpM2Peer 6 }


    bgpM2PeerCountersTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PeerCountersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "The counters associated with a BGP Peer."
	::= { bgpM2PeerCounters 1 }


    bgpM2PeerCountersEntry OBJECT-TYPE
	SYNTAX	   BgpM2PeerCountersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Each entry contains counters of message transmissions
	     and FSM transitions for a given BGP Peering session."
	AUGMENTS {
	    bgpM2PeerEntry
	}
	::= { bgpM2PeerCountersTable 1 }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 38]

Internet Draft		       BGP-MIB v2		January 12, 2004


    BgpM2PeerCountersEntry ::= SEQUENCE {
	bgpM2PeerInUpdates
	    Counter32,
	bgpM2PeerOutUpdates
	    Counter32,
	bgpM2PeerInTotalMessages
	    Counter32,
	bgpM2PeerOutTotalMessages
	    Counter32,
	bgpM2PeerFsmEstablishedTrans
	    Counter32
    }


-- +++wayne need to describe what happens if connection is broken
-- and then reestablished. Does the prior counter value accumulate?
    bgpM2PeerInUpdates OBJECT-TYPE
	SYNTAX	   Counter32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The number of BGP UPDATE messages received on this
	     connection.  This object should be initialized to zero
	     (0) when the connection is established."
	::= { bgpM2PeerCountersEntry 1 }


    bgpM2PeerOutUpdates OBJECT-TYPE
	SYNTAX	   Counter32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The number of BGP UPDATE messages transmitted on this
	     connection.  This object should be initialized to zero
	     (0) when the connection is established."
	::= { bgpM2PeerCountersEntry 2 }


    bgpM2PeerInTotalMessages OBJECT-TYPE
	SYNTAX	   Counter32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The total number of messages received from the remote
	     peer on this connection.  This object should be
	     initialized to zero when the connection is established."
	::= { bgpM2PeerCountersEntry 3 }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 39]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerOutTotalMessages OBJECT-TYPE
	SYNTAX	   Counter32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The total number of messages transmitted to the remote
	     peer on this connection.  This object should be
	     initialized to zero when the connection is established."
	::= { bgpM2PeerCountersEntry 4 }


    bgpM2PeerFsmEstablishedTrans OBJECT-TYPE
	SYNTAX	   Counter32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	"The total number of times the BGP FSM
	transitioned into the established state
	for this peer."
	::= { bgpM2PeerCountersEntry 5 }


    --
    -- Per-Peer Prefix Counters
    --

    bgpM2PrefixCountersTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PrefixCountersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Additional per-peer, per AFI SAFI counters for prefixes"
	::= { bgpM2PeerCounters 2 }


    bgpM2PrefixCountersEntry OBJECT-TYPE
	SYNTAX	   BgpM2PrefixCountersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing information about a bgp-peers prefix
	     counters."
	INDEX {
	    bgpM2PeerIndex,
	    bgpM2PrefixCountersAfi,
	    bgpM2PrefixCountersSafi
	}
	::= { bgpM2PrefixCountersTable 1 }



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 40]

Internet Draft		       BGP-MIB v2		January 12, 2004


    BgpM2PrefixCountersEntry ::= SEQUENCE {
	bgpM2PrefixCountersAfi
	    BgpM2Afi,
	bgpM2PrefixCountersSafi
	    BgpM2Safi,
	bgpM2PrefixInPrefixes
	    Gauge32,
	bgpM2PrefixInPrefixesAccepted
	    Gauge32,
	bgpM2PrefixInPrefixesRejected
	    Gauge32,
	bgpM2PrefixOutPrefixes
	    Gauge32
    }


    bgpM2PrefixCountersAfi OBJECT-TYPE
	SYNTAX	   BgpM2Afi
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The AFI index of the per-peer, per prefix counters"
	::= { bgpM2PrefixCountersEntry 1 }


    bgpM2PrefixCountersSafi OBJECT-TYPE
	SYNTAX	   BgpM2Safi
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The SAFI index of the per-peer, per prefix counters"
	::= { bgpM2PrefixCountersEntry 2 }


    bgpM2PrefixInPrefixes OBJECT-TYPE
	SYNTAX	   Gauge32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The number of prefixes received from a peer and are
	     stored in the Adj-Ribs-In for that peer."
	     -- jmh - note that we are allowing stuff to be discarded
	::= { bgpM2PrefixCountersEntry 7 }


    bgpM2PrefixInPrefixesAccepted OBJECT-TYPE
	SYNTAX	   Gauge32
	MAX-ACCESS read-only



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 41]

Internet Draft		       BGP-MIB v2		January 12, 2004


	STATUS	   current
	DESCRIPTION
	    "The number of prefixes for a peer that are installed
	     in the Adj-Ribs-In and are eligible to become active
	     in the Loc-Rib."
	::= { bgpM2PrefixCountersEntry 8 }


    bgpM2PrefixInPrefixesRejected OBJECT-TYPE
	SYNTAX	   Gauge32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The number of prefixes for a peer that are installed
	     in the Adj-Ribs-In and are NOT eligible to become active
	     in the Loc-Rib."
	::= { bgpM2PrefixCountersEntry 9 }


    bgpM2PrefixOutPrefixes OBJECT-TYPE
	SYNTAX	   Gauge32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The number of prefixes for a peer that are installed
	     in that peers Adj-Ribs-Out."
	::= { bgpM2PrefixCountersEntry 10 }



    bgpM2PeerExtensions
	OBJECT IDENTIFIER ::= { bgpM2Peer 7 }


    bgpM2PeerNonCapExts
	OBJECT IDENTIFIER ::= { bgpM2PeerExtensions 1 }


    bgpM2PeerCapExts
	OBJECT IDENTIFIER ::= { bgpM2PeerExtensions 2 }


    --
    -- Peer Route Reflection Extensions
    --

    bgpM2PeerRouteReflectionExts
	OBJECT IDENTIFIER ::= { bgpM2PeerNonCapExts 2796 }



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 42]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerReflectorClientTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PeerReflectorClientEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Table of route reflection client settings on a per-peer
	     basis."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	::= { bgpM2PeerRouteReflectionExts 1 }


    bgpM2PeerReflectorClientEntry OBJECT-TYPE
	SYNTAX	   BgpM2PeerReflectorClientEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing data on a per-peer basis on whether
	     the peer is configured as a route reflector client."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	AUGMENTS {
	    bgpM2PeerEntry
	}
	::= { bgpM2PeerReflectorClientTable 1 }


    BgpM2PeerReflectorClientEntry ::= SEQUENCE {
	bgpM2PeerReflectorClient
	    INTEGER
    }

    bgpM2PeerReflectorClient OBJECT-TYPE
	SYNTAX	  INTEGER {
	    nonClient(0),
	    client(1),
	    meshedClient(2)
	}
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "This value indicates whether the given peer is a
	     reflector client of this router, or not.  A value of
	     nonClient indicates that this peer is not a reflector
	     client.  A value of client indicates that this peer is a
	     reflector client that is not fully meshed with other
	     reflector clients.	 A value of meshedClient indicates
	     that the peer is a reflector client and is fully meshed



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 43]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     with all other reflector clients.

	     This value must be nonClient (0) for BGP external peers."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	::= { bgpM2PeerReflectorClientEntry 1 }


    --
    -- Peer AS Confederations Extensions
    --

    bgpM2PeerASConfederationExts
	OBJECT IDENTIFIER ::= { bgpM2PeerNonCapExts 3065 }


    bgpM2PeerConfedMemberTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PeerConfedMemberEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Table of confederation member settings on a per-peer
	     basis."
	REFERENCE
	    "RFC 3065 - BGP Confederations"
	::= { bgpM2PeerASConfederationExts 1 }


    bgpM2PeerConfedMemberEntry OBJECT-TYPE
	SYNTAX	   BgpM2PeerConfedMemberEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing data on a per-peer basis on whether
	     the peer is configured as a BGP confederation member."
	REFERENCE
	    "RFC 3065 - BGP Confederations"
	AUGMENTS {
	    bgpM2PeerEntry
	}
	::= { bgpM2PeerConfedMemberTable 1 }


    BgpM2PeerConfedMemberEntry ::= SEQUENCE {
	bgpM2PeerConfedMember
	    TruthValue
    }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 44]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PeerConfedMember OBJECT-TYPE
	SYNTAX	    TruthValue
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "This value indicates whether the given peer is in our
	     confederation or not."
	REFERENCE
	    "RFC 3065 - BGP Confederations"
	::= { bgpM2PeerConfedMemberEntry 1 }


    --
    -- Peer configuration objects
    --

    bgpM2PeerConfiguration
	OBJECT IDENTIFIER ::= { bgpM2Peer 8 }


    --
    -- Administering activated peering sessions
    --

    bgpM2CfgPeerAdminStatusTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2CfgPeerAdminStatusEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Table containing rows for administratively starting and
	     stopping peering sessions."
	::= { bgpM2PeerConfiguration 1 }


    bgpM2CfgPeerAdminStatusEntry OBJECT-TYPE
	SYNTAX	   BgpM2CfgPeerAdminStatusEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing row for administratively starting and
	     stopping peers."
	INDEX {
	    bgpM2PeerIndex
	}
	::= { bgpM2CfgPeerAdminStatusTable 1 }


    BgpM2CfgPeerAdminStatusEntry ::= SEQUENCE {



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 45]

Internet Draft		       BGP-MIB v2		January 12, 2004


	bgpM2CfgPeerAdminStatus
	    INTEGER
    }


    bgpM2CfgPeerAdminStatus OBJECT-TYPE
	SYNTAX	    INTEGER {
	    stop(1),
	    start(2)
	}
	MAX-ACCESS read-write
	STATUS	current
	DESCRIPTION
	    "This object allows the Manual Stop and Manual Start
	     events to be sent to an activated peering session."
	::= { bgpM2CfgPeerAdminStatusEntry 1 }


    --
    -- Peer Configuration
    --

    bgpM2CfgPeerNextIndex OBJECT-TYPE
	SYNTAX	   Integer32 (0..65535)
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This object contains the next appropriate value to
	     use as an index for creation of a row instance in
	     in the bgpM2CfgPeerTable.	If the number of available
	     entries in the bgpM2CfgPeerTable is exhausted, a
	     retrieval value of this object instance will return
	     0.	 A value of 0 may also be returned if the agent
	     is otherwise incapable of bgpM2CfgPeerTable row creation
	     at the time of bgpM2CfgPeerNextIndex retrieval."
	::= { bgpM2PeerConfiguration 2 }


    bgpM2CfgPeerTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2CfgPeerEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "BGP configuration peer table.

	     This table allows the configuration of the parameters
	     for a session with a BGP peer.




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 46]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     +++wayne provide description of how config should be done
	     for a peer per table."
	::= { bgpM2PeerConfiguration 3 }


    bgpM2CfgPeerEntry OBJECT-TYPE
	SYNTAX	   BgpM2CfgPeerEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing information set up by a management
	     entity to configure a connection with a BGP peer."
	INDEX { bgpM2CfgPeerIndex }
	::= { bgpM2CfgPeerTable 1 }


    BgpM2CfgPeerEntry ::= SEQUENCE {
	bgpM2CfgPeerConfiguredVersion
	    Unsigned32,
	bgpM2CfgAllowVersionNegotiation
	    TruthValue,
	bgpM2CfgPeerLocalAddrType
	    InetAddressType,
	bgpM2CfgPeerLocalAddr
	    InetAddress,
	bgpM2CfgPeerLocalAs
	    InetAutonomousSystemNumber,
	bgpM2CfgPeerRemoteAddrType
	    InetAddressType,
	bgpM2CfgPeerRemoteAddr
	    InetAddress,
	bgpM2CfgPeerRemoteAs
	    InetAutonomousSystemNumber,
	bgpM2CfgPeerEntryStorageType
	    StorageType,
	bgpM2CfgPeerError
	    INTEGER,
	bgpM2CfgPeerBgpPeerEntry
	    RowPointer,
	bgpM2CfgPeerRowEntryStatus
	    RowStatus,
	bgpM2CfgPeerIndex
	    Integer32,
	bgpM2CfgPeerStatus
	    INTEGER
	}





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 47]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2CfgPeerConfiguredVersion OBJECT-TYPE
	SYNTAX	   Unsigned32 (1..255)
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "The configured version to originally start with
	     this peer.	 The BGP speaker may permit negotiation
	     to a lower version number of the protocol depending on the
	     set value of bgpM2CfgAllowVersionNegotiation."
	DEFVAL	   { 4 }
	::= { bgpM2CfgPeerEntry 1 }


    bgpM2CfgAllowVersionNegotiation OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "If set to true, during session establishment with this
	     peer, negotiation to a version lower than that specified
	     in bgpM2CfgPeerConfiguredVersion will be allowed."
	DEFVAL { false }
	::= { bgpM2CfgPeerEntry 2 }


    bgpM2CfgPeerLocalAddrType OBJECT-TYPE
	SYNTAX	   InetAddressType
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "The address family of the speakers of this BGP
	     session."
	::= { bgpM2CfgPeerEntry 3 }


    bgpM2CfgPeerLocalAddr OBJECT-TYPE
	SYNTAX	   InetAddress (SIZE (4..20))
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "The address of the local end of the peering session."
	::= { bgpM2CfgPeerEntry 4 }


    bgpM2CfgPeerLocalAs OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-create
	STATUS	   current



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 48]

Internet Draft		       BGP-MIB v2		January 12, 2004


	DESCRIPTION
	    "Autonomous system represented to peer on peering
	     session initialization.  Some implementations of
	     BGP can represent themselves as multiple ASes.
	     These implementations can set this to an alternate
	     autonomous system.	 If this object is set to zero
	     (0) at the point this row instance is set to active,
	     then the implementation will initialize this session
	     representing itself as the value of bgpM2CfgLocalAs."
	DEFVAL { 0 }
	::= { bgpM2CfgPeerEntry 5 }


    bgpM2CfgPeerRemoteAddrType OBJECT-TYPE
	SYNTAX	   InetAddressType
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "The address family of the speakers of the remote BGP
	     session."
	::= { bgpM2CfgPeerEntry 6 }


    bgpM2CfgPeerRemoteAddr OBJECT-TYPE
	SYNTAX	    InetAddress (SIZE(4..20))
	MAX-ACCESS  read-create
	STATUS	    current
	DESCRIPTION
	    "The address of the remote end (destination address
	     of peer) for peering session."
	::= { bgpM2CfgPeerEntry 7 }


    bgpM2CfgPeerRemoteAs OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "Autonomous system number of the remote peer."
	::= { bgpM2CfgPeerEntry 8 }


    bgpM2CfgPeerEntryStorageType OBJECT-TYPE
	SYNTAX	   StorageType
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "This object type specifies the intended storage



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 49]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     type for the bgpM2CfgPeerEntry row instance."
	::= { bgpM2CfgPeerEntry 9 }


    bgpM2CfgPeerError  OBJECT-TYPE
	SYNTAX	    INTEGER {
	    unknown(0),
	    notActivated (1),
	    errDuplicatePeeringSession (2),
	    activated (3)
	    -- +++wayne more to follow
	}
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "This value indicates the current error status of
	     the row denoting the configured error status.

	     If this row is still under creation (has not been activated
	     bgpM2CfgPeerRowEntryStatus), then this instance will be set to
	     not-activated (1).

	     At the point that the row is activated, bgpM2CfgPeerError
	     will reflect the error status of the row data itself.  If
	     there is another session already activated with the same
	     local and remote addresses as denoted by
	     {bgpM2CfgPeerLocalAddrType, bgpM2CfgPeerLocalAddr,
	     bgpM2CfgPeerRemoteAddr}, then
	     the value of this will be set to
	     err-duplicate-peering-session (2).

	     If this row is associated with a peer session whose
	     initialization has been attempted, the value will be
	     set to activated (3) (and, bgpM2PeerCfgPeerEntry will
	     be set to the row instance of the entry in the
	     bgpM2PeerTable which reflects the state of the peering
	     session).

	     Note that this object only reflects the error as a
	     function of the attempted activation of this row as
	     containing data for a bgp peering session.	 The actual
	     state of the session at the point of any protocol exchange
	     or session state machine initiation is reflected in the
	     bgpM2PeerTable row instance (as reflected through
	     bgpM2CfgPeerPeerEntry) associated with this row instance."
	::= { bgpM2CfgPeerEntry 10 }





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 50]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2CfgPeerBgpPeerEntry OBJECT-TYPE
	SYNTAX	    RowPointer
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "Upon activation of the session data contained in this
	     row instance, this object points to an instance of a row
	     within the bgpM2PeerTable reflecting the session in its
	     initializing or operational state.	 Retrieval of this
	     column instance will always yield a value of {0.0} unless
	     the session has successfully been activated (via
	     bgpM2CfgPeerRowEntryStatus).  Such row instances will always
	     have a value of bgpM2CfgPeerError which is activated (3)."
	::= { bgpM2CfgPeerEntry 11 }


    bgpM2CfgPeerRowEntryStatus	OBJECT-TYPE
	SYNTAX	   RowStatus
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "This object type is used to control creation,
	     activation, and deletion of this row instance."
	    -- +++wayne need better directions for agent auto-removal
	    -- of row instances which have moved to active or error
	    -- state
	::= { bgpM2CfgPeerEntry 12 }


    bgpM2CfgPeerIndex OBJECT-TYPE
	SYNTAX	   Integer32 (1..65535)
	MAX-ACCESS accessible-for-notify
	STATUS	   current
	DESCRIPTION
	    "Uniquely identifies an instance of a peer row, as
	     an element of configuration."
	::= { bgpM2CfgPeerEntry 13 }


    bgpM2CfgPeerStatus OBJECT-TYPE
	SYNTAX	    INTEGER {
	    halted(1),
	    running(2)
	}
	MAX-ACCESS read-create
	STATUS	current
	DESCRIPTION
	     "This specifies the state of the peering session upon



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 51]

Internet Draft		       BGP-MIB v2		January 12, 2004


	      activation.  If disabled, the FSM is in the halted
	      state and no Automatic Start events are generated.
	      If enabled, the FSM is in the running state and
	      Automatic Start events may be generated."
	::= { bgpM2CfgPeerEntry 14 }


    --
    -- Per-peer timers table
    --

    bgpM2CfgPeerTimersTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2CfgPeerTimersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Table for configuration of per-peer timers."
	::= {  bgpM2PeerConfiguration 4 }


    bgpM2CfgPeerTimersEntry OBJECT-TYPE
	SYNTAX	    BgpM2CfgPeerTimersEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing per-peer timer configuration."
	AUGMENTS {
	    bgpM2CfgPeerEntry
	}
	::= { bgpM2CfgPeerTimersTable 1 }


    BgpM2CfgPeerTimersEntry ::= SEQUENCE {
	bgpM2CfgPeerConnectRetryInterval
	    Unsigned32,
	bgpM2CfgPeerHoldTimeConfigured
	    Unsigned32,
	bgpM2CfgPeerKeepAliveConfigured
	    Unsigned32,
	bgpM2CfgPeerMinASOrigInterval
	    Unsigned32,
	bgpM2CfgPeerMinRouteAdverInter
	    Unsigned32
    }


    bgpM2CfgPeerConnectRetryInterval OBJECT-TYPE
	SYNTAX	   Unsigned32 (1..65535)



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 52]

Internet Draft		       BGP-MIB v2		January 12, 2004


	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the ConnectRetry
	     timer.  The suggested value for this timer is 120
	     seconds."
	DEFVAL {
	    120
	}
	::= { bgpM2CfgPeerTimersEntry 1 }


    bgpM2CfgPeerHoldTimeConfigured OBJECT-TYPE
	SYNTAX	   Unsigned32 ( 0 | 3..65535 )
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the Hold Time configured
	     for this BGP speaker with this peer.  This value
	     is placed in an OPEN message sent to this peer by
	     this BGP speaker, and is compared with the Hold
	     Time field in an OPEN message received from the
	     peer when determining the Hold Time (bgpM2PeerHoldTime)
	     with the peer.  This value must not be less than
	     three seconds if it is not zero (0) in which case
	     the Hold Time is NOT to be established with the
	     peer.  The suggested value for this timer is 90
	     seconds."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Appendix 6.4"
	DEFVAL {
	    90
	}
	::= { bgpM2CfgPeerTimersEntry 2 }


    bgpM2CfgPeerKeepAliveConfigured OBJECT-TYPE
	SYNTAX	   Unsigned32 ( 0 | 1..21845 )
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the KeepAlive timer
	     configured for this BGP speaker with this peer.
	     The value of this object will only determine the
	     KEEPALIVE messages frequency relative to the value
	     specified in bgpM2PeerHoldTimeConfigured; the actual
	     time interval for the KEEPALIVE messages is indicated
	     by bgpM2PeerKeepAlive.  A reasonable maximum value



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 53]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     for this timer would be configured to be one third
	     of that of bgpM2PeerHoldTimeConfigured.

	     If the value of this object is zero (0), no
	     periodical KEEPALIVE messages are sent to the peer
	     after the BGP connection has been established.
	     The suggested value for this timer is 30 seconds."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Appendix 6.4"
	DEFVAL {
	    30
	}
	::= { bgpM2CfgPeerTimersEntry 3 }


    bgpM2CfgPeerMinASOrigInterval OBJECT-TYPE
	SYNTAX	   Unsigned32 (0..65535)
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the MinASOriginationInterval
	     timer.  The suggested value for this timer is 15
	     seconds."
	DEFVAL {
	    15
	}
	::= { bgpM2CfgPeerTimersEntry 4 }


    bgpM2CfgPeerMinRouteAdverInter OBJECT-TYPE
	SYNTAX	   Unsigned32 (0..65535)
	MAX-ACCESS read-create
	STATUS	   current
	DESCRIPTION
	    "Time interval in seconds for the
	     MinRouteAdvertisementInterval timer.  The suggested
	     value for this timer is 30 seconds."
	DEFVAL {
	    30
	}
	::= { bgpM2CfgPeerTimersEntry 5 }


    --
    -- Per-peer configuration extensions
    --

    bgpM2CfgPeerExtensions



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 54]

Internet Draft		       BGP-MIB v2		January 12, 2004


	OBJECT IDENTIFIER ::= { bgpM2PeerConfiguration 5 }


    bgpM2CfgPeerNonCapExts
	OBJECT IDENTIFIER ::= { bgpM2CfgPeerExtensions 1 }


    bgpM2CfgPeerCapExts
	OBJECT IDENTIFIER ::= { bgpM2CfgPeerExtensions 2 }


    --
    -- Peer route reflection configuration
    --

    bgpM2CfgPeerRouteReflectionExts
	OBJECT IDENTIFIER ::= { bgpM2CfgPeerNonCapExts 2796 }


    bgpM2CfgPeerReflectorClientTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2CfgPeerReflectorClientEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Table of route reflection client settings on a per-peer
	     basis."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	::= { bgpM2CfgPeerRouteReflectionExts 1 }


    bgpM2CfgPeerReflectorClientEntry OBJECT-TYPE
	SYNTAX	   BgpM2CfgPeerReflectorClientEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing data on a per-peer basis on whether
	     the peer is configured as a route reflector client."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	AUGMENTS {
	    bgpM2CfgPeerEntry
	}
	::= { bgpM2CfgPeerReflectorClientTable 1 }


    BgpM2CfgPeerReflectorClientEntry ::= SEQUENCE {
	bgpM2CfgPeerReflectorClient



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 55]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    INTEGER
    }

    bgpM2CfgPeerReflectorClient OBJECT-TYPE
	SYNTAX	  INTEGER {
	    nonClient(0),
	    client(1),
	    meshedClient(2)
	}
	MAX-ACCESS  read-create
	STATUS	    current
	DESCRIPTION
	    "This value indicates whether the given peer is a
	     reflector client of this router, or not.  A value of
	     nonClient indicates that this peer is not a reflector
	     client.  A value of client indicates that this peer is a
	     reflector client that is not fully meshed with other
	     reflector clients.	 A value of meshedClient indicates
	     that the peer is a reflector client and is fully meshed
	     with all other reflector clients.

	     This value must be nonClient (0) for BGP external peers."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	::= { bgpM2CfgPeerReflectorClientEntry 1 }


    --
    -- Peer AS Confederations Extensions
    --

    bgpM2CfgPeerASConfederationExts
	OBJECT IDENTIFIER ::= { bgpM2CfgPeerNonCapExts 3065 }


    bgpM2CfgPeerConfedMemberTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2CfgPeerConfedMemberEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Table of confederation member settings on a per-peer
	     basis."
	REFERENCE
	    "RFC 3065 - BGP Confederations"
	::= { bgpM2CfgPeerASConfederationExts 1 }


    bgpM2CfgPeerConfedMemberEntry OBJECT-TYPE



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 56]

Internet Draft		       BGP-MIB v2		January 12, 2004


	SYNTAX	   BgpM2CfgPeerConfedMemberEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing data on a per-peer basis on whether
	     the peer is configured as a BGP confederation member."
	REFERENCE
	    "RFC 3065 - BGP Confederations"
	AUGMENTS {
	    bgpM2PeerEntry
	}
	::= { bgpM2CfgPeerConfedMemberTable 1 }


    BgpM2CfgPeerConfedMemberEntry ::= SEQUENCE {
	bgpM2CfgPeerConfedMember
	    TruthValue
    }


    bgpM2CfgPeerConfedMember OBJECT-TYPE
	SYNTAX	    TruthValue
	MAX-ACCESS  read-create
	STATUS	    current
	DESCRIPTION
	    "This value indicates whether the given peer is in our
	     confederation or not."
	REFERENCE
	    "RFC 3065 - BGP Confederations"
	::= { bgpM2CfgPeerConfedMemberEntry 1 }


    --
    -- BGP NLRI Data
    --

    bgpM2Rib
	OBJECT IDENTIFIER ::= { bgpM2 3 }


    --
    -- NLRI Table
    --

    bgpM2NlriTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2NlriEntry
	MAX-ACCESS not-accessible
	STATUS	   current



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 57]

Internet Draft		       BGP-MIB v2		January 12, 2004


	DESCRIPTION
	    "The BGP-4 Received Path Attribute Table contains
	     information about paths to destination networks
	     received from all BGP4 peers.  Collectively, this
	     represents the Adj-Ribs-In.  The route where
	     bgpM2NlriBest is TRUE represents, for this NLRI,
	     the route that is installed in the LocRib from the
	     Adj-Ribs-In."
	::= { bgpM2Rib 1 }


    bgpM2NlriEntry OBJECT-TYPE
	SYNTAX	   BgpM2NlriEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Information about a path to a network."
	INDEX {
	    bgpM2PeerIndex,
	    bgpM2NlriAfi,
	    bgpM2NlriSafi,
	    bgpM2NlriPrefix,
	    bgpM2NlriPrefixLen,
	    bgpM2NlriIndex
	}
	::= { bgpM2NlriTable 1 }


    BgpM2NlriEntry ::= SEQUENCE {
	bgpM2NlriIndex
	    Unsigned32,
	bgpM2NlriAfi
	    BgpM2Afi,
	bgpM2NlriSafi
	    BgpM2Safi,
     bgpM2NlriPrefixType
	 InetAddressType,
	bgpM2NlriPrefix
	    InetAddress,
	bgpM2NlriPrefixLen
	    InetAddressPrefixLength,
	bgpM2NlriBest
	    TruthValue,
	bgpM2NlriCalcLocalPref
	    Unsigned32,
	bgpM2PathAttrIndex
	    Unsigned32,
	bgpM2NlriOpaqueType



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 58]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    INTEGER,
	bgpM2NlriOpaquePointer
	    RowPointer
    }


    bgpM2NlriIndex OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This index allows for multiple instances of a base
	     prefix for a certain AFI SAFI from a given peer.
	     This is currently useful for two things:
	     1. Allowing for a peer in future implementations to
		send more than a single route instance.
	     2. Allow for extensions which extend the NLRI field
		to send the same prefix while utilizing other
		extension specific information.	 An example of
		this is RFC 3107 - Carrying MPLS labels in BGP."
	REFERENCE
	    "RFC 3107 - Carrying Label Information in BGP-4"
	::= { bgpM2NlriEntry 1 }


    bgpM2NlriAfi OBJECT-TYPE
	SYNTAX	   BgpM2Afi
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The address family of the prefix for this NLRI."
	::= { bgpM2NlriEntry 2 }


    bgpM2NlriSafi OBJECT-TYPE
	SYNTAX	   BgpM2Safi
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The subsequent address family of the prefix for
	     this NLRI"
	REFERENCE
	    "RFC 2858 - Multiprotocol Extensions for BGP-4"
	::= { bgpM2NlriEntry 3 }


    bgpM2NlriPrefixType OBJECT-TYPE
	SYNTAX	   InetAddressType



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 59]

Internet Draft		       BGP-MIB v2		January 12, 2004


	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The type of the IP address prefix in the
	  Network Layer Reachability Information field.
	  The value of this object is derived from the
	  appropriate value from the bgpM2NlriAfi field.
	  Where an appropriate InetAddressType is not
	  available, the value of the object must be
	  unknown(0).

	  XXX TODO - This seems like a hack."
	::= { bgpM2NlriEntry 4 }


    bgpM2NlriPrefix OBJECT-TYPE
	SYNTAX	   InetAddress	(SIZE (4..20))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "An IP address prefix in the Network Layer
	     Reachability Information field.  This object
	     is an IP address containing the prefix with
	     length specified by
	     bgpM2PathAttrAddrPrefixLen.
	     Any bits beyond the length specified by
	     bgpM2PathAttrAddrPrefixLen are zeroed."
	::= { bgpM2NlriEntry 5 }


    bgpM2NlriPrefixLen OBJECT-TYPE
	SYNTAX	   InetAddressPrefixLength
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Length in bits of the address prefix in
	     the Network Layer Reachability Information field."
	::= { bgpM2NlriEntry 6 }


    bgpM2NlriBest OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "An indication of whether or not this route
	     was chosen as the best BGP4 route."
	::= { bgpM2NlriEntry 7 }



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 60]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2NlriCalcLocalPref OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The degree of preference calculated by the
	     receiving BGP4 speaker for an advertised
	     route."
	::= { bgpM2NlriEntry 8 }


    bgpM2PathAttrIndex OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value is a unique index for the per-NLRI entry
	     in the bgpM2PathAttrTable.	 It is assigned by the
	     agent at the point of creation of the bgpM2PathAttrTable
	     row entry.	 While its value is guaranteed to be unique
	     at any time, it is otherwise opaque to the management
	     application with respect to its value or the contiguity
	     of bgpM2PathAttrIndex row instance values across rows
	     of the bgpM2PeerAttrTable.	 It is used to provide an
	     index structure for other tables whose data is logically
	     per-peer, per-NLRI."
	::= { bgpM2NlriEntry 9 }


    bgpM2NlriOpaqueType OBJECT-TYPE
	SYNTAX	   INTEGER {
	    none(0),
	    bgpMplsLabelStack(1)
	}
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This object enumerates the type of the row that is
	     pointed to in the table row bgpM2NlriOpaquePointer
	     instance, if bgpM2NlriOpaquePointer is in fact not
	     a zero length.  bgpM2NlriOpaqueType is necessary since
	     the data referenced by bgpM2NlriOpaquePointer is
	     opaque to BGP.  For example, in the case of RFC 3107,
	     the label stack that is pointed to may occur in the
	     mplsLabelStackTable from the MPLS-LSR-MIB, and the
	     instance value of bgpM2NlriOpaqueType would be
	     bgpMplsLabelStack(1)."
	REFERENCE



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 61]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    "RFC 3107 - Carrying Label Information in BGP-4
	     draft-ietf-mpls-lsr-mib-08.txt"
	::= { bgpM2NlriEntry 10 }


    bgpM2NlriOpaquePointer OBJECT-TYPE
	SYNTAX	   RowPointer
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Pointer to a row that decomposes the data that is
	     opaque to the BGP MIB but is sent in the NLRI.
	     This RowPointer has zero (0) length data instance
	     if bgpM2NlriOpaqueType is none."
	::= { bgpM2NlriEntry 11 }


    --
    -- Adj-Ribs-Out Table
    --

    bgpM2AdjRibsOutTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2AdjRibsOutEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "This table contains on a per-peer basis one or more
	     routes from the bgpM2NlriTable that have been
	     placed in this peer's Adj-Ribs-Out."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Sec. 3.2"
	::= { bgpM2Rib 2 }


    bgpM2AdjRibsOutEntry OBJECT-TYPE
	SYNTAX	   BgpM2AdjRibsOutEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "List of BGP routes that have been placed into a
	     peer's Adj-Ribs-Out."
	INDEX {
	    bgpM2PeerIndex,
	    bgpM2NlriAfi,
	    bgpM2NlriSafi,
	    bgpM2NlriPrefix,
	    bgpM2NlriPrefixLen,
	    bgpM2AdjRibsOutIndex



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 62]

Internet Draft		       BGP-MIB v2		January 12, 2004


	}
	::= { bgpM2AdjRibsOutTable 1 }


    BgpM2AdjRibsOutEntry ::= SEQUENCE {
	bgpM2AdjRibsOutIndex
	    Unsigned32,
	bgpM2AdjRibsOutRoute
	    RowPointer
    }


    bgpM2AdjRibsOutIndex OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Certain extensions to BGP permit multiple instance of
	     a per afi, per safi prefix to be advertised to a peer.
	     This object allows the enumeration of them."
	::= { bgpM2AdjRibsOutEntry 1 }


    bgpM2AdjRibsOutRoute OBJECT-TYPE
	SYNTAX	   RowPointer
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This object points to the route in the bgpM2NlriTable
	     that corresponds to the entry in the peer's
	     Adj-Rib-Out.  Outgoing route maps are not
	     reflected at this point as those are part of the
	     Update-Send process."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Sec. 9.2"
	::= { bgpM2AdjRibsOutEntry 2 }


    --
    -- BGP Rib Path Attributes Table
    --

    --
    -- Path Attribute Counter
    --

    bgpM2PathAttrCount OBJECT-TYPE
	SYNTAX	   Counter32



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 63]

Internet Draft		       BGP-MIB v2		January 12, 2004


	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The number of entries in the bgpM2PathAttrTable."
	::= { bgpM2Rib 3 }


    --
    -- Path Attributes Table
    --

    bgpM2PathAttrTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PathAttrEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Provides per advertised network-prefix attribute data,
	     as advertised over a peering session."
	::= { bgpM2Rib 4 }


    bgpM2PathAttrEntry OBJECT-TYPE
	SYNTAX	   BgpM2PathAttrEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Each entry contains data about a given network
	     prefix, per-prefix and per-advertising peer."
	INDEX {
	    bgpM2PathAttrIndex
	}
	::= { bgpM2PathAttrTable 1 }


    BgpM2PathAttrEntry ::= SEQUENCE {
	bgpM2PathAttrOrigin
	    INTEGER,
	bgpM2PathAttrNextHopAddrType
	    InetAddressType,
	bgpM2PathAttrNextHop
	    InetAddress,
	bgpM2PathAttrMedPresent
	    TruthValue,
	bgpM2PathAttrMed
	    Unsigned32,
	bgpM2PathAttrLocalPrefPresent
	    TruthValue,
	bgpM2PathAttrLocalPref



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 64]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    Unsigned32,
	bgpM2PathAttrAtomicAggregate
	    INTEGER,
	bgpM2PathAttrAggregatorAS
	    InetAutonomousSystemNumber,
	bgpM2PathAttrAggregatorAddr
	    BgpM2Identifier,
	bgpM2AsPathCalcLength
	    Unsigned32,
	bgpM2AsPathString
	    SnmpAdminString,
	bgpM2AsPathIndex
	    Unsigned32
    }


    bgpM2PathAttrOrigin OBJECT-TYPE
	SYNTAX	   INTEGER {
	    igp(1),-- networks are interior
	    egp(2),-- networks learned via the EGP protocol
	    incomplete(3) -- undetermined
	    }
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The ultimate origin of the path information."
	::= { bgpM2PathAttrEntry 1 }


    bgpM2PathAttrNextHopAddrType OBJECT-TYPE
	SYNTAX	    InetAddressType
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "The address family of the address for
	     the border router that should be used
	     to access the destination network."
	::= { bgpM2PathAttrEntry 2 }


    bgpM2PathAttrNextHop OBJECT-TYPE
	SYNTAX	   InetAddress (SIZE(4..20))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The address of the border router that
	     should be used to access the destination
	     network.  This address is the nexthop



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 65]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     address received in the UPDATE packet.
	     The address family of this object will be the
	     same as that of the prefix in this row.

	     Note that for RFC2545 style double nexthops,
	     this object will always contain the global scope
	     nexthop.  bgpM2LinkLocalNextHopTable will contain
	     the linklocal scope nexthop.

	     In the case that the mechanism documented in
	     draft-kato-bgp-ipv6-link-local-00.txt is used and
	     only a link local nexthop has been sent, ,
	     bgpM2LinkLocalNextHopPresent will be false
	     and bgpM2PathAttrNextHop will contain the link local
	     nexthop."
	::= { bgpM2PathAttrEntry 3 }


    bgpM2PathAttrMedPresent OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Whether or not the MED value is present.
	     If it is not present, the bgpM2PathAttrMed
	     object has no useful value and should be set to 0."
	::= { bgpM2PathAttrEntry 4 }


    bgpM2PathAttrMed OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This metric is used to discriminate
	     between multiple exit points to an
	     adjacent autonomous system."
	::= { bgpM2PathAttrEntry 5 }


    bgpM2PathAttrLocalPrefPresent OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Whether or not the LocalPref value is present.
	     If it is not present, the bgpM2PathAttrLocalPref
	     object has no useful value and should be set to 0."



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 66]

Internet Draft		       BGP-MIB v2		January 12, 2004


	::= { bgpM2PathAttrEntry 6 }


    bgpM2PathAttrLocalPref OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The originating BGP4 speakers degree of
	     preference for an advertised route."
	::= { bgpM2PathAttrEntry 7 }


    bgpM2PathAttrAtomicAggregate OBJECT-TYPE
	SYNTAX	   INTEGER {
	    atomicAggregatePresent(1),
	    atomicAggregateMissing(2)
	    }
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "When this object is set to atomicAggregatePresent,
	  the ATOMIC_AGGREGATE Path Attribute is present
	  and indicates that the NLRI MUST NOT be made
	  more specific."
	::= { bgpM2PathAttrEntry 8 }


    bgpM2PathAttrAggregatorAS OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The AS number of the last BGP4 speaker that
	     performed route aggregation.  A value of
	     zero (0) indicates the absence of this
	     attribute.

	     Note propagation of AS of zero is illegal in
	     the Internet."
	::= { bgpM2PathAttrEntry 9 }


    bgpM2PathAttrAggregatorAddr OBJECT-TYPE
	SYNTAX	   BgpM2Identifier
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 67]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    "The IP address of the last BGP4 speaker
	     that performed route aggregation.	A
	     value of 0.0.0.0 indicates the absence
	     of this attribute."
	::= { bgpM2PathAttrEntry 10 }


    bgpM2AsPathCalcLength OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value represents the calculated length of the
	     AS Path according to the rules of the BGP specification.
	     This value is used in route selection."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Sec. 9.1.2.2.a"
	::= { bgpM2PathAttrEntry 11 }


    bgpM2AsPathString OBJECT-TYPE
	SYNTAX	   SnmpAdminString
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This is a string depicting the autonomous system
	     path to this network which was received from the
	     peer which advertised it.	The format of the string
	     is implementation-dependent, and should be designed
	     for operator readability."
	::= { bgpM2PathAttrEntry 12 }


    bgpM2AsPathIndex OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value is a unique index for the decomposed AS Path
	     in the bgpM2AsPathTable.  It is assigned by the
	     agent at the point of creation of the bgpM2AsPathTable
	     row entry.	 While its value is guaranteed to be unique
	     at any time, it is otherwise opaque to the management
	     application with respect to its value or the contiguity
	     of bgpM2AsPathIndex row instance values across rows
	     of the bgpM2AsPathTable."
	::= { bgpM2PathAttrEntry 13 }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 68]

Internet Draft		       BGP-MIB v2		January 12, 2004


    --
    -- As-4 byte AS_PATH
    --

    bgpM2AsPath4byteTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2AsPath4byteEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "This table is present for BGP speakers that support
	     the AS 4byte specification and are functioning as
	     a router between 2-byte and 4-byte AS space."
	REFERENCE
	    "draft-ietf-idr-as4bytes-04.txt - BGP support for
	     four-octet AS number space"
	::= { bgpM2Rib 5 }


    bgpM2AsPath4byteEntry OBJECT-TYPE
	SYNTAX	   BgpM2AsPath4byteEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Each row contains the information for the AS 4-byte
	     extension's NEW_AS_PATH and NEW_AGGREGATOR attributes."
	AUGMENTS {
	    bgpM2PathAttrEntry
	}
	::= { bgpM2AsPath4byteTable 1 }


    BgpM2AsPath4byteEntry ::= SEQUENCE {
	bgpM2AsPath4bytePathPresent
	    TruthValue,
	bgpM2AsPath4byteAggregatorAS
	    InetAutonomousSystemNumber,
	bgpM2AsPath4byteCalcLength
	    Unsigned32,
	bgpM2AsPath4byteString
	    SnmpAdminString,
	bgpM2AsPath4byteIndex
	    Unsigned32
    }


    bgpM2AsPath4bytePathPresent OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-only



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 69]

Internet Draft		       BGP-MIB v2		January 12, 2004


	STATUS	   current
	DESCRIPTION
	    "This value may only be true if this BGP Speaker
	     is functioning as a router between ASs that
	     are in 2-byte and 4-byte AS space.	 If this
	     value is true, then the NEW_AS_PATH attributes
	     are present and the 4-byte versions of the
	     appropriate path attributes are in this row.

	     If this value is false, then the following values
	     will be present in the row:

	     bgpM2PathAttrAggregatorAS - zero (0).
	     bgpM2AsPathCalcLength - zero (0).
	     bgpM2AsPathString - zero (0) length string.
	     bgpM2AsPathIndex - zero (0)."
	::= { bgpM2AsPath4byteEntry 1 }


    bgpM2AsPath4byteAggregatorAS OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The NEW_AGGREGATOR AS number of the last BGP4 speaker
	     that performed route aggregation.	A value of
	     zero (0) indicates the absence of this
	     attribute.

	     Note propagation of AS of zero is illegal in
	     the Internet."
	::= { bgpM2AsPath4byteEntry 2 }


    bgpM2AsPath4byteCalcLength OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value represents the calculated length of the
	     NEW_AS_PATH according to the rules of the BGP specification.
	     This value is used in route selection."
	REFERENCE
	    "draft-ietf-idr-bgp4-17.txt, Sec. 9.1.2.2.a"
	::= { bgpM2AsPath4byteEntry 3 }


    bgpM2AsPath4byteString OBJECT-TYPE



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 70]

Internet Draft		       BGP-MIB v2		January 12, 2004


	SYNTAX	   SnmpAdminString
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This is a string depicting the autonomous system
	     path to this network which was received from the
	     peer which advertised it.	The format of the string
	     is implementation-dependent, and should be designed
	     for operator readability."
	::= { bgpM2AsPath4byteEntry 4 }


    bgpM2AsPath4byteIndex OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value is a unique index for the decomposed AS Path
	     in the bgpM2AsPathTable.  It is assigned by the
	     agent at the point of creation of the bgpM2AsPathTable
	     row entry.	 While its value is guaranteed to be unique
	     at any time, it is otherwise opaque to the management
	     application with respect to its value or the contiguity
	     of bgpM2AsPathIndex row instance values across rows
	     of the bgpM2AsPathTable. "
	::= { bgpM2AsPath4byteEntry 5 }


    --	  BGP 4 Path attribute AS Path Table.  There is one row in
    --	  this table for each AS which is advertised for a given
    --	  route as provided from a peer.

-- JMH
-- We need one of these for the NewAsPath for the 4byte draft

    bgpM2AsPathTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2AsPathEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "The BGP-4 Path Attribute AS Path Table
	     contains the per network path (NLRI)
	     AS PATH data received from the
	     advertising BGP peer."
	::= { bgpM2Rib 6 }


    bgpM2AsPathTableEntry OBJECT-TYPE



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 71]

Internet Draft		       BGP-MIB v2		January 12, 2004


	SYNTAX	   BgpM2AsPathEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Information about an AS path provided with a path to
	     a network."
	INDEX {
	    bgpM2PathAttrIndex,
	    bgpM2AsPathSegmentIndex,
	    bgpM2AsPathElementIndex
	}
	::= { bgpM2AsPathTable 1 }


    BgpM2AsPathEntry ::= SEQUENCE {
	bgpM2AsPathSegmentIndex
	    Unsigned32,
	bgpM2AsPathElementIndex
	    Unsigned32,
	bgpM2AsPathType
	    INTEGER,
	bgpM2AsPathElementValue
	    InetAutonomousSystemNumber
    }


    bgpM2AsPathSegmentIndex OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "A per-AS path segment index.  This will index a set of
	     autonomous systems in an AS path which are part
	     of the same sequence or set (as determined by
	     the row value of bgpM2AsPathType, which
	     should be the same value for each bgpM2AsPathTable
	     entry indexed by the same (bgpM2PathAttrIndex,
	     bgpM2AsPathIndex) pair)."
	::= { bgpM2AsPathTableEntry 1 }


    bgpM2AsPathElementIndex OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "A per-AS element index.  This will index a particular
	     AS within a sequence or set of autonomous systems in



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 72]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     an AS path."
	::= { bgpM2AsPathTableEntry 2 }


    bgpM2AsPathType OBJECT-TYPE
	SYNTAX	INTEGER {
	    asSet(1),
	    asSequence(2),
	    confedSequence(3),
	    confedSet(4)
	 }
	 MAX-ACCESS  read-only
	 STATUS	     current
	 DESCRIPTION
	     "The type of sequence in which this asPath
	      was advertised as an attribute.  Note that
	      all asPath row instances for a given (bgpM2PathAttrIndex,
	      bgpM2AsPathIndex) index pair will have their
	      bgpM2AsPathType set to the same value.
	      The values for bgpM2AsPathType are
	      interpreted as defined in the base BGP document
	      and the BGP AS Confederations document."
	REFERENCE
	    "draft-ietf-idr-bgp4-16
	     RFC 3065 - BGP AS Confederations"
	::= { bgpM2AsPathTableEntry 3 }


    bgpM2AsPathElementValue OBJECT-TYPE
	SYNTAX	   InetAutonomousSystemNumber
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "An AS value for an AS the related NLRI traversed
	     in the propagation of its advertisement.  This
	     value is to be interpreted in the context of the
	     sequence implied by bgpM2AsPathIndex and
	     bgpM2AsPathType (and, in sequence of the
	     other table rows with the same value of
	     bgpM2PathAttrIndex and bgpM2AsPathIndex)."
	::= { bgpM2AsPathTableEntry 4 }


    --	  BGP 4 Path unknown attribute.	 There is one row in
    --	  this table for each attribute not known by this BGP
    --	  implementation (or agent instrumentation), but provided
    --	  from a peer.




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 73]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PathAttrUnknownTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PathAttrUnknownEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "The BGP-4 Path Attribute Unknown Table
	     contains the per network path (NLRI)
	     data on the path attributes advertised
	     with a route but not known to the local BGP implementation
	     or not otherwise capable of being returned from this agent.

	     The absence of row data for a given index value for
	     bgpM2PathAttrIndex indicates a lack of such unknown
	     attribute information for the indicated network path
	     (as indexed by that bgpM2PathAttrIndex value in the
	     bgpM2PathAttrTable)."
	::= { bgpM2Rib 7 }


    bgpM2PathAttrUnknownEntry OBJECT-TYPE
	SYNTAX	   BgpM2PathAttrUnknownEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Information about an unknown attribute
	     provided with a path to a network."
	INDEX {
	    bgpM2PathAttrIndex,
	    bgpM2PathAttrUnknownIndex
	}
	::= { bgpM2PathAttrUnknownTable 1 }


    BgpM2PathAttrUnknownEntry ::= SEQUENCE {
	bgpM2PathAttrUnknownIndex
	    Unsigned32,
	bgpM2PathAttrUnknownType
	    Unsigned32,
	bgpM2PathAttrUnknownValue
	    OCTET STRING
    }


    bgpM2PathAttrUnknownIndex OBJECT-TYPE
	SYNTAX Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 74]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    "An integer index for a row in this table."
	::= { bgpM2PathAttrUnknownEntry 1 }


    bgpM2PathAttrUnknownType OBJECT-TYPE
	SYNTAX Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "The attribute type advertised with this unknown
	     attribute by the peer."
	::= { bgpM2PathAttrUnknownEntry 2 }


    -- Maximum size of the following is derived as
    --	   4096	  max message size
    --	 -  16	  BGP message marker bytes
    --	 -   2	  BGP message size
    --	 -   1	  BGP message type (UPDATE with unknown attr)
    --	 -   2	  UPDATE routes length (even assuming no routes)
    --	 -   2	  UPDATE path attributes length
    --	 -   1	  path attribute flag octet
    --	 -   2	  unknown path attr type (in bgpM2PathAttrUnknownType)
    --	---------
    --	  4070 bytes maximum per-message attribute value data


    bgpM2PathAttrUnknownValue OBJECT-TYPE
	SYNTAX	   OCTET STRING (SIZE(0..4070))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "Value of path attribute not understood
	     by the base BGP-4 document.

	     Octets beyond the maximum size, if any,
	     are not recorded by this row object. "
	::= { bgpM2PathAttrUnknownEntry 3 }


    --
    -- Path Attribute Extensions
    --

    bgpM2PathAttrExtensions
	OBJECT IDENTIFIER ::= { bgpM2Rib 8 }





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 75]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PathAttrNonCapExts
	OBJECT IDENTIFIER ::= { bgpM2PathAttrExtensions 1 }


    bgpM2PathAttrCapExts
	OBJECT IDENTIFIER ::= { bgpM2PathAttrExtensions 2 }


    --
    -- Path Attribute Route Reflection Extensions
    --

    --
    -- Originator ID Table
    --

    bgpM2PathAttrRouteReflectionExts
	OBJECT IDENTIFIER ::= { bgpM2PathAttrNonCapExts 2796 }


    bgpM2PathAttrOriginatorIdTable OBJECT-TYPE
	SYNTAX	    SEQUENCE OF BgpM2PathAttrOriginatorIdEntry
	MAX-ACCESS  not-accessible
	STATUS	    current
	DESCRIPTION
	    "Per prefix data pertinent to advertisement of a
	     network prefix through an originator."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	::= { bgpM2PathAttrRouteReflectionExts 1 }


    bgpM2PathAttrOriginatorIdEntry OBJECT-TYPE
	SYNTAX	    BgpM2PathAttrOriginatorIdEntry
	MAX-ACCESS  not-accessible
	STATUS	    current
	DESCRIPTION
	    "Each entry contains data pertinent to a network
	     prefix as received through its originating BGP
	     route reflector."
	REFERENCE
	    "RFC 2796 - BGP Route Reflection"
	INDEX {
	    bgpM2PathAttrIndex
	}
	::= { bgpM2PathAttrOriginatorIdTable 1 }





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 76]

Internet Draft		       BGP-MIB v2		January 12, 2004


    BgpM2PathAttrOriginatorIdEntry ::= SEQUENCE {
	bgpM2PathAttrOriginatorId
	    BgpM2Identifier
    }


    bgpM2PathAttrOriginatorId OBJECT-TYPE
	SYNTAX	    BgpM2Identifier
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "The Originator-ID identifying the router that initially
	     advertised this destination to a Route Reflector.	A
	     value of 0.0.0.0 indicates the absence of this attribute."
	REFERENCE
	     "This attribute is defined in [RFC2796]."
	::= { bgpM2PathAttrOriginatorIdEntry 1 }


    --
    -- Cluster table
    --

    bgpM2PathAttrClusterTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PathAttrClusterEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "The BGP-4 Path Attribute Cluster Table
	     contains the per network path (NLRI)
	     data on the reflection path which a
	     route has traversed.  The absence of row
	     data for a given index value for bgpM2PathAttrIndex
	     indicates a lack of this attribute information
	     for the indicated network path (as indexed by
	     that bgpM2PathAttrIndex value in the bgpM2PathAttrTable)."
	::= { bgpM2PathAttrRouteReflectionExts 2 }


    bgpM2PathAttrClusterEntry OBJECT-TYPE
	SYNTAX	   BgpM2PathAttrClusterEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Information about a cluster traversal
	     provided with a path to a network."
	INDEX {
	    bgpM2PathAttrIndex,



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 77]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    bgpM2PathAttrClusterIndex
	}
	::= { bgpM2PathAttrClusterTable 1 }


    BgpM2PathAttrClusterEntry ::= SEQUENCE {
	bgpM2PathAttrClusterIndex
	    Unsigned32,
	bgpM2PathAttrClusterValue
	    BgpM2Identifier
    }


    bgpM2PathAttrClusterIndex OBJECT-TYPE
	SYNTAX	   Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "An integral index for a row in this table."
	::= { bgpM2PathAttrClusterEntry 1 }


    bgpM2PathAttrClusterValue OBJECT-TYPE
	SYNTAX	    BgpM2Identifier
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "A four octet long value representing a part of the
	    reflection path that the route has passed.	Each such four
	    octet long value represents the ID of a cluster that
	    the route has traversed.  The sequence of this path as
	    received in the route advertisement will be preserved in
	    the sequence of bgpM2PathAttrClusterTable rows (and the
	    bgpM2PathAttrClusterValues in each row) as returned for
	    a given bgpM2PathAttrIndex value, and the monotonically
	    increasing sequence of bgpM2PathAttrClusterIndex values
	    for that bgpM2PathAttrIndex."
	REFERENCE
	    "This attribute is defined in [RFC2796]."
	::= { bgpM2PathAttrClusterEntry 2 }


    --
    -- BGP Communities
    --

    bgpM2PathAttrCommunityExts
	OBJECT IDENTIFIER ::= { bgpM2PathAttrNonCapExts 1997 }



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 78]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PathAttrCommTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PathAttrCommEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "The BGP-4 Path Attribute Community Table
	     contains the per network path (NLRI)
	     data on the community membership advertised
	     with a route.  The absence of row
	     data for a given index value for bgpM2PathAttrIndex
	     indicates a lack of this attribute information
	     for the indicated network path (as indexed by
	     that bgpM2PathAttrIndex value in the bgpM2PathAttrTable)."
	::= { bgpM2PathAttrCommunityExts 1 }


    bgpM2PathAttrCommEntry OBJECT-TYPE
	SYNTAX	   BgpM2PathAttrCommEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Information about a community association
	     provided with a path to a network."
	INDEX {
	    bgpM2PathAttrIndex,
	    bgpM2PathAttrCommIndex
	}
	::= { bgpM2PathAttrCommTable 1 }


    BgpM2PathAttrCommEntry ::= SEQUENCE {
	bgpM2PathAttrCommIndex
	    Unsigned32,
	bgpM2PathAttrCommValue
	    BgpM2Community
    }


    bgpM2PathAttrCommIndex OBJECT-TYPE
	SYNTAX Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "An integer index for a row in this table."
	::= { bgpM2PathAttrCommEntry 1 }


    bgpM2PathAttrCommValue  OBJECT-TYPE



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 79]

Internet Draft		       BGP-MIB v2		January 12, 2004


	SYNTAX	    BgpM2Community
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "A value representing a community.	 There are certain
	     4-octet long values which could be returned in this
	     columnar row data that carry additional semantics."
	REFERENCE
	    "RFC 1997 - BGP Communities Attribute"
	::= { bgpM2PathAttrCommEntry 2 }


    --
    -- BGP Extended Communities
    --

    bgpM2PathAttrExtCommTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2PathAttrExtCommEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "The BGP-4 Path Attribute Community Table
	    contains the per network path (NLRI)
	    data on the extended community membership advertised
	    with a route.  The absence of row
	    data for a given index value for bgpM2PathAttrIndex
	    indicates a lack of this attribute information
	    for the indicated network path (as indexed by
	    that bgpM2PathAttrIndex value in the bgpM2PathAttrTable).

	    XXX JMH - can not assign the OID until an RFC is published."
	::= { bgpM2PathAttrNonCapExts XXX }


    bgpM2PathAttrExtCommEntry OBJECT-TYPE
	SYNTAX	   BgpM2PathAttrExtCommEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Information about an extended community association
	     provided with a path to a network."
	INDEX {
	    bgpM2PathAttrIndex,
	    bgpM2PathAttrExtCommIndex
	}
	::= { bgpM2PathAttrExtCommTable 1 }





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 80]

Internet Draft		       BGP-MIB v2		January 12, 2004


    BgpM2PathAttrExtCommEntry ::= SEQUENCE {
	bgpM2PathAttrExtCommIndex
	    Unsigned32,
	bgpM2PathAttrExtCommValue
	    BgpM2ExtendedCommunity
    }


    bgpM2PathAttrExtCommIndex OBJECT-TYPE
	SYNTAX Unsigned32
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "An integral index for a row in this table."
	::= { bgpM2PathAttrExtCommEntry 1 }


    bgpM2PathAttrExtCommValue  OBJECT-TYPE
	SYNTAX	    BgpM2ExtendedCommunity
	MAX-ACCESS  read-only
	STATUS	    current
	DESCRIPTION
	    "A value representing an extended community which was
	    received with the route implied by the bgpM2PathAttr
	    Index value of this row data.   There are certain
	    8-octet long values which could be returned in this
	    columnar row data that carry additional semantics."
	REFERENCE
	    "BGP-EXTCOMM - BGP Extended Communities Attribute"
	::= { bgpM2PathAttrExtCommEntry 2 }


    --
    -- RFC 2545 link local nexthop
    --

    bgpM2LinkLocalNextHopTable OBJECT-TYPE
	SYNTAX	   SEQUENCE OF BgpM2LinkLocalNextHopEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Table of link local nexthops as sent by RFC 2545
	     for IPv6 BGP Speakers."
	REFERENCE
	    "RFC 2545 - Use of BGP-4 Multiprotocol Extensions
	     for IPv6 Inter-Domain Routing"
	::= { bgpM2PathAttrNonCapExts 2545 }




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 81]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2LinkLocalNextHopEntry OBJECT-TYPE
	SYNTAX	   BgpM2LinkLocalNextHopEntry
	MAX-ACCESS not-accessible
	STATUS	   current
	DESCRIPTION
	    "Entry containing the link-local nexthops as sent
	     by a BGP speaker running RFC 2545 extensions for
	     double-nexthops."
	INDEX {
	    bgpM2PathAttrIndex
	}
	::= { bgpM2LinkLocalNextHopTable 1 }


    BgpM2LinkLocalNextHopEntry ::= SEQUENCE {
	bgpM2LinkLocalNextHopPresent
	    TruthValue,
	bgpM2LinkLocalNextHop
	    InetAddress
    }


    bgpM2LinkLocalNextHopPresent OBJECT-TYPE
	SYNTAX	   TruthValue
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value is TRUE if and only if the BGP
	     speaker is receiving IPv6 NLRI using the
	     RFC 2545 double nexthop convention and it
	     has received a link local scope nexthop in
	     addition to the global scope nexthop."
	::= { bgpM2LinkLocalNextHopEntry 1 }


    bgpM2LinkLocalNextHop OBJECT-TYPE
	SYNTAX	   InetAddress (SIZE(20))
	MAX-ACCESS read-only
	STATUS	   current
	DESCRIPTION
	    "This value contains an IPv6 link local address of
	    InetAddressType of type ipv6z.  This value is only
	    present if bgpM2LinkLocalNextHopPresent is true."
	::= { bgpM2LinkLocalNextHopEntry 2 }


    --
    -- Conformance Information



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 82]

Internet Draft		       BGP-MIB v2		January 12, 2004


    --

    bgpM2Conformance
	OBJECT IDENTIFIER ::= { bgpM2 4 }


    bgpM2MIBCompliances OBJECT IDENTIFIER ::=
	{ bgpM2Conformance 1 }


    bgpM2MIBGroups	OBJECT IDENTIFIER ::=
	{ bgpM2Conformance 2 }


    bgpM2MIBCompliance MODULE-COMPLIANCE
	STATUS	current
	DESCRIPTION
	    "The compliance statement for entities which
	    implement the BGP4 mib."
	 MODULE	 -- this module
	 MANDATORY-GROUPS {
	    bgpM2TimersGroup,
	    bgpM2CountersGroup,
	    bgpM2AsPathGroup,
	    bgpM2As4byteGroup,
	    bgpM2BaseGroup,
	    bgpM2ErrorsGroup,
	    bgpM2PeerGroup,
	    bgpM2PathAttributesGroup
	    }
	GROUP bgpM2MIBNotificationsGroup
	DESCRIPTION
	    "The notifications group is completely optional,
	     but highly recommended."
	GROUP bgpM2CommunitiesGroup
	DESCRIPTION
	    "The communities group is mandatory only for those
	     which support the BGP community attribute."
	GROUP bgpM2ExtCommunitiesGroup
	DESCRIPTION
	    "The communities group is mandatory only for those
	     which support the BGP extended community attribute."
	GROUP bgpM2RouteReflectionGroup
	DESCRIPTION
	    "The communities group is mandatory only for those
	     which support the BGP route reflection relationships."
	GROUP bgpM2AsConfederationGroup
	DESCRIPTION



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 83]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    "The communities group is mandatory only for those
	     which support the BGP confederation membership."
	GROUP bgpM2TimersGroup
	DESCRIPTION
	    "This group is mandatory for all agent implementations."
	GROUP bgpM2CountersGroup
	DESCRIPTION
	    "This group is mandatory for all agent implementations."
	GROUP bgpM2CapabilitiesGroup
	DESCRIPTION
	    "This group is mandatory for all agent implementations."
	GROUP bgpM2AsPathGroup
	DESCRIPTION
	    "This group is mandatory for all agent implementations."
	GROUP bgpM2As4byteGroup
	DESCRIPTION
	    "This group is mandatory for all agent implementations."
	GROUP bgpM2BaseGroup
	DESCRIPTION
	    "This group is mandatory for all agent implementations."
	GROUP bgpM2ErrorsGroup
	DESCRIPTION
	    "This group is mandatory for all agent implementations."
	GROUP bgpM2PeerGroup
	DESCRIPTION
	    "This group is mandatory for all agent implementations."
	GROUP bgpM2PathAttributesGroup
	DESCRIPTION
	    "This group is mandatory for all agent implementations."
	GROUP bgpM2PeerConfigurationGroup
	DESCRIPTION
	    "This group is optional for implementations that wish to
	     support configuration via SNMP."
	GROUP bgpM2PeerRouteReflectorCfgGroup
	DESCRIPTION
	    "This group is optional for implementations that wish to
	     support configuration of route reflection via SNMP.
	     Implementation of this feature requires support of the
	     bgpM2PeerConfigurationGroup."
	GROUP bgpM2PeerAsConfederationCfgGroup
	DESCRIPTION
	    "This group is optional for implementations that wish to
	     support configuration of BGP AS Confederations via SNMP.
	     Implementation of this feature requires support of the
	     bgpM2PeerConfigurationGroup."
	GROUP bgpM2Rfc2545Group
	DESCRIPTION
	    "This group is required for peers that support exchanging



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 84]

Internet Draft		       BGP-MIB v2		January 12, 2004


	     of IPv6 NLRI per RFC 2545."
	::= { bgpM2MIBCompliances 1 }



    bgpM2CommunitiesGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2PathAttrCommIndex,
	    bgpM2PathAttrCommValue
	}
	STATUS current
	DESCRIPTION
	    "Objects associated with BGP communities."
	::= { bgpM2MIBGroups 1 }


    bgpM2ExtCommunitiesGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2PathAttrExtCommIndex,
	    bgpM2PathAttrExtCommValue
	}
	STATUS current
	DESCRIPTION
	    "Objects associated with BGP extended communities."
	::= { bgpM2MIBGroups 2 }


    bgpM2RouteReflectionGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2RouteReflector,
	    bgpM2ClusterId,
	    bgpM2PeerReflectorClient,
	    bgpM2PathAttrOriginatorId,
	    bgpM2PathAttrClusterIndex,
	    bgpM2PathAttrClusterValue
	}
	STATUS current
	DESCRIPTION
	    "Objects associated with BGP route reflection."
	::= { bgpM2MIBGroups 3 }


    bgpM2AsConfederationGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2ConfederationRouter,
	    bgpM2ConfederationId,
	    bgpM2PeerConfedMember
	}



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 85]

Internet Draft		       BGP-MIB v2		January 12, 2004


	STATUS current
	DESCRIPTION
	    "Objects associated with BGP confederation membership."
	::= { bgpM2MIBGroups 4 }


    bgpM2TimersGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2PeerFsmEstablishedTime,
	    bgpM2PeerInUpdatesElapsedTime,
	    bgpM2PeerConnectRetryInterval,
	    bgpM2PeerHoldTimeConfigured,
	    bgpM2PeerKeepAliveConfigured,
	    bgpM2PeerMinASOrigInterval,
	    bgpM2PeerMinRouteAdverInterval,
	    bgpM2PeerHoldTime,
	    bgpM2PeerKeepAlive
	}
	STATUS current
	DESCRIPTION
	    "Objects associated with BGP peering timers."
	::= { bgpM2MIBGroups 5 }


    bgpM2CountersGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2PeerInUpdates,
	    bgpM2PeerOutUpdates,
	    bgpM2PeerInTotalMessages,
	    bgpM2PeerOutTotalMessages,
	    bgpM2PeerFsmEstablishedTrans,
	    bgpM2PrefixCountersAfi,
	    bgpM2PrefixCountersSafi,
	    bgpM2PrefixInPrefixes,
	    bgpM2PrefixInPrefixesAccepted,
	    bgpM2PrefixInPrefixesRejected,
	    bgpM2PrefixOutPrefixes
	}
	STATUS current
	DESCRIPTION
	    "Objects to count discrete events and exchanges on BGP
	     sessions."
	 ::= { bgpM2MIBGroups 6 }


    bgpM2CapabilitiesGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2CapabilitySupportAvailable,



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 86]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    bgpM2SupportedCapabilityCode,
	    bgpM2SupportedCapability,
	    bgpM2PeerCapAnnouncedCode,
	    bgpM2PeerCapAnnouncedIndex,
	    bgpM2PeerCapAnnouncedValue,
	    bgpM2PeerCapReceivedCode,
	    bgpM2PeerCapReceivedIndex,
	    bgpM2PeerCapReceivedValue
	}
	STATUS current
	DESCRIPTION
	    "Objects to report capabilities as received on BGP
	     sessions."
	::= { bgpM2MIBGroups 7 }


    bgpM2AsPathGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2AsPathSegmentIndex,
	    bgpM2AsPathElementIndex,
	    bgpM2AsPathType,
	    bgpM2AsPathElementValue
	}
	STATUS current
	DESCRIPTION
	    "Objects to report AS paths received on BGP NLRIs."
	::= { bgpM2MIBGroups 8 }


    bgpM2As4byteGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2AsSize,
	    bgpM2AsPath4bytePathPresent,
	    bgpM2AsPath4byteAggregatorAS,
	    bgpM2AsPath4byteCalcLength,
	    bgpM2AsPath4byteString,
	    bgpM2AsPath4byteIndex
	}
	STATUS current
	DESCRIPTION
	    "AS Size objects."
	::= { bgpM2MIBGroups 9 }


    bgpM2BaseGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2LocalAs,
	    bgpM2LocalIdentifier,



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 87]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    bgpM2VersionIndex,
	    bgpM2VersionSupported
	}
	STATUS current
	DESCRIPTION
	    "Basic objects in local BGP implementation."
	::= { bgpM2MIBGroups 10 }


    bgpM2ErrorsGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2PeerLastErrorReceived,
	    bgpM2PeerLastErrorReceivedData,
	    bgpM2PeerLastErrorReceivedTime,
	    bgpM2PeerLastErrorReceivedText,
	    bgpM2PeerLastErrorSent,
	    bgpM2PeerLastErrorSentData,
	    bgpM2PeerLastErrorSentTime,
	    bgpM2PeerLastErrorSentText
	}
	STATUS current
	DESCRIPTION
	    "Errors received on BGP peering sessions."
	::= { bgpM2MIBGroups 11 }


    bgpM2PeerGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2PeerInstance,
	    bgpM2PeerIdentifier,
	    bgpM2PeerState,
	    bgpM2PeerStatus,
	    bgpM2PeerConfiguredVersion,
	    bgpM2PeerNegotiatedVersion,
	    bgpM2PeerLocalAddrType,
	    bgpM2PeerLocalAddr,
	    bgpM2PeerLocalPort,
	    bgpM2PeerLocalAs,
	    bgpM2PeerRemoteAddrType,
	    bgpM2PeerRemoteAddr,
	    bgpM2PeerRemotePort,
	    bgpM2PeerRemoteAs,
	    bgpM2PeerIndex
	}
	STATUS current
	DESCRIPTION
	    "Core object types on BGP peering sessions."
	::= { bgpM2MIBGroups 12 }



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 88]

Internet Draft		       BGP-MIB v2		January 12, 2004


    bgpM2PathAttributesGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2PathAttrCount,
	    bgpM2AsPathCalcLength,
	    bgpM2AsPathElementValue,
	    bgpM2AsPathIndex,
	    bgpM2AsPathString,
	    bgpM2AsPathType,
	    bgpM2NlriAfi,
	    bgpM2NlriBest,
	    bgpM2NlriPrefixType,
	    bgpM2NlriPrefix,
	    bgpM2NlriPrefixLen,
	    bgpM2NlriSafi,
	    bgpM2NlriOpaqueType,
	    bgpM2NlriOpaquePointer,
	    bgpM2NlriIndex,
	    bgpM2NlriCalcLocalPref,
	    bgpM2AdjRibsOutIndex,
	    bgpM2AdjRibsOutRoute,
	    bgpM2PathAttrAggregatorAS,
	    bgpM2PathAttrAggregatorAddr,
	    bgpM2PathAttrAtomicAggregate,
	    bgpM2PathAttrIndex,
	    bgpM2PathAttrLocalPref,
	    bgpM2PathAttrLocalPrefPresent,
	    bgpM2PathAttrMed,
	    bgpM2PathAttrMedPresent,
	    bgpM2PathAttrNextHop,
	    bgpM2PathAttrNextHopAddrType,
	    bgpM2PathAttrOrigin,
	    bgpM2PathAttrUnknownIndex,
	    bgpM2PathAttrUnknownType,
	    bgpM2PathAttrUnknownValue
	}
	STATUS current
	DESCRIPTION
	    "Attributes received on BGP peering sessions."
	::= { bgpM2MIBGroups 13 }

    bgpM2PeerConfigurationGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2CfgBaseScalarStorageType,
	    bgpM2CfgLocalAs,
	    bgpM2CfgLocalIdentifier,
	    bgpM2CfgPeerAdminStatus,
	    bgpM2CfgPeerNextIndex,
	    bgpM2CfgPeerConfiguredVersion,



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 89]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    bgpM2CfgAllowVersionNegotiation,
	    bgpM2CfgPeerLocalAddrType,
	    bgpM2CfgPeerLocalAddr,
	    bgpM2CfgPeerLocalAs,
	    bgpM2CfgPeerRemoteAddrType,
	    bgpM2CfgPeerRemoteAddr,
	    bgpM2CfgPeerRemoteAs,
	    bgpM2CfgPeerEntryStorageType,
	    bgpM2CfgPeerError,
	    bgpM2CfgPeerBgpPeerEntry,
	    bgpM2CfgPeerRowEntryStatus,
	    bgpM2CfgPeerIndex,
	    bgpM2CfgPeerStatus,
	    bgpM2CfgPeerConnectRetryInterval,
	    bgpM2CfgPeerHoldTimeConfigured,
	    bgpM2CfgPeerKeepAliveConfigured,
	    bgpM2CfgPeerMinASOrigInterval,
	    bgpM2CfgPeerMinRouteAdverInter
	}
	STATUS current
	DESCRIPTION
	    "Configuration objects for BGP peers."
	::= { bgpM2MIBGroups 14 }


    bgpM2PeerRouteReflectorCfgGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2CfgRouteReflector,
	    bgpM2CfgClusterId,
	    bgpM2CfgPeerReflectorClient
	}
	STATUS current
	DESCRIPTION
	    "Configuration objects for BGP peers that support route
	     reflection."
	::= { bgpM2MIBGroups 15 }


    bgpM2PeerAsConfederationCfgGroup OBJECT-GROUP
	OBJECTS {
	    bgpM2CfgConfederationRouter,
	    bgpM2CfgConfederationId,
	    bgpM2CfgPeerConfedMember
	}
	STATUS current
	DESCRIPTION
	    "Configuration objects for BGP peers that support BGP
	     confederations."



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 90]

Internet Draft		       BGP-MIB v2		January 12, 2004


	::= { bgpM2MIBGroups 16 }


    bgpM2MIBNotificationsGroup NOTIFICATION-GROUP
	NOTIFICATIONS {
	    bgpM2Established,
	    bgpM2BackwardTransition
	}
	STATUS	current
	DESCRIPTION
	    "This group contains objects for notifications
	     supported by this mib module."
	::= { bgpM2MIBGroups 17 }


    bgpM2Rfc2545Group OBJECT-GROUP
	OBJECTS {
	    bgpM2LinkLocalNextHopPresent,
	    bgpM2LinkLocalNextHop
	}
	STATUS current
	DESCRIPTION
	    "This group is required for peers that support exchanging
	     of IPv6 NLRI per RFC 2545."
	::= { bgpM2MIBGroups 18 }

END



5.  Intellectual Property Rights

   The IETF takes no position regarding the validity or scope of any
   intellectual property or other rights that might be claimed to per-
   tain to the implementation or use of the technology described in this
   document or the extent to which any license under such rights might
   or might not be available; neither does it represent that it has made
   any effort to identify any such rights.  Information on the IETF's
   procedures with respect to rights in standards-track and standards-
   related documentation can be found in BCP-11.  Copies of claims of
   rights made available for publication and any assurances of licenses
   to be made available, or the result of an attempt made to obtain a
   general license or permission for the use of such proprietary rights
   by implementors or users of this specification can be obtained from
   the IETF Secretariat.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 91]

Internet Draft		       BGP-MIB v2		January 12, 2004


   rights which may cover technology that may be required to practice
   this standard.  Please address the information to the IETF Executive
   Director.

6.  Security Considerations

   This MIB relates to a system providing inter-domain routing.	 As
   such, improper manipulation of the objects represented by this MIB
   may result in denial of service to a large number of end-users.

   There are several management objects defined in this MIB that have a
   MAX-ACCESS clause of read-write and/or read-create.	Such objects
   should be considered sensitive or vulnerable in most network environ-
   ments.  The support for SET operations in a non-secure environment
   without proper protection can have a negative effect on network oper-
   ations.  These objects include:

   XXX TODO

   There  are  a  number  of  managed  objects	in  this MIB that con-
   tain sensitive information regarding the operation of a network.  For
   example, a BGP peer's local and remote addresses might be sensitive
   for ISPs who want to keep interface	addresses on routers confiden-
   tial to prevent router addresses used for a denial of service attack
   or spoofing.

   Therefore, it is important in most environments to control read
   access to these objects and possibly to even encrypt the values of
   these object when sending them over the network via SNMP.

   SNMPv1 by itself is not a secure environment.  Even if the network
   itself is secure (for example by using IPSec), there is still no con-
   trol as to who on the secure network is allowed to access and GET/SET
   (read/change/create/delete) the objects in this MIB.

   It is recommended that the implementers consider the security fea-
   tures as provided by the SNMPv3 framework.[REF]  Specifically, the
   implementation and use of the User-based Security Model [REF] and the
   View-based Access Control Model [REF] is recommended to provide
   appropriate security controls.

   It is then an operator/user responsibility to ensure that the SNMP
   entity giving access to an instance of this MIB, is properly config-
   ured to give access to the objects only to those principals (users)
   that have legitimate rights to indeed GET or SET (change/cre-
   ate/delete) them.





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 92]

Internet Draft		       BGP-MIB v2		January 12, 2004


7.  Acknowledgements


   Tom Nadeau, Cisco Systems, Inc.
   Jon Saperia, JDS Consulting, Inc.
   Bill Fenner, AT&T Research
   Mike McFaden, Riverstone Networks, Inc.
   Joel Krauska, Exodus Communications, Inc.
   Carl W. Kalbfleisch, Verio Networks, Inc.
   Joe Dupre, Gold Wire Technology

    others TBD...


8.  Changes From Last Version

   This section is used to track changes from version to version of this
   document.  This section will be removed from the document prior to
   being issued to IDR working group last call.

     *	  Changes from draft-ietf-idr-bgp4-mibv2-03.txt to draft-ietf-
	  idr-bgp4-mibv2-04.txt (12 January 2004)

	  Remove all objects related to BGP authentication as BGP
	  authentication has been officially removed.

	  Removed bgpM2AsPathElementValue from bgpM2AsPathTable

	  Add current OPS group MIB boilerplate and security boiler-
	  plate.  Work still needs to be done in the security section.

	  Split references into Normative References and Informational
	  References.  Add IETF Intellectual Property Rights statement.
	  Update copyright dates.

	  Add new TEXTUAL-CONVENTION, BgpM2Afi to more properly reflect
	  BGP Multi-Protocol Extensions.

	  Add bgpM2NlriPrefixType to bgpM2NlriTable as an interim mecha-
	  nism to support "proper" translation of an AFI to an InetAd-
	  dressType.  Further thought must be put into this.

	  Delete bgpM2CfgPeerRemotePort object.	 Deployed implementa-
	  tions do not seem to allow this to be configured.

	  Add bgpM2PeerInstance to permit multiple BGP routing instances
	  to be supported.




Various Authors		  Expires June 12, 2004	       FORMFEED[Page 93]

Internet Draft		       BGP-MIB v2		January 12, 2004


	  Renumber numerous OIDs to account for re-organizing objects.
	  Update conformance statements to match.

     *	  Changes from draft-ietf-idr-bgp4-mibv2-02.txt to draft-ietf-
	  idr-bgp4-mibv2-03.txt (4 November 2002):

	  Changed the order of the bgpM2NlriPrefixLen and
	  bgpM2NlriPrefix objects and renumbered them.	This was to make
	  it consistant with user expectations.

	  Clarify the peer table description text to specify the remote
	  peer.

	  Use SnmpAdminString instead of DisplayString.

	  Correct TEXTUAL CONVENTION for extended communities.

	  Changed enumerations of bgpM2PathATtrAtomicAggregate.

	  Added link local table for RFC 2545 nexthops.

     *	  Changes from draft-ietf-idr-bgp4-mibv2-01.txt to draft-ietf-
	  idr-bgp4-mibv2-02.txt (28 February 2002)

	  Lots of changes in this rewrite, these are the most dramatic:

	  Configuration objects and tables added.

	  All references to 'bgp' in object descriptors changed to
	  'bgpM2' to disambiguate from RFC 1657 and its OBSOLETing MIB.

	  Community Textual conventions added to beginning of MIB.

	  bgpM2CalcLength and PathString columns added to bgpM2PathAttr
	  table.

	  Creation of separate bgpM2AdjRibsOutTable.

	  Appearance of NLRI table notions such as 'opaque type'.

	  Overhaul of specification of AS Path types to accommodate eas-
	  ier management at time of route aggregation.

9.  Normative References


[RFC2574]   Blumenthal, U., and B. Wijnen, "User-based Security Model
	    (USM) for version 3 of the Simple Network Management



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 94]

Internet Draft		       BGP-MIB v2		January 12, 2004


	    Protocol (SNMPv3)", RFC 2574, April 1999.

[RFC2578]   McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
	    Rose, M., and S. Waldbusser, "Structure of Management Infor-
	    mation Version 2 (SMIv2)", STD 58, RFC 2578, April 1999.

[RFC2579]   McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
	    Rose, M., and S. Waldbusser, "Textual Conventions for
	    SMIv2", STD 58, RFC 2579, April 1999.

[RFC2580]   McCloghrie, K., Perkins, D., Schoenwaelder, J., Case, J.,
	    Rose, M., and S. Waldbusser, "Conformance Statements for
	    SMIv2", STD 58, RFC 2580, April 1999.

[RFC3411]   D. Harrington, R. Presuhn, B. Wijnen, "An Architecture for
	    Describing Simple Network Management Protocol (SNMP) Manage-
	    ment Frameworks", RFC 3411, December 2002.

[RFC3413]   D. Levi, P. Meyer, B. Stewart, "Simple Network Management
	    Protocol (SNMP) Applications",  RFC 3413, December 2002.

[RFC3415]   B. Wijnen, R. Presuhn, K. McCloghrie, "View-based Access
	    Control Model (VACM) for the Simple Network Management Pro-
	    tocol (SNMP)", RFC 3415, December 2002.

[RFC3416]   Presuhn, R., Editor, "Version 2 of the Protool Operations
	    for the Simple Network Management Protocol (SNMP)", RFC
	    3416, December 2002.

[RFC3417]   Presuhn, R., Editor, "Transport Mappings for the Simple Net-
	    work Management Protocol (SNMP)", RFC 3417, December 2002.

[RFC1213]   McCloghrie, K. and M. Rose, Editors, "Management Information
	    Base for Network Management of TCP/IP-based Internets: MIB-
	    II", STD 17, RFC 1213, Hughes LAN Systems, Performance Sys-
	    tems International, March 1991.

[RFC1657]   Willis, S., Burruss, J., and Chu, J., "Definitions of Man-
	    aged Objects for the Fourth Version of the Border Gateway
	    Protocol (BGP-4) using SMIv2", RFC 1657, July 1994.

[MIB-DRAFT] Hares, S., Haas, J., Willis, S., Burruss, J., and Chu, J.,
	    "Definitions of Managed Objects for the Fourth Version of
	    Border Gateway Protocol (BGP-4)", draft-ietf-idr-
	    bgp4-mib-06.txt, Work-in-progress.

[RFC1771]   Rekhter, Y., Li, T., "A Border Gateway Protocol 4 (BGP-4)",
	    RFC 1771, March 1995.



Various Authors		  Expires June 12, 2004	       FORMFEED[Page 95]

Internet Draft		       BGP-MIB v2		January 12, 2004


[RFC1772]   Rekhter, Y., Gross, P., "Application of the Border Gateway
	    Protocol in the Internet", RFC 1772, March 1995.

[RFC3065]   Traina, P., McPherson, D., and Scudder, J., "Autonomous Sys-
	    tem Confederations for BGP", RFC 3065, February, 2001.

[RFC1997]   Chandra, R., Traina, P., and Li, T., "BGP Communities
	    Attribute", RFC 1997, August, 1996.

[RFC2858]   Bates, T., Rekhter, Y., Chandra, R., and Katz, D., "Multi-
	    protocol Extensions for BGP-4", RFC 2858, June, 2000.

[RFC2796]   Bates, T., Chandra, R., and Chen, E., "BGP Route Reflection
	    - An Alternative to Full Mesh IBGP", RFC 2796, April 2000.

[BGP-EXTCOMM] Sangli, S., Tappan, D., and Rekhter, Y., "BGP Extended
	    Communities Attribute", Work-in-progress.

[RFC3107]   Rehkter, Y., and Rosen, E., "Carrying Label Information in
	    BGP-4", RFC 3107, May 2001.

10.  Informative References


[RFC1901]   Case, J., McCloghrie, K., Rose, M., and S. Waldbusser,
	    "Introduction to Community-based SNMPv2", RFC 1901, January
	    1996.

[RFC2576]   Frye, R., Levi, D., Routhier, S. and B. Wijnen, "Coexistence
	    between Version 1, Version 2, and Version 3 of the Internet-
	    Standard Network Management Framework", RFC 2576, March
	    2000.

[RFC3410]   Case, J., Mundy, R., Partain, D. and B. Stewart, "Introduc-
	    tion and Applicability Statements for Internet- Standard
	    Management Framework", RFC 3410, December 2002.

11.  Authors' Addresses

   Jeff Haas
   NextHop Technologies
   825 Victors Way, Suite 100
   Ann Arbor, MI 48108
   Phone: +1 734 222-1600
   Fax:	  +1 734 222-1602
   Email: jhaas@nexthop.com





Various Authors		  Expires June 12, 2004	       FORMFEED[Page 96]

Internet Draft		       BGP-MIB v2		January 12, 2004


   Susan Hares
   NextHop Technologies
   825 Victors Way, Suite 100
   Ann Arbor, MI 48108
   Phone: +1 734 222-1600
   Fax:	  +1 734 222-1602
   Email: skh@nexthop.com

   Wayne Tackabury
   Gold Wire Technology
   411 Waverley Oaks Rd.
   Waltham, MA	02452-8401
   Phone: +1 781 398-8819
   Fax:	  +1 781 398-8811
   Email: wayne@goldwiretech.com

12.  Full Copyright Statement

   Copyright (C) The Internet Society (2004).  All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this doc-
   ument itself may not be modified in any way, such as by removing the
   copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of develop-
   ing Internet standards in which case the procedures for copyrights
   defined in the Internet Standards process must be followed, or as
   required to translate it into languages other than English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MER-
   CHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.









Various Authors		  Expires June 12, 2004	       FORMFEED[Page 97]

Internet Draft		       BGP-MIB v2		January 12, 2004


			   Table of Contents


1. Introduction	 . . . . . . . . . . . . . . . . . . . . . . . . . .   2
2. Objectives  . . . . . . . . . . . . . . . . . . . . . . . . . . .   2
2.1. Protocol Extensions . . . . . . . . . . . . . . . . . . . . . .   2
2.2. Mechanisms for MIB Extensibility  . . . . . . . . . . . . . . .   3
2.3. BGP Configuration . . . . . . . . . . . . . . . . . . . . . . .   3
3. MIB Organization  . . . . . . . . . . . . . . . . . . . . . . . .   3
3.1. bgpM2BaseScalars  . . . . . . . . . . . . . . . . . . . . . . .   4
3.2. bgpM2PeerData . . . . . . . . . . . . . . . . . . . . . . . . .   5
3.2.1. bgpM2PeerCapabilities . . . . . . . . . . . . . . . . . . . .   5
3.2.2. bgpM2PeerCounters . . . . . . . . . . . . . . . . . . . . . .   6
3.2.3. Peering Data Extensions . . . . . . . . . . . . . . . . . . .   6
3.2.4. Configuring Peering Sessions  . . . . . . . . . . . . . . . .   6
3.3. BGP Routing Information Base Data . . . . . . . . . . . . . . .   7
3.3.1. Routing Information Base Extensions . . . . . . . . . . . . .   8
3.4. Considerations on Table Indexing  . . . . . . . . . . . . . . .   8
4. Definitions . . . . . . . . . . . . . . . . . . . . . . . . . . .   9
5. Intellectual Property Rights	 . . . . . . . . . . . . . . . . . .  91
6. Security Considerations . . . . . . . . . . . . . . . . . . . . .  92
7. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . . . .  93
8. Changes From Last Version . . . . . . . . . . . . . . . . . . . .  93
9. Normative References	 . . . . . . . . . . . . . . . . . . . . . .  94
10. Informative References . . . . . . . . . . . . . . . . . . . . .  96
11. Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . .  96
12. Full Copyright Statement . . . . . . . . . . . . . . . . . . . .  97
























Various Authors		  Expires June 12, 2004	       FORMFEED[Page 98]


