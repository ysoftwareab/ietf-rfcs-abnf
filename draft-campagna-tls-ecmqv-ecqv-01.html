<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>ECMQV_ECQV Cipher Suites for Transport Layer Security (TLS)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="ECMQV_ECQV Cipher Suites for Transport Layer Security (TLS)">
<meta name="keywords" content="I-D, Internet-Draft, Elliptic Curve Cryptography (ECC), Transport Layer Security (TLS), Datagraph Transport Layer Security (DTLS)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">M. Campagna</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Certicom Corp.</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">D. Stebila</td></tr>
<tr><td class="header">Expires: July 20, 2010</td><td class="header">Queensland University of</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Technology</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 16, 2010</td></tr>
</table></td></tr></table>
<h1><br />ECMQV_ECQV Cipher Suites for Transport Layer Security (TLS)<br />draft-campagna-tls-ecmqv-ecqv-01</h1>

<h3>Abstract</h3>

<p>This document specifies a set of cipher suites for the Transport Layer Security (TLS) and Datagram TLS (DTLS) protocols that use Elliptic Curve Qu-Vanstone (ECQV) certificates to authenticate an Elliptic Curve Menezes-Qu-Vanstone (ECMQV) exchange.  These cipher suites provide forward secrecy.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on July 20, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#notation">2.</a>&nbsp;
Notation<br />
<a href="#ecmqv_ecqv">3.</a>&nbsp;
ECMQV_ECQV Key Exchange Algorithm<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ecmqv_ecqv-overview">3.1.</a>&nbsp;
ECMQV_ECQV Handshake Protocol Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ecmqv_ecqv-serverauth">3.2.</a>&nbsp;
Server Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ecmqv_ecqv-clientauth">3.3.</a>&nbsp;
Client Authentication<br />
<a href="#datastructs">4.</a>&nbsp;
Data Structures and Computations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#datastructs-servercert">4.1.</a>&nbsp;
Server Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#datastructs-serverkeyex">4.2.</a>&nbsp;
Server Key Exchange<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#datastructs-certreq">4.3.</a>&nbsp;
Certificate Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#datastructs-clientcert">4.4.</a>&nbsp;
Client Certificate<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#datastructs-clientkeyex">4.5.</a>&nbsp;
Client Key Exchange<br />
<a href="#ciphersuites">5.</a>&nbsp;
ECMQV_ECQV-Based Cipher Suites<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ciphersuites-sha1">5.1.</a>&nbsp;
ECMQV_ECQV Cipher Suites Using the SHA-1 Hash Function<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ciphersuites-sha2">5.2.</a>&nbsp;
ECMQV_ECQV Cipher Suites Using the SHA2 Hash Function Family<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ciphersuites-aesmmo">5.3.</a>&nbsp;
ECMQV_ECQV Cipher Suites Using AES-MMO Hash Functions<br />
<a href="#ciphersuitesnull">6.</a>&nbsp;
ECMQV_ECQV-Based Cipher Suites With NULL Encryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ciphersuitesnull-sha1">6.1.</a>&nbsp;
ECMQV_ECQV Cipher Suite Using the SHA-1 Hash Function with NULL Encryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ciphersuitesnull-sha2">6.2.</a>&nbsp;
ECMQV_ECQV Cipher Suites Using the SHA2 Hash Function Family with NULL Encryption<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ciphersuitesnull-aesmmo">6.3.</a>&nbsp;
ECMQV_ECQV Cipher Suites Using AES-MMO Hash Functions with NULL Encryption<br />
<a href="#security">7.</a>&nbsp;
Security Considerations<br />
<a href="#iana">8.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#ack">Appendix&nbsp;A.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Elliptic curve implicit certificates, combined with the Elliptic Curve Menezes-Qu-Vanstone (ECMQV) key agreement schemes, provide significant computation and bandwidth savings over traditional certificate schemes and the Diffie-Hellman key agreement schemes, while still affording equivalent security properties.
</p>
<p>Elliptic Curve Qu-Vanstone (ECQV) is an implicit certificate scheme that removes the need for explicitly signing a public key and associated data in the certificate.  Details of the security properties provided by ECQV can be found in <a class='info' href='#SEC4'>[SEC4]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Qu-Vanstone Implicit Certificate Scheme (ECQV), v0.91,&rdquo; November&nbsp;2008.</span><span>)</span></a>. Compared to currently prevalent certificate schemes, ECQV provides smaller certificate sizes for equivalent security levels. This is illustrated in the following table, which compares the minimial number of bit required to convey the public key and, if required, the explicit signature in the certificate, at various symmetric key security levels.  In the table columns with (p/2^m) shows sizes for elliptic curve groups over prime fields of size p or 2^m, respectively.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center"><col align="center">
<tr><th align="center">Symmetric</th><th align="center">ECQV (p/2^m)</th><th align="center">ECDSA (p/2^m)</th><th align="center">DH/DSA/RSA</th></tr>
<tr>
<td align="center"> 80 </td>
<td align="center"> 160/163 </td>
<td align="center"> 480/489 </td>
<td align="center"> 2064</td>
</tr>
<tr>
<td align="center"> 112 </td>
<td align="center"> 224/233 </td>
<td align="center"> 672/699 </td>
<td align="center"> 4112</td>
</tr>
<tr>
<td align="center"> 128 </td>
<td align="center"> 256/283 </td>
<td align="center"> 768/849 </td>
<td align="center"> 6160</td>
</tr>
<tr>
<td align="center"> 192 </td>
<td align="center"> 384/409 </td>
<td align="center"> 1152/1227 </td>
<td align="center"> 15376</td>
</tr>
<tr>
<td align="center"> 256 </td>
<td align="center"> 521/571 </td>
<td align="center"> 1563/1713 </td>
<td align="center"> 30736</td>
</tr>
</table>
<br clear="all" />

<p><a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a> defines a set of elliptic curve cryptography (ECC)-based cipher suites for the Transport Layer Security (TLS) protocol and describes the use of ECC certificates for client authentication.  In particular, it specifies the use of Elliptic Curve Diffie-Hellman (ECDH) key agreement in a TLS handshake and the use of Elliptic Curve Digital Signature Algorithm (ECDSA) for authentication.
</p>
<p>ECMQV key agreement with ECQV implicit certifcates, denoted ECMQV_ECQV, provides the same security properties as provided by ephemeral ECDH (ECDHE) with ECDSA certificates, but requires less computation.  The following table compares the number of operations required by each party in the two schemes.
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">ECMQV_ECQV with client ECQV_ECMQV</th><th align="center">ECDHE_ECDSA with client ECDSA_sign</th></tr>
<tr>
<td align="center"> 1 hash operation </td>
<td align="center"> 3 hash operations</td>
</tr>
<tr>
<td align="center"> 1 key generation </td>
<td align="center"> 2 key generations</td>
</tr>
<tr>
<td align="center"> 2 point additions </td>
<td align="center"> 2 point additions</td>
</tr>
<tr>
<td align="center"> 2.5 point multiplications </td>
<td align="center"> 3 point multiplications</td>
</tr>
</table>
<br clear="all" />

<p>The computational and bandwidth savings make ECMQV_ECQV particularly attractive for bandwidth-constrained environments and devices with constrained computational power.
</p>
<p>ECMQV and ECQV are used in the Certificate Based Key Exchange (CBKE) defined in the ZigBee Smart Energy Specification <a class='info' href='#ZigBeeSE'>[ZigBeeSE]<span> (</span><span class='info'>ZigBee Standards Organization, &ldquo;ZigBee Smart Energy Profile Specification, revision 15,&rdquo; December&nbsp;2008.</span><span>)</span></a>. ZigBee is developing an Internet Protocol (IP) capability to support a unified Smart Energy profile to run over HomePlug. This document is meant to help support the general ZigBee and HomePlug efforts to use IETF protocols and achieve application-layer security, bandwidth, and computational goals.
</p>
<p>This document describes additions to TLS and DTLS to support ECMQV_ECQV, applicable to TLS version 1.0 <a class='info' href='#RFC2246'>[RFC2246]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a>, TLS version 1.1 <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a>, and TLS version 1.2 <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>, as well as DTLS version 1.0 <a class='info' href='#RFC4347'>[RFC4347]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a> and DTLS version 1.2 <a class='info' href='#I-D.ietf-tls-rfc4347-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4347&#8209;bis]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security version 1.2,&rdquo; October&nbsp;2009.</span><span>)</span></a>.  In particular, it defines:
</p>
<ul class="text">
<li>the use of the Elliptic Curve Menezes-Qu-Vanstone (ECMQV) key agreement scheme with long-term and ephemeral keys to establish the premaster secret, and
</li>
<li>the use of Elliptic Curve Qu-Vanstone (ECQV) implicit certificates for authentication of peers.
</li>
</ul>
<p>The remainder of this document is organized as follows.  <a class='info' href='#ecmqv_ecqv'>Section&nbsp;3<span> (</span><span class='info'>ECMQV_ECQV Key Exchange Algorithm</span><span>)</span></a> provides an overview of ECMQV_ECQV-based key exchange algorithms for TLS.  <a class='info' href='#datastructs'>Section&nbsp;4<span> (</span><span class='info'>Data Structures and Computations</span><span>)</span></a> describes the data structures and actions required to implement the new authenticated key agreement scheme.  <a class='info' href='#ciphersuites'>Section&nbsp;5<span> (</span><span class='info'>ECMQV_ECQV-Based Cipher Suites</span><span>)</span></a> defines new ECMQV_ECQV-based cipher suites and identifies a small subset of these as recommended for all implementations of this specification.  <a class='info' href='#security'>Section&nbsp;7<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> discusses security considerations.  <a class='info' href='#iana'>Section&nbsp;8<span> (</span><span class='info'>IANA Considerations</span><span>)</span></a> describes IANA considerations for the name spaces created by this document.
</p>
<p>The cipher suites described in this are suitable for DTLS without any additional changes beyond those required to implement DTLS.
</p>
<p>Implementation of this document requires familiarity with the following technologies and standards: elliptic curve cryptography <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a> (additional information available in <a class='info' href='#HMV04'>[HMV04]<span> (</span><span class='info'>Hankerson, D., Menezes, A., and S. Vanstone, &ldquo;Guide to Elliptic Curve Cryptography,&rdquo; 2004.</span><span>)</span></a>, <a class='info' href='#IEEE1363'>[IEEE1363]<span> (</span><span class='info'>Institute of Electrical and Electronics Engineers, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; 2000.</span><span>)</span></a>); ECMQV <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>, Section 6.2 (additional information available in <a class='info' href='#LMQSV98'>[LMQSV98]<span> (</span><span class='info'>Law, L., Menezes, A., Qu, M., Solinas, J., and S. Vanstone, &ldquo;An Efficient Protocol for Authenticated Key Agreement,&rdquo; August&nbsp;1998.</span><span>)</span></a>); ECQV <a class='info' href='#SEC4'>[SEC4]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Qu-Vanstone Implicit Certificate Scheme (ECQV), v0.91,&rdquo; November&nbsp;2008.</span><span>)</span></a>; the use of elliptic curve cryptography in TLS <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>; and the relevant version of TLS <a class='info' href='#RFC2246'>[RFC2246]<span> (</span><span class='info'>Dierks, T. and C. Allen, &ldquo;The TLS Protocol Version 1.0,&rdquo; January&nbsp;1999.</span><span>)</span></a>, <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a>, <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> or DTLS <a class='info' href='#RFC4347'>[RFC4347]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security,&rdquo; April&nbsp;2006.</span><span>)</span></a>, <a class='info' href='#I-D.ietf-tls-rfc4347-bis'>[I&#8209;D.ietf&#8209;tls&#8209;rfc4347&#8209;bis]<span> (</span><span class='info'>Rescorla, E. and N. Modadugu, &ldquo;Datagram Transport Layer Security version 1.2,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="notation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="ecmqv_ecqv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
ECMQV_ECQV Key Exchange Algorithm</h3>

<p>This document describes a new ECC-based key exchange algorithm for TLS and DTLS.  It uses ECMQV to compute the premaster secret.  The derivation of the master secret from the premaster secret and the subsequent generation of bulk encryption/MAC keys and initialization vectors is independent of the key exchange algorithm and not impacted by the techniques in this document.
</p>
<p>ECMQV_ECQV key exchange provides forward secrecy and mutual authentication.  It provides a new server authentication mechanism and a new client authentication mechanism, both using ECQV certificates.  This document treats the ECQV certificates as an opaque data structure that is defined outside this specification; for example, this structure could be an X.509 format.
</p>
<a name="ecmqv_ecqv-overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
ECMQV_ECQV Handshake Protocol Overview</h3>

<p>The handshake defined for ECMQV_ECQV requires that a server has an ECQV certificate.  In the case that the client also has a certificate no CertificateVerify message is required: proof of possession of the private key is demonstrated by the verify_data in the Finished method.  This is a property afforded by ECMQV that also applies to ECQV certificates and can reduce the bandwidth and computational complexity of a mutually authenticated key establishment.
</p><br /><hr class="insert" />
<a name="fig-ecmqv_ecqv-prot"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Client                                               Server

    ClientHello                  --------&gt;
                                                    ServerHello
                                                    Certificate
                                              ServerKeyExchange
                                            CertificateRequest*
                                 &lt;--------      ServerHelloDone
    Certificate*
    ClientKeyExchange
    [ChangeCipherSpec]
    Finished                     --------&gt;
                                             [ChangeCipherSpec]
                                 &lt;--------             Finished
    Application Data             &lt;-------&gt;     Application Data

	* message is not sent in some conditions
</pre></div>
<p>Message flow for an ECMQV_ECQV handshake.
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="ecmqv_ecqv-serverauth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Server Authentication</h3>

<p>The ECMQV_ECQV scheme provides server authentication by the exchange of an ECQV certificate issued by a certificate authority recognized by the client.
</p>
<a name="ecmqv_ecqv-clientauth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Client Authentication</h3>

<p>The ECMQV_ECQV scheme provides client authentication by the exchange of an ECQV certificate issued by a certificate authority recognized by the clientserver.
</p>
<p>The server MUST request ECQV-based client authentication by including this certificate type in its CertificateRequest message.  The client MUST check if it possesses a certificate appropriate for this method suggested by the server and is willing to use it for authentication.
</p>
<p>If these conditions are not met, the client SHOULD send a client Certificate message containing no certificates.  In this case, the ClientKeyExchange message is as described in .  If the server requires client authentication, it MAY respond with a fatal handshake failure alert.
</p>
<p>If the client has an appropriate certificate and is willing to use it for authentication, it MUST send that certificate in the client's Certificate message (as per <a class='info' href='#datastructs-clientcert'>Section&nbsp;4.4<span> (</span><span class='info'>Client Certificate</span><span>)</span></a>) and prove possession of the private key corresponding to the certified key.  The process of proving possession is described below.
</p>
<p>The cipher suites described in this document make use of the elliptic curve parameter negotiation mechanism defined in <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>, which makes use of TLS extensions <a class='info' href='#RFC4366'>[RFC4366]<span> (</span><span class='info'>Blake-Wilson, S., Nystrom, M., Hopwood, D., Mikkelsen, J., and T. Wright, &ldquo;Transport Layer Security (TLS) Extensions,&rdquo; April&nbsp;2006.</span><span>)</span></a>.  When the cipher suites defined in this document are used, the 'ecmqv_ecqv' case inside the ServerKeyExchange and ClientKeyExchange structure MUST be used (i.e., the ServerKeyExchange and ClientKeyExchange messages MUST include the ECQV parameters).
</p>
<a name="datastructs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Data Structures and Computations</h3>

<p>This section specifies the data structures and computations used by ECMQV key mechanisms specified in <a class='info' href='#ciphersuites'>Section&nbsp;5<span> (</span><span class='info'>ECMQV_ECQV-Based Cipher Suites</span><span>)</span></a>.  The presentation language used here is the same as that used in TLS <a class='info' href='#RFC4346'>[RFC4346]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.1,&rdquo; April&nbsp;2006.</span><span>)</span></a>.  Since this specification extends TLS, these descriptions should be merged with those in the TLS specification and any others that extend TLS.  This means that enum types may not specify all possible values, and structures with multiple formats chosen with a select() clause may not indicate all possible cases.
</p>
<p>The ClientHello message and the ServerHello messages are unchanged and utilize those used in <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="datastructs-servercert"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Server Certificate</h3>

<p>When this message is sent:
</p>
<p>This message is sent in all ECMQV_ECQV-based cipher suites.
</p>
<p>Meaning of this message:
</p>
<p>This message is used to authentically convey the server's static public key to the client.  ECC public keys MUST be encoded in a Certificate message.
</p>
<p>Structure of this message:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    opaque ECQVCert&lt;1..2^8-1&gt;

    struct {
        ECQVCert certificate_list&lt;0..2^16-1&gt;
    } Certificate;
</pre></div>
<p>The ECQVCert value is defined by the underlying application specification.  For general details on the necessary components see SEC 4 <a class='info' href='#SEC4'>[SEC4]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Qu-Vanstone Implicit Certificate Scheme (ECQV), v0.91,&rdquo; November&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The server constructs an appropriate Certificate structure and conveys it to the client in the Certificate message.  If the client has used a Supported Elliptic Curves Extension, the public key in the server's certificate MUST respect the client's choice of elliptic curves; in particular, the public key MUST employ a named curve (not the same curve as an explicit curve) unless the client has indicated support for explicit curves of the appropriate type.  If the client has used a Supported Point Formats Extension, both the server's public key point and (in the case of an explicit curve) the curve's base point MUST respect the client's choice of point formats.  (A server that cannot satisfy these requirements MUST NOT choose an ECMQV_ECQV cipher suite in its ServerHello message.)
</p>
<p>Actions of the receiver:
</p>
<p>The client validates the information in the ECQVCert and extracts the server's public key using the operations specified in SEC 4 <a class='info' href='#SEC4'>[SEC4]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Qu-Vanstone Implicit Certificate Scheme (ECQV), v0.91,&rdquo; November&nbsp;2008.</span><span>)</span></a> section 2.3, under the curve specified in the Server Key Exchange message defined in <a class='info' href='#datastructs-serverkeyex'>Section&nbsp;4.2<span> (</span><span class='info'>Server Key Exchange</span><span>)</span></a>.  (A possible reason for a fatal handshake failure is that the client's capabilities for handling elliptic curves and point formats are exceeded; cf. <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>, Section 5.1.)
</p>
<a name="datastructs-serverkeyex"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Server Key Exchange</h3>

<p>When this message is sent:
</p>
<p>This message is sent in all ECMQV_ECQV-based cipher suites.
</p>
<p>Meaning of this message:
</p>
<p>This message is used to convey the server's ephemeral ECMQV public key (and the corresponding elliptic curve domain parameters) to the client.
</p>
<p>Structure of this message:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    struct {
        ECParameters curve_params;
        ECPoint      public;
    } ServerECMQVParams;
</pre></div>
<p>curve_params:   Specifies the elliptic curve domain parameters associated with the ECMQV public key and is as specified in <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>, Section 5.4.
</p>
<p>public:   The ephemeral ECMQV public key.
</p>
<p>The ServerKeyExchange message is extended as follows.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    enum {
        ec_mqv (xx)
    } KeyExchangeAlgorithm;
</pre></div>
<p>ec_mqv:   Indicates the ServerKeyExchange message contains an ECMQV public key.
</p>
<p>The ServerKeyExchange structure is extended as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    select (KeyExchangeAlgorithm) {
        case ec_mqv:
            ServerECMQVParams params;
    } ServerKeyExchange;
</pre></div>
<p>params:   Specifies the ECMQV public key and associated domain parameters.
</p>
<p>Actions of the sender:
</p>
<p>The server selects elliptic curve domain parameters and an ephemeral ECMQV public key corresponding to these parameters according to the ECKAS-MQV scheme as specified in <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>, Section 6.2.  It conveys this information to the client in the ServerKeyExchange message using the format defined above.
</p>
<p>NOTE: curve_params MUST specify the same curve that is used by the CA, and the curve on which the point in the Certificate from the server's Certificate message lies.
</p>
<p>Actions of the receiver:
</p>
<p>The client retrieves the server's elliptic curve domain parameters and ephemeral ECMQV public key from the ServerKeyExchange message and MUST validate the parameters in accordance with <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>, Section 6.2.1, and MUST validate the ephemeral public keys in accordance with <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>, Section 6.2.2.  (A possible reason for a fatal handshake failure is that the client's capabilities for handling elliptic curves and point formats are exceeded;  cf. <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>, Section 5.1.)
</p>
<a name="datastructs-certreq"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Certificate Request</h3>

<p>When this message is sent:
</p>
<p>This message is sent by the server when requesting client authentication.
</p>
<p>Meaning of this message:
</p>
<p>The server uses this message to suggest acceptable client authentication methods.
</p>
<p>Structure of this message:
</p>
<p>The CertificateRequest message is extended as follows.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    enum {
        ecqv_ecmqv (xx),
    } ClientCertificateType;
</pre></div>
<p>ecqv_ecmqv: Indicates that the server would like to use the corresponding client authentication method specified in <a class='info' href='#datastructs-clientcert'>Section&nbsp;4.4<span> (</span><span class='info'>Client Certificate</span><span>)</span></a>.
</p>
<p>The SignatureAndHashAlgorithms are extended by the addition of a hashing algorithm which uses the Advanced Encryption Standard (AES) functions AES-128 and AES-256 in Matyas-Meyer-Oseas (MMO) hash function mode (<a class='info' href='#ZigBee'>[ZigBee]<span> (</span><span class='info'>ZigBee Standards Organization, &ldquo;ZigBee Specification, revision 17,&rdquo; October&nbsp;2007.</span><span>)</span></a>, Section B.6; see also <a class='info' href='#MOV96'>[MOV96]<span> (</span><span class='info'>Menezes, A., van Oorschot, P., and S. Vanstone, &ldquo;Handbook of Applied Cryptography,&rdquo; 1996.</span><span>)</span></a>, Section 9.4.1) and an implicit certificate type signature for ECQV.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    enum {
        aes_128_mmo (xx), aes_256_mmo (xx)
    } HashAlgorithm;

    enum {
        ecqv (xx)
    } SignatureAlgorithm;

    struct {
        ClientCertificateType certificate_types&lt;1..2^8-1&gt;;
        SignatureAndHashAlgorithm
            supported_signature_algorithms&lt;1..2^16-1&gt;;
        DistinguishedName certificate_authorities&lt;0..2^16-1&gt;;
    } CertificateRequest;
</pre></div>
<p>The benefit of ECQV certificate exchanges is the reduction in packet sizes.  It is expected that most of the parties communicating via ECQV certificates belong to the same or a small list of acceptable certificate authorities, and that these certificate authorities are identified within the certificates.  As such, it is expected that the certificate_authorities list will often be empty.
</p>
<p>The interaction of the certificate_types and supported_signature_algorithms fields is further complicated when using TLS version 1.2 <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.  The following rules augment the existing rules in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>:
</p>
<ul class="text">
<li>If the ecqv SignatureAlgorithm type is specified, it only applies to the public key contained in the end-entity certificate.  It cannot be used to sign certificates.
</li>
</ul>
<p>Actions of the sender:
</p>
<p>The server decides which client authentication methods it would like to use, and conveys this information to the client using the format defined above.
</p>
<p>Actions of the receiver:
</p>
<p>The client determines whether it has a suitable certificate for use with any of the requested methods and whether to proceed with client authentication.
</p>
<a name="datastructs-clientcert"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Client Certificate</h3>

<p>When this message is sent:
</p>
<p>This message is sent by the client in response to a CertificateRequest when a client has a suitable certificate and has decided to proceed with client authentication.  (Note that if the server has used a Supported Point Formats Extension, a certificate can only be considered suitable for use with the ECQV_ECMQV authentication methods if the public key point specified in it respects the server's choice of point formats.  If no Supported Point Formats Extension has been used, a certificate can only be considered suitable for use with these authentication methods if the point is represented in uncompressed point format.)
</p>
<p>Meaning of this message:
</p>
<p>This message is used to authentically convey the client's static public key to the server in an ECQV certificate.
</p>
<p>Structure of this message:
</p>
<p>Identical to the ECQV Certificate format specified in Server Certificate <a class='info' href='#datastructs-servercert'>Section&nbsp;4.1<span> (</span><span class='info'>Server Certificate</span><span>)</span></a>.
</p>
<p>Actions of the sender:
</p>
<p>The client constructs an appropriate Certificate message.
</p>
<p>NOTE: The ECQV certificate MUST be issued by a CA on the same curve specified in the ECParameters sent in the Server Key Exchange message.  The point in the ECQV certificate MUST also be on the same curve.
</p>
<p>Actions of the receiver:
</p>
<p>The server validates the information in the ECQVCert, and extracts the client's public key using the operations specified in <a class='info' href='#SEC4'>[SEC4]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Qu-Vanstone Implicit Certificate Scheme (ECQV), v0.91,&rdquo; November&nbsp;2008.</span><span>)</span></a> section 2.3, under the curve specified in the Server Key Exchange message defined in <a class='info' href='#datastructs-serverkeyex'>Section&nbsp;4.2<span> (</span><span class='info'>Server Key Exchange</span><span>)</span></a>.
</p>
<a name="datastructs-clientkeyex"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Client Key Exchange</h3>

<p>When this message is sent:
</p>
<p>This message is sent in all ECMQV_ECQV-based cipher suites.
</p>
<p>Meaning of the message:
</p>
<p>This message is used to convey the client's ephemeral ECMQV public key.
</p>
<p>Structure of this message:
</p>
<p>The ClientKeyExchange message mimics <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a> as follows.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    enum { implicit, explicit } PublicValueEncoding;
</pre></div>
<p>implicit, explicit: For ECMQV_ECQV cipher suites, this indicates whether the client's has one ECMQV public key in the client's certificate ("implicit") and is providing one ephemeral ECMQV public key or if it is providing two ephemeral ECMQV public keys, in the ClientKeyExchange message ("explicit").
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    struct {
        select (PublicValueEncoding) {
            case implicit:
                ECPoint ecmqv_q2;
            case explicit: struct {
                ECPoint ecmqv_q1;
                ECPoint ecmqv_q2;
            };
        } ecmqv_public;
    } ClientECMQVPublic;
</pre></div>
<p>ecmqv_q1: Contains the client's ephemeral ECMQV public key as a byte string ECPoint.point, which may represent an elliptic curve point in uncompressed or compressed format.  Here, the format MUST conform to what the server has requested through a Supported Point Formats Extension if this extension was used, and MUST be uncompressed if this extension was not used.
</p>
<p>ecmqv_q2: Is the same as above.
</p>
<p>The ClientKeyExchange message is extended as follows.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    struct {
        select (KeyExchangeAlgorithm) {
            case ecmqv:
                ClientECMQVPublic;
        } exchange_keys;
    } ClientKeyExchange;
</pre></div>
<p>Actions of the sender:
</p>
<p>The client selects an ephemeral ECMQV public key corresponding to the parameters it received from the server according to the ECKAS-MQV scheme as specified in <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>, Section 6.2.  It conveys this information to the client in the ClientKeyExchange message using the format defined above.
</p>
<p>Actions of the receiver:
</p>
<p>The server retrieves the client's ephemeral ECMQV public key(s) from the ClientKeyExchange message, checks that the public key(s) is(are) on the same elliptic curve as the server's ECMQV key, and validates the ephemeral public keys in accordance with <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>, Section 6.2.2.
</p>
<p>The premaster secret is formed as follows.  First, recover the static public key in the ECQV certificate as described in <a class='info' href='#SEC4'>[SEC4]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Qu-Vanstone Implicit Certificate Scheme (ECQV), v0.91,&rdquo; November&nbsp;2008.</span><span>)</span></a>, Section 2.5, and then perform the ECMQV computation as described in <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>, Section 6.2.  Let premaster secret be the octet string produced by this computation.
</p>
<a name="ciphersuites"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
ECMQV_ECQV-Based Cipher Suites</h3>

<a name="ciphersuites-sha1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
ECMQV_ECQV Cipher Suites Using the SHA-1 Hash Function</h3>

<p>The document specifies four cipher suites using ECMQV key exchange and ECQV certificates with RC-4, Triple-DES (3DES), or Advanced Encryption Standard (AES) encryption and the SHA-1 hash function:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    CipherSuite TLS_ECMQV_ECQV_WITH_RC4_128_SHA          = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_3DES_EDE_CBC_SHA     = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_128_CBC_SHA      = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_256_CBC_SHA      = {0xXX,0xXX};
</pre></div>
<a name="ciphersuites-sha2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
ECMQV_ECQV Cipher Suites Using the SHA2 Hash Function Family</h3>

<p>The document specifies two cipher suites using ECMQV key exchange and ECQV certificates with AES encryption and the SHA2 hash function family:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_128_CBC_SHA256   = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_256_CBC_SHA384   = {0xXX,0xXX};
</pre></div>
<p>The above two cipher suites are the same as the corresponding AES cipher suites in <a class='info' href='#ciphersuites-sha1'>Section&nbsp;5.1<span> (</span><span class='info'>ECMQV_ECQV Cipher Suites Using the SHA-1 Hash Function</span><span>)</span></a> above, except for the hash and PRF algorithms, which are as follows.
</p>
<p>For TLS_ECMQV_ECQV_WITH_AES_128_CBC_SHA256:
</p>
<ul class="text">
<li>The MAC is HMAC <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a> with SHA-256 as the hash function.
</li>
<li>When negotiated in a version of TLS prior to 1.2, the PRF from that version is used; otherwise the PRF is the TLS version 1.2 PRF <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> with SHA-256 as the hash function.
</li>
</ul>
<p>For TLS_ECMQV_ECQV_WITH_AES_256_CBC_SHA384:
</p>
<ul class="text">
<li>The MAC is HMAC <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a> with SHA-384 as the hash function.
</li>
<li>When negotiated in a version of TLS prior to 1.2, the PRF from that version is used; otherwise the PRF is the TLS version 1.2 PRF <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> with SHA-384 as the hash function.
</li>
</ul>
<a name="ciphersuites-aesmmo"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
ECMQV_ECQV Cipher Suites Using AES-MMO Hash Functions</h3>

<p>The document specifies two cipher suites using ECMQV key exchange and ECQV certificates with AES encryption and AES-MMO hash functions:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_128_CCM_AES_128_MMO = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_128_CCM_AES_256_MMO = {0xXX,0xXX};
</pre></div>
<p>The AES-MMO hash functions are specified in <a class='info' href='#ZigBee'>[ZigBee]<span> (</span><span class='info'>ZigBee Standards Organization, &ldquo;ZigBee Specification, revision 17,&rdquo; October&nbsp;2007.</span><span>)</span></a>, Section B.6.
</p>
<p>These two cipher suites are similar to the above and are included to accommodate the Certificate-Based Key Establishment (CBKE) scheme in <a class='info' href='#ZigBeeSE'>[ZigBeeSE]<span> (</span><span class='info'>ZigBee Standards Organization, &ldquo;ZigBee Smart Energy Profile Specification, revision 15,&rdquo; December&nbsp;2008.</span><span>)</span></a>.
</p>
<ul class="text">
<li>The MAC is HMAC <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a> with AES-128-MMO or AES-256-MMO, respectively, as the hash function.
</li>
<li>When negotiated in a version of TLS prior to 1.2, the PRF from that version is used; otherwise the PRF is the TLS version 1.2 PRF <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a> with AES-128-MMO or AES-256-MMO, respectively, as the hash function.
</li>
</ul>
<a name="ciphersuitesnull"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
ECMQV_ECQV-Based Cipher Suites With NULL Encryption</h3>

<p>This section specifies cipher suites using the NULL encryption algorithm.  As a result, these cipher suites provide only authentication, not confidentiality.
</p>
<a name="ciphersuitesnull-sha1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
ECMQV_ECQV Cipher Suite Using the SHA-1 Hash Function with NULL Encryption</h3>

<p>The following cipher suite matches the cipher suites defined in <a class='info' href='#ciphersuites-sha1'>Section&nbsp;5.1<span> (</span><span class='info'>ECMQV_ECQV Cipher Suites Using the SHA-1 Hash Function</span><span>)</span></a>, except that we define a suite with NULL encryption.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    CipherSuite TLS_ECMQV_ECQV_WITH_NULL_SHA             = {0xXX,0xXX};
</pre></div>
<a name="ciphersuitesnull-sha2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
ECMQV_ECQV Cipher Suites Using the SHA2 Hash Function Family with NULL Encryption</h3>

<p>The following two cipher suites are the same as the corresponding cipher suites in <a class='info' href='#ciphersuites-sha2'>Section&nbsp;5.2<span> (</span><span class='info'>ECMQV_ECQV Cipher Suites Using the SHA2 Hash Function Family</span><span>)</span></a>, but with NULL encryption.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    CipherSuite TLS_ECMQV_ECQV_WITH_NULL_SHA256          = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_NULL_SHA384          = {0xXX,0xXX};
</pre></div>
<a name="ciphersuitesnull-aesmmo"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
ECMQV_ECQV Cipher Suites Using AES-MMO Hash Functions with NULL Encryption</h3>

<p>The following two cipher suites are the same as the corresponding cipher suites in <a class='info' href='#ciphersuites-aesmmo'>Section&nbsp;5.3<span> (</span><span class='info'>ECMQV_ECQV Cipher Suites Using AES-MMO Hash Functions</span><span>)</span></a>, but with NULL encryption.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    CipherSuite TLS_ECMQV_ECQV_WITH_NULL_AES_128_MMO     = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_NULL_AES_256_MMO     = {0xXX,0xXX};
</pre></div>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>This document provides new cipher suites for the Transport Layer Security protocol.  For the most part, the security considerations involved in using the Transport Layer Security protocol apply.  Additionally, implementers should be aware of security considerations specific to elliptic curve cryptography.
</p>
<p>For ECMQV authenticated key exchange, the current best known technique for breaking the cryptosystems is by solving the elliptic curve discrete logarithm problem (ECDLP).
</p>
<p>The difficulty of breaking the ECDLP depends on the size and quality of the elliptic curve parameters.  Certain types of curves can be more susceptible to known attacks than others.  For example, curves over finite fields GF(2^m), where m is composite, may be susceptible to an attack based on the Weil descent.  All of the named curves specified in <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>, Section 5.1.1, do not have this problem.  System administrators should be cautious when enabling named curves other than the ones specified in <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a> or in supporting explicit curves, and should make a more detailed investigation into the security of the curve in question.
</p>
<p>It is believed (see for example Section B.2.1 of <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>) that when curve parameters are generated at random the curves will be resistant to special attacks, and must rely on the most general attacks.  The named curves in <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>, Section 5.1.1, were all generated verifiably pseudorandomly.  The runtime of general attacks depends on the algorithm used.  At present, the best known algorithm is the Pollard-rho method.  (Shor's algorithm for quantum computers can solve the ECDLP in polynomial time, but at present large-scale quantum computers have not been constructed and significant experimental physics and engineering work needs to be done before large-scale quantum computers can be constructed.  There is no solid estimate as to when this may occur, but it is widely believed to be at least 20 years from the present.)
</p>
<p>Based on projections of computation power, it is possible to estimate the running time of the best known attacks based on the size of the finite field.  Table 1 in <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a> gives an estimate of the equivalence between elliptic curve field size and symmetric key size.  Roughly speaking, an N-bit elliptic curve offers the same security as an N/2-bit symmetric cipher, so a 256-bit elliptic curve (such as the secp256r1 curve) is suitable for use with 128-bit AES, for example.
</p>
<p>Many estimates consider that 2^80-2^90 operations are beyond feasible, so that would suggest using elliptic curves of at least 160-180 bits.  The REQUIRED curves in this documents are 256-, 384-, and 521-bit curves; implementations SHOULD NOT use curves smaller than 160 bits.
</p>
<p>A detailed discussion on the security considerations of elliptic curve domain parameters and the ECMQV algorithm can be found in Appendix B of <a class='info' href='#SEC1'>[SEC1]<span> (</span><span class='info'>Standards for Efficient Cryptography Group, &ldquo;Elliptic Curve Cryptography,&rdquo; September&nbsp;2000.</span><span>)</span></a>.
</p>
<p>Additionally, the cipher suites defined in this document rely on the SHA-1 hash function, the SHA2 family of hash functions, and the AES-MMO hash function, as well as the DES, Triple-DES, and AES block ciphers.  The appropriate security considerations of the documents defining those functions apply.  Although some weaknesses have been discovered in SHA-1, it still provides a reasonable level of security for lower security lebels.  No weaknesses in the SHA2 family are known at present.  The SHA2 family consists of four variants -- SHA-224, SHA-256, SHA-384, and SHA-521 -- named after their digest lengths.  In the absence of special purpose attacks exploiting the specific structure of the hash function, the difficulty of finding collisions, preimages, and second preimages for the hash function is related to the digest length.
</p>
<p>Since ECMQV allow for elliptic curves of arbitrary sizes and thus arbitrary security strength, it is important that the size of elliptic curve be chosen to match the security strength of other elements of the cipher suite.  In particular, key sizes, hashing algorithms and bulk encryption algorithms must be chosen appropriately.  Information regarding estimated equivalence of key sizes is available in <a class='info' href='#NIST-800-57'>[NIST&#8209;800&#8209;57]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Key Management - Part 1: General (Revised),&rdquo; March&nbsp;2007.</span><span>)</span></a>; the discussion in <a class='info' href='#RFC3766'>[RFC3766]<span> (</span><span class='info'>Orman, H. and P. Hoffman, &ldquo;Determining Strengths For Public Keys Used For Exchanging Symmetric Keys,&rdquo; April&nbsp;2004.</span><span>)</span></a> is also relevant.
</p>
<p>System administrators and implementers should take careful consideration of the security issues when enabling curves other than the named curves defined in <a class='info' href='#RFC4492'>[RFC4492]<span> (</span><span class='info'>Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS),&rdquo; May&nbsp;2006.</span><span>)</span></a>.  Not all elliptic curves are secure, even if they are over a large field.
</p>
<p>Implementers SHOULD ensure that any ephemeral private keys or random values -- including the ephemeral private key values in ECMQV -- are generated from a random number generator or a properly-seed pseudorandom number generator, are protected from leakage, are not reused outside of the context of the protocol in this document, and are erased from memory when no longer needed.  Additionally, implementers SHOULD ensure that any public keys received are validated as per the specification to avoid known attacks.
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document defines the following new cipher suites, whose values are to be assigned from the TLS Cipher Suite registry defined in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    CipherSuite TLS_ECMQV_ECQV_WITH_RC4_128_SHA          = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_3DES_EDE_CBC_SHA     = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_128_CBC_SHA      = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_256_CBC_SHA      = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_128_CBC_SHA256   = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_AES_256_CBC_SHA384   = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_NULL_SHA             = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_NULL_SHA256          = {0xXX,0xXX};
    CipherSuite TLS_ECMQV_ECQV_WITH_NULL_SHA384          = {0xXX,0xXX};
</pre></div>
<p>This document defines the following new client certificate types, whose values are to be assigned from the TLS ClientCertificateType Identifiers registry defined in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    ecqv_ecmqv (xx)
</pre></div>
<p>This document defines the following new signature algorithms, whose values are to be assigned from the TLS SignatureAlgorithm registry defined in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    ecqv (xx)
</pre></div>
<p>This document defines the following new hash algorithms, whose values are to be assigned from the TLS HashAlgorithm registry defined in <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    aes_128_mmo (xx),
    aes_256_mmo (xx)
</pre></div>
<p>This document creates no new registries.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS-180-3">[FIPS-180-3]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf">Secure Hash Standard</a>,&rdquo; FIPS&nbsp;180-3, October&nbsp;2008 (<a href="http://csrc.nist.gov/publications/fips/fips180-3/fips180-3_final.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="FIPS-197">[FIPS-197]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">Advanced Encryption Standard</a>,&rdquo; FIPS&nbsp;197, November&nbsp;2001 (<a href="hhttp://csrc.nist.gov/publications/fips/fips197/fips-197.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tls-rfc4347-bis">[I-D.ietf-tls-rfc4347-bis]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4347-bis-03.txt">Datagram Transport Layer Security version 1.2</a>,&rdquo; draft-ietf-tls-rfc4347-bis-03 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tls-rfc4347-bis-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST-800-57">[NIST-800-57]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57-Part1-revised2_Mar08-2007.pdf">Recommendation for Key Management - Part 1: General (Revised)</a>,&rdquo; NIST Special Publication&nbsp;800-57, March&nbsp;2007 (<a href="http://csrc.nist.gov/publications/nistpubs/800-57/sp800-57-Part1-revised2_Mar08-2007.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2246">[RFC2246]</a></td>
<td class="author-text"><a href="mailto:tdierks@certicom.com">Dierks, T.</a> and <a href="mailto:callen@certicom.com">C. Allen</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2246">The TLS Protocol Version 1.0</a>,&rdquo; RFC&nbsp;2246, January&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3766">[RFC3766]</a></td>
<td class="author-text">Orman, H. and P. Hoffman, &ldquo;<a href="http://tools.ietf.org/html/rfc3766">Determining Strengths For Public Keys Used For Exchanging Symmetric Keys</a>,&rdquo; BCP&nbsp;86, RFC&nbsp;3766, April&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3766.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4346">[RFC4346]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc4346">The Transport Layer Security (TLS) Protocol Version 1.1</a>,&rdquo; RFC&nbsp;4346, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4346.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4347">[RFC4347]</a></td>
<td class="author-text">Rescorla, E. and N. Modadugu, &ldquo;<a href="http://tools.ietf.org/html/rfc4347">Datagram Transport Layer Security</a>,&rdquo; RFC&nbsp;4347, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4347.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4366">[RFC4366]</a></td>
<td class="author-text">Blake-Wilson, S., Nystrom, M., Hopwood, D., Mikkelsen, J., and T. Wright, &ldquo;<a href="http://tools.ietf.org/html/rfc4366">Transport Layer Security (TLS) Extensions</a>,&rdquo; RFC&nbsp;4366, April&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4366.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4492">[RFC4492]</a></td>
<td class="author-text">Blake-Wilson, S., Bolyard, N., Gupta, V., Hawk, C., and B. Moeller, &ldquo;<a href="http://tools.ietf.org/html/rfc4492">Elliptic Curve Cryptography (ECC) Cipher Suites for Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;4492, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4492.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SEC1">[SEC1]</a></td>
<td class="author-text">Standards for Efficient Cryptography Group, &ldquo;<a href="http://www.secg.org/download/aid-780/sec1-v2.pdf">Elliptic Curve Cryptography</a>,&rdquo; SEC&nbsp;1, September&nbsp;2000 (<a href="http://www.secg.org/download/aid-780/sec1-v2.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SEC4">[SEC4]</a></td>
<td class="author-text">Standards for Efficient Cryptography Group, &ldquo;<a href="http://www.secg.org/download/aid-775/sec4-ECQV-v091.pdf">Elliptic Curve Qu-Vanstone Implicit Certificate Scheme (ECQV), v0.91</a>,&rdquo; SEC&nbsp;4, November&nbsp;2008 (<a href="http://www.secg.org/download/aid-775/sec4-ECQV-v091.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="ZigBee">[ZigBee]</a></td>
<td class="author-text">ZigBee Standards Organization, &ldquo;<a href="http://www.zigbee.org/ZigBeeSpecificationDownloadRequest/tabid/311/Default.aspx">ZigBee Specification, revision 17</a>,&rdquo; October&nbsp;2007 (<a href="http://www.zigbee.org/ZigBeeSpecificationDownloadRequest/tabid/311/Default.aspx">PDF</a>).<p>
Registration required.
</p>
</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="HMV04">[HMV04]</a></td>
<td class="author-text">Hankerson, D., Menezes, A., and S. Vanstone, &ldquo;Guide to Elliptic Curve Cryptography,&rdquo; 2004.<p>
Springer, ISBN 038795273X.
</p>
</td></tr>
<tr><td class="author-text" valign="top"><a name="IEEE1363">[IEEE1363]</a></td>
<td class="author-text">Institute of Electrical and Electronics Engineers, &ldquo;Standard Specifications for Public Key Cryptography,&rdquo; IEEE&nbsp;1363, 2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="LMQSV98">[LMQSV98]</a></td>
<td class="author-text">Law, L., Menezes, A., Qu, M., Solinas, J., and S. Vanstone, &ldquo;<a href="http://www.cacr.math.uwaterloo.ca/techreports/1998/corr98-05.pdf">An Efficient Protocol for Authenticated Key Agreement</a>,&rdquo; University of Waterloo Technical Report CORR&nbsp;98-05, August&nbsp;1998 (<a href="http://www.cacr.math.uwaterloo.ca/techreports/1998/corr98-05.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MOV96">[MOV96]</a></td>
<td class="author-text">Menezes, A., van Oorschot, P., and S. Vanstone, &ldquo;<a href="http://www.cacr.math.uwaterloo.ca/hac">Handbook of Applied Cryptography</a>,&rdquo; 1996 (<a href="http://www.cacr.math.uwaterloo.ca/hac/">HTML</a>).<p>
CRC Press, ISBN 0-8493-8523-7. Available online.
</p>
</td></tr>
<tr><td class="author-text" valign="top"><a name="ZigBeeSE">[ZigBeeSE]</a></td>
<td class="author-text">ZigBee Standards Organization, &ldquo;<a href="http://www.zigbee.org/ZigBeeSmartEnergyPublicApplicationProfile/tabid/312/Default.aspx">ZigBee Smart Energy Profile Specification, revision 15</a>,&rdquo; December&nbsp;2008 (<a href="http://www.zigbee.org/ZigBeeSmartEnergyPublicApplicationProfile/tabid/312/Default.aspx">PDF</a>).<p>
Registration required.
</p>
</td></tr>
</table>

<a name="ack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgements</h3>

<p>The authors gratefully acknowledge helpful suggestions from Hamid Mukhtar.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Matthew Campagna</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Certicom Corp.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5520 Explorer Drive #400</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mississauga, Ontario  L4W 5L1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mcampagna@certicom.com">mcampagna@certicom.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Douglas Stebila</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Queensland University of Technology</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Information Security Institute</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Level 7, 126 Margaret St</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brisbane, Queensland  4000</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Australia</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:douglas@stebila.ca">douglas@stebila.ca</a></td></tr>
</table>
</body></html>
