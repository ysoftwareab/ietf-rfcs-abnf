INTERNET-DRAFT                            Diffie-Hellman Keys in the DNS
                                                                May 1997
                                                   Expires November 1997




        Storage of Diffie-Hellman Keys in the Domain Name System
        ------- -- -------------- ---- -- --- ------ ---- ------

                         Donald E. Eastlake 3rd



Status of This Document

   This draft, file name draft-ietf-dnssec-dhk-00.txt, is intended to be
   become a Proposed or Experimental Standard RFC.  Distribution of this
   document is unlimited. Comments should be sent to the DNS security
   mailing list <dnssec@tis.com> or to the author.

   This document is an Internet-Draft.  Internet-Drafts are working
   documents of the Internet Engineering Task Force (IETF), its areas,
   and its working groups.  Note that other groups may also distribute
   working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six
   months.  Internet-Drafts may be updated, replaced, or obsoleted by
   other documents at any time.  It is not appropriate to use Internet-
   Drafts as reference material or to cite them other than as a
   ``working draft'' or ``work in progress.''

   To learn the current status of any Internet-Draft, please check the
   1id-abstracts.txt listing contained in the Internet-Drafts Shadow
   Directories on ds.internic.net (East USA), ftp.isi.edu (West USA),
   nic.nordu.net (North Europe), ftp.nis.garr.it (South Europe),
   munnari.oz.au (Pacific Rim), or ftp.is.co.za (Africa).


















Donald E. Eastlake 3rd                                          [Page 1]


INTERNET-DRAFT                            Diffie-Hellman Keys in the DNS


Abstract

   A standard method for storing Diffie-Hellman keys in the Domain Name
   System is described which utilizes DNS KEY resource records.



Acknowledgements

   Part of the format for Diffie-Hellman keys and the description
   thereof was taken from an Internet draft by:

        Ashar Aziz <ashar.aziz@eng.sun.com>
        Tom Markson <markson@incog.com>
        Hemma Prafullchandra <hemma@eng.sun.com>

   In addition, the following person provided useful comments that have
   been incorporated:

        Ran Atkinson <rja@inet.org>
































Donald E. Eastlake 3rd                                          [Page 2]


INTERNET-DRAFT                            Diffie-Hellman Keys in the DNS


Table of Contents

      Status of This Document....................................1

      Abstract...................................................2
      Acknowledgements...........................................2

      Table of Contents..........................................3

      1. Introduction............................................4

      2. Diffie-Hellman KEY Resource Records.....................5

      3. Performance Considerations..............................6
      4. Security Considerations.................................6

      References.................................................7
      Author's Address...........................................7
      Expiration and File Name...................................7

































Donald E. Eastlake 3rd                                          [Page 3]


INTERNET-DRAFT                            Diffie-Hellman Keys in the DNS


1. Introduction

   The Domain Name System (DNS) is the current global hierarchical
   replicated distributed database system for Internet addressing, mail
   proxy, and similar information. The DNS has recently been extended to
   include digital signatures and cryptographic keys as described in RFC
   2065.  Thus the DNS can now be used for secure key distribution.

   This document describes how to store Diffie-Hellman keys in the DNS.
   Familiarity with the Diffie-Hellman key exchange algorithm is assumed
   [Schneier].

   Diffie-Hellman requires two parties to interact to derive keying
   information which can then be used for authentication.  Since DNS SIG
   RRs are primarily used as quasi-static authenticators of zone
   information for all resolvers, no Diffie-Hellman algorithm SIG RR is
   defined.



































Donald E. Eastlake 3rd                                          [Page 4]


INTERNET-DRAFT                            Diffie-Hellman Keys in the DNS


2. Diffie-Hellman KEY Resource Records

   Diffie-Hellman keys are stored in the DNS as KEY RRs using algorithm
   number 2.  The structure of the RDATA portion of this RR is as shown
   below.  The first 4 octets, including the flags, protocol, and
   algorithm fields are common to all KEY RRs as described in RFC 2065.
   The remainder, from prime length through public value is the "public
   key" part of the KEY RR. The period of key validity is not in the KEY
   RR but is indicated by the SIG RR(s) which signs and authenticates
   the KEY RR(s) at that domain name.

                            1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |             flags             |    protocol   |  algorithm=2  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |          prime length         | prime (p)   (variable length) /
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       /  prime (p)  (variable length) |       generator length        |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | generator (g) (variable length)                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |     public value length       | public value (variable length)/
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       /  public value (g^i mod p)    (variable length)                |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   [Is it worth while defining some standard internet values for p and
   g? That you are using them could be flagged by a zero or tiny "prime
   length". Using such standard values would shorten the DH KEY RR a lot
   but they might be tempting targets to break.]

   Prime length is length of the Diffie-Hellman prime (p) in bytes.
   Prime contains the binary representation of the Diffie-Hellman prime
   with most significant byte first.

   Generator length is the length of the generator (g) in bytes.
   Generator is the binary representation of generator with most
   significant byte first.  PublicValueLen is the Length of the Public
   Value (g^i mod p) in bytes.  PublicValue is the binary representation
   of the DH public value with most significant byte first.

   The corresponding algorithm=2 SIG resource record is not used so no
   format for it is defined.








Donald E. Eastlake 3rd                                          [Page 5]


INTERNET-DRAFT                            Diffie-Hellman Keys in the DNS


3. Performance Considerations

   Current DNS implementations are optimized for small transfers,
   typically less than 512 bytes including overhead.  While larger
   transfers will perform correctly and work is underway to make larger
   transfers more efficient, it is still advisable at this time to make
   reasonable efforts to minimize the size of KEY RR sets stored within
   the DNS consistent with adequate security.  Keep in mind that in a
   secure zone, an authenticating SIG RR will also be returned.



4. Security Considerations

   Many of the security consideration in RFC 2065 apply.  Of course, the
   Diffie-Hellman key stored in the DNS for an entity should not be
   trusted unless it has been obtain via a trusted DNS resolver that
   vouches for its security or unless the application using the key has
   done a similar authentication.

   In addition, the usual Diffie-Hellman key strength considerations
   apply. (p-1)/2 should also be prime, g should be primitive mod p, p
   should be "large", etc.  [Schneier]





























Donald E. Eastlake 3rd                                          [Page 6]


INTERNET-DRAFT                            Diffie-Hellman Keys in the DNS


References

   [RFC 1034] - P. Mockapetris, "Domain names - concepts and
   facilities", 11/01/1987.

   [RFC 1035] - P. Mockapetris, "Domain names - implementation and
   specification", 11/01/1987.

   [RFC 2065] - Domain Name System Security Extensions, D. Eastlake, C.
   Kaufman, January 1997.

   [Schneier] - Bruce Schneier, "Applied Cryptography: Protocols,
   Algorithms, and Source Code in C", 1996, John Wiley and Sons




Author's Address

   Donald E. Eastlake 3rd
   CyberCash, Inc.
   318 Acton Street
   Carlisle, MA 01741 USA

   Telephone:   +1 508 287 4877
                +1 703 620-4200 (main office, Reston, VA)
   FAX:         +1 508 371 7148
   EMail:       dee@cybercash.com



Expiration and File Name

   This draft expires in November 1997.

   Its file name is draft-ietf-dnssec-dhk-00.txt.
















Donald E. Eastlake 3rd                                          [Page 7]

