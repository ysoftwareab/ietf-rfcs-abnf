<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>SIP SAML Profile and Binding</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="SIP SAML Profile and Binding">
<meta name="keywords" content="Internet-Draft, I-D, SAML, SIP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIP</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc4474'>4474</a> (if&nbsp;approved)</td><td class="header">J. Hodges</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Peterson</td></tr>
<tr><td class="header">Expires: January 15, 2009</td><td class="header">NeuStar, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Polk</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">D. Sicker</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">CU Boulder</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 14, 2008</td></tr>
</table></td></tr></table>
<h1><br />SIP SAML Profile and Binding<br />draft-ietf-sip-saml-04.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 15, 2009.</p>

<h3>Abstract</h3>

<p>
                This document specifies a Session Initiation Protocol
                (SIP) profile of Security Assertion Markup Language
                (SAML) as well as a SAML SIP binding. The defined SIP
                SAML Profile composes with the mechanisms defined in
                the SIP Identity specification and satisfy
                requirements presented in &quot;Trait-based
                Authorization Requirements for the Session Initiation
                Protocol (SIP)&quot;.
            
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#saml-introduction">3.</a>&nbsp;
SAML Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#assertions">3.1.</a>&nbsp;
SAML Assertions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#request-response">3.2.</a>&nbsp;
Abstract Request/Response Protocol<br />
<a href="#goals-nongoals">4.</a>&nbsp;
Specification Scope<br />
<a href="#empl-saml-sip">5.</a>&nbsp;
Employing SAML in SIP<br />
<a href="#sip-saml-profiles">6.</a>&nbsp;
SIP SAML Profiles<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ssp-as-driven-attr-">6.1.</a>&nbsp;
AS-driven SIP SAML URI-based Attribute 
                       Assertion Fetch Profile<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ssp-asd-req-info">6.1.1.</a>&nbsp;
Required Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ssp-asd-overview">6.1.2.</a>&nbsp;
Profile Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ssp-asd-prof-descp">6.1.3.</a>&nbsp;
Profile Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ssp-asd-assn-prof-descp">6.1.4.</a>&nbsp;
Assertion Profile Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ssp-asd-assn-verif">6.1.5.</a>&nbsp;
Assertion Verification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ssp-tbd">6.2.</a>&nbsp;
The TBD &quot;call-by-value&quot;  Profile<br />
<a href="#saml-sip-bindings">7.</a>&nbsp;
SAML SIP Binding<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ssb-saml-http-uri-sip-binding">7.1.</a>&nbsp;
SAML HTTP-URI-based SIP Binding<br />
<a href="#option-tag">8.</a>&nbsp;
The 'saml-shusb' Option Tag<br />
<a href="#example">9.</a>&nbsp;
Example SAML Assertions<br />
<a href="#sec-cons">10.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-stolen-assn">10.1.</a>&nbsp;
Man-in-the-Middle Attacks and Stolen Assertions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-forged-assn">10.2.</a>&nbsp;
Forged Assertion<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec-cons-replay-attack">10.3.</a>&nbsp;
Replay Attack<br />
<a href="#anchor1">11.</a>&nbsp;
Contributors<br />
<a href="#anchor2">12.</a>&nbsp;
Acknowledgments<br />
<a href="#iana">13.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">13.1.</a>&nbsp;
IANA Registration for New SIP Option Tag<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">13.2.</a>&nbsp;
477 'Use Identity Header with SAML Assertion' Response Code<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">13.3.</a>&nbsp;
478 'Unknown SAML Assertion Content' Response Code<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">13.4.</a>&nbsp;
479 'Invalid SAML Assertion' Response Code<br />
<a href="#anchor7">14.</a>&nbsp;
Open Issues<br />
<a href="#anchor8">15.</a>&nbsp;
Change Log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">15.1.</a>&nbsp;
-03 to -04<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">15.2.</a>&nbsp;
-02 to -03<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">15.3.</a>&nbsp;
-00 to -02<br />
<a href="#rfc.references1">16.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">16.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">16.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
                This document specifies composition of the Security
                Assertion Markup Language (SAML) V2.0 with SIP <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> in order to accommodate richer
                authorization mechanisms and enable &quot;trait-based
                authorization.&quot; Trait-based authorization is
                where one is authorized to make use of some resource
                based on roles or traits rather than ones
                identifier(s). Motivations for trait-based
                authorization, along with use-case scenarios, are
                presented in <a class='info' href='#RFC4484'>[RFC4484]<span> (</span><span class='info'>Peterson, J., Polk, J., Sicker, D., and H. Tschofenig, &ldquo;Trait-Based Authorization Requirements for the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
            
</p>
<p>
                Security Assertion Markup Language (SAML) v2.0, 
                &quot;SAMLv2&quot;, 
                is an XML-based framework for creating and exchanging
                security information. <a class='info' href='#OASIS.sstc-saml-exec-overview-2.0-cd-01'>[OASIS.sstc&#8209;saml&#8209;exec&#8209;overview&#8209;2.0&#8209;cd&#8209;01]<span> (</span><span class='info'>Madsen, P. and E. Maler, &ldquo;SAML V2.0 Executive Overview,&rdquo; April&nbsp;2005.</span><span>)</span></a> and 
                <a class='info' href='#OASIS.sstc-saml-tech-overview-2.0-draft-08'>[OASIS.sstc&#8209;saml&#8209;tech&#8209;overview&#8209;2.0&#8209;draft&#8209;08]<span> (</span><span class='info'>Hughes, J. and E. Maler, &ldquo;Security Assertion Markup Language             (SAML) V2.0 Technical Overview,&rdquo; September&nbsp;2005.</span><span>)</span></a> 
                provide non-normative overviews of SAMLv2. The SAMLv2
                specification set is normatively defined by
                <a class='info' href='#OASIS.saml-conformance-2.0-os'>[OASIS.saml&#8209;conformance&#8209;2.0&#8209;os]<span> (</span><span class='info'>Mishra, P., Philpott, R., and E. Maler, &ldquo;Conformance Requirements for the Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
            
</p>
<p>
                Various means of providing trait-based authorization
                exist: authorization certificates 
                <a class='info' href='#RFC3281'>[RFC3281]<span> (</span><span class='info'>Farrell, S. and R. Housley, &ldquo;An Internet Attribute Certificate Profile for Authorization,&rdquo; April&nbsp;2002.</span><span>)</span></a>, SPKI <a class='info' href='#RFC2693'>[RFC2693]<span> (</span><span class='info'>Ellison, C., Frantz, B., Lampson, B., Rivest, R., Thomas, B., and T. Ylonen, &ldquo;SPKI Certificate Theory,&rdquo; September&nbsp;1999.</span><span>)</span></a>, or
                extensions to the authenticated identity body <a class='info' href='#RFC3893'>[RFC3893]<span> (</span><span class='info'>Peterson, J., &ldquo;Session Initiation Protocol (SIP) Authenticated Identity Body (AIB) Format,&rdquo; September&nbsp;2004.</span><span>)</span></a>. The authors
                selected SAML due to its increasing use in
                environments such as the Liberty Alliance,
                and the
                Internet2 project, areas where the applicability to
                SIP is widely desired.
            
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
                The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
                "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",
                "MAY", and "OPTIONAL" in this document are to be
                interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
            
</p>
<p>
                The SIP network element &quot;Authentication
                Service&quot; is introduced in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. We reuse this term
                to refer to a network element that authenticates and
                authorizes a user and creates a &quot;SIP identity
                assertion&quot;. This
                system entity is the logical equivalent of a &quot;SAML
                Authority&quot; in the SAML terminology.
            
</p>
<p>
                For overall SIP terminology, see <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>.
            
</p>
<p>
                In this specification, the term, or term component,
                &quot;SAML&quot; refers to SAML V2.0 in all cases. For
                example, the term &quot;SAML assertion&quot;
                implicitly means &quot;SAMLv2 assertion&quot;.
                
                For overall SAML terminology, see <a class='info' href='#OASIS.saml-glossary-2.0-os'>[OASIS.saml&#8209;glossary&#8209;2.0&#8209;os]<span> (</span><span class='info'>Hodges, J., Philpott, R., and E. Maler, &ldquo;Glossary for the Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
            
</p>
<p>
                The below list maps other various SIP terms to their SAML
                (rough-)equivalents:

                </p>
<blockquote class="text">
<p>  
                        </p>
<blockquote class="text"><dl>
<dt>Element, Network Element:</dt>
<dd>
                                <br />


                                System Entity, Entity<br />
<br />

                            
</dd>
<dt>Authentication Service:</dt>
<dd>
                                <br />


                                SAML Authority<br />
<br />

                            
</dd>
<dt>Invitee, Invited User,
                                Called Party, Callee:</dt>
<dd>
                                <br />


                                Relying Party<br />
<br />

                            
</dd>
<dt>Server, User Agent Server (UAS):</dt>
<dd>
                                <br />


                                SAML Responder<br />
<br />

                            
</dd>
<dt>User Agent Client (UAC), client:</dt>
<dd>
                                <br />


                                SAML Requester<br />
<br />

                            
</dd>
</dl></blockquote>
                    

</blockquote><p>
            
</p>
<p>
                <br />
<br />
 

                Additional terms defined in the context of this
                specification:

                </p>
<blockquote class="text">
<p>
                        </p>
<blockquote class="text"><dl>
<dt>profile attribute(s):</dt>
<dd>
                                <br />
 
                                one or more attributes of a &quot;user
                                profile&quot;.
                            
</dd>
<dt>user profile, subject profile:</dt>
<dd>
                                <br />
 
                                the set of various
                                attributes accompanying (i.e., mapped to) 
                                a user account in many 
                                environments. 
                            
</dd>
</dl></blockquote>
                    

</blockquote><p>
            
</p>
<a name="saml-introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
SAML Introduction</h3>

<p>
                SAML 
                <a class='info' href='#OASIS.sstc-saml-exec-overview-2.0-cd-01'>[OASIS.sstc&#8209;saml&#8209;exec&#8209;overview&#8209;2.0&#8209;cd&#8209;01]<span> (</span><span class='info'>Madsen, P. and E. Maler, &ldquo;SAML V2.0 Executive Overview,&rdquo; April&nbsp;2005.</span><span>)</span></a>
                <a class='info' href='#OASIS.sstc-saml-tech-overview-2.0-draft-08'>[OASIS.sstc&#8209;saml&#8209;tech&#8209;overview&#8209;2.0&#8209;draft&#8209;08]<span> (</span><span class='info'>Hughes, J. and E. Maler, &ldquo;Security Assertion Markup Language             (SAML) V2.0 Technical Overview,&rdquo; September&nbsp;2005.</span><span>)</span></a> 
                defines an XML-based framework for exchanging
                &quot;security assertions&quot; between entities.  In
                the course of making, or relying upon such assertions,
                SAML system entities may use SAML protocols, or other
                protocols, to communicate an
                assertion itself, or the subject of an assertion.
            
</p>
<p>
                Thus one can employ SAML to make and encode statements
                such as &quot;Alice has these profile attributes and
                her domain's certificate is available over there, and
                I'm making this statement, and here's who I am.&quot;
                Then one can cause such an assertion to be conveyed to
                some party who can then rely on it in some fashion for
                some purpose, for example input it into some local
                policy evaluation for access to some resource. This is
                done in a particular &quot;context of use&quot;. Such
                a context of use could be, for example, deciding
                whether to accept and act upon a SIP-based invitation
                to initiate a communication session.
            
</p>
<p>
                The specification of how SAML is employed in a
                particular context of use is known as a &quot;SAML
                profile&quot;. The specification of how SAML
                assertions and/or protocol messages are conveyed in,
                or over, another protocol is known as a &quot;SAML
                Binding&quot;. Typically, a SAML profile specifies the
                SAML bindings that may be used in its context. Both
                SAML profiles and SAML bindings reference other SAML
                specifications, especially the SAML Assertions and
                Protocols, aka &quot;SAML Core&quot;, specification <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
            
</p>
<p>
                There is an additional subtle aspect of SAML profiles that
                is worth highlighting -- the notion of a &quot;SAML assertion
                profile&quot;. A SAML assertion profile is the specification
                of the assertion contents in the context of a particular 
                SAML profile. It is possibly further qualified by a particular
                implementation and/or deployment context. Condensed 
                examples of SAML assertion profiles are:
            
</p>
<p>
                </p>
<ul class="text">
<li>
                        The SAML assertion must contain at least one
                        authentication statement and no other statements.
                        The relying party must be represented in the 
                        &lt;AudienceRestriction&gt; element. The 
                        SubjectConfirmation Method must be Foo. etc.
                    
</li>
<li>
                        The SAML assertion must contain at least one
                        attribute statement and may contain more than one. 
                        The values for the subject's 
                        profile attributes named "Foo" and "Bar" 
                        must be present. An authentication statement may 
                        be present. etc.
                    
</li>
</ul><p>
            
</p>
<p>
                The primary facets of SAML itself are: 
            
</p>
<p>
                </p>
<ul class="text">
<li>Assertions
</li>
<li>Abstract Request/Response protocol
</li>
</ul><p>
            
</p>
<p>
                We describe each in turn below:
            
</p>
<a name="assertions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
SAML Assertions</h3>

<p>
                    A SAML assertion is a package of information
                    including issuer and subject, conditions and
                    advice, and/or attribute statements, and/or
                    authentication statements and/or other statements.
                    Statements may or may not be present. The SAML
                    assertion &quot;container&quot; itself contains
                    the following information: 
                
</p>
<p>
                    </p>
<blockquote class="text"><dl>
<dt>Issuing information:</dt>
<dd>

                            <br />
 

                            Who issued the
                            assertion, when was it issued and the
                            assertion identifier.<br />
<br />

                        
</dd>
<dt>Subject information:</dt>
<dd>

                            <br />
 

                            The name of the
                            subject, the security domain and optional
                            subject information, like public
                            key.<br />
<br />

                        
</dd>
<dt>Conditions under which the 
                            assertion is valid:</dt>
<dd>

                            <br />
 

                            Special kind of
                            conditions like assertion validity period,
                            audience restriction and target
                            restriction.<br />
<br />


                        
</dd>
<dt>Additional advice:</dt>
<dd>

                            <br />
 

                            Explaining how
                            the assertion was made, for example.
</dd>
</dl></blockquote><p>
                
</p>
<p>
                    In terms of SAML assertions containing SAML
                    attribute statements or SAML authentication
                    statements, here are explanatory examples:
                    </p>
<blockquote class="text">
<p>
                            With a SAML assertion containing a SAML
                            attribute statement, an issuing authority
                            is asserting that the subject is
                            associated with certain attributes with
                            certain subject profile attribute
                            values. For example, user
                            jon@cs.example.com is associated with the
                            attribute &quot;Department&quot;, which
                            has the value &quot;Computer
                            Science&quot;.
                        
</p>
<p>
                            With a SAML assertion containing a SAML
                            authentication statement, an issuing
                            authority is asserting that the
                            subject was authenticated by certain means
                            at a certain time.
                        
</p>
<p>
                            With a SAML assertion containing both a
                            SAML attribute statement and a SAML 
                            authentication statement, an issuing authority
                            is asserting the union of the above. 
                        
</p>
</blockquote><p>
                
</p>
<a name="request-response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Abstract Request/Response Protocol</h3>

<p>
                    SAML defines an abstract request/response protocol
                    for obtaining assertions. 
                    See Section 3 &quot;SAML Protocols&quot; of 
                    <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>. 
                    A request asks for an
                    assertion. A response returns the requested
                    assertion or an error.  
                    This abstract protocol may then be
                    cast into particular contexts of use by binding it
                    to specific underlying protocols, e.g., HTTP or
                    SIP, and &quot;profiling&quot; it for the specific
                    use case at hand. The SAML 
                    HTTP-based web single sign-on profile
                    is
                    one such example
                    (see Section 4.1 Web Browser SSO Profile of 
                    <a class='info' href='#OASIS.saml-profiles-2.0-os'>[OASIS.saml&#8209;profiles&#8209;2.0&#8209;os]<span> (</span><span class='info'>Hughes, J., Cantor, S., Hodges, J., Hirsch, F., Mishra, P., Philpott, R., and E. Maler, &ldquo;Profiles for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>).
                    Trait-based SIP communication session
                    establishment, the topic of this specification,
                    is another.
                
</p>
<a name="goals-nongoals"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Specification Scope</h3>

<p>
                The scope of this specification is:
            
</p>
<p>
                </p>
<ul class="text">
<li>
                        Specify a SIP profile of SAML -- aka a &quot;SIP
                        SAML profile&quot; -- such that a subject's
                        profile attributes, and their domain's
                        certificate, can be conveyed to a relying
                        party using SAML. In doing so, satisfy the
                        requirements outlined in <a class='info' href='#RFC4484'>[RFC4484]<span> (</span><span class='info'>Peterson, J., Polk, J., Sicker, D., and H. Tschofenig, &ldquo;Trait-Based Authorization Requirements for the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>, and 
                        compose  with 
                        <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. 
                    
</li>
</ul><p>
            
</p>
<p>
                The following are outside the scope of this specification:
            
</p>
<p>
                </p>
<ul class="text">
<li>
                        Defining a means for configuring the runtime
                        behavior, or deployment characteristics, of
                        the Authentication Service. 

                        <br />
<br />
 

                        Discussion:

                        <br />
<br />
 

                        For example, a SIP
                        Authentication Service could be implemented
                        such that its SAML-based features are employed,
                        or not,
                        on a subject-by-subject basis, and/or on a
                        domain-by-domain basis. 
                         
                    
</li>
<li>
                        The definition of specific conveyed subject profile
                        attributes (aka traits). 

                        <br />
<br />
 

                        Discussion:

                        <br />
<br />
 

                        This specification defines a facility enabling 
                        &quot;trait-based authorization&quot; as discussed
                        in <a class='info' href='#RFC4484'>[RFC4484]<span> (</span><span class='info'>Peterson, J., Polk, J., Sicker, D., and H. Tschofenig, &ldquo;Trait-Based Authorization Requirements for the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. 

                        <br />
<br />
 

                        The attributes of interest in trait-based
                        authorization will be ones akin to, for
                        example: roles, organizational membership,
                        access rights, or
                        authentication event context. Definition of 
                        such attributes is
                        application- and/or deployment-context-dependent 
                        and are not defined in this
                        specification. However, The SAMLv2 specification 
                        defines several &quot;SAML Attribute Profiles&quot; 
                        for encoding attributes from various application 
                        domains, e.g., LDAP, UUID/GUID, DCE PAC, and XACML, 
                        in SAML assertions 
                        <a class='info' href='#OASIS.saml-profiles-2.0-os'>[OASIS.saml&#8209;profiles&#8209;2.0&#8209;os]<span> (</span><span class='info'>Hughes, J., Cantor, S., Hodges, J., Hirsch, F., Mishra, P., Philpott, R., and E. Maler, &ldquo;Profiles for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.

                        <br />
<br />
 
                        
                        In order for any trait-based system
                        to be practical, participating  
                        entities must agree on
                        attributes and traits that will be
                        conveyed and subsequently relied upon. 
                        Without such agreements,
                        a trait-based system cannot be usefully deployed. This
                        specification does not discuss the manner in which
                        participating entites might discover one
                        another or agree on the syntax and semantics
                        of attributes and traits. 

                        <br />
<br />
 

                        Note that SAMLv2 specifies a &quot;metadata&quot;
                        facility that may be useful in addressing this 
                        need. 
                    
</li>
</ul><p>
            
</p>
<a name="empl-saml-sip"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Employing SAML in SIP</h3>

<p>
                Employing SAML in SIP necessitates devising a new SAML
                profile(s) and binding(s) because the those already
                specified in the SAMLv2 specification set are specific
                to other use contexts, e.g., HTTP-based web
                browsing. Although SIP bears some similarity to HTTP,
                it is a seperately distinct protocol, thus 
                requiring specification of SIP-specific SAML
                profile(s) and binding(s). This is technically 
                straightforward as both SAML and SIP are 
                explicitly extensible.
            
</p>
<p>
                The &quot;Authenticated Identity Management in
                SIP&quot; specification <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> (aka &quot;SIP
                Identity&quot;) facilitates the composition of SAML
                and SIP in that it defines a "mediated authentication
                architecture" where verifying endpoints verify SIP
                identity assertions -- i.e., the &quot;Identity&quot;
                header value -- signed by an Authentication Service
                (AS). The semantic being that the AS is vouching that
                it did indeed authenticate the calling party.
            
</p>
<p>
                Such an Authentication Service, which likely has
                access to various pieces of information concerning the
                calling party, could also act as a SAML Authority, and
                make such information available to the callee via
                SAML.
            
</p>
<p>
                Since <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>
                stipulates that the AS must make its certificate
                available for retrieval and convey the availability
                and access mechanism via a URI, in the Identity-Info
                header, we have an opportunity to compose SIP Identity
                and SAML.
            
</p>
<p>
                Such composition can be accomplished by having the
                resource referred to by the URI in the Identity-Info
                be a SAML assertion conveying both the AS's
                certificate and user profile attributes. This is the
                approach defined in this specification. <a class='info' href='#fig-ovrall-msg-flow'>Figure&nbsp;1<span> (</span><span class='info'>SIP-SAML-based Network Asserted Identity</span><span>)</span></a> illustrates this
                approach in a high-level summary fashion. <a class='info' href='#fig-ssp-as-driven-invite-expl'>Figure&nbsp;2<span> (</span><span class='info'>AS-driven SIP SAML Attribute Fetch                         Profile: Example INVITE Transaction</span><span>)</span></a>, further
                below, illustrates additional details.
            
</p>
<p>
                <br /><hr class="insert" />
<a name="fig-ovrall-msg-flow"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  +--------+           +--------------+          +--------+
  |Alice@  |           |Authentication|          | Bob@   |
  |example |           |Service       |          |example2|
  |.com    |           |@example.com  |          |.com    |
  |        |           |              |          |        |
  +---+----+           +------+-------+          +---+----+
      |                       |                      |
      |      INVITE           |                      |
      |----------------------&gt;|                      |
      | From:alice@foo.com    |                      |
      |                       |                      |
      |  407 Proxy auth. req. |                      |
      |&lt;----------------------|                      |
      |     Challenge         |                      |
      |                       |                      |
      |       ACK             |                      |
      |----------------------&gt;|                      |
      |                       |                      |
      | INVITE w/authn creds  |                      |
      |----------------------&gt;|                      |
      |                       | INVITE               |
      |                       | w/Identity header    |
      |                       |---------------------&gt;|
      |                       | and Identity-Info    |
      |                       |                      |
      |                       | HTTP GET SAML assn   |
      |                       |&lt;==================== |
      |                       | and domain cert      |
      |                       |                      |
      |                       | HTTP 200 OK + assn   |
      |                       |=====================&gt;|
      |                       | and domain cert      |
      |            200 OK     |                      |
      |&lt;----------------------+----------------------|
      |                       |                      |

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: SIP-SAML-based Network Asserted Identity&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p>
                Since the AS already being trusted to create and add
                the Identity header containing the
                SIP Identity Assertion, and to supply a pointer to its
                domain certificate, having it point instead to a SAML 
                assertion conveying the domain certificate and possibly 
                some user profile attributes, does not significantly 
                alter the first-order security considerations examined in
                <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. This specification
                provides some additional security considerations analysis
                below in <a class='info' href='#sec-cons'>Section&nbsp;10<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>. 
            
</p>
<a name="sip-saml-profiles"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
SIP SAML Profiles</h3>

<p>
                This section defines two &quot;SIP SAML profiles&quot;:
                
                </p>
<ul class="text">
<li>
                        The &quot;AS-driven SIP SAML URI-based Attribute 
                        Assertion Fetch Profile&quot;
                    
</li>
<li>
                        The to-be-determined (TBD)
                        &quot;call-by-value&quot; profile 
                    
</li>
</ul><p>

            
</p>
<a name="ssp-as-driven-attr-"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
AS-driven SIP SAML URI-based Attribute 
                       Assertion Fetch Profile</h3>

<p>
            
                
</p>
<a name="ssp-asd-req-info"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
Required Information</h3>

<p>
                        The information given in this section is
                        similar to the info provided when registering
                        something, a MIME Media Type, say, with IANA.
                        In this case, it is for registering this
                        profile with the OASIS SSTC. See Section 2
                        &quot;Specification of Additional
                        Profiles&quot; in <a class='info' href='#OASIS.saml-profiles-2.0-os'>[OASIS.saml&#8209;profiles&#8209;2.0&#8209;os]<span> (</span><span class='info'>Hughes, J., Cantor, S., Hodges, J., Hirsch, F., Mishra, P., Philpott, R., and E. Maler, &ldquo;Profiles for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
                    
</p>
<p>
                        </p>
<blockquote class="text"><dl>
<dt>Identification:</dt>
<dd>
                                <br />
 

                     urn:ietf:params:sip:sip-saml-profile:as:uri:attr:1.0
 
                                
<blockquote class="text"><dl>
<dt>@@ NOTE:</dt>
<dd>
                                        This URN must be agreed upon,
                                        and then registered with IANA
                                        per <a class='info' href='#RFC3553'>[RFC3553]<span> (</span><span class='info'>Mealling, M., Masinter, L., Hardie, T., and G. Klyne, &ldquo;An IETF URN Sub-namespace for Registered Protocol Parameters,&rdquo; June&nbsp;2003.</span><span>)</span></a>.
                                    
</dd>
</dl></blockquote>
                            
</dd>
<dt>Contact Information:</dt>
<dd>
                                <br />
 

                                @@ someone's or something's contact
                                info goes here
                            
</dd>
<dt>SAML Confirmation Method Identifiers:</dt>
<dd>
                                <br />
 

                                The SAML V2.0
                                &quot;{bearer,hok,?}&quot;
                                confirmation method identifier is used
                                in this profile.
                            
</dd>
<dt>Description:</dt>
<dd>
                                <br />
 

                                Given below.
                            
</dd>
<dt>Updates:</dt>
<dd>
                                <br />
 

                                None.
                            
</dd>
</dl></blockquote><p>
                    
</p>
<a name="ssp-asd-overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.2"></a><h3>6.1.2.&nbsp;
Profile Overview</h3>

<p>
                        <a class='info' href='#fig-ssp-as-driven-invite-expl'>Figure&nbsp;2<span> (</span><span class='info'>AS-driven SIP SAML Attribute Fetch                         Profile: Example INVITE Transaction</span><span>)</span></a>
                        illustrates this profile's overall protocol
                        flow. The following steps correspond to the
                        labeled interactions in the figure. Within an
                        individual step, there may be one or more
                        actual message exchanges depending upon the
                        protocol binding employed for that particular
                        step and other implementation-dependent
                        behavior.
                    
</p>
<p>
                        Although this profile is overview is cast in
                        terms of a SIP INVITE transaction, the reader
                        should note that the mechanism specified
                        herein, and in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>, may be applied
                        to any SIP request message.
                    
</p>
<p>
                        <a class='info' href='#fig-ssp-as-driven-invite-expl'>Figure&nbsp;2<span> (</span><span class='info'>AS-driven SIP SAML Attribute Fetch                         Profile: Example INVITE Transaction</span><span>)</span></a> 
                        begins on the next page.
                    
</p>
<p>
                          

                    <br /><hr class="insert" />
<a name="fig-ssp-as-driven-invite-expl"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  +------------------+    +------------------+   +-----------------+
  |     Caller       |    |Authn Service (AS)|   |     Callee      |
  |Alice@example.com |    |  @example.com    |   | Bob@example2.com|
  +--------+---------+    +--------+---------+   +--------+--------+
-    -     |                       |                      | (steps)
^    ^     |      INVITE           |                      |
|    |     |----------------------&gt;|                      |   (1a)
|          | From:alice@foo.com    |                      |
|    C     | To:sip:bob@example.com|                      |
|    S     |                       |                      |
|    e     |  407 Proxy auth. req. |                      |
|    q     |&lt;----------------------|                      |   (1b)
|    =     |  Challenge            |                      |
|    N     |                       |                      |
|          |      ACK              |                      |
|    |     |----------------------&gt;|                      |   (1c)
|    V     |                       |                      |
|    -     |                       |                      |
     ^     | INVITE + authorization|                      |
D    |     | header w/ creds       |                      |
     |     |----------------------&gt;|                      |   (2)
I    |     | From:alice@foo.com    |                      |
     |     | To:sip:bob@example.com|                      |
A          | Proxy-Authorization:..|                      |
     C     |                       | INVITE               |
L    S     |                       |---------------------&gt;|   (3)
     e     |                       | From:alice@foo.com   |
O    q     |                       | To:sip:bob@example2.com
           |                       | Identity: .....      |
G    =     |                       | Identity-Info:       |
           |                       |   https://example.com|
|    N     |                       |     /assns/?ID=abcde |
|          |                       |                      |
|    +     |                       |URI resolution (eg. HTTP)
|          |                       |&lt;=====================|   (4)
|    1     |                       | GET /assns/?ID=abcde |
|          |                       |                      |
|    |     |                       | HTTP/1.1 200 OK      |
|    |     |                       |=====================&gt;|   (5)
|    |     |                       |  &lt;saml:Assertion&gt;    |
|    |     |                       |   &lt;saml:Subject&gt;     |
|    |     |                       |    &lt;saml:NameID&gt;     |
|    |     |                       |      Alice@example.com
|    |     |                       |     &lt;saml:SubjConf&gt;
|    |     |                       |      &lt;saml:SubjConfData&gt;
|    |     |                       |       &lt;ds:KeyInfo&gt;...
|    |     |                       |   &lt;saml:AttrStatement&gt;
|    |     |                       |     foo=bar          |
|    |     |            200 OK     |                      |
|    V     |&lt;----------------------+----------------------|   (6)
.    -     |                       |                      |
V

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: AS-driven SIP SAML Attribute Fetch
                        Profile: Example INVITE Transaction&nbsp;</b></font><br /></td></tr></table><hr class="insert" />



                        </p>
<blockquote class="text"><dl>
<dt>Step 1.</dt>
<dd> 
                                Initial SIP Transaction between 
                                Caller and AS

                                <br />
 

                                This optional initial step is
                                comprised of substeps 1a, 1b, and 1c
                                in <a class='info' href='#fig-ssp-as-driven-invite-expl'>Figure&nbsp;2<span> (</span><span class='info'>AS-driven SIP SAML Attribute Fetch                         Profile: Example INVITE Transaction</span><span>)</span></a>.
                                In this step, the caller, Alice, sends
                                a SIP request message, illustrated as
                                an INVITE, indicating Bob as the
                                callee (1a), is subsequently
                                challenged by the AS (1b), and sends
                                an ACK in response to the challenge
                                (1c).  The latter message signals the
                                completion of this SIP transaction
                                (which is an optional substep of this
                                profile).
                            
</dd>
<dt>Step 2.</dt>
<dd> Caller sends SIP Request  
                                Message with Authorization Credentials
                                to the AS

                                <br />
 

                                Alice then sends an INVITE message in
                                response to the challenge, or uses
                                cached credentials for the domain if
                                step 1  was skipped, as specified in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> and
                                <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>.  Depending
                                on the chosen SIP security mechanism
                                for client authentication either digest authentication,
                                client side authentication of Transport Layer Security, 
                                or a combination of both is used to
                                provide the AS with a strong assurance
                                about the identity of Alice.
                            
</dd>
<dt>Step 3.</dt>
<dd> AS Authorizes the SIP Request and
                                Forwards it to Callee

                                <br />
 

                                First, the AS authorizes the 
                                received INVITE message as specified in 
                                <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>
                                and <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>.

                                If the authorization is successful,
                                the AS will form the &quot;identity
                                signature&quot; for the message and add
                                Identity and Identity-Info header fields to
                                the message. The AS also at this time
                                constructs and caches a SAML assertion
                                asserting Alice's profile attributes
                                required by Bob's domain
                                (example2.com), and also containing a
                                the domain's (example.com) public key
                                certificate, or a reference to it.
                                This certificate MUST contain the
                                public key corresponding to the
                                private key used to construct the
                                signature whose value was placed in
                                the Identity header.  The AS
                                constructs a HTTP-based SAML URI
                                Reference incorporating the
                                assertion's Assertion ID (see section
                                2.3.3 of <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>).
                                The AS uses this URI as the value for
                                the Identity-Info header it adds to
                                the INVITE message.

                                <br />
<br />
 

                                The AS determines which profile
                                attributes (if any) to assert in the
                                &lt;AttributeStatement&gt; via local
                                configuration and/or obtaining
                                example2.com's metadata <a class='info' href='#OASIS.saml-metadata-2.0-os'>[OASIS.saml&#8209;metadata&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Moreh, J., Philpott, R., and E. Maler, &ldquo;Metadata for the Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
                                The AS then sends the
                                updated INVITE message to Bob.
                            
</dd>
<dt>Step 4.</dt>
<dd> Callee Dereferences HTTP-based SAML 
                                URI Reference

                                <br />
 

                                Bob's UAC or SIP Proxy
                                receives the message and begins
                                verifying it per the &quot;Verifier
                                Behavior&quot; specified in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.  In
                                order to accomplish this task, it
                                needs to obtain Alice's domain
                                certificate. It obtains the 
                                HTTP-based SAML URI Reference
                                from the message's Identity-Info header
                                and dereferences it per 
                                <a class='info' href='#ssb-saml-http-uri-sip-binding'>Section&nbsp;7.1<span> (</span><span class='info'>SAML HTTP-URI-based SIP Binding</span><span>)</span></a>. 
                                Note that this is not a SIP message, but 
                                an HTTP message <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
                            
</dd>
<dt>Step 5.</dt>
<dd> AS Returns SAML Assertion

                                <br />
 

                                Upon receipt of the above HTTP request, 
                                which contains an embedded reference to 
                                Alice's SAML Assertion, 
                                Alice's AS returns her assertion in an 
                                HTTP response message. 

                                <br />
<br />
 

                                Upon receipt of Alice's SAML Assertion, 
                                the AS continues its verification of the
                                INVITE message. If successful, it returns a 
                                200 OK message directly to Alice. Otherwise it
                                returns an appropriate SIP error response. 
                            
</dd>
<dt>Step 6.</dt>
<dd> Callee Returns SIP 200 OK to Caller
                            
                                <br />
 

                                If Bob determines, based upon Alice's identity
                                as asserted by the AS, and as further 
                                substantiated by the information in the
                                SAML assertion, to accept the INVITE, he 
                                returns a SIP 200 OK message directly to 
                                Alice. 
                            
</dd>
</dl></blockquote><p>
                    
</p>
<a name="ssp-asd-prof-descp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3"></a><h3>6.1.3.&nbsp;
Profile Description</h3>

<p>
                        The following sections provide detailed
                        definitions of the individual profile
                        steps. The relevant illustration is <a class='info' href='#fig-ssp-as-driven-roles-only'>Figure&nbsp;3<span> (</span><span class='info'>AS-driven SIP SAML Attribute Fetch                         Profile: Message Flow</span><span>)</span></a>,
                        below. Note that this profile is agnostic to
                        the specific SIP request, and also that the
                        Sender and Authentication Service (AS) may be
                        seperate or co-located in actuality.

                      

                    <br /><hr class="insert" />
<a name="fig-ssp-as-driven-roles-only"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  +------------------+    +------------------+   +------------------+
  |     Sender       |    |Authn Service (AS)|   |    Verifier      |
  |      (UAC)       |    |    (Sender's)    |   |(UAS or Proxy Svr)|
  +--------+---------+    +--------+---------+   +--------+---------+
           |                       |                      | (steps)
           |    SIP Request        |                      |
           |----------------------&gt;|                      |   (1a)
           |                       |                      |
           |  407 Proxy auth. req. |                      |
           |&lt;----------------------|                      |   (1b)
           |  Challenge            |                      |
           |                       |                      |
           |      ACK              |                      |
           |----------------------&gt;|                      |   (1c)
           |                       |                      |
           |                       |                      |
           |SIP Req + authorization|                      |
           | header w/ creds       |                      |
           |----------------------&gt;|                      |   (2)
           |                       |                      |
           |                       |                      |
           |                       | SIP Req + Ident &amp;    |
           |                       | authz headers        |
           |                       |---------------------&gt;|   (3)
           |                       |                      |
           |                       | URI resolution       |
           |                       |&lt;=====================|   (4)
           |                       | (via HTTP)           |
           |                       |                      |
           |                       | HTTP/1.1 200 OK      |
           |                       |=====================&gt;|   (5)
           |                       |                      |
           |                       |                      |
           |                       |                  ?   |   (6)
           |                       |                      |

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: AS-driven SIP SAML Attribute Fetch
                        Profile: Message Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

                    
</p>
<a name="ssp-asd-pd-init-trans"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3.1"></a><h3>6.1.3.1.&nbsp;
Initial SIP Transaction between 
                        Sender and AS</h3>

<p>
                            This OPTIONAL step maps to Steps 1 and 2
                            of Section 5 &quot;Authentication Service
                            Behavior&quot; of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. If the
                            SIP request sent by the caller in substep
                            1a is deemed insufficiently authenticated
                            by the AS per the rules stipulated by
                            <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>
                            Steps 1 and 2, then the AS MUST
                            authenticate the sender of the
                            message. The particulars of how this is
                            accomplished depend upon implementation
                            and/or deployment instantiation as
                            discussed in <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. Substeps
                            1b and 1c as shown in <a class='info' href='#fig-ssp-as-driven-roles-only'>Figure&nbsp;3<span> (</span><span class='info'>AS-driven SIP SAML Attribute Fetch                         Profile: Message Flow</span><span>)</span></a> are
                            non-normative and illustrative only.
                        
</p>
<a name="ssp-asd-pd-req-w-cred"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3.2"></a><h3>6.1.3.2.&nbsp;
Sender sends SIP Request Message with 
                        Authorization Credentials to the AS</h3>

<p>
                            This step maps to Steps 1 and 2
                            of Section 5 &quot;Authentication Service
                            Behavior&quot; of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. This
                            request is presumed to be made in a context
                            such that the AS will not challenge it -- i.e.,
                            the AS will consider the sender of the 
                            message to be authenticated. If this is not
                            true, then this procedure reverts back to 
                            Step 1, above. 

                            <br />
<br />
 

                            Otherwise, the AS carries out all other 
                            processing 
                            of the message as stipulated in 
                            <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>
                            Steps 1 and 2, and if successful, this 
                            procedure procedes to the next step below. 
                        
</p>
<a name="ssp-asd-pd-as-authz-fwd"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3.3"></a><h3>6.1.3.3.&nbsp;
AS Authorizes the SIP Request and
                                Forwards it to Verifier</h3>

<p>
                            This first portion of this
                            step maps to Steps 3 and 4
                            of Section 5 &quot;Authentication Service
                            Behavior&quot; of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>, which
                            the AS MUST perform, although with the following
                            additional substeps:

                            </p>
<blockquote class="text">
<p>
                                    The AS MUST construct a SAML
                                    assertion according to the &quot;<a class='info' href='#ssp-asd-assn-prof-descp'>Assertion Profile Description<span> (</span><span class='info'>Assertion Profile Description</span><span>)</span></a>&quot;
                                    specified in <a class='info' href='#ssp-asd-assn-prof-descp'>Section&nbsp;6.1.4<span> (</span><span class='info'>Assertion Profile Description</span><span>)</span></a>
                                    of this specification. 
                                
</p>
<p>
                                    The AS SHOULD construct an HTTPS,
                                    and MAY construct an HTTP, URI per
                                    Section &quot;3.7.5.1 URI
                                    Syntax&quot; of <a class='info' href='#OASIS.saml-bindings-2.0-os'>[OASIS.saml&#8209;bindings&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Hirsch, F., Kemp, J., Philpott, R., and E. Maler, &ldquo;Bindings for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
                                
</p>
<p>
                                    The AS MUST use the URI
                                    constructed in the immediately
                                    preceding substep as the value of
                                    the Identity-Info header that is
                                    added to the SIP request message
                                    per Step 4 of Section 5 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
                                
</p>
</blockquote><p>
                            
                            Upon successful completion of all of the above, the
                            AS forwards the request message.
                        
</p>
<p>
                            At this point in this step, after perhaps
                            traversing some number of intermediaries,
                            the SIP request message arrives at a SIP
                            network entity performing the
                            &quot;verifier&quot; role. This role and
                            its behavior are specified in Section 6
                            &quot;Verifier Behavior&quot; of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>. 
                            The verifier MUST perform the steps enumerated in
                            the aforementioned section, with the following 
                            modifications:

                            </p>
<blockquote class="text">
<p>
                                    Step 1 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>
                                    Section 6 maps to and is updated
                                    by, the following two steps in
                                    this procedure.
                                
</p>
<p>
                                    Steps 2, 3, and 4 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>
                                    Section 6 may be mapped across
                                    this latter portion of this step,
                                    and/or the following two steps, as
                                    appropriate.
                                
</p>
</blockquote><p>
                        
</p>
<a name="ssp-asd-pd-callee-deref-saml-ref"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3.4"></a><h3>6.1.3.4.&nbsp;
Verifier Dereferences HTTP-based SAML 
                                URI Reference</h3>

<p>
                            The verifier SHOULD ascertain whether it
                            has a current cached copy of the SIP
                            message sender's SAML assertion and domain
                            certificate. If not, or if the verifier
                            chooses to (e.g., due to local policy), it
                            MUST dereference the the HTTP-based SAML
                            URI Reference found in the SIP message's
                            Identity-Info header. To do so, the
                            verifier MUST employ the &quot;<a class='info' href='#ssb-saml-http-uri-sip-binding'>SAML HTTP-URI-based SIP Binding<span> (</span><span class='info'>SAML HTTP-URI-based SIP Binding</span><span>)</span></a>&quot;
                            specified in <a class='info' href='#ssb-saml-http-uri-sip-binding'>Section&nbsp;7.1<span> (</span><span class='info'>SAML HTTP-URI-based SIP Binding</span><span>)</span></a>.
                        
</p>
<a name="ssp-asd-pd-as-ret-assn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3.5"></a><h3>6.1.3.5.&nbsp;
AS Returns SAML Assertion</h3>

<p>
                            This step also employs <a class='info' href='#ssb-saml-http-uri-sip-binding'>Section&nbsp;7.1<span> (</span><span class='info'>SAML HTTP-URI-based SIP Binding</span><span>)</span></a>
                            &quot;<a class='info' href='#ssb-saml-http-uri-sip-binding'>SAML HTTP-URI-based SIP Binding<span> (</span><span class='info'>SAML HTTP-URI-based SIP Binding</span><span>)</span></a>&quot;.
                        
</p>
<p>
                            If the prior step returns an HTTP error
                            (e.g., 4xx series), then this procedure
                            terminates and the verifier returns 
                            (upstream) a SIP 436
                            'Bad Identity-Info' Response code.
                        
</p>
<p>
                            Otherwise, the HTTP response message will
                            contain a SAML assertion and be denoted as
                            such via the MIME media type of
                            &quot;application/samlassertion+xml&quot;
                            <a class='info' href='#IANA.application.samlassertion-xml'>[IANA.application.samlassertion&#8209;xml]<span> (</span><span class='info'>OASIS Security Services Technical Committee (SSTC), &ldquo;application/samlassertion+xml MIME Media Type Registration,&rdquo; December&nbsp;2004.</span><span>)</span></a>.
                            The verifier
                            MUST perform the verification steps
                            specified in <a class='info' href='#ssp-asd-assn-verif'>Section&nbsp;6.1.5<span> (</span><span class='info'>Assertion Verification</span><span>)</span></a> &quot;<a class='info' href='#ssp-asd-assn-verif'>Assertion Verification<span> (</span><span class='info'>Assertion Verification</span><span>)</span></a>&quot;,
                            below.  If successful, then this procedure
                            continues with the next step.
                        
</p>
<a name="ssp-asd-pd-callee-send-200ok"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.3.6"></a><h3>6.1.3.6.&nbsp;
Verifier performs Next Step</h3>

<p>
                            The SIP request was successfully processed. 
                            The verifier now performs its next step, which 
                            depends at least in part on the type of 
                            SIP request it received. 
                        
</p>
<a name="ssp-asd-assn-prof-descp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.4"></a><h3>6.1.4.&nbsp;
Assertion Profile Description</h3>

<p>
                        This section defines the particulars of how
                        the sender, i.e., the SAML Authority, MUST
                        construct certain portions of the SAML
                        assertions it issues.  The schema for SAML
                        assertions themselves is defined in Section 2.3
                        of <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
                    
</p>
<p>
                        An example SAML assertion, formulated according to 
                        this profile is given in <a class='info' href='#example'>Section&nbsp;9<span> (</span><span class='info'>Example SAML Assertions</span><span>)</span></a>.
                    
</p>
<p>
                        Overall SAML assertion profile requirements:

                        </p>
<blockquote class="text">
<p>
                                The SAML assertion MUST be signed by the 
                                same key as used to sign the contents of the
                                Identity header field. Signing of SAML
                                assertions is defined in Section 5.4 of
                                <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
                            
</p>
</blockquote><p>
                    
</p>
<p>
                        In the following subsections, the SAML
                        assertion profile is specified 
                        element-by-element, in a top-down, depth-first
                        manner, beginning with the outermost element,
                        &quot;&lt;Assertion&gt;&quot;.  Where
                        applicable, the requirements for an element's
                        XML attributes are also stated, as a part of
                        the element's description.  Requirements for
                        any given element or XML attribute are only
                        stated when, in the context of use of this
                        profile, they are not already sufficiently
                        defined by <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>. 
                    
</p>
<a name="ssp-asd-apd-assn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.4.1"></a><h3>6.1.4.1.&nbsp;
Element: &lt;Assertion&gt;</h3>

<p>
                            </p>
<blockquote class="text"><dl>
<dt>Attribute: ID</dt>
<dd>
                                    <br />


                                    The value for the ID XML attribute
                                    SHOULD be allocated randomly such
                                    that the value meets the
                                    randomness requirments specified
                                    in Section 1.3.4 of <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
                                
</dd>
<dt>Attribute: IssueInstant</dt>
<dd>
                                    <br />
 

                                    The value for the IssueInstant XML
                                    attribute SHOULD be set at the
                                    time the SAML assertion is created
                                    (and cached for subsequent
                                    retrieval). This time instant
                                    value MAY be temporally the same
                                    as that encoded in the SIP
                                    message's Date header, and MUST be
                                    at least temporally later, although it
                                    is RECOMMENDED that it not be 10 minutes
                                    or more later. 
                                
</dd>
</dl></blockquote><p>
                        
</p>
<a name="ssp-asd-apd-issuer"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.4.1.1"></a><h3>6.1.4.1.1.&nbsp;
Element: &lt;Issuer&gt;</h3>

<p>
                                The value for the Issuer XML element
                                MUST be a value that matches either
                                the Issuer or the Issuer Alternative
                                Name fields <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>
                                in the certificate conveyed by the
                                SAML assertion in the
                                ds:X509Certificate element located on
                                this path within the SAML assertion:

                                </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
             &lt;Assertion
               &lt;ds:Signature
                 &lt;ds:KeyInfo
                   &lt;ds:X509Data
                     &lt;ds:X509Certificate
</pre></div><p>

                            
</p>
<a name="ssp-asd-apd-subject"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.4.1.2"></a><h3>6.1.4.1.2.&nbsp;
Element: &lt;Subject&gt;</h3>

<p>
                                The &lt;Subject&gt; element SHOULD contain 
                                both a &lt;NameID&gt; element and a 
                                &lt;SubjectConfirmation&gt; element. 
                            
</p>
<p>
                                The value of the &lt;NameID&gt;
                                element MUST be the same as the
                                Address of Record (AoR) value used in
                                computing the
                                &quot;signed-identity-digest&quot;
                                which forms the value of the Identity
                                header. See Section 9 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
                            
</p>
<p>
                                The &lt;SubjectConfirmation&gt; element
                                attribute Method SHOULD be set to the value:
                                </p>
<blockquote class="text">
<p>
                              urn:oasis:names:tc:SAML:2.0:cm:sender-vouches
                                    
</p>
</blockquote><p>
                                Although it MAY be set to some other 
                                implementation- and/or deployment-specific 
                                value. The &lt;SubjectConfirmation&gt; 
                                element itself SHOULD be empty. 
                            
</p>
<a name="ssp-asd-apd-conditions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.4.1.3"></a><h3>6.1.4.1.3.&nbsp;
Element: &lt;Conditions&gt;</h3>

<p>
                                The &lt;Conditions&gt; element SHOULD
                                contain an &lt;AudienceRestriction&gt;
                                element, which itself SHOULD contain
                                an &lt;Audience&gt; element. The value
                                of the &lt;Audience&gt; element SHOULD
                                be the same as the addr-spec of the
                                SIP request's To header field.
                            
</p>
<p>
                                The following XML attributes of the 
                                &lt;Conditions&gt; element MUST be set 
                                as follows:

                                </p>
<blockquote class="text"><dl>
<dt>Attribute: NotBefore</dt>
<dd>
                                        <br />
 
                                        The value of the NotBefore XML
                                        attribute MUST be set to a
                                        time instant the same as the
                                        value for the IssueInstant XML
                                        attribute discussed above, or
                                        to a later time.
                                    
</dd>
<dt>Attribute: NotOnOrAfter</dt>
<dd>
                                        <br />
 
                                        The value of the NotOnOrAfter XML 
                                        attribute MUST be set to a time
                                        instant later than the value for
                                        NotBefore.
                                    
</dd>
</dl></blockquote><p>
                            
</p>
<a name="ssp-asd-apd-attr"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.4.1.4"></a><h3>6.1.4.1.4.&nbsp;
Element: &lt;AttributeStatement&gt;</h3>

<p>
                                The SAML assertion MAY contain an
                                &lt;AttributeStatement&gt; element. If
                                so, the &lt;AttributeStatement&gt;
                                element will contain attribute-value
                                pairs, e.g., of a user profile nature, 
                                encoded according to either one
                                of the &quot;SAML Attribute
                                Profiles&quot; as specified in <a class='info' href='#OASIS.saml-profiles-2.0-os'>[OASIS.saml&#8209;profiles&#8209;2.0&#8209;os]<span> (</span><span class='info'>Hughes, J., Cantor, S., Hodges, J., Hirsch, F., Mishra, P., Philpott, R., and E. Maler, &ldquo;Profiles for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>,
                                or encoded in some implementation-
                                and/or deployment-specific attribute
                                profile.
                            
</p>
<p>
                                The attribute-value pairs SHOULD in fact
                                pertain to the entity identified in the 
                                SIP From header field, since a SAML assertion
                                formulated per this overall section is 
                                stating that they do. 
                            
</p>
<a name="ssp-asd-assn-verif"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.5"></a><h3>6.1.5.&nbsp;
Assertion Verification</h3>

<p>
                        This section specifies the steps that a
                        verifier participating in this profile MUST
                        perform in addition to the &quot;Verifier
                        Behavior&quot; specified in Section 6 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
                    
</p>
<p>
                        The steps are:

                        </p>
<ol class="text">
<li>
                                Before Step 1 in Section 6 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>,
                                the verifier MUST extract the AS's 
                                domain certificate from the 
                                &lt;ds:X509Certificate&gt;
                                XML element at the end of the 
                                element path given in 
                                <a class='info' href='#ssp-asd-apd-issuer'>Section&nbsp;6.1.4.1.1<span> (</span><span class='info'>Element: &lt;Issuer&gt;</span><span>)</span></a>.
                            
</li>
<li>
                                Perform Step 1 in Section 6 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
                            
</li>
<li>
                                After Step 1 in Section 6 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>,
                                but before Step 2 of that section, the
                                verifier MUST verify the SAML
                                assertion's signature via the
                                procedures specified in Section 5.4 of
                                <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a> as
                                well as <a class='info' href='#W3C.xmldsig-core'>[W3C.xmldsig&#8209;core]<span> (</span><span class='info'>Eastlake, D., Reagle , J., and D. Solo, &ldquo;XML-Signature Syntax and Processing,&rdquo; October&nbsp;2000.</span><span>)</span></a>. 
                                
                                <br />
<br />
 
                                
                                @@ TODO: do we need to define a new SIP
                                error response code for when a SAML assn
                                signature is bad? 
                                e.g., '4xx Invalid SAML asssertion'.
                            
</li>
<li>
                                Perform Step 2 in Section 6 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
                            
</li>
<li>
                                Verify that the signer of the SIP message's
                                Identity header field is the same as the 
                                signer of the SAML assertion. 
                            
</li>
<li>
                                Perform Steps 3 and 4 in Section 6 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
                            
</li>
<li>
                                Verify that the SAML assertion's
                                &lt;Issuer&gt; element value matches
                                the Issuer or the Issuer Alternative
                                Name fields <a class='info' href='#RFC3280'>[RFC3280]<span> (</span><span class='info'>Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; April&nbsp;2002.</span><span>)</span></a>
                                in the AS's domain certificate.
                            
</li>
<li>
                                Verify that the SAML assertion's
                                &lt;NameID&gt; element value is the
                                same as the Address of Record (AoR)
                                value in the
                                &quot;signed-identity-digest&quot;. 
                                See Section 9 of <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a>.
                            
</li>
<li>
                                Verify that the SAML assertion's
                                &lt;SubjectConfirmation&gt; element
                                value is set to whichever value
                                was configured at implementation- or 
                                deployment-time. The default value is:
                                
<blockquote class="text"><dl>
<dt></dt>
<dd>
                              urn:oasis:names:tc:SAML:2.0:cm:sender-vouches
                                    
</dd>
</dl></blockquote>
                            
</li>
<li>
                                Verify that the SAML assertion
                                contains an &lt;Audience&gt; element, and 
                                that its value matches the value of the 
                                addr-spec of the
                                SIP To header field.
                            
</li>
<li>
                                Verify that the validity period
                                denoted by the NotBefore and
                                NotOnOrAfter attributes of the
                                &lt;Conditions&gt; element meets the
                                requirements given in <a class='info' href='#ssp-asd-apd-conditions'>Section&nbsp;6.1.4.1.3<span> (</span><span class='info'>Element: &lt;Conditions&gt;</span><span>)</span></a>.
                            
</li>
</ol><p>
                    
</p>
<a name="ssp-tbd"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
The TBD &quot;call-by-value&quot;  Profile</h3>

<p>
                    To-Be-Determined (TBD)
                
</p>
<a name="saml-sip-bindings"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
SAML SIP Binding</h3>

<p>
                This section specifies one SAML SIP Binding at this time. 
                Additional bindings may be specified in future revisions of
                this specification.
            
</p>
<a name="ssb-saml-http-uri-sip-binding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
SAML HTTP-URI-based SIP Binding</h3>

<p>
                    This section specifies the &quot;SAML
                    HTTP-URI-based SIP Binding&quot;, (SHUSB).
                
</p>
<p>
                    The SHUSB is a profile of the &quot;SAML URI Binding&quot; 
                    specified in Section 3.7 of 
                    <a class='info' href='#OASIS.saml-bindings-2.0-os'>[OASIS.saml&#8209;bindings&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Hirsch, F., Kemp, J., Philpott, R., and E. Maler, &ldquo;Bindings for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
                    The SAML URI Binding specifies a means by which 
                    SAML assertions can be referenced by URIs and thus be
                    obtained through resolution of such URIs. 
                
</p>
<p>
                    This profile of the SAML URI Binding is congruent with 
                    the SAML URI Binding -- including support for
                    HTTP-based URIs being mandatory to
                    implement --
                    except for the following further 
                    restrictions which are specified in the
                    interest of interoperability (section
                    numbers refer to <a class='info' href='#OASIS.saml-bindings-2.0-os'>[OASIS.saml&#8209;bindings&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Hirsch, F., Kemp, J., Philpott, R., and E. Maler, &ldquo;Bindings for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a>):
                
</p>
<p>
                    </p>
<blockquote class="text"><dl>
<dt>Section 3.7.5.3 Security Considerations:</dt>
<dd> 
                            <br />
 
                            Support for TLS 1.0 or SSL 3.0 is mandatory to implement. 
                        
</dd>
<dt>Section 3.7.5.4 Error Reporting:</dt>
<dd> 
                            <br />
 
                            All SHOULDs in this section are to be 
                            interpreted as MUSTs.
                        
</dd>
</dl></blockquote><p>
                
</p>
<a name="option-tag"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
The 'saml-shusb' Option Tag</h3>

<p>
        This document creates and IANA registers one new option tag:
        "saml-shusb".  This option tag is to be used, as defined in RFC
        3261, in the Require, Supported and Unsupported headers.  
        It is used to indicate support for this SIP extension, this
        option tag is included in a Supported header of the SIP request.
        
</p>
<a name="example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Example SAML Assertions</h3>

<p>
                This section presents two examples of a SAML assertion, 
                one unsigned (for clarity), the other signed (for 
                accuracy).
            
</p>
<p>
                In the first example, <a class='info' href='#fig-unsign-saml-assn'>Figure&nbsp;4<span> (</span><span class='info'>Unsigned SAML Assertion                      Illustrating Conveyance of                      Subject Attribute</span><span>)</span></a>, 
                the assertion is attesting with respect to the subject
                (lines 7-15)
                "Alice@example.com" (line 11). The validity conditions 
                are expressed in lines 16-23, via both a validity period
                expressed as temporal endpoints, and an "audience restriction"
                stating that this assertion's semantics are valid for 
                only the relying party named "example2.com". Also, the 
                assertion's issuer is noted in lines 4-5. 
            
</p>
<p>
                The above items correspond to some aspects of this 
                specification's SAML assertion profile, as noted below
                in Security Considerations dicussions, see:
                <a class='info' href='#sec-cons-stolen-assn'>Section&nbsp;10.1<span> (</span><span class='info'>Man-in-the-Middle Attacks and Stolen Assertions</span><span>)</span></a> and
                <a class='info' href='#sec-cons-forged-assn'>Section&nbsp;10.2<span> (</span><span class='info'>Forged Assertion</span><span>)</span></a>.
            
</p>
<p>
                In lines 24-36, Alice's 
                telephone number is conveyed, in a "typed" fashion, using
                LDAP/X.500 schema as the typing means. 
               
             
            
</p>
<p>
                <br /><hr class="insert" />
<a name="fig-unsign-saml-assn"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 1 &lt;Assertion ID="_a75adf55-01d7-40cc-929f-dbd8372ebdfc"
 2    IssueInstant="2003-04-17T00:46:02Z" Version="2.0"
 3    xmlns="urn:oasis:names:tc:SAML:2.0:assertion"&gt;
 4    &lt;Issuer&gt;
 5       example.com
 6    &lt;/Issuer&gt;
 7    &lt;Subject&gt;
 8       &lt;NameID
 9         Format=
10         "urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"&gt;
11         Alice@example.com
12       &lt;/NameID&gt;
13       &lt;SubjectConfirmation
14         Method="urn:oasis:names:tc:SAML:2.0:cm:sender-vouches"/&gt;
15    &lt;/Subject&gt;
16    &lt;Conditions NotBefore="2003-04-17T00:46:02Z"
17                NotOnOrAfter="2003-04-17T00:51:02Z"&gt;
18       &lt;AudienceRestriction&gt;
19          &lt;Audience&gt;
20             example2.com
21          &lt;/Audience&gt;
22       &lt;/AudienceRestriction&gt;
23    &lt;/Conditions&gt;
24    &lt;AttributeStatement&gt;
25       &lt;saml:Attribute
26    xmlns:x500=
27      "urn:oasis:names:tc:SAML:2.0:profiles:attribute:X500"
28    NameFormat=
29      "urn:oasis:names:tc:SAML:2.0:attrname-format:uri"
30    Name="urn:oid:2.5.4.20"
31    FriendlyName="telephoneNumber"&gt;
32          &lt;saml:AttributeValue xsi:type="xs:string"&gt;
33                +1-888-555-1212
34          &lt;/saml:AttributeValue&gt;
35       &lt;/saml:Attribute&gt;
36    &lt;/AttributeStatement&gt;
37 &lt;/Assertion&gt;

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Unsigned SAML Assertion 
                    Illustrating Conveyance of 
                    Subject Attribute&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p>
                In the second example, <a class='info' href='#fig-sign-saml-assn'>Figure&nbsp;5<span> (</span><span class='info'>Signed SAML Assertion                      Illustrating Conveyance of                      Subject Attribute</span><span>)</span></a>, 
                the information described above is the same, the addition
                is that this version of the assertion is signed. All the 
                signature information is conveyed in the 
                &lt;ds:signature&gt; element, lines 7-47. Thus this 
                assertion's origin and its integrity are assured. 
                Since this assertion is the same as the one in the 
                first example above, other than having a signature 
                added, the second 
                example below addresses the same Security Considerations
                aspects, plus those requiring a Signature. 
            
</p>
<p>
             

                <br /><hr class="insert" />
<a name="fig-sign-saml-assn"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 1 &lt;Assertion ID="_a75adf55-01d7-40cc-929f-dbd8372ebdfc"
 2    IssueInstant="2003-04-17T00:46:02Z" Version="2.0"
 3    xmlns="urn:oasis:names:tc:SAML:2.0:assertion"&gt;
 4    &lt;Issuer&gt;
 5       example.com
 6    &lt;/Issuer&gt;
 7    &lt;ds:Signature xmlns:ds="http://www.w3.org/2000/09/xmldsig#"&gt;
 8       &lt;ds:SignedInfo&gt;
 9          &lt;ds:CanonicalizationMethod
10             Algorithm="http://www.w3.org/2001/10/xml-exc-c14n#"/&gt;
11          &lt;ds:SignatureMethod
12           Algorithm="http://www.w3.org/2000/09/xmldsig#rsa-sha1"/&gt;
13          &lt;ds:Reference
14           URI="#_a75adf55-01d7-40cc-929f-dbd8372ebdfc"&gt;
15             &lt;ds:Transforms&gt;
16                &lt;ds:Transform
17                    Algorithm=
18          "http://www.w3.org/2000/09/xmldsig#enveloped-signature"/&gt;
19                &lt;ds:Transform
20                   Algorithm=
21                      "http://www.w3.org/2001/10/xml-exc-c14n#"&gt;
22                   &lt;InclusiveNamespaces
23                      PrefixList="#default saml ds xs xsi"
24                      xmlns=
25                       "http://www.w3.org/2001/10/xml-exc-c14n#"/&gt;
26                &lt;/ds:Transform&gt;
27             &lt;/ds:Transforms&gt;
28             &lt;ds:DigestMethod
29              Algorithm="http://www.w3.org/2000/09/xmldsig#sha1"/&gt;
30             &lt;ds:DigestValue&gt;
31                Kclet6XcaOgOWXM4gty6/UNdviI=
32             &lt;/ds:DigestValue&gt;
33          &lt;/ds:Reference&gt;
34       &lt;/ds:SignedInfo&gt;
35       &lt;ds:SignatureValue&gt;
36         hq4zk+ZknjggCQgZm7ea8fI7...Hr7wHxvCCRwubfZ6RqVL+wNmeWI4=
37       &lt;/ds:SignatureValue&gt;
38       &lt;ds:KeyInfo&gt;
39          &lt;ds:X509Data&gt;
40              &lt;ds:X509Certificate&gt;
41     MIICyjCCAjOgAwIBAgICAnUwDQYJKoZIhvcNAQEEBQAwgakxNVBAYTAlVT
42     MRIwEAYDVQQIEwlXaXNjb .....  dnP6Hr7wHxvCCRwubnZAv2FU78pLX
43     8I3bsbmRAUg4UP9hH6ABVq4KQKMknxu1xQxLhpR1ylGPdioG8cCx3w/w==
44              &lt;/ds:X509Certificate&gt;
45          &lt;/ds:X509Data&gt;
46       &lt;/ds:KeyInfo&gt;
47    &lt;/ds:Signature&gt;
48    &lt;Subject&gt;
49       &lt;NameID
50         Format=
51       "urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress"&gt;
52         Alice@example.com
53       &lt;/NameID&gt;
54       &lt;SubjectConfirmation
55        Method="urn:oasis:names:tc:SAML:2.0:cm:sender-vouches"/&gt;
56    &lt;/Subject&gt;
57    &lt;Conditions NotBefore="2003-04-17T00:46:02Z"
58                NotOnOrAfter="2003-04-17T00:51:02Z"&gt;
59       &lt;AudienceRestriction&gt;
60          &lt;Audience&gt;
61             example2.com
62          &lt;/Audience&gt;
63       &lt;/AudienceRestriction&gt;
64    &lt;/Conditions&gt;
65    &lt;AttributeStatement&gt;
66       &lt;saml:Attribute
67    xmlns:x500=
68      "urn:oasis:names:tc:SAML:2.0:profiles:attribute:X500"
69    NameFormat=
70      "urn:oasis:names:tc:SAML:2.0:attrname-format:uri"
71    Name="urn:oid:2.5.4.20"
72    FriendlyName="telephoneNumber"&gt;
73          &lt;saml:AttributeValue xsi:type="xs:string"&gt;
74                +1-888-555-1212
75          &lt;/saml:AttributeValue&gt;
76       &lt;/saml:Attribute&gt;
77    &lt;/AttributeStatement&gt;
78 &lt;/Assertion&gt;

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Signed SAML Assertion 
                    Illustrating Conveyance of 
                    Subject Attribute&nbsp;</b></font><br /></td></tr></table><hr class="insert" />


            
</p>
<a name="sec-cons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>
                This section discusses security considerations when
                using SAML with SIP.
            
</p>
<a name="sec-cons-stolen-assn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Man-in-the-Middle Attacks and Stolen Assertions</h3>

<p>
                    </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>

                            <br />
 

                            By making SAML assertions available via
                            HTTP-based requests by a potentially
                            unbounded set of requesters, it is
                            conceivably possible that anyone would be
                            able to simply request one and obtain
                            it. By SIP intermediaries on the signaling
                            path for example. Or, an HTTP
                            intermediary/proxy could intercept the
                            assertion as it is being returned to a
                            requester.

                            <br />
<br />
 

                            The attacker could then conceivably
                            attempt to impersonate the subject (the
                            putative caller) to some SIP-based target
                            entity.
                        
</dd>
<dt>Countermeasures:</dt>
<dd>

                            <br />
 

                            Such an attack is implausible for several 
                            reasons. The primary reason is that a message 
                            constructed by an imposter using a stolen 
                            assertion that conveys the public key certificate
                            of some domain will not verify per 
                            <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> because
                            the imposter will not have the corresponding 
                            private key with which to generate the signed
                            Identity header value. 
                        
</dd>
<dt></dt>
<dd>
                            Also, the SIP
                            SAML assertion profile specified herein
                            that the subject's SAML assertion must adhere
                            to causes it to be not useful to arbitrary 
                            parties. The subject's assertion:

                            
<ul class="text">
<li>
                                    should be signed, thus causing any 
                                    alterations to break its integrity and
                                    make such alterations detectable.
                                
</li>
<li>
                                    relying party is represented in the
                                    SAML assertion's
                                    Audience Restriction.
                                
</li>
<li>
                                    Issuer is represented in the 
                                    SAML assertion.
                                
</li>
<li>
                                    validity period for assertion is 
                                    restricted.
                                
</li>
</ul>
                        
</dd>
</dl></blockquote><p>
                
</p>
<a name="sec-cons-forged-assn"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Forged Assertion</h3>

<p>
                    </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>

                            <br />
 
                            
                            A malicious user
                            could forge or alter a SAML assertion in
                            order to communicate with the SIP
                            entities.
                        
</dd>
<dt>Countermeasures:</dt>
<dd>

                            <br />
 

                            To avoid this
                            kind of attack, the entities must assure
                            that proper mechanisms for protecting the
                            SAML assertion are employed, e.g., signing
                            the SAML assertion itself. Section 5.1 of 
                            <a class='info' href='#OASIS.saml-core-2.0-os'>[OASIS.saml&#8209;core&#8209;2.0&#8209;os]<span> (</span><span class='info'>Cantor, S., Kemp, J., Philpott, R., and E. Maler, &ldquo;Assertions and Protocol for the OASIS Security Assertion Markup Language             (SAML) V2.0,&rdquo; March&nbsp;2005.</span><span>)</span></a> 
                            specifies the
                            signing of SAML assertions. 

                            <br />
<br />
 

                            Additionally, the assertion content dictated
                            by the SAML assertion profile herein ensures
                            ample evidence for a relying party to verify
                            the assertion and its relationship with the 
                            received SIP request. 
                        
</dd>
</dl></blockquote><p>
                
</p>
<a name="sec-cons-replay-attack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.3"></a><h3>10.3.&nbsp;
Replay Attack</h3>

<p>
                    </p>
<blockquote class="text"><dl>
<dt>Threat:</dt>
<dd>
                            
                            <br />
 

                            Theft of SIP message protected 
                            by the mechanisms described herein
                            and replay of it at a
                            later time.
                        
</dd>
<dt>Countermeasures:</dt>
<dd>
                            
                            <br />
 

                            There are various provisions within 
                            <a class='info' href='#RFC4474'>[RFC4474]<span> (</span><span class='info'>Peterson, J. and C. Jennings, &ldquo;Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP),&rdquo; August&nbsp;2006.</span><span>)</span></a> 
                            that prevent a replay attack. 
                        
</dd>
</dl></blockquote><p>
                
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Contributors</h3>

<p>
                The authors would like to thank Marcus Tegnander and
                Henning Schulzrinne for his contributions to earlier
                versions of this document.
            
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Acknowledgments</h3>

<p>
                We would like to thank RL 'Bob' Morgan, Stefan Goeman,
                Shida Schubert, Jason Fischl, Sebastian Felis, Nie Pin, 
                Marcos Dytz, Erkki Koivusalo, Richard Barnes, 
                Marc Willekens, Marc Willekens, Steffen Fries and 
                Vijay Gurbani for their comments to this draft.  
                
                The "AS-driven SIP SAML
                URI-based Attribute Assertion Fetch Profile" is based
                on an idea by Jon Peterson.
            
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
IANA Considerations</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1"></a><h3>13.1.&nbsp;
IANA Registration for New SIP Option Tag</h3>

<p>
                The SIP option tag "saml-shusb" is created by this document, with
            the definition and rule in Section 4.4 of this document, to be added
            to sip-parameters within IANA.
            
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2"></a><h3>13.2.&nbsp;
477 'Use Identity Header with SAML Assertion' Response Code</h3>

<p>
            This document registers a new SIP response code.  
                It is sent when a verifier receives a SIP request that
            lacks an Identity header with a SAML assertion in order to indicate 
            that the request should be re-sent with an Identity header pointing 
            to a SAML assertion.  This response code is defined by
            the following information, which has been added to the method and
            response-code sub-registry under
            http://www.iana.org/assignments/sip-parameters.
            
</p>
<p>
            Response Code Number: 477
            
                
</p>
<p>Default Reason Phrase: Use Identity Header with SAML Assertion
                
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.3"></a><h3>13.3.&nbsp;
478 'Unknown SAML Assertion Content' Response Code</h3>

<p>
            This document registers a new SIP response code.  
                It is used when the verifier is unable to parse the content of
            the SAML assertion referenced by the URI of the Identity-Info header,
            because, for example, the assertion contains only unknown elements in 
            in the SAML assertion, or the SAML assertion XML document is garbled.  
            This response code is defined by the following
            information, which has been added to the method and response-code
            sub-registry under http://www.iana.org/assignments/sip-parameters.
            
</p>
<p>    
            Response Code Number: 478
            
            
</p>
<p>Default Reason Phrase: Unknown SAML Assertion Content
            
                
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.4"></a><h3>13.4.&nbsp;
479 'Invalid SAML Assertion' Response Code</h3>

<p>
            This document registers a new SIP response code.  
                It is used when the verifier is unable to process the SAML 
            assertion referenced by the URI of the Identity-Info header,
            because, for example, the assertion is self-signed, or signed by a
            root certificate authority for whom the verifier does not possess a
            root certificate.  This response code is defined by the following
            information, which has been added to the method and response-code
            sub-registry under http://www.iana.org/assignments/sip-parameters.
            
</p>
<p>
            Response Code Number: 479
            
</p>
<p>Default Reason Phrase: Invalid SAML Assertion
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Open Issues</h3>

<p>A list of open issues can be found at: 
                http://www.tschofenig.priv.at:8080/saml-sip/
            
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
Change Log</h3>

<p>
                RFC Editor - Please remove this section before publication.
            
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.1"></a><h3>15.1.&nbsp;
-03 to -04</h3>

<p>Updated IANA consideration section. 
                
</p>
<p>Added option tag
</p>
<p>Updated acknowledgments section
</p>
<p>Minor editorial changes to the security considerations section
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.2"></a><h3>15.2.&nbsp;
-02 to -03</h3>

<p>
                    Denoted that this I-D is intended to update RFC4474
                    per SIP working group consensus at IETF-69. This is the
                    tact adopted in order to address the impedance mismatch
                    between the nature of the URIs specified as to be placed
                    in the Identity-Info header field, and what is 
                    specified in RFC4474 as the allowable value of that 
                    header field. 
                
</p>
<p>
                    Added placeholder &quot;TBD&quot; section for 
                    a to-be-determined &quot;call-by-value&quot; profile, 
                    per SIP working group consensus at IETF-69.
                
</p>
<p>
                    Removed use-case appendicies (per recollection of 
                    JHodges during IETF-69 discussion as being WG consensus,
                    but such is not noted in the minutes). 
                
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15.3"></a><h3>15.3.&nbsp;
-00 to -02</h3>

<p>
                    Will detail in -04 rev. 
                
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16"></a><h3>16.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>16.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="OASIS.saml-bindings-2.0-os">[OASIS.saml-bindings-2.0-os]</a></td>
<td class="author-text"><a href="mailto:cantor.2@osu.edu">Cantor, S.</a>, <a href="mailto:Frederick.Hirsch@nokia.com">Hirsch, F.</a>, <a href="mailto:John.Kemp@nokia.com">Kemp, J.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-bindings-2.0-os.pdf">Bindings for the OASIS Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;saml-bindings-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.saml-core-2.0-os">[OASIS.saml-core-2.0-os]</a></td>
<td class="author-text"><a href="mailto:cantor.2@osu.edu">Cantor, S.</a>, <a href="mailto:John.Kemp@nokia.com">Kemp, J.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf">Assertions and Protocol for the OASIS Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;saml-core-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.saml-metadata-2.0-os">[OASIS.saml-metadata-2.0-os]</a></td>
<td class="author-text"><a href="mailto:cantor.2@osu.edu">Cantor, S.</a>, <a href="mailto:jmoreh@sigaba.com">Moreh, J.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-metadata-2.0-os.pdf">Metadata for the Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;saml-metadata-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.saml-profiles-2.0-os">[OASIS.saml-profiles-2.0-os]</a></td>
<td class="author-text"><a href="mailto:">Hughes, J.</a>, <a href="mailto:cantor.2@osu.edu">Cantor, S.</a>, <a href="mailto:Jeff.Hodges@neustar.biz">Hodges, J.</a>, <a href="mailto:Frederick.Hirsch@nokia.com">Hirsch, F.</a>, <a href="mailto:pmishra@principalidentity.com">Mishra, P.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-profiles-2.0-os.pdf">Profiles for the OASIS Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;OASIS.saml-profiles-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2392">[RFC2392]</a></td>
<td class="author-text"><a href="mailto:XIson@cnj.digex.net">Levinson, E.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2392">Content-ID and Message-ID Uniform Resource Locators</a>,&rdquo; RFC&nbsp;2392, August&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2392.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2392.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2392.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3280">[RFC3280]</a></td>
<td class="author-text">Housley, R., Polk, W., Ford, W., and D. Solo, &ldquo;<a href="http://tools.ietf.org/html/rfc3280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;3280, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3515">[RFC3515]</a></td>
<td class="author-text">Sparks, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3515">The Session Initiation Protocol (SIP) Refer Method</a>,&rdquo; RFC&nbsp;3515, April&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3515.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3553">[RFC3553]</a></td>
<td class="author-text">Mealling, M., Masinter, L., Hardie, T., and G. Klyne, &ldquo;<a href="http://tools.ietf.org/html/rfc3553">An IETF URN Sub-namespace for Registered Protocol Parameters</a>,&rdquo; BCP&nbsp;73, RFC&nbsp;3553, June&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3553.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3893">[RFC3893]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc3893">Session Initiation Protocol (SIP) Authenticated Identity Body (AIB) Format</a>,&rdquo; RFC&nbsp;3893, September&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3893.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4474">[RFC4474]</a></td>
<td class="author-text">Peterson, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc4474">Enhancements for Authenticated Identity Management in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4474, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4474.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4484">[RFC4484]</a></td>
<td class="author-text">Peterson, J., Polk, J., Sicker, D., and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc4484">Trait-Based Authorization Requirements for the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4484, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4484.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.xmldsig-core">[W3C.xmldsig-core]</a></td>
<td class="author-text"><a href="mailto:dee3@torque.pothole.com">Eastlake, D.</a>, <a href="mailto:reagle@w3.org">Reagle , J.</a>, and <a href="mailto:dsolo@alum.mit.edu">D. Solo</a>, &ldquo;<a href="http://www.w3.org/TR/xmldsig-core/">XML-Signature Syntax and Processing</a>,&rdquo; W3C Recommendation&nbsp;xmldsig-core, October&nbsp;2000.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>16.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="IANA.application.samlassertion-xml">[IANA.application.samlassertion-xml]</a></td>
<td class="author-text">OASIS Security Services Technical Committee (SSTC), &ldquo;<a href="http://www.iana.org/assignments/media-types/application/samlassertion+xml">application/samlassertion+xml MIME Media Type Registration</a>,&rdquo; IANA MIME Media Types Registry&nbsp;application/samlassertion+xml, December&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.saml-conformance-2.0-os">[OASIS.saml-conformance-2.0-os]</a></td>
<td class="author-text"><a href="mailto:pmishra@principalidentity.com">Mishra, P.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-conformance-2.0-os.pdf">Conformance Requirements for the Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;saml-conformance-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.saml-glossary-2.0-os">[OASIS.saml-glossary-2.0-os]</a></td>
<td class="author-text"><a href="mailto:Jeff.Hodges@neustar.biz">Hodges, J.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-glossary-2.0-os.pdf">Glossary for the Security Assertion Markup Language
            (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;saml-glossary-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.saml-sec-consider-2.0-os">[OASIS.saml-sec-consider-2.0-os]</a></td>
<td class="author-text"><a href="mailto:Frederick.Hirsch@nokia.com">Hirsch, F.</a>, <a href="mailto:rphilpott@rsasecurity.com">Philpott, R.</a>, and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://docs.oasis-open.org/security/saml/v2.0/saml-sec-consider-2.0-os.pdf">Security and Privacy Considerations for the OASIS Security Markup
            Language (SAML) V2.0</a>,&rdquo; OASIS Standard&nbsp;saml-sec-consider-2.0-os, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.sstc-saml-exec-overview-2.0-cd-01">[OASIS.sstc-saml-exec-overview-2.0-cd-01]</a></td>
<td class="author-text"><a href="mailto:paulmadsen@rogers.com">Madsen, P.</a> and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://www.oasis-open.org/committees/download.php/13525/sstc-saml-exec-overview-2.0-cd-01-2col.pdf">SAML V2.0 Executive Overview</a>,&rdquo; OASIS SSTC Committee Draft&nbsp;sstc-saml-exec-overview-2.0-cd-01, April&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.sstc-saml-protocol-ext-thirdparty-cd-01">[OASIS.sstc-saml-protocol-ext-thirdparty-cd-01]</a></td>
<td class="author-text"><a href="mailto:cantor.2@osu.edu">Cantor, S.</a>, &ldquo;<a href="http://www.oasis-open.org/committees/download.php/18055/sstc-saml-protocol-ext-thirdparty-cd-01.pdf">SAML Protocol Extension for Third-Party Requests</a>,&rdquo; OASIS SSTC Committee Draft&nbsp;sstc-saml-protocol-ext-thirdparty-cd-01, March&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASIS.sstc-saml-tech-overview-2.0-draft-08">[OASIS.sstc-saml-tech-overview-2.0-draft-08]</a></td>
<td class="author-text"><a href="mailto:">Hughes, J.</a> and <a href="mailto:eve.maler@sun.com">E. Maler</a>, &ldquo;<a href="http://www.oasis-open.org/committees/download.php/14361/sstc-saml-tech-overview-2.0-draft-08.pdf">Security Assertion Markup Language
            (SAML) V2.0 Technical Overview</a>,&rdquo; OASIS SSTC Working Draft&nbsp;sstc-saml-tech-overview-2.0-draft-08, September&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2543">[RFC2543]</a></td>
<td class="author-text"><a href="mailto:mjh@aciri.org">Handley, M.</a>, <a href="mailto:schulzrinne@cs.columbia.edu">Schulzrinne, H.</a>, <a href="mailto:schooler@cs.caltech.edu">Schooler, E.</a>, and <a href="mailto:jdrosen@bell-labs.com">J. Rosenberg</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2543">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;2543, March&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2543.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2693">[RFC2693]</a></td>
<td class="author-text"><a href="mailto:carl.m.ellison@intel.com">Ellison, C.</a>, <a href="mailto:frantz@netcom.com">Frantz, B.</a>, <a href="mailto:blampson@microsoft.com">Lampson, B.</a>, <a href="mailto:rivest@theory.lcs.mit.edu">Rivest, R.</a>, <a href="mailto:bt0008@sbc.com">Thomas, B.</a>, and <a href="mailto:ylo@ssh.fi">T. Ylonen</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2693">SPKI Certificate Theory</a>,&rdquo; RFC&nbsp;2693, September&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2693.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3281">[RFC3281]</a></td>
<td class="author-text">Farrell, S. and R. Housley, &ldquo;<a href="http://tools.ietf.org/html/rfc3281">An Internet Attribute Certificate Profile for Authorization</a>,&rdquo; RFC&nbsp;3281, April&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3281.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3323">[RFC3323]</a></td>
<td class="author-text">Peterson, J., &ldquo;<a href="http://tools.ietf.org/html/rfc3323">A Privacy Mechanism for the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;3323, November&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3323.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jeff Hodges</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NeuStar, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2000 Broadway Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Redwood City, CA  94063</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Jeff.Hodges@neustar.biz">Jeff.Hodges@neustar.biz</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jon Peterson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NeuStar, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1800 Sutter St Suite 570</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Concord, CA  94520</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jon.peterson@neustar.biz">jon.peterson@neustar.biz</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">James Polk</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2200 East President George Bush Turnpike</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richardson, Texas  75082</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jmpolk@cisco.com">jmpolk@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Douglas C. Sicker</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Colorado at Boulder</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">ECOT 430</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Boulder, CO  80309</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:douglas.sicker@colorado.edu">douglas.sicker@colorado.edu</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
