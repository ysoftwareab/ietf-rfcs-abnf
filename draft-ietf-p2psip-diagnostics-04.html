<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang=""><head><title>P2PSIP Overlay
    Diagnostics</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="P2PSIP Overlay
    Diagnostics">
<meta name="keywords" content="Diagnostics, P2PSIP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">P2PSIP Working Group</td><td class="header">H. Song</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">X. Jiang</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">R. Even</td></tr>
<tr><td class="header">Expires: January 13, 2011</td><td class="header">Huawei</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">D. Bryan</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cogent Force, LLC / Huawei</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 12, 2010</td></tr>
</table></td></tr></table>
<h1><br />P2PSIP Overlay
    Diagnostics<br />draft-ietf-p2psip-diagnostics-04</h1>

<h3>Abstract</h3>

<p>This document describes mechanisms for P2PSIP diagnostics. It
      defines extensions to the RELOAD P2PSIP base protocol <a class='info' href='#I-D.ietf-p2psip-base'>RELOAD<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;p2psip&#8209;base] to collect
      diagnostic information, and details the protocol specifications
      for these extensions. Useful diagnostic information for
      connection and node status monitoring is also defined. The
      document also describes the usage scenarios and provides
      examples of how these methods are used to perform diagnostics in
      a P2PSIP overlay networks.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 13, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Diagnostic Scenarios<br />
<a href="#anchor4">4.</a>&nbsp;
Overview of operations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
&ldquo;Ping-like&rdquo; Behavior: Extending Ping<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.</a>&nbsp;
 &ldquo;Traceroute-like&rdquo; Behavior: The
		      Path_Track Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.3.</a>&nbsp;
Problems with Generating Multiple Responses on Path<br />
<a href="#anchor8">5.</a>&nbsp;
RELOAD diagnostic extensions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DiagDataStruc">5.1.</a>&nbsp;
Diagnostic Data Structures<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DiagReqDataStruc">5.1.1.</a>&nbsp;
DiagnosticRequest Data Structure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.1.2.</a>&nbsp;
DiagnosticResponse Data Structure<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#diag_information">5.1.3.</a>&nbsp;
dMFlags and Diagnostic Kind ID Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.1.4.</a>&nbsp;
Extending Diagnostic Information<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ping_ext">5.2.</a>&nbsp;
Request Extension: Ping<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Path_Track">5.3.</a>&nbsp;
New Reqeust: Path_Track<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.3.1.</a>&nbsp;
Path_track Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.3.2.</a>&nbsp;
Path_track Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sec_err_codes">5.4.</a>&nbsp;
Error Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.5.</a>&nbsp;
Message Processing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.5.1.</a>&nbsp;
Message Creation and Transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Message_Processing_Intermediate_Peers">5.5.2.</a>&nbsp;
Message Processing: Intermediate Peers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Message_response">5.5.3.</a>&nbsp;
Message Response Creation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.5.4.</a>&nbsp;
Interpreting Results<br />
<a href="#anchor16">6.</a>&nbsp;
Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">6.1.</a>&nbsp;
Example 1<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">6.2.</a>&nbsp;
Example 2<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">6.3.</a>&nbsp;
Example 3<br />
<a href="#anchor20">7.</a>&nbsp;
Security Considerations<br />
<a href="#IANA">8.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IANADER">8.1.</a>&nbsp;
Diagnostic Extension Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IANADKT">8.2.</a>&nbsp;
Diagnostic Kind ID Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IANARMC">8.3.</a>&nbsp;
Message Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">8.4.</a>&nbsp;
Error Code<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">8.5.</a>&nbsp;
Message Extension<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IANADFLG">8.6.</a>&nbsp;
Diagnostics Flag<br />
<a href="#anchor23">9.</a>&nbsp;
Open Questions<br />
<a href="#anchor24">10.</a>&nbsp;
Acknowledgments<br />
<a href="#anchor25">11.</a>&nbsp;
Appendix: Changes to the Draft<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">11.1.</a>&nbsp;
Changes since -00 version<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">11.2.</a>&nbsp;
Changes since -01 version<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">11.3.</a>&nbsp;
Changes since -02 version<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">11.4.</a>&nbsp;
Changes since -03 version<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References <br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>In the last few years, overlay networks have rapidly evolved
      and emerged as a promising platform for deployment of new
      applications and services in the Internet. One of the reasons
      overlay networks are seen as an excellent platform for large
      scale distributed systems is their resilience in the presence of
      failures. This resilience has three aspects: data replication,
      routing recovery, and static resilience.  Routing recovery
      algorithms are used to repopulate the routing table with live
      nodes when failures are detected. Static resilience measures the
      extent to which an overlay can route around failures even before
      the recovery algorithm repairs the routing table. Both routing
      recovery and static resilience relies on accurate and timely
      detection of failures.
</p>
<p>There are a number of situations in which some peers in a
      P2PSIP overlay may malfunction or behave badly.  For example,
      these peers may be disabled, congested, or may be misrouting
      messages. The impact of these malfunctions on the overlay
      network may be a degradation of quality of service provided
      collectively by the peers in the overlay network or an
      interruption of the overlay services. It is desirable to
      identify malfunctioning or badly behaving peers through
      diagnostic tools, and exclude or reject them from the P2PSIP
      system. Node failures may be also caused by underlying failures,
      for example the recovery from an incorrect overlay topology may
      be slow when the IP layer routing failover speed after link
      failures is very slow. Moreover, if a backbone link fails and
      the failover is slow, the network may be partitioned, leading to
      partitions of overlay topologies and inconsistent routing
      results between different partitioned components.
</p>
<p>Some keep-alive algorithms based on periodic probe and
      acknowledge mechanisms enable accurate and timely detection of
      failures of one peer's neighbors <a class='info' href='#Overlay-Failure-Detection'>[Overlay&#8209;Failure&#8209;Detection]<span> (</span><span class='info'>Zhuang, S., &ldquo;On failure detection algorithms in overlay networks,&rdquo; Mar&nbsp;2005.</span><span>)</span></a>, but these algorithms
      by themselves can only detect the disabled neighbors using the
      periodic method, it may not be enough for service providers
      operating the overlay network.
</p>
<p>A single, general P2PSIP overlay diagnostic framework
      supporting periodic and on-demand methods for detecting node
      failures and network failures is desirable. This document
      describes a general P2PSIP overlay diagnostic extension to the
      P2PSIP base protocol RELOAD and is intended as a compliment to
      keep-alive algorithms in the P2PSIP overlay itself.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The concepts used in this document are compatible with <a class='info' href='#I-D.ietf-p2psip-concepts'>"Concepts and Terminology for Peer to
      Peer SIP"<span> (</span><span class='info'>Bryan, D., Matthews, P., Shim, E., Willis, D., and S. Dawkins, &ldquo;Concepts and Terminology for Peer to Peer SIP,&rdquo; July&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;p2psip&#8209;concepts] and the <a class='info' href='#I-D.ietf-p2psip-base'>P2PSIP base
      protocol RELOAD<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;p2psip&#8209;base].
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Diagnostic Scenarios</h3>

<p>P2P systems are self-organizing and ideally require no
      network management in the traditional sense to set up and to
      configure individual P2P nodes. However, users of an overlay, as
      well as P2P service providers may contemplate usage scenarios
      where some monitoring and diagnostics are required. We present a
      simple connectivity test and some useful diagnostic information
      that may be used in such diagnostics.
</p>
<p>The common usage scenarios for P2P diagnostics can be broadly
      categorized in three classes:
</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>Automatic diagnostics built into the P2P overlay routing
	protocol. Nodes perform periodic checks of known neighbors and
	remove those nodes from the routing tables that fail to
	respond to connectivity checks <a class='info' href='#Handling_Churn_in_a_DHT'>[Handling_Churn_in_a_DHT]<span> (</span><span class='info'>Rhea, S., &ldquo;Handling Churn in a DHT,&rdquo; June&nbsp;2004.</span><span>)</span></a>. However, the
	unresponsive nodes may only be temporarily disabled, for
	example due to some local cryptographic processing overload,
	disk processing overload or link overload. It is therefore
	useful to repeat the connectivity checks to see if such nodes
	have recovered and can be again placed in the routing tables.
	This process is known as 'failed node recovery' and can be
	optimized as described in the paper <a class='info' href='#Handling_Churn_in_a_DHT'>"Handling Churn in a
	DHT"<span> (</span><span class='info'>Rhea, S., &ldquo;Handling Churn in a DHT,&rdquo; June&nbsp;2004.</span><span>)</span></a> [Handling_Churn_in_a_DHT].
</dd>
<dt>b.</dt>
<dd>Diagnostics for a particular node to follow up an
	individual user complaint or failure. For example, in this
	case a technical support person may use a desktop sharing
	application with the permission of the user to determine
	remotely the health and possible problems with the
	malfunctioning node. Part of the remote diagnostics may
	consist of simple connectivity tests with other nodes in the
	P2PSIP overlay and retrieval statistics of nodes from the
	overlay . The simple connectivity tests are not dependent on
	the type of P2PSIP overlay. Note that other tests may be
	required as well, such as checking the health and performance
	of the user's computer or mobile device and also checking the
	bandwidth of the link connecting the user to the Internet.
</dd>
<dt>c.</dt>
<dd>P2P system diagnostics to check the overall health of the
	P2P overlay network, the consumption of network bandwidth, for
	the presence of problem links and also to check for abusive or
	malicious nodes. This is not a trivial problem and has been
	studied in detail for content and streaming P2P overlays <a class='info' href='#Diagnostic_Framework'>[Diagnostic_Framework]<span> (</span><span class='info'>Jin, X., &ldquo;A Diagnostic Framework for Peer-to-Peer Streaming,&rdquo; 2005.</span><span>)</span></a> as well as in earlier
	P2PSIP documents <a class='info' href='#Diagnostics_and_NAT_traversal_in_P2PP'>[Diagnostics_and_NAT_traversal_in_P2PP]<span> (</span><span class='info'>Gupta, G., &ldquo;Diagnostics and NAT Traversal in P2PP - Design and           Implementation,&rdquo; June&nbsp;2008.</span><span>)</span></a>. While
	this is a difficult problem, a great deal of information can
	be obtained in helping these diagnostics by sending messages
	to diagnose the network. This document provides a framework
	for obtaining this information.
</dd>
</dl></blockquote>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Overview of operations</h3>

<p>The diagnostic mechanisms described in this document are
      mainly intended to detect and localize failures or monitor
      performance in P2PSIP overlay networks. It provides mechanisms
      to detect and localize malfunctioning or badly behaving peers
      including disabled peers, congested peers and misrouting peers.
      It provides a mechanism to detect direct connectivity or
      connectivity to a specified peer, a mechanism to detect the
      availability of specified resource records and a mechanism to
      discover P2PSIP overlay topology and the underlay topology
      failures.
</p>
<p>The P2PSIP diagnostics extensions define two mechanisms to
      collect data. The first is an extension to the RELOAD ping
      mechanism, allowing diagnostic data to be queried from a peer,
      as well as to diagnose the path to that peer. The second is a
      new method and response, Path_Track, for collecting diagnostic
      information iteratively. Payloads for these mechanisms allowing
      diagnostic data to be collected and represented are presented,
      and additional error codes are introduced. Essentially, this
      draft reuses P2PSIP base protocol specification and extends them
      to introduce the new diagnostics methods. The extensions
      strictly follow the P2PSIP base protocol specification on the
      messages routing, transport, NAT traversal etc. The diagnostic
      methods are however P2PSIP protocol independent.
</p>
<p>This document primarily describes how to detect and localize
      failures including disabled peers, congested peers, misrouting
      behaviors and underlying network faults in P2PSIP overlay
      networks through a simple and efficient mechanism. This
      mechanism is modeled after the ping/traceroute paradigm: ping
      (RFC792 <a class='info' href='#RFC0792'>ICMP echo request<span> (</span><span class='info'>Postel, J., &ldquo;Internet Control Message Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> [RFC0792]) is
      used for connectivity checks, and traceroute is used for
      hop-by-hop fault localization as well as path tracing. This
      document specifies a "ping-like" mode (by extending the RELOAD
      ping method to gather diagnostics) and a "traceroute-like" mode
      (by defining the new Path_Track method) for diagnosing P2PSIP
      overlay networks.
</p>
<p>One approach these tools can be used is to detect the
      connectivity to the specified peer or the availability of the
      specified resource-record through the extended P2PSIP Ping
      operation once the overlay network receives some alarms about
      overlay service degradation or interruption, if the Ping fails,
      one can then send a Path_Track to determine where the fault
      lies.
</p>
<p>The diagnostic information must be only provided to
      authorized peers. Some diagnostic information can be authorized
      to all the participants in the P2PSIP overlay, and some other
      diagnostic information can only be provided to the authorization
      peer list of each diagnostic information according to the local
      or overlay policy. The authorization depends on the kinds
      of the diagnostic information and the administrative
      considerations, and is application specific.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
&ldquo;Ping-like&rdquo; Behavior: Extending Ping</h3>

<p>To provide &ldquo;ping-like&rdquo; behavior, the RELOAD
        ping method has been extended to collect diagnostic data along
        the path. The request message is forwarded by the intermediate
        peers along the path and then terminated by the responsible
        peer, and after optional local diagnostics, the responsible
        peer returns a response message. If an error is found when
        routing, an Error response is sent to the initiator node by
        the intermediate peer.
</p>
<p>The message flow of a Ping message (with diagnostic
	extensions) is as follows:
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Peer A              Peer B               Peer C             Peer D
  |                    |                    |                    |
  |(1). Ping           |                    |                    |
  |-------------------&gt;|(2). Ping           |                    |
  |                    |-------------------&gt;|(3). Ping           |
  |                    |                    |-------------------&gt;|
  |                    |                    |                    |
  |                    |                    |&lt;-------------------|
  |                    |&lt;-------------------|(4). Ping           |
  |&lt;-------------------|(5). Ping           |                    |
  |(6). Ping           |                    |                    |
  |                    |                    |                    |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Ping Diagnostic Message Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
 &ldquo;Traceroute-like&rdquo; Behavior: The
		      Path_Track Method</h3>

<p>We define a simple Path_Track method for retrieving
	diagnostics information iteratively. First, the initiating
	peer asks its neighbor A which is the next hop peer to the
	destination ID, and then retrieve the next hop peer B
	information, along with optional diagnostic information of A,
	to the initiator peer. Then the initiator peer asks the next
	hop peer B (directly or symmetric routing) to get the further
	next hop peer C information and diagnostic information of B.
	Unless a failure prevents the message from being forwarded,
	this step can be iteratively repeated until the request reaches
	responsible peer D for the destination ID, and retrieves
	diagnostic information of peer D.
</p>
<p>The message flow of a Path_Track message (with diagnostic
	extensions) is as follows:
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Peer-A              Peer-B               Peer-C             Peer-D
  |                    |                    |                    |
  |(1).Path_TrackReq   |                    |                    |
  |-------------------&gt;|                    |                    |
  |(2).Path_TrackAns   |                    |                    |
  |&lt;-------------------|                    |                    |
  |                    |(3).Path_TrackReq   |                    |
  |--------------------|-------------------&gt;|                    |
  |                    |(4).Path_TrackAns   |                    |
  |&lt;-------------------|--------------------|                    |
  |                    |                    |(5).Path_TrackReq   |
  |--------------------|--------------------|-------------------&gt;|
  |                    |                    |(6).Path_TrackAns   |
  |&lt;-------------------|--------------------|--------------------|
  |                    |                    |                    |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Path_Track Diagnostic Message Flow&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>There have been proposals made on list that RouteQuery and
	a series of Fetch requests can be used to replace the
	Path_Track mechanism, but in the presence of churn such an
	operation would not, strictly speaking, provide identical
	results, as the path may change between RouteQuery and Fetch
	operations. (although obviously the path could change between
	steps of Path_Track as well) The WG should discuss which
	technique they prefer for obtaining this information. If Fetch
	is used, a similar list of enhancements to Fetch may be
	required.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Problems with Generating Multiple Responses on Path</h3>

<p>An earlier version of this document considered an approach
	where a response was generated by each intermediate peer as
	the message traversed the overlay. This approach was
	discarded as a result of working group discussion. One reason
	this approach was discarded was that it could provide a DoS
	mechanism, whereby an attacker could send an arbitrary message
	claiming to be from a spoofed &ldquo;sender&rdquo; the real
	sender wished to attack. As a result of sending this one
	message, many messages would be generated and sent back to the
	spoofed &ldquo;sender&rdquo; -- one from each intermediate
	peer on the message path. While authentication mechanisms
	could reduce some of the risk of this attack, it still
	resulted in a fundamental break from the request-response
	nature of the RELOAD protocol, as multiple responses are
	generated to a single request. Although one request with
	responses from all the peers in the route will be more
	efficient, it was determined to be too great a security risk
	and deviation from the RELOAD architecture. This summary is
	provided here to document the WG decision on this issue.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
RELOAD diagnostic extensions</h3>

<p>This document extends RELOAD to carry diagnostics
      information. Considering the special usage of diagnostics, this
      document defines extensions for a payload to Ping, as well as
      the new method Path_Track and its response. Additionally, new
      Error codes, message bodies for conveying diagnostics, and some
      suggested common diagnostic values are defined. Processing of
      the Path_Track message and the diagnostic bodies is
      discussed.
</p>
<p>The mechanism defined in this document follows the RELOAD
      specification, the new request and response message use the
      message format specified in P2PSIP base protocol messages.
      Please refer to the <a class='info' href='#I-D.ietf-p2psip-base'>RELOAD<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;p2psip&#8209;base] for details of the
      protocol.
</p>
<a name="DiagDataStruc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Diagnostic Data Structures</h3>

<p>The diagnostics use the following common diagnostics data
	structures. Two common structures are defined.
	DiagnosticRequest for requesting data, and DiagnosticResponse
	for returning information.
</p>
<a name="DiagReqDataStruc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
DiagnosticRequest Data Structure</h3>

<p>The DiagnosticRequest data structure is sent to request
	  diagnostic information and has the following form:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    enum { (2^16-1) } DiagnosticExtensionRequestType;

    struct {
      DiagnosticExtensionRequestType   type;
      opaque             diagnostic_extension_contents&lt;0..2^32-1&gt;;
    } DiagnosticExtension

    struct {
      uint64              expiration;
      uint64              timestampInitiated;
      uint32              length;

      select (length){
        case 0:
          uint64               dMFlags;

        case &gt; 0:
          uint64               dMFlags;
          DiagnosticExtension  diagnostic_extensions&lt;0..2^32-1&gt;;
      }
    } DiagnosticsRequest;
</pre></div>
<p>The fields in the DiagnosticRequest are as follows:
</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>expiration : The time-of-day (in seconds and
	    microseconds, according to the receiver's clock) in NTP
	    timestamp format <a class='info' href='#RFC4330'>[RFC4330]<span> (</span><span class='info'>Mills, D., &ldquo;Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI,&rdquo; January&nbsp;2006.</span><span>)</span></a> when the
	    request expires. This field can be used to mitigate the
	    replay attack to the destination peer and overlay
	    network.
</dd>
<dt></dt>
<dd>timestampInitiated : The time-of-day (in seconds and
	    microseconds, according to the sender's clock) in NTP
	    timestamp format <a class='info' href='#RFC4330'>[RFC4330]<span> (</span><span class='info'>Mills, D., &ldquo;Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI,&rdquo; January&nbsp;2006.</span><span>)</span></a> when the
	    P2PSIP Overlay diagnostic request is sent.
</dd>
<dt></dt>
<dd>length : the length of the extended diagnostic request
	    information in bytes. If the value is greater than or
	    equal to 1, then some extended diagnostics information is
	    requested. The value of length must not be negative. 
</dd>
<dt></dt>
<dd>dMFlags : A mandatory field which is an unsigned 64-bit
	    integer indicating which base diagnostic information the
	    initiator is interested in. The initiator sets different
	    bits to retrieve different kinds of diagnostic
	    information. If dMFlags is clear, then no base diagnostic
	    information is conveyed in the Path_Track response. If
	    dMFlag is set to all '1's, then all base diagnostic
	    information values are requested. A request may set any
	    number of the flags to request the corresponding
	    diagnostic information.
</dd>
<dt></dt>
<dd>FIX (Note: This memo specifies the initial set of
	    flags, the flags can be extended by standard action. We
	    will add a section about extending the flags both standard
	    and application specific in a future version) The dMflags
	    indicate general diagnostic information The mapping
	    between the bits in the dMFlags and the diagnostic
	    information kind presented is as below.
</dd>
<dt></dt>
<dd>diagnostic_extensions : consists of one or more
	    DiagnosticExtension structures (see below) documenting
	    additional diagnostic information being requested.
</dd>
</dl></blockquote>
<p>Each DiagnosticExtension has the following fields:
</p>
<blockquote class="text">
<p>type : the extension type (see <a class='info' href='#IANADER'>Section&nbsp;8.1<span> (</span><span class='info'>Diagnostic Extension Types</span><span>)</span></a>) Note that type 0xFFFE
	    is reserved for overlay specific diagnostics and may be
	    used without IANA registration for local diagnostic
	    information.
</p>
<p>diagnostic_extension_contents : the opaque data
	    containing the request for this particular extension. This
	    data is extension dependent.
</p>
</blockquote>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
DiagnosticResponse Data Structure</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    enum { (2^16-1) } DiagnosticKindId;

    struct {
      DiagnosticKindId       kind;
      opaque                 diagnostic_info_contents&lt;0..2^16-1&gt;;
    } DiagnosticInfo;

    struct {
      uint64                 expiration;
      uint64                 timestampReceived;
      uint8                  hopCounter;

      DiagnosticInfo         diagnostic_info_list&lt;0..2^32-1&gt;;

    } DiagnosticsResponse;
</pre></div>
<p>The fields in the Diagnostic Response are as follows:
</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>expiration : The time-of-day (in seconds and
	    microseconds, according to the receiver's clock) in NTP
	    timestamp format <a class='info' href='#RFC4330'>[RFC4330]<span> (</span><span class='info'>Mills, D., &ldquo;Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI,&rdquo; January&nbsp;2006.</span><span>)</span></a> when the
	    Inspect request expires. This field can be used to
	    mitigate the replay attack to the destination peer and
	    overlay network.
</dd>
<dt></dt>
<dd>timestampReceived : The time-of-day (in seconds and
	    microseconds, according to the receiver's clock) in NTP
	    timestamp format <a class='info' href='#RFC4330'>[RFC4330]<span> (</span><span class='info'>Mills, D., &ldquo;Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI,&rdquo; January&nbsp;2006.</span><span>)</span></a> when the
	    P2PSIP Overlay diagnostic request was received.
</dd>
<dt></dt>
<dd>hopCounter : This field only appears in diagnostic
	    responses. It must be exactly copied from the TTL field of
	    the forwarding header in the received request. This
	    information is sent back to the request initiator,
	    allowing it to compute the hops that the message traversed
	    in the overlay.
</dd>
<dt></dt>
<dd>diagnostic_info_list : consists of one or more
	    DiagnosticInfo values containing the requested diagnostic
	    information.
</dd>
</dl></blockquote>
<p>The fields in the DiagnosticInfo structure are as
	  follows:
</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>kind : A numeric code indicating the type of
	    information being returned. For base data requested using
	    the dMFlags, this code corresponds to the dMFlag set, and
	    is listed in section FIX. For diagnostic extensions, this
	    code will be identical to the value of the
	    DiagnosticExtensionRequestType set in the type field of
	    the DiagnosticExtension of the request, and these two
	    values will be assigned together. See <a class='info' href='#IANADKT'>Section&nbsp;8.2<span> (</span><span class='info'>Diagnostic Kind ID Types</span><span>)</span></a>.
</dd>
<dt></dt>
<dd>diagnostic_information : Data containing the value for
	    the diagnostic information being reported. Various kinds
	    of diagnostic information can be retrieved, Please refer
	    to <a class='info' href='#diag_information'>Section&nbsp;5.1.3<span> (</span><span class='info'>dMFlags and Diagnostic Kind ID Types</span><span>)</span></a> for details of the
	    types and Diagnostic Kind-ID for the base diagnostic
	    information that may be reported.
</dd>
</dl></blockquote>
<a name="diag_information"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
dMFlags and Diagnostic Kind ID Types</h3>

<p>The dMFlags field described above is a 64 bit field that
	  allows requesters to identify up to 62 items of base
	  information to request (the first and last flags being
	  reserved) when sending a request. When the requested base
	  information is returned in the response, the value of the
	  diagnostic kind ID will correspond to the numeric field
	  marked in the dMFlags in the request. The values for the
	  dMFlags are defined in <a class='info' href='#IANADFLG'>Section&nbsp;8.6<span> (</span><span class='info'>Diagnostics Flag</span><span>)</span></a> and the
	  diagnostic Kind-IDs are defined in <a class='info' href='#IANADKT'>Section&nbsp;8.2<span> (</span><span class='info'>Diagnostic Kind ID Types</span><span>)</span></a>.
	  The information contained for each value is described in
	  this section.
</p>
<p>Editor's note: For the diagnostic information of
	  processing power, bandwidth and etc., we should look at what
	  has been useful for PlanetLab and in commercial deployments
	  in this context, and further discussion is needed on what
	  mature diagnostics information for p2p overlays can be
	  brought here. 
</p>
<blockquote class="text">
<p>STATUS_INFO (8 bits): A single value element containing
	    an unsigned byte representing whether or not the node is
	    in congestion status. An example usage of STATUS_INFO is
	    for congestion-aware routing. In this scenario, each peer
	    has to update its congestion status periodically, an
	    intermediate peer in the DHT network will choose its next
	    hop according to both the DHT routing algorithm and the
	    status information, and then forward requests to the
	    chosen next hop, so as to avoid increasing load on
	    congested peers.
</p>
<p>ROUTING_TABLE_SIZE (32 bits): A single value element
	    containing an unsigned 32-bit integer representing the number of
	    peers in the peer's routing table. The administrator of the
	    overlay may be interested in statistics of this value for the
	    consideration such as routing efficiency.
</p>
<p>PROCESS_POWER (32 bits): A single value element containing an
	    unsigned 32-bit integer specifying the processing power of the
	    node in unit of MIPS.
</p>
<p>BANDWIDTH (32 bits): A single value element containing
	    an unsigned 32-bit integer specifying the bandwidth of the
	    node in unit of Kbps.
</p>
<p>SOFTWARE_VERSION: A single value element containing a
	    US-ASCII string that identifies the manufacture, model, and
	    version of the software.
</p>
<p>MACHINE_UPTIME (64 bits): A single value element containing
	    an unsigned 64-bit integer specifying the time the nodes has
	    been up in seconds.
</p>
<p>APP_UPTIME (64 bits): A single value element containing an
	    unsigned 64-bit integer specifying the time the p2p application
	    has been up in seconds.
</p>
<p>MEMORY_FOOTPRINT (32 bits): A single value element containing
	    an unsigned 32- bit integer representing the memory footprint of
	    the peer program in kilo bytes. (Note: A kilo byte in this document represents 1024
	    bytes.)
</p>
<p>DATASIZE_STORED (64 bits): An unsigned 64-bit integer
	    representing the number of bytes of data being stored by this
	    node.
</p>
<p>INSTANCES_STORED: An array element containing the number of
	    instances of each kind stored. The array is index by Kind-ID.
	    Each entry is an unsigned 64-bit integer.
</p>
<p>MESSAGES_SENT_RCVD: An array element containing the
	    number of messages sent and received. The array is indexed
	    by method code. Each entry in the array is a pair of
	    unsigned 64-bit integers (packed end to end) representing
	    sent and received.
</p>
<p>EWMA_BYTES_SENT (32 bits): A single value element
	    containing an unsigned 32-bit integer representing an
	    exponential weighted average of bytes sent per second by
	    this peer. sent = alpha x sent_present + (1 - alpha) x
	    sent where sent_present represents the bytes sent per
	    second since the last calculation and sent represents the
	    last calculation of bytes sent per second. A suitable
	    value for alpha is 0.8. This value is calculated every
	    five seconds.
</p>
<p>EWMA_BYTES_RCVD (32 bits): A single value element
	    containing an unsigned 32-bit integer representing an
	    exponential weighted average of bytes received per second
	    by this peer. Same calculation as above.
</p>
<p>UNDERLAY_HOP (8 bits): It indicates the IP layer hops
	    from the intermediate peer which receives the diagnostics
	    message to its next hop peer for this message. (Note: this
	    is from the underlayTTL in the previous version. However,
	    RELOAD does not require the intermediate peers to look
	    into the message body. So here we use Path_Track to gather
	    underlay hops for diagnostics purpose.
</p>
<p>BATTERY_STATUS (8 bits): The left-most bit is used to
	    indicate whether this peer is using battery or not. If
	    this bit is clear ('0'), then the peer is using battery
	    power. The other 7 bits are to be determined by specific
	    applications.
</p>
</blockquote>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.4"></a><h3>5.1.4.&nbsp;
Extending Diagnostic Information</h3>

<p>The DiagnosticsExtension structure may be used to extend
	  the diagnostic information collected.
</p>
<p>Editor's Note: <a class='info' href='#I-D.ietf-p2psip-self-tuning'>The self-tuning
	  draft<span> (</span><span class='info'>Maenpaa, J., Camarillo, G., and J. Hautakorpi, &ldquo;A Self-tuning Distributed Hash Table (DHT) for REsource LOcation And Discovery (RELOAD),&rdquo; July&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;p2psip&#8209;self&#8209;tuning] could extend the diagnostics information here
	  to collect related information for calculating self-tuning
	  parameters.
</p>
<a name="ping_ext"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Request Extension: Ping</h3>

<p>To extend the ping request for use in diagnostics, a new
	extension as defined in Section 5.3.3 of RELOAD is defined.
	The structure for a MessageExtension in RELOAD is defined
	as:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
         struct {
           MessageExtensionType  type;
           Boolean               critical;
           opaque                extension_contents&lt;0..2^32-1&gt;;
         } MessageExtension;
</pre></div>
<p>For the ping request extension, we define a new
	MessageExtensionType, extension 0x0001 named Diagnostic_Ping, as
	specified in <a class='info' href='#table_extcodes'>Table&nbsp;5<span> (</span><span class='info'>New RELOAD Extension Code</span><span>)</span></a> and specified in
	the RELOAD draft section 13.12. The extension contents consists of a
	DiagnosticRequest structure as defined in <a class='info' href='#DiagReqDataStruc'>Section&nbsp;5.1.1<span> (</span><span class='info'>DiagnosticRequest Data Structure</span><span>)</span></a>. This extension MAY be used for
	new requests of the the ping method and MUST NOT be included
	in requests using any other method.
</p>
<p>This extension is NOT critical. If a peer does not extend
	the extension, they will simply ignore the diagnostic portion
	of the message, and will treat the message if it was a normal
	ping. Senders MUST accept a response that lacks diagnostic
	information and SHOULD NOT resend the message expecting a
	reply. Receivers who receive a method other than ping
	including this extension MUST ignore the extension.
</p>
<a name="Path_Track"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
New Reqeust: Path_Track</h3>

<p>This document defines a simple Path_Track method to
	retrieve the diagnostic information from the intermediate
	peers along the routing path. At each step of the Path_Track
	request, the responsible peer responds to the initiator node
	with requested status information such as congestion state,
	its processing power, its available bandwidth, the number of
	entries in its neighbor table, its uptime, its identity and
	network address information, and the next hop peer
	information.
</p>
<p>A Path_Track request specifies which diagnostic information
	is requested using a DiagnosticRequest Data structure. Base
	information is requested by setting the appropriate flags in
	the dMFlags field of the DiagnosticRequest. If the flag is
	clear (no bits are set), then the Path_Track request is only
	used for requesting the next hop information. In this case the
	iterative mode of Path_Track is degraded to a Route_Query
	method which is only used for checking the liveness of the
	peers along the routing path. The Path_Track request can be
	routed directly or through the overlay based on the routing
	mode chosen by the initiator node.
</p>
<p>A response to a successful PathTrackReq is a PathTrackAns
	message. There is a general diagnostic information portion of
	the payload, the contents of which are based on the flags in
	the request. Please refer to <a class='info' href='#diag_information'>Section&nbsp;5.1.3<span> (</span><span class='info'>dMFlags and Diagnostic Kind ID Types</span><span>)</span></a> for the definitions of the
	base diagnostic information, and <a class='info' href='#IANARMC'>Section&nbsp;8.3<span> (</span><span class='info'>Message Codes</span><span>)</span></a> for
	the numeric message code for the new request.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Path_track Request</h3>

<p>The structure of the Path_track request is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  struct {

    Destination            destination;
    DiagnosticRequest      request;

  } PathTrackReq;
</pre></div>
<p>The fields of the PathTrackReq are as follows:
</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>destination : The destination which the requester is
	  interested in. This may be any valid destination object,
	  including a Node-ID, compressed ids, or Resource-ID.
</dd>
<dt></dt>
<dd>request : A DiagnosticsRequest, as discussed in
	  <a class='info' href='#DiagDataStruc'>Section&nbsp;5.1<span> (</span><span class='info'>Diagnostic Data Structures</span><span>)</span></a>.
</dd>
</dl></blockquote>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Path_track Response</h3>

<p>The structure of the Path_Track Response is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  struct {

    Destination             next_hop;
    DiagnosticResponse      response;

  } PathTrackAns;
</pre></div>
<p>The fields of the PathTrackAns are as follows:
</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>next_hop : The information of the next hop node from the
	  responding intermediate peer to the destination node. If the
	  responding peer is the responsible peer for the destination
	  ID, then the next_hop node ID equals the responding node ID,
	  and after that the initiator must stop the iterative
	  process.
</dd>
<dt></dt>
<dd>response : A DiagnosticsResponse, as discussed in
	  .
</dd>
</dl></blockquote>
<a name="sec_err_codes"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Error Codes</h3>

<p>This document extends the Error response method defined in
	the P2PSIP base protocol specification to describe the result
	of diagnostics. When an error is encountered in RELOAD, the
	Message Code 0xFFFF is returned. The ErrorResponse structure
	includes an error code, and we define new error codes to
	report on possible error conditions detected while performing
	diagnostics:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Code Value         Error Code Name
   101                Underlay Destination Unreachable
   102                Underlay Time exceeded
   103                Message Expired
   104                Upstream Misrouting
   105                Loop detected
   106                TTL hops exceeded
</pre></div>
<p>The final error codes will be assigned by IANA. as
	specified in section 13.7 of the <a class='info' href='#I-D.ietf-p2psip-base'>p2psip base protocol<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;p2psip&#8209;base].
</p>
<p>This document introduces several types of error information
	in the error_info field in the case of Code 101. These are
	represented as a text string of length 32, with the end padded
	with null characters.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   error_info:

   net unreachable
   host unreachable
   protocol unreachable
   port unreachable
   fragmentation needed
   source route failed
</pre></div>
<p>Editors note: We may need more discussion here to see if we
	need to define an additional sub-code field for the error
	information. Sub-codes are easier for the machine to process
	while various text is more human readable.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Message Processing</h3>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.1"></a><h3>5.5.1.&nbsp;
Message Creation and Transmission</h3>

<p>When constructing either a Ping message or with
	  diagnostic extensions or a Path_Track message, the sender
	  MUST create a DiagnosticRequest data structure. The sender
	  MUST set the expiration field of this structure in NTP
	  timestamp format. The value MUST be at least 10 seconds in
	  the future, and MUST NOT be more than 600 seconds in the
	  future. The timestampInitiated field MUST be set to the
	  current time in NTP timestamp format. The sender MUST
	  include the dMFlags field in the structure, and MAY send any
	  number (or all) of the flags to request the desired
	  diagnostic information. The sender MAY leave all the bits
	  unset, requesting no diagnostic information, but MUST
	  include the field. The sender MAY also include diagnostic
	  extensions for additional information. If the sender
	  includes any extensions, they MUST calculate the length of
	  these extensions and set the length field to the correct
	  length. If no extensions are included, the sender MUST set
	  length to zero.
</p>
<p>When constructing a diagnostic ping message, the sender
	  MUST create an MessageExtension structure as defined in
	  RELOAD 5.3.3. The value of type MUST be 0x0001. The value of
	  critical must be FALSE. The value of extension_contents MUST
	  be the DiagnosticRequest structure defined above. The sender
	  MUST place the MessageExtension structure in the extensions
	  field of the MessageContents structure. The message MAY be
	  directed to a particular NodeId or ResourceID, but SHOULD
	  NOT be sent to the broadcast NodeID.
</p>
<p>When constructing a Path_Track message, the sender MUST
	  set the message_code for the RELOAD MessageContents
	  structure for Path_track. The request field of the
	  PathTrackReq must be set to the DiagnosticRequest data
	  structure defined above. The destination field MUST be set
	  to the desired destination, which MAY be either a NodeId or
	  ResourceID but SHOULD NOT be the broadcast NodeID.
</p>
<a name="Message_Processing_Intermediate_Peers"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.2"></a><h3>5.5.2.&nbsp;
Message Processing: Intermediate Peers</h3>

<p>When a request arrives at a peer, if the peer's responsible ID
          space does not cover the destination ID of the request, then the
          peer MUST continue process this request according to the overlay
          specified routing mode from the base draft.
</p>
<p>In p2psip overlay, the error response can be generated by the
          intermediate peer or responsible peer, to a diagnostic message or
          other messages. When a request is received at a peer, the peer may
          find some connectivity failures or malfunction peers through the
          pre-defined rules of the overlay network, e.g. by analyzing via list
          or underlay error messages. The peer SHOULD report the error
          responses to the initiator node. The malfunction node information
          should also be reported to the initiator node in the error message
          payload. All error responses contain the Error code followed by the
          subcode and descriptions if existed.
</p>
<p>Each intermediate peer receiving a Ping message with
          extensions (and which understands the extension) or
          receiving a Path_Track request/response SHOULD check the
          expiration value (NTP format) to determine if the message
          expired. If the message expired, the intermediate peer
          SHOULD generate a message with Error Code 103 "Message
          Expired" and return it to the initiator node, and discard
          the message.
</p>
<p>The peer should return an Error response with the Error Code 101
          "Underlay Destination Unreachable" when it receives an ICMP message
          with "Destination Unreachable" information after forwarding the
          received request to the destination peer.
</p>
<p>The peer should return an Error response with the Error Code 102
          "Underlay Time Exceeded" when it receives an ICMP message with "Time
          Exceeded" information after forwarding the received request.
</p>
<p>The peer should return an Error response with Error Code 104
          "Upstream Misrouting" when it finds its upstream peer disobeys the
          routing rules defined in the overlay. The immediate upstream peer
          information should also be conveyed to the initiator node.
</p>
<p>The peer should return an Error response with Error Code 105
          "Loop detected" when it finds a loop through the analysis of via
          list.
</p>
<p>The peer should return an Error response with Error Code 106 "TTL
          hops exceeded" when it finds that the TTL field value is no more
          than 0 when forwarding.
</p>
<a name="Message_response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.3"></a><h3>5.5.3.&nbsp;
Message Response Creation</h3>

<p>When a diagnostic request message arrives at a peer, it
	  understands the extension (in the case of ping) or the new
	  request type path_track, and it is responsible for the
	  destination ID specified in the forwarding header, it MUST
	  follow the specifications defined in 5.1.3 of the base draft
	  to form the response header, and perform the following operations:
</p>
<p>The receiver MUST check the expiration value (NTP format)
          in the DiagnosticsRequest to determine if the message
          expired. If the message expired, the peer MUST generate a
          message with the Error Code 103 "Message Expired" and return
          it to the initiator node, and discard the message.
</p>
<p>If the message is not expired, the receiver MUST
	  construct a DiagnosticsResponse structure. The destination peer MUST copy the
          TTL value from the forwarding header to the hopCounter field of the DiagnosticsResponse
	  structure. Note that this value will represent 100-hops
	  unless overlay configuration has overridden the value. The receiver MUST generate an NTP
          format timestamp for the current time of day and place it in the
          timestampReceived field. The receiver MUST construct a new
	  expiration time and place it in the expiration field of the
	  DiagnosticResponse. This expiration MUST be at least 10
	  seconds in the future and MUST NOT be more than 600 seconds
	  in the future.
</p>
<p>The destination peer MUST check if the initiator node has
          the authority to get certain kinds of diagnostic
          information, and if appropriate, appends the diagnostic
          information requested in the dMFlags and
	  diagnostic_extensions (if any) in the diagnostic_info_list
	  field of the DiagnosticsResponse structure. If there is any
	  information returned, the receiver MUST calculate the length
	  of the response and set length appropriately. If there is no
	  diagnostic information returned, length MUST be set to zero.
</p>
<p>In the event of an error, an error response containing the error
          code followed by the subcode and description (if they exist) MUST be
          created and sent to the sender. If the requester asks for
	  diagnostic information that they are not authorized to
	  query, the receiving peer MUST return an Error response
          with the Error Code 1 "Error_Unauthorized".
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5.4"></a><h3>5.5.4.&nbsp;
Interpreting Results</h3>

<p>The initiator node, as well as the responding peer, MAY compute
          the overlay One-Way-Delay time through the value in
          timestampReceived and the timestampInitiated field. However, for a
          single hop measurement, the traditional measurement methods MUST be
          used instead of the overlay layer diagnostics methods.
</p>
<p>Editor note: We need more discussion and careful consideration on
          how to use the timestamp here because time synchronization is a
          barrier in open Internet environment, while in the operator's
          network, it may be less of a problem.
</p>
<p>The initiator node receiving the Inspect response MAY check the
          hopCounter field and compute the overlay hops to the destination
          peer for the statistics of connectivity quality from the perspective
          of overlay hops.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Examples</h3>

<p>Below, we sketch how these metrics can be used.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Example 1</h3>

<p>A peer may set EWMA_BYTES_SENT and WEMA_BYTES_RCVD flags in the
	PathTrackReq to its direct neighbors. A peer can use EWMA_BYTES_SENT
	and EWMA_BYTES_RCVD of another peer to infer whether it is acting as a
	media relay. It may then choose not to forward any requests for media
	relay to this peer. Similarly, among the various candidates for
	filling up routing table, a peer may prefer a peer with a large UPTIME
	value, small RTT, and small LAST_CONTACT value.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Example 2</h3>

<p>A peer may set the StatusInfo Flag in the PathTrackReq to a remote
	destination peer. The overlay has its own threshold definition for
	congestion. The peer can get knowledge of all the status information
	of the intermediate peers along the path. Then it can choose other
	paths to that node for the later requests.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Example 3</h3>

<p>A peer may use Inspect to evaluate the average overlay hops to
	other peers by sending InspectReq to a set of random resource or node
	IDs in the overlay. A peer may adjust its timeout value according to
	the change of average overlay hops.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>The authorization for diagnostics information must be designed with
      care to prevent it becoming a resort to retrieve information for bot
      attacks. It should also be careful that attackers can use diagnostics to
      analyze overlay information to attack certain key peers if there are. As
      this draft is a RELOAD extension, it follows RELOAD message header and
      routing specifications, the common security considerations described in
      the base draft <a class='info' href='#I-D.ietf-p2psip-base'>[I&#8209;D.ietf&#8209;p2psip&#8209;base]<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> are also
      applicable to this draft. Overlays may define their own
      requirements on who can collect/share diagnostic information.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<a name="IANADER"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Diagnostic Extension Types</h3>
<br /><hr class="insert" />
<a name="table_diagextcodes"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Diagnostic Extension Name</th><th align="center">Code</th><th align="center">Specification</th></tr>
<tr>
<td align="center">reserved (identifiers used for built in types)</td>
<td align="center">0 - 0x003F</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">local use (reserved)</td>
<td align="center">0xFFFE</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">reserved</td>
<td align="center">0xFFFF</td>
<td align="center">RFC-BBBB</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Diagnostic Extension Request Types&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="IANADKT"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Diagnostic Kind ID Types</h3>
<br /><hr class="insert" />
<a name="table_diagkindcodes"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Diagnostic Kind Type</th><th align="center">Code</th><th align="center">Specification</th></tr>
<tr>
<td align="center">reserved</td>
<td align="center">0x0000</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">STATUS_INFO</td>
<td align="center">0x0001</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">ROUTING_TABLE_SIZE</td>
<td align="center">0x0002</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">PROCESS_POWER</td>
<td align="center">0x0003</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">BANDWIDTH</td>
<td align="center">0x0004</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">SOFTWARE_VERSION</td>
<td align="center">0x0005</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">MACHINE_UPTIME</td>
<td align="center">0x0006</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">APP_UPTIME</td>
<td align="center">0x0007</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">MEMORY_FOOTPRINT</td>
<td align="center">0x0008</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">DATASIZE_STORED</td>
<td align="center">0x0009</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">INSTANCES_STORED</td>
<td align="center">0x000A</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">MESSAGES_SENT_RCVD</td>
<td align="center">0x000B</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">EWMA_BYTES_SENT</td>
<td align="center">0x000C</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">EWMA_BYTES_RCVD</td>
<td align="center">0x000D</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">UNDERLAY_HOP</td>
<td align="center">0x000E</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">BATTERY_STATUS</td>
<td align="center">0x000F</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">reserved</td>
<td align="center">0x003F</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">local use (reserved)</td>
<td align="center">0xFFFE</td>
<td align="center">RFC-BBBB</td>
</tr>
<tr>
<td align="center">reserved</td>
<td align="center">0xFFFF</td>
<td align="center">RFC-BBBB</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: Diagnostic Kind Types&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="IANARMC"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Message Codes</h3>

<p>This document introduces two new types of messages and
        their responses, requiring the following additions to the
        "RELOAD Message Code" Registry defined in <a class='info' href='#I-D.ietf-p2psip-base'>RELOAD<span> (</span><span class='info'>Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;REsource LOcation And Discovery (RELOAD) Base Protocol,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;p2psip&#8209;base]. These additions
        are:
</p><br /><hr class="insert" />
<a name="table_msgcodes"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Message Code Name</th><th align="center">Code Value</th><th align="center">RFC</th></tr>
<tr>
<td align="center">path_track_req</td>
<td align="center">101</td>
<td align="center">RFC-AAAA</td>
</tr>
<tr>
<td align="center">path_track_ans</td>
<td align="center">102</td>
<td align="center">RFC-AAAA</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: Extensions to RELOAD Message Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Note: Values starting at 101 were used to prevent
	  collisions with RELOAD base values. Once RELOAD moves to
	  RFC, these values may start at the next higher value after
	  the RELOAD base values. The final message code will be
	  assigned by IANA.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Error Code</h3>

<p>This document introduces the following new error codes, extending the "RELOAD
        Message Code" registry as described below:
</p><br /><hr class="insert" />
<a name="table_errcodes"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Message Code Name</th><th align="center">Code Value</th><th align="center">RFC</th></tr>
<tr>
<td align="center">Error_Underlay_Destination_Unreachable</td>
<td align="center">101</td>
<td align="center">RFC-AAAA</td>
</tr>
<tr>
<td align="center">Error_Underlay_Time_Exceeded</td>
<td align="center">102</td>
<td align="center">RFC-AAAA</td>
</tr>
<tr>
<td align="center">Error_Message_Expired</td>
<td align="center">103</td>
<td align="center">RFC-AAAA</td>
</tr>
<tr>
<td align="center">Error_Upstream_Misrouting</td>
<td align="center">104</td>
<td align="center">RFC-AAAA</td>
</tr>
<tr>
<td align="center">Error_Loop_Detected</td>
<td align="center">105</td>
<td align="center">RFC-AAAA</td>
</tr>
<tr>
<td align="center">Error_TTL_Hops_Exceeded</td>
<td align="center">106</td>
<td align="center">RFC-AAAA</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: Extensions to RELOAD Error Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Message Extension</h3>

<p>This document introduces the following new RELOAD extension
	code:
</p><br /><hr class="insert" />
<a name="table_extcodes"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Extension Name</th><th align="center">Code Value</th><th align="center">RFC</th></tr>
<tr>
<td align="center">Diagnostic_Ping</td>
<td align="center">0x0001</td>
<td align="center">RFC-AAAA</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 5: New RELOAD Extension Code&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="IANADFLG"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.6"></a><h3>8.6.&nbsp;
Diagnostics Flag</h3>

<p>IANA SHALL create a "RELOAD Diagnostics Flag" Registry. Entries in
        this registry are 1-bit flag contained in a 64-bits long integer
        dMFlags denoting diagnostic information to be retrieved as described
        in <a class='info' href='#Path_Track'>Section&nbsp;5.3<span> (</span><span class='info'>New Reqeust: Path_Track</span><span>)</span></a>. New entries SHALL be defined via
        <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> Standards Action. The initial contents
        of this registry are:</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 +-------------------------+------------------------------+--------+
 |  diagnostic information |diagnostic flag in dMFlags    | RFC    |
 |-------------------------+------------------------------+--------|
 |Reserved                 | 0x 0000 0000 0000 0000       |RFC-BBBB|
 |STATUS_INFO              | 0x 0000 0000 0000 0001       |RFC-BBBB|
 |ROUTING_TABLE_SIZE       | 0x 0000 0000 0000 0002       |RFC-BBBB|
 |PROCESS_POWER            | 0x 0000 0000 0000 0004       |RFC-BBBB|
 |BANDWIDTH                | 0x 0000 0000 0000 0008       |RFC-BBBB|
 |SOFTWARE_VERSION         | 0x 0000 0000 0000 0010       |RFC-BBBB|
 |MACHINE_UPTIME           | 0x 0000 0000 0000 0020       |RFC-BBBB|
 |APP_UPTIME               | 0x 0000 0000 0000 0040       |RFC-BBBB|
 |MEMORY_FOOTPRINT         | 0x 0000 0000 0000 0080       |RFC-BBBB|
 |DATASIZE_STORED          | 0x 0000 0000 0000 0100       |RFC-BBBB|
 |INSTANCES_STORED         | 0x 0000 0000 0000 0200       |RFC-BBBB|
 |MESSAGES_SENT_RCVD       | 0x 0000 0000 0000 0400       |RFC-BBBB|
 |EWMA_BYTES_SENT          | 0x 0000 0000 0000 0800       |RFC-BBBB|
 |EWMA_BYTES_RCVD          | 0x 0000 0000 0000 1000       |RFC-BBBB|
 |UNDERLAY_HOP             | 0x 0000 0000 0000 2000       |RFC-BBBB|
 |BATTERY_STATUS           | 0x 0000 0000 0000 4000       |RFC-BBBB|
 |Reserved                 | 0x FFFF FFFF FFFF FFFF       |RFC-BBBB|
 +-------------------------+------------------------------+--------+
</pre></div><p>

</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Open Questions</h3>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgments</h3>

<p>We would like to thank Zheng Hewen for the contribution of the
      initial version of this draft. We would also like to thank Bruce
      Lowekamp, Salman Baset, Henning Schulzrinne and Jiang Haifeng for the
      email discussion and their valued comments, and special thanks to Henry
      Sinnreich for contributing to the usage scenarios text. We would like to
      thank the authors of the p2psip base draft for transferring text about
      diagnostics to this document.
</p>
<p>The authors would also like to thank the many people of the IETF
      P2PSIP WG that have contributed to discussions and provided input
      invaluable in assembling this document.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Appendix: Changes to the Draft</h3>

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
Changes since -00 version</h3>

<ol class="text">
<li>Changed title from "Diagnose P2PSIP Overlay Network"
            to "P2PSIP Overlay Diagnostics".
</li>
<li>Changed the table of contents. Add a section about message
            processing and a section of examples.
</li>
<li>Merge diagnostics text from the p2psip base draft -01.
</li>
<li>Removed ECHO method for security reasons.
</li>
</ol>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2"></a><h3>11.2.&nbsp;
Changes since -01 version</h3>

<blockquote class="text">
<p>Added BATTERY_STATUS as diagnostic information.
</p>
<p>Removed UnderlayTTL test from the Inspect method, instead
	 adding an UNDERLAY_HOP diagnostic information for PathTrack
	 method.
</p>
<p>Give some examples for diagnostic information, and give
	 some editor's notes for further work.
</p>
</blockquote>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3"></a><h3>11.3.&nbsp;
Changes since -02 version</h3>

<blockquote class="text">
<p>Provided further explanation as to why the base draft Ping
	 in the current form cannot be used to replace Inspect, and
	 why some combination of methods cannot replace
	 Path_track.
</p>
</blockquote>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.4"></a><h3>11.4.&nbsp;
Changes since -03 version</h3>

<blockquote class="text">
<p>Modified structure used to share information collected.
	 Both mechanisms now use a common data structure to convey information.
</p>
</blockquote>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0792">[RFC0792]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc792">Internet Control Message Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;792, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc792.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-p2psip-sip">[I-D.ietf-p2psip-sip]</a></td>
<td class="author-text">Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-sip-04.txt">A SIP Usage for RELOAD</a>,&rdquo; draft-ietf-p2psip-sip-04 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-sip-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</a></td>
<td class="author-text">Jennings, C., Lowekamp, B., Rescorla, E., Baset, S., and H. Schulzrinne, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-base-08.txt">REsource LOcation And Discovery (RELOAD) Base Protocol</a>,&rdquo; draft-ietf-p2psip-base-08 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-base-08.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.zheng-p2psip-diagnose">[I-D.zheng-p2psip-diagnose]</a></td>
<td class="author-text">Yongchao, S. and X. Jiang, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-zheng-p2psip-diagnose-04.txt">Diagnose P2PSIP Overlay Network</a>,&rdquo; draft-zheng-p2psip-diagnose-04 (work in progress), December&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-zheng-p2psip-diagnose-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="Overlay-Failure-Detection">[Overlay-Failure-Detection]</a></td>
<td class="author-text">Zhuang, S., &ldquo;On failure detection algorithms in overlay networks,&rdquo; &nbsp;Proc. IEEE Infocomm, Mar&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="Handling_Churn_in_a_DHT">[Handling_Churn_in_a_DHT]</a></td>
<td class="author-text">Rhea, S., &ldquo;Handling Churn in a DHT,&rdquo; USENIX&nbsp;Annual Conference, June&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="Diagnostic_Framework">[Diagnostic_Framework]</a></td>
<td class="author-text">Jin, X., &ldquo;A Diagnostic Framework for Peer-to-Peer Streaming,&rdquo; 2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="Diagnostics_and_NAT_traversal_in_P2PP">[Diagnostics_and_NAT_traversal_in_P2PP]</a></td>
<td class="author-text">Gupta, G., &ldquo;Diagnostics and NAT Traversal in P2PP - Design and
          Implementation,&rdquo; Columbia University Report&nbsp;, June&nbsp;2008.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References </h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4330">[RFC4330]</a></td>
<td class="author-text">Mills, D., &ldquo;<a href="http://tools.ietf.org/html/rfc4330">Simple Network Time Protocol (SNTP) Version 4 for IPv4, IPv6 and OSI</a>,&rdquo; RFC&nbsp;4330, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4330.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4981">[RFC4981]</a></td>
<td class="author-text">Risson, J. and T. Moors, &ldquo;<a href="http://tools.ietf.org/html/rfc4981">Survey of Research towards Robust Peer-to-Peer Networks: Search Methods</a>,&rdquo; RFC&nbsp;4981, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4981.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-behave-rfc3489bis">[I-D.ietf-behave-rfc3489bis]</a></td>
<td class="author-text">Rosenberg, J., Mahy, R., Matthews, P., and D. Wing, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-rfc3489bis-18.txt">Session Traversal Utilities for (NAT) (STUN)</a>,&rdquo; draft-ietf-behave-rfc3489bis-18 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-rfc3489bis-18.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.matuszewski-p2psip-security-requirements">[I-D.matuszewski-p2psip-security-requirements]</a></td>
<td class="author-text">Yongchao, S., Matuszewski, M., and D. York, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-matuszewski-p2psip-security-requirements-06.txt">P2PSIP Security Overview and Risk Analysis</a>,&rdquo; draft-matuszewski-p2psip-security-requirements-06 (work in progress), September&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-matuszewski-p2psip-security-requirements-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.song-p2psip-security-eval">[I-D.song-p2psip-security-eval]</a></td>
<td class="author-text">Yongchao, S., Zhao, B., Jiang, X., and J. Haifeng, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-song-p2psip-security-eval-00.txt">P2PSIP Security Analysis and Evaluation</a>,&rdquo; draft-song-p2psip-security-eval-00 (work in progress), February&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-song-p2psip-security-eval-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.baset-p2psip-p2pp">[I-D.baset-p2psip-p2pp]</a></td>
<td class="author-text">Baset, S., Schulzrinne, H., and M. Matuszewski, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-baset-p2psip-p2pp-01.txt">Peer-to-Peer Protocol (P2PP)</a>,&rdquo; draft-baset-p2psip-p2pp-01 (work in progress), November&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-baset-p2psip-p2pp-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mmusic-ice">[I-D.ietf-mmusic-ice]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-19.txt">Interactive Connectivity Establishment (ICE): A Protocol for Network Address Translator (NAT) Traversal for Offer/Answer Protocols</a>,&rdquo; draft-ietf-mmusic-ice-19 (work in progress), October&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mmusic-ice-19.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.bryan-p2psip-app-scenarios">[I-D.bryan-p2psip-app-scenarios]</a></td>
<td class="author-text">Bryan, D., Shim, E., Lowekamp, B., and S. Dawkins, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-bryan-p2psip-app-scenarios-00.txt">Application Scenarios for Peer-to-Peer Session Initiation Protocol  (P2PSIP)</a>,&rdquo; draft-bryan-p2psip-app-scenarios-00 (work in progress), November&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-bryan-p2psip-app-scenarios-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.bryan-p2psip-requirements">[I-D.bryan-p2psip-requirements]</a></td>
<td class="author-text">Bryan, D., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-bryan-p2psip-requirements-00.txt">P2PSIP Protocol Framework and Requirements</a>,&rdquo; draft-bryan-p2psip-requirements-00 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-bryan-p2psip-requirements-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-p2psip-self-tuning">[I-D.ietf-p2psip-self-tuning]</a></td>
<td class="author-text">Maenpaa, J., Camarillo, G., and J. Hautakorpi, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-self-tuning-02.txt">A Self-tuning Distributed Hash Table (DHT) for REsource LOcation And Discovery (RELOAD)</a>,&rdquo; draft-ietf-p2psip-self-tuning-02 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-self-tuning-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-p2psip-concepts">[I-D.ietf-p2psip-concepts]</a></td>
<td class="author-text">Bryan, D., Matthews, P., Shim, E., Willis, D., and S. Dawkins, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-concepts-02.txt">Concepts and Terminology for Peer to Peer SIP</a>,&rdquo; draft-ietf-p2psip-concepts-02 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-p2psip-concepts-02.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Song Haibin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Baixia Road No. 91</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nanjing, Jiangsu Province  210001</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P.R.China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86-25-84565867</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+86-25-84565888</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:melodysong@huawei.com">melodysong@huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jiang Xingfeng</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Baixia Road No. 91</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nanjing, Jiangsu Province  210001</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P.R.China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86-25-84565868</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+86-25-84565888</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jiang.x.f@huawei.com">jiang.x.f@huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Roni Even</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">14 David Hamelech</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tel Aviv 64953</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Israel</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:even.roni@huawei.com">even.roni@huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">David A. Bryan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cogent Force, LLC / Huawei</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Williamsburg, Virginia</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">United States of America</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dbryan@ethernot.org">dbryan@ethernot.org</a></td></tr>
</table>
</body></html>
