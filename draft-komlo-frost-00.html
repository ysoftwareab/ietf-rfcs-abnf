<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>FROST: Flexible Round-Optimized Schnorr Threshold Signatures</title>
<meta content="Chelsea Komlo" name="author">
<meta content="Ian Goldberg" name="author">
<meta content="
       Unlike signatures in a single-party setting, threshold signatures
require cooperation among a threshold number of signers each holding a
share of a common private key. Consequently, generating signatures in a
threshold setting imposes overhead due to network rounds among signers,
proving costly when secret shares are stored on network-limited devices
or when coordination occurs over unreliable networks. This draft
describes FROST, a Flexible Round-Optimized Schnorr Threshold signature
scheme that reduces network overhead during signing operations while
employing a novel technique to protect against forgery attacks
applicable to similar schemes in the literature. FROST improves upon the
state of the art in Schnorr threshold signature protocols, as it can
safely perform signing operations in a single round without limiting
concurrency of signing operations, yet allows for true threshold
signing, as only a threshold number of participants are required for
signing operations. FROST can be used as either a two-round protocol
where signers send and receive two messages in total, or optimized to a
single-round signing protocol with a pre-processing stage. FROST
achieves its efficiency improvements in part by allowing the protocol to
abort in the presence of a misbehaving participant (who is then
identified and excluded from future operations)--a reasonable model for
practical deployment scenarios. 
    " name="description">
<meta content="xml2rfc 2.47.0" name="generator">
<meta content="draft-komlo-frost-00" name="ietf.draft">
<link href="/tmp/draft-komlo-frost-00-p8jrap6d.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">FROST</td>
<td class="right">August 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Komlo &amp; Goldberg</td>
<td class="center">Expires 8 February 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Crypto Forum Research Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-komlo-frost-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-08-07" class="published">7 August 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-02-08">8 February 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Komlo</div>
<div class="org">University of Waterloo, Zcash Foundation</div>
</div>
<div class="author">
      <div class="author-name">I. Goldberg</div>
<div class="org">University of Waterloo</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">FROST: Flexible Round-Optimized Schnorr Threshold Signatures</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Unlike signatures in a single-party setting, threshold signatures
require cooperation among a threshold number of signers each holding a
share of a common private key. Consequently, generating signatures in a
threshold setting imposes overhead due to network rounds among signers,
proving costly when secret shares are stored on network-limited devices
or when coordination occurs over unreliable networks. This draft
describes FROST, a Flexible Round-Optimized Schnorr Threshold signature
scheme that reduces network overhead during signing operations while
employing a novel technique to protect against forgery attacks
applicable to similar schemes in the literature. FROST improves upon the
state of the art in Schnorr threshold signature protocols, as it can
safely perform signing operations in a single round without limiting
concurrency of signing operations, yet allows for true threshold
signing, as only a threshold number of participants are required for
signing operations. FROST can be used as either a two-round protocol
where signers send and receive two messages in total, or optimized to a
single-round signing protocol with a pre-processing stage. FROST
achieves its efficiency improvements in part by allowing the protocol to
abort in the presence of a misbehaving participant (who is then
identified and excluded from future operations)--a reasonable model for
practical deployment scenarios.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 February 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-background" class="xref">Background</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-threshold-schemes" class="xref">Threshold Schemes</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-threshold-signature-schemes" class="xref">Threshold Signature Schemes</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-distributed-key-generation" class="xref">Distributed Key Generation</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-schnorr-signatures" class="xref">Schnorr Signatures</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-additive-secret-sharing" class="xref">Additive Secret Sharing</a><a href="#section-toc.1-1.2.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-attacks-on-parallelized-sch" class="xref">Attacks on Parallelized Schnorr Multisignatures</a><a href="#section-toc.1-1.2.2.6.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-preliminaries" class="xref">Preliminaries</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-frost-flexible-round-optimi" class="xref">FROST: Flexible Round-Optimized Schnorr Threshold Signatures</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-key-generation" class="xref">Key Generation</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-threshold-signing-with-unre" class="xref">Threshold Signing with Unrestricted Parallelism</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-proof-of-security-propertie" class="xref">Proof of Security Properties</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-aborting-on-misbehaviour" class="xref">Aborting on Misbehaviour</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-operational-considerations" class="xref">Operational Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty compact">
<li class="toc ulEmpty compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-publishing-commitments-to-a" class="xref">Publishing Commitments to a Commitment Server</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-adaptively-choosing-the-set" class="xref">Adaptively Choosing the Set of Signing Participants</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Threshold signature schemes are a cryptographic primitive to facilitate
joint ownership over a private key by a set of participants, such that a
threshold number of participants must cooperate to issue a signature
that can be verified by a single public key. Threshold signatures are
useful across a range of settings that require a distributed root of
trust among a set of equally trusted parties.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Similarly to signing operations in a single-party setting, some
implementations of threshold signature schemes require performing
signing operations at scale and under heavy load. For example, threshold
signatures can be used by a set of signers to authenticate financial
transactions in cryptocurrencies <span>[<a href="#GGK_15" class="xref">GGK_15</a>]</span>, or to sign a
network consensus produced by a set of trusted authorities <span>[<a href="#MOT_11" class="xref">MOT_11</a>]</span>.
In both of these examples, as the number of signing parties or signing
operations increases, the number of communication rounds between
participants required to produce the joint signature becomes a
performance bottleneck, in addition to the increased load experienced by
each signer. This problem is further exacerbated when signers utilize
network-limited devices or unreliable networks for transmission, or
protocols that wish to allow signers to participate in signing
operations asynchronously. As such, optimizing the network overhead of
signing operations is highly beneficial to real-world applications of
threshold signatures.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Today in the literature, the best threshold signature schemes are those
that rely on pairing-based
cryptography <span>[<a href="#BLS04" class="xref">BLS04</a>]</span> <span>[<a href="#BDN18" class="xref">BDN18</a>]</span>, and can
perform signing operations in a single round among participants.
However, relying on pairing-based signature schemes is undesirable for
some implementations in practice, such as those that do not wish to
introduce a new cryptographic assumption, or that wish to maintain
backwards compatibility with an existing signature scheme such as
Schnorr signatures. Surprisingly, today's best non-pairing-based
threshold signature constructions that produce Schnorr signatures with
unlimited concurrency <span>[<a href="#SS01" class="xref">SS01</a>]</span> <span>[<a href="#GJKR03" class="xref">GJKR03</a>]</span>
require at least three rounds of communication during signing
operations, whereas constructions with fewer network
rounds <span>[<a href="#GJKR03" class="xref">GJKR03</a>]</span> must limit signing concurrency to
protect against a forgery attack <span>[<a href="#DEF_19" class="xref">DEF_19</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This draft describes FROST, a Flexible Round-Optimized Schnorr Threshold
signature scheme that addresses the need for efficient threshold signing
operations while improving upon the state of the art to ensure strong
security properties <em>without</em> limiting the parallelism of signing
operations. (Signatures generated using the FROST protocol can also be
referred to as "FROSTy signatures".) FROST can be used as either a
two-round protocol where signers send and receive two messages in total,
or optimized to a (non-broadcast) single-round signing protocol with a
pre-processing stage. FROST achieves improved efficiency in the
optimistic case that no participant misbehaves. However, in the case
where a misbehaving participant contributes malformed values during the
protocol, honest parties can identify and exclude the misbehaving
participant, and re-run the protocol.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The flexible design of FROST lends itself to supporting a number of
practical use cases for threshold signing. Because the preprocessing
round can be performed separately from the signing round, signing
operations can be performed <em>asynchronously</em>; once the preprocessing
round is complete, signers only need to receive and eventually reply
with a single message to create a signature. Further, while some
threshold schemes in the literature require all participants to be
active during signing
operations <span>[<a href="#GJKR03" class="xref">GJKR03</a>]</span> <span>[<a href="#DJN_20" class="xref">DJN_20</a>]</span>, and
refer to the threshold property of the protocol as merely a security
property, FROST allows any threshold number of participants to produce
valid signatures. Consequently, FROST can support use cases where a
subset of participants (or participating devices) can remain offline, a
property that is often desirable for security in practice.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6"><strong>Organization.</strong> We describe background information important to
understanding FROST in <a href="#background" class="xref">Section 2</a>, and in
<a href="#preliminaries" class="xref">Section 3</a> we review notation and security assumptions.
<a href="#protocol" class="xref">Section 4</a> describes the FROST protocol, and
<a href="#security-considerations-cfrg" class="xref">Section 5</a> reviews security considerations
for FROST. In <a href="#discussion" class="xref">Section 6</a> we describe implementation
considerations.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="background">
<section id="section-2">
      <h2 id="name-background">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<div id="background_threshold-schemes">
<section id="section-2.1">
        <h3 id="name-threshold-schemes">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-threshold-schemes" class="section-name selfRef">Threshold Schemes</a>
        </h3>
<p id="section-2.1-1">Cryptographic protocols called <em>(t,n)-threshold schemes</em> allow a set
of n participants to share a secret s, such that any t out of the
n participants are required to cooperate in order to recover s, but
any subset of fewer than t participants cannot recover any information
about the secret.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2"><strong>Shamir Secret Sharing.</strong> Many threshold schemes build upon Shamir
secret sharing <span>[<a href="#Sha79" class="xref">Sha79</a>]</span>, a (t,n)-threshold scheme that
relies on Lagrange interpolation to recover a secret. In Shamir secret
sharing, a trusted central dealer distributes a secret s to n
participants in such a way that any cooperating subset of t
participants can recover the secret. To distribute this secret, the
dealer first selects t-1 coefficients a<sub>1</sub>, ..., a<sub>t-1</sub> at random,
and uses the randomly selected values as coefficients to define a
polynomial f(x) = s + SUM(a<sub>i</sub> x<sup>i</sup>, i=1...t-1) of degree t-1 where
f(0) = s. The secret shares for each participant P<sub>i</sub> are
subsequently (i, f(i)), which the dealer is trusted to distribute
honestly to each participant P<sub>1</sub>, ..., P<sub>n</sub>. To reconstruct the
secret, at least t participants perform Lagrange interpolation to
reconstruct the polynomial and thus find the value s=f(0). However, no
group of fewer than t participants can reconstruct the secret, as at
least t points are required to reconstruct a polynomial of degree
t-1.<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3"><strong>Verifiable Secret Sharing.</strong> Feldman's Verifiable Secret Sharing (VSS)
Scheme <span>[<a href="#Fel87" class="xref">Fel87</a>]</span> builds upon Shamir secret sharing, adding a
verification step to demonstrate the consistency of a participant's
share with a public <em>commitment</em> that is assumed to be correctly visible
to all participants. To validate that a share is well formed, each
participant validates their share using this commitment. If the
validation fails, the participant can issue a <em>complaint</em> against the
dealer, and take actions such as broadcasting this complaint to all
other participants. FROST similarly uses this technique as well.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The commitment produced in Feldman's scheme is as follows. As before in
Shamir secret sharing, a dealer samples t-1 random values
(a<sub>1</sub>, ..., a<sub>t-1</sub>), and uses these values as coefficients to define a polynomial
f<sub>i</sub> of degree t-1 such that f(0) = s. However, along with
distributing the private share (i, f(i)) to each participant P<sub>i</sub>,
the dealer also distributes the public commitment<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">C = &lt; A<sub>0</sub>, ..., A<sub>t-1</sub> &gt;, where A<sub>0</sub> = g<sup>s</sup> and
A<sub>j</sub> = g^{a<sub>j</sub>}<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">Note that in a distributed setting, each participant P<sub>i</sub> must be sure
to have the same view of C as all other participants. In
practice, implementations guarantee consistency of participants' views
by using techniques such as posting commitments to a centralized server
that is trusted to provide a single view to all participants, or adding
another protocol round where participants compare their received
commitment values to ensure they are identical.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="threshold-signature-schemes">
<section id="section-2.2">
        <h3 id="name-threshold-signature-schemes">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-threshold-signature-schemes" class="section-name selfRef">Threshold Signature Schemes</a>
        </h3>
<p id="section-2.2-1">Threshold signature schemes leverage the (t,n) security properties of
threshold schemes, but allow participants to produce signatures over a
message using their secret shares such that anyone can validate the
integrity of the message, <em>without</em> ever reconstructing the secret. In
threshold signature schemes, the secret key s is distributed among the
n participants, while a single public key Y is used to represent the
group. Signatures can be generated by a threshold of t cooperating
signers.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">For our work, we require the resulting signature produced by the
threshold signature scheme to be valid under the Schnorr signature
scheme <span>[<a href="#Sch89" class="xref">Sch89</a>]</span>. We introduce Schnorr signatures in
<a href="#schnorr-signature" class="xref">Section 2.4</a>.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">Because threshold signature schemes ensure that no participant (or
indeed any group of fewer than t participants) ever learns the secret
key s, the generation of s and distribution of shares
s<sub>1</sub>, ..., s<sub>n</sub> often require generating shares using a less-trusted
method than relying on a central dealer. Instead, these schemes
(including FROST) make use of a Distributed Key Generation (DKG)
protocol, which we describe next.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="background_distributed-keygen">
<section id="section-2.3">
        <h3 id="name-distributed-key-generation">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-distributed-key-generation" class="section-name selfRef">Distributed Key Generation</a>
        </h3>
<p id="section-2.3-1">While some threshold schemes such as Shamir secret sharing rely on a
trusted dealer to generate and distribute secret shares to all
participants, not all threat models can allow for such a high degree of
trust in a single individual. Distributed Key Generation (DKG) supports
such threat models by enabling every participant to contribute equally
to the generation of the shared secret. At the end of running the
protocol, all participants share a joint public key Y, but each
participant holds only a share s<sub>i</sub> of the corresponding secret s
such that no set of participants smaller than the threshold knows s.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">FROST can use either Pedersen's DKG <span>[<a href="#Ped91" class="xref">Ped91</a>]</span> or Gennaro's
DKG <span>[<a href="#GJKR07" class="xref">GJKR07</a>]</span> to generate the shared long-lived secret key
among participants during its key generation stage.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="schnorr-signature">
<section id="section-2.4">
        <h3 id="name-schnorr-signatures">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-schnorr-signatures" class="section-name selfRef">Schnorr Signatures</a>
        </h3>
<p id="section-2.4-1">Often, it is desirable for signatures produced by threshold signing
operations to be indistinguishable from signatures produced by a single
participant, consequently remaining backwards compatible with existing
systems, and also preventing a privacy leak of the identities of the
individual signers. For our work, we require signatures produced by
FROST signing operations to be indistinguishable from Schnorr
signatures, and thus verifiable using the standard Schnorr verification
operations. To this end, we now describe Schnorr signing and
verification operations <span>[<a href="#Sch89" class="xref">Sch89</a>]</span> in a single-signer
setting.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">Let G be a group with prime order q and generator g, and
let H be a cryptographic hash function mapping to Z<sub>q</sub><sup>*</sup>. A
Schnorr signature is generated over a message m by the following
steps:<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4-3">
          <li id="section-2.4-3.1">Sample a random nonce k &lt;-$- Z<sub>q</sub>;
compute the commitment R = g<sup>k</sup> in G<a href="#section-2.4-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-3.2">Compute the challenge c = H(m,R)<a href="#section-2.4-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-3.3">Using the secret key s, compute the response z = k + s * c in Z<sub>q</sub><a href="#section-2.4-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-3.4">Define the signature over m to be SIG = (z, c)<a href="#section-2.4-3.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.4-4">Validating the integrity of m using the public key Y=g<sup>s</sup> and the
signature SIG is performed as follows:<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.4-5">
          <li id="section-2.4-5.1">Parse SIG as (z, c).<a href="#section-2.4-5.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-5.2">Compute R' = g<sup>z</sup> * Y<sup>-c</sup><a href="#section-2.4-5.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-5.3">Compute c' = H(m, R')<a href="#section-2.4-5.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.4-5.4">Output 1 if c = c' to indicate success; otherwise, output 0.<a href="#section-2.4-5.4" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.4-6">Schnorr signatures are simply the standard Sigma-protocol proof of
knowledge of the discrete logarithm of Y, made non-interactive (and
bound to the message m) with the Fiat-Shamir transform.<a href="#section-2.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="background_additive">
<section id="section-2.5">
        <h3 id="name-additive-secret-sharing">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-additive-secret-sharing" class="section-name selfRef">Additive Secret Sharing</a>
        </h3>
<p id="section-2.5-1">Similarly to the single-party setting described above, FROST requires
generating a random nonce k for each signing operation. However, in
the threshold setting, k should be generated in such a way that each
participant <em>contributes to</em> but <em>does not know</em> the resulting k
(properties that performing a DKG as described in
<a href="#background_distributed-keygen" class="xref">Section 2.3</a> also achieve). Key to the
design of FROST is the observation that while an arbitrary t out of
n entities are required to participate in a signing operation, a
simpler t-out-of-t scheme will suffice to generate the random nonce
k.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">While Shamir secret sharing and derived constructions require shares to
be points on a secret polynomial f where f(0)=s, an <em>additive secret
sharing scheme</em> allows t participants to jointly compute a shared
secret s by each participant P<sub>i</sub> contributing a value s<sub>i</sub> such
that the resulting shared secret is s=SUM(s<sub>i</sub>, i=1...t), the summation
of each participant's share. Consequently, this t-out-of-t secret
sharing can be performed non-interactively; each participant directly
chooses their own s<sub>i</sub>.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<p id="section-2.5-3">Benaloh and Leichter <span>[<a href="#BL88" class="xref">BL88</a>]</span> generalize this scheme to arbitrary
monotone access structures, and Cramer, Damgaerd, and
Ishai <span>[<a href="#CDI05" class="xref">CDI05</a>]</span> present a <em>non-interactive</em>
mechanism for participants to locally convert additive shares generated
via the Benaloh and Leichter t-out-of-n additive secret sharing
construction to polynomial (Shamir) form. In our work, we use the
simplest t-out-of-t case of this transformation, in which, if s<sub>i</sub>
are <em>additive</em> secret shares of s, so that s is the sum of the
s<sub>i</sub>, then (s<sub>i</sub>)/(L<sub>i</sub>) are <em>Shamir</em> secret shares of the
same s, where the L<sub>i</sub> are Lagrange coefficients.<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<p id="section-2.5-4">In FROST, participants use this technique during signing operations to
non-interactively generate a one-time secret nonce (as is required by
Schnorr signatures, described in <a href="#schnorr-signature" class="xref">Section 2.4</a>) that is
Shamir secret shared among all t signing participants.<a href="#section-2.5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="schnorr-attacks">
<section id="section-2.6">
        <h3 id="name-attacks-on-parallelized-sch">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-attacks-on-parallelized-sch" class="section-name selfRef">Attacks on Parallelized Schnorr Multisignatures</a>
        </h3>
<p id="section-2.6-1"><strong>Attack via Wagner's Algorithm.</strong> We next describe an attack recently
introduced by Drijvers et al. <span>[<a href="#DEF_19" class="xref">DEF_19</a>]</span> against some two-round
Schnorr multisignature schemes and describe how this attack applies to a
threshold setting. This attack can be performed when the adversary has
control over either choosing the message m to be signed, or the
ability to adaptively choose its own individual commitments used to
determine the group commitment R after seeing commitments from all
other signing parties.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">Successfully performing the Drijvers attack requires finding a hash
output c<sup>*</sup> = H(m<sup>*</sup>, R<sup>*</sup>) that is the sum of T other hash outputs
c<sup>*</sup> = SUM(H(m<sub>j</sub>, R<sub>j</sub>), j=1...T) (where c<sup>*</sup> is the challenge, m<sub>j</sub>
the message, and R<sub>j</sub> the commitment corresponding to a standard
Schnorr signature as described in <a href="#schnorr-signature" class="xref">Section 2.4</a>). To
find T hash outputs that sum to c<sup>*</sup>, the adversary can open many
(say T number of) parallel simultaneous signing operations, varying in
each of the T parallel executions either its individual commitment
used to determine R<sub>j</sub> or the message being signed m<sub>j</sub>. Drijvers et
al. use the k-tree algorithm of Wagner <span>[<a href="#Wag02" class="xref">Wag02</a>]</span> to find such
hashes and perform the attack in time
O(K * b * 2<sup>b/(1+lg K)</sup>), where K = T + 1,
and b is the bitlength of the order of the group.<a href="#section-2.6-2" class="pilcrow">¶</a></p>
<p id="section-2.6-3">Although this attack was proposed in a multisignature n-out-of-n
setting, this attack applies similarly in a threshold t-out-of-n
setting with the same parameters for an adversary that controls up to
t-1 participants. We note that the threshold scheme instantiated using
Pedersen's DKG by Gennaro et al. <span>[<a href="#GJKR03" class="xref">GJKR03</a>]</span> is
likewise affected by this technique and so similarly has an upper bound
to the amount of parallelism that can be safely allowed.<a href="#section-2.6-3" class="pilcrow">¶</a></p>
<p id="section-2.6-4">In <a href="#frost-signing" class="xref">Section 4.2</a> we discuss how FROST avoids the attack by
ensuring that an attacker will not gain an advantage by adaptively
choosing its own commitment (or that of any other of the signing
participants) used to determine R<sub>j</sub>, or adaptively selecting the
message being signed.<a href="#section-2.6-4" class="pilcrow">¶</a></p>
<p id="section-2.6-5">Drijvers et al. <span>[<a href="#DEF_19" class="xref">DEF_19</a>]</span> also present a metareduction for the
proofs of several Schnorr multisignature schemes in the literature that
use a generalization of the forking lemma with rewinding, proving that
the security demonstrated in a single-party setting does not extend when
applying this proof technique to a multi-party setting.<a href="#section-2.6-5" class="pilcrow">¶</a></p>
<p id="section-2.6-6"><strong>Attack via ROS Solver.</strong> Benhamouda et al. <span>[<a href="#BLOR20" class="xref">BLOR20</a>]</span> recently
present an efficient algorithm solving the ROS (Random inhomogeneities
in a Overdetermined Solvable system of linear equations) problem. The
authors demonstrate that threshold schemes using Gennaro et al.'s
DKG <span>[<a href="#GJKR07" class="xref">GJKR07</a>]</span> and multisignature schemes such as two-round
MuSig <span>[<a href="#MPSW19" class="xref">MPSW19</a>]</span> are not secure against their ROS-solving
algorithm. However, the authors conclude that (the current version of)
FROST is not affected by their ROS-solving algorithm.<a href="#section-2.6-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="preliminaries">
<section id="section-3">
      <h2 id="name-preliminaries">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-preliminaries" class="section-name selfRef">Preliminaries</a>
      </h2>
<p id="section-3-1">Let G be a group of prime order q in which the Decisional
Diffie-Hellman problem is hard, and let g be a generator of
G. Let H be a cryptographic hash function mapping to
Z<sub>q</sub><sup>*</sup>. We denote by x &lt;-$- S that x
is uniformly randomly selected from S.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">Let n be the number of participants in the signature scheme, and t
denote the threshold of the secret-sharing scheme. Let i denote the
<em>participant identifier</em> for participant P<sub>i</sub> where 1 &lt;= i &lt;= n.
Let s<sub>i</sub> be the long-lived secret share for participant P<sub>i</sub>. Let Y
denote the long-lived public key shared by all participants in the
threshold signature scheme, and let Y<sub>i</sub> = g^{s<sub>i</sub>} be the public key
share for the participant P<sub>i</sub>. Finally, let m be the message to be
signed.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">For a fixed set S = {p<sub>1</sub>,...,p<sub>t</sub>} of t participant identifiers
in the signing operation, let
L<sub>i</sub> = PROD( (p<sub>j</sub>)/(p<sub>j</sub> - p<sub>i</sub>), j=1...t, j != i) denote
the ith Lagrange coefficient for interpolating over S. Note that
the information to derive these values depends on which t (out of n)
participants are selected, and uses only the participant <em>identifiers</em>,
and not their <em>shares</em>. (Note that if n is small, the L<sub>i</sub> for
every possible S can be precomputed by each participant during the key
generation phase of the protocol as a performance optimization to avoid
re-computing these values for each signing operation.)<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4"><strong>Security Assumptions.</strong> We maintain the following assumptions, which
implementations need to account for in practice.<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-5.1">
          <em>Message Validation.</em> We assume every participant checks the
validity of the message m to be signed before issuing its
signature share. If the message is invalid, the participant should
take actions to discard the message and report the misbehaviour to
other participants.<a href="#section-3-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-5.2">
          <em>Reliable Message Delivery.</em> We assume messages are sent between
participants using a reliable network channel.<a href="#section-3-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-5.3">
          <em>Participant Identification.</em> In order to report misbehaving
participants, we require that values submitted by participants to be
identifiable within the signing group. Our protocols assume
participants are not forging messages by other participants, but
implementations can enforce this using a method of participant
authentication within the signing group. (For example,
authentication tokens or TLS certificates could serve to
authenticate participants to one another.)<a href="#section-3-5.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="protocol">
<section id="section-4">
      <h2 id="name-frost-flexible-round-optimi">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-frost-flexible-round-optimi" class="section-name selfRef">FROST: Flexible Round-Optimized Schnorr Threshold Signatures</a>
      </h2>
<p id="section-4-1">We now describe the FROST protocol, a Flexible Round-Optimized Schnorr
Threshold signature scheme that minimizes the network overhead of
producing Schnorr signatures in a threshold setting while allowing for
unrestricted parallelism of signing operations and only a threshold
number of signing participants.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2"><strong>Efficiency over Robustness.</strong> Prior threshold signature
constructions <span>[<a href="#SS01" class="xref">SS01</a>]</span> <span>[<a href="#GJKR03" class="xref">GJKR03</a>]</span> provide
the property of <em>robustness</em>; if one participant misbehaves and provides
malformed shares, the remaining honest participants can detect the
misbehaviour, exclude the misbehaving participant, and complete the
protocol, so long as the number of remaining honest participants is at
least the threshold t. This kind of robust construction is appropriate
in settings where signing participants might be arbitrary entities from
the Internet, for example.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">However, in settings where one can expect misbehaving participants to be
rare, threshold signing protocols can be relaxed to be more efficient in
the "optimistic" case that all participants honestly follow the
protocol. In the case that a participant does misbehave, honest
participants can identify the misbehaving participant and abort the
protocol. The honest participants can then simply re-run the protocol
amongst themselves, excluding the misbehaving participant. Consequently,
FROST trades off robustness in the protocol for improved efficiency in
this way.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4"><strong>Signature Aggregator Role.</strong> We instantiate FROST using a semi-trusted
<em>signature aggregator</em> role, denoted as SA. Such a role is
often practical in a real-world setting; we include this role as it also
allows for improved efficiency. However, FROST can be instantiated
without a signature aggregator. To do so, each participant simply
performs a broadcast in place of SA performing
coordination.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">The signature aggregator role can be performed by <em>any</em> participant in
the protocol, or even an external party, provided they know the
participants' public-key shares Y<sub>i</sub>. SA is trusted to
report misbehaving participants (we assume participants can authenticate
themselves to one another, as discussed in <a href="#preliminaries" class="xref">Section 3</a>)
and to publish the group's signature at the end of the protocol. If
SA deviates from the protocol, the protocol remains secure
against adaptive chosen message attacks, as SA is not
given any more of a privileged view than the adversary we model. A
malicious SA does have the power to perform
denial-of-service attacks and to falsely report misbehaviour by
participants, but <em>cannot</em> learn the private key or cause improper
messages to be signed. Note this signature aggregator role is also used
in prior threshold signature constructions in the
literature <span>[<a href="#GJKR03" class="xref">GJKR03</a>]</span> as an optimization.<a href="#section-4-5" class="pilcrow">¶</a></p>
<div id="protocol-keygen">
<section id="section-4.1">
        <h3 id="name-key-generation">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-key-generation" class="section-name selfRef">Key Generation</a>
        </h3>
<p id="section-4.1-1"><strong>FROST KeyGen</strong><a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2"><strong>Round 1</strong><a href="#section-4.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-3">
          <dt id="section-4.1-3.1">1.</dt>
          <dd id="section-4.1-3.2">
  Every participant P<sub>i</sub> samples t random values
(a<sub>i0</sub>, ..., a<sub>i(t-1))</sub>) &lt;-$- Z<sub>q</sub>,
and uses these values as coefficients to define a polynomial
f<sub>i</sub>(x) = SUM(a<sub>ij</sub> x<sup>j</sup>, j=0...t-1) of degree t-1 over
Z<sub>q</sub>.<a href="#section-4.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.3">2.</dt>
          <dd id="section-4.1-3.4">
  Every P<sub>i</sub> computes a proof of knowledge to the corresponding
secret a<sub>i0</sub> by calculating a Schnorr signature
SIG<sub>i</sub> = (w<sub>i</sub>, c<sub>i</sub>) using a<sub>i0</sub> as the secret key, such
that k &lt;-$- Z<sub>q</sub>, R<sub>i</sub> = g<sup>k</sup>,
c<sub>i</sub> = H(i, CTX, g^{a<sub>i0</sub>}, R<sub>i</sub>), w<sub>i</sub> = k + a<sub>i0</sub>* c<sub>i</sub>,
with CTX being a context string to prevent replay attacks.<a href="#section-4.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.5">3.</dt>
          <dd id="section-4.1-3.6">
  Every participant P<sub>i</sub> computes a public commitment
C<sub>i</sub> = &lt; A<sub>i0</sub>, ..., A<sub>i(t-1)</sub> &gt;, where
A<sub>ij</sub> = g^{a<sub>ij</sub>}, 0 &lt;= j &lt;= t-1<a href="#section-4.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.7">4.</dt>
          <dd id="section-4.1-3.8">
  Every P<sub>i</sub> broadcasts C<sub>i</sub>, SIG<sub>i</sub> to all other
participants.<a href="#section-4.1-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-3.9">5.</dt>
          <dd id="section-4.1-3.10">
  Upon receiving C<sub>p</sub>, SIG<sub>p</sub> from participants
1 &lt;= p &lt;= n, p != i, participant P<sub>i</sub> verifies
SIG<sub>p</sub> = (w<sub>p</sub>, c<sub>p</sub>), aborting on failure, by
checking:
c<sub>p</sub> =?= H(p, CTX, A<sub>p0</sub>, g^{w<sub>p</sub>} * A<sub>p0</sub>^{-c<sub>p</sub>})<a href="#section-4.1-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-4"><strong>Round 2</strong><a href="#section-4.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.1-5">
          <dt id="section-4.1-5.1">1.</dt>
          <dd id="section-4.1-5.2">
  Each P<sub>i</sub> securely sends to each other participant P<sub>p</sub> a
secret share (p, f<sub>i</sub>(p)), and keeps (i, f<sub>i</sub>(i)) for
themselves.<a href="#section-4.1-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.3">2.</dt>
          <dd id="section-4.1-5.4">
  Each P<sub>i</sub> verifies their shares by calculating:
g^{f<sub>p</sub>(i)} =?= PROD(A<sub>pk</sub><sup>(i^k mod q)</sup>,k=0...t-1), aborting if the check fails.<a href="#section-4.1-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.5">3.</dt>
          <dd id="section-4.1-5.6">
  Each P<sub>i</sub> calculates their long-lived private signing share by
computing s<sub>i</sub> = SUM(f<sub>p</sub>(i), p=1...n), and stores s<sub>i</sub>
securely.<a href="#section-4.1-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.1-5.7">4.</dt>
          <dd id="section-4.1-5.8">
  Each P<sub>i</sub> calculates their public verification share
Y<sub>i</sub> = g^{s<sub>i</sub>}, and the group's public key
Y = PROD(A<sub>j0</sub>, j=1...n). Any participant can compute the
public verification share of any other participant by calculating
Y<sub>i</sub> = PROD( (A<sub>jk</sub>)<sup>(i^k mod q</sup>), j=1...n, k=0...t-1)<a href="#section-4.1-5.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.1-6">To generate long-lived key shares in our scheme's key generation
protocol, FROST builds upon Pedersen's DKG for key generation; we detail
these protocol steps in the above algorithm. Note that Pedersen's DKG is
simply where each participant executes Feldman's VSS as the dealer in
parallel, and derives their secret share as the sum of the shares
received from each of the n VSS executions. In addition to the base
Pedersen DKG protocol, FROST additionally requires each participant to
demonstrate knowledge of their secret a<sub>i0</sub> by providing other
participants with proof in zero knowledge, instantiated as a Schnorr
signature, to protect against rogue-key attacks <span>[<a href="#BBS03" class="xref">BBS03</a>]</span> in the
setting where t &gt;= n/2.<a href="#section-4.1-6" class="pilcrow">¶</a></p>
<p id="section-4.1-7">To begin the key generation protocol, a set of participants must be
formed using some out-of-band mechanism decided upon by the
implementation. After participating in the Ped-DKG protocol, each
participant P<sub>i</sub> holds a value (i, s<sub>i</sub>) that is their long-lived
secret signing share. Participant P<sub>i</sub>'s public key share
Y<sub>i</sub> = g^{s<sub>i</sub>} is used by other participants to verify the correctness
of P<sub>i</sub>'s signature shares in the following signing phase, while the
group public key Y can be used by parties external to the group to
verify signatures issued by the group in the future.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8"><strong>View of Commitment Values.</strong> As required for <em>any</em> multi-party
protocol using Feldman's VSS, the key generation stage in FROST
similarly requires participants to maintain a consistent view of
commitments C<sub>i</sub>, 1 &lt;= i &lt;= n issued during the execution of
Ped-DKG. In this work, we assume participants broadcast the commitment
values honestly (e.g., participants do not provide different commitment
values to a subset of participants); recall
<a href="#background_threshold-schemes" class="xref">Section 2.1</a> where we described techniques
to achieve this guarantee in practice.<a href="#section-4.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1-9"><strong>Security tradeoffs.</strong> While Gennaro et al. <span>[<a href="#GJKR07" class="xref">GJKR07</a>]</span>
describe the "Stop, Kill, and Rewind" variant of Ped-DKG (where the
protocol terminates and is re-run if misbehaviour is detected) as
vulnerable to influence by the adversary, we note that in a real-world
setting, good security practices typically require that the cause of
misbehaviour is investigated once it has been detected; the protocol is
not allowed to terminate and re-run continuously until the adversary
finds a desirable output. Further, many protocols in practice do not
prevent an adversary from aborting and re-executing key agreement at any
point in the protocol; adversaries in protocols such as the widely used
TLS protocol can skew the distribution of the resulting key simply by
re-running the protocol.<a href="#section-4.1-9" class="pilcrow">¶</a></p>
<p id="section-4.1-10">However, implementations wishing for a robust DKG can adapt our key
generation protocol to the robust construction presented by Gennaro et
al. <span>[<a href="#GJKR07" class="xref">GJKR07</a>]</span>. Note that the efficiency of the DKG for the
key generation phase is not extremely critical, because this operation
must be done only <em>once per key generation</em> for long-lived keys. For the
per-signature operations, FROST optimizes the generation of random
values <em>without</em> utilizing a DKG, as discussed next.<a href="#section-4.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="frost-signing">
<section id="section-4.2">
        <h3 id="name-threshold-signing-with-unre">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-threshold-signing-with-unre" class="section-name selfRef">Threshold Signing with Unrestricted Parallelism</a>
        </h3>
<p id="section-4.2-1">We now introduce the signing protocol for FROST. This operation builds
upon known techniques in the
literature <span>[<a href="#AAM20" class="xref">AAM20</a>]</span> <span>[<a href="#GJKR03" class="xref">GJKR03</a>]</span> by
employing additive secret sharing and share conversion in order to
non-interactively generate the nonce value for each signature. However,
signing operations in FROST additionally leverage a binding technique to
avoid known forgery attacks without limiting concurrency. We present
FROST signing in two parts: a pre-processing phase and a single-round
signing phase. However, these stages can be combined for a simple
two-round protocol if desired.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">As a reminder, the attack of Drijvers et al. <span>[<a href="#DEF_19" class="xref">DEF_19</a>]</span>
requires the adversary to either see the victim's T commitment values
before selecting their own commitment, or to adaptively choose the
message to be signed, so that the adversary can manipulate the resulting
challenge c for the set of participants performing a group signing
operation. To prevent this attack without limiting concurrency, FROST
binds each participant's response to a specific message as well as the
set of participants and their commitments used for that particular
signing operation. In doing so, combining responses over different
messages or participant/commitment pairs results in an invalid
signature, thwarting attacks such as those of Drijvers et al.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3"><strong>Preprocess(Q)
-&gt; (i, D<sub>i1</sub>, E<sub>i1</sub>, ..., D<sub>iQ</sub>, E<sub>iQ</sub>)</strong><a href="#section-4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.2-4">Each participant P<sub>i</sub>, i in {1, ..., n} performs this stage prior
to signing. Let j be a counter for a specific nonce/commitment share
pair, and Q be the number of pairs generated at a time, such that
Q signing operations can be performed before performing another
preprocess step.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-5">
          <dt id="section-4.2-5.1">1.</dt>
          <dd id="section-4.2-5.2">
            <p id="section-4.2-5.2.1">
  Create an empty list L<sub>i</sub>. Then, for 1 &lt;= j &lt;= Q, perform
the following:<a href="#section-4.2-5.2.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-5.2.2">
              <dt id="section-4.2-5.2.2.1">1.a</dt>
              <dd id="section-4.2-5.2.2.2">
        Sample single-use nonces
(d<sub>ij</sub>, e<sub>ij</sub>) &lt;-$- Z<sub>q</sub><sup>*</sup> x Z<sub>q</sub><sup>*</sup><a href="#section-4.2-5.2.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-5.2.2.3">1.b</dt>
              <dd id="section-4.2-5.2.2.4">
        Derive commitment shares
(D<sub>ij</sub>, E<sub>ij</sub>) = (g^{d<sub>ij</sub>}, g^{e<sub>ij</sub>}).<a href="#section-4.2-5.2.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-5.2.2.5">1.c</dt>
              <dd id="section-4.2-5.2.2.6">
        Append (D<sub>ij</sub>, E<sub>ij</sub>) to L<sub>i</sub>. Store
((d<sub>ij</sub>, D<sub>ij</sub>), (e<sub>ij</sub>, E<sub>ij</sub>)) for later use in signing
operations.<a href="#section-4.2-5.2.2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-5.3">2.</dt>
          <dd id="section-4.2-5.4">
  Publish (i, L<sub>i</sub>) to a predetermined location, as specified by the
implementation.<a href="#section-4.2-5.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-6"><strong>Preprocessing Stage.</strong> We present above a preprocessing stage where
participants generate and publish Q commitments at a time. In this
setting, Q determines the number of nonces that are generated and
their corresponding commitments that are published in a single
preprocess step, and correspondingly the number of signing operations
that can be performed before the participant must perform this
preprocessing stage again. Note that implementations that do not wish to
cache commitments can instead use a two-round protocol, where
participants publish a single commitment to each other in the first
round.<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2-7">Each participant P<sub>i</sub> begins by generating a list of <em>single-use</em>
private nonce pairs and corresponding public commitment shares
((d<sub>ij</sub>, D<sub>ij</sub> = g^{d<sub>ij</sub>}), (e<sub>ij</sub>, E<sub>ij</sub> = g^{e<sub>ij</sub>})) for j=1,...,Q,
where j is a counter that identifies the next nonce/commitment share
pair available to use for signing. Each P<sub>i</sub> then publishes (i, L<sub>i</sub>),
where L<sub>i</sub> is their list of commitment shares
L<sub>i</sub> = &lt;(D<sub>ij</sub>, E<sub>ij</sub>) for j=1,...,Q&gt;. The location where
participants publish these values can depend on the implementation;
options include broadcasting to all other participants or publishing to
a centralized location that all participants can access (we discuss
these options further in <a href="#discussion" class="xref">Section 6</a>). The set of (i, L<sub>i</sub>)
tuples are then stored by any entity that might perform the signature
aggregator role during signing.<a href="#section-4.2-7" class="pilcrow">¶</a></p>
<p id="section-4.2-8"><strong>Sign(m) -&gt; (m, SIG)</strong><a href="#section-4.2-8" class="pilcrow">¶</a></p>
<p id="section-4.2-9">Let SA denote the signature aggregator (who themselves can
be one of the t signing participants). Let S be the set of
participants selected for use for this signing operation. Let
B = &lt; (i, D<sub>ij</sub>, E<sub>ij</sub>) for i in S&gt; denote the ordered
list of participant indices corresponding to each participant P<sub>i</sub>, and
L<sub>i</sub> be the set of available commitment values for P<sub>i</sub> that were
published during the Preprocess stage. Each identifier i is coupled
with the jth commitments (D<sub>ij</sub>, E<sub>ij</sub>) published by P<sub>i</sub> that will be used for this particular
signing operation. Let H<sub>1</sub>, H<sub>2</sub> be hash functions whose outputs are in
Z<sub>q</sub><sup>*</sup>.<a href="#section-4.2-9" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-10">
          <dt id="section-4.2-10.1">1.</dt>
          <dd id="section-4.2-10.2">
  SA begins by fetching the next available commitment
for each participant P<sub>i</sub> in S from L<sub>i</sub> and constructs B.<a href="#section-4.2-10.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-10.3">2.</dt>
          <dd id="section-4.2-10.4">
  For each i in S, SA sends P<sub>i</sub> the tuple (m, B).<a href="#section-4.2-10.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-10.5">3.</dt>
          <dd id="section-4.2-10.6">
  After receiving (m, B), each P<sub>i</sub> first validates the message
m, and then checks D<sub>p j</sub>, E<sub>p j</sub> in G<sup>*</sup> for
each commitment in B, aborting if either check fails.<a href="#section-4.2-10.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-10.7">4.</dt>
          <dd id="section-4.2-10.8">
  Each P<sub>i</sub> then computes the set of binding values
r<sub>p</sub> = H<sub>1</sub>(p, m, B), p in S. Each P<sub>i</sub> then derives
the group commitment
R = PROD(D<sub>pj</sub> * (E<sub>pj</sub>)^{r<sub>p</sub>}, p in S), and the challenge c = H<sub>2</sub>(m, R).<a href="#section-4.2-10.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-10.9">5.</dt>
          <dd id="section-4.2-10.10">
  Each P<sub>i</sub> computes their response using their long-lived secret
share s<sub>i</sub> by computing
z<sub>i</sub> = d<sub>ij</sub> + (e<sub>ij</sub> * r<sub>i</sub>) + L<sub>i</sub> * s<sub>i</sub> * c,
using S to determine L<sub>i</sub>.<a href="#section-4.2-10.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-10.11">6.</dt>
          <dd id="section-4.2-10.12">
  Each P<sub>i</sub> securely deletes ((d<sub>ij</sub>, D<sub>ij</sub>), (e<sub>ij</sub>, E<sub>ij</sub>))
from their local storage, and then returns z<sub>i</sub> to
SA.<a href="#section-4.2-10.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-4.2-10.13">7.</dt>
          <dd id="section-4.2-10.14">
            <p id="section-4.2-10.14.1">
  The signature aggregator SA performs the following
steps:<a href="#section-4.2-10.14.1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2-10.14.2">
              <dt id="section-4.2-10.14.2.1">7.a</dt>
              <dd id="section-4.2-10.14.2.2">
        Derive r<sub>i</sub> = H<sub>1</sub>(i,m,B) and
R<sub>i</sub> = D<sub>ij</sub> * (E<sub>ij</sub>)^{r<sub>i</sub>} for i in S, and
subsequently R=PROD(R<sub>i</sub>, i in S) and c = H<sub>2</sub>(m,R).<a href="#section-4.2-10.14.2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-10.14.2.3">7.b</dt>
              <dd id="section-4.2-10.14.2.4">
        Verify the validity of each response by checking
g^{z<sub>i</sub>} =?= R<sub>i</sub> * {Y<sub>i</sub>}^{c * L<sub>i</sub>}
for each signing share z<sub>i</sub>, i in S. If the equality does
not hold, first identify and report the misbehaving participant,
and then abort. Otherwise, continue.<a href="#section-4.2-10.14.2.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-10.14.2.5">7.c</dt>
              <dd id="section-4.2-10.14.2.6">
        Compute the group's response z = SUM(z<sub>i</sub>, i in S)<a href="#section-4.2-10.14.2.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-4.2-10.14.2.7">7.d</dt>
              <dd id="section-4.2-10.14.2.8">
        Publish the signature SIG = (z, c) along with the message
m.<a href="#section-4.2-10.14.2.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-4.2-11"><strong>Signing Protocol.</strong> At the beginning of the signing protocol above,
SA selects t participants (possibly including itself) to
participate in the signing. Let S be the set of those t
participants. SA then selects the next available
commitment (D<sub>ij</sub>, E<sub>ij</sub>) for each participant in S, which are
later used to generate a secret share to a random commitment R for the
signing group. (Each participant contributes to the group commitment
R, which corresponds to the commitment g<sup>k</sup> to the nonce k in step
1 of the single-party Schnorr signature scheme in
<a href="#schnorr-signature" class="xref">Section 2.4</a>.) This technique is a t-out-of-t
additive secret sharing; the resulting secret nonce is
k = SUM(k<sub>i</sub>, i in S), where each
k<sub>i</sub> = d<sub>ij</sub> + e<sub>ij</sub> * r<sub>i</sub> (we next describe how participants
calculate r<sub>i</sub>), and (d<sub>ij</sub>, e<sub>ij</sub>) correspond to the
(D<sub>ij</sub> = g^{d<sub>ij</sub>}, E<sub>ij</sub>=g^{e<sub>ij</sub>}) values published during the Preprocess stage. Recall
from <a href="#background_additive" class="xref">Section 2.5</a> that if the k<sub>i</sub> are <em>additive</em>
shares of k, then each (k<sub>i</sub>)/(L<sub>i</sub>) are t-out-of-t
<em>Shamir</em> shares of k.<a href="#section-4.2-11" class="pilcrow">¶</a></p>
<p id="section-4.2-12">After these steps, SA then creates the set B, where B
is the ordered list of tuples
&lt;(i, D<sub>ij</sub>, E<sub>ij</sub>) for i in S&gt;. SA then
sends (m, B) to every P<sub>i</sub>, i in S.<a href="#section-4.2-12" class="pilcrow">¶</a></p>
<p id="section-4.2-13">After receiving (m, B) from SA to initialize a signing
operation, each participant checks that m is a message they are
willing to sign. Then, using m and B, all participants derive the
"binding values" r<sub>i</sub>, i in S such that r<sub>i</sub> = H<sub>1</sub>(i, m, B),
where H<sub>1</sub> is a hash function whose outputs are in Z<sub>q</sub><sup>*</sup>.<a href="#section-4.2-13" class="pilcrow">¶</a></p>
<p id="section-4.2-14">Each participant can then compute the commitment R<sub>i</sub> for each
participant in S by deriving R<sub>i</sub> = D<sub>ij</sub> * (E<sub>ij</sub>)^{r<sub>i</sub>}.
Doing so binds the message, the set of signing participants, and each
participant's commitment to each signature share, such that signature
shares on one message cannot be used for another, assuming that
(d<sub>ij</sub>, e<sub>ij</sub>) remain secret and are used only once. This binding
technique thwarts the attack of Drijvers et al. described in
<a href="#schnorr-attacks" class="xref">Section 2.6</a> as attackers cannot combine signature shares
across disjoint signing operations or permute the set of signers or
published commitments for each signer.<a href="#section-4.2-14" class="pilcrow">¶</a></p>
<p id="section-4.2-15">The commitment for the set of signers is then simply
R = PROD(R<sub>i</sub>, i in S). As in single-party Schnorr signatures, each
participant computes the challenge c = H<sub>2</sub>(m,R).<a href="#section-4.2-15" class="pilcrow">¶</a></p>
<p id="section-4.2-16">Each participant's response z<sub>i</sub> to the challenge can be computed using
the single-use nonces (d<sub>ij</sub>, e<sub>ij</sub>) and the long-term secret shares
s<sub>i</sub>, which are t-out-of-n (degree t-1) Shamir secret shares of
the group's long-lived secret key s. Recalling that
(k<sub>i</sub>)/(L<sub>i</sub>) are degree t-1 Shamir secret shares of k, we
see that (k<sub>i</sub>)/(L<sub>i</sub>) + s<sub>i</sub> * c are degree t-1 Shamir
secret shares of the correct response z = k + s * c for a plain
(single-party) Schorr signature. Using share conversion again, and that
k<sub>i</sub> = d<sub>ij</sub> + (e<sub>ij</sub> * r<sub>i</sub>), we get that
z<sub>i</sub> = d<sub>ij</sub> + (e<sub>ij</sub> * r<sub>i</sub>) + L<sub>i</sub> * s<sub>i</sub> * c
are t-out-of-t additive shares of z.<a href="#section-4.2-16" class="pilcrow">¶</a></p>
<p id="section-4.2-17">SA finally checks the consistency of each participant's
reported z<sub>i</sub> with their commitment share (D<sub>ij</sub>, E<sub>ij</sub>) and their
public key share Y<sub>i</sub>. If every participant issued a correct z<sub>i</sub>,
then the sum of the z<sub>i</sub> values, along with c, forms the Schnorr
signature on m. This signature will verify properly to a verifier
unaware that FROST was used to generate the signature, and who checks it
with the standard single-party Schnorr verification equation with Y as
the public key (<a href="#schnorr-signature" class="xref">Section 2.4</a>).<a href="#section-4.2-17" class="pilcrow">¶</a></p>
<p id="section-4.2-18"><strong>Handling Ephemeral Outstanding Shares.</strong> Because each nonce and
commitment share generated during the preprocessing stage described in
the Preprocess algorithm must be used <em>at most once</em>, participants
delete these values after using them in a signing operation, as
indicated in Step 5 in the Sign algorithm. An accidentally reused
(d<sub>ij</sub>, e<sub>ij</sub>) can lead to exposure of the participant's long-term
secret s<sub>i</sub>, so participants must securely delete them, and defend
against snapshot rollback attacks as in any implementation of Schnorr
signatures.<a href="#section-4.2-18" class="pilcrow">¶</a></p>
<p id="section-4.2-19">However, if SA chooses to re-use a commitment set
(D<sub>ij</sub>, E<sub>ij</sub>) during the signing protocol, doing so simply results in the
participant P<sub>i</sub> aborting the protocol, and consequently does not
increase the power of SA.<a href="#section-4.2-19" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations-cfrg">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<div id="proof-of-security-properties">
<section id="section-5.1">
        <h3 id="name-proof-of-security-propertie">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-proof-of-security-propertie" class="section-name selfRef">Proof of Security Properties</a>
        </h3>
<p id="section-5.1-1">We present proofs and arguments of security in our technical
report <span>[<a href="#KG20" class="xref">KG20</a>]</span> to show that FROST is secure against
chosen-message attacks, assuming the discrete logarithm problem is hard
and the adversary controls fewer participants than the threshold. The
strategy is as follows. We first define an intermediate protocol called
FROST-Interactive that has one extra round of communication in each of
the Preprocess and Sign phases, and prove the security of
FROST-Interactive in the random oracle model. We then give a heuristic
argument that the differences between FROST-Interactive and FROST itself
do not adversely affect its security.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aborting-on-misbehaviour">
<section id="section-5.2">
        <h3 id="name-aborting-on-misbehaviour">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-aborting-on-misbehaviour" class="section-name selfRef">Aborting on Misbehaviour</a>
        </h3>
<p id="section-5.2-1">As discussed above, the goal of FROST is to save communication rounds
(particularly at signing time), at the cost of sacrificing robustness.
Consequently, FROST requires participants to abort once they have
detected misbehaviour.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">If one of the signing participants provides an incorrect signature
share, SA will detect that and abort the protocol, if
SA is itself behaving correctly. The protocol can then be
rerun with the misbehaving party removed. If SA is itself
misbehaving, and even if up to t-1 participants are corrupted,
SA still cannot produce a valid signature on a message not
approved by at least one honest participant.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="discussion">
<section id="section-6">
      <h2 id="name-operational-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-operational-considerations" class="section-name selfRef">Operational Considerations</a>
      </h2>
<div id="publishing-commitments-to-a-commitment-server">
<section id="section-6.1">
        <h3 id="name-publishing-commitments-to-a">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-publishing-commitments-to-a" class="section-name selfRef">Publishing Commitments to a Commitment Server</a>
        </h3>
<p id="section-6.1-1">The preprocessing step for FROST in <a href="#frost-signing" class="xref">Section 4.2</a> requires
some agreed-upon location for participants to publish their commitments
to. We now discuss choices for such a location for implementations, and
possible security implications.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">While participants could simply broadcast commitments to each other,
this approach requires memory overhead and possibly coordination effort.
Alternatively, implementations may wish to employ a commitment server
specifically tasked with performing and managing of participants'
commitment shares. While the commitment server may be a separate entity,
we note that the signature aggregator SA can also provide
this service in addition to its other duties. In this setting, the
commitment server is trusted to provide the correct (i.e, valid and
unused) commitment shares upon request. If the commitment server chose
to act maliciously, it could either prevent participants from performing
the protocol by denial of service, or it could provide stale or
malformed commitment values on behalf of honest participants, causing
uncertainty as to whether the commitment server or the participant was
the misbehaving entity. However, simply having access to the set of a
participant's <em>public</em> published commitments does not grant any
additional powers, and a misbehaving commitment server (or
SA) that provides old commitment values for a signing
operation simply results in either a denial of service or an invalid
signature. If SA assumes the commitment server role
itself, any uncertainty as to who is the cause of misbehaviour can be
avoided, and allows SA to carry out their role to report
misbehaviour when it occurs.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="adaptively-choosing-the-set-of-signing-participants">
<section id="section-6.2">
        <h3 id="name-adaptively-choosing-the-set">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-adaptively-choosing-the-set" class="section-name selfRef">Adaptively Choosing the Set of Signing Participants</a>
        </h3>
<p id="section-6.2-1">While FROST requires exactly t signers due to the structure of
non-interactively generating the nonce k (more specifically, so
participants can determine L<sub>i</sub> during signing), implementations
can still adaptively choose signing participants based on their
availability if the implementation does not wish to assume which t
signers are online and available when beginning a FROST signing
operation.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">How implementations should determine the availability of participants,
and select which t participants will perform signing, falls outside
FROST, and will depend on the implementation details of the
communications among the participants. In the worst case, however,
implementations can simply add an additional round before performing the
FROST signing protocol, during which participants can demonstrate their
availability and coordinate how available signers are selected to
perform the signing round (such as using some simple tie-breaking
exercise or ordering rule).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="section-7">
      <h2 id="name-acknowledgments">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-7-1">We thank Douglas Stebila for his helpful observations on the proof of
security and deriving security bounds. We thank Richard Barnes for his
helpful discussion on practical constraints and for identifying
significant optimizations to a prior version of FROST, which our final
version of FROST builds upon.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">We thank George Tankersley, Henry DeValence, Deirdre Connolly, and Ian
Miers for their feedback and discussions about real-world applications
of threshold signatures. We thank Omer Shlomovits and Elichai Turkel for
pointing out the case of rogue-key attacks in plain Ped-DKG and the
suggestion to use a proof of knowledge for a<sub>i0</sub> as a prevention
mechanism.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">We acknowledge the helpful description of additive secret sharing and
share conversion as a useful technique to non-interactively generate
secrets for Shamir secret-sharing schemes by Lueks <span>[<a href="#Lue17" class="xref">Lue17</a>]</span>,S.2.5.2.<a href="#section-7-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-informative-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="AAM20">[AAM20]</dt>
      <dd>
<span class="refAuthor">Abidin, A.</span><span class="refAuthor">, Aly, A.</span><span class="refAuthor">, and M.A. Mustafa</span>, <span class="refTitle">"Collaborative Authentication Using Threshold Cryptography"</span>, <span class="seriesInfo">Emerging Technologies for Authorization and Authentication </span>, <time datetime="2020" class="refDate">2020</time>. </dd>
<dd class="break"></dd>
<dt id="BBS03">[BBS03]</dt>
      <dd>
<span class="refAuthor">Bellare, M.</span><span class="refAuthor">, Boldyreva, A.</span><span class="refAuthor">, and J. Staddon</span>, <span class="refTitle">"Randomness Re-use in Multi-recipient Encryption Schemeas"</span>, <span class="seriesInfo">Public Key Cryptography </span>, <time datetime="2003" class="refDate">2003</time>. </dd>
<dd class="break"></dd>
<dt id="BDN18">[BDN18]</dt>
      <dd>
<span class="refAuthor">Boneh, D.</span><span class="refAuthor">, Drijvers, M.</span><span class="refAuthor">, and G. Neven</span>, <span class="refTitle">"Compact Multi-signatures for Smaller Blockchains"</span>, <span class="seriesInfo">ASIACRYPT </span>, <time datetime="2018" class="refDate">2018</time>. </dd>
<dd class="break"></dd>
<dt id="BL88">[BL88]</dt>
      <dd>
<span class="refAuthor">Benaloh, J.</span><span class="refAuthor"> and J. Leichter</span>, <span class="refTitle">"Generalized Secret Sharing and Monotone Functions"</span>, <span class="seriesInfo">CRYPTO </span>, <time datetime="1988" class="refDate">1988</time>. </dd>
<dd class="break"></dd>
<dt id="BLOR20">[BLOR20]</dt>
      <dd>
<span class="refAuthor">Benhamouda, F.</span><span class="refAuthor">, Lepoint, T.</span><span class="refAuthor">, Orrù, M.</span><span class="refAuthor">, and M. Raykova</span>, <span class="refTitle">"On the (in)security of ROS"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/945">https://eprint.iacr.org/2020/945</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BLS04">[BLS04]</dt>
      <dd>
<span class="refAuthor">Boneh, D.</span><span class="refAuthor">, Lynn, B.</span><span class="refAuthor">, and H. Shacham</span>, <span class="refTitle">"Short Signatures from the Weil Pairing"</span>, <span class="seriesInfo">Journal of Cryptology </span>, <time datetime="2004" class="refDate">2004</time>. </dd>
<dd class="break"></dd>
<dt id="CDI05">[CDI05]</dt>
      <dd>
<span class="refAuthor">Cramer, R.</span><span class="refAuthor">, Damgård, I.</span><span class="refAuthor">, and Y. Ishai</span>, <span class="refTitle">"Share Conversion, Pseudorandom Secret-Sharing and Applications to Secure Computation"</span>, <span class="seriesInfo">Theory of Cryptography </span>, <time datetime="2005" class="refDate">2005</time>. </dd>
<dd class="break"></dd>
<dt id="DEF_19">[DEF_19]</dt>
      <dd>
<span class="refAuthor">Drijvers, M.</span><span class="refAuthor">, Edalatnejad, K.</span><span class="refAuthor">, Ford, B.</span><span class="refAuthor">, Kiltz, E.</span><span class="refAuthor">, Loss, J.</span><span class="refAuthor">, Neven, G.</span><span class="refAuthor">, and I. Stepanovs</span>, <span class="refTitle">"On the Security of Two-Round Multi-Signatures"</span>, <span class="seriesInfo">2019 IEEE Symposium on Security and Privacy (SP) </span>, <time datetime="2019" class="refDate">2019</time>. </dd>
<dd class="break"></dd>
<dt id="DJN_20">[DJN_20]</dt>
      <dd>
<span class="refAuthor">Damgård, I.</span><span class="refAuthor">, Jakobsen, T.P.</span><span class="refAuthor">, Nielsen, J.B.</span><span class="refAuthor">, Pagter, J.I.</span><span class="refAuthor">, and M.B. Østergård</span>, <span class="refTitle">"Fast Threshold ECDSA with Honest Majority"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/501">https://eprint.iacr.org/2020/501</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Fel87">[Fel87]</dt>
      <dd>
<span class="refAuthor">Feldman, P.</span>, <span class="refTitle">"A Practical Scheme for Non-interactive Verifiable Secret Sharing"</span>, <span class="seriesInfo">Proceedings of the 28th Annual Symposium on Foundations of Computer Science </span>, <time datetime="1987" class="refDate">1987</time>. </dd>
<dd class="break"></dd>
<dt id="GGK_15">[GGK_15]</dt>
      <dd>
<span class="refAuthor">Goldfeder, S.</span><span class="refAuthor">, Gennaro, R.</span><span class="refAuthor">, Kalodner, H.</span><span class="refAuthor">, Bonneau, J.</span><span class="refAuthor">, Kroll, J.A.</span><span class="refAuthor">, Felten, E.W.</span><span class="refAuthor">, and A. Narayanan</span>, <span class="refTitle">"Securing Bitcoin wallets via a new DSA/ECDSA threshold signature scheme"</span>, <time datetime="2015" class="refDate">2015</time>. </dd>
<dd class="break"></dd>
<dt id="GJKR03">[GJKR03]</dt>
      <dd>
<span class="refAuthor">Gennaro, R.</span><span class="refAuthor">, Jarecki, S.</span><span class="refAuthor">, Krawczyk, H.</span><span class="refAuthor">, and T. Rabin</span>, <span class="refTitle">"Secure Applications of Pedersen's Distributed Key Generation Protocol"</span>, <span class="seriesInfo">Topics in Cryptology - CT-RSA 2003 </span>, <time datetime="2003" class="refDate">2003</time>. </dd>
<dd class="break"></dd>
<dt id="GJKR07">[GJKR07]</dt>
      <dd>
<span class="refAuthor">Gennaro, R.</span><span class="refAuthor">, Jarecki, S.</span><span class="refAuthor">, Krawczyk, H.</span><span class="refAuthor">, and T. Rabin</span>, <span class="refTitle">"Secure Distributed Key Generation for Discrete-Log Based Cryptosystems"</span>, <span class="seriesInfo">Journal of Cryptology </span>, <time datetime="2007" class="refDate">2007</time>. </dd>
<dd class="break"></dd>
<dt id="KG20">[KG20]</dt>
      <dd>
<span class="refAuthor">Komlo, C.</span><span class="refAuthor"> and I. Goldberg</span>, <span class="refTitle">"FROST: Flexible Round-Optimized Schnorr Threshold Signatures"</span>, <time datetime="2020" class="refDate">2020</time>, <span>&lt;<a href="https://eprint.iacr.org/2020/852">https://eprint.iacr.org/2020/852</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Lue17">[Lue17]</dt>
      <dd>
<span class="refAuthor">Lueks, W.</span>, <span class="refTitle">"Security and Privacy via Cryptography -- Having your cake and eating it too"</span>, <time datetime="2017" class="refDate">2017</time>. </dd>
<dd class="break"></dd>
<dt id="MOT_11">[MOT_11]</dt>
      <dd>
<span class="refAuthor">Mittal, P.</span><span class="refAuthor">, Olumofin, F.</span><span class="refAuthor">, Troncoso, C.</span><span class="refAuthor">, Borisov, N.</span><span class="refAuthor">, and I. Goldberg</span>, <span class="refTitle">"PIR-Tor: Scalable Anonymous Communication Using Private Information Retrieval"</span>, <span class="seriesInfo">20th USENIX Security Symposium </span>, <time datetime="2011" class="refDate">2011</time>. </dd>
<dd class="break"></dd>
<dt id="MPSW19">[MPSW19]</dt>
      <dd>
<span class="refAuthor">Maxwell, G.</span><span class="refAuthor">, Poelstra, A.</span><span class="refAuthor">, Seurin, Y.</span><span class="refAuthor">, and P. Wuille</span>, <span class="refTitle">"Simple Schnorr multi-signatures with applications to Bitcoin"</span>, <span class="seriesInfo">Designs, Codes and Cryptography </span>, <time datetime="2019" class="refDate">2019</time>. </dd>
<dd class="break"></dd>
<dt id="Ped91">[Ped91]</dt>
      <dd>
<span class="refAuthor">Pedersen, T.P.</span>, <span class="refTitle">"A Threshold Cryptosystem without a Trusted Party (Extended Abstract)"</span>, <span class="seriesInfo">EUROCRYPT '91 </span>, <time datetime="1991" class="refDate">1991</time>. </dd>
<dd class="break"></dd>
<dt id="SS01">[SS01]</dt>
      <dd>
<span class="refAuthor">Stinson, D.R.</span><span class="refAuthor"> and R. Strobl</span>, <span class="refTitle">"Provably Secure Distributed Schnorr Signatures and a (t, n) Threshold Scheme for Implicit Certificates"</span>, <span class="seriesInfo">Proceedings of the 6th Australasian Conference on Information Security and Privacy </span>, <time datetime="2001" class="refDate">2001</time>. </dd>
<dd class="break"></dd>
<dt id="Sch89">[Sch89]</dt>
      <dd>
<span class="refAuthor">Schnorr, C.</span>, <span class="refTitle">"Efficient Identification and Signatures for Smart Cards"</span>, <span class="seriesInfo">CRYPTO </span>, <time datetime="1989" class="refDate">1989</time>. </dd>
<dd class="break"></dd>
<dt id="Sha79">[Sha79]</dt>
      <dd>
<span class="refAuthor">Shamir, A.</span>, <span class="refTitle">"How to share a secret"</span>, <span class="seriesInfo">Communications of the ACM </span>, <time datetime="1979" class="refDate">1979</time>. </dd>
<dd class="break"></dd>
<dt id="Wag02">[Wag02]</dt>
    <dd>
<span class="refAuthor">Wagner, D.</span>, <span class="refTitle">"A Generalized Birthday Problem"</span>, <span class="seriesInfo">CRYPTO </span>, <time datetime="2002" class="refDate">2002</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Chelsea Komlo</span></div>
<div dir="auto" class="left"><span class="org">University of Waterloo, Zcash Foundation</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ckomlo@uwaterloo.ca" class="email">ckomlo@uwaterloo.ca</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ian Goldberg</span></div>
<div dir="auto" class="left"><span class="org">University of Waterloo</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:iang@uwaterloo.ca" class="email">iang@uwaterloo.ca</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
