Internet Fax Working Group                          Lloyd McIntyre
Internet Draft                                      Stephen Zilles
Expires in six months                               March 20, 1997

                    File Format for Internet Fax

                   <draft-ietf-fax-tiffplus-00.txt>

Status

This document is an Internet Draft.  Internet Drafts are working 
documents of the Internet Engineering Task Force (IETF), its 
Areas, and its Working Groups.  Note that other groups may also 
distribute working documents as Internet Drafts.

Internet Drafts are valid for a maximum of six months and may be 
updated, replaced, or obsoleted by other documents at any time.  
It is inappropriate to use Internet Drafts as reference material 
or to cite them other than as a "work in progress."

To learn the current status of any Internet-Draft, please check 
the "1id-abstracts.txt" listing contained in the Internet-Drafts 
Shadow Directories on ftp.is.co.za (Africa), nic.nordu.net 
(Europe), munnari.oz.au (Pacific Rim), ds.internic.net (US East 
Coast), or ftp.isi.edu (US West Coast).

Abstract

This Internet Draft describes the TIFF representation of the
image data specified by the ITU-T Recommendations and proposals 
for black-and-white and color facsimile. For the most part, 
existing TIFF constructs and fields are used; new TIFF fields are 
introduced only when necessary. Black-and-white facsimile is 
already described by TIFF Class F, and this Draft builds on that 
to add color fax capability and to establish a structure for 
future enhancements.

Table of Contents

1. INTRODUCTION..................................................3
   1.1. Scope....................................................3
   1.2. Rationale................................................3
   1.3. Organization of This Draft...............................4
2. TIFF and Fax..................................................4
   2.1. TIFF Overview............................................4
     2.1.1. File Structure.......................................4
     2.1.2. Image Structure......................................5
   2.2 Fax Requirements..........................................6
     2.2.1. TIFF fields required for all fax modes...............6
     2.2.2. TIFF fields recommended for all fax modes............7
     2.2.3. New TIFF fields for all fax modes....................7

McIntyre & Zilles         Expires 9/20/97                 [Page 1]

Internet Draft     File Format for Internet Fax     March 20, 1997

3. Base B&W Fax Mode.............................................9
   3.1. Overview.................................................9
   3.2. Required TIFF Fields.....................................9
     3.2.1. Baseline fields.....................................10
     3.2.2. Extension fields....................................10
     3.2.3. New fields..........................................11
   3.3. Recommended TIFF Fields.................................11
     3.3.1. Baseline fields.....................................11
     3.3.2. Extension fields....................................11
     3.3.3. New fields..........................................11
   3.4. Base B&W Fax Mode Summary...............................12
4. Base Color Fax Mode..........................................14
   4.1. Overview................................................14
   4.2. Required TIFF Fields....................................14
     4.2.1. Baseline Fields.....................................15
     4.2.2. Extension fields....................................16
     4.2.3. New fields..........................................18
   4.3. Recommended TIFF Fields.................................18
   4.4. Base Color Fax Mode Summary.............................18
5. Lossless Color Mode..........................................20
   5.1. Overview................................................20
     5.1.1. Color Encoding......................................21
     5.1.2. JBIG Encoding.......................................21
   5.2. Required TIFF Fields....................................21
     5.2.1. Baseline fields.....................................22
     5.2.2. Extension fields....................................23
     5.2.3. New fields..........................................23
   5.3. Recommended TIFF Fields.................................23
   5.4. Lossless Color Fax Mode Summary.........................24
6. Mixed Raster Content Mode....................................26
   6.1 Overview.................................................26
     6.1.1. MRC 3-layer model...................................26
     6.1.2. A TIFF Representation for the MRC 3-layer model.....27
   6.2. Required TIFF Fields....................................29
     6.2.1. Baseline fields.....................................29
     6.2.2. Extension fields....................................30
     6.2.3. New fields..........................................31
   6.3. Recommended TIFF Fields.................................32
   6.4. Rules and Requirements for Images.......................32
   6.5. MRC Fax Mode Summary....................................33
7. Mime Sub-Type................................................36
8. IANA Registration............................................36
9. Security Considerations......................................37
10. References..................................................38
11. Authors' Addresses..........................................39
Annex A: Summary of TIFF Fields for Internet Fax ...............39




McIntyre & Zilles         Expires 9/20/97                 [Page 2]

Internet Draft     File Format for Internet Fax     March 20, 1997

1.   Introduction

1.1  Scope

This document defines a TIFF-based file format specification and 
corresponding IETF content type consistent with the charter of the 
IETF Internet Fax Working Group for enabling standardized 
messaging-based fax over the Internet. In particular, it describes 
the fields and parameters required to enable TIFF (Tag Image File 
Format) to represent the content and the structure of the data 
generated by the suite of existing and developing ITU-T 
Recommendations for Group 3 facsimile. These standards, and the 
TIFF fields described here, support four facsimile modes:

    1.  base black-and-white mode, using binary compression [T.4, 
        T.6, T.82]
    2.  lossy color and grayscale mode, using JPEG compression 
        [T.42, T.81]
    3.  lossless color and grayscale mode, using JBIG compression 
        [T.43, T.82]
    4.  mixed raster content mode [MRC], using a combination of 
        existing compression methods

This specification builds on a previously proposed standard 
[RFC1314] and on work in progress [TIFF-F] for the base black-and-
white mode.  It extends that work to make it compatible with the 
relevant ITU-T Recommendations for color and grayscale facsimile. 
It also proposes a modification to the image/tiff content type 
that would accommodate the fax modes.

Within its defined scope of specifying a file format for Internet 
Fax, this draft:

    1.  specifies TIFF structures for facsimile data,
    2.  defines ITU fax-compatible values for existing TIFF 
        fields,
    3.  defines new TIFF fields and values required for 
        compatibility with ITU fax.

1.2  Rationale

This specification uses the current TIFF spec [TIFF] as the basis 
for describing color and grayscale facsimile modes. By doing so, 
it takes advantage of TIFF features and structures that bridge the 
data formats and performance requirements of both legacy fax 
machines and host-based fax applications. A TIFF-based approach 
also builds on an established base of users and implementors and 
ensures backward compatibility with existing TIFF-based IETF 
proposals and work in progress for Internet fax. 

McIntyre & Zilles         Expires 9/20/97                 [Page 3]

Internet Draft     File Format for Internet Fax     March 20, 1997

The basic approach to using TIFF for facsimile data is to insert 
the fax data stream in a TIFF file and to use TIFF fields to 
encode the parameters that describe the properties of the data. 
TIFF constructs for pages, images, and strips allow a TIFF file to 
preserve the fax data stream structure, and the performance 
advantages that come with it. 

1.3  Organization of this draft

Section 2 describes the general representation of fax data and 
parameters in a TIFF file, including the TIFF fields that 
would be used in all four fax modes. Sections 3-6 each describe 
the representation of a single fax mode. Each section starts with 
an overview of the applicable ITU-T Recommendation and then 
describes the required and optional TIFF fields for representing 
the ITU data stream. The fields in each subsection are organized 
according to whether they are baseline or extensions in the 
current TIFF specification or that will appear in the next 
specification, or are new and defined in this document. 
Sections 7 and 8 describe the MIME content type and IANA 
registration. The remaining sections are required in 
all Internet Drafts. Annex A gives a summary of the TIFF fields 
used or defined in this document.


2.   TIFF and Fax

2.1.  TIFF Overview

This section is based on the current TIFF specification [TIFF] and 
selected TIFF Technical Notes [TTN1, TTN2].

2.1.1.  File Structure

TIFF is designed for scanned images, which makes it a good match 
for facsimile documents, which are multi-page scanned raster 
images. A TIFF file begins with an 8-byte image file header that 
describes the byte order used within the file, includes a value 
that identifies the file as a TIFF file, and then gives an offset 
that points to the first image file directory (IFD). The IFD can 
be at any location in the file after the header but must begin on 
a word boundary. An IFD is a sequence of tagged fields, sorted in 
ascending order by tag value, containing information about the 
image and pointers to the image data.

A TIFF file can contain more than one IFD, where each IFD is a 
subfile whose type is given in the NewSubfileType field. Multiple 
IFDs can be organized either as a linked list, with the last entry 
in each IFD pointing to the next IFD (the pointer in the last IFD 

McIntyre & Zilles         Expires 9/20/97                 [Page 4]

Internet Draft     File Format for Internet Fax     March 20, 1997

is 0), or as a tree, using the SubIFDs field in the primary IFD 
[TTN1]. The SubIFDs field contains an array of pointers to child 
IFDs of the primary IFD. Child IFDs describe related images, such 
as a reduced resolution version of the primary IFD image. The same 
IFD can point to both a next IFD and to child IFDs, and child IFDs 
can themselves point to other IFDs. A Baseline TIFF reader is not 
required to read any IFDs beyond the first. 

This specification requires the use of subfiles or multiple IFDs. 
All four fax modes represent a multi-page fax image as a linked 
list of IFDs, with a NewSubfileType field containing a bit that 
identifies the IFD as one page of a multi-page document. Each IFD 
has a PageNumber field, identifying the page number, starting at 0 
for the first page. Only the Mixed Raster Content fax mode, 
described in Section 6, requires child IFDs. 

2.1.2  Image Structure

An IFD can store an image either as a single strip or split into 
individually addressable strips, for improved performance at the 
option of the writer. Each IFD requires the StripOffsets field, 
which is an array of pointers to the strip or strips that contain 
the actual image data. TIFF requires that each strip, except the 
last, contain the same number of scanlines, given in the 
RowsPerStrip field.  This document introduces the new 
StripRowCounts field that allows a variable number of scanlines 
per strip. This feature is required by the Mixed Raster Content 
fax mode.

Whether stripped or not, the image data is stored as uninterpreted 
data streams. The formats of these streams follow the ITU-T 
Recommendations. The compressed data stream is placed 
in a strip within an IFD, with the Compression field used to 
indicate the type of compression, and other TIFF fields used to 
describe image attributes, such as color encoding and spatial 
resolution. Compression parameters are stored in the compressed 
data stream, rather than in additional TIFF fields. This makes the 
TIFF and compression data format specifications independent of one 
another. This approach, modeled on [TTN2], allows TIFF to 
gracefully add new compression schemes as they become available.

To reduce overhead in TIFF files with multiple JPEG segments, one 
can allow JPEG tables to be stored just once in a new 
JPEGTables field [TTN2]. While this specification does not use 
this field, this approach can be adapted for use with other 
compression schemes, when all the data streams refer to the same 
table and it would reduce file size to store the table once, 
rather than replicate it throughout the file.


McIntyre & Zilles         Expires 9/20/97                 [Page 5]

Internet Draft     File Format for Internet Fax     March 20, 1997

For attributes that can be specified both places, i.e. in the data 
stream and within a TIFF field, it is possible that the two values 
will differ. When this happens for values required to interpret 
the data stream, then the values in the data stream would take 
precedence. For informational values that are not required to 
interpret the data stream, such as author name, then the TIFF 
field value normally would take precedence.

2.2  Fax requirements

2.2.1.  TIFF fields required for all fax modes

The TIFF fields listed in this section are common to all fax modes 
and required by all fax modes.  Other TIFF fields are also common 
to all modes, but the values associated with the field are mode-
specific.  Such fields are described in the relevant sections 
below.

The pattern for the field descriptions in this draft is

FieldName = values.                                           TYPE
Count = (omitted if =1)
Tag = (if not in current spec but available)
    Explanation of the field, how its used and the values it can 
    have.

ImageWidth.                                          SHORT or LONG
    Total number of pixels in a scanline.

ImageLength.                                         SHORT or LONG
    Total number of scanlines in image.

NewSubFileType = 2.                                           LONG
    2 = Bit 1 identifies the image as a single page of a 
    multi-page document.

PageNumber.                                                  SHORT
Count = 2
    The first number represents the page number (0 for the first 
    page);  the second number is the total number of pages in the 
    document.  If the second value is 0, then the total page count 
    is not available.  This field is a TIFF extension, not a 
    Baseline TIFF field.

ResolutionUnit = 2, 3.                                       SHORT
    2 = inch
    3 = centimeter
    The unit of measure for resolution.


McIntyre & Zilles         Expires 9/20/97                 [Page 6]

Internet Draft     File Format for Internet Fax     March 20, 1997

RowsPerStrip.                                        SHORT or LONG
    The number of scanlines per TIFF strip.

StripByteCounts.                                     SHORT or LONG
Count = number of strips
    For each strip, the number of bytes in that strip.

StripOffsets.                                        SHORT or LONG
Count = number of strips
    For each strip, the byte offset from the beginning of the file 
    to that strip.

2.2.2  TIFF fields recommended for all fax modes

The TIFF fields listed in this section are recommended, but not 
required, for use with all fax modes. Recommended fields that are 
mode-specific are described in the relevant sections below.

DateTime.                                                    ASCII
    Date/time in the format "YYYY:MM:DD HH:MM:SS" in 24-hour 
    format.

DocumentName.                                                ASCII
    The name of the scanned document.  This field is a TIFF 
    extension, not a Baseline TIFF field.

ImageDescription.                                            ASCII
    A string describing the contents of the image.

Orientation = 1-8.                                           SHORT
    1:  0th row represents the visual top of the image; the 0th 
        column represents the visual left side of the image.  See 
        the current TIFF specification [TIFF] for further values.
    Default = 1

Software.                                                    ASCII
    The optional name and release number of the software package 
    that created the image.

2.2.3.  New TIFF fields for all fax modes

Almost all the fields recommended in the previous section apply to 
the collection of images that make up a TIFF-based fax file, 
rather than to any one specific image in that file. It makes sense 
to separate these "global" fields from the image-specific fields 
in an IFD. It would also be useful to have a field, analogous to 
the Software field, that identifies the fax mode used to create 
the image data.


McIntyre & Zilles         Expires 9/20/97                 [Page 7]

Internet Draft     File Format for Internet Fax     March 20, 1997

For these reasons, several new fields, which are not part of the 
current TIFF specification, are defined in this document. The 
first new field, GlobalParametersIFD, is an IFD that contains 
global parameters and is located in a Primary IFD.

GlobalParametersIFD.                                           IFD
    An IFD containing global parameters. A TIFF writer would 
    likely place this field in the first IFD, where a reader would 
    find it quickly.

Each field in the GlobalParametersIFD is a TIFF field that is 
legal in any IFD. Required baseline fields should not be located 
in the GlobalParametersIFD, but should be in each image IFD. If a 
conflict exists between fields in the GlobalParametersIFD and 
image IFDs, it is valid to use the data closest to the image data, 
otherwise the image IFD is ill-formed and should be ignored.

Among the GlobalParametersIFD entries is a new ProfileType field 
which generally describes information in this IFD and in the TIFF 
file.

ProfileType:                                                  LONG
Tag:  to be assigned
    The type of image data stored in this IFD:
    0 = Unspecified
    1 = Group 3 fax
    other values for further study

The following new global fields are defined in this document as 
IFD entries for use with fax applications.

ITUFaxMode = 0 - 4.                                           BYTE
Tag:  to be assigned
    The currently defined values are:
    0:  does not conform to ITU-T Recommendations for facsimile,
    1:  black & white lossless (ITU-T Rec. T.4, T.6),
    2:  lossy color and grayscale (ITU-T Rec. T.42),
    3:  lossless color and grayscale (ITU-T Rec. T.43),
    4:  Mixed Raster Content (ITU-T Draft Rec. T.44).
Notes:  A file can use an ITU encoding with non-ITU parameters, 
    such as using JPEG to compress a CMYK image. In this case, 
    ITUFaxMode is 0.

CodingMethods.                                                LONG
Tag:  to be assigned
    This field indicates which coding methods are used in the 
    file.  A bit value of 1 indicates:
    Bit 0:  unspecified compression,


McIntyre & Zilles         Expires 9/20/97                 [Page 8]

Internet Draft     File Format for Internet Fax     March 20, 1997

    Bit 1:  1-dimensional coding, ITU-T Rec. T.4 (MH - Modified 
            Huffman),
    Bit 2:  2-dimensional coding, ITU-T Rec. T.4 (MR - Modified 
            Read),
    Bit 3:  2-dimensional coding, ITU-T Rec. T.6 (MMR - Modified 
            Modified Read),
    Bit 4:  ITU-T Rec. T.82 coding, applying ITU-T Rec. T.85 
            (JBIG),
    Bit 5:  ITU-T Rec. T.81 (Baseline JPEG),
    Bits 6-31:  reserved for future use
Notes:  There is a limit of 32 compression types to identify 
standard compression methods.

VersionYear.                                                  BYTE
Tag:  to be assigned
Count: 4
    The year of the standard specified by the ITUFaxMode field, 
    given as 4 characters, e.g. '1997'; used with T.42 and T.43.

VersionNumber                                                 BYTE
Tag:  to be assigned
    The version of the standard specified by the ITUFaxMode field. 
    A value of 0 indicates Version 1.0; used with MRC (Draft 
    T.44).


3.  Base B&W Fax Mode

3.1.  Overview

Base black-and-white mode is the binary fax application most users 
are familiar with today. This mode is appropriate for black-and-
white text and line art. It offers several options for lossless 
bi-level image coding, including 1-dimensional Modified Huffman 
(MH) and 2-dimensional Modified Read (MR), both described in 
[T.4], and Modified Modified Read (MMR), described in [T.6]. (Read 
is an acronym for Relative Element Address Designate.) 

Also available is the single-progression sequential mode of JBIG 
[T.82], used in accordance with the application rules given in 
ITU-T Rec. T.85 [T.85]. JBIG coding offers improved compression 
for halftoned originals.

This section is based on the TIFF Class F definition.  

3.2.  Required TIFF fields

This section lists the required fields and the values they must 
have to be ITU-compatible.

McIntyre & Zilles         Expires 9/20/97                 [Page 9]

Internet Draft     File Format for Internet Fax     March 20, 1997

3.2.1.  Baseline fields

ImageWidth.                                          SHORT or LONG
    This mode supports the following fixed page widths: 1728, 
    2048, 2432, 2592, 3072, 3456, 3648, 4096, 4864.

BitsPerSample = 1.                                           SHORT
    Binary data only.

Compression = 2, 3, 4, 9.                                    SHORT
    2 = 1-dimensional coding, ITU-T Rec. T.4 (MH - Modified 
        Huffman)
    3 = 2-dimensional coding, ITU-T Rec. T.4 (MR - Modified Read)
    4 = 2-dimensional coding, ITU-T Rec. T.6 (MMR - Modified 
        Modified Read)
    9 = ITU-T Rec. T.82 coding, applying ITU-T Rec. T.85 (JBIG)

FillOrder = 1, 2.                                            SHORT
    1 = Pixels are arranged within a byte such that pixels with 
        lower column values are stored in the higher-order bits of 
        the bytes, i.e., most significant bit first (MSB).
    2 = Pixels are arranged within a byte such that pixels with 
        lower column values are stored in the lower-order bits of 
        the bytes, i.e., least significant bit first (LSB).
    Most b&w fax products use LSB first.

PhotometricInterpretation = 0, 1.                            SHORT
    0 = pixel value 1 means black 
    1 = pixel value 1 means white

SamplesPerPixel = 1.                                         SHORT
    1 = monochrome, bi-level in this case (see BitsPerSample) 

XResolution.                                              RATIONAL
    The horizontal resolution of the image is expressed in pixels 
    per resolution unit. In pixels/inch, the allowed values are: 
    200, 204, 300, 400, and 406.

YResolution.                                              RATIONAL
    The vertical resolution of the image is expressed in pixels 
    per resolution unit. In pixels/inch, the allowed values are: 
    98, 100, 196, 200, 300, 392, and 400 pixels/inch

3.2.2.  Extension fields

T4Options = 0, 1, 4, 5.                                       LONG
    0:  Required if Compression field has a value of 2, indicating 



McIntyre & Zilles         Expires 9/20/97                [Page 10]

Internet Draft     File Format for Internet Fax     March 20, 1997

        Modified Huffman encoding, and if fill bits have not been 
        added to insure EOL codes end on a byte boundary.
    1:  Required if Compression field has a value of 3, indicating 
        Modified Read encoding, and if fill bits have not been 
        added to insure EOL codes end on a byte boundary.
    4:  Required if Compression field has a value of 2, indicating 
        Modified Huffman encoding, and if fill bits have been 
        added to insure EOL codes end on a byte boundary.
    5:  Required if Compression field has a value of 3, indicating 
        Modified Read encoding, and if fill bits have been added
        to insure EOL codes end on a byte boundary.

T6Options = 0.                                                LONG
    Required if Compression field has a value of 4, indicating 2D 
    Modified Modified Read.

3.2.3.  New fields

No new extensions are required for black & white fax.

3.3  Recommended TIFF fields

3.3.1.  Baseline fields

See Section 2.2.2.

3.3.2.  Extension fields

See Section 2.2.2.

3.3.3.  New fields

There are three new optional fields for describing black & white 
fax page quality. They are not defined in the current TIFF 
specification.

BadFaxLines.                                         SHORT or LONG
    The number of "bad" scan lines encountered by the facsimile 
    during reception.  A "bad" scanline is defined as a scanline 
    that, when decoded, comprises an incorrect number of pixels.

CleanFaxData = 0, 1, 2.                                      SHORT
    Indicates if "bad" lines encountered during reception are 
    stored in the data, or if "bad" lines have been replaced by 
    the receiver.
    0 =  No "bad" lines
    1 =  "bad" lines exist, but were regenerated by the receiver,
    2 =  "bad" lines exist, but have not been regenerated.


McIntyre & Zilles         Expires 9/20/97                [Page 11]

Internet Draft     File Format for Internet Fax     March 20, 1997

ConsecutiveBadFaxLines.                              SHORT or LONG
    Maximum number of consecutive "bad" scanlines received.

3.4.  Base B&W Fax Mode Summary

Recommended fields are shown with an asterisk *

    +---------------------------+--------------------------------+
    | Baseline Fields           |  Values                        |
    +---------------------------+--------------------------------+
    | BitsPerSample             | 1                              |
    +---------------------------+--------------------------------+
    | Compression               | 2: 1D Modified Huffman coding  |
    |                           | 3: 2D Modified Read coding     |
    |                           | 4: 2D Modified Modified Read   |
    |                           | coding                         |
    |                           | 9: JBIG                        |
    +---------------------------+--------------------------------+
    | DateTime*                 | {ASCII}:  date/time in the     |
    |                           | 24-hour format                 |
    |                           | "YYYY:MM:DD HH:MM:SS"          |
    +---------------------------+--------------------------------+
    | FillOrder                 | 1: most significant bit first  |
    |                           | 2: least significant bit first |
    +---------------------------+--------------------------------+
    | ImageDescription*         | {ASCII}: A string describing   |
    |                           | the contents of the image.     |
    +---------------------------+--------------------------------+
    | ImageWidth                | 1728, 2048, 2432, 2592, 3072,  |
    |                           | 3456, 3648, 4096, 4864         |
    +---------------------------+--------------------------------+
    | ImageLength               | n: total number of scanlines   |
    |                           | in image                       |
    +---------------------------+--------------------------------+
    | NewSubFileType            | 2: Bit 1 identifies single     |
    |                           | page of a multi-page document  |
    +---------------------------+--------------------------------+
    | Orientation*              | 1-8, Default 1                 |
    +---------------------------+--------------------------------+
    | PhotometricInterpretation | 0: pixel value 1 means black   |
    |                           | 1: pixel value 1 means white   |
    +---------------------------+--------------------------------+
    | ResolutionUnit            | 2: inch                        |
    |                           | 3: centimeter                  |
    +---------------------------+--------------------------------+
    | RowsPerStrip              | n: number of scanlines per     |
    |                           | TIFF strip                     |
    +---------------------------+--------------------------------+


McIntyre & Zilles         Expires 9/20/97                [Page 12]

Internet Draft     File Format for Internet Fax     March 20, 1997

    +---------------------------+--------------------------------+
    | SamplesPerPixel           | 1                              |
    +---------------------------+--------------------------------+
    | Software*                 | {ASCII}: name & release        |
    |                           | number of creator software     |
    +---------------------------+--------------------------------+
    | StripByteCounts           | <n>: number or bytes in TIFF   |
    |                           | strip                          |
    +---------------------------+--------------------------------+
    | StripOffsets              | <n>: offset from beginning of  |
    |                           | file to each TIFF strip        |
    +---------------------------+--------------------------------+
    | XResolution               | 200, 204, 300, 400, 406        |
    |                           | (written in pixels/inch)       |
    +---------------------------+--------------------------------+
    | YResolution               | 98, 196, 100, 200, 300, 392,   |
    |                           | 400 (written in pixels/inch)   |
    +---------------------------+--------------------------------+
    | Extension Fields                                           |
    +---------------------------+--------------------------------+
    | T4Options                 | 0: required if Compression is  |
    |                           | Modified Huffman, no fill bits |
    |                           | 1: required if Compression is  |
    |                           | 2D Modified Read, no fill bits |
    |                           | 4: required if Compression is  |
    |                           | Modified Huffman, fill bits    |
    |                           | 5: required if Compression is  |
    |                           | 2D Modified Read, fill bits    |
    +---------------------------+--------------------------------+
    | T6Options                 | 0: required if Compression is  |
    |                           | 2D Modified Modified Read      |
    +---------------------------+--------------------------------+
    | DocumentName*             | {ASCII}: name of scanned       |
    |                           | document                       |
    +---------------------------+--------------------------------+
    | PageNumber                | n,m: page number followed by   |
    |                           | total page count               |
    +---------------------------+--------------------------------+
    | New Fields                                                 |
    +---------------------------+--------------------------------+
    | BadFaxLines*              | number of "bad" scanlines      |
    |                           | encountered during reception   |
    +---------------------------+--------------------------------+
    | CleanFaxData*             | 0: no "bad" lines              |
    |                           | 1: "bad" lines exist, but were |
    |                           | regenerated by receiver        |
    |                           | 2: "bad" lines exist, but have |
    |                           | not been regenerated           |
    +---------------------------+--------------------------------+

McIntyre & Zilles         Expires 9/20/97                [Page 13]

Internet Draft     File Format for Internet Fax     March 20, 1997

    +---------------------------+--------------------------------+
    | ConsecutiveBadFaxLines*   | Max number of consecutive      |
    |                           | "bad" lines received           |
    +---------------------------+--------------------------------+
    | GlobalParametersIFD*      | <IFD>: global parameters IFD   |
    +---------------------------+--------------------------------+
    | ProfileType*              | n: type of data stored in      |
    |                           | TIFF file                      |
    +---------------------------+--------------------------------+
    | ITUFaxMode*               | n: ITU-compatible fax mode     |
    +---------------------------+--------------------------------+
    | CodingMethods*            | n: compression algorithms used |
    |                           | in file                        |
    +---------------------------+--------------------------------+
    | VersionNumber*            | n: version of ITU fax standard |
    +---------------------------+--------------------------------+
    | VersionYear*              | byte sequence with year of     |
    |                           | ITU fax standard               |
    +---------------------------+--------------------------------+


4.   Base Color Fax Mode

4.1.  Overview

This is the base mode for color and grayscale facsimile, which 
means that all applications that support color fax must support 
this mode. The basic approach is the lossy JPEG compression [T.81] 
of CIELAB color data [T.42]. Grayscale applications use the L* 
lightness component; color applications use the L*, a* and b* 
components.

This mode uses a new PhotometricInterpretation field value to 
describe the CIELAB encoding specified in [T.42]. Compared to the 
other two CIELAB-based values for this field, ITU-T Rec. T.42 
specifies a different default range for the a* and b* components, 
based on a comprehensive evaluation of existing hardcopy output. 
It optionally allows a selectable range for the L*, a* and b* 
components.

4.2.  Required TIFF fields

This section lists the required fields and the applications they 
must support to be compatible with ITU-T Rec. T.42 and Annex E in 
ITU-T Rec. T.4.





McIntyre & Zilles         Expires 9/20/97                [Page 14]

Internet Draft     File Format for Internet Fax     March 20, 1997

4.2.1.  Baseline Fields

ImageWidth.                                          SHORT or LONG
    This mode supports the following fixed page widths: 864, 1024, 
    1216, 1728, 2048, 2432, 2592, 3072, 3456, 3648, 4096, 4864.

BitsPerSample = 8, 12.                                       SHORT
Count = SamplesPerPixel
    The base color fax mode requires 8 bits per sample, with 12 as 
    an option. 12 bits per sample is not baseline TIFF.

Compression = 7.                                             SHORT
    Base color fax mode uses Baseline JPEG compression.  Value 7 
    represents JPEG compression as specified in [TTN2], which also 
    defines a new extension field JPEGTables that is not used 
    here.

PhotometricInterpretation = 10.                              SHORT
    Base color fax mode requires pixel values to be stored as 
    CIELAB, specified by the PhotometricInterpretation value 10, 
    referred to as ITULAB and which is based on the sample value 
    encoding defined in ITU-T Rec. T.42. With this encoding, the 
    minimum sample value is mapped to 0 and the maximum sample 
    value is mapped to (2^n - 1), i.e. the maximum value, where n 
    is BitsPerSample. 

    The conversion from unsigned ITULAB-encoded samples values to 
    signed CIELAB values is determined by the Decode field; see 
    Section 4.2.2

    PhotometricInterpretation values 8 and 9 also specify CIELAB 
    encodings, but with different, fixed ranges than ITU-T Rec. 
    T.42, and so are not used for color fax.

    Note: The intent of PhotometricInterpretation 10 is to broaden 
    the scope of the CIELAB parameter space and not just support 
    color fax. Therefore, the name and default Decode values are 
    still under discussion.

SamplesPerPixel = 1, 3.                                      SHORT
    1:  L* component only
    3:  L*, a*, b* components
    Encoded according to PhotometricInterpretation field

XResolution.                                              RATIONAL
YResolution.                                              RATIONAL
    The resolution of the image is expressed in pixels per 
    resolution unit.  In pixels per inch, allowed XResolution 


McIntyre & Zilles         Expires 9/20/97                [Page 15]

Internet Draft     File Format for Internet Fax     March 20, 1997

    values are: 100, 200, 300, and 400.  The base color fax mode 
    requires the pixels to be square, hence YResolution must equal 
    XResolution.

4.2.2  Extension fields

The JPEG compression standard allows for the a*b* chroma 
components of an image to be subsampled relative to the L* 
lightness component.  The extension fields ChromaSubSampling and 
ChromaPositioning define the subsampling.  They are the same as 
YCbCrSubSampling and YCbCrPositioning, which have been renamed to 
reflect their applicability to other color spaces.

ChromaSubSampling.                                           SHORT
Count = 2
    Specifies the subsampling factors for the chroma components of 
    a CIELAB image.  The two subfields of this field, 
    ChromaSubsampleHoriz and ChromaSubsampleVert, specify the 
    horizontal and vertical subsampling factors respectively.

SHORT 0: ChromaSubsampleHoriz = 1, 2, 4.
    1:  equal numbers of lightness and chroma samples 
        horizontally,
    2:  twice as many lightness samples as chroma samples 
        horizontally,
    4:  four times as many lightness samples as chroma samples 
        horizontally.

SHORT 1: ChromaSubsampleVert = 1, 2, 4.
    1:  equal numbers of lightness and chroma samples vertically,
    2:  twice as many lightness samples as chroma samples
        vertically,
    4:  four times as many lightness samples as chroma samples 
        vertically.

    The default value for ChromaSubSampling is (1,1) for 
    LAB-based images, which is an option for color fax. The color 
    fax default is (2,2), which must be specified explicitly in 
    the IFD.

ChromaPositioning = 1, 2.                                    SHORT
    Specifies the spatial positioning of chroma components 
    relative to the lightness component.  See the current TIFF 
    specification under YCbCrPositioning for further information.
    1:  centered,
    2:  cosited.
    Default = 1, which is what ITU-T T.4, Annex E specifies.



McIntyre & Zilles         Expires 9/20/97                [Page 16]

Internet Draft     File Format for Internet Fax     March 20, 1997

Decode.                                                     SSHORT
Count = 2 * SamplesPerPixel
    Describes how to map image sample values into the range of 
    values appropriate for the current color space.  In general, 
    the values are taken in pairs and specify the minimum and 
    maximum output value for each color component.  For the base 
    color fax mode, Decode maps from the ITULAB encoding to CIELAB 
    and has a count of 6 values.  In this case, the input is an 
    unsigned ITULAB-encoded value and the output is a signed 
    CIELAB value. 

      L* = Decode[0] + Lsample x (Decode[1]-Decode[0])/(2^n -1)

      a* = Decode[2] + asample x (Decode[3]-Decode[2])/(2^n -1)

      b* = Decode[4] + bsample x (Decode[5]-Decode[4])/(2^n -1)

    where Decode[0] is the minimum value for L*, Decode[1] is the 
    maximum value, etc. and n is the BitsPerSample field value, 
    either 8 or 12.
    
    ITU-T Rec. T.42 specifies the ITULAB encoding in terms of a 
    range and offset for each component, which are related 
    to the Decode field values as follows: 

      Decode[0] = - (Lrange x Loffset) / 2^n

      Decode[1] = Decode[0] + Lrange

    The following table gives the default range and offsets, as 
    specified in ITU-T Rec. T.42, and the corresponding minimum 
    and maximum CIELAB component and ITULAB encoded values.

    +-----------------------------------------------------------+
    | Component |    Rec. T.42     |  CIELAB    |  ITULAB       |
    |           |    defaults      |  values    |  encoding     |
    +-----------+------------------+------------+---------------+
    |           |  Range | Offset  |  Min | Max | Min |   Max   |
    +-----------+--------+---------+------+-----+-----+---------+
    |   L*      |   100  |    0    |    0 | 100 |  0  | 2^n - 1 |
    +-----------+--------+---------+------+-----+-----+---------+
    |   a*      |   170  |  128    |  -85 |  85 |  0  | 2^n - 1 |
    +-----------+--------+---------+------+-----+-----+---------+
    |   b*      |   200  |   96    |  -75 | 125 |  0  | 2^n - 1 |
    +-----------+--------+---------+------+-----+-----+---------+





McIntyre & Zilles         Expires 9/20/97                [Page 17]

Internet Draft     File Format for Internet Fax     March 20, 1997

    The default value for Decode is (0, 100, -85, 85, -75, 125), 
    which is based on the ITULAB encoding, with 
    PhotometricInterpretation 10, SamplesPerPixel 3, and 
    BitsPerSample 8. 

Note: The intent of PhotometricInterpretation 10 is to broaden 
    the scope of the CIELAB parameter space and not just support 
    color fax. Therefore, the name and default Decode values are 
    still under discussion.

4.2.3.  New fields

None.

4.3.  Recommended TIFF fields

See Sections 2.2.2. and 2.2.3.

4.4  Base Color Fax Mode Summary

Recommended fields are shown with an asterisk *

    +---------------------------+--------------------------------+
    | Baseline Fields           | Values                         |
    +---------------------------+--------------------------------+
    | BitsPerSample             | 8: 8 bits per color sample     |
    |                           | 12: optional 12 bits/sample    |
    +---------------------------+--------------------------------+
    | Compression               | 7: JPEG                        |
    +---------------------------+--------------------------------+
    | DateTime*                 | {ASCII}:  date/time in the     |
    |                           | 24-hour format                 |
    |                           | "YYYY:MM:DD HH:MM:SS"          |
    +---------------------------+--------------------------------+
    | ImageDescription*         | {ASCII}: A string describing   |
    |                           | the contents of the image.     |
    +---------------------------+--------------------------------+
    | ImageWidth                | 864, 1024, 1216, 1728, 2048,   |
    |                           | 2432, 2592, 3072, 3456, 3648,  |
    |                           | 4096, 4864                     |
    +---------------------------+--------------------------------+
    | ImageLength               | n: total number of scanlines   |
    |                           | in image                       |
    +---------------------------+--------------------------------+
    | NewSubFileType            | 2: Bit 1 identifies single page|
    |                           | of a multi-page document       |
    +---------------------------+--------------------------------+



McIntyre & Zilles         Expires 9/20/97                [Page 18]

Internet Draft     File Format for Internet Fax     March 20, 1997

    +---------------------------+--------------------------------+
    | Orientation*              | 1-8, Default 1                 |
    +---------------------------+--------------------------------+
    | PhotometricInterpretation | 10: ITULAB                     |
    +---------------------------+--------------------------------+
    | ResolutionUnit            | 2: inch                        |
    |                           | 3: centimeter                  |
    +---------------------------+--------------------------------+
    | RowsPerStrip              | n: number of scanlines per     |
    |                           | TIFF strip                     |
    +---------------------------+--------------------------------+
    | SamplesPerPixel           | 1: L* (lightness)              |
    |                           | 3: LAB                         |
    +---------------------------+--------------------------------+
    | Software*                 | {ASCII}: name & release number |
    |                           | of creator software            |
    +---------------------------+--------------------------------+
    | StripByteCounts           | <n>: number or bytes in        |
    |                           | TIFF strip                     |
    +---------------------------+--------------------------------+
    | StripOffsets              | <n>: offset from beginning     |
    |                           | of file to each TIFF strip     |
    +---------------------------+--------------------------------+
    | XResolution               | 100, 200, 300, 400 (written    |
    |                           | in pixels/inch)                |
    +---------------------------+--------------------------------+
    | YResolution               | equal to XResolution (pixels   |
    |                           | must be square)                |
    +---------------------------+--------------------------------+
    | Extension Fields                                           |
    +---------------------------+--------------------------------+
    | DocumentName*             | {ASCII}: name of scanned       |
    |                           | document                       |
    +---------------------------+--------------------------------+
    | PageNumber                | n,m: page number followed by   |
    |                           | total page count               |
    +---------------------------+--------------------------------+
    | Decode                    | minL, maxL, mina, maxa, minb,  |
    |                           | maxb: minimum and maximum      |
    |                           | values for CIELAB              |
    +---------------------------+--------------------------------+
    | ChromaSubSampling         | ChromaSubsampleHoriz:          |
    |                           | 0: equal numbers of lightness  |
    |                           | and chroma samples             |
    |                           | 1: twice as many lightness     |
    |                           | samples as chroma samples      |




McIntyre & Zilles         Expires 9/20/97                [Page 19]

Internet Draft     File Format for Internet Fax     March 20, 1997

    |                           | 2: four times as many          |
    |                           | lightness samples as chroma    |
    |                           | samples                        |
    |                           | ChromaSubsampleVert:           |
    |                           | 0: equal numbers of lightness  |
    |                           | and chroma samples             |
    |                           | 1: twice as many lightness     |
    |                           | samples as chroma samples      |
    |                           | 2: four times as many lightness|
    |                           | samples as chroma samples      |
    +---------------------------+--------------------------------+
    | ChromaPositioning         | 1: centered                    |
    |                           | 2: cosited                     |
    +---------------------------+--------------------------------+
    | New Fields                                                 |
    +---------------------------+--------------------------------+
    | GlobalParametersIFD*      | <IFD>: IFD containing          |
    |                           | global parameters              |
    +---------------------------+--------------------------------+
    | ProfileType*              | n: type of data stored in      |
    |                           | TIFF file                      |
    +---------------------------+--------------------------------+
    | ITUFaxMode*               | n: ITU-compatible fax mode     |
    +---------------------------+--------------------------------+
    | CodingMethods*            | n: compression algorithms      |
    |                           | used in file                   |
    +---------------------------+--------------------------------+
    | VersionNumber*            | n: version of ITU fax standard |
    +---------------------------+--------------------------------+
    | VersionYear*              | byte sequence with year of     |
    |                           | ITU fax standard               |
    +---------------------------+--------------------------------+


5.   Lossless Color Mode

5.1.  Overview

This mode, defined in [T.43], uses JBIG to losslessly code three 
types of color and grayscale images: one bit per color CMY, CMYK 
and RGB images; a palettized (i.e. mapped) color image; and 
continuous tone color and grayscale images. The last two are 
multi-level and use the CIELAB encoding specified in [T.42].







McIntyre & Zilles         Expires 9/20/97                [Page 20]

Internet Draft     File Format for Internet Fax     March 20, 1997

5.1.1.  Color Encoding

While under development, this mode was called T.Palette, as one of 
its major additions was palette or mapped color images. Baseline 
TIFF only allows RGB color maps, but ITU-T Rec. T.43 requires 
CIELAB color maps, using the encoding specified in ITU-T Rec. 
T.42. Palette color images are expressed with indices (bits per 
sample) of 12 bits or less, or optionally 13 to 16 bits. 

To enable T.43 color maps in TIFF requires the extension field 
Indexed, defined in [TTN1], and the PhotometricInterpretation 
field value 10, defined in Section 4.2.1. The following table 
shows how T.43 image data is interpreted, using the 
PhotometricInterpretation, SamplesPerPixel, BitsPerSample and 
Indexed fields.

    +----------------------------------------------------------+
    | Image Type | PhotoInter- | Samples  | Bits Per | Indexed |
    |            |   pretation | PerPixel |  Sample  |         |
    |------------+-------------+----------+----------+---------|
    |     RGB    |    2=RGB    |     3    |    1     |    0    |
    +----------------------------------------------------------+
    |     CMY    |    5=CMYK   |     3    |    1     |    0    |
    +------------+-------------+----------+----------+---------+
    |     CMYK   |    5=CMYK   |     4    |    1     |    0    |
    +------------+-------------+----------+----------+---------+
    |   Palette  |  10=ITULAB  |     1    |    n     |    1    |
    +------------+-------------+----------+----------+---------+
    |  Grayscale |  10=ITULAB  |     1    |   8, 12  |    0    |
    +------------+-------------+----------+----------+---------+
    |    Color   |  10=ITULAB  |     3    |   8, 12  |    0    |
    +------------+-------------+----------+----------+---------+

5.1.2.  JBIG Encoding

T.43 uses the single-progression sequential mode of JBIG, defined 
in ITU-T Rec. T.82, in accordance with the application rules 
described in ITU-T Rec. T.85. To code multi-level images using 
JBIG, which is a bi-level compression method, an image is resolved 
into a set of bit-planes using Gray code conversion, and each bit-
plane is then JBIG compressed. The Gray code conversion is part of 
the data stream encoding, and is therefore invisible to TIFF.

5.2.  Required TIFF Fields

This section lists the required fields and the values they must 
have to be compatible with ITU-T Rec. T.43.



McIntyre & Zilles         Expires 9/20/97                [Page 21]

Internet Draft     File Format for Internet Fax     March 20, 1997

5.2.1.  Baseline fields

ImageWidth.                                          SHORT or LONG
    Same page widths as the base color mode; see Section 4.2.1.

BitsPerSample = 1, 8, 9-16.                                  SHORT
Count = SamplesPerPixel
    RGB, CMY, CMYK: 1 bit per sample
    Continuous tone (CIELAB): 8 bits per sample, 12 bits optional
    Palette color: 12 or fewer bits per sample, 13-16 bits
    optional 
    Note: More than 8 bits per sample is not baseline TIFF.

ColorMap.                                                    SHORT
Count = 3 * (2**BitsPerSample)
    Lossless color fax mode supports palette-color (indexed) 
    images where the single component value is used as an index 
    into a full color lookup table stored in the ColorMap field. 
    With lossless color fax mode, only the ITULAB encoding with 8 
    bits per sample is supported for palette-color images.  To 
    utilize a color map, the TIFF Indexed field must be present. 
    TIFF orders the color map values so that all the L* values 
    come first, followed by all the a* values and then all the b* 
    values. Because ITU-T Rec. T.43 specifies a "chunky" ordering 
    with the L*a*b*components of the first value, followed by 
    those of the second value, and so on, transferring color map 
    values between a TIFF file and fax data stream requires 
    reordering values.

Compression = 9.                                             SHORT
    9:   ITU-T Rec. T.82 coding, applying ITU-T Rec. T.85 (JBIG)

FillOrder = 1, 2.                                            SHORT
    This field is only relevant for 1 bit per sample color (RGB, 
    CMY, CMYK); see Section 3.2.1 for further information.

PhotometricInterpretation = 2, 5, 10.                        SHORT
    2:  RGB
    5:  CMYK, including CMY
    10: ITULAB 

    Image data may also be stored as palette color images, where
    pixel values are represented by a single component that is an
    index into a color map using the ITULAB encoding.  This color
    map is specified by the ColorMap field.  To use palette color
    images, set the PhotometricInterpretation to 10, 




McIntyre & Zilles         Expires 9/20/97                [Page 22]

Internet Draft     File Format for Internet Fax     March 20, 1997

    SamplesPerPixel to 1, and Indexed to 1.  The color map is 
    stored in the ColorMap field.  See Section 5.1.1 for further 
    discussion on the color encoding.

SamplesPerPixel = 1, 3, 4.                                   SHORT
    1:  Palette color image, or L*-only if Indexed = 0 and 
        PhotometricInterpretation is 10 (ITULAB).
    3:  RGB, or CIELAB, or CMY if PhotometricInterpretation is 5 
        (CMYK).
    4:  CMYK.

XResolution.                                              RATIONAL
YResolution.                                              RATIONAL
    The resolution of the image is expressed in pixels per 
    resolution unit.  In pixels per inch, allowed XResolution 
    values are: 100, 200, 300, and 400.  The lossless color fax 
    mode requires the pixels to be square, hence YResolution must 
    equal XResolution.

5.2.2.  Extension fields

Indexed = 0, 1.                                              SHORT
    0:  not a palette-color image
    1:  palette-color image
    This field is used to indicate that the sample values are an 
    index into an array of color values specified in the ColorMap 
    field. Lossless color fax mode supports palette-color images 
    with the ITULAB encoding.  The SamplesPerPixel value must be 
    1.

Decode                                                       SHORT
    Decode is used in connection with the ITULAB encoding of image 
    data; see Section 4.2.2.


5.2.3.  New Fields

None.

5.3.  Recommended TIFF fields

See Sections 2.2.2. and 2.2.3.








McIntyre & Zilles         Expires 9/20/97                [Page 23]

Internet Draft     File Format for Internet Fax     March 20, 1997

5.4.  Lossless Color Fax Mode Summary

Recommended fields are shown with an asterisk *
     +--------------------|--------------------------------------+
     |   Baseline Fields  |             Values                   |
     +--------------------+--------------------------------------+
     | BitsPerSample      | 1: Binary RGB, CMY(K)                |
     |                    | 8: 8 bits per color sample           |
     |                    | 9-16: optional                       |
     +--------------------+--------------------------------------+
     | ColorMap           | n: LAB color map                     |
     +--------------------+--------------------------------------+
     | Compression        | 9: JBIG                              |
     +--------------------+--------------------------------------+
     | DateTime*          | {ASCII}:  date/time in the 24-hour   |
     |                    | format "YYYY:MM:DD HH:MM:SS"         |
     +--------------------+--------------------------------------+
     | FillOrder          | Applies only to 1 bit/sample         |
     |                    | encodings                            |
     |                    | 1: Most significant bit first        |
     |                    | 2: Least significant bit first       |
     +--------------------+--------------------------------------+
     | ImageDescription*  | {ASCII}: A string describing the     |
     |                    | contents of the image.               |
     +--------------------+--------------------------------------+
     | ImageWidth         | 864, 1024, 1216, 1728, 2048, 2432,   |
     |                    | 2592, 3072, 3456, 3648, 4096, 4864   |
     +--------------------+--------------------------------------+
     | ImageLength        | n: total number of scanlines in image|
     +--------------------+--------------------------------------+
     | NewSubFileType     | 2: Bit 1 identifies single page of a |
     |                    | multi-page document                  |
     +--------------------+--------------------------------------+
     | Orientation*       | 1-8, Default 1                       |
     +--------------------+--------------------------------------+
     | PhotometricInter-  | 2: RGB                               |
     | pretation          | 5: CMYK                              |
     |                    | 10: ITULAB                           |
     +--------------------+--------------------------------------+
     | ResolutionUnit     | 2: inch                              |
     |                    | 3: centimeter                        |
     +--------------------+--------------------------------------+
     | RowsPerStrip       | n: number of scanlines per TIFF strip|
     +--------------------+--------------------------------------+
     | SamplesPerPixel    | 1: L* (lightness)                    |
     |                    | 3: LAB, RGB, CMY                     |
     |                    | 4: CMYK                              |
     +--------------------+--------------------------------------+


McIntyre & Zilles         Expires 9/20/97                [Page 24]

Internet Draft     File Format for Internet Fax     March 20, 1997

     +--------------------+--------------------------------------+
     | Software*          | {ASCII}: name & release number of    |
     |                    | creator software                     |
     +--------------------+--------------------------------------+
     | StripByteCounts    | <n>: number or bytes in TIFF strip   |
     +--------------------+--------------------------------------+
     | StripOffsets       | <n>: offset from beginning of file to|
     |                    | each TIFF strip                      |
     +--------------------+--------------------------------------+
     | XResolution        | 100, 200, 300, 400 (written in       |
     |                    | pixels/inch)                         |
     | YResolution        | equal to XResolution (pixels must be |
     |                    | square)                              |
     +--------------------+--------------------------------------+
     | Extension Fields                                          |
     +--------------------+--------------------------------------+
     | Decode             | minL, maxL, mina, maxa, minb, maxb:  |
     |                    |minimum and maximum values for CIELAB |
     +--------------------+--------------------------------------+
     | DocumentName*      | {ASCII}: name of scanned document    |
     +--------------------+--------------------------------------+
     | PageNumber         | n,m: page number followed by total   |
     |                    | page count                           |
     +--------------------+--------------------------------------+
     | Indexed            | 0: not a palette-color image         |
     |                    | 1: palette-color image               |
     +--------------------+--------------------------------------+
     | New Fields                                                |
     +--------------------+--------------------------------------|
     | GlobalParameters   | <IFD>: global parameters IFD         |
     | IFD*               |                                      |
     +--------------------+--------------------------------------+
     | ProfileType*       | n: type of data stored in TIFF file  |
     +--------------------+--------------------------------------+
     | ITUFaxMode*        | n: ITU-compatible fax mode           |
     +--------------------+--------------------------------------+
     | CodingMethods*     | n:compression algorithms used in     |
     |                    | file                                 |
     +--------------------+--------------------------------------+
     | VersionNumber*     | n: version of ITU fax standard       |
     +--------------------+--------------------------------------+
     | VersionYear*       | byte sequence with year of ITU fax   |
     |                    | standard                             |
     +--------------------+--------------------------------------+






McIntyre & Zilles         Expires 9/20/97                [Page 25]

Internet Draft     File Format for Internet Fax     March 20, 1997


6.   Mixed Raster Content Mode

6.1.  Overview

Unlike previous fax modes, which use a single coding method and 
spatial resolution for an entire fax page, the Mixed Raster 
Content mode [MRC] enables different coding methods and 
resolutions within a single page. For example, consider a page 
that contains black-and-white text, which is best coded with MMR 
or JBIG, a color bar chart, best coded with JBIG, and a scanned 
color image, best coded with JPEG. Similarly, while spatial 
resolution of 400 pixels per inch may be best for the black-and-
white text, 200 pixel per inch is usually sufficient for a color 
image. 

Rather than applying one coding method and resolution to all 
elements, MRC allows multiple coders and resolutions within a 
page. By itself, MRC does not define any new coding methods or 
resolutions. Instead it defines a 3-layer model for structuring 
and combining the scanned image data. 

The ITU MRC document is currently a draft. However, its technical 
content is stable, and editorial changes only are permitted 
between now and its scheduled approval in October 1997. Upon 
approval, the MRC document will become ITU-T Recommendation T.44.

6.1.1. MRC 3-layer model

The 3 layers of the MRC model are Foreground and Background, which 
are both multi-level, and Mask, which is bi-level. Each layer may 
appear only once on a page and is coded independently of the other 
two. In our earlier example, the black-and-white text could be in 
the Mask layer, the color chart in the Foreground layer, and the 
color image in the Background layer. The distribution of content 
among layers is determined by the writer, as is the choice of 
compression method, color encoding and spatial resolution for a 
layer.

The final image is obtained by using the Mask layer to select 
pixels from the other two layers. When the Mask layer pixel value 
is 1, the corresponding pixel from the Foreground layer is 
selected; when it is 0, the corresponding pixel from the 
Background layer is selected. Details are given in Appendix 1 of 
[MRC].





McIntyre & Zilles         Expires 9/20/97                [Page 26]

Internet Draft     File Format for Internet Fax     March 20, 1997

Not all pages, and not all parts of a page, require 3 layers. If 
there is only one layer present, then that layer is the primary 
image and must be page size. If there is more than one layer, then 
the Mask must be one of the layers, in which case it is the 
primary image and must be page size.

MRC allows a page to be split into strips, with a variable number 
of scanlines in a strip. A strip can have 1, 2 or 3 layers. A 
single, stripped layer may be stored as a single, stripped image 
in an IFD, e.g., all strips associated with the Background 
layer may be treated as a single image.  Alternatively, each strip 
associated with a layer may be stored as a separate image or IFD, 
e.g., the Background layer can be composed of several images that 
are offset vertically with respect to the page.  In this case, 
there can be no overlap between images associated with a single 
layer.

Furthermore, color fax also requires the spatial resolutions of 
Background and Foreground images to be integer factors of the Mask 
image resolution. For example, if the Mask Layer is 400 
pixels per inch, then the Background layer can be 100, 200 or 400 
pixels per inch.


6.1.2.  A TIFF Representation for the MRC 3-layer model

In the TIFF representation of the 3-layer MRC model, each page is 
represented by a single IFD, called the Primary IFD, that 
represents the Mask layer (unless the Foreground or 
Background is the single layer present), and a set of child IFDs 
that are referenced through the SubIFDs extension field. The 
structure of SubIFDs is described in [TTN1]. To distinguish MRC-
specific SubIFDs from other SubIFDs, the NewSubFileType field will 
have Bit 4 ON, indicating an MRC-related IFD. A new ImageLayer 
field is also introduced that consists of two values which 
identify the layer (Foreground, Background, or Mask) and the order 
within the layer (first, second, ... image of the layer); see 
Section 6.2.3. 

Because MRC allows strips with variable numbers of scanlines, a 
new StripRowCounts field is introduced to replace the RowsPerStrip 
field in this mode. The StripRowCounts field allows each layer, 
with a variable number of scanlines in each strip, to be 
represented by a single IFD. Alternatively, each strip in the 
Foreground and Background layers can be represented by a single 
IFD at the option of the writer.  In all cases, the Mask layer is 
required to be represented by a single IFD.



McIntyre & Zilles         Expires 9/20/97                [Page 27]

Internet Draft     File Format for Internet Fax     March 20, 1997

The use of SubIFDs to store child IFDs is described in [TTN1].  An 
example is shown graphically below.  The Primary IFD associated 
with page 1 (PrimaryIFD 0) points to page 2 (PrimaryIFD 1) with 
the nextIFD offset.  The Primary IFD, corresponding to the Mask 
layer (ImageLayer=[2,1]), contains a SubIFDs field that points to 
a list of child IFDs.  The first child IFD represents one image of 
the Background layer, i.e., ImageLayer=[1,1].  This child IFD 
points to the second child IFD via the nextIFD offset.  This child 
represents the second Background layer image, ImageLayer=[1,2].  
Finally, the second child points to the third child, which 
corresponds to the single Foreground layer image, 
ImageLayer=[3,1].  The next IFD offset associated with this 
Foreground image is 0, indicating no more child IFDs exist.  Each 
primary IFD has the NewSubFileType set to 18, indicating the IFD 
is MRC-specific (bit 4) and that it is a single page of a multi-
page document (bit 1).  Each child IFD has the NewSubFileType set 
to 16, indicating the IFD is MRC-specific.  Note: the 'V' 
character should be read as a down-pointing arrow.


                     (nextIFD)
    PRIMARY IFD 0  ------------> PRIMARY IFD 1--> ...
        ImageLayer = [2,1]
        NewSubFileType = 18
        SubIFDs
             |
             V
          Child IFD
             ImageLayer = [1,1]
             NewSubFileType = 16
             |
             |(nextIFD)
             |
             V
          Child IFD
             ImageLayer = [1,2]
             NewSubFileType = 16
             |
             |(nextIFD)
             |
             V
          Child IFD
             ImageLayer = [3,1]
             NewSubFileType = 16
             |
             |(nextIFD)
             |
             V
             0

McIntyre & Zilles         Expires 9/20/97                [Page 28]

Internet Draft     File Format for Internet Fax     March 20, 1997

In the example above, the SubIFDs field of the Primary IFD points 
to the first IFD in a list of child IFDs.  TIFF allows the 
SubIFDs field to point to an array of IFDs, each of which can be 
the first of a list of IFDs.  An MRC-enabled TIFF reader must scan 
all available child IFDs to locate and identify IFDs associated 
with MRC layers.

In the case where the Background or Foreground layers are 
described with multiple IFDs, the XPosition and YPosition TIFF 
fields specify the offset to the upper-left corner of the IFD with 
respect to the Mask layer; see Section 6.2.2.

When there is only a single layer (Mask, Foreground, or 
Background), it is stored as the Primary IFD.

6.2.  Required TIFF Fields

This section describes the TIFF fields required to store MRC mode 
fax images.  Since MRC mode stores the fax data as a collection of 
images corresponding to layers or parts of layers, the compression 
mechanisms, color encodings and spatial resolutions used by 
previous modes apply to MRC.  Therefore, the descriptions here 
will typically reference the appropriate earlier section.  Fields 
and values specific to MRC mode are pointed out.

6.2.1.  Baseline fields

ImageWidth.                                          SHORT or LONG
     Same page widths as the base color mode; see Section 4.2.1.

BitsPerSample = 1, 8, 9-16                                   SHORT
Compression = 2, 3, 4, 7, 9.                                 SHORT
SamplesPerPixel = 1, 3, 4.                                   SHORT
FillOrder = 1, 2.                                            SHORT
PhotometricInterpretation = 0, 1, 2, 5, 10.                  SHORT
    For Mask layer, see Section 3.2.1.
    For Foreground and Background layers, see Sections 4.2.1 and 
    5.2.1.

ColorMap.                                                    SHORT
Count = 3 * (2**BitsPerSample)
    Used when Foreground or Background layer is a palette-color 
    image; see Section 5.2.1.

NewSubFileType = 16, 18.                                      LONG
    For MRC fax mode, the NewSubFileType field has two bits that 
    are required.  Bit 1 indicates a single page of a multi-page 
    document and must be set for the Primary IFDs; bit 4 indicates 


McIntyre & Zilles         Expires 9/20/97                [Page 29]

Internet Draft     File Format for Internet Fax     March 20, 1997

    MRC imaging model as described in ITU-T Recommendation Draft 
    T.44 [MRC], and must be set for Primary IFDs and all 
    MRC-specific child IFDs.

StripRowCounts.                                               LONG
Tag = 559 (0x022F)
Count = number of strips
    The number of scanlines stored in a strip. MRC allows each fax 
    strip to store a different number of scanlines, up to a 
    specified maximum strip size, which is either 256 scanlines or 
    the page length in scanlines, depending on the implementation.  
    This field replaces RowsPerStrip for IFDs with variable-sized 
    strips. Only one of the two fields, StripRowCounts and 
    RowsPerStrip, may be used in an IFD.

XResolution.                                              RATIONAL
YResolution.                                              RATIONAL
    The resolution of the image is expressed in pixels per 
    resolution unit.  In pixels per inch, allowed XResolution 
    values are: 100, 200, 300, and 400.  MRC color fax mode 
    requires the pixels to be square, hence YResolution must equal 
    XResolution.

6.2.2.  Extension fields

ChromaSubSampling.                                           SHORT
ChromaPositioning.                                           SHORT
Decode.                                                      SHORT
    For Foreground and Background layers, see Section 4.2.2.

Indexed = 0, 1.                                              SHORT
    For Foreground and Background layers: 1 indicates a palette-
    color image, see Section 5.2.2.

T4Options = 0, 1, 4, 5.                                      SHORT
T6Options = 0.                                               SHORT
    For Mask layer, see Section 3.2.2.

DefaultImageColor.                                   SHORT or LONG
Count = SamplesPerPixel
    In areas where no image data is available, a default color is
    needed to specify the color value. If the 
    StripByteCounts value for a strip is 0, then the color for 
    that strip must be defined by a default image color.

    The DefaultImageColor field uses the same encoding as the 
    image data, and its value is therefore interpreted using the 
    PhotometricInterpretation, SamplesPerPixel, BitsPerSample, and 
    Indexed fields.  If the fax data stream requires a different 

McIntyre & Zilles         Expires 9/20/97                [Page 30]

Internet Draft     File Format for Internet Fax     March 20, 1997

    encoding, then transferring the default color value between a 
    TIFF file and fax data stream requires a color conversion.

    The default value for the DefaultImageColor field is white.

XPosition.                                                RATIONAL
YPosition.                                                RATIONAL
    Specifies the horizontal and vertical offsets of the top-left 
    of the IFD from the top-left of the Primary IFD in page 
    resolution units.  For example, if the Primary IFD is at 400 
    pixels per inch, and a foreground layer IFD is at 200 pixels 
    per inch and located at pixel coordinate (345, 678) with 
    respect to the Primary IFD, the XPosition value is 345/400 and 
    the YPosition value is 678/400.
    
    Color fax does not currently allow overlap of any component 
    images within a single layer.
    
    Default values for XPosition and YPosition are 0.

6.2.3.  New fields

MRC Color fax mode requires one new field:  ImageLayer.

ImageLayer.                                         SHORT or LONG.
Count = 2
Tag = 0x87ac
    Image layers are defined such that layer 1 is the Background 
    layer, layer 3 is the Foreground layer, and layer 2 is the 
    Mask layer that selects pixels from the Background and 
    Foreground layers.  The ImageLayer tag contains two values, 
    describing the layer to which the image belongs and the order 
    in which it is imaged.

ImageLayer[0]: 1, 2, 3.
    1:  Image is a Background image, i.e., the image that will 
        appear whenever the Mask contains a value of 0.  
        Background images typically contain low-resolution, 
        continuous-tone imagery.
    2:  Image is the Mask layer.  In MRC, if the Mask layer is 
        present, it must be the Primary IFD and be full page in 
        extent (no gaps.)
    3:  Image is a Foreground image, i.e., the image that will 
        appear whenever the Mask contains a value of 1.  The 
        Foreground image generally defines the color of text or 
        lines, but may also contain high-resolution imagery.




McIntyre & Zilles         Expires 9/20/97                [Page 31]

Internet Draft     File Format for Internet Fax     March 20, 1997

ImageLayer[1]:
    1:  first image to be imaged in this layer (e.g., first fax 
        strip),
    2:  second image to be imaged in this layer (e.g., second fax
        strip),
    3:  ...
    Value describing the image order.  In MRC, this 
    may be considered the strip number.  Since MRC mode currently
    does not allow overlap between images within a layer, the
    order value does not have any visual effect.

In MRC fax mode, it is possible that only a single layer is 
transmitted.  For example, if a page contains only a single 
continuous-tone photograph, then only the Background layer may be 
transmitted.  In this case, the Background layer will be full page 
and stored as the Primary IFD.  ImageLayer[0] will be 1 indicating 
Background;  ImageLayer[1] will be 1 since the layer must be full 
page and there can be no other IFDs associated with that layer.  
No Mask layer will exist. 

6.3.   Recommended TIFF fields

See Sections 2.2.2. and 2.2.3.

6.4.   Rules and Requirements for Images

The MRC mode defines a fundamental set of rules for images in the 
3-layer representation.

    1.  If more than one layer exists, then the binary Mask layer 
        must be present and it is the primary image. If only one 
        layer exists, then the image corresponding to that layer 
        is the primary image.
    2.  The Primary image defines and extends to the entire page 
        boundary;  all attached model images cannot extend beyond 
        the Primary image. Resolution differences may cause some 
        pixels to "hang over" the page boundary, but no new pixels 
        should exist completely beyond the page extent
    3.  The Background and Foreground images may use any color 
        encoding defined in Sections 4 and 5, and may optionally 
        cover only a portion of the region defined by the Primary 
        image, unless one of them is the primary image.
    4.  Each Primary IFD and each MRC-specific SubIFD must have
        an ImageLayer field to specify which layer the IFD belongs 
        to, and the imaging order of that IFD within the layer.
    5.  Each Primary IFD must have a NewSubFileType field value
        set to 18, indicating a single page of a multi-page 
        document (bit 1) and MRC mode (bit 4).


McIntyre & Zilles         Expires 9/20/97                [Page 32]

Internet Draft     File Format for Internet Fax     March 20, 1997

    6.  Each MRC-specific child IFD must have a NewSubFileType 
        field value set to 16, indicating MRC mode (bit 4).
    7.  In MRC mode, each layer is transmitted as a sequence of 
        strips.  It is possible that each strip of each layer can 
        be stored as a separate IFD.  In this case, the SubIFDs 
        structure pointed to by the Primary IFD will contain 
        several IFDs that have an ImageLayer field with the layer 
        identified as either Background (layer 1) or Foreground 
        (layer 3).  There may be no overlap in the vertical 
        direction between IFDs associated with a single layer, 
        although there may be a gap from one of these images to 
        the next.  The TIFF XPosition and YPosition fields are 
        used to indicate the placement of these images with 
        respect to the primary image.
    8.  The resolution of Background and Foreground images 
        must each be an integer factor of the Primary image.  For 
        example, if the Primary image is 400 pixels/inch, then the 
        model images may be at 400 pixels/inch (400 / 1), 200 
        pixels/inch (400 / 2), 100 pixels/inch (400 / 4), etc.

6.5.   MRC Fax Mode Summary

Recommended fields are shown with an asterisk *
    +------------------+-----------------------------------------+
    | Baseline Fields  |               Values                    |
    |------------------|-----------------------------------------|
    | BitsPerSample    | 1: binary mask                          |
    |                  | 8: 8 bits per color sample              |
    |                  | 9-16: optional 12 bits/sample           |
    +------------------+-----------------------------------------+
    | ColorMap         | n: LAB color map                        |
    +------------------+-----------------------------------------+
    | Compression      | 2: Modified Huffman                     |
    |                  | 3: Modified Read                        |
    |                  | 4: Modified Modified Read               |
    |                  | 7: JPEG                                 |
    |                  | 9: JBIG                                 |
    +------------------+-----------------------------------------+
    | DateTime*        | {ASCII): date/time in the 24-hour format|
    |                  | "YYYY:MM:DD HH:MM:SS"                   |
    +------------------+-----------------------------------------|
    | FillOrder        | Applies only to 1 bit/sample encodings  |
    |                  | 1: Most significant bit first           |
    |                  | 2: Least significant bit first          |
    +------------------+-----------------------------------------+
    | ImageDescription*| {ASCII}: A string describing the        |
    |                  | contents of the image.                  |
    +------------------+-----------------------------------------+


McIntyre & Zilles         Expires 9/20/97            [Page 33]

Internet Draft     File Format for Internet Fax     March 20, 1997

    +------------------+-----------------------------------------+
    | ImageWidth       | 864, 1024, 1216, 1728, 2048, 2432, 2592,|
    |                  | 3072, 3456, 3648, 4096, 4864            |
    +------------------+-----------------------------------------+
    | ImageLength      | n: total number of scanlines in image   |
    +------------------+-----------------------------------------|
    | NewSubFileType   | 16, 18:                                 |
    |                  | Bit 1 indicates single page of a multi- |
    |                  | page document on Primary IFD            |
    |                  | Bit 4 indicates MRC model               |
    +------------------+-----------------------------------------+
    | Orientation*     | 1-8, Default 1                          |
    +------------------+-----------------------------------------+
    | PhotometricInter | 0: WhiteIsZero                          |
    | pretation        | 1: BlackIsZero                          |
    |                  | 2: RGB                                  |
    |                  | 5: CMYK                                 |
    |                  | 10: ITULAB                              |
    +------------------+-----------------------------------------+
    | ResolutionUnit   | 2: inch                                 |
    |                  | 3: centimeter                           |
    +------------------+-----------------------------------------+
    | RowsPerStrip     | n: number of scanlines in each strip    |
    +------------------+-----------------------------------------+
    | SamplesPerPixel  | 1: L* (lightness)                       |
    |                  | 3: RGB, LAB, CMY                        |
    |                  | 4: CMYK                                 |
    +------------------+-----------------------------------------+
    | Software*        | {ASCII}: name & release number of       |
    |                  | creator software                        |
    +------------------+-----------------------------------------+
    | StripByteCounts  | <n>: number or bytes in TIFF strip      |
    +------------------+-----------------------------------------+
    | StripOffsets     | <n>: offset from beginning of file to   |
    |                  | each TIFF strip                         |
    +------------------+-----------------------------------------|
    | XResolution      | 100, 200, 300, 400 (written in          |
    |                  | pixels/inch)                            |
    +------------------+-----------------------------------------|
    | YResolution      | equal to XResolution (pixels must be    |
    |                  | square)                                 |
    +------------------+-----------------------------------------+
    | Extension Fields                                           |
    +------------------+-----------------------------------------+
    | T4Options        | 0: required if Compression is           |
    |                  | Modified Huffman, no fill bits          |
    |                  | 1: required if Compression is 2D        |
    |                  | Modified Read, no fill bits             |


McIntyre & Zilles         Expires 9/20/97            [Page 34]

Internet Draft     File Format for Internet Fax     March 20, 1997

    |                  | 4: required if Compression is Modified  |
    |                  | Huffman, fill bits                      |
    |                  | 5: required if Compression is 2D        |
    |                  | Modified Read, fill bits                |
    +------------------+-----------------------------------------+
    | T6Options        | 0: required if Compression is 2D        |
    |                  | Modified Modified Read                  |
    +------------------+-----------------------------------------+
    | DocumentName*    | {ASCII}: name of scanned document       |
    +------------------+-----------------------------------------+
    | PageNumber       | n,m: page number followed by total page |
    |                  | count                                   |
    +------------------+-----------------------------------------+
    | Decode           | minL, maxL, mina, maxa, minb, maxb:     |
    |                  | minimum and maximum values for CIELAB   |
    +------------------+-----------------------------------------+
    | ChromaSubSampling| ChromaSubsampleHoriz:                   |
    |                  | 0: equal numbers of lightness and chroma|
    |                  | samples                                 |
    |                  | 1: twice as many lightness samples as   |
    |                  | chroma samples                          |
    |                  | 2: four times as many lightness samples |
    |                  | as chroma samples                       |
    |                  | ChromaSubsampleVert:                    |
    |                  | 0: equal numbers of lightness and chroma|
    |                  | samples                                 |
    |                  | 1: twice as many lightness samples as   |
    |                  | chroma samples                          |
    |                  | 2: four times as many lightness samples |
    |                  | as chroma samples                       |
    +------------------+-----------------------------------------+
    | ChromaPositioning| 1: centered                             |
    |                  | 2: cosited                              |
    +------------------+-----------------------------------------+
    | DefaultImageColor| <n>: background color                   |
    +------------------+-----------------------------------------+
    | Indexed          | 0: not a palette-color image            |
    |                  | 1: palette-color image                  |
    +------------------+-----------------------------------------+
    | SubIFDs          | <IFD>: byte offset to fg/bg IFDs        |
    +------------------+-----------------------------------------+
    | XPosition        | horizontal offset in primary IFD        |
    |                  | coordinates                             |
    +------------------+-----------------------------------------+
    | YPosition        | vertical offset in primary IFD          |
    |                  | coordinates                             |
    +------------------+-----------------------------------------+



McIntyre & Zilles         Expires 9/20/97          [Page 35]

Internet Draft     File Format for Internet Fax     March 20, 1997

    +------------------+-----------------------------------------+
    | New Fields                                                 |
    +------------------+-----------------------------------------+
    | ImageLayer       | n, m: layer number, imaging sequence    |
    |                  | (e.g., strip number)                    |
    +------------------+-----------------------------------------+
    | GlobalParameters | <IFD>: global parameters IFD            |
    | IFD*             |                                         |
    +------------------+-----------------------------------------+
    | ProfileType*     | n: type of data stored in TIFF file     |
    +------------------+-----------------------------------------+
    | ITUFaxMode*      | n: ITU-compatible fax mode              |
    +------------------+-----------------------------------------+
    | CodingMethods*   | n: compression algorithms used in file  |
    +------------------+-----------------------------------------+
    | VersionNumber*   | n: version of ITU fax standard          |
    +------------------+-----------------------------------------+
    | VersionYear*     | byte sequence with year of ITU fax      |
    |                  | standard                                |
    +------------------+-----------------------------------------+


7.   MIME sub-type

The draft proposes to redefine the image/tiff sub-type to 
correspond to the current TIFF specification, Revision 6.0, dated 
June 3, 1992, with the addition of the new fields defined here.  
Further, an optional application parameter is proposed that would 
distinguish subsets of the image/tiff subtype.


8.   IANA Registration

To: ietf-types@iana.org

Subject: Registration of Standard MIME media type image/tiff

MIME media type name: image

MIME subtype name: tiff

Required parameters: none

Optional parameters: application

    The value of the application parameter of image/tiff is 
    denoted by a single letter or a pair of letters.  Three 
    applications are proposed. 


McIntyre & Zilles         Expires 9/20/97          [Page 36]

Internet Draft     File Format for Internet Fax     March 20, 1997

    B - multi-page bi-level monochrome images [RFC1314].

    F - the current reference for the image/tiff subtype 
        [RFC1528], with adds from work in progress [TIFF-F]

    FX - this specification, with ITU-fax-compatible parameter 
         values

    There is no default value for application, and in the absence
    of the application parameter, the user should assume baseline 
    TIFF.

Encoding considerations: binary or base64 generally preferred

Security considerations: The security issues associated with this 
    type have not been assessed.

Interoperability considerations: image/tiff, class=FX is intended 
    for interoperability between ITU and Internet fax data 
    formats.

Published specification: TIFF Revision 6.0 is available at: 
    ftp://ftp.adobe.com/pub/adobe/devrelations/devtechnotes/ 
    pdffiles/tiff6.pdf

Person & e-mail address to contact for further information:
    Lloyd McIntyre <lmcintyre@adoc.xerox.com>
    Steve Zilles <szilles@adobe.com>

Intended usage: Common


9.   Security Considerations

Security issues have not been assessed in this document.


10.   References

[MRC]  TD1018, "Revision of D25, forming the basis for Draft Rec. 
    T.44 (MRC-Colour)", ITU-T Study Group 8, February 1997
    currently available at http://www.xerox.com/xis/mrc/

[RFC1314]  Katz, A., and Cohen, D., "A File Format for the 
    Exchange of Images in the Internet", RFC 1314, USC Information 
    Sciences Institute, April 1992





McIntyre & Zilles         Expires 9/20/97          [Page 37]

Internet Draft     File Format for Internet Fax     March 20, 1997

[RFC1528]  Malamud, C., and Rose, M., Principles of Operation for 
    the TPC.INT Subdomain: Remote Printing -- Technical 
    Procedures, RFC 1528, October 1993; also Rose, M., 
    Registration of new MIME content-type/subtype, July 31, 1993, 
    ftp://ftp.isi.edu/in-notes/iana/assignments/media-
    types/image/tiff

[T.4]  ITU-T Recommendation T.4, Standardization of group 3 
    facsimile apparatus for document transmission, July 1996

[T.6]  ITU-T Recommendation T.6, Facsimile coding schemes and 
    coding control functions for group 4 facsimile apparatus, 
    November 1988

[T.42]  ITU-T Recommendation T.42, Continuous-tone colour 
    representation method for facsimile, February 1996

[T.43]  ITU-T Draft Recommendation T.43, T.Palette-Colour - Colour 
    and gray-scale image representations using lossless coding 
    scheme for facsimile, February 1997

[T.81]  ITU-T Recommendation T.81, Information technology - 
    Digital compression and coding of continuous-tone still images 
    - Requirements and guidelines, September 1992

[T.82]  ITU-T Recommendation T.82, Information technology - Coded 
    representation of picture and audio information - Progressive 
    bi-level image compression, March 1995
 
[T.85]  ITU-T Recommendation T.85, Application profile for 
    Recommendation T.82 - Progressive bi-level image compression 
    (JBIG coding scheme) for facsimile apparatus, August 1995

[TIFF]  Tag Image File Format, Revision 6.0, Adobe Developers 
    Association, June 3, 1992

[TIFF-F]  work in progress, Tag Image File Format (TIFF) - Class 
    F, Jan. 1997, ftp://ftp.ietf.org/internet-drafts/draft-ietf-
    fax-tiff-00.txt

[TTN1]  Adobe PageMaker 6.0 TIFF Technical Notes, Sept. 14, 1995, 
    http://www.adobe.com/supportservice/devrelations/PDFS/TN/ 
    TIFFPM6.pdf

[TTN2]  Draft TIFF Technical Note 2, Replacement TIFF/JPEG 
    specification, March 17, 1995, ftp://ftp.sgi.com/graphics/ 
    tiff/TTN2.draft.txt



McIntyre & Zilles         Expires 9/20/97          [Page 38]

Internet Draft     File Format for Internet Fax     March 20, 1997

T.4, T.6, T.42, T.81, T.82 and T.85 are available at
http://www.itu.ch.
[MRC] is currently available at http://www.xerox.com/xis/mrc/


11.   Authors' Addresses

Lloyd McIntyre
Xerox Corporation
Mailstop PAHV-305
3400 Hillview Ave.
Palo Alto, CA  94304
USA
Voice:  +1-415-813-6762
Fax:    +1-415-813-6792
Email:  lmcintyre@adoc.xerox.com

Stephen Zilles
Adobe Systems Inc.
Mailstop W14
345 Park Avenue
San Jose, CA 95110-2704
Voice:  +1-408-536-4766
Fax:    +1-408-536-4042
Email:  szilles@adobe.com


Annex A:  Summary of TIFF Fields for Internet Fax

This annex includes tables which list all relevant TIFF fields 
used in the proposed fax file format.  The fields are organized 
into 3 categories:

    1)  TIFF Baseline fields
    2)  TIFF Extension fields
    3)  New Fields.

The tables include the allowed values relevant to each Fax mode.  
Entries other than explicit numbers are described by:

    n        - single number
    n, m     - 2 numbers
    a, b, c  - 3 numbers
    r        - rational number
    <n>      - array of numbers
    <b>      - byte sequence
    {ASCII}  - string
    <IFD>    - array of IFD byte offsets


McIntyre & Zilles         Expires 9/20/97          [Page 39]

Internet Draft     File Format for Internet Fax     March 20, 1997

The absence of an entry indicates the field is not part of the 
current proposal.

    Table A.1  TIFF Baseline Fields
    +----------+-------------------------------------------------+
    |          |                  Fax Modes                      |
    +----------+-------------------------------------------------|
    | Field    |  Bi-level |  Color   |  Color     | Mixed Raster|
    |          |           | (Lossy)  | (Lossless) | Content     |
    +----------+-----------+----------+------------+-------------+
    | BitsPer  |           |          |            |             |
    | Sample   | 1         | 8, 12    | 1, 8, 9-16 | 1, 8, 9-16  |
    +----------+-----------+----------+------------|-------------|
    | ColorMap |           |          | <n>        | <n>         |
    +----------+-----------+----------+------------|-------------|
    | Compres- |           |          |            |             |
    | sion     | 2, 3, 4   | 7        | 9          |2, 3, 4, 7, 9|
    +----------+-----------+----------+------------+-------------+
    | DateTime | {ASCII}   | {ASCII}  | {ASCII}    |{ASCII}      |
    +----------+-----------+--------- +------------|-------------|
    | FillOrder| 1, 2      |          | 1, 2       | 1, 2        |
    +----------+-----------+----------+------------+-------------+
    | ImageDes-| (ASCII}   | {ASCII}  | {ASCII}    | {ASCII}     |
    | cription |           |          |            |             |
    +----------+-----------+----------+------------+-------------|
    |  Image-  |1728, 2048 |864, 1024 |864, 1024   |864, 1024    |
    |  Width   |2432, 2592 |1216, 1728|1216, 1728  |1216, 1728   |
    |          |3072, 3456 |2048, 2432|2048, 2432  |2048, 2432   |
    |          |3648, 4096 |2592, 3072|2592, 3072  |2592, 3072   |
    |          |4864       |3456, 3648|3456, 3648  |3456, 3648   |
    |          |           |4096, 4864|4096, 4864  |4096, 4864   |
    +----------+-----------+----------+------------+-------------+
    | Image-   |           |          |            |             |
    | Length   | n         | n        | n          | n           |
    +----------+-----------+----------+------------+-------------+
    | NewSub-  |           |          |            |             |
    | FileType | 2         | 2        | 2          | 16, 18      |
    +----------+-----------+----------+------------+-------------+
    | Orien-   |           |          |            |             |
    | tation   | 1         | 1        |1           | 1           |
    +----------+-----------+----------+------------+-------------+
    | Photo-   |           |          |            |             |
    | metric-  |           |          |            |             |
    | Interp-  |           |          |            |             |
    | retation | 0, 1      | 10       | 2, 5, 10   | 0,1,2,5,10  |
    +----------+-----------+----------+------------+-------------+
    | Resolu-  |           |          |            |             |
    | tionUnit | 2, 3      | 2, 3     | 2, 3       | 2, 3        |
    +----------+-----------+----------+------------+-------------+

McIntyre & Zilles         Expires 9/20/97          [Page 40]

Internet Draft     File Format for Internet Fax     March 20, 1997

    +----------+-----------+----------+------------+-------------+
    | RowsPer- |           |          |            |             |
    | Strip    |n          | n        | n          |             |
    +----------+-----------+----------+------------+-------------+
    | Samples- |           |          |            |             |
    | PerPixel | 1         | 1, 3     | 1, 3, 4    | 1, 3, 4     |
    +----------+-----------+----------+------------+-------------+
    | Software | {ASCII}   | {ASCII}  | {ASCII}    | {ASCII}     |
    +----------+-----------+----------+------------+-------------+
    | Strip-   |           |          |            |             |
    | Byte-    |           |          |            |             |
    | Counts   | <n>       | <n>      | <n>        | <n>         |
    +----------+-----------+----------+------------+-------------+
    | Strip-   |           |          |            |             |
    | Offsets  | <n>       | <n>      | <n>        | <n>         |
    +----------+-----------+----------+------------+-------------+
    | XResolu- | 200, 204, | 100, 200,| 100, 200,  | 100, 200,   |
    | tion     | 300, 400, | 300, 400 | 300, 400   | 300, 400    |
    |          | 406       |          |            |             |
    +----------+-----------+----------+------------+-------------+
    | YResolu- | 98, 196,  | 100, 200,| 100, 200,  | 100, 200,   |
    | tion     | 100, 200, | 300, 400 | 300, 400   | 300, 400    |
    |          | 300, 392, |          |            |             |
    |          | 400       |          |            |             |
    +----------+-----------+----------+------------+-------------+

Table A.2  TIFF Extension Fields

    +-----------+------------------------------------------------+
    |           |                 Fax Modes                      |
    +-----------+------------------------------------------------|
    | Field     | Bi-level  | Color    | Color     | Mixed Raster|
    |           |           | (Lossy)  | (Lossless) | Content    |
    +-----------+-----------+----------+----- ------+------------+
    | T4Options | 0, 1, 4, 5|          |            | 0, 1, 4, 5 |
    +-----------+-----------+----------+------------+------------+
    | T6Options | 0         |          |            | 0          |
    +-----------+-----------+----------+------------+------------+
    | Document- |           |          |            |            |
    | Name      | {ASCII}   | {ASCII}  | {ASCII}    | {ASCII}    |
    +-----------+-----------+----------+------------+------------+
    | Page-     |           |          |            |            |
    | Number    | n, m      | n, m     | n, m       | n, m       |
    +-----------+-----------+----------+------------+------------+
    | XPosition |           |          |            | r          |
    +-----------+-----------+----------+------------+------------+
    | YPosition |           |          |            | r          |
    +-----------+-----------+----------+------------+------------+


McIntyre & Zilles         Expires 9/20/97          [Page 41]

Internet Draft     File Format for Internet Fax     March 20, 1997

    +-----------+-----------+----------+------------+------------+
    | SubIFDs   |           |          |            | <n>        |
    +-----------+-----------+----------+------------+------------+
    | Indexed   |           |          | 0, 1       | 0, 1       |
    +-----------+-----------+----------+------------+------------+
    | Chroma-   |           |          |            |            |
    | SubSampl- |           |          |            |            |
    | ing       |           | n, m     |            | n, m       |
    +-----------+-----------+----------+------------+------------+
    | Chroma-   |           |          |            |            |
    | Position- |           |          |            |            |
    | ing       |           | 1, 2     |            | 1,2        |
    +-----------+-----------+----------+------------+------------+
    | Decode    |           | <n>      | <n>        | <n>        |
    +-----------+-----------+----------+------------+------------+
    | Default-  |           |          |            |            |
    | ImageColor|           |          |            | <n>        |
    +-----------+-----------+----------+------------+------------+
    | Strip-    |           |          |            |            |
    | RowCounts |           |          |            | <n>        |
    +-----------+-----------+----------+------------+------------+

Table A.3   New Fields

    +-----------+------------------------------------------------+
    |           |                 Fax Modes                      |
    +-----------+------------------------------------------------|
    | Field     | Bi-level  | Color   | Color      | Mixed Raster|
    |           |           | (Lossy  | (Lossless) | Content     |
    +-----------+-----------+---------+------------+-------------+
    | Global-   |           |         |            |             |
    | Parame-   |           |         |            |             |
    | tersIFD   | <IFD>     | <IFD>   | <IFD>      | <IFD>       |
    +-----------+-----------+---------+------------+-------------+
    | Profile-  |           |         |            |             |
    | Type      | n         | n       | n          | n           |
    +-----------+-----------+---------+------------+-------------+
    | ITUFax-   |           |         |            |             |
    | Mode      | n         | n       | n          | n           |
    +-----------+-----------+---------+------------+-------------+
    | Coding-   |           |         |            |             |
    | Methods   | n         | n       | n          | n           |
    +-----------+-----------+---------+------------+-------------+
    | Version-  |           |         |            |             |
    | Number    | n         | n       |n           | n           |
    +-----------+-----------+---------+------------+-------------+
    | Version-  |           |         |            |             |
    | Year      | <b>       | <b>     | <b>        | <b>         |
    +-----------+-----------+---------+------------+-------------+

McIntyre & Zilles         Expires 9/20/97          [Page 42]

Internet Draft     File Format for Internet Fax     March 20, 1997

    +-----------+-----------+---------+------------+-------------+
    | BadFax-   |           |         |            |             |
    | Lines     | n         |         |            |             |
    +-----------+----------------------------------+-------------+
    | CleanFax- |           |         |            |             |
    | Data      | 0, 1, 2   |         |            |             |
    +-----------+-----------+---------+------------+-------------+
    | Consecu-  |           |         |            |             |
    | tiveBad-  |           |         |            |             |
    | FaxLines  | n         |         |            |             |
    +-----------+-----------+---------+------------+-------------+
    | ImageLayer|           |         |            | n, m        |
    +-----------+-----------+---------+------------+-------------+





































McIntyre & Zilles         Expires 9/20/97          [Page 43]
