<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>An EAP Authentication Method Based on the EKE Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="An EAP Authentication Method Based on the EKE Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">Y. Sheffer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Independent</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">G. Zorn</td></tr>
<tr><td class="header">Expires: February 26, 2011</td><td class="header">Network Zen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Fluhrer</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">August 25, 2010</td></tr>
</table></td></tr></table>
<h1><br />An EAP Authentication Method Based on the EKE Protocol<br />draft-sheffer-emu-eap-eke-08</h1>

<h3>Abstract</h3>

<p>The Extensible Authentication Protocol (EAP) describes a framework that allows the use of
        multiple authentication mechanisms. This document defines an authentication mechanism for
        EAP called EAP-EKE, based on the Encrypted Key Exchange (EKE) protocol. This method provides
        mutual authentication through the use of a short, easy to remember password. Compared with other
        common authentication methods, EAP-EKE is not susceptible to dictionary attacks. Neither does
        it require the availability of public-key certificates.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on February 26, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#protocol">3.</a>&nbsp;
Protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.</a>&nbsp;
Message Flows<br />
<a href="#anchor4">4.</a>&nbsp;
Message Formats<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#eap-eke-header-sec">4.1.</a>&nbsp;
EAP-EKE Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.2.</a>&nbsp;
EAP-EKE Payloads<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.2.1.</a>&nbsp;
The EAP-EKE-ID Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.2.</a>&nbsp;
The EAP-EKE-Commit Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.2.3.</a>&nbsp;
The EAP-EKE-Confirm Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#eap-eke-failure">4.2.4.</a>&nbsp;
The EAP-EKE-Failure Payload<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#protected-fields-sec">4.3.</a>&nbsp;
Protected Fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#encrypted-fields-sec">4.4.</a>&nbsp;
Encrypted Fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#channel-bindings">4.5.</a>&nbsp;
Channel Binding Values<br />
<a href="#protocol-sequence">5.</a>&nbsp;
Protocol Sequence<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#commit-request">5.1.</a>&nbsp;
EAP-EKE-Commit/Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#commit-response">5.2.</a>&nbsp;
EAP-EKE-Commit/Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#confirm-request">5.3.</a>&nbsp;
EAP-EKE-Confirm/Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#confirm-response">5.4.</a>&nbsp;
EAP-EKE-Confirm/Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.5.</a>&nbsp;
MSK and EMSK<br />
<a href="#anchor10">6.</a>&nbsp;
Cryptographic Details<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#key-from-password">6.1.</a>&nbsp;
Deriving a Key from the Password<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#gen-key-material">6.2.</a>&nbsp;
Generating Keying Material<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dh-groups">6.3.</a>&nbsp;
Diffie-Hellman Groups<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">6.4.</a>&nbsp;
Mandatory Algorithms<br />
<a href="#iana">7.</a>&nbsp;
IANA Considerations<br />
<a href="#security">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">8.1.</a>&nbsp;
Cryptographic Analysis<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">8.2.</a>&nbsp;
Diffie Hellman Group Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">8.3.</a>&nbsp;
Resistance to Active Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#id-protection">8.4.</a>&nbsp;
Identity Protection, Anonymity and Pseudonymity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#password-equivalent">8.5.</a>&nbsp;
Password Processing and Long Term Storage<br />
<a href="#anchor15">9.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#anchor18">Appendix&nbsp;A.</a>&nbsp;
Change Log<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The predominant access method for the Internet today is that of a human using a username
        and password to authenticate to a computer enforcing access control. Proof of knowledge of
        the password authenticates the human to the computer.
</p>
<p>Typically, these passwords are not stored on a user's computer for security reasons and
        must be entered each time the human desires network access. Therefore, the passwords must be
        ones that can be repeatedly entered by a human with a low probability of error. They will
        likely not possess high entropy and it may be assumed that an adversary with access to a
        dictionary will have the ability to guess a user's password. It is therefore desirable to
        have a robust authentication method that is secure even when used with a weak password in
        the presence of a strong adversary.
</p>
<p>EAP-EKE is an EAP method <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> that addresses the problem of
        password-based authenticated key exchange, using a possibly weak password for authentication
        and to derive an authenticated and cryptographically strong shared secret. This problem was
        first described by Bellovin and Merritt in <a class='info' href='#BM92'>[BM92]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; May&nbsp;1992.</span><span>)</span></a> and <a class='info' href='#BM93'>[BM93]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Augmented Encrypted Key Exchange: A Password-Based Protocol Secure against             Dictionary Attacks and Password File Compromise,&rdquo; 1993.</span><span>)</span></a>.
        Subsequently, a number of other solution approaches have been proposed, for example <a class='info' href='#JAB96'>[JAB96]<span> (</span><span class='info'>Jablon, D., &ldquo;Strong Password-Only Authenticated Key Exchange,&rdquo; October&nbsp;1996.</span><span>)</span></a>, <a class='info' href='#LUC97'>[LUC97]<span> (</span><span class='info'>Lucks, S., &ldquo;Open Key Exchange: How to Defeat Dictionary Attacks Without 	  Encrypting Public Keys,&rdquo; 1997.</span><span>)</span></a>, <a class='info' href='#BMP00'>[BMP00]<span> (</span><span class='info'>Boyko, V., MacKenzie, P., and S. Patel, &ldquo;Provably Secure Password Authenticated Key Exchange Using Diffie-Hellman,&rdquo; 2000.</span><span>)</span></a>, and others.
</p>
<p> This proposal is based on the original Encrypted Key Exchange (EKE) proposal, as described
        in <a class='info' href='#BM92'>[BM92]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; May&nbsp;1992.</span><span>)</span></a>. Some of the variants of the original EKE have been attacked,
        see e.g. <a class='info' href='#PA97'>[PA97]<span> (</span><span class='info'>Patel, S., &ldquo;Number Theoretic Attacks On Secure Password Schemes,&rdquo; 1997.</span><span>)</span></a>,
        and improvements have been proposed.
        None of these subsequent improvements have been incorporated into the current protocol.
        However, we have used only the subset of <a class='info' href='#BM92'>[BM92]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; May&nbsp;1992.</span><span>)</span></a> (namely the variant described
        in Section 3.1 of the paper) which has withstood the
        test of time and is believed secure as of this
        writing.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
      This document uses Encr(Ke, ...) to denote encrypted information, and Prot(Ke, Ki, ...) to denote
      encrypted and integrity protected information.
      
</p>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="protocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Protocol</h3>

<p> EAP is a two-party protocol spoken between an EAP peer and an EAP server
        (also known as "authenticator"). An EAP method
          defines the specific authentication protocol being used by EAP. This memo defines a
          particular method and therefore defines the messages sent between the EAP server
          and the EAP peer for the purpose of authentication and key derivation. 
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Message Flows</h3>

<p>A successful run of EAP-EKE consists of three message exchanges:
	an Identity exchange, a Commit exchange and a
          Confirm exchange. This is shown in <a class='info' href='#message-flows'>Figure&nbsp;1<span> (</span><span class='info'>A Successful EAP-EKE Exchange</span><span>)</span></a>.
</p>
<p>The peer and server use the EAP-EKE Identity exchange to learn each other's identities
          and to agree upon a ciphersuite to use in the subsequent exchanges. In the Commit exchange
          the peer and server exchange information to generate a shared key and also to bind each
          other to a particular guess of the password. In the Confirm exchange the peer and server
          prove liveness and knowledge of the password by generating and verifying verification
          data (note that the second message of the Commit exchange already plays an essential
	  part in this liveness proof).
</p>
<p>
          <br /><hr class="insert" />
<a name="message-flows"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

           +--------+                                     +--------+
           |        |                  EAP-EKE-ID/Request |        |
           |  EAP   |&lt;------------------------------------|  EAP   |
           |  peer  |                                     | server |
           |  (P)   | EAP-EKE-ID/Response                 |   (S)  |
           |        |------------------------------------&gt;|        |
           |        |                                     |        |
           |        |              EAP-EKE-Commit/Request |        |
           |        |&lt;------------------------------------|        |
           |        |                                     |        |
           |        | EAP-EKE-Commit/Response             |        |
           |        |------------------------------------&gt;|        |
           |        |                                     |        |
           |        |             EAP-EKE-Confirm/Request |        |
           |        |&lt;------------------------------------|        |
           |        |                                     |        |
           |        | EAP-EKE-Confirm/Response            |        |
           |        |------------------------------------&gt;|        |
           |        |                                     |        |
           |        |          EAP-Success                |        |
           |        |&lt;------------------------------------|        |
           +--------+                                     +--------+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: A Successful EAP-EKE Exchange&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p> Schematically, the original exchange as described in <a class='info' href='#BM92'>[BM92]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; May&nbsp;1992.</span><span>)</span></a> (and with the
          roles reversed) is: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

Server                              Peer
------                              ----

Encr(Password, y_s) -&gt;

		   &lt;- Encr(Password, y_p), Encr(SharedSecret, Nonce_P)

Encr(SharedSecret, Nonce_S | Nonce_P) -&gt;

                                        &lt;- Encr(SharedSecret, Nonce_S)

</pre></div><p>

          Where:
          </p>
<ul class="text">
<li>Password is a typically short string, shared between the server and the peer. In other words,
	  the same password is used to authenticate the server to the peer, and vice versa.
</li>
<li>y_s and y_p are the server's and respectively, the peer's, ephemeral public key,
          i.e. y_s = g ^ x_s (mod p)  and  y_p = g ^ x_p (mod p).
</li>
<li>Nonce_S, Nonce_P are random strings generated by the server and the peer as
          cryptographic challenges.
</li>
<li>SharedSecret is the secret created by the Diffie-Hellman algorithm,
          namely SharedSecret = g^(x_s * x_p) (mod p). This value is calculated by the server as: SharedSecret = y_p ^ x_s (mod p), and by the peer as: SharedSecret = y_s ^ x_p (mod p).
</li>
</ul><p>
          The current protocol extends the basic cryptographic protocol, and the regular
          successful exchange becomes: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   Message                   Server                       Peer
  ---------                 --------                     ------
ID/Request         ID_S, CryptoProposals -&gt;

ID/Response                                 &lt;- ID_P, CryptoSelection

Commit/Request     Encr(Password, y_s) -&gt;

Commit/Response        &lt;- Encr(Password, y_p), Prot(Ke, Ki, Nonce_P)

Confirm/Request    Prot(Ke, Ki, Nonce_S | Nonce_P), Auth_S -&gt;

Confirm/Response                    &lt;- Prot(Ke, Ki, Nonce_S), Auth_P

</pre></div><p>

	  Where, in addition to the above terminology:
          </p>
<ul class="text">
<li>Encr means encryption only, and Prot is encryption with integrity protection.
</li>
<li>Ke is an encryption key, Ki an integrity-protection key.
</li>
</ul><p>
	  <a class='info' href='#protocol-sequence'>Section&nbsp;5<span> (</span><span class='info'>Protocol Sequence</span><span>)</span></a> explains the various cryptographic values and how they are derived.
	  
</p>
<p>As shown in the exchange above, the following information elements have been added to
          the original protocol: identity values for both protocol parties (ID_S, ID_P), negotiation of
          cryptographic protocols, and signature fields to protect the integrity of the negotiated
          parameters (Auth_S, Auth_P).
	  In addition the shared secret is not used directly.
          A few details have been omitted for brevity. 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Message Formats</h3>

<p>EAP-EKE defined a small number of message types, each message consisting of a header
    followed by a payload. This section defines the header,  several payload formats,
    as well as the format of specific fields within the payloads.
</p>
<p>As usual, all multi-octet strings MUST be laid out in network byte order.
</p>
<a name="eap-eke-header-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
EAP-EKE Header</h3>

<p>The EAP-EKE header consists of the standard EAP header (see Section 4 of <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>), followed an EAP-EKE exchange type. The header has the following
          structure:
</p>
<p>
          <br /><hr class="insert" />
<a name="eap-eke-header"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Code      |  Identifier   |             Length            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |   EKE-Exch    |              Data            ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: EAP-EKE Header&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p> The Code, Identifier, Length, and Type fields are all part of the EAP header as
          defined in <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>. The Type field in the EAP header
	  is [TBD by IANA] for EAP-EKE version 1.
	  [Note to RFC Editor: insert the IANA-allocated value here.]
</p>
<p> The EKE-Exch (EKE Exchange) field identifies the type of EAP-EKE
	payload encapsulated in the Data
          field. This document defines the following values for the EKE-Exch field: </p>
<ul class="text">
<li>0x00: Reserved
</li>
<li>0x01: EAP-EKE-ID exchange
</li>
<li>0x02: EAP-EKE-Commit exchange
</li>
<li>0x03: EAP-EKE-Confirm exchange
</li>
<li>0x04: EAP-EKE-Failure message
</li>
</ul>

<p>Further values of this EKE-Exch field are available via IANA registration
	(<a class='info' href='#iana-exchange'>Section&nbsp;7.7<span> (</span><span class='info'>Exchange Registry</span><span>)</span></a>). 
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
EAP-EKE Payloads</h3>

<p>EAP-EKE messages all contain the EAP-EKE header and information encoded
	in a single payload, which differs for the different exchanges.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
The EAP-EKE-ID Payload</h3>

<p>
          <br /><hr class="insert" />
<a name="eap-eke-id-payload"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 | NumProposals  |   Reserved    |           Proposal           ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...    Proposal                  |    IDType     |  Identity    ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: EAP-EKE-ID Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>The EAP-EKE-ID payload contains the following fields:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>NumProposals:</dt>
<dd>
              <br />
The NumProposals field contains the number of Proposal fields
              subsequently contained in the payload. In the EAP-EKE-ID/Request the NumProposals
              field MUST NOT be set to zero (0) and in the EAP-EKE-ID/Response message the NumProposals
              field MUST be set to one (1). The offered proposals in the Request are listed
              contiguously in priority order, most preferable first. The selected proposal in the
              Response MUST be fully identical with one of the offered proposals.<br />
<br />

</dd>
<dt>Proposal:</dt>
<dd><br />
Each proposal consists of four one-octet
              fields, in this order: <br />
<br />

              
<blockquote class="text"><dl>
<dt>Group Description:</dt>
<dd><br />
This field's value is taken
                  from the IANA registry for Diffie-Hellman groups defined in <a class='info' href='#iana-group'>Section&nbsp;7.1<span> (</span><span class='info'>Diffie-Hellman Group Registry</span><span>)</span></a>.<br />
<br />

</dd>
<dt>Encryption:</dt>
<dd><br />
This field's value is taken from
                  the IANA registry for encryption algorithms defined in <a class='info' href='#iana-enc'>Section&nbsp;7.2<span> (</span><span class='info'>Encryption Algorithm Registry</span><span>)</span></a>.<br />
<br />

</dd>
<dt>PRF:</dt>
<dd><br />
This field's value is taken from the IANA
                  registry for pseudo random functions defined in <a class='info' href='#iana-prf'>Section&nbsp;7.3<span> (</span><span class='info'>Pseudo Random Function Registry</span><span>)</span></a>.<br />
<br />

</dd>
<dt>MAC:</dt>
<dd><br />
This field's value is taken from the IANA
                  registry for keyed message digest algorithms defined in <a class='info' href='#iana-mac'>Section&nbsp;7.4<span> (</span><span class='info'>Keyed Message Digest (MAC) Registry</span><span>)</span></a>.
                  <br />
<br />

</dd>
</dl></blockquote>
</dd>
<dt>Reserved:</dt>
<dd><br />
This field MUST be sent as zero,
	    and MUST be ignored by the recipient.<br />
<br />

</dd>
<dt>IDType:</dt>
<dd><br />
Denotes the Identity Type. This is taken
              from the IANA registry defined in <a class='info' href='#iana-identity'>Section&nbsp;7.5<span> (</span><span class='info'>Identity Type Registry</span><span>)</span></a>. The server and the peer MAY
              use different identity types.
	      All implementations MUST be able to receive two identity types: ID_NAI and ID_FQDN.
	      <br />
<br />

</dd>
<dt>Identity:</dt>
<dd><br />
The meaning of the Identity field depends
	  on the values of the Code
	  and IDType fields.
          
<ul class="text">
<li>EAP-EKE-ID/Request: server ID
</li>
<li>EAP-EKE-ID/Response: peer ID
</li>
</ul>
	  
</dd>
<dt></dt>
<dd>The length of the Identity field is computed from the Length field in the EAP header.
	Specifically, its length is
	
<blockquote class="text">
<p>eap_header_length - 9 - 4 * number_of_proposals.
</p>
</blockquote>
	This field, like all other fields in this specification, MUST be octet-aligned.
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
The EAP-EKE-Commit Payload</h3>

<p>This payload allows both parties send their encrypted ephemeral public key, with the peer
          also including a Challenge.
</p>
<p>In addition, a small amount of data can be included by the server and/or the peer,
	  and used for channel binding. This data is sent here unprotected, but is verified
	  later, when it is signed by the Auth_S/Auth_P payloads of the EAP-EKE-Confirm exchange.
</p>
<p>
          <br /><hr class="insert" />
<a name="eap-eke-commit-payload"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         DHComponent_S/DHComponent_P                           ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          PNonce_P                                             ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          CBValue (zero or more occurrences)                   ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: EAP-EKE-Commit Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>DHComponent_S/DHComponent_P:</dt>
<dd>
              <br />
This field contains the password-encrypted Diffie-Hellman
              public key, see <a class='info' href='#commit-request'>Section&nbsp;5.1<span> (</span><span class='info'>EAP-EKE-Commit/Request</span><span>)</span></a>.
	      Its size is determined by the group and the encryption algorithm.<br />
<br />

</dd>
<dt>PNonce_P:</dt>
<dd>
              <br />
This field only appears in the response, and contains the
              encrypted and integrity-protected challenge value sent by the peer.
              The field's size is determined by the encryption
	      and MAC algorithms being used, since this protocol mandates a fixed nonce
	      size for a given choice of algorithms.
	      See <a class='info' href='#commit-response'>Section&nbsp;5.2<span> (</span><span class='info'>EAP-EKE-Commit/Response</span><span>)</span></a>.<br />
<br />

</dd>
<dt>CBValue:</dt>
<dd>
              <br />
This structure MAY be included both in the request and in
              the response, and MAY be repeated multiple times in a single payload.
              See <a class='info' href='#channel-bindings'>Section&nbsp;4.5<span> (</span><span class='info'>Channel Binding Values</span><span>)</span></a>. Each structure contains its own length.
	      The field is neither encrypted nor integrity protected, instead it is protected by the
	      AUTH payloads in the Confirm exchange.
	      
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
The EAP-EKE-Confirm Payload</h3>

<p>Using this payload, both parties complete the authentication by generating a shared
          temporary key, authenticating the entire protocol, and generating key material for the EAP
          consumer protocol.
</p>
<p>
          <br /><hr class="insert" />
<a name="eap-eke-confirm-payload"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          PNonce_PS/PNonce_S                                   ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Auth_S/Auth_P                                        ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: EAP-EKE-Confirm Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>PNonce_PS/PNonce_S:</dt>
<dd>
              <br />
This field ("protected nonce") contains the encrypted and integrity-protected
              response to the other party's
              challenge, see <a class='info' href='#confirm-request'>Section&nbsp;5.3<span> (</span><span class='info'>EAP-EKE-Confirm/Request</span><span>)</span></a> and <a class='info' href='#confirm-response'>Section&nbsp;5.4<span> (</span><span class='info'>EAP-EKE-Confirm/Response</span><span>)</span></a>. Similarly to the PNonce_P field, this field's size is determined by the encryption
		and MAC algorithms.<br />
<br />

</dd>
<dt>Auth_S/Auth_P:</dt>
<dd>
              <br />
This field signs the preceding messages,
              including the Identity and the negotiated fields. This prevents various possible attacks,
	      such as
              algorithm downgrade attacks. See <a class='info' href='#confirm-request'>Section&nbsp;5.3<span> (</span><span class='info'>EAP-EKE-Confirm/Request</span><span>)</span></a> and <a class='info' href='#confirm-response'>Section&nbsp;5.4<span> (</span><span class='info'>EAP-EKE-Confirm/Response</span><span>)</span></a>. The size is determined by the
		pseudo-random function negotiated.
</dd>
</dl></blockquote><p>
        
</p>
<a name="eap-eke-failure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
The EAP-EKE-Failure Payload</h3>

<p> The EAP-EKE-Failure payload format is defined as follows: <br /><hr class="insert" />
<a name="eap-eke-failure-payload"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Failure-Code                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: EAP-EKE-Failure Payload&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>The payload's size is always exactly 4 octets.
</p>
<p>The following Failure-Code values are defined:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Value</th><th align="left">Name</th><th align="left">Meaning</th></tr>
<tr>
<td align="left">0x00000000</td>
<td align="left">Reserved</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">0x00000001</td>
<td align="left">No Error</td>
<td align="left">This code is used for failure acknowledgement, see below.</td>
</tr>
<tr>
<td align="left">0x00000002</td>
<td align="left">Protocol Error</td>
<td align="left">A failure to parse or understand a protocol message or one
        of its payloads.</td>
</tr>
<tr>
<td align="left">0x00000003</td>
<td align="left">Password Not Found</td>
<td align="left">A password
        could not be located for the identity presented by the other protocol party, making
          authentication impossible. For security reasons, implementations MAY choose to eliminate
          this error code and return "Authentication Failure" also in this case.</td>
</tr>
<tr>
<td align="left">0x00000004</td>
<td align="left">Authentication Failure</td>
<td align="left">Failure in the cryptographic
          computation most likely caused by an incorrect password, or an inappropriate identity type.</td>
</tr>
<tr>
<td align="left">0x00000005</td>
<td align="left">Authorization Failure</td>
<td align="left">
          While the password being used is correct, the user is not authorized to connect.</td>
</tr>
<tr>
<td align="left">0x00000006</td>
<td align="left">No Proposal Chosen</td>
<td align="left">The peer is unwilling to select any of the
          cryptographic proposals offered by the server.</td>
</tr>
</table>
<br clear="all" />

<p>Additional values of this field are available via IANA registration, see
	<a class='info' href='#iana-failure'>Section&nbsp;7.8<span> (</span><span class='info'>Failure-Code Registry</span><span>)</span></a>. 
</p>
<p>
          When the peer encounters an error situation, it MUST respond with EAP-EKE-Failure.
          The server MUST reply with an EAP-Failure message to end the exchange.
          
</p>
<p>
          When the server encounters an error situation, it MUST respond with EAP-EKE-Failure.
          The peer MUST send back an EAP-EKE-Failure message containing a "No Error"
          failure code. Then the server MUST send an EAP-Failure message to end the exchange.
          
</p>
<a name="protected-fields-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Protected Fields</h3>

<p>Several fields are encrypted and integrity-protected.
      They are denoted Prot(...).
      Their general structure is as follows:
</p>
<p>
          <br /><hr class="insert" />
<a name="protected-field"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Initialization Vector (IV) (optional)                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Encrypted Data                         ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                                                               ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~               |            Random Padding                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  Integrity Check Value (ICV)                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: Protected Field Structure&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>The protected field is a concatenation of three octet strings:
</p>
<p>
        </p>
<ul class="text">
<li>An optional IV, required when the encryption algorithm/mode necessitates it,
        e.g. for CBC encryption. The content and size of this field are determined
	by the selected encryption algorithm. In the case of CBC encryption, this
	field is a random octet string having the same size as the algorithm's
	block size.
</li>
<li>The original data, followed if necessary by random padding. This padding has the
	minimal length (possibly zero) required to complete
        the length of the encrypted
        data to the encryption algorithm's block size. The original data and the padding are encrypted
	together.
</li>
<li>ICV, a cryptographic checksum (MAC) of the
        encrypted data, including the padding.  The checksum is computed over the
        encrypted, rather than the plaintext, data.
        Its length is determined by the MAC algorithm negotiated.
</li>
</ul><p>
        
</p>
<p>We note that because of the requirement for an explicit ICV, this specification does not support
	authenticated encryption algorithms. Such algorithms may be added by a future extension.
</p>
<a name="encrypted-fields-sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Encrypted Fields</h3>

<p>
      Two fields are encrypted but not integrity protected. They are denoted Encr(...).
      Their format is identical to
      a protected field (<a class='info' href='#protected-fields-sec'>Section&nbsp;4.3<span> (</span><span class='info'>Protected Fields</span><span>)</span></a>),
      except that the Integrity Check Value is omitted.
      
</p>
<a name="channel-bindings"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Channel Binding Values</h3>

<p>
      This protocol allows higher level protocols that are using it to transmit opaque information
      between the peer and the server. This information is integrity protected but not encrypted,
      and may be used to ensure that protocol participants are identical at different protocol layers. See
      Sec. 7.15 of <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> for more on the rationale behind this facility.
</p>
<p>EAP-EKE neither validates nor makes any use of the transmitted information.
      The information MUST NOT be used by
      the consumer protocol until it is verified in the EAP-EKE-Confirm exchange (specifically,
      it is integrity protected by the Auth_S, Auth_P payloads).
      Consequently, it MUST NOT be relied upon in case an error occurs at the EAP-EKE level.
      
</p>
<p>An unknown Channel Binding Value SHOULD be ignored by the recipient. 
</p>
<p>Some implementations may require certain values to be present, and will abort
      the protocol if they are not. Such policy is out of scope of the current protocol.
</p>
<p>Each Channel Binding Value is encoded using a simple TLV structure:
</p>
<p>
          <br /><hr class="insert" />
<a name="cb-payload"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |          CBType               |           Length              |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |          Value                                               ...
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: Channel Binding Value&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>CBType:</dt>
<dd>
              <br />
This is the Channel Binding Value's type. This document defines
              the value 0x0000 as reserved. Other values are available for IANA allocation,
	      see <a class='info' href='#iana-cbtype'>Section&nbsp;7.6<span> (</span><span class='info'>EAP-EKE Channel Binding Type Registry</span><span>)</span></a>.
              <br />
<br />

</dd>
<dt>Length:</dt>
<dd>
              <br />
This field is the total length in octets of the
              structure, including the CBType and Length fields.
</dd>
</dl></blockquote><p>
        
</p>
<p>This facility should be used with care, since EAP-EKE does not provide for
        message fragmentation. EAP-EKE is not a tunneled method, and should not be used as
	a generic transport; specifically, implementors should refrain from using
	the Channel Binding facility to transmit posture information, in the sense of
	<a class='info' href='#RFC5209'>[RFC5209]<span> (</span><span class='info'>Sangster, P., Khosravi, H., Mani, M., Narayan, K., and J. Tardo, &ldquo;Network Endpoint Assessment (NEA): Overview and Requirements,&rdquo; June&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="protocol-sequence"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Protocol Sequence</h3>

<p>This section describes the sequence of messages for the Commit and Confirm exchanges,
    and lists the cryptographic operations performed by the server and the peer.
</p>
<a name="commit-request"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
EAP-EKE-Commit/Request</h3>

<p>The server computes 
</p>
<p>
          </p>
<blockquote class="text">
<p>y_s = g ^ x_s (mod p),
</p>
</blockquote><p>
        
</p>
<p>where x_s is a randomly chosen number in the range 2 .. p-1. The randomly chosen number
          is the ephemeral private key, and the calculated value is the corresponding
	  ephemeral public key.
          The server and the peer MUST both use a
          fresh, random value for x_s and the corresponding x_p on each run of the protocol.
</p>
<p>The server transmits the encrypted field (<a class='info' href='#encrypted-fields-sec'>Section&nbsp;4.4<span> (</span><span class='info'>Encrypted Fields</span><span>)</span></a>)
</p>
<p>
          </p>
<blockquote class="text">
<p>DHComponent_S = Encr(kmac+(password), y_s).
</p>
</blockquote><p>
        
</p>
<p>See <a class='info' href='#key-from-password'>Section&nbsp;6.1<span> (</span><span class='info'>Deriving a Key from the Password</span><span>)</span></a> for the kmac+ notation. The first output octets of kmac+ are
	used as the encryption key for the negotiated encryption algorithm, according to that algorithm's key length.
</p>
<p>When using block ciphers, it may be necessary to pad y_s on the right, to fit
          the encryption algorithm's block size. In such cases, random padding MUST be used, and
          this randomness is critical to the security of the protocol. Randomness recommendations
          can be found in <a class='info' href='#RFC4086'>[RFC4086]<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Requirements for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a>, and see also <a class='info' href='#NIST.800-90.2007'>[NIST.800&#8209;90.2007]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Random Number Generation Using 	Deterministic Random Bit Generators (Revised),&rdquo; March&nbsp;2007.</span><span>)</span></a> for additional recommendations
	  on cryptographic-level randomness.
	  When decrypting this field, the real length of
          y_s is determined according to the negotiated Diffie Hellman group.
</p>
<p>If the password needs to be stored on the server, it is RECOMMENDED to store the
          randomized password value, i.e. kmac+(password, ...), as a password-equivalent, rather than
          the cleartext password. See also <a class='info' href='#password-equivalent'>Section&nbsp;8.5<span> (</span><span class='info'>Password Processing and Long Term Storage</span><span>)</span></a>.
</p>
<p>
	The input password string SHOULD be processed according to the
       rules of the <a class='info' href='#RFC4013'>[RFC4013]<span> (</span><span class='info'>Zeilenga, K., &ldquo;SASLprep: Stringprep Profile for User Names and Passwords,&rdquo; February&nbsp;2005.</span><span>)</span></a> profile of <a class='info' href='#RFC3454'>[RFC3454]<span> (</span><span class='info'>Hoffman, P. and M. Blanchet, &ldquo;Preparation of Internationalized Strings (&quot;stringprep&quot;),&rdquo; December&nbsp;2002.</span><span>)</span></a>.
       A password SHOULD be
       considered a "stored string" per <a class='info' href='#RFC3454'>[RFC3454]<span> (</span><span class='info'>Hoffman, P. and M. Blanchet, &ldquo;Preparation of Internationalized Strings (&quot;stringprep&quot;),&rdquo; December&nbsp;2002.</span><span>)</span></a> and unassigned code
       points are therefore prohibited.  The output is the binary
       representation of the processed UTF-8 <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> character string.
       Prohibited output and unassigned codepoints encountered in
       SASLprep preprocessing SHOULD cause a preprocessing failure
       and the output SHOULD NOT be used.
          
</p>
<a name="commit-response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
EAP-EKE-Commit/Response</h3>

<p>The peer computes
</p>
<p>
          </p>
<blockquote class="text">
<p>y_p = g ^ x_p (mod p)
</p>
</blockquote><p>
        
</p>
<p>and sends
</p>
<p>
          </p>
<blockquote class="text">
<p>DHComponent_P = Encr(kmac+(password), y_p)
</p>
</blockquote><p>
        
</p>
<p>formatted as an encrypted field (<a class='info' href='#encrypted-fields-sec'>Section&nbsp;4.4<span> (</span><span class='info'>Encrypted Fields</span><span>)</span></a>).
        
</p>
<p>Both sides calculate 
</p>
<p>
          </p>
<blockquote class="text">
<p>SharedSecret = prf(0+, g ^ (x_s * x_p) (mod p))
</p>
</blockquote><p>
        
</p>
<p>If an HMAC-based pseudo-random function is used, the first argument
	to "prf" is a string of zero octets whose length
        is the output size of the base hash algorithm,
        e.g. 20 octets for HMAC-SHA1; the result is of the same length. If a non HMAC-based prf is used,
	the algorithm should specify its preferred input length (to be used as the length of the string of zeros).
        This extra
        application of the pseudo-random function is the "extraction step" of
        <a class='info' href='#RFC5869'>[RFC5869]<span> (</span><span class='info'>Krawczyk, H. and P. Eronen, &ldquo;HMAC-based Extract-and-Expand Key Derivation Function (HKDF),&rdquo; May&nbsp;2010.</span><span>)</span></a>. Note that the peer needs to compute the SharedSecret value
        before sending out its response.
        
</p>
<p>
        The encryption and integrity protection keys are computed: 
</p>
<p>
          </p>
<blockquote class="text">
<p>Ke | Ki = prf+(SharedSecret, "EAP-EKE Keys" | ID_S | ID_P)
</p>
</blockquote><p>
        
</p>
<p>And the peer generates the Protected Nonce: 
</p>
<p>
          </p>
<blockquote class="text">
<p>PNonce_P = Prot(Ke, Ki, Nonce_P),
</p>
</blockquote><p>
        
</p>
<p>where Nonce_P is a randomly generated binary string.
	  The length of Nonce_P MUST be the maximum of 16 octets,
	  and half the key size of the negotiated prf (rounded up to the next octet if necessary).
          The peer sends this value as a protected field (<a class='info' href='#protected-fields-sec'>Section&nbsp;4.3<span> (</span><span class='info'>Protected Fields</span><span>)</span></a>),
          encrypted using Ke and integrity protected using Ki with the negotiated encryption
	  and MAC algorithm.
</p>
<p>The server MUST verify the correct integrity protection of the received nonce,
	  and MUST abort the protocol if it is incorrect, with an "Authentication Failure" code.
</p>
<a name="confirm-request"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
EAP-EKE-Confirm/Request</h3>

<p>The server constructs:
</p>
<p>
          </p>
<blockquote class="text">
<p>PNonce_PS = Prot(Ke, Ki, Nonce_P | Nonce_S),
</p>
</blockquote><p>
        
</p>
<p>as a protected field, where Nonce_S is a randomly generated string,
	of the same size as Nonce_P.
</p>
<p>It computes: 
</p>
<p>
          </p>
<blockquote class="text">
<p>Ka = prf+(SharedSecret, "EAP-EKE Ka" | ID_S | ID_P | Nonce_P | Nonce_S)
</p>
</blockquote><p>
        
</p>
<p>whose length is the preferred key length of the negotiated prf
	(see <a class='info' href='#commit-response'>Section&nbsp;5.2<span> (</span><span class='info'>EAP-EKE-Commit/Response</span><span>)</span></a>). It then constructs:
</p>
<p>
          </p>
<blockquote class="text">
<p>Auth_S = prf(Ka, "EAP-EKE server" | EAP-EKE-ID/Request | EAP-EKE-ID/Response |
              EAP-EKE-Commit/Request | EAP-EKE-Commit/Response).
</p>
</blockquote><p>
        
</p>
<p>The messages are
          included in full, starting with the EAP header, and including any possible future
          extensions. 
</p>
<p>This construction of the Auth_S (and Auth_P) value implies that any future extensions MUST NOT be added
	  to the EAP-EKE-Confirm/Request or EAP-EKE-Confirm/Response messages themselves, unless these
	  extensions are integrity-protected in some other manner.
</p>
<p>The server now sends a message that contains the two payloads.
</p>
<p>The peer MUST verify the correct integrity protection of the received nonces and the
	  correctness of the Auth_S value,
	  and MUST abort the protocol if either is incorrect, with an "Authentication Failure" code.
</p>
<a name="confirm-response"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
EAP-EKE-Confirm/Response</h3>

<p>The peer computes Ka, and sends:
</p>
<p>
          </p>
<blockquote class="text">
<p>PNonce_S = Prot(Ke, Ki, Nonce_S)
</p>
</blockquote><p>
          
</p>
<p>as a protected field, and
</p>
<p>
          </p>
<blockquote class="text">
<p>Auth_P = prf(Ka, "EAP-EKE peer" | EAP-EKE-ID/Request | EAP-EKE-ID/Response |
              EAP-EKE-Commit/Request | EAP-EKE-Commit/Response)
</p>
</blockquote><p>
        
</p>
<p>The server MUST verify the correct integrity protection of the received nonce and
	  the correctness of the Auth_P value,
	  and MUST abort the protocol if either is incorrect, with an "Authentication Failure" code.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
MSK and EMSK</h3>

<p>Following the last message of the protocol, both sides compute and export the shared
          keys, each 64 bytes in length:
</p>
<p>
          </p>
<blockquote class="text">
<p>MSK | EMSK = prf+(SharedSecret, "EAP-EKE Exported Keys" | ID_S | ID_P | Nonce_P | Nonce_S)
</p>
</blockquote><p>
        
</p>
<p>
               When the RADIUS attributes specified in <a class='info' href='#RFC2548'>[RFC2548]<span> (</span><span class='info'>Zorn, G., &ldquo;Microsoft Vendor-specific RADIUS Attributes,&rdquo; March&nbsp;1999.</span><span>)</span></a> are used to
        transport keying material, then the first 32 bytes of the MSK
        correspond to MS-MPPE-RECV-KEY and the second 32 bytes to
        MS-MPPE-SEND-KEY.  In this case, only 64 bytes of keying material
        (the MSK) are used.
        
</p>
<p>At this point, both protocol participants MUST discard all intermediate
	cryptographic values, including x_p, x_s, y_p, y_s, Ke, Ki, Ka, SharedSecret. Similarly,
	both parties MUST immediately discard these values whenever the protocol terminates with
	a failure code or as a result of timeout.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Cryptographic Details</h3>

<a name="key-from-password"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Deriving a Key from the Password</h3>

<p>The negotiated keyed MAC algorithm is used as a hash function, to derive a bit string (albeit with low entropy)
      from the password. If "kmac" is the negotiated algorithm, we define:
</p>
<p>
      </p>
<blockquote class="text">
<p>kmac+(P) = T1 | T2 | ...
</p>
</blockquote><p>
      
</p>
<p>where each Ti is an application of the keyed MAC with a fixed key:
</p>
<p>
      </p>
<blockquote class="text">
<p>T1 = kmac("S"+, P | 0x01)
</p>
<p>T2 = kmac("S"+, T1 | P | 0x02)
</p>
<p>T3 = kmac("S"+, T2 | P | 0x03)
</p>
</blockquote><p>
      
</p>
<p>The key is a string containing the octet ASCII "S" (0x53) repeated
      N times, where N is the key length of the algorithm.
      Similarly to prf+ (<a class='info' href='#gen-key-material'>Section&nbsp;6.2<span> (</span><span class='info'>Generating Keying Material</span><span>)</span></a>), The keys are taken from the output
          string without regard to boundaries.
</p>
<a name="gen-key-material"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Generating Keying Material</h3>

<p>Keying material is derived as the output of the negotiated pseudo-random
	function (prf) algorithm.
          Since the amount of keying material needed may be greater than the size of the output of
          the prf algorithm, we will use the prf iteratively. We denote by "prf+"
          the function that outputs a pseudo-random stream based on the inputs to a prf as
          follows (where | indicates concatenation):
</p>
<p>
          </p>
<blockquote class="text">
<p>prf+ (K, S) = T1 | T2 | T3 | T4 | ...
</p>
</blockquote><p>
        
</p>
<p> where: </p>
<blockquote class="text">
<p>T1 = prf(K, S | 0x01)
</p>
<p>T2 = prf(K, T1 | S | 0x02)
</p>
<p>T3 = prf(K, T2 | S | 0x03)
</p>
<p>T4 = prf(K, T3 | S | 0x04)
</p>
</blockquote><p>
        
</p>
<p> continuing as needed to compute all required keys. The keys are taken from the output
          string without regard to boundaries (e.g., if the required keys are a 256-bit Advanced
          Encryption Standard (AES) key and a 160-bit HMAC key, and the prf function generates 160
          bits, the AES key will come from T1 and the beginning of T2, while the HMAC key will come
          from the rest of T2 and the beginning of T3). 
</p>
<p> The constant concatenated to the end of each string feeding the prf is a single octet.
          prf+ in this document is not defined beyond 255 times the size of the prf output. 
</p>
<a name="dh-groups"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Diffie-Hellman Groups</h3>

<p>
Many of the commonly used Diffie Hellman groups are inappropriate for use in EKE.
Most of these groups use a generator which is not a primitive element of the group.
As a result, an attacker running a dictionary attack would be able to learn at least
1 bit of information for each decrypted password guess.
      
</p>
<p>
      Any MODP Diffie Hellman group defined for use in this protocol MUST have the following properties,
      to ensure that it does not leak a usable amount of information about the password:
      </p>
<ol class="text">
<li>The generator is a primitive element of the group.
</li>
<li>The most significant 64 bits of the prime number are 1.
</li>
<li>The group's order p is a "safe prime", i.e. (p-1)/2 is also prime.
      
</li>
</ol><p>
      
</p>
<p>
      The last requirement is related to the strength of the Diffie Hellman algorithm,
      rather than the password encryption. It also makes it easy to verify that the
      generator is primitive.
      
</p>
<p>Suitable groups are defined in <a class='info' href='#iana-group'>Section&nbsp;7.1<span> (</span><span class='info'>Diffie-Hellman Group Registry</span><span>)</span></a>.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Mandatory Algorithms</h3>

<p>To facilitate interoperability, the following algorithms are mandatory to implement:
</p>
<p>
          </p>
<ul class="text">
<li>ENCR_AES128_CBC (encryption algorithm)
</li>
<li>PRF_HMAC_SHA1 (pseudo random function)
</li>
<li>MAC_HMAC_SHA1 (keyed message digest)
</li>
<li>DHGROUP_EKE_14 (DH-group)
</li>
</ul><p>
        
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>IANA shall allocate (has allocated) the EAP method type TBD, for "EAP-EKE Version 1".
      [Note to RFC Editor: insert the IANA-allocated value here.]
</p>
<p>This document requests that IANA create the registries described in the following sub-sections.
        Values (other than private-use ones) can be added to these registries per
        Specification Required <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>, with two exceptions:
	the Exchange and Failure Code registries can only be extended per
	RFC Required <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="iana-group"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Diffie-Hellman Group Registry</h3>

<p>This section defines an IANA registry for Diffie-Hellman groups.
        
</p>
<p>
      This table defines the initial contents of this registry.
      The Value column is used when negotiating the group.
      Additional groups may be defined through IANA allocation. Any future specification that defines
      a non-MODP group MUST specify its use within EAP-EKE and MUST demonstrate the group's security
      in this context.
      
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Name</th><th align="left">Length</th><th align="left">Value</th><th align="left">Description</th></tr>
<tr>
<td align="left">Reserved</td>
<td align="left">&nbsp;</td>
<td align="left">0</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">DHGROUP_EKE_2</td>
<td align="left">1024</td>
<td align="left">1</td>
<td align="left">The prime number of Group 2 <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>, with the generator 5 (decimal)</td>
</tr>
<tr>
<td align="left">DHGROUP_EKE_5</td>
<td align="left">1536</td>
<td align="left">2</td>
<td align="left">The prime number of Group 5 <a class='info' href='#RFC3526'>[RFC3526]<span> (</span><span class='info'>Kivinen, T. and M. Kojo, &ldquo;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE),&rdquo; May&nbsp;2003.</span><span>)</span></a>, g=31</td>
</tr>
<tr>
<td align="left">DHGROUP_EKE_14</td>
<td align="left">2048</td>
<td align="left">3</td>
<td align="left">The prime number of Group 14 <a class='info' href='#RFC3526'>[RFC3526]<span> (</span><span class='info'>Kivinen, T. and M. Kojo, &ldquo;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE),&rdquo; May&nbsp;2003.</span><span>)</span></a>, g=11</td>
</tr>
<tr>
<td align="left">DHGROUP_EKE_15</td>
<td align="left">3072</td>
<td align="left">4</td>
<td align="left">The prime number of Group 15 <a class='info' href='#RFC3526'>[RFC3526]<span> (</span><span class='info'>Kivinen, T. and M. Kojo, &ldquo;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE),&rdquo; May&nbsp;2003.</span><span>)</span></a>, g=5</td>
</tr>
<tr>
<td align="left">DHGROUP_EKE_16</td>
<td align="left">4096</td>
<td align="left">5</td>
<td align="left">The prime number of Group 16 <a class='info' href='#RFC3526'>[RFC3526]<span> (</span><span class='info'>Kivinen, T. and M. Kojo, &ldquo;More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE),&rdquo; May&nbsp;2003.</span><span>)</span></a>, g=5</td>
</tr>
<tr>
<td align="left">Available for allocation via IANA</td>
<td align="left">&nbsp;</td>
<td align="left">6-127</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">Reserved for private use</td>
<td align="left">&nbsp;</td>
<td align="left">128-255</td>
<td align="left">&nbsp;</td>
</tr>
</table>
<br clear="all" />

<a name="iana-enc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Encryption Algorithm Registry</h3>

<p>This section defines an IANA registry for encryption algorithms:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Name</th><th align="left">Value</th><th align="left">Definition</th></tr>
<tr>
<td align="left">Reserved</td>
<td align="left">0</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">ENCR_AES128_CBC</td>
<td align="left">1</td>
<td align="left">AES with a 128-bit key, CBC mode</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">2-127</td>
<td align="left">Available for allocation via IANA</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">128-255</td>
<td align="left">Reserved for private use</td>
</tr>
</table>
<br clear="all" />

<a name="iana-prf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Pseudo Random Function Registry</h3>

<p>This section defines an IANA registry for pseudo random function algorithms: 
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Name</th><th align="left">Value</th><th align="left">Definition</th></tr>
<tr>
<td align="left">Reserved</td>
<td align="left">0</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">PRF_HMAC_SHA1</td>
<td align="left">1</td>
<td align="left">HMAC SHA-1, as defined in <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">PRF_HMAC_SHA2_256</td>
<td align="left">2</td>
<td align="left">HMAC SHA-2-256 <a class='info' href='#SHA'>[SHA]<span> (</span><span class='info'>National Institute of Standards and Technology, U.S. Department of Commerce, &ldquo;Secure Hash Standard,&rdquo; October&nbsp;2008.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">3-127</td>
<td align="left">Available for allocation via IANA</td>
</tr>
<tr>
<td align="left">&nbsp;</td>
<td align="left">128-255</td>
<td align="left">Reserved for private use</td>
</tr>
</table>
<br clear="all" />

<p>A pseudo-random function takes two parameters K and S (the key and input string respectively),
	and, to be usable in this context, must be defined for all lengths
        of K between 0 and 65,535 bits (inclusive).
</p>
<a name="iana-mac"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Keyed Message Digest (MAC) Registry</h3>

<p>This section defines an IANA registry for keyed message digest algorithms:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Name</th><th align="left">Value</th><th align="left">Key Length (Octets)</th><th align="left">Definition</th></tr>
<tr>
<td align="left">Reserved</td>
<td align="left">0</td>
<td align="left">&nbsp;</td>
<td align="left">&nbsp;</td>
</tr>
<tr>
<td align="left">MAC_HMAC_SHA1</td>
<td align="left">1</td>
<td align="left">20</td>
<td align="left">HMAC SHA-1, as defined in <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">MAC_HMAC_SHA2_256</td>
<td align="left">2</td>
<td align="left">32</td>
<td align="left">HMAC SHA-2-256</td>
</tr>
<tr>
<td align="left">Reserved</td>
<td align="left">3-127</td>
<td align="left">&nbsp;</td>
<td align="left">Available for allocation via IANA</td>
</tr>
<tr>
<td align="left">Reserved</td>
<td align="left">128-255</td>
<td align="left">&nbsp;</td>
<td align="left">Reserved for private use</td>
</tr>
</table>
<br clear="all" />

<a name="iana-identity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.5"></a><h3>7.5.&nbsp;
Identity Type Registry</h3>

<p>In addition, an identity type registry is defined: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   +-----------+---------+---------------------------------------------+
   | Name      | Value   | Definition                                  |
   +-----------+---------+---------------------------------------------+
   | Reserved  | 0       |                                             |
   | ID_OPAQUE | 1       | An opaque octet string                      |
   | ID_NAI    | 2       | A Network Access Identifier, as defined in  |
   |           |         | [RFC4282]                                   |
   | ID_IPv4   | 3       | An IPv4 address, in binary format           |
   | ID_IPv6   | 4       | An IPv6 address, in binary format           |
   | ID_FQDN   | 5       | A fully qualified domain name, see note     |
   |           |         | below                                       |
   |           | 6-127   | Available for allocation via IANA           |
   |           | 128-255 | Reserved for private use                    |
   +-----------+---------+---------------------------------------------+

</pre></div><p>

        
</p>
<p>
      An example of a ID_FQDN
      is "example.com".  The string MUST NOT contain any terminators
      (e.g., NULL, CR, etc.). All characters in the ID_FQDN are ASCII;
      for an "internationalized domain name", the syntax is as defined
      in <a class='info' href='#RFC5891'>[RFC5891]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names in Applications (IDNA): Protocol,&rdquo; August&nbsp;2010.</span><span>)</span></a>, for example "xn--tmonesimerkki-bfbb.example.net".

	
</p>
<a name="iana-cbtype"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.6"></a><h3>7.6.&nbsp;
EAP-EKE Channel Binding Type Registry</h3>

<p>This section defines an IANA registry for the Channel Binding Type registry,
        a 16-bit long code.
        The value 0x0000 has been defined as Reserved. All other values up to and including 0xfeff are
        available for allocation via IANA. The remaining values
        up to and including 0xffff are available for private use.
        
</p>
<a name="iana-exchange"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.7"></a><h3>7.7.&nbsp;
Exchange Registry</h3>

<p>This section defines an IANA registry for the EAP-EKE Exchange registry, an 8-bit long code.
        Initial values are defined in <a class='info' href='#eap-eke-header-sec'>Section&nbsp;4.1<span> (</span><span class='info'>EAP-EKE Header</span><span>)</span></a>. All values up to and including 0x7f are
        available for allocation via IANA. The remaining values
        up to and including 0xff are available for private use.
        
</p>
<a name="iana-failure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.8"></a><h3>7.8.&nbsp;
Failure-Code Registry</h3>

<p>This section defines an IANA registry for the Failure-Code registry, a 32-bit long code.
        Initial values are defined in <a class='info' href='#eap-eke-failure'>Section&nbsp;4.2.4<span> (</span><span class='info'>The EAP-EKE-Failure Payload</span><span>)</span></a>. All values up to and including 0xfeffffff are
        available for allocation via IANA. The remaining values
        up to and including 0xffffffff are available for private use.
        
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>Any protocol that claims to solve the problem of password-authenticated key exchange must
        be resistant to active, passive and dictionary attack and have the quality of forward
        secrecy. These characteristics are discussed further in the following paragraphs.
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>Resistance to Passive Attack</dt>
<dd> A passive attacker is one that merely relays
            messages back and forth between the peer and server, faithfully, and without
            modification. The contents of the messages are available for inspection, but that is
            all. To achieve resistance to passive attack, such an attacker must not be able to
            obtain any information about the password or anything about the resulting shared secret
            from watching repeated runs of the protocol. Even if a passive attacker is able to learn
            the password, she will not be able to determine any information about the resulting
            secret shared by the peer and server.
</dd>
<dt>Resistance to Active Attack</dt>
<dd> An active attacker is able to modify, add,
            delete, and replay messages sent between protocol participants. For this protocol to be
            resistant to active attack, the attacker must not be able to obtain any information
            about the password or the shared secret by using any of its capabilities. In addition,
            the attacker must not be able to fool a protocol participant into thinking that the
            protocol completed successfully. It is always possible for an active attacker to deny
            delivery of a message critical in completing the exchange. This is no different than
            dropping all messages and is not an attack against the protocol.
</dd>
<dt>Resistance to Dictionary Attack</dt>
<dd> For this protocol to be resistant to
            dictionary attack any advantage an adversary can gain must be directly related to the
            number of interactions she makes with an honest protocol participant and not through
            computation. The adversary will not be able to obtain any information about the password
            except whether a single guess from a single protocol run is correct or incorrect.
</dd>
<dt>Forward Secrecy</dt>
<dd> Compromise of the password must not provide any information
            about the secrets generated by earlier runs of the protocol.
</dd>
</dl></blockquote><p>
      
</p>
<p>
        <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> requires that documents describing new EAP methods clearly
        articulate the security properties of the method. In addition, for use with wireless LANs,
          <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a> mandates and recommends several of these. The claims are: </p>
<ol class="text">
<li>Mechanism: password.
</li>
<li>Claims: 
<ul class="text">
<li>Mutual authentication: the peer and server both authenticate each other by proving
                possession of a shared password. This is REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Forward secrecy: compromise of the password does not reveal the secret keys (MSK
                and EMSK) from earlier runs of the protocol.
</li>
<li>Replay protection: an attacker is unable to replay messages from a previous
                exchange either to learn the password or a key derived by the exchange. Similarly
                the attacker is unable to induce either the peer or server to believe the exchange
                has successfully completed when it hasn't.
</li>
<li>Key derivation: a shared secret is derived by performing a group operation in a
                finite cyclic group (e.g. exponentiation) using secret data contributed by both the
                peer and server. An MSK and EMSK are derived from that shared secret. This is
                REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Dictionary attack resistance: an attacker can only make one password guess per
                active attack, and the protocol is designed so that the attacker does not
                gain any confirmation of her guess by observing the decrypted Y_x value (see below).
                The advantage she can gain is through interaction not through
                computation. This is REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Session independence: this protocol is resistant to active and passive attacks and
                does not enable compromise of subsequent or prior MSKs or EMSKs from either passive
                or active attacks.
</li>
<li>Denial of Service resistance: it is possible for an attacker to cause a server to
                allocate state and consume CPU. Such an attack is gated, though, by the requirement
                that the attacker first obtain connectivity through a lower-layer protocol (e.g.
                802.11 authentication followed by 802.11 association, or 802.3 "link-up") and
                respond to two EAP messages: the EAP-ID/Request and the EAP-EKE-ID/Request.
</li>
<li>Man-in-the-Middle Attack resistance: this exchange is resistant to active attack,
                which is a requirement for launching a man-in-the-middle attack. This is REQUIRED by
                  <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Shared state equivalence: upon completion of EAP-EKE the peer and server both agree
                on the MSK and EMSK values.
		The peer has authenticated the server based on the Server_ID and the
                server has authenticated the peer based on the Peer_ID. This is due to the fact that
                Peer_ID, Server_ID, and the generated shared secret are all combined to make the
                authentication element which must be shared between the peer and server for the
                exchange to complete. This is REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Fragmentation: this protocol does not define a technique for fragmentation and
                reassembly.
</li>
<li>Resistance to "Denning-Sacco" attack: learning keys distributed from an earlier run
                of the protocol, such as the MSK or EMSK, will not help an adversary learn the
                password.
</li>
</ul>
</li>
<li>Key strength: the strength of the resulting key depends on the finite cyclic group
            chosen. Sufficient key strength is REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>.
	    Clearly, "sufficient" strength varies over time, depending on computation power
	    assumed to be available to potential attackers.
	    
</li>
<li>Key hierarchy: MSKs and EMSKs are derived from the secret values generated during the
            protocol run, using a negotiated pseudo-random function.
</li>
<li>Vulnerabilities (note that none of these are REQUIRED by <a class='info' href='#RFC4017'>[RFC4017]<span> (</span><span class='info'>Stanley, D., Walker, J., and B. Aboba, &ldquo;Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs,&rdquo; March&nbsp;2005.</span><span>)</span></a>):
              
<ul class="text">
<li>Protected ciphersuite negotiation: the ciphersuite proposal made by the server is
                not protected from tampering by an active attacker. However if a proposal was
                modified by an active attacker it would result in a failure to confirm the message
                sent by the other party, since the proposal is bound by each side into its Confirm
                message, and the protocol would fail as a result. Note that this assumes that none
                of the proposed ciphersuites enables an attacker to perform real-time cryptanalysis.
</li>
<li>Confidentiality: none of the messages sent in this protocol are encrypted,
	      though many of the protocol fields are.
</li>
<li>Integrity protection: protocol messages are not directly integrity protected;
	      however the ID and Commit exchanges are integrity protected through the Auth payloads
	      exchanged in the Confirm exchange.
</li>
<li>Channel binding: this protocol enables the exchange of integrity-protected
                channel information that can be compared with values communicated via out-of-band
                mechanisms.
</li>
<li>Fast reconnect: this protocol does not provide a fast reconnect capability.
</li>
<li>Cryptographic binding: this protocol is not a tunneled EAP method and therefore has
                no cryptographic information to bind.
</li>
<li>Identity protection: the EAP-EKE-ID exchange is not protected. An attacker will see
                the server's identity in the EAP-EKE-ID/Request and see the peer's identity in
                EAP-EKE-ID/ Response. See also <a class='info' href='#id-protection'>Section&nbsp;8.4<span> (</span><span class='info'>Identity Protection, Anonymity and Pseudonymity</span><span>)</span></a>.
</li>
</ul>
</li>
</ol>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Cryptographic Analysis</h3>

<p>
    When analyzing the Commit exchange, it should be noted that the base security assumptions are
    different from "normal" cryptology.  Normally, we assume that the key has strong
    security properties, and that the data may have little.  Here, we assume that the key has
    weak security properties (the attacker may have a list of possible keys), and hence we need
    to ensure that the data has strong properties (indistinguishable from random).
    This difference may mean that conventional wisdom in cryptology might not apply in this case. This
    also imposes severe constraints on the protocol, e.g. the mandatory use of random padding, and
    the need to define specific finite groups.
    
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Diffie Hellman Group Considerations</h3>

<p>
    It is fundamental to the dictionary attack resistance that the Diffie Hellman
    public values y_s and y_p are indistinguishable from a random string.
    If this condition is not met, then a passive attacker can do trial-decryption of
    the encrypted DHComponent_P or DHComponent_S values based on a password guess,
    and if they decrypt to a value which is not a valid public value,
    they know that the password guess was incorrect.
    
</p>
<p>
For MODP groups, <a class='info' href='#dh-groups'>Section&nbsp;6.3<span> (</span><span class='info'>Diffie-Hellman Groups</span><span>)</span></a> gives conditions on the group to make sure that
this criterion is met.  For other groups (for example, Elliptic Curve groups),
some other means of ensuring this must be employed.  The standard way of expressing
Elliptic Curve public values does not meet this criterion, as a valid Elliptic Curve X
coordinate can be distinguished from a random string with probability approximately 0.5.
    
</p>
<p>
    A future document might introduce a group representation, and/or
    a slight modification of the password encryption scheme, so that Elliptic Curve groups
    can be accommodated. <a class='info' href='#BR02'>[BR02]<span> (</span><span class='info'>Black, J. and P. Rogaway, &ldquo;Ciphers with Arbitrary Finite Domains,&rdquo; 2002.</span><span>)</span></a> presents several alternative solutions for this problem.
    
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Resistance to Active Attacks</h3>

<p>
    An attacker, impersonating either the peer or the server, can always try to enumerate
    all possible passwords, for example by using a dictionary. To counter this likely attack vector,
    both peer and server MUST implement rate-limiting mechanisms. We note that locking out the other party
    after a small number of tries would create a trivial denial of service opportunity.
    
</p>
<a name="id-protection"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Identity Protection, Anonymity and Pseudonymity</h3>

<p>
    By default, the EAP-EKE-ID exchange is unprotected, and an eavesdropper can observe
    both parties' identities. A future extension of this protocol may support anonymity,
    e.g. by allowing the server to send a temporary identity to the peer at the end of the
    exchange, so that the peer can use that identity in subsequent exchanges.
    
</p>
<p>
    EAP-EKE differs in this respect from tunneled methods,
    which typically provide unconditional
    identity protection to the peer by encrypting the identity exchange,
    but reveal information in the server certificate.
    It is possible to use EAP-EKE as the inner method in a tunneled EAP method in
    order to achieve this level of identity protection.
    
</p>
<a name="password-equivalent"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Password Processing and Long Term Storage</h3>

<p>This document recommends to store a password-equivalent (a hash of the password)
    instead of the cleartext password. While this solution provides a measure of security,
    there are also tradeoffs related to algorithm agility:
    </p>
<ul class="text">
<li>Each stored password must identify the hash function that was used
    to compute the stored value.
</li>
<li>Complex deployments and migration scenarios might necessitate multiple stored passwords,
    one per each algorithm.
</li>
<li>Changing the algorithm can require in some cases that the users manually change their passwords.
</li>
</ul><p>
    
</p>
<p>The reader is referred to <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> for security considerations related to the parsing and processing of
    UTF-8 strings.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>Much of this document was unashamedly picked from <a class='info' href='#RFC5931'>[RFC5931]<span> (</span><span class='info'>Harkins, D. and G. Zorn, &ldquo;Extensible Authentication Protocol (EAP) Authentication Using Only a Password,&rdquo; August&nbsp;2010.</span><span>)</span></a>
        and <a class='info' href='#I-D.ietf-pppext-eap-srp-03'>[I&#8209;D.ietf&#8209;pppext&#8209;eap&#8209;srp&#8209;03]<span> (</span><span class='info'>Carlson, J., Aboba, B., and H. Haverinen, &ldquo;EAP SRP-SHA1 Authentication Protocol,&rdquo; July&nbsp;2001.</span><span>)</span></a>, and we would like to acknowledge the
        authors of these documents: Dan Harkins, Glen Zorn, James Carlson, Bernard Aboba and Henry
        Haverinen.
        We would like to thank David Jacobson, Steve Bellovin, Russ Housley,
	Brian Weis, Dan Harkins and Alexey Melnikov for their useful comments.
        Lidar Herooty and Idan Ofrat implemented this protocol and helped
        us improve it by asking the right questions, and we would like to thank them both.
        
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2548">[RFC2548]</a></td>
<td class="author-text"><a href="mailto:glennz@microsoft.com">Zorn, G.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2548">Microsoft Vendor-specific RADIUS Attributes</a>,&rdquo; RFC&nbsp;2548, March&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2548.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3454">[RFC3454]</a></td>
<td class="author-text">Hoffman, P. and M. Blanchet, &ldquo;<a href="http://tools.ietf.org/html/rfc3454">Preparation of Internationalized Strings ("stringprep")</a>,&rdquo; RFC&nbsp;3454, December&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3454.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3526">[RFC3526]</a></td>
<td class="author-text">Kivinen, T. and M. Kojo, &ldquo;<a href="http://tools.ietf.org/html/rfc3526">More Modular Exponential (MODP) Diffie-Hellman groups for Internet Key Exchange (IKE)</a>,&rdquo; RFC&nbsp;3526, May&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3526.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4013">[RFC4013]</a></td>
<td class="author-text">Zeilenga, K., &ldquo;<a href="http://tools.ietf.org/html/rfc4013">SASLprep: Stringprep Profile for User Names and Passwords</a>,&rdquo; RFC&nbsp;4013, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4013.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4282">[RFC4282]</a></td>
<td class="author-text">Aboba, B., Beadles, M., Arkko, J., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc4282">The Network Access Identifier</a>,&rdquo; RFC&nbsp;4282, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4282.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5891">[RFC5891]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5891">Internationalized Domain Names in Applications (IDNA): Protocol</a>,&rdquo; RFC&nbsp;5891, August&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5891.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SHA">[SHA]</a></td>
<td class="author-text">National Institute of Standards and Technology, U.S. Department of Commerce, &ldquo;Secure Hash Standard,&rdquo; NIST&nbsp;FIPS 180-3, October&nbsp;2008.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="BM92">[BM92]</a></td>
<td class="author-text">Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; Proc. IEEE Symp. on Research in Security and Privacy&nbsp;, May&nbsp;1992.</td></tr>
<tr><td class="author-text" valign="top"><a name="BM93">[BM93]</a></td>
<td class="author-text">Bellovin, S. and M. Merritt, &ldquo;Augmented Encrypted Key Exchange: A Password-Based Protocol Secure against
            Dictionary Attacks and Password File Compromise,&rdquo; Proc. 1st ACM Conference on Computer and Communication Security&nbsp;, 1993.</td></tr>
<tr><td class="author-text" valign="top"><a name="BMP00">[BMP00]</a></td>
<td class="author-text">Boyko, V., MacKenzie, P., and S. Patel, &ldquo;Provably Secure Password Authenticated Key Exchange Using Diffie-Hellman,&rdquo; Advances in Cryptology, EUROCRYPT 2000&nbsp;, 2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="BR02">[BR02]</a></td>
<td class="author-text">Black, J. and P. Rogaway, &ldquo;Ciphers with Arbitrary Finite Domains,&rdquo; Proc. of the RSA Cryptographer's Track (RSA CT '02), LNCS 2271&nbsp;, 2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-pppext-eap-srp-03">[I-D.ietf-pppext-eap-srp-03]</a></td>
<td class="author-text">Carlson, J., Aboba, B., and H. Haverinen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pppext-eap-srp-03.txt">EAP SRP-SHA1 Authentication Protocol</a>,&rdquo; draft-ietf-pppext-eap-srp-03 (work in progress), July&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="JAB96">[JAB96]</a></td>
<td class="author-text">Jablon, D., &ldquo;Strong Password-Only Authenticated Key Exchange,&rdquo; ACM Computer Communications Review&nbsp;Volume 1, Issue 5, October&nbsp;1996.</td></tr>
<tr><td class="author-text" valign="top"><a name="LUC97">[LUC97]</a></td>
<td class="author-text">Lucks, S., &ldquo;Open Key Exchange: How to Defeat Dictionary Attacks Without
	  Encrypting Public Keys,&rdquo; Proc. of the Security Protocols Workshop&nbsp;LNCS 1361, 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST.800-90.2007">[NIST.800-90.2007]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Recommendation for Random Number Generation Using
	Deterministic Random Bit Generators (Revised),&rdquo; NIST&nbsp;SP 800-90, March&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="PA97">[PA97]</a></td>
<td class="author-text">Patel, S., &ldquo;Number Theoretic Attacks On Secure Password Schemes,&rdquo; Proceedings of the 1997 IEEE Symposium on Security and Privacy&nbsp;, 1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4017">[RFC4017]</a></td>
<td class="author-text">Stanley, D., Walker, J., and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc4017">Extensible Authentication Protocol (EAP) Method Requirements for Wireless LANs</a>,&rdquo; RFC&nbsp;4017, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4017.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4086">[RFC4086]</a></td>
<td class="author-text">Eastlake, D., Schiller, J., and S. Crocker, &ldquo;<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>,&rdquo; BCP&nbsp;106, RFC&nbsp;4086, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4086.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5209">[RFC5209]</a></td>
<td class="author-text">Sangster, P., Khosravi, H., Mani, M., Narayan, K., and J. Tardo, &ldquo;<a href="http://tools.ietf.org/html/rfc5209">Network Endpoint Assessment (NEA): Overview and Requirements</a>,&rdquo; RFC&nbsp;5209, June&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5209.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5869">[RFC5869]</a></td>
<td class="author-text">Krawczyk, H. and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc5869">HMAC-based Extract-and-Expand Key Derivation Function (HKDF)</a>,&rdquo; RFC&nbsp;5869, May&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5869.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5931">[RFC5931]</a></td>
<td class="author-text">Harkins, D. and G. Zorn, &ldquo;<a href="http://tools.ietf.org/html/rfc5931">Extensible Authentication Protocol (EAP) Authentication Using Only a Password</a>,&rdquo; RFC&nbsp;5931, August&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5931.txt">TXT</a>).</td></tr>
</table>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change Log</h3>

<p>Note to RFC Editor: please remove this section before publication.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
-08</h3>

<p>Implemented Alexey Melnikov's "discuss" comments.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
-07</h3>

<p>Implemented IETF LC review comments, primarily from Dan Harkins. Changed the derivation
      of an encryption key from the plaintext password. Changed the derivation of EMSK for efficiency.
      Clarified the ranges of IANA allocations, and added a key length column for keyed MAC algorithms.
      Renamed some protocol fields for clarity.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
-06</h3>

<p>Lots of small changes based on Russ's AD review.
      Clarified processing of Channel Binding Values, some of which is currently out of scope.
      Made a small but non-backward compatible change to the generation of Ke, Ki.
      Changed the rules for nonce lengths (however this results in no change for the currently
      specified algorithms).
      
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4"></a><h3>A.4.&nbsp;
-05</h3>

<p>Revised the Anonymity section. Added more
      MODP groups. Note that DHGROUP_EKE_14 was renumbered.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.5"></a><h3>A.5.&nbsp;
-04</h3>

<p>Changed the intended document status to Informational.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.6"></a><h3>A.6.&nbsp;
-03</h3>

<p>Added a provision for channel binding.
</p>
<p>Clarified the notation for protected vs. encrypted fields.
</p>
<p>Explained how pseudonymity can be provided.
</p>
<p>Implementations need not implement the "password not found" failure.
</p>
<p>Eliminated the Design Options appendix.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.7"></a><h3>A.7.&nbsp;
-02</h3>

<p>Added text from EAP-SIM re: exporting MSK in RADIUS MPPE attributes.
</p>
<p>Eliminated protected failures: they are too rarely useful.
</p>
<p>Added the "extraction step" of HKDF.
</p>
<p>Removed the check for g^x != 0, since this can never happen for an honest peer,
      and otherwise requires an active password-guessing attacker,
      against which other protections are required. Added a related subsection
      about rate limiting.
</p>
<p>Added an Exchange Registry to the IANA Considerations.
</p>
<p>A general structure for protected (and merely encrypted) fields, which clarifies
      the protocol and also adds explicit integrity protection for the encrypted nonces,
      as recommended by <a class='info' href='#BM92'>[BM92]<span> (</span><span class='info'>Bellovin, S. and M. Merritt, &ldquo;Encrypted Key Exchange: Password-Based Protocols Secure Against Dictionary Attacks,&rdquo; May&nbsp;1992.</span><span>)</span></a>.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.8"></a><h3>A.8.&nbsp;
-01</h3>

<p>Revised following comments raised on the CFRG mailing list. In particular, added security
      considerations and a new DH group definition, to resolve the vulnerability in case the group's
      generator is not a primitive element.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.9"></a><h3>A.9.&nbsp;
-00</h3>

<p>Initial version.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yaron Sheffer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Independent</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:yaronf.ietf@gmail.com">yaronf.ietf@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Glen Zorn</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Zen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1310 East Thomas Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">#306</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, Washington  98102</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 (206) 377-9035</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gwz@net-zen.net">gwz@net-zen.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Scott Fluhrer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1414 Massachusetts Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Boxborough, MA  01719</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:sfluhrer@cisco.com">sfluhrer@cisco.com</a></td></tr>
</table>
</body></html>
