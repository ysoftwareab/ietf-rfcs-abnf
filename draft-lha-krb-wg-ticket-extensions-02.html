<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Kerberos ticket extensions</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Kerberos ticket extensions">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">L. Hornquist Astrand</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Apple, Inc</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">September 14, 2008</td></tr>
<tr><td class="header">Expires: March 18, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Kerberos ticket extensions<br />draft-lha-krb-wg-ticket-extensions-02</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on March 18, 2009.</p>

<h3>Abstract</h3>

<p>

	The Kerberos protocol does not allow ticket extensions.  This
	make it harder to deploy features like referrals and PKCROSS.

      
</p>
<p>

	Since the Kerberos protocol did not specified extensibility
	for the Ticket structure and the current implementations are
	aware of the contents of tickets, the extension protocol
	cannot simply extend the Ticket ASN.1 structure.  Instead, the
	extension data needs to be hidden inside the ticket.
	
      
</p>
<p>

	This protocol defines two methods to add extend the
	tickets. The first method requires updated clients and is more
	in line with the future development of Kerberos. The second
	way does not require update client. To take advantage of this
	protocol the server (KDC or application server) need to update
	a well. The two methods are equivalent and there is a 1-1
	mapping between them.

      
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements Notation<br />
<a href="#anchor2">2.</a>&nbsp;
Background<br />
<a href="#anchor3">3.</a>&nbsp;
Extending the ticket<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#extendingticket">3.1.</a>&nbsp;
Update Kerberos 5 ticket<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#backwardcompat">3.2.</a>&nbsp;
Backward compatible format<br />
<a href="#anchor4">4.</a>&nbsp;
Ticket extentions<br />
<a href="#anchor5">5.</a>&nbsp;
How to request a new assignment for a ticket extension<br />
<a href="#anchor6">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor7">7.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor8">8.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
Normative References<br />
<a href="#anchor10">Appendix&nbsp;A.</a>&nbsp;
Ticket-extensions ASN.1 Module<br />
<a href="#anchor11">Appendix&nbsp;B.</a>&nbsp;
Changes<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements Notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
        "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
        and "OPTIONAL" in this document are to be interpreted as
        described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Background</h3>

<p>
	The ticket and enc-part as defined by <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a>
	is defined as follow:

        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

Ticket          ::= [APPLICATION 1] SEQUENCE {
        tkt-vno         [0] INTEGER (5),
        realm           [1] Realm,
        sname           [2] PrincipalName,
        enc-part        [3] EncryptedData -- EncTicketPart
}

EncryptedData   ::= SEQUENCE {
        etype   [0] Int32 -- EncryptionType --,
        kvno    [1] UInt32 OPTIONAL,
        cipher  [2] OCTET STRING -- ciphertext
}


</pre></div><p>


	The reason that the ticket can't be extended is that Kerberos
	clients parses the returned ticket and any additions field
	will not be preserved.
      
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Extending the ticket</h3>

<p>
	This document describe two methods to extend tickets in
	<a class='info' href='#extendingticket'>Section&nbsp;3.1<span> (</span><span class='info'>Update Kerberos 5 ticket</span><span>)</span></a> and
	<a class='info' href='#backwardcompat'>Section&nbsp;3.2<span> (</span><span class='info'>Backward compatible format</span><span>)</span></a>.  The two methods are
	equivalent and there is a 1-1 mapping between them, copy the
	fields into the respetive fields. Anyone that creates
	protocols that uses ticket extentions MUST support the
	<a class='info' href='#extendingticket'>Section&nbsp;3.1<span> (</span><span class='info'>Update Kerberos 5 ticket</span><span>)</span></a> and SHOULD support both, ie,
	not depend on the encoding of the Ticket structure itself.
      
</p>
<a name="extendingticket"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Update Kerberos 5 ticket</h3>

<p>
	  The first method to extend the ticket is add a new field,
	  ext-data that extends the ticket with an array of type-value
	  ticket extensions.
	  
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

Ticket ::= [APPLICATION 1] SEQUENCE {
       tkt-vno[0]              Int32,
       realm[1]                Realm,
       sname[2]                PrincipalName,
       enc-part[3]             EncryptedData
       ext-data[4]             SEQUENCE OF TicketExtension OPTIONAL
}

</pre></div><p>

	
</p>
<p>
	  The client signals support by sending the PA-DATA type
	  pa-data-Client-Extensions setting the bit
	  Client-Extensions-support-et-ticket (the zero bit) to 1.
	
</p>
<p>
	  XXX write IANA registration for pa-data-Client-Extensions.
	  Require standard action, private/experimental gets to use
	  their define their own pa data.
	
</p>
<p>
	  If the KDC implement any protocols that uses Ticket
	  extentions, it MUST implement this method and prefer its use.
	
</p>
<a name="backwardcompat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Backward compatible format</h3>

<p>
	  
	  The second method is the backward compatible ticket that
	  doesn't change the format of the Ticket structure uses hides
	  the extension data inside the enc-part of the ticket.
	  
	
</p>
<p>
	  
	  It does this by using a special encryption type
	  etype-TBETicket to signal that enc-part.cipher contains the
	  DER-encoded TBETicket structure, instead of an encrypted
	  EncTicketPart.
	  
	
</p>
<p>
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

etype-TBETicket INTEGER ::= 4711 -- TBA XXX --

krb5int32  ::= INTEGER (-2147483648..2147483647)

TBETicket ::= SEQUENCE {
        etype           [0] krb5int32 -- EncryptionType --,
        cipher          [1] OCTET STRING
        extensions      [2] SEQUENCE OF TicketExtension OPTIONAL
}

</pre></div><p>

	  
	
</p>
<p>
	  
	  The content of cipher data and encryption type fields is moved
	  inside TBETicket. The kvno field is not moved and have the
	  same mening as before.
	  
	
</p>
<p>
	  If the KDC implement this protocol, it MAY support this method.
	
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Ticket extentions</h3>

<p>

	Ticket extentions are for communicating between the KDC and
	the service/KDC the ticket is for. Clients and 4th parties can
	read the data, but should do no attempt to modify, remove or
	add extentions.

      
</p>
<p>
	The ticket extentions them self is defined as follows:

        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

TicketExtension ::= SEQUENCE {
        te-type [0] krb5int32,
        te-data [1] OCTET STRING
        te-csum [2] Checksum OPTIONAL,
	te-kvno [3] krb5int32 OPTIONAL
}

</pre></div><p>

      
</p>
<p>

	Negative ticket extension types (te-type) is private
	extensions and MUST only be used for experimentation or
	private use.

      
</p>
<p>

	The te-type field specifies the type of the content in
	te-data. Unknown te-types MUST be ignored both by the client
	and the server.

      
</p>
<p>

	The te-csum field is optional for the type, specified by each
	ticket extension type. The ticket extension type have to be
	specified and the key usage number to use for the check
	sum. The key is usually the session key of the ticket, but
	doesn't have to be, an extension could specify an new session
	key used for the ticket. 


      
</p>
<p>

	The (te-kvno) field is to allow changing keys if they keys is
	some unrelated key.

      
</p>
<p>

	The KDC MUST NOT use extended ticket in an AS or TGS reply
	unless it is known that all instances of the service in
	question support it. In particular, a (local or cross-realm)
	TGT MUST NOT use extended tickets unless all of the KDCs to
	which it may be sent are known to support it.

      
</p>
<p>

	The KDC MAY return extended tickets to servers supporting
	ticket extensions even if the extended ticket does not contain
	any extensions.

      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
How to request a new assignment for a ticket extension</h3>

<p>
	When anyone is writing a Internet-draft for which a new
	assignment for te-type is needed/wanted under the ticket
	extension, then the proper way to do so is as follows:

	</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

      EXAMPLE-MODULE DEFINITIONS ::= BEGIN

      krb5-ticket-extension-Name ::= INTEGER nnn
      -- IANA: please assign nnn
      -- RFC-Editor: replace nnn with IANA-assigned
      --             number and remove this note
      END

</pre></div><p>


	IANA: Don't do note above, its an example, remove this note
	RFC-Editor: Don't do note above, its an example, remove this note

	IANA will assign the number as part of the RFC publication process.

      
</p>
<p>

	When reviewing the document, the reviewer should take sure to
	check that if te-csum is used, the signing key and key usage is
	specified.

      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
	This document describes how to extend Kerberos tickets to
	include additional data in the ticket. This does have a
	security implications since the extension data in the
	TBETicket is only optionally signed, not encrypted and is not
	replay protected. It is up to the consumers of this interface
	to make sure its used safely.
      
</p>
<p>
	Some of the issues that the extensions need to protect them self
	from are: MITM downgrade to normal ticket, add or remove
	extensions, cut and paste extensions between requests,
	retransmission of requests to a different KDC. The data is
	sent in clear text, so can should be taken to not send private data.
      
</p>
<p>
	The ticket extension is mainly to communicate information from
	the KDC to the server. The information can either be protected
	by the session key, or the key of the server. If its protected
	by the session key they both the client and the server can
	modify the data, and if its protected the servers key is can
	modified by the server. Any extension using Kerberos extension
	needs to define what the data is needs protection from.
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>
	Thanks to Leif Johansson, Kamada Ken'ichi, and Ken Raeburn for
	reviewing the document and provided suggestions for
	improvements.
      
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>
	There are currently no ticket extensions. Future ticket extensions will be published at:

	</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

      http://www.iana.org/assignments/NNNNNNNN
      -- IANA: please name registry, proposal: krb5-ticket-extensions

</pre></div><p>


	IANA is requested to maintain this registry for future assignments.
	New assignments can only be made via Specification Required as described in
	<a class='info' href='#RFC2434'>[RFC2434]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; October&nbsp;1998.</span><span>)</span></a>.
      
</p>
<p>
	IANA will assign the number as part of the RFC publication process.
      
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2434">[RFC2434]</a></td>
<td class="author-text"><a href="mailto:narten@raleigh.ibm.com">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no">H. Alvestrand</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2434">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;2434, October&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2434.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2434.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2434.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4120">[RFC4120]</a></td>
<td class="author-text">Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;<a href="http://tools.ietf.org/html/rfc4120">The Kerberos Network Authentication Service (V5)</a>,&rdquo; RFC&nbsp;4120, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4120.txt">TXT</a>).</td></tr>
</table>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Ticket-extensions ASN.1 Module</h3>

<p>
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

KerberosV5-TicketExtensions {
       iso(1) identified-organization(3) dod(6) internet(1)
       security(5) kerberosV5(2) modules(4) ticket-extensions(TBA)
--- XXX who is the registerar for this number ?
} DEFINITIONS EXPLICIT TAGS ::= BEGIN

IMPORTS
        -- as defined in RFC 4120
        Int32, Checksum
                FROM KerberosV5Spec2 { iso(1) identified-organization(3)
                     dod(6) internet(1) security(5) kerberosV5(2)
                     modules(4) krb5spec2(2) }


pa-data-Client-Extensions INTEGER ::= 4710 -- XXX TBA --

PA-DATA-CLIENT-EXTENSIONS ::= BIT STRING

Client-Extensions-support-et-ticket INTEGER ::= 1

Ticket ::= [APPLICATION 1] SEQUENCE {
       tkt-vno[0]              Int32,
       realm[1]                Realm,
       sname[2]                PrincipalName,
       enc-part[3]             EncryptedData
       ext-data[4]             SEQUENCE OF TicketExtension OPTIONAL
}

etype-TBETicket INTEGER ::= 4711 -- XXX TBA --

TBETicket ::= SEQUENCE {
        etype           [0] Int32 -- EncryptionType --,
        cipher          [1] OCTET STRING
        extensions      [2] SEQUENCE OF TicketExtension OPTIONAL
}

TicketExtension ::= SEQUENCE {
        te-type [0] Int32,
        te-data [1] OCTET STRING
        te-csum [2] Checksum
}

END

</pre></div><p>

      
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Changes</h3>

<p>
	RFC-EDITOR: please remove this section.
      
</p>
<p>
      </p>
<ul class="text">
<li>
	  Version 00 - initial version, after review of Leif
	  Johansson, Kamada Ken'ichi
	
</li>
<li>
	  Version 01 - comments from Ken Raeburn: experimentation or
 	  private use, attack types, asn1. nits.
	
</li>
<li>
	  Version 02 - comments from Ken Raeburn: new format for the
	  Ticket PDU message. protocol neg from the client via
	  pa-data. kvno is Ticket.enc-data, added kvno for te-csum
	  field. Clearifed between what parties the messages are for.
	
</li>
</ul><p>
      
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Love Hornquist Astrand</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Apple, Inc</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino  </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:lha@apple.com">lha@apple.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
