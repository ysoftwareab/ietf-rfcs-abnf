6Lo Working Group                                             H. Wang
Internet Draft                                                P. Wang
Interned status: Standards Track                               J. Zou
Expires: September 24, 2015                                  X.Y. Wei
                                                Chongqing University of
                                          Posts and Telecommunications
                                                        March 23, 2015


            Transmission of IPv6 Packets over WIA-PA Networks

                        draft-wang-6lo-wiapa-01

Abstract

   This document describes the frame format and address configuration
   for transmission of IPv6 packets on WIA-PA (Wireless networks for
   Industrial Automation-Process Automation) networks. WIA-PA is
   approved by IEC (the International Electrotechnical Commission) as
   an international standard for industrial wireless networks with the
   designation IEC 62601. The document also describes the protocol
   architecture and necessary command frames for supporting IPv6
   protocol in WIA-PA networks.

Status of this Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF). Note that other groups may also distribute working
   documents as Internet-Drafts. The list of current Internet-Drafts is
   at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six
   months and may be updated, replaced, or obsoleted by other documents
   at any time.  It is inappropriate to use Internet-Drafts as
   reference material or to cite them other than as "work in progress."

   This Internet-Draft will expire on September 24, 2015.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors. All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents



Wang, et al.         Expires September 24, 2015               [Page 1]

Internet-Draft            IPv6 over WIA-PA                  March 2015


   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document. Please review these documents
   carefully, as they describe your rights and restrictions with
   respect to this document. Code Components extracted from this
   document must include Simplified BSD License text as described in
   Section 4.e of the Trust Legal Provisions and are provided without
   warranty as described in the Simplified BSD License.

Table of Contents


   1. Introduction  ................................................ 3
      1.1. Requirements Notation ................................... 3
      1.2. Terms Uesd  ............................................. 3
   2. WIA-PA Standard  ............................................. 4
      2.1. WIA-PA Protocol Stack ................................... 4
      2.2. WIA-PA Network Topology ................................. 6
      2.3. Address Types of WIA-PA Networks ........................ 6
   3. Specification of IPv6 over WIA-PA Networks ................... 6
      3.1. Protocol Stack  ......................................... 7
      3.2. Network Layer Frame Format .............................. 8
      3.3. Network Layer Command Frame ............................. 9
      3.4. Stateless Address Configuration ........................ 10
      3.5. Transmission Format of IPv6 Packets .................... 12
      3.6. Multicast Address Conversion Method .................... 13
   4. IANA Considerations  ........................................ 14
   5. Security Considerations ..................................... 14
   6. Conclusions  ................................................ 15
   7. Acknowledgments  ............................................ 15
   8. References  ................................................. 15
      8.1. Normative References ................................... 15
      8.2. Informative References ................................. 15
      8.3. External Informative References ........................ 16
   Authors' Addresses  ............................................ 16















Wang, et al.         Expires September 24, 2015               [Page 2]

Internet-Draft            IPv6 over WIA-PA                  March 2015


1. Introduction

   WIA-PA (Wireless networks for Industrial Automation-Process
   Automation) is an industrial wireless network standard toward
   industrial process automation. The WIA-PA network consists of five
   categories physical devices: Host, gateway, router, field devices
   and handheld devices. Currently, WIA-PA networks have been widely
   used in factories, mines as well as Smart Home, Intelligent
   Transportation and all scenarios related to the Internet of Things.

   IPv6 protocol as the core protocol of the Internet of Things has the
   advantages of high security, high mobility, address auto-
   configuration and abundant address resources. It is an important
   trend that IP technology will be applied to wireless sensor nodes
   and network architecture for meeting the requirements of wireless
   sensor networks. In addition, we can achieve the interconnection
   between WIA-PA networks and Internet by means of IPv6 technology. In
   terms of the Internet, a variety of technologies and mature
   applications can be extended to WIA-PA networks, and for WIA-PA
   networks, we can extend the range of transmission among objects to
   the whole human society even around the world.

   [RFC4944] has defined the transmission of IPv6 packets on IEEE
   802.15.4. The WIA-PA standard based on IEEE 802.15.4 has been used
   extensively in industrial process measurement, monitoring and
   surveillance. In [RFC4944], IPv6 technology can be applied to
   support the transmission of IPv6 packets over WIA-PA networks.

   The aim of this document is to introduce the IPv6 transmission over
   WIA-PA networks.

1.1. Requirements Notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

1.2. Terms Uesd

    WIA-PA:  ''Wireless Networks for Industrial Automation-Process
             Automation'', a Chinese industrial wireless specification,
             is passed by 96% of IEC(International Electrotechnical
             Commission) members, and formally released as IEC/PAS 62601
             standard document.

   IPv6:    Internet Protocol Version 6



Wang, et al.         Expires September 24, 2015               [Page 3]

Internet-Draft            IPv6 over WIA-PA                  March 2015


   IEC:     International Electrotechnical Commission

   IEEE:    Institute of Electrical and Electronic Engineers

   OSI:     Open System Interconnect Reference Model

   MAC:     Medium Access Control

   TDMA:    Time Division Multiple Access

   CSMA:    Carrier Sense Multiple Access

   6LoWPAN: IPv6-based Low-power Personal Area Network

   PANID:   Personal Area Network ID

2. WIA-PA Standard

   This section provides a brief overview of WIA-PA standard.

   WIA-PA standard was published as People's Republic of China national
   standard GB/T 26790.1-2011 in July 2011. Then in October 2011, voted
   by all members of IEC, it becomes the international standard IEC:
   IEC62601Ed.1. What is worth mentioning that gateways, routers and
   field devices use the WIA-PA standard GB/T 26790.1, besides, WIA-PA
   standard can also be used in computers, handheld devices, etc.

2.1. WIA-PA Protocol Stack

   WIA-PA network protocol follows OSI reference model, however, it
   only defines data link layer, network layer and application layer,
   physical layer and MAC layer are based on IEEE 802.15.4. Physical
   layer SHOULD be used for energy detection, channel selection, and
   both sending and receiving data. Data link layer mainly ensures
   reliable, secure, accurate and real-time transmission from device to
   device. Besides, it supports hopping mechanism, retransmission
   mechanism, TDMA and CSMA mixing channel access mechanism. Network
   layer not only manages the whole network, configuring and
   controlling the operation of its own, but also provides an interface
   to send and receive data for application layer. WIA-PA application
   layer is divided into user application process and application
   sublayer, and also defines the user application object and
   communication service, where the user application object SHOULD be
   applied to industrial process interaction, and the communication
   service supports the communication among a plurality of objects of
   distributed applications in industrial environment. The WIA-PA
   network protocol stack is shown here:


Wang, et al.         Expires September 24, 2015               [Page 4]

Internet-Draft            IPv6 over WIA-PA                  March 2015


------------+---------------------------------+  +--------------------------------------------+
            |    User Application Process     |  |    Device Management Application Process   |
            +------------+   +----------------+  +-------------------+ +----------------------+
            |    User    |   |      User      |  |Network Management | |  Security Management |
            |Application |...|  Application   |  +-------------------+ +----------------------+
Application |  Object 1  |   |    Object n    |  |                                            |
            +------------+   +----------------+  |    +---------------+                       |
            |        +-----------+            |  |    |               |                       |
   Layer    +--------+ ASLDE-SAP +------------+--+----+   ASLDE-SAP   +-------------+         |
            +--------+           +--------------------+               +-----------+ |         |
            |        +-----------+                    +---------------+           | |         |
            +-------------+----------------+           +-----------+----------+ +-+-+-+       |
            |Communication| Polymerization |Application|Application|Management| |ASLME|       |
            |             |      and       |           |   Layer   |          | |     |       |
            |    Mode     |Depolymerization| Sublayer  |  Security | Services | |-SAP |       |
            +-------------+----------------+           +-----------+----------+ +-+-+-+       |
            |        +----------+                     +-------------+             | |         |
------------+--------+ NLDE-SAP +---------------------+  NLME-SAP   +-------------+ |         |
            +--------+          +---------------------+             +-------------+ |   + - + |
            |        +----------+                     +-------------+             | |   |   | |
            +------------+---------+                  +-------------+----------++-+-+-+ | M | |
  Network   | Addressing | Router  |  Network Layer   |Fragmentation|Management||NMLE | |   | |
   Layer    +------------+---------+                  |     and     |          ||     | | I | |
            |                                         |Restructuring| Services ||-SAP | |   | |
            +-----------------------------------------+-------------+----------++-+-+-+ | B | |
            |        +----------+                     +--------------+            | |   |   | |
            +--------+ DLDE-SAP +---------------------+   DLME-SAP   +------------+ |   |   | |
------------+--------+          +---------------------+              +------------+ |   + - + |
            |        +----------+                     +--------------+            | |         |
            +---------------+----------+  Data  +-------+--------+-----------+  +-+-+-+       |
            |      Time     |Superframe|  Link  |  Hop  |  Link  | Management|  |DLME |       |
   Data     |Synchronization|Scheduling|Sublayer|Channel|  Layer |           |  |     |       |
   Link     +---------------+----------+        |       |Security|  Services |  |-SAP |       |
   Layer    |                                   +-------+--------+-----------+  +-+-+-+       |
            |        +----------+                     +--------------+            | |         |
            +--------+ MLDE-SAP +---------------------+   MLME-SAP   +------------+ +---------+
            +--------+          +---------------------+              +------------+
            |        +----------+                     +--------------+            |
            |                         IEEE 802.15.4 MAC Layer                     |
            |                                                                     |
------------+---------------------------------------------------------------------+
  Physical  |                                                                     |
   Layer    |                      IEEE 802.15.4 Physical Layer                   |
------------+---------------------------------------------------------------------+

              Figure 1: Protocol Stack of WIA-PA Networks



Wang, et al.         Expires September 24, 2015               [Page 5]

Internet-Draft            IPv6 over WIA-PA                  March 2015


2.2. WIA-PA Network Topology

   WIA-PA network topology SHOULD be two layers, combining star
   topology and mesh topology. The first layer is a MESH network that
   is made up of gateways and router nodes, which can enhance
   robustness of the entire network. Furthermore, WIA-PA networks also
   define redundancy gateways and redundancy routers, enhancing the
   reliability and self-healing capacity of the entire network. The
   second layer is a star network consisting of routers and field
   devices, which is very easy to be managed due to the relative
   simplicity of the topology. And the WIA-PA network topology is shown
   in Figure 2.

                                 Host
                                  |
                   Node        Gateway       Node
                        \     /       \    /
                         Router      Router
                        /  |    \  /    |  \
                   Node    |     \/     |    Node
                   Node    |     /\     |    Node
                        \  |    /  \    |  /
                         Router ---- Router --------Handheld
                        /                  \
                   Node                      Node

                   Figure 2: WIA-PA Network Topology

2.3. Address Types of WIA-PA Networks

   As for address types, in WIA-PA networks, all devices MUST have
   globally unique EUI-64 long addresses and 16-bit short addresses.
   Devices are assigned EUI-64 long addresses by manufacturers and 16-
   bit short addresses by host, and they communicate for one another
   with a short address.

3. Specification of IPv6 over WIA-PA Networks

   In this section, we define the specification of IPv6 packets over
   WIA-PA networks.

   WIA-PA standard has defined MESH router mechanism,
   aggregation/disaggregation and fragmentation/restructuring, thus for
   WIA-PA networks with IPv6 technology, we SHOULD NOT adopt the MESH
   router mechanism and the fragmentation/restructuring defined by
   6LoWPAN. However, in [RFC4944] and [RFC6282], address compression



Wang, et al.         Expires September 24, 2015               [Page 6]

Internet-Draft            IPv6 over WIA-PA                  March 2015


   and stateless address auto-configuration SHOULD be applied to WIA-PA
   networks.

3.1. Protocol Stack

   Transport layer uses the UDP protocol with connectionless,
   unreliable and small footprint. Internet is in the upper layer of
   WIA-PA network layer, and consisting of IP layer and adaptation
   layer. The IPv6 over WIA-PA protocol stack is shown in Figure 3.

--------------+----------------------------------+  +-----------------------------------------+
              |    User Application Process      |  |  Device Management Application Process  |
              +-------------+   +----------------+  +-------------------+ +-------------------+
              |    User     |   |     User       |  |Network Management | |Security Management|
              |Application  |...|  Application   |  +-------------------+ +-------------------+
Application   |  Object 1   |   |   Object n     |  |                                         |
              +-------------+---+----------------+--+------------+-----------+----------+     |
    Layer     |Communication|   | Polymerization |  Application  |Application|Management|     |
              |             |   |      and       |               |   Layer   |          |     |
              |    Mode     |   |Depolymerization|   Sublayer    |  Security | Services |     |
--------------+-------------+---+----------------+---------------+-----------+----------+     |
  Transport   |                                                                         |     |
   Layer      |       UDP                  Transport Layer                              |     |
--------------+-------------------------------------------------------------------------+  M  |
Internet Layer|                                                                         |     |
/Network Layer+----------------------+                  +------------+------------------+     |
    Upper     |Address Configuration |     IP Layer     |  Address   |     Adaptation   |  I  |
              +----------------------+                  |Compression |       Layer      |     |
Network       |                                         +------------+                  |     |
 Layer -------+-----------------------------------------+-------------------------------+  B  |
              +--------------------+                       +----------------+-----------+     |
WIA-PA Network| Management Services| WIA-PA Network Layer  |  Fragmentation |  Router   |     |
Layer/Network +--------------------+                       | /Restructuring |           |     |
Layer Lower   |                                            +----------------+-----------+     |
--------------+---------------+----------+-------------+-------+--------+-----------+---+     |
              |      Time     |Superframe|    Data     |  Hop  |  Link  | Management|   |     |
   Data       |Synchronization|Scheduling|    Link     |Channel|  Layer |           |   |     |
   Link       +---------------+----------+  Sublayer   |       |Security|  Services |   |     |
   Layer      |                                        +-------+--------+-----------+   |     |
              +-------------------------------------------------------------------------+     |
              |                         IEEE 802.15.4 MAC Layer                         |     |
--------------+-------------------------------------------------------------------------+     |
Physical Layer|                      IEEE 802.15.4 Physical Layer                       |     |
--------------+-------------------------------------------------------------------------+-----+

               Figure 3: IPv6 over WIA-PA Protocol Stack



Wang, et al.         Expires September 24, 2015               [Page 7]

Internet-Draft            IPv6 over WIA-PA                  March 2015


3.2. Network Layer Frame Format

   In order to introduce IPv6 technology to WIA-PA networks, we combine
   WIA-PA standard and IPv6 technology, adding Internet layer and
   transport layer to previous WIA-PA network protocol stack, where
   adaptation layer and IP layer MUST be included in Internet layer.
   Simultaneously, considering WIA-PA network layer has realized
   fragmentation/restructuring and subnet MESH router, thus the network
   layer frame format SHOULD NOT include the MESH head and the
   fragmentation head of 6LoWPAN. The WIA-PA network frame format with
   IPv6 technology is shown in Figure 4. If the command frames interact
   with each other, the frame format SHOULD NOT include Internet layer,
   transport layer and application layer, and if the IPv6 packets
   interact for one another, the frame format for IPv6 packets is as
   follows:

+-------+-----------+---------------------+--------------+---------+---------------------+----+
|  MAC  |Data Link  |       WIA-PA        |   Internet   |Transport|     Application     |    |
| Layer |  Layer    |   Network Layer     |     Layer    | Layer   |        Layer        |Load|
| Header|  Header   |       Header        |    Header    | Header  |        Header       |    |
+-------+-----------+---------------------+-------+------+---------+-------+------+------+----+
|       |           |Network Frame Control|       |      |         |       |      |      |    |
|       |           +-------+-------------+       |      |         |       |      |      |    |
|       |           |       | Destination |       |      |         |       |      |      |    |
|       |           |       |   Address   |       |      |         |       |      |      |    |
|Source |Destination| Router+-------------+Message| Other|   UDP   |  APS  |Serial|Frame |Load|
|Address|  Address  | Field |   Source    |Values |Fields|  Header | Frame |Number|Length|    |
|       |           |       |   Address   |       |      |         |Control|      |      |    |
|       |           |       +-------------+       |      |         |       |      |      |    |
|       |           |       |  Router ID  |       |      |         |       |      |      |    |
|       |           +-------+-------------+       |      |         |       |      |      |    |
|       |           |    Other Fields     |       |      |         |       |      |      |    |
+-------+-----------+---------------------+-------+------+---------+-------+------+------+----+

                Figure 4: IPv6 over WIA-PA Frame Format

   The IPv6 packets make a modification on the frame control field of
   WIA-PA network layer header, which mainly defines bit5 of the frame
   control field. When bit5 is equal to 0, it indicates the packet MUST
   be a protocol data unit of WIA-PA network layer, and when bit5 is
   equal to 1, if package type is a WIA-PA network layer command frame,
   it indicates the packet MUST be an IPv6 related command frame, and
   if package type is a WIA-PA network layer packet, it indicates the
   packet MUST be an IPv6 packet then passes it to the upper layer to
   resolve. The revised WIA-PA network layer frame control field is
   shown in Figure 5.



Wang, et al.         Expires September 24, 2015               [Page 8]

Internet-Draft            IPv6 over WIA-PA                  March 2015


   +-----------+-----------------+-----------+-----------------+---------------+--------------+
   |Bit:  0-1  |        2        |     3     |        4        |       5       |     6-7      |
   +-----------+-----------------+-----------+-----------------+---------------+--------------+
   |   Packet  |  Fragmentation  |    P/S    |  Certification  |  IPv6 Packet  |   Retention  |
   |    Type   |      Flag       |    Flag   |      Flag       |     Flag      |              |
   +-----------+-----------------+-----------+-----------------+---------------+--------------+

              Figure 5: Network Layer Frame Control Field

3.3. Network Layer Command Frame

   For mentioned above, when bit5 is equal to 1 and the packet type of
   frame control field is command frame, which means the packet MUST be
   an IPv6 network layer command frame. Our document defines the
   following five categories of IPv6 network layer command frame:

1)        IPv6 enhanced joining response command frame: Command identifier is
   defined as ''129'', and it SHOULD be used for IPv6 nodes to reply the
   access network request. Network layer frame format of the response is
   shown in Figure 6. According to the ways to distribute IPv6 addresses
   or prefixes by host, the values of response command frame related
   field to be different.
+-------+-------------------------------------------------------------------------------------+
|Network|                                                                                     |
| Layer |                                 Network Layer Load                                  |
| Header|                                                                                     |
+-------+----------+-----+------------------+--------------+---------------------+------------+
|       |          |     | Physical Address | Short Address| IPv6 Address Option |            |
| Header|  Command |Added|    of Devices    |  of Devices  |    of Devices       |IPv6 Address|
|       |Identifier|State|    to be added   |  to be added |   to be added       |   /Prefix  |
+-------+----------+-----+------------------+--------------+---------------------+------------+

         Figure 6: IPv6 Enhanced Joining Response Command Frame

2)        Query short address request command frame: Command identifier is
   defined as ''130'', and the packet SHOULD be used for devices to query
   their own short addresses according to IPv6 addresses. Its frame
   format is shown here:

         +------------------------+--------------------------------------------+
         |   Network Layer Header |             Network Layer Load             |
         +------------------------+-----------------------+--------------------+
         |         Header         |   Command Identifier  |    IPv6 Address    |
         +------------------------+-----------------------+--------------------+

           Figure 7: Query Short Address Request Command Frame



Wang, et al.         Expires September 24, 2015               [Page 9]

Internet-Draft            IPv6 over WIA-PA                  March 2015


3)        Query short address response command frame: Command identifier is
   defined as ''131'', and the packet SHOULD be used for host to send a
   short address query request result to devices. Its frame format is
   shown here:

   +----------------------+-------------------------------------------------------------------+
   | Network Layer Header |                         Network Layer Load                        |
   +----------------------+------------------+-------------------+------------+---------------+
   |        Header        |Command Identifier| Execution Results |IPv6 Address| Short Address |
   +----------------------+------------------+-------------------+------------+---------------+

          Figure 8: Query Short Address Response Command Frame

4)        Query IPv6 address request command frame: Command identifier is
   defined as ''132'', and the packet SHOULD be used for devices to query
   IPv6 addresses according to their own short addresses. Its frame
   format is shown here:

         +------------------------+--------------------------------------------+
         |   Network Layer Header |             Network Layer Load             |
         +------------------------+-----------------------+--------------------+
         |         Header         |   Command Identifier  |    Short Address   |
         +------------------------+-----------------------+--------------------+

           Figure 9: Query IPv6 Address Request Command Frame

5)        Query IPv6 address response command frame: Command identifier is
   defined as ''133'', and the packet SHOULD be used for host to send an
   IPv6 address query request result to devices. Its frame format is
   shown here

   +----------------------+-------------------------------------------------------------------+
   | Network Layer Header |                          Network Layer Load                       |
   +----------------------+------------------+-------------------+-------------+--------------+
   |         Header       |Command Identifier| Execution Results |Short Address| IPv6 Address |
   +----------------------+------------------+-------------------+-------------+--------------+

          Figure 10: Query IPv6 Address Response Command Frame

3.4. Stateless Address Configuration

   All devices SHOULD be distributed prefixes or IPv6 addresses by host,
   and the process modes of devices are different due to the various
   distribution ways. There are three approaches as follows:

1)        Host distributes a unified whole network prefix to each device, and
   the devices can generate IPv6 addresses with address configuration


Wang, et al.         Expires September 24, 2015              [Page 10]

Internet-Draft            IPv6 over WIA-PA                  March 2015


   method. Then, we have the following four categories of IPv6 address:

o The automatically generated IPv6 link-local address in the process of
   device initialization: The IPv6 link-local address SHOULD be composed
   by prefix and interface identifier, where the prefix is ''FE80::0'',
   and the interface identifier is the negation of bit7 of EUI-64
   physical address. The EUI-64 link-local address is shown here:

         +------------------------+-----------------------+--------------------+
         |        Bit: 1-10       |         11-64         |        65-128      |
         +------------------------+-----------------------+--------------------+
         |       1111111010       |           0           |        EUI-64      |
         +------------------------+-----------------------+--------------------+

                 Figure 11: EUI-64 Link-local Address

o The IPv6 link-local address generated by the short address
   distributed by gateway: The prefix is ''FE80::0'', the interface
   identifier is generated by the short address and the negation of bit7
   of PANID. Due to the addresses are all composed by prefix and
   interface identifier, only difference in composition, no more
   reiteration here. The short address link-local address is shown here:

   +-----------+-------+---------+---------+------------------+---------+---------------------+
   | Bit: 1-10 | 11-64 |  65-80  |  81-88  |      89-104      | 105-112 |       113-128       |
   +-----------+-------+---------+---------+------------------+---------+---------------------+
   | 1111111010|   0   |  PANID  |    0    | 1111111111111110 |    0    |16-bit Short Address |
   +-----------+-------+---------+---------+------------------+---------+---------------------+

              Figure 12: Short Address Link-local Address

o The IPv6 unicast address generated by the unified whole network
   prefix distributed by host and EUI-64 physical address: The prefix is
   a unified whole network prefix distributed by host, the interface
   identifier is the negation of bit7 of EUI-64 physical address, and
   the EUI-64 unicast address is shown in Figure 13, where N is the
   prefix length.

         +------------------------+-----------------------+--------------------+
         |        Bit: 1-N        |         64-N          |        65-128      |
         +------------------------+-----------------------+--------------------+
         |         Prefix         |           0           |        EUI-64      |
         +------------------------+-----------------------+--------------------+

                   Figure 13: EUI-64 Unicast Address

o The IPv6 unicast address generated by the unified whole network


Wang, et al.         Expires September 24, 2015              [Page 11]

Internet-Draft            IPv6 over WIA-PA                  March 2015


   prefix distributed by host and the short address distributed by
   gateway: The prefix is a unified whole network prefix distributed by
   host, the interface identifier is generated by the short address and
   the negation of bit7 of PANID, and the short address unicast address
   is shown here:

   +-----------+-------+---------+---------+------------------+---------+---------------------+
   | Bit: 1-N  | 64-N  |  65-80  |  81-88  |      89-104      | 105-112 |       113-128       |
   +-----------+-------+---------+---------+------------------+---------+---------------------+
   |  Prefix   |   0   |  PANID  |    0    | 1111111111111110 |    0    |16-bit Short Address |
   +-----------+-------+---------+---------+------------------+---------+---------------------+

               Figure 14: Short Address Unicast Address

2)        Host distributes the entire network non-uniform prefix to devices,
   through the prefix, devices can generate IPv6 address with address
   configuration method. Consequently, it can also generate four kinds
   of IPv6 address, and the way is consistent with the unified one.

3)        Host distributes IPv6 address to devices. Then, two kinds of IPv6
   address can be generated, one is the IPv6 address distributed by host,
   the other is the IPv6 link-local address generated by EUI-64 physical
   address, as shown in figure 11.

3.5. Transmission Format of IPv6 Packets

   When bit5 is equal to 1, according to the packet types of frame
   control field, the packets of network layer can be divided into IPv6
   network layer command frames and IPv6 packets. Therefore, for the
   transmission of IPv6 packets, our document combines 6LoWPAN address
   compression method and the ways to obtain IPv6 address to define the
   following four kinds of header format of Internet layer, and the
   common format of Internet layer header is shown here:

    +-------+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+--------------------+
    |Bit: 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 | 0 | 1 | 2 | 3 | 4 | 5 |      Lengthen      |
    +-------+---+---+---+---+---+---+---+---+---+---+---+---+---+---+---+--------------------+
    |      FLAG     |   TF  | NH| HLIM  |CID|SAC|  SAM  | M |DAC|  DAM  |                    |
    +---------------+-------+---+-------+---+---+-------+---+---+-------+     Other Fields   |
    |              Dispatch             |        IPHC Basic Coding      |                    |
    +-----------------------------------+-------------------------------+--------------------+

             Figure 15: Internet Layer Header Common Format

   The Internet layer headers of IPv6 packets have different dispatch
   due to the devices use different ways to get IPv6 address. What's



Wang, et al.         Expires September 24, 2015              [Page 12]

Internet-Draft            IPv6 over WIA-PA                  March 2015


   more, the four different types of dispatch mentioned above are as
   follows:

1)        If the devices communicate with extranet devices, we SHOULD use
   uncompressed IPv6 packets during transmission, then the Internet
   layer header contains dispatch and other fields, where the dispatch
   is ''01000001'' and other fields are the related fields of IPv6 header.

2)        If the IPv6 address prefix of devices is the entire network unified
   prefix, the IPv6 packets are stateless compression. In this case, the
   Internet layer header only contains dispatch and address compression
   coding with the value of ''011TT1HH00110011'', where the value of ''TT''
   represents IPv6 header compression about Traffic Class, and the value
   of ''HH'' represents IPv6 header compression about Hop Limit.

3)        If is not the entire network unified prefix, the IPv6 packets are
   state compression, and the Internet layer header also includes
   dispatch and the address compression coding with the value of
   ''0111111001110111''.

4)        If the devices use the IPv6 header compression algorithm of 6LoWPAN
   to partially compress IPv6 header, the Internet layer header contains
   dispatch, address compression coding and other fields, where other
   fields are the uncompressed part of IPv6 header.

3.6. Multicast Address Conversion Method

   In WIA-PA networks, there MUST be two types of address: EUI-64 long
   address and 16-bit short address. In order to achieve the conversion
   between WIA-PA network address and IPv6 network address, for EUI-64
   long address, we complete the conversion with the use of address
   configuration method in [RFC4944]. And the short address is divided
   into broadcast address and unicast address, the unicast address uses
   the address configuration method in [RFC4944], the definition of
   broadcast address is according to the broadcast address set by WIA-
   PA standard and the structural properties of IPv6 multicast address.
   Several types of WIA-PA broadcast address are shown here:

   +-------------+---------------------+-----------------+-----------------+-----------------+
   |  Broadcast  |  Broadcast Address  |The Whole Network|  MESH Network   |     Gateway     |
   |Address Types|  within the Cluster |Broadcast Address|Broadcast Address|Broadcast Address|
   +-------------+---------------------+-----------------+-----------------+-----------------+
   |  Broadcast  |Cluster Address x.25 |     255.255     |      255.0      |      0.255      |
   |  Addresses  |   x Range: 1-254    |                 |                 |                 |
   +-------------+---------------------+-----------------+-----------------+-----------------+

                  Figure 16: WIA-PA Broadcast Address


Wang, et al.         Expires September 24, 2015              [Page 13]

Internet-Draft            IPv6 over WIA-PA                  March 2015


   The IPv6 multicast address is shown in Figure 17. In [RFC4291], IPv6
   multicast address defines its top eight is ''11111111''. Besides, the
   second field is a flag field, it is permanent when the multicast
   address is ''0000'', and it is temporary when ''0001''. The third field
   is a range field, the different values represent the different range.
   The broadcast address of our document is only for devices in link-
   local, and the range field indicates link-local when it is ''0010''.

                  +------------+---------+-----------+---------------+
                  |  Bit: 0-7  |   8-11  |   12-15   |     16-128    |
                  +------------+---------+-----------+---------------+
                  |  11111111  |   Flags |   Scope   |    Group ID   |
                  +------------+---------+-----------+---------------+

                   Figure 17: IPv6 Multicast Address

   As shown in Figure 18, we define IPv6 broadcast address for WIA-PA
   networks, where the broadcast address within the cluster is
   ''FF12::x .FF''. Due to the broadcast address within the cluster is
   non-permanent distribution, thus its flag field is ''1'', and ''x''
   indicates the cluster address of network, which is located in ''1-
   254''. In addition, the broadcast address of entire network is
   ''FF02::1'', which represents all field devices from broadcast to
   network. The broadcast address of MESH network is ''FF02::2'', which
   represents all routers from broadcast to network, and the broadcast
   address of gateway is ''FF02::FF''.

   +----------------+------------------+-----------------+-----------------+-----------------+
   |    Broadcast   |Broadcast Address |The Whole Network|  MESH Network   |     Gateway     |
   |  Address Types |within the Cluster|Broadcast Address|Broadcast Address|Broadcast Address|
   +----------------+------------------+-----------------+-----------------+-----------------+
   | WIA-PA Network |   FF12::x. FF    |     FF02::1     |     FF02::2     |      FF02::FF   |
   | IPv6 Broadcast |  x Range: 1-254  |                 |                 |                 |
   +----------------+------------------+-----------------+-----------------+-----------------+

                   Figure 18: IPv6 Broadcast Address

4. IANA Considerations

   There are no IANA considerations related to this document.

5. Security Considerations

   In industrial environment, the wireless networks share the same
   place and time. In this case, if the security mechanism is not very
   brilliant, it will seriously affect the system's information
   security. The security mechanism is beyond the scope of this draft.


Wang, et al.         Expires September 24, 2015              [Page 14]

Internet-Draft            IPv6 over WIA-PA                  March 2015


6. Conclusions

   This document describes the details of IPv6 transmission over WIA-PA
   networks. We add Internet layer and transport layer to WIA-PA
   protocol stack. According to the types of IPv6 packets, we redefine
   the frame format of network layer. Furthermore, the transmission
   format of packets in adaptation layer and multicast address
   conversion method are also defined in this document.

7. Acknowledgments

   We are grateful to the authors of [RFC4944] and [RFC6282] and the
   members of the IETF 6LoWPAN working group.

8. References

8.1. Normative References

   [RFC2119]           Bradner, S., "Key words for use in RFCs to
                       Indicate Requirement Levels", BCP 14, RFC 2119,
                       March 1997.

   [RFC4291]           Hinden, R. and S. Deering, "IP Version 6
                       Addressing Architecture", RFC 4291, February
                       2006.

   [RFC4944]           Montenegro, G., Kushalnagar, N., Hui, J., and
                       Culler, D., "Transmission of IPv6 Packets over
                       IEEE 802.15.4 Networks", RFC 4944, September
                       2007.

   [RFC6282]           J. Hui, Ed, "Compression Format for IPv6
                       Datagrams over IEEE 802.15.4-Based Networks",
                       RFC 6282, September 2011.

8.2. Informative References

   [EUI-64]            IEEE, "GUIIDELINES FOR 64-BIT GLOBAL IDENTIFIER (EUI-64)
                       REGISTRATION AUTHORITY", IEEE Std
                       http://standards.ieee.org/regauth/oui/tutorials/EUI64.html,
                       November 2012.

   [I-D.ietf-6lo-btle] Nieminen, J., Savolainen, T., Isomaki, M., Patil, B.,
                       Shelby, Z., and C. Gomez, "Transmission of IPv6 Packets
                       over BLUETOOTH Low Energy", draft-ietf-6lo-btle-00 (work
                       in progress), November 2013.



Wang, et al.         Expires September 24, 2015              [Page 15]

Internet-Draft            IPv6 over WIA-PA                  March 2015


8.3. External Informative References

   [WIA-PA]            IEC/PAS 62601 Ed.1.0[S], WIA-PA communication
                       network and communication profile, 2009.

   [ISA100.11a]        ISA100.11a Working Group,''Wireless systems for industrial
                       automation: Process control and related applications,''
                       ISA100.11a Draft standard, September 2008.

   [IEEE802.15.4]      IEEE Computer Society, "IEEE Std. 802.15.4-2006",
                       June 2006.

Authors' Addresses

   Heng Wang
   Chongqing University of Posts and Telecommunications
   Administrative Building, Chongqing University of Posts and
   Telecommunications
   Chongqing, 400065
   China

  Phone: (86)-23-6248-7845
   Email: wangheng@cqupt.edu.cn


   Ping Wang
   Chongqing University of Posts and Telecommunications
   Administrative Building, Chongqing University of Posts and
   Telecommunications
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: wangping@cqupt.edu.cn


   Ji Zou
   Chongqing University of Posts and Telecommunications
   Administrative Building, Chongqing University of Posts and
   Telecommunications
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: 976345534@qq.com




Wang, et al.         Expires September 24, 2015              [Page 16]

Internet-Draft            IPv6 over WIA-PA                  March 2015


   Xinyu Wei
   Chongqing University of Posts and Telecommunications
   Administrative Building, Chongqing University of Posts and
   Telecommunications
   Chongqing, 400065
   China

   Phone: (86)-23-6246-1061
   Email: 1294945391@qq.com







































Wang, et al.         Expires September 24, 2015              [Page 17]

