max1_k = 2^^(16 - ceil(Log2(1/CR)))

max_k = min(max1_k, max2_k)

