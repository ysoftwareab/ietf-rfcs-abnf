tau_key = CMAC(key = prf_key, message = 0x00...01)
ecb_key = CMAC(key = prf_key, message = 0x00...02) ||
                   CMAC(key = prf_key, message = 0x00...03)
                   truncated to perf_key_length bytes
beta1_key = CMAC(key = prf_key, message = pad_16(nonce) ||
                          pad_16(AAD) || pad_16(nonce_length |
beta2_key = x * beta1_key
m_i = msg[i], for i = 0 to N-1,
m_N = msg[N+] right padded up to 16 bytes with a 0x00 bytes.
               Undefined when msg_length is a multiple of 16

p = 0^16
out_msg = (m_0 + R, ..., m_{N-2} + R, R, m_N) +
                     (xb, x^2b, ..., x^{N-1}b, b, 0)
            where m_i = msg[i] for i = 0 to N-1,
m_N = msg[N+],
R = out_msg of poly_hash,
b = beta_key,
R = poly_hash(msg, tau_key)
e = beta_key * x
e = e * x
R = msg[N-1] + beta_key
e = beta_key * x
e = e * x
R_without_constant_term = poly_hash(out_msg, tau_key)
partial_block_pad =
             block_cipher_encrypt(ecb_key, out_msg[N-1] XOR msg[N-1])
partial_block_pad =
             block_cipher_encrypt(ecb_key, out_msg[N-1] XOR msg[N-1])
out_msg = HEH_hash(msg, beta1_key, tau_key)
out_msg = CTS_2ECB_encrypt(out_msg, ecb_key)
out_msg = HEH_hash_inv(out_msg, beta2_key, tau_key)
out_msg = HEH_hash(msg, beta2_key, tau_key)
out_msg = CTS_2ECB_decrypt(out_msg, ecb_key)
out_msg = HEH_hash_inv(out_msg, beta1_key, tau_key)
padded_msg = msg || 0^16
out_msg = HEH_DECRYPT(prf_key, ecb_key, tau_key, nonce, AAD,
                               msg)

unpadded_out_msg = out_msg[0:(out_msg_length - 16)]
key =        00000000000000000000000000000000
nonce =      EMPTY
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
ciphertext = a1726260d1450ae4aba906e79e584e07

key =        000102030405060708090A0B0C0D0E0F
nonce =      EMPTY
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
                00000000000000000000000000000000
                000000000000000000000000000000
ciphertext = f5eec4375cefa15fc3eff7a271779231
                ce03afa9eeacf9ad060a62602e6dc202
                3598944729eb848d13f9b7d362e6d5f6
                4e648e38553415f44ff37752954da7

key =        000102030405060708090A0B0C0D0E0F
nonce =      EMPTY
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
                00000000000000000000000000000001
                000000000000000000000000000000
ciphertext = 4efc731cacbbaa2713a051e663ddaeb0
                4c1b25a3ee7aa4c125c9547154c74923
                90b5f7fac503f527b8cdffe21bb96201
                b0dc409fed9e9123379e5a6f101bd2

key =        000102030405060708090A0B0C0D0E0F
nonce =      00000000000000000000000000000000
AAD =        EMPTY
plaintext =  000102030405060708090A0B0C0D0E0F
ciphertext = d8bd40bfcae5ee810f3d1f1fae890755

key =        a8da249b5efa13c2c194bf32ba38a377
nonce =      4d4761372b4786f0d647b5c2e8cf8527
AAD =        EMPTY
plaintext =  b8ee29e4a5d1e755d0fde722637636e2
                f80cf8fe6576e7cac142f5ca5aa8ac2a
ciphertext = 59f2784e1094f95c2223782a30481197
                b1fe70c4efdf04ef163904cfc0959a98
key =        000102030405060708090A0B0C0D0E0F
nonce =      00000000000000000000000000000000
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
                00000000000000000000000000000000
                000000000000000000000000000000
ciphertext = e040ebe952be6560e46868a37375b852
                ef386a872525f604e58ebe148b02141f
                a973b7ad15be9ca0d28a2cdcd4e30555
                0af5f851eee562a571a77c155d7a9e

key =        000102030405060708090A0B0C0D0E0F
nonce =      00000000000000000000000000000000
AAD =        EMPTY
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
                00000000000000000000000000000001
                000000000000000000000000000000
ciphertext = 4b1a15a0af086d70f0a797b5314b8cc3
                4df27a9dddd4159957adc6b13569f56a
                2d70e49749b29f71de22b5708c6924d3
                ad80584890e4edba763d717c572587

key =        000102030405060708090A0B0C0D0E0F
nonce =      000102030405060708090A0B0C0D0E0F
AAD =        000102030405060708090A0B0C0D0E0F
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
ciphertext = 16c3f198c970dd0db9b25beedbacb615
                b2ee9c51ece5d2426b9f5420be8b1b19

key =        000102030405060708090A0B0C0D0E0F
nonce =      000102030405060708090A0B0C0D0E0F
                000102030405
AAD =        0102030405060708090A0B0C0D0E0F00
                010203
plaintext =  00000000000000000000000000000000
                00000000000000000000000000000000
ciphertext = 2aa635491098bc45b711a5d950cc4988
                1d110f20056c9d220d125fabfd7ab941
key =        36DAF975AAE45061AF88079422E5E6A9
nonce =      4164A1FFAEEF4B23324C47279AFB02E8
AAD =        948F6D03EA0BDE71A0233AC87753F10E
plaintext =  6A2EDA8E07C10918507F0B5E4F32053C
                335D179A8F476ED1D08A458C00726F63
                6365BF26A7003F43C0270BBB44EC780E
                6119FA19AA99F0265850BD29C49E2436
                A9
ciphertext = d3312031380deb46e7f56220c934a759
                55a95fc750f3e535ada7d371ad60b3a7
                c6406389a62b1e66be371baa8adba267
                225d522936c3829c035ab109526d296f
                12

key =        880D8B115BA55842FF4505C5E45F78F6
nonce =      131D6E569B5CCB6E563D2CED8616E6AC
AAD =        01BD52F7065A35A07EE70D9A881EDDB4
plaintext =  00000000000000000000000000000000
                B1E0CC8A07264432823C68B2EF59E592
                D271271029F6364CEEE577D9FDA8E5C4
                131D6E569B5CCB6E563D2CED8616E6AC
                C6
ciphertext = 395f5d80788231bd0cc055ef1fd83941
                7501a2b4d9c42952ffcbd98be6393305
                41968ef42d589e5eb807054af2557905
                12bb5dda5be418335ae9b7e9d18c8ce8
                f7

key =        880D8B115BA55842FF4505C5E45F78F6
nonce =      131D6E569B5CCB6E563D2CED8616E6AC
AAD =        01BD52F7065A35A07EE70D9A881EDDB4
plaintext =  01000000000000000000000000000000
                B1E0CC8A07264432823C68B2EF59E592
                D271271029F6364CEEE577D9FDA8E5C4
                131D6E569B5CCB6E563D2CED8616E6AC
                C6
ciphertext = e6807e6ba3f4fba237c996f91bf6beba
                bf243915da3e8ab4c73c5ed9c0a8136b
                00dc6d7b4994b7c8551b5bf1a042c2f2
                2da1129fcbe45e310f880552a27b3f5b
                84

