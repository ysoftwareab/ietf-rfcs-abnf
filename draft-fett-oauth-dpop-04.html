<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OAuth 2.0 Demonstration of Proof-of-Possession at the Application Layer (DPoP)</title>
<meta content="Daniel Fett" name="author">
<meta content="Brian Campbell" name="author">
<meta content="John Bradley" name="author">
<meta content="Torsten Lodderstedt" name="author">
<meta content="Michael Jones" name="author">
<meta content="David Waite" name="author">
<meta content="
       This document describes a mechanism for sender-constraining OAuth 2.0
tokens via a proof-of-possession mechanism on the application level.
This mechanism allows for the detection of replay attacks with access and refresh
tokens. 
    " name="description">
<meta content="xml2rfc 2.40.1" name="generator">
<meta content="security" name="keyword">
<meta content="oauth2" name="keyword">
<meta content="draft-fett-oauth-dpop-04" name="ietf.draft">
<link href="/tmp/draft-zyhoj0bb.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OAuth DPoP</td>
<td class="right">March 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Fett, et al.</td>
<td class="center">Expires 5 September 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Web Authorization Protocol</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-fett-oauth-dpop-04</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-03-04" class="published">4 March 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-09-05">5 September 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Fett</div>
<div class="org">yes.com</div>
</div>
<div class="author">
      <div class="author-name">B. Campbell</div>
<div class="org">Ping Identity</div>
</div>
<div class="author">
      <div class="author-name">J. Bradley</div>
<div class="org">Yubico</div>
</div>
<div class="author">
      <div class="author-name">T. Lodderstedt</div>
<div class="org">yes.com</div>
</div>
<div class="author">
      <div class="author-name">M. Jones</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">D. Waite</div>
<div class="org">Ping Identity</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OAuth 2.0 Demonstration of Proof-of-Possession at the Application Layer (DPoP)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document describes a mechanism for sender-constraining OAuth 2.0
tokens via a proof-of-possession mechanism on the application level.
This mechanism allows for the detection of replay attacks with access and refresh
tokens.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 September 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-conventions-and-terminology" class="xref">Conventions and Terminology</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-main-objective" class="xref">Main Objective</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-concept" class="xref">Concept</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-dpop-proof-jwts" class="xref">DPoP Proof JWTs</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-syntax" class="xref">Syntax</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-checking-dpop-proofs" class="xref">Checking DPoP Proofs</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-token-request-binding-token" class="xref">Token Request (Binding Tokens to a Public Key)</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-resource-access-proof-of-po" class="xref">Resource Access (Proof of Possession for Access Tokens)</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-public-key-confirmation" class="xref">Public Key Confirmation</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-dpop-proof-replay" class="xref">DPoP Proof Replay</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-signed-jwt-swapping" class="xref">Signed JWT Swapping</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-signature-algorithms" class="xref">Signature Algorithms</a><a href="#section-toc.1-1.9.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-message-integrity" class="xref">Message Integrity</a><a href="#section-toc.1-1.9.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-oauth-access-token-type-reg" class="xref">OAuth Access Token Type Registration</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-json-web-signature-and-encr" class="xref">JSON Web Signature and Encryption Type Values Registration</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-document-history" class="xref">Document History</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1"><span>[<a href="#RFC8705" class="xref">RFC8705</a>]</span> describes methods to bind (sender-constrain) access tokens
using mutual Transport Layer Security (TLS) authentication with X.509
certificates.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2"><span>[<a href="#I-D.ietf-oauth-token-binding" class="xref">I-D.ietf-oauth-token-binding</a>]</span> provides mechanisms to
sender-constrain access tokens using HTTP token binding.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Due to a sub-par user experience of TLS client authentication in user
agents and a lack of support for HTTP token binding, neither mechanism
can be used if an OAuth client is a Single Page Application (SPA)
running in a web browser.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This document outlines an application-level sender-constraining for
access and refresh tokens that can be used in cases where neither mTLS nor
OAuth Token Binding are available. It uses proof-of-possession based on
a public/private key pair and application-level signing.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">DPoP can be used with public clients and, in case of confidential
clients, can be combined with any client authentication method.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="conventions-and-terminology">
<section id="section-1.1">
        <h3 id="name-conventions-and-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-conventions-and-terminology" class="section-name selfRef">Conventions and Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This specification uses the terms "access token", "refresh token",
"authorization server", "resource server", "authorization endpoint",
"authorization request", "authorization response", "token endpoint",
"grant type", "access token request", "access token response", and
"client" defined by The OAuth 2.0 Authorization Framework <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Objective_Replay_Different_Endpoint">
<section id="section-2">
      <h2 id="name-main-objective">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-main-objective" class="section-name selfRef">Main Objective</a>
      </h2>
<p id="section-2-1">Under the attacker model defined in <span>[<a href="#I-D.ietf-oauth-security-topics" class="xref">I-D.ietf-oauth-security-topics</a>]</span>,
the mechanism defined by this specification aims to prevent token
replay at a different endpoint.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">More precisely, if an adversary is able to get hold of an access token
or refresh token because it set up a counterfeit authorization server
or resource server, the adversary is not able to replay the respective
token at another authorization or resource server.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Secondary objectives are discussed in <a href="#Security" class="xref">Section 9</a>.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="concept">
<section id="section-3">
      <h2 id="name-concept">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-concept" class="section-name selfRef">Concept</a>
      </h2>
<p id="section-3-1">The main data structure introduced by this specification is a DPoP
proof JWT, described in detail below. A client uses a DPoP proof JWT to prove
the possession of a private key belonging to a certain public key.
Roughly speaking, a DPoP proof is a signature over some data of the
HTTP request to which it is attached to and a timestamp.<a href="#section-3-1" class="pilcrow">¶</a></p>
<figure id="figure-1">
        <div id="section-3-2.1">
<pre class="sourcecode lang-ascii-art">+--------+                                          +---------------+
|        |--(A)-- Token Request -------------------&gt;|               |
| Client |        (DPoP Proof)                      | Authorization |
|        |                                          |     Server    |
|        |&lt;-(B)-- DPoP-bound Access Token ----------|               |
|        |        (token_type=DPoP)                 +---------------+
|        |        PoP Refresh Token for public clients
|        |
|        |                                          +---------------+
|        |--(C)-- DPoP-bound Access Token ---------&gt;|               |
|        |        (DPoP Proof)                      |    Resource   |
|        |                                          |     Server    |
|        |&lt;-(D)-- Protected Resource ---------------|               |
|        |                                          +---------------+
+--------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
<p id="section-3-3">Figure 1: Basic DPoP Flow<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">The basic steps of an OAuth flow with DPoP are shown in Figure 1:<a href="#section-3-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-3-5.1">(A) In the Token Request, the client sends an authorization code
to the authorization server in order to obtain an access token
(and potentially a refresh token). The client attaches a DPoP
proof to the request in an HTTP header.<a href="#section-3-5.1" class="pilcrow">¶</a>
</li>
<li id="section-3-5.2">(B) The AS binds (sender-constrains) the access token to the
public key claimed by the client in the DPoP proof; that is, the access token cannot
be used without proving possession of the respective private key.
This is signaled to the client by using the <code>token_type</code> value
<code>DPoP</code>.<a href="#section-3-5.2" class="pilcrow">¶</a>
</li>
<li id="section-3-5.3">If a refresh token is issued to a public client, it is
sender-constrained in the same way. For confidential clients,
refresh tokens are bound to the <code>client_id</code>, which is more
flexible than binding it to a particular public key.<a href="#section-3-5.3" class="pilcrow">¶</a>
</li>
<li id="section-3-5.4">(C) If the client wants to use the access token, it has to prove
possession of the private key by, again, adding a header to the
request that carries the DPoP proof. The resource server needs to
receive information about the public key to which the access token is bound. This
information is either encoded directly into the access token (for
JWT structured access tokens), or provided at the token
introspection endpoint of the authorization server (not
shown).<a href="#section-3-5.4" class="pilcrow">¶</a>
</li>
<li id="section-3-5.5">(D) The resource server refuses to serve the request if the
signature check fails or the data in the DPoP proof is wrong,
e.g., the request URI does not match the URI claim in the DPoP
proof JWT.<a href="#section-3-5.5" class="pilcrow">¶</a>
</li>
<li id="section-3-5.6">When a refresh token that is sender-constrained using DPoP is used
by the client, the client has to provide a DPoP proof just as in
the case of a resource access. The new access token will be bound
to the same public key.<a href="#section-3-5.6" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3-6">The mechanism presented herein is not a client authentication method.
In fact, a primary use case is public clients (single page
applications) that do not use client authentication. Nonetheless, DPoP
is designed such that it is compatible with <code>private_key_jwt</code> and all
other client authentication methods.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">DPoP does not directly ensure message integrity but relies on the TLS
layer for that purpose. See <a href="#Security" class="xref">Section 9</a> for details.<a href="#section-3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dpop-proof-jwts">
<section id="section-4">
      <h2 id="name-dpop-proof-jwts">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-dpop-proof-jwts" class="section-name selfRef">DPoP Proof JWTs</a>
      </h2>
<p id="section-4-1">DPoP uses so-called DPoP proof JWTs for binding public keys and proving
knowledge about private keys.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="syntax">
<section id="section-4.1">
        <h3 id="name-syntax">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-syntax" class="section-name selfRef">Syntax</a>
        </h3>
<p id="section-4.1-1">A DPoP proof is a JWT (<span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>) that is signed (using JWS,
<span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>) using a private key chosen by the client (see below). The
header of a DPoP JWT contains at least the following parameters:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1-2.1">
            <code>typ</code>: type header, value <code>dpop+jwt</code> (REQUIRED).<a href="#section-4.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.2">
            <code>alg</code>: a digital signature algorithm identifier as per <span>[<a href="#RFC7518" class="xref">RFC7518</a>]</span>
(REQUIRED). MUST NOT be <code>none</code> or an identifier for a symmetric
algorithm (MAC).<a href="#section-4.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1-2.3">
            <code>jwk</code>: representing the public key chosen by the client, in JWK
format, as defined in <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> (REQUIRED)<a href="#section-4.1-2.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.1-3">The body of a DPoP proof contains at least the following claims:<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-4.1-4.1">
            <code>jti</code>: Unique identifier for the DPoP proof JWT (REQUIRED).
The value MUST be assigned such that there is a negligible
probability that the same value will be assigned to any
other DPoP proof used in the same context during the time window of validity.
Such uniqueness can be accomplished by encoding (base64url or any other
suitable encoding) at least 96 bits of
pseudorandom data or by using a version 4 UUID string according to <span>[<a href="#RFC4122" class="xref">RFC4122</a>]</span>.
The <code>jti</code> SHOULD be used by the server for replay
detection and prevention, see <a href="#Token_Replay" class="xref">Section 9.1</a>.<a href="#section-4.1-4.1" class="pilcrow">¶</a>
</li>
<li id="section-4.1-4.2">
            <code>htm</code>: The HTTP method for the request to which the JWT is
attached, as defined in <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span> (REQUIRED).<a href="#section-4.1-4.2" class="pilcrow">¶</a>
</li>
<li id="section-4.1-4.3">
            <code>htu</code>: The HTTP URI used for the request, without query and
fragment parts (REQUIRED).<a href="#section-4.1-4.3" class="pilcrow">¶</a>
</li>
<li id="section-4.1-4.4">
            <code>iat</code>: Time at which the JWT was created (REQUIRED).<a href="#section-4.1-4.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-4.1-5">Figure 2 shows the JSON header and payload of a DPoP proof JWT.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
<figure id="figure-2">
          <div class="artwork art-text alignLeft" id="section-4.1-6.1">
<pre>{
  "typ":"dpop+jwt",
  "alg":"ES256",
  "jwk": {
    "kty":"EC",
    "x":"l8tFrhx-34tV3hRICRDY9zCkDlpBhF42UQUfWVAWBFs",
    "y":"9VE4jf_Ok_o64zbTTlcuNJajHmt6v9TDVrU0CdvGRDA",
    "crv":"P-256"
  }
}.{
  "jti":"-BwC3ESc6acc2lTc",
  "htm":"POST",
  "htu":"https://server.example.com/token",
  "iat":1562262616
}
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a></figcaption></figure>
<p id="section-4.1-7">Figure 2: Example JWT content for <code>DPoP</code> proof header.<a href="#section-4.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1-8">Note: To keep DPoP simple to implement, only the HTTP method and URI
are signed in DPoP proofs. Nonetheless, DPoP proofs can be extended to
contain other information of the HTTP request (see also
<a href="#request_integrity" class="xref">Section 9.4</a>).<a href="#section-4.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="checking">
<section id="section-4.2">
        <h3 id="name-checking-dpop-proofs">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-checking-dpop-proofs" class="section-name selfRef">Checking DPoP Proofs</a>
        </h3>
<p id="section-4.2-1">To check if a string that was received as part of an HTTP Request is a
valid DPoP proof, the receiving server MUST ensure that<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2-2">
          <li id="section-4.2-2.1">the string value is a well-formed JWT,<a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
<li id="section-4.2-2.2">all required claims are contained in the JWT,<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</li>
<li id="section-4.2-2.3">the <code>typ</code> field in the header has the value <code>dpop+jwt</code>,<a href="#section-4.2-2.3" class="pilcrow">¶</a>
</li>
<li id="section-4.2-2.4">the algorithm in the header of the JWT indicates an asymmetric digital
signature algorithm, is not <code>none</code>, is supported by the
application, and is deemed secure,<a href="#section-4.2-2.4" class="pilcrow">¶</a>
</li>
<li id="section-4.2-2.5">that the JWT is signed using the public key contained in the <code>jwk</code>
header of the JWT,<a href="#section-4.2-2.5" class="pilcrow">¶</a>
</li>
<li id="section-4.2-2.6">the <code>htm</code> claim matches the HTTP method value of the HTTP
request in which the JWT was received (case-insensitive),<a href="#section-4.2-2.6" class="pilcrow">¶</a>
</li>
<li id="section-4.2-2.7">the <code>htu</code> claims matches the HTTP URI value for the HTTP
request in which the JWT was received, ignoring any query and
fragment parts,<a href="#section-4.2-2.7" class="pilcrow">¶</a>
</li>
<li id="section-4.2-2.8">the token was issued within an acceptable timeframe (see <a href="#Token_Replay" class="xref">Section 9.1</a>), and<a href="#section-4.2-2.8" class="pilcrow">¶</a>
</li>
<li id="section-4.2-2.9">that, within a reasonable consideration of accuracy and resource utilization,
a JWT with the same <code>jti</code> value has not been received
previously (see <a href="#Token_Replay" class="xref">Section 9.1</a>).<a href="#section-4.2-2.9" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-4.2-3">Servers SHOULD employ Syntax-Based Normalization and Scheme-Based
Normalization in accordance with Section 6.2.2. and Section 6.2.3. of
<span>[<a href="#RFC3986" class="xref">RFC3986</a>]</span> before comparing the <code>htu</code> claim.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="token-request-binding-tokens-to-a-public-key">
<section id="section-5">
      <h2 id="name-token-request-binding-token">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-token-request-binding-token" class="section-name selfRef">Token Request (Binding Tokens to a Public Key)</a>
      </h2>
<p id="section-5-1">To bind a token to a public key in the token request, the client MUST
provide a valid DPoP proof JWT in a <code>DPoP</code> header. The HTTPS request shown
in Figure 3 illustrates the protocol for this (with extra line breaks
for display purposes only).<a href="#section-5-1" class="pilcrow">¶</a></p>
<figure id="figure-3">
        <div class="artwork art-text alignLeft" id="section-5-2.1">
<pre>POST /token HTTP/1.1
Host: server.example.com
Content-Type: application/x-www-form-urlencoded;charset=UTF-8
DPoP: eyJ0eXAiOiJkcG9wK2p3dCIsImFsZyI6IkVTMjU2IiwiandrIjp7Imt0eSI6Ik
 VDIiwieCI6Imw4dEZyaHgtMzR0VjNoUklDUkRZOXpDa0RscEJoRjQyVVFVZldWQVdCR
 nMiLCJ5IjoiOVZFNGpmX09rX282NHpiVFRsY3VOSmFqSG10NnY5VERWclUwQ2R2R1JE
 QSIsImNydiI6IlAtMjU2In19.eyJqdGkiOiItQndDM0VTYzZhY2MybFRjIiwiaHRtIj
 oiUE9TVCIsImh0dSI6Imh0dHBzOi8vc2VydmVyLmV4YW1wbGUuY29tL3Rva2VuIiwia
 WF0IjoxNTYyMjYyNjE2fQ.2-GxA6T8lP4vfrg8v-FdWP0A0zdrj8igiMLvqRMUvwnQg
 4PtFLbdLXiOSsX0x7NVY-FNyJK70nfbV37xRZT3Lg
grant_type=authorization_code
&amp;code=SplxlOBeZQQYbYS6WxSbIA
&amp;redirect_uri=https%3A%2F%2Fclient%2Eexample%2Ecom%2Fcb
&amp;code_verifier=bEaL42izcC-o-xBk0K2vuJ6U-y1p9r_wW2dFWIWgjz-
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a></figcaption></figure>
<p id="section-5-3">Figure 3: Token Request for a DPoP sender-constrained token.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The HTTP header <code>DPoP</code> MUST contain a valid DPoP proof.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The authorization server, after checking the validity of the DPoP proof,
MUST associate the access token issued at the token endpoint with the
public key. It then sets <code>token_type</code> to <code>DPoP</code> in the token
response.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">A client typically cannot know whether a certain AS supports DPoP. It
therefore SHOULD use the value of the <code>token_type</code> parameter returned
from the AS to determine support for DPoP: If the token type returned
is <code>Bearer</code> or another value, the AS does not support DPoP. If it is
<code>DPoP</code>, DPoP is supported. Only then, the client needs to send
the <code>DPoP</code> header in subsequent requests and use the token type
<code>DPoP</code> in the <code>Authorization</code> header as described below.<a href="#section-5-6" class="pilcrow">¶</a></p>
<p id="section-5-7">If a refresh token is issued to a public client at the token endpoint
and a valid DPoP proof is presented, the refresh token MUST be bound
to the public key contained in the header of the DPoP proof JWT.<a href="#section-5-7" class="pilcrow">¶</a></p>
<p id="section-5-8">If a DPoP-bound refresh token is to be used at the token endpoint by a
public client, the AS MUST ensure that the DPoP proof contains the
same public key as the one the refresh token is bound to. The access
token issued MUST be bound to the public key contained in the DPoP
proof.<a href="#section-5-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="resource-access-proof-of-possession-for-access-tokens">
<section id="section-6">
      <h2 id="name-resource-access-proof-of-po">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-resource-access-proof-of-po" class="section-name selfRef">Resource Access (Proof of Possession for Access Tokens)</a>
      </h2>
<p id="section-6-1">To make use of an access token that is token-bound to a public key
using DPoP, a client MUST prove the possession of the corresponding
private key by providing a DPoP proof in the <code>DPoP</code> request header.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">The DPoP-bound access token must be sent in the <code>Authorization</code> header
with the prefix <code>DPoP</code>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">If a resource server detects that an access token that is to be used
for resource access is bound to a public key using DPoP (via the
methods described in <a href="#Confirmation" class="xref">Section 7</a>) it MUST check that a header
<code>DPoP</code> was received in the HTTP request, and check the header's
contents according to the rules in <a href="#checking" class="xref">Section 4.2</a>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The resource server MUST NOT grant access to the resource unless all
checks are successful.<a href="#section-6-4" class="pilcrow">¶</a></p>
<figure id="figure-4">
        <div class="artwork art-text alignLeft" id="section-6-5.1">
<pre>GET /protectedresource HTTP/1.1
Host: resource.example.org
Authorization: DPoP eyJhbGciOiJFUzI1NiIsImtpZCI6IkJlQUxrYiJ9.eyJzdWI
 iOiJzb21lb25lQGV4YW1wbGUuY29tIiwiaXNzIjoiaHR0cHM6Ly9zZXJ2ZXIuZXhhbX
 BsZS5jb20iLCJhdWQiOiJodHRwczovL3Jlc291cmNlLmV4YW1wbGUub3JnIiwibmJmI
 joxNTYyMjYyNjExLCJleHAiOjE1NjIyNjYyMTYsImNuZiI6eyJqa3QiOiIwWmNPQ09S
 Wk5ZeS1EV3BxcTMwalp5SkdIVE4wZDJIZ2xCVjN1aWd1QTRJIn19.vsFiVqHCyIkBYu
 50c69bmPJsj8qYlsXfuC6nZcLl8YYRNOhqMuRXu6oSZHe2dGZY0ODNaGg1cg-kVigzY
 hF1MQ
DPoP: eyJ0eXAiOiJkcG9wK2p3dCIsImFsZyI6IkVTMjU2IiwiandrIjp7Imt0eSI6Ik
 VDIiwieCI6Imw4dEZyaHgtMzR0VjNoUklDUkRZOXpDa0RscEJoRjQyVVFVZldWQVdCR
 nMiLCJ5IjoiOVZFNGpmX09rX282NHpiVFRsY3VOSmFqSG10NnY5VERWclUwQ2R2R1JE
 QSIsImNydiI6IlAtMjU2In19.eyJqdGkiOiJlMWozVl9iS2ljOC1MQUVCIiwiaHRtIj
 oiR0VUIiwiaHR1IjoiaHR0cHM6Ly9yZXNvdXJjZS5leGFtcGxlLm9yZy9wcm90ZWN0Z
 WRyZXNvdXJjZSIsImlhdCI6MTU2MjI2MjYxOH0.lNhmpAX1WwmpBvwhok4E74kWCiGB
 NdavjLAeevGy32H3dbF0Jbri69Nm2ukkwb-uyUI4AUg1JSskfWIyo4UCbQ
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a></figcaption></figure>
<p id="section-6-6">Figure 4: Protected Resource Request with a DPoP sender-constrained access token.<a href="#section-6-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Confirmation">
<section id="section-7">
      <h2 id="name-public-key-confirmation">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-public-key-confirmation" class="section-name selfRef">Public Key Confirmation</a>
      </h2>
<p id="section-7-1">It MUST be ensured that resource servers can reliably identify whether
a token is bound using DPoP and learn the public key to which the
token is bound.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">Access tokens that are represented as JSON Web Tokens (JWT) <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span>
MUST contain information about the DPoP public key (in JWK format) in
the member <code>jkt</code> of the <code>cnf</code> claim, as shown in Figure 5.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">The value in <code>jkt</code> MUST be the base64url encoding <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> of
the JWK SHA-256 Thumbprint (according to <span>[<a href="#RFC7638" class="xref">RFC7638</a>]</span>) of the public
key to which the access token is bound.<a href="#section-7-3" class="pilcrow">¶</a></p>
<figure id="figure-5">
        <div class="artwork art-text alignLeft" id="section-7-4.1">
<pre>{
  "sub":"someone@example.com",
  "iss":"https://server.example.com",
  "aud":"https://resource.example.org",
  "nbf":1562262611,
  "exp":1562266216,
  "cnf":{
      "jkt":"0ZcOCORZNYy-DWpqq30jZyJGHTN0d2HglBV3uiguA4I"
  }
}
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a></figcaption></figure>
<p id="section-7-5">Figure 5: Example access token body with <code>cnf</code> claim.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">When access token introspection is used, the same <code>cnf</code> claim as above
MUST be contained in the introspection response.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">Resource servers MUST ensure that the fingerprint of the public key in
the DPoP proof JWT equals the value in the <code>jkt</code> claim in the access
token or introspection response.<a href="#section-7-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">We would like to thank David Waite, Filip Skokan, Mike Engan, and Justin Richer for
their valuable input and feedback.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">This document resulted from discussions at the 4th OAuth Security
Workshop in Stuttgart, Germany. We thank the organizers of this
workshop (Ralf Kusters, Guido Schmitz).<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-9">
      <h2 id="name-security-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-9-1">In DPoP, the prevention of token replay at a different endpoint (see
<a href="#Objective_Replay_Different_Endpoint" class="xref">Section 2</a>) is achieved through the
binding of the DPoP proof to a certain URI and HTTP method. DPoP does
not, however, achieve the same level of protection as TLS-based
methods such as OAuth Mutual TLS <span>[<a href="#RFC8705" class="xref">RFC8705</a>]</span> or OAuth Token
Binding <span>[<a href="#I-D.ietf-oauth-token-binding" class="xref">I-D.ietf-oauth-token-binding</a>]</span> (see also <a href="#Token_Replay" class="xref">Section 9.1</a> and <a href="#request_integrity" class="xref">Section 9.4</a>).
TLS-based mechanisms can leverage a tight integration
between the TLS layer and the application layer to achieve a very high
level of message integrity and replay protection. Therefore, it is
RECOMMENDED to prefer TLS-based methods over DPoP if such methods are
suitable for the scenario at hand.<a href="#section-9-1" class="pilcrow">¶</a></p>
<div id="Token_Replay">
<section id="section-9.1">
        <h3 id="name-dpop-proof-replay">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-dpop-proof-replay" class="section-name selfRef">DPoP Proof Replay</a>
        </h3>
<p id="section-9.1-1">If an adversary is able to get hold of a DPoP proof JWT, the adversary
could replay that token at the same endpoint (the HTTP endpoint
and method are enforced via the respective claims in the JWTs). To
prevent this, servers MUST only accept DPoP proofs for a limited time
window after their <code>iat</code> time, preferably only for a relatively brief period.
Servers SHOULD store the <code>jti</code> value of each DPoP proof for the time window in
which the respective DPoP proof JWT would be accepted and decline HTTP requests
for which the <code>jti</code> value has been seen before. In order to guard against
memory exhaustion attacks a server SHOULD reject DPoP proof JWTs with unnecessarily
large <code>jti</code> values or store only a hash thereof.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<p id="section-9.1-2">Note: To accommodate for clock offsets, the server MAY accept DPoP
proofs that carry an <code>iat</code> time in the near future (e.g., up to a few
seconds in the future).<a href="#section-9.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signed-jwt-swapping">
<section id="section-9.2">
        <h3 id="name-signed-jwt-swapping">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-signed-jwt-swapping" class="section-name selfRef">Signed JWT Swapping</a>
        </h3>
<p id="section-9.2-1">Servers accepting signed DPoP proof JWTs MUST check the <code>typ</code> field in the
headers of the JWTs to ensure that adversaries cannot use JWTs created
for other purposes in the DPoP headers.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-algorithms">
<section id="section-9.3">
        <h3 id="name-signature-algorithms">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-signature-algorithms" class="section-name selfRef">Signature Algorithms</a>
        </h3>
<p id="section-9.3-1">Implementers MUST ensure that only asymmetric digital signature algorithms that
are deemed secure can be used for signing DPoP proofs. In particular,
the algorithm <code>none</code> MUST NOT be allowed.<a href="#section-9.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request_integrity">
<section id="section-9.4">
        <h3 id="name-message-integrity">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-message-integrity" class="section-name selfRef">Message Integrity</a>
        </h3>
<p id="section-9.4-1">DPoP does not ensure the integrity of the payload or headers of
requests. The signature of DPoP proofs only contains the HTTP URI and
method, but not, for example, the message body or other request
headers.<a href="#section-9.4-1" class="pilcrow">¶</a></p>
<p id="section-9.4-2">This is an intentional design decision to keep DPoP simple to use, but
as described, makes DPoP potentially susceptible to replay attacks
where an attacker is able to modify message contents and headers. In
many setups, the message integrity and confidentiality provided by TLS
is sufficient to provide a good level of protection.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
<p id="section-9.4-3">Implementers that have stronger requirements on the integrity of
messages are encouraged to either use TLS-based mechanisms or signed
requests. TLS-based mechanisms are in particular OAuth Mutual TLS
<span>[<a href="#RFC8705" class="xref">RFC8705</a>]</span> and OAuth Token Binding
<span>[<a href="#I-D.ietf-oauth-token-binding" class="xref">I-D.ietf-oauth-token-binding</a>]</span>.<a href="#section-9.4-3" class="pilcrow">¶</a></p>
<p id="section-9.4-4">Note: While signatures on (parts of) requests are out of the scope of
this specification, signatures or information to be signed can be
added into DPoP proofs.<a href="#section-9.4-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="oauth-access-token-type-registration">
<section id="section-10.1">
        <h3 id="name-oauth-access-token-type-reg">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-oauth-access-token-type-reg" class="section-name selfRef">OAuth Access Token Type Registration</a>
        </h3>
<p id="section-10.1-1">This specification registers the following access token type in the
OAuth Access Token Types registry defined in [RFC6749].<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-10.1-2.1">Type name: "DPoP"<a href="#section-10.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-10.1-2.2">Additional Token Endpoint Response Parameters: (none)<a href="#section-10.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-10.1-2.3">HTTP Authentication Scheme(s): Bearer<a href="#section-10.1-2.3" class="pilcrow">¶</a>
</li>
<li id="section-10.1-2.4">Change controller: IETF<a href="#section-10.1-2.4" class="pilcrow">¶</a>
</li>
<li id="section-10.1-2.5">Specification document(s): [[ this specification ]]<a href="#section-10.1-2.5" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="json-web-signature-and-encryption-type-values-registration">
<section id="section-10.2">
        <h3 id="name-json-web-signature-and-encr">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-json-web-signature-and-encr" class="section-name selfRef">JSON Web Signature and Encryption Type Values Registration</a>
        </h3>
<p id="section-10.2-1">This specification registers the <code>dpop+jwt</code> type value in the IANA
JSON Web Signature and Encryption Type Values registry <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span>:<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-10.2-2.1">"typ" Header Parameter Value: "dpop+jwt"<a href="#section-10.2-2.1" class="pilcrow">¶</a>
</li>
<li id="section-10.2-2.2">Abbreviation for MIME Type: None<a href="#section-10.2-2.2" class="pilcrow">¶</a>
</li>
<li id="section-10.2-2.3">Change Controller: IETF<a href="#section-10.2-2.3" class="pilcrow">¶</a>
</li>
<li id="section-10.2-2.4">Specification Document(s): [[ this specification ]]<a href="#section-10.2-2.4" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC6749">[RFC6749]</dt>
<dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dt id="RFC7519">[RFC7519]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dt id="RFC7638">[RFC7638]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor"> and N. Sakimura</span>, <span class="refTitle">"JSON Web Key (JWK) Thumbprint"</span>, <span class="seriesInfo">RFC 7638</span>, <span class="seriesInfo">DOI 10.17487/RFC7638</span>, <time datetime="2015-09">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7638">https://www.rfc-editor.org/info/rfc7638</a>&gt;</span>. </dd>
<dt id="RFC7518">[RFC7518]</dt>
<dd>
<span class="refAuthor">Jones, M.</span>, <span class="refTitle">"JSON Web Algorithms (JWA)"</span>, <span class="seriesInfo">RFC 7518</span>, <span class="seriesInfo">DOI 10.17487/RFC7518</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7518">https://www.rfc-editor.org/info/rfc7518</a>&gt;</span>. </dd>
<dt id="RFC7231">[RFC7231]</dt>
<dd>
<span class="refAuthor">Fielding, R., Ed.</span><span class="refAuthor"> and J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;</span>. </dd>
<dt id="RFC3986">[RFC3986]</dt>
<dd>
<span class="refAuthor">Berners-Lee, T.</span><span class="refAuthor">, Fielding, R.</span><span class="refAuthor">, and L. Masinter</span>, <span class="refTitle">"Uniform Resource Identifier (URI): Generic Syntax"</span>, <span class="seriesInfo">STD 66</span>, <span class="seriesInfo">RFC 3986</span>, <span class="seriesInfo">DOI 10.17487/RFC3986</span>, <time datetime="2005-01">January 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3986">https://www.rfc-editor.org/info/rfc3986</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-informative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-oauth-token-binding">[I-D.ietf-oauth-token-binding]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Campbell, B.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and W. Denniss</span>, <span class="refTitle">"OAuth 2.0 Token Binding"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-token-binding-08</span>, <time datetime="2018-10-19">19 October 2018</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-token-binding-08">https://tools.ietf.org/html/draft-ietf-oauth-token-binding-08</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dt id="RFC7515">[RFC7515]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dt id="RFC4122">[RFC4122]</dt>
<dd>
<span class="refAuthor">Leach, P.</span><span class="refAuthor">, Mealling, M.</span><span class="refAuthor">, and R. Salz</span>, <span class="refTitle">"A Universally Unique IDentifier (UUID) URN Namespace"</span>, <span class="seriesInfo">RFC 4122</span>, <span class="seriesInfo">DOI 10.17487/RFC4122</span>, <time datetime="2005-07">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4122">https://www.rfc-editor.org/info/rfc4122</a>&gt;</span>. </dd>
<dt id="RFC8705">[RFC8705]</dt>
<dd>
<span class="refAuthor">Campbell, B.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Sakimura, N.</span><span class="refAuthor">, and T. Lodderstedt</span>, <span class="refTitle">"OAuth 2.0 Mutual-TLS Client Authentication and Certificate-Bound Access Tokens"</span>, <span class="seriesInfo">RFC 8705</span>, <span class="seriesInfo">DOI 10.17487/RFC8705</span>, <time datetime="2020-02">February 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8705">https://www.rfc-editor.org/info/rfc8705</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="I-D.ietf-oauth-security-topics">[I-D.ietf-oauth-security-topics]</dt>
<dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Labunets, A.</span><span class="refAuthor">, and D. Fett</span>, <span class="refTitle">"OAuth 2.0 Security Best Current Practice"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-oauth-security-topics-14</span>, <time datetime="2020-02-10">10 February 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-security-topics-14">https://tools.ietf.org/html/draft-ietf-oauth-security-topics-14</a>&gt;</span>. </dd>
</dl>
</section>
<div id="document-history">
<section id="section-appendix.a">
      <h2 id="name-document-history">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<p id="section-appendix.a-1">[[ To be removed from the final specification ]]<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
<p id="section-appendix.a-2">-04<a href="#section-appendix.a-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.a-3.1">Update OAuth MTLS reference to RFC 8705<a href="#section-appendix.a-3.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-3.2">Use the newish RFC v3 XML and HTML format<a href="#section-appendix.a-3.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-appendix.a-4">-03<a href="#section-appendix.a-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.a-5.1">rework the text around uniqueness requirements on the jti claim in the DPoP proof JWT<a href="#section-appendix.a-5.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-5.2">make tokens a bit smaller by using <code>htm</code>, <code>htu</code>, and <code>jkt</code> rather than <code>http_method</code>, <code>http_uri</code>, and <code>jkt#S256</code> respectively<a href="#section-appendix.a-5.2" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-5.3">more explicit recommendation to use mTLS if that is available<a href="#section-appendix.a-5.3" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-5.4">added David Waite as co-author<a href="#section-appendix.a-5.4" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-5.5">editorial updates<a href="#section-appendix.a-5.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-appendix.a-6">-02<a href="#section-appendix.a-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.a-7.1">added normalization rules for URIs<a href="#section-appendix.a-7.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.2">removed distinction between proof and binding<a href="#section-appendix.a-7.2" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.3">"jwk" header again used instead of "cnf" claim in DPoP proof<a href="#section-appendix.a-7.3" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.4">renamed "Bearer-DPoP" token type to "DPoP"<a href="#section-appendix.a-7.4" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.5">removed ability for key rotation<a href="#section-appendix.a-7.5" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.6">added security considerations on request integrity<a href="#section-appendix.a-7.6" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.7">explicit advice on extending DPoP proofs to sign other parts of the HTTP messages<a href="#section-appendix.a-7.7" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.8">only use the jkt#S256 in ATs<a href="#section-appendix.a-7.8" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.9">iat instead of exp in DPoP proof JWTs<a href="#section-appendix.a-7.9" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-7.10">updated guidance on token_type evaluation<a href="#section-appendix.a-7.10" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-appendix.a-8">-01<a href="#section-appendix.a-8" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.a-9.1">fixed inconsistencies<a href="#section-appendix.a-9.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-9.2">moved binding and proof messages to headers instead of parameters<a href="#section-appendix.a-9.2" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-9.3">extracted and unified definition of DPoP JWTs<a href="#section-appendix.a-9.3" class="pilcrow">¶</a>
</li>
<li id="section-appendix.a-9.4">improved description<a href="#section-appendix.a-9.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-appendix.a-10">-00<a href="#section-appendix.a-10" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.a-11.1">first draft<a href="#section-appendix.a-11.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Daniel Fett</span></div>
<div dir="auto" class="left"><span class="org">yes.com</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mail@danielfett.de" class="email">mail@danielfett.de</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Brian Campbell</span></div>
<div dir="auto" class="left"><span class="org">Ping Identity</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:bcampbell@pingidentity.com" class="email">bcampbell@pingidentity.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">John Bradley</span></div>
<div dir="auto" class="left"><span class="org">Yubico</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ve7jtb@ve7jtb.com" class="email">ve7jtb@ve7jtb.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Torsten Lodderstedt</span></div>
<div dir="auto" class="left"><span class="org">yes.com</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:torsten@lodderstedt.net" class="email">torsten@lodderstedt.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Michael Jones</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:mbj@microsoft.com" class="email">mbj@microsoft.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David Waite</span></div>
<div dir="auto" class="left"><span class="org">Ping Identity</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:david@alkaline-solutions.com" class="email">david@alkaline-solutions.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
