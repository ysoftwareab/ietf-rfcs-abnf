<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Mathematical Mesh 3.0 Part I: Architecture Guide</title>
<meta content="Phillip Hallam-Baker" name="author">
<meta content="
       The Mathematical Mesh 'The Mesh' is an end-to-end secure infrastructure that makes computers easier to use by making them more secure. The Mesh provides a set of protocol and cryptographic building blocks that enable encrypted data stored in the cloud to be accessed, managed and exchanged between users with the same or better ease of use than traditional approaches which leave the data vulnerable to attack. 
       This document provides an overview of the Mesh data structures, protocols and examples of its use. 
       [Note to Readers] 
       Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh. 
       This document is also available online at  . 
    " name="description">
<meta content="xml2rfc 2.40.1" name="generator">
<meta content="draft-hallambaker-mesh-architecture-13" name="ietf.draft">
<link href="/tmp/draft-hallambaker-mesh-architecture-13-zjxyb92g.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Mesh Architecture 3.0</td>
<td class="right">March 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hallam-Baker</td>
<td class="center">Expires 10 September 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hallambaker-mesh-architecture</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-03-09" class="published">9 March 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-09-10">10 September 2020</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. M. Hallam-Baker</div>
<div class="org">ThresholdSecrets.com</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Mathematical Mesh 3.0 Part I: Architecture Guide</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Mathematical Mesh 'The Mesh' is an end-to-end secure infrastructure that makes computers easier to use by making them more secure. The Mesh provides a set of protocol and cryptographic building blocks that enable encrypted data stored in the cloud to be accessed, managed and exchanged between users with the same or better ease of use than traditional approaches which leave the data vulnerable to attack.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document provides an overview of the Mesh data structures, protocols and examples of its use.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">[Note to Readers]<a href="#section-abstract-3" class="pilcrow">¶</a></p>
<p id="section-abstract-4">Discussion of this draft takes place on the MATHMESH mailing list (mathmesh@ietf.org), which is archived at https://mailarchive.ietf.org/arch/search/?email_list=mathmesh.<a href="#section-abstract-4" class="pilcrow">¶</a></p>
<p id="section-abstract-5">This document is also available online at <span><a href="http://mathmesh.com/Documents/draft-hallambaker-mesh-architecture.html">http://mathmesh.com/Documents/draft-hallambaker-mesh-architecture.html</a></span>.<a href="#section-abstract-5" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-3">
<a href="#name-status-of-this-memo-3" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 10 September 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-3">
<a href="#name-copyright-notice-3" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-3">
<a href="#name-table-of-contents-3" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-3" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-definitions" class="xref">Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-related-specifications" class="xref">Related Specifications</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-defined-terms" class="xref">Defined Terms</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-requirements-language-2" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-architecture" class="xref">Architecture</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-a-personal-pki" class="xref">A Personal PKI</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.  <a href="#name-device-management" class="xref">Device Management</a><a href="#section-toc.1-1.3.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.  <a href="#name-exchange-of-trusted-credent" class="xref">Exchange of trusted credentials.</a><a href="#section-toc.1-1.3.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.  <a href="#name-application-configuration-m" class="xref">Application configuration management</a><a href="#section-toc.1-1.3.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="xref">3.1.4</a>.  <a href="#name-the-mesh-as-platform" class="xref">The Mesh as platform</a><a href="#section-toc.1-1.3.2.1.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-mesh-architecture" class="xref">Mesh Architecture</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-mesh-device-management" class="xref">Mesh Device Management</a><a href="#section-toc.1-1.3.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-mesh-account" class="xref">Mesh Account</a><a href="#section-toc.1-1.3.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.3">
                    <p id="section-toc.1-1.3.2.2.2.3.1"><a href="#section-3.2.3" class="xref">3.2.3</a>.  <a href="#name-mesh-service" class="xref">Mesh Service</a><a href="#section-toc.1-1.3.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2.2.4">
                    <p id="section-toc.1-1.3.2.2.2.4.1"><a href="#section-3.2.4" class="xref">3.2.4</a>.  <a href="#name-mesh-messaging" class="xref">Mesh Messaging</a><a href="#section-toc.1-1.3.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-using-the-mesh-with-applica" class="xref">Using the Mesh with Applications</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-contact-exchange" class="xref">Contact Exchange</a><a href="#section-toc.1-1.3.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="xref">3.3.2</a>.  <a href="#name-confirmation-protocol" class="xref">Confirmation Protocol</a><a href="#section-toc.1-1.3.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3.2.3">
                    <p id="section-toc.1-1.3.2.3.2.3.1"><a href="#section-3.3.3" class="xref">3.3.3</a>.  <a href="#name-future-applications" class="xref">Future Applications</a><a href="#section-toc.1-1.3.2.3.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-mesh-cryptography" class="xref">Mesh Cryptography</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-best-practice-by-default" class="xref">Best Practice by Default</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-multi-level-security" class="xref">Multi-Level Security</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-multi-key-decryption" class="xref">Multi-Key Decryption</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-multi-party-key-generation" class="xref">Multi-Party Key Generation</a><a href="#section-toc.1-1.4.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.  <a href="#name-data-at-rest-encryption" class="xref">Data At Rest Encryption</a><a href="#section-toc.1-1.4.2.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.5.2.1">
                    <p id="section-toc.1-1.4.2.5.2.1.1"><a href="#section-4.5.1" class="xref">4.5.1</a>.  <a href="#name-dare-envelope" class="xref">DARE Envelope</a><a href="#section-toc.1-1.4.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.5.2.2">
                    <p id="section-toc.1-1.4.2.5.2.2.1"><a href="#section-4.5.2" class="xref">4.5.2</a>.  <a href="#name-dare-container" class="xref">Dare Container</a><a href="#section-toc.1-1.4.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.6">
                <p id="section-toc.1-1.4.2.6.1"><a href="#section-4.6" class="xref">4.6</a>.  <a href="#name-uniform-data-fingerprints" class="xref">Uniform Data Fingerprints.</a><a href="#section-toc.1-1.4.2.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.6.2.1">
                    <p id="section-toc.1-1.4.2.6.2.1.1"><a href="#section-4.6.1" class="xref">4.6.1</a>.  <a href="#name-friendly-names" class="xref">Friendly Names</a><a href="#section-toc.1-1.4.2.6.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.6.2.2">
                    <p id="section-toc.1-1.4.2.6.2.2.1"><a href="#section-4.6.2" class="xref">4.6.2</a>.  <a href="#name-encrypted-authenticated-res" class="xref">Encrypted Authenticated Resource Locators</a><a href="#section-toc.1-1.4.2.6.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.6.2.3">
                    <p id="section-toc.1-1.4.2.6.2.3.1"><a href="#section-4.6.3" class="xref">4.6.3</a>.  <a href="#name-secure-internet-names" class="xref">Secure Internet Names</a><a href="#section-toc.1-1.4.2.6.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.7">
                <p id="section-toc.1-1.4.2.7.1"><a href="#section-4.7" class="xref">4.7</a>.  <a href="#name-personal-key-escrow" class="xref">Personal Key Escrow</a><a href="#section-toc.1-1.4.2.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-user-experience" class="xref">User Experience</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-creating-a-mesh-profile-and" class="xref">Creating a Mesh Profile and Administration Device.</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-mesh-accounts" class="xref">Mesh Accounts</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-using-a-mesh-service" class="xref">Using a Mesh Service</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-connecting-and-authorizing-" class="xref">Connecting and Authorizing Additional Devices</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.4.2.1">
                    <p id="section-toc.1-1.5.2.4.2.1.1"><a href="#section-5.4.1" class="xref">5.4.1</a>.  <a href="#name-direct-connection" class="xref">Direct Connection</a><a href="#section-toc.1-1.5.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.4.2.2">
                    <p id="section-toc.1-1.5.2.4.2.2.1"><a href="#section-5.4.2" class="xref">5.4.2</a>.  <a href="#name-pin-connection" class="xref">Pin Connection</a><a href="#section-toc.1-1.5.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.4.2.3">
                    <p id="section-toc.1-1.5.2.4.2.3.1"><a href="#section-5.4.3" class="xref">5.4.3</a>.  <a href="#name-earl-qr-code-connection" class="xref">EARL/QR Code Connection</a><a href="#section-toc.1-1.5.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-contact-requests" class="xref">Contact Requests</a><a href="#section-toc.1-1.5.2.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a href="#section-5.5.1" class="xref">5.5.1</a>.  <a href="#name-remote" class="xref">Remote</a><a href="#section-toc.1-1.5.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a href="#section-5.5.2" class="xref">5.5.2</a>.  <a href="#name-static-qr-code" class="xref">Static QR Code</a><a href="#section-toc.1-1.5.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.3">
                    <p id="section-toc.1-1.5.2.5.2.3.1"><a href="#section-5.5.3" class="xref">5.5.3</a>.  <a href="#name-dynamic-qr-code" class="xref">Dynamic QR Code</a><a href="#section-toc.1-1.5.2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-sharing-confidential-data-i" class="xref">Sharing Confidential Data in the Cloud</a><a href="#section-toc.1-1.5.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-escrow-and-recovery-of-keys" class="xref">Escrow and Recovery of Keys</a><a href="#section-toc.1-1.5.2.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-security-considerations-3" class="xref">Security Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations-3" class="xref">IANA Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-normative-references-3" class="xref">Normative References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="n-introduction">
<section id="section-1">
      <h2 id="name-introduction-3">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-3" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Mathematical Mesh (Mesh) is a user centered Public Key Infrastructure that uses cryptography to make computers easier to use. The Mesh provides an infrastructure that addresses the three concerns that have proved obstacles to the use of end-to-end security in computer applications:<a href="#section-1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-1-2.1">Device management.<a href="#section-1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-1-2.2">Exchange of trusted credentials.<a href="#section-1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-1-2.3">Application configuration management.<a href="#section-1-2.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-1-3">The infrastructure developed to address these original motivating concerns can be used to facilitate deployment and use of existing security protocols (OpenPGP, S/MIME, SSH) and as a platform for building end-to-end secure network applications. Current Mesh applications include:<a href="#section-1-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-1-4.1">Multi-factor authentication and confirmation<a href="#section-1-4.1" class="pilcrow">¶</a>
</li>
<li id="section-1-4.2">Credential management<a href="#section-1-4.2" class="pilcrow">¶</a>
</li>
<li id="section-1-4.3">Bookmark/Citation management<a href="#section-1-4.3" class="pilcrow">¶</a>
</li>
<li id="section-1-4.4">Task and workflow management<a href="#section-1-4.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-1-5">A core principle of the design of the Mesh is that each person is their own source of authority. They may choose to delegate that authority to another to act on their behalf (i.e. a Trusted Third Party) and they may choose to surrender parts of that authority to others (e.g. an employer) for limited times and limited purposes.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Thus, from the user's point of view, the Mesh is divided into two parts. The first and most important of these from their point of view being their own personal Mesh. The second being the ensemble of every Mesh to which their Mesh is connected. As with the Internet, which is a network of networks, a Mesh of Meshes has certain properties that are similar to those of its constituent parts and some that are very different.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">This document is not normative. It provides an overview of the Mesh comprising a description of the architecture, and a discussion of typical use cases and requirements. The remainder of the document series provides a summary of the principal components of the Mesh architecture and their relationship to each other.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Normative descriptions of the individual Mesh encodings, data structures and protocols are provided in separate documents addressing each component in turn.<a href="#section-1-8" class="pilcrow">¶</a></p>
<p id="section-1-9">The currently available Mesh document series comprises:<a href="#section-1-9" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1-10">
        <dt id="section-1-10.1">I. Architecture (This document.)</dt>
<dd id="section-1-10.2">
          <p id="section-1-10.2.1">Provides an overview of the Mesh as a system and the relationship between its constituent parts.<a href="#section-1-10.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-10.3">II. Uniform Data Fingerprint <span>[<a href="#draft-hallambaker-mesh-udf" class="xref">draft-hallambaker-mesh-udf</a>]</span>.</dt>
<dd id="section-1-10.4">
          <p id="section-1-10.4.1">Describes the UDF format used to represent cryptographic nonces, keys and content digests in the Mesh and the use of Encrypted Authenticated Resource Locators (EARLs) and Strong Internet Names (SINs) that build on the UDF platform.<a href="#section-1-10.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-10.5">III. Data at Rest Encryption <span>[<a href="#draft-hallambaker-mesh-dare" class="xref">draft-hallambaker-mesh-dare</a>]</span>.</dt>
<dd id="section-1-10.6">
          <p id="section-1-10.6.1">Describes the cryptographic message and append-only sequence formats used in Mesh applications and the Mesh Service protocol.<a href="#section-1-10.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-10.7">IV. Schema Reference <span>[<a href="#draft-hallambaker-mesh-schema" class="xref">draft-hallambaker-mesh-schema</a>]</span>.</dt>
<dd id="section-1-10.8">
          <p id="section-1-10.8.1">Describes the syntax and semantics of Mesh Profiles, Container Entries and Mesh Messages and their use in Mesh Applications.<a href="#section-1-10.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-10.9">V. Protocol Reference <span>[<a href="#draft-hallambaker-mesh-protocol" class="xref">draft-hallambaker-mesh-protocol</a>]</span>.</dt>
<dd id="section-1-10.10">
          <p id="section-1-10.10.1">Describes the Mesh Service Protocol.<a href="#section-1-10.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-10.11">VI. The Trust Mesh <span>[<a href="#draft-hallambaker-mesh-trust" class="xref">draft-hallambaker-mesh-trust</a>]</span>.</dt>
<dd id="section-1-10.12">
          <p id="section-1-10.12.1">Describes the social work factor metric used to evaluate the effectiveness of different approaches to exchange of credentials between users and organizations in various contexts and argues for a hybrid approach taking advantage of direct trust, Web of Trust and Trusted Third Party models to provide introductions.<a href="#section-1-10.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-10.13">VII. Security Considerations <span>[<a href="#draft-hallambaker-mesh-security" class="xref">draft-hallambaker-mesh-security</a>]</span>
</dt>
<dd id="section-1-10.14">
          <p id="section-1-10.14.1">Describes the security considerations for the Mesh protocol suite.<a href="#section-1-10.14.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-10.15">VIII Cryptographic Algorithms <span>[<a href="#draft-hallambaker-mesh-cryptography" class="xref">draft-hallambaker-mesh-cryptography</a>]</span>.</dt>
<dd id="section-1-10.16">
          <p id="section-1-10.16.1">Describes the recommended and required algorithm suites for Mesh applications and the implementation of the multi-party cryptography techniques used in the Mesh.<a href="#section-1-10.16.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-1-11">The following documents describe technologies that are used in the Mesh but do not form part of the Mesh specification suite:<a href="#section-1-11" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1-12">
        <dt id="section-1-12.1">JSON-BCD Encoding <span>[<a href="#draft-hallambaker-jsonbcd" class="xref">draft-hallambaker-jsonbcd</a>]</span>.</dt>
<dd id="section-1-12.2">
          <p id="section-1-12.2.1">Describes extensions to the JSON serialization format to allow direct encoding of binary data (JSON-B), compressed encoding (JSON-C) and extended binary data encoding (JSON-D). Each of these encodings is a superset of the previous one so that JSON-B is a superset of JSON, JSON-C is a superset of JSON-B and JSON-D is a superset of JSON-C.<a href="#section-1-12.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-12.3">DNS Web Service Discovery <span>[<a href="#draft-hallambaker-web-service-discovery" class="xref">draft-hallambaker-web-service-discovery</a>]</span>.</dt>
<dd id="section-1-12.4">
          <p id="section-1-12.4.1">Describes the means by which prefixed DNS SRV and TXT records are used to perform discovery of Web Services.<a href="#section-1-12.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-1-13">The following documents describe aspects of the Mesh Reference implementation:<a href="#section-1-13" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-1-14">
        <dt id="section-1-14.1">Mesh Developer <span>[<a href="#draft-hallambaker-mesh-developer" class="xref">draft-hallambaker-mesh-developer</a>]</span>.</dt>
<dd id="section-1-14.2">
          <p id="section-1-14.2.1">Describes the reference code distribution license terms, implementation status and currently supported functions.<a href="#section-1-14.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-1-14.3">Mesh Platform <span>[<a href="#draft-hallambaker-mesh-platform" class="xref">draft-hallambaker-mesh-platform</a>]</span>.</dt>
<dd id="section-1-14.4">
          <p id="section-1-14.4.1">Describes how platform specific functionality such as secure key storage and trustworthy computing features are employed in the Mesh.<a href="#section-1-14.4.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-definitions">
<section id="section-2">
      <h2 id="name-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
      </h2>
<p id="section-2-1">This section presents the related specifications and standards on which the Mesh is built, the terms that are used as terms of art within the Mesh protocols and applications and the terms used as requirements language.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="n-related-specifications">
<section id="section-2.1">
        <h3 id="name-related-specifications">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-related-specifications" class="section-name selfRef">Related Specifications</a>
        </h3>
<p id="section-2.1-1">Besides the documents that form the Mesh core, the Mesh makes use of many existing Internet standards, including:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">Cryptographic Algorithms</dt>
<dd id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">The <span class="bcp14">RECOMMENDED</span> and <span class="bcp14">REQUIRED</span> cryptographic algorithms for Mesh implementations are specified in <span>[<a href="#draft-hallambaker-mesh-cryptography" class="xref">draft-hallambaker-mesh-cryptography</a>]</span>.<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-2.1-2.2.2">In addition Mesh Devices used to administer non-Mesh applications must support the cryptographic algorithm suites specified by the application.<a href="#section-2.1-2.2.2" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.1-2.3">Transport</dt>
<dd id="section-2.1-2.4">
            <p id="section-2.1-2.4.1">All Mesh Services make use of multiple layers of security. Protection against traffic analysis and metadata attacks are provided by use of Transport Layer Security <span>[<a href="#RFC5246" class="xref">RFC5246</a>]</span>. At present, the HTTP/1.1 <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span> protocol is used to provide framing of transaction messages.<a href="#section-2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-2.1-2.5">Encoding</dt>
<dd id="section-2.1-2.6">
            <p id="section-2.1-2.6.1">All Mesh protocols and data structures are expressed in the JSON data model and all Mesh applications accept data in standard JSON encoding <span>[<a href="#RFC7159" class="xref">RFC7159</a>]</span>. The JOSE Signature <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> and Encryption <span>[<a href="#RFC7516" class="xref">RFC7516</a>]</span> standards are used as the basis for object signing and encryption.<a href="#section-2.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-defined-terms">
<section id="section-2.2">
        <h3 id="name-defined-terms">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-defined-terms" class="section-name selfRef">Defined Terms</a>
        </h3>
<p id="section-2.2-1">TBS<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-requirements-language">
<section id="section-2.3">
        <h3 id="name-requirements-language-2">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-requirements-language-2" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.3-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in RFC 2119 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-implementation-status">
<section id="section-2.4">
        <h3 id="name-implementation-status">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
        </h3>
<p id="section-2.4-1">The implementation status of the reference code base is described in the companion document <span>[<a href="#draft-hallambaker-mesh-developer" class="xref">draft-hallambaker-mesh-developer</a>]</span>.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">The examples in this document were created on 1/22/2020 1:19:03 AM.  Out of 170 examples, 67 were not functional.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">[Note: Example data is now being produced using the mesh command line tool which is currently substantially less complete than the Mesh reference code it is intended to provide an interface to. As a result, the documentation currently lags the code by more than is usual.]<a href="#section-2.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-architecture">
<section id="section-3">
      <h2 id="name-architecture">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-architecture" class="section-name selfRef">Architecture</a>
      </h2>
<p id="section-3-1">The Mathematical Mesh (Mesh) is a user centered Public Key Infrastructure that uses cryptography to make computers easier to use. This document describes version 3.0 of the Mesh architecture and protocols.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">For several decades, it has been widely noted that most users are either unwilling or unable to make even the slightest efforts to protect their security, still less those of other parties. Yet despite this observation being widespread, the efforts of the IT security community have largely focused on changing this user behavior rather that designing applications that respect it. Real users have real work to do and have neither the time nor the inclination to use tools that will negatively impact their performance.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The Mesh is based on the principle that if the Internet is to be secure, if must become effortless to use applications securely. Rather than beginning the design process by imagining all the possible modes of attack and working out how to address these with the least possible inconvenience, we must reverse the question and ask how much security can be provided without requiring any effort on the user's part to address it.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Today's technology requires users to put their trust in an endless variety of devices, software and services they cannot fully understand let alone control. Even the humble television of the 20<sup>th</sup> century has been replaced by a 'smart' TV with 15 million lines of code. Whose undeclared capabilities may well include placing the room in which it is placed under continuous audio and video surveillance.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">Every technology deployment by necessity requires some degree of trust on the owner/user's part. But this trust should be limited and subject to accountability. If manufacturers continue to fail in this regard, they risk a backlash in which users seek to restore their rights through litigation, legislation or worst of all, simply not buying more technology that they have learned to distrust through their own experience.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">The Mesh is based on the principle of radical distrust, that is, if a party is capable of defecting, we assume that they will. As the Russian proverb goes: ???????, ?? ????????: trust, but verify.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">In the 1990s, the suggestion that 'hackers' might seek to make financial gains from their activities was denounced as 'fear-mongering'. The suggestion that email or anonymous currencies might be abused received a similar response. Today malware, ransomware and spam have become so ubiquitous that they are no longer news unless the circumstances are particularly egregious.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">We must dispense with the notion that it is improper or impolite to question the good faith of technology suppliers of any kind whether they be manufacturers, service providers, software authors or reviewers. Modern supply chains are complex, typically involving hundreds if not thousands of potential points of deliberate or accidental compromise. The technology provider who relies on the presumption of good faith on their part risks serious damage to their reputation when others assert that a capability added to their product may have malign uses.<a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">Radical distrust means that we apply the principles of least principle and accountability at every level in the design:<a href="#section-3-9" class="pilcrow">¶</a></p>
<ul>
<li id="section-3-10.1">Cryptographic keys installed in a product during manufacture are only used for the limited purpose of putting that device under control of the user.<a href="#section-3-10.1" class="pilcrow">¶</a>
</li>
<li id="section-3-10.2">Cryptographic keys and assertions related to management of devices are only visible to the user they belong to and are never exposed to external parties.<a href="#section-3-10.2" class="pilcrow">¶</a>
</li>
<li id="section-3-10.3">Mesh Accounts belong to and are under control of the user they belong to and not the Mesh Service provider which the user can change at will with minimal inconvenience.<a href="#section-3-10.3" class="pilcrow">¶</a>
</li>
<li id="section-3-10.4">Mesh Services do not have access to the plaintext of any Mesh Messages or Mesh Catalog data except for the Contacts catalog.<a href="#section-3-10.4" class="pilcrow">¶</a>
</li>
<li id="section-3-10.5">All Mesh Messages are subject to access control by both the inbound and outbound Mesh Service to mitigate messaging abuse.<a href="#section-3-10.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3-11">Security is risk management and not the elimination of all possibility of any risk. Radical distrust means that we raise the bar for attackers to the point where for most attackers the risk is greater than the reward.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">In addition to distrusting technology providers the Mesh Architecture allows the user to limit the degree of trust they place in themselves. In the real world, devices are lost or stolen, passwords and activation codes are forgotten, natural or man-made catastrophes cause property and data to be lost. The Mesh permits but does not require use of escrow techniques that allow recovery from such situations.<a href="#section-3-12" class="pilcrow">¶</a></p>
<div id="n-a-personal-pki">
<section id="section-3.1">
        <h3 id="name-a-personal-pki">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-a-personal-pki" class="section-name selfRef">A Personal PKI</a>
        </h3>
<p id="section-3.1-1">The Mesh is a Public Key Infrastructure (PKI) that is designed to address the three major obstacles to deployment of end-to-end secure applications:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.1-2.1">Device management.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-3.1-2.2">Exchange of trusted credentials.<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-3.1-2.3">Application configuration management.<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.1-3">Each Mesh user is the ultimate source of authority in their Personal Mesh which specifies the set of devices, contacts and applications that they trust and for what purposes.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">The Mesh 1.0 architecture described a PKI designed to meet these limited requirements to enable use of existing end-to-end secure Internet protocols such as OpenPGP, S/MIME and SSH. Since these protocols only secure data in transit and the vast majority of data breaches involve data at rest, the Data At Rest Encryption (DARE) was added as a layered application resulting in the Mesh 2.0 architecture. This document describes the Mesh 3.0 architecture which has been entirely re-worked so that DARE provides the platform on which all other Mesh functions are built.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<div id="n-device-management">
<section id="section-3.1.1">
          <h4 id="name-device-management">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-device-management" class="section-name selfRef">Device Management</a>
          </h4>
<p id="section-3.1.1-1">Existing PKIs were developed in an era when the 'personal computer' was still coming into being. Only a small number of people owned a computer and an even smaller number owned more than one. Today, computers are ubiquitous and a typical home in the developed world contains several hundred of which a dozen or more may have some form of network access.<a href="#section-3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1.1-2">The modern consumer faces a problem of device management that is considerably more complex than the IT administrator of a small business might have faced in the 1990s but without any of the network management tools such an administrator would expect to have available.<a href="#section-3.1.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1.1-3">One important consequence of the proliferation of devices is that end-to-end security is no longer sufficient. To be acceptable to users, a system must be ends-to-ends secure. That is, a user must be able to read their encrypted email message on their laptop, tablet, phone, or watch with exactly the same ease of use as if the mail was unencrypted.<a href="#section-3.1.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1.1-4">Each personal Mesh contains a device catalog in which the cryptographic credentials and device specific application configurations for each connected device are stored.<a href="#section-3.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1.1-5">Management of the device catalog is restricted to a subset of devices that the owner of the Mesh has specifically authorized for that purpose as administration devices. Only a device with access to a duly authorized administration key can add or remove devices from a personal Mesh.<a href="#section-3.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-exchange-of-trusted-credentials">
<section id="section-3.1.2">
          <h4 id="name-exchange-of-trusted-credent">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-exchange-of-trusted-credent" class="section-name selfRef">Exchange of trusted credentials.</a>
          </h4>
<p id="section-3.1.2-1">One of the most challenging, certainly the most contentious issues in PKI is the means by which cryptographic credentials are published and validated.<a href="#section-3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-3.1.2-2">The Mesh does not attempt to impose criteria for accepting credentials as valid as no such set of criteria can be comprehensive. Rather the Mesh allows users to make use of the credential validation criteria that are appropriate to the purpose for which they intend to use them and Mesh Services provides protocol support for exchange of credentials between users and to synchronize credential information between all the devices belonging to a user.<a href="#section-3.1.2-2" class="pilcrow">¶</a></p>
<p id="section-3.1.2-3">In some circumstances, only a direct trust model is acceptable, in others, only a trusted third-party model is possible and in the vast majority of cases opportunistic approaches are more than sufficient. Both approaches may be reinforced by use of chained notary certificate (e.g. BlockChain) technology affords a means of establishing that a particular assertion was made before a certain date. The management of Trust in the Mesh is described in detail in <span>[<a href="#draft-hallambaker-mesh-trust" class="xref">draft-hallambaker-mesh-trust</a>]</span>.<a href="#section-3.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-application-configuration-management">
<section id="section-3.1.3">
          <h4 id="name-application-configuration-m">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-application-configuration-m" class="section-name selfRef">Application configuration management</a>
          </h4>
<p id="section-3.1.3-1">Configuration of cryptographic applications is typically worse than an afterthought. Configuration of one popular mail user agent to use S/MIME security requires 17 steps to be performed using four separate application programs. And since S/MIME certificates expire, the user is required to repeat these steps every few years. Contrary to the public claims made by one major software vendor it is not necessary to perform 'usability testing' to recognize abject stupidity.<a href="#section-3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-3.1.3-2">Rather than writing down configuration steps and giving them to the user, we should turn them into code and give them to a machine. Users should never be required to do the work of the machine. Nor should any programmer be allowed to insult the user by casting their effort aside and requiring it to be re-entered.<a href="#section-3.1.3-2" class="pilcrow">¶</a></p>
<p id="section-3.1.3-3">While most computer professionals who are required to do such tasks on a regular basis will create a tool for the purpose, most users do not have that option. And of those who do write their own tools, only a few have the time and the knowledge to do the job without introducing security vulnerabilities.<a href="#section-3.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-the-mesh-as-platform">
<section id="section-3.1.4">
          <h4 id="name-the-mesh-as-platform">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-the-mesh-as-platform" class="section-name selfRef">The Mesh as platform</a>
          </h4>
<p id="section-3.1.4-1">Meeting the core objectives of the Mesh required new naming, communication and cryptographic capabilities provided to be developed. These capabilities may in turn be used to develop new end-to-end secure applications.<a href="#section-3.1.4-1" class="pilcrow">¶</a></p>
<p id="section-3.1.4-2">For example, a DARE Catalog is a cryptographic container in which the entries represent a set of objects which may be added, updated and deleted over time. The Mesh Service protocol allows DARE Catalogs to be synchronized between devices connected to a Mesh Account. DARE Catalogs are used as the basis for the device and contacts catalogs referred to above.<a href="#section-3.1.4-2" class="pilcrow">¶</a></p>
<p id="section-3.1.4-3">The Mesh Credentials Catalog uses the same DARE Catalog format and Mesh Service protocol to share passwords between devices with end-to-end encryption so that no password data is ever left unencrypted in the cloud.<a href="#section-3.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-mesh-architecture">
<section id="section-3.2">
        <h3 id="name-mesh-architecture">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-mesh-architecture" class="section-name selfRef">Mesh Architecture</a>
        </h3>
<p id="section-3.2-1">The Mesh has four principal components:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.2-2">
          <dt id="section-3.2-2.1">Mesh Device Management</dt>
<dd id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">Each user has a personal Mesh profile that is used for management of their personal devices. A user may connect devices to or remove devices from their personal Mesh by use of a connected device that has been granted the 'administration' role.<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.2-2.3">Mesh Account</dt>
<dd id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">A Mesh account is similar in concept to a traditional email or messaging account but with the important difference that it belongs to the user and not a service provider. Users may maintain multiple Mesh accounts for different purposes.<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.2-2.5">Mesh Service</dt>
<dd id="section-3.2-2.6">
            <p id="section-3.2-2.6.1">A Mesh Service provides a service identifier (e.g. <code>alice@example.com</code>) through which devices and other Mesh users may interact with a Mesh Account. It is not necessary for a Mesh Account to be connected to a Mesh Service and users may change their Mesh service provider at any time. It is even possible for a Mesh Account to be connected to multiple services at the same time but only one such account is regarded as the primary account at a given time.<a href="#section-3.2-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.2-2.7">Mesh Messaging</dt>
<dd id="section-3.2-2.8">
            <p id="section-3.2-2.8.1">Mesh Messaging allows short messages (less than 32KB) to be exchanged between Mesh devices connected to an account and between Mesh Accounts. One of the key differences between Mesh Messaging and legacy services such as SMTP is that every message received is subjected to access control.<a href="#section-3.2-2.8.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3.2-3">A user's Personal Mesh is the set of their Personal Mesh Profiles, Mesh Accounts and the Mesh Services to which they are bound.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">For example, Figure X shows Alice's personal Mesh which have separate accounts for her personal and business affairs. She has many devices, two of which are shown here. Both are linked to her personal account but only one is linked to her business account. Besides allowing Alice to separate work and pleasure, this separation means that she does not need to worry about her business affairs being compromised if the device <code>Alice2</code> is stolen.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<figure id="figure-1">
          <div class="artwork art-svg alignLeft" id="section-3.2-5.1">
<svg xmlns="http://www.w3.org/2000/svg" width="6.73697in" height="6.27083in" viewBox="0 0 485.062 451.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
              <defs>
                <g>
                  <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                </g>
              </defs>
              <g>
                <title>ProfileMaster</title>
                <g transform="translate(151.312,-370.312)">
                  <title>Sheet.1</title>
                  <desc>ProfileMaster Alice</desc>
                  <rect x="0" y="416.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="11.64" y="430.18" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileMaster<tspan x="33.25" y="444.580144" font-size="1em">Alice</tspan>
                  </text>
                </g>
                <g transform="translate(205.312,-207.75)">
                  <title>Sheet.2</title>
                  <desc>ProfileAccount AlicePersonal</desc>
                  <rect x="0" y="325.5" width="108" height="126" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="18.05" y="340.3" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileAccount<tspan x="21.16" y="354.700144" font-size="1em">AlicePersonal</tspan>
                  </text>
                </g>
                <g transform="translate(43.3119,-20.4375)">
                  <title>Sheet.11</title>
                  <g>
                    <title>Sheet.8</title>
                    <desc>ProfileDevice Alice2</desc>
                    <rect x="0" y="326.625" width="108" height="124.875" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="21.79" y="341.43" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileDevice<tspan x="39.21" y="355.830144" font-size="1em">Alice</tspan>
                      <tspan>2</tspan>
                    </text>
                  </g>
                  <g transform="translate(9,-54.5625)">
                    <title>Sheet.9</title>
                    <desc>AssertionDevice Connection</desc>
                    <rect x="0" y="416.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="12.31" y="430.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionDevice<tspan x="21.76" y="442.7800384" font-size="1em">Connection</tspan>
                    </text>
                  </g>
                  <g transform="translate(9,-9)">
                    <title>Sheet.10</title>
                    <desc>AssertionAccount Connection</desc>
                    <rect x="0" y="416.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="9.19" y="430.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionAccount<tspan x="21.76" y="442.7800384" font-size="1em">Connection</tspan>
                    </text>
                  </g>
                </g>
                <g transform="translate(43.3119,-163.312)">
                  <title>Sheet.12</title>
                  <g>
                    <title>Sheet.4</title>
                    <desc>ProfileDevice Alice1</desc>
                    <rect x="0" y="280.5" width="108" height="171" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="21.79" y="295.3" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileDevice<tspan x="39.21" y="309.700144" font-size="1em">Alice</tspan>
                      <tspan>1</tspan>
                    </text>
                  </g>
                  <g transform="translate(9,-99.5625)">
                    <title>Sheet.3</title>
                    <desc>AssertionDevice Connection</desc>
                    <rect x="0" y="416.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="12.31" y="430.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionDevice<tspan x="21.76" y="442.7800384" font-size="1em">Connection</tspan>
                    </text>
                  </g>
                  <g transform="translate(9,-54)">
                    <title>Sheet.6</title>
                    <desc>AssertionAccount Connection</desc>
                    <rect x="0" y="416.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="9.19" y="430.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionAccount<tspan x="21.76" y="442.7800384" font-size="1em">Connection</tspan>
                    </text>
                  </g>
                  <g transform="translate(9,-9.5625)">
                    <title>Sheet.7</title>
                    <desc>AssertionAccount Connection</desc>
                    <rect x="0" y="416.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="9.19" y="430.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionAccount<tspan x="21.76" y="442.7800384" font-size="1em">Connection</tspan>
                    </text>
                  </g>
                </g>
                <g transform="translate(205.312,-154.312)">
                  <title>Sheet.5</title>
                  <desc>ProfileAccount AliceBusiness</desc>
                  <rect x="0" y="416.063" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="18.05" y="430.18" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileAccount<tspan x="21.28" y="444.580144" font-size="1em">AliceBusiness</tspan>
                  </text>
                </g>
                <g transform="translate(25.3119,-91.3125)">
                  <title>Sheet.13</title>
                  <path d="M126 154.5 L0 154.5 L0 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(25.3119,-280.312)">
                  <title>Sheet.14</title>
                  <path d="M0 451.5 L20.46 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(25.3119,-91.3125)">
                  <title>Sheet.15</title>
                  <path d="M0 451.5 L20.46 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(241.312,-171.75)">
                  <title>Sheet.16</title>
                  <path d="M0 235.5 L90 235.5 L90 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(171.562,-46.3125)">
                  <title>Sheet.17</title>
                  <path d="M33.75 245.06 L0 245.06 L0 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(187.312,713.25) scale(1,-1)">
                  <title>Sheet.18</title>
                  <path d="M18 433.5 L0 433.5 L0 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(331.312,578.25) rotate(180)">
                  <title>Sheet.20</title>
                  <path d="M0 451.5 L11.46 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(187.312,713.25) rotate(180)">
                  <title>Sheet.21</title>
                  <path d="M0 451.5 L38.46 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(166.601,856.66) rotate(-179.37)">
                  <title>Sheet.22</title>
                  <path d="M0 451.5 L22.71 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(171.562,667.688) rotate(180)">
                  <title>Sheet.23</title>
                  <path d="M0 451.5 L22.71 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(214.312,-263.437)">
                  <title>Sheet.24</title>
                  <desc>AssertionAccount Connection</desc>
                  <rect x="0" y="416.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="9.19" y="430.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionAccount<tspan x="21.76" y="442.7800384" font-size="1em">Connection</tspan>
                  </text>
                </g>
                <g transform="translate(214.312,-215.625)">
                  <title>Sheet.25</title>
                  <desc>AssertionAccount Connection</desc>
                  <rect x="0" y="416.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="9.19" y="430.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionAccount<tspan x="21.76" y="442.7800384" font-size="1em">Connection</tspan>
                  </text>
                </g>
                <g transform="translate(358.312,-262.312)">
                  <title>Sheet.26</title>
                  <desc>ProfileService example.com</desc>
                  <rect x="0" y="416.063" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="20.63" y="430.18" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileService<tspan x="20.99" y="447.4601728" font-family="sans-serif" font-size="0.83333em">example</tspan>
                    <tspan font-family="sans-serif" font-size="0.83333em">.</tspan>
                    <tspan font-family="sans-serif" font-size="0.83333em">com</tspan>
                  </text>
                </g>
                <g transform="translate(358.312,-217.312)">
                  <title>Sheet.27</title>
                  <desc>ProfileService example.net</desc>
                  <rect x="0" y="416.063" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="20.63" y="430.18" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileService<tspan x="20.99" y="447.4601728" font-family="sans-serif" font-size="0.83333em">example</tspan>
                    <tspan font-family="sans-serif" font-size="0.83333em">.</tspan>
                    <tspan font-family="sans-serif" font-size="0.83333em">net</tspan>
                  </text>
                </g>
                <g transform="translate(358.312,623.25) rotate(180)">
                  <title>Sheet.28</title>
                  <path d="M0 451.5 L47.46 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(358.312,668.25) rotate(180)">
                  <title>Sheet.29</title>
                  <path d="M0 451.5 L47.46 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(331.312,731.25) rotate(180)">
                  <title>Sheet.30</title>
                  <path d="M0 451.5 L11.46 451.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(800.812,18.75) rotate(90)">
                  <title>Sheet.19</title>
                  <path d="M0 451.5 L414 451.5" stroke="#000000" stroke-dasharray="5.25,3.75" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(188.312,-412.75)">
                  <title>Sheet.31</title>
                  <desc>Alice's Personal Mesh</desc>
                  <rect x="0" y="431.5" width="152" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="41.98" y="445.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">Alice's Personal Mesh</text>
                </g>
                <g transform="translate(358.312,-412.75)">
                  <title>Sheet.32</title>
                  <desc>Public Mesh</desc>
                  <rect x="0" y="431.5" width="108" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="4" y="445.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">Public Mesh</text>
                </g>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a></figcaption></figure>
<p id="section-3.2-6">Alice's ProfileMaster contains a Master Signature Key used to sign the profile itself and one or more Administrator Signature Keys used to sign assertions binding devices and/or assertions to her Mesh.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<figure id="figure-2">
          <div class="artwork art-svg alignLeft" id="section-3.2-7.1">
<svg xmlns="http://www.w3.org/2000/svg" width="4.31508in" height="3.01042in" viewBox="0 0 310.686 216.75" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
              <defs>
                <g>
                  <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                </g>
              </defs>
              <g>
                <title>ProfileMasterKeys</title>
                <g transform="translate(41.6239,-18.75)">
                  <title>Sheet.1</title>
                  <desc>ProfileMaster Alice</desc>
                  <rect x="0" y="37.5" width="108" height="179.25" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="20.64" y="52.3" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileMaster<tspan x="42.25" y="66.700144" font-size="1em">Alice</tspan>
                  </text>
                </g>
                <g transform="translate(50.6239,-120.563)">
                  <title>Sheet.2</title>
                  <desc>Master Signature Key</desc>
                  <rect x="0" y="181.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="9.99" y="196.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Master Signature <tspan x="37.65" y="208.0300384" font-size="1em">Key</tspan>
                  </text>
                </g>
                <g transform="translate(50.6239,-73.3125)">
                  <title>Sheet.3</title>
                  <desc>Administrator Signature Keys</desc>
                  <rect x="0" y="181.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="16.74" y="196.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Administrator <tspan x="15.21" y="208.0300384" font-size="1em">Signature Keys</tspan>
                  </text>
                </g>
                <g transform="translate(183.936,-72.75)">
                  <title>Sheet.4</title>
                  <desc>AssertionDevice Connection</desc>
                  <rect x="0" y="181.312" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="21.31" y="196.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionDevice<tspan x="30.76" y="208.0300384" font-size="1em">Connection</tspan>
                  </text>
                </g>
                <g transform="translate(183.936,-19.0312)">
                  <title>Sheet.5</title>
                  <desc>AssertionAccount</desc>
                  <rect x="0" y="181.312" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="18.19" y="202.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionAccount</text>
                </g>
                <g transform="translate(140.624,-90.75)">
                  <title>Sheet.6</title>
                  <path d="M0 216.75 L36.77 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(165.936,-36.75)">
                  <title>Sheet.7</title>
                  <path d="M0 216.75 L11.46 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(382.686,126) rotate(90)">
                  <title>Sheet.8</title>
                  <path d="M0 216.75 L54 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(25.3119,-135.75)">
                  <title>Sheet.9</title>
                  <path d="M0 171.75 L0 216.75 L25.31 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(25.3119,-180.75)">
                  <title>Sheet.10</title>
                  <path d="M0 216.75 L9.77 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(50.6239,-27.75)">
                  <title>Database</title>
                  <desc>CatalogDevice</desc>
                  <path d="M4.5 180.75 L85.5 180.75 A38.25 38.25 0 0 1 85.5 216.75 L4.5 216.75 A38.25 38.25 0 0 1 4.5 180.75 Z" fill="#ffffff"></path>
                  <path d="M4.5 180.75 L85.5 180.75 A38.25 38.25 0 0 1 85.5 216.75 L4.5 216.75 A38.25 38.25 0 0 1 4.5 180.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  <path d="M85.5 180.75 A38.25 38.25 -180 0 0 85.5 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  <text x="13.91" y="201.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">CatalogDevice</text>
                </g>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a></figcaption></figure>
<p id="section-3.2-8">If desired, Alice can escrow the master key associated with her Profile Master and delete it from her device(s), thus ensuring that compromise of the device does not result in a permanent compromise of her personal Mesh. Recovery of the Master Signature Key and the associated Master Encryption Escrow keys (not shown) allows Alice to recover her entire digital life.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">To eliminate the risk of hardware failure, the escrow scheme offered by the Mesh itself uses key shares printed on paper and an encrypted escrow record stored in the cloud. Mesh users are of course free to use alternative escrow means of their choice.<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<div id="n-mesh-device-management">
<section id="section-3.2.1">
          <h4 id="name-mesh-device-management">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-mesh-device-management" class="section-name selfRef">Mesh Device Management</a>
          </h4>
<p id="section-3.2.1-1">Mesh devices are added to or removed from a user's personal Mesh by adding or removing Device catalog entries from the CatalogDevice associated with the Master Profile.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2">Device catalog entries are created by devices that have been provisioned with an administration key specified in the corresponding ProfileMaster<a href="#section-3.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.2.1-3">The keying material used by a device in the context of a user's personal Mesh comes from two separate sources:<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-3.2.1-4.1">Keying material specified in the ProfileDevice which is either generated on the device itself or installed during manufacture.<a href="#section-3.2.1-4.1" class="pilcrow">¶</a>
</li>
<li id="section-3.2.1-4.2">Keying material provided by the Administration Device during the connection process.<a href="#section-3.2.1-4.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-3.2.1-5">This approach mitigates the risk of keying material used by the device being compromised during or after manufacture and the risks associated with use of weak keys. The key combination mechanism is shown in section XX below and described in detail in <span>[<a href="#draft-hallambaker-mesh-cryptography" class="xref">draft-hallambaker-mesh-cryptography</a>]</span>.<a href="#section-3.2.1-5" class="pilcrow">¶</a></p>
<figure id="figure-3">
            <div class="artwork art-svg alignLeft" id="section-3.2.1-6.1">
<svg xmlns="http://www.w3.org/2000/svg" width="6.38542in" height="4.88542in" viewBox="0 0 459.75 351.75" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                  </g>
                </defs>
                <g>
                  <title>ProfileDeviceKeys</title>
                  <g transform="translate(153,-27)">
                    <title>Sheet.30</title>
                    <rect x="0" y="77.25" width="288" height="274.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  </g>
                  <g transform="translate(640.5,18.75) rotate(90)">
                    <title>Sheet.27</title>
                    <path d="M0 351.75 L314.25 351.75" stroke="#000000" stroke-dasharray="5.25,3.75,0,3.75" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(270.75,-207.75)">
                    <title>Sheet.20</title>
                    <desc>=</desc>
                    <rect x="0" y="331.75" width="36" height="20" fill="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.02" y="346.55" fill="#000000" font-family="sans-serif" font-size="1.33333em">=</text>
                  </g>
                  <g transform="translate(270.75,-162.75)">
                    <title>Sheet.22</title>
                    <desc>=</desc>
                    <rect x="0" y="331.75" width="36" height="20" fill="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.02" y="346.55" fill="#000000" font-family="sans-serif" font-size="1.33333em">=</text>
                  </g>
                  <g transform="translate(270.75,-117.75)">
                    <title>Sheet.24</title>
                    <desc>=</desc>
                    <rect x="0" y="331.75" width="36" height="20" fill="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.02" y="346.55" fill="#000000" font-family="sans-serif" font-size="1.33333em">=</text>
                  </g>
                  <g transform="translate(18.75,-36.75)">
                    <title>Sheet.25</title>
                    <desc>AssertionDevice Connection</desc>
                    <rect x="0" y="316.312" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="21.31" y="331.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionDevice<tspan x="30.76" y="343.0300384" font-size="1em">Connection</tspan>
                    </text>
                  </g>
                  <g transform="translate(306.75,-36.75)">
                    <title>Sheet.26</title>
                    <desc>AssertionAccount Connection(s)</desc>
                    <rect x="0" y="316.312" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="18.19" y="331.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionAccount<tspan x="25.77" y="343.0300384" font-size="1em">Connection</tspan>
                      <tspan>(s)</tspan>
                    </text>
                  </g>
                  <g transform="translate(18.75,-90.75)">
                    <title>Sheet.8</title>
                    <desc>ProfileDevice Alice1</desc>
                    <rect x="0" y="171.75" width="108" height="180" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="21.79" y="186.55" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileDevice<tspan x="39.21" y="200.950144" font-size="1em">Alice</tspan>
                      <tspan>1</tspan>
                    </text>
                  </g>
                  <g transform="translate(27.75,-190.313)">
                    <title>Sheet.9</title>
                    <desc>Signature Key Public: X</desc>
                    <rect x="0" y="316.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="17.17" y="331.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Signature Key<tspan font-size="1em" font-style="italic"></tspan>
                      <tspan x="27.69" y="343.0300384" font-size="1em">Public</tspan>
                      <tspan>:</tspan>
                      <tspan font-size="1em" font-style="italic"></tspan>
                      <tspan font-size="1em" font-style="italic">X</tspan>
                    </text>
                  </g>
                  <g transform="translate(27.75,-145.312)">
                    <title>Sheet.10</title>
                    <desc>Authentication Key Public: X</desc>
                    <rect x="0" y="316.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="6.17" y="331.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Authentication Key<tspan x="27.69" y="343.0300384" font-size="1em">Public</tspan>
                      <tspan>:</tspan>
                      <tspan font-size="1em" font-style="italic"></tspan>
                      <tspan font-size="1em" font-style="italic">X</tspan>
                    </text>
                  </g>
                  <g transform="translate(27.75,-100.313)">
                    <title>Sheet.11</title>
                    <desc>Encryption Key Public: X</desc>
                    <rect x="0" y="316.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.62" y="331.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encryption Key<tspan x="27.69" y="343.0300384" font-size="1em">Public</tspan>
                      <tspan>:</tspan>
                      <tspan font-size="1em" font-style="italic"></tspan>
                      <tspan font-size="1em" font-style="italic">X</tspan>
                    </text>
                  </g>
                  <g transform="translate(162.75,-47.25)">
                    <title>Sheet.2</title>
                    <desc>DevicePrivate Alice1</desc>
                    <rect x="0" y="128.25" width="108" height="223.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="20.57" y="143.05" fill="#000000" font-family="sans-serif" font-size="1.00001em">DevicePrivate<tspan x="39.21" y="157.450144" font-size="1em">Alice</tspan>
                      <tspan>1</tspan>
                    </text>
                  </g>
                  <g transform="translate(171.75,-190.313)">
                    <title>Sheet.3</title>
                    <desc>Signature Key Private: y, Y</desc>
                    <rect x="0" y="316.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="17.17" y="331.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Signature Key<tspan x="21.19" y="343.0300384" font-size="1em">Private</tspan>
                      <tspan>: </tspan>
                      <tspan font-size="1em" font-style="italic">y</tspan>
                      <tspan font-size="1em" font-style="italic">, </tspan>
                      <tspan font-size="1em" font-style="italic">Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(171.75,-145.312)">
                    <title>Sheet.4</title>
                    <desc>Authentication Key Private: y, Y</desc>
                    <rect x="0" y="316.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="6.17" y="331.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Authentication Key<tspan x="21.19" y="343.0300384" font-size="1em">Private</tspan>
                      <tspan>: </tspan>
                      <tspan font-size="1em" font-style="italic">y</tspan>
                      <tspan font-size="1em" font-style="italic">, </tspan>
                      <tspan font-size="1em" font-style="italic">Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(171.75,-100.313)">
                    <title>Sheet.5</title>
                    <desc>Encryption Key Private: y, Y</desc>
                    <rect x="0" y="316.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.62" y="331.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encryption Key<tspan x="21.19" y="343.0300384" font-size="1em">Private</tspan>
                      <tspan>: </tspan>
                      <tspan font-size="1em" font-style="italic">y</tspan>
                      <tspan font-size="1em" font-style="italic">, </tspan>
                      <tspan font-size="1em" font-style="italic">Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(306.75,-90.75)">
                    <title>Sheet.6</title>
                    <desc>Device Connection Alice1</desc>
                    <rect x="0" y="171.75" width="108" height="180" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.46" y="186.55" fill="#000000" font-family="sans-serif" font-size="1.00001em">Device Connection<tspan x="39.21" y="200.950144" font-size="1em">Alice</tspan>
                      <tspan>1</tspan>
                    </text>
                  </g>
                  <g transform="translate(315.75,-190.313)">
                    <title>Sheet.7</title>
                    <desc>Signature Key Public: X?Y</desc>
                    <rect x="0" y="316.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="17.17" y="330.86" fill="#000000" font-family="sans-serif" font-size="0.833336em">Signature Key<tspan x="20.28" y="343.1100392" font-size="1em">Public</tspan>
                      <tspan>: X</tspan>
                      <tspan font-family="sans-serif" font-size="1em">?</tspan>
                      <tspan>Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(315.75,-145.312)">
                    <title>Sheet.12</title>
                    <desc>Authentication Key Public: X?Y</desc>
                    <rect x="0" y="316.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="6.17" y="330.86" fill="#000000" font-family="sans-serif" font-size="0.833336em">Authentication Key<tspan x="20.28" y="343.1100392" font-size="1em">Public</tspan>
                      <tspan>: X</tspan>
                      <tspan font-family="sans-serif" font-size="1em">?</tspan>
                      <tspan>Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(315.75,-100.313)">
                    <title>Sheet.13</title>
                    <desc>Encryption Key Public: X?Y</desc>
                    <rect x="0" y="316.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.62" y="330.86" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encryption Key<tspan x="20.28" y="343.1100392" font-size="1em">Public</tspan>
                      <tspan>: X</tspan>
                      <tspan font-family="sans-serif" font-size="1em">?</tspan>
                      <tspan>Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(117.75,-207.75)">
                    <title>Sheet.1</title>
                    <path d="M0 351.75 L47.46 351.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(261.75,-207.75)">
                    <title>Sheet.14</title>
                    <path d="M0 351.75 L47.46 351.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(117.75,-162.75)">
                    <title>Sheet.15</title>
                    <path d="M0 351.75 L47.46 351.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(261.75,-162.75)">
                    <title>Sheet.16</title>
                    <path d="M0 351.75 L47.46 351.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(117.75,-117.75)">
                    <title>Sheet.17</title>
                    <path d="M0 351.75 L47.46 351.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(261.75,-117.75)">
                    <title>Sheet.18</title>
                    <path d="M0 351.75 L47.46 351.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(126.75,-207.75)">
                    <title>Sheet.19</title>
                    <desc>?</desc>
                    <rect x="0" y="331.75" width="36" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="13.02" y="346.55" fill="#000000" font-family="sans-serif" font-size="0.833336em">?</text>
                  </g>
                  <g transform="translate(126.75,-162.75)">
                    <title>Sheet.21</title>
                    <desc>?</desc>
                    <rect x="0" y="331.75" width="36" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="13.02" y="346.55" fill="#000000" font-family="sans-serif" font-size="0.833336em">?</text>
                  </g>
                  <g transform="translate(126.75,-117.75)">
                    <title>Sheet.23</title>
                    <desc>?</desc>
                    <rect x="0" y="331.75" width="36" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="13.02" y="346.55" fill="#000000" font-family="sans-serif" font-size="0.833336em">?</text>
                  </g>
                  <g transform="translate(18.75,-305.5)">
                    <title>Sheet.28</title>
                    <desc>Private</desc>
                    <rect x="0" y="331.75" width="252" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="110.28" y="345.05" fill="#000000" font-family="sans-serif" font-size="0.916672em">Private</text>
                  </g>
                  <g transform="translate(306.75,-304.5)">
                    <title>Sheet.29</title>
                    <desc>Public</desc>
                    <rect x="0" y="331.75" width="108" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="40.53" y="345.05" fill="#000000" font-family="sans-serif" font-size="0.916672em">Public</text>
                  </g>
                  <g transform="translate(234,-277)">
                    <title>Sheet.31</title>
                    <desc>CatalogEntryDevice</desc>
                    <rect x="0" y="331.75" width="108" height="20" fill="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="10.45" y="345.05" fill="#000000" font-family="sans-serif" font-size="0.916672em">CatalogEntryDevice</text>
                  </g>
                  <g transform="translate(171,-56.25)">
                    <title>Sheet.32</title>
                    <desc>Activation(s)</desc>
                    <rect x="0" y="316.365" width="90" height="35.3848" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="19.44" y="337.06" fill="#000000" font-family="sans-serif" font-size="0.833336em">Activation(s)</text>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a></figcaption></figure>
<p id="section-3.2.1-7">In accordance with the principle of maintaining cryptographic hygiene, separate keys are generated for signature, authentication and encryption purposes.<a href="#section-3.2.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-mesh-account">
<section id="section-3.2.2">
          <h4 id="name-mesh-account">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-mesh-account" class="section-name selfRef">Mesh Account</a>
          </h4>
<p id="section-3.2.2-1">Mesh Accounts comprise a collection of persistent data stores associated with a particular persona associated with a personal Mesh. The connection between a Mesh Account and the personal Mesh to which it belongs may or may not be public. For example, Alice might allow her contacts to know that her business and personal accounts belong to the same personal Mesh and thus the same person but Bob might not.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">Mesh Accounts afford similar functionality to the accounts provided by traditional Internet protocols and applications but with the important distinction that they belong to the user and not the service provider. A Mesh Account may be connected to one, many or no Mesh Services and the user may add or delete service providers at any time.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3">A Mesh Account that is not connected to a Service is called an offline account. Offline accounts cannot send or receive Mesh Messages and cannot be synchronized using the Mesh Service protocol (but may be synchronized through other means).<a href="#section-3.2.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2-4">When a Mesh Account is connected to multiple services, only the first service is normally regarded as being primary with the others being secondary accounts for use in case of need.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2.2-5">Alice's personal account is connected to two devices and two services (<code>alice@example.com</code> and <code>alice@example.net</code>).<a href="#section-3.2.2-5" class="pilcrow">¶</a></p>
<figure id="figure-4">
            <div class="artwork art-svg alignLeft" id="section-3.2.2-6.1">
<svg xmlns="http://www.w3.org/2000/svg" width="6.27083in" height="4.02083in" viewBox="0 0 451.5 289.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                  </g>
                </defs>
                <g>
                  <title>ProfileAccount</title>
                  <g transform="translate(18.75,-163.313)">
                    <title>Sheet.1</title>
                    <desc>AssertionAccount Connection</desc>
                    <rect x="0" y="254.062" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="18.19" y="268.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionAccount<tspan x="30.76" y="280.7800384" font-size="1em">Connection</tspan>
                    </text>
                  </g>
                  <g transform="translate(324.75,-162.75)">
                    <title>Sheet.4</title>
                    <desc>ProfileService example.com</desc>
                    <rect x="0" y="254.062" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="26.19" y="268.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">ProfileService<tspan x="27.6" y="283.780048" font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">com</tspan>
                    </text>
                  </g>
                  <g transform="translate(324.75,-117.75)">
                    <title>Sheet.5</title>
                    <desc>ProfileService example.net</desc>
                    <rect x="0" y="254.062" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="26.19" y="268.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">ProfileService<tspan x="27.6" y="283.780048" font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">net</tspan>
                    </text>
                  </g>
                  <g transform="translate(162.75,-18.75)">
                    <title>Sheet.3</title>
                    <desc>ProfileAccount</desc>
                    <rect x="0" y="37.5" width="126" height="252" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="33.04" y="50.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">ProfileAccount</text>
                  </g>
                  <g transform="translate(171.75,-163.313)">
                    <title>Sheet.2</title>
                    <desc>Service alice@example.com</desc>
                    <rect x="0" y="254.062" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="39.46" y="268.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Service <tspan x="13.19" y="283.780048" font-family="sans-serif" font-size="0.799995em">alice</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">@</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">com</tspan>
                    </text>
                  </g>
                  <g transform="translate(171.75,-73.3125)">
                    <title>Database</title>
                    <desc>CatalogContacts</desc>
                    <path d="M4.5 253.5 L103.5 253.5 A38.25 38.25 0 0 1 103.5 289.5 L4.5 289.5 A38.25 38.25 0 0 1 4.5 253.5 Z" fill="#ffffff"></path>
                    <path d="M4.5 253.5 L103.5 253.5 A38.25 38.25 0 0 1 103.5 289.5 L4.5 289.5 A38.25 38.25 0 0 1 4.5 253.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <path d="M103.5 253.5 A38.25 38.25 -180 0 0 103.5 289.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="18.74" y="274.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">CatalogContacts</text>
                  </g>
                  <g transform="translate(171.75,-28.3125)">
                    <title>Database.7</title>
                    <desc>Catalog...</desc>
                    <path d="M4.5 253.5 L103.5 253.5 A38.25 38.25 0 0 1 103.5 289.5 L4.5 289.5 A38.25 38.25 0 0 1 4.5 253.5 Z" fill="#ffffff"></path>
                    <path d="M4.5 253.5 L103.5 253.5 A38.25 38.25 0 0 1 103.5 289.5 L4.5 289.5 A38.25 38.25 0 0 1 4.5 253.5" stroke="#000000" stroke-dasharray="0,3.75" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <path d="M103.5 253.5 A38.25 38.25 -180 0 0 103.5 289.5" stroke="#000000" stroke-dasharray="0,3.75" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="32.69" y="274.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog...</text>
                  </g>
                  <g transform="translate(171.75,-118.313)">
                    <title>Sheet.8</title>
                    <desc>Service alice@example.net</desc>
                    <rect x="0" y="254.062" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="39.46" y="268.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Service <tspan x="13.19" y="283.780048" font-family="sans-serif" font-size="0.799995em">alice</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">@</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">net</tspan>
                    </text>
                  </g>
                  <g transform="translate(171.75,-208.313)">
                    <title>Sheet.9</title>
                    <desc>Account Signature Key</desc>
                    <rect x="0" y="254.062" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="8.35" y="274.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Account Signature Key</text>
                  </g>
                  <g transform="translate(18.75,-109.313)">
                    <title>Sheet.11</title>
                    <desc>AssertionAccount Connection</desc>
                    <rect x="0" y="254.062" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="18.19" y="268.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionAccount<tspan x="30.76" y="280.7800384" font-size="1em">Connection</tspan>
                    </text>
                  </g>
                  <g transform="translate(144.75,-225.75)">
                    <title>Sheet.12</title>
                    <path d="M0 262.5 L0 289.5 L27 289.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(144.75,-252.75)">
                    <title>Sheet.13</title>
                    <path d="M0 289.5 L11.46 289.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(434.25,63.75) rotate(90)">
                    <title>Sheet.14</title>
                    <path d="M0 289.5 L99 289.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(144.75,399.15) rotate(180)">
                    <title>Sheet.15</title>
                    <path d="M0 289.5 L11.46 289.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(144.75,452.25) rotate(180)">
                    <title>Sheet.16</title>
                    <path d="M0 289.5 L11.46 289.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(279.75,-180.75)">
                    <title>Sheet.17</title>
                    <path d="M0 289.5 L38.46 289.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(279.75,-135.75)">
                    <title>Sheet.18</title>
                    <path d="M0 289.5 L38.46 289.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a></figcaption></figure>
<p id="section-3.2.2-7">As with the connection of the device to Alice's personal Mesh, the connection of each device to each account requires the creation of a separate set of keying using the same key combination mechanism described above. This information is contained in the ActivationAccount record corresponding to the account in the CatalogEntryDevice.<a href="#section-3.2.2-7" class="pilcrow">¶</a></p>
<figure id="figure-5">
            <div class="artwork art-svg alignLeft" id="section-3.2.2-8.1">
<svg xmlns="http://www.w3.org/2000/svg" width="6.13542in" height="4.20833in" viewBox="0 0 441.75 303" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                  </g>
                </defs>
                <g>
                  <title>ActivationAccount</title>
                  <g transform="translate(162,-32.25)">
                    <title>Sheet.1</title>
                    <rect x="0" y="82.5" width="261" height="220.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  </g>
                  <g transform="translate(591.75,18.75) rotate(90)">
                    <title>Sheet.2</title>
                    <path d="M0 303 L265.5 303" stroke="#000000" stroke-dasharray="5.25,3.75,0,3.75" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(270.75,-159)">
                    <title>Sheet.3</title>
                    <desc>=</desc>
                    <rect x="0" y="283" width="36" height="20" fill="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.02" y="297.8" fill="#000000" font-family="sans-serif" font-size="1.33333em">=</text>
                  </g>
                  <g transform="translate(270.75,-114)">
                    <title>Sheet.4</title>
                    <desc>=</desc>
                    <rect x="0" y="283" width="36" height="20" fill="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.02" y="297.8" fill="#000000" font-family="sans-serif" font-size="1.33333em">=</text>
                  </g>
                  <g transform="translate(270.75,-69)">
                    <title>Sheet.5</title>
                    <desc>=</desc>
                    <rect x="0" y="283" width="36" height="20" fill="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.02" y="297.8" fill="#000000" font-family="sans-serif" font-size="1.33333em">=</text>
                  </g>
                  <g transform="translate(18.75,-42)">
                    <title>Sheet.8</title>
                    <desc>ProfileDevice Alice1</desc>
                    <rect x="0" y="123" width="108" height="180" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="21.79" y="137.8" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileDevice<tspan x="39.21" y="152.200144" font-size="1em">Alice</tspan>
                      <tspan>1</tspan>
                    </text>
                  </g>
                  <g transform="translate(27.75,-141.563)">
                    <title>Sheet.9</title>
                    <desc>Signature Key Public: X</desc>
                    <rect x="0" y="267.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="17.17" y="282.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Signature Key<tspan font-size="1em" font-style="italic"></tspan>
                      <tspan x="27.69" y="294.2800384" font-size="1em">Public</tspan>
                      <tspan>:</tspan>
                      <tspan font-size="1em" font-style="italic"></tspan>
                      <tspan font-size="1em" font-style="italic">X</tspan>
                    </text>
                  </g>
                  <g transform="translate(27.75,-96.5625)">
                    <title>Sheet.10</title>
                    <desc>Authentication Key Public: X</desc>
                    <rect x="0" y="267.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="6.17" y="282.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Authentication Key<tspan x="27.69" y="294.2800384" font-size="1em">Public</tspan>
                      <tspan>:</tspan>
                      <tspan font-size="1em" font-style="italic"></tspan>
                      <tspan font-size="1em" font-style="italic">X</tspan>
                    </text>
                  </g>
                  <g transform="translate(27.75,-51.5625)">
                    <title>Sheet.11</title>
                    <desc>Encryption Key Public: X</desc>
                    <rect x="0" y="267.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.62" y="282.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encryption Key<tspan x="27.69" y="294.2800384" font-size="1em">Public</tspan>
                      <tspan>:</tspan>
                      <tspan font-size="1em" font-style="italic"></tspan>
                      <tspan font-size="1em" font-style="italic">X</tspan>
                    </text>
                  </g>
                  <g transform="translate(171.75,-141.563)">
                    <title>Sheet.13</title>
                    <desc>Signature Key Private: y, Y</desc>
                    <rect x="0" y="267.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="17.17" y="282.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Signature Key<tspan x="21.19" y="294.2800384" font-size="1em">Private</tspan>
                      <tspan>: </tspan>
                      <tspan font-size="1em" font-style="italic">y</tspan>
                      <tspan font-size="1em" font-style="italic">, </tspan>
                      <tspan font-size="1em" font-style="italic">Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(171.75,-96.5625)">
                    <title>Sheet.14</title>
                    <desc>Authentication Key Private: y, Y</desc>
                    <rect x="0" y="267.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="6.17" y="282.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Authentication Key<tspan x="21.19" y="294.2800384" font-size="1em">Private</tspan>
                      <tspan>: </tspan>
                      <tspan font-size="1em" font-style="italic">y</tspan>
                      <tspan font-size="1em" font-style="italic">, </tspan>
                      <tspan font-size="1em" font-style="italic">Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(171.75,-51.5625)">
                    <title>Sheet.15</title>
                    <desc>Encryption Key Private: y, Y</desc>
                    <rect x="0" y="267.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.62" y="282.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encryption Key<tspan x="21.19" y="294.2800384" font-size="1em">Private</tspan>
                      <tspan>: </tspan>
                      <tspan font-size="1em" font-style="italic">y</tspan>
                      <tspan font-size="1em" font-style="italic">, </tspan>
                      <tspan font-size="1em" font-style="italic">Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(306.75,-42)">
                    <title>Sheet.16</title>
                    <desc>AssertionDevice Account</desc>
                    <rect x="0" y="123" width="108" height="180" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.77" y="137.8" fill="#000000" font-family="sans-serif" font-size="1.00001em">AssertionDevice<tspan x="33.98" y="152.200144" font-size="1em">Account</tspan>
                    </text>
                  </g>
                  <g transform="translate(315.75,-141.563)">
                    <title>Sheet.17</title>
                    <desc>Signature Key Public: X?Y</desc>
                    <rect x="0" y="267.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="17.17" y="282.11" fill="#000000" font-family="sans-serif" font-size="0.833336em">Signature Key<tspan x="20.28" y="294.3600392" font-size="1em">Public</tspan>
                      <tspan>: X</tspan>
                      <tspan font-family="sans-serif" font-size="1em">?</tspan>
                      <tspan>Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(315.75,-96.5625)">
                    <title>Sheet.18</title>
                    <desc>Authentication Key Public: X?Y</desc>
                    <rect x="0" y="267.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="6.17" y="282.11" fill="#000000" font-family="sans-serif" font-size="0.833336em">Authentication Key<tspan x="20.28" y="294.3600392" font-size="1em">Public</tspan>
                      <tspan>: X</tspan>
                      <tspan font-family="sans-serif" font-size="1em">?</tspan>
                      <tspan>Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(315.75,-51.5625)">
                    <title>Sheet.19</title>
                    <desc>Encryption Key Public: X?Y</desc>
                    <rect x="0" y="267.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.62" y="282.11" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encryption Key<tspan x="20.28" y="294.3600392" font-size="1em">Public</tspan>
                      <tspan>: X</tspan>
                      <tspan font-family="sans-serif" font-size="1em">?</tspan>
                      <tspan>Y</tspan>
                    </text>
                  </g>
                  <g transform="translate(117.75,-159)">
                    <title>Sheet.20</title>
                    <path d="M0 303 L47.46 303" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(261.75,-159)">
                    <title>Sheet.21</title>
                    <path d="M0 303 L47.46 303" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(117.75,-114)">
                    <title>Sheet.22</title>
                    <path d="M0 303 L47.46 303" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(261.75,-114)">
                    <title>Sheet.23</title>
                    <path d="M0 303 L47.46 303" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(117.75,-69)">
                    <title>Sheet.24</title>
                    <path d="M0 303 L47.46 303" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(261.75,-69)">
                    <title>Sheet.25</title>
                    <path d="M0 303 L47.46 303" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(126.75,-159)">
                    <title>Sheet.26</title>
                    <desc>?</desc>
                    <rect x="0" y="283" width="36" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="13.02" y="297.8" fill="#000000" font-family="sans-serif" font-size="0.833336em">?</text>
                  </g>
                  <g transform="translate(126.75,-114)">
                    <title>Sheet.27</title>
                    <desc>?</desc>
                    <rect x="0" y="283" width="36" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="13.02" y="297.8" fill="#000000" font-family="sans-serif" font-size="0.833336em">?</text>
                  </g>
                  <g transform="translate(126.75,-69)">
                    <title>Sheet.28</title>
                    <desc>?</desc>
                    <rect x="0" y="283" width="36" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="13.02" y="297.8" fill="#000000" font-family="sans-serif" font-size="0.833336em">?</text>
                  </g>
                  <g transform="translate(18.75,-256.75)">
                    <title>Sheet.29</title>
                    <desc>Private</desc>
                    <rect x="0" y="283" width="252" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="110.28" y="296.3" fill="#000000" font-family="sans-serif" font-size="0.916672em">Private</text>
                  </g>
                  <g transform="translate(306.75,-255.75)">
                    <title>Sheet.30</title>
                    <desc>Public</desc>
                    <rect x="0" y="283" width="108" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="40.53" y="296.3" fill="#000000" font-family="sans-serif" font-size="0.916672em">Public</text>
                  </g>
                  <g transform="translate(231.75,-228.25)">
                    <title>Sheet.31</title>
                    <desc>ActivationAccount</desc>
                    <rect x="0" y="283" width="112.5" height="20" fill="#ffffff" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="15.27" y="296.3" fill="#000000" font-family="sans-serif" font-size="0.916672em">ActivationAccount</text>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a></figcaption></figure>
<p id="section-3.2.2-9">Note that even though Alice's personal account is connected to two separate Mesh Services, the same cryptographic keys are used for both. However separate keys are used for her personal and business accounts so as to prevent these accounts being linked through use of the same device keys.<a href="#section-3.2.2-9" class="pilcrow">¶</a></p>
<div id="n-account-catalogs">
<section id="section-3.2.2.1">
            <h5 id="name-account-catalogs">
<a href="#section-3.2.2.1" class="section-number selfRef">3.2.2.1. </a><a href="#name-account-catalogs" class="section-name selfRef">Account Catalogs</a>
            </h5>
<p id="section-3.2.2.1-1">Mesh Catalogs are a DARE Containers whose entries represent a set of objects with no inherent ordering. Examples of Mesh catalogs include:<a href="#section-3.2.2.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-3.2.2.1-2">
              <dt id="section-3.2.2.1-2.1">Devices</dt>
<dd id="section-3.2.2.1-2.2">
                <p id="section-3.2.2.1-2.2.1">The devices connected to the corresponding Mesh profile.<a href="#section-3.2.2.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.2.2.1-2.3">Contacts</dt>
<dd id="section-3.2.2.1-2.4">
                <p id="section-3.2.2.1-2.4.1">Logical and physical contact information for people and organizations.<a href="#section-3.2.2.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.2.2.1-2.5">Application</dt>
<dd id="section-3.2.2.1-2.6"><a href="#section-3.2.2.1-2.6" class="pilcrow">¶</a>
</dd>
<dt id="section-3.2.2.1-2.7">Bookmarks</dt>
<dd id="section-3.2.2.1-2.8">
                <p id="section-3.2.2.1-2.8.1">Web bookmarks and citations.<a href="#section-3.2.2.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.2.2.1-2.9">Credentials</dt>
<dd id="section-3.2.2.1-2.10">
                <p id="section-3.2.2.1-2.10.1">Username and password information for network resources.<a href="#section-3.2.2.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.2.2.1-2.11">Calendar</dt>
<dd id="section-3.2.2.1-2.12">
                <p id="section-3.2.2.1-2.12.1">Appointments and tasks.<a href="#section-3.2.2.1-2.12.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-3.2.2.1-2.13">Network</dt>
<dd id="section-3.2.2.1-2.14">
                <p id="section-3.2.2.1-2.14.1">Network access configuration information allowing access to WiFi networks and VPNs.<a href="#section-3.2.2.1-2.14.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2.1-2.14.2">Configuration information for applications including mail (SMTP, IMAP, OpenPGP, S/MIME, etc) and SSH.<a href="#section-3.2.2.1-2.14.2" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-3.2.2.1-3">The Devices and Contacts catalogues have special functions in the Mesh as they describe the set of devices and other users that a Mesh user interacts with.<a href="#section-3.2.2.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.2.1-4">These catalogs are also used as the basis for providing a consistent set of friendly names to the users devices and contacts that is accessible to all her devices. This (in principle) allows Alice to give a voice command to her car or her watch or her phone to call a person or open a door and expect consistent results.<a href="#section-3.2.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-mesh-service">
<section id="section-3.2.3">
          <h4 id="name-mesh-service">
<a href="#section-3.2.3" class="section-number selfRef">3.2.3. </a><a href="#name-mesh-service" class="section-name selfRef">Mesh Service</a>
          </h4>
<p id="section-3.2.3-1">Each Mesh Service is described by a ProfileService signed by a long-lived signature key. As with the ProfileMaster, a separate set of Administrator keys is used to sign the Assertion Host objects used to credential Service Hosts.<a href="#section-3.2.3-1" class="pilcrow">¶</a></p>
<figure id="figure-6">
            <div class="artwork art-svg alignLeft" id="section-3.2.3-2.1">
<svg xmlns="http://www.w3.org/2000/svg" width="4.31508in" height="3.01042in" viewBox="0 0 310.686 216.75" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                  </g>
                </defs>
                <g>
                  <title>ProfileService</title>
                  <g transform="translate(41.6239,-18.75)">
                    <title>Sheet.1</title>
                    <desc>ProfileService examplecom</desc>
                    <rect x="0" y="37.5" width="108" height="179.25" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="20.63" y="52.3" fill="#000000" font-family="sans-serif" font-size="1.00001em">ProfileService<tspan x="23.99" y="69.5801728" font-family="sans-serif" font-size="0.83333em">examplecom</tspan>
                    </text>
                  </g>
                  <g transform="translate(50.6239,-120.563)">
                    <title>Sheet.2</title>
                    <desc>Master Signature Key</desc>
                    <rect x="0" y="181.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="9.99" y="196.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Master Signature <tspan x="37.65" y="208.0300384" font-size="1em">Key</tspan>
                    </text>
                  </g>
                  <g transform="translate(50.6239,-73.3125)">
                    <title>Sheet.3</title>
                    <desc>Administrator Signature Keys</desc>
                    <rect x="0" y="181.312" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="16.74" y="196.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">Administrator <tspan x="15.21" y="208.0300384" font-size="1em">Signature Keys</tspan>
                    </text>
                  </g>
                  <g transform="translate(183.936,-72.75)">
                    <title>Sheet.4</title>
                    <desc>AssertionHost</desc>
                    <rect x="0" y="181.312" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="25.5" y="202.03" fill="#000000" font-family="sans-serif" font-size="0.833336em">AssertionHost</text>
                  </g>
                  <g transform="translate(140.624,-90.75)">
                    <title>Sheet.6</title>
                    <path d="M0 216.75 L36.77 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(25.3119,-135.75)">
                    <title>Sheet.9</title>
                    <path d="M0 171.75 L0 216.75 L25.31 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(25.3119,-180.75)">
                    <title>Sheet.10</title>
                    <path d="M0 216.75 L9.77 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(50.6239,-27.75)">
                    <title>Database</title>
                    <desc>CatalogAccount</desc>
                    <path d="M4.5 180.75 L85.5 180.75 A38.25 38.25 0 0 1 85.5 216.75 L4.5 216.75 A38.25 38.25 0 0 1 4.5 180.75 Z" fill="#ffffff"></path>
                    <path d="M4.5 180.75 L85.5 180.75 A38.25 38.25 0 0 1 85.5 216.75 L4.5 216.75 A38.25 38.25 0 0 1 4.5 180.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <path d="M85.5 180.75 A38.25 38.25 -180 0 0 85.5 216.75" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="10.79" y="201.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">CatalogAccount</text>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a></figcaption></figure>
<p id="section-3.2.3-3">Note that the Mesh Service Authentication mechanism only provides trust after first use. It does not provide a mechanism for secure introduction. A Mesh Service <span class="bcp14">SHOULD</span> be credentialed by means of a validation process that establishes the accountability. For example, the CA-Browser Forum Extended Validation Requirements.<a href="#section-3.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-mesh-messaging">
<section id="section-3.2.4">
          <h4 id="name-mesh-messaging">
<a href="#section-3.2.4" class="section-number selfRef">3.2.4. </a><a href="#name-mesh-messaging" class="section-name selfRef">Mesh Messaging</a>
          </h4>
<p id="section-3.2.4-1">The Mesh Messaging layer supports the exchange of short (less than 32KB) messages. Mesh devices connected to the same Mesh profile may exchange Mesh Messages directly. Messages exchanged between Mesh Users <span class="bcp14">MUST</span> be mediated by a Mesh Service for both sending and receipt. This 'four corner' pattern permits ingress and egress controls to be enforced on the messages and that every message is properly recorded in the appropriate spools.<a href="#section-3.2.4-1" class="pilcrow">¶</a></p>
<p id="section-3.2.4-2">For example, To send a message to Alice, Bob posts it to one of the Mesh Services connected to the Mesh Account from which the message is to be sent. The Mesh Service checks to see that both the message and Bob's pattern of behavior comply with their acceptable use policy and if satisfactory, forwards the message to the receiving service example.com.<a href="#section-3.2.4-2" class="pilcrow">¶</a></p>
<figure id="figure-7">
            <div class="artwork art-svg alignLeft" id="section-3.2.4-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="7.98697in" height="3.14583in" viewBox="0 0 575.062 226.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                  </g>
                </defs>
                <g>
                  <title>OutboundAccessControl</title>
                  <g transform="translate(181.5,-18.75)">
                    <title>Sheet.1</title>
                    <desc>ProfileService example.net</desc>
                    <rect x="0" y="37.5" width="269.25" height="189" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="79.28" y="50.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">ProfileService <tspan font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">net</tspan>
                    </text>
                  </g>
                  <g transform="translate(334.5,-90.75)">
                    <title>Sheet.2</title>
                    <desc>Serviced Account bob@example.net</desc>
                    <rect x="0" y="144.938" width="108" height="81.5625" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="19.02" y="157.94" fill="#000000" font-family="sans-serif" font-size="0.833336em">Serviced Account <tspan x="17.99" y="172.940048" font-family="sans-serif" font-size="0.799995em">bob</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">@</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">net</tspan>
                    </text>
                  </g>
                  <g transform="translate(343.5,-100.312)">
                    <title>Database</title>
                    <desc>CatalogContacts</desc>
                    <path d="M4.5 190.5 L85.5 190.5 A38.25 38.25 0 0 1 85.5 226.5 L4.5 226.5 A38.25 38.25 0 0 1 4.5 190.5 Z" fill="#ffffff"></path>
                    <path d="M4.5 190.5 L85.5 190.5 A38.25 38.25 0 0 1 85.5 226.5 L4.5 226.5 A38.25 38.25 0 0 1 4.5 190.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <path d="M85.5 190.5 A38.25 38.25 -180 0 0 85.5 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="9.74" y="211.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">CatalogContacts</text>
                  </g>
                  <g transform="translate(345.75,-46.3125)">
                    <title>Database.4</title>
                    <desc>Spool Outbound</desc>
                    <path d="M4.5 190.5 L85.5 190.5 A38.25 38.25 0 0 1 85.5 226.5 L4.5 226.5 A38.25 38.25 0 0 1 4.5 190.5 Z" fill="#ffffff"></path>
                    <path d="M4.5 190.5 L85.5 190.5 A38.25 38.25 0 0 1 85.5 226.5 L4.5 226.5 A38.25 38.25 0 0 1 4.5 190.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <path d="M85.5 190.5 A38.25 38.25 -180 0 0 85.5 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="9.52" y="211.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Spool Outbound</text>
                  </g>
                  <g transform="translate(27,-36)">
                    <title>Sheet.5</title>
                    <desc>MeshMessage Request From: bob@example.net To: alice@example.com</desc>
                    <rect x="0" y="172.5" width="126" height="54" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="16.04" y="190.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">MeshMessage Request<tspan x="12.59" y="205.500048" font-family="sans-serif" font-size="0.799995em">From</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">: </tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">bob</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">@</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">net</tspan>
                      <tspan x="12.59" y="205.500048" font-family="sans-serif" font-size="0.799995em">To</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">: </tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">alice</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">@</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">com</tspan>
                    </text>
                  </g>
                  <g transform="translate(197.25,-46.3125)">
                    <title>Custom 4</title>
                    <desc>Access Control</desc>
                    <path d="M17.01 226.5 L90.99 226.5 L108 208.5 L90.99 190.5 L17.01 190.5 L0 208.5 L17.01 226.5 Z" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="24.22" y="211.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Access Control</text>
                  </g>
                  <g transform="translate(154.5,-64.3125)">
                    <title>Sheet.7</title>
                    <path d="M0 226.5 L36.21 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(305.25,-64.3125)">
                    <title>Sheet.8</title>
                    <path d="M0 226.5 L33.96 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(499.5,108.187) rotate(90)">
                    <title>Sheet.9</title>
                    <path d="M0 226.5 L29.46 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(343.5,334.688) rotate(180)">
                    <title>Sheet.10</title>
                    <path d="M0 226.5 L70.5 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(198.75,-135.75)">
                    <title>Sheet.11</title>
                    <desc>Acceptable Use Policy</desc>
                    <rect x="0" y="191.063" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="9.63" y="211.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Acceptable Use Policy</text>
                  </g>
                  <g transform="translate(477.75,90.75) rotate(90)">
                    <title>Sheet.12</title>
                    <path d="M0 226.5 L46.9 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(436.868,-64.3097) rotate(0.282707)">
                    <title>Sheet.13</title>
                    <path d="M0 226.5 L107.46 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(450.75,-63.75)">
                    <title>Sheet.14</title>
                    <desc>To: example.com</desc>
                    <rect x="0" y="206.5" width="99" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="7.44" y="220.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">To: <tspan font-family="sans-serif" font-size="0.83333em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.83333em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.83333em">com</tspan>
                    </text>
                  </g>
                  <g transform="translate(18.75,-28.3517)">
                    <title>Sheet.15</title>
                    <desc>Bob: Post</desc>
                    <rect x="0" y="137.102" width="144" height="89.3983" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="52.7" y="150.1" fill="#000000" font-family="sans-serif" font-size="0.833336em">Bob: Post</text>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a></figcaption></figure>
<p id="section-3.2.4-4">The receiving service uses the recipient's contact catalog and other information to determine if the message should be accepted. If accepted, the message is added to the recipient's inbound message spool to be collected by her device(s) when needed.<a href="#section-3.2.4-4" class="pilcrow">¶</a></p>
<figure id="figure-8">
            <div class="artwork art-svg alignLeft" id="section-3.2.4-5.1">
<svg xmlns="http://www.w3.org/2000/svg" width="6.39583in" height="3.14583in" viewBox="0 0 460.5 226.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                  </g>
                </defs>
                <g>
                  <title>InboundAccessControl</title>
                  <g transform="translate(172.5,-18.75)">
                    <title>Sheet.2</title>
                    <desc>ProfileService example.com</desc>
                    <rect x="0" y="37.5" width="269.25" height="189" fill="none" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="72.68" y="50.63" fill="#000000" font-family="sans-serif" font-size="0.833336em">ProfileService <tspan font-family="sans-serif" font-size="1em">example</tspan>
                      <tspan font-family="sans-serif" font-size="1em">.</tspan>
                      <tspan font-family="sans-serif" font-size="1em">com</tspan>
                    </text>
                  </g>
                  <g transform="translate(325.5,-32.8125)">
                    <title>Sheet.3</title>
                    <desc>Serviced Account alice@example.com</desc>
                    <rect x="0" y="87" width="108" height="139.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="19.02" y="100" fill="#000000" font-family="sans-serif" font-size="0.833336em">Serviced Account <tspan x="13.19" y="115.000048" font-family="sans-serif" font-size="0.799995em">alice</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">@</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">com</tspan>
                    </text>
                  </g>
                  <g transform="translate(334.5,-100.313)">
                    <title>Database</title>
                    <desc>CatalogContacts</desc>
                    <path d="M4.5 190.5 L85.5 190.5 A38.25 38.25 0 0 1 85.5 226.5 L4.5 226.5 A38.25 38.25 0 0 1 4.5 190.5 Z" fill="#ffffff"></path>
                    <path d="M4.5 190.5 L85.5 190.5 A38.25 38.25 0 0 1 85.5 226.5 L4.5 226.5 A38.25 38.25 0 0 1 4.5 190.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <path d="M85.5 190.5 A38.25 38.25 -180 0 0 85.5 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="9.74" y="211.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">CatalogContacts</text>
                  </g>
                  <g transform="translate(336.75,-46.3125)">
                    <title>Database.4</title>
                    <desc>Spool Inbound</desc>
                    <path d="M4.5 190.5 L85.5 190.5 A38.25 38.25 0 0 1 85.5 226.5 L4.5 226.5 A38.25 38.25 0 0 1 4.5 190.5 Z" fill="#ffffff"></path>
                    <path d="M4.5 190.5 L85.5 190.5 A38.25 38.25 0 0 1 85.5 226.5 L4.5 226.5 A38.25 38.25 0 0 1 4.5 190.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <path d="M85.5 190.5 A38.25 38.25 -180 0 0 85.5 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="13.24" y="211.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Spool Inbound</text>
                  </g>
                  <g transform="translate(18,-36)">
                    <title>Sheet.5</title>
                    <desc>MeshMessage Request From: bob@example.net To: alice@example.com</desc>
                    <rect x="0" y="172.5" width="126" height="54" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="16.04" y="190.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">MeshMessage Request<tspan x="15.75" y="205.500048" font-family="sans-serif" font-size="0.799995em">From</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">: </tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">bob</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">@</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-size="0.799995em">.</tspan>
                      <tspan font-size="0.799995em">net</tspan>
                      <tspan x="12.59" y="205.500048" font-family="sans-serif" font-size="0.799995em">To</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">: </tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">alice</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">@</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.799995em">com</tspan>
                    </text>
                  </g>
                  <g transform="translate(188.25,-46.3125)">
                    <title>Custom 4</title>
                    <desc>Access Control</desc>
                    <path d="M17.01 226.5 L90.99 226.5 L108 208.5 L90.99 190.5 L17.01 190.5 L0 208.5 L17.01 226.5 Z" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="24.22" y="211.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Access Control</text>
                  </g>
                  <g transform="translate(145.5,-64.3125)">
                    <title>Sheet.7</title>
                    <path d="M0 226.5 L36.21 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(296.25,-64.3125)">
                    <title>Sheet.8</title>
                    <path d="M0 226.5 L33.96 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(490.5,108.187) rotate(90)">
                    <title>Sheet.9</title>
                    <path d="M0 226.5 L29.46 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(334.5,334.688) rotate(180)">
                    <title>Sheet.10</title>
                    <path d="M0 226.5 L70.5 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(189.75,-135.75)">
                    <title>Sheet.11</title>
                    <desc>Acceptable Use Policy</desc>
                    <rect x="0" y="191.063" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="9.63" y="211.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Acceptable Use Policy</text>
                  </g>
                  <g transform="translate(468.75,90.75) rotate(90)">
                    <title>Sheet.12</title>
                    <path d="M0 226.5 L46.9 226.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(18,-93.5)">
                    <title>Sheet.13</title>
                    <desc>From: example.net</desc>
                    <rect x="0" y="206.5" width="126" height="20" fill="none" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="14.23" y="220.1" fill="#000000" font-family="sans-serif" font-size="1.00001em">From: <tspan font-family="sans-serif" font-size="0.83333em">example</tspan>
                      <tspan font-family="sans-serif" font-size="0.83333em">.</tspan>
                      <tspan font-family="sans-serif" font-size="0.83333em">net</tspan>
                    </text>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a></figcaption></figure>
<p id="section-3.2.4-6">For efficiency and to limit the scope for abuse, all inbound Mesh Messages are subject to access control and limited in size to 32KB or less. This limit has proved adequate to support transfer of complex control messages and short content messages. Transfer of data objects of arbitrary size may be achieved by sending a control message containing a URI for the main content which may then be fetched using a protocol such as HTTP.<a href="#section-3.2.4-6" class="pilcrow">¶</a></p>
<p id="section-3.2.4-7">This approach makes transfers of very large data sets (i.e. multiple Terabytes) practical as the 'push' phase of the protocol is limited to the transfer of the initial control message. The bulk transfer is implemented as a 'pull' protocol allowing support for features such as continuous integrity checking and resumption of an interrupted transfer.<a href="#section-3.2.4-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-using-the-mesh-with-applications">
<section id="section-3.3">
        <h3 id="name-using-the-mesh-with-applica">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-using-the-mesh-with-applica" class="section-name selfRef">Using the Mesh with Applications</a>
        </h3>
<p id="section-3.3-1">The Mesh provides an infrastructure for supporting existing Internet security applications and a set security features that may be used to build new ones.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">For example, Alice uses the Mesh to provision and maintain the keys she uses for OpenPGP, S/MIME, SSH and IPSEC. She also uses the credential catalog for end-to-end secure management of the usernames and passwords for her Web browsing and other purposes:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<figure id="figure-9">
          <div class="artwork art-svg alignLeft" id="section-3.3-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.27083in" height="3.89583in" viewBox="0 0 379.5 280.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
              <defs>
                <g>
                  <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                </g>
              </defs>
              <g>
                <title>AliceDevices</title>
                <g transform="translate(18.75,-18.75)">
                  <title>Sheet.1</title>
                  <desc>Alice's Desktop</desc>
                  <rect x="0" y="245.062" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="14.15" y="265.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice's Desktop</text>
                </g>
                <g transform="translate(144.75,-19.3125)">
                  <title>Sheet.2</title>
                  <desc>Alice's Laptop</desc>
                  <rect x="0" y="245.062" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="16.81" y="265.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice's Laptop</text>
                </g>
                <g transform="translate(270.75,-19.3125)">
                  <title>Sheet.3</title>
                  <desc>Alice's Phone</desc>
                  <rect x="0" y="245.062" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="17.91" y="265.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice's Phone</text>
                </g>
                <g transform="translate(72.75,-126.75)">
                  <title>Sheet.9</title>
                  <g>
                    <title>Sheet.4</title>
                    <desc>Alice Personal Account</desc>
                    <rect x="0" y="145.5" width="234" height="135" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="70.69" y="158.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice Personal Account</text>
                  </g>
                  <g transform="translate(18,-72)">
                    <title>Sheet.5</title>
                    <desc>OpenPGP Private Keys</desc>
                    <rect x="0" y="245.062" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="10.21" y="259.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">OpenPGP Private <tspan x="35.7" y="271.7800384" font-size="1em">Keys</tspan>
                    </text>
                  </g>
                  <g transform="translate(128.25,-22.5)">
                    <title>Database.10</title>
                    <desc>Catalog Credential</desc>
                    <path d="M3.78 250.24 L85.5 250.24 A32.1511 32.1511 0 0 1 85.5 280.5 L3.78 280.5 A32.1511 32.1511 0 0 1 3.78 250.24 
  Z" fill="#ffffff"></path>
                    <path d="M3.78 250.24 L85.5 250.24 A32.1511 32.1511 0 0 1 85.5 280.5 L3.78 280.5 A32.1511 32.1511 0 0 1 3.78 250.24" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <path d="M85.5 250.24 A32.1511 32.1511 -180 0 0 85.5 280.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="27.48" y="262.37" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog<tspan x="21.75" y="274.3700384" font-size="1em">Credential</tspan>
                    </text>
                  </g>
                  <g transform="translate(16.875,-18.5625)">
                    <title>Sheet.7</title>
                    <desc>S/MIME Private Keys</desc>
                    <rect x="0" y="245.062" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="28.52" y="259.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">S/MIME <tspan x="20.28" y="271.7800384" font-size="1em">Private Keys</tspan>
                    </text>
                  </g>
                  <g transform="translate(128.25,-76.5)">
                    <title>Database.8</title>
                    <desc>Catalog Contact</desc>
                    <path d="M3.78 250.24 L85.5 250.24 A32.1511 32.1511 0 0 1 85.5 280.5 L3.78 280.5 A32.1511 32.1511 0 0 1 3.78 250.24 
  Z" fill="#ffffff"></path>
                    <path d="M3.78 250.24 L85.5 250.24 A32.1511 32.1511 0 0 1 85.5 280.5 L3.78 280.5 A32.1511 32.1511 0 0 1 3.78 250.24" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <path d="M85.5 250.24 A32.1511 32.1511 -180 0 0 85.5 280.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                    <text x="27.48" y="262.37" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog<tspan x="26.96" y="274.3700384" font-size="1em">Contact</tspan>
                    </text>
                  </g>
                </g>
                <g transform="translate(470.25,158.25) rotate(90)">
                  <title>Sheet.10</title>
                  <path d="M0 280.5 L56.46 280.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(329.086,342.688) rotate(131.112)">
                  <title>Sheet.11</title>
                  <path d="M0 280.5 L75.59 280.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(50.4144,342.688) rotate(48.8879) scale(1,-1)">
                  <title>Sheet.12</title>
                  <path d="M0 280.5 L75.98 280.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a></figcaption></figure>
<p id="section-3.3-4">The Mesh design is highly modular allowing components that were originally designed to support a specific requirement within the Mesh to be applied generally.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div id="n-contact-exchange">
<section id="section-3.3.1">
          <h4 id="name-contact-exchange">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-contact-exchange" class="section-name selfRef">Contact Exchange</a>
          </h4>
<p id="section-3.3.1-1">One of the chief concerns in any PKI is the means by which the public keys of other users are obtained and validated. This is of particular importance in the Mesh since every Mesh Message is subject to access control and it is thus necessary for Alice to accept Bob's credentials before Bob send most types of message to Alice.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">The Mesh supports multiple mechanisms for credential exchange. If Alice and Bob meet in person and are carrying their smart phones, a secure mutual exchange of credentials can be achieved by means of a QR code mechanism. If they are at separate locations, Alice can choose between accepting Bob's contact information with or without additional verification according to the intended use.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-confirmation-protocol">
<section id="section-3.3.2">
          <h4 id="name-confirmation-protocol">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-confirmation-protocol" class="section-name selfRef">Confirmation Protocol</a>
          </h4>
<p id="section-3.3.2-1">The basic device connection protocol requires the ability for one device to send a connection request to the Mesh service hosting the user's profile. To accept the device connection, the user connects to the service using an administration device, reviews the pending requests and creates the necessary device connection assertion if it is accepted.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">The confirmation protocol generalizes this communication pattern allowing any authorized party to post a short accept/reject question to the user who may (or may not) return a signed response. This feature can be used as improvement on traditional second factor authentication providing resistance to man-in-the-middle attacks and providing a permanent non-repudiable indication of the user's specific intent.<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-future-applications">
<section id="section-3.3.3">
          <h4 id="name-future-applications">
<a href="#section-3.3.3" class="section-number selfRef">3.3.3. </a><a href="#name-future-applications" class="section-name selfRef">Future Applications</a>
          </h4>
<p id="section-3.3.3-1">Since a wide range of network applications may be reduced to synchronization of sets and lists, the basic primitives of Catalogs and Spools may be applied to achieve end-to-end security in an even wider variety of applications.<a href="#section-3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3.3-2">For example, a Spool may be used to maintain a mailing list, track comments on a Web forum or record annotations on a document. Encrypting the container entries under a multi-party encryption group allows such communications to be shared with a group of users while maintaining full end-to-end security and without requiring every party writing to the spool to know the public encryption key of every recipient.<a href="#section-3.3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3.3-3">Another interesting possibility is the use of DARE Containers as a file archive mechanism. A single signature on the final Merkle Tree digest value would be sufficient to authenticate every file in the archive. Updates to the archive might be performed using the same container synchronization primitives provided by a Mesh Service. This approach could afford a robust, secure and efficient mechanism for software distribution and update.<a href="#section-3.3.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-mesh-cryptography">
<section id="section-4">
      <h2 id="name-mesh-cryptography">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-mesh-cryptography" class="section-name selfRef">Mesh Cryptography</a>
      </h2>
<p id="section-4-1">All the cryptographic algorithms used in the Mesh are either industry standards or present a work factor that is provably equivalent to an industry standard approach.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Existing Internet security protocols are based on approaches developed in the 1990s when performance tradeoffs were a prime consideration in the design of cryptographic protocols. Security was focused on the transport layer as it provided the best security possible given the available resources.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">With rare exceptions, most computing devices manufactured in the past ten years offer either considerably more computing power than was typical of 1990s era Internet connected machines or considerably less. The Mesh architecture is designed to provide security infrastructure both classes of machine but with the important constraint that the less capable 'constrained' devices are considered to be 'network capable' rather than 'Internet capable' and that the majority of Mesh related processing will be offloaded to another device.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">For example, Alice uses her Desktop and Laptop to exchange end-to-end secure Mesh Messages and documents but her Internet-of-Things food blender and light bulb are limited in the range of functions they support and the telemetry information they provide. The IoT devices connect to a Mesh Hub which acts as an always-on point of presence for the device state and allows complex cryptographic operations to be offloaded if necessary.<a href="#section-4-4" class="pilcrow">¶</a></p>
<figure id="figure-10">
        <div class="artwork art-svg alignLeft" id="section-4-5.1">
<svg xmlns="http://www.w3.org/2000/svg" width="7.89931in" height="4.13802in" viewBox="0 0 568.75 297.937" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
            <defs>
              <g>
                <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
              </g>
            </defs>
            <g>
              <title>ConstrainedDevice</title>
              <g transform="translate(18.75,-108.188)">
                <title>Sheet.1</title>
                <desc>Alice's Desktop</desc>
                <rect x="0" y="262.5" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="14.15" y="283.22" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice's Desktop</text>
              </g>
              <g transform="translate(144.75,-108.469)">
                <title>Sheet.2</title>
                <desc>Alice's Laptop</desc>
                <rect x="0" y="262.5" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="16.81" y="283.22" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice's Laptop</text>
              </g>
              <g transform="translate(324.75,-18.75)">
                <title>Sheet.3</title>
                <desc>Alice's Light Bulb</desc>
                <rect x="0" y="262.5" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="10.72" y="283.22" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice's Light Bulb</text>
              </g>
              <g transform="translate(270.75,-108.75)">
                <title>Sheet.4</title>
                <desc>Mesh Hub</desc>
                <rect x="0" y="262.5" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="24.16" y="283.22" fill="#000000" font-family="sans-serif" font-size="0.833336em">Mesh Hub</text>
              </g>
              <g transform="translate(126.75,-222.58)">
                <title>Cloud</title>
                <desc>Mesh Service</desc>
                <path d="M46.8 249.12 A19.9436 14.549 0 0 1 81.99 248.93 A14.6382 10.6787 0 0 1 107.16 252.46 A14.7217 10.7397 0 0 1 
  124.55 257.88 A11.1053 8.10143 0 0 1 118.64 267.7 A12.5413 9.149 0 0 1 109.02 284.59 A22.5836 16.4749 0 
  0 1 77.58 293.09 A28.4428 20.7493 0 0 1 38.12 291.03 A15.6526 11.4187 0 0 1 10.58 281.82 A11.3106 8.25121 
  0 0 1 10.63 265.35 A9.67765 7.05995 0 1 1 18.44 252.44 A15.1714 11.0677 0 0 1 46.8 249.12 Z" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="30.59" y="273.23" fill="#000000" font-family="sans-serif" font-size="1.00001em">Mesh Service</text>
              </g>
              <g transform="translate(216.75,-18.75)">
                <title>Sheet.6</title>
                <desc>Alice's Blender</desc>
                <rect x="0" y="262.5" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="15.04" y="283.22" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice's Blender</text>
              </g>
              <g transform="translate(-108.187,144.75) rotate(-90)">
                <title>Sheet.7</title>
                <path d="M0 297.94 L51.96 297.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(-124.127,-86.4835) rotate(-39.0939)">
                <title>Sheet.8</title>
                <path d="M0 297.94 L86.23 297.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(485.627,-86.4835) rotate(39.0939) scale(-1,1)">
                <title>Sheet.9</title>
                <path d="M0 297.94 L86.23 297.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(44.7046,30.6469) rotate(-46.7602)">
                <title>Sheet.10</title>
                <path d="M0 297.94 L45.61 297.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(584.96,28.1246) rotate(46.2926) scale(-1,1)">
                <title>Sheet.11</title>
                <path d="M0 297.94 L45.33 297.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
              </g>
              <g transform="translate(148.313,86.25) rotate(-90) scale(-1,1)">
                <title>Side brace</title>
                <desc>Mesh Service Protocol TLS/HTTP/JSON</desc>
                <path d="M0 284.44 L0 293.44 A4.49993 4.49993 -180 0 0 4.5 297.94 L29.25 297.94 A4.49993 4.49993 0 0 1 33.75 302.44 A4.49993 
  4.49993 0 0 1 38.25 297.94 L58.5 297.94 A4.49993 4.49993 -180 0 0 63 293.44 L63 284.44" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="306.44" y="30.75" transform="rotate(-90) scale(-1,1)" fill="#000000" font-family="sans-serif" font-size="0.833336em">Mesh Service Protocol<tspan x="306.44" y="42.7500384" font-size="1em">TLS</tspan>
                  <tspan>/HTTP/JSON</tspan>
                </text>
              </g>
              <g transform="translate(148.313,194.25) rotate(-90) scale(-1,1)">
                <title>Side brace.12</title>
                <desc>Constrained Service Protocol</desc>
                <path d="M0 284.44 L0 293.44 A4.49993 4.49993 -180 0 0 4.5 297.94 L18 297.94 A4.49993 4.49993 0 0 1 22.5 302.44 A4.49993 
  4.49993 0 0 1 27 297.94 L36 297.94 A4.49993 4.49993 -180 0 0 40.5 293.44 L40.5 284.44" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="306.44" y="19.5" transform="rotate(-90) scale(-1,1)" fill="#000000" font-family="sans-serif" font-size="0.833336em">Constrained Service <tspan x="306.44" y="31.5000384" font-size="1em">Protocol</tspan>
                </text>
              </g>
            </g>
          </svg>
        </div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a></figcaption></figure>
<div id="n-best-practice-by-default">
<section id="section-4.1">
        <h3 id="name-best-practice-by-default">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-best-practice-by-default" class="section-name selfRef">Best Practice by Default</a>
        </h3>
<p id="section-4.1-1">Except where support for external applications demand otherwise, the Mesh requires that the following 'best practices' be followed:<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.1-2">
          <dt id="section-4.1-2.1">Industry Standard Algorithms</dt>
<dd id="section-4.1-2.2">
            <p id="section-4.1-2.2.1">All cryptographic protocols make use of the most recently adopted industry standard algorithms.<a href="#section-4.1-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.1-2.3">Strongest Work Factor</dt>
<dd id="section-4.1-2.4">
            <p id="section-4.1-2.4.1">Only the strongest modes of each cipher algorithm are used. All symmetric encryption is performed with 256-bit session keys and all digest algorithms are used in 512-bit output length mode.<a href="#section-4.1-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.1-2.5">Key Hygiene</dt>
<dd id="section-4.1-2.6">
            <p id="section-4.1-2.6.1">Separate public key pairs are used for all cryptographic functions: Encryption, Signature and Authentication. This enables separate control regimes for the separate functions and partitioning of cryptographic functions within the application itself.<a href="#section-4.1-2.6.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.1-2.7">Bound Device Keys</dt>
<dd id="section-4.1-2.8">
            <p id="section-4.1-2.8.1">Each device has a separate set of Encryption, Signature and Authentication key pairs. These <span class="bcp14">MAY</span> be bound to the device to which they are assigned using hardware or other techniques to prevent or discourage export.<a href="#section-4.1-2.8.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.1-2.9">No Optional Extras</dt>
<dd id="section-4.1-2.10">
            <p id="section-4.1-2.10.1">Traditional approaches to security have treated many functions as being 'advanced' and thus suited for use by only the most sophisticated users. The Mesh rejects this approach noting that all users operate in precisely the same environment facing precisely the same threats.<a href="#section-4.1-2.10.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
<div id="n-multilevel-security">
<section id="section-4.2">
        <h3 id="name-multi-level-security">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-multi-level-security" class="section-name selfRef">Multi-Level Security</a>
        </h3>
<p id="section-4.2-1">All Mesh protocol transactions are protected at the Transport, Message and Data level. This provides security in depth that cannot be achieved by applying security at the separate levels independently. Data level encryption provides end-to-end confidentiality and non-repudiation, Message level authentication provides the basis for access control and Transport level encryption provides a degree of protection against traffic analysis.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-multikey-decryption">
<section id="section-4.3">
        <h3 id="name-multi-key-decryption">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-multi-key-decryption" class="section-name selfRef">Multi-Key Decryption</a>
        </h3>
<p id="section-4.3-1">Traditional public key encryption algorithms have two keys, one for encryption and another for decryption. The Mesh makes use of threshold cryptography techniques to allow the decryption key to be split into two or more parts.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">For example, if we have a private key <em>z</em>, we can use this to perform a key agreement with a public key <em>S</em> to obtain the key agreement value A. But if <em>z</em> = (<em>x+y</em>) mod <em>g</em> (where g is the order of the group). we can obtain the exact same result by applying the private keys <em>x</em> and <em>y</em> to <em>S</em> separately and combining the results:<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<figure id="figure-11">
          <div class="artwork art-svg alignLeft" id="section-4.3-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="6.39583in" height="3.83333in" viewBox="0 0 460.5 276" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
              <defs>
                <g>
                  <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                </g>
              </defs>
              <g>
                <title>Distributed</title>
                <g transform="translate(18.75,-18.75)">
                  <title>Sheet.24</title>
                  <desc>Private Key z</desc>
                  <rect x="0" y="141" width="108" height="135" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="28.13" y="154" fill="#000000" font-family="sans-serif" font-size="0.833336em">Private Key <tspan font-size="1em" font-style="italic">z</tspan>
                  </text>
                </g>
                <g transform="translate(27.75,-185.813)">
                  <title>Sheet.1</title>
                  <desc>Private Key z</desc>
                  <rect x="0" y="240.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="22.23" y="255.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Private Key<tspan x="43.02" y="267.2800384" font-size="1em" font-style="italic">z</tspan>
                  </text>
                </g>
                <g transform="translate(153.75,-185.813)">
                  <title>Sheet.6</title>
                  <desc>Public Key S = s.P</desc>
                  <rect x="0" y="240.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="24.27" y="255.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Public Key<tspan x="32.2" y="267.2800384" font-size="1em" font-style="italic">S </tspan>
                    <tspan>= </tspan>
                    <tspan font-size="1em" font-style="italic">s</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P</tspan>
                  </text>
                </g>
                <g transform="translate(351.75,-221.813)">
                  <title>Sheet.7</title>
                  <desc>Key Agreement A = z.S = z.s.P</desc>
                  <rect x="0" y="240.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="13.77" y="255.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Key Agreement<tspan x="18.08" y="267.2800384" font-size="1em" font-style="italic">A</tspan>
                    <tspan> = </tspan>
                    <tspan font-size="1em" font-style="italic">z</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">S</tspan>
                    <tspan> = </tspan>
                    <tspan font-size="1em" font-style="italic">z</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">s</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P</tspan>
                  </text>
                </g>
                <g transform="translate(27.75,-91.3125)">
                  <title>Sheet.8</title>
                  <desc>Private Key x</desc>
                  <rect x="0" y="240.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="22.23" y="255.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Private Key<tspan x="42.83" y="267.2800384" font-size="1em" font-style="italic">x</tspan>
                  </text>
                </g>
                <g transform="translate(27.75,-27.75)">
                  <title>Sheet.9</title>
                  <desc>Private Key y = z-x</desc>
                  <rect x="0" y="240.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="22.23" y="255.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Private Key<tspan x="32.34" y="267.2800384" font-size="1em" font-style="italic">y</tspan>
                    <tspan> = </tspan>
                    <tspan font-size="1em" font-style="italic">z</tspan>
                    <tspan font-size="1em" font-style="italic">-</tspan>
                    <tspan font-size="1em" font-style="italic">x</tspan>
                  </text>
                </g>
                <g transform="translate(207.75,-91.3125)">
                  <title>Sheet.3</title>
                  <desc>Key Agreement Ax = x.S = x.s.P</desc>
                  <rect x="0" y="240.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="13.77" y="255.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Key Agreement<tspan x="16.29" y="267.2800384" font-size="1em" font-style="italic">A</tspan>
                    <tspan y="252.43999091" font-size="0.649894em" font-style="italic">x</tspan>
                    <tspan y="257.13000592" font-size="1em"></tspan>
                    <tspan>= </tspan>
                    <tspan font-size="1em" font-style="italic">x</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">S</tspan>
                    <tspan> = </tspan>
                    <tspan font-size="1em" font-style="italic">x</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">s</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P</tspan>
                  </text>
                </g>
                <g transform="translate(351.75,-50.25)">
                  <title>Sheet.11</title>
                  <desc>Key Agreement A = Ax + Ay = x.s.P + y.s.P = z.s.P</desc>
                  <rect x="0" y="222" width="90" height="54" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="13.77" y="234" fill="#000000" font-family="sans-serif" font-size="0.833336em">Key Agreement<tspan x="20.34" y="246.0000384" font-size="1em" font-style="italic">A</tspan>
                    <tspan> = </tspan>
                    <tspan font-size="1em" font-style="italic">A</tspan>
                    <tspan y="231.15999091" font-size="0.649894em" font-style="italic">x</tspan>
                    <tspan y="235.85000592" font-size="1em"></tspan>
                    <tspan>+ </tspan>
                    <tspan font-size="1em" font-style="italic">A</tspan>
                    <tspan y="231.15999091" font-size="0.649894em" font-style="italic">y</tspan>
                    <tspan y="235.85000592" font-size="1em"></tspan>
                    <tspan>=</tspan>
                    <tspan x="18.12" y="246.0000384" font-size="1em" font-style="italic">x</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">s</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P </tspan>
                    <tspan font-size="1em" font-style="italic">+ </tspan>
                    <tspan font-size="1em" font-style="italic">y</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">s</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P </tspan>
                    <tspan font-size="1em" font-style="italic">=</tspan>
                    <tspan x="35.97" y="246.0000384" font-size="1em" font-style="italic">z</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">s</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P</tspan>
                  </text>
                </g>
                <g transform="translate(207.75,-28.875)">
                  <title>Sheet.10</title>
                  <desc>Key Agreement Ay = y.S = y.s.P</desc>
                  <rect x="0" y="240.563" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="13.77" y="255.28" fill="#000000" font-family="sans-serif" font-size="0.833336em">Key Agreement<tspan x="16.1" y="267.2800384" font-size="1em" font-style="italic">A</tspan>
                    <tspan y="252.43999091" font-size="0.649894em" font-style="italic">y</tspan>
                    <tspan y="257.13000592" font-size="1em"></tspan>
                    <tspan>= </tspan>
                    <tspan font-size="1em" font-style="italic">y</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">S</tspan>
                    <tspan> = </tspan>
                    <tspan font-size="1em" font-style="italic">y</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">s</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P</tspan>
                  </text>
                </g>
                <g transform="translate(117.75,-104.25)">
                  <title>Sheet.13</title>
                  <path d="M0 276 L83.46 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(207.75,-234.75)">
                  <title>Sheet.15</title>
                  <path d="M0 276 L137.46 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(483.75,41.25) rotate(90)">
                  <title>Sheet.18</title>
                  <path d="M0 276 L13.5 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(348.75,32.25) rotate(90)">
                  <title>Sheet.19</title>
                  <path d="M0 276 L22.5 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(117.75,-41.25)">
                  <title>Sheet.20</title>
                  <path d="M0 276 L83.46 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(72.75,-243.75)">
                  <title>Sheet.21</title>
                  <path d="M0 276 L272.46 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(315.75,-82.3125)">
                  <title>Sheet.22</title>
                  <path d="M0 276 L29.46 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(315.75,-73.3125)">
                  <title>Sheet.23</title>
                  <path d="M0 276 L29.46 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(348.75,90.1875) rotate(90)">
                  <title>Sheet.25</title>
                  <path d="M0 276 L25.24 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(297.75,-82.3125)">
                  <title>Sheet.26</title>
                  <path d="M18 276 L18 249 L0 249" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(297.75,-46.3125)">
                  <title>Sheet.27</title>
                  <path d="M18 249 L18 276 L0 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(189.75,-113.25)">
                  <title>Sheet.29</title>
                  <path d="M0 276 L11.46 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(189.75,-52.5)">
                  <title>Sheet.30</title>
                  <path d="M0 276 L11.46 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(465.75,90.1875) rotate(90)">
                  <title>Sheet.2</title>
                  <path d="M0 276 L133.31 276" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a></figcaption></figure>
<p id="section-4.3-4">The approach to Multi-Key Decryption used in the Mesh was originally inspired by the work of Matt Blaze et. al. on proxy re-encryption. But the approach used may also be considered a form of Torben Pedersen's Distributed Key generation.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<p id="section-4.3-5">This technique is used in the Mesh to allow use of decryption key held by a user to be controlled by a cloud service without giving the cloud service the ability to decrypt by itself.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-multiparty-key-generation">
<section id="section-4.4">
        <h3 id="name-multi-party-key-generation">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-multi-party-key-generation" class="section-name selfRef">Multi-Party Key Generation</a>
        </h3>
<p id="section-4.4-1">The mathematics that support multi-key decryption are also the basis for the multi-party key generation mechanism that is applied at multiple levels in the Mesh. The basis for the multi-party key generation used in the Mesh is that for any Diffie-Hellman type cryptographic scheme, given two keypairs { <em>x</em>, <em>X</em> }, { <em>y</em>, <em>Y</em> }, we calculate the public key corresponding to the private key <em>x </em>+ <em>y</em> using just the public key values <em>X </em>and <em>Y</em>.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<figure id="figure-12">
          <div class="artwork art-svg alignLeft" id="section-4.4-2.1">
<svg xmlns="http://www.w3.org/2000/svg" width="4.77083in" height="3.77083in" viewBox="0 0 343.5 271.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
              <defs>
                <g>
                  <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                </g>
              </defs>
              <g>
                <title>CoGen</title>
                <g transform="translate(18.75,-217.313)">
                  <title>Sheet.1</title>
                  <desc>Private Key x</desc>
                  <rect x="0" y="236.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="22.23" y="250.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Private Key<tspan x="42.83" y="262.7800384" font-size="1em" font-style="italic">x</tspan>
                  </text>
                </g>
                <g transform="translate(234.75,-217.313)">
                  <title>Sheet.2</title>
                  <desc>Public Key X = x.P</desc>
                  <rect x="0" y="236.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="24.27" y="250.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Public Key<tspan x="31.64" y="262.7800384" font-size="1em" font-style="italic">X </tspan>
                    <tspan>= </tspan>
                    <tspan font-size="1em" font-style="italic">x</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P</tspan>
                  </text>
                </g>
                <g transform="translate(18.75,-144.75)">
                  <title>Sheet.3</title>
                  <desc>Private Key y</desc>
                  <rect x="0" y="236.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="22.23" y="250.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Private Key<tspan x="42.76" y="262.7800384" font-size="1em" font-style="italic">y</tspan>
                  </text>
                </g>
                <g transform="translate(234.75,-144.75)">
                  <title>Sheet.4</title>
                  <desc>Public Key Y = y.P</desc>
                  <rect x="0" y="236.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="24.27" y="250.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Public Key<tspan x="31.73" y="262.7800384" font-size="1em" font-style="italic">Y </tspan>
                    <tspan>= </tspan>
                    <tspan font-size="1em" font-style="italic">y</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P</tspan>
                  </text>
                </g>
                <g transform="translate(18.75,-18.75)">
                  <title>Sheet.5</title>
                  <desc>Private Key z = x+y</desc>
                  <rect x="0" y="218.063" width="90" height="53.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="22.23" y="241.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Private Key<tspan x="31.38" y="253.7800384" font-size="1em" font-style="italic">z </tspan>
                    <tspan>=</tspan>
                    <tspan font-size="1em" font-style="italic"></tspan>
                    <tspan font-size="1em" font-style="italic">x</tspan>
                    <tspan font-size="1em" font-style="italic">+</tspan>
                    <tspan font-size="1em" font-style="italic">y</tspan>
                  </text>
                </g>
                <g transform="translate(234.75,-18.75)">
                  <title>Sheet.6</title>
                  <desc>Public Key Z = z.P = (x+y).P = X + Y</desc>
                  <rect x="0" y="218.063" width="90" height="53.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="24.27" y="235.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Public Key<tspan x="28.47" y="247.7800384" font-size="1em" font-style="italic">Z </tspan>
                    <tspan>= </tspan>
                    <tspan font-size="1em" font-style="italic">z</tspan>
                    <tspan font-size="1em" font-style="italic">.</tspan>
                    <tspan font-size="1em" font-style="italic">P </tspan>
                    <tspan font-size="1em" font-style="italic">= </tspan>
                    <tspan x="16.7" y="247.7800384" font-size="1em" font-style="italic">(</tspan>
                    <tspan font-size="1em" font-style="italic">x</tspan>
                    <tspan font-size="1em" font-style="italic">+</tspan>
                    <tspan font-size="1em" font-style="italic">y</tspan>
                    <tspan font-size="1em" font-style="italic">).</tspan>
                    <tspan font-size="1em" font-style="italic">P </tspan>
                    <tspan font-size="1em" font-style="italic">= </tspan>
                    <tspan font-size="1em" font-style="italic">X </tspan>
                    <tspan font-size="1em" font-style="italic">+ </tspan>
                    <tspan font-size="1em" font-style="italic">Y</tspan>
                  </text>
                </g>
                <g transform="translate(117.75,-234.75)">
                  <title>Sheet.7</title>
                  <path d="M0 271.5 L101.46 271.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(117.75,-162.75)">
                  <title>Sheet.8</title>
                  <path d="M0 271.5 L101.46 271.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(117.75,-45.75)">
                  <title>Sheet.9</title>
                  <path d="M0 271.5 L101.46 271.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a></figcaption></figure>
<p id="section-4.4-3">Multi-party key generation ensures that keys used to bind devices to a personal Mesh or within a Mesh account are 'safe' if any of the contributions to the generation process are safe.<a href="#section-4.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-data-at-rest-encryption">
<section id="section-4.5">
        <h3 id="name-data-at-rest-encryption">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-data-at-rest-encryption" class="section-name selfRef">Data At Rest Encryption</a>
        </h3>
<p id="section-4.5-1">The Data At Rest Encryption (DARE) format is used for all confidentiality and integrity enhancements. The DARE format is based on the JOSE Signature and Encryption formats and the use of an extended version of the JSON encoding allowing direct encoding of binary objects.<a href="#section-4.5-1" class="pilcrow">¶</a></p>
<div id="n-dare-envelope">
<section id="section-4.5.1">
          <h4 id="name-dare-envelope">
<a href="#section-4.5.1" class="section-number selfRef">4.5.1. </a><a href="#name-dare-envelope" class="section-name selfRef">DARE Envelope</a>
          </h4>
<p id="section-4.5.1-1">The DARE Envelope format offers similar capabilities to existing formats such as OpenPGP and CMS without the need for onerous encoding schemes. DARE Assertions are presented as DARE Envelopes.<a href="#section-4.5.1-1" class="pilcrow">¶</a></p>
<p id="section-4.5.1-2">A feature of the DARE Envelope format not supported in existing schemes is the ability to encrypt and authenticate sets of data attributes separately from the payload. This allows features such as the ability to encrypt a subject line or content type for a message separately from the payload.<a href="#section-4.5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-dare-container">
<section id="section-4.5.2">
          <h4 id="name-dare-container">
<a href="#section-4.5.2" class="section-number selfRef">4.5.2. </a><a href="#name-dare-container" class="section-name selfRef">Dare Container</a>
          </h4>
<p id="section-4.5.2-1">A DARE Container is an append-only sequence of DARE Envelopes. A key feature of the DARE Container format is that entries <span class="bcp14">MAY</span> be encrypted and/or authenticated incrementally. Individual entries <span class="bcp14">MAY</span> be extracted from a DARE Container to create a stand-alone DARE Envelope.<a href="#section-4.5.2-1" class="pilcrow">¶</a></p>
<p id="section-4.5.2-2">Containers may be authenticated by means of a Merkle tree of digest values on the individual frames. This allows similar demonstrations of integrity to those afforded by Blockchain to be provided but with much greater efficiency.<a href="#section-4.5.2-2" class="pilcrow">¶</a></p>
<p id="section-4.5.2-3">Unlike traditional encryption formats which require a new public key exchange for each encrypted payload, the DARE Container format allows multiple entries to be encrypted under a single key exchange operation. This is particularly useful in applications such as encrypting server transaction logs. The server need only perform a single key exchange operation is performed each time it starts to establish a master key. The master key is then used to create fresh symmetric keying material for each entry in the log using a unique nonce per entry.<a href="#section-4.5.2-3" class="pilcrow">¶</a></p>
<figure id="figure-13">
            <div class="artwork art-svg alignLeft" id="section-4.5.2-4.1">
<svg xmlns="http://www.w3.org/2000/svg" width="2.86197in" height="2.52083in" viewBox="0 0 206.062 181.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
                <defs>
                  <g>
                    <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                  </g>
                </defs>
                <g>
                  <title>ArchLog</title>
                  <g transform="translate(43.3119,-18.75)">
                    <title>Sheet.9</title>
                    <g transform="translate(0,-112.5)">
                      <title>Sheet.1</title>
                      <desc>Key Exchange A Log Entry 1</desc>
                      <rect x="0" y="150" width="144" height="31.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="40.29" y="162.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">Key Exchange A<tspan x="49.36" y="174.7500384" font-size="1em">Log Entry </tspan>
                        <tspan>1</tspan>
                      </text>
                    </g>
                    <g transform="translate(0,-99)">
                      <title>Sheet.2</title>
                      <desc>Log Entry 2</desc>
                      <rect x="0" y="168" width="144" height="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="49.36" y="177.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">Log Entry 2</text>
                    </g>
                    <g transform="translate(0,-85.5)">
                      <title>Sheet.3</title>
                      <desc>Log Entry 3</desc>
                      <rect x="0" y="168" width="144" height="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="49.36" y="177.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">Log Entry 3</text>
                    </g>
                    <g transform="translate(0,-72)">
                      <title>Sheet.4</title>
                      <desc>Log Entry 4</desc>
                      <rect x="0" y="168" width="144" height="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="49.36" y="177.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">Log Entry 4</text>
                    </g>
                    <g transform="translate(0,-58.5)">
                      <title>Sheet.5</title>
                      <desc>Log Entry 5</desc>
                      <rect x="0" y="168" width="144" height="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="49.36" y="177.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">Log Entry 5</text>
                    </g>
                    <g transform="translate(0,-27)">
                      <title>Sheet.6</title>
                      <desc>Key Exchange B Log Entry 6</desc>
                      <rect x="0" y="150" width="144" height="31.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="40.46" y="162.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">Key Exchange B<tspan x="49.36" y="174.7500384" font-size="1em">Log Entry </tspan>
                        <tspan>6</tspan>
                      </text>
                    </g>
                    <g transform="translate(0,-13.5)">
                      <title>Sheet.7</title>
                      <desc>Log Entry 7</desc>
                      <rect x="0" y="168" width="144" height="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="49.36" y="177.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">Log Entry 7</text>
                    </g>
                    <g>
                      <title>Sheet.8</title>
                      <desc>Log Entry 8</desc>
                      <rect x="0" y="168" width="144" height="13.5" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                      <text x="49.36" y="177.75" fill="#000000" font-family="sans-serif" font-size="0.833336em">Log Entry 8</text>
                    </g>
                  </g>
                  <g transform="translate(25.3119,-61.5)">
                    <title>Sheet.10</title>
                    <path d="M0 181.5 L11.46 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(25.3119,-111)">
                    <title>Sheet.11</title>
                    <path d="M0 181.5 L18 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(25.3119,-97.5)">
                    <title>Sheet.12</title>
                    <path d="M0 181.5 L18 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(25.3119,-84)">
                    <title>Sheet.13</title>
                    <path d="M0 181.5 L18 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(25.3119,-39)">
                    <title>Sheet.14</title>
                    <path d="M0 181.5 L18 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(25.3119,-147)">
                    <title>Sheet.15</title>
                    <path d="M0 181.5 L11.46 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(25.3119,-25.5)">
                    <title>Sheet.16</title>
                    <path d="M0 181.5 L18 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(25.3119,-124.5)">
                    <title>Sheet.17</title>
                    <path d="M0 181.5 L18 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(206.812,34.5) rotate(90)">
                    <title>Sheet.18</title>
                    <path d="M0 181.5 L63 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                  <g transform="translate(206.812,120) rotate(90)">
                    <title>Sheet.19</title>
                    <path d="M0 181.5 L36 181.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                  </g>
                </g>
              </svg>
            </div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a></figcaption></figure>
<p id="section-4.5.2-5">Integrity is provided by a Merkle tree calculated over the sequence of log entries. The tree apex is signed at regular intervals to provide non-repudiation.<a href="#section-4.5.2-5" class="pilcrow">¶</a></p>
<p id="section-4.5.2-6">Three types of DARE Containers are used in the mesh<a href="#section-4.5.2-6" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.5.2-7">
            <dt id="section-4.5.2-7.1">Catalogs</dt>
<dd id="section-4.5.2-7.2">
              <p id="section-4.5.2-7.2.1">A DARE Container whose entries track the status of a set of related objects which may be added, updated or deleted.<a href="#section-4.5.2-7.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.5.2-7.3">Spools</dt>
<dd id="section-4.5.2-7.4">
              <p id="section-4.5.2-7.4.1">A DARE Container whose entries track the status of a series of Mesh Messages.<a href="#section-4.5.2-7.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.5.2-7.5">Archives</dt>
<dd id="section-4.5.2-7.6">
              <p id="section-4.5.2-7.6.1">A DARE Container used to provide a file archive with optional confidentiality and/or integrity enhancements.<a href="#section-4.5.2-7.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
</section>
</div>
</section>
</div>
<div id="n-uniform-data-fingerprints">
<section id="section-4.6">
        <h3 id="name-uniform-data-fingerprints">
<a href="#section-4.6" class="section-number selfRef">4.6. </a><a href="#name-uniform-data-fingerprints" class="section-name selfRef">Uniform Data Fingerprints.</a>
        </h3>
<p id="section-4.6-1">The Uniform Data Fingerprint (UDF) format provides a compact means of presenting cryptographic nonces, keys and digest values using Base32 encoding that resists semantic substitution attacks. UDF provides a convenient format for data entry. Since the encoding used is case-insensitive, UDFs may if necessary be read out over a voice link without excessive inconvenience.<a href="#section-4.6-1" class="pilcrow">¶</a></p>
<p id="section-4.6-2">The following are examples of UDF values:<a href="#section-4.6-2" class="pilcrow">¶</a></p>
<div id="section-4.6-3">
<pre class="sourcecode">NB2U-NLDC-ZBEJ-VPWS-AHWM-CA72-4AMA
EALD-BHS4-SQXO-V7HJ-VPGX-36DA-JS2Q
SAQK-72HP-JWES-6CWN-JKTU-PW7X-FAOL-W
MB5S-R4AJ-3FBT-7NHO-T26Z-2E6Y-WFH4
KCM5-7VB6-IJXJ-WKHX-NZQF-OKGZ-EWVN
ACJJ-XRYN-VS32-PYSM-MX7W-64VQ-RNJX</pre><a href="#section-4.6-3" class="pilcrow">¶</a>
</div>
<p id="section-4.6-4">UDF content digests are used to support a direct trust model similar to that of OpenPGP. Every Mesh Profile is authenticated by the UDF fingerprint of its signature key. Mesh Friendly Names and UDF Fingerprints thus serve analogous functions to DNS names and IP Addresses. Like DNS names, Friendly Names provide the basis for application-layer interactions while the UDF Fingerprints are used as to provide the foundation for security.<a href="#section-4.6-4" class="pilcrow">¶</a></p>
<div id="n-friendly-names">
<section id="section-4.6.1">
          <h4 id="name-friendly-names">
<a href="#section-4.6.1" class="section-number selfRef">4.6.1. </a><a href="#name-friendly-names" class="section-name selfRef">Friendly Names</a>
          </h4>
<p id="section-4.6.1-1">Internet addressing schemes are designed to provide a globally unique (or at minimum unambiguous) name for a host, service or account. In the early days of the Internet, this resulted in addresses such as 10.2.3.4 and alice@example.com which from a usability point of view might be considered serviceable if not ideal. Today the Internet is a global infrastructure servicing billions of users and tens of billions of devices and accounts are more likely to be alice.lastname.1934@example.com than something memorable.<a href="#section-4.6.1-1" class="pilcrow">¶</a></p>
<p id="section-4.6.1-2">Friendly names provide a user or community specific means of identifying resources that may take advantage of geographic location or other cues to resolve possible ambiguity. If Alice says to her voice activated device "close the garage door" it is implicit that it is her garage door that she wishes to close. And should Alice be fortunate enough to own two houses with a garage, it is implicit that it is the garage door of the house she is presently using that she wishes to close.<a href="#section-4.6.1-2" class="pilcrow">¶</a></p>
<p id="section-4.6.1-3">The Mesh Device Catalog provides a directory mapping friendly names to devices that is available to all Alice's connected devices so that she may give and instruction to any of her devices using the same friendly name and expect consistent results.<a href="#section-4.6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-encrypted-authenticated-resource-locators">
<section id="section-4.6.2">
          <h4 id="name-encrypted-authenticated-res">
<a href="#section-4.6.2" class="section-number selfRef">4.6.2. </a><a href="#name-encrypted-authenticated-res" class="section-name selfRef">Encrypted Authenticated Resource Locators</a>
          </h4>
<p id="section-4.6.2-1">Various schemes have been used to employ QR Codes as a means of device and/or user authentication. In many of these schemes a QR code contains a challenge nonce that is used to authenticate the connection request.<a href="#section-4.6.2-1" class="pilcrow">¶</a></p>
<p id="section-4.6.2-2">The Mesh supports a QR code connection mode employing the Encrypted Authenticated Resource Locator (EARL) format. An EARL is an identifier which allows an encrypted data object to be retrieved and decrypted. In this case, the encrypted data object contains the information needed to complete the interaction.<a href="#section-4.6.2-2" class="pilcrow">¶</a></p>
<p id="section-4.6.2-3">An EARL contains the domain name of the service providing the resolution service and an encryption master key:<a href="#section-4.6.2-3" class="pilcrow">¶</a></p>
<div id="section-4.6.2-4">
<pre class="sourcecode">udf://example.com/ECQ4-KEU2-LRMG-UUUP-FGJ2-SZTP-WF4V-XE</pre><a href="#section-4.6.2-4" class="pilcrow">¶</a>
</div>
<p id="section-4.6.2-5">The EARL may be expressed as a QR code:<a href="#section-4.6.2-5" class="pilcrow">¶</a></p>
<figure id="figure-14">
            <div class="artwork art-svg alignLeft" id="section-4.6.2-6.1">
<svg xmlns="http://www.w3.org/2000/svg" width="820" height="820" viewBox="0 0 820.0 820.0">
                <rect x="0" y="0" width="820" height="820" fill="#FFFFFF"></rect>
                <rect x="80" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="180" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="80" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="100" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="120" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="140" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="160" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="180" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="180" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="200" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="220" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="220" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="220" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="220" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="220" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="220" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="220" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="220" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="220" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="180" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="240" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="260" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="280" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="180" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="300" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="320" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="340" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="360" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="180" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="380" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="400" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="420" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="180" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="440" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="460" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="480" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="180" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="500" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="520" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="220" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="540" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="560" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="580" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="180" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="600" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="620" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="640" y="720" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="460" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="660" y="700" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="680" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="320" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="540" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="700" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="80" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="100" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="120" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="140" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="160" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="180" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="200" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="240" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="260" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="280" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="300" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="340" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="360" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="380" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="400" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="420" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="440" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="480" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="500" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="520" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="560" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="580" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="600" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="620" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="640" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="660" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="680" width="20" height="20" fill="#000000"></rect>
                <rect x="720" y="720" width="20" height="20" fill="#000000"></rect>
              </svg>
            </div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a></figcaption></figure>
<p id="section-4.6.2-7">An EARL is resolved by presenting the content digest fingerprint of the encryption key to a Web service hosted at the specified domain. The service returns a DARE Envelope whose payload is encrypted and authenticated under the specified master key. Since the content is stored on the service under the fingerprint of the key and not the key itself, the service cannot decrypt the plaintext. Only a party that has access to the encryption key in the QR code can decrypt the message.<a href="#section-4.6.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-secure-internet-names">
<section id="section-4.6.3">
          <h4 id="name-secure-internet-names">
<a href="#section-4.6.3" class="section-number selfRef">4.6.3. </a><a href="#name-secure-internet-names" class="section-name selfRef">Secure Internet Names</a>
          </h4>
<p id="section-4.6.3-1">Secure Internet Names bind an Internet address such as a URL or an email address to a Security Policy by means of a UDF content digest of a document describing the security policy. This binding enables a SIN-aware Internet client to ensure that the security policy is applied when connecting to the address. For example, ensuring that an email sent to an address must be end-to-end encrypted under a particular public key or that access to a Web Service requires a particular set of security enhancements.<a href="#section-4.6.3-1" class="pilcrow">¶</a></p>
<dl class="dlParallel" id="section-4.6.3-2">
            <dt id="section-4.6.3-2.1">alice@example.com </dt>
<dd id="section-4.6.3-2.2">
              <p id="section-4.6.3-2.2.1">Alice's regular email address (not a SIN).<a href="#section-4.6.3-2.2.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.6.3-2.3">alice@mm--uuuu-uuuu-uuuu.example.com </dt>
<dd id="section-4.6.3-2.4">
              <p id="section-4.6.3-2.4.1">A strong email address for Alice that can be used by a regular email client.<a href="#section-4.6.3-2.4.1" class="pilcrow">¶</a></p>
</dd>
<dt id="section-4.6.3-2.5">alice@example.com.mm--uuuu-uuuu-uuuu </dt>
<dd id="section-4.6.3-2.6">
              <p id="section-4.6.3-2.6.1">A strong email address for Alice that can only used by an email client that can process SINs.<a href="#section-4.6.3-2.6.1" class="pilcrow">¶</a></p>
</dd>
</dl>
<p id="section-4.6.3-3">Using an email address that has the Security Policy element as a prefix allows a DNS wildcard element to be defined that allows the address to be used with any email client. Presenting the Security Policy element as a suffix means it can only be resolved by a SIN-aware client.<a href="#section-4.6.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-personal-key-escrow">
<section id="section-4.7">
        <h3 id="name-personal-key-escrow">
<a href="#section-4.7" class="section-number selfRef">4.7. </a><a href="#name-personal-key-escrow" class="section-name selfRef">Personal Key Escrow</a>
        </h3>
<p id="section-4.7-1">One of the core objectives of the Mesh is to make data level encryption ubiquitous. While data level encryption provides robust protection of data confidentiality, loss of the ability to decrypt means data loss.<a href="#section-4.7-1" class="pilcrow">¶</a></p>
<p id="section-4.7-2">For many Internet users, data availability is a considerably greater concern than confidentiality. Ten years later, there is no way to replace pictures of the children at five years old. Recognizing the need to guarantee data recovery, the Mesh provides a robust personal key escrow and recovery mechanism. Lawful access is not supported as a requirement.<a href="#section-4.7-2" class="pilcrow">¶</a></p>
<p id="section-4.7-3">Besides supporting key recovery in the case of loss, the Mesh protocols potentially support key recovery in the case of the key holder's death. The chief difficulty faced in implementing such a scheme being developing an acceptable user interface which allows the user to specify which of their data should survive them and which should not. As the apothegm goes: Mallet wants his beneficiaries to know where he buried Aunt Agatha's jewels but not where he buried Aunt Agatha.<a href="#section-4.7-3" class="pilcrow">¶</a></p>
<p id="section-4.7-4">The Mesh supports use of Shamir Secret Sharing to split a secret key into a set of shares, a predetermined number of which may be used to recover the original secret. For convenience secret shares are represented using UDF allowing presentation in Base32 (i.e. text format) for easy transcription or QR code presentation if preferred.<a href="#section-4.7-4" class="pilcrow">¶</a></p>
<p id="section-4.7-5">A Mesh Profile is escrowed by creating a recovery record containing the private keys corresponding to the master signature and master escrow keys associated with the profile. A master secret is then generated which is used to generate a symmetric encryption key used to encrypt the recovery record and to generate the desired number of recovery shares. For example, Alice escrows her Mesh Profile creating three recovery shares, two of which are required to recover the master secret:<a href="#section-4.7-5" class="pilcrow">¶</a></p>
<figure id="figure-15">
          <div class="artwork art-svg alignLeft" id="section-4.7-6.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.27083in" height="3.44268in" viewBox="0 0 379.5 247.873" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
              <defs>
                <g>
                  <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                </g>
              </defs>
              <g>
                <title>SecretShare</title>
                <g transform="translate(18.75,-193.685)">
                  <title>Sheet.1</title>
                  <desc>MasterKey</desc>
                  <rect x="0" y="212.435" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="23.12" y="233.15" fill="#000000" font-family="sans-serif" font-size="0.833336em">MasterKey</text>
                </g>
                <g transform="translate(144.75,-193.404)">
                  <title>Sheet.2</title>
                  <desc>HKDF/AES 256</desc>
                  <rect x="0" y="212.435" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="15.62" y="233.15" fill="#000000" font-family="sans-serif" font-size="0.833336em">HKDF/AES 256</text>
                </g>
                <g transform="translate(270.75,-193.685)">
                  <title>Sheet.3</title>
                  <desc>Encrypted Record</desc>
                  <rect x="0" y="212.435" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="8.94" y="233.15" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encrypted Record</text>
                </g>
                <g transform="translate(144.75,-121.967)">
                  <title>Sheet.4</title>
                  <desc>Secret</desc>
                  <rect x="0" y="212.435" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="32.19" y="233.15" fill="#000000" font-family="sans-serif" font-size="0.833336em">Secret</text>
                </g>
                <g transform="translate(144.75,-49.9665)">
                  <title>Sheet.5</title>
                  <desc>Shamir Secret Sharing</desc>
                  <rect x="0" y="212.435" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="16.86" y="227.15" fill="#000000" font-family="sans-serif" font-size="0.833336em">Shamir Secret <tspan x="29.81" y="239.1500384" font-size="1em">Sharing</tspan>
                  </text>
                </g>
                <g transform="translate(270.75,-72.75)">
                  <title>Sheet.6</title>
                  <desc>Share 1</desc>
                  <rect x="0" y="230.719" width="90" height="17.154" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="29.79" y="242.3" fill="#000000" font-family="sans-serif" font-size="0.833336em">Share 1</text>
                </g>
                <g transform="translate(270.75,-45.327)">
                  <title>Sheet.7</title>
                  <desc>Share 2</desc>
                  <rect x="0" y="230.719" width="90" height="17.154" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="29.79" y="242.3" fill="#000000" font-family="sans-serif" font-size="0.833336em">Share 2</text>
                </g>
                <g transform="translate(270.75,-18.75)">
                  <title>Sheet.8</title>
                  <desc>Share 3</desc>
                  <rect x="0" y="230.719" width="90" height="17.154" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="29.79" y="242.3" fill="#000000" font-family="sans-serif" font-size="0.833336em">Share 3</text>
                </g>
                <g transform="translate(108.75,-211.404)">
                  <title>Sheet.9</title>
                  <path d="M0 247.87 L29.46 247.87" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(234.75,-211.404)">
                  <title>Sheet.10</title>
                  <path d="M0 247.87 L29.46 247.87" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(-58.1228,89.6184) rotate(-90)">
                  <title>Sheet.12</title>
                  <path d="M0 247.87 L28.61 247.87" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(437.623,125.906) rotate(90)">
                  <title>Sheet.13</title>
                  <path d="M0 247.87 L29.46 247.87" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(252.75,-54.4665)">
                  <title>Sheet.14</title>
                  <path d="M0 247.87 L11.46 247.87" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(252.75,-26.904)">
                  <title>Sheet.15</title>
                  <path d="M0 247.87 L11.46 247.87" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(500.623,166.969) rotate(90)">
                  <title>Sheet.16</title>
                  <path d="M0 247.87 L54 247.87" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(252.75,-80.904)">
                  <title>Sheet.11</title>
                  <path d="M0 247.87 L11.46 247.87" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(234.75,-67.404)">
                  <title>Sheet.18</title>
                  <path d="M0 247.87 L18 247.87" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a></figcaption></figure>
<p id="section-4.7-7">To recover the master secret, Alice presents the necessary number of key shares. These are used to recover the master secret which is used to generate the decryption key.<a href="#section-4.7-7" class="pilcrow">¶</a></p>
<figure id="figure-16">
          <div class="artwork art-svg alignLeft" id="section-4.7-8.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.27083in" height="3.0804in" viewBox="0 0 379.5 221.789" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
              <defs>
                <g>
                  <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                </g>
              </defs>
              <g>
                <title>SecretRecover</title>
                <g transform="translate(270.75,-167.601)">
                  <title>Sheet.1</title>
                  <desc>MasterKey</desc>
                  <rect x="0" y="186.351" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="23.12" y="207.07" fill="#000000" font-family="sans-serif" font-size="0.833336em">MasterKey</text>
                </g>
                <g transform="translate(144.75,-167.32)">
                  <title>Sheet.2</title>
                  <desc>HKDF/AES 256</desc>
                  <rect x="0" y="186.351" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="15.62" y="207.07" fill="#000000" font-family="sans-serif" font-size="0.833336em">HKDF/AES 256</text>
                </g>
                <g transform="translate(18.75,-167.601)">
                  <title>Sheet.3</title>
                  <desc>Encrypted Record</desc>
                  <rect x="0" y="186.351" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="8.94" y="207.07" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encrypted Record</text>
                </g>
                <g transform="translate(144.75,-95.8823)">
                  <title>Sheet.4</title>
                  <desc>Secret</desc>
                  <rect x="0" y="186.351" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="32.19" y="207.07" fill="#000000" font-family="sans-serif" font-size="0.833336em">Secret</text>
                </g>
                <g transform="translate(144.75,-23.8823)">
                  <title>Sheet.5</title>
                  <desc>Shamir Secret Recovery</desc>
                  <rect x="0" y="186.351" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="16.86" y="201.07" fill="#000000" font-family="sans-serif" font-size="0.833336em">Shamir Secret <tspan x="26.29" y="213.0700384" font-size="1em">Recovery</tspan>
                  </text>
                </g>
                <g transform="translate(18.75,-46.173)">
                  <title>Sheet.6</title>
                  <desc>Share 1</desc>
                  <rect x="0" y="204.634" width="90" height="17.154" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="29.79" y="216.21" fill="#000000" font-family="sans-serif" font-size="0.833336em">Share 1</text>
                </g>
                <g transform="translate(18.75,-18.75)">
                  <title>Sheet.7</title>
                  <desc>Share 2</desc>
                  <rect x="0" y="204.634" width="90" height="17.154" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="29.79" y="216.21" fill="#000000" font-family="sans-serif" font-size="0.833336em">Share 2</text>
                </g>
                <g transform="translate(108.75,-185.32)">
                  <title>Sheet.9</title>
                  <path d="M0 221.79 L29.46 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(234.75,-185.32)">
                  <title>Sheet.10</title>
                  <path d="M0 221.79 L29.46 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(-32.0385,89.6184) rotate(-90)">
                  <title>Sheet.11</title>
                  <path d="M0 221.79 L28.61 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(348.539,167.25) rotate(90)">
                  <title>Sheet.15</title>
                  <path d="M0 221.79 L4.5 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(126.75,-50.0385)">
                  <title>Sheet.16</title>
                  <path d="M0 221.79 L11.46 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(108.75,-54.5385)">
                  <title>Sheet.18</title>
                  <path d="M0 221.79 L18 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(348.539,189.75) rotate(90)">
                  <title>Sheet.19</title>
                  <path d="M0 221.79 L4.5 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(126.75,-32.0385)">
                  <title>Sheet.20</title>
                  <path d="M0 221.79 L11.46 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(108.75,-27.5385)">
                  <title>Sheet.21</title>
                  <path d="M0 221.79 L18 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(-32.0385,162.469) rotate(-90)">
                  <title>Sheet.8</title>
                  <path d="M0 221.79 L28.61 221.79" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a></figcaption></figure>
<p id="section-4.7-9">A user may choose to store their encrypted recovery record themselves or make use of the EARL mechanism to store the information at one or more cloud services using the fingerprint of the master secret as the locator.<a href="#section-4.7-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-user-experience">
<section id="section-5">
      <h2 id="name-user-experience">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-user-experience" class="section-name selfRef">User Experience</a>
      </h2>
<p id="section-5-1">This section describes the Mesh in use. These use cases described here are re-visited in the companion Mesh Schema Reference <span>[<a href="#draft-hallambaker-mesh-schema" class="xref">draft-hallambaker-mesh-schema</a>]</span> and Mesh Protocol Reference <span>[<a href="#draft-hallambaker-mesh-protocol" class="xref">draft-hallambaker-mesh-protocol</a>]</span> with additional examples and details.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">For clarity and for compactness, these use cases are illustrated using the command line tool meshman.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The original design brief for the Mesh was to make it easier to use the Internet securely. Over time, it was realized that users are almost never prepared to sacrifice usability or convenience for security. It is therefore insufficient to minimize the cost of security, if secure applications are to be used securely they must be at least as easy to use as those they replace. If security features are to be used, they must not require the user to make any additional effort whatsoever.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">The key to meeting this constraint is that any set of instructions that can be written down to be followed by a user can be turned into code and executed by machine. Provided that the necessary authentication, integrity and confidentiality controls are provided. Thus, the Mesh is not just a cryptographic infrastructure that makes use of computer systems more secure, it is a usability infrastructure that makes computers easier to use by providing security.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The user experience is thus at the heart of the design of the Mesh and a description of the Mesh Architecture properly begins with consideration of the view of the system that matters most: that of the user.<a href="#section-5-5" class="pilcrow">¶</a></p>
<p id="section-5-6">The principle security protocols in use today were designed at a time when most Internet users made use of either a single machine or one of a number of shared machines connected to a shared file store. The problem of transferring cryptographic keys and configuration data between machines was rarely considered and when it was considered was usually implemented badly. Today the typical user owns or makes use of multiple devices they recognize as a computer (laptop, tablet) and an even greater number of devices that they do not recognize as computers but are (almost any device with a display).<a href="#section-5-6" class="pilcrow">¶</a></p>
<figure id="figure-17">
        <div class="artwork art-svg alignLeft" id="section-5-7.1">
<svg xmlns="http://www.w3.org/2000/svg" width="4.89583in" height="4.63802in" viewBox="0 0 352.5 333.937" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
            <g>
              <title>UserExperienceDevices</title>
              <g transform="translate(18.75,-144.75)">
                <title>Sheet.4</title>
                <desc>Alice Personal Account</desc>
                <rect x="0" y="234.937" width="315" height="99" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="111.19" y="247.94" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice Personal Account</text>
              </g>
              <g transform="translate(18.75,-252.75)">
                <title>Sheet.5</title>
                <desc>Service: alice@example.com</desc>
                <rect x="0" y="271.5" width="315" height="62.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="89.49" y="284.63" fill="#000000" font-family="sans-serif" font-size="0.833336em">Service: <tspan font-family="sans-serif" font-size="1em">alice</tspan>
                  <tspan font-family="sans-serif" font-size="1em">@</tspan>
                  <tspan font-family="sans-serif" font-size="1em">example</tspan>
                  <tspan font-family="sans-serif" font-size="1em">.</tspan>
                  <tspan font-family="sans-serif" font-size="1em">com</tspan>
                </text>
              </g>
              <g transform="translate(18.75,-18.75)">
                <title>Sheet.6</title>
                <desc>Alice Mesh</desc>
                <rect x="0" y="216.937" width="315" height="117" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="135.23" y="229.94" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice Mesh</text>
              </g>
              <g transform="translate(27.75,-73.3125)">
                <title>Sheet.1</title>
                <desc>Alice1 (Administration)</desc>
                <rect x="0" y="298.5" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="32.68" y="313.22" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice1<tspan x="11.68" y="325.2200384" font-size="1em">(</tspan>
                  <tspan>Administration)</tspan>
                </text>
              </g>
              <g transform="translate(131.25,-73.3125)">
                <title>Sheet.2</title>
                <desc>Alice2</desc>
                <rect x="0" y="298.5" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="32.68" y="313.22" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice2</text>
              </g>
              <g transform="translate(234.75,-72.75)">
                <title>Sheet.3</title>
                <desc>Alice3</desc>
                <rect x="0" y="298.5" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                <text x="32.68" y="313.22" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice3</text>
              </g>
              <g transform="translate(27.75,-33.4902)">
                <title>Database</title>
                <desc>Catalog Device</desc>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68 
  Z" fill="#ffffff"></path>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <path d="M85.5 303.68 A32.1511 32.1511 -180 0 0 85.5 333.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="27.48" y="315.81" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog<tspan x="29.18" y="327.8100384" font-size="1em">Device</tspan>
                </text>
              </g>
              <g transform="translate(30,-195.49)">
                <title>Database.8</title>
                <desc>Catalog Contact</desc>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68 
  Z" fill="#ffffff"></path>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <path d="M85.5 303.68 A32.1511 32.1511 -180 0 0 85.5 333.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="27.48" y="315.81" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog<tspan x="26.96" y="327.8100384" font-size="1em">Contact</tspan>
                </text>
              </g>
              <g transform="translate(131.25,-156.62)">
                <title>Database.9</title>
                <desc>Catalog Application</desc>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68 
  Z" fill="#ffffff"></path>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <path d="M85.5 303.68 A32.1511 32.1511 -180 0 0 85.5 333.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="27.48" y="315.81" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog<tspan x="19.71" y="327.8100384" font-size="1em">Application</tspan>
                </text>
              </g>
              <g transform="translate(30,-156.62)">
                <title>Database.10</title>
                <desc>Catalog Credential</desc>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68 
  Z" fill="#ffffff"></path>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <path d="M85.5 303.68 A32.1511 32.1511 -180 0 0 85.5 333.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="27.48" y="315.81" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog<tspan x="21.75" y="327.8100384" font-size="1em">Credential</tspan>
                </text>
              </g>
              <g transform="translate(234.75,-195.49)">
                <title>Database.11</title>
                <desc>Catalog Bookmark</desc>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68 
  Z" fill="#ffffff"></path>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <path d="M85.5 303.68 A32.1511 32.1511 -180 0 0 85.5 333.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="27.48" y="315.81" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog<tspan x="22.08" y="327.8100384" font-size="1em">Bookmark</tspan>
                </text>
              </g>
              <g transform="translate(131.25,-195.49)">
                <title>Database.12</title>
                <desc>Catalog Calendar</desc>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68 
  Z" fill="#ffffff"></path>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <path d="M85.5 303.68 A32.1511 32.1511 -180 0 0 85.5 333.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="27.48" y="315.81" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog<tspan x="24.66" y="327.8100384" font-size="1em">Calendar</tspan>
                </text>
              </g>
              <g transform="translate(234.75,-156.62)">
                <title>Database.13</title>
                <desc>Catalog Network</desc>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68 
  Z" fill="#ffffff"></path>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <path d="M85.5 303.68 A32.1511 32.1511 -180 0 0 85.5 333.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="27.48" y="315.81" fill="#000000" font-family="sans-serif" font-size="0.833336em">Catalog<tspan x="25.13" y="327.8100384" font-size="1em">Network</tspan>
                </text>
              </g>
              <g transform="translate(27.75,-261.75)">
                <title>Database.14</title>
                <desc>Spool Inbound</desc>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68 
  Z" fill="#ffffff"></path>
                <path d="M3.78 303.68 L85.5 303.68 A32.1511 32.1511 0 0 1 85.5 333.94 L3.78 333.94 A32.1511 32.1511 0 0 1 3.78 303.68" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <path d="M85.5 303.68 A32.1511 32.1511 -180 0 0 85.5 333.94" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                <text x="13.24" y="321.81" fill="#000000" font-family="sans-serif" font-size="0.833336em">Spool Inbound</text>
              </g>
            </g>
          </svg>
        </div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a></figcaption></figure>
<div id="n-creating-a-mesh-profile-and-administration-device">
<section id="section-5.1">
        <h3 id="name-creating-a-mesh-profile-and">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-creating-a-mesh-profile-and" class="section-name selfRef">Creating a Mesh Profile and Administration Device.</a>
        </h3>
<p id="section-5.1-1">The first step in using the Mesh is to create a personal profile. From the user's point of view a profile is a collection of all the configuration data for all the Mesh enabled devices and services that they interact with.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<div id="section-5.1-2">
<pre class="sourcecode">Alice&gt; mesh create
Device Profile UDF=MAKJ-PBFP-LU5T-5Z34-YITA-PHYT-F5QS
Personal Profile UDF=MDKD-XTUR-GFP4-QD52-STNB-Q7GS-MEWW
</pre><a href="#section-5.1-2" class="pilcrow">¶</a>
</div>
<p id="section-5.1-3">Note that the user does not specify the cryptographic algorithms to use. Choice of cryptographic algorithm is primarily the concern of the protocol designer, not the user. The only circumstance in which users would normally be involved in algorithm selection is when there is a transition in progress from one algorithm suite to another.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-mesh-accounts">
<section id="section-5.2">
        <h3 id="name-mesh-accounts">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-mesh-accounts" class="section-name selfRef">Mesh Accounts</a>
        </h3>
<p id="section-5.2-1">Add an account to the personal Mesh:<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<div id="section-5.2-2">
<pre class="sourcecode">Alice&gt; account create personal
Account=MBAL-44YZ-X4GX-USBL-JAMU-AW32-SLBQ
</pre><a href="#section-5.2-2" class="pilcrow">¶</a>
</div>
<p id="section-5.2-3">A Mesh Catalog contains a set of entries, each of which has a unique object identifier. Catalog entries may be added, updated or deleted.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">By default, all catalog entries are encrypted. Applying the Default Deny principle, in normal circumstances, the Mesh Service is not capable of decrypting any catalog excepting the Contacts catalog which is used as a source of authorization data in the Access Control applied to inbound messaging requests.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">For example, the entries in the credentials catalog specify username and password credentials used to access Internet services. Adding credentials to her catalog allows Alice to write scripts that access password protected resources without including the passwords in the scripts themselves:<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<div id="section-5.2-6">
<pre class="sourcecode">Alice&gt; password add ftp.example.com alice1 password
alice1@ftp.example.com = [password]
Alice&gt; password add www.example.com alice@example.com newpassword
alice@example.com@www.example.com = [newpassword]
Alice&gt; password list
alice1@ftp.example.com = [password]
alice@example.com@www.example.com = [newpassword]
Alice&gt; password add ftp.example.com alice1 newpassword
alice1@ftp.example.com = [newpassword]
Alice&gt; password get ftp.example.com
alice1@ftp.example.com = [newpassword]
</pre><a href="#section-5.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n-using-a-mesh-service">
<section id="section-5.3">
        <h3 id="name-using-a-mesh-service">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-using-a-mesh-service" class="section-name selfRef">Using a Mesh Service</a>
        </h3>
<p id="section-5.3-1">A Mesh Service provides an 'always available' point of presence that is used to exchange data between devices connected to the connected profile and send and receive Mesh Messages to and from other Mesh users.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">To use a Mesh Service, a user creates a Mesh Service account. This is analogous to an SMTP email service but with the important distinction that the protocol is designed to allow users to change their Mesh Service provider at any time they choose with minimal impact.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">The account is created by sending an account registration request to the chosen Mesh Service. If accepted, the Mesh Service creates a new account and creates containers to hold the associated catalogs and spools:<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<div id="section-5.3-4">
<pre class="sourcecode">Alice&gt; account register alice@example.com
Account=MBAL-44YZ-X4GX-USBL-JAMU-AW32-SLBQ
</pre><a href="#section-5.3-4" class="pilcrow">¶</a>
</div>
<p id="section-5.3-5">As with any other Internet service provision, Mesh Service providers may impose constraints on the use of their service such as the amount of data they send, store and receive and charge a fee for their service.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-connecting-and-authorizing-additional-devices">
<section id="section-5.4">
        <h3 id="name-connecting-and-authorizing-">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-connecting-and-authorizing-" class="section-name selfRef">Connecting and Authorizing Additional Devices</a>
        </h3>
<p id="section-5.4-1">Having established a Mesh profile, a user may connect any number of devices to it. Connecting a device to a Mesh profile allows it to share data with, control and be controlled by other devices connected to the profile.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">Although any type of network capable device may be connected to a Mesh profile, some devices are better suited for use with certain applications than others. Connecting an oven to a Mesh profile could allow it to be controlled through entries to the user's recipe and calendar catalogs and alert the user when the meal is ready but attempting to use it to read emails or manage Mesh profiles.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">Three connection mechanisms are currently specified, each of which provides strong mutual authentication: Direct, PIN and QR.<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<p id="section-5.4-4">Since approval of a connection request requires the creation of a signed Connection Assertion, requests must be approved by a device that has access to an administration key authorized by the user's Master Profile. Such devices are referred to as Administration devices. Administration devices must have data entry (e.g. keyboard) and output (e.g. display) affordances to support any of the currently defined connection mechanisms. The QR code connection mechanism also requires a suitable camera.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
<p id="section-5.4-5">It will be noted that the process of connecting a device that contains a preconfigured set of device keys might in principle expose the user to the risk that the manufacturer has retained knowledge of these keys and that this might be used to create a 'backdoor'.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
<p id="section-5.4-6">This risk is controlled using the key co-generation technique described earlier. The original device profile is combined with a device profile provided by the user to create a composite device profile. This ensures that every device uses a unique profile even if they are initialized from a shared firmware image containing a fixed set of device key pairs.<a href="#section-5.4-6" class="pilcrow">¶</a></p>
<div id="n-direct-connection">
<section id="section-5.4.1">
          <h4 id="name-direct-connection">
<a href="#section-5.4.1" class="section-number selfRef">5.4.1. </a><a href="#name-direct-connection" class="section-name selfRef">Direct Connection</a>
          </h4>
<p id="section-5.4.1-1">The direct connection mechanism requires that both the administration device and the device originating the connection request have data entry and output affordances and that it is possible for the user to compare the authentication codes presented by the two devices to check that they are identical.<a href="#section-5.4.1-1" class="pilcrow">¶</a></p>
<p id="section-5.4.1-2">The connection request is initiated on the device being connected:<a href="#section-5.4.1-2" class="pilcrow">¶</a></p>
<div id="section-5.4.1-3">
<pre class="sourcecode">Alice2&gt; device request alice@example.com
   Witness value = M4J5-YPNB-2O3U-35FZ-PC6G-SP6R-4LBD
   Personal Mesh = MDKD-XTUR-GFP4-QD52-STNB-Q7GS-MEWW
</pre><a href="#section-5.4.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.4.1-4">Using her administration device, Alice gets a list of pending requests. Seeing that there is a pending request matching the witness value presented by the device, Alice accepts it:<a href="#section-5.4.1-4" class="pilcrow">¶</a></p>
<div id="section-5.4.1-5">
<pre class="sourcecode">Alice&gt; device pending
Alice&gt; device accept NCGP-WWTX-4HDR-YR2I-N5DO-TYBJ-C4X7
</pre><a href="#section-5.4.1-5" class="pilcrow">¶</a>
</div>
<p id="section-5.4.1-6">The new device will now synchronize automatically in response to any Mesh commands. For example,  listing the password catalog:<a href="#section-5.4.1-6" class="pilcrow">¶</a></p>
<div id="section-5.4.1-7">
<pre class="sourcecode">Alice2&gt; password list
ERROR - Object reference not set to an instance of an object.
</pre><a href="#section-5.4.1-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n-pin-connection">
<section id="section-5.4.2">
          <h4 id="name-pin-connection">
<a href="#section-5.4.2" class="section-number selfRef">5.4.2. </a><a href="#name-pin-connection" class="section-name selfRef">Pin Connection</a>
          </h4>
<p id="section-5.4.2-1">The PIN Connection mechanism is similar to the Direct connection mechanism except that the process is initiated on an administration device by requesting assignment of a new authentication PIN. The PIN is then input to the connecting device to authenticate the request.<a href="#section-5.4.2-1" class="pilcrow">¶</a></p>
<p id="section-5.4.2-2">The PIN connection mechanism begins with the issue of the PIN:<a href="#section-5.4.2-2" class="pilcrow">¶</a></p>
<div id="section-5.4.2-3">
<pre class="sourcecode">Alice&gt; account pin
PIN=NCGD-ZOQL-JRVF-TALA-EY (Expires=2020-01-23T01:18:57Z)
</pre><a href="#section-5.4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-5.4.2-4">The PIN code is transmitted out of band to the device being connected:<a href="#section-5.4.2-4" class="pilcrow">¶</a></p>
<div id="section-5.4.2-5">
<pre class="sourcecode">Alice3&gt; device request alice@example.com /pin=NCGD-ZOQL-JRVF-TALA-EY
   Witness value = XNLM-MOF2-KNZS-3HCO-WOEO-BOTN-Y6G2
   Personal Mesh = MDKD-XTUR-GFP4-QD52-STNB-Q7GS-MEWW
</pre><a href="#section-5.4.2-5" class="pilcrow">¶</a>
</div>
<p id="section-5.4.2-6">Since the request was pre-authorized, it is not necessary for Alice to explicitly accept the connection request but the administration device is needed to create the connection assertion:<a href="#section-5.4.2-6" class="pilcrow">¶</a></p>
<div id="section-5.4.2-7">
<pre class="sourcecode">Alice&gt; device pending
</pre><a href="#section-5.4.2-7" class="pilcrow">¶</a>
</div>
<p id="section-5.4.2-8">We can check the device connection by attempting to synchronize to the profile account:<a href="#section-5.4.2-8" class="pilcrow">¶</a></p>
<div id="section-5.4.2-9">
<pre class="sourcecode">Alice3&gt; account sync
ERROR - Object reference not set to an instance of an object.
</pre><a href="#section-5.4.2-9" class="pilcrow">¶</a>
</div>
<p id="section-5.4.2-10">Note that this connection mechanism could be adapted to allow a device with a  camera affordance to connect by scanning a QR code on the administration device.<a href="#section-5.4.2-10" class="pilcrow">¶</a></p>
<p id="section-5.4.2-11">If the Device Profile fingerprint is known at the time the PIN is generated, this can be bound to the PIN authorization assertion to permit connection of a specific device.<a href="#section-5.4.2-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-earlqr-code-connection">
<section id="section-5.4.3">
          <h4 id="name-earl-qr-code-connection">
<a href="#section-5.4.3" class="section-number selfRef">5.4.3. </a><a href="#name-earl-qr-code-connection" class="section-name selfRef">EARL/QR Code Connection</a>
          </h4>
<p id="section-5.4.3-1">The EARL/QR code connection mechanisms are used to connect a constrained device to a Mesh profile by means of an Encrypted Authenticated Resource Locator, typically presented as a QR code on the device itself or its packaging.<a href="#section-5.4.3-1" class="pilcrow">¶</a></p>
<p id="section-5.4.3-2">Since the meshman tool does not support QR input, it is decoded using a separate tool to recover the UDF EARL which is presented as a command line parameter:<a href="#section-5.4.3-2" class="pilcrow">¶</a></p>
<p id="section-5.4.3-3">To use the device QR code connection mechanism, we require a Web service that will host the connection document example.com and a MeshService account that the device will attempt to  complete the connection by requesting synchronization devices@example.com.<a href="#section-5.4.3-3" class="pilcrow">¶</a></p>
<p id="section-5.4.3-4">To begin the process we generate a new random key and combine it with the service to create an EARL:<a href="#section-5.4.3-4" class="pilcrow">¶</a></p>
<div id="section-5.4.3-5">
<pre class="sourcecode">udf://example.com/ECQ4-KEU2-LRMG-UUUP-FGJ2-SZTP-WF4V-XE</pre><a href="#section-5.4.3-5" class="pilcrow">¶</a>
</div>
<p id="section-5.4.3-6">Next a device profile is created and preregistered on with the Mesh Service that will provide the hailing service. Since we are only preparing one device it is convenient to do this on the device itself. In a manufacturing scenario, these steps would typically  be performed offline in bulk.<a href="#section-5.4.3-6" class="pilcrow">¶</a></p>
<div id="section-5.4.3-7">
<pre class="sourcecode">Alice4&gt; device pre devices@example.com /key=udf://example.com/ECQ4-KE
    U2-LRMG-UUUP-FGJ2-SZTP-WF4V-XE
ERROR - Object reference not set to an instance of an object.
</pre><a href="#section-5.4.3-7" class="pilcrow">¶</a>
</div>
<p id="section-5.4.3-8">Once initialized the device attempts to poll the service for a connection each time it is powered on, when a connection button affordance on the device is pressed or at other times as agreed with the Mesh Service Provider:<a href="#section-5.4.3-8" class="pilcrow">¶</a></p>
<div id="section-5.4.3-9">
<pre class="sourcecode">Alice4&gt; account sync
ERROR - Object reference not set to an instance of an object.
</pre><a href="#section-5.4.3-9" class="pilcrow">¶</a>
</div>
<p id="section-5.4.3-10">To connect the device to her profile, Alice scans the device with her administration  device to obtain the UDF. The administration device retrieves the connection description,  decrypts it and then uses the information in the description to create the necessary Device Connection Assertion and connect to the device hailing Mesh Service Account to  complete the process:<a href="#section-5.4.3-10" class="pilcrow">¶</a></p>
<div id="section-5.4.3-11">
<pre class="sourcecode">Alice&gt; device earl udf://example.com/ECQ4-KEU2-LRMG-UUUP-FGJ2-SZTP-WF
    4V-XE
ERROR - Object reference not set to an instance of an object.
</pre><a href="#section-5.4.3-11" class="pilcrow">¶</a>
</div>
<p id="section-5.4.3-12">When the device next attempts to connect to the hailing service, it receives the Device  Connection Assertion:<a href="#section-5.4.3-12" class="pilcrow">¶</a></p>
<div id="section-5.4.3-13">
<pre class="sourcecode">Alice4&gt; account sync
ERROR - Object reference not set to an instance of an object.
</pre><a href="#section-5.4.3-13" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="n-contact-requests">
<section id="section-5.5">
        <h3 id="name-contact-requests">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-contact-requests" class="section-name selfRef">Contact Requests</a>
        </h3>
<p id="section-5.5-1">As previously stated, every inbound Mesh message is subject to access control. The user's contact catalog is used as part of the access control authentication and authorization mechanism.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5-2">By default, the only form of inbound message that is accepted without authorization in the contact catalog is a contact request. Though for certain Mesh users (e.g. politicians, celebrities) even contact requests might require some form of prior approval (e.g. endorsement by a mutual friend).<a href="#section-5.5-2" class="pilcrow">¶</a></p>
<p id="section-5.5-3">A Mesh Contact Assertion may be limited to stating the user's profile fingerprint and Mesh Service Account(s). For most purposes however, it is more convenient to present a Contact Assertion that contains at least as much information as is typically provided on a business or calling card:<a href="#section-5.5-3" class="pilcrow">¶</a></p>
<p id="section-5.5-4">Alice creates a contact entry for herself:<a href="#section-5.5-4" class="pilcrow">¶</a></p>
<div id="section-5.5-5">
<pre class="sourcecode">Alice&gt; contact self email alice@example.com
{
  "Self": true,
  "Key": "NAB7-U4XN-VGYE-5JUS-SVXK-AGPN-VSEZ",
  "EnvelopedContact": [{},
    "ewogICJDb250YWN0IjogewogICAgIkFkZHJlc3Nlcy
  I6IFt7CiAgICAgICAgIlVSSSI6ICJtYWlsdG86e2VtYWlsfSJ9XX19"]}</pre><a href="#section-5.5-5" class="pilcrow">¶</a>
</div>
<p id="section-5.5-6">User's may create multiple Contact Assertions for use in different circumstances. A user might not want to give their home address to a business contact or their business address to a personal friend.<a href="#section-5.5-6" class="pilcrow">¶</a></p>
<div id="n-remote">
<section id="section-5.5.1">
          <h4 id="name-remote">
<a href="#section-5.5.1" class="section-number selfRef">5.5.1. </a><a href="#name-remote" class="section-name selfRef">Remote</a>
          </h4>
<p id="section-5.5.1-1">In the most general case, the participants are remote from each other and one user must make a contact request of the other:<a href="#section-5.5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.5.1-2">Bob requests Alice add him to her contacts catalog:<a href="#section-5.5.1-2" class="pilcrow">¶</a></p>
<div id="section-5.5.1-3">
<pre class="sourcecode">Bob&gt; message contact alice@example.com
</pre><a href="#section-5.5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-5.5.1-4">When Alice next checks her messages, she sees the pending contact request from Bob and accepts it. Bob's contact details are added to her catalog and Bob receives a response containing Alice's credentials:<a href="#section-5.5.1-4" class="pilcrow">¶</a></p>
<div id="section-5.5.1-5">
<pre class="sourcecode">Alice&gt; message pending
Alice&gt; message accept tbs
</pre><a href="#section-5.5.1-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n-static-qr-code">
<section id="section-5.5.2">
          <h4 id="name-static-qr-code">
<a href="#section-5.5.2" class="section-number selfRef">5.5.2. </a><a href="#name-static-qr-code" class="section-name selfRef">Static QR Code</a>
          </h4>
<p id="section-5.5.2-1">A DARE contact entry may be exchanged by means of an EARL UDF. This is typically presented by means of a QR code which may be created using the <code>meshman</code> tool and a QR code generator. The resulting QR code may be printed on a business card, laser engraved on a luggage tag, etc.<a href="#section-5.5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.5.2-2">To accept the contact request, the recipient merely scans the code with a Mesh capable QR code reader. They are asked if they wish to accept the contact request and what privileges they wish to authorize for the new contact.<a href="#section-5.5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-dynamic-qr-code">
<section id="section-5.5.3">
          <h4 id="name-dynamic-qr-code">
<a href="#section-5.5.3" class="section-number selfRef">5.5.3. </a><a href="#name-dynamic-qr-code" class="section-name selfRef">Dynamic QR Code</a>
          </h4>
<p id="section-5.5.3-1">If it is possible for the device to generate a new QR code for the contact request, it is possible to support bi-directional exchange of credentials with strong mutual authentication.<a href="#section-5.5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.5.3-2">For example, Alice selects the contact credential she wishes to pass to Bob on her mobile device which presents an EARL as a QR code. Bob scans the QR code with his mobile device which retrieves Alice's credential and asks if Bob wishes to accept it and if he wishes to share his credential with Alice. If Bob agrees, his device makes a Remote Contact request authenticated under a key passed to his device with Alice's Contact Assertion.<a href="#section-5.5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.5.3-3">The Dynamic QR Code protocol may be applied to support exchange of credentials between larger groups. Enrolling the contact assertions collected in such circumstances in a notarized append only log (e.g. a DARE Container) provides a powerful basis for building a Web of Trust that is equivalent to but considerably more convenient than participation in PGP Key Signing parties.<a href="#section-5.5.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-sharing-confidential-data-in-the-cloud">
<section id="section-5.6">
        <h3 id="name-sharing-confidential-data-i">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-sharing-confidential-data-i" class="section-name selfRef">Sharing Confidential Data in the Cloud</a>
        </h3>
<p id="section-5.6-1">As previously discussed, the Mesh makes use of multi-party encryption techniques to mitigate the risk of a device compromise leading to disclosure of confidential data. The Mesh also allows these techniques to be applied to provide Confidential Document Control. This provides data encryption capabilities that are particularly suited to 'cloud computing' environments.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">A Mesh Encryption Group is a special type of Mesh Service Account that is controlled by one of more group administrators. The Encryption Group Key is a normal ECDH public key used in the normal manner. The decryption key is held by the group administrator. To add a user to the group, the administrator splits the group private key into two parts, a service key and a user key. These parts are encrypted under the public encryption keys of their assigned parties. The encrypted key parts form a decryption entry for the user is added to the Members Catalog of the Encryption Group at the Mesh Service.<a href="#section-5.6-2" class="pilcrow">¶</a></p>
<figure id="figure-18">
          <div class="artwork art-svg alignLeft" id="section-5.6-3.1">
<svg xmlns="http://www.w3.org/2000/svg" width="5.02083in" height="4.89583in" viewBox="0 0 361.5 352.5" fill="none" fill-rule="evenodd" font-size="12px" stroke-linecap="square">
              <defs>
                <g>
                  <path d="M 2 1 L 0 0 L 2 -1 L 2 1"></path>
                </g>
              </defs>
              <g>
                <title>Recryption</title>
                <g transform="translate(54.75,-180.75)">
                  <title>Sheet.10</title>
                  <desc>Service (Group W)</desc>
                  <rect x="0" y="199.5" width="126" height="153" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="48.46" y="212.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Service<tspan x="41.6" y="224.5000384" font-size="1em">(</tspan>
                    <tspan>Group W)</tspan>
                  </text>
                </g>
                <g transform="translate(63.75,-262.312)">
                  <title>Sheet.7</title>
                  <desc>Bob Decrypt Wx</desc>
                  <rect x="0" y="317.063" width="108" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                  <text x="21.16" y="337.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Bob Decrypt W<tspan font-size="1em" font-style="italic">x</tspan>
                  </text>
                </g>
                <g transform="translate(18.75,-18.75)">
                  <title>Sheet.3</title>
                  <g>
                    <title>Sheet.1</title>
                    <desc>Alice (Owner group W)</desc>
                    <rect x="0" y="271.5" width="108" height="81" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="44.21" y="284.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Alice<tspan x="18.53" y="296.5000384" font-size="1em">(</tspan>
                      <tspan>Owner group W)</tspan>
                    </text>
                  </g>
                  <g transform="translate(9,-9.5625)">
                    <title>Sheet.2</title>
                    <desc>Private w</desc>
                    <rect x="0" y="317.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="26.01" y="337.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Private <tspan font-size="1em" font-style="italic">w</tspan>
                    </text>
                  </g>
                </g>
                <g transform="translate(234.75,-162.75)">
                  <title>Sheet.4</title>
                  <g>
                    <title>Sheet.9</title>
                    <desc>Bob (Member group W)</desc>
                    <rect x="0" y="271.5" width="108" height="81" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="46.02" y="284.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Bob<tspan x="14.66" y="296.5000384" font-size="1em">(</tspan>
                      <tspan>Member group W)</tspan>
                    </text>
                  </g>
                  <g transform="translate(9,-9)">
                    <title>Sheet.8</title>
                    <desc>Private b</desc>
                    <rect x="0" y="317.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="27.01" y="337.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Private<tspan font-size="1em" font-style="italic"></tspan>
                      <tspan font-size="1em" font-style="italic">b</tspan>
                    </text>
                  </g>
                </g>
                <g transform="translate(-252.661,141.28) rotate(-71.5651)">
                  <title>Sheet.5</title>
                  <path d="M0 352.5 L78.84 352.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(-14.5051,394.005) rotate(-135)">
                  <title>Sheet.12</title>
                  <path d="M0 352.5 L69.83 352.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
                <g transform="translate(63.75,-189.75)">
                  <title>Sheet.13</title>
                  <g>
                    <title>Sheet.11</title>
                    <desc>Encrypt Bob B</desc>
                    <rect x="0" y="289.5" width="108" height="63" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="25.55" y="302.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encrypt Bob B</text>
                  </g>
                  <g transform="translate(9,-9)">
                    <title>Sheet.6</title>
                    <desc>Bob Decrypt Wy</desc>
                    <rect x="0" y="317.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="12.08" y="337.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Bob Decrypt<tspan font-size="1em" font-style="italic"></tspan>
                      <tspan>W</tspan>
                      <tspan font-size="1em" font-style="italic">y</tspan>
                    </text>
                  </g>
                </g>
                <g transform="translate(234.75,-54.75)">
                  <title>Sheet.14</title>
                  <g>
                    <title>Sheet.15</title>
                    <desc>Encrypt Group W</desc>
                    <rect x="0" y="289.5" width="108" height="63" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="19.01" y="302.5" fill="#000000" font-family="sans-serif" font-size="0.833336em">Encrypt Group W</text>
                  </g>
                  <g transform="translate(9,-9)">
                    <title>Sheet.16</title>
                    <desc>Top Secret Document</desc>
                    <rect x="0" y="317.063" width="90" height="35.4375" fill="#ffffff" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></rect>
                    <text x="23.36" y="331.78" fill="#000000" font-family="sans-serif" font-size="0.833336em">Top Secret <tspan x="23.76" y="343.7800384" font-size="1em">Document</tspan>
                    </text>
                  </g>
                </g>
                <g transform="translate(-63.75,234.75) rotate(-90)">
                  <title>Sheet.17</title>
                  <path d="M0 352.5 L38.46 352.5" stroke="#000000" stroke-linecap="round" stroke-linejoin="round" stroke-width="0.75"></path>
                </g>
              </g>
            </svg>
          </div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a></figcaption></figure>
<p id="section-5.6-4">When a user needs to decrypt a document encrypted under the group key, they make a request to the Mesh Service which checks to see that they are authorized to read that particular document, have not exceeded their decryption quota, etc. If the request is approved, the service returns the partial decryption result obtained from the service's key part together with the encrypted user key part. To complete the decryption process, the user decrypts their key part and uses it to create a second partial decryption result which is combined with the first to obtain the key agreement value needed to complete the decryption process.<a href="#section-5.6-4" class="pilcrow">¶</a></p>
<p id="section-5.6-5">Alice creates the recryption group groupw@example.com to share confidential information with her closest friends:<a href="#section-5.6-5" class="pilcrow">¶</a></p>
<div id="section-5.6-6">
<pre class="sourcecode">Alice&gt; group create groupw@example.com
{
  "Profile": {
    "KeyOfflineSignature": {
      "UDF": "MCJ5-HMK2-SUBS-MOCG-J5IS-S2GT-IY7D",
      "PublicParameters": {
        "PublicKeyECDH": {
          "crv": "Ed448",
          "Public": "bNfUzYfsJJthhioeCukz03BQ9wJWD-2i_0GoDznzdhqEu8eE
              9iVo
  VAJDOF2gDnMxvkfnBsJk55GA"}}},
    "KeyEncryption": {
      "UDF": "MC25-LCSY-DUTQ-YBUL-XXCI-RLIZ-JHIL",
      "PublicParameters": {
        "PublicKeyECDH": {
          "crv": "Ed448",
          "Public": "sx8WWkgH6k4u8RchFZitCRTvncvWje1xog-cyx4kka9kwmFw
              lDTi
  t2JXFFalq-LJ-RQlu9eIuP-A"}}}}}</pre><a href="#section-5.6-6" class="pilcrow">¶</a>
</div>
<p id="section-5.6-7">Bob encrypts a test file but he can't decrypt it because he isn't in the group:<a href="#section-5.6-7" class="pilcrow">¶</a></p>
<div id="section-5.6-8">
<pre class="sourcecode">Bob&gt; dare encodeTestFile1.txt /out=TestFile1-group.dare /encrypt=grou
    pw@example.com
ERROR - The command  is not known.
Bob&gt; dare decode  TestFile1-group.dare
ERROR - Could not find file 'C:\Users\hallam\Test\WorkingDirectory\Te
    stFile1-group.dare'.
</pre><a href="#section-5.6-8" class="pilcrow">¶</a>
</div>
<p id="section-5.6-9">Since she is the group administrator, Alice can decrypt the test file using the group decryption key:<a href="#section-5.6-9" class="pilcrow">¶</a></p>
<div id="section-5.6-10">
<pre class="sourcecode">Alice&gt; dare decode  TestFile1-group.dare
ERROR - Could not find file 'C:\Users\hallam\Test\WorkingDirectory\Te
    stFile1-group.dare'.
</pre><a href="#section-5.6-10" class="pilcrow">¶</a>
</div>
<p id="section-5.6-11">Adding Bob to the group gives him immediate access to any file encrypted under the group key without making any change to the encrypted files:<a href="#section-5.6-11" class="pilcrow">¶</a></p>
<div id="section-5.6-12">
<pre class="sourcecode">Alice&gt; dare decode  TestFile1-group.dare
ERROR - Could not find file 'C:\Users\hallam\Test\WorkingDirectory\Te
    stFile1-group.dare'.
</pre><a href="#section-5.6-12" class="pilcrow">¶</a>
</div>
<p id="section-5.6-13">Removing Bob from the group immediately withdraws his access.<a href="#section-5.6-13" class="pilcrow">¶</a></p>
<div id="section-5.6-14">
<pre class="sourcecode">Alice&gt; group delete groupw@example.com bob@example.com
ERROR - The feature has not been implemented
</pre><a href="#section-5.6-14" class="pilcrow">¶</a>
</div>
<p id="section-5.6-15">Bob cannot decrypt any more files (but he may have kept copies of files he decrypted  earlier).<a href="#section-5.6-15" class="pilcrow">¶</a></p>
<div id="section-5.6-16">
<pre class="sourcecode">Alice&gt; dare decode  TestFile1-group.dare
ERROR - Could not find file 'C:\Users\hallam\Test\WorkingDirectory\Te
    stFile1-group.dare'.
</pre><a href="#section-5.6-16" class="pilcrow">¶</a>
</div>
<p id="section-5.6-17">Should requirements demand, the same principle may be applied to achieve separation of duties in the administration roles. Instead of provisioning the group private key to a single administrator, it may be split into two or more parts. Adding a user to the group requires each of the administrators to create a decryption entry for the user and for the service and user to apply the appropriate operations to combine the key parts available to them before use.<a href="#section-5.6-17" class="pilcrow">¶</a></p>
<p id="section-5.6-18">These techniques could even be extended to support complex authorization requirements such as the need for 2 out of 3 administrators to approve membership of the group. A set of decryption entries is complete if the sum of the key parts is equal to the private key (modulo the order of the curve).<a href="#section-5.6-18" class="pilcrow">¶</a></p>
<p id="section-5.6-19">Thus, if the set of administrators is A, B and C and the private key is <em>k</em>, we can ensure that it requires exactly two administrators to create a complete set of decryption entries by issuing key set { <em>a</em> } to A, the key set {<em>k-a</em> , <em>b</em> } to B and the key set {<em>k-a</em> , <em>k-b</em> } to C (where <em>a</em> and <em>b</em> are randomly generated keys).<a href="#section-5.6-19" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-escrow-and-recovery-of-keys">
<section id="section-5.7">
        <h3 id="name-escrow-and-recovery-of-keys">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-escrow-and-recovery-of-keys" class="section-name selfRef">Escrow and Recovery of Keys</a>
        </h3>
<p id="section-5.7-1">One of the chief objections made against deployment of Data Level encryption is that although it provides the strongest possible protection of the confidentiality of the data, loss of the decryption keys means loss of the encrypted data. Thus, a robust and effective key escrow mechanism is essential if use of encryption is to ever become commonplace for stored data.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">The use of a 'life-long' Mesh profiles raises a similar concern. Loss of a Master Signature Key potentially means the loss of the ability to control devices connected to the profile and the accumulated trust endorsements of other users.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
<p id="section-5.7-3">Because of these requirements, Mesh users are strongly advised but not required to create a backup copy of the private keys corresponding to their Master Profile Signature and Escrow keys.<a href="#section-5.7-3" class="pilcrow">¶</a></p>
<p id="section-5.7-4">Users may use the key escrow mechanism of their choice including the escrow mechanism supported by the Mesh itself which uses Shamir Secret Sharing to escrow the encryption key for a DARE Envelope containing the private key information.<a href="#section-5.7-4" class="pilcrow">¶</a></p>
<p id="section-5.7-5">To escrow a key set, the user specifies the number of key shares to be created and the number required for recovery.<a href="#section-5.7-5" class="pilcrow">¶</a></p>
<div id="section-5.7-6">
<pre class="sourcecode">Alice&gt; mesh escrow
Share: SAQE-Y4MW-BH55-ZL57-4XFP-PQVZ-VLHT-U7C3-X2BA-ZOCW-75EE-KZZM-3K
    SQ-E47T-O26A-I
Share: SAQZ-QGZL-CPK4-DXZN-EOWK-2AAO-DS76-6JV2-ZXUB-YSVJ-TJKK-ONXT-CD
    VB-S633-ZANC-M
Share: SARO-HRGA-DWX2-ODU2-MGHG-EPLC-R2YK-HUIZ-3VHC-XXH4-GVQQ-SBVZ-I4
    XT-BAYE-DF4E-Q
</pre><a href="#section-5.7-6" class="pilcrow">¶</a>
</div>
<p id="section-5.7-7">Recovery of the key data requires the key recovery record and a quorum of the key shares:<a href="#section-5.7-7" class="pilcrow">¶</a></p>
<div id="section-5.7-8">
<pre class="sourcecode">Alice&gt; mesh recover $SAQE-Y4MW-BH55-ZL57-4XFP-PQVZ-VLHT-U7C3-X2BA-ZOC
    W-75EE-KZZM-3KSQ-E47T-O26A-I $SARO-HRGA-DWX2-ODU2-MGHG-EPLC-R2YK-
    HUIZ-3VHC-XXH4-GVQQ-SBVZ-I4XT-BAYE-DF4E-Q /verify
Device Profile UDF=MAZC-3DVD-LIWY-A6UV-XGWR-GSBA-62YB
Personal Profile UDF=MDKD-XTUR-GFP4-QD52-STNB-Q7GS-MEWW
</pre><a href="#section-5.7-8" class="pilcrow">¶</a>
</div>
<p id="section-5.7-9">Having recovered the Master Signature Key, the user can now create a new master profile authorizing a new administration device which can be used to authenticate access to the Mesh Service Account(s) connected to the master profile.<a href="#section-5.7-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-security-considerations">
<section id="section-6">
      <h2 id="name-security-considerations-3">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-security-considerations-3" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-6-1">The security considerations for use and implementation of Mesh services and applications are described in the Mesh Security Considerations guide <span><a href="#draft-hallambaker-mesh-security" class="xref">.</a> [<a href="#draft-hallambaker-mesh-security" class="xref">draft-hallambaker-mesh-security</a>]</span><a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-iana-considerations">
<section id="section-7">
      <h2 id="name-iana-considerations-3">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations-3" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document does not contain actions for IANA<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-acknowledgements">
<section id="section-8">
      <h2 id="name-acknowledgements">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-8-1">Comodo Group: Egemen Tas, Melhi Abdulhayo?lu, Rob Stradling, Robin Alden.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2"><a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-normative-references-3">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-normative-references-3" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="draft-hallambaker-jsonbcd">[draft-hallambaker-jsonbcd]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Binary Encodings for JavaScript Object Notation: JSON-B, JSON-C, JSON-D"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-jsonbcd-15</span>, <time datetime="2019-10-23">23 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-jsonbcd-15">https://tools.ietf.org/html/draft-hallambaker-jsonbcd-15</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-cryptography">[draft-hallambaker-mesh-cryptography]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part VIII: Cryptographic Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-cryptography-05</span>, <time datetime="2020-01-16">16 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-cryptography-05">https://tools.ietf.org/html/draft-hallambaker-mesh-cryptography-05</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-dare">[draft-hallambaker-mesh-dare]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part III : Data At Rest Encryption (DARE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-dare-06</span>, <time datetime="2020-01-16">16 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-dare-06">https://tools.ietf.org/html/draft-hallambaker-mesh-dare-06</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh: Reference Implementation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-developer-09</span>, <time datetime="2019-10-23">23 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-developer-09">https://tools.ietf.org/html/draft-hallambaker-mesh-developer-09</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-platform">[draft-hallambaker-mesh-platform]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh: Platform Configuration"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-platform-05</span>, <time datetime="2019-10-23">23 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-platform-05">https://tools.ietf.org/html/draft-hallambaker-mesh-platform-05</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-protocol">[draft-hallambaker-mesh-protocol]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part V: Protocol Reference"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-protocol-04</span>, <time datetime="2020-01-16">16 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-protocol-04">https://tools.ietf.org/html/draft-hallambaker-mesh-protocol-04</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-schema">[draft-hallambaker-mesh-schema]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part IV: Schema Reference"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-schema-05</span>, <time datetime="2020-01-16">16 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-schema-05">https://tools.ietf.org/html/draft-hallambaker-mesh-schema-05</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-security">[draft-hallambaker-mesh-security]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part VII: Security Considerations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-security-03</span>, <time datetime="2020-01-16">16 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-security-03">https://tools.ietf.org/html/draft-hallambaker-mesh-security-03</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-trust">[draft-hallambaker-mesh-trust]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part VI: The Trust Mesh"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-trust-04</span>, <time datetime="2020-01-16">16 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-trust-04">https://tools.ietf.org/html/draft-hallambaker-mesh-trust-04</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-mesh-udf">[draft-hallambaker-mesh-udf]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part II: Uniform Data Fingerprint."</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-udf-08</span>, <time datetime="2020-01-06">6 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-udf-08">https://tools.ietf.org/html/draft-hallambaker-mesh-udf-08</a>&gt;</span>. </dd>
<dt id="draft-hallambaker-web-service-discovery">[draft-hallambaker-web-service-discovery]</dt>
<dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"DNS Web Service Discovery"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-web-service-discovery-03</span>, <time datetime="2019-10-23">23 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-web-service-discovery-03">https://tools.ietf.org/html/draft-hallambaker-web-service-discovery-03</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC5246">[RFC5246]</dt>
<dd>
<span class="refAuthor">Dierks, T.</span><span class="refAuthor"> and E. Rescorla</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.2"</span>, <span class="seriesInfo">RFC 5246</span>, <span class="seriesInfo">DOI 10.17487/RFC5246</span>, <time datetime="2008-08">August 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5246">https://www.rfc-editor.org/rfc/rfc5246</a>&gt;</span>. </dd>
<dt id="RFC7159">[RFC7159]</dt>
<dd>
<span class="refAuthor">Bray, T.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">RFC 7159</span>, <span class="seriesInfo">DOI 10.17487/RFC7159</span>, <time datetime="2014-03">March 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7159">https://www.rfc-editor.org/rfc/rfc7159</a>&gt;</span>. </dd>
<dt id="RFC7231">[RFC7231]</dt>
<dd>
<span class="refAuthor">Fielding, R.</span><span class="refAuthor"> and J. Reschke</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7231">https://www.rfc-editor.org/rfc/rfc7231</a>&gt;</span>. </dd>
<dt id="RFC7515">[RFC7515]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7515">https://www.rfc-editor.org/rfc/rfc7515</a>&gt;</span>. </dd>
<dt id="RFC7516">[RFC7516]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor"> and J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7516">https://www.rfc-editor.org/rfc/rfc7516</a>&gt;</span>. </dd>
</dl>
</section>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
