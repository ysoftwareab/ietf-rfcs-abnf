x  = Random Variable (RV) denoting "time to failure" of a
t  = time

ENRP-message  =  Request | Response


ENRP-message  =     start-line
                            *message-header
                            CRLF
                            [ message-body ]


start-line       =  Request-Line |     ;Section 4.1
                            Status-Line        ;Section 5.1




message-header   =  Allow                ; Section 6.1
                            |  Expires              ; Section 6.8
                            |  NS-Parameter         ; Section 6.2
                            |  PE-Parameter         ; Refer ASAP Draft
                            |  Policy               ; Section 6.3
                            |  Periodic-Update      ; Section 6.4
                            |  Pool-Handle          ; Refer ASAP Draft
                            |  NS-ID                ; Section 6.5
                            |  Transaction-ID       ; Section 6.7
                            |  Server-Type          ; Section 6.6

                            |  WWW-Authenticate     ; Section 6.9.1
                            |  Authorization        ; Section 6.9.2
                            |  Authorization-Info   ; Section 6.9.3
                            |  Encryption           ; Section 6.9.4
                            |  Require              ; Section 6.9.5
                            |  Response-Key         ; Section 6.9.6


Request =   Request-Line
               *message-header
               CRLF
               [message-body]



Request-Line  =  Method SP Protocol-Version CRLF


Request-Line  =  Method SP ENRP-Version CRLF


Method  =  "NS-REGISTRATION" | "PE-DOWNLOAD" |
            |"NS-DOWNLOAD" |"HEARTBEAT" |"UPDATE"

Response  =  Status-Line
                     *message-header
                      CRLF
                     [ message-body ]


Status-Line  =  Protocol-version SP Status-Code SP Reason-
Status-Line  =  ENRP-version SP Status-Code SP Reason-
        Phrase CRLF

Status-Code     =  Success                 ;Fig. 3
                       |   Client-Error            ;Fig. 4
                       |   Server-Error            ;Fig. 5
                        |   extension-code
extension-code  =  3DIGIT
Reason-Phrase   =  *<TEXT-UTF8,  excluding CR, LF>


Success        =  "200"  ;  OK


Client-Error  =    "400"  ;  Bad Request
                     |   "401"  ;  Unauthorized
                     |   "403"  ;  Method Not Allowed
                     |   "404"  ;  Not Found
                     |   "409"  ;  Request Entity Too Large


Server-Error  =  "500"  ;  Internal Server Error
                     |   "501"  ;  Not Implemented
                     |   "503"  ;  ASAP/ENRP Version not supported


Allow   = ("Allow" | "l") ":" *("NS-REGISTRATION" |
            "NS-HEARTBEAT" |"UPDATE" | "NS-DOWNLOAD"|"PE-DOWNLOAD"|
             | quoted-string)


Allow= "NS-REGISTRATION" "PE-DOWNLOAD"

NS-Parameter = ( "NS-Parameter" | "e" ) ":"  NS-ID; Handle

NS-ID = ("NS-ID" | "i") ":" Digit
Handle = 1*("(" transport-addr ")" [*(";"contact-params )] [comment
transport-addr = IPv4|IPv6
IPv4 = digit "." digit "." digit "." digit *(":" port-number)
IPv6 = ( (digit ":" digit ":" digit ":" digit ":" digit ":" digit
             ":" digit ":" digit)
            |(":" digit ":" digit ":" digit ":" digit ":" digit ":"
              digit ":" digit)
            |(":" ":" digit ":" digit ":" digit ":" digit ":" digit ":"
              digit)
            |(":" ":" ":" digit ":" digit ":" digit ":" digit ":"
            digit))
          *(":" port-number)
port-number = digit
contact-params = "q"       "=" qvalue
                  | "Expires" "=" delta-seconds
                  | "Policy" "=" ("LRU"|"RR"|token)
comment = quoted-string



Policy   = ("Policy" | "p") ":" ("LRU"|"RR"|token)

Policy="RR"


Periodic-Update = ("Periodic-Update" | "u") ":" "Yes" ";"


Periodic-Update="Yes"


NS-ID = ("NS-ID" | "i") ":" Digit

NS-ID=2


Server-Type = ("Server-Type" | "r") ":" ("NS"|"PE")

Server-Type=NS

Transaction-ID = ("Transaction-ID" | "t") ":" UUID

Transaction-ID= "124F-AB12-874-2344-2344-1234-2345-9EDE"


Expires =("Expires" | "x") ":"  delta-seconds

Expires = 1000


WWW-Authenticate  = "WWW-Authenticate" ":" 1#challenge

challenge        =  "Digest" digest-challenge

digest-challenge  = 1#( realm | [ domain ] | nonce |
                          [ opaque ] |[ stale ] | [ algorithm ] |
                          [ qop-options ] | [auth-param] )

domain            = "domain" "=" <"> quoted-string <">
nonce             = "nonce" "=" nonce-value
nonce-value       = quoted-string
opaque            = "opaque" "=" quoted-string
stale             = "stale" "=" ( "true" | "false" )
algorithm         = "algorithm" "=" ( "MD5" | "MD5-sess" |
                           token )
qop-options       = "qop" "=" <"> 1#qop-value <">
qop-value         = "auth" | "auth-int" | token


Authorization  = "Authorization" ":" credentials

credentials      = "Digest" digest-response
digest-response  = 1#( username | realm | nonce
                       | response | [ algorithm ] | [cnonce] |
                       [opaque] | [message-qop] |
                           [nonce-count]  | [auth-param] )

username         = "username" "=" username-value
username-value   = quoted-string
message-qop      = "qop" "=" qop-value
cnonce           = "cnonce" "=" cnonce-value
cnonce-value     = nonce-value
nonce-count      = "nc" "=" nc-value
nc-value         = 8LHEX
response         = "response" "=" request-digest
request-digest = <"> 32LHEX <">
LHEX             =  "0" | "1" | "2" | "3" |
                           "4" | "5" | "6" | "7" |
                           "8" | "9" | "a" | "b" |
                           "c" | "d" | "e" | "f"


AuthenticationInfo = "Authentication-Info" ":" auth-info
auth-info          = 1#(nextnonce | [ message-qop ]
                               | [ response-auth ] | [ cnonce ]
                               | [nonce-count] )

nextnonce          = "nextnonce" "=" nonce-value
response-auth      = "rspauth" "=" response-digest
response-digest    = <"> *LHEX <">



Encryption         =  "Encryption" ":" encryption-scheme 1*SP
                              #encryption-params
encryption-scheme  =  token
encryption-params  =  generic-param


Require  =  "Require" ":" 1#option-tag

Response-Key  =  "Response-Key" ":" key-scheme 1*SP #key-param
key-scheme    =  token
key-param     =  generic-param




Transaction-ID=0xde34682a
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
Transaction-ID=0x34ae78d
