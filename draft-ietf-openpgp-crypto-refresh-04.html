<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>OpenPGP Message Format</title>
<meta content="Werner Koch" name="author">
<meta content="Paul Wouters" name="author">
<meta content="
       { Work in progress to update the OpenPGP specification from RFC4880 } 
       This document specifies the message formats used in OpenPGP.
OpenPGP provides encryption with public-key or symmetric cryptographic algorithms, digital signatures, compression and key management. 
       This document is maintained in order to publish all necessary information needed to develop interoperable applications based on the OpenPGP format.
It is not a step-by-step cookbook for writing an application.
It describes only the format and methods needed to read, check, generate, and write conforming packets crossing any network.
It does not deal with storage and implementation questions.
It does, however, discuss implementation issues necessary to avoid security flaws. 
    " name="description">
<meta content="xml2rfc 3.10.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-openpgp-crypto-refresh-04" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.10.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 58.2.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-openpgp-crypto-refresh-04-i7suhtqa.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">OpenPGP Message Format</td>
<td class="right">October 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Koch &amp; Wouters</td>
<td class="center">Expires 21 April 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-openpgp-crypto-refresh-04</dd>
<dt class="label-obsoletes">Obsoletes:</dt>
<dd class="obsoletes">
<a href="https://www.rfc-editor.org/rfc/rfc4880" class="eref">4880</a>, <a href="https://www.rfc-editor.org/rfc/rfc5581" class="eref">5581</a>, <a href="https://www.rfc-editor.org/rfc/rfc6637" class="eref">6637</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-10-18" class="published">18 October 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-04-21">21 April 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">W. Koch, <span class="editor">Ed.</span>
</div>
<div class="org">GnuPG e.V.</div>
</div>
<div class="author">
      <div class="author-name">P. Wouters, <span class="editor">Ed.</span>
</div>
<div class="org">Aiven</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">OpenPGP Message Format</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">{ Work in progress to update the OpenPGP specification from RFC4880 }<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This document specifies the message formats used in OpenPGP.
OpenPGP provides encryption with public-key or symmetric cryptographic algorithms, digital signatures, compression and key management.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">This document is maintained in order to publish all necessary information needed to develop interoperable applications based on the OpenPGP format.
It is not a step-by-step cookbook for writing an application.
It describes only the format and methods needed to read, check, generate, and write conforming packets crossing any network.
It does not deal with storage and implementation questions.
It does, however, discuss implementation issues necessary to avoid security flaws.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 April 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terms" class="xref">Terms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-general-functions" class="xref">General functions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-confidentiality-via-encrypt" class="xref">Confidentiality via Encryption</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-authentication-via-digital-" class="xref">Authentication via Digital Signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-compression" class="xref">Compression</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-conversion-to-radix-64" class="xref">Conversion to Radix-64</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-signature-only-applications" class="xref">Signature-Only Applications</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-data-element-formats" class="xref">Data Element Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-scalar-numbers" class="xref">Scalar Numbers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-multiprecision-integers" class="xref">Multiprecision Integers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-using-mpis-to-encode-other-" class="xref">Using MPIs to encode other data</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-key-ids" class="xref">Key IDs</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-text" class="xref">Text</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-time-fields" class="xref">Time Fields</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-keyrings" class="xref">Keyrings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-string-to-key-s2k-specifier" class="xref">String-to-Key (S2K) Specifiers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="xref">3.7.1</a>.  <a href="#name-string-to-key-s2k-specifier-" class="xref">String-to-Key (S2K) Specifier Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1.2.1">
                        <p id="section-toc.1-1.3.2.7.2.1.2.1.1"><a href="#section-3.7.1.1" class="xref">3.7.1.1</a>.  <a href="#name-simple-s2k" class="xref">Simple S2K</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1.2.2">
                        <p id="section-toc.1-1.3.2.7.2.1.2.2.1"><a href="#section-3.7.1.2" class="xref">3.7.1.2</a>.  <a href="#name-salted-s2k" class="xref">Salted S2K</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1.2.3">
                        <p id="section-toc.1-1.3.2.7.2.1.2.3.1"><a href="#section-3.7.1.3" class="xref">3.7.1.3</a>.  <a href="#name-iterated-and-salted-s2k" class="xref">Iterated and Salted S2K</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1.2.4">
                        <p id="section-toc.1-1.3.2.7.2.1.2.4.1"><a href="#section-3.7.1.4" class="xref">3.7.1.4</a>.  <a href="#name-argon2" class="xref">Argon2</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2">
                    <p id="section-toc.1-1.3.2.7.2.2.1"><a href="#section-3.7.2" class="xref">3.7.2</a>.  <a href="#name-string-to-key-usage" class="xref">String-to-Key Usage</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2.2.1">
                        <p id="section-toc.1-1.3.2.7.2.2.2.1.1"><a href="#section-3.7.2.1" class="xref">3.7.2.1</a>.  <a href="#name-secret-key-encryption" class="xref">Secret-Key Encryption</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.2.2.2">
                        <p id="section-toc.1-1.3.2.7.2.2.2.2.1"><a href="#section-3.7.2.2" class="xref">3.7.2.2</a>.  <a href="#name-symmetric-key-message-encry" class="xref">Symmetric-Key Message Encryption</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-packet-syntax" class="xref">Packet Syntax</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-overview" class="xref">Overview</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-packet-headers" class="xref">Packet Headers</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-old-format-packet-lengths" class="xref">Old Format Packet Lengths</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-new-format-packet-lengths" class="xref">New Format Packet Lengths</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2.2.1">
                        <p id="section-toc.1-1.4.2.2.2.2.2.1.1"><a href="#section-4.2.2.1" class="xref">4.2.2.1</a>.  <a href="#name-one-octet-lengths" class="xref">One-Octet Lengths</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2.2.2">
                        <p id="section-toc.1-1.4.2.2.2.2.2.2.1"><a href="#section-4.2.2.2" class="xref">4.2.2.2</a>.  <a href="#name-two-octet-lengths" class="xref">Two-Octet Lengths</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2.2.3">
                        <p id="section-toc.1-1.4.2.2.2.2.2.3.1"><a href="#section-4.2.2.3" class="xref">4.2.2.3</a>.  <a href="#name-five-octet-lengths" class="xref">Five-Octet Lengths</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.2.2.4">
                        <p id="section-toc.1-1.4.2.2.2.2.2.4.1"><a href="#section-4.2.2.4" class="xref">4.2.2.4</a>.  <a href="#name-partial-body-lengths" class="xref">Partial Body Lengths</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-packet-length-examples" class="xref">Packet Length Examples</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-packet-tags" class="xref">Packet Tags</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-packet-types" class="xref">Packet Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-public-key-encrypted-sessio" class="xref">Public-Key Encrypted Session Key Packets (Tag 1)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-algorithm-specific-fields-f" class="xref">Algorithm Specific Fields for RSA encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-algorithm-specific-fields-fo" class="xref">Algorithm Specific Fields for Elgamal encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-algorithm-specific-fields-for" class="xref">Algorithm-Specific Fields for ECDH encryption</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="xref">5.1.4</a>.  <a href="#name-notes-on-pkesk" class="xref">Notes on PKESK</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-signature-packet-tag-2" class="xref">Signature Packet (Tag 2)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.1">
                    <p id="section-toc.1-1.5.2.2.2.1.1"><a href="#section-5.2.1" class="xref">5.2.1</a>.  <a href="#name-signature-types" class="xref">Signature Types</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.2">
                    <p id="section-toc.1-1.5.2.2.2.2.1"><a href="#section-5.2.2" class="xref">5.2.2</a>.  <a href="#name-version-3-signature-packet-" class="xref">Version 3 Signature Packet Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3">
                    <p id="section-toc.1-1.5.2.2.2.3.1"><a href="#section-5.2.3" class="xref">5.2.3</a>.  <a href="#name-version-4-and-5-signature-p" class="xref">Version 4 and 5 Signature Packet Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.1">
                        <p id="section-toc.1-1.5.2.2.2.3.2.1.1"><a href="#section-5.2.3.1" class="xref">5.2.3.1</a>.  <a href="#name-algorithm-specific-fields-for-" class="xref">Algorithm-Specific Fields for RSA signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.2">
                        <p id="section-toc.1-1.5.2.2.2.3.2.2.1"><a href="#section-5.2.3.2" class="xref">5.2.3.2</a>.  <a href="#name-algorithm-specific-fields-for-d" class="xref">Algorithm-Specific Fields for DSA or ECDSA signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.3">
                        <p id="section-toc.1-1.5.2.2.2.3.2.3.1"><a href="#section-5.2.3.3" class="xref">5.2.3.3</a>.  <a href="#name-algorithm-specific-fields-for-e" class="xref">Algorithm-Specific Fields for EdDSA signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.4">
                        <p id="section-toc.1-1.5.2.2.2.3.2.4.1"><a href="#section-5.2.3.4" class="xref">5.2.3.4</a>.  <a href="#name-notes-on-signatures" class="xref">Notes on Signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.5">
                        <p id="section-toc.1-1.5.2.2.2.3.2.5.1"><a href="#section-5.2.3.5" class="xref">5.2.3.5</a>.  <a href="#name-signature-subpacket-specifi" class="xref">Signature Subpacket Specification</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.6">
                        <p id="section-toc.1-1.5.2.2.2.3.2.6.1"><a href="#section-5.2.3.6" class="xref">5.2.3.6</a>.  <a href="#name-signature-subpacket-types" class="xref">Signature Subpacket Types</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.7">
                        <p id="section-toc.1-1.5.2.2.2.3.2.7.1"><a href="#section-5.2.3.7" class="xref">5.2.3.7</a>.  <a href="#name-notes-on-self-signatures" class="xref">Notes on Self-Signatures</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.8">
                        <p id="section-toc.1-1.5.2.2.2.3.2.8.1"><a href="#section-5.2.3.8" class="xref">5.2.3.8</a>.  <a href="#name-signature-creation-time" class="xref">Signature Creation Time</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.9">
                        <p id="section-toc.1-1.5.2.2.2.3.2.9.1"><a href="#section-5.2.3.9" class="xref">5.2.3.9</a>.  <a href="#name-issuer" class="xref">Issuer</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.10">
                        <p id="section-toc.1-1.5.2.2.2.3.2.10.1"><a href="#section-5.2.3.10" class="xref">5.2.3.10</a>. <a href="#name-key-expiration-time" class="xref">Key Expiration Time</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.11">
                        <p id="section-toc.1-1.5.2.2.2.3.2.11.1"><a href="#section-5.2.3.11" class="xref">5.2.3.11</a>. <a href="#name-preferred-symmetric-algorit" class="xref">Preferred Symmetric Algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.12">
                        <p id="section-toc.1-1.5.2.2.2.3.2.12.1"><a href="#section-5.2.3.12" class="xref">5.2.3.12</a>. <a href="#name-preferred-hash-algorithms" class="xref">Preferred Hash Algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.13">
                        <p id="section-toc.1-1.5.2.2.2.3.2.13.1"><a href="#section-5.2.3.13" class="xref">5.2.3.13</a>. <a href="#name-preferred-compression-algor" class="xref">Preferred Compression Algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.14">
                        <p id="section-toc.1-1.5.2.2.2.3.2.14.1"><a href="#section-5.2.3.14" class="xref">5.2.3.14</a>. <a href="#name-signature-expiration-time" class="xref">Signature Expiration Time</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.15">
                        <p id="section-toc.1-1.5.2.2.2.3.2.15.1"><a href="#section-5.2.3.15" class="xref">5.2.3.15</a>. <a href="#name-exportable-certification" class="xref">Exportable Certification</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.16">
                        <p id="section-toc.1-1.5.2.2.2.3.2.16.1"><a href="#section-5.2.3.16" class="xref">5.2.3.16</a>. <a href="#name-revocable" class="xref">Revocable</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.17">
                        <p id="section-toc.1-1.5.2.2.2.3.2.17.1"><a href="#section-5.2.3.17" class="xref">5.2.3.17</a>. <a href="#name-trust-signature" class="xref">Trust Signature</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.18">
                        <p id="section-toc.1-1.5.2.2.2.3.2.18.1"><a href="#section-5.2.3.18" class="xref">5.2.3.18</a>. <a href="#name-regular-expression" class="xref">Regular Expression</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.19">
                        <p id="section-toc.1-1.5.2.2.2.3.2.19.1"><a href="#section-5.2.3.19" class="xref">5.2.3.19</a>. <a href="#name-revocation-key" class="xref">Revocation Key</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.20">
                        <p id="section-toc.1-1.5.2.2.2.3.2.20.1"><a href="#section-5.2.3.20" class="xref">5.2.3.20</a>. <a href="#name-notation-data" class="xref">Notation Data</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.21">
                        <p id="section-toc.1-1.5.2.2.2.3.2.21.1"><a href="#section-5.2.3.21" class="xref">5.2.3.21</a>. <a href="#name-key-server-preferences" class="xref">Key Server Preferences</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.22">
                        <p id="section-toc.1-1.5.2.2.2.3.2.22.1"><a href="#section-5.2.3.22" class="xref">5.2.3.22</a>. <a href="#name-preferred-key-server" class="xref">Preferred Key Server</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.23">
                        <p id="section-toc.1-1.5.2.2.2.3.2.23.1"><a href="#section-5.2.3.23" class="xref">5.2.3.23</a>. <a href="#name-primary-user-id" class="xref">Primary User ID</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.24">
                        <p id="section-toc.1-1.5.2.2.2.3.2.24.1"><a href="#section-5.2.3.24" class="xref">5.2.3.24</a>. <a href="#name-policy-uri" class="xref">Policy URI</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.25">
                        <p id="section-toc.1-1.5.2.2.2.3.2.25.1"><a href="#section-5.2.3.25" class="xref">5.2.3.25</a>. <a href="#name-key-flags" class="xref">Key Flags</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.26">
                        <p id="section-toc.1-1.5.2.2.2.3.2.26.1"><a href="#section-5.2.3.26" class="xref">5.2.3.26</a>. <a href="#name-signers-user-id" class="xref">Signer's User ID</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.27">
                        <p id="section-toc.1-1.5.2.2.2.3.2.27.1"><a href="#section-5.2.3.27" class="xref">5.2.3.27</a>. <a href="#name-reason-for-revocation" class="xref">Reason for Revocation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.28">
                        <p id="section-toc.1-1.5.2.2.2.3.2.28.1"><a href="#section-5.2.3.28" class="xref">5.2.3.28</a>. <a href="#name-features" class="xref">Features</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.29">
                        <p id="section-toc.1-1.5.2.2.2.3.2.29.1"><a href="#section-5.2.3.29" class="xref">5.2.3.29</a>. <a href="#name-signature-target" class="xref">Signature Target</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.30">
                        <p id="section-toc.1-1.5.2.2.2.3.2.30.1"><a href="#section-5.2.3.30" class="xref">5.2.3.30</a>. <a href="#name-embedded-signature" class="xref">Embedded Signature</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.31">
                        <p id="section-toc.1-1.5.2.2.2.3.2.31.1"><a href="#section-5.2.3.31" class="xref">5.2.3.31</a>. <a href="#name-issuer-fingerprint" class="xref">Issuer Fingerprint</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.3.2.32">
                        <p id="section-toc.1-1.5.2.2.2.3.2.32.1"><a href="#section-5.2.3.32" class="xref">5.2.3.32</a>. <a href="#name-intended-recipient-fingerpr" class="xref">Intended Recipient Fingerprint</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4">
                    <p id="section-toc.1-1.5.2.2.2.4.1"><a href="#section-5.2.4" class="xref">5.2.4</a>.  <a href="#name-computing-signatures" class="xref">Computing Signatures</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2.2.4.2.1">
                        <p id="section-toc.1-1.5.2.2.2.4.2.1.1"><a href="#section-5.2.4.1" class="xref">5.2.4.1</a>.  <a href="#name-subpacket-hints" class="xref">Subpacket Hints</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-symmetric-key-encrypted-ses" class="xref">Symmetric-Key Encrypted Session Key Packets (Tag 3)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-no-v5-skesk-with-seipd" class="xref">No v5 SKESK with SEIPD</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-one-pass-signature-packets-" class="xref">One-Pass Signature Packets (Tag 4)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-key-material-packet" class="xref">Key Material Packet</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a href="#section-5.5.1" class="xref">5.5.1</a>.  <a href="#name-key-packet-variants" class="xref">Key Packet Variants</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1.2.1">
                        <p id="section-toc.1-1.5.2.5.2.1.2.1.1"><a href="#section-5.5.1.1" class="xref">5.5.1.1</a>.  <a href="#name-public-key-packet-tag-6" class="xref">Public-Key Packet (Tag 6)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1.2.2">
                        <p id="section-toc.1-1.5.2.5.2.1.2.2.1"><a href="#section-5.5.1.2" class="xref">5.5.1.2</a>.  <a href="#name-public-subkey-packet-tag-14" class="xref">Public-Subkey Packet (Tag 14)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1.2.3">
                        <p id="section-toc.1-1.5.2.5.2.1.2.3.1"><a href="#section-5.5.1.3" class="xref">5.5.1.3</a>.  <a href="#name-secret-key-packet-tag-5" class="xref">Secret-Key Packet (Tag 5)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.1.2.4">
                        <p id="section-toc.1-1.5.2.5.2.1.2.4.1"><a href="#section-5.5.1.4" class="xref">5.5.1.4</a>.  <a href="#name-secret-subkey-packet-tag-7" class="xref">Secret-Subkey Packet (Tag 7)</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a href="#section-5.5.2" class="xref">5.5.2</a>.  <a href="#name-public-key-packet-formats" class="xref">Public-Key Packet Formats</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.5.2.3">
                    <p id="section-toc.1-1.5.2.5.2.3.1"><a href="#section-5.5.3" class="xref">5.5.3</a>.  <a href="#name-secret-key-packet-formats" class="xref">Secret-Key Packet Formats</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-algorithm-specific-parts-of" class="xref">Algorithm-specific Parts of Keys</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.1">
                    <p id="section-toc.1-1.5.2.6.2.1.1"><a href="#section-5.6.1" class="xref">5.6.1</a>.  <a href="#name-algorithm-specific-part-for" class="xref">Algorithm-Specific Part for RSA Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.2">
                    <p id="section-toc.1-1.5.2.6.2.2.1"><a href="#section-5.6.2" class="xref">5.6.2</a>.  <a href="#name-algorithm-specific-part-for-" class="xref">Algorithm-Specific Part for DSA Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.3">
                    <p id="section-toc.1-1.5.2.6.2.3.1"><a href="#section-5.6.3" class="xref">5.6.3</a>.  <a href="#name-algorithm-specific-part-for-e" class="xref">Algorithm-Specific Part for Elgamal Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.4">
                    <p id="section-toc.1-1.5.2.6.2.4.1"><a href="#section-5.6.4" class="xref">5.6.4</a>.  <a href="#name-algorithm-specific-part-for-ec" class="xref">Algorithm-Specific Part for ECDSA Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.5">
                    <p id="section-toc.1-1.5.2.6.2.5.1"><a href="#section-5.6.5" class="xref">5.6.5</a>.  <a href="#name-algorithm-specific-part-for-ed" class="xref">Algorithm-Specific Part for EdDSA Keys</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.6.2.6">
                    <p id="section-toc.1-1.5.2.6.2.6.1"><a href="#section-5.6.6" class="xref">5.6.6</a>.  <a href="#name-algorithm-specific-part-for-ecd" class="xref">Algorithm-Specific Part for ECDH Keys</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-compressed-data-packet-tag-" class="xref">Compressed Data Packet (Tag 8)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="xref">5.8</a>.  <a href="#name-symmetrically-encrypted-dat" class="xref">Symmetrically Encrypted Data Packet (Tag 9)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="xref">5.9</a>.  <a href="#name-marker-packet-obsolete-lite" class="xref">Marker Packet (Obsolete Literal Packet) (Tag 10)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a href="#section-5.10" class="xref">5.10</a>. <a href="#name-literal-data-packet-tag-11" class="xref">Literal Data Packet (Tag 11)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.11">
                <p id="section-toc.1-1.5.2.11.1"><a href="#section-5.11" class="xref">5.11</a>. <a href="#name-trust-packet-tag-12" class="xref">Trust Packet (Tag 12)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.12">
                <p id="section-toc.1-1.5.2.12.1"><a href="#section-5.12" class="xref">5.12</a>. <a href="#name-user-id-packet-tag-13" class="xref">User ID Packet (Tag 13)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.13">
                <p id="section-toc.1-1.5.2.13.1"><a href="#section-5.13" class="xref">5.13</a>. <a href="#name-user-attribute-packet-tag-1" class="xref">User Attribute Packet (Tag 17)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.13.2.1">
                    <p id="section-toc.1-1.5.2.13.2.1.1"><a href="#section-5.13.1" class="xref">5.13.1</a>.  <a href="#name-the-image-attribute-subpack" class="xref">The Image Attribute Subpacket</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.14">
                <p id="section-toc.1-1.5.2.14.1"><a href="#section-5.14" class="xref">5.14</a>. <a href="#name-sym-encrypted-integrity-pro" class="xref">Sym. Encrypted Integrity Protected Data Packet (Tag 18)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.15">
                <p id="section-toc.1-1.5.2.15.1"><a href="#section-5.15" class="xref">5.15</a>. <a href="#name-modification-detection-code" class="xref">Modification Detection Code Packet (Tag 19)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.16">
                <p id="section-toc.1-1.5.2.16.1"><a href="#section-5.16" class="xref">5.16</a>. <a href="#name-aead-encrypted-data-packet-" class="xref">AEAD Encrypted Data Packet (Tag 20)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.16.2.1">
                    <p id="section-toc.1-1.5.2.16.2.1.1"><a href="#section-5.16.1" class="xref">5.16.1</a>.  <a href="#name-eax-mode" class="xref">EAX Mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.16.2.2">
                    <p id="section-toc.1-1.5.2.16.2.2.1"><a href="#section-5.16.2" class="xref">5.16.2</a>.  <a href="#name-ocb-mode" class="xref">OCB Mode</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-radix-64-conversions" class="xref">Radix-64 Conversions</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-an-implementation-of-the-cr" class="xref">An Implementation of the CRC-24 in "C"</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-forming-ascii-armor" class="xref">Forming ASCII Armor</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-encoding-binary-in-radix-64" class="xref">Encoding Binary in Radix-64</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-decoding-radix-64" class="xref">Decoding Radix-64</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-examples-of-radix-64" class="xref">Examples of Radix-64</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-example-of-an-ascii-armored" class="xref">Example of an ASCII Armored Message</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-cleartext-signature-framewo" class="xref">Cleartext Signature Framework</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-dash-escaped-text" class="xref">Dash-Escaped Text</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-regular-expressions" class="xref">Regular Expressions</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-constants" class="xref">Constants</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-public-key-algorithms" class="xref">Public-Key Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-ecc-curves-for-openpgp" class="xref">ECC Curves for OpenPGP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2.2.1">
                    <p id="section-toc.1-1.9.2.2.2.1.1"><a href="#section-9.2.1" class="xref">9.2.1</a>.  <a href="#name-curve-specific-wire-formats" class="xref">Curve-Specific Wire Formats</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.3">
                <p id="section-toc.1-1.9.2.3.1"><a href="#section-9.3" class="xref">9.3</a>.  <a href="#name-symmetric-key-algorithms" class="xref">Symmetric-Key Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.4">
                <p id="section-toc.1-1.9.2.4.1"><a href="#section-9.4" class="xref">9.4</a>.  <a href="#name-compression-algorithms" class="xref">Compression Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.5">
                <p id="section-toc.1-1.9.2.5.1"><a href="#section-9.5" class="xref">9.5</a>.  <a href="#name-hash-algorithms" class="xref">Hash Algorithms</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.6">
                <p id="section-toc.1-1.9.2.6.1"><a href="#section-9.6" class="xref">9.6</a>.  <a href="#name-aead-algorithms" class="xref">AEAD Algorithms</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-new-string-to-key-specifier" class="xref">New String-to-Key Specifier Types</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-new-packets" class="xref">New Packets</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#section-10.2.1" class="xref">10.2.1</a>.  <a href="#name-user-attribute-types" class="xref">User Attribute Types</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.1.2.1">
                        <p id="section-toc.1-1.10.2.2.2.1.2.1.1"><a href="#section-10.2.1.1" class="xref">10.2.1.1</a>.  <a href="#name-image-format-subpacket-type" class="xref">Image Format Subpacket Types</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a href="#section-10.2.2" class="xref">10.2.2</a>.  <a href="#name-new-signature-subpackets" class="xref">New Signature Subpackets</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2.2.1">
                        <p id="section-toc.1-1.10.2.2.2.2.2.1.1"><a href="#section-10.2.2.1" class="xref">10.2.2.1</a>.  <a href="#name-signature-notation-data-sub" class="xref">Signature Notation Data Subpackets</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2.2.2">
                        <p id="section-toc.1-1.10.2.2.2.2.2.2.1"><a href="#section-10.2.2.2" class="xref">10.2.2.2</a>.  <a href="#name-signature-notation-data-subp" class="xref">Signature Notation Data Subpacket Notation Flags</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2.2.3">
                        <p id="section-toc.1-1.10.2.2.2.2.2.3.1"><a href="#section-10.2.2.3" class="xref">10.2.2.3</a>.  <a href="#name-key-server-preference-exten" class="xref">Key Server Preference Extensions</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2.2.4">
                        <p id="section-toc.1-1.10.2.2.2.2.2.4.1"><a href="#section-10.2.2.4" class="xref">10.2.2.4</a>.  <a href="#name-key-flags-extensions" class="xref">Key Flags Extensions</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2.2.5">
                        <p id="section-toc.1-1.10.2.2.2.2.2.5.1"><a href="#section-10.2.2.5" class="xref">10.2.2.5</a>.  <a href="#name-reason-for-revocation-exten" class="xref">Reason for Revocation Extensions</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.2.2.6">
                        <p id="section-toc.1-1.10.2.2.2.2.2.6.1"><a href="#section-10.2.2.6" class="xref">10.2.2.6</a>.  <a href="#name-implementation-features" class="xref">Implementation Features</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2.2.3">
                    <p id="section-toc.1-1.10.2.2.2.3.1"><a href="#section-10.2.3" class="xref">10.2.3</a>.  <a href="#name-new-packet-versions" class="xref">New Packet Versions</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-new-algorithms" class="xref">New Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.1">
                    <p id="section-toc.1-1.10.2.3.2.1.1"><a href="#section-10.3.1" class="xref">10.3.1</a>.  <a href="#name-public-key-algorithms-2" class="xref">Public-Key Algorithms</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.2">
                    <p id="section-toc.1-1.10.2.3.2.2.1"><a href="#section-10.3.2" class="xref">10.3.2</a>.  <a href="#name-symmetric-key-algorithms-2" class="xref">Symmetric-Key Algorithms</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.3">
                    <p id="section-toc.1-1.10.2.3.2.3.1"><a href="#section-10.3.3" class="xref">10.3.3</a>.  <a href="#name-hash-algorithms-2" class="xref">Hash Algorithms</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.4">
                    <p id="section-toc.1-1.10.2.3.2.4.1"><a href="#section-10.3.4" class="xref">10.3.4</a>.  <a href="#name-compression-algorithms-2" class="xref">Compression Algorithms</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3.2.5">
                    <p id="section-toc.1-1.10.2.3.2.5.1"><a href="#section-10.3.5" class="xref">10.3.5</a>.  <a href="#name-elliptic-curve-algorithms" class="xref">Elliptic Curve Algorithms</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="xref">10.4</a>.  <a href="#name-elliptic-curve-point-and-sc" class="xref">Elliptic Curve Point and Scalar Wire Formats</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="xref">10.5</a>.  <a href="#name-changes-to-existing-registr" class="xref">Changes to existing registries</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-packet-composition" class="xref">Packet Composition</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-transferable-public-keys" class="xref">Transferable Public Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-transferable-secret-keys" class="xref">Transferable Secret Keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-openpgp-messages" class="xref">OpenPGP Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.4">
                <p id="section-toc.1-1.11.2.4.1"><a href="#section-11.4" class="xref">11.4</a>.  <a href="#name-detached-signatures" class="xref">Detached Signatures</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-enhanced-key-formats" class="xref">Enhanced Key Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#section-12.1" class="xref">12.1</a>.  <a href="#name-key-structures" class="xref">Key Structures</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#section-12.2" class="xref">12.2</a>.  <a href="#name-key-ids-and-fingerprints" class="xref">Key IDs and Fingerprints</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-elliptic-curve-cryptography" class="xref">Elliptic Curve Cryptography</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-supported-ecc-curves" class="xref">Supported ECC Curves</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2">
                <p id="section-toc.1-1.13.2.2.1"><a href="#section-13.2" class="xref">13.2</a>.  <a href="#name-ec-point-wire-formats" class="xref">EC Point Wire Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2.2.1">
                    <p id="section-toc.1-1.13.2.2.2.1.1"><a href="#section-13.2.1" class="xref">13.2.1</a>.  <a href="#name-sec1-ec-point-wire-format" class="xref">SEC1 EC Point Wire Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2.2.2">
                    <p id="section-toc.1-1.13.2.2.2.2.1"><a href="#section-13.2.2" class="xref">13.2.2</a>.  <a href="#name-prefixed-native-ec-point-wi" class="xref">Prefixed Native EC Point Wire Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.2.2.3">
                    <p id="section-toc.1-1.13.2.2.2.3.1"><a href="#section-13.2.3" class="xref">13.2.3</a>.  <a href="#name-notes-on-ec-point-wire-form" class="xref">Notes on EC Point Wire Formats</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3">
                <p id="section-toc.1-1.13.2.3.1"><a href="#section-13.3" class="xref">13.3</a>.  <a href="#name-ec-scalar-wire-formats" class="xref">EC Scalar Wire Formats</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3.2.1">
                    <p id="section-toc.1-1.13.2.3.2.1.1"><a href="#section-13.3.1" class="xref">13.3.1</a>.  <a href="#name-ec-octet-string-wire-format" class="xref">EC Octet String Wire Format</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.3.2.2">
                    <p id="section-toc.1-1.13.2.3.2.2.1"><a href="#section-13.3.2" class="xref">13.3.2</a>.  <a href="#name-elliptic-curve-prefixed-oct" class="xref">Elliptic Curve Prefixed Octet String Wire Format</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.4">
                <p id="section-toc.1-1.13.2.4.1"><a href="#section-13.4" class="xref">13.4</a>.  <a href="#name-key-derivation-function" class="xref">Key Derivation Function</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13.2.5">
                <p id="section-toc.1-1.13.2.5.1"><a href="#section-13.5" class="xref">13.5</a>.  <a href="#name-ec-dh-algorithm-ecdh" class="xref">EC DH Algorithm (ECDH)</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-notes-on-algorithms" class="xref">Notes on Algorithms</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-pkcs1-encoding-in-openpgp" class="xref">PKCS#1 Encoding in OpenPGP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.1">
                    <p id="section-toc.1-1.14.2.1.2.1.1"><a href="#section-14.1.1" class="xref">14.1.1</a>.  <a href="#name-eme-pkcs1-v1_5-encode" class="xref">EME-PKCS1-v1_5-ENCODE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.2">
                    <p id="section-toc.1-1.14.2.1.2.2.1"><a href="#section-14.1.2" class="xref">14.1.2</a>.  <a href="#name-eme-pkcs1-v1_5-decode" class="xref">EME-PKCS1-v1_5-DECODE</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.1.2.3">
                    <p id="section-toc.1-1.14.2.1.2.3.1"><a href="#section-14.1.3" class="xref">14.1.3</a>.  <a href="#name-emsa-pkcs1-v1_5" class="xref">EMSA-PKCS1-v1_5</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-symmetric-algorithm-prefere" class="xref">Symmetric Algorithm Preferences</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="xref">14.3</a>.  <a href="#name-other-algorithm-preferences" class="xref">Other Algorithm Preferences</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3.2.1">
                    <p id="section-toc.1-1.14.2.3.2.1.1"><a href="#section-14.3.1" class="xref">14.3.1</a>.  <a href="#name-compression-preferences" class="xref">Compression Preferences</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.3.2.2">
                    <p id="section-toc.1-1.14.2.3.2.2.1"><a href="#section-14.3.2" class="xref">14.3.2</a>.  <a href="#name-hash-algorithm-preferences" class="xref">Hash Algorithm Preferences</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="xref">14.4</a>.  <a href="#name-plaintext" class="xref">Plaintext</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-14.5" class="xref">14.5</a>.  <a href="#name-rsa" class="xref">RSA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#section-14.6" class="xref">14.6</a>.  <a href="#name-dsa" class="xref">DSA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.7">
                <p id="section-toc.1-1.14.2.7.1"><a href="#section-14.7" class="xref">14.7</a>.  <a href="#name-elgamal" class="xref">Elgamal</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.8">
                <p id="section-toc.1-1.14.2.8.1"><a href="#section-14.8" class="xref">14.8</a>.  <a href="#name-eddsa" class="xref">EdDSA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.9">
                <p id="section-toc.1-1.14.2.9.1"><a href="#section-14.9" class="xref">14.9</a>.  <a href="#name-reserved-algorithm-numbers" class="xref">Reserved Algorithm Numbers</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.10">
                <p id="section-toc.1-1.14.2.10.1"><a href="#section-14.10" class="xref">14.10</a>. <a href="#name-openpgp-cfb-mode" class="xref">OpenPGP CFB Mode</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.11">
                <p id="section-toc.1-1.14.2.11.1"><a href="#section-14.11" class="xref">14.11</a>. <a href="#name-private-or-experimental-par" class="xref">Private or Experimental Parameters</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.12">
                <p id="section-toc.1-1.14.2.12.1"><a href="#section-14.12" class="xref">14.12</a>. <a href="#name-extension-of-the-mdc-system" class="xref">Extension of the MDC System</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14.2.13">
                <p id="section-toc.1-1.14.2.13.1"><a href="#section-14.13" class="xref">14.13</a>. <a href="#name-meta-considerations-for-exp" class="xref">Meta-Considerations for Expansion</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-implementation-nits" class="xref">Implementation Nits</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-17" class="xref">17</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-17.1" class="xref">17.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-17.2" class="xref">17.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-test-vectors" class="xref">Test vectors</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.1">
                <p id="section-toc.1-1.18.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-sample-eddsa-key" class="xref">Sample EdDSA key</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.2">
                <p id="section-toc.1-1.18.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-sample-eddsa-signature" class="xref">Sample EdDSA signature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3">
                <p id="section-toc.1-1.18.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.  <a href="#name-sample-aead-eax-encryption-" class="xref">Sample AEAD-EAX encryption and decryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.1">
                    <p id="section-toc.1-1.18.2.3.2.1.1"><a href="#appendix-A.3.1" class="xref">A.3.1</a>.  <a href="#name-sample-parameters" class="xref">Sample Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.2">
                    <p id="section-toc.1-1.18.2.3.2.2.1"><a href="#appendix-A.3.2" class="xref">A.3.2</a>.  <a href="#name-sample-symmetric-key-encryp" class="xref">Sample symmetric-key encrypted session key packet (v5)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.3">
                    <p id="section-toc.1-1.18.2.3.2.3.1"><a href="#appendix-A.3.3" class="xref">A.3.3</a>.  <a href="#name-starting-aead-eax-decryptio" class="xref">Starting AEAD-EAX decryption of CEK</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.4">
                    <p id="section-toc.1-1.18.2.3.2.4.1"><a href="#appendix-A.3.4" class="xref">A.3.4</a>.  <a href="#name-initial-content-encryption-" class="xref">Initial Content Encryption Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.5">
                    <p id="section-toc.1-1.18.2.3.2.5.1"><a href="#appendix-A.3.5" class="xref">A.3.5</a>.  <a href="#name-sample-aead-encrypted-data-" class="xref">Sample AEAD encrypted data packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.6">
                    <p id="section-toc.1-1.18.2.3.2.6.1"><a href="#appendix-A.3.6" class="xref">A.3.6</a>.  <a href="#name-decryption-of-data" class="xref">Decryption of data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.3.2.7">
                    <p id="section-toc.1-1.18.2.3.2.7.1"><a href="#appendix-A.3.7" class="xref">A.3.7</a>.  <a href="#name-complete-aead-eax-encrypted" class="xref">Complete AEAD-EAX encrypted packet sequence</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4">
                <p id="section-toc.1-1.18.2.4.1"><a href="#appendix-A.4" class="xref">A.4</a>.  <a href="#name-sample-aead-ocb-encryption-" class="xref">Sample AEAD-OCB encryption and decryption</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4.2.1">
                    <p id="section-toc.1-1.18.2.4.2.1.1"><a href="#appendix-A.4.1" class="xref">A.4.1</a>.  <a href="#name-sample-parameters-2" class="xref">Sample Parameters</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4.2.2">
                    <p id="section-toc.1-1.18.2.4.2.2.1"><a href="#appendix-A.4.2" class="xref">A.4.2</a>.  <a href="#name-sample-symmetric-key-encrypt" class="xref">Sample symmetric-key encrypted session key packet (v5)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4.2.3">
                    <p id="section-toc.1-1.18.2.4.2.3.1"><a href="#appendix-A.4.3" class="xref">A.4.3</a>.  <a href="#name-starting-aead-ocb-decryptio" class="xref">Starting AEAD-OCB decryption of CEK</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4.2.4">
                    <p id="section-toc.1-1.18.2.4.2.4.1"><a href="#appendix-A.4.4" class="xref">A.4.4</a>.  <a href="#name-initial-content-encryption-k" class="xref">Initial Content Encryption Key</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4.2.5">
                    <p id="section-toc.1-1.18.2.4.2.5.1"><a href="#appendix-A.4.5" class="xref">A.4.5</a>.  <a href="#name-sample-aead-encrypted-data-p" class="xref">Sample AEAD encrypted data packet</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4.2.6">
                    <p id="section-toc.1-1.18.2.4.2.6.1"><a href="#appendix-A.4.6" class="xref">A.4.6</a>.  <a href="#name-decryption-of-data-2" class="xref">Decryption of data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.18.2.4.2.7">
                    <p id="section-toc.1-1.18.2.4.2.7.1"><a href="#appendix-A.4.7" class="xref">A.4.7</a>.  <a href="#name-complete-aead-ocb-encrypted" class="xref">Complete AEAD-OCB encrypted packet sequence</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-document-workflow" class="xref">Document Workflow</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-D" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">{ This is work in progress to update OpenPGP.
  Editorial notes are enclosed in curly braces.
  }<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document provides information on the message-exchange packet formats used by OpenPGP to provide encryption, decryption, signing, and key management functions.
It is a revision of RFC 4880, "OpenPGP Message Format", which is a revision of RFC 2440, which itself replaces RFC 1991, "PGP Message Exchange Formats" <span>[<a href="#RFC1991" class="xref">RFC1991</a>]</span> <span>[<a href="#RFC2440" class="xref">RFC2440</a>]</span> <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document obsoletes: RFC 4880 (OpenPGP), RFC 5581 (Camellia in OpenPGP) and RFC 6637 (Elliptic Curves in OpenPGP).<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="terms">
<section id="section-1.1">
        <h3 id="name-terms">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terms" class="section-name selfRef">Terms</a>
        </h3>
<ul class="normal">
<li class="normal" id="section-1.1-1.1">OpenPGP - This is a term for security software that uses PGP 5 as a basis, formalized in this document.<a href="#section-1.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.2">PGP - Pretty Good Privacy.
PGP is a family of software systems developed by Philip R. Zimmermann from which OpenPGP is based.<a href="#section-1.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.3">PGP 2 - This version of PGP has many variants; where necessary a more detailed version number is used here.
PGP 2 uses only RSA, MD5, and IDEA for its cryptographic transforms.
An informational RFC, RFC 1991, was written describing this version of PGP.<a href="#section-1.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.4">PGP 5 - This version of PGP is formerly known as "PGP 3" in the community.
It has new formats and corrects a number of problems in the PGP 2 design.
It is referred to here as PGP 5 because that software was the first release of the "PGP 3" code base.<a href="#section-1.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-1.5">GnuPG - GNU Privacy Guard, also called GPG.
GnuPG is an OpenPGP implementation that avoids all encumbered algorithms.
Consequently, early versions of GnuPG did not include RSA public keys.<a href="#section-1.1-1.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-1.1-2">"PGP", "Pretty Good", and "Pretty Good Privacy" are trademarks of PGP Corporation and are used with permission.
The term "OpenPGP" refers to the protocol described in this and related documents.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">The key words "PRIVATE USE", "SPECIFICATION REQUIRED", and "RFC REQUIRED" that appear in this document when used to describe namespace allocation are to be interpreted as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="general-functions">
<section id="section-2">
      <h2 id="name-general-functions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-general-functions" class="section-name selfRef">General functions</a>
      </h2>
<p id="section-2-1">OpenPGP provides data integrity services for messages and data files by using these core technologies:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">digital signatures<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">encryption<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.3">compression<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.4">Radix-64 conversion<a href="#section-2-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-3">In addition, OpenPGP provides key management and certificate services, but many of these are beyond the scope of this document.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="confidentiality-via-encryption">
<section id="section-2.1">
        <h3 id="name-confidentiality-via-encrypt">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-confidentiality-via-encrypt" class="section-name selfRef">Confidentiality via Encryption</a>
        </h3>
<p id="section-2.1-1">OpenPGP combines symmetric-key encryption and public-key encryption to provide confidentiality.
When made confidential, first the object is encrypted using a symmetric encryption algorithm.
Each symmetric key is used only once, for a single object.
A new "session key" is generated as a random number for each object (sometimes referred to as a session).
Since it is used only once, the session key is bound to the message and transmitted with it.
To protect the key, it is encrypted with the receiver's public key.
The sequence is as follows:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1-2">
<li id="section-2.1-2.1">The sender creates a message.<a href="#section-2.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.2">The sending OpenPGP generates a random number to be used as a session key for this message only.<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.3">The session key is encrypted using each recipient's public key.
These "encrypted session keys" start the message.<a href="#section-2.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.4">The sending OpenPGP encrypts the message using the session key, which forms the remainder of the message.
Note that the message is also usually compressed.<a href="#section-2.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.5">The receiving OpenPGP decrypts the session key using the recipient's private key.<a href="#section-2.1-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.6">The receiving OpenPGP decrypts the message using the session key.
If the message was compressed, it will be decompressed.<a href="#section-2.1-2.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-2.1-3">With symmetric-key encryption, an object may be encrypted with a symmetric key derived from a passphrase (or other shared secret), or a two-stage mechanism similar to the public-key method described above in which a session key is itself encrypted with a symmetric algorithm keyed from a shared secret.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Both digital signature and confidentiality services may be applied to the same message.
First, a signature is generated for the message and attached to the message.
Then the message plus signature is encrypted using a symmetric session key.
Finally, the session key is encrypted using public-key encryption and prefixed to the encrypted block.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authentication-via-digital-signature">
<section id="section-2.2">
        <h3 id="name-authentication-via-digital-">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-authentication-via-digital-" class="section-name selfRef">Authentication via Digital Signature</a>
        </h3>
<p id="section-2.2-1">The digital signature uses a hash code or message digest algorithm, and a public-key signature algorithm.
The sequence is as follows:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.2-2">
<li id="section-2.2-2.1">The sender creates a message.<a href="#section-2.2-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.2">The sending software generates a hash code of the message.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.3">The sending software generates a signature from the hash code using the sender's private key.<a href="#section-2.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.4">The binary signature is attached to the message.<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.5">The receiving software keeps a copy of the message signature.<a href="#section-2.2-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.2-2.6">The receiving software generates a new hash code for the received message and verifies it using the message's signature.
If the verification is successful, the message is accepted as authentic.<a href="#section-2.2-2.6" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="compression">
<section id="section-2.3">
        <h3 id="name-compression">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-compression" class="section-name selfRef">Compression</a>
        </h3>
<p id="section-2.3-1">OpenPGP implementations SHOULD compress the message after applying the signature but before encryption.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">If an implementation does not implement compression, its authors should be aware that most OpenPGP messages in the world are compressed.
Thus, it may even be wise for a space-constrained implementation to implement decompression, but not compression.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">Furthermore, compression has the added side effect that some types of attacks can be thwarted by the fact that slightly altered, compressed data rarely uncompresses without severe errors.
This is hardly rigorous, but it is operationally useful.
These attacks can be rigorously prevented by implementing and using Modification Detection Codes as described in sections following.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="conversion-to-radix-64">
<section id="section-2.4">
        <h3 id="name-conversion-to-radix-64">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-conversion-to-radix-64" class="section-name selfRef">Conversion to Radix-64</a>
        </h3>
<p id="section-2.4-1">OpenPGP's underlying native representation for encrypted messages, signature certificates, and keys is a stream of arbitrary octets.
Some systems only permit the use of blocks consisting of seven-bit, printable text.
For transporting OpenPGP's native raw binary octets through channels that are not safe to raw binary data, a printable encoding of these binary octets is needed.
OpenPGP provides the service of converting the raw 8-bit binary octet stream to a stream of printable ASCII characters, called Radix-64 encoding or ASCII Armor.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">Implementations SHOULD provide Radix-64 conversions.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-only-applications">
<section id="section-2.5">
        <h3 id="name-signature-only-applications">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-signature-only-applications" class="section-name selfRef">Signature-Only Applications</a>
        </h3>
<p id="section-2.5-1">OpenPGP is designed for applications that use both encryption and signatures, but there are a number of problems that are solved by a signature-only implementation.
Although this specification requires both encryption and signatures, it is reasonable for there to be subset implementations that are non-conformant only in that they omit encryption.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="data-element-formats">
<section id="section-3">
      <h2 id="name-data-element-formats">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-data-element-formats" class="section-name selfRef">Data Element Formats</a>
      </h2>
<p id="section-3-1">This section describes the data elements used by OpenPGP.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="scalar-numbers">
<section id="section-3.1">
        <h3 id="name-scalar-numbers">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-scalar-numbers" class="section-name selfRef">Scalar Numbers</a>
        </h3>
<p id="section-3.1-1">Scalar numbers are unsigned and are always stored in big-endian format.
Using n[k] to refer to the kth octet being interpreted, the value of a two-octet scalar is ((n[0] &lt;&lt; 8) + n[1]).
The value of a four-octet scalar is ((n[0] &lt;&lt; 24) + (n[1] &lt;&lt; 16) + (n[2] &lt;&lt; 8) + n[3]).<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mpi">
<section id="section-3.2">
        <h3 id="name-multiprecision-integers">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-multiprecision-integers" class="section-name selfRef">Multiprecision Integers</a>
        </h3>
<p id="section-3.2-1">Multiprecision integers (also called MPIs) are unsigned integers used to hold large integers such as the ones used in cryptographic calculations.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">An MPI consists of two pieces: a two-octet scalar that is the length of the MPI in bits followed by a string of octets that contain the actual integer.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">These octets form a big-endian number; a big-endian number can be made into an MPI by prefixing it with the appropriate length.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Examples:<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">(all numbers are in hexadecimal)<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6">The string of octets [00 01 01] forms an MPI with the value 1.
The string [00 09 01 FF] forms an MPI with the value of 511.<a href="#section-3.2-6" class="pilcrow">¶</a></p>
<p id="section-3.2-7">Additional rules:<a href="#section-3.2-7" class="pilcrow">¶</a></p>
<p id="section-3.2-8">The size of an MPI is ((MPI.length + 7) / 8) + 2 octets.<a href="#section-3.2-8" class="pilcrow">¶</a></p>
<p id="section-3.2-9">The length field of an MPI describes the length starting from its most significant non-zero bit.
Thus, the MPI [00 02 01] is not formed correctly.
It should be [00 01 01].<a href="#section-3.2-9" class="pilcrow">¶</a></p>
<p id="section-3.2-10">Unused bits of an MPI MUST be zero.<a href="#section-3.2-10" class="pilcrow">¶</a></p>
<p id="section-3.2-11">Also note that when an MPI is encrypted, the length refers to the plaintext MPI.
It may be ill-formed in its ciphertext.<a href="#section-3.2-11" class="pilcrow">¶</a></p>
<div id="using-mpis-to-encode-other-data">
<section id="section-3.2.1">
          <h4 id="name-using-mpis-to-encode-other-">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-using-mpis-to-encode-other-" class="section-name selfRef">Using MPIs to encode other data</a>
          </h4>
<p id="section-3.2.1-1">Note that MPIs are used in some places used to encode non-integer data, such as an elliptic curve point (see <a href="#ec-point-wire-formats" class="xref">Section 13.2</a>, or an octet string of known, fixed length (see <a href="#ec-scalar-wire-formats" class="xref">Section 13.3</a>).
The wire representation is the same: two octets of length in bits counted from the first non-zero bit, followed by the smallest series of octets that can represent the value while stripping off any leading zero octets.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-ids">
<section id="section-3.3">
        <h3 id="name-key-ids">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-key-ids" class="section-name selfRef">Key IDs</a>
        </h3>
<p id="section-3.3-1">A Key ID is an eight-octet scalar that identifies a key.
Implementations SHOULD NOT assume that Key IDs are unique.
<a href="#enhanced-key-formats" class="xref">Section 12</a> describes how Key IDs are formed.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="text">
<section id="section-3.4">
        <h3 id="name-text">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-text" class="section-name selfRef">Text</a>
        </h3>
<p id="section-3.4-1">Unless otherwise specified, the character set for text is the UTF-8 <span>[<a href="#RFC3629" class="xref">RFC3629</a>]</span> encoding of Unicode <span>[<a href="#ISO10646" class="xref">ISO10646</a>]</span>.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="time-fields">
<section id="section-3.5">
        <h3 id="name-time-fields">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-time-fields" class="section-name selfRef">Time Fields</a>
        </h3>
<p id="section-3.5-1">A time field is an unsigned four-octet number containing the number of seconds elapsed since midnight, 1 January 1970 UTC.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="keyrings">
<section id="section-3.6">
        <h3 id="name-keyrings">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-keyrings" class="section-name selfRef">Keyrings</a>
        </h3>
<p id="section-3.6-1">A keyring is a collection of one or more keys in a file or database.
Traditionally, a keyring is simply a sequential list of keys, but may be any suitable database.
It is beyond the scope of this standard to discuss the details of keyrings or other databases.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="string-to-key-s2k-specifiers">
<section id="section-3.7">
        <h3 id="name-string-to-key-s2k-specifier">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-string-to-key-s2k-specifier" class="section-name selfRef">String-to-Key (S2K) Specifiers</a>
        </h3>
<p id="section-3.7-1">String-to-key (S2K) specifiers are used to convert passphrase strings into symmetric-key encryption/decryption keys.
They are used in two places, currently: to encrypt the secret part of private keys in the private keyring, and to convert passphrases to encryption keys for symmetrically encrypted messages.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<div id="s2k-types">
<section id="section-3.7.1">
          <h4 id="name-string-to-key-s2k-specifier-">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-string-to-key-s2k-specifier-" class="section-name selfRef">String-to-Key (S2K) Specifier Types</a>
          </h4>
<p id="section-3.7.1-1">There are three types of S2K specifiers currently supported, and some reserved values:<a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<span id="name-s2k-type-registry"></span><table class="center" id="table-1">
            <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-s2k-type-registry" class="selfRef">S2K type registry</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">ID</th>
                <th class="text-left" rowspan="1" colspan="1">S2K Type</th>
                <th class="text-left" rowspan="1" colspan="1">Generate?</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">0</td>
                <td class="text-left" rowspan="1" colspan="1">Simple S2K</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#s2k-simple" class="xref">Section 3.7.1.1</a>
</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">1</td>
                <td class="text-left" rowspan="1" colspan="1">Salted S2K</td>
                <td class="text-left" rowspan="1" colspan="1">Only when string is high entropy</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#s2k-salted" class="xref">Section 3.7.1.2</a>
</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">2</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved value</td>
                <td class="text-left" rowspan="1" colspan="1">N</td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">3</td>
                <td class="text-left" rowspan="1" colspan="1">Iterated and Salted S2K</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#s2k-iter-salted" class="xref">Section 3.7.1.3</a>
</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">4</td>
                <td class="text-left" rowspan="1" colspan="1">Argon2</td>
                <td class="text-left" rowspan="1" colspan="1">Y</td>
                <td class="text-left" rowspan="1" colspan="1">
                  <a href="#s2k-argon2" class="xref">Section 3.7.1.4</a>
</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">100 to 110</td>
                <td class="text-left" rowspan="1" colspan="1">Private/Experimental S2K</td>
                <td class="text-left" rowspan="1" colspan="1">As appropriate</td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
              </tr>
            </tbody>
          </table>
<p id="section-3.7.1-3">These are described in the subsections below.<a href="#section-3.7.1-3" class="pilcrow">¶</a></p>
<div id="s2k-simple">
<section id="section-3.7.1.1">
            <h5 id="name-simple-s2k">
<a href="#section-3.7.1.1" class="section-number selfRef">3.7.1.1. </a><a href="#name-simple-s2k" class="section-name selfRef">Simple S2K</a>
            </h5>
<p id="section-3.7.1.1-1">This directly hashes the string to produce the key data.
See below for how this hashing is done.<a href="#section-3.7.1.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.1-2">
<pre>
  Octet 0:        0x00
  Octet 1:        hash algorithm
</pre><a href="#section-3.7.1.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.7.1.1-3">Simple S2K hashes the passphrase to produce the session key.
The manner in which this is done depends on the size of the session key (which will depend on the cipher used) and the size of the hash algorithm's output.
If the hash size is greater than the session key size, the high-order (leftmost) octets of the hash are used as the key.<a href="#section-3.7.1.1-3" class="pilcrow">¶</a></p>
<p id="section-3.7.1.1-4">If the hash size is less than the key size, multiple instances of the hash context are created -- enough to produce the required key data.
These instances are preloaded with 0, 1, 2, ...
octets of zeros (that is to say, the first instance has no preloading, the second gets preloaded with 1 octet of zero, the third is preloaded with two octets of zeros, and so forth).<a href="#section-3.7.1.1-4" class="pilcrow">¶</a></p>
<p id="section-3.7.1.1-5">As the data is hashed, it is given independently to each hash context.
Since the contexts have been initialized differently, they will each produce different hash output.
Once the passphrase is hashed, the output data from the multiple hashes is concatenated, first hash leftmost, to produce the key data, with any excess octets on the right discarded.<a href="#section-3.7.1.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="s2k-salted">
<section id="section-3.7.1.2">
            <h5 id="name-salted-s2k">
<a href="#section-3.7.1.2" class="section-number selfRef">3.7.1.2. </a><a href="#name-salted-s2k" class="section-name selfRef">Salted S2K</a>
            </h5>
<p id="section-3.7.1.2-1">This includes a "salt" value in the S2K specifier -- some arbitrary data -- that gets hashed along with the passphrase string, to help prevent dictionary attacks.<a href="#section-3.7.1.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.2-2">
<pre>
  Octet 0:        0x01
  Octet 1:        hash algorithm
  Octets 2-9:     8-octet salt value
</pre><a href="#section-3.7.1.2-2" class="pilcrow">¶</a>
</div>
<p id="section-3.7.1.2-3">Salted S2K is exactly like Simple S2K, except that the input to the hash function(s) consists of the 8 octets of salt from the S2K specifier, followed by the passphrase.<a href="#section-3.7.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="s2k-iter-salted">
<section id="section-3.7.1.3">
            <h5 id="name-iterated-and-salted-s2k">
<a href="#section-3.7.1.3" class="section-number selfRef">3.7.1.3. </a><a href="#name-iterated-and-salted-s2k" class="section-name selfRef">Iterated and Salted S2K</a>
            </h5>
<p id="section-3.7.1.3-1">This includes both a salt and an octet count.
The salt is combined with the passphrase and the resulting value is hashed repeatedly.
This further increases the amount of work an attacker must do to try dictionary attacks.<a href="#section-3.7.1.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.3-2">
<pre>
  Octet  0:        0x03
  Octet  1:        hash algorithm
  Octets 2-9:      8-octet salt value
  Octet  10:       count, a one-octet, coded value
</pre><a href="#section-3.7.1.3-2" class="pilcrow">¶</a>
</div>
<p id="section-3.7.1.3-3">The count is coded into a one-octet number using the following formula:<a href="#section-3.7.1.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.3-4">
<pre>
  #define EXPBIAS 6
      count = ((Int32)16 + (c &amp; 15)) &lt;&lt; ((c &gt;&gt; 4) + EXPBIAS);
</pre><a href="#section-3.7.1.3-4" class="pilcrow">¶</a>
</div>
<p id="section-3.7.1.3-5">The above formula is in C, where "Int32" is a type for a 32-bit integer, and the variable "c" is the coded count, Octet 10.<a href="#section-3.7.1.3-5" class="pilcrow">¶</a></p>
<p id="section-3.7.1.3-6">Iterated-Salted S2K hashes the passphrase and salt data multiple times.
The total number of octets to be hashed is specified in the encoded count in the S2K specifier.
Note that the resulting count value is an octet count of how many octets will be hashed, not an iteration count.<a href="#section-3.7.1.3-6" class="pilcrow">¶</a></p>
<p id="section-3.7.1.3-7">Initially, one or more hash contexts are set up as with the other S2K algorithms, depending on how many octets of key data are needed.
Then the salt, followed by the passphrase data, is repeatedly hashed until the number of octets specified by the octet count has been hashed.
The one exception is that if the octet count is less than the size of the salt plus passphrase, the full salt plus passphrase will be hashed even though that is greater than the octet count.
After the hashing is done, the data is unloaded from the hash context(s) as with the other S2K algorithms.<a href="#section-3.7.1.3-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="s2k-argon2">
<section id="section-3.7.1.4">
            <h5 id="name-argon2">
<a href="#section-3.7.1.4" class="section-number selfRef">3.7.1.4. </a><a href="#name-argon2" class="section-name selfRef">Argon2</a>
            </h5>
<p id="section-3.7.1.4-1">This S2K method hashes the passphrase using Argon2, specified in <span>[<a href="#RFC9106" class="xref">RFC9106</a>]</span>.
This provides memory-hardness, further protecting the passphrase against brute-force attacks.<a href="#section-3.7.1.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.4-2">
<pre>
  Octet  0:        0x04
  Octets 1-16:     16-octet salt value
  Octet  17:       one-octet number of passes t
  Octet  18:       one-octet degree of parallelism p
  Octet  19:       one-octet exponent indicating the memory size m
</pre><a href="#section-3.7.1.4-2" class="pilcrow">¶</a>
</div>
<p id="section-3.7.1.4-3">The salt SHOULD be unique for each password.<a href="#section-3.7.1.4-3" class="pilcrow">¶</a></p>
<p id="section-3.7.1.4-4">The number of passes t and the degree of parallelism p MUST be non-zero.<a href="#section-3.7.1.4-4" class="pilcrow">¶</a></p>
<p id="section-3.7.1.4-5">The memory size m is 2**encoded_m, where "encoded_m" is the encoded memory size in Octet 19. The encoded memory size MUST be a value from 3+ceil(log_2(p)) to 31, such that the decoded memory size m is a value from 8*p to 2**31.<a href="#section-3.7.1.4-5" class="pilcrow">¶</a></p>
<p id="section-3.7.1.4-6">Argon2 is invoked with the passphrase as P, the salt as S, the values of t, p and m as described above, the required key size as the tag length T, 0x13 as the version v, and Argon2id as the type.<a href="#section-3.7.1.4-6" class="pilcrow">¶</a></p>
<p id="section-3.7.1.4-7">For the recommended values of t, p and m, see Section 4 of <span>[<a href="#RFC9106" class="xref">RFC9106</a>]</span>. If the recommended value of m for a given application is not a power of 2, it is RECOMMENDED to round up to the next power of 2 if the resulting performance would be acceptable, and round down otherwise (keeping in mind that m must be at least 8*p).<a href="#section-3.7.1.4-7" class="pilcrow">¶</a></p>
<p id="section-3.7.1.4-8">As an example, with the first recommended option (t=1, p=4, m=2**21), the full S2K specifier would be:<a href="#section-3.7.1.4-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.1.4-9">
<pre>
  04 XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX
  XX 01 04 15
</pre><a href="#section-3.7.1.4-9" class="pilcrow">¶</a>
</div>
<p id="section-3.7.1.4-10">(where XX represents a random octet of salt).<a href="#section-3.7.1.4-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="string-to-key-usage">
<section id="section-3.7.2">
          <h4 id="name-string-to-key-usage">
<a href="#section-3.7.2" class="section-number selfRef">3.7.2. </a><a href="#name-string-to-key-usage" class="section-name selfRef">String-to-Key Usage</a>
          </h4>
<p id="section-3.7.2-1">Simple S2K and Salted S2K specifiers can be brute-forced when used with a low-entropy string, such as those typically provided by users. In addition, the usage of Simple S2K can lead to key and IV reuse (see <a href="#skesk" class="xref">Section 5.3</a>).
Therefore, when generating S2K specifiers, implementations MUST NOT use Simple S2K, and SHOULD NOT use Salted S2K unless the implementation knows that the string is high-entropy (e.g., it generated the string itself using a known-good source of randomness).
It is RECOMMENDED that implementations use Argon2.<a href="#section-3.7.2-1" class="pilcrow">¶</a></p>
<div id="secret-key-encryption">
<section id="section-3.7.2.1">
            <h5 id="name-secret-key-encryption">
<a href="#section-3.7.2.1" class="section-number selfRef">3.7.2.1. </a><a href="#name-secret-key-encryption" class="section-name selfRef">Secret-Key Encryption</a>
            </h5>
<p id="section-3.7.2.1-1">An S2K specifier can be stored in the secret keyring to specify how to convert the passphrase to a key that unlocks the secret data.
Older versions of PGP just stored a symmetric cipher algorithm octet preceding the secret data or a zero to indicate that the secret data was unencrypted.
The MD5 hash function was always used to convert the passphrase to a key for the specified cipher algorithm.<a href="#section-3.7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2.1-2">For compatibility, when an S2K specifier is used, the special value 253, 254, or 255 is stored in the position where the cipher algorithm octet would have been in the old data structure.
This is then followed immediately by a one-octet algorithm identifier, and then by the S2K specifier as encoded above.<a href="#section-3.7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-3.7.2.1-3">Therefore, preceding the secret data there will be one of these possibilities:<a href="#section-3.7.2.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.7.2.1-4">
<pre>
  0:                 secret data is unencrypted (no passphrase)
  255, 254, or 253:  followed by algorithm octet and S2K specifier
  Cipher alg:        use Simple S2K algorithm using MD5 hash
</pre><a href="#section-3.7.2.1-4" class="pilcrow">¶</a>
</div>
<p id="section-3.7.2.1-5">This last possibility, the cipher algorithm number with an implicit use of MD5 and IDEA, is provided for backward compatibility; it MAY be understood, but SHOULD NOT be generated, and is deprecated.<a href="#section-3.7.2.1-5" class="pilcrow">¶</a></p>
<p id="section-3.7.2.1-6">These are followed by an Initial Vector of the same length as the block size of the cipher for the decryption of the secret values, if they are encrypted, and then the secret-key values themselves.<a href="#section-3.7.2.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="symmetric-key-message-encryption">
<section id="section-3.7.2.2">
            <h5 id="name-symmetric-key-message-encry">
<a href="#section-3.7.2.2" class="section-number selfRef">3.7.2.2. </a><a href="#name-symmetric-key-message-encry" class="section-name selfRef">Symmetric-Key Message Encryption</a>
            </h5>
<p id="section-3.7.2.2-1">OpenPGP can create a Symmetric-key Encrypted Session Key (ESK) packet at the front of a message.
This is used to allow S2K specifiers to be used for the passphrase conversion or to create messages with a mix of symmetric-key ESKs and public-key ESKs.
This allows a message to be decrypted either with a passphrase or a public-key pair.<a href="#section-3.7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.7.2.2-2">PGP 2 always used IDEA with Simple string-to-key conversion when encrypting a message with a symmetric algorithm.
This is deprecated, but MAY be used for backward-compatibility.<a href="#section-3.7.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="packet-syntax">
<section id="section-4">
      <h2 id="name-packet-syntax">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-packet-syntax" class="section-name selfRef">Packet Syntax</a>
      </h2>
<p id="section-4-1">This section describes the packets used by OpenPGP.<a href="#section-4-1" class="pilcrow">¶</a></p>
<div id="overview">
<section id="section-4.1">
        <h3 id="name-overview">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-4.1-1">An OpenPGP message is constructed from a number of records that are traditionally called packets.
A packet is a chunk of data that has a tag specifying its meaning.
An OpenPGP message, keyring, certificate, and so forth consists of a number of packets.
Some of those packets may contain other OpenPGP packets (for example, a compressed data packet, when uncompressed, contains OpenPGP packets).<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Each packet consists of a packet header, followed by the packet body.
The packet header is of variable length.<a href="#section-4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="packet-headers">
<section id="section-4.2">
        <h3 id="name-packet-headers">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-packet-headers" class="section-name selfRef">Packet Headers</a>
        </h3>
<p id="section-4.2-1">The first octet of the packet header is called the "Packet Tag".
It determines the format of the header and denotes the packet contents.
The remainder of the packet header is the length of the packet.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2-2">Note that the most significant bit is the leftmost bit, called bit 7.
A mask for this bit is 0x80 in hexadecimal.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-3">
<pre>
       ┌───────────────┐
  PTag │7 6 5 4 3 2 1 0│
       └───────────────┘
  Bit 7 -- Always one
  Bit 6 -- New packet format if set
</pre><a href="#section-4.2-3" class="pilcrow">¶</a>
</div>
<p id="section-4.2-4">PGP 2.6.x only uses old format packets.
Thus, software that interoperates with those versions of PGP must only use old format packets.
If interoperability is not an issue, the new packet format is RECOMMENDED.
Note that old format packets have four bits of packet tags, and new format packets have six; some features cannot be used and still be backward-compatible.<a href="#section-4.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2-5">Also note that packets with a tag greater than or equal to 16 MUST use new format packets.
The old format packets can only express tags less than or equal to 15.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2-6">Old format packets contain:<a href="#section-4.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-7">
<pre>
  Bits 5-2 -- packet tag
  Bits 1-0 -- length-type
</pre><a href="#section-4.2-7" class="pilcrow">¶</a>
</div>
<p id="section-4.2-8">New format packets contain:<a href="#section-4.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2-9">
<pre>
  Bits 5-0 -- packet tag
</pre><a href="#section-4.2-9" class="pilcrow">¶</a>
</div>
<div id="old-format-packet-lengths">
<section id="section-4.2.1">
          <h4 id="name-old-format-packet-lengths">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-old-format-packet-lengths" class="section-name selfRef">Old Format Packet Lengths</a>
          </h4>
<p id="section-4.2.1-1">The meaning of the length-type in old format packets is:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-4.2.1-2">
            <dt id="section-4.2.1-2.1">0</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.1-2.2">
  The packet has a one-octet length.
The header is 2 octets long.<a href="#section-4.2.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.1-2.3">1</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.1-2.4">
  The packet has a two-octet length.
The header is 3 octets long.<a href="#section-4.2.1-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.1-2.5">2</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.1-2.6">
  The packet has a four-octet length.
The header is 5 octets long.<a href="#section-4.2.1-2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-4.2.1-2.7">3</dt>
            <dd style="margin-left: 1.5em" id="section-4.2.1-2.8">
  The packet is of indeterminate length.
The header is 1 octet long, and the implementation must determine how long the packet is.
If the packet is in a file, this means that the packet extends until the end of the file.
In general, an implementation SHOULD NOT use indeterminate-length packets except where the end of the data will be clear from the context, and even then it is better to use a definite length, or a new format header.
The new format headers described below have a mechanism for precisely encoding data of indeterminate length.<a href="#section-4.2.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="new-format-packet-lengths">
<section id="section-4.2.2">
          <h4 id="name-new-format-packet-lengths">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-new-format-packet-lengths" class="section-name selfRef">New Format Packet Lengths</a>
          </h4>
<p id="section-4.2.2-1">New format packets have four possible ways of encoding length:<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.2.2-2">
<li id="section-4.2.2-2.1">A one-octet Body Length header encodes packet lengths of up to 191 octets.<a href="#section-4.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.2-2.2">A two-octet Body Length header encodes packet lengths of 192 to 8383 octets.<a href="#section-4.2.2-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.2-2.3">A five-octet Body Length header encodes packet lengths of up to 4,294,967,295 (0xFFFFFFFF) octets in length.
(This actually encodes a four-octet scalar number.)<a href="#section-4.2.2-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-4.2.2-2.4">When the length of the packet body is not known in advance by the issuer, Partial Body Length headers encode a packet of indeterminate length, effectively making it a stream.<a href="#section-4.2.2-2.4" class="pilcrow">¶</a>
</li>
          </ol>
<div id="one-octet-lengths">
<section id="section-4.2.2.1">
            <h5 id="name-one-octet-lengths">
<a href="#section-4.2.2.1" class="section-number selfRef">4.2.2.1. </a><a href="#name-one-octet-lengths" class="section-name selfRef">One-Octet Lengths</a>
            </h5>
<p id="section-4.2.2.1-1">A one-octet Body Length header encodes a length of 0 to 191 octets.
This type of length header is recognized because the one octet value is less than 192.
The body length is equal to:<a href="#section-4.2.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2.1-2">
<pre>
  bodyLen = 1st_octet;
</pre><a href="#section-4.2.2.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="two-octet-lengths">
<section id="section-4.2.2.2">
            <h5 id="name-two-octet-lengths">
<a href="#section-4.2.2.2" class="section-number selfRef">4.2.2.2. </a><a href="#name-two-octet-lengths" class="section-name selfRef">Two-Octet Lengths</a>
            </h5>
<p id="section-4.2.2.2-1">A two-octet Body Length header encodes a length of 192 to 8383 octets.
It is recognized because its first octet is in the range 192 to 223.
The body length is equal to:<a href="#section-4.2.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2.2-2">
<pre>
  bodyLen = ((1st_octet - 192) &lt;&lt; 8) + (2nd_octet) + 192
</pre><a href="#section-4.2.2.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="five-octet-lengths">
<section id="section-4.2.2.3">
            <h5 id="name-five-octet-lengths">
<a href="#section-4.2.2.3" class="section-number selfRef">4.2.2.3. </a><a href="#name-five-octet-lengths" class="section-name selfRef">Five-Octet Lengths</a>
            </h5>
<p id="section-4.2.2.3-1">A five-octet Body Length header consists of a single octet holding the value 255, followed by a four-octet scalar.
The body length is equal to:<a href="#section-4.2.2.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2.3-2">
<pre>
  bodyLen = (2nd_octet &lt;&lt; 24) | (3rd_octet &lt;&lt; 16) |
            (4th_octet &lt;&lt; 8)  | 5th_octet
</pre><a href="#section-4.2.2.3-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.2.3-3">This basic set of one, two, and five-octet lengths is also used internally to some packets.<a href="#section-4.2.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="partial-body-lengths">
<section id="section-4.2.2.4">
            <h5 id="name-partial-body-lengths">
<a href="#section-4.2.2.4" class="section-number selfRef">4.2.2.4. </a><a href="#name-partial-body-lengths" class="section-name selfRef">Partial Body Lengths</a>
            </h5>
<p id="section-4.2.2.4-1">A Partial Body Length header is one octet long and encodes the length of only part of the data packet.
This length is a power of 2, from 1 to 1,073,741,824 (2 to the 30th power).
It is recognized by its one octet value that is greater than or equal to 224, and less than 255.
The Partial Body Length is equal to:<a href="#section-4.2.2.4-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4.2.2.4-2">
<pre>
  partialBodyLen = 1 &lt;&lt; (1st_octet &amp; 0x1F);
</pre><a href="#section-4.2.2.4-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.2.4-3">Each Partial Body Length header is followed by a portion of the packet body data.
The Partial Body Length header specifies this portion's length.
Another length header (one octet, two-octet, five-octet, or partial) follows that portion.
The last length header in the packet MUST NOT be a Partial Body Length header.
Partial Body Length headers may only be used for the non-final parts of the packet.<a href="#section-4.2.2.4-3" class="pilcrow">¶</a></p>
<p id="section-4.2.2.4-4">Note also that the last Body Length header can be a zero-length header.<a href="#section-4.2.2.4-4" class="pilcrow">¶</a></p>
<p id="section-4.2.2.4-5">An implementation MAY use Partial Body Lengths for data packets, be they literal, compressed, or encrypted.
The first partial length MUST be at least 512 octets long.
Partial Body Lengths MUST NOT be used for any other packet types.<a href="#section-4.2.2.4-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-length-examples">
<section id="section-4.2.3">
          <h4 id="name-packet-length-examples">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-packet-length-examples" class="section-name selfRef">Packet Length Examples</a>
          </h4>
<p id="section-4.2.3-1">These examples show ways that new format packets might encode the packet lengths.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">A packet with length 100 may have its length encoded in one octet: 0x64.
This is followed by 100 octets of data.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
<p id="section-4.2.3-3">A packet with length 1723 may have its length encoded in two octets: 0xC5, 0xFB.
This header is followed by the 1723 octets of data.<a href="#section-4.2.3-3" class="pilcrow">¶</a></p>
<p id="section-4.2.3-4">A packet with length 100000 may have its length encoded in five octets: 0xFF, 0x00, 0x01, 0x86, 0xA0.<a href="#section-4.2.3-4" class="pilcrow">¶</a></p>
<p id="section-4.2.3-5">It might also be encoded in the following octet stream: 0xEF, first 32768 octets of data; 0xE1, next two octets of data; 0xE0, next one octet of data; 0xF0, next 65536 octets of data; 0xC5, 0xDD, last 1693 octets of data.
This is just one possible encoding, and many variations are possible on the size of the Partial Body Length headers, as long as a regular Body Length header encodes the last portion of the data.<a href="#section-4.2.3-5" class="pilcrow">¶</a></p>
<p id="section-4.2.3-6">Please note that in all of these explanations, the total length of the packet is the length of the header(s) plus the length of the body.<a href="#section-4.2.3-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-tags">
<section id="section-4.3">
        <h3 id="name-packet-tags">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-packet-tags" class="section-name selfRef">Packet Tags</a>
        </h3>
<p id="section-4.3-1">The packet tag denotes what type of packet the body holds.
Note that old format headers can only have tags less than 16, whereas new format headers can have tags as great as 63.
The defined tags (in decimal) are as follows:<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<span id="name-packet-type-registry"></span><table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-packet-type-registry" class="selfRef">Packet type registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Tag</th>
              <th class="text-left" rowspan="1" colspan="1">Packet Type</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved - a packet tag MUST NOT have this value</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Public-Key Encrypted Session Key Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Signature Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Symmetric-Key Encrypted Session Key Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">One-Pass Signature Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">Secret-Key Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">Public-Key Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">Secret-Subkey Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">Compressed Data Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">Symmetrically Encrypted Data Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">Marker Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">Literal Data Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">Trust Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">13</td>
              <td class="text-left" rowspan="1" colspan="1">User ID Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">14</td>
              <td class="text-left" rowspan="1" colspan="1">Public-Subkey Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">17</td>
              <td class="text-left" rowspan="1" colspan="1">User Attribute Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">18</td>
              <td class="text-left" rowspan="1" colspan="1">Sym. Encrypted and Integrity Protected Data Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">19</td>
              <td class="text-left" rowspan="1" colspan="1">Modification Detection Code Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">20</td>
              <td class="text-left" rowspan="1" colspan="1">AEAD Encrypted Data Packet</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">60 to 63</td>
              <td class="text-left" rowspan="1" colspan="1">Private or Experimental Values</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="packet-types">
<section id="section-5">
      <h2 id="name-packet-types">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-packet-types" class="section-name selfRef">Packet Types</a>
      </h2>
<div id="public-key-encrypted-session-key-packets-tag-1">
<section id="section-5.1">
        <h3 id="name-public-key-encrypted-sessio">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-public-key-encrypted-sessio" class="section-name selfRef">Public-Key Encrypted Session Key Packets (Tag 1)</a>
        </h3>
<p id="section-5.1-1">Zero or more Public-Key Encrypted Session Key packets and/or Symmetric-Key Encrypted Session Key packets may precede an encryption container (i.e. a Symmetrically Encrypted Integrity Protected Data packet, an AEAD Encrypted Data packet, or -- for historic data -- a Symmetrically Encrypted Data packet), which holds an encrypted message.
The message is encrypted with the session key, and the session key is itself encrypted and stored in the Encrypted Session Key packet(s).
The encryption container is preceded by one Public-Key Encrypted Session Key packet for each OpenPGP key to which the message is encrypted.
The recipient of the message finds a session key that is encrypted to their public key, decrypts the session key, and then uses the session key to decrypt the message.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The body of this packet consists of:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.1-3.1">A one-octet number giving the version number of the packet type.
The currently defined value for packet version is 3.<a href="#section-5.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-3.2">An eight-octet number that gives the Key ID of the public key to which the session key is encrypted.
If the session key is encrypted to a subkey, then the Key ID of this subkey is used here instead of the Key ID of the primary key.<a href="#section-5.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-3.3">A one-octet number giving the public-key algorithm used.<a href="#section-5.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.1-3.4">A string of octets that is the encrypted session key.
This string takes up the remainder of the packet, and its contents are dependent on the public-key algorithm used.<a href="#section-5.1-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<div id="pkesk-rsa">
<section id="section-5.1.1">
          <h4 id="name-algorithm-specific-fields-f">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-algorithm-specific-fields-f" class="section-name selfRef">Algorithm Specific Fields for RSA encryption</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.1-1.1">Multiprecision integer (MPI) of RSA-encrypted value m**e mod n.<a href="#section-5.1.1-1.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="pkesk-elgamal">
<section id="section-5.1.2">
          <h4 id="name-algorithm-specific-fields-fo">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-algorithm-specific-fields-fo" class="section-name selfRef">Algorithm Specific Fields for Elgamal encryption</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.2-1.1">MPI of Elgamal (Diffie-Hellman) value g**k mod p.<a href="#section-5.1.2-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.2-1.2">MPI of Elgamal (Diffie-Hellman) value m * y**k mod p.<a href="#section-5.1.2-1.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="pkesk-ecdh">
<section id="section-5.1.3">
          <h4 id="name-algorithm-specific-fields-for">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-algorithm-specific-fields-for" class="section-name selfRef">Algorithm-Specific Fields for ECDH encryption</a>
          </h4>
<ul class="normal">
<li class="normal" id="section-5.1.3-1.1">MPI of an EC point representing an ephemeral public key, in the point format associated with the curve as specified in <a href="#ec-curves" class="xref">Section 9.2</a>.<a href="#section-5.1.3-1.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.1.3-1.2">A one-octet size, followed by a symmetric key encoded using the method described in <a href="#ec-dh-algorithm-ecdh" class="xref">Section 13.5</a>.<a href="#section-5.1.3-1.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="notes-on-pkesk">
<section id="section-5.1.4">
          <h4 id="name-notes-on-pkesk">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-notes-on-pkesk" class="section-name selfRef">Notes on PKESK</a>
          </h4>
<p id="section-5.1.4-1">The value "m" in the above formulas is derived from the session key as follows.
First, the session key is prefixed with a one-octet algorithm identifier that specifies the symmetric encryption algorithm used to encrypt the following encryption container.
Then a two-octet checksum is appended, which is equal to the sum of the preceding session key octets, not including the algorithm identifier, modulo 65536.
This value is then encoded as described in PKCS#1 block encoding EME-PKCS1-v1_5 in Section 7.2.1 of <span>[<a href="#RFC3447" class="xref">RFC3447</a>]</span> to form the "m" value used in the formulas above.
See <a href="#pkcs-encoding" class="xref">Section 14.1</a> in this document for notes on OpenPGP's use of PKCS#1.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
<p id="section-5.1.4-2">Note that when an implementation forms several PKESKs with one session key, forming a message that can be decrypted by several keys, the implementation MUST make a new PKCS#1 encoding for each key.<a href="#section-5.1.4-2" class="pilcrow">¶</a></p>
<p id="section-5.1.4-3">An implementation MAY accept or use a Key ID of zero as a "wild card" or "speculative" Key ID.
In this case, the receiving implementation would try all available private keys, checking for a valid decrypted session key.
This format helps reduce traffic analysis of messages.<a href="#section-5.1.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="signature-packet">
<section id="section-5.2">
        <h3 id="name-signature-packet-tag-2">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-signature-packet-tag-2" class="section-name selfRef">Signature Packet (Tag 2)</a>
        </h3>
<p id="section-5.2-1">A Signature packet describes a binding between some public key and some data.
The most common signatures are a signature of a file or a block of text, and a signature that is a certification of a User ID.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Three versions of Signature packets are defined.
Version 3 provides basic signature information, while versions 4 and 5 provide an expandable format with subpackets that can specify more information about the signature.
PGP 2.6.x only accepts version 3 signatures.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">Implementations MUST generate version 5 signatures when using a version 5 key.
Implementations SHOULD generate V4 signatures with version 4 keys.
Implementations MUST NOT create version 3 signatures; they MAY accept version 3 signatures.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div id="signature-types">
<section id="section-5.2.1">
          <h4 id="name-signature-types">
<a href="#section-5.2.1" class="section-number selfRef">5.2.1. </a><a href="#name-signature-types" class="section-name selfRef">Signature Types</a>
          </h4>
<p id="section-5.2.1-1">There are a number of possible meanings for a signature, which are indicated in a signature type octet in any given signature.
Please note that the vagueness of these meanings is not a flaw, but a feature of the system.
Because OpenPGP places final authority for validity upon the receiver of a signature, it may be that one signer's casual act might be more rigorous than some other authority's positive act.
See <a href="#computing-signatures" class="xref">Section 5.2.4</a> for detailed information on how to compute and verify signatures of each type.<a href="#section-5.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.1-2">These meanings are as follows:<a href="#section-5.2.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-5.2.1-3">
            <dt id="section-5.2.1-3.1">0x00: Signature of a binary document.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.2">
  This means the signer owns it, created it, or certifies that it has not been modified.<a href="#section-5.2.1-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.3">0x01: Signature of a canonical text document.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.4">
  This means the signer owns it, created it, or certifies that it has not been modified.
The signature is calculated over the text data with its line endings converted to &lt;CR&gt;&lt;LF&gt;.<a href="#section-5.2.1-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.5">0x02: Standalone signature.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.6">
  This signature is a signature of only its own subpacket contents.
It is calculated identically to a signature over a zero-length binary document.
Note that it doesn't make sense to have a V3 standalone signature.<a href="#section-5.2.1-3.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.7">0x10: Generic certification of a User ID and Public-Key packet.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.8">
  The issuer of this certification does not make any particular assertion as to how well the certifier has checked that the owner of the key is in fact the person described by the User ID.<a href="#section-5.2.1-3.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.9">0x11: Persona certification of a User ID and Public-Key packet.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.10">
  The issuer of this certification has not done any verification of the claim that the owner of this key is the User ID specified.<a href="#section-5.2.1-3.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.11">0x12: Casual certification of a User ID and Public-Key packet.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.12">
  The issuer of this certification has done some casual verification of the claim of identity.<a href="#section-5.2.1-3.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.13">0x13: Positive certification of a User ID and Public-Key packet.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.14">
  The issuer of this certification has done substantial verification of the claim of identity.

Most OpenPGP implementations make their "key signatures" as 0x10 certifications.
Some implementations can issue 0x11-0x13 certifications, but few differentiate between the types.<a href="#section-5.2.1-3.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.15">0x18: Subkey Binding Signature.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.16">
  This signature is a statement by the top-level signing key that indicates that it owns the subkey.
This signature is calculated directly on the primary key and subkey, and not on any User ID or other packets.
A signature that binds a signing subkey MUST have an Embedded Signature subpacket in this binding signature that contains a 0x19 signature made by the signing subkey on the primary key and subkey.<a href="#section-5.2.1-3.16" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.17">0x19: Primary Key Binding Signature.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.18">
  This signature is a statement by a signing subkey, indicating that it is owned by the primary key and subkey.
This signature is calculated the same way as a 0x18 signature: directly on the primary key and subkey, and not on any User ID or other packets.<a href="#section-5.2.1-3.18" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.19">0x1F: Signature directly on a key.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.20">
  This signature is calculated directly on a key.
It binds the information in the Signature subpackets to the key, and is appropriate to be used for subpackets that provide information about the key, such as the Revocation Key subpacket.
It is also appropriate for statements that non-self certifiers want to make about the key itself, rather than the binding between a key and a name.<a href="#section-5.2.1-3.20" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.21">0x20: Key revocation signature.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.22">
  The signature is calculated directly on the key being revoked.
A revoked key is not to be used.
Only revocation signatures by the key being revoked, or by an authorized revocation key, should be considered valid revocation signatures.<a href="#section-5.2.1-3.22" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.23">0x28: Subkey revocation signature.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.24">
  The signature is calculated directly on the subkey being revoked.
A revoked subkey is not to be used.
Only revocation signatures by the top-level signature key that is bound to this subkey, or by an authorized revocation key, should be considered valid revocation signatures.<a href="#section-5.2.1-3.24" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.25">0x30: Certification revocation signature.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.26">
  This signature revokes an earlier User ID certification signature (signature class 0x10 through 0x13) or direct-key signature (0x1F).
It should be issued by the same key that issued the revoked signature or an authorized revocation key.
The signature is computed over the same data as the certificate that it revokes, and should have a later creation date than that certificate.<a href="#section-5.2.1-3.26" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.27">0x40: Timestamp signature.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.28">
  This signature is only meaningful for the timestamp contained in it.<a href="#section-5.2.1-3.28" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-5.2.1-3.29">0x50: Third-Party Confirmation signature.</dt>
            <dd style="margin-left: 1.5em" id="section-5.2.1-3.30">
  This signature is a signature over some other OpenPGP Signature packet(s).
It is analogous to a notary seal on the signed data.
A third-party signature SHOULD include Signature Target subpacket(s) to give easy identification.
Note that we really do mean SHOULD.
There are plausible uses for this (such as a blind party that only sees the signature, not the key or source document) that cannot include a target subpacket.<a href="#section-5.2.1-3.30" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</div>
<div id="version-three-sig">
<section id="section-5.2.2">
          <h4 id="name-version-3-signature-packet-">
<a href="#section-5.2.2" class="section-number selfRef">5.2.2. </a><a href="#name-version-3-signature-packet-" class="section-name selfRef">Version 3 Signature Packet Format</a>
          </h4>
<p id="section-5.2.2-1">The body of a version 3 Signature Packet contains:<a href="#section-5.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.1">One-octet version number (3).<a href="#section-5.2.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-2.2">
              <p id="section-5.2.2-2.2.1">One-octet length of following hashed material.
MUST be 5.<a href="#section-5.2.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-2.2.2.1">One-octet signature type.<a href="#section-5.2.2-2.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.2-2.2.2.2">Four-octet creation time.<a href="#section-5.2.2-2.2.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.2.2-2.3">Eight-octet Key ID of signer.<a href="#section-5.2.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-2.4">One-octet public-key algorithm.<a href="#section-5.2.2-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-2.5">One-octet hash algorithm.<a href="#section-5.2.2-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-2.6">Two-octet field holding left 16 bits of signed hash value.<a href="#section-5.2.2-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-2.7">One or more multiprecision integers comprising the signature.
This portion is algorithm specific, as described below.<a href="#section-5.2.2-2.7" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.2.2-3">The concatenation of the data to be signed, the signature type, and creation time from the Signature packet (5 additional octets) is hashed.
The resulting hash value is used in the signature algorithm.
The high 16 bits (first two octets) of the hash are included in the Signature packet to provide a way to reject some invalid signatures without performing a signature verification.<a href="#section-5.2.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2.2-4">Algorithm-Specific Fields for RSA signatures:<a href="#section-5.2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-5.1">Multiprecision integer (MPI) of RSA signature value m**d mod n.<a href="#section-5.2.2-5.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.2.2-6">Algorithm-Specific Fields for DSA and ECDSA signatures:<a href="#section-5.2.2-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.2-7.1">MPI of DSA or ECDSA value r.<a href="#section-5.2.2-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.2-7.2">MPI of DSA or ECDSA value s.<a href="#section-5.2.2-7.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.2.2-8">The signature calculation is based on a hash of the signed data, as described above.
The details of the calculation are different for DSA signatures than for RSA signatures.<a href="#section-5.2.2-8" class="pilcrow">¶</a></p>
<p id="section-5.2.2-9">With RSA signatures, the hash value is encoded using PKCS#1 encoding type EMSA-PKCS1-v1_5 as described in Section 9.2 of <span>[<a href="#RFC3447" class="xref">RFC3447</a>]</span>.
This requires inserting the hash value as an octet string into an ASN.1 structure.
The object identifier for the type of hash being used is included in the structure.
The hexadecimal representations for the currently defined hash algorithms are as follows:<a href="#section-5.2.2-9" class="pilcrow">¶</a></p>
<span id="name-hash-hexadecimal-representa"></span><table class="center" id="table-3">
            <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-hash-hexadecimal-representa" class="selfRef">Hash hexadecimal representations</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">algorithm</th>
                <th class="text-left" rowspan="1" colspan="1">hexadecimal represenatation</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">MD5</td>
                <td class="text-left" rowspan="1" colspan="1">0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x02, 0x05</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">RIPEMD-160</td>
                <td class="text-left" rowspan="1" colspan="1">0x2B, 0x24, 0x03, 0x02, 0x01</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA-1</td>
                <td class="text-left" rowspan="1" colspan="1">0x2B, 0x0E, 0x03, 0x02, 0x1A</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA224</td>
                <td class="text-left" rowspan="1" colspan="1">0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x04</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA256</td>
                <td class="text-left" rowspan="1" colspan="1">0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x01</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA384</td>
                <td class="text-left" rowspan="1" colspan="1">0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x02</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA512</td>
                <td class="text-left" rowspan="1" colspan="1">0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x03</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.2.2-11">The ASN.1 Object Identifiers (OIDs) are as follows:<a href="#section-5.2.2-11" class="pilcrow">¶</a></p>
<span id="name-hash-oids"></span><table class="center" id="table-4">
            <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-hash-oids" class="selfRef">Hash OIDs</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">algorithm</th>
                <th class="text-left" rowspan="1" colspan="1">OID</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">MD5</td>
                <td class="text-left" rowspan="1" colspan="1">1.2.840.113549.2.5</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">RIPEMD-160</td>
                <td class="text-left" rowspan="1" colspan="1">1.3.36.3.2.1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA-1</td>
                <td class="text-left" rowspan="1" colspan="1">1.3.14.3.2.26</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA224</td>
                <td class="text-left" rowspan="1" colspan="1">2.16.840.1.101.3.4.2.4</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA256</td>
                <td class="text-left" rowspan="1" colspan="1">2.16.840.1.101.3.4.2.1</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA384</td>
                <td class="text-left" rowspan="1" colspan="1">2.16.840.1.101.3.4.2.2</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA512</td>
                <td class="text-left" rowspan="1" colspan="1">2.16.840.1.101.3.4.2.3</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.2.2-13">The full hash prefixes for these are as follows:<a href="#section-5.2.2-13" class="pilcrow">¶</a></p>
<span id="name-hash-hexadecimal-prefixes"></span><table class="center" id="table-5">
            <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-hash-hexadecimal-prefixes" class="selfRef">Hash hexadecimal prefixes</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">algorithm</th>
                <th class="text-left" rowspan="1" colspan="1">full hash prefix</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">MD5</td>
                <td class="text-left" rowspan="1" colspan="1">0x30, 0x20, 0x30, 0x0C, 0x06, 0x08, 0x2A, 0x86, 0x48, 0x86, 0xF7, 0x0D, 0x02, 0x05, 0x05, 0x00, 0x04, 0x10</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">RIPEMD-160</td>
                <td class="text-left" rowspan="1" colspan="1">0x30, 0x21, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x24, 0x03, 0x02, 0x01, 0x05, 0x00, 0x04, 0x14</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA-1</td>
                <td class="text-left" rowspan="1" colspan="1">0x30, 0x21, 0x30, 0x09, 0x06, 0x05, 0x2B, 0x0E, 0x03, 0x02, 0x1A, 0x05, 0x00, 0x04, 0x14</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA224</td>
                <td class="text-left" rowspan="1" colspan="1">0x30, 0x2D, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x04, 0x05, 0x00, 0x04, 0x1C</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA256</td>
                <td class="text-left" rowspan="1" colspan="1">0x30, 0x31, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x01, 0x05, 0x00, 0x04, 0x20</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA384</td>
                <td class="text-left" rowspan="1" colspan="1">0x30, 0x41, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x02, 0x05, 0x00, 0x04, 0x30</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">SHA512</td>
                <td class="text-left" rowspan="1" colspan="1">0x30, 0x51, 0x30, 0x0D, 0x06, 0x09, 0x60, 0x86, 0x48, 0x01, 0x65, 0x03, 0x04, 0x02, 0x03, 0x05, 0x00, 0x04, 0x40</td>
              </tr>
            </tbody>
          </table>
<p id="section-5.2.2-15">DSA signatures MUST use hashes that are equal in size to the number of bits of q, the group generated by the DSA key's generator value.<a href="#section-5.2.2-15" class="pilcrow">¶</a></p>
<p id="section-5.2.2-16">If the output size of the chosen hash is larger than the number of bits of q, the hash result is truncated to fit by taking the number of leftmost bits equal to the number of bits of q.
This (possibly truncated) hash function result is treated as a number and used directly in the DSA signature algorithm.<a href="#section-5.2.2-16" class="pilcrow">¶</a></p>
</section>
</div>
<div id="version-4-and-5-signature-packet-formats">
<section id="section-5.2.3">
          <h4 id="name-version-4-and-5-signature-p">
<a href="#section-5.2.3" class="section-number selfRef">5.2.3. </a><a href="#name-version-4-and-5-signature-p" class="section-name selfRef">Version 4 and 5 Signature Packet Formats</a>
          </h4>
<p id="section-5.2.3-1">The body of a V4 or V5 Signature packet contains:<a href="#section-5.2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3-2.1">One-octet version number.
This is 4 for V4 signatures and 5 for V5 signatures.<a href="#section-5.2.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.3-2.2">One-octet signature type.<a href="#section-5.2.3-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.3-2.3">One-octet public-key algorithm.<a href="#section-5.2.3-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.3-2.4">One-octet hash algorithm.<a href="#section-5.2.3-2.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.3-2.5">Two-octet scalar octet count for following hashed subpacket data.
Note that this is the length in octets of all of the hashed subpackets; a pointer incremented by this number will skip over the hashed subpackets.<a href="#section-5.2.3-2.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.3-2.6">Hashed subpacket data set (zero or more subpackets).<a href="#section-5.2.3-2.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.3-2.7">Two-octet scalar octet count for the following unhashed subpacket data.
Note that this is the length in octets of all of the unhashed subpackets; a pointer incremented by this number will skip over the unhashed subpackets.<a href="#section-5.2.3-2.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.3-2.8">Unhashed subpacket data set (zero or more subpackets).<a href="#section-5.2.3-2.8" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.3-2.9">Two-octet field holding the left 16 bits of the signed hash value.<a href="#section-5.2.3-2.9" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.3-2.10">One or more multiprecision integers comprising the signature.
This portion is algorithm specific:<a href="#section-5.2.3-2.10" class="pilcrow">¶</a>
</li>
          </ul>
<div id="sig-rsa">
<section id="section-5.2.3.1">
            <h5 id="name-algorithm-specific-fields-for-">
<a href="#section-5.2.3.1" class="section-number selfRef">5.2.3.1. </a><a href="#name-algorithm-specific-fields-for-" class="section-name selfRef">Algorithm-Specific Fields for RSA signatures</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-5.2.3.1-1.1">Multiprecision integer (MPI) of RSA signature value m**d mod n.<a href="#section-5.2.3.1-1.1" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="sig-dsa">
<section id="section-5.2.3.2">
            <h5 id="name-algorithm-specific-fields-for-d">
<a href="#section-5.2.3.2" class="section-number selfRef">5.2.3.2. </a><a href="#name-algorithm-specific-fields-for-d" class="section-name selfRef">Algorithm-Specific Fields for DSA or ECDSA signatures</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-5.2.3.2-1.1">MPI of DSA or ECDSA value r.<a href="#section-5.2.3.2-1.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.3.2-1.2">MPI of DSA or ECDSA value s.<a href="#section-5.2.3.2-1.2" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="sig-eddsa">
<section id="section-5.2.3.3">
            <h5 id="name-algorithm-specific-fields-for-e">
<a href="#section-5.2.3.3" class="section-number selfRef">5.2.3.3. </a><a href="#name-algorithm-specific-fields-for-e" class="section-name selfRef">Algorithm-Specific Fields for EdDSA signatures</a>
            </h5>
<ul class="normal">
<li class="normal" id="section-5.2.3.3-1.1">Two MPI-encoded values, whose contents and formatting depend on the choice of curve used (see <a href="#curve-specific-formats" class="xref">Section 9.2.1</a>).<a href="#section-5.2.3.3-1.1" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.2.3.3-2">A version 3 signature MUST NOT be created and MUST NOT be used with EdDSA.<a href="#section-5.2.3.3-2" class="pilcrow">¶</a></p>
<div id="algorithm-specific-fields-for-ed25519-signatures">
<section id="section-5.2.3.3.1">
              <h6 id="name-algorithm-specific-fields-for-ed">
<a href="#section-5.2.3.3.1" class="section-number selfRef">5.2.3.3.1. </a><a href="#name-algorithm-specific-fields-for-ed" class="section-name selfRef">Algorithm-Specific Fields for Ed25519 signatures</a>
              </h6>
<p id="section-5.2.3.3.1-1">The two MPIs for Ed25519 use octet strings R and S as described in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.<a href="#section-5.2.3.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3.3.1-2.1">MPI of an EC point R, represented as a (non-prefixed) native (little-endian) octet string up to 32 octets.<a href="#section-5.2.3.3.1-2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.3.3.1-2.2">MPI of EdDSA value S, also in (non-prefixed) native little-endian format with a length up to 32 octets.<a href="#section-5.2.3.3.1-2.2" class="pilcrow">¶</a>
</li>
              </ul>
</section>
</div>
<div id="algorithm-specific-fields-for-ed448-signatures">
<section id="section-5.2.3.3.2">
              <h6 id="name-algorithm-specific-fields-for-ed4">
<a href="#section-5.2.3.3.2" class="section-number selfRef">5.2.3.3.2. </a><a href="#name-algorithm-specific-fields-for-ed4" class="section-name selfRef">Algorithm-Specific Fields for Ed448 signatures</a>
              </h6>
<p id="section-5.2.3.3.2-1">For Ed448 signatures, the native signature format is used as described in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.  The two MPIs are composed as follows:<a href="#section-5.2.3.3.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3.3.2-2.1">The first MPI has a body of 58 octets: a prefix 0x40 octet, followed by 57 octets of the native signature.<a href="#section-5.2.3.3.2-2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.3.3.2-2.2">The second MPI is set to 0 (this is a placeholder, and is unused).
Note that an MPI with a value of 0 is encoded on the wire as a pair of zero octets: <code>00 00</code>.<a href="#section-5.2.3.3.2-2.2" class="pilcrow">¶</a>
</li>
              </ul>
</section>
</div>
</section>
</div>
<div id="notes-on-signatures">
<section id="section-5.2.3.4">
            <h5 id="name-notes-on-signatures">
<a href="#section-5.2.3.4" class="section-number selfRef">5.2.3.4. </a><a href="#name-notes-on-signatures" class="section-name selfRef">Notes on Signatures</a>
            </h5>
<p id="section-5.2.3.4-1">The concatenation of the data being signed and the signature data from the version number through the hashed subpacket data (inclusive) is hashed.
The resulting hash value is what is signed.
The high 16 bits (first two octets) of the hash are included in the Signature packet to provide a way to reject some invalid signatures without performing a signature verification.<a href="#section-5.2.3.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.4-2">There are two fields consisting of Signature subpackets.
The first field is hashed with the rest of the signature data, while the second is unhashed.
The second set of subpackets is not cryptographically protected by the signature and should include only advisory information.<a href="#section-5.2.3.4-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.4-3">The difference between a V4 and V5 signature is that the latter includes additional meta data.<a href="#section-5.2.3.4-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3.4-4">The algorithms for converting the hash function result to a signature are described in a section below.<a href="#section-5.2.3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-subpacket">
<section id="section-5.2.3.5">
            <h5 id="name-signature-subpacket-specifi">
<a href="#section-5.2.3.5" class="section-number selfRef">5.2.3.5. </a><a href="#name-signature-subpacket-specifi" class="section-name selfRef">Signature Subpacket Specification</a>
            </h5>
<p id="section-5.2.3.5-1">A subpacket data set consists of zero or more Signature subpackets.
In Signature packets, the subpacket data set is preceded by a two-octet scalar count of the length in octets of all the subpackets.
A pointer incremented by this number will skip over the subpacket data set.<a href="#section-5.2.3.5-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.5-2">Each subpacket consists of a subpacket header and a body.
The header consists of:<a href="#section-5.2.3.5-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.3.5-3.1">the subpacket length (1, 2, or 5 octets),<a href="#section-5.2.3.5-3.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.2.3.5-3.2">the subpacket type (1 octet),<a href="#section-5.2.3.5-3.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.2.3.5-4">and is followed by the subpacket-specific data.<a href="#section-5.2.3.5-4" class="pilcrow">¶</a></p>
<p id="section-5.2.3.5-5">The length includes the type octet but not this length.
Its format is similar to the "new" format packet header lengths, but cannot have Partial Body Lengths.
That is:<a href="#section-5.2.3.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.2.3.5-6">
<pre>
if the 1st octet &lt;  192, then
    lengthOfLength = 1
    subpacketLen = 1st_octet

if the 1st octet &gt;= 192 and &lt; 255, then
    lengthOfLength = 2
    subpacketLen = ((1st_octet - 192) &lt;&lt; 8) + (2nd_octet) + 192

if the 1st octet = 255, then
    lengthOfLength = 5
    subpacket length = [four-octet scalar starting at 2nd_octet]
</pre><a href="#section-5.2.3.5-6" class="pilcrow">¶</a>
</div>
<p id="section-5.2.3.5-7">The value of the subpacket type octet may be:<a href="#section-5.2.3.5-7" class="pilcrow">¶</a></p>
<span id="name-subpacket-type-registry"></span><table class="center" id="table-6">
              <caption>
<a href="#table-6" class="selfRef">Table 6</a>:
<a href="#name-subpacket-type-registry" class="selfRef">Subpacket type registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-right" rowspan="1" colspan="1">Type</th>
                  <th class="text-left" rowspan="1" colspan="1">Description</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">Signature Creation Time</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">Signature Expiration Time</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">4</td>
                  <td class="text-left" rowspan="1" colspan="1">Exportable Certification</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">5</td>
                  <td class="text-left" rowspan="1" colspan="1">Trust Signature</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">6</td>
                  <td class="text-left" rowspan="1" colspan="1">Regular Expression</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">7</td>
                  <td class="text-left" rowspan="1" colspan="1">Revocable</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">8</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">9</td>
                  <td class="text-left" rowspan="1" colspan="1">Key Expiration Time</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">10</td>
                  <td class="text-left" rowspan="1" colspan="1">Placeholder for backward compatibility</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">11</td>
                  <td class="text-left" rowspan="1" colspan="1">Preferred Symmetric Algorithms</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">12</td>
                  <td class="text-left" rowspan="1" colspan="1">Revocation Key</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">13 to 15</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">16</td>
                  <td class="text-left" rowspan="1" colspan="1">Issuer</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">17 to 19</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">20</td>
                  <td class="text-left" rowspan="1" colspan="1">Notation Data</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">21</td>
                  <td class="text-left" rowspan="1" colspan="1">Preferred Hash Algorithms</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">22</td>
                  <td class="text-left" rowspan="1" colspan="1">Preferred Compression Algorithms</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">23</td>
                  <td class="text-left" rowspan="1" colspan="1">Key Server Preferences</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">24</td>
                  <td class="text-left" rowspan="1" colspan="1">Preferred Key Server</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">25</td>
                  <td class="text-left" rowspan="1" colspan="1">Primary User ID</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">26</td>
                  <td class="text-left" rowspan="1" colspan="1">Policy URI</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">27</td>
                  <td class="text-left" rowspan="1" colspan="1">Key Flags</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">28</td>
                  <td class="text-left" rowspan="1" colspan="1">Signer's User ID</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">29</td>
                  <td class="text-left" rowspan="1" colspan="1">Reason for Revocation</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">30</td>
                  <td class="text-left" rowspan="1" colspan="1">Features</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">31</td>
                  <td class="text-left" rowspan="1" colspan="1">Signature Target</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">32</td>
                  <td class="text-left" rowspan="1" colspan="1">Embedded Signature</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">33</td>
                  <td class="text-left" rowspan="1" colspan="1">Issuer Fingerprint</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">34</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved (Preferred AEAD Algorithms)</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">35</td>
                  <td class="text-left" rowspan="1" colspan="1">Intended Recipient Fingerprint</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">37</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved (Attested Certifications)</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">38</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved (Key Block)</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">100 to 110</td>
                  <td class="text-left" rowspan="1" colspan="1">Private or experimental</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.5-9">An implementation SHOULD ignore any subpacket of a type that it does not recognize.<a href="#section-5.2.3.5-9" class="pilcrow">¶</a></p>
<p id="section-5.2.3.5-10">Bit 7 of the subpacket type is the "critical" bit.
If set, it denotes that the subpacket is one that is critical for the evaluator of the signature to recognize.
If a subpacket is encountered that is marked critical but is unknown to the evaluating software, the evaluator SHOULD consider the signature to be in error.<a href="#section-5.2.3.5-10" class="pilcrow">¶</a></p>
<p id="section-5.2.3.5-11">An evaluator may "recognize" a subpacket, but not implement it.
The purpose of the critical bit is to allow the signer to tell an evaluator that it would prefer a new, unknown feature to generate an error than be ignored.<a href="#section-5.2.3.5-11" class="pilcrow">¶</a></p>
<p id="section-5.2.3.5-12">Implementations SHOULD implement the three preferred algorithm subpackets (11, 21, and 22), as well as the "Reason for Revocation" subpacket.
Note, however, that if an implementation chooses not to implement some of the preferences, it is required to behave in a polite manner to respect the wishes of those users who do implement these preferences.<a href="#section-5.2.3.5-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-subpacket-types">
<section id="section-5.2.3.6">
            <h5 id="name-signature-subpacket-types">
<a href="#section-5.2.3.6" class="section-number selfRef">5.2.3.6. </a><a href="#name-signature-subpacket-types" class="section-name selfRef">Signature Subpacket Types</a>
            </h5>
<p id="section-5.2.3.6-1">A number of subpackets are currently defined.
Some subpackets apply to the signature itself and some are attributes of the key.
Subpackets that are found on a self-signature are placed on a certification made by the key itself.
Note that a key may have more than one User ID, and thus may have more than one self-signature, and differing subpackets.<a href="#section-5.2.3.6-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.6-2">A subpacket may be found either in the hashed or unhashed subpacket sections of a signature.
If a subpacket is not hashed, then the information in it cannot be considered definitive because it is not part of the signature proper.<a href="#section-5.2.3.6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notes-on-self-signatures">
<section id="section-5.2.3.7">
            <h5 id="name-notes-on-self-signatures">
<a href="#section-5.2.3.7" class="section-number selfRef">5.2.3.7. </a><a href="#name-notes-on-self-signatures" class="section-name selfRef">Notes on Self-Signatures</a>
            </h5>
<p id="section-5.2.3.7-1">A self-signature is a binding signature made by the key to which the signature refers.
There are three types of self-signatures, the certification signatures (types 0x10-0x13), the direct-key signature (type 0x1F), and the subkey binding signature (type 0x18).
For certification self-signatures, each User ID may have a self-signature, and thus different subpackets in those self-signatures.
For subkey binding signatures, each subkey in fact has a self-signature.
Subpackets that appear in a certification self-signature apply to the user name, and subpackets that appear in the subkey self-signature apply to the subkey.
Lastly, subpackets on the direct-key signature apply to the entire key.<a href="#section-5.2.3.7-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.7-2">Implementing software should interpret a self-signature's preference subpackets as narrowly as possible.
For example, suppose a key has two user names, Alice and Bob.
Suppose that Alice prefers the symmetric algorithm AES-256, and Bob prefers Camellia-256 or AES-128.
If the software locates this key via Alice's name, then the preferred algorithm is AES-256; if software locates the key via Bob's name, then the preferred algorithm is Camellia-256.
If the key is located by Key ID, the algorithm of the primary User ID of the key provides the preferred symmetric algorithm.<a href="#section-5.2.3.7-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.7-3">Revoking a self-signature or allowing it to expire has a semantic meaning that varies with the signature type.
Revoking the self-signature on a User ID effectively retires that user name.
The self-signature is a statement, "My name X is tied to my signing key K" and is corroborated by other users' certifications.
If another user revokes their certification, they are effectively saying that they no longer believe that name and that key are tied together.
Similarly, if the users themselves revoke their self-signature, then the users no longer go by that name, no longer have that email address, etc.
Revoking a binding signature effectively retires that subkey.
Revoking a direct-key signature cancels that signature.
Please see <a href="#reason-for-revocation" class="xref">Section 5.2.3.27</a> for more relevant detail.<a href="#section-5.2.3.7-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3.7-4">Since a self-signature contains important information about the key's use, an implementation SHOULD allow the user to rewrite the self-signature, and important information in it, such as preferences and key expiration.<a href="#section-5.2.3.7-4" class="pilcrow">¶</a></p>
<p id="section-5.2.3.7-5">It is good practice to verify that a self-signature imported into an implementation doesn't advertise features that the implementation doesn't support, rewriting the signature as appropriate.<a href="#section-5.2.3.7-5" class="pilcrow">¶</a></p>
<p id="section-5.2.3.7-6">An implementation that encounters multiple self-signatures on the same object may resolve the ambiguity in any way it sees fit, but it is RECOMMENDED that priority be given to the most recent self-signature.<a href="#section-5.2.3.7-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-creation-time">
<section id="section-5.2.3.8">
            <h5 id="name-signature-creation-time">
<a href="#section-5.2.3.8" class="section-number selfRef">5.2.3.8. </a><a href="#name-signature-creation-time" class="section-name selfRef">Signature Creation Time</a>
            </h5>
<p id="section-5.2.3.8-1">(4-octet time field)<a href="#section-5.2.3.8-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.8-2">The time the signature was made.<a href="#section-5.2.3.8-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.8-3">MUST be present in the hashed area.<a href="#section-5.2.3.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer">
<section id="section-5.2.3.9">
            <h5 id="name-issuer">
<a href="#section-5.2.3.9" class="section-number selfRef">5.2.3.9. </a><a href="#name-issuer" class="section-name selfRef">Issuer</a>
            </h5>
<p id="section-5.2.3.9-1">(8-octet Key ID)<a href="#section-5.2.3.9-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.9-2">The OpenPGP Key ID of the key issuing the signature.
If the version of that key is greater than 4, this subpacket MUST NOT be included in the signature.<a href="#section-5.2.3.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-expiration-time">
<section id="section-5.2.3.10">
            <h5 id="name-key-expiration-time">
<a href="#section-5.2.3.10" class="section-number selfRef">5.2.3.10. </a><a href="#name-key-expiration-time" class="section-name selfRef">Key Expiration Time</a>
            </h5>
<p id="section-5.2.3.10-1">(4-octet time field)<a href="#section-5.2.3.10-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.10-2">The validity period of the key.
This is the number of seconds after the key creation time that the key expires.
If this is not present or has a value of zero, the key never expires.
This is found only on a self-signature.<a href="#section-5.2.3.10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preferred-symmetric-algorithms">
<section id="section-5.2.3.11">
            <h5 id="name-preferred-symmetric-algorit">
<a href="#section-5.2.3.11" class="section-number selfRef">5.2.3.11. </a><a href="#name-preferred-symmetric-algorit" class="section-name selfRef">Preferred Symmetric Algorithms</a>
            </h5>
<p id="section-5.2.3.11-1">(array of one-octet values)<a href="#section-5.2.3.11-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.11-2">Symmetric algorithm numbers that indicate which algorithms the key holder prefers to use.
The subpacket body is an ordered list of octets with the most preferred listed first.
It is assumed that only algorithms listed are supported by the recipient's software.
Algorithm numbers are in <a href="#symmetric-algos" class="xref">Section 9.3</a>.
This is only found on a self-signature.<a href="#section-5.2.3.11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preferred-hash-algorithms">
<section id="section-5.2.3.12">
            <h5 id="name-preferred-hash-algorithms">
<a href="#section-5.2.3.12" class="section-number selfRef">5.2.3.12. </a><a href="#name-preferred-hash-algorithms" class="section-name selfRef">Preferred Hash Algorithms</a>
            </h5>
<p id="section-5.2.3.12-1">(array of one-octet values)<a href="#section-5.2.3.12-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.12-2">Message digest algorithm numbers that indicate which algorithms the key holder prefers to receive.
Like the preferred symmetric algorithms, the list is ordered.
Algorithm numbers are in <a href="#hash-algos" class="xref">Section 9.5</a>.
This is only found on a self-signature.<a href="#section-5.2.3.12-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preferred-compression-algorithms">
<section id="section-5.2.3.13">
            <h5 id="name-preferred-compression-algor">
<a href="#section-5.2.3.13" class="section-number selfRef">5.2.3.13. </a><a href="#name-preferred-compression-algor" class="section-name selfRef">Preferred Compression Algorithms</a>
            </h5>
<p id="section-5.2.3.13-1">(array of one-octet values)<a href="#section-5.2.3.13-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.13-2">Compression algorithm numbers that indicate which algorithms the key holder prefers to use.
Like the preferred symmetric algorithms, the list is ordered.
Algorithm numbers are in <a href="#compression-algos" class="xref">Section 9.4</a>.
If this subpacket is not included, ZIP is preferred.
A zero denotes that uncompressed data is preferred; the key holder's software might have no compression software in that implementation.
This is only found on a self-signature.<a href="#section-5.2.3.13-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-expiration-time">
<section id="section-5.2.3.14">
            <h5 id="name-signature-expiration-time">
<a href="#section-5.2.3.14" class="section-number selfRef">5.2.3.14. </a><a href="#name-signature-expiration-time" class="section-name selfRef">Signature Expiration Time</a>
            </h5>
<p id="section-5.2.3.14-1">(4-octet time field)<a href="#section-5.2.3.14-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.14-2">The validity period of the signature.
This is the number of seconds after the signature creation time that the signature expires.
If this is not present or has a value of zero, it never expires.<a href="#section-5.2.3.14-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="exportable-certification">
<section id="section-5.2.3.15">
            <h5 id="name-exportable-certification">
<a href="#section-5.2.3.15" class="section-number selfRef">5.2.3.15. </a><a href="#name-exportable-certification" class="section-name selfRef">Exportable Certification</a>
            </h5>
<p id="section-5.2.3.15-1">(1 octet of exportability, 0 for not, 1 for exportable)<a href="#section-5.2.3.15-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.15-2">This subpacket denotes whether a certification signature is "exportable", to be used by other users than the signature's issuer.
The packet body contains a Boolean flag indicating whether the signature is exportable.
If this packet is not present, the certification is exportable; it is equivalent to a flag containing a 1.<a href="#section-5.2.3.15-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.15-3">Non-exportable, or "local", certifications are signatures made by a user to mark a key as valid within that user's implementation only.<a href="#section-5.2.3.15-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3.15-4">Thus, when an implementation prepares a user's copy of a key for transport to another user (this is the process of "exporting" the key), any local certification signatures are deleted from the key.<a href="#section-5.2.3.15-4" class="pilcrow">¶</a></p>
<p id="section-5.2.3.15-5">The receiver of a transported key "imports" it, and likewise trims any local certifications.
In normal operation, there won't be any, assuming the import is performed on an exported key.
However, there are instances where this can reasonably happen.
For example, if an implementation allows keys to be imported from a key database in addition to an exported key, then this situation can arise.<a href="#section-5.2.3.15-5" class="pilcrow">¶</a></p>
<p id="section-5.2.3.15-6">Some implementations do not represent the interest of a single user (for example, a key server).
Such implementations always trim local certifications from any key they handle.<a href="#section-5.2.3.15-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="revocable">
<section id="section-5.2.3.16">
            <h5 id="name-revocable">
<a href="#section-5.2.3.16" class="section-number selfRef">5.2.3.16. </a><a href="#name-revocable" class="section-name selfRef">Revocable</a>
            </h5>
<p id="section-5.2.3.16-1">(1 octet of revocability, 0 for not, 1 for revocable)<a href="#section-5.2.3.16-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.16-2">Signature's revocability status.
The packet body contains a Boolean flag indicating whether the signature is revocable.
Signatures that are not revocable have any later revocation signatures ignored.
They represent a commitment by the signer that he cannot revoke his signature for the life of his key.
If this packet is not present, the signature is revocable.<a href="#section-5.2.3.16-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-signature">
<section id="section-5.2.3.17">
            <h5 id="name-trust-signature">
<a href="#section-5.2.3.17" class="section-number selfRef">5.2.3.17. </a><a href="#name-trust-signature" class="section-name selfRef">Trust Signature</a>
            </h5>
<p id="section-5.2.3.17-1">(1 octet "level" (depth), 1 octet of trust amount)<a href="#section-5.2.3.17-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.17-2">Signer asserts that the key is not only valid but also trustworthy at the specified level.
Level 0 has the same meaning as an ordinary validity signature.
Level 1 means that the signed key is asserted to be a valid trusted introducer, with the 2nd octet of the body specifying the degree of trust.
Level 2 means that the signed key is asserted to be trusted to issue level 1 trust signatures, i.e., that it is a "meta introducer".
Generally, a level n trust signature asserts that a key is trusted to issue level n-1 trust signatures.
The trust amount is in a range from 0-255, interpreted such that values less than 120 indicate partial trust and values of 120 or greater indicate complete trust.
Implementations SHOULD emit values of 60 for partial trust and 120 for complete trust.<a href="#section-5.2.3.17-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="regular-expression">
<section id="section-5.2.3.18">
            <h5 id="name-regular-expression">
<a href="#section-5.2.3.18" class="section-number selfRef">5.2.3.18. </a><a href="#name-regular-expression" class="section-name selfRef">Regular Expression</a>
            </h5>
<p id="section-5.2.3.18-1">(null-terminated regular expression)<a href="#section-5.2.3.18-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.18-2">Used in conjunction with trust Signature packets (of level &gt; 0) to limit the scope of trust that is extended.
Only signatures by the target key on User IDs that match the regular expression in the body of this packet have trust extended by the trust Signature subpacket.
The regular expression uses the same syntax as the Henry Spencer's "almost public domain" regular expression <span>[<a href="#REGEX" class="xref">REGEX</a>]</span> package.
A description of the syntax is found in <a href="#regular-expressions" class="xref">Section 8</a>.<a href="#section-5.2.3.18-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="revocation-key">
<section id="section-5.2.3.19">
            <h5 id="name-revocation-key">
<a href="#section-5.2.3.19" class="section-number selfRef">5.2.3.19. </a><a href="#name-revocation-key" class="section-name selfRef">Revocation Key</a>
            </h5>
<p id="section-5.2.3.19-1">(1 octet of class, 1 octet of public-key algorithm ID, 20 or 32 octets of fingerprint)<a href="#section-5.2.3.19-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.19-2">V4 keys use the full 20 octet fingerprint; V5 keys use the full 32 octet fingerprint<a href="#section-5.2.3.19-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.19-3">Authorizes the specified key to issue revocation signatures for this key.
Class octet must have bit 0x80 set.
If the bit 0x40 is set, then this means that the revocation information is sensitive.
Other bits are for future expansion to other kinds of authorizations.
This is only found on a direct-key self-signature (type 0x1f).
The use on other types of self-signatures is unspecified.<a href="#section-5.2.3.19-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3.19-4">If the "sensitive" flag is set, the keyholder feels this subpacket contains private trust information that describes a real-world sensitive relationship.
If this flag is set, implementations SHOULD NOT export this signature to other users except in cases where the data needs to be available: when the signature is being sent to the designated revoker, or when it is accompanied by a revocation signature from that revoker.
Note that it may be appropriate to isolate this subpacket within a separate signature so that it is not combined with other subpackets that need to be exported.<a href="#section-5.2.3.19-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notation-data">
<section id="section-5.2.3.20">
            <h5 id="name-notation-data">
<a href="#section-5.2.3.20" class="section-number selfRef">5.2.3.20. </a><a href="#name-notation-data" class="section-name selfRef">Notation Data</a>
            </h5>
<p id="section-5.2.3.20-1">(4 octets of flags, 2 octets of name length (M), 2 octets of value length (N), M octets of name data, N octets of value data)<a href="#section-5.2.3.20-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.20-2">This subpacket describes a "notation" on the signature that the issuer wishes to make.
The notation has a name and a value, each of which are strings of octets.
There may be more than one notation in a signature.
Notations can be used for any extension the issuer of the signature cares to make.
The "flags" field holds four octets of flags.<a href="#section-5.2.3.20-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.20-3">All undefined flags MUST be zero.
Defined flags are as follows:<a href="#section-5.2.3.20-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3.20-4">First octet:<a href="#section-5.2.3.20-4" class="pilcrow">¶</a></p>
<span id="name-notation-flag-registry-firs"></span><table class="center" id="table-7">
              <caption>
<a href="#table-7" class="selfRef">Table 7</a>:
<a href="#name-notation-flag-registry-firs" class="selfRef">Notation flag registry (first octet)</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">flag</th>
                  <th class="text-left" rowspan="1" colspan="1">shorthand</th>
                  <th class="text-left" rowspan="1" colspan="1">definition</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x80</td>
                  <td class="text-left" rowspan="1" colspan="1">human-readable</td>
                  <td class="text-left" rowspan="1" colspan="1">This note value is text.</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.20-6">Other octets: none.<a href="#section-5.2.3.20-6" class="pilcrow">¶</a></p>
<p id="section-5.2.3.20-7">Notation names are arbitrary strings encoded in UTF-8.
They reside in two namespaces: The IETF namespace and the user namespace.<a href="#section-5.2.3.20-7" class="pilcrow">¶</a></p>
<p id="section-5.2.3.20-8">The IETF namespace is registered with IANA.
These names MUST NOT contain the "@" character (0x40).
This is a tag for the user namespace.<a href="#section-5.2.3.20-8" class="pilcrow">¶</a></p>
<p id="section-5.2.3.20-9">Names in the user namespace consist of a UTF-8 string tag followed by "@" followed by a DNS domain name.
Note that the tag MUST NOT contain an "@" character.
For example, the "sample" tag used by Example Corporation could be "sample@example.com".<a href="#section-5.2.3.20-9" class="pilcrow">¶</a></p>
<p id="section-5.2.3.20-10">Names in a user space are owned and controlled by the owners of that domain.
Obviously, it's bad form to create a new name in a DNS space that you don't own.<a href="#section-5.2.3.20-10" class="pilcrow">¶</a></p>
<p id="section-5.2.3.20-11">Since the user namespace is in the form of an email address, implementers MAY wish to arrange for that address to reach a person who can be consulted about the use of the named tag.
Note that due to UTF-8 encoding, not all valid user space name tags are valid email addresses.<a href="#section-5.2.3.20-11" class="pilcrow">¶</a></p>
<p id="section-5.2.3.20-12">If there is a critical notation, the criticality applies to that specific notation and not to notations in general.<a href="#section-5.2.3.20-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-server-preferences">
<section id="section-5.2.3.21">
            <h5 id="name-key-server-preferences">
<a href="#section-5.2.3.21" class="section-number selfRef">5.2.3.21. </a><a href="#name-key-server-preferences" class="section-name selfRef">Key Server Preferences</a>
            </h5>
<p id="section-5.2.3.21-1">(N octets of flags)<a href="#section-5.2.3.21-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.21-2">This is a list of one-bit flags that indicate preferences that the key holder has about how the key is handled on a key server.
All undefined flags MUST be zero.<a href="#section-5.2.3.21-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.21-3">First octet:<a href="#section-5.2.3.21-3" class="pilcrow">¶</a></p>
<span id="name-key-server-preferences-flag"></span><table class="center" id="table-8">
              <caption>
<a href="#table-8" class="selfRef">Table 8</a>:
<a href="#name-key-server-preferences-flag" class="selfRef">Key server preferences flag registry (first octet)</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">flag</th>
                  <th class="text-left" rowspan="1" colspan="1">shorthand</th>
                  <th class="text-left" rowspan="1" colspan="1">definition</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x80</td>
                  <td class="text-left" rowspan="1" colspan="1">No-modify</td>
                  <td class="text-left" rowspan="1" colspan="1">The key holder requests that this key only be modified or updated by the key holder or an administrator of the key server.</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.21-5">This is found only on a self-signature.<a href="#section-5.2.3.21-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="preferred-key-server">
<section id="section-5.2.3.22">
            <h5 id="name-preferred-key-server">
<a href="#section-5.2.3.22" class="section-number selfRef">5.2.3.22. </a><a href="#name-preferred-key-server" class="section-name selfRef">Preferred Key Server</a>
            </h5>
<p id="section-5.2.3.22-1">(String)<a href="#section-5.2.3.22-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.22-2">This is a URI of a key server that the key holder prefers be used for updates.
Note that keys with multiple User IDs can have a preferred key server for each User ID.
Note also that since this is a URI, the key server can actually be a copy of the key retrieved by ftp, http, finger, etc.<a href="#section-5.2.3.22-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="primary-user-id">
<section id="section-5.2.3.23">
            <h5 id="name-primary-user-id">
<a href="#section-5.2.3.23" class="section-number selfRef">5.2.3.23. </a><a href="#name-primary-user-id" class="section-name selfRef">Primary User ID</a>
            </h5>
<p id="section-5.2.3.23-1">(1 octet, Boolean)<a href="#section-5.2.3.23-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.23-2">This is a flag in a User ID's self-signature that states whether this User ID is the main User ID for this key.
It is reasonable for an implementation to resolve ambiguities in preferences, etc.
by referring to the primary User ID.
If this flag is absent, its value is zero.
If more than one User ID in a key is marked as primary, the implementation may resolve the ambiguity in any way it sees fit, but it is RECOMMENDED that priority be given to the User ID with the most recent self-signature.<a href="#section-5.2.3.23-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.23-3">When appearing on a self-signature on a User ID packet, this subpacket applies only to User ID packets.
When appearing on a self-signature on a User Attribute packet, this subpacket applies only to User Attribute packets.
That is to say, there are two different and independent "primaries" -- one for User IDs, and one for User Attributes.<a href="#section-5.2.3.23-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="policy-uri">
<section id="section-5.2.3.24">
            <h5 id="name-policy-uri">
<a href="#section-5.2.3.24" class="section-number selfRef">5.2.3.24. </a><a href="#name-policy-uri" class="section-name selfRef">Policy URI</a>
            </h5>
<p id="section-5.2.3.24-1">(String)<a href="#section-5.2.3.24-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.24-2">This subpacket contains a URI of a document that describes the policy under which the signature was issued.<a href="#section-5.2.3.24-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-flags">
<section id="section-5.2.3.25">
            <h5 id="name-key-flags">
<a href="#section-5.2.3.25" class="section-number selfRef">5.2.3.25. </a><a href="#name-key-flags" class="section-name selfRef">Key Flags</a>
            </h5>
<p id="section-5.2.3.25-1">(N octets of flags)<a href="#section-5.2.3.25-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.25-2">This subpacket contains a list of binary flags that hold information about a key.
It is a string of octets, and an implementation MUST NOT assume a fixed size.
This is so it can grow over time.
If a list is shorter than an implementation expects, the unstated flags are considered to be zero.
The defined flags are as follows:<a href="#section-5.2.3.25-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.25-3">First octet:<a href="#section-5.2.3.25-3" class="pilcrow">¶</a></p>
<span id="name-key-flags-registry-first-oc"></span><table class="center" id="table-9">
              <caption>
<a href="#table-9" class="selfRef">Table 9</a>:
<a href="#name-key-flags-registry-first-oc" class="selfRef">Key flags registry (first octet)</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">flag</th>
                  <th class="text-left" rowspan="1" colspan="1">definition</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x01</td>
                  <td class="text-left" rowspan="1" colspan="1">This key may be used to certify other keys.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x02</td>
                  <td class="text-left" rowspan="1" colspan="1">This key may be used to sign data.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x04</td>
                  <td class="text-left" rowspan="1" colspan="1">This key may be used to encrypt communications.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x08</td>
                  <td class="text-left" rowspan="1" colspan="1">This key may be used to encrypt storage.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x10</td>
                  <td class="text-left" rowspan="1" colspan="1">The private component of this key may have been split by a secret-sharing mechanism.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x20</td>
                  <td class="text-left" rowspan="1" colspan="1">This key may be used for authentication.</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x80</td>
                  <td class="text-left" rowspan="1" colspan="1">The private component of this key may be in the possession of more than one person.</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.25-5">Second octet:<a href="#section-5.2.3.25-5" class="pilcrow">¶</a></p>
<span id="name-key-flags-registry-second-o"></span><table class="center" id="table-10">
              <caption>
<a href="#table-10" class="selfRef">Table 10</a>:
<a href="#name-key-flags-registry-second-o" class="selfRef">Key flags registry (second octet)</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">flag</th>
                  <th class="text-left" rowspan="1" colspan="1">definition</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x04</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved (ADSK).</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x08</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved (timestamping).</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.25-7">Usage notes:<a href="#section-5.2.3.25-7" class="pilcrow">¶</a></p>
<p id="section-5.2.3.25-8">The flags in this packet may appear in self-signatures or in certification signatures.
They mean different things depending on who is making the statement -- for example, a certification signature that has the "sign data" flag is stating that the certification is for that use.
On the other hand, the "communications encryption" flag in a self-signature is stating a preference that a given key be used for communications.
Note however, that it is a thorny issue to determine what is "communications" and what is "storage".
This decision is left wholly up to the implementation; the authors of this document do not claim any special wisdom on the issue and realize that accepted opinion may change.<a href="#section-5.2.3.25-8" class="pilcrow">¶</a></p>
<p id="section-5.2.3.25-9">The "split key" (0x10) and "group key" (0x80) flags are placed on a self-signature only; they are meaningless on a certification signature.
They SHOULD be placed only on a direct-key signature (type 0x1F) or a subkey signature (type 0x18), one that refers to the key the flag applies to.<a href="#section-5.2.3.25-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signers-user-id">
<section id="section-5.2.3.26">
            <h5 id="name-signers-user-id">
<a href="#section-5.2.3.26" class="section-number selfRef">5.2.3.26. </a><a href="#name-signers-user-id" class="section-name selfRef">Signer's User ID</a>
            </h5>
<p id="section-5.2.3.26-1">(String)<a href="#section-5.2.3.26-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.26-2">This subpacket allows a keyholder to state which User ID is responsible for the signing.
Many keyholders use a single key for different purposes, such as business communications as well as personal communications.
This subpacket allows such a keyholder to state which of their roles is making a signature.<a href="#section-5.2.3.26-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.26-3">This subpacket is not appropriate to use to refer to a User Attribute packet.<a href="#section-5.2.3.26-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reason-for-revocation">
<section id="section-5.2.3.27">
            <h5 id="name-reason-for-revocation">
<a href="#section-5.2.3.27" class="section-number selfRef">5.2.3.27. </a><a href="#name-reason-for-revocation" class="section-name selfRef">Reason for Revocation</a>
            </h5>
<p id="section-5.2.3.27-1">(1 octet of revocation code, N octets of reason string)<a href="#section-5.2.3.27-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.27-2">This subpacket is used only in key revocation and certification revocation signatures.
It describes the reason why the key or certificate was revoked.<a href="#section-5.2.3.27-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.27-3">The first octet contains a machine-readable code that denotes the reason for the revocation:<a href="#section-5.2.3.27-3" class="pilcrow">¶</a></p>
<span id="name-reasons-for-revocation"></span><table class="center" id="table-11">
              <caption>
<a href="#table-11" class="selfRef">Table 11</a>:
<a href="#name-reasons-for-revocation" class="selfRef">Reasons for revocation</a>
              </caption>
<thead>
                <tr>
                  <th class="text-right" rowspan="1" colspan="1">Code</th>
                  <th class="text-left" rowspan="1" colspan="1">Reason</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">0</td>
                  <td class="text-left" rowspan="1" colspan="1">No reason specified (key revocations or cert revocations)</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">1</td>
                  <td class="text-left" rowspan="1" colspan="1">Key is superseded (key revocations)</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">2</td>
                  <td class="text-left" rowspan="1" colspan="1">Key material has been compromised (key revocations)</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">3</td>
                  <td class="text-left" rowspan="1" colspan="1">Key is retired and no longer used (key revocations)</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">32</td>
                  <td class="text-left" rowspan="1" colspan="1">User ID information is no longer valid (cert revocations)</td>
                </tr>
                <tr>
                  <td class="text-right" rowspan="1" colspan="1">100-110</td>
                  <td class="text-left" rowspan="1" colspan="1">Private Use</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.27-5">Following the revocation code is a string of octets that gives information about the Reason for Revocation in human-readable form (UTF-8).
The string may be null, that is, of zero length.
The length of the subpacket is the length of the reason string plus one.
An implementation SHOULD implement this subpacket, include it in all revocation signatures, and interpret revocations appropriately.
There are important semantic differences between the reasons, and there are thus important reasons for revoking signatures.<a href="#section-5.2.3.27-5" class="pilcrow">¶</a></p>
<p id="section-5.2.3.27-6">If a key has been revoked because of a compromise, all signatures created by that key are suspect.
However, if it was merely superseded or retired, old signatures are still valid.
If the revoked signature is the self-signature for certifying a User ID, a revocation denotes that that user name is no longer in use.
Such a revocation SHOULD include a 0x20 code.<a href="#section-5.2.3.27-6" class="pilcrow">¶</a></p>
<p id="section-5.2.3.27-7">Note that any signature may be revoked, including a certification on some other person's key.
There are many good reasons for revoking a certification signature, such as the case where the keyholder leaves the employ of a business with an email address.
A revoked certification is no longer a part of validity calculations.<a href="#section-5.2.3.27-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="features-subpacket">
<section id="section-5.2.3.28">
            <h5 id="name-features">
<a href="#section-5.2.3.28" class="section-number selfRef">5.2.3.28. </a><a href="#name-features" class="section-name selfRef">Features</a>
            </h5>
<p id="section-5.2.3.28-1">(N octets of flags)<a href="#section-5.2.3.28-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.28-2">The Features subpacket denotes which advanced OpenPGP features a user's implementation supports.
This is so that as features are added to OpenPGP that cannot be backwards-compatible, a user can state that they can use that feature.
The flags are single bits that indicate that a given feature is supported.<a href="#section-5.2.3.28-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.28-3">This subpacket is similar to a preferences subpacket, and only appears in a self-signature.<a href="#section-5.2.3.28-3" class="pilcrow">¶</a></p>
<p id="section-5.2.3.28-4">An implementation SHOULD NOT use a feature listed when sending to a user who does not state that they can use it.<a href="#section-5.2.3.28-4" class="pilcrow">¶</a></p>
<p id="section-5.2.3.28-5">Defined features are as follows:<a href="#section-5.2.3.28-5" class="pilcrow">¶</a></p>
<p id="section-5.2.3.28-6">First octet:<a href="#section-5.2.3.28-6" class="pilcrow">¶</a></p>
<span id="name-features-registry"></span><table class="center" id="table-12">
              <caption>
<a href="#table-12" class="selfRef">Table 12</a>:
<a href="#name-features-registry" class="selfRef">Features registry</a>
              </caption>
<thead>
                <tr>
                  <th class="text-left" rowspan="1" colspan="1">feature</th>
                  <th class="text-left" rowspan="1" colspan="1">definition</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x01</td>
                  <td class="text-left" rowspan="1" colspan="1">Modification Detection (packets 18 and 19)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x02</td>
                  <td class="text-left" rowspan="1" colspan="1">AEAD Encrypted Data (packet 20)</td>
                </tr>
                <tr>
                  <td class="text-left" rowspan="1" colspan="1">0x04</td>
                  <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                </tr>
              </tbody>
            </table>
<p id="section-5.2.3.28-8">If an implementation implements any of the defined features, it SHOULD implement the Features subpacket, too.<a href="#section-5.2.3.28-8" class="pilcrow">¶</a></p>
<p id="section-5.2.3.28-9">An implementation may freely infer features from other suitable implementation-dependent mechanisms.<a href="#section-5.2.3.28-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-target">
<section id="section-5.2.3.29">
            <h5 id="name-signature-target">
<a href="#section-5.2.3.29" class="section-number selfRef">5.2.3.29. </a><a href="#name-signature-target" class="section-name selfRef">Signature Target</a>
            </h5>
<p id="section-5.2.3.29-1">(1 octet public-key algorithm, 1 octet hash algorithm, N octets hash)<a href="#section-5.2.3.29-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.29-2">This subpacket identifies a specific target signature to which a signature refers.
For revocation signatures, this subpacket provides explicit designation of which signature is being revoked.
For a third-party or timestamp signature, this designates what signature is signed.
All arguments are an identifier of that target signature.<a href="#section-5.2.3.29-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.29-3">The N octets of hash data MUST be the size of the hash of the signature.
For example, a target signature with a SHA-1 hash MUST have 20 octets of hash data.<a href="#section-5.2.3.29-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="embedded-signature">
<section id="section-5.2.3.30">
            <h5 id="name-embedded-signature">
<a href="#section-5.2.3.30" class="section-number selfRef">5.2.3.30. </a><a href="#name-embedded-signature" class="section-name selfRef">Embedded Signature</a>
            </h5>
<p id="section-5.2.3.30-1">(1 signature packet body)<a href="#section-5.2.3.30-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.30-2">This subpacket contains a complete Signature packet body as specified in <a href="#signature-packet" class="xref">Section 5.2</a>.
It is useful when one signature needs to refer to, or be incorporated in, another signature.<a href="#section-5.2.3.30-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="issuer-fingerprint">
<section id="section-5.2.3.31">
            <h5 id="name-issuer-fingerprint">
<a href="#section-5.2.3.31" class="section-number selfRef">5.2.3.31. </a><a href="#name-issuer-fingerprint" class="section-name selfRef">Issuer Fingerprint</a>
            </h5>
<p id="section-5.2.3.31-1">(1 octet key version number, N octets of fingerprint)<a href="#section-5.2.3.31-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.31-2">The OpenPGP Key fingerprint of the key issuing the signature.
This subpacket SHOULD be included in all signatures.
If the version of the issuing key is 4 and an Issuer subpacket is also included in the signature, the key ID of the Issuer subpacket MUST match the low 64 bits of the fingerprint.<a href="#section-5.2.3.31-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.31-3">Note that the length N of the fingerprint for a version 4 key is 20 octets; for a version 5 key N is 32.<a href="#section-5.2.3.31-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intended-recipient-fingerprint">
<section id="section-5.2.3.32">
            <h5 id="name-intended-recipient-fingerpr">
<a href="#section-5.2.3.32" class="section-number selfRef">5.2.3.32. </a><a href="#name-intended-recipient-fingerpr" class="section-name selfRef">Intended Recipient Fingerprint</a>
            </h5>
<p id="section-5.2.3.32-1">(1 octet key version number, N octets of fingerprint)<a href="#section-5.2.3.32-1" class="pilcrow">¶</a></p>
<p id="section-5.2.3.32-2">The OpenPGP Key fingerprint of the intended recipient primary key.
If one or more subpackets of this type are included in a signature, it SHOULD be considered valid only in an encrypted context, where the key it was encrypted to is one of the indicated primary keys, or one of their subkeys.
This can be used to prevent forwarding a signature outside of its intended, encrypted context.<a href="#section-5.2.3.32-2" class="pilcrow">¶</a></p>
<p id="section-5.2.3.32-3">Note that the length N of the fingerprint for a version 4 key is 20 octets; for a version 5 key N is 32.<a href="#section-5.2.3.32-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="computing-signatures">
<section id="section-5.2.4">
          <h4 id="name-computing-signatures">
<a href="#section-5.2.4" class="section-number selfRef">5.2.4. </a><a href="#name-computing-signatures" class="section-name selfRef">Computing Signatures</a>
          </h4>
<p id="section-5.2.4-1">All signatures are formed by producing a hash over the signature data, and then using the resulting hash in the signature algorithm.<a href="#section-5.2.4-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-2">For binary document signatures (type 0x00), the document data is hashed directly.
For text document signatures (type 0x01), the document is canonicalized by converting line endings to &lt;CR&gt;&lt;LF&gt;, and the resulting data is hashed.<a href="#section-5.2.4-2" class="pilcrow">¶</a></p>
<p id="section-5.2.4-3">When a V4 signature is made over a key, the hash data starts with the octet 0x99, followed by a two-octet length of the key, and then body of the key packet; when a V5 signature is made over a key, the hash data starts with the octet 0x9a, followed by a four-octet length of the key, and then body of the key packet.
A subkey binding signature (type 0x18) or primary key binding signature (type 0x19) then hashes the subkey using the same format as the main key (also using 0x99 or 0x9a as the first octet).
Primary key revocation signatures (type 0x20) hash only the key being revoked.
Subkey revocation signature (type 0x28) hash first the primary key and then the subkey being revoked.<a href="#section-5.2.4-3" class="pilcrow">¶</a></p>
<p id="section-5.2.4-4">A certification signature (type 0x10 through 0x13) hashes the User ID being bound to the key into the hash context after the above data.
A V3 certification hashes the contents of the User ID or attribute packet packet, without any header.
A V4 or V5 certification hashes the constant 0xB4 for User ID certifications or the constant 0xD1 for User Attribute certifications, followed by a four-octet number giving the length of the User ID or User Attribute data, and then the User ID or User Attribute data.<a href="#section-5.2.4-4" class="pilcrow">¶</a></p>
<p id="section-5.2.4-5">When a signature is made over a Signature packet (type 0x50, "Third-Party Confirmation signature"), the hash data starts with the octet 0x88, followed by the four-octet length of the signature, and then the body of the Signature packet.
(Note that this is an old-style packet header for a Signature packet with the length-of-length field set to zero.) The unhashed subpacket data of the Signature packet being hashed is not included in the hash, and the unhashed subpacket data length value is set to zero.<a href="#section-5.2.4-5" class="pilcrow">¶</a></p>
<p id="section-5.2.4-6">Once the data body is hashed, then a trailer is hashed.
This trailer depends on the version of the signature.<a href="#section-5.2.4-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-7.1">A V3 signature hashes five octets of the packet body, starting from the signature type field.
This data is the signature type, followed by the four-octet signature time.<a href="#section-5.2.4-7.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.2.4-7.2">
              <p id="section-5.2.4-7.2.1">A V4 signature hashes the packet body starting from its first field, the version number, through the end of the hashed subpacket data and a final extra trailer.
Thus, the hashed fields are:<a href="#section-5.2.4-7.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-7.2.2.1">the signature version (0x04),<a href="#section-5.2.4-7.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.2.2.2">the signature type,<a href="#section-5.2.4-7.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.2.2.3">the public-key algorithm,<a href="#section-5.2.4-7.2.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.2.2.4">the hash algorithm,<a href="#section-5.2.4-7.2.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.2.2.5">the hashed subpacket length,<a href="#section-5.2.4-7.2.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.2.2.6">the hashed subpacket body,<a href="#section-5.2.4-7.2.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.2.2.7">the two octets 0x04 and 0xFF,<a href="#section-5.2.4-7.2.2.7" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.2.2.8">
                  <p id="section-5.2.4-7.2.2.8.1">a four-octet big-endian number that is the length of the hashed data from the Signature packet stopping right before the 0x04, 0xff octets.<a href="#section-5.2.4-7.2.2.8.1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-7.2.2.8.2">
The four-octet big-endian number is considered to be an unsigned integer modulo 2**32.<a href="#section-5.2.4-7.2.2.8.2" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.2.4-7.3">
              <p id="section-5.2.4-7.3.1">A V5 signature hashes the packet body starting from its first field, the version number, through the end of the hashed subpacket data and a final extra trailer.
Thus, the hashed fields are:<a href="#section-5.2.4-7.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-7.3.2.1">the signature version (0x05),<a href="#section-5.2.4-7.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.3.2.2">the signature type,<a href="#section-5.2.4-7.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.3.2.3">the public-key algorithm,<a href="#section-5.2.4-7.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.3.2.4">the hash algorithm,<a href="#section-5.2.4-7.3.2.4" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.3.2.5">the hashed subpacket length,<a href="#section-5.2.4-7.3.2.5" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.3.2.6">the hashed subpacket body,<a href="#section-5.2.4-7.3.2.6" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.3.2.7">
                  <p id="section-5.2.4-7.3.2.7.1">Only for document signatures (type 0x00 or 0x01) the following three data items are hashed here:<a href="#section-5.2.4-7.3.2.7.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.2.4-7.3.2.7.2.1">the one-octet content format,<a href="#section-5.2.4-7.3.2.7.2.1" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-5.2.4-7.3.2.7.2.2">the file name as a string (one octet length, followed by the file name),<a href="#section-5.2.4-7.3.2.7.2.2" class="pilcrow">¶</a>
</li>
                    <li class="normal" id="section-5.2.4-7.3.2.7.2.3">a four-octet number that indicates a date,<a href="#section-5.2.4-7.3.2.7.2.3" class="pilcrow">¶</a>
</li>
                  </ul>
</li>
                <li class="normal" id="section-5.2.4-7.3.2.8">the two octets 0x05 and 0xFF,<a href="#section-5.2.4-7.3.2.8" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.2.4-7.3.2.9">
                  <p id="section-5.2.4-7.3.2.9.1">a eight-octet big-endian number that is the length of the hashed data from the Signature packet stopping right before the 0x05, 0xff octets.<a href="#section-5.2.4-7.3.2.9.1" class="pilcrow">¶</a></p>
<p id="section-5.2.4-7.3.2.9.2">
The three data items hashed for document signatures need to mirror the values of the Literal Data packet.  For detached and cleartext signatures 6 zero octets are hashed instead.<a href="#section-5.2.4-7.3.2.9.2" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
          </ul>
<p id="section-5.2.4-8">After all this has been hashed in a single hash context, the resulting hash field is used in the signature algorithm and placed at the end of the Signature packet.<a href="#section-5.2.4-8" class="pilcrow">¶</a></p>
<div id="subpacket-hints">
<section id="section-5.2.4.1">
            <h5 id="name-subpacket-hints">
<a href="#section-5.2.4.1" class="section-number selfRef">5.2.4.1. </a><a href="#name-subpacket-hints" class="section-name selfRef">Subpacket Hints</a>
            </h5>
<p id="section-5.2.4.1-1">It is certainly possible for a signature to contain conflicting information in subpackets.
For example, a signature may contain multiple copies of a preference or multiple expiration times.
In most cases, an implementation SHOULD use the last subpacket in the signature, but MAY use any conflict resolution scheme that makes more sense.
Please note that we are intentionally leaving conflict resolution to the implementer; most conflicts are simply syntax errors, and the wishy-washy language here allows a receiver to be generous in what they accept, while putting pressure on a creator to be stingy in what they generate.<a href="#section-5.2.4.1-1" class="pilcrow">¶</a></p>
<p id="section-5.2.4.1-2">Some apparent conflicts may actually make sense -- for example, suppose a keyholder has a V3 key and a V4 key that share the same RSA key material.
Either of these keys can verify a signature created by the other, and it may be reasonable for a signature to contain an issuer subpacket for each key, as a way of explicitly tying those keys to the signature.<a href="#section-5.2.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="skesk">
<section id="section-5.3">
        <h3 id="name-symmetric-key-encrypted-ses">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-symmetric-key-encrypted-ses" class="section-name selfRef">Symmetric-Key Encrypted Session Key Packets (Tag 3)</a>
        </h3>
<p id="section-5.3-1">The Symmetric-Key Encrypted Session Key (SKESK) packet holds the symmetric-key encryption of a session key used to encrypt a message.
Zero or more Public-Key Encrypted Session Key packets and/or Symmetric-Key Encrypted Session Key packets may precede a an encryption container (i.e. a Symmetrically Encrypted Integrity Protected Data packet, an AEAD Encrypted Data packet, or -- for historic data -- a Symmetrically Encrypted Data packet) that holds an encrypted message.
The message is encrypted with a session key, and the session key is itself encrypted and stored in the Encrypted Session Key packet or the Symmetric-Key Encrypted Session Key packet.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">If the encryption container is preceded by one or more Symmetric-Key Encrypted Session Key packets, each specifies a passphrase that may be used to decrypt the message.
This allows a message to be encrypted to a number of public keys, and also to one or more passphrases.
This packet type is new and is not generated by PGP 2 or PGP version 5.0.<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3-3">A version 4 Symmetric-Key Encrypted Session Key packet consists of:<a href="#section-5.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-4.1">A one-octet version number with value 4.<a href="#section-5.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-4.2">A one-octet number describing the symmetric algorithm used.<a href="#section-5.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-4.3">A string-to-key (S2K) specifier, length as defined above.<a href="#section-5.3-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-4.4">Optionally, the encrypted session key itself, which is decrypted with the string-to-key object.<a href="#section-5.3-4.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-5">If the encrypted session key is not present (which can be detected on the basis of packet length and S2K specifier size), then the S2K algorithm applied to the passphrase produces the session key for decrypting the message, using the symmetric cipher algorithm from the Symmetric-Key Encrypted Session Key packet.<a href="#section-5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3-6">If the encrypted session key is present, the result of applying the S2K algorithm to the passphrase is used to decrypt just that encrypted session key field, using CFB mode with an IV of all zeros.
The decryption result consists of a one-octet algorithm identifier that specifies the symmetric-key encryption algorithm used to encrypt the following encryption container, followed by the session key octets themselves.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3-7">Note: because an all-zero IV is used for this decryption, the S2K specifier MUST use a salt value, either a Salted S2K or an Iterated-Salted S2K.
The salt value will ensure that the decryption key is not repeated even if the passphrase is reused.<a href="#section-5.3-7" class="pilcrow">¶</a></p>
<p id="section-5.3-8">A version 5 Symmetric-Key Encrypted Session Key packet consists of:<a href="#section-5.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3-9.1">A one-octet version number with value 5.<a href="#section-5.3-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-9.2">A one-octet cipher algorithm.<a href="#section-5.3-9.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-9.3">A one-octet AEAD algorithm.<a href="#section-5.3-9.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-9.4">A string-to-key (S2K) specifier, length as defined above.<a href="#section-5.3-9.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-9.5">A starting initialization vector of size specified by the AEAD algorithm.<a href="#section-5.3-9.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-9.6">The encrypted session key itself, which is decrypted with the string-to-key object using the given cipher and AEAD mode.<a href="#section-5.3-9.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.3-9.7">An authentication tag for the AEAD mode.<a href="#section-5.3-9.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.3-10">The encrypted session key is encrypted using one of the AEAD algorithms specified for the AEAD Encrypted Data Packet.
Note that no chunks are used and that there is only one authentication tag.
The Packet Tag in new format encoding (bits 7 and 6 set, bits 5-0 carry the packet tag), the packet version number, the cipher algorithm octet, and the AEAD algorithm octet are given as additional data.
For example, the additional data used with EAX and AES-128 consists of the octets 0xC3, 0x05, 0x07, and 0x01.<a href="#section-5.3-10" class="pilcrow">¶</a></p>
<div id="no-v5-skesk-seipd">
<section id="section-5.3.1">
          <h4 id="name-no-v5-skesk-with-seipd">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-no-v5-skesk-with-seipd" class="section-name selfRef">No v5 SKESK with SEIPD</a>
          </h4>
<p id="section-5.3.1-1">Note that unlike the AEAD Encrypted Data Packet (AED, see <a href="#aead" class="xref">Section 5.16</a>), the Symmetrically Encrypted Integrity Protected Data Packet (SEIPD, see <a href="#seipd" class="xref">Section 5.14</a>) does not internally indicate what cipher algorithm to use to decrypt it.
Since the v5 SKESK packet's encrypted payload only indicates the key used, not the choice of cipher algorithm used for the subsequent encrypted data, a v5 SKESK packet can only provide a session key for an AED packet, and MUST NOT be used to provide a session key for a SEIPD Packet.<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="one-pass-signature-packets-tag-4">
<section id="section-5.4">
        <h3 id="name-one-pass-signature-packets-">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-one-pass-signature-packets-" class="section-name selfRef">One-Pass Signature Packets (Tag 4)</a>
        </h3>
<p id="section-5.4-1">The One-Pass Signature packet precedes the signed data and contains enough information to allow the receiver to begin calculating any hashes needed to verify the signature.
It allows the Signature packet to be placed at the end of the message, so that the signer can compute the entire signed message in one pass.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">A One-Pass Signature does not interoperate with PGP 2.6.x or earlier.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<p id="section-5.4-3">The body of this packet consists of:<a href="#section-5.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.4-4.1">A one-octet version number.
The current version is 3.<a href="#section-5.4-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-4.2">A one-octet signature type.
Signature types are described in <a href="#signature-types" class="xref">Section 5.2.1</a>.<a href="#section-5.4-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-4.3">A one-octet number describing the hash algorithm used.<a href="#section-5.4-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-4.4">A one-octet number describing the public-key algorithm used.<a href="#section-5.4-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-4.5">An eight-octet number holding the Key ID of the signing key.<a href="#section-5.4-4.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.4-4.6">A one-octet number holding a flag showing whether the signature is nested.
A zero value indicates that the next packet is another One-Pass Signature packet that describes another signature to be applied to the same message data.<a href="#section-5.4-4.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.4-5">Note that if a message contains more than one one-pass signature, then the Signature packets bracket the message; that is, the first Signature packet after the message corresponds to the last one-pass packet and the final Signature packet corresponds to the first one-pass packet.<a href="#section-5.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-material-packet">
<section id="section-5.5">
        <h3 id="name-key-material-packet">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-key-material-packet" class="section-name selfRef">Key Material Packet</a>
        </h3>
<p id="section-5.5-1">A key material packet contains all the information about a public or private key.
There are four variants of this packet type, and two major versions.
Consequently, this section is complex.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<div id="key-packet-variants">
<section id="section-5.5.1">
          <h4 id="name-key-packet-variants">
<a href="#section-5.5.1" class="section-number selfRef">5.5.1. </a><a href="#name-key-packet-variants" class="section-name selfRef">Key Packet Variants</a>
          </h4>
<div id="public-key-packet-tag-6">
<section id="section-5.5.1.1">
            <h5 id="name-public-key-packet-tag-6">
<a href="#section-5.5.1.1" class="section-number selfRef">5.5.1.1. </a><a href="#name-public-key-packet-tag-6" class="section-name selfRef">Public-Key Packet (Tag 6)</a>
            </h5>
<p id="section-5.5.1.1-1">A Public-Key packet starts a series of packets that forms an OpenPGP key (sometimes called an OpenPGP certificate).<a href="#section-5.5.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="public-subkey-packet-tag-14">
<section id="section-5.5.1.2">
            <h5 id="name-public-subkey-packet-tag-14">
<a href="#section-5.5.1.2" class="section-number selfRef">5.5.1.2. </a><a href="#name-public-subkey-packet-tag-14" class="section-name selfRef">Public-Subkey Packet (Tag 14)</a>
            </h5>
<p id="section-5.5.1.2-1">A Public-Subkey packet (tag 14) has exactly the same format as a Public-Key packet, but denotes a subkey.
One or more subkeys may be associated with a top-level key.
By convention, the top-level key provides signature services, and the subkeys provide encryption services.<a href="#section-5.5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.5.1.2-2">Note: in PGP version 2.6, tag 14 was intended to indicate a comment packet.
This tag was selected for reuse because no previous version of PGP ever emitted comment packets but they did properly ignore them.
Public-Subkey packets are ignored by PGP version 2.6 and do not cause it to fail, providing a limited degree of backward compatibility.<a href="#section-5.5.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secret-key-packet-tag-5">
<section id="section-5.5.1.3">
            <h5 id="name-secret-key-packet-tag-5">
<a href="#section-5.5.1.3" class="section-number selfRef">5.5.1.3. </a><a href="#name-secret-key-packet-tag-5" class="section-name selfRef">Secret-Key Packet (Tag 5)</a>
            </h5>
<p id="section-5.5.1.3-1">A Secret-Key packet contains all the information that is found in a Public-Key packet, including the public-key material, but also includes the secret-key material after all the public-key fields.<a href="#section-5.5.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="secret-subkey-packet-tag-7">
<section id="section-5.5.1.4">
            <h5 id="name-secret-subkey-packet-tag-7">
<a href="#section-5.5.1.4" class="section-number selfRef">5.5.1.4. </a><a href="#name-secret-subkey-packet-tag-7" class="section-name selfRef">Secret-Subkey Packet (Tag 7)</a>
            </h5>
<p id="section-5.5.1.4-1">A Secret-Subkey packet (tag 7) is the subkey analog of the Secret Key packet and has exactly the same format.<a href="#section-5.5.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="public-key-packet-formats">
<section id="section-5.5.2">
          <h4 id="name-public-key-packet-formats">
<a href="#section-5.5.2" class="section-number selfRef">5.5.2. </a><a href="#name-public-key-packet-formats" class="section-name selfRef">Public-Key Packet Formats</a>
          </h4>
<p id="section-5.5.2-1">There are three versions of key-material packets.
Version 3 packets were first generated by PGP version 2.6.
Version 4 keys first appeared in PGP 5 and are the preferred key version for OpenPGP.<a href="#section-5.5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.5.2-2">OpenPGP implementations MUST create keys with version 4 format.
V3 keys are deprecated; an implementation MUST NOT generate a V3 key, but MAY accept it.<a href="#section-5.5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.5.2-3">A version 3 public key or public-subkey packet contains:<a href="#section-5.5.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2-4.1">A one-octet version number (3).<a href="#section-5.5.2-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-4.2">A four-octet number denoting the time that the key was created.<a href="#section-5.5.2-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-4.3">A two-octet number denoting the time in days that this key is valid.
If this number is zero, then it does not expire.<a href="#section-5.5.2-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-4.4">A one-octet number denoting the public-key algorithm of this key.<a href="#section-5.5.2-4.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-4.5">
              <p id="section-5.5.2-4.5.1">A series of multiprecision integers comprising the key material:<a href="#section-5.5.2-4.5.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2-4.5.2.1">a multiprecision integer (MPI) of RSA public modulus n;<a href="#section-5.5.2-4.5.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.5.2-4.5.2.2">an MPI of RSA public encryption exponent e.<a href="#section-5.5.2-4.5.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-5.5.2-5">V3 keys are deprecated.
They contain three weaknesses.
First, it is relatively easy to construct a V3 key that has the same Key ID as any other key because the Key ID is simply the low 64 bits of the public modulus.
Secondly, because the fingerprint of a V3 key hashes the key material, but not its length, there is an increased opportunity for fingerprint collisions.
Third, there are weaknesses in the MD5 hash algorithm that make developers prefer other algorithms.
See below for a fuller discussion of Key IDs and fingerprints.<a href="#section-5.5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.5.2-6">V2 keys are identical to the deprecated V3 keys except for the version number.
An implementation MUST NOT generate them and MAY accept or reject them as it sees fit.<a href="#section-5.5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.5.2-7">The version 4 format is similar to the version 3 format except for the absence of a validity period.
This has been moved to the Signature packet.
In addition, fingerprints of version 4 keys are calculated differently from version 3 keys, as described in <a href="#enhanced-key-formats" class="xref">Section 12</a>.<a href="#section-5.5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.5.2-8">A version 4 packet contains:<a href="#section-5.5.2-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2-9.1">A one-octet version number (4).<a href="#section-5.5.2-9.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-9.2">A four-octet number denoting the time that the key was created.<a href="#section-5.5.2-9.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-9.3">A one-octet number denoting the public-key algorithm of this key.<a href="#section-5.5.2-9.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-9.4">A series of multiprecision integers comprising the key material.
This is algorithm-specific and described in <a href="#algorithm-specific-parts-of-keys" class="xref">Section 5.6</a>.<a href="#section-5.5.2-9.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.5.2-10">The version 5 format is similar to the version 4 format except for the addition of a count for the key material.
This count helps parsing secret key packets (which are an extension of the public key packet format) in the case of an unknown algorithm.
In addition, fingerprints of version 5 keys are calculated differently from version 4 keys, as described in the section "Enhanced Key Formats".<a href="#section-5.5.2-10" class="pilcrow">¶</a></p>
<p id="section-5.5.2-11">A version 5 packet contains:<a href="#section-5.5.2-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.2-12.1">A one-octet version number (5).<a href="#section-5.5.2-12.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-12.2">A four-octet number denoting the time that the key was created.<a href="#section-5.5.2-12.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-12.3">A one-octet number denoting the public-key algorithm of this key.<a href="#section-5.5.2-12.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-12.4">A four-octet scalar octet count for the following public key material.<a href="#section-5.5.2-12.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.2-12.5">A series of values comprising the public key material.
This is algorithm-specific and described in <a href="#algorithm-specific-parts-of-keys" class="xref">Section 5.6</a>.<a href="#section-5.5.2-12.5" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="secret-key-packet-formats">
<section id="section-5.5.3">
          <h4 id="name-secret-key-packet-formats">
<a href="#section-5.5.3" class="section-number selfRef">5.5.3. </a><a href="#name-secret-key-packet-formats" class="section-name selfRef">Secret-Key Packet Formats</a>
          </h4>
<p id="section-5.5.3-1">The Secret-Key and Secret-Subkey packets contain all the data of the Public-Key and Public-Subkey packets, with additional algorithm-specific secret-key data appended, usually in encrypted form.<a href="#section-5.5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.5.3-2">The packet contains:<a href="#section-5.5.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.5.3-3.1">A Public-Key or Public-Subkey packet, as described above.<a href="#section-5.5.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.2">One octet indicating string-to-key usage conventions.
Zero indicates that the secret-key data is not encrypted.
255 or 254 indicates that a string-to-key specifier is being given.
Any other value is a symmetric-key encryption algorithm identifier.
A version 5 packet MUST NOT use the value 255.<a href="#section-5.5.3-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.3">Only for a version 5 packet, a one-octet scalar octet count of the next 4 optional fields.<a href="#section-5.5.3-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.4">[Optional] If string-to-key usage octet was 255, 254, or 253, a one-octet symmetric encryption algorithm.<a href="#section-5.5.3-3.4" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.5">[Optional] If string-to-key usage octet was 253, a one-octet AEAD algorithm.<a href="#section-5.5.3-3.5" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.6">[Optional] If string-to-key usage octet was 255, 254, or 253, a string-to-key specifier.
The length of the string-to-key specifier is implied by its type, as described above.<a href="#section-5.5.3-3.6" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.7">[Optional] If string-to-key usage octet was 253 (i.e. the secret data is AEAD-encrypted), an initialization vector (IV) of size specified by the AEAD algorithm (see <a href="#aead" class="xref">Section 5.16</a>), which is used as the nonce for the AEAD algorithm.<a href="#section-5.5.3-3.7" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.8">[Optional] If string-to-key usage octet was 255, 254, or a cipher algorithm identifier (i.e. the secret data is CFB-encrypted), an initialization vector (IV) of the same length as the cipher's block size.<a href="#section-5.5.3-3.8" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.9">Only for a version 5 packet, a four-octet scalar octet count for the following secret key material.
This includes the encrypted SHA-1 hash or AEAD tag if the string-to-key usage octet is 254 or 253.<a href="#section-5.5.3-3.9" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.10">Plain or encrypted multiprecision integers comprising the secret key data.
This is algorithm-specific and described in section <a href="#algorithm-specific-parts-of-keys" class="xref">Section 5.6</a>.
If the string-to-key usage octet is 253, then an AEAD authentication tag is part of that data.
If the string-to-key usage octet is 254, a 20-octet SHA-1 hash of the plaintext of the algorithm-specific portion is appended to plaintext and encrypted with it.
If the string-to-key usage octet is 255 or another nonzero value (i.e., a symmetric-key encryption algorithm identifier), a two-octet checksum of the plaintext of the algorithm-specific portion (sum of all octets, mod 65536) is appended to plaintext and encrypted with it. (This is deprecated and SHOULD NOT be used, see below.)<a href="#section-5.5.3-3.10" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.5.3-3.11">If the string-to-key usage octet is zero, then a two-octet checksum of the algorithm-specific portion (sum of all octets, mod 65536).<a href="#section-5.5.3-3.11" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.5.3-4">Note that the version 5 packet format adds two count values to help parsing packets with unknown S2K or public key algorithms.<a href="#section-5.5.3-4" class="pilcrow">¶</a></p>
<p id="section-5.5.3-5">Secret MPI values can be encrypted using a passphrase.
If a string-to-key specifier is given, that describes the algorithm for converting the passphrase to a key, else a simple MD5 hash of the passphrase is used.
Implementations MUST use a string-to-key specifier; the simple hash is for backward compatibility and is deprecated, though implementations MAY continue to use existing private keys in the old format.
The cipher for encrypting the MPIs is specified in the Secret-Key packet.<a href="#section-5.5.3-5" class="pilcrow">¶</a></p>
<p id="section-5.5.3-6">Encryption/decryption of the secret data is done using the key created from the passphrase and the initialization vector from the packet. If the string-to-key usage octet is not 253, CFB mode is used.
A different mode is used with V3 keys (which are only RSA) than with other key formats.
With V3 keys, the MPI bit count prefix (i.e., the first two octets) is not encrypted.
Only the MPI non-prefix data is encrypted.
Furthermore, the CFB state is resynchronized at the beginning of each new MPI value, so that the CFB block boundary is aligned with the start of the MPI data.<a href="#section-5.5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.5.3-7">With V4 and V5 keys, a simpler method is used.
All secret MPI values are encrypted, including the MPI bitcount prefix.<a href="#section-5.5.3-7" class="pilcrow">¶</a></p>
<p id="section-5.5.3-8">If the string-to-key usage octet is 253, the encrypted MPI values are encrypted as one combined plaintext using one of the AEAD algorithms specified for the AEAD Encrypted Data Packet.
Note that no chunks are used and that there is only one authentication tag.
As additional data, the Packet Tag in new format encoding (bits 7 and 6 set, bits 5-0 carry the packet tag), followed by the public key packet fields, starting with the packet version number, are passed to the AEAD algorithm.
For example, the additional data used with a Secret-Key Packet of version 4 consists of the octets 0xC5, 0x04, followed by four octets of creation time, one octet denoting the public-key algorithm, and the algorithm-specific public-key parameters. For a Secret-Subkey Packet, the first octet would be 0xC7. For a version 5 key packet, the second octet would be 0x05, and the four-octet octet count of the public key material would be included as well (see <a href="#public-key-packet-formats" class="xref">Section 5.5.2</a>).<a href="#section-5.5.3-8" class="pilcrow">¶</a></p>
<p id="section-5.5.3-9">The two-octet checksum that follows the algorithm-specific portion is the algebraic sum, mod 65536, of the plaintext of all the algorithm-specific octets (including MPI prefix and data).
With V3 keys, the checksum is stored in the clear.
With V4 keys, the checksum is encrypted like the algorithm-specific data.
This value is used to check that the passphrase was correct.
However, this checksum is deprecated; an implementation SHOULD NOT use it, but should rather use the SHA-1 hash denoted with a usage octet of 254.
The reason for this is that there are some attacks that involve undetectably modifying the secret key.
If the string-to-key usage octet is 253 no checksum or SHA-1 hash is used but the authentication tag of the AEAD algorithm follows.<a href="#section-5.5.3-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="algorithm-specific-parts-of-keys">
<section id="section-5.6">
        <h3 id="name-algorithm-specific-parts-of">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-algorithm-specific-parts-of" class="section-name selfRef">Algorithm-specific Parts of Keys</a>
        </h3>
<p id="section-5.6-1">The public and secret key format specifies algorithm-specific parts of a key.
The following sections describe them in detail.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<div id="key-rsa">
<section id="section-5.6.1">
          <h4 id="name-algorithm-specific-part-for">
<a href="#section-5.6.1" class="section-number selfRef">5.6.1. </a><a href="#name-algorithm-specific-part-for" class="section-name selfRef">Algorithm-Specific Part for RSA Keys</a>
          </h4>
<p id="section-5.6.1-1">The public key is this series of multiprecision integers:<a href="#section-5.6.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.1-2.1">MPI of RSA public modulus n;<a href="#section-5.6.1-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.1-2.2">MPI of RSA public encryption exponent e.<a href="#section-5.6.1-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.6.1-3">The secret key is this series of multiprecision integers:<a href="#section-5.6.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.1-4.1">MPI of RSA secret exponent d;<a href="#section-5.6.1-4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.1-4.2">MPI of RSA secret prime value p;<a href="#section-5.6.1-4.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.1-4.3">MPI of RSA secret prime value q (p &lt; q);<a href="#section-5.6.1-4.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.1-4.4">MPI of u, the multiplicative inverse of p, mod q.<a href="#section-5.6.1-4.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="key-dsa">
<section id="section-5.6.2">
          <h4 id="name-algorithm-specific-part-for-">
<a href="#section-5.6.2" class="section-number selfRef">5.6.2. </a><a href="#name-algorithm-specific-part-for-" class="section-name selfRef">Algorithm-Specific Part for DSA Keys</a>
          </h4>
<p id="section-5.6.2-1">The public key is this series of multiprecision integers:<a href="#section-5.6.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.2-2.1">MPI of DSA prime p;<a href="#section-5.6.2-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.2-2.2">MPI of DSA group order q (q is a prime divisor of p-1);<a href="#section-5.6.2-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.2-2.3">MPI of DSA group generator g;<a href="#section-5.6.2-2.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.2-2.4">MPI of DSA public-key value y (= g**x mod p where x is secret).<a href="#section-5.6.2-2.4" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.6.2-3">The secret key is this single multiprecision integer:<a href="#section-5.6.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.2-4.1">MPI of DSA secret exponent x.<a href="#section-5.6.2-4.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="key-elgamal">
<section id="section-5.6.3">
          <h4 id="name-algorithm-specific-part-for-e">
<a href="#section-5.6.3" class="section-number selfRef">5.6.3. </a><a href="#name-algorithm-specific-part-for-e" class="section-name selfRef">Algorithm-Specific Part for Elgamal Keys</a>
          </h4>
<p id="section-5.6.3-1">The public key is this series of multiprecision integers:<a href="#section-5.6.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.3-2.1">MPI of Elgamal prime p;<a href="#section-5.6.3-2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.3-2.2">MPI of Elgamal group generator g;<a href="#section-5.6.3-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.3-2.3">MPI of Elgamal public key value y (= g**x mod p where x is secret).<a href="#section-5.6.3-2.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.6.3-3">The secret key is this single multiprecision integer:<a href="#section-5.6.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.3-4.1">MPI of Elgamal secret exponent x.<a href="#section-5.6.3-4.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="key-ecdsa">
<section id="section-5.6.4">
          <h4 id="name-algorithm-specific-part-for-ec">
<a href="#section-5.6.4" class="section-number selfRef">5.6.4. </a><a href="#name-algorithm-specific-part-for-ec" class="section-name selfRef">Algorithm-Specific Part for ECDSA Keys</a>
          </h4>
<p id="section-5.6.4-1">The public key is this series of values:<a href="#section-5.6.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.4-2.1">
              <p id="section-5.6.4-2.1.1">A variable-length field containing a curve OID, which is formatted as follows:<a href="#section-5.6.4-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.4-2.1.2.1">A one-octet size of the following field; values 0 and 0xFF are reserved for future extensions,<a href="#section-5.6.4-2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.6.4-2.1.2.2">The octets representing a curve OID (defined in <a href="#ec-curves" class="xref">Section 9.2</a>);<a href="#section-5.6.4-2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.6.4-2.2">MPI of an EC point representing a public key.<a href="#section-5.6.4-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.6.4-3">The secret key is this single multiprecision integer:<a href="#section-5.6.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.4-4.1">MPI of an integer representing the secret key, which is a scalar of the public EC point.<a href="#section-5.6.4-4.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="key-eddsa">
<section id="section-5.6.5">
          <h4 id="name-algorithm-specific-part-for-ed">
<a href="#section-5.6.5" class="section-number selfRef">5.6.5. </a><a href="#name-algorithm-specific-part-for-ed" class="section-name selfRef">Algorithm-Specific Part for EdDSA Keys</a>
          </h4>
<p id="section-5.6.5-1">The public key is this series of values:<a href="#section-5.6.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.5-2.1">
              <p id="section-5.6.5-2.1.1">A variable-length field containing a curve OID, formatted as follows:<a href="#section-5.6.5-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.5-2.1.2.1">A one-octet size of the following field; values 0 and 0xFF are reserved for future extensions,<a href="#section-5.6.5-2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.6.5-2.1.2.2">The octets representing a curve OID, defined in <a href="#ec-curves" class="xref">Section 9.2</a>;<a href="#section-5.6.5-2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.6.5-2.2">An MPI of an EC point representing a public key Q in prefixed native form (see <a href="#ec-point-prefixed-native" class="xref">Section 13.2.2</a>).<a href="#section-5.6.5-2.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.6.5-3">The secret key is this single multiprecision integer:<a href="#section-5.6.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.5-4.1">An MPI-encoded octet string representing the native form of the secret key, in the curve-specific format described in <a href="#curve-specific-formats" class="xref">Section 9.2.1</a>.<a href="#section-5.6.5-4.1" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-5.6.5-5">See <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> for more details about the native octet strings.<a href="#section-5.6.5-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-ecdh">
<section id="section-5.6.6">
          <h4 id="name-algorithm-specific-part-for-ecd">
<a href="#section-5.6.6" class="section-number selfRef">5.6.6. </a><a href="#name-algorithm-specific-part-for-ecd" class="section-name selfRef">Algorithm-Specific Part for ECDH Keys</a>
          </h4>
<p id="section-5.6.6-1">The public key is this series of values:<a href="#section-5.6.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.6-2.1">
              <p id="section-5.6.6-2.1.1">A variable-length field containing a curve OID, which is formatted as follows:<a href="#section-5.6.6-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.6-2.1.2.1">A one-octet size of the following field; values 0 and 0xFF are reserved for future extensions,<a href="#section-5.6.6-2.1.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.6.6-2.1.2.2">Octets representing a curve OID, defined in <a href="#ec-curves" class="xref">Section 9.2</a>;<a href="#section-5.6.6-2.1.2.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-5.6.6-2.2">MPI of an EC point representing a public key, in the point format associated with the curve as specified in <a href="#curve-specific-formats" class="xref">Section 9.2.1</a><a href="#section-5.6.6-2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-5.6.6-2.3">
              <p id="section-5.6.6-2.3.1">A variable-length field containing KDF parameters, which is formatted as follows:<a href="#section-5.6.6-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.6-2.3.2.1">A one-octet size of the following fields; values 0 and 0xFF are reserved for future extensions,<a href="#section-5.6.6-2.3.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.6.6-2.3.2.2">A one-octet value 1, reserved for future extensions,<a href="#section-5.6.6-2.3.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.6.6-2.3.2.3">A one-octet hash function ID used with a KDF,<a href="#section-5.6.6-2.3.2.3" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-5.6.6-2.3.2.4">A one-octet algorithm ID for the symmetric algorithm used to wrap the symmetric key used for the message encryption; see <a href="#ec-dh-algorithm-ecdh" class="xref">Section 13.5</a> for details.<a href="#section-5.6.6-2.3.2.4" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-5.6.6-3">Observe that an ECDH public key is composed of the same sequence of fields that define an ECDSA key plus the KDF parameters field.<a href="#section-5.6.6-3" class="pilcrow">¶</a></p>
<p id="section-5.6.6-4">The secret key is this single multiprecision integer:<a href="#section-5.6.6-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.6.6-5.1">An MPI representing the secret key, in the curve-specific format described in <a href="#curve-specific-formats" class="xref">Section 9.2.1</a>.<a href="#section-5.6.6-5.1" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="compressed-data-packet-tag-8">
<section id="section-5.7">
        <h3 id="name-compressed-data-packet-tag-">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-compressed-data-packet-tag-" class="section-name selfRef">Compressed Data Packet (Tag 8)</a>
        </h3>
<p id="section-5.7-1">The Compressed Data packet contains compressed data.
Typically, this packet is found as the contents of an encrypted packet, or following a Signature or One-Pass Signature packet, and contains a literal data packet.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">The body of this packet consists of:<a href="#section-5.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.7-3.1">One octet that gives the algorithm used to compress the packet.<a href="#section-5.7-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.7-3.2">Compressed data, which makes up the remainder of the packet.<a href="#section-5.7-3.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.7-4">A Compressed Data Packet's body contains an block that compresses some set of packets.
See <a href="#packet-composition" class="xref">Section 11</a> for details on how messages are formed.<a href="#section-5.7-4" class="pilcrow">¶</a></p>
<p id="section-5.7-5">ZIP-compressed packets are compressed with raw <span>[<a href="#RFC1951" class="xref">RFC1951</a>]</span> DEFLATE blocks.
Note that PGP V2.6 uses 13 bits of compression.
If an implementation uses more bits of compression, PGP V2.6 cannot decompress it.<a href="#section-5.7-5" class="pilcrow">¶</a></p>
<p id="section-5.7-6">ZLIB-compressed packets are compressed with <span>[<a href="#RFC1950" class="xref">RFC1950</a>]</span> ZLIB-style blocks.<a href="#section-5.7-6" class="pilcrow">¶</a></p>
<p id="section-5.7-7">BZip2-compressed packets are compressed using the BZip2 <span>[<a href="#BZ2" class="xref">BZ2</a>]</span> algorithm.<a href="#section-5.7-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="symmetrically-encrypted-data-packet-tag-9">
<section id="section-5.8">
        <h3 id="name-symmetrically-encrypted-dat">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-symmetrically-encrypted-dat" class="section-name selfRef">Symmetrically Encrypted Data Packet (Tag 9)</a>
        </h3>
<p id="section-5.8-1">The Symmetrically Encrypted Data packet contains data encrypted with a symmetric-key algorithm.
When it has been decrypted, it contains other packets (usually a literal data packet or compressed data packet, but in theory other Symmetrically Encrypted Data packets or sequences of packets that form whole OpenPGP messages).<a href="#section-5.8-1" class="pilcrow">¶</a></p>
<p id="section-5.8-2">This packet is obsolete.
An implementation MUST NOT create this packet.
An implementation MAY process such a packet but it MUST return a clear diagnostic that a non-integrity protected packet has been processed.
The implementation SHOULD also return an error in this case and stop processing.<a href="#section-5.8-2" class="pilcrow">¶</a></p>
<p id="section-5.8-3">The body of this packet consists of:<a href="#section-5.8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.8-4.1">Encrypted data, the output of the selected symmetric-key cipher operating in OpenPGP's variant of Cipher Feedback (CFB) mode.<a href="#section-5.8-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.8-5">The symmetric cipher used may be specified in a Public-Key or Symmetric-Key Encrypted Session Key packet that precedes the Symmetrically Encrypted Data packet.
In that case, the cipher algorithm octet is prefixed to the session key before it is encrypted.
If no packets of these types precede the encrypted data, the IDEA algorithm is used with the session key calculated as the MD5 hash of the passphrase, though this use is deprecated.<a href="#section-5.8-5" class="pilcrow">¶</a></p>
<p id="section-5.8-6">The data is encrypted in CFB mode, with a CFB shift size equal to the cipher's block size.
The Initial Vector (IV) is specified as all zeros.
Instead of using an IV, OpenPGP prefixes a string of length equal to the block size of the cipher plus two to the data before it is encrypted.
The first block-size octets (for example, 8 octets for a 64-bit block length) are random, and the following two octets are copies of the last two octets of the IV.
For example, in an 8-octet block, octet 9 is a repeat of octet 7, and octet 10 is a repeat of octet 8.
In a cipher of length 16, octet 17 is a repeat of octet 15 and octet 18 is a repeat of octet 16.
As a pedantic clarification, in both these examples, we consider the first octet to be numbered 1.<a href="#section-5.8-6" class="pilcrow">¶</a></p>
<p id="section-5.8-7">After encrypting the first block-size-plus-two octets, the CFB state is resynchronized.
The last block-size octets of ciphertext are passed through the cipher and the block boundary is reset.<a href="#section-5.8-7" class="pilcrow">¶</a></p>
<p id="section-5.8-8">The repetition of 16 bits in the random data prefixed to the message allows the receiver to immediately check whether the session key is incorrect.
See <a href="#security-considerations" class="xref">Section 15</a> for hints on the proper use of this "quick check".<a href="#section-5.8-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="marker-packet-obsolete-literal-packet-tag-10">
<section id="section-5.9">
        <h3 id="name-marker-packet-obsolete-lite">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-marker-packet-obsolete-lite" class="section-name selfRef">Marker Packet (Obsolete Literal Packet) (Tag 10)</a>
        </h3>
<p id="section-5.9-1">An experimental version of PGP used this packet as the Literal packet, but no released version of PGP generated Literal packets with this tag.
With PGP 5, this packet has been reassigned and is reserved for use as the Marker packet.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
<p id="section-5.9-2">The body of this packet consists of:<a href="#section-5.9-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.9-3.1">The three octets 0x50, 0x47, 0x50 (which spell "PGP" in UTF-8).<a href="#section-5.9-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.9-4">Such a packet MUST be ignored when received.
It may be placed at the beginning of a message that uses features not available in PGP version 2.6 in order to cause that version to report that newer software is necessary to process the message.<a href="#section-5.9-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="literal-data-packet-tag-11">
<section id="section-5.10">
        <h3 id="name-literal-data-packet-tag-11">
<a href="#section-5.10" class="section-number selfRef">5.10. </a><a href="#name-literal-data-packet-tag-11" class="section-name selfRef">Literal Data Packet (Tag 11)</a>
        </h3>
<p id="section-5.10-1">A Literal Data packet contains the body of a message; data that is not to be further interpreted.<a href="#section-5.10-1" class="pilcrow">¶</a></p>
<p id="section-5.10-2">The body of this packet consists of:<a href="#section-5.10-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.10-3.1">
            <p id="section-5.10-3.1.1">A one-octet field that describes how the data is formatted.<a href="#section-5.10-3.1.1" class="pilcrow">¶</a></p>
<p id="section-5.10-3.1.2">
If it is a <code>b</code> (0x62), then the Literal packet contains binary data.
If it is a <code>t</code> (0x74), then it contains text data, and thus may need line ends converted to local form, or other text-mode changes.
The tag <code>u</code> (0x75) means the same as <code>t</code>, but also indicates that implementation believes that the literal data contains UTF-8 text.<a href="#section-5.10-3.1.2" class="pilcrow">¶</a></p>
<p id="section-5.10-3.1.3">
Early versions of PGP also defined a value of <code>l</code> as a 'local' mode for machine-local conversions.
<span>[<a href="#RFC1991" class="xref">RFC1991</a>]</span> incorrectly stated this local mode flag as <code>1</code> (ASCII numeral one).
Both of these local modes are deprecated.<a href="#section-5.10-3.1.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.10-3.2">
            <p id="section-5.10-3.2.1">File name as a string (one-octet length, followed by a file name).
This may be a zero-length string.
Commonly, if the source of the encrypted data is a file, this will be the name of the encrypted file.
An implementation MAY consider the file name in the Literal packet to be a more authoritative name than the actual file name.<a href="#section-5.10-3.2.1" class="pilcrow">¶</a></p>
<p id="section-5.10-3.2.2">
If the special name <code>_CONSOLE</code> is used, the message is considered to be "for your eyes only".
This advises that the message data is unusually sensitive, and the receiving program should process it more carefully, perhaps avoiding storing the received data to disk, for example.<a href="#section-5.10-3.2.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-5.10-3.3">A four-octet number that indicates a date associated with the literal data.
Commonly, the date might be the modification date of a file, or the time the packet was created, or a zero that indicates no specific time.<a href="#section-5.10-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.10-3.4">
            <p id="section-5.10-3.4.1">The remainder of the packet is literal data.<a href="#section-5.10-3.4.1" class="pilcrow">¶</a></p>
<p id="section-5.10-3.4.2">
Text data is stored with &lt;CR&gt;&lt;LF&gt; text endings (i.e., network-normal line endings).
These should be converted to native line endings by the receiving software.<a href="#section-5.10-3.4.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-5.10-4">Note that V3 and V4 signatures do not include the formatting octet, the file name, and the date field of the literal packet in a signature hash and thus are not protected against tampering in a signed document.
In contrast V5 signatures include them.<a href="#section-5.10-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="trust-packet-tag-12">
<section id="section-5.11">
        <h3 id="name-trust-packet-tag-12">
<a href="#section-5.11" class="section-number selfRef">5.11. </a><a href="#name-trust-packet-tag-12" class="section-name selfRef">Trust Packet (Tag 12)</a>
        </h3>
<p id="section-5.11-1">The Trust packet is used only within keyrings and is not normally exported.
Trust packets contain data that record the user's specifications of which key holders are trustworthy introducers, along with other information that implementing software uses for trust information.
The format of Trust packets is defined by a given implementation.<a href="#section-5.11-1" class="pilcrow">¶</a></p>
<p id="section-5.11-2">Trust packets SHOULD NOT be emitted to output streams that are transferred to other users, and they SHOULD be ignored on any input other than local keyring files.<a href="#section-5.11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user-id-packet-tag-13">
<section id="section-5.12">
        <h3 id="name-user-id-packet-tag-13">
<a href="#section-5.12" class="section-number selfRef">5.12. </a><a href="#name-user-id-packet-tag-13" class="section-name selfRef">User ID Packet (Tag 13)</a>
        </h3>
<p id="section-5.12-1">A User ID packet consists of UTF-8 text that is intended to represent the name and email address of the key holder.
By convention, it includes an <span>[<a href="#RFC2822" class="xref">RFC2822</a>]</span> mail name-addr, but there are no restrictions on its content.
The packet length in the header specifies the length of the User ID.<a href="#section-5.12-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user-attribute-packet">
<section id="section-5.13">
        <h3 id="name-user-attribute-packet-tag-1">
<a href="#section-5.13" class="section-number selfRef">5.13. </a><a href="#name-user-attribute-packet-tag-1" class="section-name selfRef">User Attribute Packet (Tag 17)</a>
        </h3>
<p id="section-5.13-1">The User Attribute packet is a variation of the User ID packet.
It is capable of storing more types of data than the User ID packet, which is limited to text.
Like the User ID packet, a User Attribute packet may be certified by the key owner ("self-signed") or any other key owner who cares to certify it.
Except as noted, a User Attribute packet may be used anywhere that a User ID packet may be used.<a href="#section-5.13-1" class="pilcrow">¶</a></p>
<p id="section-5.13-2">While User Attribute packets are not a required part of the OpenPGP standard, implementations SHOULD provide at least enough compatibility to properly handle a certification signature on the User Attribute packet.
A simple way to do this is by treating the User Attribute packet as a User ID packet with opaque contents, but an implementation may use any method desired.<a href="#section-5.13-2" class="pilcrow">¶</a></p>
<p id="section-5.13-3">The User Attribute packet is made up of one or more attribute subpackets.
Each subpacket consists of a subpacket header and a body.
The header consists of:<a href="#section-5.13-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.13-4.1">the subpacket length (1, 2, or 5 octets)<a href="#section-5.13-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.13-4.2">the subpacket type (1 octet)<a href="#section-5.13-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.13-5">and is followed by the subpacket specific data.<a href="#section-5.13-5" class="pilcrow">¶</a></p>
<p id="section-5.13-6">The following table lists the currently known subpackets:<a href="#section-5.13-6" class="pilcrow">¶</a></p>
<span id="name-user-attribute-type-registr"></span><table class="center" id="table-13">
          <caption>
<a href="#table-13" class="selfRef">Table 13</a>:
<a href="#name-user-attribute-type-registr" class="selfRef">User Attribute type registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Attribute Subpacket</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">Image Attribute Subpacket</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">100-110</td>
              <td class="text-left" rowspan="1" colspan="1">Private/Experimental Use</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.13-8">An implementation SHOULD ignore any subpacket of a type that it does not recognize.<a href="#section-5.13-8" class="pilcrow">¶</a></p>
<div id="uat-image">
<section id="section-5.13.1">
          <h4 id="name-the-image-attribute-subpack">
<a href="#section-5.13.1" class="section-number selfRef">5.13.1. </a><a href="#name-the-image-attribute-subpack" class="section-name selfRef">The Image Attribute Subpacket</a>
          </h4>
<p id="section-5.13.1-1">The Image Attribute subpacket is used to encode an image, presumably (but not required to be) that of the key owner.<a href="#section-5.13.1-1" class="pilcrow">¶</a></p>
<p id="section-5.13.1-2">The Image Attribute subpacket begins with an image header.
The first two octets of the image header contain the length of the image header.
Note that unlike other multi-octet numerical values in this document, due to a historical accident this value is encoded as a little-endian number.
The image header length is followed by a single octet for the image header version.
The only currently defined version of the image header is 1, which is a 16-octet image header.
The first three octets of a version 1 image header are thus 0x10, 0x00, 0x01.<a href="#section-5.13.1-2" class="pilcrow">¶</a></p>
<p id="section-5.13.1-3">The fourth octet of a version 1 image header designates the encoding format of the image.
The only currently defined encoding format is the value 1 to indicate JPEG.
Image format types 100 through 110 are reserved for private or experimental use.
The rest of the version 1 image header is made up of 12 reserved octets, all of which MUST be set to 0.<a href="#section-5.13.1-3" class="pilcrow">¶</a></p>
<p id="section-5.13.1-4">The rest of the image subpacket contains the image itself.
As the only currently defined image type is JPEG, the image is encoded in the JPEG File Interchange Format (JFIF), a standard file format for JPEG images <span>[<a href="#JFIF" class="xref">JFIF</a>]</span>.<a href="#section-5.13.1-4" class="pilcrow">¶</a></p>
<p id="section-5.13.1-5">An implementation MAY try to determine the type of an image by examination of the image data if it is unable to handle a particular version of the image header or if a specified encoding format value is not recognized.<a href="#section-5.13.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="seipd">
<section id="section-5.14">
        <h3 id="name-sym-encrypted-integrity-pro">
<a href="#section-5.14" class="section-number selfRef">5.14. </a><a href="#name-sym-encrypted-integrity-pro" class="section-name selfRef">Sym. Encrypted Integrity Protected Data Packet (Tag 18)</a>
        </h3>
<p id="section-5.14-1">The Symmetrically Encrypted Integrity Protected Data packet is a variant of the Symmetrically Encrypted Data packet.
It is a new feature created for OpenPGP that addresses the problem of detecting a modification to encrypted data.
It is used in combination with a Modification Detection Code packet.<a href="#section-5.14-1" class="pilcrow">¶</a></p>
<p id="section-5.14-2">There is a corresponding feature in the features Signature subpacket that denotes that an implementation can properly use this packet type.
An implementation MUST support decrypting and generating these packets.
An implementation SHOULD specifically denote support for this packet, but it MAY infer it from other mechanisms.<a href="#section-5.14-2" class="pilcrow">¶</a></p>
<p id="section-5.14-3">For example, an implementation might infer from the use of a cipher such as Advanced Encryption Standard (AES) or Twofish that a user supports this feature.
It might place in the unhashed portion of another user's key signature a Features subpacket.
It might also present a user with an opportunity to regenerate their own self-signature with a Features subpacket.<a href="#section-5.14-3" class="pilcrow">¶</a></p>
<p id="section-5.14-4">This packet contains data encrypted with a symmetric-key algorithm and protected against modification by the SHA-1 hash algorithm.
When it has been decrypted, it will typically contain other packets (often a Literal Data packet or Compressed Data packet).
The last decrypted packet in this packet's payload MUST be a Modification Detection Code packet.<a href="#section-5.14-4" class="pilcrow">¶</a></p>
<p id="section-5.14-5">The body of this packet consists of:<a href="#section-5.14-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.14-6.1">A one-octet version number.
The only currently defined value is 1.<a href="#section-5.14-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.14-6.2">Encrypted data, the output of the selected symmetric-key cipher operating in Cipher Feedback mode with shift amount equal to the block size of the cipher (CFB-n where n is the block size).<a href="#section-5.14-6.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.14-7">The symmetric cipher used MUST be specified in a Public-Key or Symmetric-Key Encrypted Session Key packet that precedes the Symmetrically Encrypted Integrity Protected Data packet.
In either case, the cipher algorithm octet is prefixed to the session key before it is encrypted.<a href="#section-5.14-7" class="pilcrow">¶</a></p>
<p id="section-5.14-8">The data is encrypted in CFB mode, with a CFB shift size equal to the cipher's block size.
The Initial Vector (IV) is specified as all zeros.
Instead of using an IV, OpenPGP prefixes an octet string to the data before it is encrypted.
The length of the octet string equals the block size of the cipher in octets, plus two.
The first octets in the group, of length equal to the block size of the cipher, are random; the last two octets are each copies of their 2nd preceding octet.
For example, with a cipher whose block size is 128 bits or 16 octets, the prefix data will contain 16 random octets, then two more octets, which are copies of the 15th and 16th octets, respectively.
Unlike the Symmetrically Encrypted Data Packet, no special CFB resynchronization is done after encrypting this prefix data.
See <a href="#cfb-mode" class="xref">Section 14.10</a> for more details.<a href="#section-5.14-8" class="pilcrow">¶</a></p>
<p id="section-5.14-9">The repetition of 16 bits in the random data prefixed to the message allows the receiver to immediately check whether the session key is incorrect.<a href="#section-5.14-9" class="pilcrow">¶</a></p>
<p id="section-5.14-10">The plaintext of the data to be encrypted is passed through the SHA-1 hash function, and the result of the hash is appended to the plaintext in a Modification Detection Code packet.
The input to the hash function includes the prefix data described above; it includes all of the plaintext, and then also includes two octets of values 0xD3, 0x14.
These represent the encoding of a Modification Detection Code packet tag and length field of 20 octets.<a href="#section-5.14-10" class="pilcrow">¶</a></p>
<p id="section-5.14-11">The resulting hash value is stored in a Modification Detection Code (MDC) packet, which MUST use the two octet encoding just given to represent its tag and length field.
The body of the MDC packet is the 20-octet output of the SHA-1 hash.<a href="#section-5.14-11" class="pilcrow">¶</a></p>
<p id="section-5.14-12">The Modification Detection Code packet is appended to the plaintext and encrypted along with the plaintext using the same CFB context.<a href="#section-5.14-12" class="pilcrow">¶</a></p>
<p id="section-5.14-13">During decryption, the plaintext data should be hashed with SHA-1, including the prefix data as well as the packet tag and length field of the Modification Detection Code packet.
The body of the MDC packet, upon decryption, is compared with the result of the SHA-1 hash.<a href="#section-5.14-13" class="pilcrow">¶</a></p>
<p id="section-5.14-14">Any failure of the MDC indicates that the message has been modified and MUST be treated as a security problem.
Failures include a difference in the hash values, but also the absence of an MDC packet, or an MDC packet in any position other than the end of the plaintext.
Any failure SHOULD be reported to the user.<a href="#section-5.14-14" class="pilcrow">¶</a></p>
<p id="section-5.14-15">Note: future designs of new versions of this packet should consider rollback attacks since it will be possible for an attacker to change the version back to 1.<a href="#section-5.14-15" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-5.14-16.1">NON-NORMATIVE EXPLANATION<a href="#section-5.14-16.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.14-16.2">The MDC system, as packets 18 and 19 are called, were created to
  provide an integrity mechanism that is less strong than a
  signature, yet stronger than bare CFB encryption.<a href="#section-5.14-16.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.14-16.3">It is a limitation of CFB encryption that damage to the ciphertext
  will corrupt the affected cipher blocks and the block following.
  Additionally, if data is removed from the end of a CFB-encrypted
  block, that removal is undetectable.  (Note also that CBC mode has
  a similar limitation, but data removed from the front of the block
  is undetectable.)<a href="#section-5.14-16.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.14-16.4">The obvious way to protect or authenticate an encrypted block is
  to digitally sign it.  However, many people do not wish to
  habitually sign data, for a large number of reasons beyond the
  scope of this document.  Suffice it to say that many people
  consider properties such as deniability to be as valuable as
  integrity.<a href="#section-5.14-16.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.14-16.5">OpenPGP addresses this desire to have more security than raw
  encryption and yet preserve deniability with the MDC system.  An
  MDC is intentionally not a MAC.  Its name was not selected by
  accident.  It is analogous to a checksum.<a href="#section-5.14-16.5" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.14-16.6">Despite the fact that it is a relatively modest system, it has
  proved itself in the real world.  It is an effective defense to
  several attacks that have surfaced since it has been created.  It
  has met its modest goals admirably.<a href="#section-5.14-16.6" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.14-16.7">Consequently, because it is a modest security system, it has
  modest requirements on the hash function(s) it employs.  It does
  not rely on a hash function being collision-free, it relies on a
  hash function being one-way.  If a forger, Frank, wishes to send
  Alice a (digitally) unsigned message that says, "I've always
  secretly loved you, signed Bob", it is far easier for him to
  construct a new message than it is to modify anything intercepted
  from Bob.  (Note also that if Bob wishes to communicate secretly
  with Alice, but without authentication or identification and with
  a threat model that includes forgers, he has a problem that
  transcends mere cryptography.)<a href="#section-5.14-16.7" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.14-16.8">Note also that unlike nearly every other OpenPGP subsystem, there
  are no parameters in the MDC system.  It hard-defines SHA-1 as its
  hash function.  This is not an accident.  It is an intentional
  choice to avoid downgrade and cross-grade attacks while making a
  simple, fast system.  (A downgrade attack would be an attack that
  replaced SHA2-256 with SHA-1, for example.  A cross-grade attack
  would replace SHA-1 with another 160-bit hash, such as
  RIPE-MD/160, for example.)<a href="#section-5.14-16.8" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-5.14-16.9">However, given the present state of hash function cryptanalysis
  and cryptography, it may be desirable to upgrade the MDC system to
  a new hash function.  See <a href="#extension-of-mdc" class="xref">Section 14.12</a> for guidance.<a href="#section-5.14-16.9" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="modification-detection-code-packet-tag-19">
<section id="section-5.15">
        <h3 id="name-modification-detection-code">
<a href="#section-5.15" class="section-number selfRef">5.15. </a><a href="#name-modification-detection-code" class="section-name selfRef">Modification Detection Code Packet (Tag 19)</a>
        </h3>
<p id="section-5.15-1">The Modification Detection Code packet contains a SHA-1 hash of plaintext data, which is used to detect message modification.
It is only used with a Symmetrically Encrypted Integrity Protected Data packet.
The Modification Detection Code packet MUST be the last packet in the plaintext data that is encrypted in the Symmetrically Encrypted Integrity Protected Data packet, and MUST appear in no other place.<a href="#section-5.15-1" class="pilcrow">¶</a></p>
<p id="section-5.15-2">A Modification Detection Code packet MUST have a length of 20 octets.<a href="#section-5.15-2" class="pilcrow">¶</a></p>
<p id="section-5.15-3">The body of this packet consists of:<a href="#section-5.15-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.15-4.1">A 20-octet SHA-1 hash of the preceding plaintext data of the Symmetrically Encrypted Integrity Protected Data packet, including prefix data, the tag octet, and length octet of the Modification Detection Code packet.<a href="#section-5.15-4.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.15-5">Note that the Modification Detection Code packet MUST always use a new format encoding of the packet tag, and a one-octet encoding of the packet length.
The reason for this is that the hashing rules for modification detection include a one-octet tag and one-octet length in the data hash.
While this is a bit restrictive, it reduces complexity.<a href="#section-5.15-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aead">
<section id="section-5.16">
        <h3 id="name-aead-encrypted-data-packet-">
<a href="#section-5.16" class="section-number selfRef">5.16. </a><a href="#name-aead-encrypted-data-packet-" class="section-name selfRef">AEAD Encrypted Data Packet (Tag 20)</a>
        </h3>
<p id="section-5.16-1">This packet contains data encrypted with an authenticated encryption and additional data (AEAD) construction.
When it has been decrypted, it will typically contain other packets (often a Literal Data packet or Compressed Data packet).<a href="#section-5.16-1" class="pilcrow">¶</a></p>
<p id="section-5.16-2">The body of this packet starts with:<a href="#section-5.16-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.16-3.1">A one-octet version number.
The only currently defined value is 1.<a href="#section-5.16-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.16-4">When the version is 1, it is followed by the following fields:<a href="#section-5.16-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.16-5.1">A one-octet cipher algorithm.<a href="#section-5.16-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.16-5.2">A one-octet AEAD algorithm.<a href="#section-5.16-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.16-5.3">A one-octet chunk size.<a href="#section-5.16-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.16-5.4">A initialization vector of size specified by the AEAD algorithm.<a href="#section-5.16-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.16-5.5">Encrypted data, the output of the selected symmetric-key cipher operating in the given AEAD mode.<a href="#section-5.16-5.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-5.16-5.6">A final, summary authentication tag for the AEAD mode.<a href="#section-5.16-5.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-5.16-6">An AEAD encrypted data packet consists of one or more chunks of data.
The plaintext of each chunk is of a size specified using the chunk size octet using the method specified below.<a href="#section-5.16-6" class="pilcrow">¶</a></p>
<p id="section-5.16-7">The encrypted data consists of the encryption of each chunk of plaintext, followed immediately by the relevant authentication tag.
If the last chunk of plaintext is smaller than the chunk size, the ciphertext for that data may be shorter; it is nevertheless followed by a full authentication tag.<a href="#section-5.16-7" class="pilcrow">¶</a></p>
<p id="section-5.16-8">For each chunk, the AEAD construction is given the Packet Tag in new format encoding (bits 7 and 6 set, bits 5-0 carry the packet tag), version number, cipher algorithm octet, AEAD algorithm octet, chunk size octet, and an eight-octet, big-endian chunk index as additional data.
The index of the first chunk is zero.
For example, the additional data of the first chunk using EAX and AES-128 with a chunk size of 2**16 octets consists of the octets 0xD4, 0x01, 0x07, 0x01, 0x10, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, and 0x00.<a href="#section-5.16-8" class="pilcrow">¶</a></p>
<p id="section-5.16-9">After the final chunk, the AEAD algorithm is used to produce a final authentication tag encrypting the empty string.
This AEAD instance is given the additional data specified above, plus an eight-octet, big-endian value specifying the total number of plaintext octets encrypted.
This allows detection of a truncated ciphertext.
Please note that the big-endian number representing the chunk index in the additional data is increased accordingly, although it's not really a chunk.<a href="#section-5.16-9" class="pilcrow">¶</a></p>
<p id="section-5.16-10">The chunk size octet specifies the size of chunks using the following formula (in C), where c is the chunk size octet:<a href="#section-5.16-10" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5.16-11">
<pre>
  chunk_size = ((uint64_t)1 &lt;&lt; (c + 6))
</pre><a href="#section-5.16-11" class="pilcrow">¶</a>
</div>
<p id="section-5.16-12">An implementation MUST accept chunk size octets with values from 0 to 16.
An implementation MUST NOT create data with a chunk size octet value larger than 16 (4 MiB chunks).<a href="#section-5.16-12" class="pilcrow">¶</a></p>
<p id="section-5.16-13">A unique, random, unpredictable initialization vector MUST be used for each message.
Failure to do so for each message can lead to a catastrophic failure depending on the choice of AEAD mode and symmetric key reuse.<a href="#section-5.16-13" class="pilcrow">¶</a></p>
<div id="eax-mode">
<section id="section-5.16.1">
          <h4 id="name-eax-mode">
<a href="#section-5.16.1" class="section-number selfRef">5.16.1. </a><a href="#name-eax-mode" class="section-name selfRef">EAX Mode</a>
          </h4>
<p id="section-5.16.1-1">The EAX AEAD Algorithm used in this document is defined in <span>[<a href="#EAX" class="xref">EAX</a>]</span>.<a href="#section-5.16.1-1" class="pilcrow">¶</a></p>
<p id="section-5.16.1-2">The EAX algorithm can only use block ciphers with 16-octet blocks.
The initialization vector is 16 octets long.
EAX authentication tags are 16 octets long.<a href="#section-5.16.1-2" class="pilcrow">¶</a></p>
<p id="section-5.16.1-3">The nonce for EAX mode is computed by treating the initialization vector as a 16-octet, big-endian value and exclusive-oring the low eight octets of it with the chunk index.<a href="#section-5.16.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ocb-mode">
<section id="section-5.16.2">
          <h4 id="name-ocb-mode">
<a href="#section-5.16.2" class="section-number selfRef">5.16.2. </a><a href="#name-ocb-mode" class="section-name selfRef">OCB Mode</a>
          </h4>
<p id="section-5.16.2-1">The OCB AEAD Algorithm used in this document is defined in <span>[<a href="#RFC7253" class="xref">RFC7253</a>]</span>.<a href="#section-5.16.2-1" class="pilcrow">¶</a></p>
<p id="section-5.16.2-2">The OCB algorithm can only use block ciphers with 16-octet blocks.
The initialization vector is 15 octets long.
OCB authentication tags are 16 octets long.<a href="#section-5.16.2-2" class="pilcrow">¶</a></p>
<p id="section-5.16.2-3">The nonce for OCB mode is computed by the exclusive-oring of the initialization vector as a 15-octet, big endian value, against the chunk index.<a href="#section-5.16.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="radix-64-conversions">
<section id="section-6">
      <h2 id="name-radix-64-conversions">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-radix-64-conversions" class="section-name selfRef">Radix-64 Conversions</a>
      </h2>
<p id="section-6-1">As stated in the introduction, OpenPGP's underlying native representation for objects is a stream of arbitrary octets, and some systems desire these objects to be immune to damage caused by character set translation, data conversions, etc.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">In principle, any printable encoding scheme that met the requirements of the unsafe channel would suffice, since it would not change the underlying binary bit streams of the native OpenPGP data structures.
The OpenPGP standard specifies one such printable encoding scheme to ensure interoperability.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">OpenPGP's Radix-64 encoding is composed of two parts: a base64 encoding of the binary data and an optional checksum.
The base64 encoding is identical to the MIME base64 content-transfer-encoding <span>[<a href="#RFC2045" class="xref">RFC2045</a>]</span>.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The optional checksum is a 24-bit Cyclic Redundancy Check (CRC) converted to four characters of radix-64 encoding by the same MIME base64 transformation, preceded by an equal sign (=).
The CRC is computed by using the generator 0x864CFB and an initialization of 0xB704CE.
The accumulation is done on the data before it is converted to radix-64, rather than on the converted data.
A sample implementation of this algorithm is in the next section.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">If present, the checksum with its leading equal sign MUST appear on the next line after the base64 encoded data.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">Rationale for CRC-24: The size of 24 bits fits evenly into printable base64.
The nonzero initialization can detect more errors than a zero initialization.<a href="#section-6-6" class="pilcrow">¶</a></p>
<div id="an-implementation-of-the-crc-24-in-c">
<section id="section-6.1">
        <h3 id="name-an-implementation-of-the-cr">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-an-implementation-of-the-cr" class="section-name selfRef">An Implementation of the CRC-24 in "C"</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-6.1-1">
<pre>
#define CRC24_INIT 0xB704CEL
#define CRC24_GENERATOR 0x864CFBL

typedef unsigned long crc24;
crc24 crc_octets(unsigned char *octets, size_t len)
{
    crc24 crc = CRC24_INIT;
    int i;
    while (len--) {
        crc ^= (*octets++) &lt;&lt; 16;
        for (i = 0; i &lt; 8; i++) {
            crc &lt;&lt;= 1;
            if (crc &amp; 0x1000000) {
                crc &amp;= 0xffffff; /* Clear bit 25 to avoid overflow */
                crc ^= CRC24_GENERATOR;
            }
        }
    }
    return crc &amp; 0xFFFFFFL;
}
</pre><a href="#section-6.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="forming-ascii-armor">
<section id="section-6.2">
        <h3 id="name-forming-ascii-armor">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-forming-ascii-armor" class="section-name selfRef">Forming ASCII Armor</a>
        </h3>
<p id="section-6.2-1">When OpenPGP encodes data into ASCII Armor, it puts specific headers around the Radix-64 encoded data, so OpenPGP can reconstruct the data later.
An OpenPGP implementation MAY use ASCII armor to protect raw binary data.
OpenPGP informs the user what kind of data is encoded in the ASCII armor through the use of the headers.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Concatenating the following data creates ASCII Armor:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-3.1">An Armor Header Line, appropriate for the type of data<a href="#section-6.2-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-3.2">Armor Headers<a href="#section-6.2-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-3.3">A blank (zero-length, or containing only whitespace) line<a href="#section-6.2-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-3.4">The ASCII-Armored data<a href="#section-6.2-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-3.5">An Armor Checksum<a href="#section-6.2-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-3.6">The Armor Tail, which depends on the Armor Header Line<a href="#section-6.2-3.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-4">An Armor Header Line consists of the appropriate header line text surrounded by five (5) dashes (<code>-</code>, 0x2D) on either side of the header line text.
The header line text is chosen based upon the type of data that is being encoded in Armor, and how it is being encoded.
Header line texts include the following strings:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2-5">
          <dt id="section-6.2-5.1">BEGIN PGP MESSAGE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-5.2">
  Used for signed, encrypted, or compressed files.<a href="#section-6.2-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-5.3">BEGIN PGP PUBLIC KEY BLOCK</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-5.4">
  Used for armoring public keys.<a href="#section-6.2-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-5.5">BEGIN PGP PRIVATE KEY BLOCK</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-5.6">
  Used for armoring private keys.<a href="#section-6.2-5.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-5.7">BEGIN PGP MESSAGE, PART X/Y</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-5.8">
  Used for multi-part messages, where the armor is split amongst Y parts, and this is the Xth part out of Y.<a href="#section-6.2-5.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-5.9">BEGIN PGP MESSAGE, PART X</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-5.10">
  Used for multi-part messages, where this is the Xth part of an unspecified number of parts.
Requires the MESSAGE-ID Armor Header to be used.<a href="#section-6.2-5.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-5.11">BEGIN PGP SIGNATURE</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-5.12">
  Used for detached signatures, OpenPGP/MIME signatures, and cleartext signatures.
Note that PGP 2 uses BEGIN PGP MESSAGE for detached signatures.<a href="#section-6.2-5.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-6">Note that all these Armor Header Lines are to consist of a complete line.
That is to say, there is always a line ending preceding the starting five dashes, and following the ending five dashes.
The header lines, therefore, MUST start at the beginning of a line, and MUST NOT have text other than whitespace following them on the same line.
These line endings are considered a part of the Armor Header Line for the purposes of determining the content they delimit.
This is particularly important when computing a cleartext signature (see below).<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">The Armor Headers are pairs of strings that can give the user or the receiving OpenPGP implementation some information about how to decode or use the message.
The Armor Headers are a part of the armor, not a part of the message, and hence are not protected by any signatures applied to the message.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<p id="section-6.2-8">The format of an Armor Header is that of a key-value pair.
A colon (<code>:</code> 0x38) and a single space (0x20) separate the key and value.
OpenPGP should consider improperly formatted Armor Headers to be corruption of the ASCII Armor.
Unknown keys should be reported to the user, but OpenPGP should continue to process the message.<a href="#section-6.2-8" class="pilcrow">¶</a></p>
<p id="section-6.2-9">Note that some transport methods are sensitive to line length.
While there is a limit of 76 characters for the Radix-64 data (<a href="#encoding-binary-radix64" class="xref">Section 6.3</a>), there is no limit to the length of Armor Headers.
Care should be taken that the Armor Headers are short enough to survive transport.
One way to do this is to repeat an Armor Header Key multiple times with different values for each so that no one line is overly long.<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<p id="section-6.2-10">Currently defined Armor Header Keys are as follows:<a href="#section-6.2-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-11.1">"Version", which states the OpenPGP implementation and version used to encode the message.
To minimize metadata, implementations SHOULD NOT emit this key and its corresponding value except for debugging purposes with explicit user consent.<a href="#section-6.2-11.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-11.2">"Comment", a user-defined comment.
OpenPGP defines all text to be in UTF-8.
A comment may be any UTF-8 string.
However, the whole point of armoring is to provide seven-bit-clean data.
Consequently, if a comment has characters that are outside the US-ASCII range of UTF, they may very well not survive transport.<a href="#section-6.2-11.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-11.3">
            <p id="section-6.2-11.3.1">"MessageID", a 32-character string of printable characters.
The string must be the same for all parts of a multi-part message that uses the "PART X" Armor Header.
MessageID strings should be unique enough that the recipient of the mail can associate all the parts of a message with each other.
A good checksum or cryptographic hash function is sufficient.<a href="#section-6.2-11.3.1" class="pilcrow">¶</a></p>
<p id="section-6.2-11.3.2">
The MessageID SHOULD NOT appear unless it is in a multi-part message.
If it appears at all, it MUST be computed from the finished (encrypted, signed, etc.) message in a deterministic fashion, rather than contain a purely random value.
This is to allow the legitimate recipient to determine that the MessageID cannot serve as a covert means of leaking cryptographic key information.<a href="#section-6.2-11.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.2-11.4">"Hash", a comma-separated list of hash algorithms used in this message.
This is used only in cleartext signed messages.<a href="#section-6.2-11.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-11.5">"Charset", a description of the character set that the plaintext is in.
Please note that OpenPGP defines text to be in UTF-8.
An implementation will get best results by translating into and out of UTF-8.
However, there are many instances where this is easier said than done.
Also, there are communities of users who have no need for UTF-8 because they are all happy with a character set like ISO Latin-5 or a Japanese character set.
In such instances, an implementation MAY override the UTF-8 default by using this header key.
An implementation MAY implement this key and any translations it cares to; an implementation MAY ignore it and assume all text is UTF-8.<a href="#section-6.2-11.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-12">The Armor Tail Line is composed in the same manner as the Armor Header Line, except the string "BEGIN" is replaced by the string "END".<a href="#section-6.2-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="encoding-binary-radix64">
<section id="section-6.3">
        <h3 id="name-encoding-binary-in-radix-64">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-encoding-binary-in-radix-64" class="section-name selfRef">Encoding Binary in Radix-64</a>
        </h3>
<p id="section-6.3-1">The encoding process represents 24-bit groups of input bits as output strings of 4 encoded characters.
Proceeding from left to right, a 24-bit input group is formed by concatenating three 8-bit input groups.
These 24 bits are then treated as four concatenated 6-bit groups, each of which is translated into a single digit in the Radix-64 alphabet.
When encoding a bit stream with the Radix-64 encoding, the bit stream must be presumed to be ordered with the most significant bit first.
That is, the first bit in the stream will be the high-order bit in the first 8-bit octet, and the eighth bit will be the low-order bit in the first 8-bit octet, and so on.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-2">
<pre>
┌──first octet──┬─second octet──┬──third octet──┐
│7 6 5 4 3 2 1 0│7 6 5 4 3 2 1 0│7 6 5 4 3 2 1 0│
├───────────┬───┴───────┬───────┴───┬───────────┤
│5 4 3 2 1 0│5 4 3 2 1 0│5 4 3 2 1 0│5 4 3 2 1 0│
└──1.index──┴──2.index──┴──3.index──┴──4.index──┘
</pre><a href="#section-6.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3-3">Each 6-bit group is used as an index into an array of 64 printable characters from the table below.
The character referenced by the index is placed in the output string.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<span id="name-encoding-for-radix-64"></span><table class="center" id="table-14">
          <caption>
<a href="#table-14" class="selfRef">Table 14</a>:
<a href="#name-encoding-for-radix-64" class="selfRef">Encoding for Radix-64</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Encoding</th>
              <th class="text-left" rowspan="1" colspan="1"> </th>
              <th class="text-right" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Encoding</th>
              <th class="text-left" rowspan="1" colspan="1"> </th>
              <th class="text-right" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Encoding</th>
              <th class="text-left" rowspan="1" colspan="1"> </th>
              <th class="text-right" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Encoding</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">A</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">17</td>
              <td class="text-left" rowspan="1" colspan="1">R</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">34</td>
              <td class="text-left" rowspan="1" colspan="1">i</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">51</td>
              <td class="text-left" rowspan="1" colspan="1">z</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">B</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">18</td>
              <td class="text-left" rowspan="1" colspan="1">S</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">35</td>
              <td class="text-left" rowspan="1" colspan="1">j</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">52</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">C</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">19</td>
              <td class="text-left" rowspan="1" colspan="1">T</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">36</td>
              <td class="text-left" rowspan="1" colspan="1">k</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">53</td>
              <td class="text-left" rowspan="1" colspan="1">1</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">D</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">20</td>
              <td class="text-left" rowspan="1" colspan="1">U</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">37</td>
              <td class="text-left" rowspan="1" colspan="1">l</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">54</td>
              <td class="text-left" rowspan="1" colspan="1">2</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">E</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">21</td>
              <td class="text-left" rowspan="1" colspan="1">V</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">38</td>
              <td class="text-left" rowspan="1" colspan="1">m</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">55</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">F</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">22</td>
              <td class="text-left" rowspan="1" colspan="1">W</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">39</td>
              <td class="text-left" rowspan="1" colspan="1">n</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">56</td>
              <td class="text-left" rowspan="1" colspan="1">4</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">G</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">23</td>
              <td class="text-left" rowspan="1" colspan="1">X</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">40</td>
              <td class="text-left" rowspan="1" colspan="1">o</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">57</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">H</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">24</td>
              <td class="text-left" rowspan="1" colspan="1">Y</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">41</td>
              <td class="text-left" rowspan="1" colspan="1">p</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">58</td>
              <td class="text-left" rowspan="1" colspan="1">6</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">I</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">25</td>
              <td class="text-left" rowspan="1" colspan="1">Z</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">42</td>
              <td class="text-left" rowspan="1" colspan="1">q</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">59</td>
              <td class="text-left" rowspan="1" colspan="1">7</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">J</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">26</td>
              <td class="text-left" rowspan="1" colspan="1">a</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">43</td>
              <td class="text-left" rowspan="1" colspan="1">r</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">60</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">K</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">27</td>
              <td class="text-left" rowspan="1" colspan="1">b</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">44</td>
              <td class="text-left" rowspan="1" colspan="1">s</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">61</td>
              <td class="text-left" rowspan="1" colspan="1">9</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">L</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">28</td>
              <td class="text-left" rowspan="1" colspan="1">c</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">45</td>
              <td class="text-left" rowspan="1" colspan="1">t</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">62</td>
              <td class="text-left" rowspan="1" colspan="1">+</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">M</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">29</td>
              <td class="text-left" rowspan="1" colspan="1">d</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">46</td>
              <td class="text-left" rowspan="1" colspan="1">u</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">63</td>
              <td class="text-left" rowspan="1" colspan="1">/</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">13</td>
              <td class="text-left" rowspan="1" colspan="1">N</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">30</td>
              <td class="text-left" rowspan="1" colspan="1">e</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">47</td>
              <td class="text-left" rowspan="1" colspan="1">v</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">14</td>
              <td class="text-left" rowspan="1" colspan="1">O</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">31</td>
              <td class="text-left" rowspan="1" colspan="1">f</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">48</td>
              <td class="text-left" rowspan="1" colspan="1">w</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">(pad)</td>
              <td class="text-left" rowspan="1" colspan="1">=</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">15</td>
              <td class="text-left" rowspan="1" colspan="1">P</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">32</td>
              <td class="text-left" rowspan="1" colspan="1">g</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">49</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">Q</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">33</td>
              <td class="text-left" rowspan="1" colspan="1">h</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1">50</td>
              <td class="text-left" rowspan="1" colspan="1">y</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-right" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
<p id="section-6.3-5">The encoded output stream must be represented in lines of no more than 76 characters each.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">Special processing is performed if fewer than 24 bits are available at the end of the data being encoded.
There are three possibilities:<a href="#section-6.3-6" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3-7">
<li id="section-6.3-7.1">The last data group has 24 bits (3 octets).
No special processing is needed.<a href="#section-6.3-7.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-7.2">The last data group has 16 bits (2 octets).
The first two 6-bit groups are processed as above.
The third (incomplete) data group has two zero-value bits added to it, and is processed as above.
A pad character (=) is added to the output.<a href="#section-6.3-7.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-7.3">The last data group has 8 bits (1 octet).
The first 6-bit group is processed as above.
The second (incomplete) data group has four zero-value bits added to it, and is processed as above.
Two pad characters (=) are added to the output.<a href="#section-6.3-7.3" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="decoding-radix-64">
<section id="section-6.4">
        <h3 id="name-decoding-radix-64">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-decoding-radix-64" class="section-name selfRef">Decoding Radix-64</a>
        </h3>
<p id="section-6.4-1">In Radix-64 data, characters other than those in the table, line breaks, and other white space probably indicate a transmission error, about which a warning message or even a message rejection might be appropriate under some circumstances.
Decoding software must ignore all white space.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">Because it is used only for padding at the end of the data, the occurrence of any "=" characters may be taken as evidence that the end of the data has been reached (without truncation in transit).
No such assurance is possible, however, when the number of octets transmitted was a multiple of three and no "=" characters are present.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="examples-of-radix-64">
<section id="section-6.5">
        <h3 id="name-examples-of-radix-64">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-examples-of-radix-64" class="section-name selfRef">Examples of Radix-64</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-6.5-1">
<pre>
Input data:  0x14FB9C03D97E
Hex:     1   4    F   B    9   C     | 0   3    D   9    7   E
8-bit:   00010100 11111011 10011100  | 00000011 11011001 01111110
6-bit:   000101 001111 101110 011100 | 000000 111101 100101 111110
Decimal: 5      15     46     28       0      61     37     62
Output:  F      P      u      c        A      9      l      +
Input data:  0x14FB9C03D9
Hex:     1   4    F   B    9   C     | 0   3    D   9
8-bit:   00010100 11111011 10011100  | 00000011 11011001
                                                pad with 00
6-bit:   000101 001111 101110 011100 | 000000 111101 100100
Decimal: 5      15     46     28       0      61     36
                                                   pad with =
Output:  F      P      u      c        A      9      k      =
Input data:  0x14FB9C03
Hex:     1   4    F   B    9   C     | 0   3
8-bit:   00010100 11111011 10011100  | 00000011
                                       pad with 0000
6-bit:   000101 001111 101110 011100 | 000000 110000
Decimal: 5      15     46     28       0      48
                                            pad with =      =
Output:  F      P      u      c        A      w      =      =
</pre><a href="#section-6.5-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="example-of-an-ascii-armored-message">
<section id="section-6.6">
        <h3 id="name-example-of-an-ascii-armored">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-example-of-an-ascii-armored" class="section-name selfRef">Example of an ASCII Armored Message</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-6.6-1">
<pre>
-----BEGIN PGP MESSAGE-----

yDgBO22WxBHv7O8X7O/jygAEzol56iUKiXmV+XmpCtmpqQUKiQrFqclFqUDBovzS
vBSFjNSiVHsuAA==
=njUN
-----END PGP MESSAGE-----
</pre><a href="#section-6.6-1" class="pilcrow">¶</a>
</div>
<p id="section-6.6-2">Note that this example has extra indenting; an actual armored message would have no leading whitespace.<a href="#section-6.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="cleartext-signature-framework">
<section id="section-7">
      <h2 id="name-cleartext-signature-framewo">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-cleartext-signature-framewo" class="section-name selfRef">Cleartext Signature Framework</a>
      </h2>
<p id="section-7-1">It is desirable to be able to sign a textual octet stream without ASCII armoring the stream itself, so the signed text is still readable without special software.
In order to bind a signature to such a cleartext, this framework is used, which follows the same basic format and restrictions as the ASCII armoring described in <a href="#forming-ascii-armor" class="xref">Section 6.2</a>.
(Note that this framework is not intended to be reversible.
<span>[<a href="#RFC3156" class="xref">RFC3156</a>]</span> defines another way to sign cleartext messages for environments that support MIME.)<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The cleartext signed message consists of:<a href="#section-7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-3.1">The cleartext header <code>-----BEGIN PGP SIGNED MESSAGE-----</code> on a single line,<a href="#section-7-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-3.2">One or more "Hash" Armor Headers,<a href="#section-7-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-3.3">Exactly one empty line not included into the message digest,<a href="#section-7-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-3.4">The dash-escaped cleartext that is included into the message digest,<a href="#section-7-3.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-3.5">The ASCII armored signature(s) including the <code>-----BEGIN PGP SIGNATURE-----</code> Armor Header and Armor Tail Lines.<a href="#section-7-3.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-7-4">If the "Hash" Armor Header is given, the specified message digest algorithm(s) are used for the signature.
If there are no such headers, MD5 is used.
If MD5 is the only hash used, then an implementation MAY omit this header for improved V2.x compatibility.
If more than one message digest is used in the signature, the "Hash" armor header contains a comma-delimited list of used message digests.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">Current message digest names are described below with the algorithm IDs.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">An implementation SHOULD add a line break after the cleartext, but MAY omit it if the cleartext ends with a line break.
This is for visual clarity.<a href="#section-7-6" class="pilcrow">¶</a></p>
<div id="dash-escaped-text">
<section id="section-7.1">
        <h3 id="name-dash-escaped-text">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-dash-escaped-text" class="section-name selfRef">Dash-Escaped Text</a>
        </h3>
<p id="section-7.1-1">The cleartext content of the message must also be dash-escaped.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Dash-escaped cleartext is the ordinary cleartext where every line starting with a <span class="unicode">"-" (HYPHEN-MINUS, U+002D)</span> is prefixed by the sequence <span class="unicode">"-" (HYPHEN-MINUS, U+002D)</span> and <span class="unicode">" " (SPACE, U+0020)</span>.
This prevents the parser from recognizing armor headers of the cleartext itself.
An implementation MAY dash-escape any line, SHOULD dash-escape lines commencing "From" followed by a space, and MUST dash-escape any line commencing in a dash.
The message digest is computed using the cleartext itself, not the dash-escaped form.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.1-3">As with binary signatures on text documents, a cleartext signature is calculated on the text using canonical &lt;CR&gt;&lt;LF&gt; line endings.
The line ending (i.e., the &lt;CR&gt;&lt;LF&gt;) before the <code>-----BEGIN PGP SIGNATURE-----</code> line that terminates the signed text is not considered part of the signed text.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">When reversing dash-escaping, an implementation MUST strip the string <code>- </code> if it occurs at the beginning of a line, and SHOULD warn on <code>-</code> and any character other than a space at the beginning of a line.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">Also, any trailing whitespace -- spaces (0x20) and tabs (0x09) -- at the end of any line is removed when the cleartext signature is generated.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="regular-expressions">
<section id="section-8">
      <h2 id="name-regular-expressions">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-regular-expressions" class="section-name selfRef">Regular Expressions</a>
      </h2>
<p id="section-8-1">A regular expression is zero or more branches, separated by <code>|</code>.
It matches anything that matches one of the branches.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">A branch is zero or more pieces, concatenated.
It matches a match for the first, followed by a match for the second, etc.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">A piece is an atom possibly followed by <code>*</code>, <code>+</code>, or <code>?</code>.
An atom followed by <code>*</code> matches a sequence of 0 or more matches of the atom.
An atom followed by <code>+</code> matches a sequence of 1 or more matches of the atom.
An atom followed by <code>?</code> matches a match of the atom, or the null string.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">An atom is a regular expression in parentheses (matching a match for the regular expression), a range (see below), <code>.</code> (matching any single character), <code>^</code> (matching the null string at the beginning of the input string), <code>$</code> (matching the null string at the end of the input string), a <code>\</code> followed by a single character (matching that character), or a single character with no other significance (matching that character).<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">A range is a sequence of characters enclosed in <code>[]</code>.
It normally matches any single character from the sequence.
If the sequence begins with <code>^</code>, it matches any single character not from the rest of the sequence.
If two characters in the sequence are separated by <code>-</code>, this is shorthand for the full list of ASCII characters between them (e.g., <code>[0-9]</code> matches any decimal digit).
To include a literal <code>]</code> in the sequence, make it the first character (following a possible <code>^</code>).
To include a literal <code>-</code>, make it the first or last character.<a href="#section-8-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="constants">
<section id="section-9">
      <h2 id="name-constants">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-constants" class="section-name selfRef">Constants</a>
      </h2>
<p id="section-9-1">This section describes the constants used in OpenPGP.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">Note that these tables are not exhaustive lists; an implementation MAY implement an algorithm not on these lists, so long as the algorithm numbers are chosen from the private or experimental algorithm range.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">See <a href="#notes-on-algorithms" class="xref">Section 14</a> for more discussion of the algorithms.<a href="#section-9-3" class="pilcrow">¶</a></p>
<div id="pubkey-algos">
<section id="section-9.1">
        <h3 id="name-public-key-algorithms">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-public-key-algorithms" class="section-name selfRef">Public-Key Algorithms</a>
        </h3>
<span id="name-public-key-algorithm-regist"></span><table class="center" id="table-15">
          <caption>
<a href="#table-15" class="selfRef">Table 15</a>:
<a href="#name-public-key-algorithm-regist" class="selfRef">Public-key algorithm registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
              <th class="text-left" rowspan="1" colspan="1">Public Key Format</th>
              <th class="text-left" rowspan="1" colspan="1">Secret Key Format</th>
              <th class="text-left" rowspan="1" colspan="1">Signature Format</th>
              <th class="text-left" rowspan="1" colspan="1">PKESK Format</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">RSA (Encrypt or Sign) <span>[<a href="#HAC" class="xref">HAC</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(n), MPI(e) [<a href="#key-rsa" class="xref">Section 5.6.1</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(d), MPI(p), MPI(q), MPI(u)</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(m**d mod n) [<a href="#sig-rsa" class="xref">Section 5.2.3.1</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(m**e mod n) [<a href="#pkesk-rsa" class="xref">Section 5.1.1</a>]</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">RSA Encrypt-Only <span>[<a href="#HAC" class="xref">HAC</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(n), MPI(e) [<a href="#key-rsa" class="xref">Section 5.6.1</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(d), MPI(p), MPI(q), MPI(u)</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(m**e mod n) [<a href="#pkesk-rsa" class="xref">Section 5.1.1</a>]</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">RSA Sign-Only <span>[<a href="#HAC" class="xref">HAC</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(n), MPI(e) [<a href="#key-rsa" class="xref">Section 5.6.1</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(d), MPI(p), MPI(q), MPI(u)</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(m**d mod n) [<a href="#sig-rsa" class="xref">Section 5.2.3.1</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">Elgamal (Encrypt-Only) <span>[<a href="#ELGAMAL" class="xref">ELGAMAL</a>]</span> <span>[<a href="#HAC" class="xref">HAC</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(p), MPI(g), MPI(y) [<a href="#key-elgamal" class="xref">Section 5.6.3</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(x)</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(g**k mod p), MPI (m * y**k mod p) [<a href="#pkesk-elgamal" class="xref">Section 5.1.2</a>]</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">17</td>
              <td class="text-left" rowspan="1" colspan="1">DSA (Digital Signature Algorithm) <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span> <span>[<a href="#HAC" class="xref">HAC</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(p), MPI(q), MPI(g), MPI(y) [<a href="#key-dsa" class="xref">Section 5.6.2</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(x)</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(r), MPI(s) [<a href="#sig-dsa" class="xref">Section 5.2.3.2</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">18</td>
              <td class="text-left" rowspan="1" colspan="1">ECDH public key algorithm</td>
              <td class="text-left" rowspan="1" colspan="1">OID, MPI(point in curve-specific point format), KDFParams [see <a href="#curve-specific-formats" class="xref">Section 9.2.1</a>, <a href="#key-ecdh" class="xref">Section 5.6.6</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(secret)</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(point in curve-specific point format), size octet, encoded key [<a href="#curve-specific-formats" class="xref">Section 9.2.1</a>, <a href="#pkesk-ecdh" class="xref">Section 5.1.3</a>, <a href="#ec-dh-algorithm-ecdh" class="xref">Section 13.5</a>]</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">19</td>
              <td class="text-left" rowspan="1" colspan="1">ECDSA public key algorithm <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">OID, MPI(point in SEC1 format) [<a href="#key-ecdsa" class="xref">Section 5.6.4</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(secret)</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(r), MPI(s) [<a href="#sig-dsa" class="xref">Section 5.2.3.2</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">20</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved (formerly Elgamal Encrypt or Sign)</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">21</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for Diffie-Hellman (X9.42, as defined for IETF-S/MIME)</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">22</td>
              <td class="text-left" rowspan="1" colspan="1">EdDSA  <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">OID, MPI(point in prefixed native format) [<a href="#key-eddsa" class="xref">Section 5.6.5</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI(value in curve-specific format) [see <a href="#curve-specific-formats" class="xref">Section 9.2.1</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">MPI, MPI [see <a href="#curve-specific-formats" class="xref">Section 9.2.1</a>, <a href="#sig-eddsa" class="xref">Section 5.2.3.3</a>]</td>
              <td class="text-left" rowspan="1" colspan="1">N/A</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">23</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved (AEDH)</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">24</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved (AEDSA)</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">100 to 110</td>
              <td class="text-left" rowspan="1" colspan="1">Private/Experimental algorithm</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
<p id="section-9.1-2">Implementations MUST implement DSA for signatures, and Elgamal for encryption.
Implementations SHOULD implement RSA keys (1).
RSA Encrypt-Only (2) and RSA Sign-Only (3) are deprecated and SHOULD NOT be generated, but may be interpreted.
See <a href="#rsa-notes" class="xref">Section 14.5</a>.
See <a href="#reserved-notes" class="xref">Section 14.9</a> for notes on Elgamal Encrypt or Sign (20), and X9.42 (21).
Implementations MAY implement any other algorithm.<a href="#section-9.1-2" class="pilcrow">¶</a></p>
<p id="section-9.1-3">A compatible specification of ECDSA is given in <span>[<a href="#RFC6090" class="xref">RFC6090</a>]</span> as "KT-I Signatures" and in <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>; ECDH is defined in <a href="#ec-dh-algorithm-ecdh" class="xref">Section 13.5</a> of this document.<a href="#section-9.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ec-curves">
<section id="section-9.2">
        <h3 id="name-ecc-curves-for-openpgp">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-ecc-curves-for-openpgp" class="section-name selfRef">ECC Curves for OpenPGP</a>
        </h3>
<p id="section-9.2-1">The parameter curve OID is an array of octets that define a named curve.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
<p id="section-9.2-2">The table below specifies the exact sequence of octets for each named curve referenced in this document.
It also specifies which public key algorithms the curve can be used with, as well as the size of expected elements in octets:<a href="#section-9.2-2" class="pilcrow">¶</a></p>
<span id="name-ecc-curve-oid-and-usage-reg"></span><table class="center" id="table-16">
          <caption>
<a href="#table-16" class="selfRef">Table 16</a>:
<a href="#name-ecc-curve-oid-and-usage-reg" class="selfRef">ECC Curve OID and usage registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">ASN.1 Object Identifier</th>
              <th class="text-left" rowspan="1" colspan="1">OID len</th>
              <th class="text-left" rowspan="1" colspan="1">Curve OID octets in hexadecimal representation</th>
              <th class="text-left" rowspan="1" colspan="1">Curve name</th>
              <th class="text-left" rowspan="1" colspan="1">Usage</th>
              <th class="text-left" rowspan="1" colspan="1">Field Size (fsize)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1.2.840.10045.3.1.7</td>
              <td class="text-left" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">2A 86 48 CE 3D 03 01 07</td>
              <td class="text-left" rowspan="1" colspan="1">NIST P-256</td>
              <td class="text-left" rowspan="1" colspan="1">ECDSA, ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1.3.132.0.34</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">2B 81 04 00 22</td>
              <td class="text-left" rowspan="1" colspan="1">NIST P-384</td>
              <td class="text-left" rowspan="1" colspan="1">ECDSA, ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">48</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1.3.132.0.35</td>
              <td class="text-left" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">2B 81 04 00 23</td>
              <td class="text-left" rowspan="1" colspan="1">NIST P-521</td>
              <td class="text-left" rowspan="1" colspan="1">ECDSA, ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">66</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1.3.6.1.4.1.11591.15.1</td>
              <td class="text-left" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">2B 06 01 04 01 DA 47 0F 01</td>
              <td class="text-left" rowspan="1" colspan="1">Ed25519</td>
              <td class="text-left" rowspan="1" colspan="1">EdDSA</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1.3.101.113</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">2B 65 71</td>
              <td class="text-left" rowspan="1" colspan="1">Ed448</td>
              <td class="text-left" rowspan="1" colspan="1">EdDSA</td>
              <td class="text-left" rowspan="1" colspan="1">57</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1.3.6.1.4.1.3029.1.5.1</td>
              <td class="text-left" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">2B 06 01 04 01 97 55 01 05 01</td>
              <td class="text-left" rowspan="1" colspan="1">Curve25519</td>
              <td class="text-left" rowspan="1" colspan="1">ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">32</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1.3.101.111</td>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">2B 65 6F</td>
              <td class="text-left" rowspan="1" colspan="1">X448</td>
              <td class="text-left" rowspan="1" colspan="1">ECDH</td>
              <td class="text-left" rowspan="1" colspan="1">56</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.2-4">The "Field Size (fsize)" column represents the field size of the group in number of octets, rounded up, such that x or y coordinates for a point on the curve, native point representations, or scalars with high enough entropy for the curve can be represented in that many octets.<a href="#section-9.2-4" class="pilcrow">¶</a></p>
<p id="section-9.2-5">The sequence of octets in the third column is the result of applying the Distinguished Encoding Rules (DER) to the ASN.1 Object Identifier with subsequent truncation.
The truncation removes the two fields of encoded Object Identifier.
The first omitted field is one octet representing the Object Identifier tag, and the second omitted field is the length of the Object Identifier body.
For example, the complete ASN.1 DER encoding for the NIST P-256 curve OID is "06 08 2A 86 48 CE 3D 03 01 07", from which the first entry in the table above is constructed by omitting the first two octets.
Only the truncated sequence of octets is the valid representation of a curve OID.<a href="#section-9.2-5" class="pilcrow">¶</a></p>
<div id="curve-specific-formats">
<section id="section-9.2.1">
          <h4 id="name-curve-specific-wire-formats">
<a href="#section-9.2.1" class="section-number selfRef">9.2.1. </a><a href="#name-curve-specific-wire-formats" class="section-name selfRef">Curve-Specific Wire Formats</a>
          </h4>
<p id="section-9.2.1-1">Some Elliptic Curve Public Key Algorithms use different conventions for specific fields depending on the curve in use.
Each field is always formatted as an MPI, but with a curve-specific framing.
This table summarizes those distinctions.<a href="#section-9.2.1-1" class="pilcrow">¶</a></p>
<span id="name-curve-specific-wire-formats-2"></span><table class="center" id="table-17">
            <caption>
<a href="#table-17" class="selfRef">Table 17</a>:
<a href="#name-curve-specific-wire-formats-2" class="selfRef">Curve-specific wire formats</a>
            </caption>
<thead>
              <tr>
                <th class="text-left" rowspan="1" colspan="1">Curve</th>
                <th class="text-left" rowspan="1" colspan="1">ECDH Point Format</th>
                <th class="text-left" rowspan="1" colspan="1">ECDH Secret Key MPI</th>
                <th class="text-left" rowspan="1" colspan="1">EdDSA Secret Key MPI</th>
                <th class="text-left" rowspan="1" colspan="1">EdDSA Signature first MPI</th>
                <th class="text-left" rowspan="1" colspan="1">EdDSA Signature second MPI</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">NIST P-256</td>
                <td class="text-left" rowspan="1" colspan="1">SEC1</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">NIST P-384</td>
                <td class="text-left" rowspan="1" colspan="1">SEC1</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">NIST P-521</td>
                <td class="text-left" rowspan="1" colspan="1">SEC1</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ed25519</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">32 octets of secret</td>
                <td class="text-left" rowspan="1" colspan="1">32 octets of R</td>
                <td class="text-left" rowspan="1" colspan="1">32 octets of S</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Ed448</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">prefixed 57 octets of secret</td>
                <td class="text-left" rowspan="1" colspan="1">prefixed 114 octets of signature</td>
                <td class="text-left" rowspan="1" colspan="1">0 [this is an unused placeholder]</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">Curve25519</td>
                <td class="text-left" rowspan="1" colspan="1">prefixed native</td>
                <td class="text-left" rowspan="1" colspan="1">integer</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
              </tr>
              <tr>
                <td class="text-left" rowspan="1" colspan="1">X448</td>
                <td class="text-left" rowspan="1" colspan="1">prefixed native</td>
                <td class="text-left" rowspan="1" colspan="1">prefixed 56 octets of secret</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
                <td class="text-left" rowspan="1" colspan="1">N/A</td>
              </tr>
            </tbody>
          </table>
<p id="section-9.2.1-3">For the native octet-string forms of EdDSA values, see <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>.
For the native octet-string forms of ECDH secret scalars and points, see <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-9.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="symmetric-algos">
<section id="section-9.3">
        <h3 id="name-symmetric-key-algorithms">
<a href="#section-9.3" class="section-number selfRef">9.3. </a><a href="#name-symmetric-key-algorithms" class="section-name selfRef">Symmetric-Key Algorithms</a>
        </h3>
<span id="name-symmetric-key-algorithm-reg"></span><table class="center" id="table-18">
          <caption>
<a href="#table-18" class="selfRef">Table 18</a>:
<a href="#name-symmetric-key-algorithm-reg" class="selfRef">Symmetric-key algorithm registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Plaintext or unencrypted data</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">IDEA <span>[<a href="#IDEA" class="xref">IDEA</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">TripleDES (DES-EDE, <span>[<a href="#SCHNEIER" class="xref">SCHNEIER</a>]</span>, <span>[<a href="#HAC" class="xref">HAC</a>]</span> - 168 bit key derived from 192)</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">CAST5 (128 bit key, as per <span>[<a href="#RFC2144" class="xref">RFC2144</a>]</span>)</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">Blowfish (128 bit key, 16 rounds) <span>[<a href="#BLOWFISH" class="xref">BLOWFISH</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">AES with 128-bit key <span>[<a href="#AES" class="xref">AES</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">AES with 192-bit key</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">AES with 256-bit key</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">Twofish with 256-bit key <span>[<a href="#TWOFISH" class="xref">TWOFISH</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">Camellia with 128-bit key <span>[<a href="#RFC3713" class="xref">RFC3713</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">Camellia with 192-bit key</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">13</td>
              <td class="text-left" rowspan="1" colspan="1">Camellia with 256-bit key</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">100 to 110</td>
              <td class="text-left" rowspan="1" colspan="1">Private/Experimental algorithm</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">253, 254 and 255</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved to avoid collision with Secret Key Encryption (see <a href="#secret-key-encryption" class="xref">Section 3.7.2.1</a> and <a href="#secret-key-packet-formats" class="xref">Section 5.5.3</a>)</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.3-2">Implementations MUST implement TripleDES.
Implementations SHOULD implement AES-128 and CAST5.
Implementations that interoperate with PGP 2.6 or earlier need to support IDEA, as that is the only symmetric cipher those versions use.
Implementations MAY implement any other algorithm.<a href="#section-9.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compression-algos">
<section id="section-9.4">
        <h3 id="name-compression-algorithms">
<a href="#section-9.4" class="section-number selfRef">9.4. </a><a href="#name-compression-algorithms" class="section-name selfRef">Compression Algorithms</a>
        </h3>
<span id="name-compression-algorithm-regis"></span><table class="center" id="table-19">
          <caption>
<a href="#table-19" class="selfRef">Table 19</a>:
<a href="#name-compression-algorithm-regis" class="selfRef">Compression algorithm registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Uncompressed</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">ZIP <span>[<a href="#RFC1951" class="xref">RFC1951</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">ZLIB <span>[<a href="#RFC1950" class="xref">RFC1950</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">BZip2 <span>[<a href="#BZ2" class="xref">BZ2</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">100 to 110</td>
              <td class="text-left" rowspan="1" colspan="1">Private/Experimental algorithm</td>
            </tr>
          </tbody>
        </table>
<p id="section-9.4-2">Implementations MUST implement uncompressed data.
Implementations SHOULD implement ZIP.
Implementations MAY implement any other algorithm.<a href="#section-9.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hash-algos">
<section id="section-9.5">
        <h3 id="name-hash-algorithms">
<a href="#section-9.5" class="section-number selfRef">9.5. </a><a href="#name-hash-algorithms" class="section-name selfRef">Hash Algorithms</a>
        </h3>
<span id="name-hash-algorithm-registry"></span><table class="center" id="table-20">
          <caption>
<a href="#table-20" class="selfRef">Table 20</a>:
<a href="#name-hash-algorithm-registry" class="selfRef">Hash algorithm registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
              <th class="text-left" rowspan="1" colspan="1">Text Name</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">MD5 <span>[<a href="#HAC" class="xref">HAC</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"MD5"</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">SHA-1 <span>[<a href="#FIPS180" class="xref">FIPS180</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"SHA1"</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">RIPE-MD/160 <span>[<a href="#HAC" class="xref">HAC</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"RIPEMD160"</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">4</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">5</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">6</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">7</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">8</td>
              <td class="text-left" rowspan="1" colspan="1">SHA2-256 <span>[<a href="#FIPS180" class="xref">FIPS180</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"SHA256"</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">9</td>
              <td class="text-left" rowspan="1" colspan="1">SHA2-384 <span>[<a href="#FIPS180" class="xref">FIPS180</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"SHA384"</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">10</td>
              <td class="text-left" rowspan="1" colspan="1">SHA2-512 <span>[<a href="#FIPS180" class="xref">FIPS180</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"SHA512"</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">11</td>
              <td class="text-left" rowspan="1" colspan="1">SHA2-224 <span>[<a href="#FIPS180" class="xref">FIPS180</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"SHA224"</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">12</td>
              <td class="text-left" rowspan="1" colspan="1">SHA3-256 <span>[<a href="#FIPS202" class="xref">FIPS202</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"SHA3-256"</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">13</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">14</td>
              <td class="text-left" rowspan="1" colspan="1">SHA3-512 <span>[<a href="#FIPS202" class="xref">FIPS202</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">"SHA3-512"</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">100 to 110</td>
              <td class="text-left" rowspan="1" colspan="1">Private/Experimental algorithm</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
<p id="section-9.5-2">Implementations MUST implement SHA-1.
Implementations MAY implement other algorithms.
MD5 is deprecated.<a href="#section-9.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="aead-algorithms">
<section id="section-9.6">
        <h3 id="name-aead-algorithms">
<a href="#section-9.6" class="section-number selfRef">9.6. </a><a href="#name-aead-algorithms" class="section-name selfRef">AEAD Algorithms</a>
        </h3>
<span id="name-aead-algorithm-registry"></span><table class="center" id="table-21">
          <caption>
<a href="#table-21" class="selfRef">Table 21</a>:
<a href="#name-aead-algorithm-registry" class="selfRef">AEAD algorithm registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">ID</th>
              <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
              <th class="text-left" rowspan="1" colspan="1">IV length (octets)</th>
              <th class="text-left" rowspan="1" colspan="1">authentication tag length (octets)</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">EAX <span>[<a href="#EAX" class="xref">EAX</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">OCB <span>[<a href="#RFC7253" class="xref">RFC7253</a>]</span>
</td>
              <td class="text-left" rowspan="1" colspan="1">15</td>
              <td class="text-left" rowspan="1" colspan="1">16</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">100 to 110</td>
              <td class="text-left" rowspan="1" colspan="1">Private/Experimental algorithm</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-10">
      <h2 id="name-iana-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">Because this document obsoletes <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span>, IANA is requested to update all registration information that references <span>[<a href="#RFC4880" class="xref">RFC4880</a>]</span> to instead reference this RFC.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">OpenPGP is highly parameterized, and consequently there are a number of considerations for allocating parameters for extensions.
This section describes how IANA should look at extensions to the protocol as described in this document.<a href="#section-10-2" class="pilcrow">¶</a></p>
<div id="new-string-to-key-specifier-types">
<section id="section-10.1">
        <h3 id="name-new-string-to-key-specifier">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-new-string-to-key-specifier" class="section-name selfRef">New String-to-Key Specifier Types</a>
        </h3>
<p id="section-10.1-1">OpenPGP S2K specifiers contain a mechanism for new algorithms to turn a string into a key.
This specification creates a registry of S2K specifier types.
The registry includes the S2K type, the name of the S2K, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#s2k-types" class="xref">Section 3.7.1</a>.
Adding a new S2K specifier MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">IANA should add a column "Generate?" to the S2K type registry, with initial values taken from <a href="#s2k-types" class="xref">Section 3.7.1</a>.<a href="#section-10.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="new-packets">
<section id="section-10.2">
        <h3 id="name-new-packets">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-new-packets" class="section-name selfRef">New Packets</a>
        </h3>
<p id="section-10.2-1">Major new features of OpenPGP are defined through new packet types.
This specification creates a registry of packet types.
The registry includes the packet type, the name of the packet, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#packet-tags" class="xref">Section 4.3</a>.
Adding a new packet type MUST be done through the RFC REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<div id="user-attribute-types">
<section id="section-10.2.1">
          <h4 id="name-user-attribute-types">
<a href="#section-10.2.1" class="section-number selfRef">10.2.1. </a><a href="#name-user-attribute-types" class="section-name selfRef">User Attribute Types</a>
          </h4>
<p id="section-10.2.1-1">The User Attribute packet permits an extensible mechanism for other types of certificate identification.
This specification creates a registry of User Attribute types.
The registry includes the User Attribute type, the name of the User Attribute, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#user-attribute-packet" class="xref">Section 5.13</a>.
Adding a new User Attribute type MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.1-1" class="pilcrow">¶</a></p>
<div id="image-format-subpacket-types">
<section id="section-10.2.1.1">
            <h5 id="name-image-format-subpacket-type">
<a href="#section-10.2.1.1" class="section-number selfRef">10.2.1.1. </a><a href="#name-image-format-subpacket-type" class="section-name selfRef">Image Format Subpacket Types</a>
            </h5>
<p id="section-10.2.1.1-1">Within User Attribute packets, there is an extensible mechanism for other types of image-based User Attributes.
This specification creates a registry of Image Attribute subpacket types.
The registry includes the Image Attribute subpacket type, the name of the Image Attribute subpacket, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#uat-image" class="xref">Section 5.13.1</a>.
Adding a new Image Attribute subpacket type MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="new-signature-subpackets">
<section id="section-10.2.2">
          <h4 id="name-new-signature-subpackets">
<a href="#section-10.2.2" class="section-number selfRef">10.2.2. </a><a href="#name-new-signature-subpackets" class="section-name selfRef">New Signature Subpackets</a>
          </h4>
<p id="section-10.2.2-1">OpenPGP signatures contain a mechanism for signed (or unsigned) data to be added to them for a variety of purposes in the Signature subpackets as discussed in <a href="#signature-subpacket" class="xref">Section 5.2.3.5</a>.
This specification creates a registry of Signature subpacket types.
The registry includes the Signature subpacket type, the name of the subpacket, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#signature-subpacket" class="xref">Section 5.2.3.5</a>.
Adding a new Signature subpacket MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.2-1" class="pilcrow">¶</a></p>
<div id="signature-notation-data-subpackets">
<section id="section-10.2.2.1">
            <h5 id="name-signature-notation-data-sub">
<a href="#section-10.2.2.1" class="section-number selfRef">10.2.2.1. </a><a href="#name-signature-notation-data-sub" class="section-name selfRef">Signature Notation Data Subpackets</a>
            </h5>
<p id="section-10.2.2.1-1">OpenPGP signatures further contain a mechanism for extensions in signatures.
These are the Notation Data subpackets, which contain a key/value pair.
Notations contain a user space that is completely unmanaged and an IETF space.<a href="#section-10.2.2.1-1" class="pilcrow">¶</a></p>
<p id="section-10.2.2.1-2">This specification creates a registry of Signature Notation Data types.
The registry includes the Signature Notation Data type, the name of the Signature Notation Data, its allowed values, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#notation-data" class="xref">Section 5.2.3.20</a>.
Adding a new Signature Notation Data subpacket MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signature-notation-data-subpacket-notation-flags">
<section id="section-10.2.2.2">
            <h5 id="name-signature-notation-data-subp">
<a href="#section-10.2.2.2" class="section-number selfRef">10.2.2.2. </a><a href="#name-signature-notation-data-subp" class="section-name selfRef">Signature Notation Data Subpacket Notation Flags</a>
            </h5>
<p id="section-10.2.2.2-1">This specification creates a new registry of Signature Notation Data Subpacket Notation Flags.
The registry includes the columns "Flag", "Description", "Security Recommended", "Interoperability Recommended", and "Reference".
The initial values for this registry can be found in <a href="#notation-data" class="xref">Section 5.2.3.20</a>.
Adding a new item MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-server-preference-extensions">
<section id="section-10.2.2.3">
            <h5 id="name-key-server-preference-exten">
<a href="#section-10.2.2.3" class="section-number selfRef">10.2.2.3. </a><a href="#name-key-server-preference-exten" class="section-name selfRef">Key Server Preference Extensions</a>
            </h5>
<p id="section-10.2.2.3-1">OpenPGP signatures contain a mechanism for preferences to be specified about key servers.
This specification creates a registry of key server preferences.
The registry includes the key server preference, the name of the preference, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#key-server-preferences" class="xref">Section 5.2.3.21</a>.
Adding a new key server preference MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-flags-extensions">
<section id="section-10.2.2.4">
            <h5 id="name-key-flags-extensions">
<a href="#section-10.2.2.4" class="section-number selfRef">10.2.2.4. </a><a href="#name-key-flags-extensions" class="section-name selfRef">Key Flags Extensions</a>
            </h5>
<p id="section-10.2.2.4-1">OpenPGP signatures contain a mechanism for flags to be specified about key usage.
This specification creates a registry of key usage flags.
The registry includes the key flags value, the name of the flag, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#key-flags" class="xref">Section 5.2.3.25</a>.
Adding a new key usage flag MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reason-for-revocation-extensions">
<section id="section-10.2.2.5">
            <h5 id="name-reason-for-revocation-exten">
<a href="#section-10.2.2.5" class="section-number selfRef">10.2.2.5. </a><a href="#name-reason-for-revocation-exten" class="section-name selfRef">Reason for Revocation Extensions</a>
            </h5>
<p id="section-10.2.2.5-1">OpenPGP signatures contain a mechanism for flags to be specified about why a key was revoked.
This specification creates a registry of "Reason for Revocation" flags.
The registry includes the "Reason for Revocation" flags value, the name of the flag, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#reason-for-revocation" class="xref">Section 5.2.3.27</a>.
Adding a new feature flag MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.2.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="implementation-features">
<section id="section-10.2.2.6">
            <h5 id="name-implementation-features">
<a href="#section-10.2.2.6" class="section-number selfRef">10.2.2.6. </a><a href="#name-implementation-features" class="section-name selfRef">Implementation Features</a>
            </h5>
<p id="section-10.2.2.6-1">OpenPGP signatures contain a mechanism for flags to be specified stating which optional features an implementation supports.
This specification creates a registry of feature-implementation flags.
The registry includes the feature-implementation flags value, the name of the flag, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#features-subpacket" class="xref">Section 5.2.3.28</a>.
Adding a new feature-implementation flag MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.2.6-1" class="pilcrow">¶</a></p>
<p id="section-10.2.2.6-2">Also see <a href="#meta-considerations-for-expansion" class="xref">Section 14.13</a> for more information about when feature flags are needed.<a href="#section-10.2.2.6-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="new-packet-versions">
<section id="section-10.2.3">
          <h4 id="name-new-packet-versions">
<a href="#section-10.2.3" class="section-number selfRef">10.2.3. </a><a href="#name-new-packet-versions" class="section-name selfRef">New Packet Versions</a>
          </h4>
<p id="section-10.2.3-1">The core OpenPGP packets all have version numbers, and can be revised by introducing a new version of an existing packet.
This specification creates a registry of packet types.
The registry includes the packet type, the number of the version, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#packet-types" class="xref">Section 5</a>.
Adding a new packet version MUST be done through the RFC REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="new-algorithms">
<section id="section-10.3">
        <h3 id="name-new-algorithms">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-new-algorithms" class="section-name selfRef">New Algorithms</a>
        </h3>
<p id="section-10.3-1"><a href="#constants" class="xref">Section 9</a> lists the core algorithms that OpenPGP uses.
Adding in a new algorithm is usually simple.
For example, adding in a new symmetric cipher usually would not need anything more than allocating a constant for that cipher.
If that cipher had other than a 64-bit or 128-bit block size, there might need to be additional documentation describing how OpenPGP-CFB mode would be adjusted.
Similarly, when DSA was expanded from a maximum of 1024-bit public keys to 3072-bit public keys, the revision of FIPS 186 contained enough information itself to allow implementation.
Changes to this document were made mainly for emphasis.<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<div id="public-key-algorithms">
<section id="section-10.3.1">
          <h4 id="name-public-key-algorithms-2">
<a href="#section-10.3.1" class="section-number selfRef">10.3.1. </a><a href="#name-public-key-algorithms-2" class="section-name selfRef">Public-Key Algorithms</a>
          </h4>
<p id="section-10.3.1-1">OpenPGP specifies a number of public-key algorithms.
This specification creates a registry of public-key algorithm identifiers.
The registry includes the algorithm name, its key sizes and parameters, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#pubkey-algos" class="xref">Section 9.1</a>.
Adding a new public-key algorithm MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.3.1-1" class="pilcrow">¶</a></p>
<p id="section-10.3.1-2">This document requests IANA register the following new public-key algorithm:<a href="#section-10.3.1-2" class="pilcrow">¶</a></p>
<span id="name-new-public-key-algorithms-r"></span><table class="center" id="table-22">
            <caption>
<a href="#table-22" class="selfRef">Table 22</a>:
<a href="#name-new-public-key-algorithms-r" class="selfRef">New public-Key algorithms registered</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">ID</th>
                <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">22</td>
                <td class="text-left" rowspan="1" colspan="1">EdDSA public key algorithm</td>
                <td class="text-left" rowspan="1" colspan="1">This doc, <a href="#eddsa" class="xref">Section 14.8</a>
</td>
              </tr>
            </tbody>
          </table>
<p id="section-10.3.1-4">[ Note to RFC-Editor: Please remove the table above on publication.
]<a href="#section-10.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="symmetric-key-algorithms">
<section id="section-10.3.2">
          <h4 id="name-symmetric-key-algorithms-2">
<a href="#section-10.3.2" class="section-number selfRef">10.3.2. </a><a href="#name-symmetric-key-algorithms-2" class="section-name selfRef">Symmetric-Key Algorithms</a>
          </h4>
<p id="section-10.3.2-1">OpenPGP specifies a number of symmetric-key algorithms.
This specification creates a registry of symmetric-key algorithm identifiers.
The registry includes the algorithm name, its key sizes and block size, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#symmetric-algos" class="xref">Section 9.3</a>.
Adding a new symmetric-key algorithm MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hash-algorithms">
<section id="section-10.3.3">
          <h4 id="name-hash-algorithms-2">
<a href="#section-10.3.3" class="section-number selfRef">10.3.3. </a><a href="#name-hash-algorithms-2" class="section-name selfRef">Hash Algorithms</a>
          </h4>
<p id="section-10.3.3-1">OpenPGP specifies a number of hash algorithms.
This specification creates a registry of hash algorithm identifiers.
The registry includes the algorithm name, a text representation of that name, its block size, an OID hash prefix, and a reference to the defining specification.
The initial values for this registry can be found in <a href="#hash-algos" class="xref">Section 9.5</a> for the algorithm identifiers and text names, and <a href="#version-three-sig" class="xref">Section 5.2.2</a> for the OIDs and expanded signature prefixes.
Adding a new hash algorithm MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.3.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3.3-2">This document requests IANA register the following hash algorithms:<a href="#section-10.3.3-2" class="pilcrow">¶</a></p>
<span id="name-new-hash-algorithms-registe"></span><table class="center" id="table-23">
            <caption>
<a href="#table-23" class="selfRef">Table 23</a>:
<a href="#name-new-hash-algorithms-registe" class="selfRef">New hash algorithms registered</a>
            </caption>
<thead>
              <tr>
                <th class="text-right" rowspan="1" colspan="1">ID</th>
                <th class="text-left" rowspan="1" colspan="1">Algorithm</th>
                <th class="text-left" rowspan="1" colspan="1">Reference</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">12</td>
                <td class="text-left" rowspan="1" colspan="1">SHA3-256</td>
                <td class="text-left" rowspan="1" colspan="1">This doc</td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">13</td>
                <td class="text-left" rowspan="1" colspan="1">Reserved</td>
                <td class="text-left" rowspan="1" colspan="1"> </td>
              </tr>
              <tr>
                <td class="text-right" rowspan="1" colspan="1">14</td>
                <td class="text-left" rowspan="1" colspan="1">SHA3-512</td>
                <td class="text-left" rowspan="1" colspan="1">This doc</td>
              </tr>
            </tbody>
          </table>
<p id="section-10.3.3-4">[Notes to RFC-Editor: Please remove the table above on publication.
    It is desirable not to reuse old or reserved algorithms because some existing tools might print a wrong description.
    The ID 13 has been reserved so that the SHA3 algorithm IDs align nicely with their SHA2 counterparts.]<a href="#section-10.3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="compression-algorithms">
<section id="section-10.3.4">
          <h4 id="name-compression-algorithms-2">
<a href="#section-10.3.4" class="section-number selfRef">10.3.4. </a><a href="#name-compression-algorithms-2" class="section-name selfRef">Compression Algorithms</a>
          </h4>
<p id="section-10.3.4-1">OpenPGP specifies a number of compression algorithms.
This specification creates a registry of compression algorithm identifiers.
The registry includes the algorithm name and a reference to the defining specification.
The initial values for this registry can be found in <a href="#compression-algos" class="xref">Section 9.4</a>.
Adding a new compression key algorithm MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.3.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="elliptic-curve-algorithms">
<section id="section-10.3.5">
          <h4 id="name-elliptic-curve-algorithms">
<a href="#section-10.3.5" class="section-number selfRef">10.3.5. </a><a href="#name-elliptic-curve-algorithms" class="section-name selfRef">Elliptic Curve Algorithms</a>
          </h4>
<p id="section-10.3.5-1">This document requests IANA add a registry of elliptic curves for use in OpenPGP.<a href="#section-10.3.5-1" class="pilcrow">¶</a></p>
<p id="section-10.3.5-2">Each curve is identified on the wire by OID, and is acceptable for use in certain OpenPGP public key algorithms.
The table's initial headings and values can be found in <a href="#ec-curves" class="xref">Section 9.2</a>.
Adding a new elliptic curve algorithm to OpenPGP MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.
If the new curve can be used for ECDH or EdDSA, it must also be added to the "Curve-specific wire formats" table described in <a href="#curve-specific-formats" class="xref">Section 9.2.1</a>.<a href="#section-10.3.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="elliptic-curve-point-and-scalar-wire-formats">
<section id="section-10.4">
        <h3 id="name-elliptic-curve-point-and-sc">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-elliptic-curve-point-and-sc" class="section-name selfRef">Elliptic Curve Point and Scalar Wire Formats</a>
        </h3>
<p id="section-10.4-1">This document requests IANA add a registry of wire formats that represent elliptic curve points.
The table's initial headings and values can be found in <a href="#ec-point-wire-formats" class="xref">Section 13.2</a>.
Adding a new EC point wire format MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<p id="section-10.4-2">This document also requests IANA add a registry of wire formats that represent scalars for use with elliptic curve cryptography.
The table's initial headings and values can be found in <a href="#ec-scalar-wire-formats" class="xref">Section 13.3</a>.
Adding a new EC scalar wire format MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-10.4-2" class="pilcrow">¶</a></p>
<p id="section-10.4-3">This document also requests that IANA add a registry mapping curve-specific MPI octet-string encoding conventions for ECDH and EdDSA.
The table's initial headings and values can be found in <a href="#curve-specific-formats" class="xref">Section 9.2.1</a>.
Adding a new elliptic curve algorithm to OpenPGP MUST be done through the SPECIFICATION REQUIRED method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>, and requires adding an entry to this table if the curve is to be used with either EdDSA or ECDH.<a href="#section-10.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="changes-to-existing-registries">
<section id="section-10.5">
        <h3 id="name-changes-to-existing-registr">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-changes-to-existing-registr" class="section-name selfRef">Changes to existing registries</a>
        </h3>
<p id="section-10.5-1">This document requests IANA add the following wire format columns to the OpenPGP public-key algorithm registry:<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.5-2.1">Public Key Format<a href="#section-10.5-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-2.2">Secret Key Format<a href="#section-10.5-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-2.3">Signature Format<a href="#section-10.5-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.5-2.4">PKESK Format<a href="#section-10.5-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.5-3">And populate them with the values found in <a href="#pubkey-algos" class="xref">Section 9.1</a>.<a href="#section-10.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="packet-composition">
<section id="section-11">
      <h2 id="name-packet-composition">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-packet-composition" class="section-name selfRef">Packet Composition</a>
      </h2>
<p id="section-11-1">OpenPGP packets are assembled into sequences in order to create messages and to transfer keys.
Not all possible packet sequences are meaningful and correct.
This section describes the rules for how packets should be placed into sequences.<a href="#section-11-1" class="pilcrow">¶</a></p>
<div id="transferable-public-keys">
<section id="section-11.1">
        <h3 id="name-transferable-public-keys">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-transferable-public-keys" class="section-name selfRef">Transferable Public Keys</a>
        </h3>
<p id="section-11.1-1">OpenPGP users may transfer public keys.
The essential elements of a transferable public key are as follows:<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-11.1-2.1">One Public-Key packet<a href="#section-11.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.1-2.2">Zero or more revocation signatures<a href="#section-11.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.1-2.3">One or more User ID packets<a href="#section-11.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.1-2.4">After each User ID packet, zero or more Signature packets (certifications)<a href="#section-11.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.1-2.5">Zero or more User Attribute packets<a href="#section-11.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.1-2.6">After each User Attribute packet, zero or more Signature packets (certifications)<a href="#section-11.1-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.1-2.7">Zero or more Subkey packets<a href="#section-11.1-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-11.1-2.8">After each Subkey packet, one Signature packet, plus optionally a revocation<a href="#section-11.1-2.8" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.1-3">The Public-Key packet occurs first.
Each of the following User ID packets provides the identity of the owner of this public key.
If there are multiple User ID packets, this corresponds to multiple means of identifying the same unique individual user; for example, a user may have more than one email address, and construct a User ID for each one.<a href="#section-11.1-3" class="pilcrow">¶</a></p>
<p id="section-11.1-4">Immediately following each User ID packet, there are zero or more Signature packets.
Each Signature packet is calculated on the immediately preceding User ID packet and the initial Public-Key packet.
The signature serves to certify the corresponding public key and User ID.
In effect, the signer is testifying to his or her belief that this public key belongs to the user identified by this User ID.<a href="#section-11.1-4" class="pilcrow">¶</a></p>
<p id="section-11.1-5">Within the same section as the User ID packets, there are zero or more User Attribute packets.
Like the User ID packets, a User Attribute packet is followed by zero or more Signature packets calculated on the immediately preceding User Attribute packet and the initial Public-Key packet.<a href="#section-11.1-5" class="pilcrow">¶</a></p>
<p id="section-11.1-6">User Attribute packets and User ID packets may be freely intermixed in this section, so long as the signatures that follow them are maintained on the proper User Attribute or User ID packet.<a href="#section-11.1-6" class="pilcrow">¶</a></p>
<p id="section-11.1-7">After the User ID packet or Attribute packet, there may be zero or more Subkey packets.
In general, subkeys are provided in cases where the top-level public key is a signature-only key.
However, any V4 or V5 key may have subkeys, and the subkeys may be encryption-only keys, signature-only keys, or general-purpose keys.
V3 keys MUST NOT have subkeys.<a href="#section-11.1-7" class="pilcrow">¶</a></p>
<p id="section-11.1-8">Each Subkey packet MUST be followed by one Signature packet, which should be a subkey binding signature issued by the top-level key.
For subkeys that can issue signatures, the subkey binding signature MUST contain an Embedded Signature subpacket with a primary key binding signature (0x19) issued by the subkey on the top-level key.<a href="#section-11.1-8" class="pilcrow">¶</a></p>
<p id="section-11.1-9">Subkey and Key packets may each be followed by a revocation Signature packet to indicate that the key is revoked.
Revocation signatures are only accepted if they are issued by the key itself, or by a key that is authorized to issue revocations via a Revocation Key subpacket in a self-signature by the top-level key.<a href="#section-11.1-9" class="pilcrow">¶</a></p>
<p id="section-11.1-10">Transferable public-key packet sequences may be concatenated to allow transferring multiple public keys in one operation.<a href="#section-11.1-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="transferable-secret-keys">
<section id="section-11.2">
        <h3 id="name-transferable-secret-keys">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-transferable-secret-keys" class="section-name selfRef">Transferable Secret Keys</a>
        </h3>
<p id="section-11.2-1">OpenPGP users may transfer secret keys.
The format of a transferable secret key is the same as a transferable public key except that secret-key and secret-subkey packets are used instead of the public key and public-subkey packets.
Implementations SHOULD include self-signatures on any User IDs and subkeys, as this allows for a complete public key to be automatically extracted from the transferable secret key.
Implementations MAY choose to omit the self-signatures, especially if a transferable public key accompanies the transferable secret key.<a href="#section-11.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="openpgp-messages">
<section id="section-11.3">
        <h3 id="name-openpgp-messages">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-openpgp-messages" class="section-name selfRef">OpenPGP Messages</a>
        </h3>
<p id="section-11.3-1">An OpenPGP message is a packet or sequence of packets that corresponds to the following grammatical rules (comma represents sequential composition, and vertical bar separates alternatives):<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-11.3-2">
          <dt id="section-11.3-2.1">OpenPGP Message :-</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.2">
  Encrypted Message | Signed Message | Compressed Message | Literal Message.<a href="#section-11.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.3">Compressed Message :-</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.4">
  Compressed Data Packet.<a href="#section-11.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.5">Literal Message :-</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.6">
  Literal Data Packet.<a href="#section-11.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.7">ESK :-</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.8">
  Public-Key Encrypted Session Key Packet | Symmetric-Key Encrypted Session Key Packet.<a href="#section-11.3-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.9">ESK Sequence :-</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.10">
  ESK | ESK Sequence, ESK.<a href="#section-11.3-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.11">Encrypted Data :-</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.12">
  Symmetrically Encrypted Data Packet | Symmetrically Encrypted Integrity Protected Data Packet | AEAD Encrypted Data Packet<a href="#section-11.3-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.13">Encrypted Message :-</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.14">
  Encrypted Data | ESK Sequence, Encrypted Data.<a href="#section-11.3-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.15">One-Pass Signed Message :-</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.16">
  One-Pass Signature Packet, OpenPGP Message, Corresponding Signature Packet.<a href="#section-11.3-2.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-11.3-2.17">Signed Message :-</dt>
          <dd style="margin-left: 1.5em" id="section-11.3-2.18">
  Signature Packet, OpenPGP Message | One-Pass Signed Message.<a href="#section-11.3-2.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-11.3-3">In addition, decrypting a Symmetrically Encrypted and Integrity Protected Data packet, an AEAD Encrypted Data packet, or -- for historic data -- a Symmetrically Encrypted Data packet must yield a valid OpenPGP Message.
Decompressing a Compressed Data packet must also yield a valid OpenPGP Message.<a href="#section-11.3-3" class="pilcrow">¶</a></p>
<p id="section-11.3-4">Note that some subtle combinations that are formally acceptable by this grammar are nonetheless unacceptable.
For example, a v5 SKESK packet cannot effectively precede a SEIPD packet, since that combination does not include any information about the choice of symmetric cipher used for SEIPD (see <a href="#no-v5-skesk-seipd" class="xref">Section 5.3.1</a> for more details).<a href="#section-11.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="detached-signatures">
<section id="section-11.4">
        <h3 id="name-detached-signatures">
<a href="#section-11.4" class="section-number selfRef">11.4. </a><a href="#name-detached-signatures" class="section-name selfRef">Detached Signatures</a>
        </h3>
<p id="section-11.4-1">Some OpenPGP applications use so-called "detached signatures".
For example, a program bundle may contain a file, and with it a second file that is a detached signature of the first file.
These detached signatures are simply a Signature packet stored separately from the data for which they are a signature.<a href="#section-11.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="enhanced-key-formats">
<section id="section-12">
      <h2 id="name-enhanced-key-formats">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-enhanced-key-formats" class="section-name selfRef">Enhanced Key Formats</a>
      </h2>
<div id="key-structures">
<section id="section-12.1">
        <h3 id="name-key-structures">
<a href="#section-12.1" class="section-number selfRef">12.1. </a><a href="#name-key-structures" class="section-name selfRef">Key Structures</a>
        </h3>
<p id="section-12.1-1">The format of an OpenPGP V3 key is as follows.
Entries in square brackets are optional and ellipses indicate repetition.<a href="#section-12.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.1-2">
<pre>
RSA Public Key
   [Revocation Self Signature]
    User ID [Signature ...]
   [User ID [Signature ...] ...]
</pre><a href="#section-12.1-2" class="pilcrow">¶</a>
</div>
<p id="section-12.1-3">Each signature certifies the RSA public key and the preceding User ID.
The RSA public key can have many User IDs and each User ID can have many signatures.
V3 keys are deprecated.
Implementations MUST NOT generate new V3 keys, but MAY continue to use existing ones.<a href="#section-12.1-3" class="pilcrow">¶</a></p>
<p id="section-12.1-4">The format of an OpenPGP V4 key that uses multiple public keys is similar except that the other keys are added to the end as "subkeys" of the primary key.<a href="#section-12.1-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-12.1-5">
<pre>
Primary-Key
   [Revocation Self Signature]
   [Direct Key Signature...]
    User ID [Signature ...]
   [User ID [Signature ...] ...]
   [User Attribute [Signature ...] ...]
   [[Subkey [Binding-Signature-Revocation ...]
           Subkey-Binding-Signature ...] ...]
</pre><a href="#section-12.1-5" class="pilcrow">¶</a>
</div>
<p id="section-12.1-6">A subkey always has at least one subkey binding signature after it that is issued using the primary key to tie the two keys together.
These binding signatures may be in either V3 or V4 format, but SHOULD be V4.
Subkeys that can issue signatures MUST have a V4 binding signature due to the REQUIRED embedded primary key binding signature.<a href="#section-12.1-6" class="pilcrow">¶</a></p>
<p id="section-12.1-7">In a V4 key, the primary key MUST be a key capable of certification.
The subkeys may be keys of any other type.
There may be other constructions of V4 keys, too.
For example, there may be a single-key RSA key in V4 format, a DSA primary key with an RSA encryption key, or RSA primary key with an Elgamal subkey, etc.<a href="#section-12.1-7" class="pilcrow">¶</a></p>
<p id="section-12.1-8">It is also possible to have a signature-only subkey.
This permits a primary key that collects certifications (key signatures), but is used only for certifying subkeys that are used for encryption and signatures.<a href="#section-12.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="key-ids-and-fingerprints">
<section id="section-12.2">
        <h3 id="name-key-ids-and-fingerprints">
<a href="#section-12.2" class="section-number selfRef">12.2. </a><a href="#name-key-ids-and-fingerprints" class="section-name selfRef">Key IDs and Fingerprints</a>
        </h3>
<p id="section-12.2-1">For a V3 key, the eight-octet Key ID consists of the low 64 bits of the public modulus of the RSA key.<a href="#section-12.2-1" class="pilcrow">¶</a></p>
<p id="section-12.2-2">The fingerprint of a V3 key is formed by hashing the body (but not the two-octet length) of the MPIs that form the key material (public modulus n, followed by exponent e) with MD5.
Note that both V3 keys and MD5 are deprecated.<a href="#section-12.2-2" class="pilcrow">¶</a></p>
<p id="section-12.2-3">A V4 fingerprint is the 160-bit SHA-1 hash of the octet 0x99, followed by the two-octet packet length, followed by the entire Public-Key packet starting with the version field.
The Key ID is the low-order 64 bits of the fingerprint.
Here are the fields of the hash material, with the example of a DSA key:<a href="#section-12.2-3" class="pilcrow">¶</a></p>
<p id="section-12.2-4">a.1) 0x99 (1 octet)<a href="#section-12.2-4" class="pilcrow">¶</a></p>
<p id="section-12.2-5">a.2) two-octet, big-endian scalar octet count of (b)-(e)<a href="#section-12.2-5" class="pilcrow">¶</a></p>
<p id="section-12.2-6">b) version number = 4 (1 octet);<a href="#section-12.2-6" class="pilcrow">¶</a></p>
<p id="section-12.2-7">c) timestamp of key creation (4 octets);<a href="#section-12.2-7" class="pilcrow">¶</a></p>
<p id="section-12.2-8">d) algorithm (1 octet): 17 = DSA (example);<a href="#section-12.2-8" class="pilcrow">¶</a></p>
<p id="section-12.2-9">e) Algorithm-specific fields.<a href="#section-12.2-9" class="pilcrow">¶</a></p>
<p id="section-12.2-10">Algorithm-Specific Fields for DSA keys (example):<a href="#section-12.2-10" class="pilcrow">¶</a></p>
<p id="section-12.2-11">e.1) MPI of DSA prime p;<a href="#section-12.2-11" class="pilcrow">¶</a></p>
<p id="section-12.2-12">e.2) MPI of DSA group order q (q is a prime divisor of p-1);<a href="#section-12.2-12" class="pilcrow">¶</a></p>
<p id="section-12.2-13">e.3) MPI of DSA group generator g;<a href="#section-12.2-13" class="pilcrow">¶</a></p>
<p id="section-12.2-14">e.4) MPI of DSA public-key value y (= g**x mod p where x is secret).<a href="#section-12.2-14" class="pilcrow">¶</a></p>
<p id="section-12.2-15">A V5 fingerprint is the 256-bit SHA2-256 hash of the octet 0x9A, followed by the four-octet packet length, followed by the entire Public-Key packet starting with the version field.
The Key ID is the high-order 64 bits of the fingerprint.
Here are the fields of the hash material, with the example of a DSA key:<a href="#section-12.2-15" class="pilcrow">¶</a></p>
<p id="section-12.2-16">a.1) 0x9A (1 octet)<a href="#section-12.2-16" class="pilcrow">¶</a></p>
<p id="section-12.2-17">a.2) four-octet scalar octet count of (b)-(f)<a href="#section-12.2-17" class="pilcrow">¶</a></p>
<p id="section-12.2-18">b) version number = 5 (1 octet);<a href="#section-12.2-18" class="pilcrow">¶</a></p>
<p id="section-12.2-19">c) timestamp of key creation (4 octets);<a href="#section-12.2-19" class="pilcrow">¶</a></p>
<p id="section-12.2-20">d) algorithm (1 octet): 17 = DSA (example);<a href="#section-12.2-20" class="pilcrow">¶</a></p>
<p id="section-12.2-21">e) four-octet scalar octet count for the following key material;<a href="#section-12.2-21" class="pilcrow">¶</a></p>
<p id="section-12.2-22">f) algorithm-specific fields.<a href="#section-12.2-22" class="pilcrow">¶</a></p>
<p id="section-12.2-23">Algorithm-Specific Fields for DSA keys (example):<a href="#section-12.2-23" class="pilcrow">¶</a></p>
<p id="section-12.2-24">f.1) MPI of DSA prime p;<a href="#section-12.2-24" class="pilcrow">¶</a></p>
<p id="section-12.2-25">f.2) MPI of DSA group order q (q is a prime divisor of p-1);<a href="#section-12.2-25" class="pilcrow">¶</a></p>
<p id="section-12.2-26">f.3) MPI of DSA group generator g;<a href="#section-12.2-26" class="pilcrow">¶</a></p>
<p id="section-12.2-27">f.4) MPI of DSA public-key value y (= g**x mod p where x is secret).<a href="#section-12.2-27" class="pilcrow">¶</a></p>
<p id="section-12.2-28">Note that it is possible for there to be collisions of Key IDs -- two different keys with the same Key ID.
Note that there is a much smaller, but still non-zero, probability that two different keys have the same fingerprint.<a href="#section-12.2-28" class="pilcrow">¶</a></p>
<p id="section-12.2-29">Also note that if V3, V4, and V5 format keys share the same RSA key material, they will have different Key IDs as well as different fingerprints.<a href="#section-12.2-29" class="pilcrow">¶</a></p>
<p id="section-12.2-30">Finally, the Key ID and fingerprint of a subkey are calculated in the same way as for a primary key, including the 0x99 (V3 and V4 key) or 0x9A (V5 key) as the first octet (even though this is not a valid packet ID for a public subkey).<a href="#section-12.2-30" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="elliptic-curve-cryptography">
<section id="section-13">
      <h2 id="name-elliptic-curve-cryptography">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-elliptic-curve-cryptography" class="section-name selfRef">Elliptic Curve Cryptography</a>
      </h2>
<p id="section-13-1">This section describes algorithms and parameters used with Elliptic Curve Cryptography (ECC) keys.
A thorough introduction to ECC can be found in <span>[<a href="#KOBLITZ" class="xref">KOBLITZ</a>]</span>.<a href="#section-13-1" class="pilcrow">¶</a></p>
<div id="supported-ecc-curves">
<section id="section-13.1">
        <h3 id="name-supported-ecc-curves">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-supported-ecc-curves" class="section-name selfRef">Supported ECC Curves</a>
        </h3>
<p id="section-13.1-1">This document references three named prime field curves defined in <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span> as "Curve P-256", "Curve P-384", and "Curve P-521".
These three <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span> curves can be used with ECDSA and ECDH public key algorithms.
Additionally, curve "Curve25519" and "Curve448" are referenced for use with Ed25519 and Ed448 (EdDSA signing, see <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>); and X25519 and X448 (ECDH encryption, see <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>).<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<p id="section-13.1-2">The named curves are referenced as a sequence of octets in this document, called throughout, curve OID.
<a href="#ec-curves" class="xref">Section 9.2</a> describes in detail how this sequence of octets is formed.<a href="#section-13.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ec-point-wire-formats">
<section id="section-13.2">
        <h3 id="name-ec-point-wire-formats">
<a href="#section-13.2" class="section-number selfRef">13.2. </a><a href="#name-ec-point-wire-formats" class="section-name selfRef">EC Point Wire Formats</a>
        </h3>
<p id="section-13.2-1">A point on an elliptic curve will always be represented on the wire as an MPI.
Each curve uses a specific point format for the data within the MPI itself.
Each format uses a designated prefix octet to ensure that the high octet has at least one bit set to make the MPI a constant size.<a href="#section-13.2-1" class="pilcrow">¶</a></p>
<span id="name-elliptic-curve-point-wire-f"></span><table class="center" id="table-24">
          <caption>
<a href="#table-24" class="selfRef">Table 24</a>:
<a href="#name-elliptic-curve-point-wire-f" class="selfRef">Elliptic Curve Point Wire Formats</a>
          </caption>
<thead>
            <tr>
              <th class="text-right" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Wire Format</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">SEC1</td>
              <td class="text-left" rowspan="1" colspan="1">0x04 || x || y</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ec-point-sec1" class="xref">Section 13.2.1</a>
</td>
            </tr>
            <tr>
              <td class="text-right" rowspan="1" colspan="1">Prefixed native</td>
              <td class="text-left" rowspan="1" colspan="1">0x40 || native</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ec-point-prefixed-native" class="xref">Section 13.2.2</a>
</td>
            </tr>
          </tbody>
        </table>
<div id="ec-point-sec1">
<section id="section-13.2.1">
          <h4 id="name-sec1-ec-point-wire-format">
<a href="#section-13.2.1" class="section-number selfRef">13.2.1. </a><a href="#name-sec1-ec-point-wire-format" class="section-name selfRef">SEC1 EC Point Wire Format</a>
          </h4>
<p id="section-13.2.1-1">For a SEC1-encoded (uncompressed) point the content of the MPI is:<a href="#section-13.2.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.2.1-2">
<pre>
B = 04 || x || y
</pre><a href="#section-13.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-13.2.1-3">where x and y are coordinates of the point P = (x, y), and each is encoded in the big-endian format and zero-padded to the adjusted underlying field size.
The adjusted underlying field size is the underlying field size rounded up to the nearest 8-bit boundary, as noted in the "fsize" column in <a href="#ec-curves" class="xref">Section 9.2</a>.
This encoding is compatible with the definition given in <span>[<a href="#SEC1" class="xref">SEC1</a>]</span>.<a href="#section-13.2.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ec-point-prefixed-native">
<section id="section-13.2.2">
          <h4 id="name-prefixed-native-ec-point-wi">
<a href="#section-13.2.2" class="section-number selfRef">13.2.2. </a><a href="#name-prefixed-native-ec-point-wi" class="section-name selfRef">Prefixed Native EC Point Wire Format</a>
          </h4>
<p id="section-13.2.2-1">For a custom compressed point the content of the MPI is:<a href="#section-13.2.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.2.2-2">
<pre>
B = 40 || p
</pre><a href="#section-13.2.2-2" class="pilcrow">¶</a>
</div>
<p id="section-13.2.2-3">where p is the public key of the point encoded using the rules defined for the specified curve.
This format is used for ECDH keys based on curves expressed in Montgomery form, and for points when using EdDSA.<a href="#section-13.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="notes-on-ec-point-wire-formats">
<section id="section-13.2.3">
          <h4 id="name-notes-on-ec-point-wire-form">
<a href="#section-13.2.3" class="section-number selfRef">13.2.3. </a><a href="#name-notes-on-ec-point-wire-form" class="section-name selfRef">Notes on EC Point Wire Formats</a>
          </h4>
<p id="section-13.2.3-1">Given the above definitions, the exact size of the MPI payload for an encoded point is 515 bits for "Curve P-256", 771 for "Curve P-384", 1059 for "Curve P-521", 263 for both "Curve25519" and "Ed25519", 463 for "Ed448", and 455 for "X448".
For example, the length of a EdDSA public key for the curve Ed25519 is 263 bits: 7 bits to represent the 0x40 prefix octet and 32 octets for the native value of the public key.<a href="#section-13.2.3-1" class="pilcrow">¶</a></p>
<p id="section-13.2.3-2">Even though the zero point, also called the point at infinity, may occur as a result of arithmetic operations on points of an elliptic curve, it SHALL NOT appear in data structures defined in this document.<a href="#section-13.2.3-2" class="pilcrow">¶</a></p>
<p id="section-13.2.3-3">Each particular curve uses a designated wire format for the point found in its public key or ECDH data structure.
An implementation MUST NOT use a different wire format for a point than the wire format associated with the curve.<a href="#section-13.2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="ec-scalar-wire-formats">
<section id="section-13.3">
        <h3 id="name-ec-scalar-wire-formats">
<a href="#section-13.3" class="section-number selfRef">13.3. </a><a href="#name-ec-scalar-wire-formats" class="section-name selfRef">EC Scalar Wire Formats</a>
        </h3>
<p id="section-13.3-1">Some non-curve values in elliptic curve cryptography (e.g. secret keys and signature components) are not points on a curve, but are also encoded on the wire in OpenPGP as an MPI.<a href="#section-13.3-1" class="pilcrow">¶</a></p>
<p id="section-13.3-2">Because of different patterns of deployment, some curves treat these values as opaque bit strings with the high bit set, while others are treated as actual integers, encoded in the standard OpenPGP big-endian form.
The choice of encoding is specific to the public key algorithm in use.<a href="#section-13.3-2" class="pilcrow">¶</a></p>
<span id="name-elliptic-curve-scalar-encod"></span><table class="center" id="table-25">
          <caption>
<a href="#table-25" class="selfRef">Table 25</a>:
<a href="#name-elliptic-curve-scalar-encod" class="selfRef">Elliptic Curve Scalar Encodings</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Type</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">integer</td>
              <td class="text-left" rowspan="1" colspan="1">An integer, big-endian encoded as a standard OpenPGP MPI</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#mpi" class="xref">Section 3.2</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">octet string</td>
              <td class="text-left" rowspan="1" colspan="1">An octet string of fixed length, that may be shorter on the wire due to leading zeros being stripped by the MPI encoding, and may need to be zero-padded before usage</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ec-octet-string" class="xref">Section 13.3.1</a>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">prefixed N octets</td>
              <td class="text-left" rowspan="1" colspan="1">An octet string of fixed length N, prefixed with octet 0x40 to ensure no leading zero octet</td>
              <td class="text-left" rowspan="1" colspan="1">
                <a href="#ec-prefix" class="xref">Section 13.3.2</a>
</td>
            </tr>
          </tbody>
        </table>
<div id="ec-octet-string">
<section id="section-13.3.1">
          <h4 id="name-ec-octet-string-wire-format">
<a href="#section-13.3.1" class="section-number selfRef">13.3.1. </a><a href="#name-ec-octet-string-wire-format" class="section-name selfRef">EC Octet String Wire Format</a>
          </h4>
<p id="section-13.3.1-1">Some opaque strings of octets are represented on the wire as an MPI by simply stripping the leading zeros and counting the remaining bits.
These strings are of known, fixed length.
They are represented in this document as <code>MPI(N octets of X)</code> where <code>N</code> is the expected length in octets of the octet string.<a href="#section-13.3.1-1" class="pilcrow">¶</a></p>
<p id="section-13.3.1-2">For example, a five-octet opaque string (<code>MPI(5 octets of X)</code>) where <code>X</code> has the value <code>00 02 ee 19 00</code> would be represented on the wire as an MPI like so: <code>00 1a 02 ee 19 00</code>.<a href="#section-13.3.1-2" class="pilcrow">¶</a></p>
<p id="section-13.3.1-3">To encode <code>X</code> to the wire format, we set the MPI's two-octet bit counter to the value of the highest set bit (bit 26, or 0x001a), and do not transfer the leading all-zero octet to the wire.<a href="#section-13.3.1-3" class="pilcrow">¶</a></p>
<p id="section-13.3.1-4">To reverse the process, an implementation that knows this value has an expected length of 5 octets can take the following steps:<a href="#section-13.3.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.3.1-5.1">ensure that the MPI's two-octet bitcount is less than or equal to 40 (5 octets of 8 bits)<a href="#section-13.3.1-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-13.3.1-5.2">allocate 5 octets, setting all to zero initially<a href="#section-13.3.1-5.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-13.3.1-5.3">copy the MPI data octets (without the two count octets) into the lower octets of the allocated space<a href="#section-13.3.1-5.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="ec-prefix">
<section id="section-13.3.2">
          <h4 id="name-elliptic-curve-prefixed-oct">
<a href="#section-13.3.2" class="section-number selfRef">13.3.2. </a><a href="#name-elliptic-curve-prefixed-oct" class="section-name selfRef">Elliptic Curve Prefixed Octet String Wire Format</a>
          </h4>
<p id="section-13.3.2-1">Another way to ensure that a fixed-length bytestring is encoded simply to the wire while remaining in MPI format is to prefix the bytestring with a dedicated non-zero octet.
This specification uses 0x40 as the prefix octet.
This is represented in this standard as <code>MPI(prefixed N octets of X)</code>, where <code>N</code> is the known bytestring length.<a href="#section-13.3.2-1" class="pilcrow">¶</a></p>
<p id="section-13.3.2-2">For example, a five-octet opaque string using <code>MPI(prefixed 5 octets of X)</code> where <code>X</code> has the value <code>00 02 ee 19 00</code> would be written to the wire form as: <code>00 2f 40 00 02 ee 19 00</code>.<a href="#section-13.3.2-2" class="pilcrow">¶</a></p>
<p id="section-13.3.2-3">To encode the string, we prefix it with the octet 0x40 (whose 7th bit is set), then set the MPI's two-octet bit counter to 47 (0x002f, 7 bits for the prefix octet and 40 bits for the string).<a href="#section-13.3.2-3" class="pilcrow">¶</a></p>
<p id="section-13.3.2-4">To decode the string from the wire, an implementation that knows that the variable is formed in this way can:<a href="#section-13.3.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.3.2-5.1">ensure that the first three octets of the MPI (the two bit-count octets plus the prefix octet)  are <code>00 2f 40</code>, and<a href="#section-13.3.2-5.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-13.3.2-5.2">use the remainder of the MPI directly off the wire.<a href="#section-13.3.2-5.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-13.3.2-6">Note that this is a similar approach to that used in the EC point encodings found in <a href="#ec-point-prefixed-native" class="xref">Section 13.2.2</a>.<a href="#section-13.3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="key-derivation-function">
<section id="section-13.4">
        <h3 id="name-key-derivation-function">
<a href="#section-13.4" class="section-number selfRef">13.4. </a><a href="#name-key-derivation-function" class="section-name selfRef">Key Derivation Function</a>
        </h3>
<p id="section-13.4-1">A key derivation function (KDF) is necessary to implement EC encryption.
The Concatenation Key Derivation Function (Approved Alternative 1) <span>[<a href="#SP800-56A" class="xref">SP800-56A</a>]</span> with the KDF hash function that is SHA2-256 <span>[<a href="#FIPS180" class="xref">FIPS180</a>]</span> or stronger is REQUIRED.<a href="#section-13.4-1" class="pilcrow">¶</a></p>
<p id="section-13.4-2">For convenience, the synopsis of the encoding method is given below with significant simplifications attributable to the restricted choice of hash functions in this document.
However, <span>[<a href="#SP800-56A" class="xref">SP800-56A</a>]</span> is the normative source of the definition.<a href="#section-13.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.4-3">
<pre>
//   Implements KDF( X, oBits, Param );
//   Input: point X = (x,y)
//   oBits - the desired size of output
//   hBits - the size of output of hash function Hash
//   Param - octets representing the parameters
//   Assumes that oBits &lt;= hBits
// Convert the point X to the octet string:
//   ZB' = 04 || x || y
// and extract the x portion from ZB'
ZB = x;
MB = Hash ( 00 || 00 || 00 || 01 || ZB || Param );
return oBits leftmost bits of MB.
</pre><a href="#section-13.4-3" class="pilcrow">¶</a>
</div>
<p id="section-13.4-4">Note that ZB in the KDF description above is the compact representation of X as defined in Section 4.2 of <span>[<a href="#RFC6090" class="xref">RFC6090</a>]</span>.<a href="#section-13.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ec-dh-algorithm-ecdh">
<section id="section-13.5">
        <h3 id="name-ec-dh-algorithm-ecdh">
<a href="#section-13.5" class="section-number selfRef">13.5. </a><a href="#name-ec-dh-algorithm-ecdh" class="section-name selfRef">EC DH Algorithm (ECDH)</a>
        </h3>
<p id="section-13.5-1">The method is a combination of an ECC Diffie-Hellman method to establish a shared secret, a key derivation method to process the shared secret into a derived key, and a key wrapping method that uses the derived key to protect a session key used to encrypt a message.<a href="#section-13.5-1" class="pilcrow">¶</a></p>
<p id="section-13.5-2">The One-Pass Diffie-Hellman method C(1, 1, ECC CDH) <span>[<a href="#SP800-56A" class="xref">SP800-56A</a>]</span> MUST be implemented with the following restrictions: the ECC CDH primitive employed by this method is modified to always assume the cofactor is 1, the KDF specified in <a href="#key-derivation-function" class="xref">Section 13.4</a> is used, and the KDF parameters specified below are used.<a href="#section-13.5-2" class="pilcrow">¶</a></p>
<p id="section-13.5-3">The KDF parameters are encoded as a concatenation of the following 5 variable-length and fixed-length fields, which are compatible with the definition of the OtherInfo bitstring <span>[<a href="#SP800-56A" class="xref">SP800-56A</a>]</span>:<a href="#section-13.5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-4.1">
            <p id="section-13.5-4.1.1">A variable-length field containing a curve OID, which is formatted as follows:<a href="#section-13.5-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-4.1.2.1">A one-octet size of the following field,<a href="#section-13.5-4.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-13.5-4.1.2.2">The octets representing a curve OID defined in <a href="#ec-curves" class="xref">Section 9.2</a>;<a href="#section-13.5-4.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-13.5-4.2">A one-octet public key algorithm ID defined in <a href="#pubkey-algos" class="xref">Section 9.1</a>;<a href="#section-13.5-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-4.3">
            <p id="section-13.5-4.3.1">A variable-length field containing KDF parameters, which are identical to the corresponding field in the ECDH public key, and are formatted as follows:<a href="#section-13.5-4.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-4.3.2.1">A one-octet size of the following fields; values 0 and 0xFF are reserved for future extensions,<a href="#section-13.5-4.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-13.5-4.3.2.2">A one-octet value 0x01, reserved for future extensions,<a href="#section-13.5-4.3.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-13.5-4.3.2.3">A one-octet hash function ID used with the KDF,<a href="#section-13.5-4.3.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-13.5-4.3.2.4">A one-octet algorithm ID for the symmetric algorithm used to wrap the symmetric key for message encryption; see <a href="#ec-dh-algorithm-ecdh" class="xref">Section 13.5</a> for details;<a href="#section-13.5-4.3.2.4" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li class="normal" id="section-13.5-4.4">20 octets representing the UTF-8 encoding of the string <code>Anonymous Sender    </code>, which is the octet sequence 41 6E 6F 6E 79 6D 6F 75 73 20 53 65 6E 64 65 72 20 20 20 20;<a href="#section-13.5-4.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-4.5">20 octets representing a recipient encryption subkey or a primary key fingerprint identifying the key material that is needed for decryption (for version 5 keys the 20 leftmost octets of the fingerprint are used).<a href="#section-13.5-4.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-13.5-5">The size of the KDF parameters sequence, defined above, is either 54 for the NIST curve P-256, 51 for the curves P-384 and P-521, 56 for Curve25519, or 49 for X448.<a href="#section-13.5-5" class="pilcrow">¶</a></p>
<p id="section-13.5-6">The key wrapping method is described in <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span>.
The KDF produces a symmetric key that is used as a key-encryption key (KEK) as specified in <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span>.
Refer to <a href="#security-considerations" class="xref">Section 15</a> for the details regarding the choice of the KEK algorithm, which SHOULD be one of three AES algorithms.
Key wrapping and unwrapping is performed with the default initial value of <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span>.<a href="#section-13.5-6" class="pilcrow">¶</a></p>
<p id="section-13.5-7">The input to the key wrapping method is the value "m" derived from the session key, as described in <a href="#public-key-encrypted-session-key-packets-tag-1" class="xref">Section 5.1</a>, "Public-Key Encrypted Session Key Packets (Tag 1)", except that the PKCS #1.5 padding step is omitted.
The result is padded using the method described in <span>[<a href="#PKCS5" class="xref">PKCS5</a>]</span> to an 8-octet granularity.
For example, the following AES-256 session key, in which 32 octets are denoted from k0 to k31, is composed to form the following 40 octet sequence:<a href="#section-13.5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.5-8">
<pre>
09 k0 k1 ... k31 s0 s1 05 05 05 05 05
</pre><a href="#section-13.5-8" class="pilcrow">¶</a>
</div>
<p id="section-13.5-9">The octets s0 and s1 above denote the checksum.
This encoding allows the sender to obfuscate the size of the symmetric encryption key used to encrypt the data.
For example, assuming that an AES algorithm is used for the session key, the sender MAY use 21, 13, and 5 octets of padding for AES-128, AES-192, and AES-256, respectively, to provide the same number of octets, 40 total, as an input to the key wrapping method.<a href="#section-13.5-9" class="pilcrow">¶</a></p>
<p id="section-13.5-10">The output of the method consists of two fields.
The first field is the MPI containing the ephemeral key used to establish the shared secret.
The second field is composed of the following two subfields:<a href="#section-13.5-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-11.1">One octet encoding the size in octets of the result of the key wrapping method; the value 255 is reserved for future extensions;<a href="#section-13.5-11.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-11.2">Up to 254 octets representing the result of the key wrapping method, applied to the 8-octet padded session key, as described above.<a href="#section-13.5-11.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-13.5-12">Note that for session key sizes 128, 192, and 256 bits, the size of the result of the key wrapping method is, respectively, 32, 40, and 48 octets, unless size obfuscation is used.<a href="#section-13.5-12" class="pilcrow">¶</a></p>
<p id="section-13.5-13">For convenience, the synopsis of the encoding method is given below; however, this section, <span>[<a href="#SP800-56A" class="xref">SP800-56A</a>]</span>, and <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span> are the normative sources of the definition.<a href="#section-13.5-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13.5-14.1">Obtain the authenticated recipient public key R<a href="#section-13.5-14.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.2">Generate an ephemeral key pair {v, V=vG}<a href="#section-13.5-14.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.3">Compute the shared point S = vR;<a href="#section-13.5-14.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.4">m = symm_alg_ID || session key || checksum || pkcs5_padding;<a href="#section-13.5-14.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.5">curve_OID_len = (octet)len(curve_OID);<a href="#section-13.5-14.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.6">Param = curve_OID_len || curve_OID || public_key_alg_ID || 03 || 01 || KDF_hash_ID || KEK_alg_ID for AESKeyWrap || <code>Anonymous Sender    </code> || recipient_fingerprint;<a href="#section-13.5-14.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.7">Z_len = the key size for the KEK_alg_ID used with AESKeyWrap<a href="#section-13.5-14.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.8">Compute Z = KDF( S, Z_len, Param );<a href="#section-13.5-14.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.9">Compute C = AESKeyWrap( Z, m ) as per <span>[<a href="#RFC3394" class="xref">RFC3394</a>]</span><a href="#section-13.5-14.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.10">VB = convert point V to the octet string<a href="#section-13.5-14.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-13.5-14.11">Output (MPI(VB) || len(C) || C).<a href="#section-13.5-14.11" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-13.5-15">The decryption is the inverse of the method given.
Note that the recipient obtains the shared secret by calculating<a href="#section-13.5-15" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-13.5-16">
<pre>
S = rV = rvG, where (r,R) is the recipient's key pair.
</pre><a href="#section-13.5-16" class="pilcrow">¶</a>
</div>
<p id="section-13.5-17">Consistent with <a href="#aead" class="xref">Section 5.16</a> and <a href="#seipd" class="xref">Section 5.14</a>, AEAD encryption or a Modification Detection Code (MDC) MUST be used anytime the symmetric key is protected by ECDH.<a href="#section-13.5-17" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="notes-on-algorithms">
<section id="section-14">
      <h2 id="name-notes-on-algorithms">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-notes-on-algorithms" class="section-name selfRef">Notes on Algorithms</a>
      </h2>
<div id="pkcs-encoding">
<section id="section-14.1">
        <h3 id="name-pkcs1-encoding-in-openpgp">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-pkcs1-encoding-in-openpgp" class="section-name selfRef">PKCS#1 Encoding in OpenPGP</a>
        </h3>
<p id="section-14.1-1">This standard makes use of the PKCS#1 functions EME-PKCS1-v1_5 and EMSA-PKCS1-v1_5.
However, the calling conventions of these functions has changed in the past.
To avoid potential confusion and interoperability problems, we are including local copies in this document, adapted from those in PKCS#1 v2.1 <span>[<a href="#RFC3447" class="xref">RFC3447</a>]</span>.
<span>[<a href="#RFC3447" class="xref">RFC3447</a>]</span> should be treated as the ultimate authority on PKCS#1 for OpenPGP.
Nonetheless, we believe that there is value in having a self-contained document that avoids problems in the future with needed changes in the conventions.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<div id="eme-pkcs1-v15-encode">
<section id="section-14.1.1">
          <h4 id="name-eme-pkcs1-v1_5-encode">
<a href="#section-14.1.1" class="section-number selfRef">14.1.1. </a><a href="#name-eme-pkcs1-v1_5-encode" class="section-name selfRef">EME-PKCS1-v1_5-ENCODE</a>
          </h4>
<p id="section-14.1.1-1">Input:<a href="#section-14.1.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-14.1.1-2">
            <dt id="section-14.1.1-2.1">k =</dt>
            <dd style="margin-left: 1.5em" id="section-14.1.1-2.2">
  the length in octets of the key modulus.<a href="#section-14.1.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-14.1.1-2.3">M =</dt>
            <dd style="margin-left: 1.5em" id="section-14.1.1-2.4">
  message to be encoded, an octet string of length mLen, where mLen &lt;= k - 11.<a href="#section-14.1.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-14.1.1-3">Output:<a href="#section-14.1.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-14.1.1-4">
            <dt id="section-14.1.1-4.1">EM =</dt>
            <dd style="margin-left: 1.5em" id="section-14.1.1-4.2">
  encoded message, an octet string of length k.<a href="#section-14.1.1-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-14.1.1-5">Error: "message too long".<a href="#section-14.1.1-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-14.1.1-6">
<li id="section-14.1.1-6.1">Length checking: If mLen &gt; k - 11, output "message too long" and stop.<a href="#section-14.1.1-6.1" class="pilcrow">¶</a>
</li>
            <li id="section-14.1.1-6.2">Generate an octet string PS of length k - mLen - 3 consisting of pseudo-randomly generated nonzero octets.
The length of PS will be at least eight octets.<a href="#section-14.1.1-6.2" class="pilcrow">¶</a>
</li>
            <li id="section-14.1.1-6.3">
              <p id="section-14.1.1-6.3.1">Concatenate PS, the message M, and other padding to form an encoded message EM of length k octets as<a href="#section-14.1.1-6.3.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-14.1.1-6.3.2">
<pre>
EM = 0x00 || 0x02 || PS || 0x00 || M.
</pre><a href="#section-14.1.1-6.3.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="section-14.1.1-6.4">Output EM.<a href="#section-14.1.1-6.4" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<div id="eme-pkcs1-v15-decode">
<section id="section-14.1.2">
          <h4 id="name-eme-pkcs1-v1_5-decode">
<a href="#section-14.1.2" class="section-number selfRef">14.1.2. </a><a href="#name-eme-pkcs1-v1_5-decode" class="section-name selfRef">EME-PKCS1-v1_5-DECODE</a>
          </h4>
<p id="section-14.1.2-1">Input:<a href="#section-14.1.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-14.1.2-2">
            <dt id="section-14.1.2-2.1">EM =</dt>
            <dd style="margin-left: 1.5em" id="section-14.1.2-2.2">
  encoded message, an octet string<a href="#section-14.1.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-14.1.2-3">Output:<a href="#section-14.1.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-14.1.2-4">
            <dt id="section-14.1.2-4.1">M =</dt>
            <dd style="margin-left: 1.5em" id="section-14.1.2-4.2">
  message, an octet string.<a href="#section-14.1.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-14.1.2-5">Error: "decryption error".<a href="#section-14.1.2-5" class="pilcrow">¶</a></p>
<p id="section-14.1.2-6">To decode an EME-PKCS1_v1_5 message, separate the encoded message EM into an octet string PS consisting of nonzero octets and a message M as follows<a href="#section-14.1.2-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-14.1.2-7">
<pre>
  EM = 0x00 || 0x02 || PS || 0x00 || M.
</pre><a href="#section-14.1.2-7" class="pilcrow">¶</a>
</div>
<p id="section-14.1.2-8">If the first octet of EM does not have hexadecimal value 0x00, if the second octet of EM does not have hexadecimal value 0x02, if there is no octet with hexadecimal value 0x00 to separate PS from M, or if the length of PS is less than 8 octets, output "decryption error" and stop.
See also the security note in <a href="#security-considerations" class="xref">Section 15</a> regarding differences in reporting between a decryption error and a padding error.<a href="#section-14.1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="emsa-pkcs1-v15">
<section id="section-14.1.3">
          <h4 id="name-emsa-pkcs1-v1_5">
<a href="#section-14.1.3" class="section-number selfRef">14.1.3. </a><a href="#name-emsa-pkcs1-v1_5" class="section-name selfRef">EMSA-PKCS1-v1_5</a>
          </h4>
<p id="section-14.1.3-1">This encoding method is deterministic and only has an encoding operation.<a href="#section-14.1.3-1" class="pilcrow">¶</a></p>
<p id="section-14.1.3-2">Option:<a href="#section-14.1.3-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-14.1.3-3">
            <dt id="section-14.1.3-3.1">Hash -</dt>
            <dd style="margin-left: 1.5em" id="section-14.1.3-3.2">
  a hash function in which hLen denotes the length in octets of the hash function output.<a href="#section-14.1.3-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-14.1.3-4">Input:<a href="#section-14.1.3-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-14.1.3-5">
            <dt id="section-14.1.3-5.1">M =</dt>
            <dd style="margin-left: 1.5em" id="section-14.1.3-5.2">
  message to be encoded.<a href="#section-14.1.3-5.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-14.1.3-5.3">emLen =</dt>
            <dd style="margin-left: 1.5em" id="section-14.1.3-5.4">
  intended length in octets of the encoded message, at least tLen + 11, where tLen is the octet length of the DER encoding T of a certain value computed during the encoding operation.<a href="#section-14.1.3-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-14.1.3-6">Output:<a href="#section-14.1.3-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-14.1.3-7">
            <dt id="section-14.1.3-7.1">EM =</dt>
            <dd style="margin-left: 1.5em" id="section-14.1.3-7.2">
  encoded message, an octet string of length emLen.<a href="#section-14.1.3-7.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-14.1.3-8">Errors: "message too long"; "intended encoded message length too short".<a href="#section-14.1.3-8" class="pilcrow">¶</a></p>
<p id="section-14.1.3-9">Steps:<a href="#section-14.1.3-9" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-14.1.3-10">
<li id="section-14.1.3-10.1">
              <p id="section-14.1.3-10.1.1">Apply the hash function to the message M to produce a hash value H:<a href="#section-14.1.3-10.1.1" class="pilcrow">¶</a></p>
<p id="section-14.1.3-10.1.2">
H = Hash(M).<a href="#section-14.1.3-10.1.2" class="pilcrow">¶</a></p>
<p id="section-14.1.3-10.1.3">
If the hash function outputs "message too long," output "message too long" and stop.<a href="#section-14.1.3-10.1.3" class="pilcrow">¶</a></p>
</li>
            <li id="section-14.1.3-10.2">Using the list in <a href="#version-three-sig" class="xref">Section 5.2.2</a>, produce an ASN.1 DER value for the hash function used.
Let T be the full hash prefix from the list, and let tLen be the length in octets of T.<a href="#section-14.1.3-10.2" class="pilcrow">¶</a>
</li>
            <li id="section-14.1.3-10.3">If emLen &lt; tLen + 11, output "intended encoded message length too short" and stop.<a href="#section-14.1.3-10.3" class="pilcrow">¶</a>
</li>
            <li id="section-14.1.3-10.4">Generate an octet string PS consisting of emLen - tLen - 3 octets with hexadecimal value 0xFF.
The length of PS will be at least 8 octets.<a href="#section-14.1.3-10.4" class="pilcrow">¶</a>
</li>
            <li id="section-14.1.3-10.5">
              <p id="section-14.1.3-10.5.1">Concatenate PS, the hash prefix T, and other padding to form the encoded message EM as<a href="#section-14.1.3-10.5.1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-14.1.3-10.5.2">
<pre>
EM = 0x00 || 0x01 || PS || 0x00 || T.
</pre><a href="#section-14.1.3-10.5.2" class="pilcrow">¶</a>
</div>
</li>
            <li id="section-14.1.3-10.6">Output EM.<a href="#section-14.1.3-10.6" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
</section>
</div>
<div id="symmetric-algorithm-preferences">
<section id="section-14.2">
        <h3 id="name-symmetric-algorithm-prefere">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-symmetric-algorithm-prefere" class="section-name selfRef">Symmetric Algorithm Preferences</a>
        </h3>
<p id="section-14.2-1">The symmetric algorithm preference is an ordered list of algorithms that the keyholder accepts.
Since it is found on a self-signature, it is possible that a keyholder may have multiple, different preferences.
For example, Alice may have AES-128 only specified for "alice@work.com" but Camellia-256, Twofish, and AES-128 specified for "alice@home.org".
Note that it is also possible for preferences to be in a subkey's binding signature.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<p id="section-14.2-2">Since TripleDES is the MUST-implement algorithm, if it is not explicitly in the list, it is tacitly at the end.
However, it is good form to place it there explicitly.
Note also that if an implementation does not implement the preference, then it is implicitly a TripleDES-only implementation.<a href="#section-14.2-2" class="pilcrow">¶</a></p>
<p id="section-14.2-3">An implementation MUST NOT use a symmetric algorithm that is not in the recipient's preference list.
When encrypting to more than one recipient, the implementation finds a suitable algorithm by taking the intersection of the preferences of the recipients.
Note that the MUST-implement algorithm, TripleDES, ensures that the intersection is not null.
The implementation may use any mechanism to pick an algorithm in the intersection.<a href="#section-14.2-3" class="pilcrow">¶</a></p>
<p id="section-14.2-4">If an implementation can decrypt a message that a keyholder doesn't have in their preferences, the implementation SHOULD decrypt the message anyway, but MUST warn the keyholder that the protocol has been violated.
For example, suppose that Alice, above, has software that implements all algorithms in this specification.
Nonetheless, she prefers subsets for work or home.
If she is sent a message encrypted with IDEA, which is not in her preferences, the software warns her that someone sent her an IDEA-encrypted message, but it would ideally decrypt it anyway.<a href="#section-14.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="other-algorithm-preferences">
<section id="section-14.3">
        <h3 id="name-other-algorithm-preferences">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-other-algorithm-preferences" class="section-name selfRef">Other Algorithm Preferences</a>
        </h3>
<p id="section-14.3-1">Other algorithm preferences work similarly to the symmetric algorithm preference, in that they specify which algorithms the keyholder accepts.
There are two interesting cases that other comments need to be made about, though, the compression preferences and the hash preferences.<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<div id="compression-preferences">
<section id="section-14.3.1">
          <h4 id="name-compression-preferences">
<a href="#section-14.3.1" class="section-number selfRef">14.3.1. </a><a href="#name-compression-preferences" class="section-name selfRef">Compression Preferences</a>
          </h4>
<p id="section-14.3.1-1">Compression has been an integral part of PGP since its first days.
OpenPGP and all previous versions of PGP have offered compression.
In this specification, the default is for messages to be compressed, although an implementation is not required to do so.
Consequently, the compression preference gives a way for a keyholder to request that messages not be compressed, presumably because they are using a minimal implementation that does not include compression.
Additionally, this gives a keyholder a way to state that it can support alternate algorithms.<a href="#section-14.3.1-1" class="pilcrow">¶</a></p>
<p id="section-14.3.1-2">Like the algorithm preferences, an implementation MUST NOT use an algorithm that is not in the preference vector.
If the preferences are not present, then they are assumed to be [ZIP(1), Uncompressed(0)].<a href="#section-14.3.1-2" class="pilcrow">¶</a></p>
<p id="section-14.3.1-3">Additionally, an implementation MUST implement this preference to the degree of recognizing when to send an uncompressed message.
A robust implementation would satisfy this requirement by looking at the recipient's preference and acting accordingly.
A minimal implementation can satisfy this requirement by never generating a compressed message, since all implementations can handle messages that have not been compressed.<a href="#section-14.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="hash-algorithm-preferences">
<section id="section-14.3.2">
          <h4 id="name-hash-algorithm-preferences">
<a href="#section-14.3.2" class="section-number selfRef">14.3.2. </a><a href="#name-hash-algorithm-preferences" class="section-name selfRef">Hash Algorithm Preferences</a>
          </h4>
<p id="section-14.3.2-1">Typically, the choice of a hash algorithm is something the signer does, rather than the verifier, because a signer rarely knows who is going to be verifying the signature.
This preference, though, allows a protocol based upon digital signatures ease in negotiation.<a href="#section-14.3.2-1" class="pilcrow">¶</a></p>
<p id="section-14.3.2-2">Thus, if Alice is authenticating herself to Bob with a signature, it makes sense for her to use a hash algorithm that Bob's software uses.
This preference allows Bob to state in his key which algorithms Alice may use.<a href="#section-14.3.2-2" class="pilcrow">¶</a></p>
<p id="section-14.3.2-3">Since SHA1 is the MUST-implement hash algorithm, if it is not explicitly in the list, it is tacitly at the end.
However, it is good form to place it there explicitly.<a href="#section-14.3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="plaintext">
<section id="section-14.4">
        <h3 id="name-plaintext">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-plaintext" class="section-name selfRef">Plaintext</a>
        </h3>
<p id="section-14.4-1">Algorithm 0, "plaintext", may only be used to denote secret keys that are stored in the clear.
Implementations MUST NOT use plaintext in Symmetrically Encrypted Data packets; they must use Literal Data packets to encode unencrypted or literal data.<a href="#section-14.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rsa-notes">
<section id="section-14.5">
        <h3 id="name-rsa">
<a href="#section-14.5" class="section-number selfRef">14.5. </a><a href="#name-rsa" class="section-name selfRef">RSA</a>
        </h3>
<p id="section-14.5-1">There are algorithm types for RSA Sign-Only, and RSA Encrypt-Only keys.
These types are deprecated.
The "key flags" subpacket in a signature is a much better way to express the same idea, and generalizes it to all algorithms.
An implementation SHOULD NOT create such a key, but MAY interpret it.<a href="#section-14.5-1" class="pilcrow">¶</a></p>
<p id="section-14.5-2">An implementation SHOULD NOT implement RSA keys of size less than 1024 bits.<a href="#section-14.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="dsa">
<section id="section-14.6">
        <h3 id="name-dsa">
<a href="#section-14.6" class="section-number selfRef">14.6. </a><a href="#name-dsa" class="section-name selfRef">DSA</a>
        </h3>
<p id="section-14.6-1">An implementation SHOULD NOT implement DSA keys of size less than 1024 bits.
It MUST NOT implement a DSA key with a q size of less than 160 bits.
DSA keys MUST also be a multiple of 64 bits, and the q size MUST be a multiple of 8 bits.
The Digital Signature Standard (DSS) <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span> specifies that DSA be used in one of the following ways:<a href="#section-14.6-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.6-2.1">1024-bit key, 160-bit q, SHA-1, SHA2-224, SHA2-256, SHA2-384, or SHA2-512 hash<a href="#section-14.6-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.6-2.2">2048-bit key, 224-bit q, SHA2-224, SHA2-256, SHA2-384, or SHA2-512 hash<a href="#section-14.6-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.6-2.3">2048-bit key, 256-bit q, SHA2-256, SHA2-384, or SHA2-512 hash<a href="#section-14.6-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.6-2.4">3072-bit key, 256-bit q, SHA2-256, SHA2-384, or SHA2-512 hash<a href="#section-14.6-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-14.6-3">The above key and q size pairs were chosen to best balance the strength of the key with the strength of the hash.
Implementations SHOULD use one of the above key and q size pairs when generating DSA keys.
If DSS compliance is desired, one of the specified SHA hashes must be used as well.
<span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span> is the ultimate authority on DSS, and should be consulted for all questions of DSS compliance.<a href="#section-14.6-3" class="pilcrow">¶</a></p>
<p id="section-14.6-4">Note that earlier versions of this standard only allowed a 160-bit q with no truncation allowed, so earlier implementations may not be able to handle signatures with a different q size or a truncated hash.<a href="#section-14.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="elgamal">
<section id="section-14.7">
        <h3 id="name-elgamal">
<a href="#section-14.7" class="section-number selfRef">14.7. </a><a href="#name-elgamal" class="section-name selfRef">Elgamal</a>
        </h3>
<p id="section-14.7-1">An implementation SHOULD NOT implement Elgamal keys of size less than 1024 bits.<a href="#section-14.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="eddsa">
<section id="section-14.8">
        <h3 id="name-eddsa">
<a href="#section-14.8" class="section-number selfRef">14.8. </a><a href="#name-eddsa" class="section-name selfRef">EdDSA</a>
        </h3>
<p id="section-14.8-1">Although the EdDSA algorithm allows arbitrary data as input, its use with OpenPGP requires that a digest of the message is used as input (pre-hashed).
See section <a href="#computing-signatures" class="xref">Section 5.2.4</a>, "Computing Signatures" for details.
Truncation of the resulting digest is never applied; the resulting digest value is used verbatim as input to the EdDSA algorithm.<a href="#section-14.8-1" class="pilcrow">¶</a></p>
<p id="section-14.8-2">For clarity: while <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> describes different variants of EdDSA, OpenPGP uses the "pure" variant (PureEdDSA).
The hashing that happens with OpenPGP is done as part of the standard OpenPGP signature process, and that hash itself is fed as the input message to the PureEdDSA algorithm.<a href="#section-14.8-2" class="pilcrow">¶</a></p>
<p id="section-14.8-3">As specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>, Ed448 also expects a "context string".
In OpenPGP, Ed448 is used with the empty string as a context string.<a href="#section-14.8-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reserved-notes">
<section id="section-14.9">
        <h3 id="name-reserved-algorithm-numbers">
<a href="#section-14.9" class="section-number selfRef">14.9. </a><a href="#name-reserved-algorithm-numbers" class="section-name selfRef">Reserved Algorithm Numbers</a>
        </h3>
<p id="section-14.9-1">A number of algorithm IDs have been reserved for algorithms that would be useful to use in an OpenPGP implementation, yet there are issues that prevent an implementer from actually implementing the algorithm.
These are marked in <a href="#pubkey-algos" class="xref">Section 9.1</a> as "reserved for".<a href="#section-14.9-1" class="pilcrow">¶</a></p>
<p id="section-14.9-2">The reserved public-key algorithm X9.42 (21) does not have the necessary parameters, parameter order, or semantics defined.
The same is currently true for reserved public-key algorithms AEDH (23) and AEDSA (24).<a href="#section-14.9-2" class="pilcrow">¶</a></p>
<p id="section-14.9-3">Previous versions of OpenPGP permitted Elgamal <span>[<a href="#ELGAMAL" class="xref">ELGAMAL</a>]</span> signatures with a public-key identifier of 20.
These are no longer permitted.
An implementation MUST NOT generate such keys.
An implementation MUST NOT generate Elgamal signatures.
See <span>[<a href="#BLEICHENBACHER" class="xref">BLEICHENBACHER</a>]</span>.<a href="#section-14.9-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="cfb-mode">
<section id="section-14.10">
        <h3 id="name-openpgp-cfb-mode">
<a href="#section-14.10" class="section-number selfRef">14.10. </a><a href="#name-openpgp-cfb-mode" class="section-name selfRef">OpenPGP CFB Mode</a>
        </h3>
<p id="section-14.10-1">OpenPGP does symmetric encryption using a variant of Cipher Feedback mode (CFB mode).
This section describes the procedure it uses in detail.
This mode is what is used for Symmetrically Encrypted Data Packets; the mechanism used for encrypting secret-key material is similar, and is described in the sections above.<a href="#section-14.10-1" class="pilcrow">¶</a></p>
<p id="section-14.10-2">In the description below, the value BS is the block size in octets of the cipher.
Most ciphers have a block size of 8 octets.
The AES and Twofish have a block size of 16 octets.
Also note that the description below assumes that the IV and CFB arrays start with an index of 1 (unlike the C language, which assumes arrays start with a zero index).<a href="#section-14.10-2" class="pilcrow">¶</a></p>
<p id="section-14.10-3">OpenPGP CFB mode uses an initialization vector (IV) of all zeros, and prefixes the plaintext with BS+2 octets of random data, such that octets BS+1 and BS+2 match octets BS-1 and BS.
It does a CFB resynchronization after encrypting those BS+2 octets.<a href="#section-14.10-3" class="pilcrow">¶</a></p>
<p id="section-14.10-4">Thus, for an algorithm that has a block size of 8 octets (64 bits), the IV is 10 octets long and octets 7 and 8 of the IV are the same as octets 9 and 10.
For an algorithm with a block size of 16 octets (128 bits), the IV is 18 octets long, and octets 17 and 18 replicate octets 15 and 16.
Those extra two octets are an easy check for a correct key.<a href="#section-14.10-4" class="pilcrow">¶</a></p>
<p id="section-14.10-5">Step by step, here is the procedure:<a href="#section-14.10-5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-14.10-6">
<li id="section-14.10-6.1">The feedback register (FR) is set to the IV, which is all zeros.<a href="#section-14.10-6.1" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.2">FR is encrypted to produce FRE (FR Encrypted).
This is the encryption of an all-zero value.<a href="#section-14.10-6.2" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.3">FRE is xored with the first BS octets of random data prefixed to the plaintext to produce C[1] through C[BS], the first BS octets of ciphertext.<a href="#section-14.10-6.3" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.4">FR is loaded with C[1] through C[BS].<a href="#section-14.10-6.4" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.5">FR is encrypted to produce FRE, the encryption of the first BS octets of ciphertext.<a href="#section-14.10-6.5" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.6">The left two octets of FRE get xored with the next two octets of data that were prefixed to the plaintext.
This produces C[BS+1] and C[BS+2], the next two octets of ciphertext.<a href="#section-14.10-6.6" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.7">(The resynchronization step) FR is loaded with C[3] through C[BS+2].<a href="#section-14.10-6.7" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.8">FR is encrypted to produce FRE.<a href="#section-14.10-6.8" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.9">FRE is xored with the first BS octets of the given plaintext, now that we have finished encrypting the BS+2 octets of prefixed data.
This produces C[BS+3] through C[BS+(BS+2)], the next BS octets of ciphertext.<a href="#section-14.10-6.9" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.10">FR is loaded with C[BS+3] to C[BS + (BS+2)] (which is C11-C18 for an 8-octet block).<a href="#section-14.10-6.10" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.11">FR is encrypted to produce FRE.<a href="#section-14.10-6.11" class="pilcrow">¶</a>
</li>
          <li id="section-14.10-6.12">FRE is xored with the next BS octets of plaintext, to produce the next BS octets of ciphertext.
These are loaded into FR, and the process is repeated until the plaintext is used up.<a href="#section-14.10-6.12" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="private-or-experimental-parameters">
<section id="section-14.11">
        <h3 id="name-private-or-experimental-par">
<a href="#section-14.11" class="section-number selfRef">14.11. </a><a href="#name-private-or-experimental-par" class="section-name selfRef">Private or Experimental Parameters</a>
        </h3>
<p id="section-14.11-1">S2K specifiers, Signature subpacket types, User Attribute types, image format types, and algorithms described in <a href="#constants" class="xref">Section 9</a> all reserve the range 100 to 110 for private and experimental use.
Packet types reserve the range 60 to 63 for private and experimental use.
These are intentionally managed with the PRIVATE USE method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-14.11-1" class="pilcrow">¶</a></p>
<p id="section-14.11-2">However, implementations need to be careful with these and promote them to full IANA-managed parameters when they grow beyond the original, limited system.<a href="#section-14.11-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="extension-of-mdc">
<section id="section-14.12">
        <h3 id="name-extension-of-the-mdc-system">
<a href="#section-14.12" class="section-number selfRef">14.12. </a><a href="#name-extension-of-the-mdc-system" class="section-name selfRef">Extension of the MDC System</a>
        </h3>
<p id="section-14.12-1">As described in the non-normative explanation in <a href="#seipd" class="xref">Section 5.14</a>, the MDC system is uniquely unparameterized in OpenPGP.
This was an intentional decision to avoid cross-grade attacks.
If the MDC system is extended to a stronger hash function, care must be taken to avoid downgrade and cross-grade attacks.<a href="#section-14.12-1" class="pilcrow">¶</a></p>
<p id="section-14.12-2">One simple way to do this is to create new packets for a new MDC.
For example, instead of the MDC system using packets 18 and 19, a new MDC could use 20 and 21.
This has obvious drawbacks (it uses two packet numbers for each new hash function in a space that is limited to a maximum of 60).<a href="#section-14.12-2" class="pilcrow">¶</a></p>
<p id="section-14.12-3">Another simple way to extend the MDC system is to create new versions of packet 18, and reflect this in packet 19.
For example, suppose that V2 of packet 18 implicitly used SHA-256.
This would require packet 19 to have a length of 32 octets.
The change in the version in packet 18 and the size of packet 19 prevent a downgrade attack.<a href="#section-14.12-3" class="pilcrow">¶</a></p>
<p id="section-14.12-4">There are two drawbacks to this latter approach.
The first is that using the version number of a packet to carry algorithm information is not tidy from a protocol-design standpoint.
It is possible that there might be several versions of the MDC system in common use, but this untidiness would reflect untidiness in cryptographic consensus about hash function security.
The second is that different versions of packet 19 would have to have unique sizes.
If there were two versions each with 256-bit hashes, they could not both have 32-octet packet 19s without admitting the chance of a cross-grade attack.<a href="#section-14.12-4" class="pilcrow">¶</a></p>
<p id="section-14.12-5">Yet another, complex approach to extend the MDC system would be a hybrid of the two above -- create a new pair of MDC packets that are fully parameterized, and yet protected from downgrade and cross-grade.<a href="#section-14.12-5" class="pilcrow">¶</a></p>
<p id="section-14.12-6">Any change to the MDC system MUST be done through the IETF CONSENSUS method, as described in <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-14.12-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="meta-considerations-for-expansion">
<section id="section-14.13">
        <h3 id="name-meta-considerations-for-exp">
<a href="#section-14.13" class="section-number selfRef">14.13. </a><a href="#name-meta-considerations-for-exp" class="section-name selfRef">Meta-Considerations for Expansion</a>
        </h3>
<p id="section-14.13-1">If OpenPGP is extended in a way that is not backwards-compatible, meaning that old implementations will not gracefully handle their absence of a new feature, the extension proposal can be declared in the key holder's self-signature as part of the Features signature subpacket.<a href="#section-14.13-1" class="pilcrow">¶</a></p>
<p id="section-14.13-2">We cannot state definitively what extensions will not be upwards-compatible, but typically new algorithms are upwards-compatible, whereas new packets are not.<a href="#section-14.13-2" class="pilcrow">¶</a></p>
<p id="section-14.13-3">If an extension proposal does not update the Features system, it SHOULD include an explanation of why this is unnecessary.
If the proposal contains neither an extension to the Features system nor an explanation of why such an extension is unnecessary, the proposal SHOULD be rejected.<a href="#section-14.13-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-15">
      <h2 id="name-security-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-15-1.1">As with any technology involving cryptography, you should check the current literature to determine if any algorithms used here have been found to be vulnerable to attack.<a href="#section-15-1.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-1.2">This specification uses Public-Key Cryptography technologies.
It is assumed that the private key portion of a public-private key pair is controlled and secured by the proper party or parties.<a href="#section-15-1.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-1.3">Certain operations in this specification involve the use of random numbers.
An appropriate entropy source should be used to generate these numbers (see <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span>).<a href="#section-15-1.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-1.4">The MD5 hash algorithm has been found to have weaknesses, with collisions found in a number of cases.
MD5 is deprecated for use in OpenPGP.
Implementations MUST NOT generate new signatures using MD5 as a hash function.
They MAY continue to consider old signatures that used MD5 as valid.<a href="#section-15-1.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-1.5">SHA2-224 and SHA2-384 require the same work as SHA2-256 and SHA2-512, respectively.
In general, there are few reasons to use them outside of DSS compatibility.
You need a situation where one needs more security than smaller hashes, but does not want to have the full 256-bit or 512-bit data length.<a href="#section-15-1.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-1.6">Many security protocol designers think that it is a bad idea to use a single key for both privacy (encryption) and integrity (signatures).
In fact, this was one of the motivating forces behind the V4 key format with separate signature and encryption keys.
If you as an implementer promote dual-use keys, you should at least be aware of this controversy.<a href="#section-15-1.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-1.7">The DSA algorithm will work with any hash, but is sensitive to the quality of the hash algorithm.
Verifiers should be aware that even if the signer used a strong hash, an attacker could have modified the signature to use a weak one.
Only signatures using acceptably strong hash algorithms should be accepted as valid.<a href="#section-15-1.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-1.8">As OpenPGP combines many different asymmetric, symmetric, and hash algorithms, each with different measures of strength, care should be taken that the weakest element of an OpenPGP message is still sufficiently strong for the purpose at hand.
While consensus about the strength of a given algorithm may evolve, NIST Special Publication 800-57 <span>[<a href="#SP800-57" class="xref">SP800-57</a>]</span> recommends the following list of equivalent strengths:<a href="#section-15-1.8" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-key-length-equivalences"></span><table class="center" id="table-26">
        <caption>
<a href="#table-26" class="selfRef">Table 26</a>:
<a href="#name-key-length-equivalences" class="selfRef">Key length equivalences</a>
        </caption>
<thead>
          <tr>
            <th class="text-right" rowspan="1" colspan="1">Asymmetric key size</th>
            <th class="text-left" rowspan="1" colspan="1">Hash size</th>
            <th class="text-left" rowspan="1" colspan="1">Symmetric key size</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">1024</td>
            <td class="text-left" rowspan="1" colspan="1">160</td>
            <td class="text-left" rowspan="1" colspan="1">80</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">2048</td>
            <td class="text-left" rowspan="1" colspan="1">224</td>
            <td class="text-left" rowspan="1" colspan="1">112</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">3072</td>
            <td class="text-left" rowspan="1" colspan="1">256</td>
            <td class="text-left" rowspan="1" colspan="1">128</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">7680</td>
            <td class="text-left" rowspan="1" colspan="1">384</td>
            <td class="text-left" rowspan="1" colspan="1">192</td>
          </tr>
          <tr>
            <td class="text-right" rowspan="1" colspan="1">15360</td>
            <td class="text-left" rowspan="1" colspan="1">512</td>
            <td class="text-left" rowspan="1" colspan="1">256</td>
          </tr>
        </tbody>
      </table>
<ul class="normal">
<li class="normal" id="section-15-3.1">
          <p id="section-15-3.1.1">There is a somewhat-related potential security problem in signatures.
If an attacker can find a message that hashes to the same hash with a different algorithm, a bogus signature structure can be constructed that evaluates correctly.<a href="#section-15-3.1.1" class="pilcrow">¶</a></p>
<p id="section-15-3.1.2">
For example, suppose Alice DSA signs message M using hash algorithm H.
Suppose that Mallet finds a message M' that has the same hash value as M with H'.
Mallet can then construct a signature block that verifies as Alice's signature of M' with H'.
However, this would also constitute a weakness in either H or H' or both.
Should this ever occur, a revision will have to be made to this document to revise the allowed hash algorithms.<a href="#section-15-3.1.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-15-3.2">If you are building an authentication system, the recipient may specify a preferred signing algorithm.
However, the signer would be foolish to use a weak algorithm simply because the recipient requests it.<a href="#section-15-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-3.3">Some of the encryption algorithms mentioned in this document have been analyzed less than others.
For example, although CAST5 is presently considered strong, it has been analyzed less than TripleDES.
Other algorithms may have other controversies surrounding them.<a href="#section-15-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-3.4">
          <p id="section-15-3.4.1">In late summer 2002, Jallad, Katz, and Schneier published an interesting attack on the OpenPGP protocol and some of its implementations <span>[<a href="#JKS02" class="xref">JKS02</a>]</span>.
In this attack, the attacker modifies a message and sends it to a user who then returns the erroneously decrypted message to the attacker.
The attacker is thus using the user as a random oracle, and can often decrypt the message.<a href="#section-15-3.4.1" class="pilcrow">¶</a></p>
<p id="section-15-3.4.2">
Compressing data can ameliorate this attack.
The incorrectly decrypted data nearly always decompresses in ways that defeat the attack.
However, this is not a rigorous fix, and leaves open some small vulnerabilities.
For example, if an implementation does not compress a message before encryption (perhaps because it knows it was already compressed), then that message is vulnerable.
Because of this happenstance -- that modification attacks can be thwarted by decompression errors -- an implementation SHOULD treat a decompression error as a security problem, not merely a data problem.<a href="#section-15-3.4.2" class="pilcrow">¶</a></p>
<p id="section-15-3.4.3">
This attack can be defeated by the use of Modification Detection, provided that the implementation does not let the user naively return the data to the attacker.
An implementation MUST treat an MDC failure as a security problem, not merely a data problem.<a href="#section-15-3.4.3" class="pilcrow">¶</a></p>
<p id="section-15-3.4.4">
In either case, the implementation MAY allow the user access to the erroneous data, but MUST warn the user as to potential security problems should that data be returned to the sender.<a href="#section-15-3.4.4" class="pilcrow">¶</a></p>
<p id="section-15-3.4.5">
While this attack is somewhat obscure, requiring a special set of circumstances to create it, it is nonetheless quite serious as it permits someone to trick a user to decrypt a message.
Consequently, it is important that:<a href="#section-15-3.4.5" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-15-3.4.6">
<li id="section-15-3.4.6.1">Implementers treat MDC errors and decompression failures as security problems.<a href="#section-15-3.4.6.1" class="pilcrow">¶</a>
</li>
            <li id="section-15-3.4.6.2">Implementers implement Modification Detection with all due speed and encourage its spread.<a href="#section-15-3.4.6.2" class="pilcrow">¶</a>
</li>
            <li id="section-15-3.4.6.3">Users migrate to implementations that support Modification Detection with all due speed.<a href="#section-15-3.4.6.3" class="pilcrow">¶</a>
</li>
          </ol>
</li>
        <li class="normal" id="section-15-3.5">PKCS#1 has been found to be vulnerable to attacks in which a system that reports errors in padding differently from errors in decryption becomes a random oracle that can leak the private key in mere millions of queries.
Implementations must be aware of this attack and prevent it from happening.
The simplest solution is to report a single error code for all variants of decryption errors so as not to leak information to an attacker.<a href="#section-15-3.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-3.6">Some technologies mentioned here may be subject to government control in some countries.<a href="#section-15-3.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-3.7">
          <p id="section-15-3.7.1">In winter 2005, Serge Mister and Robert Zuccherato from Entrust released a paper describing a way that the "quick check" in OpenPGP CFB mode can be used with a random oracle to decrypt two octets of every cipher block <span>[<a href="#MZ05" class="xref">MZ05</a>]</span>.
They recommend as prevention not using the quick check at all.<a href="#section-15-3.7.1" class="pilcrow">¶</a></p>
<p id="section-15-3.7.2">
Many implementers have taken this advice to heart for any data that is symmetrically encrypted and for which the session key is public-key encrypted.
In this case, the quick check is not needed as the public-key encryption of the session key should guarantee that it is the right session key.
In other cases, the implementation should use the quick check with care.<a href="#section-15-3.7.2" class="pilcrow">¶</a></p>
<p id="section-15-3.7.3">
On the one hand, there is a danger to using it if there is a random oracle that can leak information to an attacker.
In plainer language, there is a danger to using the quick check if timing information about the check can be exposed to an attacker, particularly via an automated service that allows rapidly repeated queries.<a href="#section-15-3.7.3" class="pilcrow">¶</a></p>
<p id="section-15-3.7.4">
On the other hand, it is inconvenient to the user to be informed that they typed in the wrong passphrase only after a petabyte of data is decrypted.
There are many cases in cryptographic engineering where the implementer must use care and wisdom, and this is one.<a href="#section-15-3.7.4" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-15-3.8">Refer to <span>[<a href="#FIPS186" class="xref">FIPS186</a>]</span>, B.4.1, for the method to generate a uniformly distributed ECC private key.<a href="#section-15-3.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-15-3.9">
          <p id="section-15-3.9.1">The curves proposed in this document correspond to the symmetric key sizes 128 bits, 192 bits, and 256 bits, as described in the table below.
This allows a compliant application to offer balanced public key security, which is compatible with the symmetric key strength for each AES algorithm defined here.<a href="#section-15-3.9.1" class="pilcrow">¶</a></p>
<p id="section-15-3.9.2">
The following table defines the hash and the symmetric encryption algorithm that SHOULD be used with a given curve for ECDSA or ECDH.
A stronger hash algorithm or a symmetric key algorithm MAY be used for a given ECC curve.
However, note that the increase in the strength of the hash algorithm or the symmetric key algorithm may not increase the overall security offered by the given ECC key.<a href="#section-15-3.9.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<span id="name-elliptic-curve-cryptographi"></span><table class="center" id="table-27">
        <caption>
<a href="#table-27" class="selfRef">Table 27</a>:
<a href="#name-elliptic-curve-cryptographi" class="selfRef">Elliptic Curve cryptographic guidance</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Curve name</th>
            <th class="text-left" rowspan="1" colspan="1">ECC</th>
            <th class="text-left" rowspan="1" colspan="1">RSA strength</th>
            <th class="text-left" rowspan="1" colspan="1">Hash size strength, informative</th>
            <th class="text-left" rowspan="1" colspan="1">Symmetric key size</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NIST P-256</td>
            <td class="text-left" rowspan="1" colspan="1">256</td>
            <td class="text-left" rowspan="1" colspan="1">3072</td>
            <td class="text-left" rowspan="1" colspan="1">256</td>
            <td class="text-left" rowspan="1" colspan="1">128</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NIST P-384</td>
            <td class="text-left" rowspan="1" colspan="1">384</td>
            <td class="text-left" rowspan="1" colspan="1">7680</td>
            <td class="text-left" rowspan="1" colspan="1">384</td>
            <td class="text-left" rowspan="1" colspan="1">192</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NIST P-521</td>
            <td class="text-left" rowspan="1" colspan="1">521</td>
            <td class="text-left" rowspan="1" colspan="1">15360</td>
            <td class="text-left" rowspan="1" colspan="1">512</td>
            <td class="text-left" rowspan="1" colspan="1">256</td>
          </tr>
        </tbody>
      </table>
<ul class="normal">
<li class="normal" id="section-15-5.1">
          <p id="section-15-5.1.1">Requirement levels indicated elsewhere in this document lead to the following combinations of algorithms in the OpenPGP profile: MUST implement NIST curve P-256 / SHA2-256 / AES-128, SHOULD implement NIST curve P-521 / SHA2-512 / AES-256, MAY implement NIST curve P-384 / SHA2-384 / AES-256, among other allowed combinations.<a href="#section-15-5.1.1" class="pilcrow">¶</a></p>
<p id="section-15-5.1.2">
Consistent with the table above, the following table defines the KDF hash algorithm and the AES KEK encryption algorithm that SHOULD be used with a given curve for ECDH.
A stronger KDF hash algorithm or AES KEK algorithm MAY be used for a given ECC curve.<a href="#section-15-5.1.2" class="pilcrow">¶</a></p>
</li>
      </ul>
<span id="name-elliptic-curve-kdf-and-kek-"></span><table class="center" id="table-28">
        <caption>
<a href="#table-28" class="selfRef">Table 28</a>:
<a href="#name-elliptic-curve-kdf-and-kek-" class="selfRef">Elliptic Curve KDF and KEK recommendations</a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Curve name</th>
            <th class="text-left" rowspan="1" colspan="1">Recommended KDF hash algorithm</th>
            <th class="text-left" rowspan="1" colspan="1">Recommended KEK encryption algorithm</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NIST P-256</td>
            <td class="text-left" rowspan="1" colspan="1">SHA2-256</td>
            <td class="text-left" rowspan="1" colspan="1">AES-128</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NIST P-384</td>
            <td class="text-left" rowspan="1" colspan="1">SHA2-384</td>
            <td class="text-left" rowspan="1" colspan="1">AES-192</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NIST P-521</td>
            <td class="text-left" rowspan="1" colspan="1">SHA2-512</td>
            <td class="text-left" rowspan="1" colspan="1">AES-256</td>
          </tr>
        </tbody>
      </table>
<ul class="normal">
<li class="normal" id="section-15-7.1">
          <p id="section-15-7.1.1">This document explicitly discourages the use of algorithms other than AES as a KEK algorithm because backward compatibility of the ECDH format is not a concern.
The KEK algorithm is only used within the scope of a Public-Key Encrypted Session Key Packet, which represents an ECDH key recipient of a message.
Compare this with the algorithm used for the session key of the message, which MAY be different from a KEK algorithm.<a href="#section-15-7.1.1" class="pilcrow">¶</a></p>
<p id="section-15-7.1.2">
Compliant applications SHOULD implement, advertise through key preferences, and use the strongest algorithms specified in this document.<a href="#section-15-7.1.2" class="pilcrow">¶</a></p>
<p id="section-15-7.1.3">
Note that the symmetric algorithm preference list may make it impossible to use the balanced strength of symmetric key algorithms for a corresponding public key.
For example, the presence of the symmetric key algorithm IDs and their order in the key preference list affects the algorithm choices available to the encoding side, which in turn may make the adherence to the table above infeasible.
Therefore, compliance with this specification is a concern throughout the life of the key starting immediately after the key generation when the key preferences are first added to a key.
It is generally advisable to position a symmetric algorithm ID of strength matching the public key at the head of the key preference list.<a href="#section-15-7.1.3" class="pilcrow">¶</a></p>
<p id="section-15-7.1.4">
Encryption to multiple recipients often results in an unordered intersection subset.
For example, if the first recipient's set is {A, B} and the second's is {B, A}, the intersection is an unordered set of two algorithms, A and B.
In this case, a compliant application SHOULD choose the stronger encryption algorithm.<a href="#section-15-7.1.4" class="pilcrow">¶</a></p>
<p id="section-15-7.1.5">
Resource constraints, such as limited computational power, are a reason why an application might prefer to use the weakest algorithm.
On the other side of the spectrum are applications that can implement every algorithm defined in this document.
Most applications are expected to fall into either of these two categories.
A compliant application in the second, or strongest, category SHOULD prefer AES-256 to AES-192.<a href="#section-15-7.1.5" class="pilcrow">¶</a></p>
<p id="section-15-7.1.6">
SHA-1 MUST NOT be used with the ECDSA or the KDF in the ECDH method.<a href="#section-15-7.1.6" class="pilcrow">¶</a></p>
<p id="section-15-7.1.7">
MDC MUST be used when a symmetric encryption key is protected by ECDH.
None of the ECC methods described in this document are allowed with deprecated V3 keys.<a href="#section-15-7.1.7" class="pilcrow">¶</a></p>
<p id="section-15-7.1.8">
Side channel attacks are a concern when a compliant application's use of the OpenPGP format can be modeled by a decryption or signing oracle, for example, when an application is a network service performing decryption to unauthenticated remote users.
ECC scalar multiplication operations used in ECDSA and ECDH are vulnerable to side channel attacks.
Countermeasures can often be taken at the higher protocol level, such as limiting the number of allowed failures or time-blinding of the operations associated with each network interface.
Mitigations at the scalar multiplication level seek to eliminate any measurable distinction between the ECC point addition and doubling operations.<a href="#section-15-7.1.8" class="pilcrow">¶</a></p>
</li>
      </ul>
</section>
</div>
<div id="implementation-nits">
<section id="section-16">
      <h2 id="name-implementation-nits">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-implementation-nits" class="section-name selfRef">Implementation Nits</a>
      </h2>
<p id="section-16-1">This section is a collection of comments to help an implementer, particularly with an eye to backward compatibility.
Previous implementations of PGP are not OpenPGP compliant.
Often the differences are small, but small differences are frequently more vexing than large differences.
Thus, this is a non-comprehensive list of potential problems and gotchas for a developer who is trying to be backward-compatible.<a href="#section-16-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-16-2.1">The IDEA algorithm is patented, and yet it is required for PGP 2 interoperability.
It is also the de-facto preferred algorithm for a V3 key with a V3 self-signature (or no self-signature).<a href="#section-16-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-16-2.2">When exporting a private key, PGP 2 generates the header "BEGIN PGP SECRET KEY BLOCK" instead of "BEGIN PGP PRIVATE KEY BLOCK".
All previous versions ignore the implied data type, and look directly at the packet data type.<a href="#section-16-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-16-2.3">PGP versions 2.0 through 2.5 generated V2 Public-Key packets.
These are identical to the deprecated V3 keys except for the version number.
An implementation MUST NOT generate them and may accept or reject them as it sees fit.
Some older PGP versions generated V2 PKESK packets (Tag 1) as well.
An implementation may accept or reject V2 PKESK packets as it sees fit, and MUST NOT generate them.<a href="#section-16-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-16-2.4">PGP version 2.6 will not accept key-material packets with versions greater than 3.<a href="#section-16-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-16-2.5">There are many ways possible for two keys to have the same key material, but different fingerprints (and thus Key IDs).
Perhaps the most interesting is an RSA key that has been "upgraded" to V4 format, but since a V4 fingerprint is constructed by hashing the key creation time along with other things, two V4 keys created at different times, yet with the same key material will have different fingerprints.<a href="#section-16-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-16-2.6">If an implementation is using zlib to interoperate with PGP 2, then the "windowBits" parameter should be set to -13.<a href="#section-16-2.6" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-16-2.7">The 0x19 back signatures were not required for signing subkeys until relatively recently.
Consequently, there may be keys in the wild that do not have these back signatures.
Implementing software may handle these keys as it sees fit.<a href="#section-16-2.7" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-16-2.8">OpenPGP does not put limits on the size of public keys.
However, larger keys are not necessarily better keys.
Larger keys take more computation time to use, and this can quickly become impractical.
Different OpenPGP implementations may also use different upper bounds for public key sizes, and so care should be taken when choosing sizes to maintain interoperability.
As of 2007 most implementations have an upper bound of 4096 bits.<a href="#section-16-2.8" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-16-2.9">ASCII armor is an optional feature of OpenPGP.
The OpenPGP working group strives for a minimal set of mandatory-to-implement features, and since there could be useful implementations that only use binary object formats, this is not a "MUST" feature for an implementation.
For example, an implementation that is using OpenPGP as a mechanism for file signatures may find ASCII armor unnecessary.
OpenPGP permits an implementation to declare what features it does and does not support, but ASCII armor is not one of these.
Since most implementations allow binary and armored objects to be used indiscriminately, an implementation that does not implement ASCII armor may find itself with compatibility issues with general-purpose implementations.
Moreover, implementations of OpenPGP-MIME <span>[<a href="#RFC3156" class="xref">RFC3156</a>]</span> already have a requirement for ASCII armor so those implementations will necessarily have support.<a href="#section-16-2.9" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<section id="section-17">
      <h2 id="name-references">
<a href="#section-17" class="section-number selfRef">17. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-17.1">
        <h3 id="name-normative-references">
<a href="#section-17.1" class="section-number selfRef">17.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="AES">[AES]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"FIPS PUB 197, Advanced Encryption Standard (AES)"</span>, <time datetime="2001-11" class="refDate">November 2001</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/fips/fips197/fips-197.%7Bps,pdf%7D">http://csrc.nist.gov/publications/fips/fips197/fips-197.{ps,pdf}</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BLOWFISH">[BLOWFISH]</dt>
        <dd>
<span class="refAuthor">Schneier, B.</span>, <span class="refTitle">"Description of a New Variable-Length Key, 64-Bit Block Cipher (Blowfish)"</span>, <span class="seriesInfo">Fast Software Encryption, Cambridge Security Workshop Proceedings Springer-Verlag, 1994, pp191-204</span>, <time datetime="1993-12" class="refDate">December 1993</time>, <span>&lt;<a href="http://www.counterpane.com/bfsverlag.html">http://www.counterpane.com/bfsverlag.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="BZ2">[BZ2]</dt>
        <dd>
<span class="refAuthor">Seward, J.</span>, <span class="refTitle">"The Bzip2 and libbzip2 home page"</span>, <time datetime="2010" class="refDate">2010</time>, <span>&lt;<a href="http://www.bzip.org/">http://www.bzip.org/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="EAX">[EAX]</dt>
        <dd>
<span class="refAuthor">Bellare, M.</span>, <span class="refAuthor">Rogaway, P.</span>, and <span class="refAuthor">D. Wagner</span>, <span class="refTitle">"A Conventional Authenticated-Encryption Mode"</span>, <time datetime="2003-04" class="refDate">April 2003</time>. </dd>
<dd class="break"></dd>
<dt id="ELGAMAL">[ELGAMAL]</dt>
        <dd>
<span class="refAuthor">Elgamal, T.</span>, <span class="refTitle">"A Public-Key Cryptosystem and a Signature Scheme Based on Discrete Logarithms"</span>, <span class="seriesInfo">IEEE Transactions on Information Theory v. IT-31, n. 4, 1985, pp. 469-472</span>, <time datetime="1985" class="refDate">1985</time>. </dd>
<dd class="break"></dd>
<dt id="FIPS180">[FIPS180]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology, U.S. Department of Commerce</span>, <span class="refTitle">"Secure Hash Standard (SHS), FIPS 180-4"</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="http://dx.doi.org/10.6028/NIST.FIPS.180-4">http://dx.doi.org/10.6028/NIST.FIPS.180-4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS186">[FIPS186]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology, U.S. Department of Commerce</span>, <span class="refTitle">"Digital Signature Standard (DSS), FIPS 186-4"</span>, <time datetime="2013-07" class="refDate">July 2013</time>, <span>&lt;<a href="http://dx.doi.org/10.6028/NIST.FIPS.186-4">http://dx.doi.org/10.6028/NIST.FIPS.186-4</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS202">[FIPS202]</dt>
        <dd>
<span class="refAuthor">National Institute of Standards and Technology, U.S. Department of Commerce</span>, <span class="refTitle">"SHA-3 Standard: Permutation-Based Hash and Extendable-Output Functions, FIPS 202"</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="http://dx.doi.org/10.6028/NIST.FIPS.202">http://dx.doi.org/10.6028/NIST.FIPS.202</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="HAC">[HAC]</dt>
        <dd>
<span class="refAuthor">Menezes, A.J.</span>, <span class="refAuthor">Oorschot, P.v.</span>, and <span class="refAuthor">S. Vanstone</span>, <span class="refTitle">"Handbook of Applied Cryptography"</span>, <time datetime="1996" class="refDate">1996</time>. </dd>
<dd class="break"></dd>
<dt id="IDEA">[IDEA]</dt>
        <dd>
<span class="refAuthor">Lai, X.</span>, <span class="refTitle">"On the design and security of block ciphers"</span>, <span class="seriesInfo">ETH Series in Information Processing, J.L. Massey (editor) Vol. 1, Hartung-Gorre Verlag Konstanz, Technische Hochschule (Zurich)</span>, <time datetime="1992" class="refDate">1992</time>. </dd>
<dd class="break"></dd>
<dt id="ISO10646">[ISO10646]</dt>
        <dd>
<span class="refAuthor">International Organization for Standardization</span>, <span class="refTitle">"Information Technology - Universal Multiple-octet coded Character Set (UCS) - Part 1: Architecture and Basic Multilingual Plane"</span>, <span class="seriesInfo">ISO Standard 10646-1</span>, <time datetime="1993-05" class="refDate">May 1993</time>. </dd>
<dd class="break"></dd>
<dt id="JFIF">[JFIF]</dt>
        <dd>
<span class="refAuthor">CA, E.H.M.</span>, <span class="refTitle">"JPEG File Interchange Format (Version 1.02)."</span>, <time datetime="1996-09" class="refDate">September 1996</time>. </dd>
<dd class="break"></dd>
<dt id="PKCS5">[PKCS5]</dt>
        <dd>
<span class="refAuthor">RSA Laboratories</span>, <span class="refTitle">"PKCS #5 v2.0: Password-Based Cryptography Standard"</span>, <time datetime="1999-03-25" class="refDate">25 March 1999</time>. </dd>
<dd class="break"></dd>
<dt id="RFC1950">[RFC1950]</dt>
        <dd>
<span class="refAuthor">Deutsch, P.</span> and <span class="refAuthor">J-L. Gailly</span>, <span class="refTitle">"ZLIB Compressed Data Format Specification version 3.3"</span>, <span class="seriesInfo">RFC 1950</span>, <span class="seriesInfo">DOI 10.17487/RFC1950</span>, <time datetime="1996-05" class="refDate">May 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1950">https://www.rfc-editor.org/info/rfc1950</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1951">[RFC1951]</dt>
        <dd>
<span class="refAuthor">Deutsch, P.</span>, <span class="refTitle">"DEFLATE Compressed Data Format Specification version 1.3"</span>, <span class="seriesInfo">RFC 1951</span>, <span class="seriesInfo">DOI 10.17487/RFC1951</span>, <time datetime="1996-05" class="refDate">May 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1951">https://www.rfc-editor.org/info/rfc1951</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2045">[RFC2045]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span> and <span class="refAuthor">N. Borenstein</span>, <span class="refTitle">"Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies"</span>, <span class="seriesInfo">RFC 2045</span>, <span class="seriesInfo">DOI 10.17487/RFC2045</span>, <time datetime="1996-11" class="refDate">November 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2045">https://www.rfc-editor.org/info/rfc2045</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2144">[RFC2144]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span>, <span class="refTitle">"The CAST-128 Encryption Algorithm"</span>, <span class="seriesInfo">RFC 2144</span>, <span class="seriesInfo">DOI 10.17487/RFC2144</span>, <time datetime="1997-05" class="refDate">May 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2144">https://www.rfc-editor.org/info/rfc2144</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2822">[RFC2822]</dt>
        <dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 2822</span>, <span class="seriesInfo">DOI 10.17487/RFC2822</span>, <time datetime="2001-04" class="refDate">April 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2822">https://www.rfc-editor.org/info/rfc2822</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3156">[RFC3156]</dt>
        <dd>
<span class="refAuthor">Elkins, M.</span>, <span class="refAuthor">Del Torto, D.</span>, <span class="refAuthor">Levien, R.</span>, and <span class="refAuthor">T. Roessler</span>, <span class="refTitle">"MIME Security with OpenPGP"</span>, <span class="seriesInfo">RFC 3156</span>, <span class="seriesInfo">DOI 10.17487/RFC3156</span>, <time datetime="2001-08" class="refDate">August 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3156">https://www.rfc-editor.org/info/rfc3156</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3394">[RFC3394]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span> and <span class="refAuthor">R. Housley</span>, <span class="refTitle">"Advanced Encryption Standard (AES) Key Wrap Algorithm"</span>, <span class="seriesInfo">RFC 3394</span>, <span class="seriesInfo">DOI 10.17487/RFC3394</span>, <time datetime="2002-09" class="refDate">September 2002</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3394">https://www.rfc-editor.org/info/rfc3394</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3447">[RFC3447]</dt>
        <dd>
<span class="refAuthor">Jonsson, J.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1"</span>, <span class="seriesInfo">RFC 3447</span>, <span class="seriesInfo">DOI 10.17487/RFC3447</span>, <time datetime="2003-02" class="refDate">February 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3447">https://www.rfc-editor.org/info/rfc3447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3629">[RFC3629]</dt>
        <dd>
<span class="refAuthor">Yergeau, F.</span>, <span class="refTitle">"UTF-8, a transformation format of ISO 10646"</span>, <span class="seriesInfo">STD 63</span>, <span class="seriesInfo">RFC 3629</span>, <span class="seriesInfo">DOI 10.17487/RFC3629</span>, <time datetime="2003-11" class="refDate">November 2003</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3629">https://www.rfc-editor.org/info/rfc3629</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3713">[RFC3713]</dt>
        <dd>
<span class="refAuthor">Matsui, M.</span>, <span class="refAuthor">Nakajima, J.</span>, and <span class="refAuthor">S. Moriai</span>, <span class="refTitle">"A Description of the Camellia Encryption Algorithm"</span>, <span class="seriesInfo">RFC 3713</span>, <span class="seriesInfo">DOI 10.17487/RFC3713</span>, <time datetime="2004-04" class="refDate">April 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3713">https://www.rfc-editor.org/info/rfc3713</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7253">[RFC7253]</dt>
        <dd>
<span class="refAuthor">Krovetz, T.</span> and <span class="refAuthor">P. Rogaway</span>, <span class="refTitle">"The OCB Authenticated-Encryption Algorithm"</span>, <span class="seriesInfo">RFC 7253</span>, <span class="seriesInfo">DOI 10.17487/RFC7253</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7253">https://www.rfc-editor.org/info/rfc7253</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9106">[RFC9106]</dt>
        <dd>
<span class="refAuthor">Biryukov, A.</span>, <span class="refAuthor">Dinu, D.</span>, <span class="refAuthor">Khovratovich, D.</span>, and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"Argon2 Memory-Hard Function for Password Hashing and Proof-of-Work Applications"</span>, <span class="seriesInfo">RFC 9106</span>, <span class="seriesInfo">DOI 10.17487/RFC9106</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9106">https://www.rfc-editor.org/info/rfc9106</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SCHNEIER">[SCHNEIER]</dt>
        <dd>
<span class="refAuthor">Schneier, B.</span>, <span class="refTitle">"Applied Cryptography Second Edition: protocols, algorithms, and source code in C"</span>, <time datetime="1996" class="refDate">1996</time>. </dd>
<dd class="break"></dd>
<dt id="SP800-56A">[SP800-56A]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Johnson, D.</span>, and <span class="refAuthor">M. Smid</span>, <span class="refTitle">"Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography"</span>, <span class="seriesInfo">NIST Special Publication 800-56A Revision 1</span>, <time datetime="2007-03" class="refDate">March 2007</time>. </dd>
<dd class="break"></dd>
<dt id="TWOFISH">[TWOFISH]</dt>
      <dd>
<span class="refAuthor">Schneier, B.</span>, <span class="refAuthor">Kelsey, J.</span>, <span class="refAuthor">Whiting, D.</span>, <span class="refAuthor">Wagner, D.</span>, <span class="refAuthor">Hall, C.</span>, and <span class="refAuthor">N. Ferguson</span>, <span class="refTitle">"The Twofish Encryption Algorithm"</span>, <time datetime="1999" class="refDate">1999</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-17.2">
        <h3 id="name-informative-references">
<a href="#section-17.2" class="section-number selfRef">17.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="BLEICHENBACHER">[BLEICHENBACHER]</dt>
        <dd>
<span class="refAuthor">Bleichenbacher, D.</span>, <span class="refTitle">"Generating ElGamal Signatures Without Knowing the Secret Key"</span>, <span class="seriesInfo">Lecture Notes in Computer Science Volume 1070, pp. 10-18</span>, <time datetime="1996" class="refDate">1996</time>. </dd>
<dd class="break"></dd>
<dt id="JKS02">[JKS02]</dt>
        <dd>
<span class="refAuthor">Jallad, K.</span>, <span class="refAuthor">Katz, J.</span>, and <span class="refAuthor">B. Schneier</span>, <span class="refTitle">"Implementation of Chosen-Ciphertext Attacks against PGP and GnuPG"</span>, <time datetime="2002" class="refDate">2002</time>, <span>&lt;<a href="http://www.counterpane.com/pgp-attack.html">http://www.counterpane.com/pgp-attack.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="KOBLITZ">[KOBLITZ]</dt>
        <dd>
<span class="refAuthor">Koblitz, N.</span>, <span class="refTitle">"A course in number theory and cryptography, Chapter VI. Elliptic Curves"</span>, <span class="seriesInfo">ISBN 0-387-96576-9</span>, <time datetime="1997" class="refDate">1997</time>. </dd>
<dd class="break"></dd>
<dt id="MZ05">[MZ05]</dt>
        <dd>
<span class="refAuthor">Mister, S.</span> and <span class="refAuthor">R. Zuccherato</span>, <span class="refTitle">"An Attack on CFB Mode Encryption As Used By OpenPGP"</span>, <span class="seriesInfo">IACR ePrint Archive Report 2005/033</span>, <time datetime="2005-02-08" class="refDate">8 February 2005</time>, <span>&lt;<a href="http://eprint.iacr.org/2005/033">http://eprint.iacr.org/2005/033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="REGEX">[REGEX]</dt>
        <dd>
<span class="refAuthor">Friedl, J.</span>, <span class="refTitle">"Mastering Regular Expressions"</span>, <span class="seriesInfo">ISBN 0-596-00289-0</span>, <time datetime="2002-08" class="refDate">August 2002</time>. </dd>
<dd class="break"></dd>
<dt id="RFC1991">[RFC1991]</dt>
        <dd>
<span class="refAuthor">Atkins, D.</span>, <span class="refAuthor">Stallings, W.</span>, and <span class="refAuthor">P. Zimmermann</span>, <span class="refTitle">"PGP Message Exchange Formats"</span>, <span class="seriesInfo">RFC 1991</span>, <span class="seriesInfo">DOI 10.17487/RFC1991</span>, <time datetime="1996-08" class="refDate">August 1996</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1991">https://www.rfc-editor.org/info/rfc1991</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2440">[RFC2440]</dt>
        <dd>
<span class="refAuthor">Callas, J.</span>, <span class="refAuthor">Donnerhacke, L.</span>, <span class="refAuthor">Finney, H.</span>, and <span class="refAuthor">R. Thayer</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="seriesInfo">RFC 2440</span>, <span class="seriesInfo">DOI 10.17487/RFC2440</span>, <time datetime="1998-11" class="refDate">November 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2440">https://www.rfc-editor.org/info/rfc2440</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4880">[RFC4880]</dt>
        <dd>
<span class="refAuthor">Callas, J.</span>, <span class="refAuthor">Donnerhacke, L.</span>, <span class="refAuthor">Finney, H.</span>, <span class="refAuthor">Shaw, D.</span>, and <span class="refAuthor">R. Thayer</span>, <span class="refTitle">"OpenPGP Message Format"</span>, <span class="seriesInfo">RFC 4880</span>, <span class="seriesInfo">DOI 10.17487/RFC4880</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4880">https://www.rfc-editor.org/info/rfc4880</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6090">[RFC6090]</dt>
        <dd>
<span class="refAuthor">McGrew, D.</span>, <span class="refAuthor">Igoe, K.</span>, and <span class="refAuthor">M. Salter</span>, <span class="refTitle">"Fundamental Elliptic Curve Cryptography Algorithms"</span>, <span class="seriesInfo">RFC 6090</span>, <span class="seriesInfo">DOI 10.17487/RFC6090</span>, <time datetime="2011-02" class="refDate">February 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6090">https://www.rfc-editor.org/info/rfc6090</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SEC1">[SEC1]</dt>
        <dd>
<span class="refAuthor">Standards for Efficient Cryptography Group</span>, <span class="refTitle">"SEC 1: Elliptic Curve Cryptography"</span>, <time datetime="2000-09" class="refDate">September 2000</time>. </dd>
<dd class="break"></dd>
<dt id="SP800-57">[SP800-57]</dt>
      <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Recommendation on Key Management"</span>, <span class="seriesInfo">NIST Special Publication 800-57</span>, <time datetime="2007-03" class="refDate">March 2007</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/nistpubs/800-57/SP800-57-Part%7B1,2%7D.pdf">http://csrc.nist.gov/publications/nistpubs/800-57/SP800-57-Part{1,2}.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="test-vectors">
<section id="appendix-A">
      <h2 id="name-test-vectors">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-test-vectors" class="section-name selfRef">Test vectors</a>
      </h2>
<p id="appendix-A-1">To help implementing this specification a non-normative example for the EdDSA algorithm is given.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="sample-eddsa-key">
<section id="appendix-A.1">
        <h3 id="name-sample-eddsa-key">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-sample-eddsa-key" class="section-name selfRef">Sample EdDSA key</a>
        </h3>
<p id="appendix-A.1-1">The secret key used for this example is:<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">D: 1a8b1ff05ded48e18bf50166c664ab023ea70003d78d9e41f5758a91d850f8d2<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<p id="appendix-A.1-3">Note that this is the raw secret key used as input to the EdDSA signing operation.
The key was created on 2014-08-19 14:28:27 and thus the fingerprint of the OpenPGP key is:<a href="#appendix-A.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-4">
<pre>
   C959 BDBA FA32 A2F8 9A15  3B67 8CFD E121 9796 5A9A
</pre><a href="#appendix-A.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.1-5">The algorithm specific input parameters without the MPI length headers are:<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
<p id="appendix-A.1-6">oid: 2b06010401da470f01<a href="#appendix-A.1-6" class="pilcrow">¶</a></p>
<p id="appendix-A.1-7">q: 403f098994bdd916ed4053197934e4a87c80733a1280d62f8010992e43ee3b2406<a href="#appendix-A.1-7" class="pilcrow">¶</a></p>
<p id="appendix-A.1-8">The entire public key packet is thus:<a href="#appendix-A.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.1-9">
<pre>
   98 33 04 53 f3 5f 0b 16  09 2b 06 01 04 01 da 47
   0f 01 01 07 40 3f 09 89  94 bd d9 16 ed 40 53 19
   79 34 e4 a8 7c 80 73 3a  12 80 d6 2f 80 10 99 2e
   43 ee 3b 24 06
</pre><a href="#appendix-A.1-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sample-eddsa-signature">
<section id="appendix-A.2">
        <h3 id="name-sample-eddsa-signature">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-sample-eddsa-signature" class="section-name selfRef">Sample EdDSA signature</a>
        </h3>
<p id="appendix-A.2-1">The signature is created using the sample key over the input data "OpenPGP" on 2015-09-16 12:24:53 and thus the input to the hash function is:<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">m: 4f70656e504750040016080006050255f95f9504ff0000000c<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<p id="appendix-A.2-3">Using the SHA2-256 hash algorithm yields the digest:<a href="#appendix-A.2-3" class="pilcrow">¶</a></p>
<p id="appendix-A.2-4">d: f6220a3f757814f4c2176ffbb68b00249cd4ccdc059c4b34ad871f30b1740280<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
<p id="appendix-A.2-5">Which is fed into the EdDSA signature function and yields this signature:<a href="#appendix-A.2-5" class="pilcrow">¶</a></p>
<p id="appendix-A.2-6">r: 56f90cca98e2102637bd983fdb16c131dfd27ed82bf4dde5606e0d756aed3366<a href="#appendix-A.2-6" class="pilcrow">¶</a></p>
<p id="appendix-A.2-7">s: d09c4fa11527f038e0f57f2201d82f2ea2c9033265fa6ceb489e854bae61b404<a href="#appendix-A.2-7" class="pilcrow">¶</a></p>
<p id="appendix-A.2-8">The entire signature packet is thus:<a href="#appendix-A.2-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.2-9">
<pre>
   88 5e 04 00 16 08 00 06  05 02 55 f9 5f 95 00 0a
   09 10 8c fd e1 21 97 96  5a 9a f6 22 01 00 56 f9
   0c ca 98 e2 10 26 37 bd  98 3f db 16 c1 31 df d2
   7e d8 2b f4 dd e5 60 6e  0d 75 6a ed 33 66 01 00
   d0 9c 4f a1 15 27 f0 38  e0 f5 7f 22 01 d8 2f 2e
   a2 c9 03 32 65 fa 6c eb  48 9e 85 4b ae 61 b4 04
</pre><a href="#appendix-A.2-9" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sample-aead-eax-encryption-and-decryption">
<section id="appendix-A.3">
        <h3 id="name-sample-aead-eax-encryption-">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-sample-aead-eax-encryption-" class="section-name selfRef">Sample AEAD-EAX encryption and decryption</a>
        </h3>
<p id="appendix-A.3-1">Encryption is performed with the string <code>Hello, world!</code>, using AES-128 with AEAD-EAX encryption.<a href="#appendix-A.3-1" class="pilcrow">¶</a></p>
<div id="sample-parameters">
<section id="appendix-A.3.1">
          <h4 id="name-sample-parameters">
<a href="#appendix-A.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-sample-parameters" class="section-name selfRef">Sample Parameters</a>
          </h4>
<p id="appendix-A.3.1-1">S2K:<a href="#appendix-A.3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.1-2">
<pre>
  type 3
</pre><a href="#appendix-A.3.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.1-3">Iterations:<a href="#appendix-A.3.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.1-4">
<pre>
  524288 (144), SHA2-256
</pre><a href="#appendix-A.3.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.1-5">Salt:<a href="#appendix-A.3.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.1-6">
<pre>
  cd5a9f70fbe0bc65
</pre><a href="#appendix-A.3.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sample-symmetric-key-encrypted-session-key-packet-v5">
<section id="appendix-A.3.2">
          <h4 id="name-sample-symmetric-key-encryp">
<a href="#appendix-A.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-sample-symmetric-key-encryp" class="section-name selfRef">Sample symmetric-key encrypted session key packet (v5)</a>
          </h4>
<p id="appendix-A.3.2-1">Packet header:<a href="#appendix-A.3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.2-2">
<pre>
  c3 3e
</pre><a href="#appendix-A.3.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.2-3">Version, algorithms, S2K fields:<a href="#appendix-A.3.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.2-4">
<pre>
  05 07 01 03 08 cd 5a 9f 70 fb e0 bc 65 90
</pre><a href="#appendix-A.3.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.2-5">AEAD IV:<a href="#appendix-A.3.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.2-6">
<pre>
  bc 66 9e 34 e5 00 dc ae dc 5b 32 aa 2d ab 02 35
</pre><a href="#appendix-A.3.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.2-7">AEAD encrypted CEK:<a href="#appendix-A.3.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.2-8">
<pre>
  9d ee 19 d0 7c 34 46 c4 31 2a 34 ae 19 67 a2 fb
</pre><a href="#appendix-A.3.2-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.2-9">Authentication tag:<a href="#appendix-A.3.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.2-10">
<pre>
  7e 92 8e a5 b4 fa 80 12 bd 45 6d 17 38 c6 3c 36
</pre><a href="#appendix-A.3.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="starting-aead-eax-decryption-of-cek">
<section id="appendix-A.3.3">
          <h4 id="name-starting-aead-eax-decryptio">
<a href="#appendix-A.3.3" class="section-number selfRef">A.3.3. </a><a href="#name-starting-aead-eax-decryptio" class="section-name selfRef">Starting AEAD-EAX decryption of CEK</a>
          </h4>
<p id="appendix-A.3.3-1">The derived key is:<a href="#appendix-A.3.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.3-2">
<pre>
  b2 55 69 b9 54 32 45 66 45 27 c4 97 6e 7a 5d 6e
</pre><a href="#appendix-A.3.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.3-3">Authenticated Data:<a href="#appendix-A.3.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.3-4">
<pre>
  c3 05 07 01
</pre><a href="#appendix-A.3.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.3-5">Nonce:<a href="#appendix-A.3.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.3-6">
<pre>
  bc 66 9e 34 e5 00 dc ae dc 5b 32 aa 2d ab 02 35
</pre><a href="#appendix-A.3.3-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.3-7">Decrypted CEK:<a href="#appendix-A.3.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.3-8">
<pre>
  86 f1 ef b8 69 52 32 9f 24 ac d3 bf d0 e5 34 6d
</pre><a href="#appendix-A.3.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="initial-content-encryption-key">
<section id="appendix-A.3.4">
          <h4 id="name-initial-content-encryption-">
<a href="#appendix-A.3.4" class="section-number selfRef">A.3.4. </a><a href="#name-initial-content-encryption-" class="section-name selfRef">Initial Content Encryption Key</a>
          </h4>
<p id="appendix-A.3.4-1">This key would typically be extracted from an SKESK or PKESK.
In this example, it is extracted from an SKESK packet, as described above.<a href="#appendix-A.3.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3.4-2">CEK:<a href="#appendix-A.3.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.4-3">
<pre>
  86 f1 ef b8 69 52 32 9f 24 ac d3 bf d0 e5 34 6d
</pre><a href="#appendix-A.3.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sample-aead-encrypted-data-packet">
<section id="appendix-A.3.5">
          <h4 id="name-sample-aead-encrypted-data-">
<a href="#appendix-A.3.5" class="section-number selfRef">A.3.5. </a><a href="#name-sample-aead-encrypted-data-" class="section-name selfRef">Sample AEAD encrypted data packet</a>
          </h4>
<p id="appendix-A.3.5-1">Packet header:<a href="#appendix-A.3.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.5-2">
<pre>
  d4 4a
</pre><a href="#appendix-A.3.5-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.5-3">Version, AES-128, EAX, Chunk bits (14):<a href="#appendix-A.3.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.5-4">
<pre>
  01 07 01 0e
</pre><a href="#appendix-A.3.5-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.5-5">IV:<a href="#appendix-A.3.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.5-6">
<pre>
  b7 32 37 9f 73 c4 92 8d e2 5f ac fe 65 17 ec 10
</pre><a href="#appendix-A.3.5-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.5-7">AEAD-EAX Encrypted data chunk #0:<a href="#appendix-A.3.5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.5-8">
<pre>
  5d c1 1a 81 dc 0c b8 a2 f6 f3 d9 00 16 38 4a 56
  fc 82 1a e1 1a e8
</pre><a href="#appendix-A.3.5-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.5-9">Chunk #0 authentication tag:<a href="#appendix-A.3.5-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.5-10">
<pre>
  db cb 49 86 26 55 de a8 8d 06 a8 14 86 80 1b 0f
</pre><a href="#appendix-A.3.5-10" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.5-11">Final (zero-size chunk #1) authentication tag:<a href="#appendix-A.3.5-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.5-12">
<pre>
  f3 87 bd 2e ab 01 3d e1 25 95 86 90 6e ab 24 76
</pre><a href="#appendix-A.3.5-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="decryption-of-data">
<section id="appendix-A.3.6">
          <h4 id="name-decryption-of-data">
<a href="#appendix-A.3.6" class="section-number selfRef">A.3.6. </a><a href="#name-decryption-of-data" class="section-name selfRef">Decryption of data</a>
          </h4>
<p id="appendix-A.3.6-1">Starting AEAD-EAX decryption of data, using the CEK.<a href="#appendix-A.3.6-1" class="pilcrow">¶</a></p>
<p id="appendix-A.3.6-2">Chunk #0:<a href="#appendix-A.3.6-2" class="pilcrow">¶</a></p>
<p id="appendix-A.3.6-3">Authenticated data:<a href="#appendix-A.3.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.6-4">
<pre>
  d4 01 07 01 0e 00 00 00 00 00 00 00 00
</pre><a href="#appendix-A.3.6-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.6-5">Nonce:<a href="#appendix-A.3.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.6-6">
<pre>
  b7 32 37 9f 73 c4 92 8d e2 5f ac fe 65 17 ec 10
</pre><a href="#appendix-A.3.6-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.6-7">Decrypted chunk #0.<a href="#appendix-A.3.6-7" class="pilcrow">¶</a></p>
<p id="appendix-A.3.6-8">Literal data packet with the string contents <code>Hello, world!\n</code>.<a href="#appendix-A.3.6-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.6-9">
<pre>
  cb 14 62 00 00 00 00 00  48 65 6c 6c 6f 2c 20 77
  6f 72 6c 64 21 0a
</pre><a href="#appendix-A.3.6-9" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.6-10">Authenticating final tag:<a href="#appendix-A.3.6-10" class="pilcrow">¶</a></p>
<p id="appendix-A.3.6-11">Authenticated data:<a href="#appendix-A.3.6-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.6-12">
<pre>
  d4 01 07 01 0e 00 00 00  00 00 00 00 01 00 00 00
  00 00 00 00 16
</pre><a href="#appendix-A.3.6-12" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.6-13">Nonce:<a href="#appendix-A.3.6-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.6-14">
<pre>
  b7 32 37 9f 73 c4 92 8d e2 5f ac fe 65 17 ec 11
</pre><a href="#appendix-A.3.6-14" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="complete-aead-eax-encrypted-packet-sequence">
<section id="appendix-A.3.7">
          <h4 id="name-complete-aead-eax-encrypted">
<a href="#appendix-A.3.7" class="section-number selfRef">A.3.7. </a><a href="#name-complete-aead-eax-encrypted" class="section-name selfRef">Complete AEAD-EAX encrypted packet sequence</a>
          </h4>
<p id="appendix-A.3.7-1">Symmetric-key encrypted session key packet (v5):<a href="#appendix-A.3.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.7-2">
<pre>
   c3 3e 05 07 01 03 08 cd  5a 9f 70 fb e0 bc 65 90
   bc 66 9e 34 e5 00 dc ae  dc 5b 32 aa 2d ab 02 35
   9d ee 19 d0 7c 34 46 c4  31 2a 34 ae 19 67 a2 fb
   7e 92 8e a5 b4 fa 80 12  bd 45 6d 17 38 c6 3c 36
</pre><a href="#appendix-A.3.7-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.3.7-3">AEAD encrypted data packet:<a href="#appendix-A.3.7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.3.7-4">
<pre>
   d4 4a 01 07 01 0e b7 32  37 9f 73 c4 92 8d e2 5f
   ac fe 65 17 ec 10 5d c1  1a 81 dc 0c b8 a2 f6 f3
   d9 00 16 38 4a 56 fc 82  1a e1 1a e8 db cb 49 86
   26 55 de a8 8d 06 a8 14  86 80 1b 0f f3 87 bd 2e
   ab 01 3d e1 25 95 86 90  6e ab 24 76
</pre><a href="#appendix-A.3.7-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sample-aead-ocb-encryption-and-decryption">
<section id="appendix-A.4">
        <h3 id="name-sample-aead-ocb-encryption-">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-sample-aead-ocb-encryption-" class="section-name selfRef">Sample AEAD-OCB encryption and decryption</a>
        </h3>
<p id="appendix-A.4-1">Encryption is performed with the string <code>Hello, world!</code> using AES-128 with AEAD-OCB encryption.<a href="#appendix-A.4-1" class="pilcrow">¶</a></p>
<div id="sample-parameters-1">
<section id="appendix-A.4.1">
          <h4 id="name-sample-parameters-2">
<a href="#appendix-A.4.1" class="section-number selfRef">A.4.1. </a><a href="#name-sample-parameters-2" class="section-name selfRef">Sample Parameters</a>
          </h4>
<p id="appendix-A.4.1-1">S2K:<a href="#appendix-A.4.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.1-2">
<pre>
  type 3
</pre><a href="#appendix-A.4.1-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.1-3">Iterations:<a href="#appendix-A.4.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.1-4">
<pre>
  524288 (144), SHA2-256
</pre><a href="#appendix-A.4.1-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.1-5">Salt:<a href="#appendix-A.4.1-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.1-6">
<pre>
  9f0b7da3e5ea6477
</pre><a href="#appendix-A.4.1-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sample-symmetric-key-encrypted-session-key-packet-v5-1">
<section id="appendix-A.4.2">
          <h4 id="name-sample-symmetric-key-encrypt">
<a href="#appendix-A.4.2" class="section-number selfRef">A.4.2. </a><a href="#name-sample-symmetric-key-encrypt" class="section-name selfRef">Sample symmetric-key encrypted session key packet (v5)</a>
          </h4>
<p id="appendix-A.4.2-1">Packet header:<a href="#appendix-A.4.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.2-2">
<pre>
  c3 3d
</pre><a href="#appendix-A.4.2-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.2-3">Version, algorithms, S2K fields:<a href="#appendix-A.4.2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.2-4">
<pre>
  05 07 02 03 08 9f 0b 7d a3 e5 ea 64 77 90
</pre><a href="#appendix-A.4.2-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.2-5">AEAD IV:<a href="#appendix-A.4.2-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.2-6">
<pre>
  99 e3 26 e5 40 0a 90 93 6c ef b4 e8 eb a0 8c
</pre><a href="#appendix-A.4.2-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.2-7">AEAD encrypted CEK:<a href="#appendix-A.4.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.2-8">
<pre>
  67 73 71 6d 1f 27 14 54 0a  38 fc ac 52 99 49 da
</pre><a href="#appendix-A.4.2-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.2-9">Authentication tag:<a href="#appendix-A.4.2-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.2-10">
<pre>
  c5 29 d3 de 31 e1 5b 4a eb  72 9e 33 00 33 db ed
</pre><a href="#appendix-A.4.2-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="starting-aead-ocb-decryption-of-cek">
<section id="appendix-A.4.3">
          <h4 id="name-starting-aead-ocb-decryptio">
<a href="#appendix-A.4.3" class="section-number selfRef">A.4.3. </a><a href="#name-starting-aead-ocb-decryptio" class="section-name selfRef">Starting AEAD-OCB decryption of CEK</a>
          </h4>
<p id="appendix-A.4.3-1">The derived key is:<a href="#appendix-A.4.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.3-2">
<pre>
  eb 9d a7 8a 9d 5d f8 0e c7 02 05 96 39 9b 65 08
</pre><a href="#appendix-A.4.3-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.3-3">Authenticated Data:<a href="#appendix-A.4.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.3-4">
<pre>
  c3 05 07 02
</pre><a href="#appendix-A.4.3-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.3-5">Nonce:<a href="#appendix-A.4.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.3-6">
<pre>
  99 e3 26 e5 40 0a 90 93 6c ef b4 e8 eb a0 8c
</pre><a href="#appendix-A.4.3-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.3-7">Decrypted CEK:<a href="#appendix-A.4.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.3-8">
<pre>
  d1 f0 1b a3 0e 13 0a a7 d2 58 2c 16 e0 50 ae 44
</pre><a href="#appendix-A.4.3-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="initial-content-encryption-key-1">
<section id="appendix-A.4.4">
          <h4 id="name-initial-content-encryption-k">
<a href="#appendix-A.4.4" class="section-number selfRef">A.4.4. </a><a href="#name-initial-content-encryption-k" class="section-name selfRef">Initial Content Encryption Key</a>
          </h4>
<p id="appendix-A.4.4-1">This key would typically be extracted from an SKESK or PKESK.
In this example, it is extracted from an SKESK packet, as described above.<a href="#appendix-A.4.4-1" class="pilcrow">¶</a></p>
<p id="appendix-A.4.4-2">Decrypted CEK:<a href="#appendix-A.4.4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.4-3">
<pre>
  d1 f0 1b a3 0e 13 0a a7 d2 58 2c 16 e0 50 ae 44
</pre><a href="#appendix-A.4.4-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sample-aead-encrypted-data-packet-1">
<section id="appendix-A.4.5">
          <h4 id="name-sample-aead-encrypted-data-p">
<a href="#appendix-A.4.5" class="section-number selfRef">A.4.5. </a><a href="#name-sample-aead-encrypted-data-p" class="section-name selfRef">Sample AEAD encrypted data packet</a>
          </h4>
<p id="appendix-A.4.5-1">Packet header:<a href="#appendix-A.4.5-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.5-2">
<pre>
  d4 49
</pre><a href="#appendix-A.4.5-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.5-3">Version, AES-128, OCB, Chunk bits (14):<a href="#appendix-A.4.5-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.5-4">
<pre>
  01 07 02 0e
</pre><a href="#appendix-A.4.5-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.5-5">IV:<a href="#appendix-A.4.5-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.5-6">
<pre>
  5e d2 bc 1e 47 0a be 8f 1d 64 4c 7a 6c 8a 56
</pre><a href="#appendix-A.4.5-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.5-7">AEAD-OCB Encrypted data chunk #0:<a href="#appendix-A.4.5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.5-8">
<pre>
  7b 0f 77 01 19 66 11 a1  54 ba 9c 25 74 cd 05 62
  84 a8 ef 68 03 5c
</pre><a href="#appendix-A.4.5-8" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.5-9">Chunk #0 authentication tag:<a href="#appendix-A.4.5-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.5-10">
<pre>
  62 3d 93 cc 70 8a 43 21 1b b6 ea f2 b2 7f 7c 18
</pre><a href="#appendix-A.4.5-10" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.5-11">Final (zero-size chunk #1) authentication tag:<a href="#appendix-A.4.5-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.5-12">
<pre>
  d5 71 bc d8 3b 20 ad d3 a0 8b 73 af 15 b9 a0 98
</pre><a href="#appendix-A.4.5-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="decryption-of-data-1">
<section id="appendix-A.4.6">
          <h4 id="name-decryption-of-data-2">
<a href="#appendix-A.4.6" class="section-number selfRef">A.4.6. </a><a href="#name-decryption-of-data-2" class="section-name selfRef">Decryption of data</a>
          </h4>
<p id="appendix-A.4.6-1">Starting AEAD-OCB decryption of data, using the CEK.<a href="#appendix-A.4.6-1" class="pilcrow">¶</a></p>
<p id="appendix-A.4.6-2">Chunk #0:<a href="#appendix-A.4.6-2" class="pilcrow">¶</a></p>
<p id="appendix-A.4.6-3">Authenticated data:<a href="#appendix-A.4.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.6-4">
<pre>
  d4 01 07 02 0e 00 00 00 00 00 00 00 00
</pre><a href="#appendix-A.4.6-4" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.6-5">Nonce:<a href="#appendix-A.4.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.6-6">
<pre>
  5e d2 bc 1e 47 0a be 8f 1d 64 4c 7a 6c 8a 56
</pre><a href="#appendix-A.4.6-6" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.6-7">Decrypted chunk #0.<a href="#appendix-A.4.6-7" class="pilcrow">¶</a></p>
<p id="appendix-A.4.6-8">Literal data packet with the string contents <code>Hello, world!\n</code>.<a href="#appendix-A.4.6-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.6-9">
<pre>
  cb 14 62 00 00 00 00 00  48 65 6c 6c 6f 2c 20 77
  6f 72 6c 64 21 0a
</pre><a href="#appendix-A.4.6-9" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.6-10">Authenticating final tag:<a href="#appendix-A.4.6-10" class="pilcrow">¶</a></p>
<p id="appendix-A.4.6-11">Authenticated data:<a href="#appendix-A.4.6-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.6-12">
<pre>
  d4 01 07 02 0e 00 00 00 00 00 00 00 01 00 00 00
  00 00 00 00 16
</pre><a href="#appendix-A.4.6-12" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.6-13">Nonce:<a href="#appendix-A.4.6-13" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.6-14">
<pre>
  5e d2 bc 1e 47 0a be 8f 1d 64 4c 7a 6c 8a 57
</pre><a href="#appendix-A.4.6-14" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="complete-aead-ocb-encrypted-packet-sequence">
<section id="appendix-A.4.7">
          <h4 id="name-complete-aead-ocb-encrypted">
<a href="#appendix-A.4.7" class="section-number selfRef">A.4.7. </a><a href="#name-complete-aead-ocb-encrypted" class="section-name selfRef">Complete AEAD-OCB encrypted packet sequence</a>
          </h4>
<p id="appendix-A.4.7-1">Symmetric-key encrypted session key packet (v5):<a href="#appendix-A.4.7-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.7-2">
<pre>
  c3 3d 05 07 02 03 08 9f  0b 7d a3 e5 ea 64 77 90
  99 e3 26 e5 40 0a 90 93  6c ef b4 e8 eb a0 8c 67
  73 71 6d 1f 27 14 54 0a  38 fc ac 52 99 49 da c5
  29 d3 de 31 e1 5b 4a eb  72 9e 33 00 33 db ed
</pre><a href="#appendix-A.4.7-2" class="pilcrow">¶</a>
</div>
<p id="appendix-A.4.7-3">AEAD encrypted data packet:<a href="#appendix-A.4.7-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-A.4.7-4">
<pre>
  d4 49 01 07 02 0e 5e d2  bc 1e 47 0a be 8f 1d 64
  4c 7a 6c 8a 56 7b 0f 77  01 19 66 11 a1 54 ba 9c
  25 74 cd 05 62 84 a8 ef  68 03 5c 62 3d 93 cc 70
  8a 43 21 1b b6 ea f2 b2  7f 7c 18 d5 71 bc d8 3b
  20 ad d3 a0 8b 73 af 15  b9 a0 98
</pre><a href="#appendix-A.4.7-4" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="acknowledgements">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">This memo also draws on much previous work from a number of other authors, including: Derek Atkins, Charles Breed, Dave Del Torto, Marc Dyksterhouse, Gail Haspert, Gene Hoffman, Paul Hoffman, Ben Laurie, Raph Levien, Colin Plumb, Will Price, David Shaw, William Stallings, Mark Weaver, and Philip R. Zimmermann.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="document-workflow">
<section id="appendix-C">
      <h2 id="name-document-workflow">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-document-workflow" class="section-name selfRef">Document Workflow</a>
      </h2>
<p id="appendix-C-1">This document is built from markdown using <a href="https://rubygems.org/gems/kramdown-rfc2629">ruby-kramdown-rfc2629</a>, and tracked using <a href="https://git-scm.com/">git</a>.
The markdown source under development can be found in the file <code>crypto-refresh.md</code> in the <code>main</code> branch of the <a href="https://gitlab.com/openpgp-wg/rfc4880bis">git repository</a>.
Discussion of this document should take place on the <a href="https://www.ietf.org/mailman/listinfo/openpgp">openpgp@ietf.org mailing list</a>.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">A non-substantive editorial nit can be submitted directly as a <a href="https://gitlab.com/openpgp-wg/rfc4880bis/-/merge_requests/new">merge request</a>.
A substantive proposed edit may also be submitted as a merge request, but should simultaneously be sent to the mailing list for discussion.<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">An open problem can be recorded and tracked as <a href="https://gitlab.com/openpgp-wg/rfc4880bis/-/issues">an issue</a> in the gitlab issue tracker, but discussion of the issue should take place on the mailing list.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<p id="appendix-C-4">[Note to RFC-Editor: Please remove this section on publication.]<a href="#appendix-C-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Werner Koch (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">GnuPG e.V.</span></div>
<div dir="auto" class="left"><span class="street-address">Rochusstr. 44</span></div>
<div dir="auto" class="left">
<span class="postal-code">40479</span> <span class="locality">Duesseldorf</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wk@gnupg.org" class="email">wk@gnupg.org</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://gnupg.org/verein" class="url">https://gnupg.org/verein</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Paul Wouters (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">Aiven</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:paul.wouters@aiven.io" class="email">paul.wouters@aiven.io</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
