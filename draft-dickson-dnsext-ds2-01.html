<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DNSSEC Delegation Signature with Canonical Signer Name</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DNSSEC Delegation Signature with Canonical Signer Name">
<meta name="keywords" content="DNSSEC">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">dnsext</td><td class="header">B. Dickson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Brian Dickson</td></tr>
<tr><td class="header">Expires: May 13, 2011</td><td class="header">November 9, 2010</td></tr>
</table></td></tr></table>
<h1><br />DNSSEC Delegation Signature with Canonical Signer Name<br />draft-dickson-dnsext-ds2-01</h1>

<h3>Abstract</h3>

<p>
      The Domain Name System Security (DNSSEC) Extensions introduced the
   DS resource record (RR) for authentication of zone delegations.
   This document introduces an alternative resource record, DS2, which
   similarly provides authentication of zone delegations.  However, DS2
   provides a canonical signer name, for zones whose content may be duplicated
   with multiple owner names. The zone is signed by the canonical signer,
   and the DS2 record allows for validation using this signer name.

</p>
<h3>Author's Note</h3>

<p>
      Intended Status: Proposed Standard.
    
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on May 13, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Rationale<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Terminology<br />
<a href="#anchor5">2.</a>&nbsp;
Backward Compatibility<br />
<a href="#anchor6">3.</a>&nbsp;
The DS2 Resource Record<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.</a>&nbsp;
RDATA Fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.1.1.</a>&nbsp;
The Canonical Signer Name Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.1.2.</a>&nbsp;
The Key Tag Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.1.3.</a>&nbsp;
The Algorithm Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.1.4.</a>&nbsp;
The Digest Type Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.1.5.</a>&nbsp;
The Digest Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.2.</a>&nbsp;
DS2 RDATA Wire Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.3.</a>&nbsp;
Presentation Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.4.</a>&nbsp;
DS2 RR Example<br />
<a href="#anchor16">4.</a>&nbsp;
Authoritative Server Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.1.</a>&nbsp;
Delegated (Child) Zones Beneath DS2-signed Zone Cuts<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.1.1.</a>&nbsp;
Zone Signing<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.1.2.</a>&nbsp;
Dynamic Update<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.2.</a>&nbsp;
Parent Zone at Zone Cut<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.2.1.</a>&nbsp;
Zone Serving<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.2.2.</a>&nbsp;
Referrals to Signed Zones<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.2.3.</a>&nbsp;
Responding to Queries for DS2 RRs<br />
<a href="#anchor24">5.</a>&nbsp;
Validator Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">5.1.</a>&nbsp;
DS responses without NSEC/NSEC3<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">5.2.</a>&nbsp;
NSEC/NSEC3 RRs with DS2 type bit set<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">5.3.</a>&nbsp;
DS2 Signed Delegated Zones<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">5.3.1.</a>&nbsp;
RRSIG Validation Using Canonical Signer Name<br />
<a href="#anchor29">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor30">7.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor31">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#anchor34">Appendix&nbsp;A.</a>&nbsp;
Constructs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">A.1.</a>&nbsp;
Elements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">A.1.1.</a>&nbsp;
Zone Master File<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">A.1.2.</a>&nbsp;
Zone Delegation (Zone Cut)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">A.1.3.</a>&nbsp;
$ORIGIN<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">A.1.4.</a>&nbsp;
$INCLUDE<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">A.2.</a>&nbsp;
Basic Constructs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">A.2.1.</a>&nbsp;
Zone Cut as a Replacement for a CNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">A.2.2.</a>&nbsp;
Zone Cut as a Replacement for a DNAME<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">A.2.3.</a>&nbsp;
Identical Zones with Non-Identical Child Zones<br />
<a href="#anchor44">Appendix&nbsp;B.</a>&nbsp;
Construction Examples, Unsigned<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">B.1.</a>&nbsp;
Objective, In Lay Terms<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">B.2.</a>&nbsp;
Building a Set of 'same' Zones<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">B.3.</a>&nbsp;
Building a Two-Deep Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor48">B.3.1.</a>&nbsp;
First Level Zone File<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor49">B.3.2.</a>&nbsp;
Server Conf for First Level Zones<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor50">B.3.3.</a>&nbsp;
Server Conf for Second Level Zones<br />
<a href="#anchor51">Appendix&nbsp;C.</a>&nbsp;
Construction Examples, Signed<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor52">C.1.</a>&nbsp;
Signed Single Level Zones<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor53">C.1.1.</a>&nbsp;
Create the Single Level Zone<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor54">C.1.2.</a>&nbsp;
Sign the zone<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor55">C.1.3.</a>&nbsp;
De-canonicalize the zone<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor56">C.1.4.</a>&nbsp;
Add DS2 Records to Parent Zones<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor57">C.2.</a>&nbsp;
Signed Two Level Zones<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor58">C.2.1.</a>&nbsp;
Create the Child Zone<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor59">C.2.2.</a>&nbsp;
Sign the child zone<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor60">C.2.3.</a>&nbsp;
De-canonicalize the child zone<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor61">C.2.4.</a>&nbsp;
Create the Canonical First-Level Zone And Add DS2 Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor62">C.2.5.</a>&nbsp;
Sign the first-level zone<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor63">C.2.6.</a>&nbsp;
De-canonicalize the first-level zone<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor64">C.2.7.</a>&nbsp;
Add DS2 Records to Parent Zones<br />
<a href="#anchor65">Appendix&nbsp;D.</a>&nbsp;
Use Cases<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor66">D.1.</a>&nbsp;
All the same<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor67">D.2.</a>&nbsp;
Two (ore more) levels of sameness<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor68">D.3.</a>&nbsp;
Groupings of sameness with additional singletons, beneath identical zones<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor69">D.4.</a>&nbsp;
All different below one or more levels of all the same<br />
<a href="#anchor70">Appendix&nbsp;E.</a>&nbsp;
Signed Zone Examples<br />
<a href="#anchor71">Appendix&nbsp;F.</a>&nbsp;
Example Responses<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Rationale</h3>

<p>
   The DNS Security Extensions included the DS RR to provide
   authenticated zone delegations.  Though the DS RR meets the
   requirements for authentication of delegations, it introduces a
   side-effect in that otherwise identical zones with different
   owner names produce non-identical cryptographic signatures.
   Such zones must be signed repeatedly, using each unique owner name.
     This
   property introduces undesired scaling effects.
<br />
<br />

The existence of Internationalized Domain Names (IDNs) creates the need for "equivalent" zones,
whose content is identical, but whose owner name differs. Among the sources of this need,
are the existence of many-to-one mappings of symbol to canonical meaning, analogous to the
two-to-one mapping of upper/lower to lowercase in ASCII.
<br />
<br />

When the many-to-one mapping occurs once per label, the inflated number of zones is not unreasonable.
However, there is no such limitation on per-label instances, nor on the number of labels having this characteristic, in IDNs.
The desire or need for multiple names for identical zones is not limited to IDNs; in particular, identical names under multiple TLDs is another use case.
<br />
<br />

The cost to cryptographically secure multiple identical
   zones is high, relative to the perceived
   security benefit, in certain cases: identical zones known by very many names, large zones, and
   zones where zone data will be updated rapidly, and any combination thereof.  In these
   cases, the costs of maintaining the multitude of RRSIGs may be extremely
   high and use of the "re-usable" RRSIGs for duplicated zone content may be more appropriate.

<br />
<br />

   This document presents the DS2 Resource Record which can be used as
   an alternative, or even adjunct, to the DS RR to mitigate these issues.

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Requirements</h3>

<p>
The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
      NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",  "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in
      <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Terminology</h3>

<p>
The reader is assumed to be familiar with the basic DNS and DNSSEC
   concepts described in [RFC1034], [RFC1035], [RFC4033], [RFC4034],
   [RFC4035], and subsequent RFCs that update them: [RFC2136],
   [RFC2181], and [RFC2308].
<br />
<br />

   The following terminology is used throughout this document:
<br />
<br />

Delegation:  an NS RRSet with a name different from the current zone
      apex, signifying a delegation to a child zone.
<br />
<br />

Secure delegation:  a name containing a delegation (NS RRSet) and a
      signed DS RRSet, signifying a delegation to a signed child zone.
<br />
<br />

Insecure delegation:  a name containing a delegation (NS RRSet), but
      lacking a DS RRSet, signifying a delegation to an unsigned child
      zone.

</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Backward Compatibility</h3>

<p>
   This specification describes a protocol change that is partially
   backwards compatible with 
   <a class='info' href='#RFC4033'>RFC 4033<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4033]
   [RFC4033]
   , 
   <a class='info' href='#RFC4034'>RFC 4034<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4034]
   [RFC4034]
   , and 
   <a class='info' href='#RFC4035'>RFC 4035<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Protocol Modifications for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4035]
   [RFC4035]
   .  In
   particular, security-aware resolvers that are unaware of this
   specification (DS2-unaware resolvers) may not validate the
   responses introduced by this document. Zones delegations signed
   with DS2 only, will be interpreted as "Insecure" by DS2-unaware resolvers.
   
   <br />
<br />

   Security-unaware resolvers are unaffected by this specification.

</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
The DS2 Resource Record</h3>

<p>
The DS2 Resource Record (RR) is very similar to the DS RR
<a class='info' href='#RFC4034'>RFC 4034<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4034]
   [RFC4034]
. The main distinction is that the DS2 RR includes an explicit Canonical Signer Name, as opposed to the implicit signer name of the DS RR.
<br />
<br />

The Canonical Signer Name is used in the validation process, for both the corresponding DNSKEY RR, and for validation of RRSIG RRs in the delegated zone.
<br />
<br />

The delegated zone is the product of signing a version of the zone, where the owner and signer of the zone, and parent of all RRs in the zone, is the Canonical Signer Name.
<br />
<br />

The remainder of the DS2 RR is the same as that of the DS RR, where the DS RR was produced using the Canonical Signer Name as the owner name (and signer name) of the DNSKEY RR .
<br />
<br />

Note that the DS RR with an owner of the Canonical Signer Name MAY exist, but does not need to exist.
<br />
<br />

Note also that DS and DS2 records may coexist. This is likely to occur in a zone which was itself delegated via a DS2, i.e. for which multiple, differently-named copies of the zone exist.
<br />
<br />

   The type number for the DS2 record is {TBD}.
<br />
<br />

   The DS2 resource record is class independent.
<br />
<br />

   The DS2 RR has no special TTL requirements.

</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
RDATA Fields</h3>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
The Canonical Signer Name Field</h3>

<p>
The Canonical Signer Name field identifies the name to be used as the Signer when performing validation on the delegated zone.
<br />
<br />

The Canonical Signer Name is also used in validating the DNSKEY which corresponds to the DS2 record in the zone apex of the delegated zone.
<br />
<br />

This is detailed below.

</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
The Key Tag Field</h3>

<p>
   The Key Tag field lists the key tag of the DNSKEY RR referred to by
   the DS record, in network byte order.
<br />
<br />

   The Key Tag used by the DS RR is identical to the Key Tag used by
   RRSIG RRs.  Appendix B describes how to compute a Key Tag.

</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.3"></a><h3>3.1.3.&nbsp;
The Algorithm Field</h3>

<p>
   The Algorithm field lists the algorithm number of the DNSKEY RR
   referred to by the DS record.
<br />
<br />

   The algorithm number used by the DS RR is identical to the algorithm
   number used by RRSIG and DNSKEY RRs.  Appendix A.1 lists the
   algorithm number types.

</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.4"></a><h3>3.1.4.&nbsp;
The Digest Type Field</h3>

<p>
   The DS RR refers to a DNSKEY RR by including a digest of that DNSKEY
   RR.  The Digest Type field identifies the algorithm used to construct
   the digest.  Appendix A.2 lists the possible digest algorithm types.

</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.5"></a><h3>3.1.5.&nbsp;
The Digest Field</h3>

<p>
   The DS record refers to a DNSKEY RR by including a digest of that
   DNSKEY RR.
<br />
<br />

   The digest is calculated by concatenating the canonical form of the
   fully qualified owner name of the DNSKEY RR with the DNSKEY RDATA,
   and then applying the digest algorithm.
<br />
<br />

     digest = digest_algorithm( DNSKEY owner name | DNSKEY RDATA);
<br />
<br />

      "|" denotes concatenation
<br />
<br />

     DNSKEY RDATA = Flags | Protocol | Algorithm | Public Key.
<br />
<br />

   The size of the digest may vary depending on the digest algorithm and
   DNSKEY RR size.  As of the time of this writing, the only defined
   digest algorithm is SHA-1, which produces a 20 octet digest.

</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
DS2 RDATA Wire Format</h3>

<p>
    The RDATA for a DS RR consists of a Canonical Signer Name (domain name), a 2 octet Key Tag field, a 1 octet
   Algorithm field, a 1 octet Digest Type field, and a Digest field.
<br />
<br />

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                        1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2 2 2 3 3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                   Canonical Signer Name                       /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Key Tag             |  Algorithm    |  Digest Type  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   /                                                               /
   /                            Digest                             /
   /                                                               /
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div><p>


</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Presentation Format</h3>

<p>
   The presentation format of the RDATA portion is as follows:
<br />
<br />

  The Canonical Signer Name field is represented as a domain name.
<br />
<br />

   The Key Tag field MUST be represented as an unsigned decimal integer.
<br />
<br />

   The Algorithm field MUST be represented either as an unsigned decimal
   integer or as an algorithm mnemonic specified in Appendix A.1.
<br />
<br />

   The Digest Type field MUST be represented as an unsigned decimal
   integer.
<br />
<br />

   The Digest MUST be represented as a sequence of case-insensitive
   hexadecimal digits.  Whitespace is allowed within the hexadecimal
   text.

</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
DS2 RR Example</h3>

<p>
   The following example shows a DNSKEY RR and its corresponding DS2 RR.
   <br />
<br />

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
dskey.example.com. 86400 IN DNSKEY 256 3 5 ( AQOeiiR0GOMYkDshWoSKz
                                          9XzfwJr1AYtsmx3TGkJaNXVb
                                          fi/2pHm822aJ5iI9BMzNXxeY
                                          CmZDRD99WYwYqUSdjMmmAphX
                                          dvxegXd/M5+X7OrzKBaMbCVd
                                          FLUUh6DhweJBjEVv5f2wwjM9
                                          XzcnOf+EPbtG9DMBmADjFDc2
                                          w/rljwvFw==
                                          ) ;  key id = 60485

dskey.example.com. 86400 IN DS2 dskey.example.com. 60485 5 1 ( 2BB183
                                          AF5F22588179A53B0A98631FAD
                                          1A292118 )
</pre></div><p>

   The first four text fields specify the name, TTL, Class, and RR type
   (DS2). The name "dskey.example.com." is the Canonical Signer Name,
   which in this case is the same as the owner name. Value 60485 is the key tag for the corresponding
   "dskey.example.com." DNSKEY RR, and value 5 denotes the algorithm
   used by this "dskey.example.com." DNSKEY RR.  The value 1 is the
   algorithm used to construct the digest, and the rest of the RDATA
   text is the digest in hexadecimal.


</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Authoritative Server Considerations</h3>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Delegated (Child) Zones Beneath DS2-signed Zone Cuts</h3>

<p>
The DS2 signature is designed to permit zones signed by another Signer Name, to be authenticated.
<br />
<br />

While the motivation for this is enabling duplicated zone content under different owner names, this is not a requirement.
<br />
<br />

Child zones are always unique from the perspective of resolvers. All delegations are normal delegations. It is only the delegation signatures (DS or DS2) that get special treatment.
<br />
<br />

The Canonical Signer Name (CSN) is ONLY to be used for signature validation. No relationship between zones sharing CSNs is implied or should be inferred.
<br />
<br />

In particular, the "strong linking" of child zones (on the authority server(s)) is not required. Even if two child zones started off identical, they would be permitted to subsequently diverge, regardless of SOA Serial Numbers.

</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Zone Signing</h3>

<p>
The Child zone below a DS2-signed zone cut, are signed as follows:
</p>
<blockquote class="text">
<p>The rightmost portion of the owner name matching the zone name, is replaced with the Canonical Signer Name.
</p>
<p>The Signer Name used is the Canonical Signer Name.
</p>
<p>The RRsets are signed with the above changes, but otherwise as usual.
</p>
</blockquote><p>
<br />
<br />

The normal usage of DS2, is that a "canonical" version of a zone, with owner name of the Canonical Signer Name, is signed normally per RFC 4035.
Then, the entire zone, including signatures, is used verbatim, except for changing the rightmost portion of the owner names.
<br />
<br />

This "copy" of the zone exists for the purpose of having the same zone known by multiple names, e.g. aliasing, such as for IDN usage.
The DS2 ensures that the delegation is secure, and that the existing signatures validate properly.
<br />
<br />

Copying the zone is not the only means by which such a zone may be created or used.

</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Dynamic Update</h3>

<p>
In addition to the existing issues for Dynamic Updates for DNSSEC-signed zones, a new problem is introduced by this specification.
<br />
<br />

When a dynamic update needs to be applied to a DS2-signed delegated zone, might incorrectly be presumed that it needs to be applied to all "copies" of the zone.
<br />
<br />

The correct behaviour is specified by the Dynamic Update specification, RFC 2181. Only the Primary Master Server is able to know, and respond appropriately, if zones are in fact "copies".
<br />
<br />

The specific mechanism by which this occurs is beyond the scope of this document.
<br />
<br />

However, implementors intending to enable "copies", are encouraged to consider methods which do not duplicate data, but rather maintain a single instance of the zone data. This methodology implies that dynamic updates to the zone, by any of its names, result in the zone being updated for all names by which the zone is known.

</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Parent Zone at Zone Cut</h3>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Zone Serving</h3>

<p>
This specification modifies DNSSEC-enabled DNS responses generated by authoritative servers. In particular, when a signed delegation is returned, whether it includes a DS, DS2, or both, it is also necessary to return the corresponding NSEC/NSEC3 record showing the covered RR types.

</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Referrals to Signed Zones</h3>

<p>
At a zone cut, it is possible for both DS and DS2 RRs to exist for the same owner name.
The new rule applies in all circumstances, whether only DS, only DS2, or both, exist to sign the delegation.
<br />
<br />

The rule is: always return the corresponding NSEC/NSEC3 record matching the owner (or owner hash).
<br />
<br />

The reason for this is, that receiving validator will need to know which RR types are expected, in the answer.
<br />
<br />

A DS2-unaware receiving validator will need the NSEC/NSEC3 in particular, if a DS2 RR exists but no DS RR exists. In that case, the zone will validate as "Insecure", since no DS exists and has been proven by the NSEC/NSEC RR (and its RRSIG).

</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Responding to Queries for DS2 RRs</h3>

<p>
This is the same circumstance as section 3.1.4.1 of RFC 4034, "Responding to Queries for DS RRs". The same rules as DS RRs, apply to DS2 RRs.

</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Validator Considerations</h3>

<p>
In RFC 5155, the Validator Considerations referencing DS, must be presumed to now read "DS or DS2" (or in the negative sense, "neither DS nor DS2").
<br />
<br />

Validators MUST use the original Owner Name for any necessary queries for DS, DS2, DNSKEY, and RRSIG resource records. This is because there is no explicit or implicit relationship between the Canonical Signer Name, and a zone whose name corresponds to the Canonical Signer Name (which might not even exist).

</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
DS responses without NSEC/NSEC3</h3>

<p>
If a response is received which includes a DS RR, but does not include the corresponding NSEC/NSEC3 RR, the validator MUST attempt to retrieve the NSEC/NSEC RR, and subsequently attempt to retrieve the corresponding DS2 record if the DS2 type bit is set in the NSEC/NSEC3 type bit map.
<br />
<br />

Intermediate caches or middleboxes may not be DS2-aware, and may not include DS2 records when QTYPE is not DS2. If the middlebox is DS2-unaware, the middleboxes SHOULD still allow responses for exact matches to unknown types, such as DS2.

</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
NSEC/NSEC3 RRs with DS2 type bit set</h3>

<p>
If a DS2-aware validator receives a response with an NSEC/NSEC3 RR with the DS2 type bit set, but had not also received the DS2 RR, the validator MUST attempt to retrieve the DS2 RRset.
<br />
<br />

An intermediate cache or middlebox may have filtered out, or not cached, the DS2 RR. Explicit querying for the DS2 RR may return the missing DS2 RR.

</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
DS2 Signed Delegated Zones</h3>

<p>
Zones whose delegation is signed by a DS2 RR, and which DS2 RR successfully validates, MUST be validated using the Canonical Signer Name (or Names, if multiple DS/DS2 RRs are present).
<br />
<br />

More specifically, RRSIG RRs in the delegated zone, MUST be validated with Canonical Signer Names (CSN) whose DS2 RR is itself validated.
For purposes of this process, every DS RR can be treated as a DS2 RR with the Canonical Signer Name of the DS2 RR's owner name, and MUST be included in the set of CSNs.

</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
RRSIG Validation Using Canonical Signer Name</h3>

<p>
The procedure for validating an RRSIG is modified as follows:
</p>
<blockquote class="text">
<p>The RRSIG Signer Name MUST match the Canonical Signer Name. No comparison is made between the Owner Name and either the Canonical Signer Name or the Signer Name of the RRSIG.
</p>
<p>The number of labels in the RRset Owner name, minus the numer of labels in the Zone Name, plus the number of labels in the Canonical Signer Name, MUST be greater than
      or equal to the value in the RRSIG RR's Labels field.
</p>
<p>The RRSIG RR's Algorithm, and Key Tag fields MUST
      match the algorithm, and key tag for some DNSKEY RR in
      the zone's apex DNSKEY RRset.
</p>
</blockquote><p>

</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
Further work on DS/DS2 security issues may be necessary. In particular, it is unclear whether the implicit signalling of use of NSEC/NSEC3 may be vulnerable to downgrade attacks.

</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>
   This document updates the IANA registry "DOMAIN NAME SYSTEM
   PARAMETERS" (http://www.iana.org/assignments/dns-parameters) in sub-
   registry "TYPES", by defining one new type.  Section 3 defines the
   DS2 RR type {TBD}.

</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>
The problems related to aliasing, as discussed on the DNSEXT WG mailing list, provided helpful direction in limiting what changes could or should be made to DNS, and DNSSEC in particular.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1033">[RFC1033]</a></td>
<td class="author-text">Lottor, M., &ldquo;<a href="http://tools.ietf.org/html/rfc1033">Domain administrators operations guide</a>,&rdquo; RFC&nbsp;1033, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1035">[RFC1035]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1035, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2136">[RFC2136]</a></td>
<td class="author-text"><a href="mailto:paul@vix.com">Vixie, P.</a>, <a href="mailto:set@thumper.bellcore.com">Thomson, S.</a>, <a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, and <a href="mailto:bound@zk3.dec.com">J. Bound</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2136">Dynamic Updates in the Domain Name System (DNS UPDATE)</a>,&rdquo; RFC&nbsp;2136, April&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2136.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2136.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2136.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2181">[RFC2181]</a></td>
<td class="author-text"><a href="mailto:kre@munnari.OZ.AU">Elz, R.</a> and <a href="mailto:randy@psg.com">R. Bush</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2181">Clarifications to the DNS Specification</a>,&rdquo; RFC&nbsp;2181, July&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2181.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2181.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2181.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2308">[RFC2308]</a></td>
<td class="author-text"><a href="mailto:Mark.Andrews@cmis.csiro.au">Andrews, M.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2308">Negative Caching of DNS Queries (DNS NCACHE)</a>,&rdquo; RFC&nbsp;2308, March&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2308.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2308.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2308.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4034">[RFC4034]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4034, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4035">[RFC4035]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4035">Protocol Modifications for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4035, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4035.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5155">[RFC5155]</a></td>
<td class="author-text">Laurie, B., Sisson, G., Arends, R., and D. Blacka, &ldquo;<a href="http://tools.ietf.org/html/rfc5155">DNS Security (DNSSEC) Hashed Authenticated Denial of Existence</a>,&rdquo; RFC&nbsp;5155, March&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5155.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Constructs</h3>

<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Elements</h3>

<p>
    The following DNS elements are used in the constructs discussed here.
    
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.1"></a><h3>A.1.1.&nbsp;
Zone Master File</h3>

<p>
    The term "zone master file" has the meaning established in RFC 1035. It is the file containing all the resource records and directives for the zone.
    
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.2"></a><h3>A.1.2.&nbsp;
Zone Delegation (Zone Cut)</h3>

<p>
    The terms "zone delegation" and "zone cut" may generally be used interchangeably.
    <br />
<br />

    A zone delegation is the act of putting in NS records in a zone at a place other than the apex.
    <br />
<br />

    The zone delegation is the parent side of a zone cut.
    <br />
<br />

    A zone cut creates a new zone. The apex of the new zone has the same owner name as the zone delegation.
    
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.3"></a><h3>A.1.3.&nbsp;
$ORIGIN</h3>

<p>
    Most DNS authority servers include the ability to directly refer to a zone master file, with an implied $ORIGIN. For those, no $ORIGIN needs to be used.
    <br />
<br />

    For completeness, zone master files with explicit $ORIGIN are also used in examples. This is in keeping with RFC 1035.
    
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.4"></a><h3>A.1.4.&nbsp;
$INCLUDE</h3>

<p>
    In the instances where $ORIGIN use is needed, it is also necessary to include common content via the $INCLUDE directive. This is also RFC 1035 compliant.
    
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Basic Constructs</h3>

<p>
    The following examples show ways to replace CNAME/DNAME usage with other existing DNS items. Rationale for usage, and differences from CNAME/DNAME are explained for each.
    
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1"></a><h3>A.2.1.&nbsp;
Zone Cut as a Replacement for a CNAME</h3>

<p>
    The following example shows a simple CNAME, where the CNAME target (for convenience) is a sibling of the CNAME itself.
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    zone file for example.com:

    $ORIGIN example.com.
    @        SOA ns1.example.com. postmaster (
                       42 7200 600 3600000 60 )
         NS ns1.example.com
    alias  CNAME real.example.com
    real   TXT "This is real data, maintained in a single location."
</pre></div><p>

    <br />
<br />

    Querying for type TXT at alias.example.com, will return the CNAME RR plus the TXT RR for real.example.com (the CNAME target).
    <br />
<br />

    The following example shows the use of a zone cut, and the inclusion of data from a single location, as an alternative.
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    zone file for example.com:

    $ORIGIN example.com.
    @        SOA ns1.example.com. postmaster (
                       42 7200 600 3600000 60 )
         NS ns1.example.com
    alias NS ns1.example.com ; all zones are served by ns1
    real  NS ns1.example.com ; normally there are multiple NS's

    server configuration (with implicit $ORIGIN of zone.name):
    zone alias.example.com { master; file="czone-data.example.com";};
    zone real.example.com { master; file="czone-data.example.com";};
</pre></div><p>

<br />
<br />
<br />

    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Or, server configuration (without implicit $ORIGIN):
    zone alias.example.com { master; file="alias.example.com";};
    zone real.example.com { master; file="real.example.com";};

    zone file for alias.example.com:

    $ORIGIN alias.example.com.
    $INCLUDE "czone-data.example.com"

    zone file for real.example.com:

    $ORIGIN real.example.com.
    $INCLUDE "czone-data.example.com"

    file czone-data.example.com:

@         SOA ns1.example.com. postmaster ( 42 7200 600 3600000 60 )
          NS ns1.example.com
          TXT "This is real data, maintained in a single location."
</pre></div><p>

    <br />
<br />

    Querying for the TXT record for either alias.example.com, or real.example.com, requires first following the delegation, and then gets a response which does not include any CNAME.
    <br />
<br />

    The main difference here is, that the DNS node "alias.example.com" is a real, first-class entry, which can be used interchangeably with "real.example.com". E.g., it can be used as an MX target.
    <br />
<br />

    The other important difference is, as the data is all authoritative and self-contained, it is not possible to have a broken CNAME. If the necessary linkage is incorrect, the zone file will not load.
    <br />
<br />

    This means that maintaining aliased data in this way, returns values in a consistent manner, in a deterministic path and timeframe. Data kept this way can be validated, via zone loading and zone checking functions included with most modern DNS authority servers.
    
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.2"></a><h3>A.2.2.&nbsp;
Zone Cut as a Replacement for a DNAME</h3>

<p>
    The following example shows a simple DNAME, where the DNAME target (for convenience) is a sibling of the DNAME itself.
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    zone file for example.com:

    $ORIGIN example.com.
    @        SOA ns1.example.com. postmaster (
                       42 7200 600 3600000 60 )
         NS ns1.example.com
    alias  DNAME real.example.com
    content.real   TXT "This is real data, kept only here."
</pre></div><p>

    <br />
<br />

    Querying for type TXT at alias.example.com, will return the CNAME RR plus the TXT RR for real.example.com (the CNAME target).
    <br />
<br />

    The following example shows the use of a zone cut, and the inclusion of data from a single location, as an alternative.
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    zone file for example.com:

    $ORIGIN example.com.
    @        SOA ns1.example.com. postmaster (
                       42 7200 600 3600000 60 )
         NS ns1.example.com
    alias NS ns1.example.com ; all zones are served by ns1
    real  NS ns1.example.com ; normally there are multiple NS's

    server configuration (with implicit $ORIGIN of zone.name):
    zone alias.example.com { master; file="dzone.example.com";};
    zone real.example.com { master; file="dzone.example.com";};

    Or, server configuration (without implicit $ORIGIN):
    zone alias.example.com { master; file="alias.example.com";};
    zone real.example.com { master; file="real.example.com";};

    zone file for alias.example.com:

    $ORIGIN alias.example.com.
    $INCLUDE "dzone.example.com"

    zone file for real.example.com:

    $ORIGIN real.example.com.
    $INCLUDE "dzone.example.com"

    file dzone.example.com:

@        SOA ns1.example.com. postmaster ( 42 7200 600 3600000 60 )
         NS ns1.example.com
content  TXT "This is real data, maintained in a single location."
</pre></div><p>

    <br />
<br />

    Querying for the TXT record for either content.alias.example.com, or content.real.example.com, requires first following the delegation, and then gets a response which does not include any DNAME or synthesized CNAME.
    <br />
<br />

    The main difference here is, that the DNS node "content.alias.example.com" is a real, first-class entry, which can be used interchangeably with "content.real.example.com". E.g., it can be used as an MX target.
    <br />
<br />

    The other important difference is, as the data is all authoritative and self-contained, it is not possible to have a broken DNAME. If the necessary linkage is incorrect, the zone file will not load.
    <br />
<br />

    This means that maintaining aliased data in this way, returns values in a consistent manner, in a deterministic path and timeframe. Data kept this way can be validated, via zone loading and zone checking functions included with most modern DNS authority servers.
    
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.3"></a><h3>A.2.3.&nbsp;
Identical Zones with Non-Identical Child Zones</h3>

<p>
    This example demonstrates identical zones, where there are child zones (of all identical parents) whose content differ. The owner name of the child zones, relative to the parent apex name, is identical.
    <br />
<br />

    Note Well: The following example is not possible with CNAME or DNAME usage.
    <br />
<br />

    The query re-writing that occurs in CNAME/DNAME obscures zone cuts as a distinction for any portion of the DNS tree below the CNAME/DNAME.
  </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    zone file for example.com:

    $ORIGIN example.com.
    @        SOA ns1.example.com. postmaster (
                       42 7200 600 3600000 60 )
         NS ns1.example.com
    alias NS ns1.example.com ; all zones are served by NS1
    real  NS ns1.example.com ; normally there are multiple NS's

    server configuration (with implicit $ORIGIN of zone.name):
    zone alias.example.com {
      master; file="has-a-child.example.com";};
    zone real.example.com {
      master; file="has-a-child.example.com";};
    zone child.alias.example.com {
      master; file="child.alias.example.com";};
    zone child.real.example.com {
      master; file="child.real.example.com";};

    (Non-implicit $ORIGIN may be used, similar to previous examples.)

    file has-a-child.example.com:

@        SOA ns1.example.com. postmaster (
                       42 7200 600 3600000 60 )
         NS ns1.example.com
content  TXT "identical"
; this zone cut exists in all aliased zones
child    NS ns1.example.com

    file child.alias.example.com:

@        SOA ns1.example.com. postmaster (
                       42 7200 600 3600000 60 )
         NS ns1.example.com
         TXT "divergent"

    file child.real.example.com:

@        SOA ns1.example.com. postmaster (
                       42 7200 600 3600000 60 )
         NS ns1.example.com
         TXT "unique"
</pre></div><p>

    <br />
<br />

    TXT Queries for content.alias.example.com and content.real.example.com, both return "identical" results.
    <br />
<br />

    TXT Queries for child.alias.example.com, and child.real.example.com, return "divergent" and "unique" results respectively, which come from their respective zones.
    <br />
<br />

    If real.example.com were a very large zone, with very few members whose values needed to differ from alias.example.com, this mechanism would be quite useful for maintaining the data.
    
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Construction Examples, Unsigned</h3>

<p>
    The following examples show how to construct a hierarchy of zones, with all zones at a given depth being identical.
    <br />
<br />

    The zones are unsigned, and can be implemented using existing DNS elements. No DS2 is required.
    
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.1"></a><h3>B.1.&nbsp;
Objective, In Lay Terms</h3>

<p>
    In these example, we are using the constructs available, to build DNS zones with specific characteristics.
    <br />
<br />

    What we want, is for all the zones (under consideration) to be "the same".
    <br />
<br />

    What we mean by "the same" is  that:
    </p>
<blockquote class="text">
<p>
    Every node in any zone, is in every zone;
    
</p>
<p>
    Every combination of class and type, at each node, exists at that node in all the zones;
    
</p>
<p>
    The value of each tuple (name,class,type) in each zone is identical.
    
</p>
</blockquote><p>
    <br />
<br />

    In addition, whenever we use zone names (or placeholders for names), like Ai.Bj, we mean all combinations of the members of set {A} and the set {B}, combined, as {A}.{B}.
    The members of set {A} are A1, A2, A3, etc., and the members of set {B} are B1, B2, B3., etc.
    The letters "i" and "j" simply indicate that there is no relationship between the number of members in sets {A} and {B}.
    <br />
<br />

    Additionally, A1, A2, etc., are placeholder names for what might be actual names. For instance, A1 could be "foo.example.com.", and A2 could be "bar.example.net."
    
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.2"></a><h3>B.2.&nbsp;
Building a Set of 'same' Zones</h3>

<p>
    First, we need the zone content that will be used to populate the zones. Let's say we have a single existing zone, that we want to turn into a set of 'same' zones.
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone file for "myzone.example.com.", the file myzone.zone:

    myzone.example.com.   SOA ns1.example.com postmaster (
                  42 7200 600 3600000 60 )
                  NS ns1.example.com
    mytext.myzone.example.com.        TXT "Example Text"
    mymailer.myzone.example.com.      A 127.0.0.1
    www.myzone.example.com.           A 127.0.0.2
    radius.myzone.example.com.        A 127.0.0.3
</pre></div><p>

    <br />
<br />

    First we de-canonicalize the labels within the zone:
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone file for "myzone.example.com.", the file myzone.zone:

    myzone.example.com.   SOA ns1.example.com postmaster (
                  42 7200 600 3600000 60 )
                  NS ns1.example.com
    mytext        TXT "Example Text"
    mymailer      A 127.0.0.1
    www           A 127.0.0.2
    radius        A 127.0.0.3
</pre></div><p>

    <br />
<br />

    Then we turn the zone name itself into a reference to the $ORIGIN, which itself will be supplied when the zone is loaded:
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone file  for "myzone.example.com.", the file myzone.zone:

    @   SOA ns1.example.com postmaster (
                  42 7200 600 3600000 60 )
                  NS ns1.example.com
    mytext        TXT "Example Text"
    mymailer      A 127.0.0.1
    www           A 127.0.0.2
    radius        A 127.0.0.3
</pre></div><p>

    <br />
<br />

    Finally, we modify the configuation file to use this file for both myzone.example.com., and any other zones we want to have be the same:
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Configuration file (named.conf, for BIND) elements needed
    for myzone.example.com and additional zones:

    zone "myzone.example.com."{master; file="myzone.zone";};
    zone "myzone.example.net."{master; file="myzone.zone";};
    zone "other.example.org."{master; file="myzone.zone";};
</pre></div><p>

    <br />
<br />

    Each time a zone file is loaded, it does so with an implicit $ORIGIN of the zone name. This causes all the zones that have @ as the zone name (SOA owner) to be identical, if they are read from the same file.
    
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3"></a><h3>B.3.&nbsp;
Building a Two-Deep Example</h3>

<p>
    For this example, we will build several zones with the same content, by re-using the same file. For this example, we will save some steps by using the same zone file as before, 'mysone.zone'.
    <br />
<br />

    Since the zones will be two deep, we need another set of zones above those, i.e. one deep, who exist only to contain the two-deep zones.
    <br />
<br />

    In DNS parlance, these would, if inside a single zone, be considered "empty non-terminals".
    However, they are not inside a single zone, but rather are delegation-only zones.
    The "real" data is in their children, and the parent zones contain no other data besides that needed for the delegations (i.e. NS records and possibly glue records).
    
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3.1"></a><h3>B.3.1.&nbsp;
First Level Zone File</h3>

<p>
    This is a "thin" zone file, containing only the labels by which the second level zones are to be known.
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone file for first level zones, "first-level.zone":

    @   SOA ns1.example.com postmaster (
            42 7200 600 3600000 60 )
         NS ns1.example.com
    red    NS ns1.example.com
    green  NS ns1.example.com
    blue   NS ns1.example.com
</pre></div><p>

    
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3.2"></a><h3>B.3.2.&nbsp;
Server Conf for First Level Zones</h3>

<p>
    This establishes the parent names for the first level zones, from which the delegations to the second level occur:
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone conf file elements for the first level zones:

    zone "myzone.example.com."{master; file="first-level.zone";};
    zone "myzone.example.net."{master; file="first-level.zone";};
    zone "other.example.org."{master; file="first-level.zone";};
</pre></div><p>

    
</p>
<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B.3.3"></a><h3>B.3.3.&nbsp;
Server Conf for Second Level Zones</h3>

<p>
    This establishes the fully qualified zone names for the second level zones, in all permutations and combinations:
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone conf file elements for the first level zones:

    zone "red.myzone.example.com."{master; file="myzone.zone";};
    zone "red.myzone.example.net."{master; file="myzone.zone";};
    zone "red.other.example.org."{master; file="myzone.zone";};
    zone "green.myzone.example.com."{master; file="myzone.zone";};
    zone "green.myzone.example.net."{master; file="myzone.zone";};
    zone "green.other.example.org."{master; file="myzone.zone";};
    zone "blue.myzone.example.com."{master; file="myzone.zone";};
    zone "blue.myzone.example.net."{master; file="myzone.zone";};
    zone "blue.other.example.org."{master; file="myzone.zone";};
</pre></div><p>

    <br />
<br />

    While this requires setting up all the zones, there is only one zone file to maintain, and all the zones inherit the common contents.
    
</p>
<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Construction Examples, Signed</h3>

<p>
    The following examples are exactly the same as the examples above, except that they are signed.
    <br />
<br />

    The zone files are identical, and require the use of DS2 signatures.
    
</p>
<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1"></a><h3>C.1.&nbsp;
Signed Single Level Zones</h3>

<p>The procedure here is:
    </p>
<blockquote class="text">
<p>Create the first-instance zone, fully qualified.
    
</p>
<p>Sign the zone, and capture the DS record.
    
</p>
<p>De-canonicalize the zone file, and use the DS as a basis for the DS2 records.
    
</p>
</blockquote><p>
    The DS2 records will need to be signed by their respective parent zones. The signatures are omitted for clarity.
    
</p>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.1"></a><h3>C.1.1.&nbsp;
Create the Single Level Zone</h3>

<p>
    We need to use the Canonical Signer Name for the zone name.
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone file for "myzone.example.com.", the file myzone.zone:

    myzone.example.com.   SOA ns1.example.com postmaster (
                  42 7200 600 3600000 60 )
                  NS ns1.example.com
    mytext.myzone.example.com.        TXT "Example Text"
    mymailer.myzone.example.com.      A 127.0.0.1
    www.myzone.example.com.           A 127.0.0.2
    radius.myzone.example.com.        A 127.0.0.3
</pre></div><p>

    
</p>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.2"></a><h3>C.1.2.&nbsp;
Sign the zone</h3>

<p>
    
</p>
<a name="anchor55"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.3"></a><h3>C.1.3.&nbsp;
De-canonicalize the zone</h3>

<p>
    
</p>
<a name="anchor56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1.4"></a><h3>C.1.4.&nbsp;
Add DS2 Records to Parent Zones</h3>

<p>
    
</p>
<a name="anchor57"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2"></a><h3>C.2.&nbsp;
Signed Two Level Zones</h3>

<p>The procedure here is:
    </p>
<blockquote class="text">
<p>Create the first-instance child zone, fully qualified.
    
</p>
<p>Sign the child zone, and capture the DS record.
    
</p>
<p>De-canonicalize the child zone file, and use the DS as a basis for the DS2 records on the child delegations.
    
</p>
<p>Create the first-instance parent zone, fully qualified, and include the DS2 records.
    
</p>
<p>Sign the parent zone, and capture the DS record.
    
</p>
<p>De-canonicalize the parent zone file, and use the DS as a basis for the DS2 records in the parent zones.
    
</p>
</blockquote><p>
    The parents' DS2 records will need to be signed by their respective parent zones. Those signatures are omitted for clarity.
    
</p>
<a name="anchor58"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.1"></a><h3>C.2.1.&nbsp;
Create the Child Zone</h3>

<p>
    We need to use the Canonical Signer Name for the zone name.
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone file for "red.myzone.example.com.", the file myzone.zone:

    red.myzone.example.com.   SOA ns1.example.com postmaster (
                  42 7200 600 3600000 60 )
                  NS ns1.example.com
    mytext.red.myzone.example.com.        TXT "Example Text"
    mymailer.red.myzone.example.com.      A 127.0.0.1
    www.red.myzone.example.com.           A 127.0.0.2
    radius.red.myzone.example.com.        A 127.0.0.3
</pre></div><p>

    
</p>
<a name="anchor59"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.2"></a><h3>C.2.2.&nbsp;
Sign the child zone</h3>

<p>
    
</p>
<a name="anchor60"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.3"></a><h3>C.2.3.&nbsp;
De-canonicalize the child zone</h3>

<p>
    
</p>
<a name="anchor61"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.4"></a><h3>C.2.4.&nbsp;
Create the Canonical First-Level Zone And Add DS2 Records</h3>

<p>
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone file for "myzone.example.com.", "first-level.zone":

    myzone.example.com.   SOA ns1.example.com postmaster (
            42 7200 600 3600000 60 )
         NS ns1.example.com
    red.myzone.example.com.    NS ns1.example.com
                      DS2 red.myzone.example.com. (
    ; rest of DS record contents go here
                      )
    green.myzone.example.com.  NS ns1.example.com
                      DS2 red.myzone.example.com. (
    ; rest of DS record contents go here
                      )
    blue.myzone.example.com.   NS ns1.example.com
                      DS2 red.myzone.example.com. (
    ; rest of DS record contents go here
                      )
</pre></div><p>

    
</p>
<a name="anchor62"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.5"></a><h3>C.2.5.&nbsp;
Sign the first-level zone</h3>

<p>
    
</p>
<a name="anchor63"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.6"></a><h3>C.2.6.&nbsp;
De-canonicalize the first-level zone</h3>

<p>
    
</p>
<a name="anchor64"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2.7"></a><h3>C.2.7.&nbsp;
Add DS2 Records to Parent Zones</h3>

<p>
    
</p>
<a name="anchor65"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D"></a><h3>Appendix D.&nbsp;
Use Cases</h3>

<a name="anchor66"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.1"></a><h3>D.1.&nbsp;
All the same</h3>

<p>
    Use Case: identical zone content, where zones have more than one name.
    <br />
<br />

    Example:
    <br />
<br />

    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    colors.example.com
    colours.example.com
</pre></div><p>


    
</p>
<a name="anchor67"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.2"></a><h3>D.2.&nbsp;
Two (ore more) levels of sameness</h3>

<p>
    Use Case: identical zone content, where the zones owner names contain two or more labels with equivalent labels (synonyms/homonyms/IDNs).
    <br />
<br />

    Example:
    <br />
<br />

    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    colours.iso-with-accents.example.com
    colors.iso-with-accents.example.com
    colours.iso-without-accents.example.com
    colors.iso-without-accents.example.com
    colours.ascii.example.com
    colors.ascii.example.com
</pre></div><p>

    
</p>
<a name="anchor68"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.3"></a><h3>D.3.&nbsp;
Groupings of sameness with additional singletons, beneath identical zones</h3>

<p>
    Use Case: Clusters of content where the content of each cluster is identical, beneath zones which are identical.
    <br />
<br />

    Example: Language-specific content, grouped by country, underneath aliases for some company's zones.
    <br />
<br />

    [NB - Better examples of sameness and singletons are needed - same name, different content]
    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Zone Name                           CSN
    ---------                           ---
    (Parents)
    big-company.example.com             big-company.example.com
    trade-mark.example.com              big-company.example.com
    product-name.example.com            big-company.example.com

    (Children)
    en.big-company.example.com          en.big-company.example.com
    en.trade-mark.example.com...      ..en.big-company.example.com
    en.product-name.example.com.       .en.big-company.example.com
    canada-en.big-company.example.com   en.big-company.example.com
    usa.big-company.example.com         en.big-company.example.com
    uk.big-company.example.com          en.big-company.example.com
    fr.big-company.example.com          fr.big-company.example.com
    canada-fr.big-company.example.com   fr.big-company.example.com
    france.big-company.example.com      fr.big-company.example.com
    sw.big-company.example.com          sw.big-company.example.com
    (etc)

    (Grandchildren)
    secure-server.en.big-company.example.com
    secure-server.en.trade-mark.example.com
    (etc...)
    [Delegations are made to unique zones when unique values for
     arbitrary-depth labels are required.]
    [E.g. for SSL certificates, unique IP addresses, and such.]
</pre></div><p>

    In the above table, each of the delegations to the children is signed by the CSN.
    <br />
<br />

    Each zone uses a master zone file corresponding to the CSN on a 1:1 basis.
    <br />
<br />

    If two zones have the same CSN, they are loaded from the same master zone file.
    
</p>
<a name="anchor69"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.D.4"></a><h3>D.4.&nbsp;
All different below one or more levels of all the same</h3>

<p>
    Use Case: Two large zones, whose content is identical except for one node in the zone.
    <br />
<br />

    Use Case detail: The "exception" node is isolated via a zone cut, and all the grandchildren zones are unique.
    <br />
<br />

    The children zones are identical, and signed once with delegations signed by DS2 RRs.
    The grandchildren zones are unique, signed by their respective owner names.
    The delegations from the (identical) parents of the grandchildren, require multiple DS RRs, one for each grandchild's signature.
    <br />
<br />

    Note Well: The grandchildren in this case, MUST be served by the same set of nameservers, since the NS records at the zone cut are identical.
    <br />
<br />

    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    bigzone.iso-with-accents.example.com
    bigzone.ascii.example.com
    unique-node.bigzone.iso-with-accents.example.com
    unique-node.bigzone.ascii.example.com
</pre></div><p>

    
</p>
<a name="anchor70"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.E"></a><h3>Appendix E.&nbsp;
Signed Zone Examples</h3>

<a name="anchor71"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.F"></a><h3>Appendix F.&nbsp;
Example Responses</h3>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Dickson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Dickson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">6261 Lawrence St,</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Halifax, NS  B3L 1J8</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:brian.peter.dickson@gmail.com">brian.peter.dickson@gmail.com</a></td></tr>
</table>
</body></html>
