pkR = Deserialize(ECHConfig.public_key)
ech_hrr_key = context.Export("tls ech hrr key", 32)
payload = context.Seal(ClientHelloOuterAAD,
                              EncodedClientHelloInner)

pkR = Deserialize(ECHConfig.public_key)
context = SetupPSKR(ClientECH.enc, skR,
           "tls ech" || 0x00 || ECHConfig, ech_hrr_key, "hrr key")
EncodedClientHelloInner = context.Open(ClientHelloOuterAAD,
                                              ClientECH.payload)

context = SetupBaseR(ClientECH.enc, skR,
                            "tls ech" || 0x00 || ECHConfig)
EncodedClientHelloInner = context.Open(ClientHelloOuterAAD,
                                              ClientECH.payload)
ech_hrr_key = context.Export("tls ech hrr key", 32)
accept_confirmation = HKDF-Expand-Label(
           HKDF-Extract(0, ClientHelloInner.random),
           "ech accept confirmation",
           ServerHello.random[0:24], 8)

