pass = false
pass = true
W = max(W', 0) + TL
LPT = t_a
