<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>ASN.1 Translation</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="ASN.1 Translation">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">C. Wallace</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cygnacom Solutions</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">C. Gardiner</td></tr>
<tr><td class="header">Expires: May 20, 2010</td><td class="header">BBN Technologies</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 16, 2009</td></tr>
</table></td></tr></table>
<h1><br />ASN.1 Translation<br />draft-ietf-pkix-asn1-translation-01</h1>

<h3>Abstract</h3>

<p>
        Abstract Syntax Notation One (ASN.1) is widely used throughout the IETF security area and has been for many years.  Some specifications were written using a now deprecated version of ASN.1 and some were written using the current version of ASN.1.  Not all ASN.1 compilers support both older and current syntax.  This document is intended to provide guidance to specification authors and to implementers converting ASN.1 modules written using one version of ASN.1 to another version without causing changes to the "bits on the wire".  This document does not provide a comprehensive tutorial of any version of ASN.1.  Instead, it addresses ASN.1 features that are used in IETF security area specifications with focus on items that vary with the ASN.1 version.  
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 20, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
<a href="#anchor3">2.</a>&nbsp;
ASN.1 design elements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.1.</a>&nbsp;
Open types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.1.1.</a>&nbsp;
ANY DEFINED BY<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.1.2.</a>&nbsp;
OCTET STRINGs and BIT STRINGs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.1.3.</a>&nbsp;
Information Object Classes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.2.</a>&nbsp;
Constraints<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.2.1.</a>&nbsp;
Simple table constraints<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.2.2.</a>&nbsp;
Component relation constraints<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">2.2.3.</a>&nbsp;
Content constraints<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">2.3.</a>&nbsp;
Parameterization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">2.4.</a>&nbsp;
Versioning and Extensibility<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">2.4.1.</a>&nbsp;
Extension markers<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">2.4.2.</a>&nbsp;
Version brackets<br />
<a href="#anchor16">3.</a>&nbsp;
Character set differences<br />
<a href="#anchor17">4.</a>&nbsp;
ASN.1 translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.1.</a>&nbsp;
Downgrading from X.68x to X.208<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.2.</a>&nbsp;
Upgrading from X.208 to X.68x<br />
<a href="#anchor20">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor21">6.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
          This document is intended to serve as a tutorial for converting ASN.1 modules written using <a class='info' href='#CCITT.X208.1988'>[CCITT.X208.1988]<span> (</span><span class='info'>International International Telephone and Telegraph Consultative Committee, &ldquo;Specification of Abstract Syntax Notation One (ASN.1),&rdquo; November&nbsp;1988.</span><span>)</span></a> to <a class='info' href='#CCITT.X680.2002'>[CCITT.X680.2002]<span> (</span><span class='info'>International International Telephone and Telegraph Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Specification of basic notation,&rdquo; July&nbsp;2002.</span><span>)</span></a>, or vice versa.  Preparation of this document was motivated by <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-smime-new-asn1'>[I&#8209;D.ietf&#8209;smime&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for CMS and S/MIME,&rdquo; August&nbsp;2009.</span><span>)</span></a>, which provide updated ASN.1 modules for a number of RFCs.
        
</p>
<p>The intent of this specification is to assist with translation of ASN.1 from one version to another without resulting in any changes to the encoded results when using the Basic Encoding Rules or Distinguished Encoding Rules <a class='info' href='#CCITT.X209.1988'>[CCITT.X209.1988]<span> (</span><span class='info'>International Telephone and Telegraph Consultative Committee, &ldquo;Specification of Basic Encoding Rules for Abstract Syntax Notation One (ASN.1),&rdquo; 1988.</span><span>)</span></a><a class='info' href='#CCITT.X690.2002'>[CCITT.X690.2002]<span> (</span><span class='info'>International International Telephone and Telegraph Consultative Committee, &ldquo;ASN.1 encoding rules: Specification of basic encoding Rules (BER), Canonical encoding rules (CER) and Distinguished encoding rules (DER),&rdquo; July&nbsp;2002.</span><span>)</span></a>.  Other encoding rules were not considered.
</p>
<p>
      Transforming a new ASN.1 module to an older ASN.1 module can be performed in a fairly mechanical manner, much of the transformation consists of deleting new constructs.  Transforming an older ASN.1 module to a newer ASN.1 module can also be done fairly mechanically, if one does not wish to move many of the constraints that are contained in the prose into the ASN.1 module.  If the constraints are to be added, then the conversion can be a complex process.
    
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>This document addresses two different versions of ASN.1. The old (1988) version was defined in a single document (X.208) and the newer (1998, 2002) version is defined in a series of documents (X.680, X.681, X.682 and X.683).  For convenience, the series of documents is henceforth referred to as X.68x.  Specific documents from the series are referenced by name where appropriate.
</p>
<p>
            The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
            "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
            document are to be interpreted as described in RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
          
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
ASN.1 design elements</h3>

<p>
          When translating an ASN.1 module from X.208 syntax to X.68x syntax, or vice versa, many definitions do not require or benefit from change.  Review of the original ASN.1 modules updated by <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-smime-new-asn1'>[I&#8209;D.ietf&#8209;smime&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for CMS and S/MIME,&rdquo; August&nbsp;2009.</span><span>)</span></a> and the revised modules included in those documents indicates that most changes can be sorted into one of a few categories.  This section describes these categories.
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Open types</h3>

<p>Protocols often feature flexible designs that enable other (later) specifications to define the syntax and semantics of some features.  For example, <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> includes the definition of the Extension structure.  There are many instances of extensions defined in other specifications.  Several mechanisms are available in X.208, X.68x or both to accommodate this practice, as described below.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
ANY DEFINED BY</h3>

<p>
            X.208 defines the ANY DEFINED BY production for specifying open types.  This typically appears in a SEQUENCE along with an OBJECT IDENTIFIER that indicates the type of object that is encoded.  The ContentInfo structure, shown below from <a class='info' href='#RFC3852'>[RFC3852]<span> (</span><span class='info'>Housley, R., &ldquo;Cryptographic Message Syntax (CMS),&rdquo; July&nbsp;2004.</span><span>)</span></a>, uses ANY DEFINED BY along with an OBJECT IDENTIFIER field to identify and convey arbitrary types of data.  Each content type to be wrapped in a ContentInfo is assigned a unique OBJECT IDENTIFIER, such as the id-signedData shown below.  However, X.208 does not provide a formal means for establishing a relationship between a type and the type identifier.  Any associations are done in the comments of the module and/or the text of the associated document.
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from RFC 3852
ContentInfo ::= SEQUENCE {
    contentType ContentType,
    content [0] EXPLICIT ANY DEFINED BY contentType }

ContentType ::= OBJECT IDENTIFIER

id-signedData OBJECT IDENTIFIER ::= { iso(1) member-body(2)
   us(840) rsadsi(113549) pkcs(1) pkcs7(7) 2 }

</pre></div>
<p>ANY DEFINED BY may also appear using an INTEGER to indicate the type of object that is encoded, as shown in the following example from <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from RFC 5280
ExtensionAttribute ::=  SEQUENCE {
    extension-attribute-type [0] IMPLICIT INTEGER
        (0..ub-extension-attributes),
    extension-attribute-value [1]
        ANY DEFINED BY extension-attribute-type }

</pre></div>
<p>Though the usage of ANY DEFINED BY was deprecated in 1994, it appears in some active specifications. The AttributeValue definition in <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> uses ANY with a DEFINED BY comment to bind the value to a type identifier field.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from RFC 5280
AttributeTypeAndValue ::= SEQUENCE {
    type     AttributeType,
    value    AttributeValue }

AttributeType ::= OBJECT IDENTIFIER

AttributeValue ::= ANY -- DEFINED BY AttributeType

</pre></div>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2"></a><h3>2.1.2.&nbsp;
OCTET STRINGs and BIT STRINGs</h3>

<p>
            Both X.208 and X.68x allow open types to be implemented using OCTET STRINGs and BIT STRINGs as containers.  The definitions of Extension and SubjectPublicKeyInfo in <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> demonstrate the usage of OCTET STRING and BIT STRING, respectively, to convey information that is further defined using ASN.1.
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from RFC 5280
Extension  ::=  SEQUENCE  {
    extnID      OBJECT IDENTIFIER,
    critical    BOOLEAN DEFAULT FALSE,
    extnValue   OCTET STRING
    -- contains the DER encoding of an ASN.1 value
    -- corresponding to the extension type identified
    -- by extnID
}

SubjectPublicKeyInfo  ::=  SEQUENCE  {
     algorithm            AlgorithmIdentifier,
     subjectPublicKey     BIT STRING  }

</pre></div>
<p>In both cases, the prose of the specification indicates that the adjacent OBJECT IDENTIFIER value indicates the type of structure within the value of the primitive OCTET STRING or BIT STRING type.  For example, where an extnID field contains the value id-ce-basicConstraints, the extnValue field contains an encoded BasicConstraints as the value of the OCTET STRING, as shown in the dump of an encoded extension below.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

Tag Length      Value
30   15:         SEQUENCE {
06    3:           OBJECT IDENTIFIER basicConstraints (2 5 29 19)
01    1:           BOOLEAN TRUE
04    5:           OCTET STRING, encapsulates {
30    3:               SEQUENCE {
01    1:                 BOOLEAN TRUE
       :                 }
       :               }
       :           }


</pre></div>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.3"></a><h3>2.1.3.&nbsp;
Information Object Classes</h3>

<p>
              Information object classes are defined in <a class='info' href='#CCITT.X681.2002'>[CCITT.X681.2002]<span> (</span><span class='info'>International International Telephone and Telegraph                 Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Information object specification,&rdquo; July&nbsp;2002.</span><span>)</span></a>.  Object classes allow protocol designers to relate pieces of data that are in some way associated.  In the most generic of terms, an Information Object class can be thought of as a database schema, with Information Object Sets being instances of the databases.
            
</p>
<p>Unlike type definitions, object classes with the same structure are not equivalent.  Thus if you have:
</p>
<p>
          </p>
<blockquote class="text">
<p>FOO ::= TYPE-IDENTIFIER
</p>
<p>BAR ::= TYPE-IDENTIFIER
</p>
</blockquote><p>
          
</p>
<p>FOO and BAR are not interchangeable.
</p>
<p>TYPE-IDENTIFIER is one of the predefined information object classes in Annex A of <a class='info' href='#CCITT.X681.2002'>[CCITT.X681.2002]<span> (</span><span class='info'>International International Telephone and Telegraph                 Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Information object specification,&rdquo; July&nbsp;2002.</span><span>)</span></a>.  This provides for a simple mapping from an OBJECT IDENTIFIER to a data type.  The tag UNIQUE on &amp;id means that this value may appear only once in an Information Object Set, however multiple objects can be defined with the same &amp;id value.
        
</p>
<p><a class='info' href='#I-D.ietf-smime-new-asn1'>[I&#8209;D.ietf&#8209;smime&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for CMS and S/MIME,&rdquo; August&nbsp;2009.</span><span>)</span></a> uses the TYPE-IDENTIFIER construction to update the definition of ContentInfo, as shown below.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- TYPE-IDENTIFIER definition from X.681
TYPE-IDENTIFIER ::= CLASS
{
    &amp;id OBJECT IDENTIFIER UNIQUE,
    &amp;Type
}
WITH SYNTAX {&amp;Type IDENTIFIED BY &amp;id}

-- from updated RFC 3852 module in [I-D.ietf-smime-new-asn1]
CONTENT-TYPE ::= TYPE-IDENTIFIER
ContentType ::= CONTENT-TYPE.&amp;id

ContentInfo ::= SEQUENCE {
    contentType        CONTENT-TYPE.
                    &amp;id({ContentSet}),
    content            [0] EXPLICIT CONTENT-TYPE.
                    &amp;Type({ContentSet}{@contentType})}

ContentSet CONTENT-TYPE ::= {
    --  Define the set of content types to be recognized.
    ct-Data | ct-SignedData | ct-EncryptedData | ct-EnvelopedData |
    ct-AuthenticatedData | ct-DigestedData, ... }

-- other CONTENT-TYPE instances not shown for brevity
ct-SignedData CONTENT-TYPE ::=
     { SignedData IDENTIFIED BY id-signedData}


</pre></div>
<p>
            This example illustrates the following:
            </p>
<ul class="text">
<li>Definition of an information object class: TYPE-IDENITIFIER and CONTENT-TYPE are information object classes.
</li>
<li>Definition of an information object, or an instance of an information object class: ct-SignedData is an information object.
</li>
<li>Definition of an information object set: ContentSet is an information object set.
</li>
<li>Usage of an information object: The definition of ContentInfo uses information from the CONTENT-TYPE information object class.
</li>
<li>Defining constraints using an object set: Both the contentType and content fields are constrained by ContentSet.
</li>
</ul><p>
            
</p>
<p>As noted above, TYPE-IDENTIFIER simply associates an OBJECT IDENTIFIER with an arbitrary data type.  CONTENT-TYPE is a TYPE-IDENTIFIER.  The WITH SYNTAX component allows for a more natural language expression of information object definitions.
</p>
<p>ct-SignedData is the name of an information object that associated the identifier id-signedData with the data type SignedData.  It is an instance of the CONTENT-TYPE information object class.  The &amp;Type field is assigned the value SignedData and the &amp;id field is assigned the value id-signedData.  The example above uses the syntax provided by the WITH SYNTAX component of the TYPE-IDENTIFIER definition.  An equivalent definition not using the provided syntax is as follows: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

ct-SignedData CONTENT-TYPE ::=
{
    &amp;id id-signedData,
    &amp;Type SignedData
}

</pre></div>
<p>ContentSet is the name of a set of information objects derived from the CONTENT-TYPE information object class.  The set contains six information objects and is extensible, as indicated by the ellipsis (see the Versioning and Extensibility section below).
</p>
<p>ContentInfo is defined using type information from an information object, i.e., the type of the contentType field is that of the &amp;id field from CONTENT-TYPE.  An equivalent definition is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

ContentType ::= OBJECT IDENTIFIER

</pre></div>
<p>Both fields in ContentInfo are constrained.  The contentType field is constrained using a simple table constraint that restricts the values to those from the corresponding field of the objects in ContentSet.  The content field is constrained using a component relationship constraint.  Constraints are discussed in the next section.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Constraints</h3>

<p>The X.68x versions of the ASN.1 specifications introduced the ability to use the object information sets as part of the constraint on the values that a field can take.   Simple table constraints are used to restrict the set of values that can occur in a field.  Component relation constraints allow for the restriction of a field based on contents of other fields in the type.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
Simple table constraints</h3>

<p>
              Simple table constraints are widely used in <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-smime-new-asn1'>[I&#8209;D.ietf&#8209;smime&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for CMS and S/MIME,&rdquo; August&nbsp;2009.</span><span>)</span></a> to limit implementer options (although the constraints are almost always followed by or include extensibility markers making the parameters serve an informational purpose not as a limitation).  Table constraints are defined in <a class='info' href='#CCITT.X682.2002'>[CCITT.X682.2002]<span> (</span><span class='info'>International International Telephone and Telegraph                 Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Constraint specification,&rdquo; July&nbsp;2002.</span><span>)</span></a>.
            
</p>
<p>Some ASN.1 compilers have the ability to use the simple table constraint to check that a field contains one of the legal values.
</p>
<p>
              The following example from <a class='info' href='#I-D.ietf-smime-new-asn1'>[I&#8209;D.ietf&#8209;smime&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for CMS and S/MIME,&rdquo; August&nbsp;2009.</span><span>)</span></a> provides two examples of using table constraints to clarify the intended usage of a particular field.  The parameters indicate the types of attributes that are typically found in the signedAttrs and unsignedAttrs fields.  In this example, the object sets are disjoint but this is not required.  For example, in <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a>, there is some overlap between the CertExtensions and CrlExtensions sets.
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from updated RFC 3852 module in [I-D.ietf-smime-new-asn1]
SignerInfo ::= SEQUENCE {
    version CMSVersion,
    sid SignerIdentifier,
    digestAlgorithm DigestAlgorithmIdentifier,
    signedAttrs [0] IMPLICIT SignedAttributes OPTIONAL,
    signatureAlgorithm SignatureAlgorithmIdentifier,
    signature SignatureValue,
    unsignedAttrs [1] IMPLICIT Attributes
         {{UnsignedAttributes}} OPTIONAL }

SignedAttributes ::= Attributes {{ SignedAttributesSet }}

SignedAttributesSet ATTRIBUTE ::=
       { aa-signingTime | aa-messageDigest | aa-contentType, ... }

UnsignedAttributes ATTRIBUTE ::= { aa-countersignature, ... }


</pre></div>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Component relation constraints</h3>

<p>
              Component relation constraints are often used to bind the type field of an open type to the identifier field.  Using the binding in this way allows for a compiler to immediately decode the associated type when the containing structure is defined.  The following example from <a class='info' href='#RFC2560'>[RFC2560]<span> (</span><span class='info'>Myers, M., Ankney, R., Malpani, A., Galperin, S., and C. Adams, &ldquo;X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP,&rdquo; June&nbsp;1999.</span><span>)</span></a> as updated <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a> demonstrates this usage.
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from updated RFC 2560 module in [I-D.ietf-pkix-new-asn1]
RESPONSE ::= TYPE-IDENTIFIER

ResponseSet RESPONSE ::= {basicResponse, ...}

ResponseBytes ::=       SEQUENCE {
    responseType        RESPONSE.
                            &amp;id ({ResponseSet}),
    response            OCTET STRING (CONTAINING RESPONSE.
                            &amp;Type({ResponseSet}{@responseType}))}

</pre></div>
<p>
In this example, the response field is constrained to contain a type identified by the responseType field.  The controlling field is identified using atNotation, e.g., "@responseType".  atNotation can be defined relative to the outermost SEQUENCE, SET or CHOICE or relative to the field with which the atNotation is associated.  When there is no '.' immediately after the '@', the field appears as a member of the outermost SEQUENCE, SET or CHOICE.  When there is a '.' immediately after the '@', each '.' represents a SEQUENCE, SET or CHOICE starting with the SEQUENCE, SET or CHOICE that contains the field with which the atNotation is associated.  For example, ResponseBytes could have been written as shown below.  In this case, the syntax is very similar since the innermost and outermost SEQUENCE, SET or CHOICE are the same.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

ResponseBytes ::=       SEQUENCE {
    responseType        RESPONSE.
                            &amp;id ({ResponseSet}),
    response            OCTET STRING (CONTAINING RESPONSE.
                            &amp;Type({ResponseSet}{@.responseType}))}

</pre></div>
<p>The TaggedRequest example from <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a> provides an example where the outermost and innermost SEQUENCE, SET or CHOICE are different.  Relative to the atNotation included in the definition of the requestMessageValue field, the outermost SEQUENCE, SET or CHOICE is TaggedRequest and the innermost is the SEQUENCE used to define the orm field.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

TaggedRequest ::= CHOICE {
   tcr               [0] TaggedCertificationRequest,
   crm               [1] CertReqMsg,
   orm               [2] SEQUENCE {
       bodyPartID            BodyPartID,
       requestMessageType    OTHER-REQUEST.&amp;id({OtherRequests}),
       requestMessageValue   OTHER-REQUEST.&amp;Type({OtherRequests}
                                 {@.requestMessageType})
   }
}

</pre></div>
<p>
  When referencing a field using atNotation, the definition of the field must be included within the outermost SEQUENCE, SET or CHOICE.  References to fields within structures that are defined separately are not allowed.  For example, the following example includes invalid atNotation in the definition of the signature field within the SIGNED parameterized type.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

AlgorithmIdentifier{ALGORITHM-TYPE, ALGORITHM-TYPE:AlgorithmSet} ::=
          SEQUENCE {
              algorithm   ALGORITHM-TYPE.&amp;id({AlgorithmSet}),
              parameters  ALGORITHM-TYPE.
                     &amp;Params({AlgorithmSet}{@algorithm}) OPTIONAL
          }

-- example containing invalid atNotation
SIGNED{ToBeSigned} ::= SEQUENCE {
   toBeSigned           ToBeSigned,
   algorithmIdentifier  AlgorithmIdentifier
                            { SIGNATURE-ALGORITHM, {...}}
   },
   signature BIT STRING (CONTAINING SIGNATURE-ALGORITHM.&amp;Value(
                            {SignatureAlgorithms}
                            {@algorithmIdentifier.algorithm}))
}

</pre></div>
<p>The above example could be alternatively written with correct atNotation as follows, with the definition of the algorithm field included within ToBeSigned.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

  SIGNED{ToBeSigned} ::= SEQUENCE {
     toBeSigned           ToBeSigned,
     algorithmIdentifier  SEQUENCE {
         algorithm        SIGNATURE-ALGORITHM.
                              &amp;id({SignatureAlgorithms}),
         parameters       SIGNATURE-ALGORITHM.
                              &amp;Params({SignatureAlgorithms}
                                  {@algorithmIdentifier.algorithm})
     },
     signature BIT STRING (CONTAINING SIGNATURE-ALGORITHM.&amp;Value(
                              {SignatureAlgorithms}
                              {@algorithmIdentifier.algorithm}))
  }

</pre></div>
<p>In the above example, the outermost SEQUENCE, SET or CHOICE relative to the parameters field is the SIGNED parameterized type.  The innermost structure is the SEQUENCE used as the type for the algorithmIdentifier field.  The atNotation for the parameters field could be expressed using any of the following representations:
</p>
<p>
              </p>
<blockquote class="text">
<p>@algorithmIdentifier.algorithm
</p>
<p>@.algorithm
</p>
</blockquote><p>
            
</p>
<p>The atNotation for the signature field has only one representation.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.3"></a><h3>2.2.3.&nbsp;
Content constraints</h3>

<p>
              Open types implemented as OCTET STRINGs or BIT STRINGs can be constrained using contents constraints syntax defined in <a class='info' href='#CCITT.X682.2002'>[CCITT.X682.2002]<span> (</span><span class='info'>International International Telephone and Telegraph                 Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Constraint specification,&rdquo; July&nbsp;2002.</span><span>)</span></a>.  Below are the revised definitions from <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-smime-new-asn1'>[I&#8209;D.ietf&#8209;smime&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for CMS and S/MIME,&rdquo; August&nbsp;2009.</span><span>)</span></a>.  These show usage of OCTET STRING and BIT STRING along with constrained sets of identifiers.  The Extension definition uses a content constraint that requires the value of the OCTET STRING to be an encoding the type associated with the information object selected from the ExtensionSet object set using the value of the extnID field.  For reasons described above in the "Component relation constraints" section, the SubjectPublicKeyInfo definition relies on prose to bind the BIT STRING to the type identifier because it is not possible to express a content constraint that includes a component relationship constraint to bind the type value within the algorithm field to the subjectPublicKey field.
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from updated RFC 5280 module in [I-D.ietf-pkix-new-asn1]
Extension{EXTENSION:ExtensionSet} ::= SEQUENCE {
    extnID      EXTENSION.&amp;id({ExtensionSet}),
    critical    BOOLEAN
    -- (EXTENSION.&amp;Critical({ExtensionSet}{@extnID}))
                       DEFAULT FALSE,
    extnValue   OCTET STRING (CONTAINING
                  EXTENSION.&amp;ExtnType({ExtensionSet}{@extnID}))
                  --  contains the DER encding of the ASN.1 value
                  --  corresponding to the extension type identified
                  --  by extnID
}

SubjectPublicKeyInfo  ::=  SEQUENCE  {
    algorithm            AlgorithmIdentifier{PUBLIC-KEY,
                             {PublicKeyAlgorithms}},
    subjectPublicKey     BIT STRING
}

</pre></div>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Parameterization</h3>

<p>
          Parameterization is defined in <a class='info' href='#CCITT.X683.2002'>[CCITT.X683.2002]<span> (</span><span class='info'>International International Telephone and Telegraph                 Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Parameterization of ASN.1 specifications,&rdquo; July&nbsp;2002.</span><span>)</span></a> and can also be used to define new types in a way similar to the macro notation described in Annex A of X.208.  The following example from <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a> shows this usage.  The toBeSigned field takes the type passed as a parameter.
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from [I-D.ietf-pkix-new-asn1]
SIGNED{ToBeSigned} ::= SEQUENCE {
    toBeSigned  ToBeSigned,
    algorithm   AlgorithmIdentifier{SIGNATURE-ALGORITHM,
                    {SignatureAlgorithms}},
    signature   BIT STRING
}

-- from updated RFC5280 module in [I-D.ietf-pkix-new-asn1]
Certificate  ::=  SIGNED{TBSCertificate}

</pre></div>
<p>Parameters need not be simple types.  The following example demonstrates the usage of an information object class and an information object set as parameters.  The first parameter in the definition of AlgorithmIdentifier is an information object class.  Information object classes used for this parameter must have &amp;id and &amp;Params fields, which determine the type of the algorithm and parameters fields.  Other fields may be present in the information object class but they are not used by the definition of AlgorithmIdentifier, as demonstrated by the SIGNATURE-ALGORITHM class shown below.  The second parameter is an information object set that is used to constrain the values that appear in the algorithm and parameters fields.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from [I-D.ietf-pkix-new-asn1]
AlgorithmIdentifier{ALGORITHM-TYPE, ALGORITHM-TYPE:AlgorithmSet}
    ::= SEQUENCE
{
    algorithm   ALGORITHM-TYPE.&amp;id({AlgorithmSet}),
    parameters  ALGORITHM-TYPE.&amp;Params
                  ({AlgorithmSet}{@algorithm}) OPTIONAL
}

SIGNATURE-ALGORITHM ::= CLASS {
    &amp;id             OBJECT IDENTIFIER,
    &amp;Params         OPTIONAL,
    &amp;Value          OPTIONAL,
    &amp;paramPresence  ParamOptions DEFAULT absent,
    &amp;HashSet        DIGEST-ALGORITHM OPTIONAL,
    &amp;PublicKeySet   PUBLIC-KEY OPTIONAL,
    &amp;smimeCaps      SMIME-CAPS OPTIONAL
} WITH SYNTAX {
    IDENTIFIER &amp;id
    [VALUE &amp;Value]
    [PARAMS [TYPE &amp;Params] ARE &amp;paramPresence ]
    [HASHES &amp;HashSet]
    [PUBLIC KEYS &amp;PublicKeySet]
    [SMIME CAPS &amp;smimeCaps]
}

-- from updated RFC 2560 module in [I-D.ietf-pkix-new-asn1]
BasicOCSPResponse       ::= SEQUENCE {
    tbsResponseData      ResponseData,
    signatureAlgorithm   AlgorithmIdentifier{SIGNATURE-ALGORITHM,
                          {sa-dsaWithSHA1 | sa-rsaWithSHA1 |
                               sa-rsaWithMD5 | sa-rsaWithMD2, ...}},
    signature            BIT STRING,
    certs            [0] EXPLICIT SEQUENCE OF Certificate OPTIONAL
}

</pre></div>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Versioning and Extensibility</h3>

<p>Specifications are often revised and ASN.1 modules updated to include new components.  <a class='info' href='#CCITT.X681.2002'>[CCITT.X681.2002]<span> (</span><span class='info'>International International Telephone and Telegraph                 Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Information object specification,&rdquo; July&nbsp;2002.</span><span>)</span></a> provides two mechanisms useful in supporting extensibility: extension markers and version brackets.  
        
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.1"></a><h3>2.4.1.&nbsp;
Extension markers</h3>

<p>An extension marker is represented by an ellipsis (i.e., three adjacent periods).  Extension markers are included in specifications at points where the protocol designer anticipates future changes.  This can also be achieved by including EXTENSIBILITY IMPLIED in the ASN.1 module definition.  EXTENSIBILITY IMPLIED is the equivalent to including an extension marker in each type defined in the ASN.1 module.  Extensibility markers are used throughout <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-smime-new-asn1'>[I&#8209;D.ietf&#8209;smime&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for CMS and S/MIME,&rdquo; August&nbsp;2009.</span><span>)</span></a> where object sets are defined.  In other instances, the updated modules retroactively added extension markers where fields were added to an earlier version by an update, as shown in the CertificateChoices example below.
</p>
<p>Examples: 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from updated RFC 3370
KeyAgreementAlgs KEY-AGREE ::= { kaa-esdh | kaa-ssdh, ...}

-- from updated RFC 3852
CertificateChoices ::= CHOICE {
    certificate Certificate,
    extendedCertificate [0] IMPLICIT ExtendedCertificate,
         -- Obsolete
    ...,
    [[3: v1AttrCert [1] IMPLICIT AttributeCertificateV1]],
         -- Obsolete
    [[4: v2AttrCert [2] IMPLICIT AttributeCertificateV2]],
    [[5: other      [3] IMPLICIT OtherCertificateFormat]]
}

</pre></div>
<p>Protocol designers should use extension markers within definitions that are likely to change.  For example, extensibility markers should be used when enumerating error values.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4.2"></a><h3>2.4.2.&nbsp;
Version brackets</h3>

<p>Version brackets can be used to indicate features that are available in later versions of an ASN.1 module but not in earlier versions.  <a class='info' href='#I-D.ietf-pkix-new-asn1'>[I&#8209;D.ietf&#8209;pkix&#8209;new&#8209;asn1]<span> (</span><span class='info'>Hoffman, P. and J. Schaad, &ldquo;New ASN.1 Modules for PKIX,&rdquo; August&nbsp;2009.</span><span>)</span></a> added version brackets to the definition of TBSCertificate to illustrate the addition of the issuerUniqueID, subjectUniqueID and extensions fields, as shown below.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

-- from updated RFC 5280 module in [I-D.ietf-pkix-new-asn1]
TBSCertificate  ::=  SEQUENCE  {
    version         [0]  Version DEFAULT v1,
    serialNumber         CertificateSerialNumber,
    signature            AlgorithmIdentifier{SIGNATURE-ALGORITHM,
                              {SignatureAlgorithms}},
    issuer               Name,
    validity             Validity,
    subject              Name,
    subjectPublicKeyInfo SubjectPublicKeyInfo,
    ... ,
    [[2:               -- If present, version MUST be v2
    issuerUniqueID  [1]  IMPLICIT UniqueIdentifier OPTIONAL,
    subjectUniqueID [2]  IMPLICIT UniqueIdentifier OPTIONAL
    ]],
    [[3:               -- If present, version MUST be v3 --
    extensions      [3]  ExtensionSet{{CertExtensions}} OPTIONAL
    ]], ... }

</pre></div>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Character set differences</h3>

<p>X.68s uses a character set that is a superset of the character set defined in X.208.  The character set defined in X.208 includes the following: 
</p>
<p></p>
<blockquote class="text">
<p>A to Z
</p>
<p>a to z
</p>
<p>0 to 9
</p>
<p>:=,{}&lt;.
</p>
<p>()[]-'"
</p>
</blockquote>

<p>The character set in X.68x additionally includes the following:
</p>
<p></p>
<blockquote class="text">
<p>!&amp;*/;&gt;@^_|
</p>
</blockquote>

<p>The &gt; and | characters can also be used in X.208 syntax in macro definitions.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
ASN.1 translation</h3>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Downgrading from X.68x to X.208</h3>

<p>At a minimum, downgrading an ASN.1 module from X.68x syntax to X.208 requires the removal of features not supported by X.208.  As indicated above, the features most commonly used in IETF security area ASN.1 modules are information object classes (and object sets), content constraints, parameterization, version brackets and extension markers.  Extension markers and version brackets can simply be deleted (or commented out).  The definitions for information object classes and object sets can also be deleted or commented out, as these will not be used.  The following checklist can be used in most cases:
</p>
<p>
        </p>
<ul class="text">
<li>Remove all Information Set Class, Information Set Object and Information Set Object Set definitions and imports from the file.
</li>
<li>Replace all fixed Type Information Set Class element references with the fixed type.  (I.e. Replace FOO.&amp;id with OBJECT IDENTIFIER.)
</li>
<li>Delete all simple constraints.
</li>
<li>Delete all CONTAINING statements.
</li>
<li>Replace all variable Type Information Set Class element references with either ANY or ANY DEFINED BY statements.
</li>
<li>Remove version and extension markers.
</li>
<li>Hand instantiate all instances of parameterized types.
</li>
</ul><p>
        
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Upgrading from X.208 to X.68x</h3>

<p>The amount of change associated with upgrading from X.208 syntax to X.68x syntax is dependent on the reasons for changing and personal style.  A minimalist approach could consist of altering any deprecated features, most commonly ANY DEFINED BY, and adding any necessary extensibility markers.  A more comprehensive approach may include of the introduction of constraints, parameterization, versioning, extensibility, etc.
</p>
<p>The following checklist can be used when upgrading a module without introducing constraints:
</p>
<p></p>
<blockquote class="text">
<p>Use TYPE-IDENTIFIER.&amp;Type for "ANY".
</p>
<p>Use TYPE-IDENTIFIER.&amp;Type for "ANY DEFINED BY ...".
</p>
</blockquote><p>
        
</p>
<p>When constraints are introducing during an upgrade, additional steps are necessary:
</p>
<p></p>
<ol class="text">
<li>Identify each unique class that should be defined based on what types of things exist.
</li>
<li>Define an Information Object Class for each of the classes above with the appropriate elements.
</li>
<li>Define the all of appropriate Information Object Sets based on the classes defined in step 2 along with the different places that they should be used.
</li>
<li>Replace ANY by the appropriate class and variable type element.
</li>
<li>Replace ANY DEFINED BY with the appropriate variable type element and the components constraint.  Replace the element used in the constraint with the appropriate fixed type element and simple constraint.
</li>
<li>Add any simple constraints as appropriate.
</li>
<li>Define any objects and fill in elements for object sets as appropriate.
</li>
</ol><p>
        
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
          There are no IANA considerations.  Please delete this section prior to RFC publication.
        
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
Where a module is downgraded from X.68x syntax to X.208 there is loss of potential automated enforcement of constraints expressed by the author of the module being downgraded.  These constraints should be captured in prose or ASN.1 comments and enforced through other means, as necessary.

</p>
<p>Depending on the feature set of the ASN.1 compiler being used, the code to enforce and use constraints may be generated automatically or may require the programmer to do this independently.  It is the responsibility of the programmer to ensure that the constraints on the ASN.1 expressed either in prose or in the ASN.1 module are actually enforced.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CCITT.X208.1988">[CCITT.X208.1988]</a></td>
<td class="author-text">International International Telephone and Telegraph
Consultative Committee, &ldquo;Specification of Abstract Syntax Notation One (ASN.1),&rdquo; CCITT&nbsp;Recommendation X.208, November&nbsp;1988.</td></tr>
<tr><td class="author-text" valign="top"><a name="CCITT.X680.2002">[CCITT.X680.2002]</a></td>
<td class="author-text">International International Telephone and Telegraph
Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Specification of basic notation,&rdquo; CCITT&nbsp;Recommendation X.680, July&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="CCITT.X681.2002">[CCITT.X681.2002]</a></td>
<td class="author-text">International International Telephone and Telegraph
                Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Information object specification,&rdquo; CCITT&nbsp;Recommendation X.681, July&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="CCITT.X682.2002">[CCITT.X682.2002]</a></td>
<td class="author-text">International International Telephone and Telegraph
                Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Constraint specification,&rdquo; CCITT&nbsp;Recommendation X.682, July&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="CCITT.X683.2002">[CCITT.X683.2002]</a></td>
<td class="author-text">International International Telephone and Telegraph
                Consultative Committee, &ldquo;Abstract Syntax Notation One (ASN.1): Parameterization of ASN.1 specifications,&rdquo; CCITT&nbsp;Recommendation X.683, July&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="CCITT.X209.1988">[CCITT.X209.1988]</a></td>
<td class="author-text">International Telephone and Telegraph Consultative Committee, &ldquo;Specification of Basic Encoding Rules for Abstract Syntax Notation One (ASN.1),&rdquo; CCITT&nbsp;Recommendation X.209, 1988.</td></tr>
<tr><td class="author-text" valign="top"><a name="CCITT.X690.2002">[CCITT.X690.2002]</a></td>
<td class="author-text">International International Telephone and Telegraph
Consultative Committee, &ldquo;ASN.1 encoding rules: Specification of basic encoding Rules (BER), Canonical encoding rules (CER) and Distinguished encoding rules (DER),&rdquo; CCITT&nbsp;Recommendation X.690, July&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-pkix-new-asn1">[I-D.ietf-pkix-new-asn1]</a></td>
<td class="author-text">Hoffman, P. and J. Schaad, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-new-asn1-07.txt">New ASN.1 Modules for PKIX</a>,&rdquo; draft-ietf-pkix-new-asn1-07 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-pkix-new-asn1-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-smime-new-asn1">[I-D.ietf-smime-new-asn1]</a></td>
<td class="author-text">Hoffman, P. and J. Schaad, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-smime-new-asn1-07.txt">New ASN.1 Modules for CMS and S/MIME</a>,&rdquo; draft-ietf-smime-new-asn1-07 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-smime-new-asn1-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2560">[RFC2560]</a></td>
<td class="author-text"><a href="mailto:mmyers@verisign.com">Myers, M.</a>, <a href="mailto:rankney@erols.com">Ankney, R.</a>, <a href="mailto:ambarish@valicert.com">Malpani, A.</a>, <a href="mailto:galperin@mycfo.com">Galperin, S.</a>, and <a href="mailto:cadams@entrust.com">C. Adams</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2560">X.509 Internet Public Key Infrastructure Online Certificate Status Protocol - OCSP</a>,&rdquo; RFC&nbsp;2560, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2560.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3852">[RFC3852]</a></td>
<td class="author-text">Housley, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3852">Cryptographic Message Syntax (CMS)</a>,&rdquo; RFC&nbsp;3852, July&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3852.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Carl Wallace</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cygnacom Solutions</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 5200</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">7925 Jones Branch Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">McLean, VA  22102</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cwallace@cygnacom.com">cwallace@cygnacom.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Charles Gardiner</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BBN Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10 Moulton Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cambridge, MA  02138</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gardiner@bbn.com">gardiner@bbn.com</a></td></tr>
</table>
</body></html>
