hd-value = { "{HD}", base64(hash-a1) }
hash-a1 = H( { username-value, ":", realm-value, ":", passwd } )

username-value       = "dn" ":" normalized-dn
realm-value          = service-name "@" host

dc=austin, dc=innosoft, dc=com and whose plaintext password is
username-value = "dn:CN=JAMES SMITH,DC=AUSTIN,DC=INNOSOFT,DC=COM"
realm-value    = "idds@brio.austin.innosoft.com"
passwd         = "secret"

hd-value       = "{HD}HGV7gjTumJR5WisCano8Vw=="

realm="idds@brio.austin.innosoft.com",
nonce="N8SAX3jAE/6bqt",qop="auth",charset=utf-8 

cn=James Smith, dc=austin, dc=innosoft, dc=com
charset=utf-8,
username="dn:CN=JAMES SMITH,DC=AUSTIN,DC=INNOSOFT,DC=COM",
realm="idds@brio.austin.innosoft.com",nonce="N8SAX3jAE/6bqt",
nc=00000001,cnonce="37c4805fac7d9b3c56a7",
response="9a8cac7d0f582e57cbfd6c19d10ac329",qop=auth

dc=innosoft, dc=com. The client computed the correct response to the
ld = ldap_init("brio.austin.innosoft.com", 389);
name = "cn=James Smith, dc=austin, dc=innosoft, dc=com";
pass = "secret";

retval = ldap_sasl_bind_s(ld, "", "DIGEST-MD5", NULL, 
                              controls, NULL, &servercredp);
normdn = dn_normalize_case(name);
username = malloc(strlen(normdn)+sizeof("dn:")+1);
resp = ldap_digest_md5_encode(servercredp->bv_val, username, pass);
retval = ldap_sasl_bind(ld, name, "DIGEST-MD5", &ccred, 
                            controls, NULL, &msgid);
