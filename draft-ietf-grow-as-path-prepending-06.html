<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>AS Path Prepending</title>
<meta content="Mike McBride" name="author">
<meta content="Doug Madory" name="author">
<meta content="Jeff Tantsura" name="author">
<meta content="Robert Raszuk" name="author">
<meta content="Hongwei Li" name="author">
<meta content="Jakob Heitz" name="author">
<meta content="Gyan Mishra" name="author">
<meta content="
       AS Path Prepending provides a tool to manipulate the BGP AS_Path attribute
      through prepending multiple entries of an AS. AS Path Prepending is used to deprioritize a
      route or alternate path. By prepending the local ASN multiple times, ASs can make 
      advertised AS paths appear artificially longer. Excessive AS Path Prepending has caused 
      routing issues in the Internet. This document provides guidance with the use of AS Path 
      Prepending, including alternative solutions, in order to avoid negatively affecting the Internet. 
    " name="description">
<meta content="xml2rfc 3.12.2" name="generator">
<meta content="draft-ietf-grow-as-path-prepending-06" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.2
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-ietf-grow-as-path-prepend-06-jlpkdhwp.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">AS Path Prepending</td>
<td class="right">February 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">McBride, et al.</td>
<td class="center">Expires 21 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-grow-as-path-prepending-06</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7454" class="eref">7454</a>, <a href="https://www.rfc-editor.org/rfc/rfc8195" class="eref">8195</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-02-17" class="published">17 February 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Best Current Practice</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-21">21 August 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. McBride</div>
<div class="org">Futurewei</div>
</div>
<div class="author">
      <div class="author-name">D. Madory</div>
<div class="org">Kentik</div>
</div>
<div class="author">
      <div class="author-name">J. Tantsura</div>
<div class="org">Microsoft</div>
</div>
<div class="author">
      <div class="author-name">R. Raszuk</div>
<div class="org">NTT Network Innovations</div>
</div>
<div class="author">
      <div class="author-name">H. Li</div>
<div class="org">HPE</div>
</div>
<div class="author">
      <div class="author-name">J. Heitz</div>
<div class="org">Cisco</div>
</div>
<div class="author">
      <div class="author-name">G. Mishra</div>
<div class="org">Verizon Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">AS Path Prepending</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">AS Path Prepending provides a tool to manipulate the BGP AS_Path attribute
      through prepending multiple entries of an AS. AS Path Prepending is used to deprioritize a
      route or alternate path. By prepending the local ASN multiple times, ASs can make 
      advertised AS paths appear artificially longer. Excessive AS Path Prepending has caused 
      routing issues in the Internet. This document provides guidance with the use of AS Path 
      Prepending, including alternative solutions, in order to avoid negatively affecting the Internet.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-use-cases" class="xref">Use Cases</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-problems" class="xref">Problems</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-cascading-and-ripple-effect" class="xref">Cascading and ripple effects of prepending across the Internet</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-excessive-prepending" class="xref">Excessive Prepending</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-prepending-during-a-routing" class="xref">Prepending during a routing leak</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-prepending-to-all" class="xref">Prepending to All</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-memory" class="xref">Memory</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-errant-announcement" class="xref">Errant announcement</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-alternatives-to-as-path-pre" class="xref">Alternatives to AS Path Prepend</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-best-practices" class="xref">Best Practices</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgement" class="xref">Acknowledgement</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Border Gateway Protocol (BGP) <span>[<a href="#RFC4271" class="xref">RFC4271</a>]</span> specifies the AS_PATH 
      attribute which enumerates ASs a route update has traversed. If the UPDATE message is propagated over an external link, 
      then the local AS number is prepended to the AS_PATH attribute, and the NEXT_HOP 
      attribute is updated with an IP address of the router that should be used as a next hop to the 
      network.  If the UPDATE message is propagated over an internal link, then the AS_PATH 
      attribute and the NEXT_HOP attribute are passed unmodified.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">A common practice among operators is to prepend multiple entries of an
      AS (known as AS Path Prepending) in order to deprioritize a route or a path. So far, this has 
      not caused many problems. However, the practice is increasing, with both IPv4 and IPv6, and 
      there are now inherent risks to the global Internet, especially with excessive AS Path Prepending. 
      Prepending is frequently employed in an excessive manner such that it renders routes vulnerable to disruption or 
      misdirection. AS Path Prepending is discussed in Use of BGP Large Communities 
      <span>[<a href="#RFC8195" class="xref">RFC8195</a>]</span>.  This document provides additional and specific guidance to 
      operators on how to be good Internet citizens with less risky use of AS Path Prepending.<a href="#section-1-2" class="pilcrow">¶</a></p>
<div id="requirements-language">
<section id="section-1.1">
        <h3 id="name-requirements-language">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <span><a href="#RFC2119" class="xref">RFC 2119</a> [<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="section-2">
      <h2 id="name-use-cases">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-use-cases" class="section-name selfRef">Use Cases</a>
      </h2>
<p id="section-2-1">There are various reasons that AS Path Prepending is in use today including:<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">Preferring one ISP over another ISP on the same ASBR or across different ASBRs.<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">Preferring one ASBR over another ASBR in the same site or between sister sites.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.3">Utilize one path exclusively and another path solely as a backup.<a href="#section-2-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.4">Signal to indicate that one path may have a different amount of capacity than another where the lower capacity link still takes traffic.<a href="#section-2-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.5">Conditionally prefer one ASBR over another at the same site or between sites for lowest latency path based on geographic location.<a href="#section-2-2.5" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.6">An ISP doesn't accept traffic engineering using BGP communities. Prepending is the only option.<a href="#section-2-2.6" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-3">The following illustration, from Geoff Huston's <a href="https://labs.apnic.net/?p=1264">Path Prepending in BGP</a>, 
          shows how AS Prepending is typically used:<a href="#section-2-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2-4">
<pre>

               +---+    +---+
           +---| D |----| F |
           |   +---+    +---+
+---+   +---+             |
| A |---| B |             |
+---+   +---+        2x&lt;- |
           |   +---+    +---+
           +---| C |----| E |
               +---+    +---+


</pre><a href="#section-2-4" class="pilcrow">¶</a>
</div>
<p id="section-2-5">In the diagram above, A, B, C, D, E, and F all have a different AS.
    B will normally prefer the path via C to send traffic to E, as this represents the shorter AS path for B. 
    If E were to prepend a further two instances of its own AS number when advertising its routes to C, then 
    B will now see a different situation, where the AS Path via D represents the shorter path. Through 
    the use of selective prepending E is able to alter the routing decision of B, even though B is not an adjacent 
    neighbour of E. The result is that traffic from A and B will be passed via D and F to reach E, rather than via C. 
    In this way prepending implements action at a distance where the routing decisions made by non-adjacent 
    ASs can be influenced by selective AS Path prepending.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
<section id="section-3">
      <h2 id="name-problems">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-problems" class="section-name selfRef">Problems</a>
      </h2>
<p id="section-3-1">Since it is so commonly used, what is the problem with the excessive use of AS Path Prepending? Here are
      a few examples:<a href="#section-3-1" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-cascading-and-ripple-effect">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-cascading-and-ripple-effect" class="section-name selfRef">Cascading and ripple effects of prepending across the Internet</a>
        </h3>
<p id="section-3.1-1">Care should be taken in prepending, as prepending can cause ripple effects with multiple AS's performing the same 
      set of prepends in the same direction, resulting in route leaks where the valid preferred path becomes now de-preferred.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.1-2">
<pre>

                         &lt;-5x     &lt;-5x     &lt;-5x
               +---+    +---+    +---+    +---+
           +---| D |----| F |----| H |----| J |
           |   +---+    +---+    +---+    +---+
+---+   +---+             |                 |
| A |---| B |             |                 |
+---+   +---+        13x&lt;-|                 |
           |   +---+    +---+    +---+    +---+
           +---| C |----| E |----| G |----| I |
               +---+    +---+    +---+    +---+


</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-3.1-3">In the diagram above A, B, C, D, E, F G, H, I, and J are all part of different ASes.
    B will normally prefer the path via D to send traffic to J, as this represents the preferred path to B, due to E prepending 13 instances of its own 
    AS number when advertising routes to C. ISP J decides to prepend 5 instances of its own AS when advertising to H, and ISP H decides to do the 
    same and prepends 5 instances of its own AS when advertising to F.  ISP F decides as well to prepend 5 instances of its own AS when 
    advertising to D.  B now sees 19 AS hops for prefixes coming from D to get to J which should be the preferred path compared to 18 AS hops 
    coming from C which is now preferred. We now have a route leak to I as B now sends all of its traffic through I to reach J.  This is the typical 
    scenario where route leaks occur where providers decide to de-prefer a path. However as the same de-preference of a path gets cascaded in the 
    same direction, as a result, the path that should never be preferred as its as-path is very high in this case 18 AS hops ends up being the preferred 
    path resulting in a route leak. Usage of BGP large communities along with conditional prepending, along with care being taken when prepending is 
    performed between providers, can help mitigate the adverse impacts of prepending.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-excessive-prepending">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-excessive-prepending" class="section-name selfRef">Excessive Prepending</a>
        </h3>
<p id="section-3.2-1">The risk of excessive use of AS Path Prepending can be illustrated with real-world examples that have been 
      anonymized using documentation prefixes <span>[<a href="#RFC5737" class="xref">RFC5737</a>]</span> and ASs <span>[<a href="#RFC5398" class="xref">RFC5398</a>]</span> . Consider the 
      prefix 198.51.100.0/24 which is normally announced with an inordinate amount of prepending. A recent analysis 
      revealed that 198.51.100.0/24 is announced to the world along the following AS path:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">64496 64511 64511 64511 64511 64511 64511 64511 64511 64511 64511 64511 64511 64511 64511 64511 64511
      64511 64511 64511 64511 64511 64511 64511<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">In this example, the origin AS64511 appears 23 consecutive times before being passed on to a single 
      upstream (AS64496), which passes it on to the global Internet, prepended-to-all. An attacker, wanting to intercept or 
      manipulate traffic to this prefix, could enlist a datacenter to allow announcements 
      of the same prefix with a fabricated AS path such as 999999 64496 64511. Here the fictional AS999999 represents 
      the shady datacenter.  This malicious route would be preferred due to the shortened AS path length and might 
      go unnoticed by the true origin, even if route-monitoring had been implemented. Standard BGP route monitoring 
      checks a route's origin and upstream and both would be intact in this scenario. The length of the prepending gives 
      the attacker room to craft an AS path that would appear plausible to the casual observer, comply with origin validation 
      mechanisms, and not be detected by off-the-shelf route monitoring.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
<section id="section-3.3">
        <h3 id="name-prepending-during-a-routing">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-prepending-during-a-routing" class="section-name selfRef">Prepending during a routing leak</a>
        </h3>
<p id="section-3.3-1">In April 2010, a service provider experienced a routing leak. While analyzing the leak something peculiar was noticed. 
      When we ranked the approximately 50,000 prefixes involved in the leak based on how many ASs accepted the leaked 
      routes, most of the impact was constrained to Country A routes. However, two of the top five most-propagated leaked 
      routes (listed in the table below) were Country B routes.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">During the routing leak, nearly all of the ASs of the Internet preferred the Country A leaked routes for 192.0.2.0/21 and 
      198.51.100.0/22 because, at the time, these two Country B prefixes were being announced to the entire Internet along the following 
      excessively prepended AS path: 64496 64500 64511 64511 64511 64511 64511 64511. Virtually 
      any illegitimate route would be preferred over the legitimate route. In this case, the victim is all but ensuring their victimhood.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">There was only a single upstream seen in the prepending example from above, so the prepending was achieving nothing 
      except incurring risk. You would think such mistakes would be relatively rare, 
      especially now, 10 years later.  As it turns out, there is quite a lot of prepending-to-all going on right now and during leaks, it 
      doesn't go well for those who make this mistake. While one can debate the merits of prepending to a subset of multiple transit 
      providers, it is difficult to see the utility in prepending to every provider. In this configuration, the prepending is no longer shaping 
      route propagation. It is simply incentivizing ASs to choose another origin if one were to suddenly appear whether by mistake 
      or otherwise.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
</section>
<section id="section-3.4">
        <h3 id="name-prepending-to-all">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-prepending-to-all" class="section-name selfRef">Prepending to All</a>
        </h3>
<p id="section-3.4-1">Based on analysis done in 2019, 
      <a href="https://blog.apnic.net/2019/07/15/excessive-bgp-as-path-prepending-is-a-self-inflicted-vulnerability/">Excessive AS 
      Path Prepending</a>, out of approximately 750,000 routes in the IPv4 global routing table, nearly 60,000 BGP routes are prepended 
      to 95% or more of hundreds of BGP sources. About 8% of the global routing table, or 1 out of every 12 BGP routes, is configured with 
      prepends to virtually the entire Internet. The 60,000 routes include entities of every stripe: governments, financial institutions, even 
      important parts of Internet infrastructure.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">Much of the worst propagation of leaked routes during big leak events have been due to routes being prepended-to-all.
           The AS64505 leak of April 2014 (&gt;320,000 prefixes) was prepended-to-all. And the AS64506 leak of June 2015 (&gt;260,000 prefixes)
          was also prepended-to-all. Prepended-to-all prefixes are those seen as prepended by all (or nearly all) of the ASs of the Internet.
          In this configuration, prepending is no longer shaping route propagation but is simply incentivizing ASs to choose another origin 
          if one were to suddenly appear whether by mistake or otherwise. The percentage of the IPv4 table that is prepended-to-all is 
          growing at 0.5% per year. The IPv6 table is growing slower at 0.2% per year. The reasons for using prepend-to-all appears 
          to be due to 1) the AS forgetting to remove the prepending for one of its transit providers when it is no longer needed and 2) the 
          AS attempting to de-prioritize traffic from transit providers over settlement-free peers and 3) there are simply a lot of errors in 
          BGP routing. Consider the prepended AS path below:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">64496 64501 64501 64510 64510 64501 64510 64501 64501
                         64510 64510 64501 64501 64510<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">The prepending here involves a mix of two distinct ASNs (64501 and 64510) with the last two digits transposed.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
<section id="section-3.5">
        <h3 id="name-memory">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-memory" class="section-name selfRef">Memory</a>
        </h3>
<p id="section-3.5-1">Long AS Paths cause an increase in memory usage by BGP speakers. A concern about an AS Path longer than 255 is the 
      extra complexity required to process it, because it needs to be encoded 
       in more than one AS_SEQUENCE in the AS_PATH BGP path attribute.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
</section>
<section id="section-3.6">
        <h3 id="name-errant-announcement">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-errant-announcement" class="section-name selfRef">Errant announcement</a>
        </h3>
<p id="section-3.6-1">It is possible for an Internet-wide outage to occur because of a single errant routing announcement. For example, AS64496 
      could announce its one prefix with an extremely long AS path. Someone could enter their ASN instead of the prepend count.
      64496 modulo 256 = 240 prepends, and when a path lengths exceeded 255, routers could crash.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4">
      <h2 id="name-alternatives-to-as-path-pre">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-alternatives-to-as-path-pre" class="section-name selfRef">Alternatives to AS Path Prepend</a>
      </h2>
<p id="section-4-1">Various options, to provide path preference without needing to use AS Path Prepend, include:<a href="#section-4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-2.1">Use predefined communities that are mapped to a particular behavior when propagated.<a href="#section-4-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.2">Announce more specific routes on the preferred path.<a href="#section-4-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.3">The BGP Origin Code is an attribute that is used for path selection and can be used as a high order tie-breaker.
            The three origin codes are IGP, EGP and INCOMPLETE. When AS Paths are of equivalent length, users could advertise 
            paths, with IGP or EGP origin, over the preferred path while the other ASBRs (which would otherwise need to prepend N times) 
            advertises with an INCOMPLETE origin code.<a href="#section-4-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.4">The Multi Exit Discriminator (MED) is an optional non-transitive attribute that can be used to influence path preference instead of using as-path.
            MED is non transitive so it cannot influence an AS more then 1 AS hop away.<a href="#section-4-2.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-2.5">Local-preference optional non-transitive attribute, above as-path in BGP path selection, can be used to 
            influence route preference within the local operators AS administrative domain. Local-preference can shield the operator domain from 
            traffic shifts off the preferred path to a de-preferred path caused by excess prepending done by service providers across the Internet. If all service 
            providers across the Internet set local-preference inbound conditionally with Large Community set on preferred paths, essentially the impacts of 
            route leaks as well as other routing issues resulting from excess prepending can be mitigated.<a href="#section-4-2.5" class="pilcrow">¶</a>
</li>
      </ul>
<div class="alignLeft art-text artwork" id="section-4-3">
<pre>

                         &lt;-5x     &lt;-5x     &lt;-5x
       LP 110  +---+    +---+    +---+    +---+
           +---| D |----| F |----| H |----| J |
           |   +---+    +---+    +---+    +---+
+---+   +---+             |                 |
| A |---| B |             |                 |
+---+   +---+        13x&lt;-|                 |
           |   +---+    +---+    +---+    +---+
           +---| C |----| E |----| G |----| I |
               +---+    +---+    +---+    +---+


</pre><a href="#section-4-3" class="pilcrow">¶</a>
</div>
<p id="section-4-4">In the diagram above A, B, C, D, E, F G, H, I, J are all part of a different AS.
    B will normally prefer the path via D to send traffic to J, as this represents the preferred path to B, due to E prepending 13 instances of its own 
    AS number when advertising routes to C. ISP J decides to prepend 5 instances of its own AS when advertising to H, and ISP H decides to do the 
    same and prepends 5 instances of its own AS when advertising to F.  ISP F decides to also prepend 5 instances of its own AS when 
    advertising to D.  B now sees 19 AS hops for prefixes coming from D to get to J which should be the preferred path compare to 18 AS hops 
    coming from C which is now preferred. We now have a route leak to I as B now sends all of its traffic through I to reach J.  Route leak on B can 
    be prevented locally within the operator domain by setting local-preference inbound, which is above as-path length in the best path selection, to 
    higher then default 100 to 110 inbound from D, thus shielding the operator B from being influenced by the excessive prepend cascading ripple 
    affect by F, H, J. Note that A still sees the cascading ripple affect of excess prepending, however A, or any service provider AS downstream 
    of B, ingressing B, will be shunted to D via local-preference and the route leak is now mitigated for all downstream AS to the left of B that prefer 
    the path through B.<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
<section id="section-5">
      <h2 id="name-best-practices">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-best-practices" class="section-name selfRef">Best Practices</a>
      </h2>
<p id="section-5-1">Many of the best practices, or lack thereof, can be illustrated from the preceding examples. Here's a summary of the
        best current practices when using AS Path Prepending:<a href="#section-5-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-2.1">Network operators should ensure prepending is absolutely necessary as many networks have excessive prepending.
             It is best to innumerate what the routing policies are intended to achieve before concluding that prepending is a solution<a href="#section-5-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-2.2">The neighbor you are prepending may have an unconditional preference for customer routes and prepending doesn't work. 
             It's helpful to check with neighbors to see if they will honor the prepend to avoid wasting effort and potentially causing further vulnerabilities.<a href="#section-5-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-2.3">Use of local-preference inbound on preferred paths between service providers to help mitigate the adverse affects of prepending<a href="#section-5-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-2.4">There is no need to prepend more than 5 ASs. The following diagram, from the previously referenced AS Path Prepending analysis from 2019, 
            shows that 90% of AS path lengths are 5 ASNs or fewer in length.<a href="#section-5-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<div class="alignLeft art-text artwork" id="section-5-3">
<pre>

  +------------------------------------+
90|                                    |
  |      X                             |
80|     X X                            |
  |     X X                            |
70|     X X                            |
  |    X  X                            |
60|    X  X                            |
  |    X  X                            |
50|   X    X                           |
  |   X    X                           |
40|   X     X                          |
  |   X     X                          |
30|   X     X                          |
  |   X      X                         |
20|   X       XX                       |
  |  XX         XX                     |
10| XX            XXXX                 |
  |XX                 XXXXXXXXXXXXXXXXX|
  +------------------------------------+
              5         10          15
      AS Path Length in IPv4

X Axis = unique AS Paths in millions

</pre><a href="#section-5-3" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-5-4.1">Don't prepend ASNs that you don't own.<a href="#section-5-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.2">Prepending-to-all is a self-inflicted and needless risk that serves little purpose. Those excessively prepending their routes 
        should consider this risk and adjust their routing configuration.<a href="#section-5-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.3">The Internet is typically around 5 ASs deep with the largest AS_PATH being 16-20 ASNs. Some have 
      added 100 or more AS Path Prepends and operators should therefore consider limiting the maximum AS-path 
      length being accepted through aggressive filter policies.<a href="#section-5-4.3" class="pilcrow">¶</a>
</li>
      </ul>
</section>
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1"></p>
</section>
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1"></p>
<p id="section-7-2">Long prepending may make a network more vulnernable to route hijacking which will exist whenever there is 
      a well connected peer that is willing to forge their AS_PATH or allows announcements with a fabricated AS path.<a href="#section-7-2" class="pilcrow">¶</a></p>
</section>
<section id="section-8">
      <h2 id="name-acknowledgement">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgement" class="section-name selfRef">Acknowledgement</a>
      </h2>
<p id="section-8-1"></p>
<p id="section-8-2">The authors would like to thank Greg Skinner, Randy Bush, Dave Farmer, 
      Nick Hilliard, Martijn Schmidt, Michael Still, Geoff Huston and Jeffrey Haas for contributing to this document.<a href="#section-8-2" class="pilcrow">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-normative-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4271">[RFC4271]</dt>
      <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5398">[RFC5398]</dt>
      <dd>
<span class="refAuthor">Huston, G.</span>, <span class="refTitle">"Autonomous System (AS) Number Reservation for Documentation Use"</span>, <span class="seriesInfo">RFC 5398</span>, <span class="seriesInfo">DOI 10.17487/RFC5398</span>, <time datetime="2008-12" class="refDate">December 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5398">https://www.rfc-editor.org/info/rfc5398</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5737">[RFC5737]</dt>
      <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Cotton, M.</span>, and <span class="refAuthor">L. Vegoda</span>, <span class="refTitle">"IPv4 Address Blocks Reserved for Documentation"</span>, <span class="seriesInfo">RFC 5737</span>, <span class="seriesInfo">DOI 10.17487/RFC5737</span>, <time datetime="2010-01" class="refDate">January 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5737">https://www.rfc-editor.org/info/rfc5737</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8195">[RFC8195]</dt>
    <dd>
<span class="refAuthor">Snijders, J.</span>, <span class="refAuthor">Heasley, J.</span>, and <span class="refAuthor">M. Schmidt</span>, <span class="refTitle">"Use of BGP Large Communities"</span>, <span class="seriesInfo">RFC 8195</span>, <span class="seriesInfo">DOI 10.17487/RFC8195</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8195">https://www.rfc-editor.org/info/rfc8195</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Mike McBride</span></div>
<div dir="auto" class="left"><span class="org">Futurewei</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:michael.mcbride@futurewei.com" class="email">michael.mcbride@futurewei.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Doug Madory</span></div>
<div dir="auto" class="left"><span class="org">Kentik</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dmadory@kentik.com" class="email">dmadory@kentik.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jeff Tantsura</span></div>
<div dir="auto" class="left"><span class="org">Microsoft</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jefftant.ietf@gmail.com" class="email">jefftant.ietf@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Robert Raszuk</span></div>
<div dir="auto" class="left"><span class="org">NTT Network Innovations</span></div>
<div dir="auto" class="left"><span class="street-address">940 Stewart Dr</span></div>
<div dir="auto" class="left">
<span class="locality">Sunnyvale</span>, <span class="region">CA</span> <span class="postal-code">94085</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:robert@raszuk.net" class="email">robert@raszuk.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hongwei Li</span></div>
<div dir="auto" class="left"><span class="org">HPE</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:flycoolman@gmail.com" class="email">flycoolman@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jakob Heitz</span></div>
<div dir="auto" class="left"><span class="org">Cisco</span></div>
<div dir="auto" class="left"><span class="street-address">170 West Tasman Drive</span></div>
<div dir="auto" class="left">
<span class="locality">San Jose</span>, <span class="region">CA</span> <span class="postal-code">95134</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jheitz@cisco.com" class="email">jheitz@cisco.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Gyan Mishra</span></div>
<div dir="auto" class="left"><span class="org">Verizon Inc.</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:gyan.s.mishra@verizon.com" class="email">gyan.s.mishra@verizon.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
