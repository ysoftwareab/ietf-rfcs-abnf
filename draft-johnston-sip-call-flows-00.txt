Internet Draft                                           Alan Johnston
Document: draft-johnston-sip-call-flows-00.txt           Steve Donovan
Category: Informational                                  Robert Sparks
                                                      Chris Cunningham
                                                         Kevin Summers
                                                          MCI WorldCom
                                                          October 1999


                    SIP Telephony Call Flow Examples


Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026[1].

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.
   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time. It is inappropriate to use Internet- Drafts as reference
   material or to cite them other than as "work in progress."
   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt
   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.



Abstract

   This document gives examples of SIP IP Telephony call flows.
   Elements in these call flows include SIP User Agents and Clients, SIP
   Proxy and Redirect Servers, and Gateways to the PSTN (Public Switch
   Telephone Network).  Scenarios include SIP Registration, SIP to SIP
   calling, SIP to Gateway, Gateway to SIP, and Gateway to Gateway via
   SIP.  Call flow diagrams and message details are shown.  PSTN
   telephony protocols are illustrated using SS7 (Signaling System 7),
   ISDN (Integrated Services Digital Network) and FGB (Feature Group B)
   circuit associated signaling.  PSTN calls are illustrated using
   global telephone numbers from the PSTN and from private extensions
   served on a PBX (Private Branch Exchange).









Johnston, et al.                                              [Page 1]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


Table of Contents

   1      Overview...................................................3
   1.1    General Assumptions........................................3
   1.2    Legend for Message Flows...................................5
   1.3    SIP Protocol Assumptions...................................6
   2      SIP Registration Services..................................7
   2.1    Success Scenarios..........................................7
    2.1.1 SIP Client New Registration................................7
    2.1.2 User Cancels Registration..................................9
    2.1.3 User updates contact list.................................10
    2.1.4 User Requests Current Contact List........................12
   2.2    Failure Scenarios.........................................13
    2.2.1 Unsuccessful SIP registration.............................13
   3      SIP to SIP Dialing........................................15
   3.1    Success Scenarios.........................................15
    3.1.1 Successful SIP to SIP through two proxies.................16
    3.1.2 Successful SIP to SIP with Proxy failure..................26
    3.1.3 Successful SIP to SIP through SIP Firewall Proxy..........34
    3.1.4 Successful SIP to SIP via Redirect and Proxy..............43
   3.2    Failure Scenarios.........................................50
    3.2.1 Unsuccessful SIP to SIP no answer.........................50
    3.2.2 Unsuccessful SIP to SIP busy..............................56
    3.2.3 Unsuccessful SIP to SIP no response.......................60
    3.2.4 Unsuccessful SIP to SIP Temporarily Unavailable...........65
   4      SIP to Gateway Dialing....................................71
   4.1    Success Scenarios.........................................71
    4.1.1 Successful SIP to ISUP PSTN call..........................72
    4.1.2 Successful SIP to ISDN PBX call...........................79
    4.1.3 Successful SIP to ISUP PSTN call with overflow............87
   4.2    Failure Scenarios.........................................95
    4.2.1 Unsuccessful SIP to PSTN call: Treatment from PSTN........96
    4.2.2 Unsuccessful SIP to PSTN: REL w/Cause from PSTN..........101
    4.2.3 Unsuccessful SIP to PSTN: ANM Timeout....................105
   5      Gateway to SIP Dialing...................................111
   5.1    Success Scenarios........................................111
    5.1.1 Successful PSTN to SIP call..............................112
    5.1.2 Successful PSTN to SIP call, Fast Answer.................118
    5.1.3 Successful PBX to SIP call...............................123
   5.2    Failure Scenarios........................................128
    5.2.1 Unsuccessful PSTN to SIP REL, SIP error mapped to REL....128
    5.2.2 Unsuccessful PSTN to SIP REL, SIP busy mapped to REL.....130
    5.2.3 Unsuccessful PSTN->SIP, SIP error interworking to tones..134
    5.2.4 Unsuccessful PSTN->SIP, ACM timeout......................139
    5.2.5 Unsuccessful PSTN->SIP, ACM timeout, stateless SPS.......144
    5.2.6 Unsuccessful PSTN->SIP, ANM timeout......................150
   6      Gateway to Gateway Dialing via SIP Network...............155
   6.1    Success Scenarios........................................155
    6.1.1 Successful ISUP PSTN to ISUP PSTN call...................156
    6.1.2 Successful FGB PBX to ISDN PBX call with overflow........163



Johnston, et al.            Informational                     [Page 2]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   7      Acknowledgements.........................................172
   8      References...............................................172

1  Overview

   The call flows shown in this document were developed in the design of
   a carrier-class SIP IP Telephony network.  They represent an example
   minimum set of functionality for SIP to be used in IP Telephony
   applications.

   It is the hope of the authors that this document will be useful for
   SIP implementors, designers, and protocol researchers alike and will
   help further the goal of a standard SIP implementation for IP
   Telephony.  It is envisioned that as changes to the standard and
   additional RFCs are added that this document will reflect those
   changes and represent the current state of a standard interoperable
   SIP IP Telephony implementation.

   These call flows are based on the current version 2.0 of SIP in
   RFC2543[2].  Additions and changes to SIP necessary for PSTN
   interworking are referenced as IETF Internet-Drafts as they are used
   in the call flows.

   Various PSTN signaling protocols are illustrated in this document:
   SS7 (Signaling System 7), ISDN (Integrated Services Digital Network),
   and FGB (Feature Group B) circuit associated signaling.  They were
   chosen to illustrate the nature of SIP/PSTN interworking _ they are
   not a complete or even representative set.  Also, some details and
   parameters of these PSTN protocols have been omitted.  The intent of
   this document was not to provide a complete and exact mapping of PSTN
   protocols to SIP.  Rather the emphasis is on the SIP signaling, the
   message interaction, and the modifications to SIP currently proposed
   to solve IP Telephony issues.

   Finally, these call flows show a minimal implementation.  Not even
   basic telephony features such as call forwarding or call waiting are
   included.  A typical carrier-class implementation of a basic set of
   telephony features using SIP is described in another document[3].

1.1 General Assumptions

   A number of architecture, network, and protocol assumptions underlie
   the call flows in this document.  They are outlined in this section
   so that they may be taken into consideration.  Differences in these
   assumptions will affect the nature of the call flows.

   The authentication of SIP User Agents in these example call flows is
   performed using SIP Digest.

   No authentication of Gateways is shown, since it is assumed that:



Johnston, et al.            Informational                     [Page 3]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


     . Gateways will only accept calls routed through a trusted Proxy.
     . Proxies will perform the Client authentication.
     . The Proxy and the Gateway will authenticate each other using
       IPSec[4].
    
   
   The SIP Proxy Server has access to a Location Manager and other
    
   
   databases.  Information present in the Request-URI and the context
   (From header) is sufficient to determine to which proxy or gateway
   the message should be routed.  In most cases, a primary and secondary
   route will be determined in case of Proxy or Gateway failure
   downstream.
    
   
   The Proxy Servers in these call flows insert Record-Route headers
    
   
   into requests to ensure that they are in the signaling path for
   future message exchanges.
    
   
    
   Gateways receive enough information in the Request-URI field to
   determine how to route a call, i.e. what trunk group or link to
   select, what digits to outpulse, etc.
    
   
   Gateways provide tones (ringing, busy, etc) and announcements to the
    
   
   PSTN side based on SIP response messages, or pass along audio in-band
   tones (ringing, busy tone, etc.) in an early media stream to the SIP
   side.
    
   
   Two types of Gateways are described in this document:
    
   
    
   
     . Network Gateway.  This high port count PSTN gateway originates
       and terminates calls to the PSTN.  It's use is shared by many
       customers.  Incoming calls from the PSTN have the From header
       populated with a SIP URL containing the telephone number from
       the calling party telephone number, if available.  A Network
       Gateway typically uses carrier protocols such as SS7.
        
       
     . Enterprise Gateway.  This low port count PBX (Private Branch
       Exchange) gateway has trunks or lines for a single customer or
       user.  Incoming calls from the PBX have the From header
       populated with a provisionable string which uniquely identifies
       the customer, trunk group, or carrier.  This allows private
       numbers to be interpreted in their correct context.  An
       Enterprise Gateway typically uses SS7, ISDN, circuit associated
       signaling, or other PBX interfaces.

   The interactions between the Proxy and Gateway can be summarized as
    
   
   follows:
    
   
     . The SIP Proxy Server performs digit analysis and lookup and
       locates the correct gateway.
        
       




Johnston, et al.            Informational                     [Page 4]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


     . The SIP Proxy Server performs gateway location based on primary
       and secondary routing.
    
   
    
   Digit handling by the Gateways will be  as follows:
        
       
     . Dialed digits received from a Network or Enterprise Gateway will
       be put in a SIP URL with a telephone number.  The number will
       either be globalized (e.g. sip:+1-314-555-1111@ngw.wcom.com
       ;user=phone) or left as a private number (sip:555-6666,phone-
       context=p1234@gw.wcom.com;user=phone) which will require
       interpretation based on From header.  The "phone-context="
       qualifier is used to interpret the private number.  It is used
       the same as the tag of the same name from the Tel URL draft[5].
       However, its use in the user portion of the SIP URL should not
       require changes to parsers.  All Gateways will need to be
       provisioned to be able to parse the user portion of a Request-
       URI to determine the customer, trunk group, or circuit
       referenced.
        
       
     . The From header will be populated with a SIP URL with a
       telephone number if it is Calling Party number (CgPN) from the
       PSTN.  If it is an Enterprise Gateway, a provisionable  string
       which uniquely identifies the customer, trunk group, or carrier
       will be used in the sip URI (e.g. From:
       sip:ProvisionableString@gw1.wcom.com ;user=phone).
    
   
     . Note that an alternative to using a SIP URL for telephone
       numbers is the TEL URL[5].  The major difference between using
       the SIP URL and the TEL URL is that the SIP URL is routable in a
       SIP network (resolves down to an IP address) where the TEL URL
       is not (it just represents digits).  For example, a SIP URL can
       be used in a Contact header, but a TEL URL can not.

   These flows show UDP for transport.  TCP could also be used.

1.2 Legend for Message Flows

   Important Note:  In this text version of this Internet Draft, figures
   containing the message flows have been deleted.  They will be present
   in the next draft of this document.  A PostScript (.ps) and Acrobat
   (.pdf) version are available which contain the figures.

   Dashed lines _ represent control messages that are mandatory to the
   call scenario. These control messages can be SIP or PSTN signaling.

   Solid lines _ represent media paths between network elements.

   Dashed line with parenthesis around name - represent optional control
   messages.




Johnston, et al.            Informational                     [Page 5]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Messages are identified in the Figures as F1, F2, etc.  This
   references the message details in the table that follows the Figure.
   Comments in the message details are shown in the following form:

          /* Comments. */

1.3 SIP Protocol Assumptions

   Except for the following, this call flows document uses the April
   1999 version 2.0 of SIP defined by RFC2543[2].  The following
   changes/extensions are assumed throughout:

     . A Contact header is included with every INVITE message.
        
       
     . A Contact header is included in every 200 OK Response.
        
       
     . The 183 Session Progress response message[5] is used in SIP to
       Gateway and Gateway to Gateway via SIP calling (Sections 4 and
       6). The 183 response with SDP will cause the User Agent to
       immediately play the SDP media stream to hear in-band call
       progress information.  See Section 4 for more information.
        
       
     . A Content-Length header is present in every message, set to zero
       if there is no message body.
        
       
     . The final entry in a Route header is always the Contact
       information obtained from the INVITE or 200 OK messages.
        
       
     . In the SDP message bodies, the time field is "t=0 0"  It is
       expected that an actual SDP message body would have a non-zero
       start timestamp.






















Johnston, et al.            Informational                     [Page 6]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


2  SIP Registration Services

2.1 Success Scenarios

   Registration either validates or invalidates a SIP client for user
   services provided by the SIP proxy and/or SIP server.  Additionally,
   the client provides one or more contact locations to the SIP server
   with the registration request.

2.1.1 
     SIP Client New Registration



   User B initiates a new SIP session with the SIP server (i.e. the user
   "logs on to" the SIP server).  User B sends a SIP REGISTER request to
   the SIP server.  The request includes the user's contact list.  The
   SIP server provides a challenge to User B.  User B enters her/his
   valid user ID and password.  User B's SIP client encrypts the user
   information according to the challenge issued by the SIP server and
   sends the response to the SIP server.  The SIP server validates the
   user's credentials.  It registers the user in its contact database
   and returns a response (200 OK) to User B's SIP client.  The response
   includes the user's current contact list in Contact headers.  The
   format of the authentication shown is SIP digest as described by
   RFC2543[2].

   Message Details


   REGISTER F1
   B->SIP server

   REGISTER sip:ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 123456789@here.com
   CSeq: 1 REGISTER
   Contact: TheLittleGuy <sip:UserB@there.com>
   Contact: sip:+1-972-555-2222@gw1.wcom.com;user=phone
   Contact: tel:+1-972-555-2222
   Content-Length: 0


   Unauthorized F2
   SIP server-> User B

   SIP/2.0 401 Unauthorized
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>



Johnston, et al.            Informational                     [Page 7]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 123456789@here.com
   CSeq: 1 REGISTER
   WWW-Authenticate: Digest realm="MCI WorldCom SIP", domain="wcom.com",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="", stale="FALSE",
   algorithm="MD5"
   Content-Length: 0


   REGISTER F3
   B->SIP server

   REGISTER sip:ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 123456790@here.com
   CSeq: 1 REGISTER
   Contact: TheLittleGuy <sip:UserB@there.com>
   Contact: sip:+1-972-555-2222@gw1.wcom.com;user=phone
   Contact: tel:+1-972-555-2222
   Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss2.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Length: 0




   200 OK  F4
   SIP server
   -> B

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 1234567890@here.com
   CSeq: 1 REGISTER
   Contact: TheLittleGuy <sip:UserB@there.com>
   Contact: sip:+1-972-555-2222@gw1.wcom.com;user=phone
   Contact: tel:+1-972-555-2222
   Content-Length: 0










Johnston, et al.            Informational                     [Page 8]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




2.1.2 
     User Cancels Registration


   User B wishes to cancel her/his registration with the SIP
   registrar/redirect server. User B sends a SIP REGISTER request to the
   SIP server.  The request has an expiration period of 0 and applies to
   all existing contact locations.  Since the user already has
   authenticated with the server, the user supplies authentication
   credentials with the request and is not challenged by the server.
   The SIP server validates the user's credentials.  It clears the
   user's contact list, and returns a response (200 OK) to User B's SIP
   client.

   Message Details


   REGISTER F1
   B->SIP server

   REGISTER sip:ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 123456791@here.com
   CSeq: 1 REGISTER
   Expires: 0
   Contact: *
   Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss2.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Length: 0


   200 OK  F2
   SIP server
   -> B

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 1234567891@here.com
   CSeq: 1 REGISTER
   Content-Length: 0







Johnston, et al.            Informational                     [Page 9]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




2.1.3 
     User updates contact list


   User B wishes to update the list of addresses where the SIP server
   will redirect INVITE requests.  Note this scenario assumes that
   Scenario 2.1.1 has taken place, but 2.1.2 has not (i.e. User B
   currently has 3 contacts registered with SS2.)

   User B sends a SIP REGISTER request to the SIP server.  User B's
   request includes an updated contact list.  Since the user already has
   authenticated with the server, the user supplies authentication
   credentials with the request and is not challenged by the server.
   The SIP server validates the user's credentials.  It registers the
   user in its contact database, updates the user's contact list, and
   returns a response (200 OK) to User B's SIP client.  The response
   includes the user's current contact list in Contact headers.

   Message Details


   REGISTER F1
   B->SIP server

   REGISTER sip:ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 123456791@here.com
   CSeq: 1 REGISTER
   Contact: mailto:UserB@there.com
   Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss2.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Length: 0


   200 OK  F2
   SIP server
   -> B

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 1234567891@here.com
   CSeq: 1 REGISTER
   Contact: TheLittleGuy <sip:UserB@there.com>
   Contact: sip:+1-972-555-2222@gw1.wcom.com;user=phone



Johnston, et al.            Informational                    [Page 10]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Contact: tel:+1-972-555-2222
   Contact: mailto:UserB@there.com
   Content-Length: 0


















































Johnston, et al.            Informational                    [Page 11]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



2.1.4 
     User Requests Current Contact List


   User B sends a register request to the Proxy serverer containing no
   Contact headers, indicating the user wishes to query the server for
   the user's current contact list.  Since the user already has
   authenticated with the server, the user supplies authentication
   credentials with the request and is not challenged by the server. The
   SIP server validates the user's credentials.  It registers the user
   in its contact database and returns a response (200 OK) to User B's
   SIP client.  The response includes the user's current contact list in
   Contact headers.

   Message Details


   REGISTER F1
   B->SIP server

   REGISTER sip:ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 123456792@here.com
   CSeq: 1 REGISTER
   Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss2.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Length: 0


   200 OK  F2
   SIP server
   -> B

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 1234567892@here.com
   CSeq: 1 REGISTER
   Contact: TheLittleGuy <sip:UserB@there.com>
   Contact: sip:+1-972-555-2222@gw1.wcom.com;user=phone
   Contact: tel:+1-972-555-2222
   Contact: mailto:UserB@there.com
   Content-Length: 0






Johnston, et al.            Informational                    [Page 12]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


2.2 Failure Scenarios

2.2.1 
     Unsuccessful SIP registration






   User B sends a SIP REGISTER request to the SIP server.  The SIP
   server provides a challenge to User B.  User B enters her/his user ID
   and password.  User B's SIP client encrypts the user information
   according to the challenge issued by the SIP server and sends the
   response to the SIP server.  The SIP server attempts to validate the
   user's credentials, but they are not valid (the user's password does
   not match the password established for the user's account).  The
   server returns a response (401 Unauthorized) to User B's SIP client.







   Message Details


   REGISTER F1
   B->SIP server

   REGISTER sip:ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 123456789@here.com
   CSeq: 1 REGISTER
   Contact: TheLittleGuy <sip:UserB@there.com>
   Contact: sip:+1-972-555-2222@gw1.wcom.com;user=phone
   Contact: tel:+1-972-555-2222
   Content-Length: 0


   Unauthorized F2
   SIP server-> User B

   SIP/2.0 401 Unauthorized
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 123456789@here.com



Johnston, et al.            Informational                    [Page 13]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   CSeq: 1 REGISTER
   WWW-Authenticate: Digest realm="MCI WorldCom SIP", domain="wcom.com",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="", stale="FALSE",
   algorithm="MD5"
   Content-Length: 0


   REGISTER F3
   B->SIP server

   REGISTER sip:ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 123456791@here.com
   CSeq: 1 REGISTER
   Contact: TheLittleGuy <sip:UserB@there.com>
   Contact: sip:+1-972-555-2222@gw1.wcom.com;user=phone
   Contact: tel:+1-972-555-2222
   Authorization:Digest username="UserB", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss2.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Length: 0




   Note: The response above encodes the incorrect password _IForgot_
   Unauthorized F4
   SIP server-> User B

   SIP/2.0 401 Unauthorized
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-ID: 1234567891@here.com
   CSeq: 1 REGISTER
   WWW-Authenticate: Digest realm="MCI WorldCom SIP", domain="wcom.com",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="", stale="FALSE",
   algorithm="MD5"
   Content-Length: 0












Johnston, et al.            Informational                    [Page 14]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


3  SIP to SIP Dialing

3.1 Success Scenarios

   This section details calls between two SIP User Agent Clients (UACs)
   _ User A and User B.  User A (TheLittleGuy sip:UserA@here.com) and
   User B (TheBigGuy sip:UserB@there.com) are assumed to be SIP phones
   or SIP-enabled devices.  Calls route using at least one SIP Proxy
   server.  The successful calls show the initial signaling, the
   exchange of media information in the form of SDP payloads, the
   establishment of the media session, then finally the termination of
   the call.

   SIP digest authentication is used by the first Proxy Server to
   authenticate the caller User A. It is assumed that User B has
   registered with Proxy Server SS2 as per Section 2.1 to be able to
   receive the calls.




































Johnston, et al.            Informational                    [Page 15]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



3.1.1 
     Successful SIP to SIP through two proxies



   In this scenario, User A completes a call to User B using two proxies
   SS1 and SS2.  The initial INVITE (F1) does not contain the
   Authorization credentials SS1 requires, so a 407 Proxy Authorization
   response is sent containing the challenge information.  A new INVITE
   (F4) is then sent containing the correct credentials and the call
   proceeds.  The call terminates when User B disconnects by initiating
   a BYE message.

   SS1 inserts a Record-Route header into the INVITE message to ensure
   that it is present in all subsequent message exchanges.  SS2 also
   inserts itself into the Record-Route header.  The ACK (F15) and BYE
   (F18) both have a Route header.

   A tag is inserted by User B in message F9 since the initial INVITE
   message contains more than one Via header and may have been forked.


   Message Details


   INVITE F1
   A -> Proxy 1

   INVITE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000









Johnston, et al.            Informational                    [Page 16]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   /* Proxy 1 challenges User A for authentication */

   407 Proxy Authorization Required F2
   Proxy 1 -> User A

   SIP/2.0 407 Proxy Authorization Required
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Proxy-Authenticate: Digest realm="MCI WorldCom SIP",
   domain="wcom.com", nonce="ea9c8e88df84f1cec4341ae6cbe5a359",
   opaque="", stale="FALSE", algorithm="MD5"
   Content-Length: 0


   ACK F3
   A -> Proxy 1

   ACK sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0




   /* User A responds be re-sending the INVITE with authentication
   credentials in it.  */


   INVITE F4
   A -> Proxy 1

   INVITE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length:132



Johnston, et al.            Informational                    [Page 17]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000






   /* Proxy 1 accepts the credentials and forwards the INVITE to Proxy
   2.  Proxy 1 is assumed to have been authenticated by Proxy 2 using
   IPSec.  Client for A prepares to receive data on port 49170 from the
   network. */


   INVITE
   F5
   Proxy
   1 ->
   Proxy
   2


   INVITE sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F6
   Proxy 1
   -> A)



Johnston, et al.            Informational                    [Page 18]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   INVITE F7
   Proxy 2
   ->B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>,<sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F8
   Proxy 2
   -> Proxy 1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F9



Johnston, et al.            Informational                    [Page 19]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   B -> Proxy 2

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180
   Ringin
   g F10
   Proxy 2
   ->
   Proxy
   1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F11
   Proxy1
   ->A

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   200 OK F12
   B -> Proxy 2

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060



Johnston, et al.            Informational                    [Page 20]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>,<sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK
   F13
   Proxy
   2
   ->
   Proxy
   1


   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>,<sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F14
   Proxy 1
   -> A



Johnston, et al.            Informational                    [Page 21]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>,<sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ACK F15
   A -> Proxy 1


   ACK sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:UserB@ss2.wcom.com>,<sip:UserB@there.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345601@here.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F16
   Proxy 1 -> Proxy 2


   ACK sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:UserB@there.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345601@here.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F17



Johnston, et al.            Informational                    [Page 22]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Proxy 2 ->B


   ACK sip: UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345601@here.com
   CSeq: 1 ACK
   Content-Length: 0




   /* RTP streams are established between A and B */





   /* User B Hangs Up with User A. */


   BYE F18
   User B
   -> Proxy 2


   BYE sip: UserA@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   Route: <sip:UserA@ss1.wcom.com>,<sip:UserA@here.com>
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345601@here.com
   CSeq: 1 BYE
   Content-Length: 0


   BYE
   F19
   Proxy
   2 ->
   Proxy
   1


   BYE sip: UserA@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060



Johnston, et al.            Informational                    [Page 23]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP there.com:5060
   Route:  <sip:UserA@here.com>
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345601@here.com
   CSeq: 1 BYE
   Content-Length: 0


   BYE F20
   Proxy 1 -> User A

   BYE sip: UserA@here.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345601@here.com
   CSeq: 1 BYE
   Content-Length: 0


   200 OK F21
   User A
   -> Proxy 1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345601@here.com
   CSeq: 1 BYE
   Content-Length: 0


   200 OK F22
   Proxy 1 -> Proxy 2

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345601@here.com
   CSeq: 1 BYE
   Content-Length: 0




Johnston, et al.            Informational                    [Page 24]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   200 OK F23
   Proxy 2 -> User B

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345601@here.com
   CSeq: 1 BYE
   Content-Length: 0










































Johnston, et al.            Informational                    [Page 25]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



3.1.2 
     Successful SIP to SIP with Proxy failure



In this scenario, User A completes a call to User B via a Proxy Server.
User A is configured for a primary SIP Proxy Server SS1 and a secondary
SIP Proxy Server SS2 (Or is able to use DNS SRV records to locate SS1
and SS2). SS1 is out of service and does not respond to INVITEs (it is
reachable, but unresponsive).  After sending a CANCEL to SS1, User A
then completes the call to User B using SS2.


   Message Details


   INVITE F1
   A -> Proxy 1

   INVITE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   INVITE F2
   A -> Proxy 1

   Same as Message F1


   INVITE F3
   A -> Proxy 1

   Same as Message F1


   INVITE F4



Johnston, et al.            Informational                    [Page 26]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   A -> Proxy 1

   Same as Message F1


   INVITE F5
   A -> Proxy 1

   Same as Message F1


   INVITE F6
   A -> Proxy 1

   Same as Message F1


   INVITE F7
   A -> Proxy 1

   Same as Message F1




   /* User A gives up on the unresponsive proxy and sends a CANCEL.  If
   any 200 OK responses come back to the INVITE, User A sends an ACK,
   then a BYE. */


   CANCEL F8
   A -> Proxy 1

   CANCEL sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   INVITE F9
   A -> Proxy 2

   INVITE sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp



Johnston, et al.            Informational                    [Page 27]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* Proxy 2 challenges User A for authentication */
   407 Proxy Authorization Required F10
   Proxy 2 -> User A

   SIP/2.0 407 Proxy Authorization Required
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Proxy-Authenticate: Digest realm="MCI WorldCom SIP",
   domain="wcom.com", nonce="ea9c8e88df84f1cec4341ae6cbe5a359",
   opaque="", stale="FALSE", algorithm="MD5"
   Content-Length: 0


   ACK F11
   A -> Proxy 2

   ACK sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345601@here.com
   CSeq: 1 INVITE
   Content-Length: 0




   /* User A responds be re-sending the INVITE with authentication
   credentials in it.  */


   INVITE F12
   A -> Proxy 2

   INVITE sip:UserB@ss2.wcom.com SIP/2.0



Johnston, et al.            Informational                    [Page 28]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345602@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss2.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* Proxy 2 accepts the credentials and forwards the INVITE to User B.
   Client for A prepares to receive data on port 49170 from the network.
   */


   INVITE F13
   Proxy 2 ->B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345602@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000





Johnston, et al.            Informational                    [Page 29]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   (100 Trying F14
   Proxy 2 -> User A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345602@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F15
   B -> Proxy 2

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345602@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F16
   Proxy 2
   -> A

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345602@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   200 OK F17
   B -> Proxy 2

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345602@here.com
   CSeq: 1 INVITE



Johnston, et al.            Informational                    [Page 30]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F18
   Proxy 2 ->A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345602@here.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ACK F19
   A -> Proxy 2


   ACK sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:UserB@there.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345602@here.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F20
   Proxy 2 ->B



Johnston, et al.            Informational                    [Page 31]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   ACK sip: UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345602@here.com
   CSeq: 1 ACK
   Content-Length: 0




   /* RTP streams are established between A and B */



   /* User B Hangs Up with User A. */
   BYE F21
   User B
    -> Proxy 2


   BYE sip: UserA@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   Route: <sip:UserA@here.com>
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345602@here.com
   CSeq: 1 BYE
   Content-Length: 0


   BYE F22
   Proxy 2 -> User A

   BYE sip: UserA@here.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345602@here.com
   CSeq: 1 BYE
   Content-Length: 0


   200 OK F23
   User A
   -> Proxy 2



Johnston, et al.            Informational                    [Page 32]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345602@here.com
   CSeq: 1 BYE
   Content-Length: 0


   200 OK F24
   Proxy 2 -> User B

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345602@here.com
   CSeq: 1 BYE
   Content-Length: 0
































Johnston, et al.            Informational                    [Page 33]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



3.1.3 
     Successful SIP to SIP through SIP Firewall Proxy


   User A completes a call to User B through a Firewall Proxy and a SIP
   Proxy.  The signaling message exchange is identical to 3.1.1 but the
   media stream setup is not end-to-end _ the Firewall proxy terminates
   both media streams and bridges them.  This is done by the Proxy
   modifying the SDP in the INVITE (F1) and 200 OK (F11) messages.

   In addition to firewall traversal, this back-to-back User Agent
   Client and User Agent Server could be used as part of an anonymizer
   service (in which all identifying information on User A would be
   removed), or to perform codec media conversion, such as mu-law to A-
   law conversion of PCM on an international call.






   Message Details


   INVITE F1
   A->SIP FW

   INVITE sip:UserB@ fwp1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000







Johnston, et al.            Informational                    [Page 34]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Client for A prepares to receive data on port 49170 from the
   network.*/


   INVITE F2
   SS FW -> SS1

   INVITE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@fwp1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length:134

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 200.201.202.203
   m=audio 1000 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F3
   SIP FW-> A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0




   /* SIP FW prepares to proxy data from port 1000 to
   100.101.102.103/49170.   SS1 uses a location manager function to
   determine where B is actually located. Based upon location analysis
   the call is forwarded to User B */





Johnston, et al.            Informational                    [Page 35]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   INVITE F4
   SS1->B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss1.wcom.com>,<sip:UserB@fwp1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length:134

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 200.201.202.203
   m=audio 1000 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F5
   SS1 -> SIP FW)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   (100 Trying F6
   B -> SS1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0




Johnston, et al.            Informational                    [Page 36]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   180 Ringing F7
   B->SS1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F8
   SS1 -> SIP FW

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F9
   SIP FW
   -> A

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   200 OK F10
   B->SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss1.wcom.com>,<sip:UserB@fwp1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>



Johnston, et al.            Informational                    [Page 37]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 133

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F11
   SS1 -> SIP FW

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss1.wcom.com>,<sip:UserB@fwp1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a =rtpmap:0 PCMU/8000


   200 OK F12
   SIP FW
   -> A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss1.wcom.com>,<sip:UserB@fwp1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>



Johnston, et al.            Informational                    [Page 38]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 200.201.202.203
   m=audio 1002 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* The gateway prepares to proxy packets from port 1001 to
   110.111.112.113/3456
   ACK F13
   A->SIP FW


   ACK sip:UserB@fwp1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:ss1.wcom.com>, <sip:UserB@there.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F14
   SIP FW -> SS1


   ACK sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:UserB@there.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F15
   SS1->B


   ACK sip: UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060



Johnston, et al.            Informational                    [Page 39]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0




   /* RTP streams are established between A and the SIP GW and between
   the SIP GW and B*/



   /* User A Hangs Up with User B. */
   BYE F16
   A->SIP FW


   BYE sip: UserB@fwp1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:ss1.wcom.com>, <sip:UserB@there.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   BYE F17
   SIP FW
    -> SS1


   BYE sip: UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:UserB@there.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   BYE F18
   SS1->B




Johnston, et al.            Informational                    [Page 40]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   BYE sip: UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F19
   B->SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F20
   SS1 -> SIP FW

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP fwp1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F21
   SIP FW
    -> A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0




Johnston, et al.            Informational                    [Page 41]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999























































Johnston, et al.            Informational                    [Page 42]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




3.1.4 
     Successful SIP to SIP via Redirect and Proxy



   In this scenario, User A places a call to User B using first a
   Redirect server then a Proxy Server.  The INVITE message is first
   sent to the Redirect Server.  The Server returns a 302 Moved
   Temporarily response (F2) containing a Contact header with User B's
   current SIP address.  User A then generates a new INVITE and sends to
   User B via the Proxy Server and the call proceeds normally.

   The call is terminated when User B sends a BYE message.







































Johnston, et al.            Informational                    [Page 43]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   Message Details


   INVITE F1
   A->Redir Proxy

   INVITE sip:UserB@redirect.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /*Client for A prepares to receive data on port 49170 from the
   network.*/


   302 Moved Temporarily F2
   Redir Proxy
    ->A

   SIP/2.0 302 Moved Temporarily
   Contact: sip:UserB@ss2.wcom.com
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F3
   A->Redir Proxy

   ACK sip:UserB@redirect.wcom.com SIP/2.0



Johnston, et al.            Informational                    [Page 44]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   INVITE F4
   A -> Proxy

   INVITE sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 2 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   INVITE F5
   Proxy -> B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 2 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000



Johnston, et al.            Informational                    [Page 45]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   (100 Trying F6
   Proxy
   -> A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 2 INVITE
   Content-Length: 0


   (100 Trying ) F7 B
   -> Proxy

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 2 INVITE
   Content-Length: 0


   180 Ringing F8
   B->Proxy

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 INVITE
   Content-Length: 0


   180 Ringing F9
   Proxy->A

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 INVITE



Johnston, et al.            Informational                    [Page 46]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Content-Length: 0


   200 OK F10
   B->Proxy

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F11
   Proxy->A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ACK F12
   A -> Proxy



Johnston, et al.            Informational                    [Page 47]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   ACK sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:UserB@there.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 ACK
   Content-Length: 0


   ACK F13
   Proxy -> B


   ACK sip: UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 ACK
   Content-Length: 0




   /* RTP streams are established between A and B*/



   /* User B Hangs Up with User A. */
   BYE F14
   B->Proxy


   BYE sip: UserA@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP there.com:5060
   Route: <sip:UserA@here.com>
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345600@here.com
   CSeq: 1 BYE
   Content-Length: 0


   BYE F15
   Proxy->A




Johnston, et al.            Informational                    [Page 48]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   BYE sip: UserA@here.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345600@here.com
   CSeq: 1 BYE
   Content-Length: 0


   200 OK F16
   A -> Proxy

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345600@here.com
   CSeq: 1 BYE
   Content-Length: 0


   200 OK F17
   Proxy -> B

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP there.com:5060
   From: TheLittleGuy <sip:UserB@there.com>;tag=314159
   To: TheBigGuy <sip:UserA@here.com>
   Call-Id: 12345600@here.com
   CSeq: 1 BYE
   Content-Length: 0




















Johnston, et al.            Informational                    [Page 49]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


3.2 Failure Scenarios

3.2.1 
     Unsuccessful SIP to SIP no answer



   In this scenario, User A gives up on the call before User B answers
   (sends a 200 OK response).  User A sends a CANCEL (F9) since no final
   response had been received from User B.  If a 200 OK to the INVITE
   had crossed with the CANCEL, User A would have sent an ACK then a BYE
   to User B in order to properly terminate the call.

   Note that the CSeq of the CANCEL message (F9) is not incremented.
   This is so that downstream clients can match the To, From, Call-ID,
   and CSeq of the CANCEL to the INVITE to decide which request to
   terminate.





































Johnston, et al.            Informational                    [Page 50]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   Message Details


   INVITE F1
   A -> Proxy 1

   INVITE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length:132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /*Client for A prepares to receive data on port 49170 from the
   network.*/


   INVITE F2
   Proxy 1 -> Proxy 2

   INVITE sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length:132

   v=0



Johnston, et al.            Informational                    [Page 51]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F3
   Proxy 1 -> A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   INVITE F4
   Proxy 2 ->B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>,<sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F5
   Proxy 2 -> Proxy 1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>



Johnston, et al.            Informational                    [Page 52]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F6
   B -> Proxy 2

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F7
   Proxy 2 -> Proxy 1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F8
   Proxy1
   -> A

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0









Johnston, et al.            Informational                    [Page 53]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   /* User A gives up and sends a CANCEL. If a 200 OK reply to the
   INVITE crossed with the CANCEL and was received by User A, User A
   would send an ACK then a BYE to terminate the call.*/


   CANCEL F9
   A -> Proxy 1


   CANCEL sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   CANCEL F10
   Proxy 1 -> Proxy 2


   CANCEL sip: UserA@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   CANCEL F11
   Proxy 2 ->B

   CANCEL sip: UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   200 OK F12
   A -> Proxy 1

   SIP/2.0 200 OK



Johnston, et al.            Informational                    [Page 54]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   200 OK F13
   Proxy 1 -> Proxy 2

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   200 OK F14
   Proxy 2 ->B

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0




















Johnston, et al.            Informational                    [Page 55]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



3.2.2 
     Unsuccessful SIP to SIP busy



   In this scenario, User B is busy and sends a 486 Busy Here response
   to User A's INVITE.  The 4xx response is ACKed at each signaling leg.

   Message Details


   INVITE F1
   User A
   -> Proxy 1

   INVITE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /*Client for A prepares to receive data on port 49170 from the
   network.*/
   INVITE F2
   Proxy 1 -> Proxy 2

   INVITE sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com



Johnston, et al.            Informational                    [Page 56]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F3
   Proxy 1 -> User A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   INVITE F4
   Proxy 2 ->
   User B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>,<sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000





Johnston, et al.            Informational                    [Page 57]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   (100 Trying F5
   Proxy 2 -> Proxy 1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   486 Busy Here F6 User B
   -> Proxy 2

   SIP/2.0  486 Busy Here
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F7
   Proxy 2 -> User B


   ACK sip: UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   486 Busy Here F8 Proxy 2 -> Proxy 1

   SIP/2.0  486 Busy Here
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0



Johnston, et al.            Informational                    [Page 58]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   ACK F9
   Proxy 1 -> Proxy 2


   ACK sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   486 Busy Here F10
   Proxy 1 -> User A

   SIP/2.0  486 Busy Here
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F11
   User A
   -> Proxy 1


   ACK sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0














Johnston, et al.            Informational                    [Page 59]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



3.2.3 
     Unsuccessful SIP to SIP no response



   In this example, there is no response from User B to User A's INVITE
   messages being re-transmitted by Proxy 2.  After the sixth re-
   transmission, Proxy 2 gives up and sends a CANCEL to User B and a 480
   No Response to User A.  Note that the CANCEL would also be
   retransmitted six times, as governed by SIP timer T1 as in Section
   5.2.6.









   Message Details


   INVITE F1
   User A
   -> Proxy 1

   INVITE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000







Johnston, et al.            Informational                    [Page 60]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   /*Client for A prepares to receive data on port 49170 from the
   network.*/
   INVITE F2
   Proxy 1 -> Proxy 2

   INVITE sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F3
   Proxy 1 -> User A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   INVITE F4
   Proxy 2 -> User B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>,<sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>



Johnston, et al.            Informational                    [Page 61]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F5
   Proxy 2 -> Proxy 1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   INVITE F6
   Proxy 2 -> User B

   Resend of Message F4
   INVITE F7
   Proxy 2 -> User B

   Resend of Message F4
   INVITE F8
   Proxy 2 -> User B

   Resend of Message F4
   INVITE F9
   Proxy 2 -> User B

   Resend of Message F4
   INVITE F10
   Proxy 2 -> User B

   Resend of Message F4
   INVITE F11
   Proxy 2 -> User B

   Resend of Message F4
   CANCEL F12
   Proxy 2 -> User B



Johnston, et al.            Informational                    [Page 62]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   CANCEL sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   480 No Response F13 Proxy 2 -> Proxy 1

   SIP/2.0  480 No Response
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F14
   Proxy 1 -> Proxy 2


   ACK sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   480 No Response F15
   Proxy 1 -> User A

   SIP/2.0  480 No Response
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F16
   User A
   -> Proxy 1



Johnston, et al.            Informational                    [Page 63]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   ACK sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0












































Johnston, et al.            Informational                    [Page 64]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



3.2.4 
     Unsuccessful SIP to SIP Temporarily Unavailable



   In this scenario, User B initially sends a 180 Ringing response to
   User A, indicating that alerting is taking place.  However, then a
   480 Unavailable is then sent to User A.  This response is
   acknowledged then proxied back to User A.












































Johnston, et al.            Informational                    [Page 65]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999





   Message Details


   INVITE F1
   A -> Proxy 1

   INVITE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /*Client for A prepares to receive data on port 49170 from the
   network.*/
   INVITE F2
   Proxy 1 -> Proxy 2

   INVITE sip:UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0



Johnston, et al.            Informational                    [Page 66]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   INVITE F3
   Proxy 2 -> B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:UserB@ss2.wcom.com>,<sip:UserB@ss1.wcom.com>
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4
   Proxy 1 -> A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   (100 Trying F5
   Proxy 2 -> Proxy 1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>



Johnston, et al.            Informational                    [Page 67]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   (100 Trying F6
   User B
   -> Proxy 2)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F7
   B -> Proxy 2

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F8
   Proxy 2 -> Proxy 1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F9
   Proxy 1



Johnston, et al.            Informational                    [Page 68]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   -> A

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   480 Temporarily Unavailable F10
   B -> Proxy 2

   SIP/2.0 480 Temporarily Unavailable
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F11
   Proxy 2 ->B

   ACK sip: UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss2.wcom.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   480 Temporarily Unavailable F12
   Proxy 2 -> Proxy 1

   SIP/2.0 480 Temporarily Unavailable
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0





Johnston, et al.            Informational                    [Page 69]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   ACK F13
   Proxy 1 -> Proxy 2


   ACK sip: UserB@ss2.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   480 Temporarily Unavailable F14
   Proxy1
   -> A

   SIP/2.0 480 Temporarily Unavailable
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F15
   A -> Proxy 1


   ACK sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:UserA@here.com>
   To: TheLittleGuy <sip:UserB@there.com>;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0
















Johnston, et al.            Informational                    [Page 70]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



4  SIP to Gateway Dialing


   In the following scenarios, User A (TheBigGuy sip:UserA@here.com) is
   a SIP phone or other SIP-enabled device.  User B is reachable via the
   PSTN at global telephone number +1-972-555-2222. User A places a call
   to User B through a Proxy Server SS1 and a Network Gateway.  In other
   scenarios, User A places calls to User C, who is served via a PBX
   (Private Branch Exchange) and is identified by a private extension
   444-3333, or global number +1-918-555-3333.  Note that User A uses
   his/her global telephone number +1-314-555-1111 in the From header in
   the INVITE messages.  This then gives the Gateway the option of using
   this header to populate the calling party identification field in
   subsequent signaling (CgPN in ISUP).  Left open is the issue of how
   the Gateway can determine the accuracy of the telephone number,
   necessary before passing it as a valid CgPN in the PSTN.  Note that
   User A still uses his/her SIP URL in the Contact header.

   There is a major SIP issue in the call flows in this section and
   Section 6.  In-band alerting (ringing tone, busy tone, recorded
   announcements, etc.) is present in the PSTN speech path after the
   receipt of the SS7 Address Complete Message (ACM) which maps to the
   SIP 180 Ringing response.  In a SIP to SIP call, the media path is
   not established until the call is answered (200 OK sent).  In order
   for the SIP caller User A to hear this alerting, it is necessary that
   an early media path be established to perform this.  This is the
   purpose of the 183 Session Progress[5] responses used throughout this
   document in place of the 180 Ringinig.

   This document will be updated as this issue is further refined, with
   the possible inclusion of reliable responses[6] and/or additional SIP
   headers.

4.1 Success Scenarios

   In these scenarios, User A is a SIP phone or other SIP-enabled
   device.  User A places a call to User B in the PSTN or User C on a
   PBX through a Proxy Server SS1 and a Gateway.














Johnston, et al.            Informational                    [Page 71]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




4.1.1 
     Successful SIP to ISUP PSTN call


   User A dials the globalized E.164 number +1-972-555-2222 to reach
   User B.  Note that A might have only dialed the last 7 digits, or
   some other dialing plan.  It is assumed that the SIP User Agent
   Client converts the digits into a global number and puts them into a
   SIP URL.

   User A could use either their SIP address (sip:UserA@here.com) or SIP
   telephone number (sip:+1-314-555-1111@ss1.wcom.com;user=phone) in the
   From header.  In this example, the telephone number is included, and
   it is shown as being passed as calling party identification through
   the Network Gateway to User B (F5).  Note that for this number to be
   passed into the SS7 network, it would have to be somehow verified for
   accuracy.

   In this scenario, User B answers the call then User A disconnects the
   call.  Signaling between NGW1 and User B's telephone switch is SS7.


   Message Details


   INVITE F1
   A->SS1

   INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000





Johnston, et al.            Informational                    [Page 72]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   (100 Trying F2
   SS1 -> User A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to NGW1.  Client for A prepares to receive data on port 49170 from
   the network.*/


   INVITE F3
   SS1
    -> NGW1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4
   GW -> SS1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone



Johnston, et al.            Informational                    [Page 73]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   IAM F5
   GW -> User B

   IAM
   CdPN=972-555-2222,NPI=E.164,NOA=National
   CgPN=314-555-1111,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   ACM F6
   User B
    -> GW

   ACM
   Charge Indicator=No Charge
   Called Party Status=no indication
   Called Party's Category=ordinary subscriber
   End To End Method=none available
   Interworking=encountered
   End to End Information=none available
   ISUP Indicator=not used all the way
   ISDN Access Terminating access non ISDN
   Echo Control=not included
   183 Session Progress F7
   GW -> SS1

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000



Johnston, et al.            Informational                    [Page 74]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999






   /* SS1 proxies the OK to User A
   At this point the GW will start sendin an RTP path to the receive
   port on A encoding anything that is being received from B via the
   PSTN network (i.e. ringing) */


   183 Session Progress F8
   SS1
   ->User A

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ANM F9
   User B
    -> GW

   ANM

   200 OK F10
   GW -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE



Johnston, et al.            Informational                    [Page 75]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Contact: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F11
   SS1
   ->User A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ACK F12
   A->SS1


   ACK sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:+1-972-555-2222@ngw1.wcom.com;user=phone>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0




Johnston, et al.            Informational                    [Page 76]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   ACK F13
   SS1 -> GW


   ACK sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0




   /* RTP streams are established between A and B(via the GW) */



   /* User A Hangs Up with User B. */
   BYE F14
   A->SS1


   BYE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:+1-972-555-2222@ngw1.wcom.com;user=phone>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   BYE F15
   SS1 -> GW


   BYE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE



Johnston, et al.            Informational                    [Page 77]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Content-Length: 0


   200 OK F16
   GW -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F17
   SS1->A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   REL F18
   GW -> B

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F19
   B -> GW

   RLC













Johnston, et al.            Informational                    [Page 78]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




4.1.2 
     Successful SIP to ISDN PBX call

   User A is a SIP device while User C is connected via an Enterprise
   Gateway (GW1) to a PBX.  The PBX connection is via a ISDN trunk
   group.  User A dials User C's telephone number (918-555-3333) which
   is globalized and put into a SIP URL.

   The phone-context in the username portion of the Request-URI in
   message F3 is used to identify the context (customer, trunk group, or
   line) in which the private number 444-3333 is valid.  Otherwise, this
   INVITE message could get forwarded and the context of the digits
   could become lost and the call unroutable.  See section 1.1 for a
   discussion of phone-context.

   Proxy SS1 looks up the telephone number and locates the Enterprise
   Gateway that servers User C.  User C is identified by its extension
   (444-3333) in the Request-URI sent to GW1.

   User A hears the ringing provided by the Gateway on the media path
   established after the 183 Session Progress response is received.
   Signaling between GW1 and PBX C is shown as ISDN.

   Message Details


   INVITE F1
   A->SS1

   INVITE sip:+1-918-555-3333@ss1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




Johnston, et al.            Informational                    [Page 79]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   (100 Trying F2
   SS1 -> User A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1 with the extension determined as 444-3333.  Client for A
   prepares to receive data on port 49170 from the network.*/


   INVITE F3
   SS1 -> GW1

   INVITE sip:444-3333,phone-context=p1234@gw1.wcom.com;user=phone
   SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4
   GW -> SS1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060



Johnston, et al.            Informational                    [Page 80]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   SETUP F5
   GW -> User C

   Protocol discriminator=Q.931
   Call reference: Flag=0, CR  value=any valid value not in use
   Message type=SETUP
   Bearer capability: Information transfer capability=0 (Speech) or 16
   (3.1 kHz audio)
   Channel identification=Preferred or exclusive B-channel
   Progress indicator=1 (Call is not end-to-end ISDN;further call
   progress information may be available inband)
   Called party number:
   Type of number and numbering plan ID=?? (private numbering plan)
   Digits=444-3333
   CALL PROCeeding F6
   User C
    -> GW

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F5 SETUP message
   Message type=CALL PROC
   Channel identification=Exclusive B-channel
   PROGress F7
   User C
    -> GW

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F5 SETUP message
   Message type=PROG
   Progress indicator=1 (Call is not end-to-end ISDN;further call
   progress information may be available inband)
   183 Session Progress F8
   GW -> SS1

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp



Johnston, et al.            Informational                    [Page 81]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* The GW will establish an RTP path to the receive port on A
   encoding anything that is being received from C via the PSTN network
   (i.e. ringing)
   183 Session Progress F9
   SS1
   ->User A

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   CONNect F10
   User C
    -> GW

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F5 SETUP message
   Message type=CONN
   CONNect ACK F11
   GW  -> User C

   Protocol discriminator=Q.931
   Call reference: Flag=0, CR  value=value in F5 SETUP message
   Message type=CONN ACK



Johnston, et al.            Informational                    [Page 82]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   200 OK F12
   GW -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: sip:444-3333,phone-context=p1234@gw1.wcom.com ;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F13
   SS1
   ->User A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: sip:444-3333,phone-context=p1234@gw1.wcom.com ;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ACK F14
   A->SS1



Johnston, et al.            Informational                    [Page 83]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   ACK sip:444-3333,phone-context=p1234@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:444-3333,phone-context=p1234@gw1.wcom.com> ;user=phone
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F15
   SS1 -> GW


   ACK sip:444-3333,phone-context=p1234@gw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0




   /* RTP streams are established between A and B(via the GW) */



   /* User A Hangs Up with User B. */
   BYE F16
   A->SS1


   BYE sip:444-3333,phone-context=p1234@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:444-3333,phone-context=p1234@gw1.wcom.com>;user=phone
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0





Johnston, et al.            Informational                    [Page 84]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   BYE F17
   SS1 -> GW


   BYE sip:444-3333,phone-context=p1234@gw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F18
   GW -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F19
   SS1->A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheOtherGuy <sip:+1-918-555-3333@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   DISConnect F20
   GW -> User C

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F4 SETUP message
   Message type=DISC
   Cause=16 (Normal clearing)
   RELease F21



Johnston, et al.            Informational                    [Page 85]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   User C
   -> GW

   Protocol discriminator=Q.931
   Call reference: Flag=0, CR  value=value in F4 SETUP message
   Message type=REL
   RELease COMplete F22
   GW -> User C

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F4 SETUP message
   Message type=REL COM









































Johnston, et al.            Informational                    [Page 86]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



4.1.3 
     Successful SIP to ISUP PSTN call with overflow
   User A calls User B through SS1 working as a proxy server.  SS1 tries
   an Enterprise Gateway GW1. GW1 is not available and responds with a
   503 Service Unavailable (F4).  The call is then routed to a Network
   Gateway NGW2.  User B answers the call.  The call is terminated when
   User A disconnects the call.  NGW2 and User B's telephone switch use
   SS7 signaling.

   Message Details


   INVITE F1
   A->SS1

   INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS1 uses a location manager function to determine where B is
   actually located.  SS1 receives a primary route NGW1 and a secondary
   route NGW2.  NGW1 is tried first */


   INVITE F2
   SS1 -> NGW1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>



Johnston, et al.            Informational                    [Page 87]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F3 Proxy -> User A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   503 Service Unavailable F4
   NGW1-> SS1

   SIP/2.0 503 Service Unavailable
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com
   ;user=phone;tag=123456789
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0




   /* See table below for possible responses resulting in attempt to
   next route in list.

   408 Request Timeout
   413 Request Entity Too Large



Johnston, et al.            Informational                    [Page 88]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   480 Temporarily Unavailable
   500 Server Internal Error
   501 Not Implemented
   502 Bad Gateway
   503 Service Unavailable
   504 Gateway Timeout
   505 Version Not Supported
    */


   ACK F5
   SS1 -> GW2


   ACK sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=123456789
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0




   /* SS1 now tries secondary route to NGW2 */
   INVITE F6 SS1
   -> NGW2

   INVITE sip:+1-972-555-2222@ngw2.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000





Johnston, et al.            Informational                    [Page 89]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   IAM F7
   NGW2 -> User B

   IAM
   CdPN=972-555-2222,NPI=E.164,NOA=National
   CgPN=314-555-1111,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   ACM F8
   User B
    -> NGW2

   ACM
   Charge Indicator=No Charge
   Called Party Status=no indication
   Called Party's Category=ordinary subscriber
   End To End Method=none available
   Interworking=encountered
   End to End Information=none available
   ISUP Indicator=not used all the way
   ISDN Access Terminating access non ISDN
   Echo Control=not included
   183 Session Progress F9
   NGW2
   -> SS1

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000








Johnston, et al.            Informational                    [Page 90]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   /* The GW will establish an RTP path to the receive port on A
   encoding anything that is being received from B via the PSTN network
   (i.e. ringing) */


   183 Session Progress F10
   SS1 -> User A

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ANM F11
   User B
    -> NGW2

   ANM

   200 OK F12
   NGW2
    -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: sip:+1-972-555-2222@ngw2.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0



Johnston, et al.            Informational                    [Page 91]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F13
   SS1
    -> User A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: sip:+1-972-555-2222@ngw2.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ACK F14
   A->SS1


   ACK sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:+1-972-555-2222@ngw2.wcom.com>;user=phone
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F15
   SS1 -> NGW2





Johnston, et al.            Informational                    [Page 92]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   ACK sip:+1-972-555-2222@ngw2.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0




   /* RTP streams are established between A and B(via the GW) */



   /* User A Hangs Up with User B. */
   BYE F16
   A->SS1


   BYE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   Route: <sip:+1-972-555-2222@ngw2.wcom.com>;user=phone
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   BYE F17
   SS1 -> NGW2


   BYE sip:+1-972-555-2222@ngw2.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F18
   NGW2 -> SS1



Johnston, et al.            Informational                    [Page 93]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F19
   SS1-> User A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 2 BYE
   Content-Length: 0


   REL F20
   GW -> B

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F21
   B -> GW

   RLC


















Johnston, et al.            Informational                    [Page 94]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



4.2  Failure Scenarios

   In these failure scenarios, the call does not complete.  In most
   cases, however, a media stream is still setup.  This is due to the
   fact that most failures in dialing to the PSTN result in in-band
   tones (busy, reorder tones) or announcements ("The number you have
   dialed has changed.  The new number is...").  The 183 Session
   Progress[5] response containing SDP media information is used to
   setup this early media path so that the caller User A knows the final
   disposition of the call.

   The media stream is either terminated by the caller after the tone or
   announcement has been heard and understood, or by the Gateway after a
   timer expires.

   In other failure scenarios, a SS7 Release with Cause Code is mapped
   to a SIP response.  In these scenarios, the early media path is not
   used, but the actual failure code is conveyed to the caller by the
   SIP User Agent Client.

































Johnston, et al.            Informational                    [Page 95]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



4.2.1 
     Unsuccessful SIP to PSTN call: Treatment from PSTN

   User A calls User B in the PSTN through a proxy server SS1 and a
   Network Gateway NGW1.  The call is rejected by the PSTN with an in-
   band treatment (tone or recording) played.  User A hears the
   treatment and then issues a CANCEL (F9) to terminate the call. (A BYE
   is not sent since no final response was ever received by User A.)


   Message Details


   INVITE F1
   A->SS1

   INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying  F2 SS1  -> A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0







Johnston, et al.            Informational                    [Page 96]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to NGW1.  Client for A prepares to receive data on port 49170 from
   the network.*/


   INVITE F3
   SS1 ->   NGW1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4 NGW1-> SS1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   IAM F5
   GW -> User B

   IAM
   CdPN=972-555-2222,NPI=E.164,NOA=National
   CgPN=314-555-1111,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required



Johnston, et al.            Informational                    [Page 97]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   ACM F6
   User B
    -> GW

   ACM
   Charge Indicator=No Charge
   Called Party Status=no indication
   Called Party's Category=ordinary subscriber
   End To End Method=none available
   Interworking=encountered
   End to End Information=none available
   ISUP Indicator=not used all the way
   ISDN Access Terminating access non ISDN
   Echo Control=not included
   183 Session Progress F7
   GW -> SS1

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   183 Session Progress F8
   SS1
   ->User A

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150




Johnston, et al.            Informational                    [Page 98]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* User A listens to recorded announcement from the PSTN then hangs
   up */


   CANCEL F9
   A->SS1


   CANCEL sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   CANCEL F10
   SS1 -> GW


   CANCEL sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   200 OK F11
   GW -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone



Johnston, et al.            Informational                    [Page 99]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   200 OK F12
   SS1->A

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 CANCEL
   Content-Length: 0


   REL F13
   GW -> B

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F14
   B -> GW

   RLC























Johnston, et al.            Informational                   [Page 100]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




4.2.2 
     Unsuccessful SIP to PSTN: REL w/Cause from PSTN
   User A calls PSTN User B through a Proxy Server SS1 and a Network
   Gateway NGW1.  However, User A does not provide enough digits for the
   call to be completed. (In a real scenario, this call might have been
   rejected by SS1 based on incomplete address.  However, especially on
   international calls, the number of digits in the number is not
   obvious, and this scenario may result.)  The call is rejected by the
   PSTN with a SS7 Release message REL containing a specific Cause
   value.  This cause value (28) is mapped by the Gateway to a SIP 484
   Address Incomplete response which is proxied back to User A.

   Message Details


   INVITE F1
   A->SS1

   INVITE sip:+1-972-555-222@ss1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying  F2 SS1  -> A)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0




Johnston, et al.            Informational                   [Page 101]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999





   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to NGW1.  Client for A prepares to receive data on port 49170 from
   the network. */


   INVITE F3
   SS1
   -> NGW1

   INVITE sip:+1-972-555-222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4 NGW1-> SS1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   IAM F5
   GW -> User B

   IAM
   CdPN=972-555-2222,NPI=E.164,NOA=National
   CgPN=314-555-1111,NPI=E.164,NOA=National



Johnston, et al.            Informational                   [Page 102]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   REL F6
   User B
    -> GW

   REL
   CauseValue=28 Address Incomplete
   CodingStandard=CCITT
   RLC F7
   GW -> User B

   RLC


   /* Network Gateway maps CauseValue=28 to the SIP message 484 Address
   Incomplete */


   484 Address Incomplete F8
   GW -> SS1

   SIP/2.0 484 Address Incomplete
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-222@ss1.wcom.com>;user=phone;
   tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F9
   SS1 -> GW

   ACK sip:+1-972-555-222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-222@ss1.wcom.com>;user=phone;
   tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   484 Address Incomplete F10
   SS1 -> User A



Johnston, et al.            Informational                   [Page 103]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   SIP/2.0 484 Address Incomplete
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-222@ss1.wcom.com>;user=phone;
   tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F11
   User A
    -> SS1

   ACK sip:+1-972-555-222@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-222@ss1.wcom.com>;user=phone;
   tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0






























Johnston, et al.            Informational                   [Page 104]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



4.2.3 
      Unsuccessful SIP to PSTN: ANM Timeout



   User A calls User B in the PSTN through a proxy server SS1 and a
   Gateway GW1.  The call is released by the Gateway after its ISUP T9
   timer expires due to no ANswer Message (ANM) being received.  The
   Gateway sends a SS7 Release REL message to the PSTN and a 480
   Temporarily Unavailable response to User A in the SIP network.











































Johnston, et al.            Informational                   [Page 105]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   Message Details


   INVITE F1
   A->SS1

   INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Authorization:Digest username="UserA", realm="MCI WorldCom SIP",
   nonce="ea9c8e88df84f1cec4341ae6cbe5a359", opaque="",
   uri="sip:ss1.wcom.com", response="dfe56131d1958046689cd83306477ecc"
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1.  Client for A prepares to receive data on port 49170 from the
   network.*/


   (100 Trying F2 SS1
    -> A)

   SIP/2.0  100 Trying
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   INVITE F3
   SS1 -> GW1



Johnston, et al.            Informational                   [Page 106]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   Record-Route: <sip:+1-314-555-1111@ss1.wcom.com>
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Contact: TheBigGuy <sip:UserA@here.com>
   Content-Type: application/sdp
   Content-Length: 132

   v=0
   o=UserA 2890844526 2890844526 IN IP4 here.com
   t=0 0
   c=IN IP4 here.com
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4 GW1
    -> SS1)

   SIP/2.0  100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>;user=phone
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   IAM F5
   GW -> User B

   IAM
   CdPN=972-555-2222,NPI=E.164,NOA=National
   CgPN=314-555-1111,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   ACM F6
   User B
    -> GW

   ACM
   Charge Indicator=No Charge
   Called Party Status=no indication



Johnston, et al.            Informational                   [Page 107]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Called Party's Category=ordinary subscriber
   End To End Method=none available
   Interworking=encountered
   End to End Information=none available
   ISUP Indicator=not used all the way
   ISDN Access Terminating access non ISDN
   Echo Control=not included
   183 Session Progress F7
   GW -> SS1

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   183 Session Progress F8
   SS1 -> User A

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000





Johnston, et al.            Informational                   [Page 108]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   /* After ISUP T9 Timer expires, Network Gateway sends REL to ISUP
   network and 480 to SIP network */


   REL F9 GW -> User B

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F10 User B
    -> GW

   RLC
   480 Temporarily Unavailable F11
   GW -> SS1

   SIP/2.0 480 Temporarily Unavailable
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F12
   SS1 -> GW

   ACK sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0


   480 Temporarily Unavailable F13
   SS1 -> User A

   SIP/2.0 480 Temporarily Unavailable
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159



Johnston, et al.            Informational                   [Page 109]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Call-Id: 12345600@here.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F14
   User A
    -> SS1

   ACK sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP here.com:5060
   From: TheBigGuy <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   To: TheLittleGuy <sip:+1-972-555-2222@ss1.wcom.com>
   ;user=phone;tag=314159
   Call-Id: 12345600@here.com
   CSeq: 1 ACK
   Content-Length: 0




































Johnston, et al.            Informational                   [Page 110]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



5  Gateway to SIP Dialing

5.1 Success Scenarios

   In these scenarios, User A is placing calls from the PSTN to User B
   in a SIP network.  User A's telephone switch signals to a Network
   Gateway (NGW1) using SS7.

   Since the called SIP User Agent does not send in-band signaling
   information, no early media path needs to be established on the IP
   side.  As a result, the 183 Session Progress response is not used.
   However, NGW1 will establish a one way speech path prior to call
   completion, and generate ringing for the PSTN caller.  Any tones or
   recordings are generated by NGW1 and played in this speech path.
   When the call completes successfully, NGW1 bridges the PSTN speech
   path with the IP media path.




































Johnston, et al.            Informational                   [Page 111]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



5.1.1 
     Successful PSTN to SIP call


   In this scenario, User A from the PSTN calls User B through a Network
   Gateway NGW1 and Proxy Server SS1.  When User B answers the call the
   media path is setup end-to-end.  The call terminates when User A
   hangs up the call, with User A's telephone switch sending a SS7
   Release message which is mapped to a BYE by NGW1.

   Message Details


   IAM F1
   User A -> GW

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=972-555-2222,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   INVITE F2
   A->SS1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1.  GW1  prepares to receive data on port 3456 from User A.*/




Johnston, et al.            Informational                   [Page 112]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   INVITE F3
   SS1
   ->User B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4 User B -> SS1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F5 User B -> SS1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com>;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F6 SS1



Johnston, et al.            Informational                   [Page 113]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


    -> NGW1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACM F7
   NGW1-> User A

   ACM
   Charge Indicator=No Charge
   Called Party Status=no indication
   Called Party's Category=ordinary subscriber
   End To End Method=none available
   Interworking=encountered
   End to End Information=none available
   ISUP Indicator=not used all the way
   ISDN Access Terminating access non ISDN
   Echo Control=not included
   200 OK F8 User B -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   Contact: TheLittleGuy <sip:UserB@there.com>
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F9 SS1
    -> NGW1

   SIP/2.0 200 OK



Johnston, et al.            Informational                   [Page 114]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ACK F10 GW1 -> SS1

   ACK sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Route: <sip:UserB@there.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F11 SS1 -> User B

   ACK sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   ANM F12
   User B
    -> NGW1

   ANM






Johnston, et al.            Informational                   [Page 115]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   /* RTP streams are established between A and B (via the GW) */



   /* User A Hangs Up with User B. */
   REL F13
   User A
    -> NGW1

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F14
   NGW1-> User A

   RLC
   BYE F15
   NGW1-> SS1

   BYE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Route: <sip:UserB@there.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0


   BYE F16
   SS1 -> User B

   BYE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F17
   User B
    -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone



Johnston, et al.            Informational                   [Page 116]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F18 SS1 -> NGW1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0






































Johnston, et al.            Informational                   [Page 117]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



5.1.2 
     Successful PSTN to SIP call, Fast Answer



   This "fast answer" scenario is similar to 5.1.1 except that User B
   immediately accepts the call, sending a 200 OK (F5) without sending a
   180 Ringing response.  The Gateway then sends an Answer Message (ANM)
   without sending an Address Complete Message (ACM).

   Message Details


   IAM F1
   User A -> GW

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=972-555-2222,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   INVITE F2
   GW -> SS1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to User B.  User B  prepares to receive data on port 3456 from User
   A.*/



Johnston, et al.            Informational                   [Page 118]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   INVITE F3
   SS1 -> User B

   INVITE UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4
   SS1 -> GW1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   200 OK F5 User B -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 150



Johnston, et al.            Informational                   [Page 119]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F6 SS1
   -> GW1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ACK F7 GW1
   ->SS1

   ACK UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Route: <sip:UserB@there.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F8 SS1
   ->User B

   ACK UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060



Johnston, et al.            Informational                   [Page 120]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   ANM F9
   User B
   ->GW

   ANM



   /* RTP streams are established between A and B (via the GW) */



   /* User A Hangs Up with User B. */
   REL F10
   User A
   ->GW

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F11
   GW -> User A

   RLC
   BYE F12
   GW -> SS1

   BYE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Route: <sip:UserB@there.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0


   BYE F13
   SS1 -> User B

   BYE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060



Johnston, et al.            Informational                   [Page 121]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F14
   User B
   -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F15 SS1 ->GW

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0























Johnston, et al.            Informational                   [Page 122]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



5.1.3 
     Successful PBX to SIP call



   In this scenario, User A calls from PBX A to User B through GW1 and
   SS1 working as a proxy server.  Signaling between PBX A and GW1 is
   Feature Group B (FGB) circuit associated signaling (in-band mult-
   frequency outpulsing).  After the receipt of the 180 Ringing from
   User B, GW1 generates ringing tone for User A.

   User B answers the call by sending a 200 OK.  The call terminates
   when User A hangs up, causing GW1 to send a BYE.

   Message Details


   MF Digits F1
   PBX A
   ->GW1

   KP 1 972 555 2222 ST
   INVITE F2
   A->SS1

   INVITE sip:+1-972-555-2222@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 1 INVITE
   Contact: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1.*/





Johnston, et al.            Informational                   [Page 123]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   INVITE F3
   SS1
   ->User B

   INVITE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 1 INVITE
   Contact: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4 SS1
   -> GW)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F5 User B -> SS1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone
   ;tag=314159
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F6 SS1



Johnston, et al.            Informational                   [Page 124]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   -> GW1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0




   /* One way Voice path is established between GW and the PBX for
   ringing. */


   200 OK F7 User B -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@gw1.wcom.com
   Contact: TheLittleGuy <sip:UserB@there.com>
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F8 SS1
   -> GW1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 1 INVITE
   Contact: TheLittleGuy <sip:UserB@there.com>



Johnston, et al.            Informational                   [Page 125]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=UserB 2890844527 2890844527 IN IP4 there.com
   t=0 0
   c=IN IP4 110.111.112.113
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ACK F9 GW1
   ->SS1

   ACK sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Route: <sip:UserB@there.com>
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F10 SS1
   ->User B

   ACK sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0




   /* RTP streams are established between A and B (via the GW) */



   /* User A Hangs Up with User B. */
   BYE F11
   GW -> SS1

   BYE sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Route: <sip:UserB@there.com>



Johnston, et al.            Informational                   [Page 126]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0


   BYE F12
   SS1 -> User B

   BYE sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F13
   User B
   -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0


   200 OK F14 SS1 ->GW

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>;user=phone
   To: sip:+1-972-555-2222@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@gw1.wcom.com
   CSeq: 2 BYE
   Content-Length: 0










Johnston, et al.            Informational                   [Page 127]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


5.2 Failure Scenarios

5.2.1 
     Unsuccessful PSTN to SIP REL, SIP error mapped to REL




   User A attempts to call a SIP user through SS1 working as a proxy
   server.  SS1 is unable to find any routing for the number.  The call
   is rejected by SS1 with a REL message containing a specific Cause
   value mapped by the gateway based on the SIP error.

   Message Details


   IAM F1
   User A
   -> GW

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=972-555-9999,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   INVITE F2
   A->SS1

   INVITE sip:+1-972-555-9999@ngw1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-9999@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000








Johnston, et al.            Informational                   [Page 128]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1.  GW1  prepares to receive data on port 3456 from User A.*/


   604 Does Not Exist Anwhere F3
   SS1 -> GW

   SIP/2.0 604 Does Not Exist Anywhere
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-9999@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F4 GW1
   ->SS1

   ACK sip:+1-972-555-9999@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-9999@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   REL F5
   GW -> User A

   REL
   CauseCode=1
   CodingStandard=CCITT
   RLC F6
   User A
   -> GW

   RLC













Johnston, et al.            Informational                   [Page 129]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999





5.2.2 
     Unsuccessful PSTN to SIP REL, SIP busy mapped to REL


   In this scenario, User A calls User B through a Gateway GW1 and SS1
   working as a proxy server.  The call is routed to User B via the
   gateway.  The call is rejected by the User B who sends a 600 Busy
   Everywhere response.  The Gateway sends a REL message containing a
   specific Cause value mapped by the gateway based on the SIP error.

   Since no interworking is indicated in the IAM (F1), the busy tone is
   generated locally by User A's telephone switch.  In scenario 5.2.3,
   the busy signal is generated by the Gateway since interworking is
   indicated.





































Johnston, et al.            Informational                   [Page 130]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   Message Details


   IAM F1
   User A
   -> GW

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=972-555-2222,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   INVITE F2
   A->SS1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1.  GW1  prepares to receive data on port 3456 from User A.*/


   INVITE F3
   SS1
   ->User B

   INVITE UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060



Johnston, et al.            Informational                   [Page 131]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4 SS1
   -> GW1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   600 Busy Everywhere F5 User B
   -> SS1

   SIP/2.0 600 Busy Everywhere
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F6 SS1
   ->User B

   ACK UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159



Johnston, et al.            Informational                   [Page 132]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   600 Busy Everywhere F7 SS1 -> GW1

   SIP/2.0 600 Busy Everywhere
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F8 GW1
   ->SS1

   ACK UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   REL F9
   User A
   ->GW

   REL
   CauseCode=17 Busy
   CodingStandard=CCITT
   RLC F10
   GW -> User A

   RLC














Johnston, et al.            Informational                   [Page 133]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



5.2.3 
     Unsuccessful PSTN->SIP, SIP error interworking to tones


   In this scenario, User A calls User B through SS1 working as a proxy
   server.  The call is routed to User B via the gateway.  The call is
   rejected by the User B client.  GW1 plays busy tone, and releases
   call after timeout.

   GW1 plays the busy tone since the IAM (F1) indicates the interworking
   is present.  In scenario 5.2.2, with no interworking, the busy
   indication is carried in the REL Cause value and is generated locally
   instead.








































Johnston, et al.            Informational                   [Page 134]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   Message Details


   IAM F1
   User A
   -> GW

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=972-555-2222,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   Interworking=encountered
   INVITE F2
   A->SS1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1.  GW1  prepares to receive data on port 3456 from User A.*/


   INVITE F3
   SS1
   ->User B

   INVITE UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060



Johnston, et al.            Informational                   [Page 135]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying F4 User B -> SS1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   600 Busy Everywhere F5 User B
   -> SS1

   SIP/2.0 600 Busy Everywhere
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F6 SS1
   ->User B

   ACK UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060



Johnston, et al.            Informational                   [Page 136]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   600 Busy Everywhere F7 SS1 -> GW1

   SIP/2.0 600 Busy Everywhere
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACK F8 GW1
   ->SS1

   ACK sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   ACM F9
   User B
   ->GW

   ACM
   Charge Indicator=No Charge
   Called Party Status=no indication
   Called Party's Category=ordinary subscriber
   End To End Method=none available
   Interworking=encountered
   End to End Information=none available
   ISUP Indicator=not used all the way
   ISDN Access Terminating access non ISDN
   Echo Control=not included


   /* One way speech path established between GW and User A. */





Johnston, et al.            Informational                   [Page 137]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   /* Call Released after NGW treatment timer expires. */


   REL F10
   User A
   ->GW

   REL
   CauseCode=17
   CodingStandard=CCITT
   RLC F11
   GW -> User A

   RLC





































Johnston, et al.            Informational                   [Page 138]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999





5.2.4 
     Unsuccessful PSTN->SIP, ACM timeout


   User A calls User B through SS1 working as a proxy server.  SS1 re-
   sends the INVITE after the expiration of SIP timer T1.  User B never
   responds with 180 Ringing _ it is reachable but unresponsive.  After
   the expiration of ISUP T7 timer, User A's network disconnects the
   call by sending a Release message REL.  The Gateway maps this to a
   CANCEL which is re-sent by SS1 after SIP T1 timer expires.

   Message Details


   IAM F1
   User A
   -> GW

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=972-555-2222,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   INVITE F2
   A->SS1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000







Johnston, et al.            Informational                   [Page 139]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1.  GW1  prepares to receive data on port 3456 from User A.*/


   INVITE F3
   SS1
   ->User B

   INVITE sip:UserB@there.com  SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   c t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   100 Trying F4 SS1
   -> GW

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   INVITE F5
   GW -> SS1

   Same as Message F3




   INVITE F6



Johnston, et al.            Informational                   [Page 140]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   SS1
   ->User B

   Same as Message F3




   INVITE F7
   SS1
   ->User B

   Same as Message F3




   INVITE F8
   SS1
   ->User B

   Same as Message F3


   INVITE F9
   SS1
   ->User B

   Same as Message F3




   /* ISUP Timer T7 expires in User A's access network. */

   REL F10
   User A
   ->GW

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F11
   GW -> User A

   RLC
   CANCEL F12
   GW -> SS1

   CANCEL sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0



Johnston, et al.            Informational                   [Page 141]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 CANCEL
   Content-Length: 0


   CANCEL F13
   SS1 -> User B

   CANCEL sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 CANCEL
   Content-Length: 0


   CANCEL F14
   GW -> SS1

   Same as Message F13


   CANCEL F15
   SS1
   ->User B

   Same as Message F13


   CANCEL F16
   SS1
   ->User B

   Same as Message F13


   CANCEL F17
   SS1
   ->User B

   Same as Message F13


   CANCEL F18
   SS1



Johnston, et al.            Informational                   [Page 142]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   ->User B

   Same as Message F13


















































Johnston, et al.            Informational                   [Page 143]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



5.2.5 
     Unsuccessful PSTN->SIP, ACM timeout, stateless SPS



   In this scenario, User A calls User B through SS1 working as a
   stateless proxy server.  Since SS1 is stateless, GW1 re-sends the
   INVITE and CANCEL messages after the expiration of SIP timer T1.
   User B does not respond with 180 Ringing.  User A's network
   disconnects the call with a release REL.











































Johnston, et al.            Informational                   [Page 144]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   Message Details


   IAM F1
   User A
   -> GW

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=972-555-2222,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   INVITE F2
   GW -> SS1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1.  GW1  prepares to receive data on port 3456 from User A.*/


   INVITE F3
   SS1-> User B

   INVITE sip:UserB@there.com  SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>



Johnston, et al.            Informational                   [Page 145]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   INVITE F4
   GW -> SS1

   Same as Message F2


   INVITE F5
   SS1 -> User B

   Same as Message F3


   INVITE F6
   GW -> SS1

   Same as Message F2


   INVITE F7
   SS1 -> User B

   Same as Message F3


   INVITE F8
   GW -> SS1

   Same as Message F2


   INVITE F9
   SS1 -> User B

   Same as Message F3



Johnston, et al.            Informational                   [Page 146]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   INVITE F10
   GW -> SS1

   Same as Message F2


   INVITE F11
   SS1 -> User B

   Same as Message F3


   INVITE F12
   GW -> SS1

   Same as Message F2


   INVITE F13
   SS1 -> User B

   Same as Message F3




   /* ISUP T7 Timer expires in User A's access network. */


   REL F14
   User A
   ->GW

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F15
   GW -> User A

   RLC
   CANCEL F16
   GW -> SS1

   CANCEL sip:+1-972-555-2222@ngw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com



Johnston, et al.            Informational                   [Page 147]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   CSeq: 1 CANCEL
   Content-Length: 0


   CANCEL F17
   SS1 -> User B

   CANCEL sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 CANCEL
   Content-Length: 0


   CANCEL F18
   GW -> SS1

   Same as Message F16
   CANCEL F19
   SS1 -> User B

   Same as Message F17
   CANCEL F20
   GW -> SS1

   Same as Message F16
   CANCEL F21
   SS1 -> User B

   Same as Message F17
   CANCEL F22
   GW -> SS1

   Same as Message F16
   CANCEL F23
   SS1 -> User B

   Same as Message F17
   CANCEL F24
   GW -> SS1

   Same as Message F16
   CANCEL F25
   SS1 -> User B

   Same as Message F17
   CANCEL F26



Johnston, et al.            Informational                   [Page 148]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   GW -> SS1

   Same as Message F16
   CANCEL F27
   SS1 -> User B

   Same as Message F17














































Johnston, et al.            Informational                   [Page 149]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



5.2.6 
     Unsuccessful PSTN->SIP, ANM timeout



   In this scenario, User A calls User B through SS1 working as a proxy
   server.  User B does not respond with 200 OK.  User A disconnects the
   call with a Release message REL which is mapped by GW1 to a CANCEL.
   Note that if User B had sent a 200 OK response after the REL, GW1
   would have sent an ACK then a BYE to properly terminate the call.











































Johnston, et al.            Informational                   [Page 150]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   Message Details


   IAM F1
   User A
   -> GW

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=972-555-2222,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   INVITE F2
   A->SS1

   INVITE sip:+1-972-555-2222@ngw1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS1 uses a location manager function to determine where B is
   actually located.  Based upon location analysis the call is forwarded
   to GW1.  GW1  prepares to receive data on port 3456 from User A.*/


   INVITE F3
   SS1
   ->User B

   INVITE sip:UserB@there.com  SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060



Johnston, et al.            Informational                   [Page 151]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 150

   v=0
   o=GATEWAY1 2890844527 2890844527 IN IP4 gatewayone.wcom.com
   t=0 0
   c=IN IP4 gatewayone.wcom.com
   m=audio 3456 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   (100 Trying  F4 User B -> SS1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing  F5 User B -> SS1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   180 Ringing F6 SS1
   -> GW1

   SIP/2.0 180 Ringing
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone



Johnston, et al.            Informational                   [Page 152]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   ACM F7
   GW -> User A

   ACM
   Charge Indicator=No Charge
   Called Party Status=no indication
   Called Party's Category=ordinary subscriber
   End To End Method=none available
   Interworking=encountered
   End to End Information=none available
   ISUP Indicator=not used all the way
   ISDN Access Terminating access non ISDN
   Echo Control=not included


   /* ISUP Timer T9 expires in User A's access network. */


   REL F8
   User A
   -> GW

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F9
   GW -> User A

   RLC
   CANCEL F10
   GW -> SS1

   CANCEL sip:UserB@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 CANCEL
   Content-Length: 0


   CANCEL F11
   SS1 -> User B




Johnston, et al.            Informational                   [Page 153]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   CANCEL sip:UserB@there.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 CANCEL
   Content-Length: 0


   200 OK F12
   User B
   -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 CANCEL
   Content-Length: 0


   200 OK F13 SS1 -> GW

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-972-555-2222@ngw1.wcom.com;user=phone;tag=314159
   Call-Id: 12345602@ngw1.wcom.com
   CSeq: 1 CANCEL
   Content-Length: 0




















Johnston, et al.            Informational                   [Page 154]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



6  Gateway to Gateway Dialing via SIP Network

   In these scenarios, both the caller and the called party are in the
   telephone network, either normal PSTN subscribers or PBX extensions.
   The calls route through two Gateways and at least one SIP Proxy
   Server.  The Proxy Server performs the authentication and location of
   the Gateways.

   Note that the proposed INFO method[8] is not currently included in
   this document. It is anticipated that a future version will include
   an example of this.

   Again it is noted that the intent of this call flows document is not
   to provide a detailed parameter level mapping of SIP to PSTN
   protocols.  For information on SIP to ISUP mapping, the reader is
   referred to other references[9].

6.1 Success Scenarios

   In these scenarios, the call is successfully completed between the
   two Gateways allowing the PSTN or PBX users to communicate.  The 183
   Session Progress response is used to establish a media path between
   the two Gateways, allowing in-band alerting to pass from the called
   party telephone switch to the caller.




























Johnston, et al.            Informational                   [Page 155]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



6.1.1 
     Successful ISUP PSTN to ISUP PSTN call

   In this scenario, User A in the PSTN calls User C who is served as an
   extension on a PBX.  User A's telephone switch signals via SS7 to the
   Network Gateway NGW1, while User C's PBX signals via SS7 with the
   Enterprise Gateway GW2.  The CdPN and CgPN are mapped into SIP URLs
   and placed in the To and From headers.  SS1 looks up the dialed
   digits in the Request-URI and maps the digits to the PBX extension of
   User C served by GW2.  The INVITE is then forwarded to GW2 for call
   completion.  An early media path is established end-to-end so that
   User A can hear the ringing tone generated by PBX C.

   User C answers the call and the media path is cut through in both
   directions.  User B hangs up terminating the call.

   Message Details


   IAM F1
   User A
   -> GW

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=972-555-2222,NPI=E.164,NOA=National
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   INVITE F2
   GW1 -> SS1

   INVITE sip:+1-918-555-3333@ss1.wcom.com;user=phone  SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-918-555-3333@ss1.wcom.com;user=phone
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=GW1 2890844526 2890844526 IN IP4 gw1.wcom.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




Johnston, et al.            Informational                   [Page 156]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999





   /* SS uses a location manager function to determine where B is
   actually located.  Response is returned listing onnet and offnet
   routes. */


   INVITE F3
   SS1 -> GW2

   INVITE sip:444-3333,phone-context=p1234@gw2.wcom.com;user=phone
   SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-918-555-3333@ss1.wcom.com;user=phone
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=GW1 2890844526 2890844526 IN IP4 gw1.wcom.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   IAM F4
   GW2 -> User C

   IAM
   CgPN=314-555-1111,NPI=E.164,NOA=National
   CdPN=444-3333,NPI=Private,NOA=Subscriber
   USI=Speech
   CPT=0 0
   C=Normal
   CCI =Not Required
   ACM F5
   User C
   -> GW2

   ACM
   Charge Indicator=No Charge
   Called Party Status=no indication
   Called Party's Category=ordinary subscriber



Johnston, et al.            Informational                   [Page 157]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   End To End Method=none available
   Interworking=encountered
   End to End Information=none available
   ISUP Indicator=not used all the way
   ISDN Access Terminating access non ISDN
   Echo Control=not included


   /* Based on PROGress message, GW3 returns a 183 response with SDP
   allowing in-band call progress indications to be sent to the
   originator.  */


   183 Session Progress F6
   GW2 -> SS1

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=PBX_B 987654321 987654321 IN IP4 gw2.wcom.com
   t=0 0
   c=IN IP4 100.101.102.104
   m=audio 14918 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   183 Session Progress F7
   SS1 -> GW1

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=PBX_B 987654321 987654321 IN IP4 gw2.wcom.com
   t=0 0
   c=IN IP4 100.101.102.104



Johnston, et al.            Informational                   [Page 158]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   m=audio 14918 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* GW1 receives packets from GW2 with encoded ringback, tones or
   other audio.  GW1 decodes this and places it on the originating
   trunk. */


   ACM F8
   GW1
   ->User A

   ACM
   Charge Indicator=No Charge
   Called Party Status=no indication
   Called Party's Category=ordinary subscriber
   End To End Method=none available
   Interworking=encountered
   End to End Information=none available
   ISUP Indicator=not used all the way
   ISDN Access Terminating access non ISDN
   Echo Control=not included


   /* User B answers */
   ANM F9
   User C
   -> GW2

   ANM

   200 OK F10
   GW2 -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:444-3333,phone-context=p1234@gw2.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 134

   v=0



Johnston, et al.            Informational                   [Page 159]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
   t=0 0
   c=IN IP4 100.101.102.104
   m=audio 14918 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F11
   SS1 -> GW1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Record-Route: <sip:+1-972-555-2222@ss1.wcom.com>
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:444-3333,phone-context=p1234@gw2.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
   t=0 0
   c=IN IP4 100.101.102.104
   m=audio 14918 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   ANM F12
   GW1 -> User A

   ANM

   ACK F13
   GW1 -> SS1


   ACK sip:444-3333,phone-context=p1234@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   Route: <sip:444-3333,phone-context=p1234@gw2.wcom.com>;user=phone
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F14
   SS1 -> GW3



Johnston, et al.            Informational                   [Page 160]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   ACK sip:444-3333,phone-context=p1234@gw2.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP ngw1.wcom.com:5060
   From: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   To: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0




   /* RTP streams are established between GW1 and GW2. */



   /* User B Hangs Up with User A. */
   REL F15
   User C-> GW2

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   BYE F16
   GW3 -> SS1


   BYE sip:+1-314-555-1111@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP gw2.wcom.com:5060
   Route: <sip:+1-314-555-1111@ngw1.wcom.com>;user=phone
   From: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   To: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 4 BYE
   Content-Length: 0


   RLC F17
   GW2
   ->User C

   RLC
   BYE F18
   SS1 -> GW1


   BYE sip:+1-314-555-1111@gw1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060



Johnston, et al.            Informational                   [Page 161]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Via: SIP/2.0/UDP gw2.wcom.com:5060
   From: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   To: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 4 BYE
   Content-Length: 0


   200 OK F19
   GW1 -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw2.wcom.com:5060
   From: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   To: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 4 BYE
   Content-Length: 0


   200 OK F20
   SS11
   ->GW3

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP gw2.wcom.com:5060
   From: sip:+1-918-555-3333@ss1.wcom.com;user=phone;tag=314159
   To: sip:+1-314-555-1111@ngw1.wcom.com;user=phone
   Call-Id: 12345600@ngw1.wcom.com
   CSeq: 4 BYE
   Content-Length: 0


   REL F21
   User C-> GW2

   REL
   CauseCode=16 Normal
   CodingStandard=CCITT
   RLC F22
   GW2
   ->User C

   RLC








Johnston, et al.            Informational                   [Page 162]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




6.1.2 
     Successful FGB PBX to ISDN PBX call with overflow




   PBX User A calls PBX User C via GW1 using SS1 as a Proxy Server.
   During the attempt to reach User C via GW2, an error is encountered _
   SS1 receives a 503 Service Unavailable (F4) response to the forwarded
   INVITE.  This could be due to all circuits being busy, or some other
   outage at GW2.  SS1 recognizes the error and uses an alternative
   route via GW3 to terminate the call.  From there, the call proceeds
   normally with User C answering the call.  The call is terminated when
   User C hangs up.


   Message Details


   PBX A
   ->GW1

   Seizure

   GW1 -> PBX A

   Wink
   MF Digits F1
   PBX A
   ->GW1

   KP 444 3333 ST
   INVITE F2
   GW1 -> SS1

   INVITE sip:444-3333,phone-context=p1234@ss1.wcom.com;user=phone
   SIP/2.0
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com;user=phone
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 INVITE
   Contact: PBX_A <sip:IdentifierString@gw1.wcom.com>
   Content-Type: application/sdp
   Content-Length: 136

   v=0
   o=PBX_A 2890844526 2890844526 IN IP4 gw1.wcom.com
   t=0 0



Johnston, et al.            Informational                   [Page 163]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* SS uses a location manager function to determine where B is
   actually located.  Response is returned listing onnet and offnet
   routes. */


   INVITE F3
   SS1 -> GW2

   INVITE sip:444-3333,phone-context=p1234@gw2.wcom.com;user=phone
   SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Record-Route: <sip:444-3333,phone-context=p1234@ss1.wcom.com>
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com;user=phone
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 INVITE
   Contact: PBX_A <sip:IdentifierString@gw1.wcom.com>
   Content-Type: application/sdp
   Content-Length: 136

   v=0
   o=PBX_A 2890844526 2890844526 IN IP4 gw1.wcom.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   503 Service Unavailable F4
   GW2 -> SS1

   SIP/2.0 503 Service Unavailable
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=314159
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0





Johnston, et al.            Informational                   [Page 164]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   ACK F5
   SS1 -> GW2


   ACK sip:444-3333,phone-context=p1234@gw2.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=314159
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   INVITE F6
   SS1 -> GW3

   INVITE sip:+1-918-555-3333@gw3.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Record-Route: <sip:444-3333,phone-context=p1234@ss1.wcom.com>
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com;user=phone
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 INVITE
   Contact: PBX_A <sip:IdentifierString@gw1.wcom.com>
   Content-Type: application/sdp
   Content-Length: 136

   v=0
   o=PBX_A 2890844526 2890844526 IN IP4 gw1.wcom.com
   t=0 0
   c=IN IP4 100.101.102.103
   m=audio 49170 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   SETUP F7
   GW3-> PBX C

   Protocol discriminator=Q.931
   Call reference: Flag=0, CR  value=any valid value not in use
   Message type=SETUP
   Bearer capability: Information transfer capability=0 (Speech) or 16
   (3.1 kHz audio)
   Channel identification=Preferred or exclusive B-channel
   Progress indicator=1 (Call is not end-to-end ISDN;further call
   progress information may be available inband)
   Called party number:



Johnston, et al.            Informational                   [Page 165]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Type of number and numbering plan ID=33 (National number in ISDN
   numbering plan)
   Digits=918-555-3333

   (100 Trying F8
   GW3
   ->SS1)

   SIP/2.0 100 Trying
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com;user=phone
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 INVITE
   Content-Length: 0


   CALL PROCeeding F9
   PBX C
   -> GW3

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F9 SETUP message
   Message type=CALL PROC
   Channel identification=Exclusive B-channel
   PROGress F10
   PBX C
   -> GW3

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F9 SETUP message
   Message type=PROG
   Progress indicator=1 (Call is not end-to-end ISDN;further call
   progress information may be available inband)


   /* Based on PROGress message, GW3 returns a 183 response with SDP
   allowing in-band call progress indications to be sent to the
   originator.  */


   183 Session Progress F11
   GW3 -> SS1

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789



Johnston, et al.            Informational                   [Page 166]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
   t=0 0
   c=IN IP4 100.101.102.104
   m=audio 14918 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   183 Session Progress F12
   SS1 -> GW1

   SIP/2.0 183 Session Progress
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 INVITE
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
   t=0 0
   c=IN IP4 100.101.102.104
   m=audio 14918 RTP/AVP 0
   a=rtpmap:0 PCMU/8000




   /* GW1 receives packets from GW3 with encoded ringback, tones or
   other audio.  GW1 decodes this and places it on the originating
   trunk. */


   CONNect F13
   PBX C
   -> GW3

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F9 SETUP message
   Message type=CONN
   200 OK F14
   GW3 -> SS1



Johnston, et al.            Informational                   [Page 167]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Record-Route: <sip:444-3333,phone-context=p1234@ss1.wcom.com>
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-918-555-3333@gw3.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
   t=0 0
   c=IN IP4 100.101.102.104
   m=audio 14918 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   200 OK F15
   SS1 -> GW1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Record-Route: <sip:444-3333,phone-context=p1234@ss1.wcom.com>
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 INVITE
   Contact: sip:+1-918-555-3333@gw3.wcom.com;user=phone
   Content-Type: application/sdp
   Content-Length: 134

   v=0
   o=PBX_B 987654321 987654321 IN IP4 gw3.wcom.com
   t=0 0
   c=IN IP4 100.101.102.104
   m=audio 14918 RTP/AVP 0
   a=rtpmap:0 PCMU/8000


   GW1 -> PBX A

   Seizure
   ACK F16
   GW1 -> SS1



Johnston, et al.            Informational                   [Page 168]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   ACK sip:+1-918-555-3333@ss1.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   Route: <sip:+1-918-555-3333@gw3.wcom.com;user=phone>
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   ACK F17
   SS1 -> GW3


   ACK sip:+1-918-555-3333@gw3.wcom.com;user=phone SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw1.wcom.com:5060
   From: PBX_A <sip:IdentifierString@gw1.wcom.com>
   To: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 ACK
   Content-Length: 0


   CONNect ACK F18
   GW3-> PBX C

   Protocol discriminator=Q.931
   Call reference: Flag=0, CR  value=value in F9 SETUP message
   Message type=CONN ACK


   /* RTP streams are established between GW1 and GW3. */



   /* User B Hangs Up with User A. */
   DISConnect F19
   PBX C
   -> GW3

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F9 SETUP message
   Message type=DISC
   Cause=16 (Normal clearing)
   BYE F20



Johnston, et al.            Informational                   [Page 169]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


   GW3 -> SS1


   BYE sip:IdentifierString@ss1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP gw3.wcom.com:5060
   Route: <sip:IdentifierString@gw1.wcom.com>
   From: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789
   To: PBX_A <sip:IdentifierString@gw1.wcom.com>
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 BYE
   Content-Length: 0


   BYE F21
   SS1 -> GW1


   BYE sip:IdentifierString@gw1.wcom.com SIP/2.0
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw3.wcom.com:5060
   From: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789
   To: PBX_A <sip:IdentifierString@gw1.wcom.com>
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 BYE
   Content-Length: 0


   GW1 -> PBX A

   Seizure removal
   RELease F22
   GW3-> PBX C

   Protocol discriminator=Q.931
   Call reference: Flag=0, CR  value=value in F9 SETUP message
   Message type=REL
   200 OK F23
   GW1 -> SS1

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP ss1.wcom.com:5060
   Via: SIP/2.0/UDP gw3.wcom.com:5060
   From: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789
   To: PBX_A <sip:IdentifierString@gw1.wcom.com>
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 BYE
   Content-Length: 0



Johnston, et al.            Informational                   [Page 170]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999




   200 OK F24
   SS11
   ->GW3

   SIP/2.0 200 OK
   Via: SIP/2.0/UDP gw3.wcom.com:5060
   From: sip:444-3333,phone-context=p1234@ss1.wcom.com
   ;user=phone;tag=123456789
   To: PBX_A <sip:IdentifierString@gw1.wcom.com>
   Call-Id: 12345600@gw1.wcom.com
   CSeq: 1 BYE
   Content-Length: 0


   RELease COMplete F25
   PBX C
   -> GW3

   Protocol discriminator=Q.931
   Call reference: Flag=1, CR  value=value in F9 SETUP message
   Message type=REL COM
   PBX A
   ->GW1

   Seizure removal


























Johnston, et al.            Informational                   [Page 171]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


7  Acknowledgements


   The authors wish to thank the following individuals for their
   assistance and review of this call flows document:  Dean Willis,
   Henry Sinnreich, David Devanatham, Joe Pizzimenti, Matt Cannon, John
   Hearty, the whole MCI WorldCom IPOP Design team, and from Nortel
   Networks: Scott Orton, Greg Osterhout, Pat Sollee, Doug Weisenberg,
   Danny Mistry, Steve McKinnon, and Denise Ingram.


8  References


   [1] S. Bradner, "The Internet Standards Process -- Revision 3", BCP
       9, RFC 2026, October 1996.

   [2] M. Handley, H. Schulzrinne, E. Schooler, and J. Rosenberg, "SIP:
       Session Initiation Protocol", RFC 2543, March 1999.

   [3] R. Sparks, C. Cunningham, A. Johnston, S. Donovan, D. Willis,
       and  K. Summers, "SIP Telephony Service Examples with Call
       Flows", Internet Draft, Internet Engineering Task Force, October
       1999.  Work in progress.

   [4] S. Kent, R. Atkinson, "Security Architecture for the Internet
       Protocol", RFC 2401, November 1998.

   [5] S. Donovan, J. Hearty, M. Cannon, H. Schulzrinne, and J.
       Rosenberg, "SIP 183 Session Progress Message", Internet Draft,
       Internet Engineering Task Force, June 1999.  Work in progress.

   [6] J. Rosenberg, and H. Schulzrinne, "Reliability of Provisional
       Responses in SIP", Internet Draft, Internet Engineering Task
       Force, May 20, 1999,  Work in progress.

   [7] A. Vaha-Sipila, "URLs for Telephone Calls", Internet Draft,
       Internet Engineering Task Force, September 1999,  Work in
       progress

   [8] S. Donovan, M. Cannon, "The SIP INFO Method", Internet Draft,
       Internet Engineering Task Force, June 1999.  Work in progress.

   [9] G. Camarillo, "Best Current Practice for ISUP to SIP Mapping",
       Internet Draft, Internet Engineering Task Force, August 1999,
       Work in progress.







Johnston, et al.            Informational                   [Page 172]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999


Author's Addresses

   Alan Johnston
   MCI WorldCom
   100 S 4th Street             Phone:  +1-314-342-7360
   St. Louis, MO  63104         Email:  alan.johnston@wcom.com

   Steve Donovan
   MCI WorldCom
   901 International Parkway    Phone:  +1-972-729-1621
   Richardson, TX  65081        Email:  steven.r.donovan@wcom.com

   Robert Sparks
   MCI WorldCom
   2400 N Glenville Drive        Phone:  +1-972-729-5241
   Richardson, TX  75082         Email:  Robert.Sparks@wcom.com

   Chris Cunningham
   MCI WorldCom
   400 International Parkway    Phone:  +1-972-729-3110
   Richardson, TX  75081        Email:  Chris.Cunningham@wcom.com

   Kevin Summers
   MCI WorldCom
   2400 N Glenvile Drive        Phone:  +1-972-729-7976
   Richardson, TX  75082        Email:  Kevin.Summers@wcom.com




Copyright Notice

   "Copyright (C) The Internet Society 1999. All Rights Reserved.

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implementation may be prepared, copied, published
   and distributed, in whole or in part, without restriction of any
   kind, provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works. However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of
   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.



Johnston, et al.            Informational                   [Page 173]

Internet Draft     SIP Telephony Call Flow Examples      October, 1999



   This document and the information contained herein is provided on an
   "AS IS" basis and THE INTERNET SOCIETY AND THE INTERNET ENGINEERING
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.














































Johnston, et al.            Informational                   [Page 174]


