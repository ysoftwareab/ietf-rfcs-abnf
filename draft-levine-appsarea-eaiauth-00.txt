



Network Working Group                                          J. Levine
Internet-Draft                                      Taughannock Networks
Intended status: Standards Track                            July 4, 2015
Expires: January 5, 2016


            E-mail Authentication for Internationalized Mail
                    draft-levine-appsarea-eaiauth-00

Abstract

   SPF, DKIM, and DMARC enable a domain owner to publish e-mail
   authentication and policy information in the DNS.  In
   internationalized e-mail, domain names can occur both as U-labels and
   A-labels.  This specification clarifies when to use which form of a
   domain names when using SPF, DKIM, and DMARC.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 5, 2016.

Copyright Notice

   Copyright (c) 2015 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Levine                   Expires January 5, 2016                [Page 1]

Internet-Draft             EAI Authentication                  July 2015


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Definitions . . . . . . . . . . . . . . . . . . . . . . . . .   2
   3.  SPF and internationalized mail  . . . . . . . . . . . . . . .   3
   4.  DKIM and internationalized mail . . . . . . . . . . . . . . .   3
   5.  DMARC and internationalized mail  . . . . . . . . . . . . . .   3
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .   4
   8.  Normative References  . . . . . . . . . . . . . . . . . . . .   4
   Author's Address  . . . . . . . . . . . . . . . . . . . . . . . .   5

1.  Introduction

   SPF, DKIM, and DMARC enable a domain owner to publish e-mail
   authentication and policy information in the DNS.  SPF primarily
   publishes information about what host addresses are authorized to
   send mail for a domain.  DKIM places cryptographic signatures on
   e-mail messages, with the validation keys published in the DNS.
   DMARC publishes policy information related to the domain in the From:
   header of e-mail messages.

   In conventional e-mail, all domain names are ASCII in all contexts so
   there is no question about the representation of the domain names.
   All internationalized domain names are represented as A-labels
   [RFC5890] in message bodies, in SMTP sessions, and in the DNS.
   Internationalized mail [RFC6530] allows U-labels in SMTP sessions
   [RFC6531] and in message headers [RFC6532].

   Every U-label is equivalent to an A-label, so in principle the choice
   of label format should not cause any ambiguities.  But in practice,
   consistent use of label formats will make it more likely that mail
   senders' and receivers' code interoperates.

2.  Definitions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

   The term IDN, for Internationalized Domain Name, refers to either a
   U-label or an A-label.

   Since DMARC is not currently a standards track protocol, this
   specification offers advice rather than requirements for DMARC.






Levine                   Expires January 5, 2016                [Page 2]

Internet-Draft             EAI Authentication                  July 2015


3.  SPF and internationalized mail

   SPF [RFC7208] uses two identities from the SMTP session, the host
   name in the EHLO command, and the domain in the address in the MAIL
   FROM command.  Since the EHLO command precedes the server response
   that identifies the SMTPUTF8 extension, an IDN domain name argument
   SHOULD be represented as an A-label.  An IDN domain name in MAIL FROM
   can be either a U-label or an A-label.

   All U-labels MUST be converted to A-labels before being used for an
   SPF validation.  This includes both the original DNS lookup,
   described in Section 3 of [RFC7208] and the macro expansion of
   domain-spec described in section 7.  Section 4.3 of [RFC7208] states
   that all IDNs in an SPF DNS record MUST be A-labels; this rule is
   unchanged since any SPF record may be used to authorize either
   internationalized or conventional mail.

4.  DKIM and internationalized mail

   DKIM [RFC6376] specifies a message header that contains a
   cryptographic message signature and a DNS record that contains the
   validation key.

   Section 3.5 of [RFC6376] states that IDNs in the d=, i=, and s= tags
   of a DKIM-Signature header MUST be encoded as A-labels.  This rule is
   relaxed only for headers in internationalized messages [RFC6532] so
   IDNs MAY be represented either as A-labels or U-labels.  This
   provides improved consistency with other headers, particularly since
   the local-part of the i= tag is likely to be UTF-8 rather than ASCII.
   When computing or verifying the hash used a DKIM signature as
   described in section 3.7, the hash MUST use the domain name in the
   format it occurs in the header.  When retrieving or processing a DKIM
   key record from the DNS, all U-labels must first be converted into
   A-labels before creating the domain name to be looked up.

   DKIM key records, described in section 3.6.1, do not contain domain
   names, so there is no change to their specification.

5.  DMARC and internationalized mail

   DMARC [RFC7489] defines a policy language that domain owners can
   specify for the domain of the address in a RFC5322.From header.

   Section 6.6.1 specifies, somewhat imprecisely, how IDNs in the
   RFC5322.From address domain are to be handled.  That section is
   updated to say that all U-labels in the domain are converted to
   A-labels before further processing.  Sections 6.7 and 7.1 are




Levine                   Expires January 5, 2016                [Page 3]

Internet-Draft             EAI Authentication                  July 2015


   similarly updated to say that all U-labels in domains being handled
   are converted to A-labels before further processing.

   DMARC policy records, described in section 6.3, can contain e-mail
   addresses in the rua and ruf tags.  Since a policy record can be used
   for both internationalized and conventional mail, those addresses
   have to be conventional addresses, not internationalized addresses.

6.  IANA Considerations

   This document makes no request of IANA.

7.  Security Considerations

   Nothing new.

8.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, DOI 10.17487/
              RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC5890]  Klensin, J., "Internationalized Domain Names for
              Applications (IDNA): Definitions and Document Framework",
              RFC 5890, DOI 10.17487/RFC5890, August 2010,
              <http://www.rfc-editor.org/info/rfc5890>.

   [RFC6376]  Crocker, D., Ed., Hansen, T., Ed., and M. Kucherawy, Ed.,
              "DomainKeys Identified Mail (DKIM) Signatures", STD 76,
              RFC 6376, DOI 10.17487/RFC6376, September 2011,
              <http://www.rfc-editor.org/info/rfc6376>.

   [RFC6530]  Klensin, J. and Y. Ko, "Overview and Framework for
              Internationalized Email", RFC 6530, DOI 10.17487/RFC6530,
              February 2012, <http://www.rfc-editor.org/info/rfc6530>.

   [RFC6531]  Yao, J. and W. Mao, "SMTP Extension for Internationalized
              Email", RFC 6531, DOI 10.17487/RFC6531, February 2012,
              <http://www.rfc-editor.org/info/rfc6531>.

   [RFC6532]  Yang, A., Steele, S., and N. Freed, "Internationalized
              Email Headers", RFC 6532, DOI 10.17487/RFC6532, February
              2012, <http://www.rfc-editor.org/info/rfc6532>.







Levine                   Expires January 5, 2016                [Page 4]

Internet-Draft             EAI Authentication                  July 2015


   [RFC7208]  Kitterman, S., "Sender Policy Framework (SPF) for
              Authorizing Use of Domains in Email, Version 1", RFC 7208,
              DOI 10.17487/RFC7208, April 2014,
              <http://www.rfc-editor.org/info/rfc7208>.

   [RFC7489]  Kucherawy, M., Ed. and E. Zwicky, Ed., "Domain-based
              Message Authentication, Reporting, and Conformance
              (DMARC)", RFC 7489, DOI 10.17487/RFC7489, March 2015,
              <http://www.rfc-editor.org/info/rfc7489>.

Author's Address

   John Levine
   Taughannock Networks
   PO Box 727
   Trumansburg, NY  14886

   Phone: +1 831 480 2300
   Email: standards@taugh.com
   URI:   http://jl.ly































Levine                   Expires January 5, 2016                [Page 5]
