<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Signed syslog Messages</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Signed syslog Messages">
<meta name="keywords" content="syslog, syslog-sign">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">syslog Working Group</td><td class="header">J. Kelsey</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NIST</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Callas</td></tr>
<tr><td class="header">Expires: April 6, 2008</td><td class="header">PGP Corporation</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">A. Clemm</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 04, 2007</td></tr>
</table></td></tr></table>
<h1><br />Signed syslog Messages<br />draft-ietf-syslog-sign-23.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 6, 2008.</p>

<h3>Abstract</h3>

<p>
			This document describes a mechanism to add origin authentication, message integrity, 
			replay resistance, message sequencing, and detection of missing messages to the transmitted 
			syslog messages.  This specification is intended to be used in conjunction with the work 
			defined in RFC xxxx, "The syslog Protocol".  
			
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#conventions">2.</a>&nbsp;
Conventions Used in this Document<br />
<a href="#format">3.</a>&nbsp;
syslog Message Format<br />
<a href="#sigBlock">4.</a>&nbsp;
Signature Blocks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sigBlkPkts">4.1.</a>&nbsp;
syslog Messages Containing a Signature Block<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sigBlockFormat">4.2.</a>&nbsp;
Signature Block Format and Fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Version">4.2.1.</a>&nbsp;
Version<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rebootid">4.2.2.</a>&nbsp;
Reboot Session ID<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#siggrp">4.2.3.</a>&nbsp;
Signature Group and Signature Priority<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#globBlk">4.2.4.</a>&nbsp;
Global Block Counter<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#firstmsg">4.2.5.</a>&nbsp;
First Message Number<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#count">4.2.6.</a>&nbsp;
Count<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#hash">4.2.7.</a>&nbsp;
Hash Block<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sig">4.2.8.</a>&nbsp;
Signature<br />
<a href="#payncert">5.</a>&nbsp;
Payload and Certificate Blocks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#prelims">5.1.</a>&nbsp;
Preliminaries: Key Management and Distribution Issues<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#build">5.2.</a>&nbsp;
Payload Block<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#buildcert">5.3.</a>&nbsp;
Certificate Block<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certmsg">5.3.1.</a>&nbsp;
syslog Messages Containing a Certificate Block<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#certblock">5.3.2.</a>&nbsp;
Certificate Block Format and Fields<br />
<a href="#redunnflex">6.</a>&nbsp;
Redundancy and Flexibility<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#redun">6.1.</a>&nbsp;
Redundancy<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#redunCertblk">6.1.1.</a>&nbsp;
Configuration Parameters for Certificate Blocks<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#redunSigblk">6.1.2.</a>&nbsp;
Configuration Parameters for Signature Blocks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#flex">6.2.</a>&nbsp;
Flexibility<br />
<a href="#verify">7.</a>&nbsp;
Efficient Verification of Logs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#offline">7.1.</a>&nbsp;
Offline Review of Logs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#online">7.2.</a>&nbsp;
Online Review of Logs<br />
<a href="#security">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecCrypto">8.1.</a>&nbsp;
Cryptographic Constraints<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecPacket">8.2.</a>&nbsp;
Packet Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecAuth">8.3.</a>&nbsp;
Message Authenticity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SeqReplay">8.4.</a>&nbsp;
Replaying<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecRelDel">8.5.</a>&nbsp;
Reliable Delivery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecSeq">8.6.</a>&nbsp;
Sequenced Delivery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecInt">8.7.</a>&nbsp;
Message Integrity<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecObs">8.8.</a>&nbsp;
Message Observation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecMITM">8.9.</a>&nbsp;
Man In The Middle Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecDen">8.10.</a>&nbsp;
Denial of Service<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SecCov">8.11.</a>&nbsp;
Covert Channels<br />
<a href="#iana">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ianaSyslog">9.1.</a>&nbsp;
Structured Data and syslog messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ianaVer">9.2.</a>&nbsp;
Version Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ianaSIG">9.3.</a>&nbsp;
SG Field<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ianabuild">9.4.</a>&nbsp;
Key Blob Type<br />
<a href="#authors">10.</a>&nbsp;
Working Group<br />
<a href="#acks">11.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
			This document describes a mechanism, called syslog-sign in this document,
			that adds origin
			authentication, message integrity, replay resistance, message
			sequencing, and detection of missing messages to syslog.  Essentially,
			this is accomplished by sending a special syslog message.  
			The contents of this syslog message is called a Signature Block.  
			Each Signature Block contains, in effect, a detached signature on
			some number of previously sent messages.  It is cryptographically signed and contains 
			the hashes of previously sent syslog messages.  
			
</p>
<p>
			While most implementations
			of syslog involve only a single originator
			and a single collector of each message,
			provisions need to be made to cover situations in which messages are 
			sent to multiple collectors.  
			This concerns, in particular, situations in which different messages 
			are sent to different collectors, which means that some messages are sent 
			to some collectors but not to others.  
			The required differentiation of messages is generally performed 
			based on the Priority value of the individual messages.  
			For example, messages from any Facility
			with a Severity value of 3, 2, 1, or 0 may be sent to one collector
			while all messages of Facilities 4, 10, 13, and 14 may be sent to
			another collector.  Appropriate syslog-sign messages must be kept
			with their proper syslog messages.  To address this, syslog-sign
			uses a Signature Group.  A Signature Group identifies a group of
			messages that are all kept together for signing purposes by the
			originator.  A Signature Block always belongs to exactly one signature
			group and always signs messages belonging only to that signature
			group.
			
</p>
<p>
			Additionally, a originator sends a Certificate Block to provide key
			management information between the originator and the collector.  This
			Certificate Block has a field to denote the type of key material
			which may be such things as a PKIX certificate, an OpenPGP certificate,
			or even an indication that a key had been predistributed.  
			In the cases of certificates being sent, the
			certificates may have to be split across multiple packets.
			
</p>
<p>
			The collector of the previous messages may verify that the hash of 
			each received message matches the signed hash contained
			in the Signature Block.  A collector may process these Signature
			Blocks as they arrive, building an authenticated log file.
			Alternatively, it may store all the log messages in the order they
			were received.  This allows a network operator to authenticate the
			log file at the time the logs are reviewed.
			
</p>
<p>
			The mechanism described in this specification is intended to be used in
			conjunction with  
			the syslog protocol as defined in <a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol] as its message delivery mechanism and uses the concept of 
			STRUCTURED-DATA elements defined
			in that document.  In fact, this specification mandates implementation of 
			syslog protocol.  Nevertheless, it is conceivable that the concepts 
			underlying this mechanism could 
			also be used in conjunction with other message delivery mechanisms.  
			Designers of other efforts to define event notification mechanisms are 
			therefore encouraged to consider this specification in their designs.
			
</p>
<p>
			NOTE to RFC editor:  
			replace xxxx with the actual RFC number assigned to <a class='info' href='#syslog-protocol'>[syslog&#8209;protocol]<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a>, 
			replace zzzz with the actual RFC number assigned to <a class='info' href='#syslog-transport-udp'>[syslog&#8209;transport&#8209;udp]<span> (</span><span class='info'>Okmianski, A., &ldquo;Transmission of syslog Messages over UDP,  						draft-ietf-syslog-transport-udp-12.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a>,
			replace wwww with the actual RFC number assigned to <a class='info' href='#syslog-transport-tls'>[syslog&#8209;transport&#8209;tls]<span> (</span><span class='info'>Miao, F. and M. Yuzhi, &ldquo;TLS Transport Mapping for syslog, draft-ietf-syslog-transport-tls-10.txt (work in progress),&rdquo; May&nbsp;2007.</span><span>)</span></a>,
			replace yyyy with the actual RFC number assigned to this document, and remove this note.  
			
</p>
<a name="conventions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions Used in this Document</h3>

<p>
			The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
			"SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this 
			document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
			
</p>
<a name="format"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
syslog Message Format</h3>

<p>
			This specification is intended to be used in conjunction with the syslog 
			protocol as defined in
			<a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol].  The syslog protocol therefore 
			MUST be supported by implementations of this specification.   
			
</p>
<p>
			Because the originator generating the 
			Signature Block message signs each message in its entirety, 
			the messages MUST NOT be changed in transit.  By the same token, 
			the syslog-sign messages MUST NOT be changed in transit.  Specifically,
			a relay as described in <a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol]  
			MAY make changes to a syslog packet.  If this occurs, the mechanism 
			described in this document is rendered useless.  
			Likewise, any truncation of messages
			that occurs between sending and receiving renders the mechanism useless.  
			For this reason, syslog originator and collector implementations implementing this 
			specification MUST support messages of up to and including 2048 octets in length, 
			in order to minimize the chance of truncation.   
			While syslog originator and collector implementations MAY support messages with a 
			length larger than 2048 octets, implementors need to be aware that any message
			truncations that occur render the mechanism useless.  
			
</p>
<p>
			This specification uses the syslog message format
			described in <a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol].  
			Along with other fields, that document describes the concept of Structured Data (SD).  
			Structured Data is defined in terms of SD ELEMENTS (SDEs).  
			An SDE consists of a name and a set of parameter name - value pairs.  
			The SDE name is referred to as SD-ID.  
			The name-value pairs are referred to as SD-PARAM, or SD Parameters,
			with the name constituting the SD-PARAM-NAME, and the value constituting the SD-PARAM-VALUE.  
			
</p>
<p>
			The syslog messages defined in this document carry the signature and certificate data
			as Structured Data.  The special syslog messages defined in this document 
			include for this purpose definitions 
			of SDEs to convey parameters that relate to the signing of syslog messages.  
			The MSG part of the syslog messages defined in this document SHOULD 
			simply be empty -- 
			the content of the messages is not intended for interpretation by humans but by applications
			that use those messages to build an authenticated log.    
			
</p>
<p> 
			Because the syslog messages defined in this document adhere to the format 
			described in <a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol], they identify the machine that 
			originates the syslog message in the HOSTNAME field.  Therefore, the signature and certificate 
			data do not need to include an additional parameter to identify the machine that orginates the 
			message.   
			
</p>
<a name="sigBlock"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Signature Blocks</h3>

<p>
			This section describes the format of the Signature Block and the fields used
			within the Signature Block, as well as the syslog messages used to carry the 
			Signature Block.  
			
</p>
<a name="sigBlkPkts"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
syslog Messages Containing a Signature Block</h3>

<p>
				There is a need to distinguish the Signature Block itself from the syslog message
				that is used to carry a Signature Block.  
				Signature Blocks MUST be encompassed within completely formed 
				syslog messages.  Syslog messages that contain a Signature Block are also referred to as 
				Signature Block messages.  
				
</p>
<p>
				A Signature Block message 
				is identified by the presence of an
				SD ELEMENT with an SD-ID with the value "ssign".  
				In addition, a Signature Block message 
				MUST contain valid APP-NAME, PROCID, and MSGID fields to be compliant with 
				<a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol].   
				This specification does not mandate particular values for these fields; however, 
				for consistency, originators SHOULD use the 
				same values for APP-NAME, PROCID, and MSGID fields for 
				every Signature Block message that is sent, whichever values are chosen.  
				It is RECOMMENDED (but not required) to use 110 as value 
				for the PRI field, corresponding to facility 13 and severity 6 (informational).  
				The Signature Block is 
				carried as Structured Data within the Signature Block message, per the definitions 
				that follow in the next section.  
				A Signature Block 
				message SHOULD NOT carry other Structured Data besides the Structured Data of the 
				Signature Block itself.  
				
</p>
<p>
				The syslog messages defined as part of syslog-sign themselves 
				(Signature Block messages and Certificate Block messages) do not need to be
				signed by a Signature Block.  Collectors that 
				implement syslog-sign know to distinguish syslog messages that are associated with syslog-sign 
				from those that are subjected to signing and 
				process them differently.  
				
</p>
<a name="sigBlockFormat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Signature Block Format and Fields</h3>

<p>
				The content of a Signature Block message is the Signature Block.  
				The Signature Block MUST
				be encoded as an SD ELEMENT, as defined in 
				<a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol].  
				
</p>
<p>
				The SD-ID MUST have the value of "ssign".  
				
</p>
<p>
				The SDE contains the fields of the Signature Block encoded as 
				SD Parameters, as specified in the following.    
				The Signature Block is composed of the following fields. The value of each field
				MUST be printable ASCII, and any binary values MUST be 
				base 64 encoded, as defined in <a class='info' href='#RFC4648'>RFC 4648<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648].  
				
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Field                     SD-PARAM-NAME        Size in octets
    -----                     -------------        ---- -- ------

    Version                          VER                 4

    Reboot Session ID               RSID                1-10

    Signature Group                   SG                 1

    Signature Priority              SPRI                1-3

    Global Block Counter             GBC                1-10

    First Message Number             FMN                1-10

    Count                            CNT                1-2

    Hash Block                        HB      variable, size of hash
                                            times the number of hashes
                                             (base 64 encoded binary)

    Signature                       SIGN             variable
                                             (base 64 encoded binary)
</pre></div>
<p>
				A Signature Block is accordingly encoded as follows, where xxx denotes a placeholder for the 
				particular values: 
				
</p>
<p>
				[ssign VER="xxx" RSID="xxx" SG="xxx" SPRI="xxx" GBC="xxx" 
				FMN="xxx" CNT="xxx" HB="xxx" SIGN="xxx"]  
				
</p>
<p>
				Values of the fields constitute SD parameter values and are hence enclosed in quotes, 
				per <a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol].  
				The fields are separated by single spaces and are described below.  
				
</p>
<a name="Version"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Version</h3>

<p>
					The Signature Block Version field is a decimal value 
					that has a length of 4 octets, which may include leading zeroes.  
					Each octet contains a 
					decimal character in the range of "0" to "9".  
					The value in this field specifies
					the version of the syslog-sign protocol. This is extensible to allow
					for different hash algorithms and signature schemes to be used in
					the future. The value of this field is the grouping of the protocol
					version (2 octets), the hash algorithm (1 octet) and the signature
					scheme (1 octet).  

					</p>
<blockquote class="text">
<p>
						Protocol Version - 2 octets, with "01" as the value for 
                                    the protocol version that is described in this document.  
						
</p>
<p>
						Hash Algorithm - 1 octet, where, in conjunction 
						with Protocol Version 01, a value of "1" denotes SHA1 and  
						a value of "2" denotes SHA256, as defined in
						<a class='info' href='#FIPS.180-2.2002'>FIPS-180-2.2002<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Secure Hash Standard,&rdquo; August&nbsp;2002.</span><span>)</span></a> [FIPS.180&#8209;2.2002].
						
</p>
<p>
						Signature Scheme - 1 octet, where, in conjunction
						with Protocol Version 01, a value of "1" denotes
						OpenPGP DSA, defined in <a class='info' href='#RFC2440'>RFC 2440<span> (</span><span class='info'>Callas, J., Donnerhacke, L., Finney, H., and R. Thayer, &ldquo;OpenPGP Message Format,&rdquo; November&nbsp;1998.</span><span>)</span></a> [RFC2440] and 
						<a class='info' href='#FIPS.186-2.2000'>FIPS.186-2.2000<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Digital Signature Standard,&rdquo; January&nbsp;2000.</span><span>)</span></a> [FIPS.186&#8209;2.2000].
						
</p>
</blockquote><p>

					The version, hash algorithm and signature scheme defined in
					this document would accordingly be represented as "0111" (if SHA1 is used as Hash Algorithm) 
					and "0121" (if SHA256 is used as Hash Algorithm), respectively 
					(without the quotation marks).  
					
</p>
<p>
					The values of the Hash Algorithm and Signature Scheme are 
					defined relative to the Protocol Version.  If the single-octet representation of the values 
					for Hash Algorithm and Signature Scheme were to ever represent a limitation, 
					this limitation could be overcome by defining a new Protocol Version with additional
					Hash Algorithms and/or Signature Schemes, and having implementations support both 
					Protocol Versions concurrently.  
 					
</p>
<a name="rebootid"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Reboot Session ID</h3>

<p>
					The Reboot Session ID is a decimal value that has a length between 1 and 10 octets.  
					The acceptable values for
					this are between 0 and 9999999999.  Leading zeroes MUST be omitted.  
					A Reboot Session ID is expected to increase whenever an originator reboots in order to allow 
					collectors to distinguish messages and message signatures across reboots.  
					Hence, an originator needs to retain the previous Reboot Session ID across reboots.  
					In cases where an originator does not support this capability, 
					the Reboot Session ID MUST always be set to a value of 0, which indicates 
					that this capability is not supported.  
					Otherwise, it MUST increase whenever an originator reboots, starting with a value of 1.  
					If the value reaches 9999999999, then manual intervention may be required 
					to subsequently reset it to 1.  Implementors MAY wish to consider using the snmpEngineBoots
					value as a source for this counter as defined in 
					<a class='info' href='#RFC3414'>RFC 3414<span> (</span><span class='info'>Blumenthal, U. and B. Wijnen, &ldquo;User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3),&rdquo; December&nbsp;2002.</span><span>)</span></a> [RFC3414].
					
</p>
<a name="siggrp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.3"></a><h3>4.2.3.&nbsp;
Signature Group and Signature Priority</h3>

<p>
					The SG parameter may take any value from
					0-3 inclusive.  The SPRI parameter may take any value from 0-191 inclusive.  
                              These fields
					taken together allow network administrators to associate
					groupings of syslog messages with appropriate Signature Blocks and
					Certificate Blocks.  
					Groupings of syslog messages that are signed together are also 
					called Signature Groups.  A Signature Block contains only hashes 
					of those syslog messages that are part of the same Signature Group.  
					
</p>
<p>
					For example, in some cases, network
					administrators might have originators send syslog messages of Facilities 0 through 15
					to one collector and those with Facilities 16
					through 23 to another.  In such cases, associated Signature Blocks should 
					likely be sent to the corresponding collectors as well, signing the syslog 
					messages that are intended for each collector separately.  This way, each
					collector receives Signature Blocks for all syslog messages
					that it receives, and only for those.  
					The ability to associate different categories of syslog messages with different 
					Signature Groups, signed in separate Signature Blocks, 
					provides administrators with flexibility in this regard.  
					
</p>
<p>
					Syslog-sign provides four options for handling Signature Groups,
					linking them with PRI values so they may be routed to the
					destination commensurate with the corresponding syslog messages. In
					all cases, no more than 192 distinct Signature Groups (0-191) are permitted.  
					
</p>
<p>
					The Signature Group to which a Signature Block pertains is indicated by 
					the Signature Priority (SPRI) field.  
					The Signature Group (SG) field indicates how to interpret the Signature 
					Priority field.  (Note that the SG field does not indicate the Signature Group itself, 
					as its name might suggest.)  The SG field can have one of the following values:  

					</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>
						"0" -- There is only one Signature Group.  
						In this case, the administrators want all Signature
						Blocks to be sent to a single destination; in all likelihood,
						all of the syslog messages will also be going to that same
						destination.  Signature Blocks sign
						all messages regardless of their PRI value.  
						This means that, in effect,
						the Signature Block's SPRI value can be ignored.  
						However, it is RECOMMENDED that a single SPRI value be used for all
						Signature Blocks.    
						Furthermore, it is RECOMMENDED to set that value 
						to the same value as the 
						PRI field of the Signature Block message.  This way, the PRI of the Signature
						Block message matches the SPRI of the Signature Block that it contains.
						
</dd>
<dt>b.</dt>
<dd>
						"1" -- Each PRI value is associated with its own Signature Group. Signature
						Blocks for a given Signature Group have SPRI = PRI for that
						Signature Group.  In other words, the SPRI of the Signature Block matches 
						the PRI value of the syslog messages that are part of the Signature Group
						and hence signed by the Signature Block.  
						An SG value of 1 can, for example, be used when the administrator of an originator
						does not know where any of the syslog messages will ultimately
						go but anticipates that messages with different PRI values will be collected and 
						processed separately.  Having a Signature Group per PRI value provides 
						administrators with 
						a large degree of flexibility with regard to how to divide 
						up the processing of syslog messages and their signatures after they 
						are received, at the same time allowing 
						Signature Blocks to follow the corresponding syslog messages to their
						eventual destination.    
						
</dd>
<dt>c.</dt>
<dd>
						"2" -- Each Signature Group contains a range of PRI values.
						Signature Groups are assigned sequentially. A Signature Block for
						a given Signature Group has its own SPRI value denoting the
						highest PRI value of syslog messages in that Signature Group.  
						The lowest PRI value of syslog messages in that Signature Group will
						be one larger than the SPRI value of the previous Signature Group or "0" 
						in case there is no other Signature Group with a lower SPRI value.  
						The specific Signature Groups and ranges they are associated with 
						are subject to configuration by a system administrator.  
						
</dd>
<dt>d.</dt>
<dd>
						"3" -- Signature Groups are not assigned with any of the above 
						relationships to PRI values of the syslog messages they 
						sign. Instead, another scheme is used, which is outside the scope of 
						this specification.  There has to be some predefined
						arrangement between the originator and the intended collectors as to which 
						syslog messages are to be included in which Signature Group, requiring 
						configuration by a system administrator.  This provides administrators also 
						with the flexibility to group syslog messages into Signature Groups according to 
						criteria that are not tied to the PRI value.  
						
</dd>
</dl></blockquote><p>

					One reasonable way to configure some installations is to have only
					one Signature Group, indicated with SG=0, and have the originator send a copy of 
					each Signature Block to each collector.   In that case, collectors that are not 
					configured to receive every syslog message will still receive signatures for
					every message, even ones they are not supposed to receive.   
					While the collector will not be able to detect gaps in the
					messages (because the presence of a signature of a message that is missing 
					does not tell the collector whether
					or not the corresponding message would be of the collector's concern), 
					it does allow all messages that do arrive at each collector
					to be put into the right order and to be verified.  It also
					allows each collector to detect duplicates.  
					Likewise, configuring only one Signature Group can be a reasonable way to 
					configure installations that involve relay chains, 
					where one or more interim relays may or may not relay all messages to the 
					same destination.  
					
</p>
<a name="globBlk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.4"></a><h3>4.2.4.&nbsp;
Global Block Counter</h3>

<p>
					The Global Block Counter is a decimal value representing the number of
					Signature Blocks sent by syslog-sign before the current one, in this
					reboot session. This takes at least 1 octet and at most 10 octets
					displayed as a decimal counter. The acceptable values for this
					are between 0 and 9999999999, starting with 0.  Leading zeroes MUST be omitted.  
					If the value of the Global Block Counter 
					has reached 9999999999 and the Reboot Session ID has a value other than 0
					(indicating the fact that persistence of the Reboot Session ID is supported),
					then the Reboot Session ID MUST be incremented by 1 and the
					Global Block Counter resumes at 0.  When 
					the Reboot Session ID is 0 (i.e., persistent 
					Reboot Session IDs are not supported) and the Global Block Counter
					reaches its maximum value, then the Global Block Counter is reset to 0 
					and the Reboot Session ID MUST remain at 0.   
					
</p>
<p>
					Note that the Global Block Counter
					crosses Signature Groups; it allows one to roughly synchronize when
					two messages were sent, even though they went to different
					collectors and are part of different Signature Groups.  
					
</p>
<p>
					Because a reboot results in the start of a new reboot session, the originator MUST 
					reset the Global Block Counter to 0 after a reboot occurs.  
					Applications need to take into account the possibility that a 
					reboot occurred when authenticating 
					a log, and situations in which reboots occur frequently may result 
					in losing the ability to verify the proper sequence in which messages were
					sent, hence jeopardizing the integrity of the log.  
					
</p>
<a name="firstmsg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.5"></a><h3>4.2.5.&nbsp;
First Message Number</h3>

<p>
					This is a decimal value between 1 and 10 octets, with leading zeroes omitted.  
					It contains the unique
					message number within this Signature Group of the first message
					whose hash appears in this block.  The very first message of the
					reboot session is numbered "1".  This implies that when the Reboot Session ID 
					increases, the message number is reset to 1.  
					
</p>
<p>
					For example, if this Signature Group has processed 1000 messages so
					far and message number 1001 is the first message whose hash appears
					in this Signature Block, then this field contains 1001.  The 
					message number is relative to the Signature Group to which it belongs; 
					hence, a message number does not identify a message beyond its Signature Group.    
					
</p>
<p>
					Should the message number reach 9999999999 within the same reboot session and 
					Signature Group, the message number subsequently restarts at 1.   
					In such event, the Global Block Counter will be vastly different 
					between two occurrences of the same message number.     
					
</p>
<a name="count"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.6"></a><h3>4.2.6.&nbsp;
Count</h3>

<p>
					The count is a 1 or 2 octet field that indicates the number of message
					hashes to follow.  The valid values for this field are 1 through
					99.  The number of hashes included in the Signature
					Block MUST be chosen such that the length of the 
					resulting syslog message does not exceed the maximum permissible syslog 
					message length.  
					
</p>
<a name="hash"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.7"></a><h3>4.2.7.&nbsp;
Hash Block</h3>

<p>
					The hash block is a block of hashes, each separately encoded in
					base 64. Each hash in the hash block is the hash of the entire
					syslog message represented by the hash, independent of the underlying
					transport.  Hashes are ordered from left to right in the order of occurrence 
					of the syslog messages that they represent.   
					
</p>
<p>
					The "entire syslog message" refers to what is described as the syslog 
					message excluding 
					transport parts that are described in 
					<a class='info' href='#syslog-transport-udp'>RFC zzzz<span> (</span><span class='info'>Okmianski, A., &ldquo;Transmission of syslog Messages over UDP,  						draft-ietf-syslog-transport-udp-12.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;transport&#8209;udp] and 
					<a class='info' href='#syslog-transport-tls'>RFC wwww<span> (</span><span class='info'>Miao, F. and M. Yuzhi, &ldquo;TLS Transport Mapping for syslog, draft-ietf-syslog-transport-tls-10.txt (work in progress),&rdquo; May&nbsp;2007.</span><span>)</span></a> [syslog&#8209;transport&#8209;tls], 
					and excluding other parts that may be defined 
					in future transports.  The hash value 
					will be the result of the hashing algorithm run across the syslog message, 
					starting with the "&lt;" of the PRI portion of the header part of the 
					message.  The hash algorithm used
					and indicated by the Version field determines the size of
					each hash, but the size MUST NOT be shorter than 160 bits without the use of 
					padding. It is
					base 64 encoded as per <a class='info' href='#RFC4648'>RFC 4648<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648].
					
</p>
<p>
					The number of hashes in a hash block SHOULD be chosen such that the resulting 
					Signature Block message does not exceed a length of 2048 octets in order to 
					avoid the possibility that truncation occurs.  When more
					hashes need to be sent than fit inside a Signature Block message, it is
					advisable to start a new Signature Block.  
					
</p>
<a name="sig"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.8"></a><h3>4.2.8.&nbsp;
Signature</h3>

<p>
					This is a digital signature, encoded in base 64 
					per <a class='info' href='#RFC4648'>RFC 4648<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648]. The signature is calculated over the
					completely formatted syslog-message, including all of the PRI, HEADER, and hashes in the
					hash block, excluding spaces between fields, and
					also excluding the signature field 
					(SD Parameter Name "SIGN", "=", and corresponding value).  
					
</p>
<a name="payncert"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Payload and Certificate Blocks</h3>

<p>
			Certificate Blocks and Payload Blocks provide key management for
			syslog-sign.  Their purpose is to support key management that uses
			public key cryptosystems. 
			
</p>
<a name="prelims"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Preliminaries: Key Management and Distribution Issues</h3>

<p>
				A Payload Block contains public key certificate information that is to be conveyed to the
				collector.  A Payload Block is sent at the 
				beginning of a new reboot session, carrying public key 
				information in effect for the reboot session.  
				However, a Payload Block is not sent directly, but in (one or more) fragments.  
				Those fragments are termed Certificate Blocks.  Therefore, originators send at 
				least one Certificate Block at the beginning of a new reboot session.  
				
</p>
<p>
				There are three key points to understand about Certificate Blocks:

				</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>
					They handle a variable-sized payload, fragmenting it if
					necessary and transmitting the fragments as legal syslog
					messages. This payload is built (as described below) at the
					beginning of a reboot session and is transmitted in pieces with
					each Certificate Block carrying a piece. There is
					exactly one Payload Block per reboot session.
					
</dd>
<dt>b.</dt>
<dd>
					The Certificate Blocks are digitally signed. The originator does not
					sign the Payload Block, but the signatures on the Certificate
					Blocks ensure its authenticity. Note that it may not even be
					possible to verify the signature on the Certificate Blocks
					without the information in the Payload Block; in this case the
					Payload Block is reconstructed, the key is extracted, and then
					the Certificate Blocks are verified. (This is necessary even
					when the Payload Block carries a certificate, because some other
					fields of the Payload Block are not otherwise verified.)  In
					practice, most installations keep the same public key over
					long periods of time, so that most of the time, it is easy to
					verify the signatures on the Certificate Blocks, and use the
					Payload Block to provide other useful per-session information.
					
</dd>
<dt>c.</dt>
<dd>
					The kind of Payload Block that is expected is determined by what
					kind of key material is on the collector that receives it. The
					originator and collector (or offline log viewer) both have some key
					material (such as a root public key or predistributed public
					key) and an acceptable value for the Key Blob Type in the
					Payload Block, below. The collector or offline log viewer MUST
					NOT accept a Payload Block of the wrong type.
					
</dd>
</dl></blockquote><p>
				
</p>
<a name="build"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Payload Block</h3>

<p>
				The Payload Block is built when a new reboot session is started.
				There is a one-to-one correspondence between reboot sessions and Payload
				Blocks. 
				An originator creates a new Payload Block after each reboot.  The Payload 
				Block is used until the next reboot.  
				A Payload Block MUST have the following fields:  

				</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>
					Full local time stamp for the originator at the time the reboot session started.  This 
					must be in the time stamp format specified in 
					<a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol]
					(essentially, time stamp format per 
					<a class='info' href='#RFC3339'>RFC 3339<span> (</span><span class='info'>Klyne, G. and C. Newman, &ldquo;Date and Time on the Internet: Timestamps,&rdquo; July&nbsp;2002.</span><span>)</span></a> [RFC3339] with some further restrictions).
					
</dd>
<dt>b.</dt>
<dd>
					Key Blob Type, a one-octet field containing one of five values:

					
<ol class="text">
<li>
						'C' -- a PKIX certificate.
						
</li>
<li>
						'P' -- an OpenPGP certificate.
						
</li>
<li>
						'K' -- the public key whose corresponding private key is
						being used to sign these messages.
						
</li>
<li>
						'N' -- no key information sent; key is predistributed.
						
</li>
<li>
						'U' -- installation-specific key exchange information
						
</li>
</ol>
					
</dd>
<dt>c.</dt>
<dd>
					The key blob, if any, base 64
					encoded per <a class='info' href='#RFC4648'>RFC 4648<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648] and
					consisting of the raw key data.  
					
</dd>
</dl></blockquote><p>
				
</p>
<p>
				The fields are separated by single space characters.  
				Because a Payload Block is not carried in a 
				syslog message directly, only the corresponding Certificate Blocks, it does not
				need to be encoded as an SD ELEMENT.    
				The Payload Block does not contain a field that identifies the reboot 
				session; instead, the reboot session can be inferred from the 
				Reboot Session ID parameter of the Certificate Blocks that are used to 
				carry the Payload Block.  
				
</p>
<a name="buildcert"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Certificate Block</h3>

<p>
				This section describes the format of the Certificate Block and the fields used
				within the Certificate Block, as well as the syslog messages used to carry
				Certificate Blocks.  
				
</p>
<a name="certmsg"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
syslog Messages Containing a Certificate Block</h3>

<p>
					Certificate Blocks are used to get the Payload Block to the collector.
					As with a Signature Block, each Certificate Block is carried in its 
					own syslog message, 
					called Certificate Block message.  
					
</p>
<p>
					Because certificates can legitimately be much longer than 2048 octets,
					the Payload Block can be split up into several pieces, with 
					each Certificate Block carrying a piece of the Payload Block.  
					Note
					that the originator MAY make the Certificate Blocks of any legal length
					(that is, any length that keeps the entire Certificate Block message 
					within 2048 octets) that holds all the
					required fields. Software that processes Certificate Blocks MUST
					deal correctly with blocks of any legal length.
					The length of the fragment of the Payload Block that a Certificate Block
					carries MUST be at least 1 octet.  The length SHOULD be chosen 
					such that the length of the Certificate
					Block message does not exceed 2048 octets.  
					
</p>
<p>
					A Certificate Block message 
					is identified by the presence of an
					SD ELEMENT 
					with an SD-ID with the value "ssign-cert".  
					In addition, a Certificate Block message 
					MUST contain valid APP-NAME, PROCID, and MSGID fields to be compliant with 
					syslog protocol.    
					Syslog-sign does not mandate particular values for these fields; however, 
					for consistency, implementations SHOULD use the 
					same value for APP-NAME, PROCID, and MSGID fields for 
					every Certificate Block message, whichever values are chosen.  
					It is RECOMMENDED to use 110 as value 
					for the PRI field, corresponding to facility 13 and severity 6 (informational).  
					The Certificate Block is 
					carried as Structured Data within the Certificate Block message.   
					A Certificate Block 
					message SHOULD NOT carry other Structured Data besides the Structured Data of the 
					Certificate Block itself.  The MSG part of a Certificate Block message SHOULD be empty.  
					
</p>
<a name="certblock"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Certificate Block Format and Fields</h3>

<p>
					The contents of a Certificate Block message is the Certificate Block itself.  
					Like a Signature Block, the Certificate Block is encoded as an SD ELEMENT.   
					The SD-ID of the Certificate Block is "ssign-cert".  
					The Certificate Block is composed of the following fields, each of which is 
					encoded as an SD Parameter with parameter name as indicated. Each field
					must be printable ASCII, and any binary values are base 64 encoded per 
					<a class='info' href='#RFC4648'>RFC 4648<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648].
					
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Field                       SD-PARAM-NAME      Size in octets
    -----                       -------------      ---- -- ------

    Version                          VER                 4

    Reboot Session ID               RSID                1-10

    Signature Group                   SG                 1

    Signature Priority              SPRI                1-3

    Total Payload Block Length      TPBL                1-8

    Index into Payload Block       INDEX                1-8

    Fragment Length                 FLEN                1-4

    Payload Block Fragment          FRAG              variable
                                             (base 64 encoded binary)

    Signature                       SIGN             variable
                                             (base 64 encoded binary)
</pre></div>
<p>
					A Certificate Block is accordingly encoded as follows, where xxx denotes a 
					placeholder for the particular values: 
					
</p>
<p>
					[ssign-cert VER="xxx" RSID="xxx" SG="xxx" SPRI="xxx" TBPL="xxx" 
					INDEX="xxx" FLEN="xxx" FRAG="xxx" SIGN="xxx"]  
					
</p>
<p>
					Values of the fields constitute SD parameter values and are hence enclosed in quotes, 
					per <a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol].  
					The fields are separated by single spaces and are described below.
					
</p>
<a name="VersionCER"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.1"></a><h3>5.3.2.1.&nbsp;
Version</h3>

<p>
						The Signature Group version field is 4 octets in length. 
						This field is identical in format and meaning to the
						Version field described in <a class='info' href='#Version'>Section&nbsp;4.2.1<span> (</span><span class='info'>Version</span><span>)</span></a>.
						
</p>
<a name="rebootidCER"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.2"></a><h3>5.3.2.2.&nbsp;
Reboot Session ID</h3>

<p>
						The Reboot Session ID is identical in format and meaning to the 
						RSID field described in
						<a class='info' href='#rebootid'>Section&nbsp;4.2.2<span> (</span><span class='info'>Reboot Session ID</span><span>)</span></a>.
						
</p>
<a name="siggrpCER"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.3"></a><h3>5.3.2.3.&nbsp;
Signature Group and Signature Priority</h3>

<p>
						The SIG field is identical in format and meaning to the SIG field described in
						<a class='info' href='#siggrp'>Section&nbsp;4.2.3<span> (</span><span class='info'>Signature Group and Signature Priority</span><span>)</span></a>.  
						The SPRI field is identical in format and meaning to the SPRI field described there.
						
</p>
<a name="tpbl"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.4"></a><h3>5.3.2.4.&nbsp;
Total Payload Block Length</h3>

<p>
						The Total Payload Block Length is a value representing the total length
						of the Payload Block in octets, expressed as a decimal with one to eight octets.
						
</p>
<a name="index"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.5"></a><h3>5.3.2.5.&nbsp;
Index into Payload Block</h3>

<p>
						This is a decimal value between 1 and 8 octets, 
						with leading zeroes omitted.  
						It contains the number of octets
						into the Payload Block at which this fragment starts.  The first octet of
						the first fragment is numbered "1".
						
</p>
<a name="fraglen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.6"></a><h3>5.3.2.6.&nbsp;
Fragment Length</h3>

<p>
						The total length of this fragment expressed as a decimal integer
						with one to four octets.  The fragment length must be at least 1.  
						
</p>
<a name="pbfragment"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.7"></a><h3>5.3.2.7.&nbsp;
Payload Block Fragment</h3>

<p>
						The Payload Block Fragment contains a fragment of the payload block, 
						encoded in base 64, as per <a class='info' href='#RFC4648'>RFC 4648<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648].  
						Its length must match the indicated fragment length.    
						
</p>
<a name="sigCER"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2.8"></a><h3>5.3.2.8.&nbsp;
Signature</h3>

<p>
						This is a digital signature, encoded in base 64, as per 
						<a class='info' href='#RFC4648'>RFC 4648<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4648]. The Version field effectively specifies the
						original encoding of the signature. The signature is 
						calculated over the completely formatted syslog message, including
						all of the PRI, HEADER, and certificate block, 
						excluding spaces between fields, and also excluding the 
						signature field itself (SD Parameter Name "SIGN", "=", and corresponding value).  
						
</p>
<a name="redunnflex"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Redundancy and Flexibility</h3>

<p>
			There is a general rule that determines how redundancy works and
			what level of flexibility the originator and collector have in message
			formats: in general, the originator is allowed to send Signature and
			Certificate Blocks multiple times, to send Signature and Certificate
			Blocks of any legal length, to include fewer hashes in hash blocks,
			etc.
			
</p>
<a name="redun"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Redundancy</h3>

<p>
				Syslog messages are in general sent over unreliable transport, which means that
				they can be lost in transit. However, if a collector does not receive
				Signature and Certificate Blocks, many messages may not be able to
				be verified. Sending Signature and Certificate Blocks multiple times
				provides redundancy; because the collector MUST ignore
				Signature/Certificate Blocks it has already received and
				authenticated, the originator can in principle change its redundancy
				level for any reason, without communicating this fact to the
				collector.
				
</p>
<p>
				Although the transport sender is not constrained in how it decides to send
				redundant Signature and Certificate Blocks, or even in whether it
				decides to send along multiple copies of normal syslog messages,
				we define some redundancy parameters below which may be useful
				in controlling redundant transmission from the transport sender to the
				transport receiver, and which may be useful for administrators to configure.  
				
</p>
<a name="redunCertblk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
Configuration Parameters for Certificate Blocks</h3>

<p>
					certInitialRepeat = number of times each Certificate Block should be
					sent before the first message is sent.
					
</p>
<p>
					certResendDelay  = maximum time delay in seconds to delay before
					next redundant sending.
					
</p>
<p>
					certResendCount  = maximum number of sent messages to delay before
					next redundant sending.
					
</p>
<a name="redunSigblk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.2"></a><h3>6.1.2.&nbsp;
Configuration Parameters for Signature Blocks</h3>

<p>
					sigNumberResends = number of times a Signature Block is resent.
					
</p>
<p>
					sigResendDelay   = maximum time delay in seconds from original
					sending to next redundant sending.
					
</p>
<p>
					sigResendCount   = maximum number of sent messages to delay before
					next redundant sending.
					
</p>
<a name="flex"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Flexibility</h3>

<p>
				An originator may change many things about the makeup of Signature and
				Certificate Blocks in a given reboot session. The things it cannot
				change are:

				</p>
<blockquote class="text">
<p>
					* The version
					
</p>
<p>
					* The number or arrangements of Signature Groups
					
</p>
</blockquote><p>

				It is legitimate for an originator to send short Signature Blocks
				to allow the collector to verify messages quickly. 
   				
</p>
<a name="verify"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Efficient Verification of Logs</h3>

<p>
			The logs secured with syslog-sign may be reviewed either online or
			offline. Online review is somewhat more complicated and
			computationally expensive, but not prohibitively so.
			
</p>
<a name="offline"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Offline Review of Logs</h3>

<p>
				When the collector stores logs to be reviewed later, they can be
				authenticated offline just before they are reviewed. Reviewing these
				logs offline is simple and relatively inexpensive in terms of resources
				used, so long as there is enough space available on the reviewing
				machine. Here, we presume that the stored log files have
				already been separated by originator, Reboot Session ID, and Signature
				Group. This can be done easily with a script file. We then do
				the following:

				</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>
					First, we go through the raw log file and split its contents
					into three files. Each message in the raw log file is classified
					as a normal message, a Signature Block message, or a Certificate Block message.
					Signature Blocks and Certificate Blocks are then stored in their own
					files. Normal messages are stored in a keyed file, indexed on
					their hash values.
					
</dd>
<dt>b.</dt>
<dd>
					We sort the Certificate Block file by INDEX value, and check to
					see whether we have a set of Certificate Blocks that can reconstruct
					the Payload Block. If so, we reconstruct the Payload Block,
					verify any key-identifying information, and then use this to
					verify the signatures on the Certificate Blocks we have received.
					When this is done, we have verified the reboot session and key
					used for the rest of the process.
					
</dd>
<dt>c.</dt>
<dd>
					We sort the Signature Block file by First Message Number. We now
					create an authenticated log file, which consists of some
					header information and then a sequence of message number,
					message text pairs. We next go through the Signature Block file.
					For each Signature Block in the file, we do the following:
					
					
<ol class="text">
<li>
						Verify the signature on the Block.
						
</li>
<li>
						For each hashed message in the Block:

						
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>
							Look up the hash value in the keyed message file.
							
</dd>
<dt>b.</dt>
<dd>
							If the message is found, write (message number, message
							text) to the authenticated log file.
							
</dd>
</dl></blockquote>
						
						Skip all other Signature Blocks with the same
						First Message Number.
						
</li>
</ol>
					
					The resulting authenticated log file contains all messages
					that have been authenticated.  In addition, it implicitly indicates 
					all gaps in the authenticated messages (specifically 
					in the case when all messages of the same Signature Group 
					are sent to the same collector), because their 
					message numbers are missing. 
					
</dd>
</dl></blockquote><p>
				
				One can see that, assuming sufficient space for building
				the keyed file, this whole process is linear in the number of
				messages (generally two seeks, one to write and the other to read,
				per normal message received), and O(N lg N) in the number of
				Signature Blocks. This estimate comes with two caveats: first, the
				Signature Blocks arrive very nearly in sorted order, and so can
				probably be sorted more cheaply on average than O(N lg N) steps.
				Second, the signature verification on each Signature Block
				almost certainly is more expensive than the sorting step in
				practice. We have not discussed error-recovery, which may be
				necessary for the Certificate Blocks. In practice, a simple
				error-recovery strategy is probably enough: if the Payload
				Block is not valid, then we can just try alternate
				instances of each Certificate Block, if such are available, until we
				get the Payload Block right.
				
</p>
<p>
				It is easy for an attacker to flood us with plausible-looking
				messages, Signature Blocks, and Certificate Blocks.
				
</p>
<a name="online"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Online Review of Logs</h3>

<p>
				Some collector implementations may need to monitor log
				messages in close to real-time. This can be done with
				syslog-sign, though it is somewhat more complex than offline
				verification. This is done as follows:
				
				</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>
					We have an authenticated message file, into which we write (message number,
					message text) pairs which have been authenticated. Again, we will
					assume that we are handling only one Signature Group and only one
					Reboot Session ID at any given time.
					
</dd>
<dt>b.</dt>
<dd>
					We have three data structures: A queue in which (message
					number, hash of message) pairs are kept in sorted order, a queue
					in which (arrival sequence, hash of message) pairs are kept in sorted
					order, and a hash table that stores (message text, count) pairs
					indexed by hash value. In the hash table, count may be any number
					greater than zero; when count is zero, the entry in the hash
					table is cleared.
					
</dd>
<dt>c.</dt>
<dd>
					We must receive all the Certificate Blocks before any other
					processing can really be done. (This is why they are sent first.)
					Once that is done, any Certificate Block message that arrives is
					discarded.
					
</dd>
<dt>d.</dt>
<dd>
					Whenever a normal message arrives, we add (arrival sequence,
					hash of message) to our message queue. If our hash table has an
					entry for the message's hash value, we increment its count by
					one; otherwise, we create a new entry with count = 1. If the
					message queue is full, we roll the oldest messages off the queue
					by taking the oldest entry in the queue, and using it to index the
					hash table. If that entry has count 1, we delete the entry from
					the hash table; otherwise, we decrement its count.  We then
					delete the oldest entry in the queue.
					
</dd>
<dt>e.</dt>
<dd>
					Whenever a Signature Block message arrives, we first check to see whether the
					First Message Number value is too old to still be of interest, 
					or if another Signature
					Block with that First Message Number has already been received. If
					so, we discard the Signature Block. Otherwise, we check
					its signature and discard it if the signature is not valid. A
					Signature Block contains a sequence of (message number, message
					hash) pairs. For each pair, we first check to see whether the message
					hash is in the hash table. If so, we write the (message
					number, message text) into the authenticated message queue.
					Otherwise, we write the (message number, message hash) to the
					message number queue. This generally involves rolling the oldest
					entry out of this queue: before this is done, that entry's hash
					value is again looked up in the hash table. If a matching
					entry is found, the (message number, message text) pair is
					written to the authenticated message file. In either case,
					the oldest entry is then discarded.
					
</dd>
<dt>f.</dt>
<dd>
					The result of this is a sequence of messages in the
					authenticated message file, each of which has been
					authenticated, and which are labeled with numbers showing their
					order of original transmission.
					
</dd>
</dl></blockquote><p>
				
				One can see that this whole process is roughly linear
				in the number of messages, and also in the number of Signature
				Blocks received. The process is susceptible to flooding attacks; an
				attacker can send enough normal messages that the messages roll off
				their queue before their Signature Blocks can be processed.
				
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>
			Normal syslog event messages are unsigned and have most of the security attributes
			described in Section 8 
			of <a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol].  This document also describes Certificate Blocks
			and Signature Blocks, which are signed syslog messages.  The Signature Blocks contain
			signature information for previously sent syslog event messages.  All of this 
			information can be used to authenticate syslog messages and to minimize or obviate
			many of the security concerns described in <a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol].  
			
</p>
<a name="SecCrypto"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Cryptographic Constraints</h3>

<p>
				As with any technology involving cryptography, it is advisable to check
				the current literature to determine whether any algorithms used here
				have been found to be vulnerable to attack.
				
</p>
<p>
				This specification uses Public Key Cryptography
				technologies. The proper party or parties have to control
				the private key portion of a public-private key pair.
				Any party that controls a private key can sign anything
				it pleases.
				
</p>
<p>
				Certain operations in this specification involve the use of
				random numbers. An appropriate entropy source SHOULD be used to
				generate these numbers. See <a class='info' href='#RFC4086'>RFC 4086<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Recommendations for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a> [RFC4086]
				and <a class='info' href='#NIST800.90'>NIST SP 800-90<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;NIST Special Publication 800-90: Recommendation for Random Number Generation using Deterministic Random Bit Generators,&rdquo; June&nbsp;2006.</span><span>)</span></a> [NIST800.90].
				
</p>
<a name="SecPacket"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Packet Parameters</h3>

<p>
				As an originator, it is advisable to avoid message lengths exceeding 2048 octets.  
				Various problems might result
				if an originator were to send messages with a length greater than 2048
				octets, because relays MAY truncate messages with lengths 
				greater than 2048 octets which would make it impossible for collectors to 				
				validate a hash of the packet.  To increase
				the chance of interoperability, it tends to be  
				best to be conservative with what
				you send but liberal in what you are able to receive.  
				
</p>
<p>
				Originators need to rigidly enforce the correctness of message bodies.
				Problems may 
				arise if the collector does not fully accept the syslog packets sent from an
				originator, or if it has problems with the format of the Certificate Block or
				Signature Block messages.
				
</p>
<p>
				Collectors are not to malfunction in case they receive malformed syslog messages or 
				messages containing characters other than those specified in this document.  In other 
				words, they are to ignore such messages and continue working.
				
</p>
<a name="SecAuth"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.3"></a><h3>8.3.&nbsp;
Message Authenticity</h3>

<p>
				Syslog does not strongly associate the message
				with the message originator.  That association is established by the collector upon verification
				of the Signature Block.  Before a Signature Block is used to
				ascertain the authenticity of an event message, it might be received, stored, and
				reviewed by a person or automated parser.  It is advisable not to assume a message is 
				authentic until after a message has been
				validated by checking the contents of the Signature Block.
				
</p>
<p>
				With the Signature Block checking, an attacker may only forge messages if it
				can compromise the private key of the true originator.  
				
</p>
<a name="SeqReplay"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.4"></a><h3>8.4.&nbsp;
Replaying</h3>

<p>
				Event messages might be recorded and replayed by an
				attacker.  Using the information contained in the
				Signature Blocks, a reviewer can determine whether the received messages are the ones
				originally sent by an originator.  The reviewer can also identify messages that have 
				been replayed.  
				
</p>
<a name="SecRelDel"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.5"></a><h3>8.5.&nbsp;
Reliable Delivery</h3>

<p>
				<a class='info' href='#syslog-transport-tls'>RFC wwww<span> (</span><span class='info'>Miao, F. and M. Yuzhi, &ldquo;TLS Transport Mapping for syslog, draft-ietf-syslog-transport-tls-10.txt (work in progress),&rdquo; May&nbsp;2007.</span><span>)</span></a> [syslog&#8209;transport&#8209;tls] can be used for the reliable delivery of
				syslog messages.  Event messages sent over UDP might be lost in transit.
				A reviewer can pinpoint any messages sent by the originator but not 
				received by the collector by reviewing the Signature Block information.  
				In addition, the information in
				subsequent Signature Blocks allows a
				reviewer to determine whether any Signature Block messages
				were lost in transit.
				
</p>
<a name="SecSeq"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.6"></a><h3>8.6.&nbsp;
Sequenced Delivery</h3>

<p>
				Syslog messages delivered over UDP might not only be lost, but
				also arrive out of sequence.  
				A reviewer can determine the original order of syslog messages and identify 
				which messages were delivered out of order by examining the information 
				in the Signature Block 
				along with any timestamp information in the message.
				
</p>
<a name="SecInt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.7"></a><h3>8.7.&nbsp;
Message Integrity</h3>

<p>
				Syslog messages might be damaged in transit.  A review of
				the information in the Signature Block determines whether
				the received message was the intended message sent by
				the originator. A damaged Signature Block or Certificate
				Block is evident because the collector will not be
				able to validate that it was signed by the originator.
				
</p>
<a name="SecObs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.8"></a><h3>8.8.&nbsp;
Message Observation</h3>

<p>
				Event messages, Certificate Blocks, and Signature Blocks are all sent in plaintext.  
				This allows network administrators to read the
				message when sniffing the wire.  However, this also allows an attacker to see the
				contents of event messages and perhaps to use that information for malicious purposes.
				
</p>
<a name="SecMITM"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.9"></a><h3>8.9.&nbsp;
Man In The Middle Attacks</h3>

<p>
				It is conceivable that an attacker might intercept Certificate Block messages and insert its
				own Certificate information.  In that case, the attacker would be able to receive
				event messages from the actual originator and then relay modified messages, insert new
				messages, or delete messages.  It would then be able to construct a Signature Block
				and sign it with its own private key.  Network administrators need to verify
				that the key contained in the Payload Block is indeed the key being used on the
				actual originator.  If that is the case, then this MITM attack will not succeed.
				
</p>
<a name="SecDen"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.10"></a><h3>8.10.&nbsp;
Denial of Service</h3>

<p>

				An attacker might send invalid Signature Block messages to overwhelm the collector's 
				processing capability and consume all available resources.
				For this reason, it can be appropriate to simply 
				receive the Signature Block messages and process them only as time permits.
				
</p>
<p>
				An attacker might also just overwhelm a collector by sending more
				messages to it than it can handle.   
				Implementors are advised to consider features that minimize this threat,  
				such as only accepting syslog messages from known IP addresses.
				
</p>
<a name="SecCov"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.11"></a><h3>8.11.&nbsp;
Covert Channels</h3>

<p>
				Nothing in this protocol attempts to eliminate covert
				channels.  In fact, just about every aspect of
				syslog messages lends itself to the conveyance of covert
				signals.  For example, a collusionist could send odd and
				even PRI values to indicate Morse Code dashes and dots.
				
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<a name="ianaSyslog"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Structured Data and syslog messages</h3>

<p>
				With regard to  <a class='info' href='#syslog-protocol'>RFC xxxx<span> (</span><span class='info'>Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</span><span>)</span></a> [syslog&#8209;protocol],
				IANA is requested to add the following values to the registry entitled "syslog 
				Structured Data id values":    

				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       SD-ID         PARAM_NAME
       -----         ----------
       ssign
                     VER
                     RSID
                     SG
                     SPRI
                     GBC
                     FMN
                     CNT
                     HB
                     SIGN

       ssign-cert
                     VER
                     RSID
                     SG
                     SPRI
                     TBPL
                     INDEX
                     FLEN
                     FRAG
                     SIGN
</pre></div><p>

				
				In addition, several fields need to be controlled by the IANA in both 
				the Signature Block and the Certificate Block, as outlined in the following
				sections.
				
</p>
<a name="ianaVer"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Version Field</h3>

<p>
				IANA is requested to create three registries, each associated with a different subfield
				of the Version field of Signature Blocks and Certificate Blocks, described in 
				<a class='info' href='#Version'>Section&nbsp;4.2.1<span> (</span><span class='info'>Version</span><span>)</span></a> and <a class='info' href='#VersionCER'>Section&nbsp;5.3.2.1<span> (</span><span class='info'>Version</span><span>)</span></a>, respectively.  
				
</p>
<p>
				The first registry that IANA is requested to create 
				is entitled "syslog-sign protocol version values".   
				It is for the values of the Protocol Version subfield.  The Protocol Version subfield constitutes
				the first 2 octets in the Version field.  
				New values shall be assigned by the IANA using the "IETF Consensus" policy
				defined in <a class='info' href='#RFC2434'>RFC 2434<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; October&nbsp;1998.</span><span>)</span></a> [RFC2434].  
				Assigned numbers are to be increased by 1, up to a maximum value of "50".  
				Protocol Version numbers of "51" through "99" are vendor-specific;
				values in this range are not to be assigned by the IANA.  
				
</p>
<p>
				IANA is requested to register the Protocol Version values shown below.  

				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      VALUE                    PROTOCOL VERSION
      -----                    ----------------
      00                       Reserved
      01                       Defined in RFC yyyy
</pre></div><p>


				The second registry that IANA is requested to create 
				is entitled "syslog-sign hash algorithm values". 
				It is for the values of the Hash Algorithm subfield.  The Hash Algorithm subfield constitutes 
				the third octet in the Version field Signature Blocks and Certificate Blocks.  
				New values shall be assigned by the IANA using the "IETF Consensus" policy
				defined in <a class='info' href='#RFC2434'>RFC 2434<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; October&nbsp;1998.</span><span>)</span></a> [RFC2434].  Assigned values are to 
				be increased by 1, up to a maximum value of "9".  
				The values are registered relative to the Protocol Version.  This means that the same 
				Hash Algorithm value can be reserved for different Protocol Versions, possibly referring
				to a different hash algorithm each time.  This makes it possible to 
				deal with future scenarios in which the single octet representation becomes a limitation, 
				as more Hash Algorithms can be supported by defining additional Protocol Versions that 
				implementations might support concurrently.  
				
</p>
<p>
				IANA is requested to register the Hash Algorithm values shown below.  

				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      VALUE     PROTOCOL VERSION     HASH ALGORITHM
      -----     ----------------     --------------
      0         01                   Reserved
      1         01                   SHA1
      2         01                   SHA256
</pre></div><p>


				The third registry that IANA is requested to create 
				is entitled "syslog-sign signature scheme values". 
				It is for the values of the Signature Scheme subfield.  The Signature Scheme subfield 
				constitutes the fourth octet in the Version field of Signature Blocks and Certificate Blocks.  
				New values shall be assigned by the IANA using the "IETF Consensus" policy
				defined in <a class='info' href='#RFC2434'>RFC 2434<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; October&nbsp;1998.</span><span>)</span></a> [RFC2434].  Assigned values are to 
				be increased by 1, up to a maximum value of "9".  This means that the same 
				Signature Scheme value can be reserved for different Protocol Versions, possibly in each 
				case referring to a different Signature Scheme each time.  This makes it possible to 
				deal with future scenarios in which the single octet representation becomes a limitation, 
				as more Signature Schemes can be supported by defining additional Protocol Versions that 
				implementations might support concurrently.  
				
</p>
<p>
				IANA is requested to register the Signature Scheme values shown below.  

				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      VALUE     PROTOCOL VERSION    SIGNATURE SCHEME
      -----     ----------------    ----------------
      0         01                  Reserved
      1         01                  OpenPGP DSA
</pre></div><p>

				
</p>
<a name="ianaSIG"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
SG Field</h3>

<p>
				IANA is requested to create a registry entitled "syslog-sign sg field values".  
				It is for values of the SG Field as defined in <a class='info' href='#siggrp'>Section&nbsp;4.2.3<span> (</span><span class='info'>Signature Group and Signature Priority</span><span>)</span></a>.
				New values shall be assigned by 
				the IANA using the "IETF Consensus" policy defined in 
				<a class='info' href='#RFC2434'>RFC 2434<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; October&nbsp;1998.</span><span>)</span></a> [RFC2434].  Assigned values are to be incremented by 1, 
				up to a maximum value of "7".  
				Values "8" and "9" shall be left as vendor specific and shall not be assigned by the IANA.
				
</p>
<p>
				IANA is requested to register the SG Field values shown below.

				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      VALUE     MEANING
      -----     -------
      0         per RFC yyyy
      1         per RFC yyyy
      2         per RFC yyyy
      3         per RFC yyyy
</pre></div><p>

				
</p>
<a name="ianabuild"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
Key Blob Type</h3>

<p>
				IANA is requested to create a registry entitled "syslog-sign key blob type values".   
				It is to register one-character identifiers for the key blob type, per
				<a class='info' href='#build'>Section&nbsp;5.2<span> (</span><span class='info'>Payload Block</span><span>)</span></a>.  New values shall be assigned by 
				the IANA using the "IETF Consensus" policy defined in 
				<a class='info' href='#RFC2434'>RFC 2434<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; October&nbsp;1998.</span><span>)</span></a> [RFC2434].  Uppercase letters may be assigned as values.  
				Lowercase letters are left as vendor specific and shall not be assigned by the IANA.	
				
</p>
<p>
				IANA is requested to register the key blob type values shown below.

				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      VALUE     KEY BLOB TYPE
      -----     ------------
      'C'       a PKIX certificate
      'P'       an OpenPGP certificate
      'K'       the public key whose corresponding private key is used to sign the messages
      'N'       no key information sent, key is predistributed
      'U'       installation-specific key exchange information
</pre></div><p>

				
</p>
<a name="authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Working Group</h3>

<p>
			The working group can be contacted via the mailing list:

				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      syslog@ietf.org
</pre></div><p>

			
</p>
<p>
			The current Chairs of the Working Group can be contacted at:
				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      Chris Lonvick
      Cisco Systems
      Email: clonvick@cisco.com

      David Harrington
      Huawei Technologies (USA)
      Email: ietfdbh@comcast.net
             dharrington@huawei.com
      Tel: +1-603-436-8634
</pre></div><p>

			
</p>
<a name="acks"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>
			The authors wish to thank Alex Brown, Chris Calabrese, Steve Chang, Carson
			Gaspar, Drew Gross, David Harrington, Chris Lonvick, Darrin New, Marshall Rose, 
			Holt Sorenson, Rodney Thayer, Andrew Ross, Rainer Gerhards, Albert Mietus, 
			and the many Counterpane Internet Security engineering and 
			operations people who commented on various versions of this proposal.
			
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS.186-2.2000">[FIPS.186-2.2000]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/publications/fips/fips186-2/fips186-2-change1.pdf">Digital Signature Standard</a>,&rdquo; FIPS&nbsp;PUB 186-2, January&nbsp;2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="FIPS.180-2.2002">[FIPS.180-2.2002]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf">Secure Hash Standard</a>,&rdquo; FIPS&nbsp;PUB 180-2, August&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST800.90">[NIST800.90]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;<a href="http://csrc.nist.gov/publications/nistpubs/800-90/SP800-90_DRBG-June2006-final.pdf">NIST Special Publication 800-90: Recommendation for Random Number Generation using Deterministic Random Bit Generators</a>,&rdquo; June&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2434">[RFC2434]</a></td>
<td class="author-text"><a href="mailto:narten@raleigh.ibm.com">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no">H. Alvestrand</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2434">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;2434, October&nbsp;1998 (<a href="ftp://ftp.isi.edu/in-notes/rfc2434.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2434.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2434.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2440">[RFC2440]</a></td>
<td class="author-text"><a href="mailto:jon@pgp.com">Callas, J.</a>, <a href="mailto:lutz@iks-jena.de">Donnerhacke, L.</a>, <a href="mailto:hal@pgp.com">Finney, H.</a>, and <a href="mailto:rodney@unitran.com">R. Thayer</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2440">OpenPGP Message Format</a>,&rdquo; RFC&nbsp;2440, November&nbsp;1998 (<a href="ftp://ftp.isi.edu/in-notes/rfc2440.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2440.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2440.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3414">[RFC3414]</a></td>
<td class="author-text">Blumenthal, U. and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3414">User-based Security Model (USM) for version 3 of the Simple Network Management Protocol (SNMPv3)</a>,&rdquo; RFC&nbsp;3414, December&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3414.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4648">[RFC4648]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="syslog-protocol">[syslog-protocol]</a></td>
<td class="author-text">Gerhards, R., &ldquo;The syslog Protocol, draft-ietf-syslog-protocol-23.txt (work in progress),&rdquo; September&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="syslog-transport-udp">[syslog-transport-udp]</a></td>
<td class="author-text">Okmianski, A., &ldquo;Transmission of syslog Messages over UDP, 
						draft-ietf-syslog-transport-udp-12.txt (work in progress),&rdquo; September&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="syslog-transport-tls">[syslog-transport-tls]</a></td>
<td class="author-text">Miao, F. and M. Yuzhi, &ldquo;TLS Transport Mapping for syslog, draft-ietf-syslog-transport-tls-10.txt (work in progress),&rdquo; May&nbsp;2007.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:-">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3339">[RFC3339]</a></td>
<td class="author-text">Klyne, G. and C. Newman, &ldquo;<a href="http://tools.ietf.org/html/rfc3339">Date and Time on the Internet: Timestamps</a>,&rdquo; RFC&nbsp;3339, July&nbsp;2002 (<a href="ftp://ftp.isi.edu/in-notes/rfc3339.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4086">[RFC4086]</a></td>
<td class="author-text"><a href="mailto:dee@lkg.dec.com">Eastlake, D.</a>, <a href="mailto:jis@mit.edu">Schiller, J.</a>, and <a href="mailto:crocker@cybercash.com">S. Crocker</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc4086">Randomness Recommendations for Security</a>,&rdquo; RFC&nbsp;4086, June&nbsp;2005 (<a href="ftp://ftp.isi.edu/in-notes/rfc4086.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Kelsey</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NIST</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:john.kelsey@nist.gov">john.kelsey@nist.gov</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jon Callas</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PGP Corporation</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jon@callas.org">jon@callas.org</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alexander Clemm</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:alex@cisco.com">alex@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
