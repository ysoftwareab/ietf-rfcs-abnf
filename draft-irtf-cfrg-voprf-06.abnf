output = Finalize(input, blind, evaluatedElement, blindedElement, pkS, proof)

contextString = I2OSP(modeBase, 1) || I2OSP(suite.ID, 2)
contextString = I2OSP(modeBase, 1) || I2OSP(suite.ID, 2)
contextString = I2OSP(modeVerifiable, 1) || I2OSP(suite.ID, 2)
contextString = I2OSP(modeVerifiable, 1) || I2OSP(suite.ID, 2)
R = GG.DeserializeElement(blindedElement)
Z = skS * R
evaluatedElement = GG.SerializeElement(Z)

P = GG.HashToGroup(input)
T = skS * P
issuedElement = GG.SerializeElement(T)

finalizeDST = "VOPRF06-Finalize-" || self.contextString
hashInput = I2OSP(len(input), 2) || input ||
                 I2OSP(len(issuedElement), 2) || issuedElement ||
                 I2OSP(len(finalizeDST), 2) || finalizeDST

T = GG.HashToGroup(input)
element = GG.SerializeElement(T)
issuedElement = Evaluate(skS, [element])
E = GG.SerializeElement(issuedElement)

finalizeDST = "VOPRF06-Finalize-" || self.contextString
hashInput = I2OSP(len(input), 2) || input ||
                 I2OSP(len(E), 2) || E ||
                 I2OSP(len(finalizeDST), 2) || finalizeDST

digest = Hash(hashInput)

R = GG.DeserializeElement(blindedElement)
Z = skS * R
evaluatedElement = GG.SerializeElement(Z)

proof = GenerateProof(skS, pkS, blindedElement, evaluatedElement)

blindedElementList = [blindedElement]
evaluatedElementList = [evaluatedElement]

a = ComputeCompositesFast(skS, pkS, blindedElementList, evaluatedElementList)

M = GG.DeserializeElement(a[0])
r = GG.RandomScalar()
a2 = GG.SerializeElement(ScalarBaseMult(r))
a3 = GG.SerializeElement(r * M)

pkSm = GG.SerializeElement(pkS)
challengeDST = "VOPRF06-Challenge-" || self.contextString
h2Input = I2OSP(len(pkSm), 2) || pkSm ||
            I2OSP(len(a[0]), 2) || a[0] ||
            I2OSP(len(a[1]), 2) || a[1] ||
            I2OSP(len(a2), 2) || a2 ||
            I2OSP(len(a3), 2) || a3 ||
            I2OSP(len(challengeDST), 2) || challengeDST

c = GG.HashToScalar(h2Input)
s = (r - c * skS) mod p
proof = [GG.SerializeScalar(c), GG.SerializeScalar(s)]

pkSm = GG.SerializeElement(pkS)
seedDST = "VOPRF06-Seed-" || self.contextString
compositeDST = "VOPRF06-Composite-" || self.contextString
h1Input = I2OSP(len(pkSm), 2) || pkSm ||
            I2OSP(len(seedDST), 2) || seedDST

seed = Hash(h1Input)
M = GG.Identity()
Z = GG.Identity()
h2Input = I2OSP(len(seed), 2) || seed || I2OSP(i, 2) ||
              I2OSP(len(blindedElements[i]), 2) || blindedElements[i] ||
              I2OSP(len(evaluatedElements[i]), 2) || evaluatedElements[i] ||
              I2OSP(len(compositeDST), 2) || compositeDST
di = GG.HashToScalar(h2Input)
Mi = GG.DeserializeElement(blindedElements[i])
M = di * Mi + M
Zi = GG.DeserializeElement(evaluatedElements[i])
Z = di * Zi + Z

pkSm = GG.SerializeElement(pkS)
seedDST = "VOPRF06-Seed-" || self.contextString
compositeDST = "VOPRF06-Composite-" || self.contextString
h1Input = I2OSP(len(pkSm), 2) || pkSm ||
            I2OSP(len(seedDST), 2) || seedDST

seed = Hash(h1Input)
M = GG.Identity()
h2Input = I2OSP(len(seed), 2) || seed || I2OSP(i, 2) ||
              I2OSP(len(blindedElements[i]), 2) || blindedElements[i] ||
              I2OSP(len(evaluatedElements[i]), 2) || evaluatedElements[i] ||
              I2OSP(len(compositeDST), 2) || compositeDST
di = GG.HashToScalar(h2Input)
Mi = GG.DeserializeElement(blindedElements[i])
M = di * Mi + M

Z = skS * M

blind = GG.RandomScalar()
P = GG.HashToGroup(input)
blindedElement = GG.SerializeElement(blind * P)

Z = GG.DeserializeElement(evaluatedElement)
N = (blind^(-1)) * Z
unblindedElement = GG.SerializeElement(N)

unblindedElement = Unblind(blind, evaluatedElement)

finalizeDST = "VOPRF06-Finalize-" || self.contextString
hashInput = I2OSP(len(input), 2) || input ||
                 I2OSP(len(unblindedElement), 2) || unblindedElement ||
                 I2OSP(len(finalizeDST), 2) || finalizeDST
blindedElementList = [blindedElement]
evaluatedElementList = [evaluatedElement]

a = ComputeComposites(pkS, blindedElementList, evaluatedElementList)
c = GG.DeserializeScalar(proof[0])
s = GG.DeserializeScalar(proof[1])

M = GG.DeserializeElement(a[0])
Z = GG.DeserializeElement(a[1])
a2 = GG.SerializeElement(A')
a3 = GG.SerializeElement(B')

challengeDST = "VOPRF06-Challenge-" || self.contextString
h2Input = I2OSP(len(pkS), 2) || pkS ||
              I2OSP(len(a[0]), 2) || a[0] ||
              I2OSP(len(a[1]), 2) || a[1] ||
              I2OSP(len(a2), 2) || a2 ||
              I2OSP(len(a3), 2) || a3 ||
              I2OSP(len(challengeDST), 2) || challengeDST

expected_c  = GG.HashToScalar(h2Input)

Z = GG.DeserializeElement(evaluatedElement)
N = (blind^(-1)) * Z
unblindedElement = GG.SerializeElement(N)

unblindedElement = Unblind(blind, evaluatedElement, blindedElement, pkS, proof)

finalizeDST = "VOPRF06-Finalize-" || self.contextString
hashInput = I2OSP(len(input), 2) || input ||
              I2OSP(len(unblindedElement), 2) || unblindedElement ||
              I2OSP(len(finalizeDST), 2) || finalizeDST
Ne = Ns = 32 bytes.  For group elements, use the 'Encode' and
Ne = Ns = 56 bytes.  For group elements, use the 'Encode' and
blind = GG.RandomScalar()
blindedGenerator = ScalarBaseMult(blind)
blindedPublicKey = blind * pkS

P = GG.HashToGroup(input)
blindedElement = GG.SerializeElement(P + blindedGenerator) /* P + ScalarBaseMult(r) */

Z = GG.DeserializeElement(evaluatedElement)
unblindedElement = GG.SerializeElement(N)

seed = aca1ae53bec831a1279b75ec6091b23d28034b59f77abeb0fa8f6d1a01340
skSm = 758cbac0e1eb4265d80f6e6489d9a74d788f7ddeda67d7fb3c08b08f44bda
Input = 00
Blind = c604c785ada70d77a5256ae21767de8c3304115237d262134f5e46e512cf
BlindedElement = 3c7f2d901c0d4f245503a186086fbdf5d8b4408432b25c5163e
EvaluationElement = fc6c2b854553bf1ed6674072ed0bde1a9911e02b4bd64aa0
Output = d8ed12382086c74564ae19b7a2b5ed9bdc52656d1fc151faaae51aaba86
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 5ed895206bfc53316d307b23e46ecc6623afb3086da74189a416012be037
BlindedElement = 28a5e797b710f76d20a52507145fbf320a574ec2c8ab0e33e65
EvaluationElement = 345e140b707257ae83d4911f7ead3177891e7a62c5409773
Output = 4d5f4221b5ebfd4d1a9dd54830e1ed0bce5a8f30a792723a6fddfe6cfe9
seed = 23ad84086377ae0ac20acfcf143a9b5c34be63758b94f7ed0a8485345a748
skSm = 8d30b6ed995e28692f9ae5517ad4d974395605fd31cbe65b47f88822a142e
pkSm = c447ae83e5ea5a070c3b35ca0926460020378fd48402b54a7ba2e36b48011
Input = 00
Blind = ed8366feb6b1d05d1f46acb727061e43aadfafe9c10e5a64e7518d63e326
BlindedElement = 9cf00acd9be7d00b87012823aec2480afac98468fc7e0766e52
EvaluationElement = a0a6cbd69a6c3c84bf84ae2b2178debe5ca2d7de8c0c3439
EvaluationProofC = 4c1e61ab430c2026b14dbe2df62d64bf5b76001edc0ac5e84
EvaluationProofS = 490660d2a0974c09ab13a10091f70d21e6229638c4e6a902a
Output = 960fb25a94db326205638c0d02c87c064445514e30d539acecb440b36bf
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = e6d0f1d89ad552e383d6c6f4e8598cc3037d6e274d22da3089e7afbd4171
BlindedElement = 9669e8326632c31ddac138b1da65cf39bdc6fa085050f5afd2b
EvaluationElement = dc1bf956f7ee401ff5fd1ab206ac13ead704d609ce81469a
EvaluationProofC = 44d8c86b857be2321c2ddf75898508e0f9b56e96ea21c76a8
EvaluationProofS = cec985971cfb2b5747374d85527a58b0a69ce906e5f9eb2fd
Output = fce0ce88eda349292e209eae49032e03bc73a756a5093ca380b0f59db94
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 80513e77795feeec6d2c450589b0e1b178febd5c193a9fcba0d27f0a06e0
BlindedElement = 6620ec0b7dc26cb6a6cc7a72ecf28971863861b88363b374f91
EvaluationElement = c2860fa4213e425c1e5eebff92bbb8e532389b8871fae9fa
EvaluationProofC = 8ecc6109a673872da634dbaa091674a255866599e380dc6c2
EvaluationProofS = 0949b5e1705ba2c76d179deef6c45891cc38a0515010be0a9
Output = 960fb25a94db326205638c0d02c87c064445514e30d539acecb440b36bf
seed = 22bfaee29297b24011e2635ddcd67155ec1805954faa50deb34d937143b4a
skSm = 4b2674b32c4975645382b98f2cd8401eaf90a48c5be505118bc674eca46e7
Input = 00
Blind = d1080372f0fcf8c5eace50914e7127f576725f215cc7c111673c635ce668
BlindedElement = 0e5e2ac2924bee04fa1ae372a6a26f6f71972372494c08433d6
EvaluationElement = 9837f23012ebd3f817e597481b03d6da85b17d16eee4c5f4
Output = 9139010e665e84800d86d912c5ea0407b51efd3fb9fdad5fc661964a15a
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = aed1ffa44fd8f0ed16373606a3cf7df589cca86d8ea1abbf5768771dbef3
BlindedElement = 0016392cdfbe773dd6740eaa7b41ad19b62b7552a5fff88a337
EvaluationElement = fc0afdf7f6eaefb86c884b2dd8a21ffe8c375d1e189def2d
Output = 52f8970ec1ed4759758135e5526422d0dfb912b45a963a0e94ea8aa27c0
seed = 9cd0d686c7af3459483e2dcd807912748650131d61c654dd0657213eea091
skSm = 2e233ab9d5a9300c0c8af8410b819eff8c47ddf6a65daddf046ee1ef91b05
pkSm = ac0a06cde8eddf02a5fb710537e00ffcac23ca6de5c744309366fd7fe71b7
Input = 00
Blind = 4c936db1779a621b6c71475ac3111fd5703a59b713929f36dfd1e892a7fe
BlindedElement = b06491721a030478fcf4756de92f0937e29a3898496964636be
EvaluationElement = e20b32caa3976efe88ff6104ae69d1e4110ce8d536e7b8d6
EvaluationProofC = 75162c17aaa22c38538ad5d3bb1dab6b7dde1410f76f58de2
EvaluationProofS = 6e6cb40e86974de14f2a96a87d8e4b78f31a92b67a2232f44
Output = 727b216c822412144797413444bf52bde9a7e3d0e0b8a18fbce80316914
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 15b3355179392f40c3d5a15f0d5ffc354e340454ec779f575e4573a3886a
BlindedElement = 3ea98d0d80c5e34582534f06daa3f5747d594fc271dddf4bcb9
EvaluationElement = 4a981797731fad28fac6c9423eaf3d4ec74214ef38edc8a6
EvaluationProofC = 3ec1c00ad2821e528058ed30081e6a1cd5f344a45e9bf51eb
EvaluationProofS = 0063bb1ffffe2e2ec2d22d7b9fa61d8d8914b5599eaaf8998
Output = 025579e09632d69fa8a58fb93fd7dd0b03fa719247cbe6716ebdc49e2c9
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 614bb578f29cc677ea9e7aea3e4839413997e020f9377b63c13584156a09
BlindedElement = 3a3cb2e82a88063371b1983fbb47e4b6838102f3225f21fb578
EvaluationElement = 8e6630cac5c1d4d7b76b478432a9a5b633314e0880d2c026
EvaluationProofC = 060ea0d134649060a9dc7d4747f9302096229bbd90d6bed3a
EvaluationProofS = f15fabd7dfb504b9473989366b19b6d3576d8c64670099f66
Output = 727b216c822412144797413444bf52bde9a7e3d0e0b8a18fbce80316914
seed = 3eff673ea2fb8669d141dddd1af5a7e43f97f3e00e00273f6435d8407ec93
skSm = 95771c829754f4bec369da4f9502fbd709b5b98a260ae720fe41661868639
Input = 00
Blind = 5d9e7f6efd3093c32ecceabd57fb03cf760c926d2a7bfa265babf29ec98a
BlindedElement = 02f09475852ef62318680a3ea1319d0474dfabc4402b752ec94
EvaluationElement = 03b304fc1030556762e95ada14aaf68358a68cc66efa231b
Output = a7bb47cee7f531bd5dc412a4a14b10c6fe532c5e9e74a7509a4b2349311
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 825155ab61f17605af2ae2e935c78d857c9407bcd45128d57d338f1671b5
BlindedElement = 02589019677db1bca1ca2f94da740691016578952337e2d19e0
EvaluationElement = 02d26a438f0b7fd11950ddca72f9d8302c3c9363c596255e
Output = 26918fb45d5aa80e101954ac6f6455497aab7423e7271571f87fad343c3
seed = ab2f339a7220e50cc4dc9da84913863596593d9ead69c6a61cf50d8da5cdf
skSm = 0773c16f0faf8a5d3e8f76631600d5d5837cb65192531d8f06add8151c895
pkSm = 02715ccbcb67ce334bc6527dfbc795aea8839d13c888eeae822022ff8062c
Input = 00
Blind = cee64d86fd20ab4caa264a26c0e3d42fb773b3173ba76f9588c9b14779bd
BlindedElement = 03458b1f2964895be9500419f7252a5f899932a0e1a80dad2a5
EvaluationElement = 02f33b62756f2af3e7789adb228a69d6a477fb9c71ff0bf7
EvaluationProofC = f20cd08a2fc81ac3379f1704cb1e63fd7d206fab9b0d8aeda
EvaluationProofS = 85ca571b54edea4b8bce2247c37cdea760aab6f480286e871
Output = 307bce9725d306e5b28c589084e9458985d57e482c8a4e92bf2ffd1e236
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 5c4b401063eff0bf242b4cd534a79bacfc2e715b2db1e7a3ad4ff8af1b24
BlindedElement = 02b600c8cd1f859fb7a87a1c9298b68d12902e4d093c9573af0
EvaluationElement = 03af5ace869c4c48a4d169f72a5d78fa806c566f36dbd73a
EvaluationProofC = 31b202d4df078ac8def9054a29ee0dce585fbff4384763606
EvaluationProofS = 1cfc5ab981b3da6a9ee344108fb1e2547e7817ec7f1966638
Output = cba462665ec1a01c302a05f2c29a2e4b5282ee639db91460f63353999ec
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = f0c7822ba317fb5e86028c44b92bd3aedcf6744d388ca013ef33edd36930
BlindedElement = 03ac68c358da4a3cff87c0a31e9646d178be69bbda8e00d204e
EvaluationElement = 03f7c0a0373e2bf57d0f86d92ad1e8d97c009a420d43706e
EvaluationProofC = 0785f1389d3e9e91e5514d97d192f8f35cd5288b52b750332
EvaluationProofS = b0e8ee29aabee13fa30833e9c55b9c657d1b52e6599058432
Output = 307bce9725d306e5b28c589084e9458985d57e482c8a4e92bf2ffd1e236
seed = 63e92b15555b6cb760d44daf230782c763430c860fcac60eac7508526b79c
skSm = 8abb9c0771d2fd11ffb7d84ae7623d32c92a8688f7ab4110f041cba48990a
Input = 00
Blind = 359073c015b92d15450f7fb395bf52c6ea98384c491fe4e4d423b59de7b0
BlindedElement = 022250ba7604814ab2058e70fdc5dcf2604afb3ab6e15fc97c5
EvaluationElement = 02779e7450227d438ee2b24d257cad8ec842fe6b1f1ed55e
Output = 26668250052b501b6d884549726eaf95094a4c249eb83ff6c90fab0e798
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 21ece4f9b6ffd01ce82082545413bd9bb5e8f3c63b86ae88d9ce0530b01c
BlindedElement = 022dd0addbced4c8ea73eaa8e38f43506a7c3f98288ed479725
EvaluationElement = 0274578679fbcff1a9d8e5fedf024361a039915b7e347540
Output = 4e603ffa07b244507b6939359caa372a27793c65a08027df9859fe768cb
seed = 1ce2b395fbc9b0c94142ca50b5237fbf30955deb98195e4a8f9b85b14cbfb
skSm = b33d6912f3d98f4127eb29022196ae5fd203875953fdd00eed62588cf7511
pkSm = 029668c6874e11fb84c854653910bad621060af56e3beaa459a454ac9d8d6
Input = 00
Blind = 102f6338df84c9602bfa9e7d690b1f7a173d07e6d54a419db4a6308f8b09
BlindedElement = 03c267661f12013daa1e4fe319713adde264a37bea8b91c5cb2
EvaluationElement = 02711fcd5e6f778121ff23f40fbbf0280ff022f61437be61
EvaluationProofC = 51ead6a0432a4d5c355fc58c075d420907e1155703a9df21e
EvaluationProofS = 88a8510e0aabfd3d0957616adc007508d030e21d695a768df
Output = 1512d25e41336b8975d51e061f3ad8ca79f76fb6c5467526c9fecfd38cf
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 8aec1d0c3d16afd032da7ba961449a56cec6fb918e932b06d5778ac7f67b
BlindedElement = 038f7b700d59fe135484a799fa10bb761b622d29a606ef9ecb5
EvaluationElement = 028bb86d62701dd511ae0e7d074ed46519c71d3d8b82be23
EvaluationProofC = 4ad66d430fe36eca8dd13d72b8a79c14afe42dd8b78196cef
EvaluationProofS = d8340cbcbf1bc19afeca7bac68610b6101588b99a99cea1dd
Output = 2fed20cb0c1bcda344057b5c16faa96cc62a9ae6572a94a175b1a2742a2
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 41fabd4722d92472d858051ce9ad1a533176a862c697b2c392aff2aeb77e
BlindedElement = 0261f6684d6b14f9a751e3837b09545fea017d792c3b3585524
EvaluationElement = 029a2f611bd2f4346e9f834e91c6828354fb49262e60473f
EvaluationProofC = a3009c06dd2c102d748bb7d3bc873fb6bad12aa310f6ca83a
EvaluationProofS = 861ab3ea88d2e428d0ca95332a7ccb3f3d71c5158502925e2
Output = 1512d25e41336b8975d51e061f3ad8ca79f76fb6c5467526c9fecfd38cf
seed = 860941f8d1d28513d9b38da971d0291cb2532a9dacc9256d5eaaa022e3f32
skSm = 0095b985908df61dae8bf8c037488cafea62377af2a2f41030f6dd8b3c750
Input = 00
Blind = 01b983705fcc9a39607288b935b0797ac6b3c4b2e848823ac9ae16b3a3b5
BlindedElement = 0301df6ecf5c96659ecc36613357a9f337b43687e0073f67b9a
EvaluationElement = 0300b7706ad75473f5265a4456b3fbc61c998895cc157cb1
Output = 3a34c3c5c87a7d14617e3f20fb76b861f6db25b0074369b80e5256dd30b
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 01a03b1096b0316bc8567c89bd70267d35c8ddcb2be2cdc867089a2eb5cf
BlindedElement = 0201412d7330e8ef457d1e21e25feb41c3b09d3bcd347916743
EvaluationElement = 020182d03c2244a6be2246f023ce67cd876b88dc75ebfcad
Output = 105da360c0bca0e14a645cbb8b93e0033d061f3351ac494882c9a00c9c6
seed = 2d317f9cfdbedf19e3b3264399ffbac20c1c39899b50af2f0abb24177ddfc
skSm = 0097bfe7b0db0760d3d062be371d5fb9ae91f75221dc7b24be288deec3dac
pkSm = 0200641f1fbe204bdf4f47b358a3daa1f0c68ca55e39716178ae7804c5b86
Input = 00
Blind = 00bbb82117c88bbd91b8954e16c0b9ceed3ce992b198be1ebfba9ba970db
BlindedElement = 0200f9ed4c09f771e30913440c62139f63300f6577d31f5af0b
EvaluationElement = 0300c69b7af34014ec66228f8109a71294e86b232a500ca4
EvaluationProofC = 0180092b8c106e6453eee63718642a11580d3943947940e71
EvaluationProofS = 00010c5168438bcfb0fcdd5737416ed4c2f3ab9fdd70d5552
Output = 5d6bb0a459ebabdc24f4eb1f2d5ba84967b5362e28b4263113ae82f64b6
Input = 5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 009055c99bf9591cb0eab2a72d044c05ca2cc2ef9b609a38546f74b6d688
BlindedElement = 0201dfa5dc7ea17f0cf60caa26d2a488e7af296268834b35eaf
EvaluationElement = 03008ec6ce61d8438ba2d10d83a476ba8cc28d7e385e2ea6
EvaluationProofC = 01dfab8e49173c15e3fe755b6d0d18181eb6f223cd44c4d8c
EvaluationProofS = 017a99db7e59297be3bee22d7de9f7939dbf55a3d0d3344ec
Output = be1882653a80f060f3c65f654270c202abbc5be961cb8c79ff952f2e284
Input = 00,5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a5a
Blind = 01c6cf092d80c7cf2cb55388d899515238094c800bdd9c65f71780ba85f5
BlindedElement = 0300be204aba0367d902f293aa8bda66a136f7e3962dfafab88
EvaluationElement = 0200482edc448a8be76098f64ff783309b7e5c1e8882b7e1
EvaluationProofC = 0008ce3eb07c5b4b230c1e7424d3282ebfa665aee41f69860
EvaluationProofS = 00b5521b8a33efb3bb0e1c02f5d93b3fb9d8f6531085a7117
Output = 5d6bb0a459ebabdc24f4eb1f2d5ba84967b5362e28b4263113ae82f64b6
