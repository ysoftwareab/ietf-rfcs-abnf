<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Certificate Management Protocol (CMP) Updates</title>
<meta content="Hendrik Brockhaus" name="author">
<meta content="David von Oheimb" name="author">
<meta content="
       This document contains a set of updates to the syntax and transport of Certificate Management Protocol (CMP) version 2. This document updates RFC 4210 and RFC 6712. 
       The aspects of CMP updated in this document are using EnvelopedData instead of EncryptedValue, clarifying the handling of p10cr messages, improving the crypto agility, as well as adding new general message types, extended key usages to identify certificates for use with CMP, and '.well-known' HTTP path segments. 
       To properly differentiate the support of EnvelopedData instead of EncryptedValue, the CMP version 3 is introduced in case a transaction is supposed to use EnvelopedData. 
    " name="description">
<meta content="xml2rfc 3.7.0" name="generator">
<meta content="CMP" name="keyword">
<meta content="draft-ietf-lamps-cmp-updates-10" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.7.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.4
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 56.0.0
    six 1.15.0
-->
<link href="/tmp/draft-ietf-lamps-cmp-updates-10-krs5sxv1.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">CMP Updates</td>
<td class="right">May 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Brockhaus &amp; von Oheimb</td>
<td class="center">Expires 5 November 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">LAMPS Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-lamps-cmp-updates-10</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc4210" class="eref">4210</a>, <a href="https://www.rfc-editor.org/rfc/rfc5912" class="eref">5912</a>, <a href="https://www.rfc-editor.org/rfc/rfc6712" class="eref">6712</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-05-04" class="published">4 May 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-11-05">5 November 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">H. Brockhaus</div>
<div class="org">Siemens</div>
</div>
<div class="author">
      <div class="author-name">D. von Oheimb</div>
<div class="org">Siemens</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Certificate Management Protocol (CMP) Updates</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document contains a set of updates to the syntax and transport of Certificate Management Protocol (CMP) version 2. This document updates RFC 4210 and RFC 6712.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The aspects of CMP updated in this document are using EnvelopedData instead of EncryptedValue, clarifying the handling of p10cr messages, improving the crypto agility, as well as adding new general message types, extended key usages to identify certificates for use with CMP, and '.well-known' HTTP path segments.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">To properly differentiate the support of EnvelopedData instead of EncryptedValue, the CMP version 3 is introduced in case a transaction is supposed to use EnvelopedData.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 5 November 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-convention-and-terminology" class="xref">Convention and Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-updates-to-rfc-4210-certifi" class="xref">Updates to RFC 4210 - Certificate Management Protocol (CMP)</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-new-section-11-changes-sinc" class="xref">New Section 1.1. - Changes since RFC 4210</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-new-section-45-extended-key" class="xref">New Section 4.5 - Extended Key Usage</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-update-section-511-pki-mess" class="xref">Update Section 5.1.1. - PKI Message Header</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-new-section-5113-rootcacert" class="xref">New Section 5.1.1.3. - RootCaCert</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-new-section-5114-certprofil" class="xref">New Section 5.1.1.4. - CertProfile</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-update-section-5131-shared-" class="xref">Update Section 5.1.3.1. - Shared Secret Information</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="xref">2.7</a>.  <a href="#name-replace-section-5134-multip" class="xref">Replace Section 5.1.3.4 - Multiple Protection</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a href="#section-2.8" class="xref">2.8</a>.  <a href="#name-replace-section-522-encrypt" class="xref">Replace Section 5.2.2. - Encrypted Values</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.9">
                <p id="section-toc.1-1.2.2.9.1"><a href="#section-2.9" class="xref">2.9</a>.  <a href="#name-update-section-534-certific" class="xref">Update Section 5.3.4. - Certification Response</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.10">
                <p id="section-toc.1-1.2.2.10.1"><a href="#section-2.10" class="xref">2.10</a>. <a href="#name-update-section-53192-signin" class="xref">Update Section 5.3.19.2. - Signing Key Pair Types</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.11">
                <p id="section-toc.1-1.2.2.11.1"><a href="#section-2.11" class="xref">2.11</a>. <a href="#name-update-section-53193-encryp" class="xref">Update Section 5.3.19.3. - Encryption/Key Agreement Key Pair Types</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.12">
                <p id="section-toc.1-1.2.2.12.1"><a href="#section-2.12" class="xref">2.12</a>. <a href="#name-replace-section-53199-revoc" class="xref">Replace Section 5.3.19.9. - Revocation Passphrase</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.13">
                <p id="section-toc.1-1.2.2.13.1"><a href="#section-2.13" class="xref">2.13</a>. <a href="#name-new-section-531914-ca-certi" class="xref">New Section 5.3.19.14 - CA Certificates</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.14">
                <p id="section-toc.1-1.2.2.14.1"><a href="#section-2.14" class="xref">2.14</a>. <a href="#name-new-section-531915-root-ca-" class="xref">New Section 5.3.19.15 - Root CA Certificate Update</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.15">
                <p id="section-toc.1-1.2.2.15.1"><a href="#section-2.15" class="xref">2.15</a>. <a href="#name-new-section-531916-certific" class="xref">New Section 5.3.19.16 - Certificate Request Template</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.16">
                <p id="section-toc.1-1.2.2.16.1"><a href="#section-2.16" class="xref">2.16</a>. <a href="#name-update-section-5322-polling" class="xref">Update Section 5.3.22 - Polling Request and Response</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.17">
                <p id="section-toc.1-1.2.2.17.1"><a href="#section-2.17" class="xref">2.17</a>. <a href="#name-update-section-7-version-ne" class="xref">Update Section 7 - Version Negotiation</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.18">
                <p id="section-toc.1-1.2.2.18.1"><a href="#section-2.18" class="xref">2.18</a>. <a href="#name-update-section-711-clients-" class="xref">Update Section 7.1.1. - Clients Talking to RFC 2510 Servers</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.19">
                <p id="section-toc.1-1.2.2.19.1"><a href="#section-2.19" class="xref">2.19</a>. <a href="#name-update-section-9-iana-consi" class="xref">Update Section 9 - IANA Considerations</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.20">
                <p id="section-toc.1-1.2.2.20.1"><a href="#section-2.20" class="xref">2.20</a>. <a href="#name-update-appendix-b-the-use-o" class="xref">Update Appendix B - The Use of Revocation Passphrase</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.21">
                <p id="section-toc.1-1.2.2.21.1"><a href="#section-2.21" class="xref">2.21</a>. <a href="#name-update-appendix-c-request-m" class="xref">Update Appendix C - Request Message Behavioral Clarifications</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.22">
                <p id="section-toc.1-1.2.2.22.1"><a href="#section-2.22" class="xref">2.22</a>. <a href="#name-update-appendix-d1-general-" class="xref">Update Appendix D.1. - General Rules for Interpretation of These Profiles</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.23">
                <p id="section-toc.1-1.2.2.23.1"><a href="#section-2.23" class="xref">2.23</a>. <a href="#name-update-appendix-d2-algorith" class="xref">Update Appendix D.2. - Algorithm Use Profile</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.24">
                <p id="section-toc.1-1.2.2.24.1"><a href="#section-2.24" class="xref">2.24</a>. <a href="#name-update-appendix-d4-initial-" class="xref">Update Appendix D.4. - Initial Registration/Certification (Basic Authenticated Scheme)</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-updates-to-rfc-6712-http-tr" class="xref">Updates to RFC 6712 - HTTP Transfer for the Certificate Management Protocol (CMP)</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-new-section-11-changes-since" class="xref">New Section 1.1. - Changes since RFC 6712</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-replace-section-36-http-req" class="xref">Replace Section 3.6. - HTTP Request-URI</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-update-section-6-iana-consi" class="xref">Update Section 6. - IANA Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-asn1-modules" class="xref">ASN.1 Modules</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-1988-asn1-module" class="xref">1988 ASN.1 Module</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-2002-asn1-module" class="xref">2002 ASN.1 Module</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-history-of-changes" class="xref">History of changes</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.c" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">While using <span><a href="#RFC4210" class="xref">CMP</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> in industrial and IoT environments and developing the <span><a href="#I-D.ietf-lamps-lightweight-cmp-profile" class="xref">Lightweight CMP Profile</a> [<a href="#I-D.ietf-lamps-lightweight-cmp-profile" class="xref">I-D.ietf-lamps-lightweight-cmp-profile</a>]</span> some limitations were identified in the original CMP specification. This document updates <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> and <span><a href="#RFC6712" class="xref">RFC 6712</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span> to overcome these limitations.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Among others, this document improves the crypto agility of CMP, which means to be flexible to react on future advances in cryptography.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This document also introduces new extended key usages to identify CMP endpoints on registration and certification authorities.<a href="#section-1-3" class="pilcrow">¶</a></p>
<div id="Convention_Terminology">
<section id="section-1.1">
        <h3 id="name-convention-and-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-convention-and-terminology" class="section-name selfRef">Convention and Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2" class="keepWithNext">Technical terminology is used in conformance with <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>, <span><a href="#RFC4211" class="xref">RFC 4211</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span>, and <span><a href="#RFC5280" class="xref">RFC 5280</a> [<a href="#RFC5280" class="xref">RFC5280</a>]</span>. The following key words are used:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-3">
          <dt id="section-1.1-3.1">CA:</dt>
          <dd style="margin-left: 3.0em" id="section-1.1-3.2">Certification authority, which issues certificates.<a href="#section-1.1-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.3">RA:</dt>
          <dd style="margin-left: 3.0em" id="section-1.1-3.4">Registration authority, an optional system component to which a CA delegates certificate management functions such as authorization checks.<a href="#section-1.1-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.5">KGA:</dt>
          <dd style="margin-left: 3.0em" id="section-1.1-3.6">Key generation authority, which generates key pairs on behalf of an EE. The KGA could be co-located with an RA or a CA.<a href="#section-1.1-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-3.7">EE:</dt>
          <dd style="margin-left: 3.0em" id="section-1.1-3.8">End entity, a user, device, or service that holds a PKI certificate. An identifier for the EE is given as its subject of the certificate.<a href="#section-1.1-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="CMP-Updates">
<section id="section-2">
      <h2 id="name-updates-to-rfc-4210-certifi">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-updates-to-rfc-4210-certifi" class="section-name selfRef">Updates to RFC 4210 - Certificate Management Protocol (CMP)</a>
      </h2>
<div id="CMP-1.1">
<section id="section-2.1">
        <h3 id="name-new-section-11-changes-sinc">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-new-section-11-changes-sinc" class="section-name selfRef">New Section 1.1. - Changes since RFC 4210</a>
        </h3>
<p id="section-2.1-1">The following subsection describes feature updates to <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>. They are always related to the base specification. Hence references to the original sections in <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> are used whenever possible.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2" class="keepWithNext">Insert this section at the end of the current Section 1:<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3" class="keepWithNext">1.1. Changes since RFC 4210<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">The following updates are made in [thisRFC]:<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-5.1">Add new extended key usages for various CMP server types, e.g., registration authority and certification authority, to express the authorization of the entity identified in the certificate containing the respective extended key usage extension to act as the indicated PKI management entity.<a href="#section-2.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.2">Extend the description of multiple protection to cover additional use cases, e.g., batch processing of messages.<a href="#section-2.1-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.3">Offering EnvelopedData as the preferred choice next to EncryptedValue to better support crypto agility in CMP. Note that according to <span><a href="#RFC4211" class="xref">RFC 4211</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> section 2.1. point 9 the use of the EncryptedValue structure has been deprecated in favor of the EnvelopedData structure. <span><a href="#RFC4211" class="xref">RFC 4211</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> offers the EncryptedKey structure, a choice of EncryptedValue and EnvelopedData for migration to EnvelopedData. For reasons of completeness and consistency the type EncryptedValue has been exchanged in all occurrences in <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>.  This includes the protection of centrally generated private keys, encryption of certificates, and protection of revocation passphrases. To properly differentiate the support of EnvelopedData instead of EncryptedValue, the CMP version 3 is introduced in case a transaction is supposed to use EnvelopedData.<a href="#section-2.1-5.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.4">Adding new general message types to request CA certificates, a root CA update, or a certificate request template.<a href="#section-2.1-5.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.5">Extend the usage of polling to p10cr messages.<a href="#section-2.1-5.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.1-5.6">Delete the mandatory algorithm profile in <span><a href="#RFC4210" class="xref">RFC 4210 Appendix D.2</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> and refer to <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms Section 7</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>.<a href="#section-2.1-5.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="CMP-4.5">
<section id="section-2.2">
        <h3 id="name-new-section-45-extended-key">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-new-section-45-extended-key" class="section-name selfRef">New Section 4.5 - Extended Key Usage</a>
        </h3>
<p id="section-2.2-1">The following subsection introduces a new extended key usage for CMP servers authorized to centrally generate key pairs on behalf of end entities.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2" class="keepWithNext">Insert this section at the end of the current Section 4:<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3" class="keepWithNext">4.5. Extended Key Usage<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">The Extended Key Usage (EKU) extension indicates the purposes for which the certified key pair may be used. It therefore restricts the use of a certificate to specific applications.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<p id="section-2.2-5">A CA may want to delegate parts of its duties to other PKI management entities. The mechanism to prove this delegation explained in this section offers an automatic way of checking the authorization of such delegation. Such delegation MAY also be expressed by other means, e.g., explicit configuration.<a href="#section-2.2-5" class="pilcrow">¶</a></p>
<p id="section-2.2-6">To offer automatic validation for the delegation of a role by a CA to another entity, the certificates used for CMP message protection or signed data for central key generation MUST be issued by the delegating CA and MUST contain the respective EKUs. This proves the authorization of this entity by the delegating CA to act in the given role as described below.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<p id="section-2.2-7" class="keepWithNext">The OIDs to be used for these EKUs are:<a href="#section-2.2-7" class="pilcrow">¶</a></p>
<div id="section-2.2-8">
<pre class="sourcecode lang-asn.1">
   id-kp-cmcCA OBJECT IDENTIFIER ::= {
      iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) kp(3) 27 }
   id-kp-cmcRA OBJECT IDENTIFIER ::= {
      iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) kp(3) 28 }
   id-kp-cmKGA OBJECT IDENTIFIER ::= {
      iso(1) identified-organization(3) dod(6) internet(1)
      security(5) mechanisms(5) pkix(7) kp(3) 32 }
</pre><a href="#section-2.2-8" class="pilcrow">¶</a>
</div>
<p id="section-2.2-9">Note: <span><a href="#RFC6402" class="xref">RFC 6402 section 2.10</a> [<a href="#RFC6402" class="xref">RFC6402</a>]</span> specifies OIDs for a CMC CA and a CMC RA. As the functionality of a CA and RA is not specific to using CMC or CMP as the certificate management protocol, these OIDs MAY be re-used.<a href="#section-2.2-9" class="pilcrow">¶</a></p>
<p id="section-2.2-10" class="keepWithNext">The meaning of the id-kp-cmKGA EKU is as follows:<a href="#section-2.2-10" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-11">
          <dt id="section-2.2-11.1">CMP KGA:</dt>
          <dd style="margin-left: 5.0em" id="section-2.2-11.2">CMP Key Generation Authorities are identified by the id-kp-cmKGA extended key usage.  The CMP KGA knows the private key it generated on behalf of the end entity.  This is a very sensitive service and therefore needs specific authorization.  This authorization is with the CA certificate itself. Alternatively, the CA MAY delegate the authorization by placing the id-kp-cmKGA extended key usage in the certificate used to authenticate the origin of the generated private key or the delegation MAY be determined through local configuration of the end entity.<a href="#section-2.2-11.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-12">Note: In device PKIs, especially those issuing IDevID certificates <span><a href="#IEEE.802.1AR_2018" class="xref">IEEE 802.1AR Section 8.5</a> [<a href="#IEEE.802.1AR_2018" class="xref">IEEE.802.1AR_2018</a>]</span>, CA certificates  may have very long validity (including the GeneralizedTime value 99991231235959Z to indicate a not well-defined expiration date as specified in <span><a href="#IEEE.802.1AR_2018" class="xref">IEEE 802.1AR Section 8.5</a> [<a href="#IEEE.802.1AR_2018" class="xref">IEEE.802.1AR_2018</a>]</span> and <span><a href="#RFC5280" class="xref">RFC 5280 Section 4.1.2.5</a> [<a href="#RFC5280" class="xref">RFC5280</a>]</span>). Such validity periods SHOULD NOT be used for protection of CMP messages and key generation.  Certificates containing one of the above EKUs SHOULD NOT use indefinite expiration date.<a href="#section-2.2-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.1.1">
<section id="section-2.3">
        <h3 id="name-update-section-511-pki-mess">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-update-section-511-pki-mess" class="section-name selfRef">Update Section 5.1.1. - PKI Message Header</a>
        </h3>
<p id="section-2.3-1">Section 5.1.1 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes the PKI message header. This document introduces the new version 3 indicating support of EnvelopedData as specified in <a href="#CMP-5.2.2" class="xref">Section 2.8</a>.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2" class="keepWithNext">Replace the ASN.1 Syntax of PKIHeader and the subsequent description of pvno with the following text:<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<div id="section-2.3-3">
<pre class="sourcecode lang-asn.1">
   PKIHeader ::= SEQUENCE {
      pvno                INTEGER     { cmp1999(1), cmp2000(2),
                                        cmp2021(3) },
      sender              GeneralName,
      recipient           GeneralName,
      messageTime     [0] GeneralizedTime         OPTIONAL,
      protectionAlg   [1] AlgorithmIdentifier     OPTIONAL,
      senderKID       [2] KeyIdentifier           OPTIONAL,
      recipKID        [3] KeyIdentifier           OPTIONAL,
      transactionID   [4] OCTET STRING            OPTIONAL,
      senderNonce     [5] OCTET STRING            OPTIONAL,
      recipNonce      [6] OCTET STRING            OPTIONAL,
      freeText        [7] PKIFreeText             OPTIONAL,
      generalInfo     [8] SEQUENCE SIZE (1..MAX) OF
                          InfoTypeAndValue     OPTIONAL
   }
   PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
</pre><a href="#section-2.3-3" class="pilcrow">¶</a>
</div>
<p id="section-2.3-4">The usage of pvno values is described in Section 7.<a href="#section-2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.1.1.3">
<section id="section-2.4">
        <h3 id="name-new-section-5113-rootcacert">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-new-section-5113-rootcacert" class="section-name selfRef">New Section 5.1.1.3. - RootCaCert</a>
        </h3>
<p id="section-2.4-1">Section 5.1.1 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> defines the PKIHeader and id-it OIDs to be used in the generalInfo field. This section introduces id-it-rootCaCert.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">Insert this section after Section 5.1.1.2:<a href="#section-2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.4-3">5.1.1.3. RootCaCert<a href="#section-2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.4-4">This is used by the EE to indicate a specific root CA certificate, e.g., when requesting a root CA certificate update, see Section 5.3.19.15.<a href="#section-2.4-4" class="pilcrow">¶</a></p>
<div id="section-2.4-5">
<pre class="sourcecode lang-asn.1">
   id-it-rootCaCert  OBJECT IDENTIFIER ::= {id-it TBD5}
      RootCaCertValue ::= CMPCertificate
</pre><a href="#section-2.4-5" class="pilcrow">¶</a>
</div>
<p id="section-2.4-6">&lt; TBD: The OID TBD5 has to be registered at IANA. &gt;<a href="#section-2.4-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.1.1.4">
<section id="section-2.5">
        <h3 id="name-new-section-5114-certprofil">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-new-section-5114-certprofil" class="section-name selfRef">New Section 5.1.1.4. - CertProfile</a>
        </h3>
<p id="section-2.5-1">Section 5.1.1 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> defines the PKIHeader and id-it OIDs to be used in the generalInfo field. This section introduces id-it-certProfile.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">Insert this section after Section 5.1.1.3:<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<p id="section-2.5-3">5.1.1.4. CertProfile<a href="#section-2.5-3" class="pilcrow">¶</a></p>
<p id="section-2.5-4">This is used by the EE to indicate a specific certificate profile, e.g., when requesting a new certificate or a certificate request template, see Section 5.3.19.16.<a href="#section-2.5-4" class="pilcrow">¶</a></p>
<div id="section-2.5-5">
<pre class="sourcecode lang-asn.1">
   id-it-certProfile  OBJECT IDENTIFIER ::= {id-it TBD6}
      CertProfileValue ::= UTF8String
</pre><a href="#section-2.5-5" class="pilcrow">¶</a>
</div>
<p id="section-2.5-6">&lt; TBD: The OID TBD6 has to be registered at IANA. &gt;<a href="#section-2.5-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.1.3.1">
<section id="section-2.6">
        <h3 id="name-update-section-5131-shared-">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-update-section-5131-shared-" class="section-name selfRef">Update Section 5.1.3.1. - Shared Secret Information</a>
        </h3>
<p id="section-2.6-1">Section 5.1.3.1 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes the MAC based protection of a PKIMessage using the algorithm id-PasswordBasedMac.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.6-2">Replace the first paragraph with the following text:<a href="#section-2.6-2" class="pilcrow">¶</a></p>
<p id="section-2.6-3">In this case, the sender and recipient share secret information with sufficient entropy (established via out-of-band means or from a previous PKI management operation). PKIProtection will contain a MAC value and the protectionAlg MAY be one of the options described in <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>. The PasswordBasedMac is specified as follows (see also <span>[<a href="#RFC4211" class="xref">RFC4211</a>]</span> and <span>[<a href="#I-D.ietf-lamps-crmf-update-algs" class="xref">I-D.ietf-lamps-crmf-update-algs</a>]</span>):<a href="#section-2.6-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.1.3.4">
<section id="section-2.7">
        <h3 id="name-replace-section-5134-multip">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-replace-section-5134-multip" class="section-name selfRef">Replace Section 5.1.3.4 - Multiple Protection</a>
        </h3>
<p id="section-2.7-1">Section 5.1.3.4 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes the nested message. This document enables using nested messages also for batch transport of PKI messages between PKI management entities and with mixed body types.<a href="#section-2.7-1" class="pilcrow">¶</a></p>
<p id="section-2.7-2" class="keepWithNext">Replace the text of the section with the following text:<a href="#section-2.7-2" class="pilcrow">¶</a></p>
<p id="section-2.7-3" class="keepWithNext">5.1.3.4.  Multiple Protection<a href="#section-2.7-3" class="pilcrow">¶</a></p>
<p id="section-2.7-4">When receiving a protected PKI message, a PKI management entity such as an RA MAY forward that message adding its own protection (which MAY be a MAC or a signature, depending on the information and certificates shared between the RA and the CA). Moreover, multiple PKI messages MAY be aggregated. There are several use cases for such messages.<a href="#section-2.7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.7-5.1">The RA confirms having validated and authorized a message and forwards the original message unchanged.<a href="#section-2.7-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.7-5.2">The RA modifies the message(s) in some way (e.g., adds or modifies particular field values or add new extensions) before forwarding them, then it MAY create its own desired PKIBody.  If the changes made by the RA to PKIMessage break the POP of a certificate request, the RA MUST set the POP RAVerified. It MAY include the original PKIMessage from the EE in the generalInfo field of PKIHeader of a nested message (to accommodate, for example, cases in which the CA wishes to check POP or other information on the original EE message). The infoType to be used in this situation is {id-it 15} (see Section 5.3.19 for the value of id-it) and the infoValue is PKIMessages (contents MUST be in the same order as the message in PKIBody).<a href="#section-2.7-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.7-5.3">The RA collects several messages that are to be forwarded in the same direction and forwards them in a batch. In communication to the CA request messages and in communication from the CA response or announcement messages will be collected. This can for instance be used when bridging an off-line connection between two PKI management entities.<a href="#section-2.7-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.7-6" class="keepWithNext">These use cases are accomplished by nesting the messages within a new PKI message.  The structure used is as follows:<a href="#section-2.7-6" class="pilcrow">¶</a></p>
<div id="section-2.7-7">
<pre class="sourcecode lang-asn.1">
   NestedMessageContent ::= PKIMessages
</pre><a href="#section-2.7-7" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="CMP-5.2.2">
<section id="section-2.8">
        <h3 id="name-replace-section-522-encrypt">
<a href="#section-2.8" class="section-number selfRef">2.8. </a><a href="#name-replace-section-522-encrypt" class="section-name selfRef">Replace Section 5.2.2. - Encrypted Values</a>
        </h3>
<p id="section-2.8-1">Section 5.2.2 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes the use of EncryptedValue to transport encrypted data. This document extends the encryption of data to preferably use EnvelopedData.<a href="#section-2.8-1" class="pilcrow">¶</a></p>
<p id="section-2.8-2" class="keepWithNext">Replace the text of the section with the following text:<a href="#section-2.8-2" class="pilcrow">¶</a></p>
<p id="section-2.8-3" class="keepWithNext">5.2.2.  Encrypted Values<a href="#section-2.8-3" class="pilcrow">¶</a></p>
<p id="section-2.8-4">Where encrypted data (in this specification, private keys, certificates, or revocation passphrase) are sent in PKI messages, the EncryptedKey data structure is used.<a href="#section-2.8-4" class="pilcrow">¶</a></p>
<div id="section-2.8-5">
<pre class="sourcecode lang-asn.1">
   EncryptedKey ::= CHOICE {
      encryptedValue        EncryptedValue, -- deprecated
      envelopedData     [0] EnvelopedData }
</pre><a href="#section-2.8-5" class="pilcrow">¶</a>
</div>
<p id="section-2.8-6">See <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> for EncryptedKey and EncryptedValue syntax and <span><a href="#RFC5652" class="xref">CMS</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span> for EnvelopedData syntax. Using the EncryptedKey data structure offers the choice to either use EncryptedValue (for backward compatibility only) or EnvelopedData.  The use of the EncryptedValue structure has been deprecated in favor of the EnvelopedData structure.  Therefore, it is recommended to use EnvelopedData.<a href="#section-2.8-6" class="pilcrow">¶</a></p>
<p id="section-2.8-7">Note: The EncryptedKey structure defined in <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> is reused here, which makes the update backward compatible. Using the new syntax with the untagged default choice EncryptedValue is bits-on-the-wire compatible with the old syntax.<a href="#section-2.8-7" class="pilcrow">¶</a></p>
<p id="section-2.8-8">To indicate support for EnvelopedData the pvno cmp2021 is introduced by this document. Details on the usage of pvno values is described in Section 7.<a href="#section-2.8-8" class="pilcrow">¶</a></p>
<p id="section-2.8-9">The EncryptedKey data structure is used in CMP to transport a private key, certificate, or revocation passphrase in encrypted form.<a href="#section-2.8-9" class="pilcrow">¶</a></p>
<p id="section-2.8-10" class="keepWithNext">EnvelopedData is used as follows:<a href="#section-2.8-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.8-11.1">It contains only one RecipientInfo structure because the content is encrypted only for one recipient.<a href="#section-2.8-11.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.8-11.2">It may contain a private key in the AsymmetricKeyPackage structure as defined in <span><a href="#RFC5958" class="xref">RFC 5958</a> [<a href="#RFC5958" class="xref">RFC5958</a>]</span> wrapped in a SignedData structure as specified in <span><a href="#RFC5652" class="xref">CMS section 5</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span> signed by the Key Generation Authority.<a href="#section-2.8-11.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.8-11.3">It may contain a certificate or revocation passphrase directly in the encryptedContent field.<a href="#section-2.8-11.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.8-12">The content of the EnvelopedData structure, as specified in <span><a href="#RFC5652" class="xref">CMS section 6</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span>, MUST be encrypted using a newly generated symmetric content-encryption key. This content-encryption key MUST be securely provided to the recipient using one of three key management techniques.<a href="#section-2.8-12" class="pilcrow">¶</a></p>
<p id="section-2.8-13" class="keepWithNext">The choice of the key management technique to be used by the sender depends on the credential available at the recipient:<a href="#section-2.8-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.8-14.1">Recipient's certificate that contains a key usage extension asserting keyAgreement: The content-encryption key will be protected using the key agreement key management technique, as specified in <span><a href="#RFC5652" class="xref">CMS section 6.2.2</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span>. This is the preferred technique.<a href="#section-2.8-14.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.8-14.2">Recipient's certificate that contains a key usage extension asserting keyEncipherment: The content-encryption key will be protected using the key transport key management technique, as specified in <span><a href="#RFC5652" class="xref">CMS section 6.2.1</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span>.<a href="#section-2.8-14.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.8-14.3">A password or shared secret: The content-encryption key will be protected using the password-based key management technique, as specified in <span><a href="#RFC5652" class="xref">CMS section 6.2.4</a> [<a href="#RFC5652" class="xref">RFC5652</a>]</span>.<a href="#section-2.8-14.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="CMP-5.3.4">
<section id="section-2.9">
        <h3 id="name-update-section-534-certific">
<a href="#section-2.9" class="section-number selfRef">2.9. </a><a href="#name-update-section-534-certific" class="section-name selfRef">Update Section 5.3.4. - Certification Response</a>
        </h3>
<p id="section-2.9-1">Section 5.3.4 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes the Certification Response. This document updates the syntax by using the parent structure EncryptedKey instead of EncryptedValue as described in <a href="#CMP-5.2.2" class="xref">Section 2.8</a> above. Moreover, it clarifies the certReqId to be used in response to a p10cr message.<a href="#section-2.9-1" class="pilcrow">¶</a></p>
<p id="section-2.9-2" class="keepWithNext">Replace the ASN.1 syntax of CertifiedKeyPair and CertOrEncCert with the following text:<a href="#section-2.9-2" class="pilcrow">¶</a></p>
<div id="section-2.9-3">
<pre class="sourcecode lang-asn.1">
   CertifiedKeyPair ::= SEQUENCE {
      certOrEncCert       CertOrEncCert,
      privateKey      [0] EncryptedKey        OPTIONAL,
      -- see [CRMF] for comment on encoding
      publicationInfo [1] PKIPublicationInfo  OPTIONAL
   }

   CertOrEncCert ::= CHOICE {
      certificate     [0] Certificate,
      encryptedCert   [1] EncryptedKey
   }
</pre><a href="#section-2.9-3" class="pilcrow">¶</a>
</div>
<p id="section-2.9-4" class="keepWithNext">Add the following as a new paragraph right after the ASN.1 syntax:<a href="#section-2.9-4" class="pilcrow">¶</a></p>
<p id="section-2.9-5">A p10cr message contains exactly one CertificationRequestInfo data structure as specified in <span><a href="#RFC2986" class="xref">PKCS#10</a> [<a href="#RFC2986" class="xref">RFC2986</a>]</span> but no certReqId.  Therefore, the certReqId in the corresponding certification response (cp) message MUST be set to 0.<a href="#section-2.9-5" class="pilcrow">¶</a></p>
<p id="section-2.9-6" class="keepWithNext">Add the following as new paragraphs to the end of the section:<a href="#section-2.9-6" class="pilcrow">¶</a></p>
<p id="section-2.9-7">The use of EncryptedKey is described in Section 5.2.2.<a href="#section-2.9-7" class="pilcrow">¶</a></p>
<p id="section-2.9-8">Note: To indicate support for EnvelopedData the pvno cmp2021 is introduced by this document. Details on the usage of different pvno values is described in Section 7.<a href="#section-2.9-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.2">
<section id="section-2.10">
        <h3 id="name-update-section-53192-signin">
<a href="#section-2.10" class="section-number selfRef">2.10. </a><a href="#name-update-section-53192-signin" class="section-name selfRef">Update Section 5.3.19.2. - Signing Key Pair Types</a>
        </h3>
<p id="section-2.10-1">The following section clarifies the usage of the Signing Key Pair Types on referencing EC curves.<a href="#section-2.10-1" class="pilcrow">¶</a></p>
<p id="section-2.10-2" class="keepWithNext">Insert this note at the end of Section 5.3.19.2:<a href="#section-2.10-2" class="pilcrow">¶</a></p>
<p id="section-2.10-3">Note: In case several EC curves are supported, several id-ecPublicKey elements need to be given, one per named curve.<a href="#section-2.10-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.3">
<section id="section-2.11">
        <h3 id="name-update-section-53193-encryp">
<a href="#section-2.11" class="section-number selfRef">2.11. </a><a href="#name-update-section-53193-encryp" class="section-name selfRef">Update Section 5.3.19.3. - Encryption/Key Agreement Key Pair Types</a>
        </h3>
<p id="section-2.11-1">The following section clarifies the use of the Encryption/Key Agreement Key Pair Types on referencing EC curves.<a href="#section-2.11-1" class="pilcrow">¶</a></p>
<p id="section-2.11-2">Insert this note at the end of Section 5.3.19.3:<a href="#section-2.11-2" class="pilcrow">¶</a></p>
<p id="section-2.11-3" class="keepWithNext">Note: In case several EC curves are supported, several id-ecPublicKey elements need to be given, one per named curve.<a href="#section-2.11-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.9">
<section id="section-2.12">
        <h3 id="name-replace-section-53199-revoc">
<a href="#section-2.12" class="section-number selfRef">2.12. </a><a href="#name-replace-section-53199-revoc" class="section-name selfRef">Replace Section 5.3.19.9. - Revocation Passphrase</a>
        </h3>
<p id="section-2.12-1">Section 5.3.19.9 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes the provisioning of a revocation passphrase for authenticating a later revocation request. This document updates the handling by using the parent structure EncryptedKey instead of EncryptedValue to transport this information as described in <a href="#CMP-5.2.2" class="xref">Section 2.8</a> above.<a href="#section-2.12-1" class="pilcrow">¶</a></p>
<p id="section-2.12-2" class="keepWithNext">Replace the text of the section with the following text:<a href="#section-2.12-2" class="pilcrow">¶</a></p>
<p id="section-2.12-3" class="keepWithNext">5.3.19.9.  Revocation Passphrase<a href="#section-2.12-3" class="pilcrow">¶</a></p>
<p id="section-2.12-4">This MAY be used by the EE to send a passphrase to a CA/RA for the purpose of authenticating a later revocation request (in the case that the appropriate signing private key is no longer available to authenticate the request).  See Appendix B for further details on the use of this mechanism.<a href="#section-2.12-4" class="pilcrow">¶</a></p>
<div id="section-2.12-5">
<pre class="sourcecode lang-asn.1">
   GenMsg:    {id-it 12}, EncryptedKey
   GenRep:    {id-it 12}, &lt; absent &gt;
</pre><a href="#section-2.12-5" class="pilcrow">¶</a>
</div>
<p id="section-2.12-6">The use of EncryptedKey is described in Section 5.2.2.<a href="#section-2.12-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.14">
<section id="section-2.13">
        <h3 id="name-new-section-531914-ca-certi">
<a href="#section-2.13" class="section-number selfRef">2.13. </a><a href="#name-new-section-531914-ca-certi" class="section-name selfRef">New Section 5.3.19.14 - CA Certificates</a>
        </h3>
<p id="section-2.13-1">The following subsection describes PKI general messages using id-it-caCerts. The use is specified in Lightweight CMP Profile [I-D.ietf-lamps-lightweight-cmp-profile] Section 4.4.<a href="#section-2.13-1" class="pilcrow">¶</a></p>
<p id="section-2.13-2" class="keepWithNext">Insert this section after Section 5.3.19.13:<a href="#section-2.13-2" class="pilcrow">¶</a></p>
<p id="section-2.13-3" class="keepWithNext">2.3.19.14 CA Certificates<a href="#section-2.13-3" class="pilcrow">¶</a></p>
<p id="section-2.13-4">This MAY be used by the client to get the current CA intermediate and issuing CA certificates.<a href="#section-2.13-4" class="pilcrow">¶</a></p>
<div id="section-2.13-5">
<pre class="sourcecode lang-asn.1">
   GenMsg:    {id-it 17}, &lt; absent &gt;
   GenRep:    {id-it 17}, SEQUENCE OF CMPCertificate | &lt; absent &gt;
</pre><a href="#section-2.13-5" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="CMP-5.3.19.15">
<section id="section-2.14">
        <h3 id="name-new-section-531915-root-ca-">
<a href="#section-2.14" class="section-number selfRef">2.14. </a><a href="#name-new-section-531915-root-ca-" class="section-name selfRef">New Section 5.3.19.15 - Root CA Certificate Update</a>
        </h3>
<p id="section-2.14-1">The following subsection describes PKI general messages using id-it-rootCaKeyUpdate. The use is specified in Lightweight CMP Profile [I-D.ietf-lamps-lightweight-cmp-profile] Section 4.4.<a href="#section-2.14-1" class="pilcrow">¶</a></p>
<p id="section-2.14-2" class="keepWithNext">Insert this section after new Section 5.3.19.14:<a href="#section-2.14-2" class="pilcrow">¶</a></p>
<p id="section-2.14-3" class="keepWithNext">5.3.19.15. Root CA Certificate Update<a href="#section-2.14-3" class="pilcrow">¶</a></p>
<p id="section-2.14-4">This MAY be used by the client to get an update of an existing root CA Certificate, which MAY be indicated in the rootCaCert field, see Section 5.1.1.3, of the PKIHeader of the request message.  In contrast to the ckuann message this approach follows the request/response model.<a href="#section-2.14-4" class="pilcrow">¶</a></p>
<div id="section-2.14-5">
<pre class="sourcecode lang-asn.1">
   GenMsg:    {id-it 18}, &lt; absent &gt;
   GenRep:    {id-it 18}, RootCaKeyUpdateContent | &lt; absent &gt;

   RootCaKeyUpdateContent ::= SEQUENCE {
      newWithNew       CMPCertificate,
      newWithOld   [0] CMPCertificate OPTIONAL,
      oldWithNew   [1] CMPCertificate OPTIONAL
      }
</pre><a href="#section-2.14-5" class="pilcrow">¶</a>
</div>
<p id="section-2.14-6">Note: In contrast to CAKeyUpdAnnContent, this type offers omitting newWithOld and oldWithNew in the GenRep message, depending on the needs of the EE.<a href="#section-2.14-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.3.19.16">
<section id="section-2.15">
        <h3 id="name-new-section-531916-certific">
<a href="#section-2.15" class="section-number selfRef">2.15. </a><a href="#name-new-section-531916-certific" class="section-name selfRef">New Section 5.3.19.16 - Certificate Request Template</a>
        </h3>
<p id="section-2.15-1">The following subsection introduces the PKI general message using id-it-certReqTemplate. Details are specified in the Lightweight CMP Profile [I-D.ietf-lamps-lightweight-cmp-profile] Section 4.4.<a href="#section-2.15-1" class="pilcrow">¶</a></p>
<p id="section-2.15-2" class="keepWithNext">Insert this section after new Section 5.3.19.15:<a href="#section-2.15-2" class="pilcrow">¶</a></p>
<p id="section-2.15-3" class="keepWithNext">5.3.19.16. Certificate Request Template<a href="#section-2.15-3" class="pilcrow">¶</a></p>
<p id="section-2.15-4">This MAY be used by the client to get a template containing requirements for certificate request attributes and extensions. The controls id-regCtrl-algId and id-regCtrl-rsaKeyLen MAY contain details on the types of subject public keys the CA is willing to certify.<a href="#section-2.15-4" class="pilcrow">¶</a></p>
<p id="section-2.15-5">The id-regCtrl-algId control MAY be used to identify a cryptographic algorithm, see <span><a href="#RFC5280" class="xref">RFC 5280 Section 4.1.2.7</a> [<a href="#RFC5280" class="xref">RFC5280</a>]</span>, other than rsaEncryption. The algorithm field SHALL identify a cryptographic algorithm. The contents of the optional parameters field will vary according to the algorithm identified. For example, when the algorithm is set to id-ecPublicKey, the parameters identify the elliptic curve to be used, see <span>[<a href="#RFC5480" class="xref">RFC5480</a>]</span>.<a href="#section-2.15-5" class="pilcrow">¶</a></p>
<p id="section-2.15-6">The id-regCtrl-rsaKeyLen control SHALL be used for algorithm rsaEncrytion and SHALL contain the intended modulus bit length of the RSA key.<a href="#section-2.15-6" class="pilcrow">¶</a></p>
<p id="section-2.15-7" class="keepWithNext"></p>
<div id="section-2.15-8">
<pre class="sourcecode lang-asn.1">
   GenMsg:    {id-it 19}, &lt; absent &gt;
   GenRep:    {id-it 19}, CertReqTemplateContent | &lt; absent &gt;

   CertReqTemplateValue  ::= CertReqTemplateContent
   CertReqTemplateContent ::= SEQUENCE {
     certTemplate           CertTemplate,
     keySpec                Controls OPTIONAL
     }

   Controls  ::= SEQUENCE SIZE(1..MAX) OF AttributeTypeAndValue

   id-regCtrl-algId OBJECT IDENTIFIER ::= { iso(1)
      identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) pkip(5) regCtrl(1) TBD3 }
   AlgIdCtrl ::= AlgorithmIdentifier{ALGORITHM, {...}}

   id-regCtrl-rsaKeyLen OBJECT IDENTIFIER ::= { iso(1)
      identified-organization(3) dod(6) internet(1) security(5)
      mechanisms(5) pkix(7) pkip(5) regCtrl(1) TBD4 }
   RsaKeyLenCtrl ::= INTEGER
</pre><a href="#section-2.15-8" class="pilcrow">¶</a>
</div>
<p id="section-2.15-9">&lt; TBD: The OIDs TBD3 and TBD4 have to be registered at IANA. &gt;<a href="#section-2.15-9" class="pilcrow">¶</a></p>
<p id="section-2.15-10">The CertReqTemplateValue contains the prefilled certTemplate to be used for a future certificate request.  The publicKey field in the certTemplate MUST NOT be used.  In case the PKI management entity wishes to specify supported public-key algorithms, the keySpec field MUST be used.  One AttributeTypeAndValue per supported algorithm or RSA key length MUST be used.<a href="#section-2.15-10" class="pilcrow">¶</a></p>
<p id="section-2.15-11">Note: The Controls ASN.1 type is defined in <span><a href="#RFC4211" class="xref">CRMF Section 6</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span><a href="#section-2.15-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-5.3.22">
<section id="section-2.16">
        <h3 id="name-update-section-5322-polling">
<a href="#section-2.16" class="section-number selfRef">2.16. </a><a href="#name-update-section-5322-polling" class="section-name selfRef">Update Section 5.3.22 - Polling Request and Response</a>
        </h3>
<p id="section-2.16-1">Section 5.3.22 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes when and how polling messages are used. This document adds the polling mechanism also for outstanding responses to a p10cr.<a href="#section-2.16-1" class="pilcrow">¶</a></p>
<p id="section-2.16-2" class="keepWithNext">Replace in the first paragraph the word 'cr' by 'cr, p10cr' and add just before the state machine diagram the following text:<a href="#section-2.16-2" class="pilcrow">¶</a></p>
<p id="section-2.16-3">A p10cr message contains exactly one CertificationRequestInfo data structure as specified in <span><a href="#RFC2986" class="xref">PKCS#10</a> [<a href="#RFC2986" class="xref">RFC2986</a>]</span> but no certificate request identifier.  Therefore, the certReqId MUST be set to 0 in all subsequent messages of this transaction.<a href="#section-2.16-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-7">
<section id="section-2.17">
        <h3 id="name-update-section-7-version-ne">
<a href="#section-2.17" class="section-number selfRef">2.17. </a><a href="#name-update-section-7-version-ne" class="section-name selfRef">Update Section 7 - Version Negotiation</a>
        </h3>
<p id="section-2.17-1">Section 7 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes the use of CMP protocol versions. This document describes the handling of the additional CMP version cmp2021 introduced to indicate support of EnvelopedData.<a href="#section-2.17-1" class="pilcrow">¶</a></p>
<p id="section-2.17-2" class="keepWithNext">Replace the text of the first two paragraphs with the following text:<a href="#section-2.17-2" class="pilcrow">¶</a></p>
<p id="section-2.17-3">This section defines the version negotiation between client and server used to choose among cmp1999 (specified in <span><a href="#RFC2510" class="xref">RFC 2510</a> [<a href="#RFC2510" class="xref">RFC2510</a>]</span>), cmp2000 (specified in <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>), and cmp2021 (specified in this document). The only difference between protocol versions cmp2021 and cmp2000 is that EnvelopedData replaces EncryptedValue.<a href="#section-2.17-3" class="pilcrow">¶</a></p>
<p id="section-2.17-4" class="keepWithNext">If a client does not support cmp2021 it chooses the versions for a request as follows:<a href="#section-2.17-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.17-5.1">If the client knows the protocol version(s) supported by the server (e.g., from a previous PKIMessage exchange or via some out-of-band means), then it MUST send a PKIMessage with the highest version supported by both itself and the server.<a href="#section-2.17-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.17-5.2">If the client does not know what version(s) the server supports, then it MUST send a PKIMessage using the highest version it supports.<a href="#section-2.17-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.17-6" class="keepWithNext">If a client supports cmp2021 and encrypted values are supposed to be transferred in the PKI management operation the client MUST choose the version for a request as follows:<a href="#section-2.17-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.17-7.1">If the client supports EnvelopedData, but not EncryptedValue, then it MUST send a PKIMessage using cmp2021.<a href="#section-2.17-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.17-7.2">If the client does not support EnvelopedData, but EncryptedValue, then it MUST send a PKIMessage using cmp2000.<a href="#section-2.17-7.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.17-7.3">
            <p id="section-2.17-7.3.1" class="keepWithNext">If the client supports both EnvelopedData and EncryptedValue:<a href="#section-2.17-7.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.17-7.3.2.1">If the client knows the protocol version(s) supported by the server (e.g., from a previous PKIMessage exchange or via some out-of-band means), then it MUST send a PKIMessage with the highest version supported the server.<a href="#section-2.17-7.3.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.17-7.3.2.2">If the client does not know what version(s) the server supports, then it MUST send a PKIMessage using cmp2021.<a href="#section-2.17-7.3.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
</section>
</div>
<div id="CMP-7.1.1">
<section id="section-2.18">
        <h3 id="name-update-section-711-clients-">
<a href="#section-2.18" class="section-number selfRef">2.18. </a><a href="#name-update-section-711-clients-" class="section-name selfRef">Update Section 7.1.1. - Clients Talking to RFC 2510 Servers</a>
        </h3>
<p id="section-2.18-1">Section 7.1.1 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes the behavior of a client sending a cmp2000 message talking to a cmp1999 server. This document extends the section to clients with any higher version than cmp1999.<a href="#section-2.18-1" class="pilcrow">¶</a></p>
<p id="section-2.18-2" class="keepWithNext">Replace the first sentence of Section 7.1.1 with the following text:<a href="#section-2.18-2" class="pilcrow">¶</a></p>
<p id="section-2.18-3">If, after sending a message with a protocol version number higher than cmp1999, a client receives an ErrorMsgContent with a version of cmp1999, then it MUST abort the current transaction.<a href="#section-2.18-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-9">
<section id="section-2.19">
        <h3 id="name-update-section-9-iana-consi">
<a href="#section-2.19" class="section-number selfRef">2.19. </a><a href="#name-update-section-9-iana-consi" class="section-name selfRef">Update Section 9 - IANA Considerations</a>
        </h3>
<p id="section-2.19-1">Section 9 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> contains the IANA Considerations of that document. As this document defines a new Extended Key Usage, the IANA Considerations need to be updated accordingly.<a href="#section-2.19-1" class="pilcrow">¶</a></p>
<p id="section-2.19-2" class="keepWithNext">Add the following paragraphs after the third paragraph of the section:<a href="#section-2.19-2" class="pilcrow">¶</a></p>
<p id="section-2.19-3">In the SMI-numbers registry "SMI Security for PKIX Extended Key Purpose Identifiers (1.3.6.1.5.5.7.3)" (see https://www.iana.org/assignments/smi-numbers/smi-numbers.xhtml#smi-numbers-1.3.6.1.5.5.7.3) as defined in <span><a href="#RFC7299" class="xref">RFC 7299</a> [<a href="#RFC7299" class="xref">RFC7299</a>]</span> one addition has been performed.<a href="#section-2.19-3" class="pilcrow">¶</a></p>
<p id="section-2.19-4" class="keepWithNext">One new entry has been added:<a href="#section-2.19-4" class="pilcrow">¶</a></p>
<span id="name-addition-to-the-pkix-extend"></span><div id="IANA_new_EKU">
<table class="left" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-addition-to-the-pkix-extend" class="selfRef">Addition to the PKIX Extended Key Purpose Identifiers registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Decimal</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">32</td>
              <td class="text-left" rowspan="1" colspan="1">id-kp-cmKGA</td>
              <td class="text-left" rowspan="1" colspan="1">[thisRFC]</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.19-6">In the SMI-numbers registry "SMI Security for PKIX CMP Information Types (1.3.6.1.5.5.7.4)" (see https://www.iana.org/assignments/smi-numbers/smi-numbers.xhtml#smi-numbers-1.3.6.1.5.5.7.4) as defined in <span><a href="#RFC7299" class="xref">RFC 7299</a> [<a href="#RFC7299" class="xref">RFC7299</a>]</span> fife additions have been performed.<a href="#section-2.19-6" class="pilcrow">¶</a></p>
<p id="section-2.19-7" class="keepWithNext">Fife new entries have been added:<a href="#section-2.19-7" class="pilcrow">¶</a></p>
<span id="name-addition-to-the-pkix-cmp-in"></span><div id="IANA_new_id-it">
<table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-addition-to-the-pkix-cmp-in" class="selfRef">Addition to the PKIX CMP Information Types registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Decimal</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">17</td>
              <td class="text-left" rowspan="1" colspan="1">id-it-caCerts</td>
              <td class="text-left" rowspan="1" colspan="1">[thisRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">18</td>
              <td class="text-left" rowspan="1" colspan="1">id-it-rootCaKeyUpdate</td>
              <td class="text-left" rowspan="1" colspan="1">[thisRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">19</td>
              <td class="text-left" rowspan="1" colspan="1">id-it-certReqTemplate</td>
              <td class="text-left" rowspan="1" colspan="1">[thisRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD5</td>
              <td class="text-left" rowspan="1" colspan="1">id-it-rootCaCert</td>
              <td class="text-left" rowspan="1" colspan="1">[thisRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD6</td>
              <td class="text-left" rowspan="1" colspan="1">id-it-certProfile</td>
              <td class="text-left" rowspan="1" colspan="1">[thisRFC]</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-2.19-9">In the SMI-numbers registry " SMI Security for PKIX CRMF Registration Controls (1.3.6.1.5.5.7.5.1)" (see https://www.iana.org/assignments/smi-numbers/smi-numbers.xhtml#smi-numbers-1.3.6.1.5.5.7.5.1) as defined in <span><a href="#RFC7299" class="xref">RFC 7299</a> [<a href="#RFC7299" class="xref">RFC7299</a>]</span> two additions have been performed.<a href="#section-2.19-9" class="pilcrow">¶</a></p>
<p id="section-2.19-10" class="keepWithNext">Two new entries have been added:<a href="#section-2.19-10" class="pilcrow">¶</a></p>
<span id="name-addition-to-the-pkix-crmf-r"></span><div id="IANA_new_id-regCtrl">
<table class="left" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-addition-to-the-pkix-crmf-r" class="selfRef">Addition to the PKIX CRMF Registration Controls registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Decimal</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">References</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD3</td>
              <td class="text-left" rowspan="1" colspan="1">id-regCtrl-algId</td>
              <td class="text-left" rowspan="1" colspan="1">[thisRFC]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TBD4</td>
              <td class="text-left" rowspan="1" colspan="1">id-regCtrl-rsaKeyLen</td>
              <td class="text-left" rowspan="1" colspan="1">[thisRFC]</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="CMP-B">
<section id="section-2.20">
        <h3 id="name-update-appendix-b-the-use-o">
<a href="#section-2.20" class="section-number selfRef">2.20. </a><a href="#name-update-appendix-b-the-use-o" class="section-name selfRef">Update Appendix B - The Use of Revocation Passphrase</a>
        </h3>
<p id="section-2.20-1">Appendix B of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> describes the use of the revocation passphrase. As this document updates <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> to utilize the parent structure EncryptedKey instead of EncryptedValue as described in <a href="#CMP-5.2.2" class="xref">Section 2.8</a> above, the description is updated accordingly.<a href="#section-2.20-1" class="pilcrow">¶</a></p>
<p id="section-2.20-2" class="keepWithNext">Replace the first bullet point of this section with the following text:<a href="#section-2.20-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.20-3.1">The OID and value specified in Section 5.3.19.9 MAY be sent in a GenMsg message at any time, or MAY be sent in the generalInfo field of the PKIHeader of any PKIMessage at any time.  (In particular, the EncryptedKey structure as described in section 5.2.2 may be sent in the header of the certConf message that confirms acceptance of certificates requested in an initialization request or certificate request message.)  This conveys a revocation passphrase chosen by the entity to the relevant CA/RA. For use of EnvelopedData this is in the decrypted bytes of encryptedContent field and for use of EncryptedValue this is in the decrypted bytes of the encValue field. Furthermore, the transfer is accomplished with appropriate confidentiality characteristics.<a href="#section-2.20-3.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.20-4" class="keepWithNext">Replace the third bullet point of this section with the following text:<a href="#section-2.20-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.20-5.1">When using EnvelopedData the localKeyId attribute as specified in <span><a href="#RFC2985" class="xref">RFC 2985</a> [<a href="#RFC2985" class="xref">RFC2985</a>]</span> and when using EncryptedValue the valueHint field MAY contain a key identifier (chosen by the entity, along with the passphrase itself) to assist in later retrieval of the correct passphrase (e.g., when the revocation request is constructed by the entity and received by the CA/RA).<a href="#section-2.20-5.1" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="CMP-C">
<section id="section-2.21">
        <h3 id="name-update-appendix-c-request-m">
<a href="#section-2.21" class="section-number selfRef">2.21. </a><a href="#name-update-appendix-c-request-m" class="section-name selfRef">Update Appendix C - Request Message Behavioral Clarifications</a>
        </h3>
<p id="section-2.21-1">Appendix C of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> provides clarifications to the request message behavior. As this document updates <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> to utilize the parent structure EncryptedKey instead of EncryptedValue as described in <a href="#CMP-5.2.2" class="xref">Section 2.8</a> above, the description is updated accordingly.<a href="#section-2.21-1" class="pilcrow">¶</a></p>
<p id="section-2.21-2" class="keepWithNext">Replace the comment within the ASN.1 syntax coming after the definition of POPOPrivKey with the following text:<a href="#section-2.21-2" class="pilcrow">¶</a></p>
<div id="section-2.21-3">
<pre class="sourcecode lang-asn.1">
   -- **********
   -- *  the type of "thisMessage" is given as BIT STRING in RFC 4211
   -- *  [RFC4211]; it should be "EncryptedKey" (in accordance with
   -- *  Section 5.2.2 of this specification). Therefore, this
   -- *  document makes the behavioral clarification of specifying
   -- *  that the contents of "thisMessage" MUST be encoded either as
   -- *  "EnvelopedData" or "EncryptedValue" (only for backward
   -- *  compatibility) and then wrapped in a BIT STRING.  This
   -- *  allows the necessary conveyance and protection of the
   -- *  private key while maintaining bits-on-the-wire compatibility
   -- *  with RFC 4211 [RFC4211].
   -- **********
</pre><a href="#section-2.21-3" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="CMP-D.1">
<section id="section-2.22">
        <h3 id="name-update-appendix-d1-general-">
<a href="#section-2.22" class="section-number selfRef">2.22. </a><a href="#name-update-appendix-d1-general-" class="section-name selfRef">Update Appendix D.1. - General Rules for Interpretation of These Profiles</a>
        </h3>
<p id="section-2.22-1">Appendix D.1 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> provides general rules for interpretation of the PKI management messages profiles specified in Appendix D and Appendix E of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>. This document updates a sentence regarding the new protocol version cmp2021.<a href="#section-2.22-1" class="pilcrow">¶</a></p>
<p id="section-2.22-2" class="keepWithNext">Replace the last sentence of the first paragraph of the section with the following text:<a href="#section-2.22-2" class="pilcrow">¶</a></p>
<p id="section-2.22-3">Mandatory fields are not mentioned if they have an obvious value (e.g., in this version of these profiles, pvno is always cmp2000).<a href="#section-2.22-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-D.2">
<section id="section-2.23">
        <h3 id="name-update-appendix-d2-algorith">
<a href="#section-2.23" class="section-number selfRef">2.23. </a><a href="#name-update-appendix-d2-algorith" class="section-name selfRef">Update Appendix D.2. - Algorithm Use Profile</a>
        </h3>
<p id="section-2.23-1"><span><a href="#RFC4210" class="xref">Appendix D.2 of RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> provides a list of algorithms that implementations must support when claiming conformance with PKI Management Message Profiles as specified in <span><a href="#RFC4210" class="xref">CMP Appendix D.2</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span>. This document redirects to the new algorithm profile as specified in Appendix A.1 of <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>.<a href="#section-2.23-1" class="pilcrow">¶</a></p>
<p id="section-2.23-2" class="keepWithNext">Replace the text of the section with the following text:<a href="#section-2.23-2" class="pilcrow">¶</a></p>
<p id="section-2.23-3" class="keepWithNext">D.2. Algorithm Use Profile<a href="#section-2.23-3" class="pilcrow">¶</a></p>
<p id="section-2.23-4">For specifications of algorithm identifiers and respective conventions for conforming implementations, please refer to <span><a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">CMP Algorithms Appendix A.1</a> [<a href="#I-D.ietf-lamps-cmp-algorithms" class="xref">I-D.ietf-lamps-cmp-algorithms</a>]</span>.<a href="#section-2.23-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="CMP-D.4">
<section id="section-2.24">
        <h3 id="name-update-appendix-d4-initial-">
<a href="#section-2.24" class="section-number selfRef">2.24. </a><a href="#name-update-appendix-d4-initial-" class="section-name selfRef">Update Appendix D.4. - Initial Registration/Certification (Basic Authenticated Scheme)</a>
        </h3>
<p id="section-2.24-1">Appendix D.4 of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> provides the initial registration/certification scheme.  This scheme shall continue using EncryptedValue for backward compatibility reasons.<a href="#section-2.24-1" class="pilcrow">¶</a></p>
<p id="section-2.24-2" class="keepWithNext">Replace the comment after the privateKey field of crc[1].certifiedKeyPair in the syntax of the Initialization Response message with the following text:<a href="#section-2.24-2" class="pilcrow">¶</a></p>
<div id="section-2.24-3">
<pre class="sourcecode lang-asn.1">
   -- see Appendix C, Request Message Behavioral Clarifications
   -- for backward compatibility reasons, use EncryptedValue
</pre><a href="#section-2.24-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="Trans-Updates">
<section id="section-3">
      <h2 id="name-updates-to-rfc-6712-http-tr">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-updates-to-rfc-6712-http-tr" class="section-name selfRef">Updates to RFC 6712 - HTTP Transfer for the Certificate Management Protocol (CMP)</a>
      </h2>
<div id="Trans-1.1">
<section id="section-3.1">
        <h3 id="name-new-section-11-changes-since">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-new-section-11-changes-since" class="section-name selfRef">New Section 1.1. - Changes since RFC 6712</a>
        </h3>
<p id="section-3.1-1">The following subsection describes feature updates to <span><a href="#RFC6712" class="xref">RFC 6712</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span>. They are related to the base specification. Hence references to the original sections in <span><a href="#RFC6712" class="xref">RFC 6712</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span> are used whenever possible.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2" class="keepWithNext">Insert this section at the end of the current Section 1:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3" class="keepWithNext">1.1  Changes since RFC 6712<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4" class="keepWithNext">The following updates are made in [thisRFC]:<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-5.1">Introduce the HTTP path '/.well-known/cmp'.<a href="#section-3.1-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-5.2">Extend the URI structure.<a href="#section-3.1-5.2" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="Trans-3.6">
<section id="section-3.2">
        <h3 id="name-replace-section-36-http-req">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-replace-section-36-http-req" class="section-name selfRef">Replace Section 3.6. - HTTP Request-URI</a>
        </h3>
<p id="section-3.2-1">Section 3.6 of <span><a href="#RFC6712" class="xref">RFC 6712</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span> specifies the used HTTP URIs. This document introduces the HTTP path '/.well-known/cmp' and extends the URIs.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2" class="keepWithNext">Replace the text of the section with the following text:<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3" class="keepWithNext">3.6.  HTTP Request-URI<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4">Each CMP server on a PKI management entity supporting HTTP or HTTPS transport MUST support the use of the path prefix '/.well-known/' as defined in <span><a href="#RFC8615" class="xref">RFC 8615</a> [<a href="#RFC8615" class="xref">RFC8615</a>]</span> and the registered name 'cmp' to ease interworking in a multi-vendor environment.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5" class="keepWithNext">The CMP client needs to be configured with sufficient information to form the CMP server URI.  This is at least the authority portion of the URI, e.g., 'www.example.com:80', or the full operation path segment of the PKI management entity. Additionally, OPTIONAL path segments MAY be added after the registered application name as part of the full operation path to provide further distinction.  A path segment could for example support the differentiation of specific CAs, certificate profiles, or PKI management operations. A valid full operation path segment can look like this:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty">
<li class="compact ulEmpty" id="section-3.2-6.1">http://www.example.com/.well-known/cmp<a href="#section-3.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="section-3.2-6.2">http://www.example.com/.well-known/cmp/operationLabel<a href="#section-3.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="section-3.2-6.3">http://www.example.com/.well-known/cmp/profileLabel<a href="#section-3.2-6.3" class="pilcrow">¶</a>
</li>
          <li class="compact ulEmpty" id="section-3.2-6.4">http://www.example.com/.well-known/cmp/profileLabel/operationLabel<a href="#section-3.2-6.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="Trans-6">
<section id="section-3.3">
        <h3 id="name-update-section-6-iana-consi">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-update-section-6-iana-consi" class="section-name selfRef">Update Section 6. - IANA Considerations</a>
        </h3>
<p id="section-3.3-1">Section 6 of <span><a href="#RFC6712" class="xref">RFC 6712</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span> contains the IANA Considerations of that document.  As this document defines a new '.well-known' URI prefix, the IANA Considerations need to be updated accordingly.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2" class="keepWithNext">Add the following text between the first and second paragraph of the section:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">In the registry of well-known URIs (see https://www.iana.org/assignments/well-known-uris/well-known-uris.xhtml#well-known-uris-1) as defined in <span><a href="#RFC8615" class="xref">RFC 8615</a> [<a href="#RFC8615" class="xref">RFC8615</a>]</span> the following change has been performed.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4" class="keepWithNext">One new name entry has been added:<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<div id="IANA_well-known">
<table class="left" id="table-4">
          <caption><a href="#table-4" class="selfRef">Table 4</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">URI suffix </th>
              <th class="text-left" rowspan="1" colspan="1">Change controller</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">cmp</td>
              <td class="text-left" rowspan="1" colspan="1">IETF</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-4-1">This document contains an update to the IANA Consideration sections to be added to <span>[<a href="#RFC4210" class="xref">RFC4210</a>]</span> and <span>[<a href="#RFC6712" class="xref">RFC6712</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">&lt; TBD: This document updates the ASN.1 modules of <span><a href="#RFC4210" class="xref">RFC 4210 Appendix F</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> and <span><a href="#RFC5912" class="xref">RFC 5912 Section 9</a> [<a href="#RFC5912" class="xref">RFC5912</a>]</span>. New OIDs TBD1 and TBD2 need to be registered to identify the updated ASN.1 modules. &gt;<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">&lt; TBD: New OIDs TBD3 (id-regCtrl-algId) and TBD4 (id-regCtrl-rsaKeyLen) need to be registered. &gt;<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">&lt; TBD: New OIDs TBD5 (id-it-rootCaCert) and TBD6 (id-it-certProfile) need to be registered. &gt;<a href="#section-4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">No changes are made to the existing security considerations of <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> and <span><a href="#RFC6712" class="xref">RFC 6712</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Acknowledgements">
<section id="section-6">
      <h2 id="name-acknowledgements">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-6-1">Special thank goes to Jim Schaad for his guidance and the inspiration on structuring and writing this document we got from <span>[<a href="#RFC6402" class="xref">RFC6402</a>]</span> which updates CMC. Special thank also goes also to Russ Housley and Tomas Gustavsson for reviewing and providing valuable suggestions on improving this document.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">We also thank all reviewers of this document for their valuable feedback.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-lamps-cmp-algorithms">[I-D.ietf-lamps-cmp-algorithms]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">Aschauer, H.</span>, <span class="refAuthor">Ounsworth, M.</span>, and <span class="refAuthor">S. Mister</span>, <span class="refTitle">"Certificate Management Protocol (CMP) Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-cmp-algorithms-03</span>, <time datetime="2021-02-22" class="refDate">22 February 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-lamps-cmp-algorithms-03">https://tools.ietf.org/html/draft-ietf-lamps-cmp-algorithms-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-lamps-crmf-update-algs">[I-D.ietf-lamps-crmf-update-algs]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Algorithm Requirements Update to the Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-crmf-update-algs-07</span>, <time datetime="2021-04-08" class="refDate">8 April 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-lamps-crmf-update-algs-07">https://tools.ietf.org/html/draft-ietf-lamps-crmf-update-algs-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2510">[RFC2510]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span> and <span class="refAuthor">S. Farrell</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocols"</span>, <span class="seriesInfo">RFC 2510</span>, <span class="seriesInfo">DOI 10.17487/RFC2510</span>, <time datetime="1999-03" class="refDate">March 1999</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2510">https://www.rfc-editor.org/info/rfc2510</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2985">[RFC2985]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #9: Selected Object Classes and Attribute Types Version 2.0"</span>, <span class="seriesInfo">RFC 2985</span>, <span class="seriesInfo">DOI 10.17487/RFC2985</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2985">https://www.rfc-editor.org/info/rfc2985</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2986">[RFC2986]</dt>
        <dd>
<span class="refAuthor">Nystrom, M.</span> and <span class="refAuthor">B. Kaliski</span>, <span class="refTitle">"PKCS #10: Certification Request Syntax Specification Version 1.7"</span>, <span class="seriesInfo">RFC 2986</span>, <span class="seriesInfo">DOI 10.17487/RFC2986</span>, <time datetime="2000-11" class="refDate">November 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2986">https://www.rfc-editor.org/info/rfc2986</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4210">[RFC4210]</dt>
        <dd>
<span class="refAuthor">Adams, C.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Kause, T.</span>, and <span class="refAuthor">T. Mononen</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 4210</span>, <span class="seriesInfo">DOI 10.17487/RFC4210</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4210">https://www.rfc-editor.org/info/rfc4210</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4211">[RFC4211]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate Request Message Format (CRMF)"</span>, <span class="seriesInfo">RFC 4211</span>, <span class="seriesInfo">DOI 10.17487/RFC4211</span>, <time datetime="2005-09" class="refDate">September 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4211">https://www.rfc-editor.org/info/rfc4211</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5280">https://www.rfc-editor.org/info/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5480">[RFC5480]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refAuthor">Brown, D.</span>, <span class="refAuthor">Yiu, K.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">T. Polk</span>, <span class="refTitle">"Elliptic Curve Cryptography Subject Public Key Information"</span>, <span class="seriesInfo">RFC 5480</span>, <span class="seriesInfo">DOI 10.17487/RFC5480</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5480">https://www.rfc-editor.org/info/rfc5480</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5652">[RFC5652]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Cryptographic Message Syntax (CMS)"</span>, <span class="seriesInfo">STD 70</span>, <span class="seriesInfo">RFC 5652</span>, <span class="seriesInfo">DOI 10.17487/RFC5652</span>, <time datetime="2009-09" class="refDate">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5652">https://www.rfc-editor.org/info/rfc5652</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5912">[RFC5912]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">J. Schaad</span>, <span class="refTitle">"New ASN.1 Modules for the Public Key Infrastructure Using X.509 (PKIX)"</span>, <span class="seriesInfo">RFC 5912</span>, <span class="seriesInfo">DOI 10.17487/RFC5912</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5912">https://www.rfc-editor.org/info/rfc5912</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5958">[RFC5958]</dt>
        <dd>
<span class="refAuthor">Turner, S.</span>, <span class="refTitle">"Asymmetric Key Packages"</span>, <span class="seriesInfo">RFC 5958</span>, <span class="seriesInfo">DOI 10.17487/RFC5958</span>, <time datetime="2010-08" class="refDate">August 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5958">https://www.rfc-editor.org/info/rfc5958</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6402">[RFC6402]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"Certificate Management over CMS (CMC) Updates"</span>, <span class="seriesInfo">RFC 6402</span>, <span class="seriesInfo">DOI 10.17487/RFC6402</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6402">https://www.rfc-editor.org/info/rfc6402</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6712">[RFC6712]</dt>
        <dd>
<span class="refAuthor">Kause, T.</span> and <span class="refAuthor">M. Peylo</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure -- HTTP Transfer for the Certificate Management Protocol (CMP)"</span>, <span class="seriesInfo">RFC 6712</span>, <span class="seriesInfo">DOI 10.17487/RFC6712</span>, <time datetime="2012-09" class="refDate">September 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6712">https://www.rfc-editor.org/info/rfc6712</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7299">[RFC7299]</dt>
        <dd>
<span class="refAuthor">Housley, R.</span>, <span class="refTitle">"Object Identifier Registry for the PKIX Working Group"</span>, <span class="seriesInfo">RFC 7299</span>, <span class="seriesInfo">DOI 10.17487/RFC7299</span>, <time datetime="2014-07" class="refDate">July 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7299">https://www.rfc-editor.org/info/rfc7299</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8615">[RFC8615]</dt>
      <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Well-Known Uniform Resource Identifiers (URIs)"</span>, <span class="seriesInfo">RFC 8615</span>, <span class="seriesInfo">DOI 10.17487/RFC8615</span>, <time datetime="2019-05" class="refDate">May 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8615">https://www.rfc-editor.org/info/rfc8615</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-lamps-lightweight-cmp-profile">[I-D.ietf-lamps-lightweight-cmp-profile]</dt>
        <dd>
<span class="refAuthor">Brockhaus, H.</span>, <span class="refAuthor">Fries, S.</span>, and <span class="refAuthor">D. V. Oheimb</span>, <span class="refTitle">"Lightweight Certificate Management Protocol (CMP) Profile"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-lamps-lightweight-cmp-profile-05</span>, <time datetime="2021-02-22" class="refDate">22 February 2021</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-lamps-lightweight-cmp-profile-05">https://tools.ietf.org/html/draft-ietf-lamps-lightweight-cmp-profile-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IEEE.802.1AR_2018">[IEEE.802.1AR_2018]</dt>
      <dd>
<span class="refAuthor">IEEE</span>, <span class="refTitle">"IEEE Standard for Local and metropolitan area networks - Secure Device Identity"</span>, <span class="seriesInfo">IEEE 802.1AR-2018</span>, <span class="seriesInfo">DOI 10.1109/IEEESTD.2018.8423794</span>, <time datetime="2018-08-02" class="refDate">2 August 2018</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/8423794">https://ieeexplore.ieee.org/document/8423794</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="ASN.1_Modules">
<section id="section-appendix.a">
      <h2 id="name-asn1-modules">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-asn1-modules" class="section-name selfRef">ASN.1 Modules</a>
      </h2>
<div id="ASN.1_1988_Modules">
<section id="section-a.1">
        <h2 id="name-1988-asn1-module">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-1988-asn1-module" class="section-name selfRef">1988 ASN.1 Module</a>
        </h2>
<p id="section-a.1-1">This section contains the updated ASN.1 module for <span>[<a href="#RFC4210" class="xref">RFC4210</a>]</span>.  This module replaces the module in Appendix F of that document.  Although a 2002 ASN.1 module is provided, this 1988 ASN.1 module remains the normative module as per the policy of the PKIX working group.<a href="#section-a.1-1" class="pilcrow">¶</a></p>
<div id="section-a.1-2">
<pre class="sourcecode lang-asn.1">
PKIXCMP {iso(1) identified-organization(3)
      dod(6) internet(1) security(5) mechanisms(5) pkix(7)
      id-mod(0) id-mod-cmp2021-88(TBD1)}

DEFINITIONS EXPLICIT TAGS ::=

BEGIN

-- EXPORTS ALL --

IMPORTS

    Certificate, CertificateList, Extensions, AlgorithmIdentifier,
    UTF8String, id-kp -- if required; otherwise, comment out
           FROM PKIX1Explicit88 {iso(1) identified-organization(3)
           dod(6) internet(1) security(5) mechanisms(5) pkix(7)
           id-mod(0) id-pkix1-explicit-88(18)}

    GeneralName, KeyIdentifier
           FROM PKIX1Implicit88 {iso(1) identified-organization(3)
           dod(6) internet(1) security(5) mechanisms(5) pkix(7)
           id-mod(0) id-pkix1-implicit-88(19)}

    CertTemplate, PKIPublicationInfo, EncryptedKey, CertId,
    CertReqMessages, Controls, id-regCtrl
           FROM PKIXCRMF-2005 {iso(1) identified-organization(3)
           dod(6) internet(1) security(5) mechanisms(5) pkix(7)
           id-mod(0) id-mod-crmf2005(36)}
    -- The import of EncryptedKey is added due to the updates made
    -- in CMP Updates [thisRFC]]. EncryptedValue does not need to
    -- be imported anymore and is therefore removed here.

    -- see also the behavioral clarifications to CRMF codified in
    -- Appendix C of this specification
    CertificationRequest
           FROM PKCS-10 {iso(1) member-body(2)
                         us(840) rsadsi(113549)
                         pkcs(1) pkcs-10(10) modules(1) pkcs-10(1)}
    -- (specified in RFC 2986 with 1993 ASN.1 syntax and IMPLICIT
    -- tags).  Alternatively, implementers may directly include
    -- the [PKCS10] syntax in this module

    EnvelopedData, SignedData
           FROM CryptographicMessageSyntax2004 { iso(1)
           member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
           smime(16) modules(0) cms-2004(24) }
    -- The import of EnvelopedData and SignedData is added due to
    -- the updates made in CMP Updates [thisRFC]

    ;

-- the rest of the module contains locally-defined OIDs and
-- constructs

CMPCertificate ::= CHOICE {
    x509v3PKCert        Certificate
}
-- This syntax, while bits-on-the-wire compatible with the
-- standard X.509 definition of "Certificate", allows the
-- possibility of future certificate types (such as X.509
-- attribute certificates, WAP WTLS certificates, or other kinds
-- of certificates) within this certificate management protocol,
-- should a need ever arise to support such generality.  Those
-- implementations that do not foresee a need to ever support
-- other certificate types MAY, if they wish, comment out the
-- above structure and "un-comment" the following one prior to
-- compiling this ASN.1 module.  (Note that interoperability
-- with implementations that don't do this will be unaffected by
-- this change.)

-- CMPCertificate ::= Certificate

PKIMessage ::= SEQUENCE {
    header           PKIHeader,
    body             PKIBody,
    protection   [0] PKIProtection OPTIONAL,
    extraCerts   [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                     OPTIONAL
}

PKIMessages ::= SEQUENCE SIZE (1..MAX) OF PKIMessage

PKIHeader ::= SEQUENCE {
    pvno                INTEGER     { cmp1999(1), cmp2000(2),
                                      cmp2021(3) },
    sender              GeneralName,
    -- identifies the sender
    recipient           GeneralName,
    -- identifies the intended recipient
    messageTime     [0] GeneralizedTime         OPTIONAL,
    -- time of production of this message (used when sender
    -- believes that the transport will be "suitable"; i.e.,
    -- that the time will still be meaningful upon receipt)
    protectionAlg   [1] AlgorithmIdentifier     OPTIONAL,
    -- algorithm used for calculation of protection bits
    senderKID       [2] KeyIdentifier           OPTIONAL,
    recipKID        [3] KeyIdentifier           OPTIONAL,
    -- to identify specific keys used for protection
    transactionID   [4] OCTET STRING            OPTIONAL,
    -- identifies the transaction; i.e., this will be the same in
    -- corresponding request, response, certConf, and PKIConf
    -- messages
    senderNonce     [5] OCTET STRING            OPTIONAL,
    recipNonce      [6] OCTET STRING            OPTIONAL,
    -- nonces used to provide replay protection, senderNonce
    -- is inserted by the creator of this message; recipNonce
    -- is a nonce previously inserted in a related message by
    -- the intended recipient of this message
    freeText        [7] PKIFreeText             OPTIONAL,
    -- this may be used to indicate context-specific instructions
    -- (this field is intended for human consumption)
    generalInfo     [8] SEQUENCE SIZE (1..MAX) OF
                           InfoTypeAndValue     OPTIONAL
    -- this may be used to convey context-specific information
    -- (this field not primarily intended for human consumption)
}

PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
    -- text encoded as UTF-8 String [RFC3629] (note: each
    -- UTF8String MAY include an [RFC3066] language tag
    -- to indicate the language of the contained text
    -- see [RFC2482] for details)

PKIBody ::= CHOICE {       -- message-specific body elements
    ir       [0]  CertReqMessages,        --Initialization Request
    ip       [1]  CertRepMessage,         --Initialization Response
    cr       [2]  CertReqMessages,        --Certification Request
    cp       [3]  CertRepMessage,         --Certification Response
    p10cr    [4]  CertificationRequest,   --imported from [PKCS10]
    popdecc  [5]  POPODecKeyChallContent, --pop Challenge
    popdecr  [6]  POPODecKeyRespContent,  --pop Response
    kur      [7]  CertReqMessages,        --Key Update Request
    kup      [8]  CertRepMessage,         --Key Update Response
    krr      [9]  CertReqMessages,        --Key Recovery Request
    krp      [10] KeyRecRepContent,       --Key Recovery Response
    rr       [11] RevReqContent,          --Revocation Request
    rp       [12] RevRepContent,          --Revocation Response
    ccr      [13] CertReqMessages,        --Cross-Cert. Request
    ccp      [14] CertRepMessage,         --Cross-Cert. Response
    ckuann   [15] CAKeyUpdAnnContent,     --CA Key Update Ann.
    cann     [16] CertAnnContent,         --Certificate Ann.
    rann     [17] RevAnnContent,          --Revocation Ann.
    crlann   [18] CRLAnnContent,          --CRL Announcement
    pkiconf  [19] PKIConfirmContent,      --Confirmation
    nested   [20] NestedMessageContent,   --Nested Message
    genm     [21] GenMsgContent,          --General Message
    genp     [22] GenRepContent,          --General Response
    error    [23] ErrorMsgContent,        --Error Message
    certConf [24] CertConfirmContent,     --Certificate confirm
    pollReq  [25] PollReqContent,         --Polling request
    pollRep  [26] PollRepContent          --Polling response
}

PKIProtection ::= BIT STRING

ProtectedPart ::= SEQUENCE {
    header    PKIHeader,
    body      PKIBody
}

id-PasswordBasedMac OBJECT IDENTIFIER ::= {1 2 840 113533 7 66 13}
PBMParameter ::= SEQUENCE {
    salt                OCTET STRING,
    -- note:  implementations MAY wish to limit acceptable sizes
    -- of this string to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks
    owf                 AlgorithmIdentifier,
    -- AlgId for a One-Way Function (SHA-1 recommended)
    iterationCount      INTEGER,
    -- number of times the OWF is applied
    -- note:  implementations MAY wish to limit acceptable sizes
    -- of this integer to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks
    mac                 AlgorithmIdentifier
    -- the MAC AlgId (e.g., DES-MAC, Triple-DES-MAC [PKCS11],
}   -- or HMAC [RFC2104, RFC2202])

id-DHBasedMac OBJECT IDENTIFIER ::= {1 2 840 113533 7 66 30}
DHBMParameter ::= SEQUENCE {
    owf                 AlgorithmIdentifier,
    -- AlgId for a One-Way Function (SHA-1 recommended)
    mac                 AlgorithmIdentifier
    -- the MAC AlgId (e.g., DES-MAC, Triple-DES-MAC [PKCS11],
}   -- or HMAC [RFC2104, RFC2202])


NestedMessageContent ::= PKIMessages

PKIStatus ::= INTEGER {
    accepted                (0),
    -- you got exactly what you asked for
    grantedWithMods        (1),
    -- you got something like what you asked for; the
    -- requester is responsible for ascertaining the differences
    rejection              (2),
    -- you don't get it, more information elsewhere in the message
    waiting                (3),
    -- the request body part has not yet been processed; expect to
    -- hear more later (note: proper handling of this status
    -- response MAY use the polling req/rep PKIMessages specified
    -- in Section 5.3.22; alternatively, polling in the underlying
    -- transport layer MAY have some utility in this regard)
    revocationWarning      (4),
    -- this message contains a warning that a revocation is
    -- imminent
    revocationNotification (5),
    -- notification that a revocation has occurred
    keyUpdateWarning       (6)
    -- update already done for the oldCertId specified in
    -- CertReqMsg
}

PKIFailureInfo ::= BIT STRING {
-- since we can fail in more than one way!
-- More codes may be added in the future if/when required.
    badAlg              (0),
    -- unrecognized or unsupported Algorithm Identifier
    badMessageCheck     (1),
    -- integrity check failed (e.g., signature did not verify)
    badRequest          (2),
    -- transaction not permitted or supported
    badTime             (3),
    -- messageTime was not sufficiently close to the system time,
    -- as defined by local policy
    badCertId           (4),
    -- no certificate could be found matching the provided criteria
    badDataFormat       (5),
    -- the data submitted has the wrong format
    wrongAuthority      (6),
    -- the authority indicated in the request is different from the
    -- one creating the response token
    incorrectData       (7),
    -- the requester's data is incorrect (for notary services)
    missingTimeStamp    (8),
    -- when the timestamp is missing but should be there
    -- (by policy)
    badPOP              (9),
    -- the proof-of-possession failed
    certRevoked         (10),
       -- the certificate has already been revoked
    certConfirmed       (11),
       -- the certificate has already been confirmed
    wrongIntegrity      (12),
       -- invalid integrity, password based instead of signature or
       -- vice versa
    badRecipientNonce   (13),
       -- invalid recipient nonce, either missing or wrong value
    timeNotAvailable    (14),
       -- the TSA's time source is not available
    unacceptedPolicy    (15),
       -- the requested TSA policy is not supported by the TSA.
    unacceptedExtension (16),
       -- the requested extension is not supported by the TSA.
    addInfoNotAvailable (17),
       -- the additional information requested could not be
       -- understood or is not available
    badSenderNonce      (18),
       -- invalid sender nonce, either missing or wrong size
    badCertTemplate     (19),
       -- invalid cert. template or missing mandatory information
    signerNotTrusted    (20),
       -- signer of the message unknown or not trusted
    transactionIdInUse  (21),
       -- the transaction identifier is already in use
    unsupportedVersion  (22),
       -- the version of the message is not supported
    notAuthorized       (23),
       -- the sender was not authorized to make the preceding
       -- request or perform the preceding action
    systemUnavail       (24),
    -- the request cannot be handled due to system unavailability
    systemFailure       (25),
    -- the request cannot be handled due to system failure
    duplicateCertReq    (26)
    -- certificate cannot be issued because a duplicate
    -- certificate already exists
}

PKIStatusInfo ::= SEQUENCE {
    status        PKIStatus,
    statusString  PKIFreeText     OPTIONAL,
    failInfo      PKIFailureInfo  OPTIONAL
}

OOBCert ::= CMPCertificate

OOBCertHash ::= SEQUENCE {
    hashAlg     [0] AlgorithmIdentifier     OPTIONAL,
    certId      [1] CertId                  OPTIONAL,
    hashVal         BIT STRING
    -- hashVal is calculated over the DER encoding of the
    -- self-signed certificate with the identifier certID.
}

POPODecKeyChallContent ::= SEQUENCE OF Challenge
-- One Challenge per encryption key certification request (in the
-- same order as these requests appear in CertReqMessages).

Challenge ::= SEQUENCE {
    owf                 AlgorithmIdentifier  OPTIONAL,
    -- MUST be present in the first Challenge; MAY be omitted in
    -- any subsequent Challenge in POPODecKeyChallContent (if
    -- omitted, then the owf used in the immediately preceding
    -- Challenge is to be used).
    witness             OCTET STRING,
    -- the result of applying the one-way function (owf) to a
    -- randomly-generated INTEGER, A.  [Note that a different
    -- INTEGER MUST be used for each Challenge.]
    challenge           OCTET STRING
    -- the encryption (under the public key for which the cert.
    -- request is being made) of Rand.
}

-- Added in CMP Updates [thisRFC]

Rand ::= SEQUENCE {
-- Rand is encrypted under the public key to form the challenge
-- in POPODecKeyChallContent
   int                  INTEGER,
   -- the randomly-generated INTEGER A (above)
   sender               GeneralName
   -- the sender's name (as included in PKIHeader)
}

POPODecKeyRespContent ::= SEQUENCE OF INTEGER
-- One INTEGER per encryption key certification request (in the
-- same order as these requests appear in CertReqMessages).  The
-- retrieved INTEGER A (above) is returned to the sender of the
-- corresponding Challenge.

CertRepMessage ::= SEQUENCE {
    caPubs       [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                     OPTIONAL,
    response         SEQUENCE OF CertResponse
}

CertResponse ::= SEQUENCE {
    certReqId           INTEGER,
    -- to match this response with corresponding request (a value
    -- of 0 is to be used if certReqId is not specified in the
    -- corresponding request, which can only be a p10cr)
    status              PKIStatusInfo,
    certifiedKeyPair    CertifiedKeyPair    OPTIONAL,
    rspInfo             OCTET STRING        OPTIONAL
    -- analogous to the id-regInfo-utf8Pairs string defined
    -- for regInfo in CertReqMsg [CRMF]
}

CertifiedKeyPair ::= SEQUENCE {
    certOrEncCert       CertOrEncCert,
    privateKey      [0] EncryptedKey        OPTIONAL,
    -- see [CRMF] for comment on encoding
    -- Changed from Encrypted Value to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- CMP Updates [thisRFC]
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change
    publicationInfo [1] PKIPublicationInfo  OPTIONAL
}

CertOrEncCert ::= CHOICE {
    certificate     [0] CMPCertificate,
    encryptedCert   [1] EncryptedKey
    -- Changed from Encrypted Value to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- CMP Updates [thisRFC]
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change
}

KeyRecRepContent ::= SEQUENCE {
    status                  PKIStatusInfo,
    newSigCert          [0] CMPCertificate OPTIONAL,
    caCerts             [1] SEQUENCE SIZE (1..MAX) OF
                                        CMPCertificate OPTIONAL,
    keyPairHist         [2] SEQUENCE SIZE (1..MAX) OF
                                        CertifiedKeyPair OPTIONAL
}

RevReqContent ::= SEQUENCE OF RevDetails

RevDetails ::= SEQUENCE {
    certDetails         CertTemplate,
    -- allows requester to specify as much as they can about
    -- the cert. for which revocation is requested
    -- (e.g., for cases in which serialNumber is not available)
    crlEntryDetails     Extensions       OPTIONAL
    -- requested crlEntryExtensions
}

RevRepContent ::= SEQUENCE {
    status       SEQUENCE SIZE (1..MAX) OF PKIStatusInfo,
    -- in same order as was sent in RevReqContent
    revCerts [0] SEQUENCE SIZE (1..MAX) OF CertId
                                        OPTIONAL,
    -- IDs for which revocation was requested
    -- (same order as status)
    crls     [1] SEQUENCE SIZE (1..MAX) OF CertificateList
                                        OPTIONAL
    -- the resulting CRLs (there may be more than one)
}

CAKeyUpdAnnContent ::= SEQUENCE {
    oldWithNew   CMPCertificate, -- old pub signed with new priv
    newWithOld   CMPCertificate, -- new pub signed with old priv
    newWithNew   CMPCertificate  -- new pub signed with new priv
}

CertAnnContent ::= CMPCertificate

RevAnnContent ::= SEQUENCE {
    status              PKIStatus,
    certId              CertId,
    willBeRevokedAt     GeneralizedTime,
    badSinceDate        GeneralizedTime,
    crlDetails          Extensions  OPTIONAL
    -- extra CRL details (e.g., crl number, reason, location, etc.)
}

CRLAnnContent ::= SEQUENCE OF CertificateList

CertConfirmContent ::= SEQUENCE OF CertStatus

CertStatus ::= SEQUENCE {
   certHash    OCTET STRING,
   -- the hash of the certificate, using the same hash algorithm
   -- as is used to create and verify the certificate signature
   certReqId   INTEGER,
   -- to match this confirmation with the corresponding req/rep
   statusInfo  PKIStatusInfo OPTIONAL
}

PKIConfirmContent ::= NULL

-- Added in CMP Updates [thisRFC]

RootCaKeyUpdateContent ::= SEQUENCE {
   newWithNew       CMPCertificate,
   -- new root CA certificate
   newWithOld   [0] CMPCertificate OPTIONAL,
   -- X.509 certificate containing the new public root CA key
   -- signed with the old private root CA key
   oldWithNew   [1] CMPCertificate OPTIONAL
   -- X.509 certificate containing the old public root CA key
   -- signed with the new private root CA key
   }

-- Added in CMP Updates [thisRFC]

CertReqTemplateContent ::= SEQUENCE {
   certTemplate           CertTemplate,
   -- prefilled certTemplate structure elements
   -- The SubjectPublicKeyInfo field in the certTemplate MUST NOT
   -- be used.
   keySpec                Controls OPTIONAL
   -- MAY be used to specify supported algorithms.
   -- Controls  ::= SEQUENCE SIZE(1..MAX) OF AttributeTypeAndValue
   -- as specified in CRMF (RFC4211)
   }

   id-regCtrl-algId OBJECT IDENTIFIER ::= { id-regCtrl TBD3 }
   AlgIdCtrl ::= AlgorithmIdentifier
   -- SHALL be used to specify suported algorithms other than RSA

   id-regCtrl-rsaKeyLen OBJECT IDENTIFIER ::= { id-regCtrl TBD4 }
   RsaKeyLenCtrl ::= INTEGER
   -- SHALL be used to specify suported RSA key lengths

InfoTypeAndValue ::= SEQUENCE {
    infoType               OBJECT IDENTIFIER,
    infoValue              ANY DEFINED BY infoType  OPTIONAL
}
-- Example InfoTypeAndValue contents include, but are not limited
-- to, the following (un-comment in this ASN.1 module and use as
-- appropriate for a given environment):
--
--   id-it-caProtEncCert    OBJECT IDENTIFIER ::= {id-it 1}
--      CAProtEncCertValue      ::= CMPCertificate
--   id-it-signKeyPairTypes OBJECT IDENTIFIER ::= {id-it 2}
--      SignKeyPairTypesValue   ::= SEQUENCE OF AlgorithmIdentifier
--   id-it-encKeyPairTypes  OBJECT IDENTIFIER ::= {id-it 3}
--      EncKeyPairTypesValue    ::= SEQUENCE OF AlgorithmIdentifier
--   id-it-preferredSymmAlg OBJECT IDENTIFIER ::= {id-it 4}
--      PreferredSymmAlgValue   ::= AlgorithmIdentifier
--   id-it-caKeyUpdateInfo  OBJECT IDENTIFIER ::= {id-it 5}
--      CAKeyUpdateInfoValue    ::= CAKeyUpdAnnContent
--   id-it-currentCRL       OBJECT IDENTIFIER ::= {id-it 6}
--      CurrentCRLValue         ::= CertificateList
--   id-it-unsupportedOIDs  OBJECT IDENTIFIER ::= {id-it 7}
--      UnsupportedOIDsValue    ::= SEQUENCE OF OBJECT IDENTIFIER
--   id-it-keyPairParamReq  OBJECT IDENTIFIER ::= {id-it 10}
--      KeyPairParamReqValue    ::= OBJECT IDENTIFIER
--   id-it-keyPairParamRep  OBJECT IDENTIFIER ::= {id-it 11}
--      KeyPairParamRepValue    ::= AlgorithmIdentifer
--   id-it-revPassphrase    OBJECT IDENTIFIER ::= {id-it 12}
--      RevPassphraseValue      ::= EncryptedKey
--      - Changed from Encrypted Value to EncryptedKey as a CHOICE
--      - of EncryptedValue and EnvelopedData due to the changes
--      - made in CMP Updates [thisRFC]
--      - Using the choice EncryptedValue is bit-compatible to the
--      - syntax without this change
--   id-it-implicitConfirm  OBJECT IDENTIFIER ::= {id-it 13}
--      ImplicitConfirmValue    ::= NULL
--   id-it-confirmWaitTime  OBJECT IDENTIFIER ::= {id-it 14}
--      ConfirmWaitTimeValue    ::= GeneralizedTime
--   id-it-origPKIMessage   OBJECT IDENTIFIER ::= {id-it 15}
--      OrigPKIMessageValue     ::= PKIMessages
--   id-it-suppLangTags     OBJECT IDENTIFIER ::= {id-it 16}
--      SuppLangTagsValue       ::= SEQUENCE OF UTF8String
--   id-it-caCerts OBJECT IDENTIFIER ::= { id-it 17}
--      CaCertsValue ::= SEQUENCE OF CMPCertificate
--      - id-it-caCerts added in CMP Updates [thisRFC]
--   id-it-rootCaKeyUpdate OBJECT IDENTIFIER ::= { id-it 18}
--      RootCaKeyUpdateValue ::= RootCaKeyUpdateContent
--      - id-it-rootCaKeyUpdate added in CMP Updates [thisRFC]
--   id-it-certReqTemplate OBJECT IDENTIFIER ::= { id-it 19}
--      CertReqTemplateValue ::= CertReqTemplateContent
--      - id-it-certReqTemplate added in CMP Updates [thisRFC]
--   id-it-rootCaCert  OBJECT IDENTIFIER ::= {id-it TBD5}
--      RootCaCertValue ::= CMPCertificate
--      - id-it-rootCaCert  added in CMP Updates [thisRFC]
--   id-it-certProfile  OBJECT IDENTIFIER ::= {id-it TBD6}
--      CertProfileValue ::= UTF8String
--      - id-it-certProfile  added in CMP Updates [thisRFC]
--
-- where
--
--   id-pkix OBJECT IDENTIFIER ::= {
--      iso(1) identified-organization(3)
--      dod(6) internet(1) security(5) mechanisms(5) pkix(7)}
-- and
--   id-it   OBJECT IDENTIFIER ::= {id-pkix 4}
--
--
-- This construct MAY also be used to define new PKIX Certificate
-- Management Protocol request and response messages, or general-
-- purpose (e.g., announcement) messages for future needs or for
-- specific environments.

GenMsgContent ::= SEQUENCE OF InfoTypeAndValue

-- May be sent by EE, RA, or CA (depending on message content).
-- The OPTIONAL infoValue parameter of InfoTypeAndValue will
-- typically be omitted for some of the examples given above.
-- The receiver is free to ignore any contained OBJ. IDs that it
-- does not recognize. If sent from EE to CA, the empty set
-- indicates that the CA may send
-- any/all information that it wishes.

GenRepContent ::= SEQUENCE OF InfoTypeAndValue
-- Receiver MAY ignore any contained OIDs that it does not
-- recognize.

ErrorMsgContent ::= SEQUENCE {
    pKIStatusInfo          PKIStatusInfo,
    errorCode              INTEGER           OPTIONAL,
    -- implementation-specific error codes
    errorDetails           PKIFreeText       OPTIONAL
    -- implementation-specific error details
}

PollReqContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER
}

PollRepContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER,
    checkAfter             INTEGER,  -- time in seconds
    reason                 PKIFreeText OPTIONAL
}

--
-- Extended Key Usage extension for PKI entities used in CMP
-- operations, added due to the changes made in
-- CMP Updates [thisRFC]
-- The EKUs for the CA and RA are reused from CMC as defined in
-- [RFC6402]
--

-- id-kp-cmcCA OBJECT IDENTIFIER ::= { id-kp 27 }
-- id-kp-cmcRA OBJECT IDENTIFIER ::= { id-kp 28 }
id-kp-cmKGA OBJECT IDENTIFIER ::= { id-kp 32 }

-- There is no 1988 ASN.1 module of PKCS#9 available to import the
-- syntax of the localKeyId attribute type and value from. Therefore,
-- the syntax is added here as needed for the updates made in
-- CMP Updates [thisRFC]

pkcs-9 OBJECT IDENTIFIER ::= {iso(1) member-body(2) us(840)
                              rsadsi(113549) pkcs(1) 9}

pkcs-9-at-localKeyId OBJECT IDENTIFIER ::= {pkcs-9 21}

localKeyIdValue ::= OCTET STRING

END -- of CMP module
</pre><a href="#section-a.1-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ASN.1_2002_Modules">
<section id="section-a.2">
        <h2 id="name-2002-asn1-module">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-2002-asn1-module" class="section-name selfRef">2002 ASN.1 Module</a>
        </h2>
<p id="section-a.2-1">This section contains the updated 2002 ASN.1 module for <span>[<a href="#RFC5912" class="xref">RFC5912</a>]</span>.  This module replaces the module in Section 9 of that document.  The module contains those changes to the normative ASN.1 module from <span><a href="#RFC4210" class="xref">RFC4210 Appendix F</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> that were to update to 2002 ASN.1 standard done in <span>[<a href="#RFC5912" class="xref">RFC5912</a>]</span> as well as changes made in this document.<a href="#section-a.2-1" class="pilcrow">¶</a></p>
<div id="section-a.2-2">
<pre class="sourcecode lang-asn.1">
PKIXCMP-2021
    { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-cmp2021-02(TBD2) }
DEFINITIONS EXPLICIT TAGS ::=
BEGIN
IMPORTS

AttributeSet{}, Extensions{}, EXTENSION, ATTRIBUTE
FROM PKIX-CommonTypes-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkixCommon-02(57)}

AlgorithmIdentifier{}, SIGNATURE-ALGORITHM, ALGORITHM,
    DIGEST-ALGORITHM, MAC-ALGORITHM
FROM AlgorithmInformation-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0)
    id-mod-algorithmInformation-02(58)}

Certificate, CertificateList, id-kp
FROM PKIX1Explicit-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-explicit-02(51)}

GeneralName, KeyIdentifier
FROM PKIX1Implicit-2009
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkix1-implicit-02(59)}

CertTemplate, PKIPublicationInfo, EncryptedKey, CertId,
    CertReqMessages, Controls, id-regCtrl
FROM PKIXCRMF-2009
    { iso(1) identified-organization(3) dod(6) internet(1)
    security(5) mechanisms(5) pkix(7) id-mod(0)
    id-mod-crmf2005-02(55) }
    -- The import of EncryptedKey is added due to the updates made
    -- in CMP Updates [thisRFC]. EncryptedValue does not need to
    -- be imported anymore and is therefore removed here.

-- see also the behavioral clarifications to CRMF codified in
-- Appendix C of this specification

CertificationRequest
FROM PKCS-10
    {iso(1) identified-organization(3) dod(6) internet(1) security(5)
    mechanisms(5) pkix(7) id-mod(0) id-mod-pkcs10-2009(69)}
-- (specified in RFC 2986 with 1993 ASN.1 syntax and IMPLICIT
-- tags).  Alternatively, implementers may directly include
-- the [PKCS10] syntax in this module

localKeyId
FROM PKCS-9
    {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
    modules(0) pkcs-9(1)}
    -- The import of localKeyId is added due to the updates made in
    -- CMP Updates [thisRFC]

EnvelopedData, SignedData
FROM CryptographicMessageSyntax-2009
    {iso(1) member-body(2) us(840) rsadsi(113549) pkcs(1) pkcs-9(9)
    smime(16) modules(0) id-mod-cms-2004-02(41)}
    -- The import of EnvelopedData and SignedData is added due to
    -- the updates made in CMP Updates [thisRFC]
;

-- the rest of the module contains locally defined OIDs and
-- constructs

CMPCertificate ::= CHOICE { x509v3PKCert Certificate, ... }
-- This syntax, while bits-on-the-wire compatible with the
-- standard X.509 definition of "Certificate", allows the
-- possibility of future certificate types (such as X.509
-- attribute certificates, WAP WTLS certificates, or other kinds
-- of certificates) within this certificate management protocol,
-- should a need ever arise to support such generality.  Those
-- implementations that do not foresee a need to ever support
-- other certificate types MAY, if they wish, comment out the
-- above structure and "uncomment" the following one prior to
-- compiling this ASN.1 module.  (Note that interoperability
-- with implementations that don't do this will be unaffected by
-- this change.)

-- CMPCertificate ::= Certificate

PKIMessage ::= SEQUENCE {
    header           PKIHeader,
    body             PKIBody,
    protection   [0] PKIProtection OPTIONAL,
    extraCerts   [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                  OPTIONAL }

PKIMessages ::= SEQUENCE SIZE (1..MAX) OF PKIMessage

PKIHeader ::= SEQUENCE {
    pvno                INTEGER     { cmp1999(1), cmp2000(2),
                                      cmp2012(3) },
    sender              GeneralName,
    -- identifies the sender
    recipient           GeneralName,
    -- identifies the intended recipient
    messageTime     [0] GeneralizedTime         OPTIONAL,
    -- time of production of this message (used when sender
    -- believes that the transport will be "suitable"; i.e.,
    -- that the time will still be meaningful upon receipt)
    protectionAlg   [1] AlgorithmIdentifier{ALGORITHM, {...}}
                            OPTIONAL,
    -- algorithm used for calculation of protection bits
    senderKID       [2] KeyIdentifier           OPTIONAL,
    recipKID        [3] KeyIdentifier           OPTIONAL,
    -- to identify specific keys used for protection
    transactionID   [4] OCTET STRING            OPTIONAL,
    -- identifies the transaction; i.e., this will be the same in
    -- corresponding request, response, certConf, and PKIConf
    -- messages
    senderNonce     [5] OCTET STRING            OPTIONAL,
    recipNonce      [6] OCTET STRING            OPTIONAL,
    -- nonces used to provide replay protection, senderNonce
    -- is inserted by the creator of this message; recipNonce
    -- is a nonce previously inserted in a related message by
    -- the intended recipient of this message
    freeText        [7] PKIFreeText             OPTIONAL,
    -- this may be used to indicate context-specific instructions
    -- (this field is intended for human consumption)
    generalInfo     [8] SEQUENCE SIZE (1..MAX) OF
                        InfoTypeAndValue     OPTIONAL
    -- this may be used to convey context-specific information
    -- (this field not primarily intended for human consumption)
}

PKIFreeText ::= SEQUENCE SIZE (1..MAX) OF UTF8String
    -- text encoded as UTF-8 String [RFC3629] (note: each
    -- UTF8String MAY include an [RFC3066] language tag
    -- to indicate the language of the contained text;
    -- see [RFC2482] for details)

PKIBody ::= CHOICE {       -- message-specific body elements
    ir       [0]  CertReqMessages,        --Initialization Request
    ip       [1]  CertRepMessage,         --Initialization Response
    cr       [2]  CertReqMessages,        --Certification Request
    cp       [3]  CertRepMessage,         --Certification Response
    p10cr    [4]  CertificationRequest,   --imported from [PKCS10]
    popdecc  [5]  POPODecKeyChallContent, --pop Challenge
    popdecr  [6]  POPODecKeyRespContent,  --pop Response
    kur      [7]  CertReqMessages,        --Key Update Request
    kup      [8]  CertRepMessage,         --Key Update Response
    krr      [9]  CertReqMessages,        --Key Recovery Request
    krp      [10] KeyRecRepContent,       --Key Recovery Response
    rr       [11] RevReqContent,          --Revocation Request
    rp       [12] RevRepContent,          --Revocation Response
    ccr      [13] CertReqMessages,        --Cross-Cert. Request
    ccp      [14] CertRepMessage,         --Cross-Cert. Response
    ckuann   [15] CAKeyUpdAnnContent,     --CA Key Update Ann.
    cann     [16] CertAnnContent,         --Certificate Ann.
    rann     [17] RevAnnContent,          --Revocation Ann.
    crlann   [18] CRLAnnContent,          --CRL Announcement
    pkiconf  [19] PKIConfirmContent,      --Confirmation
    nested   [20] NestedMessageContent,   --Nested Message
    genm     [21] GenMsgContent,          --General Message
    genp     [22] GenRepContent,          --General Response
    error    [23] ErrorMsgContent,        --Error Message
    certConf [24] CertConfirmContent,     --Certificate confirm
    pollReq  [25] PollReqContent,         --Polling request
    pollRep  [26] PollRepContent          --Polling response
}

PKIProtection ::= BIT STRING

ProtectedPart ::= SEQUENCE {
    header    PKIHeader,
    body      PKIBody }

id-PasswordBasedMac OBJECT IDENTIFIER ::= { iso(1) member-body(2)
    usa(840) nt(113533) nsn(7) algorithms(66) 13 }
PBMParameter ::= SEQUENCE {
    salt                OCTET STRING,
    -- note:  implementations MAY wish to limit acceptable sizes
    -- of this string to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks
    owf                 AlgorithmIdentifier{DIGEST-ALGORITHM, {...}},
    -- AlgId for a One-Way Function (SHA-1 recommended)
    iterationCount      INTEGER,
    -- number of times the OWF is applied
    -- note:  implementations MAY wish to limit acceptable sizes
    -- of this integer to values appropriate for their environment
    -- in order to reduce the risk of denial-of-service attacks
    mac                 AlgorithmIdentifier{MAC-ALGORITHM, {...}}
    -- the MAC AlgId (e.g., DES-MAC, Triple-DES-MAC [PKCS11],
    -- or HMAC [RFC2104, RFC2202])
}

id-DHBasedMac OBJECT IDENTIFIER ::= { iso(1) member-body(2)
    usa(840) nt(113533) nsn(7) algorithms(66) 30 }
DHBMParameter ::= SEQUENCE {
    owf                 AlgorithmIdentifier{DIGEST-ALGORITHM, {...}},
    -- AlgId for a One-Way Function (SHA-1 recommended)
    mac                 AlgorithmIdentifier{MAC-ALGORITHM, {...}}
    -- the MAC AlgId (e.g., DES-MAC, Triple-DES-MAC [PKCS11],
    -- or HMAC [RFC2104, RFC2202])
}

PKIStatus ::= INTEGER {
    accepted               (0),
    -- you got exactly what you asked for
    grantedWithMods        (1),
    -- you got something like what you asked for; the
    -- requester is responsible for ascertaining the differences
    rejection              (2),
    -- you don't get it, more information elsewhere in the message
    waiting                (3),
    -- the request body part has not yet been processed; expect to
    -- hear more later (note: proper handling of this status
    -- response MAY use the polling req/rep PKIMessages specified
    -- in Section 5.3.22; alternatively, polling in the underlying
    -- transport layer MAY have some utility in this regard)
    revocationWarning      (4),
    -- this message contains a warning that a revocation is
    -- imminent
    revocationNotification (5),
    -- notification that a revocation has occurred
    keyUpdateWarning       (6)
    -- update already done for the oldCertId specified in
    -- CertReqMsg
}

PKIFailureInfo ::= BIT STRING {
-- since we can fail in more than one way!
-- More codes may be added in the future if/when required.
    badAlg              (0),
    -- unrecognized or unsupported Algorithm Identifier
    badMessageCheck     (1),
    -- integrity check failed (e.g., signature did not verify)
    badRequest          (2),
    -- transaction not permitted or supported
    badTime             (3),
    -- messageTime was not sufficiently close to the system time,
    -- as defined by local policy
    badCertId           (4),
    -- no certificate could be found matching the provided criteria
    badDataFormat       (5),
    -- the data submitted has the wrong format
    wrongAuthority      (6),
    -- the authority indicated in the request is different from the
    -- one creating the response token
    incorrectData       (7),
    -- the requester's data is incorrect (for notary services)
    missingTimeStamp    (8),
    -- when the timestamp is missing but should be there
    -- (by policy)
    badPOP              (9),
    -- the proof-of-possession failed
    certRevoked         (10),
    -- the certificate has already been revoked
    certConfirmed       (11),
    -- the certificate has already been confirmed
    wrongIntegrity      (12),
    -- invalid integrity, password based instead of signature or
    -- vice versa
    badRecipientNonce   (13),
    -- invalid recipient nonce, either missing or wrong value
    timeNotAvailable    (14),
    -- the TSA's time source is not available
    unacceptedPolicy    (15),
    -- the requested TSA policy is not supported by the TSA
    unacceptedExtension (16),
    -- the requested extension is not supported by the TSA
    addInfoNotAvailable (17),
    -- the additional information requested could not be
    -- understood or is not available
    badSenderNonce      (18),
    -- invalid sender nonce, either missing or wrong size
    badCertTemplate     (19),
    -- invalid cert. template or missing mandatory information
    signerNotTrusted    (20),
    -- signer of the message unknown or not trusted
    transactionIdInUse  (21),
    -- the transaction identifier is already in use
    unsupportedVersion  (22),
    -- the version of the message is not supported
    notAuthorized       (23),
    -- the sender was not authorized to make the preceding
    -- request or perform the preceding action
    systemUnavail       (24),
    -- the request cannot be handled due to system unavailability
    systemFailure       (25),
    -- the request cannot be handled due to system failure
    duplicateCertReq    (26)
    -- certificate cannot be issued because a duplicate
    -- certificate already exists
}

PKIStatusInfo ::= SEQUENCE {
    status        PKIStatus,
    statusString  PKIFreeText     OPTIONAL,
    failInfo      PKIFailureInfo  OPTIONAL }

OOBCert ::= CMPCertificate

OOBCertHash ::= SEQUENCE {
    hashAlg     [0] AlgorithmIdentifier{DIGEST-ALGORITHM, {...}}
                        OPTIONAL,
    certId      [1] CertId                  OPTIONAL,
    hashVal         BIT STRING
    -- hashVal is calculated over the DER encoding of the
    -- self-signed certificate with the identifier certID.
}

POPODecKeyChallContent ::= SEQUENCE OF Challenge
-- One Challenge per encryption key certification request (in the
-- same order as these requests appear in CertReqMessages).

Challenge ::= SEQUENCE {
    owf                 AlgorithmIdentifier{DIGEST-ALGORITHM, {...}}
                            OPTIONAL,
    -- MUST be present in the first Challenge; MAY be omitted in
    -- any subsequent Challenge in POPODecKeyChallContent (if
    -- omitted, then the owf used in the immediately preceding
    -- Challenge is to be used).
    witness             OCTET STRING,
    -- the result of applying the one-way function (owf) to a
    -- randomly-generated INTEGER, A.  [Note that a different
    -- INTEGER MUST be used for each Challenge.]
    challenge           OCTET STRING
    -- the encryption (under the public key for which the cert.
    -- request is being made) of Rand.
}

-- Added in CMP Updates [thisRFC]

Rand ::= SEQUENCE {
-- Rand is encrypted under the public key to form the challenge
-- in POPODecKeyChallContent
   int                  INTEGER,
   -- the randomly-generated INTEGER A (above)
   sender               GeneralName
   -- the sender's name (as included in PKIHeader)
}

POPODecKeyRespContent ::= SEQUENCE OF INTEGER
-- One INTEGER per encryption key certification request (in the
-- same order as these requests appear in CertReqMessages).  The
-- retrieved INTEGER A (above) is returned to the sender of the
-- corresponding Challenge.

CertRepMessage ::= SEQUENCE {
    caPubs       [1] SEQUENCE SIZE (1..MAX) OF CMPCertificate
                  OPTIONAL,
    response         SEQUENCE OF CertResponse }

CertResponse ::= SEQUENCE {
    certReqId           INTEGER,
    -- to match this response with the corresponding request (a value
    -- of 0 is to be used if certReqId is not specified in the
    -- corresponding request, which can only be a p10cr)
    status              PKIStatusInfo,
    certifiedKeyPair    CertifiedKeyPair    OPTIONAL,
    rspInfo             OCTET STRING        OPTIONAL
    -- analogous to the id-regInfo-utf8Pairs string defined
    -- for regInfo in CertReqMsg [RFC4211]
}

CertifiedKeyPair ::= SEQUENCE {
    certOrEncCert       CertOrEncCert,
    privateKey      [0] EncryptedKey      OPTIONAL,
    -- see [RFC4211] for comment on encoding
    -- Changed from Encrypted Value to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- CMP Updates [thisRFC]
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change
    publicationInfo [1] PKIPublicationInfo  OPTIONAL }

CertOrEncCert ::= CHOICE {
    certificate     [0] CMPCertificate,
    encryptedCert   [1] EncryptedKey
    -- Changed from Encrypted Value to EncryptedKey as a CHOICE of
    -- EncryptedValue and EnvelopedData due to the changes made in
    -- CMP Updates [thisRFC]
    -- Using the choice EncryptedValue is bit-compatible to the
    -- syntax without this change
}

KeyRecRepContent ::= SEQUENCE {
    status                  PKIStatusInfo,
    newSigCert          [0] CMPCertificate OPTIONAL,
    caCerts             [1] SEQUENCE SIZE (1..MAX) OF
                                     CMPCertificate OPTIONAL,
    keyPairHist         [2] SEQUENCE SIZE (1..MAX) OF
                                     CertifiedKeyPair OPTIONAL }

RevReqContent ::= SEQUENCE OF RevDetails

RevDetails ::= SEQUENCE {
    certDetails         CertTemplate,
    -- allows requester to specify as much as they can about
    -- the cert. for which revocation is requested
    -- (e.g., for cases in which serialNumber is not available)
    crlEntryDetails     Extensions{{...}}    OPTIONAL
    -- requested crlEntryExtensions
}

RevRepContent ::= SEQUENCE {
    status       SEQUENCE SIZE (1..MAX) OF PKIStatusInfo,
    -- in same order as was sent in RevReqContent
    revCerts [0] SEQUENCE SIZE (1..MAX) OF CertId OPTIONAL,
    -- IDs for which revocation was requested
    -- (same order as status)
    crls     [1] SEQUENCE SIZE (1..MAX) OF CertificateList OPTIONAL
    -- the resulting CRLs (there may be more than one)
}

CAKeyUpdAnnContent ::= SEQUENCE {
    oldWithNew   CMPCertificate, -- old pub signed with new priv
    newWithOld   CMPCertificate, -- new pub signed with old priv
    newWithNew   CMPCertificate  -- new pub signed with new priv
}

CertAnnContent ::= CMPCertificate

RevAnnContent ::= SEQUENCE {
    status              PKIStatus,
    certId              CertId,
    willBeRevokedAt     GeneralizedTime,
    badSinceDate        GeneralizedTime,
    crlDetails          Extensions{{...}}  OPTIONAL
    -- extra CRL details (e.g., crl number, reason, location, etc.)
}

CRLAnnContent ::= SEQUENCE OF CertificateList
PKIConfirmContent ::= NULL

NestedMessageContent ::= PKIMessages

-- Added in CMP Updates [thisRFC]

RootCaKeyUpdateContent ::= SEQUENCE {
   newWithNew       CMPCertificate,
   -- new root CA certificate
   newWithOld   [0] CMPCertificate OPTIONAL,
   -- X.509 certificate containing the new public root CA key
   -- signed with the old private root CA key
   oldWithNew   [1] CMPCertificate OPTIONAL
   -- X.509 certificate containing the old public root CA key
   -- signed with the new private root CA key
   }

-- Added in CMP Updates [thisRFC]

CertReqTemplateContent ::= SEQUENCE {
   certTemplate           CertTemplate,
   -- prefilled certTemplate structure elements
   -- The SubjectPublicKeyInfo field in the certTemplate MUST NOT
   -- be used.
   keySpec                Controls OPTIONAL
   -- MAY be used to specify supported algorithms.
   -- Controls  ::= SEQUENCE SIZE(1..MAX) OF AttributeTypeAndValue
   -- as specified in CRMF (RFC4211)
   }

id-regCtrl-algId OBJECT IDENTIFIER ::= { id-regCtrl TBD3 }
   AlgIdCtrl ::= AlgorithmIdentifier{ALGORITHM, {...}}
   -- SHALL be used to specify suported algorithms other than RSA

id-regCtrl-rsaKeyLen OBJECT IDENTIFIER ::= { id-regCtrl TBD4 }
   RsaKeyLenCtrl ::= INTEGER
   -- SHALL be used to specify suported RSA key lengths

INFO-TYPE-AND-VALUE ::= TYPE-IDENTIFIER

InfoTypeAndValue ::= SEQUENCE {
    infoType    INFO-TYPE-AND-VALUE.
                    &amp;id({SupportedInfoSet}),
    infoValue   INFO-TYPE-AND-VALUE.
                    &amp;Type({SupportedInfoSet}{@infoType}) }

SupportedInfoSet INFO-TYPE-AND-VALUE ::= { ... }

-- Example InfoTypeAndValue contents include, but are not limited
-- to, the following (uncomment in this ASN.1 module and use as
-- appropriate for a given environment):
--
--   id-it-caProtEncCert    OBJECT IDENTIFIER ::= {id-it 1}
--      CAProtEncCertValue      ::= CMPCertificate
--   id-it-signKeyPairTypes OBJECT IDENTIFIER ::= {id-it 2}
--      SignKeyPairTypesValue   ::= SEQUENCE OF
--                                      AlgorithmIdentifier{{...}}
--   id-it-encKeyPairTypes  OBJECT IDENTIFIER ::= {id-it 3}
--      EncKeyPairTypesValue    ::= SEQUENCE OF
--                                      AlgorithmIdentifier{{...}}
--   id-it-preferredSymmAlg OBJECT IDENTIFIER ::= {id-it 4}
--      PreferredSymmAlgValue   ::= AlgorithmIdentifier{{...}}
--   id-it-caKeyUpdateInfo  OBJECT IDENTIFIER ::= {id-it 5}
--      CAKeyUpdateInfoValue    ::= CAKeyUpdAnnContent
--   id-it-currentCRL       OBJECT IDENTIFIER ::= {id-it 6}
--      CurrentCRLValue         ::= CertificateList
--   id-it-unsupportedOIDs  OBJECT IDENTIFIER ::= {id-it 7}
--      UnsupportedOIDsValue    ::= SEQUENCE OF OBJECT IDENTIFIER
--   id-it-keyPairParamReq  OBJECT IDENTIFIER ::= {id-it 10}
--      KeyPairParamReqValue    ::= OBJECT IDENTIFIER
--   id-it-keyPairParamRep  OBJECT IDENTIFIER ::= {id-it 11}
--      KeyPairParamRepValue    ::= AlgorithmIdentifer
--   id-it-revPassphrase    OBJECT IDENTIFIER ::= {id-it 12}
--      RevPassphraseValue      ::= EncryptedKey
--      - Changed from Encrypted Value to EncryptedKey as a CHOICE
--      - of EncryptedValue and EnvelopedData due to the changes
--      - made in CMP Updates [thisRFC]
--      - Using the choice EncryptedValue is bit-compatible to
--      - the syntax without this change
--   id-it-implicitConfirm  OBJECT IDENTIFIER ::= {id-it 13}
--      ImplicitConfirmValue    ::= NULL
--   id-it-confirmWaitTime  OBJECT IDENTIFIER ::= {id-it 14}
--      ConfirmWaitTimeValue    ::= GeneralizedTime
--   id-it-origPKIMessage   OBJECT IDENTIFIER ::= {id-it 15}
--      OrigPKIMessageValue     ::= PKIMessages
--   id-it-suppLangTags     OBJECT IDENTIFIER ::= {id-it 16}
--      SuppLangTagsValue       ::= SEQUENCE OF UTF8String
--   id-it-caCerts OBJECT IDENTIFIER ::= { id-it 17}
--      CaCertsValue ::= SEQUENCE OF CMPCertificate
--      - id-it-caCerts added in CMP Updates [thisRFC]
--   id-it-rootCaKeyUpdate OBJECT IDENTIFIER ::= { id-it 18}
--      RootCaKeyUpdateValue ::= RootCaKeyUpdateContent
--      - id-it-rootCaKeyUpdate added in CMP Updates [thisRFC]
--   id-it-certReqTemplate OBJECT IDENTIFIER ::= { id-it 19}
--      CertReqTemplateValue ::= CertReqTemplateContent
--      - id-it-certReqTemplate added in CMP Updates [thisRFC]
--   id-it-rootCaCert  OBJECT IDENTIFIER ::= {id-it TBD5}
--      RootCaCertValue ::= CMPCertificate
--      - id-it-rootCaCert  added in CMP Updates [thisRFC]
--   id-it-certProfile  OBJECT IDENTIFIER ::= {id-it TBD6}
--      CertProfileValue ::= UTF8String
--      - id-it-certProfile  added in CMP Updates [thisRFC]
--
-- where
--
--   id-pkix OBJECT IDENTIFIER ::= {
--      iso(1) identified-organization(3)
--      dod(6) internet(1) security(5) mechanisms(5) pkix(7)}
-- and
--   id-it   OBJECT IDENTIFIER ::= {id-pkix 4}
--
--
-- This construct MAY also be used to define new PKIX Certificate
-- Management Protocol request and response messages, or general-
-- purpose (e.g., announcement) messages for future needs or for
-- specific environments.

GenMsgContent ::= SEQUENCE OF InfoTypeAndValue

-- May be sent by EE, RA, or CA (depending on message content).
-- The OPTIONAL infoValue parameter of InfoTypeAndValue will
-- typically be omitted for some of the examples given above.
-- The receiver is free to ignore any contained OBJECT IDs that it
-- does not recognize.  If sent from EE to CA, the empty set
-- indicates that the CA may send
-- any/all information that it wishes.

GenRepContent ::= SEQUENCE OF InfoTypeAndValue
-- Receiver MAY ignore any contained OIDs that it does not
-- recognize.

ErrorMsgContent ::= SEQUENCE {
    pKIStatusInfo          PKIStatusInfo,
    errorCode              INTEGER           OPTIONAL,
    -- implementation-specific error codes
    errorDetails           PKIFreeText       OPTIONAL
    -- implementation-specific error details
}

CertConfirmContent ::= SEQUENCE OF CertStatus

CertStatus ::= SEQUENCE {
    certHash    OCTET STRING,
    -- the hash of the certificate, using the same hash algorithm
    -- as is used to create and verify the certificate signature
    certReqId   INTEGER,
    -- to match this confirmation with the corresponding req/rep
    statusInfo  PKIStatusInfo OPTIONAL }

PollReqContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER }

PollRepContent ::= SEQUENCE OF SEQUENCE {
    certReqId              INTEGER,
    checkAfter             INTEGER,  -- time in seconds
    reason                 PKIFreeText OPTIONAL }

--
-- Extended Key Usage extension for PKI entities used in CMP
-- operations, added due to the changes made in
-- CMP Updates [thisRFC]
-- The EKUs for the CA and RA are reused from CMC as defined in
-- [RFC6402]
--

-- id-kp-cmcCA OBJECT IDENTIFIER ::= { id-kp 27 }
-- id-kp-cmcRA OBJECT IDENTIFIER ::= { id-kp 28 }
id-kp-cmKGA OBJECT IDENTIFIER ::= { id-kp 32 }

END
</pre><a href="#section-a.2-2" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="History">
<section id="section-appendix.b">
      <h2 id="name-history-of-changes">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-history-of-changes" class="section-name selfRef">History of changes</a>
      </h2>
<p id="section-appendix.b-1">Note: This appendix will be deleted in the final version of the document.<a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2" class="keepWithNext">From version 9 -&gt; 10:<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-3.1">Added 1988 ASN.1 syntax for localKeyId attribute to Appendix A.1<a href="#section-appendix.b-3.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-4" class="keepWithNext">From version 08 -&gt; 09:<a href="#section-appendix.b-4" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-5.1">Deleted specific definition of CMP CA and CMP RA in Section 2.2 and only reference RFC 6402 for definition of id-kp-cmcCA and id-kp-cmcRA to resolve the ToDo below based on feedback of Tomas Gustavesson<a href="#section-appendix.b-5.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-5.2">Added Section 2.4. and 2.5 to define id-it-rootCaCert and id-it-certProfile to be used in Section 2.14 and 2.15<a href="#section-appendix.b-5.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-5.3">Added reference to CMP Algorithms in Section 2.8<a href="#section-appendix.b-5.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-5.4">Extended Section 2.14 to explicitly indicate the root CA an update is requested for by using id-it-rootCaCert and changing the ASN.1 syntax to require providing the newWithOld certificate in the response message<a href="#section-appendix.b-5.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-5.5">Extended Section 2.15 to explicitly indicate the certificate request template by using id-it-certProfile and on further details of the newly introduced controls<a href="#section-appendix.b-5.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-5.6">Deleted the table on id-kp-cmcCA and id-kp-cmcRA and adding id-it-rootCaCert and id-it-certProfile in Section 2.19<a href="#section-appendix.b-5.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-5.7">Adding the definition of id-it-rootCaCert and id-it-certProfile in both ASN.1 modules in Appendix A<a href="#section-appendix.b-5.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-5.8">Minor editorial changes reflecting the above changes<a href="#section-appendix.b-5.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-6" class="keepWithNext">From version 07 -&gt; 08:<a href="#section-appendix.b-6" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-7.1">Added a ToDo to Section 2.2 to reflect a current discussion on the need of an additional CMP-CA role and EKU and differentiation from CMP-RA<a href="#section-appendix.b-7.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-7.2">Added ToDos to Section 2.12 and 2.13<a href="#section-appendix.b-7.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-8" class="keepWithNext">From version 06 -&gt; 07:<a href="#section-appendix.b-8" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-9.1">Added David von Oheimb as co-author<a href="#section-appendix.b-9.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.2">Changed to XML V3<a href="#section-appendix.b-9.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.3">Added Section 2.3 to enable a CMP protocol version number 3 in the PKIHeader for cases where EnvelopedData is to be used (see thread "Mail regarding draft-ietf-lamps-cmp-updates").<a href="#section-appendix.b-9.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.4">Added Section 2.4 to refer to [I-D.ietf-lamps-crmf-update-algs] for the update of id-PasswordBasedMac for PKI message protection using passwords or shared secrets.<a href="#section-appendix.b-9.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.5">Updated Section 2.6 to introduce the protocol version number 3 to properly indicate support of EnvelopedData instead of EncryptedValue in case a transaction requires use of EnvelopedData (see thread "Mail regarding draft-ietf-lamps-cmp-updates").<a href="#section-appendix.b-9.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.6">Update Section 2.14 to make the minimal changes to the respective section in CMP more explicit.<a href="#section-appendix.b-9.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.7">Added Sections 2.15 and 2.16 to address the new cmp2021 protocol version in Section 7 Version Negotiation.<a href="#section-appendix.b-9.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.8">Updated Section 2.17 to add new OIDs for id-regCtrl-algId and id-regCtrl-rsaKeyLen for registration at IANA.<a href="#section-appendix.b-9.8" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.9">Added Section 2.20 to update the general rules of interpretation in Appendix D.1 regarding the new cmp2021 version.<a href="#section-appendix.b-9.9" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.10">Added Section 2.21 to update the Algorithm Use Profile in Appendix D.2 with the reference to the new CMP Algorithms document as decided at IETF 108.<a href="#section-appendix.b-9.10" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.11">Updates Section 3.1 to delete the description of a discovery mechanism as decided at IETF 108.<a href="#section-appendix.b-9.11" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-9.12">Various changes and corrections in wording.<a href="#section-appendix.b-9.12" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-10" class="keepWithNext">From version 05 -&gt; 06:<a href="#section-appendix.b-10" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-11.1">Added the update of Appendix D.2 with the reference to the new CMP Algorithms document as decided in IETF 108<a href="#section-appendix.b-11.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-11.2">Updated the IANA considerations to register new OIDs for id-regCtrl-algId and d-regCtrl-rsaKeyLen.<a href="#section-appendix.b-11.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-11.3">Minor changes and corrections<a href="#section-appendix.b-11.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-12" class="keepWithNext">From version 04 -&gt; 05:<a href="#section-appendix.b-12" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-13.1">Added <a href="#CMP-5.3.19.2" class="xref">Section 2.10</a> and <a href="#CMP-5.3.19.3" class="xref">Section 2.11</a> to clarify the usage of these general messages types with EC curves (see thread "AlgorithmIdentifier parameters NULL value - Re: InfoTypeAndValue in CMP headers")<a href="#section-appendix.b-13.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-13.2">Split former section 2.7 on adding 'CA Certificates', 'Root CA Certificates Update', and 'Certificate Request Template' in three separate sections for easier readability<a href="#section-appendix.b-13.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-13.3">Changed in <a href="#CMP-5.3.19.15" class="xref">Section 2.14</a> the ASN.1 syntax of CertReqTemplateValue from using reaKeyLen to usage of controls as specified in <span><a href="#RFC4211" class="xref">CRMF Section 6</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> (see thread "dtaft-ietf-lamps-cmp-updates and rsaKeyLen")<a href="#section-appendix.b-13.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-13.4">Updated the IANA considerations in <a href="#CMP-9" class="xref">Section 2.19</a> to introduce new OID for id-regCtrl-algId  and id-regCtrl-rsaKeyLen (see thread "dtaft-ietf-lamps-cmp-updates and rsaKeyLen")<a href="#section-appendix.b-13.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-13.5">Updated the IANA Considerations in and the Appendixes to introduce new OID for the updates ASN.1 modules (see thread "I-D Action: draft-ietf-lamps-cmp-updates-04.txt")<a href="#section-appendix.b-13.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-13.6">Removed EncryptedValue from and added Controls to the list of types imported from <span><a href="#RFC4211" class="xref">CRMF</a> [<a href="#RFC4211" class="xref">RFC4211</a>]</span> in ASN.1 modules (see thread "draft-ietf-lamps-cmp-updates and the ASN.1 modules")<a href="#section-appendix.b-13.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-13.7">Moved declaration of Rand out of the comment in ASN.1 modules (see thread "draft-ietf-lamps-cmp-updates and the ASN.1 modules")<a href="#section-appendix.b-13.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-13.8">Minor changes and corrections<a href="#section-appendix.b-13.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-14" class="keepWithNext">From version 03 -&gt; 04:<a href="#section-appendix.b-14" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-15.1">Added Section 2.7 to introduce three new id-it IDs for uses in general messages as discussed (see thread "draft-ietf-lamps-cmp-updates add section to introduce id-it-caCerts, id-it-rootCaKeyUpdate, and id-it-certReqTemplate")<a href="#section-appendix.b-15.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-15.2">Added the new id-it IDs and the /.well-known/cmp to the IANA Considerations of <span>[<a href="#RFC4210" class="xref">RFC4210</a>]</span> in Section 2.9<a href="#section-appendix.b-15.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-15.3">Updated the IANA Considerations of <span>[<a href="#RFC4210" class="xref">RFC4210</a>]</span> in <a href="#CMP-B" class="xref">Section 2.20</a><a href="#section-appendix.b-15.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-15.4">Some changes in wording on <a href="#Trans-Updates" class="xref">Section 3</a> due to review comments from Martin Peylo<a href="#section-appendix.b-15.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-16" class="keepWithNext">From version 02 -&gt; 03:<a href="#section-appendix.b-16" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-17.1">Added a ToDo on aligning with the CMP Algorithms draft that will be set up as decided in IETF 108<a href="#section-appendix.b-17.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-17.2">Updated section on Encrypted Values in <a href="#CMP-5.2.2" class="xref">Section 2.8</a> to add the AsymmetricKey Package structure to transport a newly generated private key as decided in IETF 108<a href="#section-appendix.b-17.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-17.3">Updated the IANA Considerations of <span>[<a href="#RFC4210" class="xref">RFC4210</a>]</span> in <a href="#CMP-B" class="xref">Section 2.20</a><a href="#section-appendix.b-17.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-17.4">Added the pre-registered OID in <a href="#CMP-B" class="xref">Section 2.20</a> and the ASN.1 module<a href="#section-appendix.b-17.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-17.5">Added <a href="#Trans-Updates" class="xref">Section 3</a> to document the changes to <span><a href="#RFC6712" class="xref">RFC 6712</a> [<a href="#RFC6712" class="xref">RFC6712</a>]</span> regarding URI discovery and using the path-prefix of '/.well-known/' as discussed in IETF 108<a href="#section-appendix.b-17.5" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-17.6">Updated the IANA Considerations section<a href="#section-appendix.b-17.6" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-17.7">Added a complete updated ASN.1 module in 1988 syntax to update Appendix F of <span>[<a href="#RFC4210" class="xref">RFC4210</a>]</span> and a complete updated ASN.1 module in 2002 syntax to update Section 9 of <span>[<a href="#RFC5912" class="xref">RFC5912</a>]</span><a href="#section-appendix.b-17.7" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-17.8">Minor changes in wording<a href="#section-appendix.b-17.8" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-18" class="keepWithNext">From version 01 -&gt; 02:<a href="#section-appendix.b-18" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-19.1">Updated section on EKU OIDs in <a href="#CMP-4.5" class="xref">Section 2.2</a> as decided in IETF 107<a href="#section-appendix.b-19.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-19.2">Changed from symmetric key-encryption to password-based key management technique in <a href="#CMP-5.2.2" class="xref">Section 2.8</a> as discussed with Russ and Jim on the mailing list<a href="#section-appendix.b-19.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-19.3">Defined the attribute containing the key identifier for the revocation passphrase in <a href="#CMP-B" class="xref">Section 2.20</a><a href="#section-appendix.b-19.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-19.4">Moved the change history to the Appendix<a href="#section-appendix.b-19.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-20" class="keepWithNext">From version 00 -&gt; 01:<a href="#section-appendix.b-20" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-21.1">Minor changes in wording<a href="#section-appendix.b-21.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-22" class="keepWithNext">From draft-brockhaus-lamps-cmp-updates-03 -&gt; draft-ietf-lamps-cmp-updates-00:<a href="#section-appendix.b-22" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-23.1">Changes required to reflect WG adoption<a href="#section-appendix.b-23.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-24" class="keepWithNext">From version 02 -&gt; 03:<a href="#section-appendix.b-24" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-25.1">Added some clarification in <a href="#CMP-1.1" class="xref">Section 2.1</a><a href="#section-appendix.b-25.1" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-26" class="keepWithNext">From version 01 -&gt; 02:<a href="#section-appendix.b-26" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-27.1">Added clarification to section on multiple protection<a href="#section-appendix.b-27.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-27.2">Added clarification on new EKUs after some exchange with Tomas Gustavsson<a href="#section-appendix.b-27.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-27.3">Reused OIDs from <span><a href="#RFC6402" class="xref">RFC 6402</a> [<a href="#RFC6402" class="xref">RFC6402</a>]</span> as suggested by Sean Turner at IETF 106<a href="#section-appendix.b-27.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-27.4">Added clarification on the field containing the key identifier for a revocation passphrase<a href="#section-appendix.b-27.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-27.5">Minor changes in wording<a href="#section-appendix.b-27.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-appendix.b-28" class="keepWithNext">From version 00 -&gt; 01:<a href="#section-appendix.b-28" class="pilcrow">¶</a></p>
<ul class="compact">
<li class="compact" id="section-appendix.b-29.1">Added a section describing the new extended key usages<a href="#section-appendix.b-29.1" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-29.2">Completed the section on changes to the specification of encrypted values<a href="#section-appendix.b-29.2" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-29.3">Added a section on clarification to Appendix D.4<a href="#section-appendix.b-29.3" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-29.4">Minor generalization in <span><a href="#RFC4210" class="xref">RFC 4210</a> [<a href="#RFC4210" class="xref">RFC4210</a>]</span> Sections 5.1.3.4 and 5.3.22<a href="#section-appendix.b-29.4" class="pilcrow">¶</a>
</li>
        <li class="compact" id="section-appendix.b-29.5">Minor changes in wording<a href="#section-appendix.b-29.5" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.c">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Hendrik Brockhaus</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:hendrik.brockhaus@siemens.com" class="email">hendrik.brockhaus@siemens.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">David von Oheimb</span></div>
<div dir="auto" class="left"><span class="org">Siemens AG</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:david.von.oheimb@siemens.com" class="email">david.von.oheimb@siemens.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
