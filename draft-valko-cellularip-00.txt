





INTERNET-DRAFT                                                  A. Valko
                                           Ericsson, Columbia University
                                                   A. Campbell, J. Gomez
<draft-valko-cellularip-00.txt>                      Columbia University
Expires May 1999                                           November 1998

                              Cellular IP

Status of this Memo

   This document is an Internet-Draft. Internet-Drafts are working
   documents of the Internet Engineering Task Force (IETF), its areas,
   and its working groups. Note that other groups may also distribute
   working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet- Drafts as reference
   material or to cite them other than as ``work in progress.''

   To learn the current status of any Internet-Draft, please check the
   ``1id- abstracts.txt'' listing contained in the Internet- Drafts
   Shadow Directories on ftp.is.co.za (Africa), nic.nordu.net (Europe),
   munnari.oz.au (Pacific Rim), ftp.ietf.org (US East Coast), or
   ftp.isi.edu (US West Coast).

   Distribution of this memo is unlimited.

Abstract

   This document specifies a protocol that allows routing IP datagrams
   to a mobile host.  The protocol is intended to provide local mobility
   and handoff support.  It can interwork with Mobile IP [1] to provide
   wide area mobility support.  Four fundamental design principles of
   the protocol are: (1) location information is stored in distributed
   data bases (2) location information referring to a mobile host is
   created and updated by regular IP datagrams originated by the said
   mobile host (3) location information is stored as soft state (4)
   location management for idle mobile hosts is separated from location
   management of hosts that are actively transmitting or receiving data.

















Valko, Campbell, Gomez            Expires May 1999              [Page 1]





INTERNET-DRAFT                Cellular IP               18 November 1998


Table of Contents

 1. Introduction                                                       2
     1.1. Protocol Requirements . . . . . . . . . . . . . . . . . .    3
     1.2. Assumptions . . . . . . . . . . . . . . . . . . . . . . .    3
     1.3. Applicability . . . . . . . . . . . . . . . . . . . . . .    3
     1.4. New Architectural Entities  . . . . . . . . . . . . . . .    3
     1.5. Terminology . . . . . . . . . . . . . . . . . . . . . . .    4
     1.6. Protocol Overview . . . . . . . . . . . . . . . . . . . .    5
     1.7. Location Management and Routing . . . . . . . . . . . . .    7
 2. Cellular IP Functions                                              8
     2.1. Location Management . . . . . . . . . . . . . . . . . . .    8
     2.2. Routing . . . . . . . . . . . . . . . . . . . . . . . . .    9
     2.3. Handoff . . . . . . . . . . . . . . . . . . . . . . . . .    9
     2.4. Wide Area Mobility  . . . . . . . . . . . . . . . . . . .   10
     2.5. Handling Wireless Channel Black-outs  . . . . . . . . . .   10
 3. Protocol Details                                                  11
     3.1. Protocol Parameters . . . . . . . . . . . . . . . . . . .   11
     3.2. Beacon Signal Structure . . . . . . . . . . . . . . . . .   11
     3.3. Packet Formats  . . . . . . . . . . . . . . . . . . . . .   11
          3.3.1. Data packet  . . . . . . . . . . . . . . . . . . .   11
          3.3.2. Route-update packet  . . . . . . . . . . . . . . .   11
          3.3.3. Paging-update packet . . . . . . . . . . . . . . .   12
     3.4. Addressing  . . . . . . . . . . . . . . . . . . . . . . .   13
     3.5. Cellular IP Routing . . . . . . . . . . . . . . . . . . .   13
     3.6. Cellular IP Gateway . . . . . . . . . . . . . . . . . . .   14
     3.7. Cellular IP Mobile Host . . . . . . . . . . . . . . . . .   15

APPENDIX A. Security Issues . . . . . . . . . . . . . . . . . . . .   16
APPENDIX B. Network Planning and Performance  . . . . . . . . . . .   17
APPENDIX C. Multiple Gateway Systems  . . . . . . . . . . . . . . .   18
APPENDIX D. Charging  . . . . . . . . . . . . . . . . . . . . . . .   18
APPENDIX E. Uplink I/F Selection  . . . . . . . . . . . . . . . . .   18
References                                                            19
Authors' Addresses                                                    19

1. Introduction

   Hosts connecting to the Internet via wireless interface are likely to
   change their point of access frequently.  A mechanism is required
   that ensures that packets addressed to moving hosts are successfully
   delivered with high probability.  A change of access point during
   active data transmission or reception is called a handoff.  During or
   immediately after a handoff, packet losses may occur due to delayed
   propagation of new location information.  These losses should be
   minimized in order to avoid a degradation of service quality as
   handoffs become more frequent.

   This memo specifies Cellular IP, a protocol that provides mobility
   and handoff support for frequently moving hosts.  It is intended to
   be used on a local level, for instance in a campus or metropolitan
   area network.  Cellular IP can interwork with Mobile IP [1] to
   support wide area mobility, that is, mobility between Cellular IP
   Networks.



Valko, Campbell, Gomez            Expires May 1999              [Page 2]





INTERNET-DRAFT                Cellular IP               18 November 1998


1.1. Protocol Requirements

   A host connected to a Cellular IP Network must be able to send IP
   datagrams to hosts outside the Cellular IP Network.

   IP datagrams arriving to a Cellular IP Network, addressed to a host
   connected to this Cellular IP Network, should be delivered with high
   probability to the host regardless of its actual location.

   IP datagrams generated by one host in the Cellular IP Network
   addressed to another host in the Cellular IP Network should be
   delivered to the destination without leaving the Cellular IP Network.

   A mobile host migrating between Cellular IP Networks must be able to
   use Mobile IP [1] for wide area mobility.  Upon entering a Cellular
   IP Network, it must be able to provide its home agent with a care-
   of-address that ensures that its packets are routed to this Cellular
   IP Network.

   Mobile hosts migrating inside or between Cellular IP Networks must be
   able to retain their own home IP addresses regardless of location.
   Hosts inside a Cellular IP Network are identified by IP addresses,
   but these addresses have no location significance.

   Hosts outside the Cellular IP Network must not need any updating or
   enhancements in order to communicate with hosts inside the Cellular
   IP Network.  Nodes sending or receiving datagrams to/from the mobile
   host must remain unaware of the host's location inside the Cellular
   IP Network.

1.2. Assumptions

   Cellular IP assumes that a random access L2 protocol covers the air
   interface.

1.3. Applicability

   Cellular IP is applicable to networks ranging in size from LANs to
   metropolitan area networks.  To provide global mobility support,
   Mobile IP [1] should be used above Cellular IP.

   Cellular IP is designed to support frequently migrating hosts but
   with appropriate setting of protocol parameters, it can also
   efficiently serve rarely moving or even static hosts.

1.4. New Architectural Entities

      Cellular IP Node
         A Cellular IP Network consists of interconnected Cellular IP
         Nodes.  The role of Nodes is twofold.  They route IP packets
         inside the Cellular IP Network and communicate with Mobile
         Hosts via wireless interface.  Referring to the latter role, a
         Cellular IP Node that has a wireless interface is also called a
         Base Station.



Valko, Campbell, Gomez            Expires May 1999              [Page 3]





INTERNET-DRAFT                Cellular IP               18 November 1998


      Cellular IP Base Station
         See Cellular IP Node.

      Cellular IP Gateway
         A Cellular IP Node that is connected to a regular IP network by
         at least one of its interfaces.

      Cellular IP Mobile Host
         A Mobile Host that implements the Cellular IP protocol.

1.5. Terminology

      Active Mobile Host
         A Mobile Host is in active state if it is transmitting or
         receiving IP packets.  (Exact definition is given in section
         3.7.)

      Active-state-timeout
         The time a Cellular IP Mobile Host remains in active state
         without receiving IP packets.

      Cellular IP Network Identifier
         A unique identifier assigned to Cellular IP Networks.

      Control packet
         Paging-update and Route-update packet.

      Data packet
         An IP packet that is not a control packet.

      Downlink
         Directed to a Mobile Host.

      Downlink interface (I/F)
         All interfaces of a Cellular IP Node except its Uplink I/F are
         referred to as Downlink I/Fs.

      Idle Mobile Host
         A Mobile Host is in idle state if it has not recently
         transmitted or received IP packets.  (Exact definition is given
         in section 3.7.)

      Internet
         A Cellular IP Network provides access to a regular IP network.
         This IP network in this memo is referred to as "Internet".

      Paging Cache
         A cache maintained by some Cellular IP Nodes, used to route
         packets to Mobile Hosts.

      Paging-timeout
         Validity time of mappings in Paging Caches.

      Paging-update packet



Valko, Campbell, Gomez            Expires May 1999              [Page 4]





INTERNET-DRAFT                Cellular IP               18 November 1998


         A control packet transmitted by Cellular IP Mobile Hosts in
         order to update Paging Cache.

      Paging-update-time
         Time between consecutive Paging-update packets.

      Route-timeout
         Validity time of mappings in Routing Caches.

      Route-update packet
         A control packet transmitted by Cellular IP Mobile Hosts in
         order to update Routing Cache.

      Route-update-time
         Time between consecutive Route-update packets.

      Routing Cache
         A cache maintained by all Cellular IP Nodes, used to route
         packets to Mobile Hosts.

      Uplink
         Originated by a Mobile Host.

      Uplink I/F
         The interface used by a Cellular IP Node to forward packets
         towards the Gateway.

1.6. Protocol Overview

   The figure shown below presents a schematic view of multiple Cellular
   IP Networks providing access to the Mobile IP enabled Internet.

            ..............................................
            .                                            .
            .      Internet Backbone with Mobile IP      .
            .                                            .
            ..............................................
                 /                 |                \
                /                  |                 \
            +--+                 +--+                  +--+
            |GW|                 |GW|                  |GW|
            +--+                 +--+                  +--+
           /                       |                      \
    +-------------+      +--------------------+      +-------------+
    |             |      |                    |      |             |
    | Cellular IP |      |     Cellular IP    |      | Cellular IP |
    |   Network   |      |       Network      |      |   Network   |
    |             |      |  __     __     __  |      |             |
    +-------------+      +-|BS|---|BS|---|BS|-+      +-------------+
                            --     --     --


                            +     ...      +
                           MH             MH



Valko, Campbell, Gomez            Expires May 1999              [Page 5]





INTERNET-DRAFT                Cellular IP               18 November 1998


   In the following, we present an overview of the operation of Cellular
   IP, followed by a figure illustrating the functional entities that
   comprise Cellular IP.

   Base Stations periodically emit beacon signals.  Mobile Hosts use
   these beacon signals to locate the nearest Base Station.  A Mobile
   Host can transmit a packet by relaying it to the nearest Base
   Station.

   All IP packets transmitted by a Mobile Host are routed from the Base
   Station to the Gateway by hop-by-hop shortest path routing,
   regardless of the destination address.

   Cellular IP Nodes maintain Routing Cache.  Packets transmitted by the
   Mobile Host create and update entries in each Node's Cache.  An entry
   maps the Mobile Host's IP address to the interface through which the
   packet entered the Node.

   The chain of cached mappings referring to a single Mobile Host
   constitutes a reverse path for downlink packets addressed to the same
   Mobile Host.  As the Mobile Host migrates, the chain always points to
   its current location because its uplink packets create new mappings
   and old mappings are automatically cleared after a soft state
   timeout.  After a migration, before the old mappings are cleared, a
   Node can temporarily have mappings for the same Mobile Host to
   multiple interfaces.  (This causes the chain to temporarily have a
   fork.)

   IP packets addressed to a Mobile Host are routed by the chain of
   cached mappings referring to the said Mobile Host.

   To prevent its mappings from timing out, a Mobile Host can
   periodically transmit control packets.  Control packets are regular
   IP packets with empty payloads.

   Mobile Hosts that are not actively transmitting or receiving data but
   want to be reachable for incoming packets, let their Routing Cache
   mappings time out but maintain Paging Cache mappings.  IP packets
   addressed to these Mobile Hosts will be routed by Paging Caches.
   Paging Caches have a longer timeout value than Routing Caches and are
   not necessarily maintained in every Node.
















Valko, Campbell, Gomez            Expires May 1999              [Page 6]





INTERNET-DRAFT                Cellular IP               18 November 1998


                           +--------+
                           |host in |
                           |Internet|
                           +--------+
                                |                        Internet
                                |      --------------------------
                           +--------+         Cellular IP Network
                           |Cell. IP|
                           |Gateway |
                           +--------+
                                |
                  -             :
                  |             :
                  |             : ___________ Uplink I/F
    A network of  |             |/                 (=shortest path
                  |        +--------+               toward Gateway)
     Cellular IP  |        |Cellular|
                  |        |IP Node |
        Nodes     |        +--------+
                  |             |\___________ Downlink I/F
                  |             :                  (=all other
                  -             :                   interfaces)
                                :
                                |
                           +--------+
uplink                     |Cellular|
  ^                        |IP Node |
  |                        +--------+
  |                      air    |
  |                    interface|
  V                        +--------+
downlink                   | Mobile |
                           |  Host  |
                           +--------+

1.7. Location Management and Routing

   Cellular IP uses two parallel cache systems to store the information
   related to the location of Mobile Hosts.  The two systems basically
   operate in the same way.  This section is intended to clarify why we
   use two distinct caches.

   Supposing there is just one set of cache, the following trade-off
   determines the optimal time cached mappings remain valid.  After a
   Mobile Host performs a handoff, its path to the old Base Station will
   remain valid until the cached mappings associated with this Base
   Station are cleared.  If in this period packets are sent to the Host,
   they are routed not only to its current location, but also to the old
   Base Station.  This results in a waste of resources.  The waste is
   especially large if the Mobile Host performs a number of handoffs
   within the validity time of the mappings.  In this case the system
   approaches a broadcasting based communication system and becomes
   inefficient.  This kind of waste can be minimized by selecting a
   small timeout interval, typically in the order of packet time scale.



Valko, Campbell, Gomez            Expires May 1999              [Page 7]





INTERNET-DRAFT                Cellular IP               18 November 1998


   On the other hand, in order to maintain mappings, Mobile Hosts must
   send control packets with a periodicity comparable to the mappings'
   validity time.  If the validity time is in the order of packet time
   scale, control packets must be transmitted at this time scale even by
   idle Mobile Hosts which similarly results in a large load generated
   by control packets making the system inefficient.

   Separating the caches for active and idle Mobile Hosts allows us to
   specify two optimal time scales for these operational states.  More
   specifically, active Hosts have mappings in Routing Caches.  These
   mappings remain valid for a short time, associated with the packet
   time scale.  Therefore Active Hosts need to send IP packets
   relatively frequently; that is, when they have no data to send they
   send control packets.  In contrast, idle Hosts have mappings in
   Paging Caches.  These mappings remain in caches for longer time, in
   the host mobility time scale.  Therefore the frequency at which idle
   Hosts must send control packets is relatively low, comparable to the
   frequency of migrations.  This load is not significantly higher than
   explicit migration signalling would impose on the system.

2. Cellular IP Functions

2.1. Location Management

   Idle mobile hosts periodically transmit Paging-update packets to keep
   Paging Cache mappings up-to-date.  These Paging-update packets update
   Paging Cache mappings but not Routing Cache mappings.  Paging-update
   packets reach the Gateway and are discarded there to isolate Cellular
   IP specific operations from the Internet.

   As the idle Mobile Host moves, it always sends its Paging-update
   packets to the nearest Base Station, forcing Paging Caches to point
   at its up-to-date location.  Outdated mappings are cleared after a
   system specific time, paging-timeout.

   When an IP packet arrives at a Cellular IP Node, addressed to a
   Mobile Host for which no up-to-date Routing Cache mapping is
   available, the Paging Cache is used to route the packet.  This phase
   is called "implicit paging".  (In the case of explicit paging, this
   packet is transformed into an explicit paging packet and all Nodes
   route it using Paging Caches.  This solution can provide some
   advantages over implicit paging, however, this is for further study.)
   If the Node has no Paging Cache, it forwards the packet to all
   Downlink I/Fs.  A Node that has Paging Cache but has no mapping in it
   for the addressed Host discards the packet.

   Upon receiving the packet, the Mobile Host moves to active state and
   starts updating its Routing Cache mappings.  Further IP packets
   addressed to the same Host will be routed by Routing Caches as long
   as the Mobile Host keeps the Routing Caches updated.







Valko, Campbell, Gomez            Expires May 1999              [Page 8]





INTERNET-DRAFT                Cellular IP               18 November 1998


2.2. Routing

   Packets transmitted by Mobile Hosts are routed to the Gateway using
   regular hop-by-hop routing.  Cellular IP Nodes monitor these passing
   data packets and use them to create and update Routing Cache
   mappings.  These map Mobile Host IP addresses to Node interfaces.
   Packets addressed to the Mobile Host are routed along the reverse
   path, on a hop-by-hop basis, by these Routing Cache mappings.

   The structure and basic operation of routing is the same as that of
   location management.  To clarify the duality between the two, we
   summarize the operation of Paging Caches and Routing Caches in the
   following table.  For the reasons of separating the two functions,
   see section 1.7.

   -------------------------------------------------------------------
                      Paging Caches               Routing Caches
   -------------------------------------------------------------------
   updated by     all uplink packets (data,           data and
                Paging-update, Route-update)   Route-update packets

   scope         both idle and active MHs        active Mobile Hosts

   purpose       route downlink packets if         route downlink
              there is no Routing Cache entry         packets

   time scale           mobility                       packet
   -------------------------------------------------------------------

   The Mobile Host may keep receiving data packets without sending data
   for possibly long durations.  To keep its Routing Cache mappings up
   to date and to avoid repeated paging, Mobile Hosts in active state
   that have no data to send must send periodic Route-update packets.
   Like uplink data packets, Route-update packets configure Routing
   Caches and ensure that the hop-by-hop route from the Gateway to the
   Mobile Host remains up-to-date.

   For reliability and timeliness, Paging Caches also contain Mobile
   Hosts that are contained by Routing Caches.  For this reason, Paging
   Caches are updated by all uplink packets including data and Route-
   update packets.

2.3. Handoff

   Handoff is initiated by the Mobile Host.  As the Host approaches a
   new Base Station, it redirects its packets from the old to the new
   Base Station.  The first of these redirected packets will configure
   Routing Caches along the way from the new Base Station to the
   Gateway.  (The paths leading to the old and new Base Stations may
   overlap.  In Nodes where the two paths are the same, the new packets
   simply refresh old mappings and the handoff remains unnoticed.)

   For a time equal to the timeout of Routing Cache mappings, packets
   addressed to the Host will be routed to both the old and new Base



Valko, Campbell, Gomez            Expires May 1999              [Page 9]





INTERNET-DRAFT                Cellular IP               18 November 1998


   Stations.  After the timeout has elapsed the Routing Cache mappings
   associated with the old Base Station will be automatically cleared.
   After this time, packets addressed to the Mobile Host continue to be
   delivered to the new Base Station only.

   If the Mobile Host has no data packets to send at the time of
   handoff, it generates and transmits a Route-update packet immediately
   after moving to the new Base Station.  This ensures that mappings are
   created quickly with the result of minimizing the downlink packet
   loss.

2.4. Wide Area Mobility

   Wide area mobility occurs when the Mobile Host moves between Cellular
   IP Networks.  The Mobile Host can identify Cellular IP Networks by
   the Cellular IP Network Identifier contained in the Base Stations'
   beacon signals.  The beacon signal also contains the IP address of
   the Gateway.  Technically, Cellular IP does not require that Mobile
   Hosts register before using the Cellular IP Network.  A Mobile Host
   entering the service area can start transmitting Paging-update
   packets configuring Paging Caches immediately.  For security and
   charging purposes, however, authentication and other user-related
   information may need to be provided by the Mobile Host.  This
   information will be inserted in the payload of the first Paging-
   update packet and may be repeated in a few following Paging-update
   packets for reliability.  Upon receiving the first Paging-update
   packet, the Gateway performs admission control that may involve
   technical and charging decisions.  The Gateway's response is sent to
   the Mobile Host in regular IP packet(s).  If the request was
   accepted, the response may also carry the required setting of
   protocol parameters.  The issues of authentication, billing and
   security are for further study and are beyond the scope of this
   Internet-Draft.

   Once the registration is accepted, the Mobile Host can send a Mobile
   IP registration message to its home agent, specifying the Gateway's
   IP address as care-of-address.  (Alternatively, the Gateway can
   register at the Home Agent on behalf of the Mobile Host.)

   The Mobile Host may leave the service area at any time without prior
   notice.  Mappings associated to the Host will be cleared after the
   timeout.

2.5. Handling Wireless Channel Black-outs

   Due to conditions in the wireless channel, Mobile Hosts may become
   temporarily disconnected.  A host that reappears after a black-out
   can continue operation normally regardless of whether it reappeared
   in the same cell or in another one.  The first packets transmitted
   (data or control) will configure or re-configure mappings in Routing
   and/or Paging Caches.  The network does not notice the black-out
   except for the Base Station that discards packets addressed to the
   unreachable Mobile Host.




Valko, Campbell, Gomez            Expires May 1999             [Page 10]





INTERNET-DRAFT                Cellular IP               18 November 1998


3. Protocol Details

3.1. Protocol Parameters

   The following parameters shall be set by network management.  The
   values listed here are for information only.  Consideration of
   selecting the proper values are discussed in Appendix B.

   -------------------------------------------------------------------
   Name                           Meaning                Typical Value
   -------------------------------------------------------------------
   route-update-time        Inter-arrival time              100 ms
                          of Route-update packets
   route-timeout            Validity of Routing             300 ms
                               Cache mappings
   paging-update-time        Inter-arrival time              1 min
                          of Paging-update packets
   paging-timeout            Validity of Paging              3 min
                               Cache mappings
   active-state-timeout     Time the Mobile Host            10 sec
                           remains in active state
                            without receiving data
   -------------------------------------------------------------------

3.2. Beacon Signal Structure

   Cellular IP Base Stations must periodically transmit beacon signals
   to allow for Mobile Hosts to identify an available Base Station.
   Information elements carried by the beacon signal are:

   - Layer2 parameters related to the Base Station;
   - the Cellular IP Network Identifier; and
   - the IP address of the Gateway.

3.3. Packet Formats

3.3.1. Data packet

   Cellular IP forwards regular IP packets without modification,
   segmentation, encapsulation or tunnelling.

3.3.2. Route-update packet

   A Route-update packet is an IP packet of which

   - the source address is the IP address of the sending Mobile Host;
   - the destination address is the Gateway; and
   - the protocol type is IPPROTO_CELLIPRU.

   The payload of the Route-update packet may be empty.  Optionally,
   control information may be carried in the Route-update packet's
   payload, encoded in the following Type-Length-Value format:





Valko, Campbell, Gomez            Expires May 1999             [Page 11]





INTERNET-DRAFT                Cellular IP               18 November 1998


    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-   -+-+-+-+-+-+-+-+-
   |     Type      |    Length     |    Data ...       |     Type ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-   -+-+-+-+-+-+-+-+-

      Type     Indicates the particular type of control information.

      Length   Indicates the length (in bytes) of the following data
               field within.  The length does not include the Type and
               Length bytes.

      Data     This field may be zero or more bytes in length.  The
               meaning, format and length of the data field is
               determined by the Type and Length fields.

   Currently the following types of control information are defined
   (details are for further study):

      Registration request
         Used when a Mobile Host enters the Cellular IP Network.

      Authentication
         Must be used when the Registration request field is present and
         may be used at other times, too. For further study.

3.3.3. Paging-update packet

   A Paging-update packet is an IP packet of which

   - the source address is the IP address of the sending Mobile Host;
   - the destination address is the Gateway; and
   - the protocol type is IPPROTO_CELLIPPU.

   The payload of the Paging-update packet may be empty.  Optionally,
   control information may be carried in the Paging-update packet's
   payload, encoded in the following Type-Length-Value format:

    0                   1                   2
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-   -+-+-+-+-+-+-+-+-
   |     Type      |    Length     |    Data ...       |     Type ...
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-   -+-+-+-+-+-+-+-+-

      Type     Indicates the particular type of control information.

      Length   Indicates the length (in bytes) of the following data
               field within.  The length does not include the Type and
               Length bytes.

      Data     This field may be zero or more bytes in length.  The
               meaning, format and length of the data field is
               determined by the Type and Length fields.




Valko, Campbell, Gomez            Expires May 1999             [Page 12]





INTERNET-DRAFT                Cellular IP               18 November 1998


   Currently the following types of control information are defined
   (details are for further study):

      Registration request
         Used when a Mobile Host enters the Cellular IP Network.

      Authentication
         Must be used when the Registration request field is present and
         may be used at other times, too. For further study.

3.4. Addressing

   Cellular IP requires no address space allocation beyond what is
   present in IP.  Mobile Hosts are identified by their home IP
   addresses.

3.5. Cellular IP Routing

   Cellular IP Nodes need only to implement the algorithm described in
   this section.  They do not need regular IP routing capability.  This
   section describes the routing algorithm in Cellular IP Nodes other
   than the Gateway.  The extra functions required only in the Cellular
   IP Gateway are described in section 3.6.

   In uplink direction (toward the Gateway), packets are routed in the
   Cellular IP Network on a hop-by-hop basis.  The interface through
   which a Node will forward a packet toward the Gateway is referred to
   as the Node's Uplink I/F.  The Uplink I/F at each Node may be
   designated by network management.  Alternatively, a simplified
   shortest path algorithm can select Uplink I/Fs.  (A regular shortest
   path algorithm is also applicable but is more complex than required
   since it determines routes to all nodes in the network.)  A simple
   algorithm that configures Uplink I/Fs and automatically reconfigures
   them if necessary after a topology change is described in Appendix E.

   A Node's interfaces other than the Uplink I/F are called Downlink
   I/Fs.  A packet arriving to the Node through one of the Downlink I/Fs
   is assumed to be coming from a Mobile Host.  The packet is first used
   to update the Node's Routing and Paging Caches and is then forwarded
   through the Node's Uplink I/F.

   To update the Caches, the Node reads the packet type (IPPROTO) and
   the source IP address.  Paging-update packets update the Paging Cache
   only.  Route-update and data packets update both Routing and Paging
   Caches.  Both types of caches consist of

      { IP-address, interface, expiration time }

   triplets, called mappings.  To update the Routing Cache, the Node
   creates the following triplet:







Valko, Campbell, Gomez            Expires May 1999             [Page 13]





INTERNET-DRAFT                Cellular IP               18 November 1998


      { the newly arrived packet's source IP address,
        the interface through which it arrived,
        current time + route-timeout
      }

   If a mapping existed in the Routing Cache with the same IP address
   and the same interface, it is replaced by the new triplet.  If such a
   triplet did not exist, the new triplet is inserted in the cache.  The
   Paging Cache is updated in the same way, using paging-timeout instead
   of route-timeout.  If the Node has no Paging Cache then only the
   Routing Cache is updated by Route-update and data packets and no
   cache is updated by Paging-update packets.

   A packet arriving to a Cellular IP Node through the Uplink I/F is
   assumed to be addressed to a Mobile Host.  The Node first checks if
   the destination IP address has a valid mapping in the Routing Cache.
   If such mapping(s) exist(s), the packet is forwarded to all
   interfaces to which valid Routing Cache mappings were found.

   If there are no valid Routing Cache mappings for the destination
   address and the Node has a Paging Cache, the packet is routed
   according to the Paging Cache as follows. It is forwarded to all
   interfaces to which the destination IP address has valid Paging Cache
   mapping.  If the Node has Paging Cache but there are no valid
   mappings, the packet is discarded.

   If there are no valid Routing Cache mappings for the destination, and
   the Node has no Paging Cache, the packet is forwarded to all Downlink
   I/Fs.

3.6. Cellular IP Gateway

   The following figure is a schematic view of a Cellular IP Gateway.
   The Gateway can logically be divided into three building blocks: a
   regular Cellular IP Node, a Gateway Packet Filter and a Gateway
   Controller.

                               IP network
                               ===================
                                         |
          +------------------------------|--------+
          |                              |        |
          | +----------+          +-------------+ |
          | | Gateway  |__________|   Gateway   | |
          | |Controller|          |Packet Filter| |
          | +----------+          +-------------+ |
          |                              | _______|____Uplink I/F
          |                              |/       |
          |                       +-------------+ |
          |    Cellular IP        | Cellular IP | |
          |      Gateway          |    Node     | |
          |                       +-------------+ |
          |                         |    |    |\__|____Downlink I/Fs
          +-------------------------|----|----|---+



Valko, Campbell, Gomez            Expires May 1999             [Page 14]





INTERNET-DRAFT                Cellular IP               18 November 1998


   Uplink packets update the Routing and/or Paging Caches in the
   Cellular IP Node block and are forwarded towards the Gateway filter.
   The Gateway filter reads the destination IP address.  If this is the
   Gateway's address, the packet is forwarded to the Gateway controller.
   Most of these packets are Route-update and Paging-update packets with
   empty payload and are immediately dropped.  If the packet carries
   control information, for instance a registration request, it is
   interpreted and processed by the Gateway controller.

   If the destination address is not the Gateway's, the packet is
   forwarded to the Internet.  (This means that a packet sent from a
   Mobile Host to another Mobile Host in the same Cellular IP Network
   goes through the destination Home Agent.  However, this is not the
   case if route optimization is used.  To operate efficiently even
   without Mobile IP route optimization, the Gateway Packet Filter can
   also check if the destination address of an uplink packet has a valid
   mapping in any of the Gateway's caches.  If a mapping is found, the
   packet is "turned back" and is treated as a downlink packet.)

   Packets arriving to the Gateway Packet Filter from the Internet can
   be of the following types:

      If the destination address is the Gateway and the packet is
      tunnelled, it must be sent using Mobile IP.  The packet is then
      detunnelled and forwarded to the Cellular IP Node.

      If the destination address is not the Gateway and the packet is an
      IPv6 packet containing a routing header, it must be sent using
      Mobile IP.  The packet is then forwarded to the Cellular IP Node,
      unchanged.

      If the destination address is not the Gateway and the packet does
      not contain a routing header, it is a regular IP packet addressed
      to a Mobile Host of which this Cellular IP Network is the home
      network.  The packet is then forwarded to the Cellular IP Node,
      unchanged.

   The Gateway's Cellular IP Node block treats these packets as
   determined by the Cellular IP Routing algorithm (section 3.5).  The
   packet is routed according to the Routing Cache if valid mapping(s)
   exist(s) for the destination address and is routed according to the
   Paging Cache otherwise.  Though in Cellular IP Nodes it is optional
   to have Paging Cache, it is recommended that the Gateway's Cellular
   IP Node have one.  This way, packets addressed to Hosts currently not
   connected to the Cellular IP Network do not enter the network and
   load it in vain but are immediately discarded in the Gateway when
   neither Routing, nor Paging Cache mapping is found for the
   destination address.  (It may be advantageous to also generate a
   warning message in this case and send it back to the packet's source
   address.)

3.7. Cellular IP Mobile Host

   While connected to a Cellular IP Network, a Mobile Host must be in



Valko, Campbell, Gomez            Expires May 1999             [Page 15]





INTERNET-DRAFT                Cellular IP               18 November 1998


   one of two states: 'active' or 'idle'.  The Host moves from idle to
   active state when it receives any IP packet.  If it does not receive
   more IP packets, it remains in active state for a time equal to
   active-state-timeout.  Any IP packet received in active state
   restarts the active state timer.  When the timer elapses, the Host
   returns to idle state.

   When the Host moves from idle to active state, it must transmit a
   Route-update packet.  At the same time, a timer is initiated from a
   value equal to route-update-time.  If the timer expires without any
   data packet being transmitted from the Host, again a Route-update
   packet is transmitted and the timer is re-initiated.  Any IP packet
   transmitted before the timer expires, resets the timer to route-
   update-time.  This ensures that while the Mobile Host is in active
   state, the largest interval between two transmitted packets is never
   longer than route-update-time.  The mechanism also ensures that if
   data packets are transmitted with sufficient frequency, no Route-
   update packets will be generated.

   In idle state, the Mobile Host must transmit Paging-update packets
   periodically, at intervals of paging-update-time.  Similarly to the
   Route-update packet timer, the paging-update timer is reset if a data
   packet is transmitted.  (We recall that a transmitted IP packet does
   not make the Mobile Host go to active state.)

   Regardless of which state the Host is in, it must immediately
   transmit an IP packet whenever it connects to a new base station.
   This typically happens at migration, but is also the case after a
   wireless channel black-out or when the Host enters the Cellular IP
   Network.  The packet transmitted this way is a Route-update packet if
   the Host is active and a Paging-update packet if the Host is idle.
   (If the Host has a data packet queued and ready for transmission, it
   can send that packet instead of a control packet.) A packet
   transmitted this way also resets the appropriate control packet
   timer.

Appendix A. Security Issues

   A Cellular IP Network is a single administrative domain.  It is
   connected to the Internet through a Gateway that may eventually also
   serve as a firewall.  Hence security issues only need to be
   considered at the wireless interface.

   The security of a Cellular IP system will be determined by the
   wireless link.  Cellular IP does not assume one specific wireless
   link protocol.  If the wireless link protocol does not include
   encryption, a malicious user can listen to the traffic of other users
   even without being connected to the Cellular IP network.  By
   transmitting packets with a false source address, a host can also
   imitate another host and thus creating false traffic.  These security
   issues appear in all wireless IP systems and are not specific to
   Cellular IP, however, they must also be dealt with in Cellular IP.

   A security problem specific to Cellular IP is that a malicious host,



Valko, Campbell, Gomez            Expires May 1999             [Page 16]





INTERNET-DRAFT                Cellular IP               18 November 1998


   by transmitting packets with a false source address, can redirect
   packets addressed to another user.  In normal circumstances, this
   will not prevent the real addressee from receiving the packet, since
   the malicious host will only add new routing entries but not remove
   existing route entries.  However, this and other attacks will need to
   be addressed in an operational Cellular IP Network.

   The following is a list of possible security protection mechanisms.

      Encrypted wireless link.
         This is probably the only strategy that can give full
         protection.  For high security, the encryption code must be
         user-specific.  The code can be agreed upon when the Mobile
         Host enters the network.  This, however, allows malicious hosts
         to listen to the code decision procedure.  To prevent this, the
         Gateway can obtain the code (or part of it) from the Mobile
         Host's home agent.

      Authentication
         The Mobile Host can be required to provide authentication
         information upon entering the Cellular IP Network.  If it has
         no security binding with the network, the Gateway will use the
         Mobile Host's home agent to check the validity of the
         authentication.

      Packet filtering in Gateway
         To ensure that Mobile Hosts that have not registered
         successfully can not use the Cellular IP Network, the Gateway
         can filter regular data packets and discard those that do not
         belong to an authorized user.

Appendix B. Network Planning and Performance

   To adapt the system to actual traffic and mobility characteristics,
   the operator of a Cellular IP Cellular IP Network can set the
   following system parameters:

      route-timeout
         Will typically be a small multiple of the route-update-time.

      route-update-time
         Will typically be on the packet time scale.  Higher values
         would result in less frequent Route-update packet
         transmissions, but it also increases the route-timeout.  This
         extends the time a route is valid after the Mobile Host moves
         away and hence increases network load.

      paging-timeout
         Will typically be a small multiple of the paging-update-time.

      paging-update-time
         Will typically be on the host mobility time scale.  Higher
         values would result in less frequent Paging-update packets, but
         it also increases the paging-timeout.  This extends the time



Valko, Campbell, Gomez            Expires May 1999             [Page 17]





INTERNET-DRAFT                Cellular IP               18 November 1998


         Paging Cache mappings associated with the old location remain
         valid after the Mobile Host moves away and hence increases the
         cost of paging.

      active-state-timeout
         The value should be such that short pauses between bursts do
         not cause the Mobile Host to go idle.  Too high a value would
         result in transmitting Route-update packets in vain for a long
         time.

      Paging Cache population
         Paging Caches need not be maintained in all nodes.  The
         operator is free to select the nodes that maintain Paging
         Caches and will typically select nodes with many downlink I/Fs.

Appendix C. Multiple Gateway Systems

   Cellular IP requires that a Mobile Host be using exactly one Gateway
   at a time.  This requirement comes from the fact that the Gateway
   serves as the Mobile Host's Foreign Agent and it relays its packets
   both up and downlink.  It is also required to make uplink routing
   unambiguous.  The Cellular IP Network can have multiple Gateways as
   long as a single Host still uses just one Gateway at any time.  (The
   Host can change Gateway, involving a Mobile IP location updating.)
   In a Network with multiple Gateways, Nodes must be able to determine
   which Gateway a given Mobile Host is using.  Assignment of Gateways
   can, for instance, be based on geographical partitioning of the
   network, or on partitioning the Mobile Hosts' address space.  This
   issue is for further study.

Appendix D. Charging

   Cellular IP Network providers can charge Cellular IP Mobile users for
   connectivity or for transmitted data or both.  Charging information
   is best collected in the Gateway.  The Gateway receives all control
   packets and can determine the time a Mobile Host was connected to the
   network.  It can also measure through traffic in both directions.

Appendix E. Uplink I/F Selection

   This algorithm selects Uplink I/Fs in all Nodes of a Cellular IP
   Network and reconfigures them if necessary after a change of
   topology.

      The Gateway periodically creates a control packet called a
      "Gateway broadcast packet".  The Gateway broadcast packet contains
      a sequence number increased each time by the Gateway.  The Gateway
      transmits the packet through all of its interfaces except those
      connected to the Internet.  A Cellular IP Node receiving a Gateway
      broadcast packet sets as Uplink I/F the interface through which
      the packet arrived and denotes all other interfaces as Downlink
      I/Fs, including the air interface if there is one.  The Node
      stores the sequence number of the Gateway broadcast packet.  After
      a short random delay, the Node forwards the packet through all of



Valko, Campbell, Gomez            Expires May 1999             [Page 18]





INTERNET-DRAFT                Cellular IP               18 November 1998


      its Downlink I/Fs, except the air interface.  The Node ignores
      further Gateway broadcast packets with the same sequence number,
      but repeats the procedure if one arrives with a higher sequence
      number.

References

   [1] "IP Mobility Support," C. Perkins, ed., IETF RFC 2002, October
   1996.

Authors' Addresses

   Andras G. Valko
   Ericsson Traffic Analysis and Network Performance Laboratory
   Center for Telecommunications Research, Columbia University
   H-1300 Bp.3.P.O.Box 197, Hungary
   phone: +36 1 437 7774
   fax  : +36 1 437 7219
   email: andras.valko@lt.eth.ericsson.se, andras@comet.columbia.edu

   Andrew T. Campbell, Javier Gomez
   Department of Electrical Engineering, Columbia University
   Rm. 801 Schapiro Research Building
   530 W. 120th Street, New York, N.Y. 10027
   phone: (212) 854 3109
   fax  : (212) 316 9068
   email: [campbell,javierg]@comet.columbia.edu






























Valko, Campbell, Gomez            Expires May 1999             [Page 19]


