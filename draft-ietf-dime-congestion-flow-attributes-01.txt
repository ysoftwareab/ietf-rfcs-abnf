 



Diameter Maintenance and Extensions (DIME)                      L. Bertz
Internet-Draft                                                S. Manning
Intended Status: Proposed Standard                                Sprint
Expires: April 30, 2014                                     B. Hirschman
                                                            October 2014


               Diameter Congestion and Filter Attributes
           draft-ietf-dime-congestion-flow-attributes-01.txt

Abstract

   This document defines optional ECN and filter related attributes that
   can be used for improved traffic identification, support of ECN and
   minimized filter administration within Diameter.

   RFC 5777 defines a Filter-Rule AVP that accommodates extensions for
   classification, conditions and actions. It does not support traffic
   identification for packets using Explicit Congestion Notification as
   defined in RFC 3168 and does not provide specific actions when the
   flow(s) described by the Filter-Rule are congested.

   A Filter-Rule can describe multiple flows but not the exact number of
   flows. Flow count and other associated data (e.g. packets) is not
   captured in Accounting applications, leaving administrators without
   useful information regarding the effectiveness or understanding of
   the filter definition.

   These optional attributes are forward and backwards compatible with
   RFC 5777.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on February 14, 2014.

 


Bertz, et al.            Expires April 17, 2014                 [Page 1]

Internet-Draft      Congestion and Filter Attributes        October 2014


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.


































 


Bertz, et al.            Expires April 17, 2014                 [Page 2]

Internet-Draft      Congestion and Filter Attributes        October 2014


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  4
   2.  Terminology and Abbreviations  . . . . . . . . . . . . . . . .  4
   3.  ECN-IP-Codepoint, Congestion-Treatment and Filter Attributes .  4
     3.1.  ECN-IP-Codepoint AVP . . . . . . . . . . . . . . . . . . .  4
     3.2.  Congestion-Treatment AVP . . . . . . . . . . . . . . . . .  5
     3.3.  Flow-Count AVP . . . . . . . . . . . . . . . . . . . . . .  5
     3.4.  Packet-Count AVP . . . . . . . . . . . . . . . . . . . . .  5
   4.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  6
     4.1.  AVP Codes  . . . . . . . . . . . . . . . . . . . . . . . .  6
   5.  Examples . . . . . . . . . . . . . . . . . . . . . . . . . . .  6
     5.1. Classifier Example  . . . . . . . . . . . . . . . . . . . .  6
     5.2. Diameter Credit Control (CC) with Congestion Information  .  7
   6.  Security Considerations  . . . . . . . . . . . . . . . . . . .  8
   7.  Acknowledgements . . . . . . . . . . . . . . . . . . . . . . .  8
   8.  References . . . . . . . . . . . . . . . . . . . . . . . . . .  8
     8.1.  Normative References . . . . . . . . . . . . . . . . . . .  8
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . .  9





























 


Bertz, et al.            Expires April 17, 2014                 [Page 3]

Internet-Draft      Congestion and Filter Attributes        October 2014


1.  Introduction

   Two optional Explicit Congestion Notification (ECN) [RFC3168] related
   AVPs are specified in the document.  The first AVP provides direct
   support for ECN [RFC3168] in the IP header and the second AVP
   provides the ability to define alternate traffic treatment when
   congestion is experienced.

   This document also defines two optional AVPs, Flow-Count and Packet-
   Count, used for conveying flow information within the Diameter
   protocol [RFC6733].  These AVPs were found to be useful for a wide
   range of applications.  The AVPs provide a way to convey information
   of the group of flows described by the Filter-Rule, IPFilterRule or
   other Diameter traffic filters.

   The semantics and encoding of all AVPs can be found in Section 3.

   Such AVPs are, for example, needed by some ECN applications to
   determine the number of flows congested or used by administrators to
   determine the impact of filter definitions.

   Additional parameters may be defined in future documents as the need
   arises.  All parameters are defined as Diameter-encoded Attribute
   Value Pairs (AVPs), which are described using a modified version of
   the Augmented Backus-Naur Form (ABNF), see [RFC6733].  The data types
   are also taken from [RFC6733].

2.  Terminology and Abbreviations

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC2119 [RFC2119].

3.  ECN-IP-Codepoint, Congestion-Treatment and Filter Attributes

3.1.  ECN-IP-Codepoint AVP

   The ECN-IP-Codepoint AVP (AVP Code TBD) is of type Enumerated and
   specifies the Explicit Congestion Notification codepoint values to
   match in the IP header.

   Value | Binary | Keyword                            | References
   -----------------------------------------------------------------
   0     | 00     | Non-ECT (Not ECN-Capable Transport)| [RFC3168]
   1     | 01     | ECT(1) (ECN-Capable Transport)     | [RFC3168]
   2     | 10     | ECT(0) (ECN-Capable Transport)     | [RFC3168]
   3     | 11     | CE (Congestion Experienced)        | [RFC3168]

 


Bertz, et al.            Expires April 17, 2014                 [Page 4]

Internet-Draft      Congestion and Filter Attributes        October 2014


   When this AVP is used for classification in the Filter-Rule it MUST
   be part of Classifier Grouped AVP as defined in RFC5777.

3.2.  Congestion-Treatment AVP

   The Congestion-Treatment AVP (AVP Code TBD) is of type Grouped and
   indicates how congested traffic, i.e., traffic that has Explicit
   Congestion Notification Congestion Experienced marking set or some
   other administratively defined criteria, is treated.  In case the
   Congestion-Treatment AVP is absent the treatment of the congested
   traffic is left to the discretion of the node performing QoS
   treatment.

               Congestion-Treatment ::= < AVP Header: TBD >
                           { Treatment-Action }
                           [ QoS-Profile-Template ]
                           [ QoS-Parameters ]
                         * [ AVP ]

   Treatment-Action, QoS-Profile-Template and QoS-Parameters are defined
   in [RFC5777].  The Congestion-Treatment AVP is an action and MUST be
   an attribute of the Filter-Rule Grouped AVP as defined in RFC5777.

3.3.  Flow-Count AVP

   The Flow-Count AVP (AVP Code TBD) is of type Unsigned64.

   It indicates the number of protocol specific flows.  The protocol is
   determined by the filter (e.g. IPFilterRule, Filter-Id, etc.).

3.4.  Packet-Count AVP

   The Packet-Count AVP (AVP Code TBD) is of type Unsigned64.

   It indicates the number of protocol specific packets.  The protocol
   is determined by the filter (e.g. IPFilterRule, Filter-Id, etc.).  












 


Bertz, et al.            Expires April 17, 2014                 [Page 5]

Internet-Draft      Congestion and Filter Attributes        October 2014


4.  IANA Considerations

4.1.  AVP Codes

   IANA allocated AVP codes in the IANA-controlled namespace registry
   specified in Section 11.1.1 of [RFC6733] for the following AVPs that
   are defined in this document.

   +----------------------------------------------------------------+
   |                                       AVP  Section             |
   |AVP                                    Code Defined Data Type   |
   +----------------------------------------------------------------+
   |ECN-IP-Codepoint                      TBD 3.1     Enumerated    |
   |Congestion-Treatment                  TBD 3.2     Grouped       |
   |Flow-Count                            TBD 3.3     Unsigned64    |
   |Packet-Count                          TBD 3.4     Unsinged64    |
   +----------------------------------------------------------------+

5.  Examples

   The following examples illustrate the use of the AVPs defined in this
   draft.

5.1. Classifier Example

   The Classifier AVP (AVP Code 511) specified in RFC 5777 is a grouped
   AVP that consists of a set of attributes that specify how to match a
   packet.  The addition of the ECN-IP-Codepoint is shown here.

      Classifier ::= < AVP Header: 511 >
                     { Classifier-ID }
                     [ Protocol ]
                     [ Direction ]
                     [ ECP-IP-Codepoint ]
                   * [ From-Spec ]
                   * [ To-Spec ]
                   * [ Diffserv-Code-Point ]
                     [ Fragmentation-Flag ]
                   * [ IP-Option ]
                   * [ TCP-Option ]
                     [ TCP-Flags ]
                   * [ ICMP-Type ]
                   * [ ETH-Option ]
                   * [ AVP ]

   Setting the ECP-IP-Codepoint value to 'CE' would permit the capture
   of CE flags in the Flow. 

 


Bertz, et al.            Expires April 17, 2014                 [Page 6]

Internet-Draft      Congestion and Filter Attributes        October 2014


   Another Classifier with the ECP-IP-Codepoint value of 'ECT' could be
   specified and, when coupled with the Flow-Count AVP, reports the
   number of ECT capable flows.   

5.2. Diameter Credit Control (CC) with Congestion Information

   Diameter nodes using Charge Control can use the Congestion-Treatment
   AVP to trigger specific actions when congestion occurs.  This is
   similar to the Excess-Treatment Action.  The ability to detect when
   congestion occurs is specific to the AVPs in the Filter-Rule and
   Diameter Client and is no different than how 'Excess' can be
   determined for Excess-Treatment. If Excess-Treatment or Congestion-
   Treatment has occurred Diameter Clients may autonomously send CCRs
   during the Service Delivery session as interim events.  This is shown
   in Figure 1.


                              Service Element
        End User            (CC Client)                        CC Server
           |                     |                                  |
           |(1) Service Request  |                                  |
           |-------------------->|                                  |
           |                     |(2) CCR (Initial,                 |
           |                     |    QoS-Resources(QoS-Desired))   |
           |                     |--------------------------------->|
           |                     |(3) CCA (Granted-Units,           |
           |                     |    QoS-Resources(QoS-Authorized))|
           |                     |<---------------------------------|
           |(4) Service Delivery |                                  |
           |<------------------->|                                  |
           |              (5) Congestion Detected                   |
           |              (6) Congestion Treatment Occurs           |
           |                     |(7) CCR (Termination, Used-Units, |
           |                     |    Flow-Count, Packet-Count,     |
           |                     |    QoS-Resources(QoS-Delivered)) |
           |                     |--------------------------------->|
           |                     |(8) CCA                           |
           |                     |<-------------------------------->|
           |                     |                                  |
           |                     |                                  |
           |(9) End of Service   |                                  |
           |-------------------->|                                  |
           |                     |(10)CCR (Termination, Used-Units, |
           |                     |    Flow-Count, Packet-Count,     |
           |                     |    QoS-Resources(QoS-Delivered)) |
           |                     |--------------------------------->|
           |                     |(11) CCA                          |
           |                     |<---------------------------------|
 


Bertz, et al.            Expires April 17, 2014                 [Page 7]

Internet-Draft      Congestion and Filter Attributes        October 2014


   Figure 1: Example of a Diameter Credit Control with Congestion
   Information

   The 'Used-Service-Units' described in RFC5777 examples is customarily
   a Service-Units, Time-Units or Byte-Count AVP.  This is insufficient
   to represent network state and does not differentiate between
   throughput and good-put (good or quality throughput) even though the
   filters may imply good or poor throughput. 

   Flow-Count and Packet-Count AVPs defined in this document could be
   sent with a CCR when the triggering event is related to Congestion-
   Treatment.  This provides the CC Server with a better view of the
   type of congested traffic for improved decision making and Charging. 
   Sending such AVPs under any condition permits rudimentary traffic
   profiling regardless of network conditions.  For instance, low byte
   per packet counts is indicative of web traffic and high byte counts
   per packet with a small number of flows may be indicative of video
   traffic.  Enriched reporting described here provides relief from Deep
   Packet Inspection load and loss of information as traffic becomes
   increasingly encrypted. 

   Some services, e.g. Streaming Services, limit the number of flows,
   Flow-Count, as opposed to other Units, i.e. Byte-Count.  In such a
   case the Flow-Count AVP may be used in place of Service-Units.

6.  Security Considerations

   The document does not raise any new security concerns.  This document
   describes an extension of RFC5777 that introduces a new filter
   parameter applied to ECN as defined by [RFC3168].  It also defines a
   new Grouped AVP that expresses what action to take should congestion
   be detected.  The Grouped AVP reuses attributes defined in RFC5777.

   The security considerations of the Diameter protocol itself have been
   discussed in RFC 6733 [RFC6733].  Use of the AVPs defined in this
   document MUST take into consideration the security issues and
   requirements of the Diameter base protocol.

7.  Acknowledgements

   We would like to thank Avi Lior for his guidance and feedback during
   the development of this specification.

8.  References
8.1.  Normative References

   [RFC2119] Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.
 


Bertz, et al.            Expires April 17, 2014                 [Page 8]

Internet-Draft      Congestion and Filter Attributes        October 2014


   [RFC3168]  Black, D., Floyd, S., and K. Ramakrishnan, "The Addition
              of Explicit Congestion Notification (ECN) to IP", RFC
              3168, September 2001.

   [RFC6733]  Fajardo, V., Arkko, J., Loughney, J., and G. Zorn,
              "Diameter Base Protocol", RFC 6733, October 2012.

   [RFC5777]  Korhonen, J., Tschofenig, H., Arumaithurai, M., Lior, A.
              and Jones, M. Ed., "Traffic Classification and Quality of
              Service (QoS) Attributes for Diameter", RFC 5777, February
              2010.

Authors' Addresses


              Lyle Bertz
              Sprint
              6220 Sprint Parkway
              Overland Park, KS 66251
              United States

              EMail: lyleb551144@gmail.com

              Serge Manning
              Sprint
              6220 Sprint Parkway
              Overland Park, KS 66251
              United States

              EMail: sergem913@gmail.com

              Brent Hirschman

              EMail: Brent.Hirschman@gmail.com

















Bertz, et al.            Expires April 17, 2014                 [Page 9]
