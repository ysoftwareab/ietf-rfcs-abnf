<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Feature Referral in the Session
    Initiation Protocol (SIP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Feature Referral in the Session
    Initiation Protocol (SIP)">
<meta name="keywords" content="I-D, Internet-Draft, SIP, feature referral">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIPPING WG</td><td class="header">F. Audet</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Nortel</td></tr>
<tr><td class="header">Intended status: BCP</td><td class="header">A. Johnston</td></tr>
<tr><td class="header">Expires: August 20, 2008</td><td class="header">Avaya</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">R. Mahy</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Plantronics</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Jennings</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 17, 2008</td></tr>
</table></td></tr></table>
<h1><br />Feature Referral in the Session
    Initiation Protocol (SIP)<br />draft-audet-sipping-feature-ref-00</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 20, 2008.</p>

<h3>Abstract</h3>

<p>Feature referral allows for an application to make a high level
      request to a User Agent to perform an action or "feature", and let the
      the User Agent actually execute the feature as it sees fit. Feature
      referral uses the SIP REFER method with a Refer-To header field
      containing a URN.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Terminology<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
<a href="#overview">3.</a>&nbsp;
Overview<br />
<a href="#anchor3">4.</a>&nbsp;
User Agent Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.1.</a>&nbsp;
Dialog usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.2.</a>&nbsp;
Addressing the relevant parties<br />
<a href="#anchor6">5.</a>&nbsp;
Call flows<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.1.</a>&nbsp;
Answer Call Operation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.2.</a>&nbsp;
Clear Connection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.3.</a>&nbsp;
Deflect Call<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.4.</a>&nbsp;
Hold Call<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.5.</a>&nbsp;
Retrieve Call<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.6.</a>&nbsp;
Single Step Transfer Call Flow Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.7.</a>&nbsp;
Conference Calls<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.8.</a>&nbsp;
Seperate Calls<br />
<a href="#anchor15">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor16">7.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor17">8.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informational References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>To simplify discussions of the REFER method and its extensions, the
      three terms below are being used throughout the document:
</p>
<p>
				</p>
<ul class="text">
<li>REFER-Issuer: the UA issuing the REFER request
</li>
<li>REFER-Recipient: the UA receiving the REFER request
</li>
<li>REFER-Target: the UA designated in the Refer-To Uniform Resource
          Identifier (URI), which, for this specification, is a Uniform
          Resource Name (URN)
</li>
</ul><p>
			
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>Feature referral allows for an application (such as a proxy or a user
      agent) to make a high level request to a SIP <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> User Agent (UA) to perform an action or
      "feature", and let the the User Agent actually execute the feature as it
      sees fit. Feature referral uses the SIP REFER method <a class='info' href='#RFC3515'>[RFC3515]<span> (</span><span class='info'>Sparks, R., &ldquo;The Session Initiation Protocol (SIP) Refer Method,&rdquo; April&nbsp;2003.</span><span>)</span></a> with a Refer-To header field containing a URN
      <a class='info' href='#RFC2141'>[RFC2141]<span> (</span><span class='info'>Moats, R., &ldquo;URN Syntax,&rdquo; May&nbsp;1997.</span><span>)</span></a>.
</p>
<p>Feature referral is useful for collections of loosely coupled User
      Agents which would like to present a coordinated user experience (i.e.,
      when the Application is co-resident in the UA). Among other things, this
      allows User Agents which handle orthogonal media types but which would
      like to be present in a single conversation to add and remove each other
      from the conversation as needed. This is especially appropriate when
      coordinating conversations among organizers, general purpose computers,
      and special purpose communications appliances like telephones, Internet
      televisions, in-room video systems, electronic whiteboards, and gaming
      devices. For example using feature referral, an Instant Messaging client
      could initiate a multiplayer gaming session and an audio session to a
      chat conversation. Likewise a telephone could add an electronic
      whiteboard session to a voice conversation. Finally, a computer or
      organizer could cause a nearby phone to dial from numbers or URIs in a
      document, email, or address book; allow users to answer or deflect
      incoming calls without removing hands from the computer keyboard; place
      calls on hold; and join other sessions on the phone or otherwise.
</p>
<p>Feature referral is also useful for a wide range of third party
      applications that need to remotely control or influence a User Agent
      (for example, in Contact center environment). In pre-SIP environments,
      these environments have been using "Computer Telephony Integration": for
      example, traditional PBXs use CTI protocols such as CSTA <a class='info' href='#ECMA269'>[ECMA269]<span> (</span><span class='info'>ECMA International, &ldquo;Services for Computer Suported Telecommunications           Communications Applications (CSTA) Phase III,&rdquo; December&nbsp;2006.</span><span>)</span></a> to provide this functionality. CSTA works fine
      for legacy PBXs with legacy phones but is problematic in a SIP
      environment. For example, SIP includes totally new capabilities such as
      presence and instant messaging. SIP also supports multiple users with
      multiple devices operating at once, and with complex User Interfaces.
      Furthermore, multiple applications may want to simultaneously wish to
      interact with the device. Because of the lack of a native mechanism
      mechanism to achieve such control for SIP, implementors have had to
      implement such techniques as mapping CSTA's ASN.1 encoding to XML then
      encapsulate it into SIP INFO requests in order to tunnel it to a SIP
      B2BUA <a class='info' href='#ECMA323'>[ECMA323]<span> (</span><span class='info'>ECMA International, &ldquo;XML Protocol for Computer Supported Telecommunications           Applications (CSTA) Phase III,&rdquo; December&nbsp;2006.</span><span>)</span></a>, which then maps it to proprietary
      device control protocols or to SIP with proprietary and incompatible
      extensions. This document provides a clean and native way to meet the
      requirements.
</p>
<p>CTI fundamentally requires two components:
</p>
<p>
				</p>
<ul class="text">
<li>Monitoring - to learn the state of the UA
</li>
<li>Control - request the UA to perform certain features
</li>
</ul><p>
			
</p>
<p>SIP already provides some capabilities for monitoring, including the
      following:
</p>
<p>
				</p>
<ul class="text">
<li>Dialog package - call states
</li>
<li>Registration package - phone status
</li>
<li>Conference package - conference status
</li>
</ul><p>
			
</p>
<p>SIP also provide a method for requesting UAs do perform certain task,
      i.e., REFER <a class='info' href='#RFC3515'>[RFC3515]<span> (</span><span class='info'>Sparks, R., &ldquo;The Session Initiation Protocol (SIP) Refer Method,&rdquo; April&nbsp;2003.</span><span>)</span></a>, but today is it limited.
      Specically:
</p>
<p>
				</p>
<ul class="text">
<li>REFER does not allow for a UA to request another UA to respond to
          requests, e.g., 
<ul class="text">
<li>A UA cannot request another UA to answer a call
</li>
<li>A UA cannot request another UA to reject a call
</li>
</ul>
					
</li>
<li>REFER does not allow for a UA to reques another UA to invoke
          features, e.g.,
<ul class="text">
<li>REFER does not allow for a UA to request another UA to place
              a call on hold, or to mute it
</li>
<li>REFER does not allow for a UA to request another UA to
              transfer, conference, or park a call
</li>
</ul>
					
</li>
</ul><p>
			
</p>
<p>Feature referral is consistent with the SIP call control framework
      <a class='info' href='#I-D.ietf-sipping-cc-framework'>[I&#8209;D.ietf&#8209;sipping&#8209;cc&#8209;framework]<span> (</span><span class='info'>Mahy, R., Sparks, R., Rosenberg, J., Petrie, D., and A. Johnston, &ldquo;A Call Control and Multi-party usage framework for the Session Initiation Protocol (SIP),&rdquo; December&nbsp;2009.</span><span>)</span></a> and is a natural
      expansion of the Application Interaction Framework <a class='info' href='#I-D.ietf-sipping-app-interaction-framework'>[I&#8209;D.ietf&#8209;sipping&#8209;app&#8209;interaction&#8209;framework]<span> (</span><span class='info'>Rosenberg, J., &ldquo;A Framework for Application Interaction in the Session Initiation Protocol  (SIP),&rdquo; July&nbsp;2005.</span><span>)</span></a> which allows
      for referral to SIP resources (through the SIP URI scheme) and Web pages
      (through the HTTP URI scheme).
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Overview</h3>

<p>A prototypical feature referal flow looks as per section 4.1 of <a class='info' href='#RFC3515'>[RFC3515]<span> (</span><span class='info'>Sparks, R., &ldquo;The Session Initiation Protocol (SIP) Refer Method,&rdquo; April&nbsp;2003.</span><span>)</span></a>. The Refer-To URI in the REFER message includes
      a URN describing the feature. The first part of the URN, i.e., the
      Namespace Identifier, is indended to be in the formal space and assigned
      by IANA, as per the procedures of <a class='info' href='#RFC3406'>[RFC3406]<span> (</span><span class='info'>Daigle, L., van Gulik, D., Iannella, R., and P. Faltstrom, &ldquo;Uniform Resource Names (URN) Namespace Definition Mechanisms,&rdquo; October&nbsp;2002.</span><span>)</span></a>. An
      alternative would be to use the service URN space <a class='info' href='#RFC5031'>[RFC5031]<span> (</span><span class='info'>Schulzrinne, H., &ldquo;A Uniform Resource Name (URN) for Emergency and Other Well-Known Services,&rdquo; January&nbsp;2008.</span><span>)</span></a>. Until this is resolved, this document will use
      the following namespace: "feature". The second part of the URN includes
      the feature name, and may be followed by a semi-colon and additional
      feature-specific parameters.
</p>
<p>Feature referral are sent to a GRUU when a specific instance of a UA
      is the desired target. When the feature referral needs to be correlated
      to a specific dialog, the Target-Dialog header field is used <a class='info' href='#RFC4538'>[RFC4538]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Request Authorization through Dialog Identification in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2006.</span><span>)</span></a>. Some primitives require a second dialog
      identifier (such as ConferenceCalls which causes the media from two
      dialogs to be mixed). The mechanism to convey this second dialog
      identifier is TBD.
</p>
<p>The following is a list of sample features (using the CSTA TR/87
      <a class='info' href='#TR87'>[TR87]<span> (</span><span class='info'>ECMA International, &ldquo;Using CSTA for SIP Phone User Agents (uaCSTA),&rdquo; June&nbsp;2004.</span><span>)</span></a> minimal profile as a starting point):
</p>
<p>
				</p>
<ul class="text">
<li>Answer call - urn:feature:AnswerCall
</li>
<li>Clear connection - urn:feature:ClearConnection
</li>
<li>Deflect call - urn:feature:DeflectCall
</li>
<li>Hold call - urn:feature:HoldCall
</li>
<li>Retrieve call - urn:feature:RetrieveCall
</li>
<li>Single step transfer -urn:feature:SingleStepTransfer
</li>
<li>Conference calls - urn:feature:ConferenceCalls
</li>
<li>Separate calls - urn:feature:SeparateCalls
</li>
</ul><p>
			
</p>
<p>Note that the very important "Make call" CTI primitive does not
      require a feature referral URN since it is accomplished by sending a
      normal REFER with a URI identifying the resource (e.g., a sip, sips or
      tel URI).
</p>
<p>Of course, other features could also be added, beyond the realm of
      traditional telephony, e.g.:
</p>
<p>
				</p>
<ul class="text">
<li>Add buddy to list - urn:feature:AddBuddy;sip@bob@example.com
</li>
<li>Send vCard - urn:feature:SendVCard
</li>
</ul><p>
			
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
User Agent Behavior</h3>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Dialog usage</h3>

<p>This document attempts to avoid using multiple dialog usages, for
        the reasons described in <a class='info' href='#RFC5057'>[RFC5057]<span> (</span><span class='info'>Sparks, R., &ldquo;Multiple Dialog Usages in the Session Initiation Protocol,&rdquo; November&nbsp;2007.</span><span>)</span></a>. Therefore,
        this document will make use of the GRUU <a class='info' href='#I-D.ietf-sip-gruu'>[I&#8209;D.ietf&#8209;sip&#8209;gruu]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Obtaining and Using Globally Routable User Agent (UA) URIs (GRUU) in the  Session Initiation Protocol (SIP),&rdquo; October&nbsp;2007.</span><span>)</span></a>, and the Target-Dialog header field
        <a class='info' href='#RFC4538'>[RFC4538]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Request Authorization through Dialog Identification in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2006.</span><span>)</span></a> to associated and existing INVITE usage
        with a REFER arriving on a new dialog to facilitate authorization of
        that REFER.
</p>
<p>In many use cases of feature referral, receiving notifications
        about the status of a REFER request are superfluous, as the Refer
        issuer often maintains a long duration subscription to the dialog
        package <a class='info' href='#RFC4235'>[RFC4235]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., and R. Mahy, &ldquo;An INVITE-Initiated Dialog Event Package for the Session Initiation Protocol (SIP),&rdquo; November&nbsp;2005.</span><span>)</span></a>. Suppression of the REFER
        notifications is done with the norefersub option-tag, defined in
        section 7 of <a class='info' href='#RFC4488'>[RFC4488]<span> (</span><span class='info'>Levin, O., &ldquo;Suppression of Session Initiation Protocol (SIP) REFER Method Implicit Subscription,&rdquo; May&nbsp;2006.</span><span>)</span></a>. When the norefersub
        option tag is present, a REFER request which would have created a new
        subscription and dialog becomes a standalone transaction instead,
        eliminating a multiple dialog usage. Each such standalone REFER
        transaction use a new (unique) Call-ID header field value.
</p>
<p>In the most common usage, the controller maintains a long duration
        subscription to the dialog package, and sends REFER requests in
        seperate dialogs Each REFER would include the norefersub option-tag in
        a Supported header field.
</p>
<p>In some cases, the controller does not maintain a dialog package
        subscription for the Refer-Receiver. This might be the case for a
        "webdialer" or other application which associates with other UAs on an
        adhoc and intermitent basis. An initial REFER request is sent to start
        a new dialog, which is followed by notifications for the refer event
        type (the norefersub option-tag is not used in this case).
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Addressing the relevant parties</h3>

<p>REFER requests contain a number of URIs which need to address the
        appropriate parties. A list of the relevant fields include the
        Request-URI, To URI, From URI, Contact URI, Refer-To URI, and the
        Referred-By URI, as well as the Target-Dialog itself. This section
        attempts to clarify what needs to be placed in each field.
</p>
<p>In most cases, feature referral applies to dialogs or sessions on a
        specific UA, in which case a GRUU <a class='info' href='#I-D.ietf-sip-gruu'>[I&#8209;D.ietf&#8209;sip&#8209;gruu]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Obtaining and Using Globally Routable User Agent (UA) URIs (GRUU) in the  Session Initiation Protocol (SIP),&rdquo; October&nbsp;2007.</span><span>)</span></a> for a single UA (i.e., Contact URI)
        is used. Contact URIs for a UA can be discovered by subscribing to the
        registration package <a class='info' href='#RFC3680'>[RFC3680]<span> (</span><span class='info'>Rosenberg, J., &ldquo;A Session Initiation Protocol (SIP) Event Package for Registrations,&rdquo; March&nbsp;2004.</span><span>)</span></a> for the relevant
        AORs.
</p>
<p>In the cases where the controller does not care which specific UA
        it manipulates, an AOR can be used instead. When an AOR is used, the
        REFER request can include appropriate caller-preferences to encourage
        selection of an appropriate Contact. The norefersub option-tag is not
        used when the REFER Request-URI is an AOR, as the REFER Request could
        fork and cause very odd behavior. While, the controller can discourage
        a proxy from forking remote call control request by using the
        Request-Disposition: no-fork header field, insuring that no proxy
        forks requires the use of the callerpref option-tag in a Proxy-Require
        header field value. Use of Proxy-Require is not normally advised
        because any proxy in the chain of this request which did not support
        caller preferences would cause the request to fail.
</p>
<p>The To header field in the REFER request normally contains the same
        URI as in the Request-URI. The From identifies the AOR of the
        controller. The Refer-To URI is the feature referral URN.
</p>
<p>Many uses of feature referral require that the Refer-Receiver take
        some action in the context of an existing dialog. For example, the
        controller might want the Refer-Receiver to send terminate an existing
        dialog. To select the appropriate dialog from which to source the
        request, the Target-Dialog header specified in <a class='info' href='#RFC4538'>[RFC4538]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Request Authorization through Dialog Identification in the Session Initiation Protocol (SIP),&rdquo; June&nbsp;2006.</span><span>)</span></a> is used.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Call flows</h3>

<p>This sample provides non-normative sample calls flows for the
      features listed in <a class='info' href='#overview'>Section&nbsp;3<span> (</span><span class='info'>Overview</span><span>)</span></a>. It is important to
      understand that the actual "realization" of the feature (i.e., the
      actual procedures invoked) are the sole responsibility of the
      Refer-Recipient. This document in no way attempts to standardize those
      procedures, and the call flow below are merely examples.
</p>
<p>In all cases, the "controller" (i.e., the Refer-Issuer) could be
      Alice's PC, PDA, or a third party application. The controlled device is
      Alice's phone (i.e., the Refer-Recipient). The Refer-Target is obviously
      the feature referral URN. In all cases, it is assumed that the
      controller is subscribed to Alice's Phone's dialog package.
</p>
<p>The call flows in this document use the following conventions. The
      dialog each message is sent in is shown on the left hand side. Selected
      Request-URI and header fields are shown. The contents of message bodies
      are shown for dialog-info+xml, sdp, and sipfrag message bodies. For
      responses, the method is shown in parentheses. For reference, the
      messages are labeled F1, F2, etc.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Answer Call Operation</h3>

<p>In message 1, Bob makes a call to Alice's Phone. A notification of
        "trying" is sent to the controller. Alice's phone automatically sends
        a "ringing" to Bob. Another notification of "early" is then sent to
        the controller. The controller then tells the phone to answer the
        call. Alice's phone sends a notification of "confirmed" to the
        controller.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Controller                       Alice                        Bob
        |&lt;&lt;&lt; Controller subscribed  &gt;&gt;&gt;|                            |
        |&lt;&lt; to Alice's dialog events &gt;&gt;|                            |
dialog1 |                              | F1  INVITE sip:Alice-AOR   |
        |                              |&lt;---------------------------|
dialog2 | F2 NOTIFY sip:Controller-GRUU|                            |
        |    dialog-info+xml: dialog1=trying                        |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F3  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
dialog1 |                              | F4  180 (INVITE)           |
        |                              |---------------------------&gt;|
dialog2 | F5 NOTIFY sip:Controller-GRUU|                            |
        |    dialog-info+xml: dialog1=early                         |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F6  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F7  REFER sip:Alice-GRUU     |                            |
        |     To: sip:Alice-GRUU       |                            |
        |     Refer-To: urn:feature:AnswerCall                      |
        |     Target-Dialog: dialog1   |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F8  202 (REFER)              |                            |
        |&lt;-----------------------------|                            |
dialog1 |                              | F9  200 (INVITE)           |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 |                              |     F10 ACK                |
        |                              |&lt;---------------------------|
dialog2 | F11 NOTIFY sip:Controller-GRUU                            |
        |     dialog-info+xml: dialog1=confirmed                    |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F12 200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Answer Call Flow Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Clear Connection</h3>

<p>Clear Connection is a perfect example of a feature whose treatment
        (and consequently, the resulting call flow) depends on the situation,
        for example, the state of the dialog between the remote parties.
</p>
<p>Alice's Phone and Bob are currently in an established dialog. The
        controller tells Alice's phone to "clear the connection" with Bob's
        phone.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Controller                    Alice                           Bob
        |&lt;&lt; Controller subscribed to &gt;&gt;|&lt;&lt;&lt; Established dialog1 &gt;&gt;&gt;&gt;|
        |&lt;&lt;&lt; Alice's dialog events &gt;&gt;&gt;&gt;|                            |
        |                              |                            |
dialog3 | F1  REFER sip:Alice-GRUU     |                            |
        |     To: sip:Alice-GRUU       |                            |
        |     Refer-To: urn:feature:ClearConnection                 |
        |     Target-Dialog: dialog1   |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F2  202 (REFER)              |                            |
        |&lt;-----------------------------|                            |
dialog1 |                              | F3  BYE sip:Bob-GRUU       |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 |                              | F4  200 (BYE)              |
        |                              |&lt;---------------------------|
        | F5  NOTIFY sip:Controller-GRUU                            |
        |     dialog-info+xml: dialog2=local-bye                    |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F6  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Clear Connection in Established Dialog Call Flow Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>If Alice's Phone and Bob are in an early dialog with Bob calling
        Alice, the call flow could be as follows.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Controller                    Alice                        Bob
        |&lt;&lt; Controller subscribed to &gt;&gt;|                            |
        |&lt;&lt;&lt; Alice's dialog events &gt;&gt;&gt;&gt;|                            |
dialog1 |                              | F1  INVITE sip:Alice-AOR   |
        |     (dialog2)                |&lt;---------------------------|
        |                              |                            |
dialog2 | F2 NOTIFY sip:Controller-GRUU|                            |
        |     dialog-info+xml: dialog1=trying                       |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F3  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
dialog1 |                              | F4  180 (INVITE)           |
        |                              |---------------------------&gt;|
dialog2 | F5 NOTIFY sip:Controller-GRUU|                            |
        |    dialog-info+xml: dialog1=early                         |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F6  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F7  REFER sip:Alice-GRUU     |                            |
        |     To: sip:Alice-GRUU       |                            |
        |     Refer-To: urn:ietf:feature:ClearConnection            |
        |     Target-Dialog: dialog1   |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F8  202 (REFER) (dialog3)    |                            |
        |&lt;-----------------------------|                            |
dialog1 |                              | F9  480 (INVITE)           |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 |                              | F10 ACK                    |
        |                              |&lt;---------------------------|
dialog2 | F11 NOTIFY (Controller-GRUU) |                            |
        |     dialog-info+xml: dialog1=rejected                     |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F12 200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Clear Connection in Early Dialog Call Flow Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>If Alice's Phone and Bob are in an early dialog with Alice calling
        Bob, the call flow could be as follows.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Controller                    Alice                        Bob
        |&lt;&lt; Controller subscribed to &gt;&gt;|                            |
        |&lt;&lt;&lt; Alice's dialog events  &gt;&gt;&gt;|                            |
dialog1 |                              | F1  INVITE sip:Bob-AOR     |
        |                              |---------------------------&gt;|
dialog2 | F2 NOTIFY sip:Controller-GRUU|                            |
        |    dialog-info+xml: dialog1=trying                        |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F3  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
dialog1 |                              | F4  180 (INVITE)           |
        |                              |&lt;---------------------------|
dialog2 | F5 NOTIFY sip:Controller-GRUU|                            |
        |    dialog-info+xml: dialog1=early                         |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F6  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F7  REFER sip:Alice-GRUU     |                            |
        |     To: sip:Alice-GRUU       |                            |
        |     Refer-To: urn:feature:ClearConnection                 |
        |     Target-Dialog: dialog1   |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F8  202 (REFER)              |                            |
        |&lt;-----------------------------|                            |
dialog1 |                              | F9  CANCEL                 |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 |                              | F10 200 (CANCEL)           |
        |                              |&lt;---------------------------|
        |                              |                            |
dialog1 |                              | F11 487 (INVITE)           |
        |                              |&lt;---------------------------|
        |                              |                            |
dialog1 |                              | F12 ACK                    |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 | F13 NOTIFY sip:Controller-GRUU                            |
        |     dialog-info+xml: dialog1=rejected                     |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F14 200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Clear Connection Initiated Call Flow Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Deflect Call</h3>

<p>Bob makes a call to Alice's Phone. A notification of "trying" is
        sent to the controller. Alice's phone automatically sends a "ringing"
        to Bob. Another notification of "early" is then sent to the
        controller. The controller tells the phone to deflect the call to
        Cathy. Alice's phone sends a notification of "terminated" to the
        controller. Bob's will attempt the call to Cathy.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     Controller                      Alice                        Bob
        |&lt;&lt; Controller subscribed to &gt;&gt;|                            |
        |&lt;&lt;&lt; Alice's dialog events &gt;&gt;&gt;&gt;|                            |
dialog1 |                              | F1  INVITE sip:Alice-AOR   |
        |                              |&lt;---------------------------|
dialog2 | F2 NOTIFY sip:Controller-GRUU|                            |
        |    dialog-info+xml: dialog1=trying                        |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F3  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
dialog1 |                              | F4  180 (INVITE)           |
        |                              |---------------------------&gt;|
dialog2 | F5 NOTIFY sip:Controller-GRUU|                            |
        |    dialog-info+xml: dialog1=early                         |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F6  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F7  REFER sip:Alice-GRUU     |                            |
        |     To: sip:Alice-GRUU       |                            |
        |     Refer-To: urn:feature:DeflectCall;target=(Cathy-AOR)  |
        |     Target-Dialog: dialog1   |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F8  202 (REFER)              |                            |
        |&lt;-----------------------------|                            |
dialog1 |                              | F9  302 (INVITE)           |
        |                              |     Contact: sip:Cathy-AOR |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 |                              | F10 ACK                    |
        |                              |&lt;---------------------------|
dialog2 | F11 NOTIFY sip:Controller-GRUU                            |
        |     dialog-info+xml: dialog1=rejected                     |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F12 200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
        |            Cathy                                          |
dialog4 |              | F13 INVITE sip:Cathy-AOR                   |
        |              |&lt;-------------------------------------------|
dialog4 |              | F14 180 (INVITE)                           |
        |              |-------------------------------------------&gt;|
dialog4 |              | F15 200 (INVITE)                           |
        |              |-------------------------------------------&gt;|
dialog4 |              | F16 ACK                                    |
        |              |&lt;-------------------------------------------|
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Deflect Call Flow Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Hold Call</h3>

<p>The controller tells Alice's phone to put on hold the already
        established dialog with Bob. Alice's phone sends a re-INVVITE to Bob's
        contact to put the media stream on hold. Note that a call hold is
        different concept than held media. In fact, a user can be placed on
        hold, and be provided with music on hold. A held call is a logical
        state which could be useful for a number of things such as monitoring
        the amount of time a user stays in a queue.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Controller                    Alice                        Bob
        |&lt;&lt; Controller subscribed to &gt;&gt;|&lt;&lt;&lt;&lt; Established dialog1 &gt;&gt;&gt;|
        |&lt;&lt;&lt; Alice's dialog events &gt;&gt;&gt;&gt;|                            |
        |                              |                            |
dialog3 | F1  REFER sip:Alice-GRUU     |                            |
        |     To: sip:Alice-GRUU       |                            |
        |     Refer-To: urn:feature:HoldCall                        |
        |     Target-Dialog: dialog1   |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F2  202 (REFER)              |                            |
        |&lt;-----------------------------|                            |
dialog1 |                              | F3  re-INVITE sip:Bob-GRUU |
        |                              |     sdp: hold              |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 |                              | F4  200 (re-INVITE)        |
        |                              |&lt;---------------------------|
        |                              |                            |
dialog1 |                              | F5  ACK                    |
        |                              |&lt;---------------------------|
dialog2 | F6 NOTIFY sip:Controller-GRUU|                            |
        |    dialog-info+xml: dialog2;confirmed;+sip.rendering="no" |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F7  200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Call Hold Call Flow Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Retrieve Call</h3>

<p>The controller tells Alice's phone to retrieve an held call with
        Bob. Alice's phone sends a re-INVVITE to Bob's contact to resume the
        media stream which was already on hold.
</p><br /><hr class="insert" />
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Controller                    Alice                        Bob
        |&lt;&lt; Controller subscribed to &gt;&gt;|&lt;&lt;&lt;&lt; Established dialog1 &gt;&gt;&gt;|
        |&lt;&lt;&lt; Alice's dialog events &gt;&gt;&gt;&gt;|                            |
        |                              |                            |
        | F1  REFER sip:Alice-GRUU     |                            |
        |     To: sip:Alice-GRUU       |                            |
        |     Refer-To: urn:feature:RetrieveCall                    |
        |     Target-Dialog: dialog1  |                             |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F2  202 (REFER)              |                            |
        |&lt;-----------------------------|                            |
dialog1 |                              | F3  re-INVITE sip:Bob-GRUU |
        |                              |     sdp: un-hold           |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 |                              | F4  200 (re-INVITE)
        |                              |&lt;---------------------------|
        |                              |                            |
dialog1 |                              | F5  ACK                    |
        |                              |&lt;---------------------------|
dialog2 | F6 NOTIFY sip:Controller-GRUU |                           |
        |    dialog-info+xml: dialog2;confirmed;+sip.rendering="yes"|
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F7  200 (NOTIFY) (dialog2)   |                            |
        |-----------------------------&gt;|                            |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Retrieve Call Flow Example&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
Single Step Transfer Call Flow Example</h3>

<p>Alice's phone and Bob are currently in an established dialog. The
        controller tells Alice's phone to transfer the call to Cathy. Alice's
        phone sends a REFER to Bob to transfer the call to Cathy. Cathy's
        phone rings, is and is answered. Bob sends a notification to Alice's
        phone of completion of REFER (using the implicit subscription).
        Alice's phone then terminates the session with Bob and sends a
        notification of "terminated" to the controller.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       Controller                    Alice                        Bob
        |&lt;&lt; Controller subscribed to &gt;&gt;|&lt;&lt;&lt;&lt; Established dialog1 &gt;&gt;&gt;|
        |&lt;&lt;&lt; Alice's dialog events &gt;&gt;&gt;&gt;|                            |
        |                              |                            |
dialog3 |F1 REFER sip:Alice-GRUU       |                            |
        |   To: sip:Alice-GRUU         |                            |
        |   Refer-To: urn:feature:SingleStepTransfer;target=Cathy-AOR
        |   Target-Dialog: dialog1     |                            |
        |-----------------------------&gt;|                            |
        |                              |                            |
dialog3 | F2  202 (REFER)              |                            |
        |&lt;-----------------------------|                            |
dialog4 |                              | F3  REFER sip:Bob-GRUU     |
        |                              |     Refer-To: (Cathy-AOR)  |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog4 |                              | F4  200 (REFER)            |
        |                              |&lt;---------------------------|
        |                              |                            |
dialog4 |                              | F5  NOTIFY sip:Alice-GRUU  |
        |                              |     sipfrag: 100           |
        |                              |&lt;---------------------------|
        |                              |                            |
dialog4 |                              | F6  200 (NOTIFY)           |
        |            Cathy             |---------------------------&gt;|
dialog5 |              | F7  INVITE sip:Cathy-AOR                   |
        |              |&lt;-------------------------------------------|
dialog5 |              | F8  180                                    |
        |              |-------------------------------------------&gt;|
dialog5 |              | F9  200                                    |
        |              |-------------------------------------------&gt;|
dialog5 |              | F10 ACK                                    |
        |              |&lt;-------------------------------------------|
dialog4 |                              | F11 NOTIFY sip:Alice-GRUU  |
        |                              |     sipfrag: 200           |
        |                              |&lt;---------------------------|
        |                              |                            |
dialog4 |                              | F12 200 (NOTIFY)           |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 |                              | F13 BYE                    |
        |                              |---------------------------&gt;|
        |                              |                            |
dialog1 |                              | F14 200 (BYE)              |
        |                              |&lt;---------------------------|
dialog2 | F15 NOTIFY sip:Controller-GRUU|                           |
        |     dialog-info+xml: dialog1=terminated                   |
        |&lt;-----------------------------|                            |
        |                              |                            |
dialog2 | F16 200 (NOTIFY)             |                            |
        |-----------------------------&gt;|                            |
</pre></div>
<p>
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
Conference Calls</h3>

<p>T.B.D.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.8"></a><h3>5.8.&nbsp;
Seperate Calls</h3>

<p>T.B.D.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>The functionality described in this document allows an authorized
      party to manipulate SIP sessions and dialogs in arbitrary ways. Any user
      agent that accepts these types of requests needs to be very careful in
      who it authorizes to send these types of requests. The same security
      considerations as <a class='info' href='#RFC3515'>[RFC3515]<span> (</span><span class='info'>Sparks, R., &ldquo;The Session Initiation Protocol (SIP) Refer Method,&rdquo; April&nbsp;2003.</span><span>)</span></a> apply.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>T.B.D. Need to register urn namespace according to procedures of
      <a class='info' href='#RFC3406'>[RFC3406]<span> (</span><span class='info'>Daigle, L., van Gulik, D., Iannella, R., and P. Faltstrom, &ldquo;Uniform Resource Names (URN) Namespace Definition Mechanisms,&rdquo; October&nbsp;2002.</span><span>)</span></a>.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgments</h3>

<p>Many thanks to Sean Olson, Orit Levin, Robert Sparks, Jonathan
      Rosenberg, and John Elwell.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informational References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2141">[RFC2141]</a></td>
<td class="author-text"><a href="mailto:jayhawk@ds.internic.net">Moats, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2141">URN Syntax</a>,&rdquo; RFC&nbsp;2141, May&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2141.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2141.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2141.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3261.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3406">[RFC3406]</a></td>
<td class="author-text">Daigle, L., van Gulik, D., Iannella, R., and P. Faltstrom, &ldquo;<a href="http://tools.ietf.org/html/rfc3406">Uniform Resource Names (URN) Namespace Definition Mechanisms</a>,&rdquo; BCP&nbsp;66, RFC&nbsp;3406, October&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3406.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3515">[RFC3515]</a></td>
<td class="author-text">Sparks, R., &ldquo;<a href="http://tools.ietf.org/html/rfc3515">The Session Initiation Protocol (SIP) Refer Method</a>,&rdquo; RFC&nbsp;3515, April&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3515.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3680">[RFC3680]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://tools.ietf.org/html/rfc3680">A Session Initiation Protocol (SIP) Event Package for Registrations</a>,&rdquo; RFC&nbsp;3680, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3680.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4235">[RFC4235]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., and R. Mahy, &ldquo;<a href="http://tools.ietf.org/html/rfc4235">An INVITE-Initiated Dialog Event Package for the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4235, November&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4235.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4488">[RFC4488]</a></td>
<td class="author-text">Levin, O., &ldquo;<a href="http://tools.ietf.org/html/rfc4488">Suppression of Session Initiation Protocol (SIP) REFER Method Implicit Subscription</a>,&rdquo; RFC&nbsp;4488, May&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4488.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4538">[RFC4538]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4538">Request Authorization through Dialog Identification in the Session Initiation Protocol (SIP)</a>,&rdquo; RFC&nbsp;4538, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4538.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5031">[RFC5031]</a></td>
<td class="author-text">Schulzrinne, H., &ldquo;<a href="http://tools.ietf.org/html/rfc5031">A Uniform Resource Name (URN) for Emergency and Other Well-Known Services</a>,&rdquo; RFC&nbsp;5031, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5031.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5057">[RFC5057]</a></td>
<td class="author-text">Sparks, R., &ldquo;<a href="http://tools.ietf.org/html/rfc5057">Multiple Dialog Usages in the Session Initiation Protocol</a>,&rdquo; RFC&nbsp;5057, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5057.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sipping-app-interaction-framework">[I-D.ietf-sipping-app-interaction-framework]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-app-interaction-framework-05.txt">A Framework for Application Interaction in the Session Initiation Protocol  (SIP)</a>,&rdquo; draft-ietf-sipping-app-interaction-framework-05 (work in progress), July&nbsp;2005 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-app-interaction-framework-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sip-gruu">[I-D.ietf-sip-gruu]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-gruu-15.txt">Obtaining and Using Globally Routable User Agent (UA) URIs (GRUU) in the  Session Initiation Protocol (SIP)</a>,&rdquo; draft-ietf-sip-gruu-15 (work in progress), October&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sip-gruu-15.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sipping-cc-framework">[I-D.ietf-sipping-cc-framework]</a></td>
<td class="author-text">Mahy, R., Sparks, R., Rosenberg, J., Petrie, D., and A. Johnston, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-cc-framework-12.txt">A Call Control and Multi-party usage framework for the Session Initiation Protocol (SIP)</a>,&rdquo; draft-ietf-sipping-cc-framework-12 (work in progress), December&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-cc-framework-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="ECMA269">[ECMA269]</a></td>
<td class="author-text">ECMA International, &ldquo;<a href="http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-269.pdf">Services for Computer Suported Telecommunications
          Communications Applications (CSTA) Phase III</a>,&rdquo; Standard&nbsp;ECMA-269, December&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="ECMA323">[ECMA323]</a></td>
<td class="author-text">ECMA International, &ldquo;<a href="http://www.ecma-international.org/publications/files/ECMA-ST/Ecma-323.pdf">XML Protocol for Computer Supported Telecommunications
          Applications (CSTA) Phase III</a>,&rdquo; Standard&nbsp;ECMA-323, December&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="TR87">[TR87]</a></td>
<td class="author-text">ECMA International, &ldquo;<a href="http://www.ecma-international.org/publications/files/ECMA-TR/TR-087.pdf">Using CSTA for SIP Phone User Agents (uaCSTA)</a>,&rdquo; Technical Report&nbsp;TR/87, June&nbsp;2004.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Francois Audet</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nortel</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">4655 Great America Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Clara, CA  95054</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 495 2456</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:audet@nortel.com">audet@nortel.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alan Johnston</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Avaya</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">St. Louis, MO  63124</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:alan@sipstation.com">alan@sipstation.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Rohan Mahy</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Plantronics</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">345 Encincal Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Santa Cruz, CA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rohan@ekabal.com">rohan@ekabal.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cullen Jennings</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 West Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mailstop SJC-21/2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 902-3341</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fluffy@cisco.com">fluffy@cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
