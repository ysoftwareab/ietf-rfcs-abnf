<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Syslog Sending Policy Messages</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Syslog Sending Policy Messages">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">W. Fan</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Huaweisymantec Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">February 27, 2009</td></tr>
<tr><td class="header">Expires: August 31, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Syslog Sending Policy Messages<br />draft-fan-syslog-sending-policy-00</h1>

<h3>Status of This Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008. The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 31, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>This document defines special syslog messages called Sending
Policy messages
for indicating how syslog senders process syslog
messages before sending them.
The information Sending Policy messages convey is of interest to syslog
receivers and helpful for audit.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Conventions Used in this Document<br />
<a href="#anchor3">3.</a>&nbsp;
Definitions<br />
<a href="#anchor4">4.</a>&nbsp;
Sending Policy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.1.</a>&nbsp;
Policy Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.1.</a>&nbsp;
Priority Policy<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.1.2.</a>&nbsp;
Filtering Policy<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.1.3.</a>&nbsp;
Persistency Policy<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.</a>&nbsp;
Criteria For Importance Evaluation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.2.1.</a>&nbsp;
Based on Priority Value<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.2.2.</a>&nbsp;
Based on Timestamp Value<br />
<a href="#anchor12">5.</a>&nbsp;
Sending Policy Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.1.</a>&nbsp;
Sending Policy Block Format and Fields<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.1.1.</a>&nbsp;
Version<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.1.2.</a>&nbsp;
Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.1.3.</a>&nbsp;
TimeType and TimeValue<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.1.4.</a>&nbsp;
Criteria and Threshold<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.2.</a>&nbsp;
Usages<br />
<a href="#anchor19">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">6.1.</a>&nbsp;
Message stream<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">6.2.</a>&nbsp;
Message loss<br />
<a href="#anchor22">7.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor23">8.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor24">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">9.2.</a>&nbsp;
Informative References<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
		Generally, syslog senders would send all generated messages to targeted receivers. But there would be a different story in some circumstances. For some reason, syslog system may buffer messages before sending them further. When some important messages have been hold in sending queue for a long time, the senders would like to send those urgent messages timely even out of order they are in sending queue or they were generated. When transport senders are going to drain their sending queue, they would not be able to send all the messages timely. In this case, senders would filter out less important messages to reduce queue overload or store new coming messages persistently in disk for sending them later.
	
</p>
<p>
		These scenarios may be not rare in real world. When congestion control is applied to syslog transport, some mechanisms will be employed to adjust sending rate based on feedback approach. When network congestion occurs, in order to reduce package loss in transit and improve network throughout, sending rate will slow down. Congestion control increase the latency of messages sending and the chance sending queue is full. Message burst due to malicious behaviors is likely to exhaust sending queue, too.
	
</p>
<p>
		When senders process messages before sending them, something would have happend, e.g, network congestion occurs or intrusion led to log messages burst. So the event that senders process messages before sending them might be an alert to operators. Additionally, the information how senders process messages before sending them is of interest to receivers and helpful for audit, e.g, the information which messages are more important than others may be of value to receivers. For an instance, when receivers can identify the more important
messages from the sender's perspective, it could handle this event timely
when many messages near-simultaneously arrive. For another instance,
taking into account that the sender has dropped which messages during which period of time
may help us
do a more accurate audit. This
document defines special messages called Sending Policy messages to notify this kind of event and deliver
this information.
	
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions Used in this Document</h3>

<p>
			The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in
this
   document are to be interpreted as described in RFC 2119 [RFC2119].
		
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Definitions</h3>

<p>
	</p>
<ul class="text">
<li>
			Message refer to syslog message whose on-the-wire format is
defined in section 6, [RFC5424]. 		
</li>
<li>
			Sender refer to transport sender which is defined in section 3,
[RFC5424].
		
</li>
<li>
			Receiver refer to transport receiver which is defined in section
3, [RFC5424].
		
</li>
<li>
			Sending queue is a conceptual buffer for buffering messages to
be sent in sender's side.
		
</li>
<li>
			Receiving queue is a conceptual buffer for buffering messages to
be received and processed in receiver's side.
		
</li>
</ul><p>
	
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Sending Policy</h3>

<p>
		A Sending Policy contains an action senders take on messages before sending them and criteria which are used to evaluate the importance of messages. Actions should be taken based on criteria.
	
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Policy Type</h3>

<p> According to what kind of actions senders would take, Sending Policies can be probably divided into three category:
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Priority Policy</h3>

<p>
    			When latency occurs, senders would like to send the more
important messages timely even out of order the messages were generated or are in sending queue. How to evaluate the importance of messages
depend on what criteria senders adopts.The criteria are of interest to
the receiver, as the
receiver can also pick up important messages to be processed timely
when it
starves, i.e, when so many near-simultaneously messages arrive.
</p>
<p>Priority Policy indicates messages would be sent based on level of importance even out of order they were generated or are in sending queue. Priority Policy also contains the criteria adopted to evaluate the importance of messages.
		
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Filtering Policy</h3>

<p>
    			 When the number of messages to be sent increases,
it is possible to drain the sending queue. Senders may simply dropping
messages to alleviate sending queue load.
Comparing to messages dropped by routers in transit, senders has more
sense
what messages they'd like to abondon whilst the others
preserved. We assume senders always drop less important messages.
		
</p>
<p>
		This policy may do not affect receiver's behavior
very much. But when audit later, it would do more accurate analysis by
taking criteria which are used to evaluate importance of messages into
account.
		
</p>
<p> Filtering Policy indicates some messages would be dropped based on their importance. Filtering Policy also contains the criteria adopted to evaluate the importance of messages.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
Persistency Policy</h3>

<p>
    			As an alternative to Filtering Policy, Senders may want to
store the messages persistently for more reliability but less
timeliness. This policy may not affect receiver's bahavior very much. The event that this policy has been applied may be of
interest to receivers. It would be considered as an alert indicating congestion
occurs or messages burst.
		
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Criteria For Importance Evaluation</h3>

<p>Persistency Policy do not care about importance of messages, since no messages dropping and no messages sent out of order. With regard to Priority Policy and Filtering Policy, they both need to identify the more important messages to be processed before sending them. There are commonly 2 ways to evaluate importance of syslog messages:
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Based on Priority Value</h3>

<p>Priority Value consists of two parts: Facility and Severity. Facility value takes value from 0 to 23. Severity value takes value from 0 to 6. In both cases, the lower the value is, the more important the message is.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Based on Timestamp Value</h3>

<p>Timestamp Value is not mandatory in syslog messages, but when it shows up, it indicates the time when message was generated. When we filter out messages, we can simply dropping new coming messages or let new coming messages override the old ones(e.g, circular queue). The latter takes newer message more valuable, but the former takes newer message less important. Priority Policy would not base on these criteria.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Sending Policy Messages</h3>

<p>Sending Policy Messages are used to contain policies specified in section 4 and the event when specific policy was applied or revoked. These information are carried as Sending Policy Blocks in Sending Policy Messages actually.
</p>
<p>
			There is a need
to distinguish the Sendig Policy Block itself from the
   syslog message that is used to carry a Sending Policy Block.  Sending Policy
   Blocks MUST be encompassed within completely formed syslog
messages.
   Syslog messages that contain a Sending Policy Block are also referred to
   as Sending Policy messages.
		
</p>
<p>
			A Sending Policy message is identified by the presence of an SD
   ELEMENT with an SD-ID with the value "sending-policy".  In addition, a Sending
   Policy message MUST contain valid APP-NAME, PROCID, and
   MSGID fields to be compliant with [RFC5424].  This specification
does
   not mandate particular values for these fields; however, for
   consistency, originators MUST use the same values for APP-NAME,
   PROCID, and MSGID fields for every Sending Policy message that is
   sent, whichever values are chosen.  To allow for the possibility of
   multiple originators per host, the combination of APP-NAME, PROCID,
   and MSGID MUST be unique for each such originator.  If an
originator
   daemon is restarted, it MAY use a new PROCID for what is otherwise
   the same originator but MUST continue to use the same APP-NAME and
   MSGID.  The Sending Policy Block is carried as
Structured Data
   within the Sending Policy Block message, per the definitions that follow
   in the subsection.  The MSG part of a Sending
   Policy message SHOULD be any readable text for explaining the Sending Policy Block.
		
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Sending Policy Block Format and Fields</h3>

<p>
    		The Sending 
   Policy Block MUST be encoded as an SD ELEMENT, as defined in
   [RFC5424].
	
</p>
<p>
		The SD-ID MUST have the value of "sending-policy".
	
</p>
<p>
		The SDE contains the fields of the Sending Policy Block encoded as
SD Parameters, as specified in the following. The Sending Policy Block is
composed of the following fields. The value of each field MUST be
printable ASCII.
	
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">Field</th><th align="center">SD-PARAM-NAME</th><th align="center">Size in octets</th></tr>
<tr>
<td align="center">Version</td>
<td align="center">VER</td>
<td align="center">2</td>
</tr>
<tr>
<td align="center">Type</td>
<td align="center">TYPE</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">TimeType</td>
<td align="center">TT</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">TimeValue</td>
<td align="center">TV</td>
<td align="center">1-50</td>
</tr>
<tr>
<td align="center">Criteria</td>
<td align="center">CRI</td>
<td align="center">1</td>
</tr>
<tr>
<td align="center">Threshold</td>
<td align="center">THRE</td>
<td align="center">1-10</td>
</tr>
</table>
<br clear="all" />

<p>
		The fields MUST be provided in the order listed if they were present.  Each SD
parameter
   MUST occur once in the Sending Policy Block.  Version is mandatory. A Sending Policy
   Block is likely to be accordingly encoded as follows, where xxx denotes a
   placeholder for the particular values:
	
</p>
<p>
		[sending-policy VER="xxx" TYPE="xxx" TT="xxx" TV="xxx" CRI="xxx"
THRE="xxx"]
	
</p>
<p>
		Values of the fields constitute SD parameter values and are hence
   enclosed in quotes, per [RFC5424].  The fields are separated by
   single spaces and are described in the subsequent subsections.
	
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Version</h3>

<p>
    			The Version field is a numeric value that has
a length of 2 octets, which may include leading zeroes. The two octets
contain a decimal character in the range of "0" to "9". The value
in this field specifies the version of this Block with "01" as the
value for the
      protocol version that is described in this document.
		
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Type</h3>

<p>
    			This field indicates which type of policies specified in
section 4 the sender has adopted. The TYPE parameter may take any
value from 0-2 inclusive.
    			</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>"0" -- Priority Policy has been adopted by the
sender.
</dd>
<dt>b.</dt>
<dd>"1" -- Filtering Policy has been adopted by the
sender.
</dd>
<dt>c.</dt>
<dd>"2" -- Persistency Policy has been adopted by the
sender.
</dd>
</dl></blockquote><p>
    		
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.3"></a><h3>5.1.3.&nbsp;
TimeType and TimeValue</h3>

<p>
    			The two fields show us when the sender starts to apply the
policy indicated in TYPE field or when the sender revokes it, that
is dependent on TimeType Value. TT parameter may take any value from
0-1 inclusive
    			</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>"0" -- Subsequent TimeValue field represent start
time.
</dd>
<dt>b.</dt>
<dd>"1" -- Subsequent TimeValue field represent end time. 
</dd>
</dl></blockquote><p>
		
</p>
<p>
			When Priority Policy was applied, if TT Value equals "0", TV
Value SHOULD be the TIMESTAMP Value of the first message out of order;
if TT Value equals "1", TV Value SHOULD be the TIMESTAMP Value of the
last message out of order.
		
</p>
<p>
			When Filtering Policy was applied, if TT Value equals "0", TV
Value SHOULD be the TIMESTAMP Value of the first message dropped; if
TT Value equals "1", TV Value SHOULD be the TIMESTAMP Value of the
last message dropped.
		
</p>
<p>	
			When Persistency Policy was applied, if TT Value equals "0" or
"1", TV Value SHOULD be the system time when the Policy message was sent(I.e., TV Value equals to TIMESTAMP Value in message HEADER).
		
</p>
<p>
			sending-policy SDE can convey only criteria for importance evaluation, in this case, no indicator for policy has been applied or revoked, so this two field can be absent. 
		
</p>
<p>
    			TV parameter is a formalized timestamp derived from
[RFC3339] and follow the restrictions specified in [RFC5424](section
6.2.3).
		
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.4"></a><h3>5.1.4.&nbsp;
Criteria and Threshold</h3>

<p>
			Criteria field indicates the criteria which are used to
evaluate the importance of messages. Criteria parameter may take any
value from 0-2 inclusive.
    			</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>"0" -- Evaluate importance of a message based on Severity Value which is a part of PRI Value contained in HEADER part.
</dd>
<dt>b.</dt>
<dd>"1" -- Evaluate importance of a message based on Facility Value which is a part of PRI Value contained in HEADER part.
</dd>
<dt>c.</dt>
<dd>"2" -- Evaluate importance of a message based on Timestamp Value  contained in HEADR part. 
</dd>
</dl></blockquote><p>
    		
</p>
<p>
			When Criteria field takes value "2", Threshold Value indicates
whether earlier or older messages are considered more important. In
this case, Threshold Value can be intepreted in this way:
			</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>"0" -- the earlier messages were generated, more important
they were.
</dd>
<dt>b.</dt>
<dd>"1" -- the older messages were generated, more important
they were.
</dd>
</dl></blockquote><p>
		
</p>
<p>
			When Criteria field takes value "0" or "1", Threshold Value indicates the border of more important messages and less important messages. 
			E.g, when Criteria
parameter takes value "0", and, Threshold Value equals "3",
that means any messages bearing severity Value greater than 3 may be
dropped(when Filter Policy was adopted) or delayed their sending(when
Priority Policy was adopted).
		
</p>
<p>When Persistency Policy was adopted, these two fields can be
absent.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Usages</h3>

<p>Sending Policy messages can only convey criteria for importance evaluation, in this case, Version, CRI and THRE MUST be present. E.g., senders would send this messages following the session is established.
</p>
<p>The following example shows the criteria are that messages bearing Severity Value which is less than or equals to 3 are more important.
</p>
<p>[sending-policy VER="01" CRI="0" THRE="3"]
</p>
<p>When Sending Policy messages are used as event notification, TT and TV MUST be present, CRI and THRE MUST be present unless criteria for importance evaluation have been delivered before.  two Sending Policy messages are recommended to indicate event start and event end respectively. In this case, Sending Policy messages SHOULD have enough high priority to be sent timely and avoid being filtered out.
</p>
<p>The following example shows Filtering Policy has been adopted by the sender and the first affected message(i.e. the first message dropped) was generated on Feb 24 2009 05:14:15am, 3 microseconds into the
   next second( and the local time is -7 hours from UTC). The CRI and THRE are interpreted as last example
</p>
<p>[sending-policy VER="01" TYPE="1" TT="0" TV="2009-02-24T05:14:15.000003-07:00" CRI="0" THRE="3"]
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>This specification shares the same security considerations addressed in section 8.5, [RFC5424]. Additionally, two issues should be taken care of.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Message stream</h3>

<p>When Priority Policy was applied, syslog messages may be sent out of order they were generated. The receivers should not reconstruct sequence of events based on the order they were received. In this case, TIMESTAMP may be used to do this work. Besides, when Priority Policy message is used as real-time event notification, syslog-sign may not work well in this case, since the urgent message sent out of order can not be verified until the corresponding Signature message has been interpreted. By the same token, receivers would not process messages out of order they were received. 
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Message loss</h3>

<p>When Filtering Policy was applied, syslog messages may be lost by senders. In this case, Sending Policy messages could tell what kind of messages was dropped. If syslog-sign is also applied, syslog-sign can tell how many and which messages was dropped. It is recommended that Signature Block messages have enough high priority to avoid being filtered out by senders easily.
</p>
<p>If UDP-like congestion control is adopted for syslog transport, Sending Policy messages themselves would probably be lost in transit. Sending Policy messages should be sent several times in this case.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>IANA is requested to register the SD-ID value "sending-policy" together with
   the PARAM-NAME values specified in Section 5.1 in the registry for
   SYSLOG structured data id values according to section 9 in
   [RFC5424].

</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center"><col align="center">
<tr><th align="center">SD-ID</th><th align="center">PARAM-NAME</th><th align="center"></th></tr>
<tr>
<td align="center">sending-policy</td>
<td align="center">&nbsp;</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">VER</td>
<td align="center">mandatory</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">TYPE</td>
<td align="center">optional</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">TT</td>
<td align="center">optional</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">TV</td>
<td align="center">optional</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">CRI</td>
<td align="center">optional</td>
</tr>
<tr>
<td align="center">&nbsp;</td>
<td align="center">THRE</td>
<td align="center">optional</td>
</tr>
</table>
<br clear="all" />

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Normative References</h3>

<p>	[RFC5424]  Gerhards, R., "The syslog Protocol", RFC 5424,
              December 2008.
</p>
<p>[RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
Informative References</h3>

<p>[RFC3339]  Klyne, G. and C. Newman, "Date and Time on the Internet:
              Timestamps", RFC 3339, July 2002.
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Washam Fan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huaweisymantec Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Building 17</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Zhongguancun Software Park</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">No.8 Dongbeiwang West Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beijing  100085</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PRC</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 010 58791314</td></tr>
<tr><td class="author" align="right">EMail:&nbsp;</td>
<td class="author-text"><a href="mailto:washam.fan@huaweisymantec.com">washam.fan@huaweisymantec.com</a></td></tr>
</table>
</body></html>
