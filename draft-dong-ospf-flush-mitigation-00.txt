



Network Working Group                                            J. Dong
Internet-Draft                                                  X. Zhang
Intended status: Standards Track                     Huawei Technologies
Expires: May 4, 2017                                               Z. Li
                                                            China Mobile
                                                        October 31, 2016


            LSA Flushing Problem Mitigation in OSPF Networks
                  draft-dong-ospf-flush-mitigation-00

Abstract

   In OSPF protocol, LSAs with the LS age at MaxAge are not used in
   routing table calculation and MUST be flushed in the network.  In
   some cases, the flushing of OSPF MaxAge LSAs may cause flooding storm
   of OSPF packets and severely impact network stability and the
   services provided by the network.  This document specifies a backward
   compatible mechanism to mitigate the impact of MaxAge LSA flushing in
   OSPF networks.

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on May 4, 2017.








Dong, et al.               Expires May 4, 2017                  [Page 1]

Internet-Draft        OSPF LSA Flushing Mitigation          October 2016


Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Proposed Solution . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Deployment Considerations . . . . . . . . . . . . . . . . . .   4
   4.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   4
   5.  Security Considerations . . . . . . . . . . . . . . . . . . .   5
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   5
   7.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   5
     7.1.  Normative References  . . . . . . . . . . . . . . . . . .   5
     7.2.  Informative References  . . . . . . . . . . . . . . . . .   5
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   5

1.  Introduction

   In OSPF protocol [RFC2328], Link State Updates (LSAs) are exchanged
   in Link State Update (LSU) packets to achieve link-state database
   (LSDB) synchronization and consistent route calculation.  LSAs with
   the LS age at MaxAge are not used in routing table calculation and
   MUST be flushed in the network.  In some cases, the flushing of
   MaxAge LSAs can cause flooding storm of OSPF packets and severely
   impact network stability and the services provided by the network.
   [I-D.dong-ospf-maxage-flush-problem-statement] analyzes the problem
   of MaxAge LSA flushing, and gives the requirements on potential
   solutions.

   This document proposes a backward compatible mechanism to mitigate
   the impacts of MaxAge LSA flushing in OSPF networks.








Dong, et al.               Expires May 4, 2017                  [Page 2]

Internet-Draft        OSPF LSA Flushing Mitigation          October 2016


2.  Proposed Solution

   In normal cases, the flushing of router-LSA indicates that the
   originator of the LSA is no longer reachable in the network and is
   unable to refresh the LSA.  The flushing of other types of LSAs
   indicate the routing information carried in the LSAs is no longer
   applicable.  Since usually the removal of a node is a significant
   change to the network and can also be informed by the update of LSAs
   of its adjacent routers, the flushing of router-LSA MUST be processed
   carefully to avoid unnecessary routing churns caused by improper LSA
   flushing.

   The proposed solution aims to distinguish persistent LSA flushing
   from normal LSA flushing, so that the impact of persistent flushing
   can be alleviated without slowing down normal route convergence.
   Specifically, the flushing of router-LSA and the subsequent flushing
   of LSAs belonging to the same originator are further examined.
   During the examination time, the old instance of the LSAs and the
   MaxAge LSAs are kept in LSDB and the route recalculation is
   postponed.

   Two types of timers are used in this solution:

   o  T1: the examination time of the suspicious persistent LSA flushing
      of a particular router.  When a MaxAge router-LSA of a particular
      router is received, timer T1 fires and the originator of the
      router-LSA is marked as in Restrain state.  The value of timer T1
      is configurable, and the RECOMMENED value is 1800 seconds.

   o  T2: the examination time of a received MaxAge LSA, the originator
      of which is currently in Restrain state.  When a Maxage LSA is
      received and the orginator of the LSA is in Restrain state, timer
      T2 fires and the old instance of the LSA is still in use, which
      means the Maxage LSA does not trigger route recalculation.  The
      value of timer T2 is configurable, and the RECOMMENDED value is 10
      seconds.

   The detailed procedures are described as follows :

   a.  When a MaxAge router-LSA is received,

   o  If the originator of the LSA is not in Restrain state, mark the
      originator of the LSA as in Restrain state, timer T1 is started
      for that router, and timer T2 is started for the router-LSA.  The
      MaxAge LSA is flushed further in the newtork, while the old
      instance of the LSA is still in use in route calculation until T2
      expires.




Dong, et al.               Expires May 4, 2017                  [Page 3]

Internet-Draft        OSPF LSA Flushing Mitigation          October 2016


   o  If the originator of the LSA is already in Restrain state, then T1
      is restarted for that router.  If timer T2 does not exist for this
      LSA, timer T2 is started for the LSA.

   b.  When a MaxAge LSA with LSA-type other than router LSA is
   received,

   o  If the originator of the LSA is in Restrain state, timer T2 is
      started for the LSA.  The MaxAge LSA is flushed further in the
      newtork, while the old instance of the LSA is in use in route
      calculation.

   o  If the originator of the LSA is not in Restrain state, the
      processing is according to [RFC2328].

   c.  When a newer LSA instance originated by a router in Restrain
   state is received,

   o  If timer T2 for this LSA exists, the newer instance replaces the
      old LSA instance in link-state database and triggers route
      recalculation, timer T2 for this LSA is stopped.

   o  If timer T2 for this LSA does not exist, the processing is
      according to [RFC2328].

   d.  When timer T2 for a particular LSA expires, the MaxAge LSA
   triggers route recalculation and is removed from link-state database.

   e.  When timer T1 for a particular router expires, the router is
   marked as in normal state.

3.  Deployment Considerations

   While it is RECOMMENDED that the proposed mechanism deployed on all
   the routers in the same OSPF network, this mechanism can also be
   deployed into the network incrementally.

4.  IANA Considerations

   This document makes no request of IANA.

   Note to RFC Editor: this section may be removed on publication as an
   RFC.








Dong, et al.               Expires May 4, 2017                  [Page 4]

Internet-Draft        OSPF LSA Flushing Mitigation          October 2016


5.  Security Considerations

   TBD

6.  Acknowledgements

   TBD

7.  References

7.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC2328]  Moy, J., "OSPF Version 2", STD 54, RFC 2328,
              DOI 10.17487/RFC2328, April 1998,
              <http://www.rfc-editor.org/info/rfc2328>.

7.2.  Informative References

   [I-D.dong-ospf-maxage-flush-problem-statement]
              Dong, J., Zhang, X., and Z. Li, "OSPF Corrupted MaxAge LSA
              Flushing Problem Statement", draft-dong-ospf-maxage-flush-
              problem-statement-00 (work in progress), March 2016.

Authors' Addresses

   Jie Dong
   Huawei Technologies
   Huawei Campus, No.156 Beiqing Rd.
   Beijing  100095
   China

   Email: jie.dong@huawei.com


   Xudong Zhang
   Huawei Technologies
   Huawei Campus, No.156 Beiqing Rd.
   Beijing  100095
   China

   Email: zhangxudong@huawei.com





Dong, et al.               Expires May 4, 2017                  [Page 5]

Internet-Draft        OSPF LSA Flushing Mitigation          October 2016


   Zhenqiang Li
   China Mobile
   No.32 Xuanwumenxi Ave., Xicheng District
   Beijing  100032
   China

   Email: lizhenqiang@chinamobile.com












































Dong, et al.               Expires May 4, 2017                  [Page 6]
