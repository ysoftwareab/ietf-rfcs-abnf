<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DHCPv6 Dynamic Re-Configuration</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Mechanism">
<link href="#rfc.section.4" rel="Chapter" title="4 Protocol overview">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Message">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Relay Reconfigure option">
<link href="#rfc.section.5" rel="Chapter" title="5 DHCPv6 Relay Agent Behaviour">
<link href="#rfc.section.6" rel="Chapter" title="6 DHCPv6 Server Behaviour">
<link href="#rfc.section.7" rel="Chapter" title="7 Host Tracking">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Some networks are expected to support IPv4-only, dual-stack, and IPV6-only hosts at the same time. This makes prioritizing the DNS servers for hosts tricky due to a heterogeneous mix of protocol stacks causing optimal behavior to occur only when the host stack re-initializes. The networks infrastructure is usually well equipped to be aware of single/dual-stack nature of hosts. This specification extends DHCPv6 so that the DHCPv6 Relay Agent can dynamically influence the priority of DNS servers provided to the host, so that the host can use the optimal DNS server for resolution." />
  <meta name="description" content="Some networks are expected to support IPv4-only, dual-stack, and IPV6-only hosts at the same time. This makes prioritizing the DNS servers for hosts tricky due to a heterogeneous mix of protocol stacks causing optimal behavior to occur only when the host stack re-initializes. The networks infrastructure is usually well equipped to be aware of single/dual-stack nature of hosts. This specification extends DHCPv6 so that the DHCPv6 Relay Agent can dynamically influence the priority of DNS servers provided to the host, so that the host can use the optimal DNS server for resolution." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">BEHAVE Working Group</td>
<td class="right">D. Wing</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">T. Reddy</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">P. Patil</td>
</tr>
<tr>
<td class="left">Expires: May 03, 2012</td>
<td class="right">Cisco</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DHCPv6 Dynamic Re-Configuration<br />
  <span class="filename">draft-wing-behave-dhcpv6-reconfigure-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Some networks are expected to support IPv4-only, dual-stack, and IPV6-only hosts at the same time. This makes prioritizing the DNS servers for hosts tricky due to a heterogeneous mix of protocol stacks causing optimal behavior to occur only when the host stack re-initializes. The networks infrastructure is usually well equipped to be aware of single/dual-stack nature of hosts. This specification extends DHCPv6 so that the DHCPv6 Relay Agent can dynamically influence the priority of DNS servers provided to the host, so that the host can use the optimal DNS server for resolution.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 03, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Mechanism</a>
</li>
<li>4.   <a href="#rfc.section.4">Protocol overview</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Message</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Relay Reconfigure option</a>
</li>
<li>5.   <a href="#rfc.section.5">DHCPv6 Relay Agent Behaviour</a>
</li>
<li>6.   <a href="#rfc.section.6">DHCPv6 Server Behaviour</a>
</li>
<li>7.   <a href="#rfc.section.7">Host Tracking</a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The default address selection rules <a href="#RFC3484">[RFC3484]</a> prefers IPv6 over IPv4. If a dual-stack host is configured to use a DNS64 server, that DNS64 server will synthesize a AAAA response if there is an A record. Thus, the dual-stack host will always use IPv6 if a DNS lookup was involved, even if IPv4 could have been used more optimally.  If NAT44 and NAT64 are deployed on the same network, , it is preferable to use NAT44 over NAT64 because of scale, performance and application incompatibility issues (e.g., FTP) <a href="#RFC6384">[RFC6384]</a>. At the same time, native IPv6 can still be preferred over IPv4. The DHCPv6 Relay Agent can observe host characteristics on a network to determine if the host is IPV4-only, dual-stack or IPV6-only and also determine transitions from single to dual-stack or vice-versa. In this document we propose a specification that allows the DHCPv6 Relay Agent to influence the DHCPv6 Server to send appropriately prioritized DNS Servers to the client as per host characteristics.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#terminology" id="terminology">Terminology</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.2.p.2">'normal' DNS server : DNS server using an IPv4-mapped IPv6 address (that is, an IPv6 address starting with ::ffff:/96 IPv4-mapped prefix).  Hosts can communicate with 'normal' DNS server only using IPv4 packets <a href="#RFC6052">[RFC6052]</a>, section 4.2.</p>
<p id="rfc.section.2.p.3">DNS64 server : DNS server using a normal IPv6 address and synthesizes AAAA records from A records <a href="#RFC6147">[RFC6147]</a></p>
<p></p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#mechanism" id="mechanism">Mechanism</a>
</h1>
<p id="rfc.section.3.p.1">This document describes a new DHCPv6 Message and Option that is to be used by the DHCPv6 Relay Agent to indicate to the DHCPv6 Server of the priority of DNS servers to be provided to the specified host. The DHCPv6 Server then sends a Reconfigure message to the host providing updated/re-ordered DNS server list as suggested by the Relay Agent. The idea is for the DHCPv6 Relay Agent to dynamically send the reconfigure message based on host characteristics.</p>
<p></p>

<ol>
<li>
<strong>IPv6-only transition to Dual-Stack</strong> In case a host is IPv6-only to start off, it is provided a DNS64 Server. When transitioning to dual-stack, a IPv4 DNS Server is assigned as a consequence of obtaining an IPv4 Address. The DHCPv6 Relay Agent can detect this and send RELAY-RECONFIG message <a href="#relay_reconfig_msg">Section 4.1</a> to the DHCPv6 Server indicating that the host needs to be needs to be provided with "normal" DNS Server followed by DNS64 server. In lieu of this mechanism, the host would continue to use the DNS64 server until the host stack Re-initializes.</li>
<li>
<strong>Dual-Stack to IPv6-only</strong> In case a host is dual-stack, it is provided with "normal" DNS followed by DNS64 server. When transitioning to IPv6-only, the DHCPv6 Relay Agent can detect this and send a RELAY-RECONFIG message to the DHCPv6 Server indicating that the host needs to be assigned a DNS64 server only. Without this, the host will continue to use the "normal" DNS Server which is inaccessible and eventually time out to fail over to the DNS64 Server. This means that the host will take additional time to fully initialize causing delays in connection.</li>
<li>
<strong>IPv4-only transition to Dual-Stack</strong> In case a host is IPv4-only to start off, it is provided IPv4 DNS Server. When transitioning to dual-Stack, DNS64 server is also provided as a consequence of obtaining IPv6 address(s). The DHCPv6 Relay Agent can detect this and send RELAY-RECONFIG message to the DHCPv6 Server indicating that the host needs to be provided with "normal" DNS Server followed by DNS64 server.</li>
<li>
<strong>Dual-Stack to IPv4-only</strong> In case a host is dual-stack, it is provided with "normal" DNS followed by DNS64 server. When transitioning to IPv4-only, no change is required because the host continues to use "normal" server.</li>
</ol>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Protocol overview</h1>
<p id="rfc.section.4.p.1">To realize the mechanism described above, this document extends the DHCPv6 protocol allowing the DHCPv6 relay-agent to inform DHCPv6 server to initiate a reconfigure message with the client, resulting in the client to initiate Renew/Reply or information-request/Reply transaction with the server to receive updated/new configuration information.</p>
<div id="#rfc.figure.1"></div>
<div id="#fig_message_flow"></div>
<pre>
DHCPv6 Client        DHCPv6 Relay Agent           DHCPv6 Server
      |                    |                              |
      |                    |-----------------------------&gt;|
      |                    |  DHCPv6 Relay-supplied       |
      |                    |   Reconfigure message        |
      |                    |                              |
      |                    |                              |
      |&lt;--------------------------------------------------|
      |                    | DHCPv6 Reconfigure           |
      |                    |                              |
      |--------------------|-----------------------------&gt;|                         
      |           DHCPv6 Information-request              |
      |                    |                              |
      |&lt;--------------------------------------------------|
      |              DHCPv6 Reply                         |
      |                    |                              |
</pre>
<p></p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#relay_reconfig_msg" id="relay_reconfig_msg">Message</a>
</h1>
<p id="rfc.section.4.1.p.1">The RELAY-RECONFIG message uses the Client/Server message formats described in <a href="#RFC3315">[RFC3315]</a>, section 6.</p>
<p id="rfc.section.4.1.p.2">RELAY-RECONFIG - A Relay Agent sends a RELAY-RECONFIG message to DHCPv6 server so that server can update configuration information based on the details in the Relay Reconfigure option. DHCPv6 server will subsequently initiate Reconfigure message with the client to propagate the new configuration information.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Relay Reconfigure option</h1>
<p id="rfc.section.4.2.p.1">The Relay Reconfigure option is used only in a RELAY-RECONFIG message and identifies the query being performed. The option includes the reconf-type, client-key and option(s) to provide data needed for the DHCPv6 server to initiate Reconfigure message with the client.</p>
<p id="rfc.section.4.2.p.2">The Relay Reconfigure option is defined below:</p>
<div id="#rfc.figure.2"></div>
<div id="#fig_Relay_supplied_Prefix"></div>
<pre>
 0                   1                   2                     3

 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  OPTION_RELAY_RECONF          | option-len                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| reconf-type   |  client-key   |        Reserved               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                  client-key-options                           .
.                                                               .
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Info-flags |              Reserved1                        |
-----------------------------------------------------------------
</pre>
<p></p>

<dl>
<dt>option-len:</dt>
<dd style="margin-left: 8">Length of the option.</dd>
<dt>reconf-type: </dt>
<dd style="margin-left: 8">5 for Renew message, 11 for Information-request message.</dd>
<dt>client-key:</dt>
<dd style="margin-left: 8">8-bit unsigned integer. The client-key indicates the key to identify the client.</dd>
<dt>client-key-options:</dt>
<dd style="margin-left: 8">8-bit unsigned integer. This option can contain either OPTION_IAADDR or OPTION_CLIENTID. The server identifies the client either using IPv6 address assigned to the client using OPTION_IAADDR option or using DHCP Unique Identifier (DUID) of the client in OPTION_CLIENTID option <a href="#RFC3315">[RFC3315]</a>.</dd>
</dl>
<p id="rfc.section.4.2.p.4">client-key values are defined below -</p>
<div id="#rfc.figure.3"></div>
<div id="#fig_values_1"></div>
<pre>
+------+--------------------------------
|Value | Name                          |
+------+--------------------------------
| 0x01 | IDENTIFY_CLIENT_BY_ADDRESS    |
| 0x02 | IDENTIFY_CLIENT_BY_CLIENTID   | 
+------+--------------------------------
</pre>
<p></p>
<p id="rfc.section.4.2.p.6">Info-flag values are defined below -</p>
<div id="#rfc.figure.4"></div>
<div id="#fig_values_2"></div>
<pre>
+------+--------------------------------
|Value | Name                          |
+------+--------------------------------
| 0x01 | IPV6_DNS64_SERV_ONLY          |
| 0x02 | IPV6_HIG_PROI_NORM_SERV       | 
+------+--------------------------------
</pre>
<p></p>
<p></p>

<dl>
<dt>1 :</dt>
<dd>
<strong>IPV6_DNS64_DNS_SERV_ONLY</strong> Provide only DNS64 address list to the client.</dd>
<dt>2 :</dt>
<dd>
<strong>IPV6_HIG_PROI_NORM_SERV</strong> Provide DNS address list in this order to the client - first "normal" DNS servers, second DNS64 servers.</dd>
</dl>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#relay_agent" id="relay_agent">DHCPv6 Relay Agent Behaviour</a>
</h1>
<p id="rfc.section.5.p.1">Relay Agent and clients MUST discard any received RELAY-RECONFIG messages. DHCPv6 relay agents that implement this specification MUST be configurable for sending the RELAY-RECONFIG message. Relay agents SHOULD have separate configuration for client-key in OPTION_RELAY_RECONF option . The Relay Agent sets the "msg-type" field to RELAY-RECONFIG. The Relay Agent generates a transaction ID and inserts this value in the "transaction-id" field. The Relay Agent MUST include OPTION_RELAY_RECONF option and set the reconf-type, client-key, client-key-options accordingly. The Relay Agent detects host characteristics using mechanisms discussed in <a href="#snooping">Section 7</a>. For host transition from IPv6-only to dual-Stack or IPv4-only to dual-stack Relay Agent will set Info-flags with IPV6_HIG_PROI_NORM_SERV and for host transition from dual-stack to IPv6 only Relay-Agent will set Info-flags with IPV6_DNS64_SERV_ONLY. The Relay Reconfigure option is a general and extendable frame work such that in future based on changes to host/network characteristics, Relay agent can dynamically inform the DHCPv6 server to update the host with other configuration information.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#dhcp_server_behaviour" id="dhcp_server_behaviour">DHCPv6 Server Behaviour</a>
</h1>
<p id="rfc.section.6.p.1">Servers MUST discard any received RELAY-RECONFIG messages that meet any of the following conditions :</p>
<p></p>

<ul>
<li>the message does not include OPTION_RELAY_RECONF option.</li>
<li>DUID or IPv6 address in client-key-options does not match server binding to identify the client.</li>
</ul>
<p id="rfc.section.6.p.3">Client will have to indicate with a Reconfigure Accept option in the Solicit message that it will accept the Reconfigure message. Server can have administrative policy that it will only respond to a client willing to accept a Reconfigure message. If the client does not indicate that it will accept Reconfigure message in the Solicit message then the server will discard the Solicit Message.</p>
<p id="rfc.section.6.p.4">Upon receiving RELAY-RECONFIG message containing the Relay Reconfigure Option, the DHCPv6 server processing is described below depending on the Info-flag values:</p>
<p><a href="#RFC3315">[RFC3315]</a>, section 19.1 to create and send Reconfigure message.</p>

<ul>
<li>
<strong>IPV6_DNS64_SERV_ONLY</strong> The DHCPv6 server will select only IPv6 addresses list of DNS64 recursive name servers to be sent to the client. The DHCPv6 server would send Reconfigure message to inform the client that the server has updated configuration information and then the client would initiate Information-request/replay transaction with the server. The updated configuration will now be sent as part of Information-request reply by the DHCPv6 server.</li>
<li>
<strong>IPV6_HIG_PROI_NORM_SERV</strong> The DHCPv6 server will select DNS servers in this order, first is the normal DNS servers and the second is the DNS64 servers. The DHCPv6 server would send Reconfigure message to the client to inform the client that the server has updated configuration information and then the client would initiate Information-request/replay transaction with the server. The updated configuration will now be sent as part of Information-request reply by the DHCPv6 server. The order of DNS servers provided by option OPTION_DNS_SERVERS determines the preference for use by the DNS client resolver <a href="#RFC3646">[RFC3646]</a> thus ensuring higher priority for normal DNS server list followed by DNS64 servers.</li>
</ul>

<p>DHCPv6 server will use mechanism described </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#snooping" id="snooping">Host Tracking</a>
</h1>
<p id="rfc.section.7.p.1">Relay Agents can actively keep track of all IPv4/IPv6 addresses and associated lease times assigned to hosts via the respective DHCP servers. This enables Relay Agents to detect transitions from single to dual-stack and vice-versa efficiently. In addition to this technique, which is to be primarily used, transitions can also be detected using snooping mechanisms. Network devices today use mechanisms such as ARP and NDP snooping to determine host characteristics such as IPv4/IPv6 - MAC bindings. IPv4/IPv6 and MAC counters are also used to determine host liveliness. These mechanisms help determine if a particular IP is inactive. Relay Agents can leverage these to potentially detect IP address inactivity to determine if a particular host has reverted to using a single stack even though it initially had dual-stack capabilities. Similarly, it can also detect active dual-stack usage after long periods of single-stack activity.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.8.p.1">The RELAY-RECONFIG is exchanged only between the DHCPv6 relay agent and DHCPv6 server, section 21.1 of <a href="#RFC3315">[RFC3315]</a> provides details on securing DHCPv6 messages sent between servers and relay agents. And section 23 of <a href="#RFC3315">[RFC3315]</a> provides general DHCPv6 security considerations.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#iana" id="iana">IANA Considerations</a>
</h1>
<p id="rfc.section.9.p.1">IANA is requested to assign new DHCPv6 Message types to RELAY-RECONFIG from the msg-type space as defined in section "DHCP Message Types" of <a href="#RFC3315">[RFC3315]</a>. IANA is requested to assign new option codes to OPTION_RELAY_RECONF from the option-code space as defined in section "DHCPv6 Options" of <a href="#RFC3315">[RFC3315]</a>.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3315">[RFC3315]</b></td>
<td class="top">
<a>Droms, R.</a>, <a>Bound, J.</a>, <a>Volz, B.</a>, <a>Lemon, T.</a>, <a>Perkins, C.</a> and <a>M. Carney</a>, "<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 3315, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3484">[RFC3484]</b></td>
<td class="top">
<a>Draves, R.</a>, "<a href="http://tools.ietf.org/html/rfc3484">Default Address Selection for Internet Protocol version 6 (IPv6)</a>", RFC 3484, February 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3646">[RFC3646]</b></td>
<td class="top">
<a>Droms, R.</a>, "<a href="http://tools.ietf.org/html/rfc3646">DNS Configuration options for Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 3646, December 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6147">[RFC6147]</b></td>
<td class="top">
<a>Bagnulo, M.</a>, <a>Sullivan, A.</a>, <a>Matthews, P.</a> and <a>I. van Beijnum</a>, "<a href="http://tools.ietf.org/html/rfc6147">DNS64: DNS Extensions for Network Address Translation from IPv6 Clients to IPv4 Servers</a>", RFC 6147, April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6052">[RFC6052]</b></td>
<td class="top">
<a>Bao, C.</a>, <a>Huitema, C.</a>, <a>Bagnulo, M.</a>, <a>Boucadair, M.</a> and <a>X. Li</a>, "<a href="http://tools.ietf.org/html/rfc6052">IPv6 Addressing of IPv4/IPv6 Translators</a>", RFC 6052, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6384">[RFC6384]</b></td>
<td class="top">
<a>van Beijnum, I.</a>, "<a href="http://tools.ietf.org/html/rfc6384">An FTP Application Layer Gateway (ALG) for IPv6-to-IPv4 Translation</a>", RFC 6384, October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3633">[RFC3633]</b></td>
<td class="top">
<a>Troan, O.</a> and <a>R. Droms</a>, "<a href="http://tools.ietf.org/html/rfc3633">IPv6 Prefix Options for Dynamic Host Configuration Protocol (DHCP) version 6</a>", RFC 3633, December 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5007">[RFC5007]</b></td>
<td class="top">
<a>Brzozowski, J.</a>, <a>Kinnear, K.</a>, <a>Volz, B.</a> and <a>S. Zeng</a>, "<a href="http://tools.ietf.org/html/rfc5007">DHCPv6 Leasequery</a>", RFC 5007, September 2007.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.wing-behave-dns64-config">[I-D.wing-behave-dns64-config]</b></td>
<td class="top">
<a>Wing, D</a>, "<a href="http://tools.ietf.org/html/draft-wing-behave-dns64-config-03">IPv6-only and Dual Stack Hosts on the Same Network with DNS64</a>", Internet-Draft draft-wing-behave-dns64-config-03, February 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Dan Wing</span> 
	  <span class="n hidden">
		<span class="family-name">Wing</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>170 West Tasman Drive</span>

	  <span class="vcardline">
		<span class="locality">San Jose</span>,  
		<span class="region">California</span> 
		<span class="code">95134</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:dwing@cisco.com">dwing@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tirumaleswar Reddy</span> 
	  <span class="n hidden">
		<span class="family-name">Reddy</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>Cessna Business Park, Varthur Hobli</span>
<span>Sarjapur Marathalli Outer Ring Road</span>

	  <span class="vcardline">
		<span class="locality">Bangalore</span>,  
		<span class="region">Karnataka</span> 
		<span class="code">560103</span>
	  </span>
	  <span class="country-name vcardline">India</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:tireddy@cisco.com">tireddy@cisco.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Prashanth Patil</span> 
	  <span class="n hidden">
		<span class="family-name">Patil</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  <span>Cessna Business Park, Varthur Hobli</span>
<span>Sarjapur Marthalli Outer Ring Road</span>

	  <span class="vcardline">
		<span class="locality">Bangalore</span>,  
		<span class="region">Karnataka</span> 
		<span class="code">560103</span>
	  </span>
	  <span class="country-name vcardline">India</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:praspati@cisco.com">praspati@cisco.com</a></span>

  </address>
</div>

</body>
</html>