
IDR Working Group                                        zhifeng Zhang
Internet Draft                                               (Huawei)
Expires: May 2006
                                                   

                                                            Nov 2005

              draft-zhang-idr-bgp-extcommunity-qos-00.txt

            ExtCommunity map and carry TOS value of IP header 


Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on May 16, 2006.

Copyright Notice

   Copyright (C) The Internet Society (2005).All Rights Reserved.

Abstract
   
   This document defines a new BGP Extended Community, which can map 
   the value of IP TOS. Then, the Extended Community can classified 
   the route information at the same time can carry the value of TOS 
   which will apply into the IP packet. Then BGP and QoS have corre
   -lation when we apply the QoS policy based on BGP,it will be simple.




Zhang zhifeng                                                  [Page 1]


Internet Draft  ExtCommunity map and carry TOS value of IP header  Nov 2005


Table of Contents

   1.   Introduction.................................................2
   2.   The BGP Extended Community map value of TOS..................2
   3.   Format of BGP ExtCommunity...................................2
   4.   Security Considerations......................................5
   5.   References...................................................5
   6.   Author's Addresses...........................................5
   7.   Full Copyright Statement.....................................6


1. Introduction
   
   Since BGP commuity can only classify routing information,if you want to
   apply QoS policy based on BGP ,you can use BGP community to classify 
   route information, then apply the TOS or some other QoS policy based 
   on the classified route information.
  
   If BGP Extended Community can map TOS value of IP header at the same 
   time and keep the ability for classifing route information,the QoS 
   policy based on BGP will be simple.
   
2. The BGP Extended Community map value of TOS 
 
   In this document, we define the capability of Extended Community map 
   and carry the TOS value of IP header. When BGP import route information, 
   this Extended Community can be push or be apply by route policy, then 
   BGP route information can carry the TOS value of IP header. 
 

3. Format of BGP ExtCommunity
 
   The BGP Extended Community is encoded as an eight octet quantity.
     
 
Zhang zhifeng                                                    [Page 2]
 
 
Internet Draft  ExtCommunity map and carry TOS value of IP header  Nov 2005
 

   In this document, we define the Format of the BGP Extended Community 
   as follows:
    
                - Type Field      : 1 octets
                - TOS Value Field : 1 octets
                - Value Field     : Remaining octets
  
        Type Field - the value mark the IANA regist information of BGP    
                     Extended Community and the format of the Value Field
 
        TOS Value Field - the value mark the TOS value that will be carried  
                          by the stream matched correlation networking 
                          information 
                         
        Value Field - the value mark the classified route imformatin 

 
      0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     | Type Field    |TOS Value Field|          Value Field          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
     |                          Value Field                          |
     +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 
3.1 The Type Field
 
   The size of Type Field for Regular types is 1 octet£¬as shown below£º
 
             0 1 2 3 4 5 6 7
            +-+-+-+-+-+-+-+-+
            |I|T|  spare  |V|
            +-+-+-+-+-+-+-+-+
 

            I - IANA authority bit
            T - TOS bit
                Value 0: The TOS Value Field mark the default value 0
                value 1: The TOS Value Field mark the value which would
                         be remarked the IP packet 
            V - The value of this bit which can identify the format of
                the Value Field   

Zhang zhifeng                                                    [Page 3]
 
 
Internet Draft  ExtCommunity map and carry TOS value of IP header  Nov 2005
                 

                Value 0: The high-order two octets of the Value Field is
                         administrator Field, the remaining octets is
                         sub-administrator Field
 
                Value 1: The high-order four octets of the Value Field 
                         is administrator Field, the remaining octets is
                         sub-administrator Field
    
 
3.2 TOS Value Field
 
   The default value of TOS Value Field is 0. When the route information
   be imported into BGP, we can define the TOS Field value that the route 
   informatin should carried.
 
   According to defined DSCP value, we will define such BGP Extended 
   Community:
   

   ExtCommunity name    the high-order     DSCP classes     DSCP values
                        six bits of TOS
                        Value Field                        
   ExtCom-EF             101110               EF              101110
   ExtCom-AF41           100010               AF41            100010
   ExtCom-AF42           100100               AF42            100100
   ExtCom-AF43           100110               AF43            100110
   ExtCom-AF31           011010               AF31            011010
   ExtCom-AF32           011100               AF32            011100
   ExtCom-AF33           011110               AF33            011110
   ExtCom-AF21           010010               AF21            010010
   ExtCom-AF22           010100               AF22            010100
   ExtCom-AF23           010110               AF23            010110
   ExtCom-AF11           001010               AF11            001010
   ExtCom-AF12           001100               AF12            001100
   ExtCom-AF13           001110               AF13            001110
   ExtCom-BF             000000               BF              000000
 
   The remaining bits of TOS Value Field use 0 as value. 
 
Zhang zhifeng                                                    [Page 4]
 
 
Internet Draft  ExtCommunity map and carry TOS value of IP header  Nov 2005


3.3 Value Field   
   
   The Value Field used for identifing the route infomation which belong
   to different community. 
 
   We can set and change the value of the Value Field, and can't impact 
   the other Field.      

4. Security Considerations

   This document does not introduce new security issues.

5. References

   [IP]      Postel  "INTERNET PROTOCOL (IP)", RFC 791,  September 1981.

   [DS Field]    K. Nichols,S. Blake,F. Baker, and D. Black, "Definition 
                   of the Differentiated Services Field (DS Field) in the 
                   IPv4 and IPv6 Headers", RFC 2474, December 1998.
   
   [Architecture for DS]    S. Blake,D. Black,M. Carlson,E. Davies,Z. Wang
                    and W. Weiss "An Architecture for Differentiated Services"
                    RFC 2475, December 1998.    
               

6.   Author's Addresses

     zhifeng Zhang
     Huawei Technologies
     No. 3 Xinxi Road, Shangdi, 
     Haidian District, 
     Beijing, China
     Email: zhangzhifeng@huawei.com 
     



Zhang zhifeng                                                    [Page 5]
 
 
Internet Draft  ExtCommunity map and carry TOS value of IP header  Nov 2005


7. Full Copyright Statement

   Copyright (C) The Internet Society (2005).  

   This document is subject to the rights, licenses and restrictions 
   contained in BCP 78, and except as set forth therein, the authors 
   retain all their rights.


   This document and translations of it MAY be copied and furnished to 
   others, and derivative works that comment on or otherwise explain it 
   or assist in its implementation MAY be prepared, copied, published 
   and distributed, in whole or in part, without restriction of any 
   kind, provided that the above copyright notice and this paragraph 
   are included on all such copies and derivative works. However, this 
   document itself MAY not be modified in any way, such as by removing 
   the copyright notice or references to the Internet Society or other 
   Internet organizations, except as needed for the purpose of 
   developing Internet standards in which case the procedures for 
   copyrights defined in the Internet Standards process MUST be 
   followed, or as required to translate it into languages other than 
   English. 

   The limited permissions granted above are perpetual and will not be 
   revoked by the Internet Society or its successors or assigns.    

   This document and the information contained herein
   are provided on an "AS IS" basis and THE CONTRIBUTOR, THE
   ORGANIZATION HE/SHE REPRESENTS OR IS SPONSORED BY (IF ANY), THE
   INTERNET SOCIETY AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM
   ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO
   ANY WARRANTY THAT THE USE OF THE INFORMATION HEREIN WILL NOT
   INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY
   OR FITNESS FOR A PARTICULAR PURPOSE.

   













Zhang zhifeng                                                    [Page 6]


