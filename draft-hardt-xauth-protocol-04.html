<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>The XAuth Protocol</title>
<meta content="Dick Hardt" name="author">
<meta content="
       Client software often desires resources or identity claims that are independent of the client. This protocol allows a user and/or resource owner to delegate resource authorization and/or release of identity claims to a server. Client software can then request access to resources and/or identity claims by calling the server. The server acquires consent and authorization from the user and/or resource owner if required, and then returns to the client software the authorization and identity claims that were approved. This protocol can be extended to support alternative authorizations, claims, interactions, and client authentication mechanisms. 
    " name="description">
<meta content="xml2rfc 2.40.0" name="generator">
<meta content="draft-hardt-xauth-protocol-04" name="ietf.draft">
<link href="/tmp/draft-hardt-xauth-protocol-04-SWbsoB.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">The XAuth Protocol</td>
<td class="right">February 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hardt</td>
<td class="center">Expires 22 August 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hardt-xauth-protocol-04</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-02-19" class="published">19 February 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-08-22">22 August 2020</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">D. Hardt, <span class="editor">Ed.</span>
</div>
<div class="org">SignIn.Org</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">The XAuth Protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Client software often desires resources or identity claims that are independent of the client. This protocol allows a user and/or resource owner to delegate resource authorization and/or release of identity claims to a server. Client software can then request access to resources and/or identity claims by calling the server. The server acquires consent and authorization from the user and/or resource owner if required, and then returns to the client software the authorization and identity claims that were approved. This protocol can be extended to support alternative authorizations, claims, interactions, and client authentication mechanisms.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note" id="section-note.1">
      <h2 id="name-note-to-readers">
<a href="#name-note-to-readers" class="section-name selfRef">Note to Readers</a>
      </h2>
<p id="section-note.1-1">Source for this draft and an issue tracker can be found at
  <a href="https://github.com/dickhardt/hardt-xauth-protocol">https://github.com/dickhardt/hardt-xauth-protocol</a>.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 22 August 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-parties" class="xref">Parties</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-reused-terms" class="xref">Reused Terms</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-new-terms" class="xref">New Terms</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-sequences" class="xref">Sequences</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-create-grant" class="xref">Create Grant</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-reciprocal-grant" class="xref">Reciprocal Grant</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-gs-initiated-grant" class="xref">GS Initiated Grant</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-create-and-update" class="xref">Create and Update</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-create-and-delete" class="xref">Create and Delete</a><a href="#section-toc.1-1.3.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-create-discover-and-delete" class="xref">Create, Discover, and Delete</a><a href="#section-toc.1-1.3.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-create-and-wait" class="xref">Create and Wait</a><a href="#section-toc.1-1.3.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-read-grant" class="xref">Read Grant</a><a href="#section-toc.1-1.3.2.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.9">
                <p id="section-toc.1-1.3.2.9.1"><a href="#section-3.9" class="xref">3.9</a>.  <a href="#name-access-token-refresh" class="xref">Access Token Refresh</a><a href="#section-toc.1-1.3.2.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.10">
                <p id="section-toc.1-1.3.2.10.1"><a href="#section-3.10" class="xref">3.10</a>. <a href="#name-gs-api-table" class="xref">GS API Table</a><a href="#section-toc.1-1.3.2.10.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-grant-and-authz-life-cycle" class="xref">Grant and AuthZ Life Cycle</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-gs-apis" class="xref">GS APIs</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-create-grant-2" class="xref">Create Grant</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-read-grant-2" class="xref">Read Grant</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-update-grant" class="xref">Update Grant</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-delete-grant" class="xref">Delete Grant</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-request-json" class="xref">Request JSON</a><a href="#section-toc.1-1.5.2.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.1">
                    <p id="section-toc.1-1.5.2.5.2.1.1"><a href="#section-5.5.1" class="xref">5.5.1</a>.  <a href="#name-client-object" class="xref">"client" Object</a><a href="#section-toc.1-1.5.2.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.2">
                    <p id="section-toc.1-1.5.2.5.2.2.1"><a href="#section-5.5.2" class="xref">5.5.2</a>.  <a href="#name-interaction-object" class="xref">"interaction" Object</a><a href="#section-toc.1-1.5.2.5.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.3">
                    <p id="section-toc.1-1.5.2.5.2.3.1"><a href="#section-5.5.3" class="xref">5.5.3</a>.  <a href="#name-user-object" class="xref">"user" Object</a><a href="#section-toc.1-1.5.2.5.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.4">
                    <p id="section-toc.1-1.5.2.5.2.4.1"><a href="#section-5.5.4" class="xref">5.5.4</a>.  <a href="#name-authorization-object" class="xref">"authorization" Object</a><a href="#section-toc.1-1.5.2.5.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.5">
                    <p id="section-toc.1-1.5.2.5.2.5.1"><a href="#section-5.5.5" class="xref">5.5.5</a>.  <a href="#name-authorizations-object" class="xref">"authorizations" Object</a><a href="#section-toc.1-1.5.2.5.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.6">
                    <p id="section-toc.1-1.5.2.5.2.6.1"><a href="#section-5.5.6" class="xref">5.5.6</a>.  <a href="#name-claims-object" class="xref">"claims" Object</a><a href="#section-toc.1-1.5.2.5.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.5.2.7">
                    <p id="section-toc.1-1.5.2.5.2.7.1"><a href="#section-5.5.7" class="xref">5.5.7</a>.  <a href="#name-reciprocal-object" class="xref">"reciprocal" Object</a><a href="#section-toc.1-1.5.2.5.2.7.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-refresh-authorization" class="xref">Refresh Authorization</a><a href="#section-toc.1-1.5.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-update-authorization" class="xref">Update Authorization</a><a href="#section-toc.1-1.5.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.8">
                <p id="section-toc.1-1.5.2.8.1"><a href="#section-5.8" class="xref">5.8</a>.  <a href="#name-delete-authorization" class="xref">Delete Authorization</a><a href="#section-toc.1-1.5.2.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.9">
                <p id="section-toc.1-1.5.2.9.1"><a href="#section-5.9" class="xref">5.9</a>.  <a href="#name-gs-options" class="xref">GS Options</a><a href="#section-toc.1-1.5.2.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.10">
                <p id="section-toc.1-1.5.2.10.1"><a href="#section-5.10" class="xref">5.10</a>. <a href="#name-grant-options" class="xref">Grant Options</a><a href="#section-toc.1-1.5.2.10.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.11">
                <p id="section-toc.1-1.5.2.11.1"><a href="#section-5.11" class="xref">5.11</a>. <a href="#name-authz-options" class="xref">AuthZ Options</a><a href="#section-toc.1-1.5.2.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.12">
                <p id="section-toc.1-1.5.2.12.1"><a href="#section-5.12" class="xref">5.12</a>. <a href="#name-request-verification" class="xref">Request Verification</a><a href="#section-toc.1-1.5.2.12.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-gs-initiated-grant-2" class="xref">GS Initiated Grant</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-gs-api-responses" class="xref">GS API Responses</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-grant-response" class="xref">Grant Response</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-interaction-response" class="xref">Interaction Response</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-wait-response" class="xref">Wait Response</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-response-json" class="xref">Response JSON</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4.2.1">
                    <p id="section-toc.1-1.7.2.4.2.1.1"><a href="#section-7.4.1" class="xref">7.4.1</a>.  <a href="#name-interaction-object-2" class="xref">"interaction" Object</a><a href="#section-toc.1-1.7.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4.2.2">
                    <p id="section-toc.1-1.7.2.4.2.2.1"><a href="#section-7.4.2" class="xref">7.4.2</a>.  <a href="#name-user-object-2" class="xref">"user" Object</a><a href="#section-toc.1-1.7.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4.2.3">
                    <p id="section-toc.1-1.7.2.4.2.3.1"><a href="#section-7.4.3" class="xref">7.4.3</a>.  <a href="#name-authorization-object-2" class="xref">"authorization" Object</a><a href="#section-toc.1-1.7.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4.2.4">
                    <p id="section-toc.1-1.7.2.4.2.4.1"><a href="#section-7.4.4" class="xref">7.4.4</a>.  <a href="#name-authorizations-object-2" class="xref">"authorizations" Object</a><a href="#section-toc.1-1.7.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4.2.5">
                    <p id="section-toc.1-1.7.2.4.2.5.1"><a href="#section-7.4.5" class="xref">7.4.5</a>.  <a href="#name-claims-object-2" class="xref">"claims" Object</a><a href="#section-toc.1-1.7.2.4.2.5.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4.2.6">
                    <p id="section-toc.1-1.7.2.4.2.6.1"><a href="#section-7.4.6" class="xref">7.4.6</a>.  <a href="#name-reciprocal-object-2" class="xref">"reciprocal" Object</a><a href="#section-toc.1-1.7.2.4.2.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4.2.7">
                    <p id="section-toc.1-1.7.2.4.2.7.1"><a href="#section-7.4.7" class="xref">7.4.7</a>.  <a href="#name-interaction-types" class="xref">Interaction Types</a><a href="#section-toc.1-1.7.2.4.2.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.4.2.8">
                    <p id="section-toc.1-1.7.2.4.2.8.1"><a href="#section-7.4.8" class="xref">7.4.8</a>.  <a href="#name-signing-and-encryption" class="xref">Signing and Encryption</a><a href="#section-toc.1-1.7.2.4.2.8.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-response-verification" class="xref">Response Verification</a><a href="#section-toc.1-1.7.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-rs-access" class="xref">RS Access</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-bearer-token" class="xref">Bearer Token</a><a href="#section-toc.1-1.8.2.1.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-error-responses" class="xref">Error Responses</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-jose-authentication" class="xref">JOSE Authentication</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-gs-access" class="xref">GS Access</a><a href="#section-toc.1-1.10.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.10.2.1.2.1">
                    <p id="section-toc.1-1.10.2.1.2.1.1"><a href="#section-10.1.1" class="xref">10.1.1</a>.  <a href="#name-authorization-header" class="xref">Authorization Header</a><a href="#section-toc.1-1.10.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.1.2.2">
                    <p id="section-toc.1-1.10.2.1.2.2.1"><a href="#section-10.1.2" class="xref">10.1.2</a>.  <a href="#name-signed-body" class="xref">Signed Body</a><a href="#section-toc.1-1.10.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.1.2.3">
                    <p id="section-toc.1-1.10.2.1.2.3.1"><a href="#section-10.1.3" class="xref">10.1.3</a>.  <a href="#name-public-key-resolution" class="xref">Public Key Resolution</a><a href="#section-toc.1-1.10.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-rs-access-2" class="xref">RS Access</a><a href="#section-toc.1-1.10.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.10.2.2.2.1">
                    <p id="section-toc.1-1.10.2.2.2.1.1"><a href="#section-10.2.1" class="xref">10.2.1</a>.  <a href="#name-jose-header" class="xref">JOSE header</a><a href="#section-toc.1-1.10.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.2.2.2">
                    <p id="section-toc.1-1.10.2.2.2.2.1"><a href="#section-10.2.2" class="xref">10.2.2</a>.  <a href="#name-jose-mechanism" class="xref">"jose" Mechanism</a><a href="#section-toc.1-1.10.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.2.2.3">
                    <p id="section-toc.1-1.10.2.2.2.3.1"><a href="#section-10.2.3" class="xref">10.2.3</a>.  <a href="#name-josebody-mechanism" class="xref">"jose+body" Mechanism</a><a href="#section-toc.1-1.10.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.2.2.4">
                    <p id="section-toc.1-1.10.2.2.2.4.1"><a href="#section-10.2.4" class="xref">10.2.4</a>.  <a href="#name-public-key-resolution-2" class="xref">Public Key Resolution</a><a href="#section-toc.1-1.10.2.2.2.4.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.  <a href="#name-request-encryption" class="xref">Request Encryption</a><a href="#section-toc.1-1.10.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="xref">10.4</a>.  <a href="#name-response-signing" class="xref">Response Signing</a><a href="#section-toc.1-1.10.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="xref">10.5</a>.  <a href="#name-response-encryption" class="xref">Response Encryption</a><a href="#section-toc.1-1.10.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-extensibility" class="xref">Extensibility</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-rational" class="xref">Rational</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.14.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.15.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-16" class="xref">16</a>. <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.16.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#section-16.1" class="xref">16.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.16.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#section-16.2" class="xref">16.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.16.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-document-history" class="xref">Document History</a><a href="#section-toc.1-1.17.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#section-a.1" class="xref">A.1</a>.  <a href="#name-draft-hardt-xauth-protocol-" class="xref">draft-hardt-xauth-protocol-00</a><a href="#section-toc.1-1.17.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#section-a.2" class="xref">A.2</a>.  <a href="#name-draft-hardt-xauth-protocol-0" class="xref">draft-hardt-xauth-protocol-01</a><a href="#section-toc.1-1.17.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#section-a.3" class="xref">A.3</a>.  <a href="#name-draft-hardt-xauth-protocol-02" class="xref">draft-hardt-xauth-protocol-02</a><a href="#section-toc.1-1.17.2.3.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.17.2.4">
                <p id="section-toc.1-1.17.2.4.1"><a href="#section-a.4" class="xref">A.4</a>.  <a href="#name-draft-hardt-xauth-protocol-03" class="xref">draft-hardt-xauth-protocol-03</a><a href="#section-toc.1-1.17.2.4.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.17.2.5">
                <p id="section-toc.1-1.17.2.5.1"><a href="#section-a.5" class="xref">A.5</a>.  <a href="#name-draft-hardt-xauth-protocol-03-2" class="xref">draft-hardt-xauth-protocol-03</a><a href="#section-toc.1-1.17.2.5.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#section-appendix.b" class="xref">Appendix B</a>.  <a href="#name-comparison-with-oauth-20-an" class="xref">Comparison with OAuth 2.0 and OpenID Connect</a><a href="#section-toc.1-1.18.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#section-appendix.c" class="xref">Appendix C</a>.  <a href="#name-open-questions" class="xref">Open Questions</a><a href="#section-toc.1-1.19.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#section-appendix.d" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-toc.1-1.20.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This protocol supports the widely deployed use cases supported by OAuth 2.0 <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> &amp; <span>[<a href="#RFC6750" class="xref">RFC6750</a>]</span>, and OpenID Connect <span>[<a href="#OIDC" class="xref">OIDC</a>]</span>, an extension of OAuth 2.0, as well as other extensions, and other use cases that are not supported, such as acquiring multiple access tokens at the same time, and updating the request during user interaction. This protocol also addresses many of the security issues in OAuth 2.0 by having parameters securely sent directly between parties, rather than via a browser redirection.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">The technology landscape has changed since OAuth 2.0 was initially drafted. More interactions happen on mobile devices than PCs. Modern browsers now directly support asymetric cryptographic functions. Standards have emerged for signing and encrypting tokens with rich payloads (JOSE) that are widely deployed.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Additional use cases are now being served with extensions to OAuth 2.0: OpenID Connect added support for authentication and releasing identity claims; <span>[<a href="#RFC8252" class="xref">RFC8252</a>]</span> added support for native apps; <span>[<a href="#RFC8628" class="xref">RFC8628</a>]</span> added support for smart devices; and support for <span>[<a href="#browser_based_apps" class="xref">browser_based_apps</a>]</span> is being worked on. There are numerous efforts on adding proof-of-possession to resource access.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This protocol simplifies the overall architectural model, takes advantage of today's technology landscape, provides support for all the widely deployed use cases, and offers numerous extension points.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">While this protocol is not backwards compatible with OAuth 2.0, it strives to minimize the migration effort.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">This protocol centers around a Grant, a representation of the collection of user identity claims and/or resource authorizations the Client is requesting, and the resulting identity claims and/or resource authorizations granted by the Grant Server.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">[Editor: suggestions on how to improve this are welcome!]<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">[Editor: suggestions for other names than XAuth are welcome!]<a href="#section-1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="terminology">
<section id="section-2">
      <h2 id="name-terminology">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
      </h2>
<div id="parties">
<section id="section-2.1">
        <h3 id="name-parties">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-parties" class="section-name selfRef">Parties</a>
        </h3>
<p id="section-2.1-1">The parties and their relationships to each other:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-2.1-2">
<pre>
+--------+                           +------------+
|  User  |                           |  Resource  |
|        |                           | Owner (RO) |
+--------+                           +------------+
    |      \                       /      |
    |       \                     /       |
    |        \                   /        |
    |         \                 /         |
+--------+     +---------------+     +------------+
| Client |----&gt;|     Grant     | _ _ |  Resource  |
|        |&lt;----|  Server (GS)  |     |   Server   |
|        |     +---------------+     |    (RS)    |
|        |--------------------------&gt;|            |
|        |&lt;--------------------------|            |
+--------+                           +------------+
</pre><a href="#section-2.1-2" class="pilcrow">¶</a>
</div>
<ul>
<li id="section-2.1-3.1">
            <strong>User</strong> - the person interacting with the Client who has delegated access to identity claims about themselves to the Grant Server (GS), and can authenticate at the GS.<a href="#section-2.1-3.1" class="pilcrow">¶</a>
</li>
<li id="section-2.1-3.2">
            <strong>Client</strong> - requests a Grant from the GS to access one or more Resource Servers (RSs), and/or identity claims about the User. The Client can create, retrieve, update, and delete a Grant. When a Grant is created, the Client receives from the GS the granted access token(s) for the RS(s), and identity claims about the User. The Client uses an access token to access the RS.  There are two types of Clients: Registered Clients and Dynamic Clients. All Clients have a key to authenticate with the Grant Server.<a href="#section-2.1-3.2" class="pilcrow">¶</a>
</li>
<li id="section-2.1-3.3">
            <strong>Registered Client</strong> - a Client that has registered with the GS and has a Client ID to identify itself, and can prove it possesses a key that is linked to the Client ID. The GS may have different policies for what different Registered Clients can request. A Registered Client MAY be interacting with a User.<a href="#section-2.1-3.3" class="pilcrow">¶</a>
</li>
<li id="section-2.1-3.4">
            <strong>Dynamic Client</strong> - a Client that has not been registered with the GS, and each instance will generate it's own key pair so it can prove it is the same instance of the Client on subsequent requests, and to requests of a Resource Server. A single-page application with no server is an example of a Dynamic Client. A Dynamic Client MUST be interacting with a User.<a href="#section-2.1-3.4" class="pilcrow">¶</a>
</li>
<li id="section-2.1-3.5">
            <strong>Grant Server</strong> (GS) - manages Grants for access to APIs at RSs and release of identity claims about the User. The GS may require explicit consent from the RO or User to provide these to the Client. An GS may support Registered Clients and/or Dynamic Clients. The GS is a combination of the Authorization Server (AS) in OAuth 2.0, and the OpenID Provider (OP) in OpenID Connect.<a href="#section-2.1-3.5" class="pilcrow">¶</a>
</li>
<li id="section-2.1-3.6">
            <strong>Resource Server</strong> (RS) - has API resources that require an access token from the GS. Owned by the Resource Owner.<a href="#section-2.1-3.6" class="pilcrow">¶</a>
</li>
<li id="section-2.1-3.7">
            <strong>Resource Owner</strong> (RO) - owns resources at the RS, and has delegated RS access management to the GS. The RO may be the same entity as the User, or may be a different entity that the GS interacts with independently. GS and RO interactions are out of scope of this document.<a href="#section-2.1-3.7" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="reused-terms">
<section id="section-2.2">
        <h3 id="name-reused-terms">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-reused-terms" class="section-name selfRef">Reused Terms</a>
        </h3>
<ul>
<li id="section-2.2-1.1">
            <strong>access token</strong> - an access token as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> Section 1.4.<a href="#section-2.2-1.1" class="pilcrow">¶</a>
</li>
<li id="section-2.2-1.2">
            <strong>Claim</strong> - a Claim as defined in <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 5. Claims may be issued by the GS, or by other issuers.<a href="#section-2.2-1.2" class="pilcrow">¶</a>
</li>
<li id="section-2.2-1.3">
            <strong>Client ID</strong> - a GS unique identifier for a Registered Client as defined in <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> Section 2.2.<a href="#section-2.2-1.3" class="pilcrow">¶</a>
</li>
<li id="section-2.2-1.4">
            <strong>ID Token</strong> - an ID Token as defined in <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 2.<a href="#section-2.2-1.4" class="pilcrow">¶</a>
</li>
<li id="section-2.2-1.5">
            <strong>NumericDate</strong> - a NumericDate as defined in <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> Section 2.<a href="#section-2.2-1.5" class="pilcrow">¶</a>
</li>
<li id="section-2.2-1.6">
            <strong>authN</strong> - short for authentication.<a href="#section-2.2-1.6" class="pilcrow">¶</a>
</li>
<li id="section-2.2-1.7">
            <strong>authZ</strong> - short for authorization.<a href="#section-2.2-1.7" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="new-terms">
<section id="section-2.3">
        <h3 id="name-new-terms">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-new-terms" class="section-name selfRef">New Terms</a>
        </h3>
<ul>
<li id="section-2.3-1.1">
            <strong>GS URI</strong> - the endpoint at the GS the Client calls to create a Grant. The unique identifier for the GS.<a href="#section-2.3-1.1" class="pilcrow">¶</a>
</li>
<li id="section-2.3-1.2">
            <strong>Grant</strong> - the user identity claims and/or RS authorizations the GS has granted to the Client.<a href="#section-2.3-1.2" class="pilcrow">¶</a>
</li>
<li id="section-2.3-1.3">
            <strong>Grant URI</strong>  - the URI that represents the Grant. The Grant URI MUST start with the GS URI.<a href="#section-2.3-1.3" class="pilcrow">¶</a>
</li>
<li id="section-2.3-1.4">
            <strong>Authorization</strong> - the access granted by the RO to the Client. Contains an access token.<a href="#section-2.3-1.4" class="pilcrow">¶</a>
</li>
<li id="section-2.3-1.5">
            <strong>AuthZ URI</strong> - the URI that represents the Authorization the Client was granted by the RO. The AuthZ URI MUST start with the GS URI. The AuthZ URI is used to refresh, update, and delete an access token.<a href="#section-2.3-1.5" class="pilcrow">¶</a>
</li>
<li id="section-2.3-1.6">
            <strong>interaction</strong> - [Editor: what do we really mean by this term?]<a href="#section-2.3-1.6" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="sequences">
<section id="section-3">
      <h2 id="name-sequences">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-sequences" class="section-name selfRef">Sequences</a>
      </h2>
<p id="section-3-1">Before any sequence, the Client needs to be manually or programmatically configured for the GS. See GS Options <a href="#GSoptions" class="xref">Section 5.9</a> for details on acquiring GS metadata.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">[Editor: a plethora of sequences are included to illustrate all the different actions. Many of these could potentially be moved to a use case document in the future.]<a href="#section-3-2" class="pilcrow">¶</a></p>
<div id="CreateGrantSeq">
<section id="section-3.1">
        <h3 id="name-create-grant">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-create-grant" class="section-name selfRef">Create Grant</a>
        </h3>
<p id="section-3.1-1">The Client requests a Grant from the GS that requires User interaction:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.1-2">
<pre>
+--------+                                  +-------+
| Client |                                  |  GS   |
|        |--(1)--- Create Grant -----------&gt;|       |
|        |                                  |  (2)  |
|        |&lt;--- Interaction Response ---(3)--|  eval |
|        |                                  |       |
|        |--(4)--- Read Grant -------------&gt;|       |         +------+
|        |                                  |       |         | User |
|        |--(5)--- Interaction Transfer --- | - - - | -------&gt;|      |
|        |                                  |       |&lt;--(6)--&gt;|      |
|        |                                  |       |  authN  |      |
|        |                                  |       |&lt;--(7)--&gt;|      |
|        |                                  |       |  authZ  |      |
|        |&lt;--- Interaction Transfer ---(8)- | - - - | --------|      |
|        |                                  |       |         |      |
|        |&lt;--------- Grant Response ---(9)--|       |         +------+
|        |                                  |       |
+--------+                                  +-------+
</pre><a href="#section-3.1-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.1-3">
          <li id="section-3.1-3.1">
            <strong>Create Grant</strong> The Client creates a Grant Request (<a href="#CreateGrant" class="xref">Section 5.1</a>) and sends it with an HTTP POST to the GS GS URI.<a href="#section-3.1-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.1-3.2">
            <strong>Grant Request Evaluation</strong>  The GS processes the request to determine if it will send a Interaction Response, Wait Response, or a Grant Response. The GS determines that interaction with the User is required and sends an Interaction Response. (For readability, this step is not described in the following sequences)<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.1-3.3">
            <strong>Interaction Response</strong>  The GS sends an Interaction Response (<a href="#InteractionResponse" class="xref">Section 7.2</a>) containing the Grant URI and an interaction object.<a href="#section-3.1-3.3" class="pilcrow">¶</a>
</li>
<li id="section-3.1-3.4">
            <strong>Read Grant</strong> The Client does an HTTP GET of the Grant URI (<a href="#ReadGrant" class="xref">Section 5.2</a>).<a href="#section-3.1-3.4" class="pilcrow">¶</a>
</li>
<li id="section-3.1-3.5">
            <strong>Interaction Transfer</strong> The Client transfers User interaction to the GS.<a href="#section-3.1-3.5" class="pilcrow">¶</a>
</li>
<li id="section-3.1-3.6">
            <strong>User Authentication</strong> The GS authenticates the User.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
</li>
<li id="section-3.1-3.7">
            <strong>User Authorization</strong> If required, the GS interacts with the User to determine which identity claims and/or authorizations in the Grant Request are to be granted.<a href="#section-3.1-3.7" class="pilcrow">¶</a>
</li>
<li id="section-3.1-3.8">
            <strong>Interaction Transfer</strong> The GS transfers User interaction to the Client.<a href="#section-3.1-3.8" class="pilcrow">¶</a>
</li>
<li id="section-3.1-3.9">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 7.1</a>).<a href="#section-3.1-3.9" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="reciprocal-grant">
<section id="section-3.2">
        <h3 id="name-reciprocal-grant">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-reciprocal-grant" class="section-name selfRef">Reciprocal Grant</a>
        </h3>
<p id="section-3.2-1">Party A and Party B are both a Client and a GS, and each Client would like a Grant for the other GS. Party A starts off being the Client per Create Grant <a href="#CreateGrantSeq" class="xref">Section 3.1</a>. Party B then includes a Reciprocal Request in its Grant Response. Party A then gets authorization from the User and returns a Grant URI to Party B. Party A and B swap roles, and Party B's Client obtains the Grant from Party A's GS.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.2-2">
<pre>
                Party A                                    Party B
               +--------+                                 +--------+
               | Client |                                 |   GS   |
               ~ ~ ~ ~ ~ ~     Same as steps 1 - 8 of    ~ ~ ~ ~ ~ ~
+------+       |        |        Create Grant above       |        |
| User |       |        |                                 |        |
|      |&lt;----- | - - -  | -- Interaction Transfer ------- |        |
|      |       |        |                                 |        |
|      |       |        |&lt;------- Grant Response ---(1)---|        |
|      |       |        |      Reciprocal Grant Request   |        |
|      |&lt;-(2)-&gt;|        |                                 |        |
|      | AuthZ |        |---(3)--- Update Grant ---------&gt;|        |
+------+       |        |   Reciprocal Grant Response     |        |
               |        |                                 |        |
               |        |&lt;-- Empty Grant Response ---(4)--|        |
               |        |                                 |        |
               +--------+       (5) Swap Roles            +--------+
               |   GS   |                                 | Client |
               |        |&lt;------------ Read Grant ---(6)--|        |
               |        |                                 |        |
               |        |--(7)--- Grant Response --------&gt;|        |
               |        |                                 |        |
               +--------+                                 +--------+
</pre><a href="#section-3.2-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.2-3">
          <li id="section-3.2-3.1">
            <strong>Grant Response</strong> Party B responds with a Grant Response including a Reciprocal Object <a href="#ReciprocalRequest" class="xref">Section 7.4.6</a> requesting its own Grant.<a href="#section-3.2-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.2-3.2">
            <strong>User Authorization</strong> If required, Party A interacts with the User to determine which identity claims and/or authorizations in the Grant Request are to be granted to Party B.<a href="#section-3.2-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.2-3.3">
            <strong>Update Grant</strong> Party A sends an Update Grant request containing the Grant URI in the Reciprocal object <a href="#ReciprocalResponse" class="xref">Section 5.5.7</a>.<a href="#section-3.2-3.3" class="pilcrow">¶</a>
</li>
<li id="section-3.2-3.4">
            <strong>Grant Response</strong> Party B responds with an Empty Grant Response as there were no other requests in the Update Grant.<a href="#section-3.2-3.4" class="pilcrow">¶</a>
</li>
<li id="section-3.2-3.5">
            <strong>Swap Roles</strong> Party A now acts as a GS, Party B as a Client.<a href="#section-3.2-3.5" class="pilcrow">¶</a>
</li>
<li id="section-3.2-3.6">
            <strong>Read Grant</strong> Party B does an HTTP GET of the Grant URI (<a href="#ReadGrant" class="xref">Section 5.2</a>).<a href="#section-3.2-3.6" class="pilcrow">¶</a>
</li>
<li id="section-3.2-3.7">
            <strong>Grant Response</strong> Party A responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 7.1</a>).<a href="#section-3.2-3.7" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="GSInitiatedGrantSeq">
<section id="section-3.3">
        <h3 id="name-gs-initiated-grant">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-gs-initiated-grant" class="section-name selfRef">GS Initiated Grant</a>
        </h3>
<p id="section-3.3-1">The User is at the GS, and wants to interact with a Registered Client. The GS can redirect the User to the Client:<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.3-2">
<pre>
+--------+                                  +-------+         +------+
| Client |                                  |  GS   |         | User |
|        |                                  |       |&lt;--(1)--&gt;|      |
|        |                                  |       |         |      |
|        |&lt;----- GS Initiation Redirect --- | - - - | --(2)---|      |
|   (3)  |                                  |       |         |      |
| verify |--(4)--- Read Grant -------------&gt;|       |         +------+
|        |                                  |       |
|        |&lt;--------- Grant Response --(5)---|       |
|        |                                  |       |
+--------+                                  +-------+
</pre><a href="#section-3.3-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.3-3">
          <li id="section-3.3-3.1">
            <strong>User Interaction</strong> The GS interacts with the User to determine the Client and what identity claims and authorizations to provide. The GS creates a Grant and corresponding Grant URI.<a href="#section-3.3-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.3-3.2">
            <strong>GS Initiated Redirect</strong> The GS redirects the User to the Client's interaction_uri, adding a query parameter with the name "Grant URI" and the value being the URL encoded Grant URI.<a href="#section-3.3-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.3-3.3">
            <strong>Client Verification</strong> The Client verifies the Grant URI is from an GS the Client trusts, and starts with the GS GS URI.<a href="#section-3.3-3.3" class="pilcrow">¶</a>
</li>
<li id="section-3.3-3.4">
            <strong>Read Grant</strong> The Client does an HTTP GET of the Grant URI (<a href="#ReadGrant" class="xref">Section 5.2</a>).<a href="#section-3.3-3.4" class="pilcrow">¶</a>
</li>
<li id="section-3.3-3.5">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 7.1</a>).<a href="#section-3.3-3.5" class="pilcrow">¶</a>
</li>
</ol>
<p id="section-3.3-4">See <a href="#GSInitiatedGrant" class="xref">Section 6</a> for more details.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="create-and-update">
<section id="section-3.4">
        <h3 id="name-create-and-update">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-create-and-update" class="section-name selfRef">Create and Update</a>
        </h3>
<p id="section-3.4-1">The Client requests an identity claim to determine who the User is. Once the Client learns who the User is, and the Client updates the Grant for additional identity claims which the GS prompts the User for and returns to the Client. Once those are received, the Client updates the Grant with the remaining identity claims required.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.4-2">
<pre>
+--------+                                  +-------+
| Client |                                  |  GS   |
|        |--(1)--- Create Grant -----------&gt;|       |
|        |  "interaction"."keep":true       |       |
|        |                                  |       |
|        |&lt;--- Interaction Response ---(2)--|       |
|        |                                  |       |
|        |--(3)--- Read Grant -------------&gt;|       |         +------+
|        |                                  |       |         | User |
|        |--(4)--- Interaction Transfer --- | - - - | -------&gt;|      |
|        |                                  |       |         |      |
|        |                                  |       |&lt;--(5)--&gt;|      |
|        |                                  |       |  authN  |      |
|        |&lt;--------- Grant Response ---(6)--|       |         |      |
|  (7)   |                                  |       |         |      |
|  eval  |--(8)--- Update Grant -----------&gt;|       |         |      |
|        |  "interaction"."keep":true       |       |&lt;--(9)--&gt;|      |
|        |                                  |       |  authZ  |      |
|        |&lt;--------- Grant Response --(10)--|       |         |      |
|  (11)  |                                  |       |         |      |
|  eval  |--(12)-- Update Grant -----------&gt;|       |         |      |
|        |  "interaction"."keep":false      |       |&lt;--(13)-&gt;|      |
|        |                                  |       |  authZ  |      |
|        |                                  |       |         |      |
|        |&lt;--- Interaction Transfer --(14)- | - - - | --------|      |
|        |                                  |       |         |      |
|        |&lt;--------- Grant Response --(15)--|       |         +------+
|        |                                  |       |
+--------+                                  +-------+
</pre><a href="#section-3.4-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.4-3">
          <li id="section-3.4-3.1">
            <strong>Create Grant</strong> The Client creates a Grant Request (<a href="#CreateGrant" class="xref">Section 5.1</a>) including an identity claim and "interaction"."keep":true, and sends it with an HTTP POST to the GS GS URI.<a href="#section-3.4-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.2">
            <strong>Interaction Response</strong>  The GS sends an Interaction Response (<a href="#InteractionResponse" class="xref">Section 7.2</a>) containing the Grant URI, an interaction object, and "interaction"."keep":true.<a href="#section-3.4-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.3">
            <strong>Read Grant</strong> The Client does an HTTP GET of the Grant URI (<a href="#ReadGrant" class="xref">Section 5.2</a>).<a href="#section-3.4-3.3" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.4">
            <strong>Interaction Transfer</strong> The Client transfers User interaction to the GS.<a href="#section-3.4-3.4" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.5">
            <strong>User Authentication</strong> The GS authenticates the User.<a href="#section-3.4-3.5" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.6">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 7.1</a>) including the identity claim from User authentication and "interaction"."keep":true.<a href="#section-3.4-3.6" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.7">
            <strong>Grant Evaluation</strong> The Client queries its User database and does not find a User record matching the identity claim.<a href="#section-3.4-3.7" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.8">
            <strong>Update Grant</strong> The Client creates an Update Grant Request (<a href="#UpdateGrant" class="xref">Section 5.3</a>) including the initial identity claims required and "interaction"."keep":true, and sends it with an HTTP PUT to the Grant URI.<a href="#section-3.4-3.8" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.9">
            <strong>User AuthN</strong> The GS interacts with the User to determine which identity claims in the Update Grant Request are to be granted.<a href="#section-3.4-3.9" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.10">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 7.1</a>) including the identity claims released by the User and "interaction"."keep":true.<a href="#section-3.4-3.10" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.11">
            <strong>Grant Evaluation</strong> The Client evaluates the identity claims in the Grant Response and determines the remaining User identity claim required.<a href="#section-3.4-3.11" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.12">
            <strong>Update Grant</strong> The Client creates an Update Grant Request (<a href="#UpdateGrant" class="xref">Section 5.3</a>) including the remaining required identity claims and "interaction"."keep":false, and sends it with an HTTP PUT to the Grant URI.<a href="#section-3.4-3.12" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.13">
            <strong>User AuthZ</strong> The GS interacts with the User to determine which identity claims in the Update Grant Request are to be granted.<a href="#section-3.4-3.13" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.14">
            <strong>Interaction Transfer</strong> The GS transfers User interaction to the Client.<a href="#section-3.4-3.14" class="pilcrow">¶</a>
</li>
<li id="section-3.4-3.15">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 7.1</a>) including the identity claims released by the User.<a href="#section-3.4-3.15" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="create-and-delete">
<section id="section-3.5">
        <h3 id="name-create-and-delete">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-create-and-delete" class="section-name selfRef">Create and Delete</a>
        </h3>
<p id="section-3.5-1">The Client requests an identity claim to determine who the User is. Once the Client learns who the User is, and the Client knows it has all the identity claims and authorizations needed, the Client deletes the Grant which prompts the GS to transfer the interaction back to the Client.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.5-2">
<pre>
+--------+                                  +-------+
| Client |                                  |  GS   |
|        |--(1)--- Create Grant -----------&gt;|       |
|        |  "interaction"."keep":true       |       |
|        |                                  |       |
|        |&lt;--- Interaction Response ---(2)--|       |
|        |                                  |       |
|        |--(3)--- Read Grant -------------&gt;|       |         +------+
|        |                                  |       |         | User |
|        |--(4)--- Interaction Transfer --- | - - - | -------&gt;|      |
|        |                                  |       |         |      |
|        |                                  |       |&lt;--(5)--&gt;|      |
|        |                                  |       |  authN  |      |
|        |&lt;--------- Grant Response ---(6)--|       |         |      |
|  (7)   |                                  |       |         |      |
|  eval  |--(8)--- Delete Grant -----------&gt;|       |         |      |
|        |&lt;------- Delete Response ---------|       |         |      |
|        |                                  |       |         |      |
|        |&lt;--- Interaction Transfer ---(9)- | - - - | --------|      |
|        |                                  |       |         |      |
+--------+                                  +-------+         +------+
</pre><a href="#section-3.5-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.5-3">
          <li id="section-3.5-3.1">
            <strong>Create Grant</strong> The Client creates a Grant Request (<a href="#CreateGrant" class="xref">Section 5.1</a>) including an identity claim and "interaction"."keep":true, and sends it with an HTTP POST to the GS GS URI.<a href="#section-3.5-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.5-3.2">
            <strong>Interaction Response</strong>  The GS sends an Interaction Response (<a href="#InteractionResponse" class="xref">Section 7.2</a>) containing the Grant URI, an interaction object, and "interaction"."keep":true.<a href="#section-3.5-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.5-3.3">
            <strong>Read Grant</strong> The Client does an HTTP GET of the Grant URI (<a href="#ReadGrant" class="xref">Section 5.2</a>).<a href="#section-3.5-3.3" class="pilcrow">¶</a>
</li>
<li id="section-3.5-3.4">
            <strong>Interaction Transfer</strong> The Client transfers User interaction to the GS.<a href="#section-3.5-3.4" class="pilcrow">¶</a>
</li>
<li id="section-3.5-3.5">
            <strong>User Authentication</strong> The GS authenticates the User.<a href="#section-3.5-3.5" class="pilcrow">¶</a>
</li>
<li id="section-3.5-3.6">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 7.1</a>) including the identity claim from User authentication and "interaction"."keep":true.<a href="#section-3.5-3.6" class="pilcrow">¶</a>
</li>
<li id="section-3.5-3.7">
            <strong>Grant Evaluation</strong> The Client queries its User database and finds the User record matching the identity claim, and that no additional claims or authorizations are required.<a href="#section-3.5-3.7" class="pilcrow">¶</a>
</li>
<li id="section-3.5-3.8">
            <strong>Delete Grant</strong> The Client no longer needs the Grant and decides to Delete Grant (<a href="#DeleteGrant" class="xref">Section 5.4</a>) by sending an HTTP DELETE to the Grant URI. If the GS responds with success the Grant no longer exists.<a href="#section-3.5-3.8" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="create-discover-and-delete">
<section id="section-3.6">
        <h3 id="name-create-discover-and-delete">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-create-discover-and-delete" class="section-name selfRef">Create, Discover, and Delete</a>
        </h3>
<p id="section-3.6-1">The Client wants to discover if the GS has a User with a given identifier. If not, it will abort the request and not transfer interaction to the GS.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.6-2">
<pre>
+--------+                                  +-------+
| Client |                                  |  GS   |
|        |--(1)--- Create Grant -----------&gt;|       |
|        |  "user"."exists":true            |       |
|        |                                  |       |
|        |&lt;--- Interaction Response ---(2)--|       |
|        |     "user"."exists":false        |       |
|        |                                  |       |
|        |--(3)--- Delete Grant -----------&gt;|       |
|        |&lt;------- Delete Response ---------|       |
|        |                                  |       |
+--------+                                  +-------+
</pre><a href="#section-3.6-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.6-3">
          <li id="section-3.6-3.1">
            <strong>Create Grant</strong> The Client creates a Grant Request (<a href="#CreateGrant" class="xref">Section 5.1</a>) including an identity claim request, a User identifier, and "user"."exists":true. The Client sends it with an HTTP POST to the GS GS URI.<a href="#section-3.6-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.6-3.2">
            <strong>Interaction Response</strong>  The GS sends an Interaction Response (<a href="#InteractionResponse" class="xref">Section 7.2</a>) containing the Grant URI, an interaction object, and "user"."exists":false.<a href="#section-3.6-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.6-3.3">
            <strong>Delete Grant</strong> The Client determines the GS cannot fulfil its Grant Request, and decides to Delete Grant (<a href="#DeleteGrant" class="xref">Section 5.4</a>) by sending an HTTP DELETE to the Grant URI. If the GS responds with success the Grant no longer exists.<a href="#section-3.6-3.3" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="create-and-wait">
<section id="section-3.7">
        <h3 id="name-create-and-wait">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-create-and-wait" class="section-name selfRef">Create and Wait</a>
        </h3>
<p id="section-3.7-1">The Client wants access to resources that require the GS to interact with the RO, which may not happen immediately, so the GS instructs the Client to wait and check back later.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.7-2">
<pre>
+--------+                                  +-------+
| Client |                                  |  GS   |
|        |--(1)--- Create Grant -----------&gt;|       |
|        |                                  |       |
|        |&lt;---------- Wait Response ---(2)--|       |         +------+
|  (3)   |                                  |       |         |  RO  |
|  Wait  |                                  |       |&lt;--(4)--&gt;|      |
|        |                                  |       |  authZ  |      |
|        |--(5)--- Read Grant -------------&gt;|       |         +------+
|        |                                  |       |
|        |&lt;--------- Grant Response --(6)---|       |
|        |                                  |       |
+--------+                                  +-------+
</pre><a href="#section-3.7-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.7-3">
          <li id="section-3.7-3.1">
            <strong>Create Grant</strong> The Client creates a Grant Request (<a href="#CreateGrant" class="xref">Section 5.1</a>) and sends it with an HTTP POST to the GS GS URI.<a href="#section-3.7-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.7-3.2">
            <strong>Wait Response</strong>  The GS sends an Interaction Response (<a href="#WaitResponse" class="xref">Section 7.3</a>) containing the Grant URI and wait time.<a href="#section-3.7-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.7-3.3">
            <strong>Client Waits</strong> The Client waits the wait time.<a href="#section-3.7-3.3" class="pilcrow">¶</a>
</li>
<li id="section-3.7-3.4">
            <strong>RO AuthZ</strong> The GS interacts with the RO to determine which identity claims in the Grant Request are to be granted.<a href="#section-3.7-3.4" class="pilcrow">¶</a>
</li>
<li id="section-3.7-3.5">
            <strong>Read Grant</strong> The Client does an HTTP GET of the Grant URI (<a href="#ReadGrant" class="xref">Section 5.2</a>).<a href="#section-3.7-3.5" class="pilcrow">¶</a>
</li>
<li id="section-3.7-3.6">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 7.1</a>).<a href="#section-3.7-3.6" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="read-grant">
<section id="section-3.8">
        <h3 id="name-read-grant">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-read-grant" class="section-name selfRef">Read Grant</a>
        </h3>
<p id="section-3.8-1">The Client wants to acquire fresh identity claims and authorizations in the Grant. No User or RO interaction is required as no new consent or authorization is required.<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.8-2">
<pre>
+--------+                                  +-------+
| Client |                                  |  GS   |
|        |--(1)--- Read Grant -------------&gt;|       |
|        |                                  |       |
|        |&lt;--------- Grant Response --(2)---|       |
|        |                                  |       |
+--------+                                  +-------+
</pre><a href="#section-3.8-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.8-3">
          <li id="section-3.8-3.1">
            <strong>Read Grant</strong> The Client does an HTTP GET of the Grant URI (<a href="#ReadGrant" class="xref">Section 5.2</a>).<a href="#section-3.8-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.8-3.2">
            <strong>Grant Response</strong> The GS responds with a Grant Response (<a href="#GrantResponse" class="xref">Section 7.1</a>) containing updated identity claims and authorizations.<a href="#section-3.8-3.2" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="access-token-refresh">
<section id="section-3.9">
        <h3 id="name-access-token-refresh">
<a href="#section-3.9" class="section-number selfRef">3.9. </a><a href="#name-access-token-refresh" class="section-name selfRef">Access Token Refresh</a>
        </h3>
<p id="section-3.9-1">The Client has an access token and uses it to access resources at an RS. The access token expires, and the Client acquires a fresh access token from the GS.<a href="#section-3.9-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.9-2">
<pre>
+--------+                             +----------+
| Client |                             | Resource |
|        |--(1)--- Access Resource ---&gt;|  Server  |
|        |&lt;------- Resource Response --|   (RS)   |
|        |                             |          |
|        |--(2)--- Access Resource ---&gt;|          |
|        |&lt;------- Error Response -----|          |
|        |                             |          |
|        |                             +----------+  +-------+
|        |                                           |  GS   |
|        |--(3)--- Refresh AuthZ -------------------&gt;|       |
|        |&lt;------- AuthZ Response -------------------|       |
|        |                                           |       |
+--------+                                           +-------+
</pre><a href="#section-3.9-2" class="pilcrow">¶</a>
</div>
<ol start="1" type="1" class="normal type-1" id="section-3.9-3">
          <li id="section-3.9-3.1">
            <strong>Resource Request</strong> The Client accesses the RS with the access token per <a href="#RSAccess" class="xref">Section 8</a> and receives a response from the RS.<a href="#section-3.9-3.1" class="pilcrow">¶</a>
</li>
<li id="section-3.9-3.2">
            <strong>Resource Request</strong> The Client attempts to access the RS, but receives an error indicating the access token has expired.<a href="#section-3.9-3.2" class="pilcrow">¶</a>
</li>
<li id="section-3.9-3.3">
            <strong>Refresh AuthZ</strong> If the Client received an AuthZ URI in the Response JSON "authorization" object (<a href="#ResponseAuthorizationObject" class="xref">Section 7.4.3</a>), the Client can Refresh AuthZ (<a href="#RefreshAuthZ" class="xref">Section 5.6</a>) with an HTTP GET to the AuthZ URI and receive an Response JSON "authorization" object" (<a href="#ResponseAuthorizationObject" class="xref">Section 7.4.3</a>) with a fresh access token.<a href="#section-3.9-3.3" class="pilcrow">¶</a>
</li>
</ol>
</section>
</div>
<div id="gs-api-table">
<section id="section-3.10">
        <h3 id="name-gs-api-table">
<a href="#section-3.10" class="section-number selfRef">3.10. </a><a href="#name-gs-api-table" class="section-name selfRef">GS API Table</a>
        </h3>
<table class="center" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">request</th>
              <th class="text-left" rowspan="1" colspan="1">http verb</th>
              <th class="text-left" rowspan="1" colspan="1">uri</th>
              <th class="text-left" rowspan="1" colspan="1">response</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Create Grant</td>
              <td class="text-left" rowspan="1" colspan="1">POST</td>
              <td class="text-left" rowspan="1" colspan="1">GS URI</td>
              <td class="text-left" rowspan="1" colspan="1">interaction, wait, or grant</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Read Grant</td>
              <td class="text-left" rowspan="1" colspan="1">GET</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">wait, or grant</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Update Grant</td>
              <td class="text-left" rowspan="1" colspan="1">PUT</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">interaction, wait, or grant</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Delete Grant</td>
              <td class="text-left" rowspan="1" colspan="1">DELETE</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">success</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Refresh AuthZ</td>
              <td class="text-left" rowspan="1" colspan="1">GET</td>
              <td class="text-left" rowspan="1" colspan="1">AuthZ URI</td>
              <td class="text-left" rowspan="1" colspan="1">authorization</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Update AuthZ</td>
              <td class="text-left" rowspan="1" colspan="1">PUT</td>
              <td class="text-left" rowspan="1" colspan="1">AuthZ URI</td>
              <td class="text-left" rowspan="1" colspan="1">authorization</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Delete AuthZ</td>
              <td class="text-left" rowspan="1" colspan="1">DELETE</td>
              <td class="text-left" rowspan="1" colspan="1">AuthZ URI</td>
              <td class="text-left" rowspan="1" colspan="1">success</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">GS Options</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONS</td>
              <td class="text-left" rowspan="1" colspan="1">GS URI</td>
              <td class="text-left" rowspan="1" colspan="1">metadata</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Grant Options</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONS</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">metadata</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AuthZ Options</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONS</td>
              <td class="text-left" rowspan="1" colspan="1">AuthZ URI</td>
              <td class="text-left" rowspan="1" colspan="1">metadata</td>
            </tr>
          </tbody>
        </table>
<p id="section-3.10-2">[ Editor: is there value in an API for listing a Client's Grants? eg:]<a href="#section-3.10-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-3.10-3">
<pre>
List Grants     GET     GS URI    JSON array of Grant URIs
</pre><a href="#section-3.10-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="grant-and-authz-life-cycle">
<section id="section-4">
      <h2 id="name-grant-and-authz-life-cycle">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-grant-and-authz-life-cycle" class="section-name selfRef">Grant and AuthZ Life Cycle</a>
      </h2>
<p id="section-4-1">[Editor: straw man for life cycles.]<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2"><strong>Grant life Cycle</strong><a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The Client MAY create, read, update, and delete Grants. A Grant persists until it has expired, is deleted, or another Grant is created for the same GS, Client, and User tuple.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">At any point in time, there can only be one Grant for the GS, Client, and User tuple. When a Client creates a Grant at the same GS for the same User, the GS MUST invalidate a previous Grant for the Client at that GS for that User.<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5"><strong>Authorization Life Cycle</strong><a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">Authorizations are OPTIONALLY included in a Grant Response "authorization" Object (<a href="#ResponseAuthorizationObject" class="xref">Section 7.4.3</a>), and are represented by an AuthZ URI. If an AuthZ URI is included, the Client MAY refresh, update, and delete Authorizations.<a href="#section-4-6" class="pilcrow">¶</a></p>
<p id="section-4-7">An Authorization will persist independent of the Grant, and persist until invalidated by the GS per GS policy, or deleted by the Client.<a href="#section-4-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gs-apis">
<section id="section-5">
      <h2 id="name-gs-apis">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-gs-apis" class="section-name selfRef">GS APIs</a>
      </h2>
<p id="section-5-1"><strong>Client Authentication</strong><a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">All APIs except for GS Options require the Client to authenticate.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">This document defines the JOSE Authentication mechanism in <a href="#JOSEauthN" class="xref">Section 10</a>. Other mechanisms include [TBD].<a href="#section-5-3" class="pilcrow">¶</a></p>
<div id="CreateGrant">
<section id="section-5.1">
        <h3 id="name-create-grant-2">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-create-grant-2" class="section-name selfRef">Create Grant</a>
        </h3>
<p id="section-5.1-1">The Client creates a Grant by doing an HTTP POST of a JSON <span>[<a href="#RFC8259" class="xref">RFC8259</a>]</span> document to the GS URI.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">The JSON document MUST include the following from the Request JSON <a href="#RequestJSON" class="xref">Section 5.5</a>:<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.1-3.1">iat<a href="#section-5.1-3.1" class="pilcrow">¶</a>
</li>
<li id="section-5.1-3.2">nonce<a href="#section-5.1-3.2" class="pilcrow">¶</a>
</li>
<li id="section-5.1-3.3">uri set to the GS URI<a href="#section-5.1-3.3" class="pilcrow">¶</a>
</li>
<li id="section-5.1-3.4">client<a href="#section-5.1-3.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.1-4">and MAY include the following from Request JSON <a href="#RequestJSON" class="xref">Section 5.5</a><a href="#section-5.1-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.1-5.1">user<a href="#section-5.1-5.1" class="pilcrow">¶</a>
</li>
<li id="section-5.1-5.2">interaction<a href="#section-5.1-5.2" class="pilcrow">¶</a>
</li>
<li id="section-5.1-5.3">authorization or authorizations<a href="#section-5.1-5.3" class="pilcrow">¶</a>
</li>
<li id="section-5.1-5.4">claims<a href="#section-5.1-5.4" class="pilcrow">¶</a>
</li>
<li id="section-5.1-5.5">reciprocal<a href="#section-5.1-5.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.1-6">The GS MUST respond with one of Grant Response <a href="#GrantResponse" class="xref">Section 7.1</a>, Interaction Response <a href="#InteractionResponse" class="xref">Section 7.2</a>, Wait Response <a href="#WaitResponse" class="xref">Section 7.3</a>, or one of the following errors:<a href="#section-5.1-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.1-7.1">TBD<a href="#section-5.1-7.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.1-8">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.1-8" class="pilcrow">¶</a></p>
<p id="section-5.1-9">Following is a non-normative example where the Client wants to interact with the User with a popup and is requesting identity claims about the User and read access to the User's contacts:<a href="#section-5.1-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-10">
<pre>
Example 1

{
    "iat"       : 15790460234,
    "uri"       : "https://as.example/endpoint",
    "nonce"     : "f6a60810-3d07-41ac-81e7-b958c0dd21e4",
    "client": {
        "display": {
            "name"  : "SPA Display Name",
            "uri"   : "https://spa.example/about"
        }
    },
    "interaction": {
        "type"      : "popup"
    },
    "authorization": {
        "type"      : "oauth_scope",
        "scope"     : "read_contacts"
    },
    "claims": {
        "oidc": {
            "id_token" : {
                "email"          : { "essential" : true },
                "email_verified" : { "essential" : true }
            },
            "userinfo" : {
                "name"           : { "essential" : true },
                "picture"        : null
            }
        }
    }
}
</pre><a href="#section-5.1-10" class="pilcrow">¶</a>
</div>
<p id="section-5.1-11">Following is a non-normative example where the Client is requesting the GS to keep the interaction with the User after returning the ID Token so the Client can update the Grant, and is also asking if the user exists:<a href="#section-5.1-11" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-12">
<pre>
Example 2

{
    "iat"       : 15790460234,
    "uri"       : "https://as.example/endpoint",
    "nonce"     : "5c9360a5-9065-4f7b-a330-5713909e06c6",
    "client": {
        "id"        : "di3872h34dkJW"
    },
    "interaction": {
        "keep"          : true,
        "type"          : "redirect",
        "redirect_uri"  : "https://web.example/return"
    },
    "user": {
        "identifiers": {
            "email" : "jane.doe@example.com"
        },
        "exists"    : true
    },
    "claims"    : { "oidc": { "id_token" : {} } }
}
</pre><a href="#section-5.1-12" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ReadGrant">
<section id="section-5.2">
        <h3 id="name-read-grant-2">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-read-grant-2" class="section-name selfRef">Read Grant</a>
        </h3>
<p id="section-5.2-1">The Client reads a Grant by doing an HTTP GET of the corresponding Grant URI.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">The GS MUST respond with one of Grant Response <a href="#GrantResponse" class="xref">Section 7.1</a>, Interaction Response <a href="#InteractionResponse" class="xref">Section 7.2</a>, Wait Response <a href="#WaitResponse" class="xref">Section 7.3</a>, or one of the following errors:<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.2-3.1">TBD<a href="#section-5.2-3.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.2-4">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="UpdateGrant">
<section id="section-5.3">
        <h3 id="name-update-grant">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-update-grant" class="section-name selfRef">Update Grant</a>
        </h3>
<p id="section-5.3-1">The Client updates a Grant by doing an HTTP PUT of a JSON document to the corresponding Grant URI.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">The JSON document MUST include the following from the Request JSON <a href="#RequestJSON" class="xref">Section 5.5</a><a href="#section-5.3-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.3-3.1">iat<a href="#section-5.3-3.1" class="pilcrow">¶</a>
</li>
<li id="section-5.3-3.2">uri set to the Grant URI<a href="#section-5.3-3.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.3-4">and MAY include the following from Request JSON <a href="#RequestJSON" class="xref">Section 5.5</a><a href="#section-5.3-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.3-5.1">user<a href="#section-5.3-5.1" class="pilcrow">¶</a>
</li>
<li id="section-5.3-5.2">interaction<a href="#section-5.3-5.2" class="pilcrow">¶</a>
</li>
<li id="section-5.3-5.3">authorization or authorizations<a href="#section-5.3-5.3" class="pilcrow">¶</a>
</li>
<li id="section-5.3-5.4">claims<a href="#section-5.3-5.4" class="pilcrow">¶</a>
</li>
<li id="section-5.3-5.5">reciprocal<a href="#section-5.3-5.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.3-6">The GS MUST respond with one of Grant Response <a href="#GrantResponse" class="xref">Section 7.1</a>, Interaction Response <a href="#InteractionResponse" class="xref">Section 7.2</a>, Wait Response <a href="#WaitResponse" class="xref">Section 7.3</a>, or one of the following errors:<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.3-7.1">TBD<a href="#section-5.3-7.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.3-8">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.3-8" class="pilcrow">¶</a></p>
<p id="section-5.3-9">Following is a non-normative example where the Client made an "interaction"."keep":true request, and now wants to update the request with additional claims:<a href="#section-5.3-9" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.3-10">
<pre>
Example 3

{
    "iat"       : 15790460234,
    "uri"       : "https://as.example/endpoint/grant/example3",
    "claims": {
        "oidc": {
            "userinfo" : {
                "email"          : { "essential" : true },
                "name"           : { "essential" : true },
                "picture"        : null
            }
        }
    }
}
</pre><a href="#section-5.3-10" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="DeleteGrant">
<section id="section-5.4">
        <h3 id="name-delete-grant">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-delete-grant" class="section-name selfRef">Delete Grant</a>
        </h3>
<p id="section-5.4-1">The Client deletes a Grant by doing an HTTP DELETE of the corresponding Grant URI.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">The GS MUST respond with OK 200, or one of the following errors:<a href="#section-5.4-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.4-3.1">TBD<a href="#section-5.4-3.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.4-4">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RequestJSON">
<section id="section-5.5">
        <h3 id="name-request-json">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-request-json" class="section-name selfRef">Request JSON</a>
        </h3>
<p id="section-5.5-1">[Editor: do we want to reuse the JWT claims "iat", "jti", etc.? ]<a href="#section-5.5-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.5-2.1">
            <strong>iat</strong> - the time of the request as a NumericDate.<a href="#section-5.5-2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5-2.2">
            <strong>nonce</strong> - a unique identifier for this request. Note the Grant Response MUST contain a matching nonce attribute value.<a href="#section-5.5-2.2" class="pilcrow">¶</a>
</li>
<li id="section-5.5-2.3">
            <strong>uri</strong> - the GS URI if in a Create Grant <a href="#CreateGrant" class="xref">Section 5.1</a>, or the Grant URI if in an Update Grant <a href="#UpdateGrant" class="xref">Section 5.3</a>.<a href="#section-5.5-2.3" class="pilcrow">¶</a>
</li>
</ul>
<div id="client-object">
<section id="section-5.5.1">
          <h4 id="name-client-object">
<a href="#section-5.5.1" class="section-number selfRef">5.5.1. </a><a href="#name-client-object" class="section-name selfRef">"client" Object</a>
          </h4>
<p id="section-5.5.1-1">The client object MUST contain either the id attribute for Registered Clients, or the display object for Dynamic Clients.<a href="#section-5.5.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.5.1-2.1">
              <strong>id</strong> - the Client ID the GS has for the Registered Client.<a href="#section-5.5.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.1-2.2">
              <p id="section-5.5.1-2.2.1"><strong>display</strong> - the display object contains the following attributes:<a href="#section-5.5.1-2.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.5.1-2.2.2.1">
                  <strong>name</strong> - a string that represents the Dynamic Client<a href="#section-5.5.1-2.2.2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.1-2.2.2.2">
                  <strong>uri</strong> - a URI representing the Dynamic Client<a href="#section-5.5.1-2.2.2.2" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-5.5.1-3">[Editor: a max length for the name?]
[Editor: a max length for the URI?]<a href="#section-5.5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.5.1-4">The name and uri will be displayed by the GS when prompting for authorization.<a href="#section-5.5.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="interaction-object">
<section id="section-5.5.2">
          <h4 id="name-interaction-object">
<a href="#section-5.5.2" class="section-number selfRef">5.5.2. </a><a href="#name-interaction-object" class="section-name selfRef">"interaction" Object</a>
          </h4>
<p id="section-5.5.2-1">The interaction object contains the type of interaction the Client will provide the User. Other attributes<a href="#section-5.5.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.5.2-2.1">
              <strong>keep</strong> - a JSON boolean. If set to the JSON value true, the GS will not transfer the User interaction back to the Client after processing the Grant request. The JSON value false is equivalent to the attribute not being present, and the GS will transfer the User interaction back to the Client after processing the request. This attribute is OPTIONAL<a href="#section-5.5.2-2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.2-2.2">
              <strong>type</strong> - contains one of the following values: "popup", "redirect", "qrcode", or "code". Details in <a href="#InteractionType" class="xref">Section 7.4.7</a>. This attribute is REQUIRED.<a href="#section-5.5.2-2.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.5.2-3">[Editor: do we want this to be an array of types the Client can support? This would only be the case if the GS is not able to support all types and negotiation is required. Is that required?]<a href="#section-5.5.2-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.5.2-4.1">
              <strong>redirect_uri</strong> - this attribute is REQUIRED if the type is "redirect". It is the URI that the Client requests the GS to redirect the User to after the GS has completed interacting with the User. If the Client manages session state in URIs, then the redirect_uri SHOULD contain that state.<a href="#section-5.5.2-4.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.2-4.2">
              <strong>completion_uri</strong> - this attribute is OPTIONAL and is ignored unless the type is "qrcode" or "code". This is the URI the Client would like the GS to redirect the User to after the interaction with the User is complete.<a href="#section-5.5.2-4.2" class="pilcrow">¶</a>
</li>
<li id="section-5.5.2-4.3">
              <strong>ui_locales</strong> - End-User's preferred languages and scripts for the user interface, represented as a space-separated list of <span>[<a href="#RFC5646" class="xref">RFC5646</a>]</span> language tag values, ordered by preference. This attribute is OPTIONAL.<a href="#section-5.5.2-4.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.5.2-5">[Editor: do we need max pixels or max chars for qrcode interaction? Either passed to GS, or max specified values here?]<a href="#section-5.5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.5.2-6">[Editor: other possible interaction models could be a "webview", where the Client can display a web page, or just a "message", where the client can only display a text message]<a href="#section-5.5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.5.2-7">[Editor: we may need to include interaction types for iOS and Android as the mobile OS APIs evolve.]<a href="#section-5.5.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="RequestUserObject">
<section id="section-5.5.3">
          <h4 id="name-user-object">
<a href="#section-5.5.3" class="section-number selfRef">5.5.3. </a><a href="#name-user-object" class="section-name selfRef">"user" Object</a>
          </h4>
<ul>
<li id="section-5.5.3-1.1">
              <strong>exists</strong> - MUST contain the JSON true value. Indicates the Client requests the GS to return a "user"."exists" value in an Interaction Response <a href="#InteractionResponse" class="xref">Section 7.2</a>. This attribute is OPTIONAL, and MAY be ignored by the GS.<a href="#section-5.5.3-1.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.3-1.2">
              <p id="section-5.5.3-1.2.1"><strong>identifiers</strong> - REQUIRED if the exists attribute is present. The values MAY be used by the GS to improve the User experience. Contains one or more of the following identifiers for the User:<a href="#section-5.5.3-1.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.5.3-1.2.2.1">
                  <strong>phone_number</strong> - contains a phone number per Section 5 of <span>[<a href="#RFC3966" class="xref">RFC3966</a>]</span>.<a href="#section-5.5.3-1.2.2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.3-1.2.2.2">
                  <strong>email</strong> - contains an email address per <span>[<a href="#RFC5322" class="xref">RFC5322</a>]</span>.<a href="#section-5.5.3-1.2.2.2" class="pilcrow">¶</a>
</li>
<li id="section-5.5.3-1.2.2.3">
                  <strong>oidc_id_token</strong> - is an OpenID Connect ID Token per <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 2.<a href="#section-5.5.3-1.2.2.3" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
</section>
</div>
<div id="AuthorizationObject">
<section id="section-5.5.4">
          <h4 id="name-authorization-object">
<a href="#section-5.5.4" class="section-number selfRef">5.5.4. </a><a href="#name-authorization-object" class="section-name selfRef">"authorization" Object</a>
          </h4>
<ul>
<li id="section-5.5.4-1.1">
              <strong>type</strong> - one of the following values: "oauth_scope" or "oauth_rich". This attribute is REQUIRED.<a href="#section-5.5.4-1.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.4-1.2">
              <strong>scope</strong> - a string containing the OAuth 2.0 scope per <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span> section 3.3. MUST be included if type is "oauth_scope" or "oauth_rich".<a href="#section-5.5.4-1.2" class="pilcrow">¶</a>
</li>
<li id="section-5.5.4-1.3">
              <strong>authorization_details</strong> - an authorization_details object per <span>[<a href="#RAR" class="xref">RAR</a>]</span>. MUST be included if type is "oauth_rich".<a href="#section-5.5.4-1.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.5.4-2">[Editor: details may change as the <span>[<a href="#RAR" class="xref">RAR</a>]</span> document evolves]<a href="#section-5.5.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authorizations-object">
<section id="section-5.5.5">
          <h4 id="name-authorizations-object">
<a href="#section-5.5.5" class="section-number selfRef">5.5.5. </a><a href="#name-authorizations-object" class="section-name selfRef">"authorizations" Object</a>
          </h4>
<p id="section-5.5.5-1">A JSON array of "authorization" objects. Only one of "authorization" or "authorizations" may be in the Request JSON.<a href="#section-5.5.5-1" class="pilcrow">¶</a></p>
<p id="section-5.5.5-2">[Editor: instead of an array, we could have a Client defined dictionary of "authorization" objects]<a href="#section-5.5.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ClaimsObject">
<section id="section-5.5.6">
          <h4 id="name-claims-object">
<a href="#section-5.5.6" class="section-number selfRef">5.5.6. </a><a href="#name-claims-object" class="section-name selfRef">"claims" Object</a>
          </h4>
<p id="section-5.5.6-1">Includes one or more of the following:<a href="#section-5.5.6-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.5.6-2.1">
              <p id="section-5.5.6-2.1.1"><strong>oidc</strong> - an object that contains one or both of the following objects:<a href="#section-5.5.6-2.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.5.6-2.1.2.1">
                  <strong>userinfo</strong> - Claims that will be returned as a JSON object<a href="#section-5.5.6-2.1.2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.6-2.1.2.2">
                  <strong>id_token</strong> - Claims that will be included in the returned ID Token. If the null value, an ID Token will be returned containing no additional Claims.<a href="#section-5.5.6-2.1.2.2" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-5.5.6-3">The contents of the userinfo and id_token objects are Claims as defined in <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 5.<a href="#section-5.5.6-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.5.6-4.1">
              <strong>oidc4ia</strong> - OpenID Connect for Identity Assurance claims request per <span>[<a href="#OIDC4IA" class="xref">OIDC4IA</a>]</span>.<a href="#section-5.5.6-4.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.6-4.2">
              <strong>vc</strong> - [Editor: define how W3C Verifiable Credentials <span>[<a href="#W3C_VC" class="xref">W3C_VC</a>]</span> can be requested.]<a href="#section-5.5.6-4.2" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="ReciprocalResponse">
<section id="section-5.5.7">
          <h4 id="name-reciprocal-object">
<a href="#section-5.5.7" class="section-number selfRef">5.5.7. </a><a href="#name-reciprocal-object" class="section-name selfRef">"reciprocal" Object</a>
          </h4>
<ul>
<li id="section-5.5.7-1.1">
              <strong>uri</strong> - the Grant URI for the Reciprocal Grant. This attribute is REQUIRED.<a href="#section-5.5.7-1.1" class="pilcrow">¶</a>
</li>
<li id="section-5.5.7-1.2">
              <strong>client</strong> - the client object must contain the "id" attribute with the Client ID the Grant was issued to. This attribute is REQUIRED.<a href="#section-5.5.7-1.2" class="pilcrow">¶</a>
</li>
<li id="section-5.5.7-1.3">
              <strong>authorization</strong> - an authorization object per <a href="#ResponseAuthorizationObject" class="xref">Section 7.4.3</a> in the Response JSON.<a href="#section-5.5.7-1.3" class="pilcrow">¶</a>
</li>
<li id="section-5.5.7-1.4">
              <strong>authorizations</strong> - an authorizations object per <a href="#ResponseAuthorizationsObject" class="xref">Section 7.4.4</a> in the Response JSON.<a href="#section-5.5.7-1.4" class="pilcrow">¶</a>
</li>
<li id="section-5.5.7-1.5">
              <strong>claims</strong> - a claims object per <a href="#ResponseClaimsObject" class="xref">Section 7.4.5</a> in the Response JSON.<a href="#section-5.5.7-1.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.5.7-2">[Editor: parameters for the Client to request it wants the Grant Response signed and/or encrypted?]<a href="#section-5.5.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="RefreshAuthZ">
<section id="section-5.6">
        <h3 id="name-refresh-authorization">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-refresh-authorization" class="section-name selfRef">Refresh Authorization</a>
        </h3>
<p id="section-5.6-1">The Client updates an Authorization by doing an HTTP GET to the corresponding AuthZ URI.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
<p id="section-5.6-2">The GS MUST respond with an Response JSON "authorization" object <a href="#ResponseAuthorizationObject" class="xref">Section 7.4.3</a>, or one of the following errors:<a href="#section-5.6-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.6-3.1">TBD<a href="#section-5.6-3.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.6-4">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.6-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="UpdateAuthZ">
<section id="section-5.7">
        <h3 id="name-update-authorization">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-update-authorization" class="section-name selfRef">Update Authorization</a>
        </h3>
<p id="section-5.7-1">The Client updates an Authorization by doing an HTTP PUT to the corresponding AuthZ URI of the following JSON. All of the following MUST be included.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.7-2.1">
            <strong>iat</strong> - the time of the response as a NumericDate.<a href="#section-5.7-2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.7-2.2">
            <strong>uri</strong> - the AuthZ URI.<a href="#section-5.7-2.2" class="pilcrow">¶</a>
</li>
<li id="section-5.7-2.3">
            <strong>authorization</strong> - the new authorization requested per the Request JSON "authorization" object <a href="#AuthorizationObject" class="xref">Section 5.5.4</a>.<a href="#section-5.7-2.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.7-3">The GS MUST respond with an Response JSON "authorization" object <a href="#ResponseAuthorizationObject" class="xref">Section 7.4.3</a>, or one of the following errors:<a href="#section-5.7-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.7-4.1">TBD<a href="#section-5.7-4.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.7-5">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.7-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="delete-authorization">
<section id="section-5.8">
        <h3 id="name-delete-authorization">
<a href="#section-5.8" class="section-number selfRef">5.8. </a><a href="#name-delete-authorization" class="section-name selfRef">Delete Authorization</a>
        </h3>
<p id="section-5.8-1">The Client deletes an Authorization by doing an HTTP DELETE to the corresponding AuthZ URI.<a href="#section-5.8-1" class="pilcrow">¶</a></p>
<p id="section-5.8-2">The GS MUST respond with OK 200, or one of the following errors:<a href="#section-5.8-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.8-3.1">TBD<a href="#section-5.8-3.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.8-4">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.8-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="GSoptions">
<section id="section-5.9">
        <h3 id="name-gs-options">
<a href="#section-5.9" class="section-number selfRef">5.9. </a><a href="#name-gs-options" class="section-name selfRef">GS Options</a>
        </h3>
<p id="section-5.9-1">The Client can get the metadata for the GS by doing an HTTP OPTIONS of the corresponding GS URI. This is the only API where the GS MAY respond to an unauthenticated request.<a href="#section-5.9-1" class="pilcrow">¶</a></p>
<p id="section-5.9-2">The GS MUST respond with the the following JSON document:<a href="#section-5.9-2" class="pilcrow">¶</a></p>
<p id="section-5.9-3">[Editor: this section is a work in progress]<a href="#section-5.9-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.9-4.1">
            <strong>uri</strong> - the GS URI.<a href="#section-5.9-4.1" class="pilcrow">¶</a>
</li>
<li id="section-5.9-4.2">
            <strong>client_authentication</strong> - an array of the Client Authentication mechanisms supported by the GS<a href="#section-5.9-4.2" class="pilcrow">¶</a>
</li>
<li id="section-5.9-4.3">
            <strong>interactions</strong> - an array of the interaction types supported by the GS.<a href="#section-5.9-4.3" class="pilcrow">¶</a>
</li>
<li id="section-5.9-4.4">
            <p id="section-5.9-4.4.1"><strong>authorization</strong> - an object containing the authorizations the Client may request from the GS, if any.<a href="#section-5.9-4.4.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.9-4.4.2.1">Details TBD<a href="#section-5.9-4.4.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-5.9-4.5">
            <p id="section-5.9-4.5.1"><strong>claims</strong> - an object containing the identity claims the Client may request from the GS, if any, and what public keys the claims will be signed with.<a href="#section-5.9-4.5.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.9-4.5.2.1">Details TBD<a href="#section-5.9-4.5.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-5.9-4.6">
            <strong>algorithms</strong> - a list of the cryptographic algorithms supported by the GS.<a href="#section-5.9-4.6" class="pilcrow">¶</a>
</li>
<li id="section-5.9-4.7">
            <p id="section-5.9-4.7.1"><strong>features</strong> - an object containing feature support<a href="#section-5.9-4.7.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.9-4.7.2.1">
                <strong>user_exists</strong> - boolean indicating if "user"."exists" is supported.<a href="#section-5.9-4.7.2.1" class="pilcrow">¶</a>
</li>
<li id="section-5.9-4.7.2.2">
                <strong>authorizations</strong> - boolean indicating if a request for multiple authorizations is supported.<a href="#section-5.9-4.7.2.2" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-5.9-5">[Editor: keys used by Client to encrypt requests, or verify signed responses?]<a href="#section-5.9-5" class="pilcrow">¶</a></p>
<p id="section-5.9-6">[Editor: namespace metadata for extensions?]<a href="#section-5.9-6" class="pilcrow">¶</a></p>
<p id="section-5.9-7">or one of the following errors:<a href="#section-5.9-7" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.9-8.1">TBD<a href="#section-5.9-8.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.9-9">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.9-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="GrantOptions">
<section id="section-5.10">
        <h3 id="name-grant-options">
<a href="#section-5.10" class="section-number selfRef">5.10. </a><a href="#name-grant-options" class="section-name selfRef">Grant Options</a>
        </h3>
<p id="section-5.10-1">The Client can get the metadata for the Grant by doing an HTTP OPTIONS of the corresponding  Grant URI.<a href="#section-5.10-1" class="pilcrow">¶</a></p>
<p id="section-5.10-2">The GS MUST respond with the the following JSON document:<a href="#section-5.10-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.10-3.1">
            <strong>verbs</strong> - an array of the HTTP verbs supported at the GS URI.<a href="#section-5.10-3.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.10-4">or one of the following errors:<a href="#section-5.10-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.10-5.1">TBD<a href="#section-5.10-5.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.10-6">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.10-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="AuthZOptions">
<section id="section-5.11">
        <h3 id="name-authz-options">
<a href="#section-5.11" class="section-number selfRef">5.11. </a><a href="#name-authz-options" class="section-name selfRef">AuthZ Options</a>
        </h3>
<p id="section-5.11-1">The Client can get the metadata for the AuthZ by doing an HTTP OPTIONS of the corresponding AuthZ URI.<a href="#section-5.11-1" class="pilcrow">¶</a></p>
<p id="section-5.11-2">The GS MUST respond with the the following JSON document:<a href="#section-5.11-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.11-3.1">
            <strong>verbs</strong> - an array of the HTTP verbs supported at the GS URI.<a href="#section-5.11-3.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.11-4">or one of the following errors:<a href="#section-5.11-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.11-5.1">TBD<a href="#section-5.11-5.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-5.11-6">from Error Responses <a href="#ErrorResponses" class="xref">Section 9</a>.<a href="#section-5.11-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="request-verification">
<section id="section-5.12">
        <h3 id="name-request-verification">
<a href="#section-5.12" class="section-number selfRef">5.12. </a><a href="#name-request-verification" class="section-name selfRef">Request Verification</a>
        </h3>
<p id="section-5.12-1">On receipt of a request, the GS MUST verify the following:<a href="#section-5.12-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-5.12-2.1">TBD<a href="#section-5.12-2.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="GSInitiatedGrant">
<section id="section-6">
      <h2 id="name-gs-initiated-grant-2">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-gs-initiated-grant-2" class="section-name selfRef">GS Initiated Grant</a>
      </h2>
<p id="section-6-1">[Editor: In OAuth 2.0, all flows are initiated at the Client. If the AS wanted to initiate a flow, it redirected to the Client, that redirected back to the AS to initiate a flow.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Here is a proposal to support GS initiated: authentication; just-in-time (JIT) provisioning; and authorization]<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3"><strong>initiation_uri</strong> A URI at the Client that contains no query or fragment. How the GS learns the Client initiation_uri is out of scope.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">The GS creates a Grant and Grant URI, and redirects the User to the initiation_uri with the query parameter "grant" and the value of Grant URI.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">See <a href="#GSInitiatedGrantSeq" class="xref">Section 3.3</a> for the sequence diagram.<a href="#section-6-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="gs-api-responses">
<section id="section-7">
      <h2 id="name-gs-api-responses">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-gs-api-responses" class="section-name selfRef">GS API Responses</a>
      </h2>
<div id="GrantResponse">
<section id="section-7.1">
        <h3 id="name-grant-response">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-grant-response" class="section-name selfRef">Grant Response</a>
        </h3>
<p id="section-7.1-1">The Grant Response MUST include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 7.4</a><a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.1-2.1">iat<a href="#section-7.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-7.1-2.2">nonce<a href="#section-7.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-7.1-2.3">uri<a href="#section-7.1-2.3" class="pilcrow">¶</a>
</li>
<li id="section-7.1-2.4">expires_in<a href="#section-7.1-2.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.1-3">and MAY include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 7.4</a><a href="#section-7.1-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.1-4.1">authorization or authorizations<a href="#section-7.1-4.1" class="pilcrow">¶</a>
</li>
<li id="section-7.1-4.2">claims<a href="#section-7.1-4.2" class="pilcrow">¶</a>
</li>
<li id="section-7.1-4.3">reciprocal<a href="#section-7.1-4.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.1-5">Example non-normative Grant Response JSON document for Example 1 in <a href="#CreateGrantSeq" class="xref">Section 3.1</a>:<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.1-6">
<pre>
{
    "iat"           : 15790460234,
    "nonce"         : "f6a60810-3d07-41ac-81e7-b958c0dd21e4",
    "uri"           : "https://as.example/endpoint/grant/example1",
    "expires_in"    : 300
    "authorization": {
        "type"          : "oauth_scope",
        "scope"         : "read_contacts",
        "expires_in"    : 3600,
        "mechanism"     : "bearer",
        "token"         : "eyJJ2D6.example.access.token.mZf9p"
    },
    "claims": {
        "oidc": {
            "id_token"      : "eyJhbUzI1N.example.id.token.YRw5DFdbW",
            "userinfo" : {
                "name"      : "John Doe",
                "picture"   : "https://photos.example/p/eyJzdkiO"
            }
        }
    }
}
</pre><a href="#section-7.1-6" class="pilcrow">¶</a>
</div>
<p id="section-7.1-7">Example non-normative Grant Response JSON document for Example 2 in <a href="#CreateGrantSeq" class="xref">Section 3.1</a>:<a href="#section-7.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.1-8">
<pre>
{
    "iat"   : 15790460234,
    "nonce" : "5c9360a5-9065-4f7b-a330-5713909e06c6",
    "uri"   : "https://as.example/endpoint/grant/example2",
    "authorization": {
        "type"          : "oauth_scope",
        "scope"         : "read_calendar write_calendar",
        "expires_in"    : 3600,
        "mechanism"     : "jose",
        "token"         : "eyJJ2D6.example.access.token.mZf9p"
        "certificate": {
            "x5u"   : "https://as.example/cert/example2"
        },
        "uri"       : "https://as.example/endpoint/authz/example2"
    }
}
</pre><a href="#section-7.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="InteractionResponse">
<section id="section-7.2">
        <h3 id="name-interaction-response">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-interaction-response" class="section-name selfRef">Interaction Response</a>
        </h3>
<p id="section-7.2-1">The Interaction Response MUST include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 7.4</a><a href="#section-7.2-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.2-2.1">iat<a href="#section-7.2-2.1" class="pilcrow">¶</a>
</li>
<li id="section-7.2-2.2">nonce<a href="#section-7.2-2.2" class="pilcrow">¶</a>
</li>
<li id="section-7.2-2.3">uri<a href="#section-7.2-2.3" class="pilcrow">¶</a>
</li>
<li id="section-7.2-2.4">interaction<a href="#section-7.2-2.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.2-3">and MAY include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 7.4</a><a href="#section-7.2-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.2-4.1">user<a href="#section-7.2-4.1" class="pilcrow">¶</a>
</li>
<li id="section-7.2-4.2">wait<a href="#section-7.2-4.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.2-5">A non-normative example of an Interaction Response follows:<a href="#section-7.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.2-6">
<pre>
{
    "iat"       : 15790460234,
    "nonce"     : "0d1998d8-fbfa-4879-b942-85a88bff1f3b",
    "uri"       : "https://as.example/endpoint/grant/example4",
    "interaction" : {
        "type"                  : "popup",
        "authorization_uri"     : "https://as.example/popup/example4"
    },
    "user": {
        "exists" : true
    }
}
</pre><a href="#section-7.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="WaitResponse">
<section id="section-7.3">
        <h3 id="name-wait-response">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-wait-response" class="section-name selfRef">Wait Response</a>
        </h3>
<p id="section-7.3-1">The Wait Response MUST include the following from the Response JSON <a href="#ResponseJSON" class="xref">Section 7.4</a><a href="#section-7.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.3-2.1">iat<a href="#section-7.3-2.1" class="pilcrow">¶</a>
</li>
<li id="section-7.3-2.2">nonce<a href="#section-7.3-2.2" class="pilcrow">¶</a>
</li>
<li id="section-7.3-2.3">uri<a href="#section-7.3-2.3" class="pilcrow">¶</a>
</li>
<li id="section-7.3-2.4">wait<a href="#section-7.3-2.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.3-3">A non-normative example of Wait Response follows:<a href="#section-7.3-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-7.3-4">
<pre>
{
    "iat"       : 15790460234,
    "nonce"     : "0d1998d8-fbfa-4879-b942-85a88bff1f3b",
    "uri"       : "https://as.example/endpoint/grant/example5",
    "wait"      : 300
}
</pre><a href="#section-7.3-4" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="ResponseJSON">
<section id="section-7.4">
        <h3 id="name-response-json">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-response-json" class="section-name selfRef">Response JSON</a>
        </h3>
<p id="section-7.4-1">Details of the JSON document:<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4-2.1">
            <strong>iat</strong> - the time of the response as a NumericDate.<a href="#section-7.4-2.1" class="pilcrow">¶</a>
</li>
<li id="section-7.4-2.2">
            <strong>nonce</strong> - the nonce that was included in the Request JSON <a href="#RequestJSON" class="xref">Section 5.5</a>.<a href="#section-7.4-2.2" class="pilcrow">¶</a>
</li>
<li id="section-7.4-2.3">
            <strong>uri</strong> - the Grant URI.<a href="#section-7.4-2.3" class="pilcrow">¶</a>
</li>
<li id="section-7.4-2.4">
            <strong>wait</strong> - a numeric value representing the number of seconds the Client should want before making a Read Grant request to the Grant URI.<a href="#section-7.4-2.4" class="pilcrow">¶</a>
</li>
<li id="section-7.4-2.5">
            <strong>expires_in</strong> - a numeric value specifying how many seconds until the Grant expires. This attribute is OPTIONAL.<a href="#section-7.4-2.5" class="pilcrow">¶</a>
</li>
</ul>
<div id="interactionObject">
<section id="section-7.4.1">
          <h4 id="name-interaction-object-2">
<a href="#section-7.4.1" class="section-number selfRef">7.4.1. </a><a href="#name-interaction-object-2" class="section-name selfRef">"interaction" Object</a>
          </h4>
<p id="section-7.4.1-1">If the GS wants the Client to start the interaction, the GS MUST return the interaction mechanism provided by the Client in the Grant Request, and include the required attributes in the interaction object:<a href="#section-7.4.1-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4.1-2.1">
              <strong>type</strong> - this MUST match the type provided by the Client in the Grant Request client.interaction object.<a href="#section-7.4.1-2.1" class="pilcrow">¶</a>
</li>
<li id="section-7.4.1-2.2">
              <strong>authorization_uri</strong> - the URI to redirect the user to or load in the popup. Must be included if type is  "popup" and "redirect"<a href="#section-7.4.1-2.2" class="pilcrow">¶</a>
</li>
<li id="section-7.4.1-2.3">
              <strong>display_uri</strong> - the URI to be displayed to the User for them to navigate to and enter the code. Must be included if type is "qrcode" and "code"<a href="#section-7.4.1-2.3" class="pilcrow">¶</a>
</li>
<li id="section-7.4.1-2.4">
              <strong>qr_uri</strong> - the URI to show as a QR code. MUST be included if type is "qrcode"<a href="#section-7.4.1-2.4" class="pilcrow">¶</a>
</li>
<li id="section-7.4.1-2.5">
              <strong>user_code</strong> - a text string of the code to display to the User. Must be included if type is "qrcode" or "code".<a href="#section-7.4.1-2.5" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.4.1-3">[Editor: do we specify a maximum length for the display_uri and code so that a device knows the maximum it needs to support? A smart device may have limited screen real estate.]<a href="#section-7.4.1-3" class="pilcrow">¶</a></p>
<p id="section-7.4.1-4">The authorization_uri, qr_uri, and user_code MUST be unique and only match the associated Grant URI.<a href="#section-7.4.1-4" class="pilcrow">¶</a></p>
<p id="section-7.4.1-5">TBD: entropy and other security considerations for the authorization_uri, qr_uri, and the user_code.<a href="#section-7.4.1-5" class="pilcrow">¶</a></p>
<p id="section-7.4.1-6">See Interaction Types <a href="#InteractionType" class="xref">Section 7.4.7</a> for details.<a href="#section-7.4.1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="user-object">
<section id="section-7.4.2">
          <h4 id="name-user-object-2">
<a href="#section-7.4.2" class="section-number selfRef">7.4.2. </a><a href="#name-user-object-2" class="section-name selfRef">"user" Object</a>
          </h4>
<ul>
<li id="section-7.4.2-1.1">
              <strong>exists</strong> - a boolean value indicating if the GS has a user with one or more of the provided identifiers in the Request "user"."identifiers" object <a href="#RequestUserObject" class="xref">Section 5.5.3</a><a href="#section-7.4.2-1.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="ResponseAuthorizationObject">
<section id="section-7.4.3">
          <h4 id="name-authorization-object-2">
<a href="#section-7.4.3" class="section-number selfRef">7.4.3. </a><a href="#name-authorization-object-2" class="section-name selfRef">"authorization" Object</a>
          </h4>
<p id="section-7.4.3-1">The "authorization" object is a response to the Request "authorization" object <a href="#AuthorizationObject" class="xref">Section 5.5.4</a>, the Refresh Authorization <a href="#RefreshAuthZ" class="xref">Section 5.6</a>, or the Update Authorization <a href="#UpdateAuthZ" class="xref">Section 5.7</a>.<a href="#section-7.4.3-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4.3-2.1">
              <strong>type</strong> - the type of claim request: "oauth_scope" or "oauth_rich". See the "type" object in <a href="#AuthorizationObject" class="xref">Section 5.5.4</a> for details.<a href="#section-7.4.3-2.1" class="pilcrow">¶</a>
</li>
<li id="section-7.4.3-2.2">
              <strong>scope</strong> - the scopes the Client was granted authorization for. This will be all, or a subset, of what was requested. This attribute is OPTIONAL.<a href="#section-7.4.3-2.2" class="pilcrow">¶</a>
</li>
<li id="section-7.4.3-2.3">
              <strong>authorization_details</strong> - the authorization details granted per <span>[<a href="#RAR" class="xref">RAR</a>]</span>. Included if type is "oauth_rich".<a href="#section-7.4.3-2.3" class="pilcrow">¶</a>
</li>
<li id="section-7.4.3-2.4">
              <strong>mechanism</strong> - one of the access mechanisms: "bearer", "jose", or "jose+body". See <a href="#RSAccess" class="xref">Section 8</a> for details.<a href="#section-7.4.3-2.4" class="pilcrow">¶</a>
</li>
<li id="section-7.4.3-2.5">
              <strong>token</strong> - the access token for accessing an RS.  This attribute is REQUIRED.<a href="#section-7.4.3-2.5" class="pilcrow">¶</a>
</li>
<li id="section-7.4.3-2.6">
              <strong>expires_in</strong> - a numeric value specifying how many seconds until the access token expires. This attribute is OPTIONAL.<a href="#section-7.4.3-2.6" class="pilcrow">¶</a>
</li>
<li id="section-7.4.3-2.7">
              <strong>certificate</strong> - MUST be included if the mechanism is "jose" or "jose+body". Contains the jwk header values for the Client to include in the JWS header when calling the RS using the "jose" or "jose+body" mechanisms. See <a href="#JWSHeader" class="xref">Section 10.2.1</a>.<a href="#section-7.4.3-2.7" class="pilcrow">¶</a>
</li>
<li id="section-7.4.3-2.8">
              <strong>uri</strong> - the AuthZ URI. Used to refresh, update, and delete the authorization. This attribute is OPTIONAL.<a href="#section-7.4.3-2.8" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.4.3-3">[Editor: any value in an expiry for the Authorization?]<a href="#section-7.4.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ResponseAuthorizationsObject">
<section id="section-7.4.4">
          <h4 id="name-authorizations-object-2">
<a href="#section-7.4.4" class="section-number selfRef">7.4.4. </a><a href="#name-authorizations-object-2" class="section-name selfRef">"authorizations" Object</a>
          </h4>
<p id="section-7.4.4-1">A JSON array of authorization objects. Support for the authorizations object is OPTIONAL.<a href="#section-7.4.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ResponseClaimsObject">
<section id="section-7.4.5">
          <h4 id="name-claims-object-2">
<a href="#section-7.4.5" class="section-number selfRef">7.4.5. </a><a href="#name-claims-object-2" class="section-name selfRef">"claims" Object</a>
          </h4>
<p id="section-7.4.5-1">The claims object is a response to the Request "claims" object <a href="#AuthorizationObject" class="xref">Section 5.5.4</a>.<a href="#section-7.4.5-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4.5-2.1">
              <p id="section-7.4.5-2.1.1"><strong>oidc</strong><a href="#section-7.4.5-2.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4.5-2.1.2.1">
                  <strong>id_token</strong> - an OpenID Connect ID Token containing the Claims the User consented to be released.<a href="#section-7.4.5-2.1.2.1" class="pilcrow">¶</a>
</li>
<li id="section-7.4.5-2.1.2.2">
                  <strong>userinfo</strong> - the Claims the User consented to be released.<a href="#section-7.4.5-2.1.2.2" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.4.5-2.1.3">
Claims are defined in <span>[<a href="#OIDC" class="xref">OIDC</a>]</span> Section 5.<a href="#section-7.4.5-2.1.3" class="pilcrow">¶</a></p>
</li>
<li id="section-7.4.5-2.2">
              <strong>oidc4ia</strong> - OpenID Connect for Identity Assurance claims response per <span>[<a href="#OIDC4IA" class="xref">OIDC4IA</a>]</span>.<a href="#section-7.4.5-2.2" class="pilcrow">¶</a>
</li>
<li id="section-7.4.5-2.3">
              <p id="section-7.4.5-2.3.1"><strong>vc</strong><a href="#section-7.4.5-2.3.1" class="pilcrow">¶</a></p>
<p id="section-7.4.5-2.3.2">
The verified claims the user consented to be released. [Editor: details TBD]<a href="#section-7.4.5-2.3.2" class="pilcrow">¶</a></p>
</li>
</ul>
</section>
</div>
<div id="ReciprocalRequest">
<section id="section-7.4.6">
          <h4 id="name-reciprocal-object-2">
<a href="#section-7.4.6" class="section-number selfRef">7.4.6. </a><a href="#name-reciprocal-object-2" class="section-name selfRef">"reciprocal" Object</a>
          </h4>
<p id="section-7.4.6-1">The following MUST be included<a href="#section-7.4.6-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4.6-2.1">
              <strong>nonce</strong> - a unique identifier for this request. Note the Grant Response MUST contain a matching nonce attribute value.<a href="#section-7.4.6-2.1" class="pilcrow">¶</a>
</li>
<li id="section-7.4.6-2.2">
              <p id="section-7.4.6-2.2.1"><strong>client</strong><a href="#section-7.4.6-2.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4.6-2.2.2.1">
                  <strong>id</strong> - the Client ID making the request<a href="#section-7.4.6-2.2.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-7.4.6-3">One or more of the following objects from the Request JSON <a href="#RequestJSON" class="xref">Section 5.5</a> are included:<a href="#section-7.4.6-3" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4.6-4.1">
              <strong>authorization</strong> <a href="#ResponseAuthorizationObject" class="xref">Section 7.4.3</a><a href="#section-7.4.6-4.1" class="pilcrow">¶</a>
</li>
<li id="section-7.4.6-4.2">
              <strong>authorizations</strong> <a href="#ResponseAuthorizationsObject" class="xref">Section 7.4.4</a><a href="#section-7.4.6-4.2" class="pilcrow">¶</a>
</li>
<li id="section-7.4.6-4.3">
              <strong>claims</strong> <a href="#ResponseClaimsObject" class="xref">Section 7.4.5</a><a href="#section-7.4.6-4.3" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="InteractionType">
<section id="section-7.4.7">
          <h4 id="name-interaction-types">
<a href="#section-7.4.7" class="section-number selfRef">7.4.7. </a><a href="#name-interaction-types" class="section-name selfRef">Interaction Types</a>
          </h4>
<p id="section-7.4.7-1">If the GS wants the Client to initiate the interaction with the User, then the GS will return an Interaction Response. The Client will initiate the interaction with the User in one of the following ways:<a href="#section-7.4.7-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.4.7-2.1">
              <strong>popup</strong>
The Client will create a new popup child browser window with URI contained in the "interaction"."authorization_uri" attribute. 
[Editor: more details on how to do this] The GS will close the popup window when the interactions with the User are complete. [Editor: confirm GS can stll do this on all browsers, or does Client need to close? If so, then Client needs to provide a redirect_uri.]<a href="#section-7.4.7-2.1" class="pilcrow">¶</a>
</li>
<li id="section-7.4.7-2.2">
              <strong>redirect</strong>
The Client will redirect the User to the "interaction"."authorization_uri" attribute. When the GS interactions with the User are complete, the GS will redirect the User to the "interaction"."redirect_uri" attribute the Client provided in the Grant Request.<a href="#section-7.4.7-2.2" class="pilcrow">¶</a>
</li>
<li id="section-7.4.7-2.3">
              <strong>qrcode</strong>
The Client will create a <span>[<a href="#QR_Code" class="xref">QR_Code</a>]</span> of the "interaction"."qr" attribute and display the resulting graphic. The Client will also display the "interaction"."display_uri" and "interaction"."user_code" per the "code" type.<a href="#section-7.4.7-2.3" class="pilcrow">¶</a>
</li>
<li id="section-7.4.7-2.4">
              <strong>code</strong>
The Client will display the "interaction"."user_code" contents and direct the User to navigate to the "interaction"."display_uri" value and enter the code.<a href="#section-7.4.7-2.4" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-7.4.7-3">A GS MUST support the "popup", "redirect", "qrcode", and "code" interaction types.<a href="#section-7.4.7-3" class="pilcrow">¶</a></p>
<p id="section-7.4.7-4">[Editor: is this too restrictive?]<a href="#section-7.4.7-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="signing-and-encryption">
<section id="section-7.4.8">
          <h4 id="name-signing-and-encryption">
<a href="#section-7.4.8" class="section-number selfRef">7.4.8. </a><a href="#name-signing-and-encryption" class="section-name selfRef">Signing and Encryption</a>
          </h4>
<p id="section-7.4.8-1">[Editor: TBD - how response is signed and/or encrypted by the GS. Is there a generalized description, or is it mechanism specific?]<a href="#section-7.4.8-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="response-verification">
<section id="section-7.5">
        <h3 id="name-response-verification">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-response-verification" class="section-name selfRef">Response Verification</a>
        </h3>
<p id="section-7.5-1">On receipt of a response, the Client MUST verify the following:<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-7.5-2.1">TBD<a href="#section-7.5-2.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="RSAccess">
<section id="section-8">
      <h2 id="name-rs-access">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-rs-access" class="section-name selfRef">RS Access</a>
      </h2>
<p id="section-8-1">This document specifies three different mechanisms for the Client to access an RS ("bearer", "jose", and "jose+body"). The "bearer" mechanism is defined in {BearerToken}. The "jose" and "jose+body" mechanisms are proof-of-possession mechanisms and are defined in <a href="#joseMech" class="xref">Section 10.2.2</a> and <a href="#jose_bodyMech" class="xref">Section 10.2.3</a> respectively. Additional proof-of-possession mechanisms may be defined in other documents. The mechanism the Client is to use with an RS is the Response JSON "authorization"."mechanism" attribute <a href="#ResponseAuthorizationObject" class="xref">Section 7.4.3</a>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<div id="BearerToken">
<section id="section-8.1">
        <h3 id="name-bearer-token">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-bearer-token" class="section-name selfRef">Bearer Token</a>
        </h3>
<p id="section-8.1-1">If the access mechanism is "bearer", then the Client accesses the RS per Section 2.1 of <span>[<a href="#RFC6750" class="xref">RFC6750</a>]</span><a href="#section-8.1-1" class="pilcrow">¶</a></p>
<p id="section-8.1-2">A non-normative example of the HTTP request headers follows:<a href="#section-8.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-8.1-3">
<pre>
GET /calendar HTTP/2
Host: calendar.example
Authorization: bearer eyJJ2D6.example.access.token.mZf9pTSpA
</pre><a href="#section-8.1-3" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="ErrorResponses">
<section id="section-9">
      <h2 id="name-error-responses">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-error-responses" class="section-name selfRef">Error Responses</a>
      </h2>
<ul>
<li id="section-9-1.1">TBD<a href="#section-9-1.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="JOSEauthN">
<section id="section-10">
      <h2 id="name-jose-authentication">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-jose-authentication" class="section-name selfRef">JOSE Authentication</a>
      </h2>
<p id="section-10-1">How the Client authenticates to the GS and RS are independent of each other. One mechanism can be used to authenticate to the GS, and a different mechanism to authenticate to the RS.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Other documents that specify other Client authentication mechanisms will replace this section.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">In the JOSE Authentication Mechanism, the Client authenticates by using its private key to sign a JSON document with JWS per <span>[<a href="#RFC7515" class="xref">RFC7515</a>]</span> which results in a token using JOSE compact serialization.<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">[Editor: are there advantages to using JSON serialization in the body?]<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">Different instances of a Registered Clients MAY have different private keys, but certificates bind them to a public key the GS has for the Client ID. An instance of a Client will use the same private key for all signing.<a href="#section-10-5" class="pilcrow">¶</a></p>
<p id="section-10-6">The Client and the GS MUST both use HTTP/2 (<span>[<a href="#RFC7540" class="xref">RFC7540</a>]</span>) or later, and TLS 1.3 (<span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span>) or later, when communicating with each other.<a href="#section-10-6" class="pilcrow">¶</a></p>
<p id="section-10-7">[Editor: too aggressive to mandate HTTP/2 and TLS 1.3?]<a href="#section-10-7" class="pilcrow">¶</a></p>
<p id="section-10-8">The token may be included in an HTTP header, or as the HTTP message body.<a href="#section-10-8" class="pilcrow">¶</a></p>
<p id="section-10-9">The following sections specify how the Client uses JOSE to authenticate to the GS and RS.<a href="#section-10-9" class="pilcrow">¶</a></p>
<div id="gs-access">
<section id="section-10.1">
        <h3 id="name-gs-access">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-gs-access" class="section-name selfRef">GS Access</a>
        </h3>
<p id="section-10.1-1">The Client authenticates to the GS by passing either a signed header parameter, or a signed message body.
The following table shows the verb, uri and token location for each Client request to the GS:<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<table class="center" id="table-2">
          <caption><a href="#table-2" class="selfRef">Table 2</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">request</th>
              <th class="text-left" rowspan="1" colspan="1">http verb</th>
              <th class="text-left" rowspan="1" colspan="1">uri</th>
              <th class="text-left" rowspan="1" colspan="1">token in</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Create Grant</td>
              <td class="text-left" rowspan="1" colspan="1">POST</td>
              <td class="text-left" rowspan="1" colspan="1">GS URI</td>
              <td class="text-left" rowspan="1" colspan="1">body</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Read Grant</td>
              <td class="text-left" rowspan="1" colspan="1">GET</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">header</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Update Grant</td>
              <td class="text-left" rowspan="1" colspan="1">PUT</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">body</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Delete Grant</td>
              <td class="text-left" rowspan="1" colspan="1">DELETE</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">success</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Refresh AuthZ</td>
              <td class="text-left" rowspan="1" colspan="1">GET</td>
              <td class="text-left" rowspan="1" colspan="1">AuthZ URI</td>
              <td class="text-left" rowspan="1" colspan="1">body</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Update AuthZ</td>
              <td class="text-left" rowspan="1" colspan="1">PUT</td>
              <td class="text-left" rowspan="1" colspan="1">AuthZ URI</td>
              <td class="text-left" rowspan="1" colspan="1">body</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Delete AuthZ</td>
              <td class="text-left" rowspan="1" colspan="1">DELETE</td>
              <td class="text-left" rowspan="1" colspan="1">AuthZ URI</td>
              <td class="text-left" rowspan="1" colspan="1">header</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">GS Options</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONS</td>
              <td class="text-left" rowspan="1" colspan="1">GS URI</td>
              <td class="text-left" rowspan="1" colspan="1">header</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Grant Options</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONS</td>
              <td class="text-left" rowspan="1" colspan="1">Grant URI</td>
              <td class="text-left" rowspan="1" colspan="1">header</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">AuthZ Options</td>
              <td class="text-left" rowspan="1" colspan="1">OPTIONS</td>
              <td class="text-left" rowspan="1" colspan="1">AuthZ URI</td>
              <td class="text-left" rowspan="1" colspan="1">header</td>
            </tr>
          </tbody>
        </table>
<div id="authorization-header">
<section id="section-10.1.1">
          <h4 id="name-authorization-header">
<a href="#section-10.1.1" class="section-number selfRef">10.1.1. </a><a href="#name-authorization-header" class="section-name selfRef">Authorization Header</a>
          </h4>
<p id="section-10.1.1-1">For requests with the token in the header, the JWS payload MUST contain the following attributes:<a href="#section-10.1.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1.1-2"><strong>iat</strong> - the time the token was created as a NumericDate.<a href="#section-10.1.1-2" class="pilcrow">¶</a></p>
<p id="section-10.1.1-3"><strong>jti</strong> - a unique identifier for the token per <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> section 4.1.7.<a href="#section-10.1.1-3" class="pilcrow">¶</a></p>
<p id="section-10.1.1-4"><strong>uri</strong> - the value of the URI being called (GS URI, Grant URI, or AuthZ URI).<a href="#section-10.1.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1.1-5"><strong>verb</strong> - the HTTP verb being used in the call ("GET", "DELETE", "OPTIONS")<a href="#section-10.1.1-5" class="pilcrow">¶</a></p>
<p id="section-10.1.1-6">The HTTP authorization header is set to the "jose" parameter followed by one or more white space characters, followed by the resulting token.<a href="#section-10.1.1-6" class="pilcrow">¶</a></p>
<p id="section-10.1.1-7">A non-normative example of a JWS payload and the HTTP request follows:<a href="#section-10.1.1-7" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10.1.1-8">
<pre>
{
    "iat"   : 15790460234,
    "jti"   : "f6d72254-4f23-417f-b55e-14ad323b1dc1",
    "uri"   : "https://as.example/endpoint/grant/example6",
    "verb"  : "GET"
}

GET /endpoint/example.grant HTTP/2
Host: as.example
Authorization: jose eyJhbGciOiJIUzI1NiIsIn ...
</pre><a href="#section-10.1.1-8" class="pilcrow">¶</a>
</div>
<p id="section-10.1.1-9">[Editor: make a real example token]<a href="#section-10.1.1-9" class="pilcrow">¶</a></p>
<p id="section-10.1.1-10"><strong>GS Verification</strong><a href="#section-10.1.1-10" class="pilcrow">¶</a></p>
<p id="section-10.1.1-11">The GS MUST verify the token by:<a href="#section-10.1.1-11" class="pilcrow">¶</a></p>
<ul>
<li id="section-10.1.1-12.1">TBD<a href="#section-10.1.1-12.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="signed-body">
<section id="section-10.1.2">
          <h4 id="name-signed-body">
<a href="#section-10.1.2" class="section-number selfRef">10.1.2. </a><a href="#name-signed-body" class="section-name selfRef">Signed Body</a>
          </h4>
<p id="section-10.1.2-1">For requests with the token in the body, the Client uses the Request JSON as the payload in a JWS. The resulting token is sent with the content-type set to "application/jose".<a href="#section-10.1.2-1" class="pilcrow">¶</a></p>
<p id="section-10.1.2-2">A non-normative example (line breaks added to the body for readability):<a href="#section-10.1.2-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10.1.2-3">
<pre>
POST /endpoint HTTP/2
Host: as.example
Content-Type: application/jose
Content-Length: 155

eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyzdWIiOiIxMjM0NTY3ODkwIiwibmF
tZSI6IkpvaG4gRG9lIiwiaWF0IjoxNTE2MjM5MDIyfQ.SflKxwRJSMeKKF2QT4fwpMe
Jf36POk6yJV_adQssw5c
</pre><a href="#section-10.1.2-3" class="pilcrow">¶</a>
</div>
<p id="section-10.1.2-4">[Editor: make a real example token]<a href="#section-10.1.2-4" class="pilcrow">¶</a></p>
<p id="section-10.1.2-5"><strong>GS Verification</strong><a href="#section-10.1.2-5" class="pilcrow">¶</a></p>
<p id="section-10.1.2-6">The GS MUST verify the token by:<a href="#section-10.1.2-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-10.1.2-7.1">TBD<a href="#section-10.1.2-7.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="public-key-resolution">
<section id="section-10.1.3">
          <h4 id="name-public-key-resolution">
<a href="#section-10.1.3" class="section-number selfRef">10.1.3. </a><a href="#name-public-key-resolution" class="section-name selfRef">Public Key Resolution</a>
          </h4>
<ul>
<li id="section-10.1.3-1.1">
              <strong>Registered Clients</strong> can use any of the JWS header values to direct the GS to resolve the public key matching the private key used to the Client ID. The GS MAY restrict with JWS headers a Client can use.<a href="#section-10.1.3-1.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-10.1.3-2">[Editor: would examples help here so that implementors understand the full range of options, and how an instance can have its own asymetric key pair]<a href="#section-10.1.3-2" class="pilcrow">¶</a></p>
<p id="section-10.1.3-3">A non-normative example of a JOSE header for a Registered Client with a key identifier of "12":<a href="#section-10.1.3-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10.1.3-4">
<pre>
{
    "alg"   : "ES256",
    "typ"   : "JOSE",
    "kid"   : "12"
}
</pre><a href="#section-10.1.3-4" class="pilcrow">¶</a>
</div>
<ul>
<li id="section-10.1.3-5.1">
              <strong>Dynamic Clients</strong> include their public key in the "jwk" JWS header.<a href="#section-10.1.3-5.1" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-10.1.3-6">A non-normative example of a JOSE header for a Dynamic Client:<a href="#section-10.1.3-6" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10.1.3-7">
<pre>
{
    "alg"   : "ES256",
    "typ"   : "JOSE",
    "jwk"   : {
        "kty"   : "EC",
        "crv"   : "P-256",
        "x"     : "Kgl5DJSgLyV-G32osmLhFKxJ97FoMW0dZVEqDG-Cwo4",
        "y"     : "GsL4mOM4x2e6iON8BHvRDQ6AgXAPnw0m0SfdlREV7i4"
    }
}
</pre><a href="#section-10.1.3-7" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="rs-access">
<section id="section-10.2">
        <h3 id="name-rs-access-2">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-rs-access-2" class="section-name selfRef">RS Access</a>
        </h3>
<p id="section-10.2-1">In the "jose" mechanism <a href="#joseMech" class="xref">Section 10.2.2</a>, all Client requests to the RS include a proof-of-possession token in the HTTP authorization header. In the "jose+body" mechanism <a href="#jose_bodyMech" class="xref">Section 10.2.3</a>, the Client signs the JSON document in the request if the POST or PUT verbs are used, otherwise it is the same as the "jose" mechanism.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<div id="JWSHeader">
<section id="section-10.2.1">
          <h4 id="name-jose-header">
<a href="#section-10.2.1" class="section-number selfRef">10.2.1. </a><a href="#name-jose-header" class="section-name selfRef">JOSE header</a>
          </h4>
<p id="section-10.2.1-1">The GS provides the Client one or more JWS header parameters and values for a a certificate, or a reference to a certificate or certificate chain, that the RS can use to resolve the public key matching the private key being used by the Client.<a href="#section-10.2.1-1" class="pilcrow">¶</a></p>
<p id="section-10.2.1-2">A non-normative examples JOSE header:<a href="#section-10.2.1-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10.2.1-3">
<pre>
{
    "alg"   : "ES256",
    "typ"   : "JOSE",
    "x5u"   : "https://as.example/cert/example2"
}
</pre><a href="#section-10.2.1-3" class="pilcrow">¶</a>
</div>
<p id="section-10.2.1-4">[Editor: this enables Dynamic Clients to make proof-of-possession API calls the same as Registered Clients.]<a href="#section-10.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="joseMech">
<section id="section-10.2.2">
          <h4 id="name-jose-mechanism">
<a href="#section-10.2.2" class="section-number selfRef">10.2.2. </a><a href="#name-jose-mechanism" class="section-name selfRef">"jose" Mechanism</a>
          </h4>
<p id="section-10.2.2-1">The JWS payload MUST contain the following attributes:<a href="#section-10.2.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2.2-2"><strong>iat</strong> - the time the token was created as a NumericDate.<a href="#section-10.2.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2.2-3"><strong>jti</strong> - a unique identifier for the token per <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> section 4.1.7.<a href="#section-10.2.2-3" class="pilcrow">¶</a></p>
<p id="section-10.2.2-4"><strong>uri</strong> - the value of the RS URI being called.<a href="#section-10.2.2-4" class="pilcrow">¶</a></p>
<p id="section-10.2.2-5"><strong>verb</strong> - the HTTP verb being used in the call<a href="#section-10.2.2-5" class="pilcrow">¶</a></p>
<p id="section-10.2.2-6"><strong>token</strong> - the access token provided by the GS to the Client<a href="#section-10.2.2-6" class="pilcrow">¶</a></p>
<p id="section-10.2.2-7">The HTTP authorization header is set to the "jose" parameter followed by one or more white space characters, followed by the resulting token.<a href="#section-10.2.2-7" class="pilcrow">¶</a></p>
<p id="section-10.2.2-8">A non-normative example of a JWS payload and the HTTP request follows:<a href="#section-10.2.2-8" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10.2.2-9">
<pre>
{
    "iat"   : 15790460234,
    "jti"   : "f6d72254-4f23-417f-b55e-14ad323b1dc1",
    "uri"   : "https://calendar.example/calendar",
    "verb"  : "GET",
    "token" : "eyJJ2D6.example.access.token.mZf9pTSpA"
}

GET /calendar HTTP/2
Host: calendar.example
Authorization: jose eyJhbG.example.jose.token.adks
</pre><a href="#section-10.2.2-9" class="pilcrow">¶</a>
</div>
<p id="section-10.2.2-10">[Editor: make a real example token]<a href="#section-10.2.2-10" class="pilcrow">¶</a></p>
<p id="section-10.2.2-11"><strong>RS Verification</strong><a href="#section-10.2.2-11" class="pilcrow">¶</a></p>
<p id="section-10.2.2-12">The RS MUST verify the token by:<a href="#section-10.2.2-12" class="pilcrow">¶</a></p>
<ul>
<li id="section-10.2.2-13.1">verify access token is bound to the public key - include key fingerprint in access token?<a href="#section-10.2.2-13.1" class="pilcrow">¶</a>
</li>
<li id="section-10.2.2-13.2">TBD<a href="#section-10.2.2-13.2" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="jose_bodyMech">
<section id="section-10.2.3">
          <h4 id="name-josebody-mechanism">
<a href="#section-10.2.3" class="section-number selfRef">10.2.3. </a><a href="#name-josebody-mechanism" class="section-name selfRef">"jose+body" Mechanism</a>
          </h4>
<p id="section-10.2.3-1">The "jose+body" mechanism can only be used if the content being sent to the RS is a JSON document.<a href="#section-10.2.3-1" class="pilcrow">¶</a></p>
<p id="section-10.2.3-2">Any requests not sending a message body will use the "jose" mechanism <a href="#joseMech" class="xref">Section 10.2.2</a>.<a href="#section-10.2.3-2" class="pilcrow">¶</a></p>
<p id="section-10.2.3-3">Requests sending a message body MUST have the following JWS payload:<a href="#section-10.2.3-3" class="pilcrow">¶</a></p>
<p id="section-10.2.3-4"><strong>iat</strong> - the time the token was created as a NumericDate.<a href="#section-10.2.3-4" class="pilcrow">¶</a></p>
<p id="section-10.2.3-5"><strong>jti</strong> - a unique identifier for the token per <span>[<a href="#RFC7519" class="xref">RFC7519</a>]</span> section 4.1.7.<a href="#section-10.2.3-5" class="pilcrow">¶</a></p>
<p id="section-10.2.3-6"><strong>uri</strong> - the value of the RS URI being called.<a href="#section-10.2.3-6" class="pilcrow">¶</a></p>
<p id="section-10.2.3-7"><strong>verb</strong> - the HTTP verb being used in the call<a href="#section-10.2.3-7" class="pilcrow">¶</a></p>
<p id="section-10.2.3-8"><strong>token</strong> - the access token provided by the GS to the Client<a href="#section-10.2.3-8" class="pilcrow">¶</a></p>
<p id="section-10.2.3-9"><strong>body</strong> - the message body being sent to the RS<a href="#section-10.2.3-9" class="pilcrow">¶</a></p>
<p id="section-10.2.3-10">A non-normative example of a JWS payload and the HTTP request follows:<a href="#section-10.2.3-10" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-10.2.3-11">
<pre>
{
    "iat"   : 15790460234,
    "jti"   : "f6d72254-4f23-417f-b55e-14ad323b1dc1",
    "uri"   : "https://calendar.example/calendar",
    "verb"  : "POST",
    "token" : "eyJJ2D6.example.access.token.mZf9pTSpA",
    "payload" : {
        "event" : {
            "title"             : "meeting with joe",
            "start_date_utc"    : "2020-02-21 11:00:00",
            "end_date_utc"      : "2020-02-21 11:00:00"
        }
    }
}

POST /calendar HTTP/2
Host: calendar.example
Content-Type: application/jose
Content-Length: 155

eyJhbGciOi.example.jose+body.adasdQssw5c
</pre><a href="#section-10.2.3-11" class="pilcrow">¶</a>
</div>
<p id="section-10.2.3-12">[Editor: make a real example token]<a href="#section-10.2.3-12" class="pilcrow">¶</a></p>
<p id="section-10.2.3-13"><strong>RS Verification</strong><a href="#section-10.2.3-13" class="pilcrow">¶</a></p>
<p id="section-10.2.3-14">The RS MUST verify the token by:<a href="#section-10.2.3-14" class="pilcrow">¶</a></p>
<ul>
<li id="section-10.2.3-15.1">TBD<a href="#section-10.2.3-15.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="public-key-resolution-1">
<section id="section-10.2.4">
          <h4 id="name-public-key-resolution-2">
<a href="#section-10.2.4" class="section-number selfRef">10.2.4. </a><a href="#name-public-key-resolution-2" class="section-name selfRef">Public Key Resolution</a>
          </h4>
<p id="section-10.2.4-1">The RS has a public key for the GS that it uses to verify the certificate or certificate chain the Client includes in the JWS header.<a href="#section-10.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="request-encryption">
<section id="section-10.3">
        <h3 id="name-request-encryption">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-request-encryption" class="section-name selfRef">Request Encryption</a>
        </h3>
<p id="section-10.3-1">[Editor: to be fleshed out]<a href="#section-10.3-1" class="pilcrow">¶</a></p>
<p id="section-10.3-2">The Client encrypts a request when ??? using the GS public key returned as the ??? attribute in GS Options <a href="#GSoptions" class="xref">Section 5.9</a>.<a href="#section-10.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response-signing">
<section id="section-10.4">
        <h3 id="name-response-signing">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-response-signing" class="section-name selfRef">Response Signing</a>
        </h3>
<p id="section-10.4-1">[Editor: to be fleshed out]<a href="#section-10.4-1" class="pilcrow">¶</a></p>
<p id="section-10.4-2">The Client verifies a signed response ??? using the GS public key returned as the ??? attribute in GS Options <a href="#GSoptions" class="xref">Section 5.9</a>.<a href="#section-10.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="response-encryption">
<section id="section-10.5">
        <h3 id="name-response-encryption">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-response-encryption" class="section-name selfRef">Response Encryption</a>
        </h3>
<p id="section-10.5-1">[Editor: to be fleshed out]<a href="#section-10.5-1" class="pilcrow">¶</a></p>
<p id="section-10.5-2">The Client decrypts a response when ??? using the private key matching the public key included in the request as the ??? attribute in <a href="#RequestJSON" class="xref">Section 5.5</a>.<a href="#section-10.5-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="extensibility">
<section id="section-11">
      <h2 id="name-extensibility">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-extensibility" class="section-name selfRef">Extensibility</a>
      </h2>
<p id="section-11-1">This standard can be extended in a number of areas:<a href="#section-11-1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.1">
          <p id="section-11-2.1.1"><strong>Client Authentication Mechanisms</strong><a href="#section-11-2.1.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.1.2.1">An extension could define other mechanisms for the Client to authenticate to the GS and/or RS such as Mutual TLS or HTTP Signing. Constrained environments could use CBOR <span>[<a href="#RFC7049" class="xref">RFC7049</a>]</span> instead of JSON, and COSE <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span> instead of JOSE, and CoAP <span>[<a href="#RFC8323" class="xref">RFC8323</a>]</span> instead of HTTP/2.<a href="#section-11-2.1.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-11-2.2">
          <p id="section-11-2.2.1"><strong>Grant</strong><a href="#section-11-2.2.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.2.2.1">An extension can define new objects in the Grant Request and Grant Response JSON.<a href="#section-11-2.2.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-11-2.3">
          <p id="section-11-2.3.1"><strong>Top Level</strong><a href="#section-11-2.3.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.3.2.1">Top level objects SHOULD only be defined to represent functionality other the existing top level objects and attributes.<a href="#section-11-2.3.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-11-2.4">
          <p id="section-11-2.4.1"><strong>"client" Object</strong><a href="#section-11-2.4.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.4.2.1">Additional information about the Client that the GS would require related to an extension.<a href="#section-11-2.4.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-11-2.5">
          <p id="section-11-2.5.1"><strong>"user" Object</strong><a href="#section-11-2.5.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.5.2.1">Additional information about the User that the GS would require related to an extension.<a href="#section-11-2.5.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-11-2.6">
          <p id="section-11-2.6.1"><strong>"authorization" Object</strong><a href="#section-11-2.6.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.6.2.1">Additional types of authorizations in addition to OAuth 2.0 scopes and RAR.<a href="#section-11-2.6.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-11-2.7">
          <p id="section-11-2.7.1"><strong>"claims" Object</strong><a href="#section-11-2.7.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.7.2.1">Additional types of identity claims in addition to OpenID Connect claims and Verified Credentials.<a href="#section-11-2.7.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-11-2.8">
          <p id="section-11-2.8.1"><strong>Interaction types</strong><a href="#section-11-2.8.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.8.2.1">Additional types of interactions a Client can start with the User.<a href="#section-11-2.8.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
<li id="section-11-2.9">
          <p id="section-11-2.9.1"><strong>Continuous Authentication</strong><a href="#section-11-2.9.1" class="pilcrow">¶</a></p>
<ul>
<li id="section-11-2.9.2.1">An extension could define a mechanism for the Client to regularly provide continuous authentication signals and receive responses.<a href="#section-11-2.9.2.1" class="pilcrow">¶</a>
</li>
</ul>
</li>
</ul>
<p id="section-11-3">[Editor: do we specify access token / handle introspection in this document, or leave that to an extension?]<a href="#section-11-3" class="pilcrow">¶</a></p>
<p id="section-11-4">[Editor: do we specify access token / handle revocation in this document, or leave that to an extension?]<a href="#section-11-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="rational">
<section id="section-12">
      <h2 id="name-rational">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-rational" class="section-name selfRef">Rational</a>
      </h2>
<ol start="1" type="1" class="normal type-1" id="section-12-1">
        <li id="section-12-1.1">
          <p id="section-12-1.1.1"><strong>Why is there only one mechanism for the Client to authenticate with the GS? Why not support other mechanisms?</strong><a href="#section-12-1.1.1" class="pilcrow">¶</a></p>
<p id="section-12-1.1.2">
Having choices requires implementers to understand which choice is preferable for them. Having one default mechanism in the document for the Client to authenticate simplifies most implementations. Deployments that have unique characteristics can select other mechanisms that are preferable in specific environments.<a href="#section-12-1.1.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.2">
          <p id="section-12-1.2.1"><strong>Why is the default Client authentication JOSE rather than MTLS?</strong><a href="#section-12-1.2.1" class="pilcrow">¶</a></p>
<p id="section-12-1.2.2">
MTLS cannot be used today by a Dynamic Client. MTLS requires the application to have access below what is typically the application layer, that is often not available on some platforms. JOSE is done at the application layer. Many GS deployments will be an application behind a proxy performing TLS, and there are risks in the proxy passing on the results of MTLS.<a href="#section-12-1.2.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.3">
          <p id="section-12-1.3.1"><strong>Why is the default Client authentication JOSE rather than HTTP signing?</strong><a href="#section-12-1.3.1" class="pilcrow">¶</a></p>
<p id="section-12-1.3.2">
There is currently no widely deployed open standard for HTTP signing. Additionally, HTTP signing requires passing all the relevant parts of the HTTP request to downstream services within an GS that may need to independently verify the Client identity.<a href="#section-12-1.3.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.4">
          <p id="section-12-1.4.1"><strong>What are the advantages of using JOSE for the Client to authenticate to the GS and a resource?</strong><a href="#section-12-1.4.1" class="pilcrow">¶</a></p>
<p id="section-12-1.4.2">
Both Registered Clients and Dynamic Clients can have a private key, eliminating the public Client issues in OAuth 2.0, as a Dynamic Client can create an ephemeral key pair. Using asymetric cryptography also allows each instance of a Registered Client to have its own private key if it can obtain a certificate binding its public key to the public key the GS has for the Client. Signed tokens can be passed to downstream components in a GS or RS to enable independent verification of the Client and its request. The GS Initiated Sequence <a href="#GSInitiatedGrant" class="xref">Section 6</a> requires a URL safe parameter, and JOSE is URL safe.<a href="#section-12-1.4.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.5">
          <p id="section-12-1.5.1"><strong>Why does the GS not return parameters to the Client in the redirect url?</strong><a href="#section-12-1.5.1" class="pilcrow">¶</a></p>
<p id="section-12-1.5.2">
Passing parameters via a browser redirection is the source of many of the security risks in OAuth 2.0. It also presents a challenge for smart devices. In this protocol, the redirection from the Client to the GS is to enable the GS to interact with the User, and the redirection back to the Client is to hand back interaction control to the Client if the redirection was a full browser redirect. Unlike OAuth 2.0, the identity of the Client is independent of the URI the GS redirects to.<a href="#section-12-1.5.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.6">
          <p id="section-12-1.6.1"><strong>Why is there not a UserInfo endpoint as there is with OpenID Connect?</strong><a href="#section-12-1.6.1" class="pilcrow">¶</a></p>
<p id="section-12-1.6.2">
Since the Client can Read Grant at any time, it get the same functionality as the UserInfo endpoint, without the Client having to manage a separate access token and refresh token. If the Client would like additional claims, it can Update Grant, and the GS will let the Client know if an interaction is required to get any of the additional claims, which the Client can then start.<a href="#section-12-1.6.2" class="pilcrow">¶</a></p>
<p id="section-12-1.6.3">
[Editor: is there some other reason to have the UserInfo endpoint?]<a href="#section-12-1.6.3" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.7">
          <p id="section-12-1.7.1"><strong>Why is there still a Client ID?</strong><a href="#section-12-1.7.1" class="pilcrow">¶</a></p>
<p id="section-12-1.7.2">
The GS needs an identifier to fetch the meta data associated with a Client such as the name and image to display to the User, and the policies on what a Client is allowed to do. The Client ID was used in OAuth 2.0 for the same purpose, which simplifies migration. Dynamic Clients do not have a Client ID.<a href="#section-12-1.7.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.8">
          <p id="section-12-1.8.1"><strong>Why have both claims and authorizations?</strong><a href="#section-12-1.8.1" class="pilcrow">¶</a></p>
<p id="section-12-1.8.2">
There are use cases for each that are independent: authenticating a user and providing claims vs granting access to a resource. A request for an authorization returns an access token which may have full CRUD capabilities, while a request for a claim returns the claim about the User - with no create, update or delete capabilities. While the UserInfo endpoint in OIDC may be thought of as a resource, separating the concepts and how they are requested keeps each of them simpler in the Editor's opinion. :)<a href="#section-12-1.8.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.9">
          <p id="section-12-1.9.1"><strong>Why specify HTTP/2 or later and TLS 1.3 or later for Client and GS communication in ?</strong><a href="#JOSEauthN" class="xref">Section 10</a><a href="#section-12-1.9.1" class="pilcrow">¶</a></p>
<p id="section-12-1.9.2">
Knowing the GS supports HTTP/2 enables a Client to set up a connection faster. HTTP/2 will be more efficient when Clients have large numbers of access tokens and are frequently refreshing them at the GS as there will be less network traffic. Mandating TLS 1.3 similarly improves the performance and security of Clients and GS when setting up a TLS connection.<a href="#section-12-1.9.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.10">
          <p id="section-12-1.10.1"><strong>Why do some of the JSON objects only have one child, such as the identifiers object in the user object in the Grant Request?</strong><a href="#section-12-1.10.1" class="pilcrow">¶</a></p>
<p id="section-12-1.10.2">
It is difficult to forecast future use cases. Having more resolution may mean the difference between a simple extension, and a convoluted extension.<a href="#section-12-1.10.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.11">
          <p id="section-12-1.11.1"><strong>Why is the "iss" included in the "oidc" identifier object? Would the "sub" not be enough for the GS to identify the User?</strong><a href="#section-12-1.11.1" class="pilcrow">¶</a></p>
<p id="section-12-1.11.2">
This decouples the GS from the OpenID Provider (OP). The GS identifier is the GS URI, which is the endpoint at the GS. The OP issuer identifier will likely not be the same as the GS URI. The GS may also provide claims from multiple OPs.<a href="#section-12-1.11.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.12">
          <p id="section-12-1.12.1"><strong>Why complicate things with "interaction"."keep"?</strong><a href="#section-12-1.12.1" class="pilcrow">¶</a></p>
<p id="section-12-1.12.2">
The common sequence has a back and forth between the Client and the GS, and the Client can update the Grant and have a new interaction. Keeping the interaction provides a more seamless user experience where the results from the first request determine subsequent requests. For example, a common pattern is to use a GS to authenticate the User at the Client, and to register the User at the Client using additional claims from the GS. The Client does not know a priori if the User is a new User, or a returning User. Asking a returning User to consent releasing claims they have already provided is a poor User experience, as is sending the User back to the GS. The Client requesting identity first enables the Client to get a response from the GS while the GS is still interacting with the User, so that the Client can request additional claims only if needed. Additionally, the claims a Client may want about a User may be dependent on some initial Claims. For example, if a User is in a particular country, additional or different Claims my be required by the Client.<a href="#section-12-1.12.2" class="pilcrow">¶</a></p>
<p id="section-12-1.12.3">
There are also benefits for the GS. Today, a GS usually keeps track of which claims a Client has requested for a User. Storing this information for all Clients a User uses may be undesirable for a GS that does not want to have that information about the User. Keeping the interaction allows the Client to track what information it has about the User, and the GS can remain stateless.<a href="#section-12-1.12.3" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.13">
          <p id="section-12-1.13.1"><strong>Why is there a "jose+body" RS access mechanism method  for the Client?</strong><a href="#jose_bodyMech" class="xref">Section 10.2.3</a><a href="#section-12-1.13.1" class="pilcrow">¶</a></p>
<p id="section-12-1.13.2">
There are numerous use cases where the RS wants non-repudiation and providence of the contents of an API call. For example, the UGS Service Supplier Framework for Authentication and Authorization <span>[<a href="#UTM" class="xref">UTM</a>]</span>.<a href="#section-12-1.13.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.14">
          <p id="section-12-1.14.1"><strong>Why use URIs to instead of handles for the Grant and Authorization?</strong><a href="#section-12-1.14.1" class="pilcrow">¶</a></p>
<p id="section-12-1.14.2">
A URI is an identifier just like a handle that can contain GS information that is opaque to the Client - so it has all the features of a handle, plus it can be the URL that is resolved to manipulate a Grant or an Authorization. As the Grant URI and AuthZ URI are defined to start with the GS URI, the Client (and GS) can easily determine which GS a Grant or Authorization belong to. URIs also enable a RESTful interface to the GS functionality.<a href="#section-12-1.14.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.15">
          <p id="section-12-1.15.1"><strong>Why use the OPTIONS verb on the GS URI? Why not use a .well-known mechanism?</strong><a href="#section-12-1.15.1" class="pilcrow">¶</a></p>
<p id="section-12-1.15.2">
Having the GS URI endpoint respond to the metadata allows the GS to provide Client specific results using the same Client authentication used for other requests to the GS. It also reduces the risk of a mismatch between what the advertised metadata, and the actual metadata. A .well-known discovery mechanism may be defined to resolve from a hostname to the GS URI.<a href="#section-12-1.15.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.16">
          <p id="section-12-1.16.1"><strong>Why support UPDATE, DELETE, and OPTIONS verbs on the AuthZ URI?</strong><a href="#section-12-1.16.1" class="pilcrow">¶</a></p>
<p id="section-12-1.16.2">
Maybe there are no use cases for them [that the editor knows of], but the GS can not implement, and they are available if use cases come up.<a href="#section-12-1.16.2" class="pilcrow">¶</a></p>
</li>
<li id="section-12-1.17">
          <p id="section-12-1.17.1"><strong>Why list explicit interactions, instead of the Client and GS negotiating interaction capabilities?</strong><a href="#section-12-1.17.1" class="pilcrow">¶</a></p>
<p id="section-12-1.17.2">
The Client knows what interactions it is capable of, and prefers. Telling the GS the interaction allows the GS to know what interaction the User will have. Knowing how the Client will transition the interaction will enable the GS to provider a better User experience. For example, the GS may want to provide a short URL if it knows the Client will be showing a QR code vs a redirect, or have a different layout if it is a popup vs a redirect.<a href="#section-12-1.17.2" class="pilcrow">¶</a></p>
<p id="section-12-1.17.3">
[Editor: are there use cases where the Client would want to provide a list of interaction types so the GS can select which one it can support? ]<a href="#section-12-1.17.3" class="pilcrow">¶</a></p>
</li>
</ol>
</section>
</div>
<div id="acknowledgments">
<section id="section-13">
      <h2 id="name-acknowledgments">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-13-1">This draft derives many of its concepts from Justin Richer's Transactional Authorization draft <span>[<a href="#TxAuth" class="xref">TxAuth</a>]</span>.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">Additional thanks to Justin Richer and Annabelle Richard Backman for their strong critique of earlier drafts.<a href="#section-13-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-14">
      <h2 id="name-iana-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-14-1">[ JOSE parameter for Authorization HTTP header ]<a href="#section-14-1" class="pilcrow">¶</a></p>
<p id="section-14-2">TBD<a href="#section-14-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-15">
      <h2 id="name-security-considerations">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-15-1">TBD<a href="#section-15-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-16">
      <h2 id="name-references">
<a href="#section-16" class="section-number selfRef">16. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-16.1">
        <h3 id="name-normative-references">
<a href="#section-16.1" class="section-number selfRef">16.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC3966">[RFC3966]</dt>
<dd>
<span class="refAuthor">Schulzrinne, H.</span>, <span class="refTitle">"The tel URI for Telephone Numbers"</span>, <span class="seriesInfo">RFC 3966</span>, <span class="seriesInfo">DOI 10.17487/RFC3966</span>, <time datetime="2004-12">December 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3966">https://www.rfc-editor.org/info/rfc3966</a>&gt;</span>. </dd>
<dt id="RFC5322">[RFC5322]</dt>
<dd>
<span class="refAuthor">Resnick, P., Ed.</span>, <span class="refTitle">"Internet Message Format"</span>, <span class="seriesInfo">RFC 5322</span>, <span class="seriesInfo">DOI 10.17487/RFC5322</span>, <time datetime="2008-10">October 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5322">https://www.rfc-editor.org/info/rfc5322</a>&gt;</span>. </dd>
<dt id="RFC5646">[RFC5646]</dt>
<dd>
<span class="refAuthor">Phillips, A., Ed.</span><span class="refAuthor"> and M. Davis, Ed.</span>, <span class="refTitle">"Tags for Identifying Languages"</span>, <span class="seriesInfo">BCP 47</span>, <span class="seriesInfo">RFC 5646</span>, <span class="seriesInfo">DOI 10.17487/RFC5646</span>, <time datetime="2009-09">September 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5646">https://www.rfc-editor.org/info/rfc5646</a>&gt;</span>. </dd>
<dt id="RFC6749">[RFC6749]</dt>
<dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dt id="RFC6750">[RFC6750]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor"> and D. Hardt</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework: Bearer Token Usage"</span>, <span class="seriesInfo">RFC 6750</span>, <span class="seriesInfo">DOI 10.17487/RFC6750</span>, <time datetime="2012-10">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6750">https://www.rfc-editor.org/info/rfc6750</a>&gt;</span>. </dd>
<dt id="RFC7515">[RFC7515]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Signature (JWS)"</span>, <span class="seriesInfo">RFC 7515</span>, <span class="seriesInfo">DOI 10.17487/RFC7515</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7515">https://www.rfc-editor.org/info/rfc7515</a>&gt;</span>. </dd>
<dt id="RFC7516">[RFC7516]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor"> and J. Hildebrand</span>, <span class="refTitle">"JSON Web Encryption (JWE)"</span>, <span class="seriesInfo">RFC 7516</span>, <span class="seriesInfo">DOI 10.17487/RFC7516</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7516">https://www.rfc-editor.org/info/rfc7516</a>&gt;</span>. </dd>
<dt id="RFC7519">[RFC7519]</dt>
<dd>
<span class="refAuthor">Jones, M.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, and N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dt id="RFC7540">[RFC7540]</dt>
<dd>
<span class="refAuthor">Belshe, M.</span><span class="refAuthor">, Peon, R.</span><span class="refAuthor">, and M. Thomson, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol Version 2 (HTTP/2)"</span>, <span class="seriesInfo">RFC 7540</span>, <span class="seriesInfo">DOI 10.17487/RFC7540</span>, <time datetime="2015-05">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7540">https://www.rfc-editor.org/info/rfc7540</a>&gt;</span>. </dd>
<dt id="RFC8259">[RFC8259]</dt>
<dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dt id="RFC8446">[RFC8446]</dt>
<dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dt id="OIDC">[OIDC]</dt>
<dd>
<span class="refAuthor">Sakimora, N.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Jones, M.</span><span class="refAuthor">, de Medeiros, B.</span><span class="refAuthor">, and C. Mortimore</span>, <span class="refTitle">"OpenID Connect Core 1.0"</span>, <time datetime="2014-11">November 2014</time>, <span>&lt;<a href="https://openiD.net/specs/openiD-connect-core-1_0.html">https://openiD.net/specs/openiD-connect-core-1_0.html</a>&gt;</span>. </dd>
<dt id="OIDC4IA">[OIDC4IA]</dt>
<dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor"> and D. Fett</span>, <span class="refTitle">"OpenID Connect for Identity Assurance 1.0"</span>, <time datetime="2019-10">October 2019</time>, <span>&lt;<a href="https://openid.net/specs/openid-connect-4-identity-assurance-1_0.html">https://openid.net/specs/openid-connect-4-identity-assurance-1_0.html</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-16.2">
        <h3 id="name-informative-references">
<a href="#section-16.2" class="section-number selfRef">16.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC7049">[RFC7049]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor"> and P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">RFC 7049</span>, <span class="seriesInfo">DOI 10.17487/RFC7049</span>, <time datetime="2013-10">October 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7049">https://www.rfc-editor.org/info/rfc7049</a>&gt;</span>. </dd>
<dt id="RFC8252">[RFC8252]</dt>
<dd>
<span class="refAuthor">Denniss, W.</span><span class="refAuthor"> and J. Bradley</span>, <span class="refTitle">"OAuth 2.0 for Native Apps"</span>, <span class="seriesInfo">BCP 212</span>, <span class="seriesInfo">RFC 8252</span>, <span class="seriesInfo">DOI 10.17487/RFC8252</span>, <time datetime="2017-10">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8252">https://www.rfc-editor.org/info/rfc8252</a>&gt;</span>. </dd>
<dt id="RFC8152">[RFC8152]</dt>
<dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dt id="RFC8323">[RFC8323]</dt>
<dd>
<span class="refAuthor">Bormann, C.</span><span class="refAuthor">, Lemay, S.</span><span class="refAuthor">, Tschofenig, H.</span><span class="refAuthor">, Hartke, K.</span><span class="refAuthor">, Silverajan, B.</span><span class="refAuthor">, and B. Raymor, Ed.</span>, <span class="refTitle">"CoAP (Constrained Application Protocol) over TCP, TLS, and WebSockets"</span>, <span class="seriesInfo">RFC 8323</span>, <span class="seriesInfo">DOI 10.17487/RFC8323</span>, <time datetime="2018-02">February 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8323">https://www.rfc-editor.org/info/rfc8323</a>&gt;</span>. </dd>
<dt id="RFC8628">[RFC8628]</dt>
<dd>
<span class="refAuthor">Denniss, W.</span><span class="refAuthor">, Bradley, J.</span><span class="refAuthor">, Jones, M.</span><span class="refAuthor">, and H. Tschofenig</span>, <span class="refTitle">"OAuth 2.0 Device Authorization Grant"</span>, <span class="seriesInfo">RFC 8628</span>, <span class="seriesInfo">DOI 10.17487/RFC8628</span>, <time datetime="2019-08">August 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8628">https://www.rfc-editor.org/info/rfc8628</a>&gt;</span>. </dd>
<dt id="browser_based_apps">[browser_based_apps]</dt>
<dd>
<span class="refAuthor">Parecki, A.</span><span class="refAuthor"> and D. Waite</span>, <span class="refTitle">"OAuth 2.0 for Browser-Based Apps"</span>, <time datetime="2019-09">September 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps-04">https://tools.ietf.org/html/draft-ietf-oauth-browser-based-apps-04</a>&gt;</span>. </dd>
<dt id="RAR">[RAR]</dt>
<dd>
<span class="refAuthor">Lodderstedt, T.</span><span class="refAuthor">, Richer, J.</span><span class="refAuthor">, and B. Campbell</span>, <span class="refTitle">"OAuth 2.0 Rich Authorization Requests"</span>, <time datetime="2020-01">January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-oauth-rar-00">https://tools.ietf.org/html/draft-ietf-oauth-rar-00</a>&gt;</span>. </dd>
<dt id="W3C_VC">[W3C_VC]</dt>
<dd>
<span class="refAuthor">Sporny, M.</span><span class="refAuthor">, Noble, G.</span><span class="refAuthor">, and D. Chadwick</span>, <span class="refTitle">"Verifiable Credentials Data Model 1.0"</span>, <time datetime="2019-11">November 2019</time>, <span>&lt;<a href="https://w3c.github.io/vc-data-model/">https://w3c.github.io/vc-data-model/</a>&gt;</span>. </dd>
<dt id="QR_Code">[QR_Code]</dt>
<dd>
<span class="refTitle">"ISO/IEC 18004:2015 - Information technology - Automatic identification and data capture techniques - QR Code bar code symbology specification"</span>, <time datetime="2015-02">February 2015</time>, <span>&lt;<a href="https://www.iso.org/standard/62021.html">https://www.iso.org/standard/62021.html</a>&gt;</span>. </dd>
<dt id="TxAuth">[TxAuth]</dt>
<dd>
<span class="refAuthor">Richer, J.</span>, <span class="refTitle">"Transactional AuthN"</span>, <time datetime="2019-12">December 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-richer-transactional-authz-04">https://tools.ietf.org/html/draft-richer-transactional-authz-04</a>&gt;</span>. </dd>
<dt id="UTM">[UTM]</dt>
<dd>
<span class="refAuthor">Rios, J.</span><span class="refAuthor">, Smith, I.</span><span class="refAuthor">, and P. Venkatesen</span>, <span class="refTitle">"UGS Service Supplier Framework for Authentication and AuthN"</span>, <time datetime="2019-09">September 2019</time>, <span>&lt;<a href="https://utm.arc.nasa.gov/docs/2019-UTM_Framework-NGSA-TM220364.pdf">https://utm.arc.nasa.gov/docs/2019-UTM_Framework-NGSA-TM220364.pdf</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="document-history">
<section id="section-appendix.a">
      <h2 id="name-document-history">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-document-history" class="section-name selfRef">Document History</a>
      </h2>
<div id="draft-hardt-xauth-protocol-00">
<section id="section-a.1">
        <h2 id="name-draft-hardt-xauth-protocol-">
<a href="#section-a.1" class="section-number selfRef">A.1. </a><a href="#name-draft-hardt-xauth-protocol-" class="section-name selfRef">draft-hardt-xauth-protocol-00</a>
        </h2>
<ul>
<li id="section-a.1-1.1">Initial version<a href="#section-a.1-1.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-01">
<section id="section-a.2">
        <h2 id="name-draft-hardt-xauth-protocol-0">
<a href="#section-a.2" class="section-number selfRef">A.2. </a><a href="#name-draft-hardt-xauth-protocol-0" class="section-name selfRef">draft-hardt-xauth-protocol-01</a>
        </h2>
<ul>
<li id="section-a.2-1.1">text clean up<a href="#section-a.2-1.1" class="pilcrow">¶</a>
</li>
<li id="section-a.2-1.2">added OIDC4IA claims<a href="#section-a.2-1.2" class="pilcrow">¶</a>
</li>
<li id="section-a.2-1.3">added "jws" method for accessing a resource.<a href="#section-a.2-1.3" class="pilcrow">¶</a>
</li>
<li id="section-a.2-1.4">renamed Initiation Request -&gt; Grant Request<a href="#section-a.2-1.4" class="pilcrow">¶</a>
</li>
<li id="section-a.2-1.5">renamed Initiation Response -&gt; Interaction Response<a href="#section-a.2-1.5" class="pilcrow">¶</a>
</li>
<li id="section-a.2-1.6">renamed Completion Request -&gt; Authorization Request<a href="#section-a.2-1.6" class="pilcrow">¶</a>
</li>
<li id="section-a.2-1.7">renamed Completion Response -&gt; Grant Request<a href="#section-a.2-1.7" class="pilcrow">¶</a>
</li>
<li id="section-a.2-1.8">renamed completion handle -&gt; authorization handle<a href="#section-a.2-1.8" class="pilcrow">¶</a>
</li>
<li id="section-a.2-1.9">added Authentication Request, Authentication Response, authentication handle<a href="#section-a.2-1.9" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-02">
<section id="section-a.3">
        <h2 id="name-draft-hardt-xauth-protocol-02">
<a href="#section-a.3" class="section-number selfRef">A.3. </a><a href="#name-draft-hardt-xauth-protocol-02" class="section-name selfRef">draft-hardt-xauth-protocol-02</a>
        </h2>
<ul>
<li id="section-a.3-1.1">major rewrite<a href="#section-a.3-1.1" class="pilcrow">¶</a>
</li>
<li id="section-a.3-1.2">handles are now URIs<a href="#section-a.3-1.2" class="pilcrow">¶</a>
</li>
<li id="section-a.3-1.3">the collection of claims and authorizations are a Grant<a href="#section-a.3-1.3" class="pilcrow">¶</a>
</li>
<li id="section-a.3-1.4">an Authorization is its own type<a href="#section-a.3-1.4" class="pilcrow">¶</a>
</li>
<li id="section-a.3-1.5">lots of sequences added<a href="#section-a.3-1.5" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-03">
<section id="section-a.4">
        <h2 id="name-draft-hardt-xauth-protocol-03">
<a href="#section-a.4" class="section-number selfRef">A.4. </a><a href="#name-draft-hardt-xauth-protocol-03" class="section-name selfRef">draft-hardt-xauth-protocol-03</a>
        </h2>
<ul>
<li id="section-a.4-1.1">fixed RO definition<a href="#section-a.4-1.1" class="pilcrow">¶</a>
</li>
<li id="section-a.4-1.2">improved language in Rationals<a href="#section-a.4-1.2" class="pilcrow">¶</a>
</li>
<li id="section-a.4-1.3">added user code interaction method, and aligned qrcode interaction method<a href="#section-a.4-1.3" class="pilcrow">¶</a>
</li>
<li id="section-a.4-1.4">added completion_uri for code flows<a href="#section-a.4-1.4" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="draft-hardt-xauth-protocol-03-1">
<section id="section-a.5">
        <h2 id="name-draft-hardt-xauth-protocol-03-2">
<a href="#section-a.5" class="section-number selfRef">A.5. </a><a href="#name-draft-hardt-xauth-protocol-03-2" class="section-name selfRef">draft-hardt-xauth-protocol-03</a>
        </h2>
<ul>
<li id="section-a.5-1.1">renamed interaction uris to have purpose specific names<a href="#section-a.5-1.1" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
</section>
</div>
<div id="comparison-with-oauth-20-and-openid-connect">
<section id="section-appendix.b">
      <h2 id="name-comparison-with-oauth-20-an">
<a href="#section-appendix.b" class="section-number selfRef">Appendix B. </a><a href="#name-comparison-with-oauth-20-an" class="section-name selfRef">Comparison with OAuth 2.0 and OpenID Connect</a>
      </h2>
<p id="section-appendix.b-1"><strong>Changed Features</strong><a href="#section-appendix.b-1" class="pilcrow">¶</a></p>
<p id="section-appendix.b-2">The major changes between this protocol and OAuth 2.0 and OpenID Connect are:<a href="#section-appendix.b-2" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.b-3.1">The Client uses a private key to authenticate in this protocol instead of the client secret in OAuth 2.0 and OpenID Connect.<a href="#section-appendix.b-3.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-3.2">The Client initiates the protocol by making a signed request directly to the GS instead of redirecting the User to the GS.<a href="#section-appendix.b-3.2" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-3.3">The Client does not pass any parameters in redirecting the User to the GS, nor receive any parameters in the redirection back from the GS.<a href="#section-appendix.b-3.3" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-3.4">The refresh_token has been replaced with a AuthZ URI that both represents the access, and is the URI to call to refresh access.<a href="#section-appendix.b-3.4" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-3.5">The Client can request identity claims to be returned independent of the ID Token. There is no UserInfo endpoint to query claims as there is in OpenID Connect.<a href="#section-appendix.b-3.5" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-3.6">The GS URI is the token endpoint. CHECK!!!s<a href="#section-appendix.b-3.6" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-appendix.b-4"><strong>Preserved Features</strong><a href="#section-appendix.b-4" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.b-5.1">This protocol reuses the OAuth 2.0 scopes, Client IDs, and access tokens of OAuth 2.0.<a href="#section-appendix.b-5.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-5.2">This protocol reuses the Client IDs, Claims and ID Token of OpenID Connect.<a href="#section-appendix.b-5.2" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-5.3">No change is required by the Client or the RS for existing bearer token protected APIs.<a href="#section-appendix.b-5.3" class="pilcrow">¶</a>
</li>
</ul>
<p id="section-appendix.b-6"><strong>New Features</strong><a href="#section-appendix.b-6" class="pilcrow">¶</a></p>
<ul>
<li id="section-appendix.b-7.1">A Grant represents the user identity claims and RS access granted to the Client.<a href="#section-appendix.b-7.1" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-7.2">The Client can update, retrieve, and delete a Grant.<a href="#section-appendix.b-7.2" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-7.3">The GS can initiate a flow by creating a Grant and redirecting the User to the Client with the Grant URI.<a href="#section-appendix.b-7.3" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-7.4">The Client can discovery if an GS has a User with an identifier before the GS interacts with the User.<a href="#section-appendix.b-7.4" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-7.5">The Client can request the GS to first authenticate the User and return User identity claims, and then the Client can update Grant request based on the User identity.<a href="#section-appendix.b-7.5" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-7.6">Support for QR Code initiated interactions.<a href="#section-appendix.b-7.6" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-7.7">Each Client instance can have its own private / public key pair.<a href="#section-appendix.b-7.7" class="pilcrow">¶</a>
</li>
<li id="section-appendix.b-7.8">More Extensibility dimensions.<a href="#section-appendix.b-7.8" class="pilcrow">¶</a>
</li>
</ul>
</section>
</div>
<div id="open-questions">
<section id="section-appendix.c">
      <h2 id="name-open-questions">
<a href="#section-appendix.c" class="section-number selfRef">Appendix C. </a><a href="#name-open-questions" class="section-name selfRef">Open Questions</a>
      </h2>
<ol start="1" type="1" class="normal type-1" id="section-appendix.c-1">
        <li id="section-appendix.c-1.1"><a href="#section-appendix.c-1.1" class="pilcrow">¶</a></li>
</ol>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.d">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Dick Hardt (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">SignIn.Org</span></div>
<div dir="auto" class="left"><span class="country-name">United States</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:dick.hardt@gmail.com" class="email">dick.hardt@gmail.com</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
