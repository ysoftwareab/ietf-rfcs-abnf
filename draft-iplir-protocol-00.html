<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>IPlir network layer security protocol</title>
<meta content="Davletshina Alexandra" name="author">
<meta content="Urivskiy Alexey" name="author">
<meta content="Rybkin Andrey" name="author">
<meta content="Tychina Leonid" name="author">
<meta content="Parshin Ilia" name="author">
<meta content="
       
                This document specifies the IPlir network layer security protocol. It 
 describes how to provide a set of security services for traffic over 
 public and corporate networks using the TCP/IP stack.
       
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="list of keywords" name="keyword">
<meta content="draft-iplir-protocol-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.4
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.26.0
    setuptools 59.5.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-iplir-00-f82kkxe7.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Abbreviated Title</td>
<td class="right">December 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Davletshina, et al.</td>
<td class="center">Expires 17 June 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-iplir-protocol-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-12-14" class="published">14 December 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-06-17">17 June 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Davletshina, <span class="editor">Ed.</span>
</div>
<div class="org">InfoTeCS</div>
</div>
<div class="author">
      <div class="author-name">A. Urivskiy</div>
<div class="org">InfoTeCS</div>
</div>
<div class="author">
      <div class="author-name">A. Rybkin</div>
<div class="org">InfoTeCS</div>
</div>
<div class="author">
      <div class="author-name">L. Tychina</div>
<div class="org">InfoTeCS</div>
</div>
<div class="author">
      <div class="author-name">I. Parshin</div>
<div class="org">InfoTeCS</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">IPlir network layer security protocol</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
                This document specifies the IPlir network layer security protocol. It 
 describes how to provide a set of security services for traffic over 
 public and corporate networks using the TCP/IP stack.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 17 June 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-scope" class="xref">Scope</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-audience" class="xref">Audience</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-conventions-used-in-this-do" class="xref">Conventions Used in This Document</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-definitions-and-notations" class="xref">Definitions and Notations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-definitions" class="xref">Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-notations" class="xref">Notations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-system-overview" class="xref">System overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-iplir-packet-contents" class="xref">IPlir packet contents</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-iplir-message-content" class="xref">IPlir message content</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-tuples-type-length-value" class="xref">Tuples (type, length, value)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-pair-of-ipv4-addresses" class="xref">Pair of IPv4 addresses</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-pair-of-ipv6-addresses" class="xref">Pair of IPv6 addresses</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.  <a href="#name-iplir-packet-structure-and-" class="xref">IPlir packet structure and IPlir header location</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.1">
                    <p id="section-toc.1-1.4.2.4.2.1.1"><a href="#section-4.4.1" class="xref">4.4.1</a>.  <a href="#name-transport-mode" class="xref">Transport mode</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.2">
                    <p id="section-toc.1-1.4.2.4.2.2.1"><a href="#section-4.4.2" class="xref">4.4.2</a>.  <a href="#name-light-tunnel" class="xref">Light tunnel</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4.2.3">
                    <p id="section-toc.1-1.4.2.4.2.3.1"><a href="#section-4.4.3" class="xref">4.4.3</a>.  <a href="#name-tunnel-mode" class="xref">Tunnel mode</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-encryption-and-mac" class="xref">Encryption and MAC</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-cryptographic-keys" class="xref">Cryptographic keys</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-cryptographic-suites" class="xref">Cryptographic suites</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-magma-mgm-cryptographic-sui" class="xref">MAGMA-MGM cryptographic suite: CS = 1</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1.2.1">
                        <p id="section-toc.1-1.5.2.3.2.1.2.1.1"><a href="#section-5.3.1.1" class="xref">5.3.1.1</a>.  <a href="#name-exchange-keys" class="xref">Exchange keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1.2.2">
                        <p id="section-toc.1-1.5.2.3.2.1.2.2.1"><a href="#section-5.3.1.2" class="xref">5.3.1.2</a>.  <a href="#name-requirements-for-initializi" class="xref">Requirements for initializing values</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1.2.3">
                        <p id="section-toc.1-1.5.2.3.2.1.2.3.1"><a href="#section-5.3.1.3" class="xref">5.3.1.3</a>.  <a href="#name-key-derivation-algorithms" class="xref">Key derivation algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.1.2.4">
                        <p id="section-toc.1-1.5.2.3.2.1.2.4.1"><a href="#section-5.3.1.4" class="xref">5.3.1.4</a>.  <a href="#name-encryption-and-mac-algorith" class="xref">Encryption and MAC algorithms</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-kuzn-ctr-cmac-cryptographic" class="xref">KUZN-CTR-CMAC cryptographic suite: CS=2</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2.2.1">
                        <p id="section-toc.1-1.5.2.3.2.2.2.1.1"><a href="#section-5.3.2.1" class="xref">5.3.2.1</a>.  <a href="#name-exchange-keys-2" class="xref">Exchange keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2.2.2">
                        <p id="section-toc.1-1.5.2.3.2.2.2.2.1"><a href="#section-5.3.2.2" class="xref">5.3.2.2</a>.  <a href="#name-requirements-for-initializin" class="xref">Requirements for initializing values</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2.2.3">
                        <p id="section-toc.1-1.5.2.3.2.2.2.3.1"><a href="#section-5.3.2.3" class="xref">5.3.2.3</a>.  <a href="#name-key-derivation-algorithms-2" class="xref">Key derivation algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.2.2.4">
                        <p id="section-toc.1-1.5.2.3.2.2.2.4.1"><a href="#section-5.3.2.4" class="xref">5.3.2.4</a>.  <a href="#name-encryption-and-mac-algorithm" class="xref">Encryption and MAC algorithms</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3">
                    <p id="section-toc.1-1.5.2.3.2.3.1"><a href="#section-5.3.3" class="xref">5.3.3</a>.  <a href="#name-aes-128-gcm-cryptographic-s" class="xref">AES-128-GCM cryptographic suite: CS = 129</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3.2.1">
                        <p id="section-toc.1-1.5.2.3.2.3.2.1.1"><a href="#section-5.3.3.1" class="xref">5.3.3.1</a>.  <a href="#name-exchange-keys-3" class="xref">Exchange keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3.2.2">
                        <p id="section-toc.1-1.5.2.3.2.3.2.2.1"><a href="#section-5.3.3.2" class="xref">5.3.3.2</a>.  <a href="#name-requirements-for-initializing" class="xref">Requirements for initializing values</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3.2.3">
                        <p id="section-toc.1-1.5.2.3.2.3.2.3.1"><a href="#section-5.3.3.3" class="xref">5.3.3.3</a>.  <a href="#name-key-derivation-algorithms-3" class="xref">Key derivation algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.3.2.4">
                        <p id="section-toc.1-1.5.2.3.2.3.2.4.1"><a href="#section-5.3.3.4" class="xref">5.3.3.4</a>.  <a href="#name-encryption-and-mac-algorithms" class="xref">Encryption and MAC algorithms</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4">
                    <p id="section-toc.1-1.5.2.3.2.4.1"><a href="#section-5.3.4" class="xref">5.3.4</a>.  <a href="#name-aes-256-ctr-cmac-cryptograp" class="xref">AES-256-CTR-CMAC cryptographic suite: CS = 132</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4.2.1">
                        <p id="section-toc.1-1.5.2.3.2.4.2.1.1"><a href="#section-5.3.4.1" class="xref">5.3.4.1</a>.  <a href="#name-exchange-keys-4" class="xref">Exchange keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4.2.2">
                        <p id="section-toc.1-1.5.2.3.2.4.2.2.1"><a href="#section-5.3.4.2" class="xref">5.3.4.2</a>.  <a href="#name-requirements-for-initializing-" class="xref">Requirements for initializing values</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4.2.3">
                        <p id="section-toc.1-1.5.2.3.2.4.2.3.1"><a href="#section-5.3.4.3" class="xref">5.3.4.3</a>.  <a href="#name-key-derivation-algorithms-4" class="xref">Key derivation algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.4.2.4">
                        <p id="section-toc.1-1.5.2.3.2.4.2.4.1"><a href="#section-5.3.4.4" class="xref">5.3.4.4</a>.  <a href="#name-encryption-and-mac-algorithms-2" class="xref">Encryption and MAC algorithms</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.5">
                    <p id="section-toc.1-1.5.2.3.2.5.1"><a href="#section-5.3.5" class="xref">5.3.5</a>.  <a href="#name-aes-256-cfb-cmac-cryptograp" class="xref">AES-256-CFB-CMAC cryptographic suite: CS = 134</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.5.2.1">
                        <p id="section-toc.1-1.5.2.3.2.5.2.1.1"><a href="#section-5.3.5.1" class="xref">5.3.5.1</a>.  <a href="#name-exchange-keys-5" class="xref">Exchange keys</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.5.2.2">
                        <p id="section-toc.1-1.5.2.3.2.5.2.2.1"><a href="#section-5.3.5.2" class="xref">5.3.5.2</a>.  <a href="#name-requirements-for-initializing-v" class="xref">Requirements for initializing values</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.5.2.3">
                        <p id="section-toc.1-1.5.2.3.2.5.2.3.1"><a href="#section-5.3.5.3" class="xref">5.3.5.3</a>.  <a href="#name-key-derivation-algorithms-5" class="xref">Key derivation algorithms</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5.2.3.2.5.2.4">
                        <p id="section-toc.1-1.5.2.3.2.5.2.4.1"><a href="#section-5.3.5.4" class="xref">5.3.5.4</a>.  <a href="#name-encryption-and-mac-algorithms-3" class="xref">Encryption and MAC algorithms</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iplir-packet-processing" class="xref">IPlir packet processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-ip-and-iplir-packet-fragmen" class="xref">IP and IPlir packet fragmentation</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-source-ip-packet-protection" class="xref">Source IP packet protection by the sender host</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-iplir-packet-processing-on-" class="xref">IPlir packet processing on the forward host</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-source-ip-packet-recovery-b" class="xref">Source IP packet recovery by the recipient host</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="Introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="Scope">
<section id="section-1.1">
        <h3 id="name-scope">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
        </h3>
<p id="section-1.1-1">
 The IPlir protocol may be used to protect IP packets during their 
 transmission via communication channels. IP packet protection means 
 ensuring integrity and authenticity of the data source of the packets 
 with an option of also ensuring their confidentiality. For this purpose, 
 when IPlir is applied, encapsulation of source IP packets, calculation 
 of message authentication codes for the encapsulated packets and service 
 information along with optional packet encryption are used. In addition, 
 the IPlir protocol allows for protection against replay attacks based on 
 the use of counter values and/or timestamps.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">
 The IPlir protocol can be used to create Virtual Private Networks at the 
 3rd (network) layer of the basic ISO OSI reference model. Data is 
 protected during transfer of IP packets between any two hosts supporting 
 the IPlir protocol, including options of data exchange between two end 
 hosts, an end host and a security gateway, and two security gateways. 
 All protection mechanisms are implemented without establishing a 
 connection (in terms of network) between the two interacting hosts.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">
 This document is not a Security Architecture for the Internet; it 
 addresses security only at the network layer, provided through the 
 use of a combination of cryptographic and protocol security mechanisms.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<p id="section-1.1-4">
 This document does not have IETF consensus and does not imply IETF 
 support for IPlir.<a href="#section-1.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Audience">
<section id="section-1.2">
        <h3 id="name-audience">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-audience" class="section-name selfRef">Audience</a>
        </h3>
<p id="section-1.2-1">
 The target audience for this document is primarily individuals who 
 implement this network layer security technology or who architect 
 systems that will use this technology. Technically adept users of this 
 technology(end users or system administrators) also are part of the 
 target audience.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">
 This document assumes that the reader is familiar with the Internet 
 Protocol (IP), related networking technology, and general information 
 system security terms and concepts.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-2">
      <h2 id="name-conventions-used-in-this-do">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-conventions-used-in-this-do" class="section-name selfRef">Conventions Used in This Document</a>
      </h2>
<p id="section-2-1">
                The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", 
 "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this 
 document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
        <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
<div id="Terms">
<section id="section-3">
      <h2 id="name-definitions-and-notations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-definitions-and-notations" class="section-name selfRef">Definitions and Notations</a>
      </h2>
<div id="Definitions">
<section id="section-3.1">
        <h3 id="name-definitions">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<p id="section-3.1-1">
 This document uses the following terms and definitions:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.1-2.1">AEAD: Authenticated Encryption with Associated Data,<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.2">cryptographic suite: a set of cryptographic algorithms and 
 parameters used in the IPlir,<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.3">CTR mode: a block cipher mode of operation when a cipher key 
 stream is applied to plaintext data under a specific law,<a href="#section-3.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.4">derived key: a key derived from the shared secret (original 
 key) and random and/or fixed mutually known data,<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.5">end-to-end MAC: MAC implemented between the source and destination hosts,<a href="#section-3.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.6">exchange key: a key known only to the specified pair of hosts 
 used to derive keys,<a href="#section-3.1-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.7">host (network host): a network device with a unique ID and IPlir support,<a href="#section-3.1-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.8">initializing value: a value transmitted over the communication 
 channel and used in defining the starting point of a symmetric 
 cryptographic technique,<a href="#section-3.1-2.8" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.9">IP packet (network packet): a logically indivisible data block at 
 the network layer of the basic ISO OSI reference model relating to the IP,<a href="#section-3.1-2.9" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.10">IPlir message: the data contained in the IPlir packet body,<a href="#section-3.1-2.10" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.11">IPlir operation mode: one of the three IPlir operating modes: 
 transport, light tunnel, and tunnel,<a href="#section-3.1-2.11" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.12">IPlir packet: an IP packet protected by IPlir,<a href="#section-3.1-2.12" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.13">IPlir packets reception policy: a set of rules for processing incoming 
 IPlir packets,<a href="#section-3.1-2.13" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.14">key: a sequence of symbols that controls the operation of a 
 cryptographic transformation,<a href="#section-3.1-2.14" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.15">key system: a set of keys, their deployment and management subsystems,<a href="#section-3.1-2.15" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.16">MAC (message authentication code): a fixed-length string of bits 
 (tag) computed by applying a symmetric cryptographic technique to the 
 message and appended to that message in order to provide its integrity 
 and authenticity of the data source,<a href="#section-3.1-2.16" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.17">network host context: the information necessary to process/create IPlir 
 packets from/to the network host logically related to the given one,<a href="#section-3.1-2.17" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.18">security policy: a set of rules for IP traffic processing by the network host,<a href="#section-3.1-2.18" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.19">sender host: the host creating an IPlir packet from a source IP packet,<a href="#section-3.1-2.19" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.20">source IP packet: an IP packet before it was protected by the IPlir,<a href="#section-3.1-2.20" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.21">symmetric cryptographic technique: a cryptographic technique that uses 
 the same key for both the originator's and recipient's transformation,<a href="#section-3.1-2.21" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.22">recipient host: the host recovering the source IP packet from an IPlir packet,<a href="#section-3.1-2.22" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.23">routing of IPlir packets: a function of forwarding IPlir packets by a 
 network host during reception of IPlir packets addressed to this network 
 host from the IP perspective, but for which it is not the recipient host,<a href="#section-3.1-2.23" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.24">transit MAC: MAC implemented between two neighbor hosts in a packet 
 transfer chain,<a href="#section-3.1-2.24" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.1-2.25">transit host: the host implementing the function of routing IPlir packets.<a href="#section-3.1-2.25" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="Notations">
<section id="section-3.2">
        <h3 id="name-notations">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-notations" class="section-name selfRef">Notations</a>
        </h3>
<p id="section-3.2-1">
 The following notations are used in this document:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<table class="left" id="table-1">
          <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1"></th>
              <th class="text-left" rowspan="1" colspan="1"></th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">V^{*}</td>
              <td class="text-left" rowspan="1" colspan="1">a set of all finite length binary strings, including an empty string</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">|x|</td>
              <td class="text-left" rowspan="1" colspan="1">the length (number of components) of the string x \in V^{*}</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">V_s</td>
              <td class="text-left" rowspan="1" colspan="1">a set of all binary strings with a length of s, where s is a non-negative integer; 
 numbering of substrings and components is right-to-left, starting with zero</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">x||y</td>
              <td class="text-left" rowspan="1" colspan="1">concatenation of binary strings x and y from V^{*}, i.e., a string from V_{|x|+|y|}, 
 wherein the left substring from V_{|x|} is the same as string x, and the right 
 substring from V_{|y|} is the same as string y</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0^r</td>
              <td class="text-left" rowspan="1" colspan="1">a binary string consisting of r zeros</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">LSB_s(x)</td>
              <td class="text-left" rowspan="1" colspan="1">truncation of binary string x with a length of m, m &gt;= s, to a binary string 
 with a length of s according to the following rule: 
 LSB_s(x_{m-1} || ... || x_1 || x_0) = x_{s-1} || ... || x_1 || x_0, xi \in V_1, 
 i = 0,1,...,m-1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IntToVec_s(x)</td>
              <td class="text-left" rowspan="1" colspan="1">representation of the ring element x \in Z_{2^s} as a binary string 
 with a length of s: for x = x_0 + 2 * x_1 + ... + 2^{s-1} * x_{s-1}, 
 where x_i \in V_1, i = 0,1,...,s-1, the following equation is true 
 IntToVec_s(x) = x_{s-1} || ... || x_1 || x_0</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CharToByte(c)</td>
              <td class="text-left" rowspan="1" colspan="1">representation of the c symbol as a binary string of length 8 calculated 
 according to the following rule: CharToByte(c) = 0 || IntToVec_7(ASCII(c)), 
 where ASCII(c) \in Z_{2^7} is the ASCII representation of the c symbol</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">StrToVec_s(string)</td>
              <td class="text-left" rowspan="1" colspan="1">representation of the string of symbols string = 'c_{m-1}c_{m-2}...c_0' consisting 
 of m symbols as a binary string with a length of s, s &gt;= 8*m according to 
 the following rule: StrToVec_s('c_{m-1}c_{m-2}...c_0') = 
 0^{s-8*m} || CharToByte(c_{m-1}) || CharToByte(c_{m-2}) || ... || CharToByte(c_0)</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">K_ENC</td>
              <td class="text-left" rowspan="1" colspan="1">packet encryption key. The length of the value is determined by the used cryptographic 
 suite</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">K_MAC</td>
              <td class="text-left" rowspan="1" colspan="1">packet end-to-end MAC key. The length of the value is determined by the used 
 cryptographic suite</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">K_AEAD</td>
              <td class="text-left" rowspan="1" colspan="1">packet encryption and end-to-end MAC key. The length of the value is determined 
 by the used cryptographic suite</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">K_TMAC</td>
              <td class="text-left" rowspan="1" colspan="1">packet transit MAC key. The length of the value is determined by the used 
 cryptographic suite</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Version</td>
              <td class="text-left" rowspan="1" colspan="1">IPlir header version. This document describes the IPlir header of Version = 1. 
 The field length is 8 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">CS</td>
              <td class="text-left" rowspan="1" colspan="1">cryptographic suite identifier determining the contents of cryptographic mechanisms 
 and their parameters used to create the IPlir packet. The field length is 8 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">T</td>
              <td class="text-left" rowspan="1" colspan="1">the transit MAC field flag. If T = 1, the IPlir trailer contains fields 
 TransitIdentifier, TransitIntegrityCheckValue and TransitInitValue, otherwise 
 the fields are absent. When calculating and checking the end-to-end MAC (ICV) 
 insert the T field has to be set to 0. The field length is 1 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">D</td>
              <td class="text-left" rowspan="1" colspan="1">the DestinationIdentifier field flag. If D = 1, the header contains the 
 DestinationIdentifier field, otherwise the field is absent. The destination 
 host identifier is required for routing of IPlir packets. The field length is 
 1 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ExtID</td>
              <td class="text-left" rowspan="1" colspan="1">the flag of extended network host identifiers. If ExtID = 0, all the network 
 host identifiers (the SourceIdentifier field and, if available, 
 DestinationIdentifier and TransitIdentifier fields) are 32 bits long. 
 If ExtID = 1, all the network host identifiers are 64 bits long. 
 The field length is 1 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ExtSN</td>
              <td class="text-left" rowspan="1" colspan="1">the packet extended sequence number flag. If ExtSN=0, the packet SequenceNumber 
 field is 32 bits long. If ExtSN = 1, the SequenceNumber field is 64 bits long. 
 The field length is 1 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">DAR</td>
              <td class="text-left" rowspan="1" colspan="1">the flag of disabling the anti-replay mechanism. The use of the flag is regulated 
 by security policies. The field length is 1 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">R1</td>
              <td class="text-left" rowspan="1" colspan="1">the field reserved for future use. When IPlir header is generated, the field must 
 contain all zeros. The receiving end must not analyze the field content. 
 The field length is 3 bits</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">KN</td>
              <td class="text-left" rowspan="1" colspan="1">the number of the exchange key used to encrypt and calculate the end-to-end MAC, 
 but not the transit MAC. The field length is 4 bits</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TKN</td>
              <td class="text-left" rowspan="1" colspan="1">the number of the exchange key used to calculate the transit MAC. 
 If the transit MAC is not used, i.e., T = 0, the field value should be 0. 
 When calculating and checking the end-to-end MAC (ICV), the TKN field must be 
 filled with zeros. The field length is 4 bits</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Timestamp</td>
              <td class="text-left" rowspan="1" colspan="1">packet send time. The field contains the send time value based on the astronomical 
 clock of the sender host in the POSIX time format less 0x40000000 seconds. 
 The estimated overflow time is the year 2140. The field length is 32 bits</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SourceIdentifier</td>
              <td class="text-left" rowspan="1" colspan="1">the source host identifier used by the destination host to identify the IPlir 
 packet sender and the related context of the sender host for packet processing. 
 The field length is 32 bits with ExtID = 0, or 64 bits with ExtID = 1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">DestinationIdentifier</td>
              <td class="text-left" rowspan="1" colspan="1">the destination host identifier required for routing of IPlir packets. 
 The field is available, if D = 0. The field length is 32 bits with ExtID = 0, 
 or 64 bits with ExtID = 1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SequenceNumber</td>
              <td class="text-left" rowspan="1" colspan="1">the packet sequence number; an unsigned integer. The field length is 32 bits 
 with ExtSN = 0, or 64 bits with ExtSN = 1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">InitValue (IV)</td>
              <td class="text-left" rowspan="1" colspan="1">an end-to-end initializing value that can be used to execute encryption 
 operations and calculate an end-to-end MAC, as well as to derive keys for 
 these operations. The field length is determined by the used cryptographic suite</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Type, Length, Value</td>
              <td class="text-left" rowspan="1" colspan="1">(type, length, value) tuples enabling transmission of additional information 
 within the IPlir packet. Type is the type of the value in the Value field. 
 The field length is 8 bit. Length is the byte length of the Value field. 
 The field length is 8 bit. Value is random data of the Type type</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">PayloadData</td>
              <td class="text-left" rowspan="1" colspan="1">a variable-length field containing the source IP packet or its part, 
 depending on the IPlir operation mode</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Staffing</td>
              <td class="text-left" rowspan="1" colspan="1">a (network) filler to make the length of the IPlir suitable for more efficient 
 providing of the IPlir message processing. The Staffing field contains a sequence 
 of integers in a binary form: the first byte contains digit 1, the second one 
 contains 2, etc. The value length is determined by the SL field value, if SL is 
 absent (S = 0) or has the value 0, there is no Staffing field</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">SL</td>
              <td class="text-left" rowspan="1" colspan="1">the number of bytes in the Staffing field. The field is available, if S = 1. 
 The field length is 8 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">Mode</td>
              <td class="text-left" rowspan="1" colspan="1">the mode in which the IPlir packet was generated in. The field length is 2 bits</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TLV</td>
              <td class="text-left" rowspan="1" colspan="1">Type, Length and Value field flag. If TLV = 1, the IPlir body begins with tuples 
 (Type, Length, Value), otherwise there are no tuples. The field length is 1 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">S</td>
              <td class="text-left" rowspan="1" colspan="1">the SL field flag. If S = 1, the IPlir body contains the SL field, otherwise this 
 field is absent. The field length is 1 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">R2</td>
              <td class="text-left" rowspan="1" colspan="1">the field reserved for future use. When an IPlir message is generated, the field 
 must contain all zeros. The receiving end must not analyze the field content. 
 The field length is 4 bits</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">NextHeader</td>
              <td class="text-left" rowspan="1" colspan="1">the source IP packet protocol number. The field length is 8 bit</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">IntegrityCheckValue (ICV)</td>
              <td class="text-left" rowspan="1" colspan="1">an end-to-end MAC calculated for the data from the IPlir message start and to the 
 NextHeader field inclusive. The field length is determined by the used 
 cryptographic suite</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TransitIdentifier</td>
              <td class="text-left" rowspan="1" colspan="1">the identifier of the transit host that routed the IPlir packet last. 
 Each transit host updates the field value with its identifier. 
 The field is available, if T = 1. The field length is 32 bits with ExtID = 0, 
 or 64 bits with ExtID = 1</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TransitInitValue (TIV)</td>
              <td class="text-left" rowspan="1" colspan="1">the transit initializing value used to calculate a transit MAC and derive keys 
 for packet transit MAC. The field is available, if T = 1. The field length is 
 determined by the used cryptographic suite</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">TransitIntegrityCheckValue (TICV)</td>
              <td class="text-left" rowspan="1" colspan="1">a transit MAC calculated for the data from the IPlir message start and to the 
 TransitInitValue field inclusive. The field is available, if T = 1. 
 The field length is determined by the used cryptographic suite</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
</section>
</div>
<div id="System">
<section id="section-4">
      <h2 id="name-system-overview">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-system-overview" class="section-name selfRef">System overview</a>
      </h2>
<div id="Packet">
<section id="section-4.1">
        <h3 id="name-iplir-packet-contents">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-iplir-packet-contents" class="section-name selfRef">IPlir packet contents</a>
        </h3>
<p id="section-4.1-1">
 The IPlir packet structure is shown in Figure 1.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span id="name-figure-1-iplir-packet-struc"></span><figure id="figure-1">
          <div class="alignCenter art-text artwork" id="section-4.1-2.1">
<pre>
+------------+------------+--------------------+
| IP header  | UDP header | IPlir message      |
+------------+------------+--------------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-figure-1-iplir-packet-struc" class="selfRef">Figure 1. IPlir packet structure</a>
          </figcaption></figure>
<p id="section-4.1-3">
 The IP header is the header of a standard IP packet, where the Protocol field for IPv4 
 and the NextHeader field for IPv6 contain the value 241 or, in case of additional UDP 
 encapsulation, 17.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1-4">
 The UDP header is a standard UDP header only existing when additional encapsulation of 
 the IPlir message in a UDP message is used. The IPlir protocol uses UDP destination port 
 number 55777 as a default port.<a href="#section-4.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1-5">
 The IPlir message is the main part of the IPlir packet that includes protected data from 
 the source IP packet and plaintext data required for IPlir packet processing.<a href="#section-4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Message">
<section id="section-4.2">
        <h3 id="name-iplir-message-content">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-iplir-message-content" class="section-name selfRef">IPlir message content</a>
        </h3>
<p id="section-4.2-1">
 The IPlir message contains:<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">IPlir header containing plaintext information related to encapsulation and protection 
 of the source IP packet;<a href="#section-4.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.2">IPlir body containing information the encryption of which is optional;<a href="#section-4.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-4.2-2.3">IPlir trailer containing MACs, the transit host identifier, and the transit initializing value.<a href="#section-4.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-4.2-3">
 The IPlir message structure is shown in Figure 2.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<span id="name-figure-2-iplir-message-stru"></span><figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-4.2-4.1">
<pre>
+---+---------------+---------------+---------------+---------------+
|   |       0       |       1       |       2       |       3       |
+---+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Bit|7|6|5|4|3|2|1|0|7|6|5|4|3|2|1|0|7|6|5|4|3|2|1|0|7|6|5|4|3|2|1|0|
+---+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   |               |               | | |E|E| |     |       |       |
| I |               |               | | |x|x|D|     |       |       |
| P |    Version    |      CS       |T|D|t|t|A| R1  |  KN   |  TKN  |
| l |               |               | | |I|S|R|     |       |       |
| i |               |               | | |D|N| |     |       |       |
| r +---------------+---------------+-+-+-+-+-+-----+-------+-------+
|   |   Timestamp                                                   |
|   +---------------------------------------------------------------+
| h |   SourceIdentifier                                            |
| e +---------------------------------------------------------------+
| a |   DestinationIdentifier                                       |
| d +---------------------------------------------------------------+
| e |   SequenceNumber                                              |
| r +---------------------------------------------------------------+
|   |   InitValue                                                   |
+---+---------------+---------------+-------------------------------+
|   |   Type_1      |   Length_1    |   Value_1 (Length_1 byte)     |
|   +---------------+---------------+-------------------------------+
| I |   ...                                                         |
| P +---------------+---------------+-------------------------------+
| l |   Type_n      |   Length_n    |   Value_n (Length_n byte)     |
| i +---------------+---------------+-------------------------------+
| r |   PayloadData                                                 |
|   +---------------------------------------------------------------+
| b |   Staffing                                                    |
| o |               +---------------+---+-+-+-------+---------------+
| d |               |               | M |T| |       |               |
| y |               |      SL       | o |L|S|  R2   |  NextHeader   |
|   |               |               | d |V| |       |               |
|   |               |               | e | | |       |               |
+---+---------------+---------------+---+-+-+-------+---------------+
|  t|   IntegrityCheckValue (ICV)                                   |
|I r+---------------------------------------------------------------+
|P a|   TransitIdentifier                                           |
|l i+---------------------------------------------------------------+
|i l|   TransitInitValue                                            |
|r e+---------------------------------------------------------------+
|  r|   TransitIntegrityCheckValue (TICV)                           |
+---+---------------------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-figure-2-iplir-message-stru" class="selfRef">Figure 2. IPlir message structure</a>
          </figcaption></figure>
<p id="section-4.2-5">
 The IPlir message fields have a big-endian order of bytes. The numbering is left-to-right, 
 the lead bytes have lower numbers. Numbering of bits inside bytes is right-to-left, the high 
 bits have higher numbers.<a href="#section-4.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Tuples">
<section id="section-4.3">
        <h3 id="name-tuples-type-length-value">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-tuples-type-length-value" class="section-name selfRef">Tuples (type, length, value)</a>
        </h3>
<p id="section-4.3-1">
 Tuples (Type, Length, Value) enable transmission of additional information within the IPlir 
 message. The TLV field value indicates whether there are tuples. If its value is 1, there 
 is one or more tuples in the beginning of the IPlir body.<a href="#section-4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.3-2">
 The Value field of any tuple should be divisible by 8 bits. The Length field indicates 
 the Value field length in bytes.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">
 Permissible Type field values for the tuples are provided in Table 1.<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<span id="name-table-1-type-field-values-f"></span><table class="left" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-table-1-type-field-values-f" class="selfRef">Table 1 - Type Field Values for Tuples</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Type value</th>
              <th class="text-center" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0</td>
              <td class="text-center" rowspan="1" colspan="1">the last tuple in the IPlir message; can be used by the vendor for its own needs</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">1</td>
              <td class="text-center" rowspan="1" colspan="1">a pair of IPv4 addresses</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">2</td>
              <td class="text-center" rowspan="1" colspan="1">a pair of IPv6 addresses</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">3-128</td>
              <td class="text-center" rowspan="1" colspan="1">not in use</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">129-254</td>
              <td class="text-center" rowspan="1" colspan="1">can be used by the vendor for its own needs</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">255</td>
              <td class="text-center" rowspan="1" colspan="1">not in use</td>
            </tr>
          </tbody>
        </table>
<p id="section-4.3-5">
 The last tuple in the message is always type 0. The length of this tuple should be chosen so 
 as to ensure effective IPlir message processing.<a href="#section-4.3-5" class="pilcrow">¶</a></p>
<div id="IPv4">
<section id="section-4.3.1">
          <h4 id="name-pair-of-ipv4-addresses">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-pair-of-ipv4-addresses" class="section-name selfRef">Pair of IPv4 addresses</a>
          </h4>
<p id="section-4.3.1-1">
 The Value field of the tuple of this type contains a pair of IPv4 addresses. The sender's 
 address comes first, followed by the recipient's address. The addresses are transmitted 
 in the network byte order.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<p id="section-4.3.1-2">
 The main function of the tuple of this type is to preserve the IPv4 addresses from 
 the source IP packet in the "Light tunnel" mode.<a href="#section-4.3.1-2" class="pilcrow">¶</a></p>
<p id="section-4.3.1-3">
 The tuple structure is shown in Figure 3.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<span id="name-figure-3-type-1-tuple-struc"></span><figure id="figure-3">
            <div class="alignLeft art-text artwork" id="section-4.3.1-4.1">
<pre>
+------+--------------+--------------+--------------+--------------+
|Bytes |      0       |      1       |      2       |      3       |
+------+--------------+--------------+--------------+--------------+
|      |              |              |Sender IPv4   |              |
|      |   Type = 1   |  Length = 8  |address, byte |     ...      |
|      |              |              |No.1 (MSB)    |              |
|      +--------------+--------------+--------------+--------------+
| TLV  |              |Sender IPv4   |Recipient IPv4|              |
|      |     ...      |address, byte |address, byte |     ...      |
| area |              |No.4 (LSB)    |No.1 (MSB)    |              |
|      +--------------+--------------+--------------+--------------+
|      |              |Recipient IPv4|              |              |
|      |     ...      |address, byte |  Not in use  |  Not in use  |
|      |              |No.4 (LSB)    |              |              |
+------+--------------+--------------+--------------+--------------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-figure-3-type-1-tuple-struc" class="selfRef">Figure 3 - Type = 1 Tuple Structure</a>
            </figcaption></figure>
<p id="section-4.3.1-5">
 Note: Bytes labeled "not in use" contain information related to the following tuple.<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IPv6">
<section id="section-4.3.2">
          <h4 id="name-pair-of-ipv6-addresses">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-pair-of-ipv6-addresses" class="section-name selfRef">Pair of IPv6 addresses</a>
          </h4>
<p id="section-4.3.2-1">
 The Value field of the tuple of this type contains a pair of IPv6 addresses. 
 The sender's address comes first, followed by the recipient's address. 
 The addresses are transmitted in the network byte order.<a href="#section-4.3.2-1" class="pilcrow">¶</a></p>
<p id="section-4.3.2-2">
 The main function of the tuple of this type is to preserve the IPv6 addresses 
 from the source IP packet in the "Light tunnel" mode.<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
<p id="section-4.3.2-3">
 The tuple structure is shown in Figure 4.<a href="#section-4.3.2-3" class="pilcrow">¶</a></p>
<span id="name-figure-4-type-2-tuple-struc"></span><figure id="figure-4">
            <div class="alignLeft art-text artwork" id="section-4.3.2-4.1">
<pre>
+------+--------------+--------------+--------------+--------------+
|Bytes |      0       |      1       |      2       |      3       |
+------+--------------+--------------+--------------+--------------+
|      |              |              |Sender IPv6   |              |
|      |   Type = 2   |  Length = 32 |address, byte |     ...      |
|      |              |              |No.1 (MSB)    |              |
|      +--------------+--------------+--------------+--------------+
|      |                            ...                            |
|      +--------------+--------------+--------------+--------------+
| TLV  |              |Sender IPv6   |Recipient IPv6|              |
|      |     ...      |address, byte |address, byte |     ...      |
| area |              |No.16 (LSB)   |No.1 (MSB)    |              |
|      +--------------+--------------+--------------+--------------+
|      |                            ...                            |
|      +--------------+--------------+--------------+--------------+
|      |              |Recipient IPv6|              |              |
|      |     ...      |address, byte |  Not in use  |  Not in use  |
|      |              |No.16 (LSB)   |              |              |
+------+--------------+--------------+--------------+--------------+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-figure-4-type-2-tuple-struc" class="selfRef">Figure 4 - Type = 2 Tuple Structure</a>
            </figcaption></figure>
<p id="section-4.3.2-5">
 Note: Bytes labeled "not in use" contain information related to the following tuple.<a href="#section-4.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Mode">
<section id="section-4.4">
        <h3 id="name-iplir-packet-structure-and-">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-iplir-packet-structure-and-" class="section-name selfRef">IPlir packet structure and IPlir header location</a>
        </h3>
<p id="section-4.4-1">
 The IPlir protocol can operate in three modes: transport, tunnel, and light tunnel. 
 The transport and light tunnel modes ensure protection of the data generated by protocols 
 above the IP level in the basic ISO OSI reference model, in particular, by the transport 
 layer. The tunnel mode ensures protection of the entire source IP packet.<a href="#section-4.4-1" class="pilcrow">¶</a></p>
<p id="section-4.4-2">
 The receiving end determines what mode the packet was sent in based on the Mode field value. 
 Possible field values are shown in Table 2.<a href="#section-4.4-2" class="pilcrow">¶</a></p>
<span id="name-table-2-mode-field-values"></span><table class="left" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-table-2-mode-field-values" class="selfRef">Table 2 - Mode Field Values</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Mode field value</th>
              <th class="text-center" rowspan="1" colspan="1">Mode description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0</td>
              <td class="text-center" rowspan="1" colspan="1">transport mode</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">1</td>
              <td class="text-center" rowspan="1" colspan="1">light tunnel mode ("light tunnel")</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">2</td>
              <td class="text-center" rowspan="1" colspan="1">tunnel mode ("tunnel" mode)</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">3</td>
              <td class="text-center" rowspan="1" colspan="1">reserved for future needs</td>
            </tr>
          </tbody>
        </table>
<div id="Transport">
<section id="section-4.4.1">
          <h4 id="name-transport-mode">
<a href="#section-4.4.1" class="section-number selfRef">4.4.1. </a><a href="#name-transport-mode" class="section-name selfRef">Transport mode</a>
          </h4>
<p id="section-4.4.1-1">
 In the transport mode, the IPlir header and (Type, Length, Value)-tupples follow the 
 IP header and precede the header of the next layer (e.g., TCP, UDP, ICMP, etc.). 
 In the IPv4 context, it means that the IPlir header is located after the IP header, 
 including all options in the source IP packet, but before the header of the next level 
 protocol.<a href="#section-4.4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.4.1-2">
 Figure 5 shows an example of IP packet protection using the IPlir in the transport mode.<a href="#section-4.4.1-2" class="pilcrow">¶</a></p>
<span id="name-figure-5-ip-packet-protecti"></span><figure id="figure-5">
            <div class="alignLeft art-text artwork" id="section-4.4.1-3.1">
<pre>
+-------------------------+     +--------------------------+
|    Source IP packet     |     |       IPlir packet       |
|  +-------------------+  |     |  +--------------------+  |
|  |     IP header     |----------&gt;|     IP header      |  |
|  +-------------------+  |     |  +--------------------+  |
|  |  IP packet data   |-----+  |  |    IPlir header    |  |
|  +-------------------+  |  |  |  +--------------------+  |
+-------------------------+  |  |  |     IPlir body     |  |
                             |  |  | +----------------+ |  |
                             +------&gt;| IP packet data | |  |
                                |  | +----------------+ |  |
                                |  +--------------------+  |
                                |  |    IPlir trailer   |  |
                                |  +--------------------+  |
                                +--------------------------+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-figure-5-ip-packet-protecti" class="selfRef">Figure 5 - IP Packet Protection Using IPlir in the Transport Mode</a>
            </figcaption></figure>
<p id="section-4.4.1-4">
 In the IPv6 context, the IPlir header is addressed to the destination endpoint. 
 Therefore, it should be placed after the Hop-by-hop, Routing, and Fragmentation extension headers. 
 The Destination Options extension headers can be located before, after, or on both sides of the 
 IPlir header, depending on the required semantics. However, since the IPlir protocol can ensure 
 privacy of only the fields following the IPlir header, the recipient options should follow 
 the IPlir header.<a href="#section-4.4.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Light">
<section id="section-4.4.2">
          <h4 id="name-light-tunnel">
<a href="#section-4.4.2" class="section-number selfRef">4.4.2. </a><a href="#name-light-tunnel" class="section-name selfRef">Light tunnel</a>
          </h4>
<p id="section-4.4.2-1">
 Location of the IPlir header and (Type, Length, Value)-tuples in the light tunnel mode is the 
 same as in the transport mode, except that the set of tuples in the IPlir body must include 
 type 1 tuple (two IPv4 addresses) or type 2 tuple (two IPv6 addresses), wherein the sender 
 and recipient's addresses from the IP header of the source IP packet. The tuple type is 
 dictated by the version of the IP header of the source IP packet.<a href="#section-4.4.2-1" class="pilcrow">¶</a></p>
<p id="section-4.4.2-2">
 The recipient host can restore the initial IP addresses from the available tuple Value field.<a href="#section-4.4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.4.2-3">
 Unlike the transport mode, the light tunnel mode makes it possible to change addresses in the IPlir packet IP header.<a href="#section-4.4.2-3" class="pilcrow">¶</a></p>
<p id="section-4.4.2-4">
 Figure 6 shows an example of IP packet protection using the IPlir in the light tunnel mode.<a href="#section-4.4.2-4" class="pilcrow">¶</a></p>
<span id="name-figure-6-ip-packet-protecti"></span><figure id="figure-6">
            <div class="alignLeft art-text artwork" id="section-4.4.2-5.1">
<pre>
+--------------------------+     +------------------------------+
|     Source IP packet     |     |         IPlir packet         |
|  +--------------------+  |     |  +------------------------+  |
|  |     IP header      |  |     |  |       IP header        |  |
|  | +----------------+ |  |     |  | +--------------------+ |  |
|  | |   Source IP    | |  |     |  | |     Source IP      | |  |
|  | +----------------+ |----------&gt;| +--------------------+-------+
|  | | Destination IP | |  |     |  | |   Destination IP   | |  |  |
|  | +----------------+ |  |     |  | +--------------------+ |  |  |
|  +--------------------+  |     |  +------------------------+  |  |
|  |   IP packet data   |-----+  |  |      IPlir header      |  |  |
|  +--------------------+  |  |  |  +------------------------+  |  |
+--------------------------+  |  |  |       IPlir body       |  |  |
                              |  |  | +--------------------+ |  |  |
                              |  |  | |        TLV         | |  |  |
                              |  |  | | +----------------+ | |  |  |
                              |  |  | | |   Source IP    | | |  |  |
                              |  |  | | +----------------+&lt;--------+
                              |  |  | | | Destination IP | | |  |
                              |  |  | | +----------------+ | |  |
                              |  |  | +--------------------+ |  |
                              +------&gt;|   IP packet data   | |  |
                                 |  | +--------------------+ |  |
                                 |  +------------------------+  |
                                 |  |      IPlir trailer     |  |
                                 |  +------------------------+  |
                                 +------------------------------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-figure-6-ip-packet-protecti" class="selfRef">Figure 6 - IP Packet Protection Using IPlir in the Light Tunnel Mode</a>
            </figcaption></figure>
</section>
</div>
<div id="Tunnel">
<section id="section-4.4.3">
          <h4 id="name-tunnel-mode">
<a href="#section-4.4.3" class="section-number selfRef">4.4.3. </a><a href="#name-tunnel-mode" class="section-name selfRef">Tunnel mode</a>
          </h4>
<p id="section-4.4.3-1">
 Unlike the other modes, the tunnel mode protects the entire source IP packet, including its IP header.<a href="#section-4.4.3-1" class="pilcrow">¶</a></p>
<p id="section-4.4.3-2">
 In the tunnel mode, a new IP header is generated with its contents based on the destination host 
 context and the source host IP routing table, followed by the IPlir header and tuples (Type, Length, Value). 
 This is followed by the source IP packet.<a href="#section-4.4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.4.3-3">
 Versions of the source and new IP headers can be different. It means that IPv6 packets can be 
 transmitted via the IPv4 protocol and vice versa.<a href="#section-4.4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.4.3-4">
 Figure 7 shows an example of IP packet protection using the IPlir in the tunnel mode.<a href="#section-4.4.3-4" class="pilcrow">¶</a></p>
<span id="name-figure-7-ip-packet-protecti"></span><figure id="figure-7">
            <div class="alignLeft art-text artwork" id="section-4.4.3-5.1">
<pre>
+-------------------------+      +--------------------------+
|    Source IP packet     |      |       IPlir packet       |
|  +-------------------+  |      |  +--------------------+  |
|  |     IP header     |-------+ |  |     IP header      |  |
|  +-------------------+  |    | |  +--------------------+  |
|  |  IP packet data   |----+  | |  |    IPlir header    |  |
|  +-------------------+  | |  | |  +--------------------+  |
+-------------------------+ |  | |  |     IPlir body     |  |
                            |  | |  | +----------------+ |  |
                            |  +-----&gt;|   IP header    | |  |
                            |    |  | +----------------+ |  |
                            +--------&gt;| IP packet data | |  |
                                 |  | +----------------+ |  |
                                 |  +--------------------+  |
                                 |  |    IPlir trailer   |  |
                                 |  +--------------------+  |
                                 +--------------------------+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-figure-7-ip-packet-protecti" class="selfRef">Figure 7 - IP Packet Protection Using IPlir in the Tunnel Mode</a>
            </figcaption></figure>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">
 Possible values of function arguments in the algorithms above are limited by whether 
 they can be used as conversion input parameters.<a href="#section-5-1" class="pilcrow">¶</a></p>
<div id="Encryption">
<section id="section-5.1">
        <h3 id="name-encryption-and-mac">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-encryption-and-mac" class="section-name selfRef">Encryption and MAC</a>
        </h3>
<p id="section-5.1-1">
 To ensure packet confidentiality, the IPlir protocol provides for a possibility to 
 encrypt it using a symmetric cryptographic technique. Packet encryption in IPlir is 
 recommended, but not required. Encryption can be disabled by selecting a separate 
 cryptographic suite clearly indicating that there is no encryption. In case of encryption, 
 it is applied between the sender and recipient hosts regardless of the transfer network 
 topology and existence of intermediate hosts.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
 To ensure packet integrity and authenticity of the data source, the IPlir protocol allows for MAC. 
 Packet MAC can be end-to-end and transit. End-to-end MAC is applied between the sender and 
 recipient hosts, and is mandatory. Transit MAC is applied between two neighbor hosts 
 in a packet transfer chain, and is optional.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">
 To ensure both confidentiality, and integrity and authenticity of the data source of the packet 
 at the same time, either separate encryption and MAC algorithms may be used, or AEAD algorithms 
 to encrypt and calculate MAC simultaneously.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Key">
<section id="section-5.2">
        <h3 id="name-cryptographic-keys">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-cryptographic-keys" class="section-name selfRef">Cryptographic keys</a>
        </h3>
<p id="section-5.2-1">
 It is implied that there is a key system that provides the interacting hosts with necessary 
 exchange keys and controls their synchronization. Keys can be managed manually or automatically.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
 The exchange keys required to process a specific packet with all their mandatory attributes 
 (meta data) are available when packet processing starts.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">
 Correct functioning of the IPlir protocol requires a host numbering system where each host 
 is assigned a unique identifier. Each exchange key related to the specific pair of hosts is 
 indexed with the corresponding pair of their identifiers. Key systems where several exchange 
 keys (not more than 16) exist simultaneously for the two hosts can be used. To make it possible, 
 each exchange key in the IPlir protocol is additionally indexed with an integer value between 
 0 and 15 (inclusive)  located in the KN or TKN field of the IPlir message and allowing to 
 unambiguously determine the exchange key for the two hosts.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<p id="section-5.2-4">
 The peculiarity of IPlir is that unique packet encryption, end-to-end MAC and transit MAC keys 
 used in the corresponding cryptographic algorithms are derived for each IP packet based on the exchange keys. 
 The packet encryption, end-to-end MAC, and transit MAC keys derived for the same IP packet should be different, 
 except when AEAD algorithms are used, where one packet encryption and end-to-end MAC key is used 
 for encryption and end-to-end MAC of the packet.<a href="#section-5.2-4" class="pilcrow">¶</a></p>
<p id="section-5.2-5">
 The exchange key used to derive packet encryption and end-to-end MAC keys (or packet encryption and 
 end-to-end MAC key) is determined by the KN field value of the IPlir message and identifiers of the 
 sender and recipient hosts. The exchange key used to derive the packet transit MAC key is determined 
 by the TKN field value of the IPlir message and identifiers of the interacting (transit) hosts.<a href="#section-5.2-5" class="pilcrow">¶</a></p>
<p id="section-5.2-6">
 Exchange key types and methods to derive packet protection keys from them are determined by the cryptographic suite.<a href="#section-5.2-6" class="pilcrow">¶</a></p>
<p id="section-5.2-7">
 For any unique key used in the IPlir protocol at any time it should be impossible to calculate it 
 from the other keys, except for calculation of derived keys for packet protection from 
 a specific exchange key.<a href="#section-5.2-7" class="pilcrow">¶</a></p>
<p id="section-5.2-8">
 The maximum quantity of material that can be processed using the same key should be determined considering 
 theoretical limits arising from the use of particular cryptographic algorithms and practical limitations 
 arising during IPlir implementation.<a href="#section-5.2-8" class="pilcrow">¶</a></p>
<p id="section-5.2-9">
 The maximum number of keys (packet encryption, end-to-end MAC, transit MAC keys or packet encryption and 
 end-to-end MAC keys) derived from one exchange key should be determined considering theoretical limits 
 arising from the use of particular cryptographic algorithms and practical limitations arising during 
 IPlir implementation.<a href="#section-5.2-9" class="pilcrow">¶</a></p>
<p id="section-5.2-10">
 When the allowed limit for a specific key is reached, the interacting parties should stop using it. 
 For protection of further interactions, the parties should use a key for which the allowed limit has 
 not been achieved, e.g., a new key.<a href="#section-5.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Suites">
<section id="section-5.3">
        <h3 id="name-cryptographic-suites">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-cryptographic-suites" class="section-name selfRef">Cryptographic suites</a>
        </h3>
<p id="section-5.3-1">
 The cryptographic algorithms and parameters used in the IPlir protocol make up a cryptographic suite 
 designated by its CS number in the CS field of each IPlir message. There can be up to 256 different 
 cryptographic suites in total.<a href="#section-5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3-2">
 Permissible CS field values are provided in Table 3:<a href="#section-5.3-2" class="pilcrow">¶</a></p>
<span id="name-table-3-permissible-cs-fiel"></span><table class="left" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-table-3-permissible-cs-fiel" class="selfRef">Table 3 - Permissible CS Field Values</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">CS value</th>
              <th class="text-center" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0</td>
              <td class="text-center" rowspan="1" colspan="1">not in use</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">1</td>
              <td class="text-center" rowspan="1" colspan="1">MAGMA-MGM cryptographic suite </td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">2</td>
              <td class="text-center" rowspan="1" colspan="1">KUZN-CTR-CMAC cryptographic suite </td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">3-128</td>
              <td class="text-center" rowspan="1" colspan="1">not in use</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">129</td>
              <td class="text-center" rowspan="1" colspan="1">AES-128-GCM cryptographic suite</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">130-131</td>
              <td class="text-center" rowspan="1" colspan="1">can be used by the vendor for its own needs</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">132</td>
              <td class="text-center" rowspan="1" colspan="1">AES-256-CTR-CMAC cryptographic suite</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">133</td>
              <td class="text-center" rowspan="1" colspan="1">can be used by the vendor for its own needs</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">134</td>
              <td class="text-center" rowspan="1" colspan="1">AES-256-CFB-CMAC cryptographic suite</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">135-254</td>
              <td class="text-center" rowspan="1" colspan="1">can be used by the vendor for its own needs</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">255</td>
              <td class="text-center" rowspan="1" colspan="1">Not in use</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.3-4">
 The list of main mechanisms and parameters defined and/or described in the cryptographic suite 
 is shown in Table 4:<a href="#section-5.3-4" class="pilcrow">¶</a></p>
<span id="name-table-4-main-mechanisms-and"></span><table class="left" id="table-5">
          <caption>
<a href="#table-5" class="selfRef">Table 5</a>:
<a href="#name-table-4-main-mechanisms-and" class="selfRef">Table 4 - Main Mechanisms And Parameters In The Cryptographic Suite</a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Parameter</th>
              <th class="text-center" rowspan="1" colspan="1">Description</th>
              <th class="text-center" rowspan="1" colspan="1">Purpose</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">EncAlg</td>
              <td class="text-center" rowspan="1" colspan="1">encryption algorithm</td>
              <td class="text-center" rowspan="1" colspan="1">the algorithm is used to encrypt the packet</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">MACAlg</td>
              <td class="text-center" rowspan="1" colspan="1">end-to-end MAC algorithm</td>
              <td class="text-center" rowspan="1" colspan="1">the algorithm is used to calculate packet end-to-end MAC</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">TMACAlg</td>
              <td class="text-center" rowspan="1" colspan="1">transit MAC algorithm</td>
              <td class="text-center" rowspan="1" colspan="1">the algorithm is used to calculate packet transit MAC</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">MACLen</td>
              <td class="text-center" rowspan="1" colspan="1">end-to-end MAC length</td>
              <td class="text-center" rowspan="1" colspan="1"></td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">TMACLen</td>
              <td class="text-center" rowspan="1" colspan="1">transit MAC length</td>
              <td class="text-center" rowspan="1" colspan="1"></td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">IVLen</td>
              <td class="text-center" rowspan="1" colspan="1">end-to-end initializing value length</td>
              <td class="text-center" rowspan="1" colspan="1">the initializing value can be used for packet encryption, end-to-end MAC, 
 and derivation of packet encryption keys and packet end-to-end MAC keys 
 (or packet encryption and end-to-end MAC keys)</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">TIVLen</td>
              <td class="text-center" rowspan="1" colspan="1">transit initializing value length</td>
              <td class="text-center" rowspan="1" colspan="1">the initializing value can be used for packet transit MAC and derivation of packet transit MAC keys</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">KDAlg</td>
              <td class="text-center" rowspan="1" colspan="1">algorithms of deriving packet protection keys from exchange keys</td>
              <td class="text-center" rowspan="1" colspan="1">the algorithms are used to derive packet encryption keys and packet end-to-end MAC keys 
 (or packet encryption and end-to-end MAC keys), and to derive packet transit MAC keys</td>
            </tr>
          </tbody>
        </table>
<p id="section-5.3-6">
 All necessary parameters should be included in the cryptographic suite description. 
 Interpretation of values of specific cryptographic suite parameters is determined by the 
 cryptographic suite. If any parameter in the cryptographic suite is inapplicable or must be ignored, 
 it should be specified clearly.<a href="#section-5.3-6" class="pilcrow">¶</a></p>
<div id="MGM">
<section id="section-5.3.1">
          <h4 id="name-magma-mgm-cryptographic-sui">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-magma-mgm-cryptographic-sui" class="section-name selfRef">MAGMA-MGM cryptographic suite: CS = 1</a>
          </h4>
<p id="section-5.3.1-1">
 MAGMA-MGM Cryptographic Suite Description:<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<table class="left" id="table-6">
            <caption><a href="#table-6" class="selfRef">Table 6</a></caption>
<thead>
              <tr>
                <th class="text-center" rowspan="1" colspan="1">Parameter</th>
                <th class="text-center" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">EncAlg</td>
                <td class="text-center" rowspan="1" colspan="1">GOST R 34.12-2015 (Magma) [RFC8891] in the MGM mode [RFC9058]   </td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">GOST R 34.12-2015 (Magma) [RFC8891] in the MGM mode [RFC9058]   </td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">GOST R 34.12-2015 (Magma) [RFC8891] in the MGM mode [RFC9058]   </td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACLen</td>
                <td class="text-center" rowspan="1" colspan="1">32 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACLen</td>
                <td class="text-center" rowspan="1" colspan="1">32 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">IVLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TIVLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">KDAlg</td>
                <td class="text-center" rowspan="1" colspan="1">see the description below </td>
              </tr>
            </tbody>
          </table>
<div id="KeyMGM">
<section id="section-5.3.1.1">
            <h5 id="name-exchange-keys">
<a href="#section-5.3.1.1" class="section-number selfRef">5.3.1.1. </a><a href="#name-exchange-keys" class="section-name selfRef">Exchange keys</a>
            </h5>
<p id="section-5.3.1.1-1">
 For each pair of interacting hosts, there is a single exchange key with a length of 
 256 bits used for deriving of packet encryption and end-to-end MAC keys, as well as 
 packet transit MAC keys.<a href="#section-5.3.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1.1-2">
 There may be several exchange keys for a pair of interacting hosts. The KN field value of the IPlir message 
 (for derivation of packet encryption and end-to-end MAC keys) or the TKN field value of the IPlir message 
 (for derivation of packet transit MAC keys) is used to determine a specific single exchange key.<a href="#section-5.3.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IVMGM">
<section id="section-5.3.1.2">
            <h5 id="name-requirements-for-initializi">
<a href="#section-5.3.1.2" class="section-number selfRef">5.3.1.2. </a><a href="#name-requirements-for-initializi" class="section-name selfRef">Requirements for initializing values</a>
            </h5>
<p id="section-5.3.1.2-1">
 The end-to-end initializing value InitValue in the InitValue field of the IPlir message should have a 
 length of 64 bits and be unique for each IPlir packet the encryption and end-to-end MAC of which are 
 implemented by the same sender host using the same single exchange key.<a href="#section-5.3.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1.2-2">
 The transit initializing value TransitInitValue in the TransitInitValue field of the IPlir message should 
 have a length of 64 bits and be unique for each IPlir packet the transit MAC of which is implemented by 
 the same (transit) host using the same single exchange key.<a href="#section-5.3.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="KDFMGM">
<section id="section-5.3.1.3">
            <h5 id="name-key-derivation-algorithms">
<a href="#section-5.3.1.3" class="section-number selfRef">5.3.1.3. </a><a href="#name-key-derivation-algorithms" class="section-name selfRef">Key derivation algorithms</a>
            </h5>
<p id="section-5.3.1.3-1">
 The packet encryption and end-to-end MAC key K_AEAD of-256 bit length is calculated as follows:<a href="#section-5.3.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.1.3-2">
 K_AEAD = K_1 || K_2 || K_3 || K_4,<a href="#section-5.3.1.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3.1.3-3">
 where each value of K_i \in V_64, i = 1,2,3,4 is calculated as per GOST R 34.12-2015 (Magma) [RFC8891] 
 in the CMAC mode, as per GOST R 34.13-2015 [GOST3413-2015], wherein<a href="#section-5.3.1.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1.3-4.1">the single exchange key corresponding to the specified sender and recipient hosts, and the KN field 
 value of the IPlir message is used as the key,<a href="#section-5.3.1.3-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.1.3-4.2">
                <p id="section-5.3.1.3-4.2.1">a binary string as shown below is used as the data: IntToVec_8(i)||Label||aL||IV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.1.3-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1.3-4.2.2.1">Label = StrToVec_48('AEAD'),<a href="#section-5.3.1.3-4.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-4.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.1.3-4.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-4.2.2.3">IV_KDF = InitValue, where InitValue is initialized by the InitValue field value of the IPlir message,<a href="#section-5.3.1.3-4.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-4.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.1.3-4.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-4.2.2.5">Node = SourceIdentifier, where SourceIdentifier is initialized by the SourceIdentifier field value of the IPlir message,<a href="#section-5.3.1.3-4.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-4.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the InitValue, 
 SequenceNumber and SourceIdentifier fields of the IPlir message,<a href="#section-5.3.1.3-4.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-4.2.2.7">oL = IntToVec_16(OutputBitLength), where OutputBitLength = 256,<a href="#section-5.3.1.3-4.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.1.3-4.3">the MAC length s is 64 bits.<a href="#section-5.3.1.3-4.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.1.3-5">
 The packet transit MAC key K_TMAC of 256-bit length is calculated as follows:<a href="#section-5.3.1.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3.1.3-6">
 K_TMAC = K_1 || K_2 || K_3 || K_4,<a href="#section-5.3.1.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3.1.3-7">
 where each value of K_i \in V_64, i = 1,2,3,4 is calculated as per GOST 34.12-2018 GOST R 34.12-2015 (Magma) [RFC8891] 
 in the CMAC mode, as per GOST R 34.13-2015 [GOST3413-2015], wherein<a href="#section-5.3.1.3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1.3-8.1">the single exchange key corresponding to the specified (transit) hosts the IPlir packet passes through and the 
 TKN field value of the IPlir message is used as the key,<a href="#section-5.3.1.3-8.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.1.3-8.2">
                <p id="section-5.3.1.3-8.2.1">a binary string as shown below is used as the data: IntToVec_8(i)||Label||aL||TIV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.1.3-8.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1.3-8.2.2.1">Label = StrToVec_48('TMAC'),<a href="#section-5.3.1.3-8.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-8.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.1.3-8.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-8.2.2.3">TIV_KDF = TransitInitValue, where TransitInitValue is initialized by the TransitInitValue field value of the IPlir message,<a href="#section-5.3.1.3-8.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-8.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.1.3-8.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-8.2.2.5">Node = TransitIdentifier, where TransitIdentifier is initialized by the TransitIdentifier field value of the IPlir message,<a href="#section-5.3.1.3-8.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-8.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the TransitInitValue, 
 SequenceNumber and TransitIdentifier fields of the IPlir message,<a href="#section-5.3.1.3-8.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.3-8.2.2.7">oL = IntToVec_16(OutputBitLength), where OutputBitLength = 256,<a href="#section-5.3.1.3-8.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.1.3-8.3">the MAC length s is 64 bits.<a href="#section-5.3.1.3-8.3" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="EncMGM">
<section id="section-5.3.1.4">
            <h5 id="name-encryption-and-mac-algorith">
<a href="#section-5.3.1.4" class="section-number selfRef">5.3.1.4. </a><a href="#name-encryption-and-mac-algorith" class="section-name selfRef">Encryption and MAC algorithms</a>
            </h5>
<p id="section-5.3.1.4-1">
 Encryption of the IPlir body and calculation of the end-to-end MAC ICV in the IntegrityCheckValue field of the IPlir 
 message are implemented according to the GOST R 34.12-2015 (Magma) [RFC8891] in the MGM mode [RFC9058], wherein<a href="#section-5.3.1.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1.4-2.1">the packet encryption and end-to-end MAC key K_AEAD is used as the key,<a href="#section-5.3.1.4-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.1.4-2.2">data in the IPlir header fields in the order of their appearance in the IPlir message are used as associated authenticated data protected by MAC,<a href="#section-5.3.1.4-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.1.4-2.3">data in the IPlir body fields in the order of their appearance in the IPlir message are used as plaintext,<a href="#section-5.3.1.4-2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.1.4-2.4">
                <p id="section-5.3.1.4-2.4.1">the value of IV_AEAD \in V_63 is used as a unique vector:<a href="#section-5.3.1.4-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1.4-2.4.2.1">IV_AEAD = LSB_63(InitValue),<a href="#section-5.3.1.4-2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.4-2.4.2.2">where InitValue is initialized by the InitValue field value of the IPlir message,<a href="#section-5.3.1.4-2.4.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.1.4-2.5">the MAC length s is 32 bits.<a href="#section-5.3.1.4-2.5" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.1.4-3">
 The diagram of encryption and end-to-end MAC is shown in Figure 8.<a href="#section-5.3.1.4-3" class="pilcrow">¶</a></p>
<span id="name-figure-8-diagram-of-encrypt"></span><figure id="figure-8">
              <div class="alignLeft art-text artwork" id="section-5.3.1.4-4.1">
<pre>
                +-----------------------------------+
                |           IPlir header            |
                |                ...                |
                |   +---------------------------+   |
           +--------|     SourceIdentifier      |   |
           |    |   +---------------------------+   |
           |    |                ...                |--------+
           |    |   +---------------------------+   |        |
           +--------|      SequenceNumber       |   |        |
           |    |   +---------------------------+   |        |
           +--------|        InitValue          |---------+  |
           |    |   +---------------------------+   |     |  |
           |    +-----------------------------------+     |  |
           |    |            IPlir body             |--+  |  |
           |    +-----------------------------------+  |  |  |
           |    |           IPlir trailer           |  |  |  |
           |    |                ...                |  |  |  |
           |    +-----------------------------------+  |  |  |
           |                                           |  |  |
           v                                           v  v  v
+---------------------------------+            +-------------------+
| KDF based on GOST R 34.12-2015  |  +------+  | GOST R 34.12-2015 |
| (Magma) [RFC8891] in the CMAC   |-&gt;|K_AEAD|-&gt;| (Magma) [RFC8891] |
|       mode according to         |  +------+  | in the MGM mode   |
|GOST R 34.13-2015 [GOST3413-2015]|            |    [RFC9058]      |
+---------------------------------+            +-------------------+
                 ^                                      |    |
                 |                                      |    |
     +-----------------------+                          |    |
     | Exchange keys between |                          |    |
     | source and destination|                          |    |
     |        hosts          |                          |    |
     +-----------------------+                          |    |
                                                        |    |
                +-----------------------------------+   |    |
                |           IPlir header            |   |    |
                |                ...                |   |    |
                |   +---------------------------+   |   |    |
                |   |     SourceIdentifier      |   |   |    |
                |   +---------------------------+   |   |    |
                |                ...                |   |    |
                |   +---------------------------+   |   |    |
                |   |      SequenceNumber       |   |   |    |
                |   +---------------------------+   |   |    |
                |   |        InitValue          |   |   |    |
                |   +---------------------------+   |   |    |
                +-----------------------------------+   |    |
                |       Encrypted IPlir body        |&lt;--+    |
                +-----------------------------------+        |
                |           IPlir trailer           |        |
                |   +---------------------------+   |        |
                |   |     InterityCheckValue    |&lt;-----------+
                |   +---------------------------+   |
                |                ...                |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-figure-8-diagram-of-encrypt" class="selfRef">Figure 8 - Diagram of Encryption and End-to-End MAC Using the MAGMA-MGM Cryptographic Suite</a>
              </figcaption></figure>
<p id="section-5.3.1.4-5">
 Calculation of the transit MAC TICV in the TransitIntegrityCheckValue field of the 
 IPlir message is implemented according to the GOST R 34.12-2015 (Magma) [RFC8891] 
 in the MGM mode  [RFC9058], wherein<a href="#section-5.3.1.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1.4-6.1">the packet transit MAC key K_TMAC is used as the key,<a href="#section-5.3.1.4-6.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.1.4-6.2">data in the IPlir header fields, the encrypted IPlir body and IntegrityCheckValue, TransitIdentifier, 
 TransitInitValue fields data in the order of their appearance in the IPlir message are used as associated 
 authenticated data protected by MAC,<a href="#section-5.3.1.4-6.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.1.4-6.3">plaintext is an empty string,<a href="#section-5.3.1.4-6.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.1.4-6.4">
                <p id="section-5.3.1.4-6.4.1">the value of TIV_AEAD \in V_63 is used as a unique vector:<a href="#section-5.3.1.4-6.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1.4-6.4.2.1">TIV_AEAD = LSB_63(TransitInitValue),<a href="#section-5.3.1.4-6.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.1.4-6.4.2.2">where TransitInitValue is initialized by the TransitInitValue field value of the IPlir message,<a href="#section-5.3.1.4-6.4.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.1.4-6.5">the MAC length s is 32 bits.<a href="#section-5.3.1.4-6.5" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.1.4-7">
 The diagram of transit MAC is shown in Figure 9. The "null" value means an empty binary string.<a href="#section-5.3.1.4-7" class="pilcrow">¶</a></p>
<span id="name-figure-9-diagram-of-transit"></span><figure id="figure-9">
              <div class="alignLeft art-text artwork" id="section-5.3.1.4-8.1">
<pre>
                +-----------------------------------+--+
                |           IPlir header            |  |
                |                ...                |  |
                |   +---------------------------+   |  |
           +--------|      SequenceNumber       |   |  |
           |    |   +---------------------------+   |  |
           |    |                ...                |  |
           |    +-----------------------------------+  |
           |    |        Encrypted IPlir body       |  |-------+
           |    +-----------------------------------+  |       |
           |    |           IPlir trailer           |  |       |
           |    |                ...                |  |       |
           |    |   +---------------------------+   |  |       |
           +--------|     TransitIdentifier     |   |  |       |
           |    |   +---------------------------+   |  |       |
           +--------|                           |   |  |       |
           |    |   |     TransitInitValue      |   |  |       |
           |    | +-|                           |   |  |       |
           |    | | +---------------------------+---|--+       |
           |    | |              ...                |          |
           |    +-|---------------------------------+          |
           |      |                                            |
           |      +--------------------------------------+     |
           |                           +------+          |     |
           |                           | null |----+     |     |
           |                           +------+    |     |     |
           v                                       v     v     v
+---------------------------------+            +-------------------+
| KDF based on GOST R 34.12-2015  |  +------+  | GOST R 34.12-2015 |
| (Magma) [RFC8891] in the CMAC   |-&gt;|K_TMAC|-&gt;| (Magma) [RFC8891] |
|       mode according to         |  +------+  | in the MGM mode   |
|GOST R 34.13-2015 [GOST3413-2015]|            |    [RFC9058]      |
+---------------------------------+            +-------------------+
                 ^                                    |      |
                 |                                    v      |
     +-----------------------+                    +------+   |
     | Exchange keys between |                    | null |   |
     |     transit hosts     |                    +------+   |
     +-----------------------+                               |
                                                             |
                +-----------------------------------+        |
                |           IPlir header            |        |
                |                ...                |        |
                |   +---------------------------+   |        |
                |   |      SequenceNumber       |   |        |
                |   +---------------------------+   |        |
                |                ...                |        |
                +-----------------------------------+        |
                |        Encrypted IPlir body       |        |
                +-----------------------------------+        |
                |           IPlir trailer           |        |
                |                ...                |        |
                |   +---------------------------+   |        |
                |   |     TransitIdentifier     |   |        |
                |   +---------------------------+   |        |
                |   |                           |   |        |
                |   |     TransitInitValue      |   |        |
                |   |                           |   |        |
                |   +---------------------------+   |        |
                |   | TransitInterityCheckValue |&lt;-----------+
                |   +---------------------------+   |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-figure-9-diagram-of-transit" class="selfRef">Figure 9 - Diagram of Transit MAC Using the MAGMA-MGM Cryptographic Suite</a>
              </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="KUZN">
<section id="section-5.3.2">
          <h4 id="name-kuzn-ctr-cmac-cryptographic">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-kuzn-ctr-cmac-cryptographic" class="section-name selfRef">KUZN-CTR-CMAC cryptographic suite: CS=2</a>
          </h4>
<p id="section-5.3.2-1">
 AES-256-CTR-CMAC Cryptographic Suite Description:<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
<table class="left" id="table-7">
            <caption><a href="#table-7" class="selfRef">Table 7</a></caption>
<thead>
              <tr>
                <th class="text-center" rowspan="1" colspan="1">Parameter</th>
                <th class="text-center" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">EncAlg</td>
                <td class="text-center" rowspan="1" colspan="1">GOST R 34.12-2015 (Kuznyechik) [RFC7801] in the CTR mode [GOST3413-2015]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">GOST R 34.12-2015 (Kuznyechik) [RFC7801] in the CMAC mode [GOST3413-2015]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">GOST R 34.12-2015 (Kuznyechik) [RFC7801] in the CMAC mode [GOST3413-2015]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">IVLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TIVLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">KDAlg</td>
                <td class="text-center" rowspan="1" colspan="1">see the description below </td>
              </tr>
            </tbody>
          </table>
<div id="KeyKUZN">
<section id="section-5.3.2.1">
            <h5 id="name-exchange-keys-2">
<a href="#section-5.3.2.1" class="section-number selfRef">5.3.2.1. </a><a href="#name-exchange-keys-2" class="section-name selfRef">Exchange keys</a>
            </h5>
<p id="section-5.3.2.1-1">
 For each pair of interacting hosts, there is a single exchange key with a length of 256 bits 
 designed for derivation of packet encryption keys, end-to-end MAC keys, and transit MAC keys.<a href="#section-5.3.2.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2.1-2">
 There may be several exchange keys for a pair of interacting hosts. The KN field value of the 
 IPlir message (for derivation of packet encryption keys and packet end-to-end MAC keys) or the 
 TKN field value of the IPlir message (for derivation of packet transit MAC keys) is used to 
 determine a specific single exchange key.<a href="#section-5.3.2.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IVKUZN">
<section id="section-5.3.2.2">
            <h5 id="name-requirements-for-initializin">
<a href="#section-5.3.2.2" class="section-number selfRef">5.3.2.2. </a><a href="#name-requirements-for-initializin" class="section-name selfRef">Requirements for initializing values</a>
            </h5>
<p id="section-5.3.2.2-1">
 The end-to-end initializing value InitValue in the InitValue field of the IPlir message should 
 have a length of 64 bits and be unique for each IPlir packet the encryption and end-to-end MAC 
 of which are implemented by the same sender host using the same single exchange key.<a href="#section-5.3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2.2-2">
 The transit initializing value TransitInitValue in the TransitInitValue field of the IPlir 
 message should have a length of 64 bits and be unique for each IPlir packet the transit MAC 
 of which is implemented by the same (transit) host using the same single exchange key.<a href="#section-5.3.2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="KDFKUZN">
<section id="section-5.3.2.3">
            <h5 id="name-key-derivation-algorithms-2">
<a href="#section-5.3.2.3" class="section-number selfRef">5.3.2.3. </a><a href="#name-key-derivation-algorithms-2" class="section-name selfRef">Key derivation algorithms</a>
            </h5>
<p id="section-5.3.2.3-1">
 The packet encryption key K_ENC of 256-bit length and the packet end-to-end MAC key K_MAC of 
 256-bit length are calculated as follows:<a href="#section-5.3.2.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.2.3-2">
 K_ENC = K_1 || K_2,<a href="#section-5.3.2.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3.2.3-3">
 K_MAC = K_3 || K_4,<a href="#section-5.3.2.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3.2.3-4">
 where each value of K_i \in V_128, i = 1,2,3,4 is calculated as per GOST R 34.12-2015 
 (Kuznyechik) [RFC7801] in the CMAC mode [GOST3413-2015], wherein<a href="#section-5.3.2.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2.3-5.1">the single exchange key corresponding to the specified sender and recipient hosts, 
 and the KN field value of the IPlir message is used as the key,<a href="#section-5.3.2.3-5.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.2.3-5.2">
                <p id="section-5.3.2.3-5.2.1">a binary string as shown below is used as the data: IntToVec_8(i)||Label||aL||IV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.2.3-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2.3-5.2.2.1">Label = StrToVec_48('ENCMAC'),<a href="#section-5.3.2.3-5.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-5.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.2.3-5.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-5.2.2.3">IV_KDF = InitValue, where InitValue is initialized by the InitValue field value of the IPlir message,<a href="#section-5.3.2.3-5.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-5.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.2.3-5.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-5.2.2.5">Node = SourceIdentifier, where SourceIdentifier is initialized by the SourceIdentifier field value of the IPlir message,<a href="#section-5.3.2.3-5.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-5.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the InitValue, 
 SequenceNumber and SourceIdentifier fields of the IPlir message,<a href="#section-5.3.2.3-5.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-5.2.2.7">oL = IntToVec_16(OutputBitLength), where OutputBitLength = 512,<a href="#section-5.3.2.3-5.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.2.3-5.3">the MAC length s is 128 bits.<a href="#section-5.3.2.3-5.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.2.3-6">
 The packet transit MAC key K_TMAC of 256-bit length is calculated as follows:<a href="#section-5.3.2.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3.2.3-7">
 K_TMAC = K_1 || K_2,<a href="#section-5.3.2.3-7" class="pilcrow">¶</a></p>
<p id="section-5.3.2.3-8">
 where each value of K_i \in V_128, i = 1,2 is calculated as per GOST R 34.12-2015 
 (Kuznyechik) [RFC7801] in the CMAC mode [GOST3413-2015], wherein<a href="#section-5.3.2.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2.3-9.1">the single exchange key corresponding to the specified (transit) hosts the IPlir 
 packet passes through and the TKN field value of the IPlir message is used as the key,<a href="#section-5.3.2.3-9.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.2.3-9.2">
                <p id="section-5.3.2.3-9.2.1">a binary string as shown below is used as the data: IntToVec_8(i)||Label||aL||TIV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.2.3-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2.3-9.2.2.1">Label = StrToVec_48('TMAC'),<a href="#section-5.3.2.3-9.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-9.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.2.3-9.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-9.2.2.3">TIV_KDF = TransitInitValue, where TransitInitValue is initialized by the TransitInitValue field value of the IPlir message,<a href="#section-5.3.2.3-9.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-9.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.2.3-9.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-9.2.2.5">Node = TransitIdentifier, where TransitIdentifier is initialized by the TransitIdentifier field value of the IPlir message,<a href="#section-5.3.2.3-9.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-9.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the TransitInitValue, 
 SequenceNumber and TransitIdentifier fields of the IPlir message,<a href="#section-5.3.2.3-9.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.3-9.2.2.7">oL = IntToVec_16(OutputBitLength), where OutputBitLength = 256,<a href="#section-5.3.2.3-9.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.2.3-9.3">the MAC length s is 128 bits.<a href="#section-5.3.2.3-9.3" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="EncKUZN">
<section id="section-5.3.2.4">
            <h5 id="name-encryption-and-mac-algorithm">
<a href="#section-5.3.2.4" class="section-number selfRef">5.3.2.4. </a><a href="#name-encryption-and-mac-algorithm" class="section-name selfRef">Encryption and MAC algorithms</a>
            </h5>
<p id="section-5.3.2.4-1">
 The IPlir body is encrypted according to the GOST R 34.12-2015 
 (Kuznyechik) [RFC7801] in the CTR mode [GOST3413-2015], wherein<a href="#section-5.3.2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2.4-2.1">the packet encryption key K_ENC is used as the key,<a href="#section-5.3.2.4-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.2.4-2.2">data in the IPlir body fields in the order of their appearance in the IPlir message are used as plaintext,<a href="#section-5.3.2.4-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.2.4-2.3">
                <p id="section-5.3.2.4-2.3.1">the value of IV_ENC \in V_64 is used as the initializing value:<a href="#section-5.3.2.4-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2.4-2.3.2.1">IV_ENC = InitValue,<a href="#section-5.3.2.4-2.3.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.2.4-2.3.2.2">where InitValue is initialized by the InitValue field value of the IPlir message,<a href="#section-5.3.2.4-2.3.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.2.4-2.4">the s key stream block length is 128 bits.<a href="#section-5.3.2.4-2.4" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.2.4-3">
 Calculation of the end-to-end MAC ICV in the IntegrityCheckValue field of the IPlir message is implemented 
 according to the GOST R 34.12-2015 (Kuznyechik) [RFC7801] in the CMAC mode [GOST3413-2015], wherein<a href="#section-5.3.2.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2.4-4.1">the packet end-to-end MAC key K_MAC is used as the key,<a href="#section-5.3.2.4-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.2.4-4.2">data in the IPlir body fields in the order of their appearance in the IPlir message are used as plaintext,<a href="#section-5.3.2.4-4.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.2.4-4.3">the MAC length s is 64 bits.<a href="#section-5.3.2.4-4.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.2.4-5">
 The diagram of encryption and end-to-end MAC is shown in Figure 10.<a href="#section-5.3.2.4-5" class="pilcrow">¶</a></p>
<span id="name-figure-10-diagram-of-encryp"></span><figure id="figure-10">
              <div class="alignLeft art-text artwork" id="section-5.3.2.4-6.1">
<pre>
                +-----------------------------------+
                |           IPlir header            |
                |                ...                |
                |   +---------------------------+   |
           +--------|     SourceIdentifier      |   |
           |    |   +---------------------------+   |
           |    |                ...                |
           |    |   +---------------------------+   |
           +--------|      SequenceNumber       |   |
           |    |   +---------------------------+   |
           +--------|        InitValue          |----------+
           |    |   +---------------------------+   |      |
           |    +-----------------------------------+      |
           |    |            IPlir body             |--+   |
           |    +-----------------------------------+  |   |
           |    |           IPlir trailer           |  |   |
           |    |                ...                |  |   |
           |    +-----------------------------------+  |   |
           |                                           |   |
           v                                           v   v
+---------------------------------+  +------+  +-------------------+
| KDF based on GOST R 34.12-2015  |-&gt;|K_ENC |-&gt;| GOST R 34.12-2015 |
| (Kuznyechik) [RFC7801] in the   |  +------+  |   (Kuznyechik)    |
|     CMAC mode according to      |            | [RFC7801] in the  |
|GOST R 34.13-2015 [GOST3413-2015]|  +------+  |     CTR mode      |
|                                 |-&gt;|K_MAC |  |  [GOST3413-2015]  |
+---------------------------------+  +------+  +-------------------+
            ^                            |               |
            |                            v               |
+-----------------------+       +-------------------+    |
| Exchange keys between |       | GOST R 34.12-2015 |    |
| source and destination|   +---|   (Kuznyechik)    |    |
|        hosts          |   |   | [RFC7801] in the  |    |
+-----------------------+   |   |     CMAC mode     |    |
                            |   |  [GOST3413-2015]  |    |
                            |   +-------------------+    |
    +-----------------------+             ^              |
    |                                     |              |
    |   +---------------------------------+              |
    |   |                                                |
    |   |   +---+-----------------------------------+    |
    |   |   |   |           IPlir header            |    |
    |   |   |   |                ...                |    |
    |   |   |   |   +---------------------------+   |    |
    |   |   |   |   |     SourceIdentifier      |   |    |
    |   |   |   |   +---------------------------+   |    |
    |   |   |   |                ...                |    |
    |   +---|   |   +---------------------------+   |    |
    |       |   |   |      SequenceNumber       |   |    |
    |       |   |   +---------------------------+   |    |
    |       |   |   |        InitValue          |   |    |
    |       |   |   +---------------------------+   |    |
    |       |   +-----------------------------------+    |
    |       |   |       Encrypted IPlir body        |&lt;---+
    |       +---+-----------------------------------+
    |           |           IPlir trailer           |
    |           |   +---------------------------+   |
    +--------------&gt;|     InterityCheckValue    |   |
                |   +---------------------------+   |
                |                ...                |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-figure-10-diagram-of-encryp" class="selfRef">Figure 10 - Diagram of Encryption and End-to-End MAC Using the KUZN-CTR-CMAC Cryptographic Suite</a>
              </figcaption></figure>
<p id="section-5.3.2.4-7">
 Calculation of the transit MAC TICV in the TransitIntegrityCheckValue field of the 
 IPlir message is implemented according to the GOST R 34.12-2015 (Kuznyechik) [RFC7801] 
 in the CMAC mode [GOST3413-2015], wherein<a href="#section-5.3.2.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.2.4-8.1">the packet transit MAC key K_TMAC is used as the key,<a href="#section-5.3.2.4-8.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.2.4-8.2">data in the IPlir header fields, the encrypted IPlir body and IntegrityCheckValue, TransitIdentifier, 
 TransitInitValue fields data in the order of their appearance in the IPlir message are used as associated 
 authenticated data protected by MAC,<a href="#section-5.3.2.4-8.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.2.4-8.3">the MAC length s is 64 bits.<a href="#section-5.3.2.4-8.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.2.4-9">
 The diagram of transit MAC is shown in Figure 11.<a href="#section-5.3.2.4-9" class="pilcrow">¶</a></p>
<span id="name-figure-11-diagram-of-transi"></span><figure id="figure-11">
              <div class="alignLeft art-text artwork" id="section-5.3.2.4-10.1">
<pre>
                +-----------------------------------+--+
                |           IPlir header            |  |
                |                ...                |  |
                |   +---------------------------+   |  |
           +--------|      SequenceNumber       |   |  |
           |    |   +---------------------------+   |  |
           |    |                ...                |  |
           |    +-----------------------------------+  |
           |    |        Encrypted IPlir body       |  |---+
           |    +-----------------------------------+  |   |
           |    |           IPlir trailer           |  |   |
           |    |                ...                |  |   |
           |    |   +---------------------------+   |  |   |
           +--------|     TransitIdentifier     |   |  |   |
           |    |   +---------------------------+   |  |   |
           +--------|                           |   |  |   |
           |    |   |     TransitInitValue      |   |  |   |
           |    |   |                           |   |  |   |
           |    |   +---------------------------+---|--+   |
           |    |                ...                |      |
           |    +-----------------------------------+      |
           |                                               |
           v                                               v
+---------------------------------+            +-------------------+
| KDF based on GOST R 34.12-2015  |  +------+  | GOST R 34.12-2015 |
| (Kuznyechik) [RFC7801] in the   |-&gt;|K_TMAC|-&gt;|   (Kuznyechik)    |
|     CMAC mode according to      |  +------+  | [RFC7801] in the  |
|GOST R 34.13-2015 [GOST3413-2015]|            |     CMAC mode     |
+---------------------------------+            |  [GOST3413-2015]  +
                 ^                             +-------------------+
                 |                                       |
                 |                                       |
     +-----------------------+                           |
     | Exchange keys between |                           |
     |     transit hosts     |                           |
     +-----------------------+                           |
                                                         |
                +-----------------------------------+    |
                |           IPlir header            |    |
                |                ...                |    |
                |   +---------------------------+   |    |
                |   |      SequenceNumber       |   |    |
                |   +---------------------------+   |    |
                |                ...                |    |
                +-----------------------------------+    |
                |        Encrypted IPlir body       |    |
                +-----------------------------------+    |
                |           IPlir trailer           |    |
                |                ...                |    |
                |   +---------------------------+   |    |
                |   |     TransitIdentifier     |   |    |
                |   +---------------------------+   |    |
                |   |                           |   |    |
                |   |     TransitInitValue      |   |    |
                |   |                           |   |    |
                |   +---------------------------+   |    |
                |   | TransitInterityCheckValue |&lt;-------+
                |   +---------------------------+   |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-figure-11-diagram-of-transi" class="selfRef">Figure 11 - Diagram of Transit MAC Using the AES-256-CFB-CMAC Cryptographic Suite</a>
              </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="GCM">
<section id="section-5.3.3">
          <h4 id="name-aes-128-gcm-cryptographic-s">
<a href="#section-5.3.3" class="section-number selfRef">5.3.3. </a><a href="#name-aes-128-gcm-cryptographic-s" class="section-name selfRef">AES-128-GCM cryptographic suite: CS = 129</a>
          </h4>
<p id="section-5.3.3-1">
 AES-128-GCM Cryptographic Suite Description:<a href="#section-5.3.3-1" class="pilcrow">¶</a></p>
<table class="left" id="table-8">
            <caption><a href="#table-8" class="selfRef">Table 8</a></caption>
<thead>
              <tr>
                <th class="text-center" rowspan="1" colspan="1">Parameter</th>
                <th class="text-center" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">EncAlg</td>
                <td class="text-center" rowspan="1" colspan="1">AES-128 [NIST.FIPS.197] in the GCM mode [NIST.SP.800-38d]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">AES-128 [NIST.FIPS.197] in the GCM mode [NIST.SP.800-38d]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">AES-128 [NIST.FIPS.197] in the GCM mode [NIST.SP.800-38d]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">IVLen</td>
                <td class="text-center" rowspan="1" colspan="1">96 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TIVLen</td>
                <td class="text-center" rowspan="1" colspan="1">96 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">KDAlg</td>
                <td class="text-center" rowspan="1" colspan="1">see the description below </td>
              </tr>
            </tbody>
          </table>
<div id="KeyGCM">
<section id="section-5.3.3.1">
            <h5 id="name-exchange-keys-3">
<a href="#section-5.3.3.1" class="section-number selfRef">5.3.3.1. </a><a href="#name-exchange-keys-3" class="section-name selfRef">Exchange keys</a>
            </h5>
<p id="section-5.3.3.1-1">
 For each pair of interacting hosts, there is a single exchange key with a length of 
 128 bits used for deriving of packet encryption and end-to-end MAC keys, as well as 
 packet transit MAC keys.<a href="#section-5.3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3.1-2">
 There may be several exchange keys for a pair of interacting hosts. The KN field value of the IPlir message 
 (for derivation of packet encryption and end-to-end MAC keys) or the TKN field value of the IPlir message 
 (for derivation of packet transit MAC keys) is used to determine a specific single exchange key.<a href="#section-5.3.3.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IVGCM">
<section id="section-5.3.3.2">
            <h5 id="name-requirements-for-initializing">
<a href="#section-5.3.3.2" class="section-number selfRef">5.3.3.2. </a><a href="#name-requirements-for-initializing" class="section-name selfRef">Requirements for initializing values</a>
            </h5>
<p id="section-5.3.3.2-1">
 The end-to-end initializing value InitValue in the InitValue field of the IPlir message should have a 
 length of 96 bits and be unique for each IPlir packet the encryption and end-to-end MAC of which are 
 implemented by the same sender host using the same single exchange key.<a href="#section-5.3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3.2-2">
 The transit initializing value TransitInitValue in the TransitInitValue field of the IPlir message should 
 have a length of 96 bits and be unique for each IPlir packet the transit MAC of which is implemented by 
 the same (transit) host using the same single exchange key.<a href="#section-5.3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="KDFGCM">
<section id="section-5.3.3.3">
            <h5 id="name-key-derivation-algorithms-3">
<a href="#section-5.3.3.3" class="section-number selfRef">5.3.3.3. </a><a href="#name-key-derivation-algorithms-3" class="section-name selfRef">Key derivation algorithms</a>
            </h5>
<p id="section-5.3.3.3-1">
 The packet encryption and end-to-end MAC key K_AEAD of-256 bit length is calculated as follows:<a href="#section-5.3.3.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.3.3-2">
 K_AEAD = K_1,<a href="#section-5.3.3.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3.3.3-3">
 where value of K_1 \in V_128 is calculated as per KDF in Counter Mode [NIST.SP.800-108] using AES-128 
 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b] as the PRF, wherein<a href="#section-5.3.3.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3.3-4.1">the single exchange key corresponding to the specified sender and recipient hosts, and the KN field 
 value of the IPlir message is used as the key for the PRF,<a href="#section-5.3.3.3-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.3.3-4.2">
                <p id="section-5.3.3.3-4.2.1">a binary string as shown below is used as the input data for the PRF: IntToVec_8(i)||Label||aL||IV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.3.3-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3.3-4.2.2.1">Label = StrToVec_48('AEAD'),<a href="#section-5.3.3.3-4.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-4.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.3.3-4.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-4.2.2.3">IV_KDF = InitValue, where InitValue is initialized by the InitValue field value of the IPlir message,<a href="#section-5.3.3.3-4.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-4.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.3.3-4.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-4.2.2.5">Node = SourceIdentifier, where SourceIdentifier is initialized by the SourceIdentifier field value of the IPlir message,<a href="#section-5.3.3.3-4.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-4.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the InitValue, 
 SequenceNumber and SourceIdentifier fields of the IPlir message,<a href="#section-5.3.3.3-4.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-4.2.2.7">oL = IntToVec_8(OutputBitLength), where OutputBitLength = 128,<a href="#section-5.3.3.3-4.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.3.3-4.3">the PRF output length is 128 bits.<a href="#section-5.3.3.3-4.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.3.3-5">
 The packet transit MAC key K_TMAC of 128-bit length is calculated as follows:<a href="#section-5.3.3.3-5" class="pilcrow">¶</a></p>
<p id="section-5.3.3.3-6">
 K_TMAC = K_1,<a href="#section-5.3.3.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3.3.3-7">
 where value of K_1 \in V_128 is calculated as per KDF in Counter Mode [NIST.SP.800-108] using AES-128 
 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b] as the PRF, wherein<a href="#section-5.3.3.3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3.3-8.1">the single exchange key corresponding to the specified (transit) hosts the IPlir packet passes through and the 
 TKN field value of the IPlir message is used as the key for the PRF,<a href="#section-5.3.3.3-8.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.3.3-8.2">
                <p id="section-5.3.3.3-8.2.1">a binary string as shown below is used as the input data for the PRF: IntToVec_8(i)||Label||aL||TIV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.3.3-8.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3.3-8.2.2.1">Label = StrToVec_48('TMAC'),<a href="#section-5.3.3.3-8.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-8.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.3.3-8.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-8.2.2.3">TIV_KDF = TransitInitValue, where TransitInitValue is initialized by the TransitInitValue field value of the IPlir message,<a href="#section-5.3.3.3-8.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-8.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.3.3-8.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-8.2.2.5">Node = TransitIdentifier, where TransitIdentifier is initialized by the TransitIdentifier field value of the IPlir message,<a href="#section-5.3.3.3-8.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-8.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the TransitInitValue, 
 SequenceNumber and TransitIdentifier fields of the IPlir message,<a href="#section-5.3.3.3-8.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.3-8.2.2.7">oL = IntToVec_8(OutputBitLength), where OutputBitLength = 128,<a href="#section-5.3.3.3-8.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.3.3-8.3">the PRF output length is 128 bits.<a href="#section-5.3.3.3-8.3" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="EncGCM">
<section id="section-5.3.3.4">
            <h5 id="name-encryption-and-mac-algorithms">
<a href="#section-5.3.3.4" class="section-number selfRef">5.3.3.4. </a><a href="#name-encryption-and-mac-algorithms" class="section-name selfRef">Encryption and MAC algorithms</a>
            </h5>
<p id="section-5.3.3.4-1">
 Encryption of the IPlir body and calculation of the end-to-end MAC ICV in the IntegrityCheckValue field of the IPlir 
 message are implemented according to the AES-128 [NIST.FIPS.197] in the GCM mode [NIST.SP.800-38d], wherein<a href="#section-5.3.3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3.4-2.1">the packet encryption and end-to-end MAC key K_AEAD is used as the key,<a href="#section-5.3.3.4-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.3.4-2.2">data in the IPlir header fields in the order of their appearance in the IPlir message are used as associated authenticated data protected by MAC,<a href="#section-5.3.3.4-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.3.4-2.3">data in the IPlir body fields in the order of their appearance in the IPlir message are used as plaintext,<a href="#section-5.3.3.4-2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.3.4-2.4">
                <p id="section-5.3.3.4-2.4.1">the value of IV_AEAD \in V_96 is used as a unique vector:<a href="#section-5.3.3.4-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3.4-2.4.2.1">IV_AEAD = InitValue,<a href="#section-5.3.3.4-2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.4-2.4.2.2">where InitValue is initialized by the InitValue field value of the IPlir message,<a href="#section-5.3.3.4-2.4.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.3.4-2.5">the MAC length s is 64 bits.<a href="#section-5.3.3.4-2.5" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.3.4-3">
 The diagram of encryption and end-to-end MAC is shown in Figure 12.<a href="#section-5.3.3.4-3" class="pilcrow">¶</a></p>
<span id="name-figure-12-diagram-of-encryp"></span><figure id="figure-12">
              <div class="alignLeft art-text artwork" id="section-5.3.3.4-4.1">
<pre>
                +-----------------------------------+
                |           IPlir header            |
                |                ...                |
                |   +---------------------------+   |
           +--------|     SourceIdentifier      |   |
           |    |   +---------------------------+   |
           |    |                ...                |--------+
           |    |   +---------------------------+   |        |
           +--------|      SequenceNumber       |   |        |
           |    |   +---------------------------+   |        |
           +--------|        InitValue          |---------+  |
           |    |   +---------------------------+   |     |  |
           |    +-----------------------------------+     |  |
           |    |            IPlir body             |--+  |  |
           |    +-----------------------------------+  |  |  |
           |    |           IPlir trailer           |  |  |  |
           |    |                ...                |  |  |  |
           |    +-----------------------------------+  |  |  |
           |                                           |  |  |
           v                                           v  v  v
+---------------------------------+            +-------------------+
|     KDF in Counter Mode         |  +------+  |      AES-128      |
|   [NIST.SP.800-108] based on    |-&gt;|K_AEAD|-&gt;|  [NIST.FIPS.197]  |
| AES-128 [NIST.FIPS.197] in the  |  +------+  |  in the GCM mode  |
|   CMAC mode [NIST.SP.800-38b]   |            | [NIST.SP.800-38d] |
+---------------------------------+            +-------------------+
                 ^                                      |    |
                 |                                      |    |
     +-----------------------+                          |    |
     | Exchange keys between |                          |    |
     | source and destination|                          |    |
     |        hosts          |                          |    |
     +-----------------------+                          |    |
                                                        |    |
                +-----------------------------------+   |    |
                |           IPlir header            |   |    |
                |                ...                |   |    |
                |   +---------------------------+   |   |    |
                |   |     SourceIdentifier      |   |   |    |
                |   +---------------------------+   |   |    |
                |                ...                |   |    |
                |   +---------------------------+   |   |    |
                |   |      SequenceNumber       |   |   |    |
                |   +---------------------------+   |   |    |
                |   |        InitValue          |   |   |    |
                |   +---------------------------+   |   |    |
                +-----------------------------------+   |    |
                |       Encrypted IPlir body        |&lt;--+    |
                +-----------------------------------+        |
                |           IPlir trailer           |        |
                |   +---------------------------+   |        |
                |   |     InterityCheckValue    |&lt;-----------+
                |   +---------------------------+   |
                |                ...                |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-figure-12-diagram-of-encryp" class="selfRef">Figure 12 - Diagram of Encryption and End-to-End MAC Using the AES-128-GCM Cryptographic Suite</a>
              </figcaption></figure>
<p id="section-5.3.3.4-5">
 Calculation of the transit MAC TICV in the TransitIntegrityCheckValue field of the 
 IPlir message is implemented according to the AES-128 [NIST.FIPS.197] in the GCM mode [NIST.SP.800-38d], wherein<a href="#section-5.3.3.4-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3.4-6.1">the packet transit MAC key K_TMAC is used as the key,<a href="#section-5.3.3.4-6.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.3.4-6.2">data in the IPlir header fields, the encrypted IPlir body and IntegrityCheckValue, TransitIdentifier, 
 TransitInitValue fields data in the order of their appearance in the IPlir message are used as associated 
 authenticated data protected by MAC,<a href="#section-5.3.3.4-6.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.3.4-6.3">plaintext is an empty string,<a href="#section-5.3.3.4-6.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.3.4-6.4">
                <p id="section-5.3.3.4-6.4.1">the value of TIV_AEAD \in V_96 is used as a unique vector:<a href="#section-5.3.3.4-6.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.3.4-6.4.2.1">TIV_AEAD = TransitInitValue,<a href="#section-5.3.3.4-6.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.3.4-6.4.2.2">where TransitInitValue is initialized by the TransitInitValue field value of the IPlir message,<a href="#section-5.3.3.4-6.4.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.3.4-6.5">the MAC length s is 64 bits.<a href="#section-5.3.3.4-6.5" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.3.4-7">
 The diagram of transit MAC is shown in Figure 13. The "null" value means an empty binary string.<a href="#section-5.3.3.4-7" class="pilcrow">¶</a></p>
<span id="name-figure-13-diagram-of-transi"></span><figure id="figure-13">
              <div class="alignLeft art-text artwork" id="section-5.3.3.4-8.1">
<pre>
                +-----------------------------------+--+
                |           IPlir header            |  |
                |                ...                |  |
                |   +---------------------------+   |  |
           +--------|      SequenceNumber       |   |  |
           |    |   +---------------------------+   |  |
           |    |                ...                |  |
           |    +-----------------------------------+  |
           |    |        Encrypted IPlir body       |  |-------+
           |    +-----------------------------------+  |       |
           |    |           IPlir trailer           |  |       |
           |    |                ...                |  |       |
           |    |   +---------------------------+   |  |       |
           +--------|     TransitIdentifier     |   |  |       |
           |    |   +---------------------------+   |  |       |
           +--------|                           |   |  |       |
           |    |   |     TransitInitValue      |   |  |       |
           |    | +-|                           |   |  |       |
           |    | | +---------------------------+---|--+       |
           |    | |              ...                |          |
           |    +-|---------------------------------+          |
           |      |                                            |
           |      +--------------------------------------+     |
           |                           +------+          |     |
           |                           | null |----+     |     |
           |                           +------+    |     |     |
           v                                       v     v     v
+---------------------------------+            +-------------------+
|     KDF in Counter Mode         |  +------+  |      AES-128      |
|   [NIST.SP.800-108] based on    |-&gt;|K_TMAC|-&gt;|  [NIST.FIPS.197]  |
| AES-128 [NIST.FIPS.197] in the  |  +------+  |  in the GCM mode  |
|   CMAC mode [NIST.SP.800-38b]   |            | [NIST.SP.800-38d] |
+---------------------------------+            +-------------------+
                 ^                                    |      |
                 |                                    v      |
     +-----------------------+                    +------+   |
     | Exchange keys between |                    | null |   |
     |     transit hosts     |                    +------+   |
     +-----------------------+                               |
                                                             |
                +-----------------------------------+        |
                |           IPlir header            |        |
                |                ...                |        |
                |   +---------------------------+   |        |
                |   |      SequenceNumber       |   |        |
                |   +---------------------------+   |        |
                |                ...                |        |
                +-----------------------------------+        |
                |        Encrypted IPlir body       |        |
                +-----------------------------------+        |
                |           IPlir trailer           |        |
                |                ...                |        |
                |   +---------------------------+   |        |
                |   |     TransitIdentifier     |   |        |
                |   +---------------------------+   |        |
                |   |                           |   |        |
                |   |     TransitInitValue      |   |        |
                |   |                           |   |        |
                |   +---------------------------+   |        |
                |   | TransitInterityCheckValue |&lt;-----------+
                |   +---------------------------+   |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-figure-13-diagram-of-transi" class="selfRef">Figure 13 - Diagram of Transit MAC Using the AES-128-GCM Cryptographic Suite</a>
              </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="AESCTRCMAC">
<section id="section-5.3.4">
          <h4 id="name-aes-256-ctr-cmac-cryptograp">
<a href="#section-5.3.4" class="section-number selfRef">5.3.4. </a><a href="#name-aes-256-ctr-cmac-cryptograp" class="section-name selfRef">AES-256-CTR-CMAC cryptographic suite: CS = 132</a>
          </h4>
<p id="section-5.3.4-1">
 AES-256-CTR-CMAC Cryptographic Suite Description:<a href="#section-5.3.4-1" class="pilcrow">¶</a></p>
<table class="left" id="table-9">
            <caption><a href="#table-9" class="selfRef">Table 9</a></caption>
<thead>
              <tr>
                <th class="text-center" rowspan="1" colspan="1">Parameter</th>
                <th class="text-center" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">EncAlg</td>
                <td class="text-center" rowspan="1" colspan="1">AES-256 [NIST.FIPS.197] in the CTR mode [NIST.SP.800-38a]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">AES-256 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">AES-256 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">IVLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TIVLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">KDAlg</td>
                <td class="text-center" rowspan="1" colspan="1">see the description below </td>
              </tr>
            </tbody>
          </table>
<div id="KeyAESCTRCMAC">
<section id="section-5.3.4.1">
            <h5 id="name-exchange-keys-4">
<a href="#section-5.3.4.1" class="section-number selfRef">5.3.4.1. </a><a href="#name-exchange-keys-4" class="section-name selfRef">Exchange keys</a>
            </h5>
<p id="section-5.3.4.1-1">
 For each pair of interacting hosts, there is a single exchange key with a length of 256 bits 
 designed for derivation of packet encryption keys, end-to-end MAC keys, and transit MAC keys.<a href="#section-5.3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.4.1-2">
 There may be several exchange keys for a pair of interacting hosts. The KN field value of the 
 IPlir message (for derivation of packet encryption keys and packet end-to-end MAC keys) or the 
 TKN field value of the IPlir message (for derivation of packet transit MAC keys) is used to 
 determine a specific single exchange key.<a href="#section-5.3.4.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IVAESCTRCMAC">
<section id="section-5.3.4.2">
            <h5 id="name-requirements-for-initializing-">
<a href="#section-5.3.4.2" class="section-number selfRef">5.3.4.2. </a><a href="#name-requirements-for-initializing-" class="section-name selfRef">Requirements for initializing values</a>
            </h5>
<p id="section-5.3.4.2-1">
 The end-to-end initializing value InitValue in the InitValue field of the IPlir message should 
 have a length of 64 bits and be unique for each IPlir packet the encryption and end-to-end MAC 
 of which are implemented by the same sender host using the same single exchange key.<a href="#section-5.3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.4.2-2">
 The transit initializing value TransitInitValue in the TransitInitValue field of the IPlir 
 message should have a length of 64 bits and be unique for each IPlir packet the transit MAC 
 of which is implemented by the same (transit) host using the same single exchange key.<a href="#section-5.3.4.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="KDFAESCTRCMAC">
<section id="section-5.3.4.3">
            <h5 id="name-key-derivation-algorithms-4">
<a href="#section-5.3.4.3" class="section-number selfRef">5.3.4.3. </a><a href="#name-key-derivation-algorithms-4" class="section-name selfRef">Key derivation algorithms</a>
            </h5>
<p id="section-5.3.4.3-1">
 The packet encryption key K_ENC of 256-bit length and the packet end-to-end MAC key K_MAC of 
 256-bit length are calculated as follows:<a href="#section-5.3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.4.3-2">
 K_ENC = K_1 || K_2,<a href="#section-5.3.4.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3.4.3-3">
 K_MAC = K_3 || K_4,<a href="#section-5.3.4.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3.4.3-4">
 where each value of K_i \in V_128, i = 1,2,3,4 is calculated as per KDF in Counter Mode [NIST.SP.800-108] using AES-256 
 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b] as the PRF, wherein<a href="#section-5.3.4.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4.3-5.1">the single exchange key corresponding to the specified sender and recipient hosts, and the KN field 
 value of the IPlir message is used as the key for the PRF,<a href="#section-5.3.4.3-5.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.4.3-5.2">
                <p id="section-5.3.4.3-5.2.1">a binary string as shown below is used as the input data for the PRF: IntToVec_8(i)||Label||aL||IV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.4.3-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4.3-5.2.2.1">Label = StrToVec_48('ENCMAC'),<a href="#section-5.3.4.3-5.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-5.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.4.3-5.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-5.2.2.3">IV_KDF = InitValue, where InitValue is initialized by the InitValue field value of the IPlir message,<a href="#section-5.3.4.3-5.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-5.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.4.3-5.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-5.2.2.5">Node = SourceIdentifier, where SourceIdentifier is initialized by the SourceIdentifier field value of the IPlir message,<a href="#section-5.3.4.3-5.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-5.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the InitValue, 
 SequenceNumber and SourceIdentifier fields of the IPlir message,<a href="#section-5.3.4.3-5.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-5.2.2.7">oL = IntToVec_8(OutputBitLength), where OutputBitLength = 512,<a href="#section-5.3.4.3-5.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.4.3-5.3">the PRF output length is 128 bits.<a href="#section-5.3.4.3-5.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.4.3-6">
 The packet transit MAC key K_TMAC of 256-bit length is calculated as follows:<a href="#section-5.3.4.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3.4.3-7">
 K_TMAC = K_1 || K_2,<a href="#section-5.3.4.3-7" class="pilcrow">¶</a></p>
<p id="section-5.3.4.3-8">
 where each value of K_i \in V_128, i = 1,2 is calculated as per KDF in Counter Mode [NIST.SP.800-108] using AES-256 
 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b] as the PRF, wherein<a href="#section-5.3.4.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4.3-9.1">the single exchange key corresponding to the specified (transit) hosts the IPlir packet passes through and the 
 TKN field value of the IPlir message is used as the key for the PRF,<a href="#section-5.3.4.3-9.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.4.3-9.2">
                <p id="section-5.3.4.3-9.2.1">a binary string as shown below is used as the input data for the PRF: IntToVec_8(i)||Label||aL||TIV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.4.3-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4.3-9.2.2.1">Label = StrToVec_48('TMAC'),<a href="#section-5.3.4.3-9.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-9.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.4.3-9.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-9.2.2.3">TIV_KDF = TransitInitValue, where TransitInitValue is initialized by the TransitInitValue field value of the IPlir message,<a href="#section-5.3.4.3-9.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-9.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.4.3-9.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-9.2.2.5">Node = TransitIdentifier, where TransitIdentifier is initialized by the TransitIdentifier field value of the IPlir message,<a href="#section-5.3.4.3-9.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-9.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the TransitInitValue, 
 SequenceNumber and TransitIdentifier fields of the IPlir message,<a href="#section-5.3.4.3-9.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.3-9.2.2.7">oL = IntToVec_16(OutputBitLength), where OutputBitLength = 256,<a href="#section-5.3.4.3-9.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.4.3-9.3">the PRF output length is 128 bits.<a href="#section-5.3.4.3-9.3" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="EncAESCTRCMAC">
<section id="section-5.3.4.4">
            <h5 id="name-encryption-and-mac-algorithms-2">
<a href="#section-5.3.4.4" class="section-number selfRef">5.3.4.4. </a><a href="#name-encryption-and-mac-algorithms-2" class="section-name selfRef">Encryption and MAC algorithms</a>
            </h5>
<p id="section-5.3.4.4-1">
 The IPlir body is encrypted according to the AES-256 [NIST.FIPS.197] in the CTR mode [NIST.SP.800-38a], wherein<a href="#section-5.3.4.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4.4-2.1">the packet encryption key K_ENC is used as the key,<a href="#section-5.3.4.4-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.4.4-2.2">data in the IPlir body fields in the order of their appearance in the IPlir message are used as plaintext,<a href="#section-5.3.4.4-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.4.4-2.3">
                <p id="section-5.3.4.4-2.3.1">the values of T_1, T_2, ... , T_n \in V_128 are used as counters in CTR mode:<a href="#section-5.3.4.4-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4.4-2.3.2.1">T_i = InitValue || IntToVec_64(i), i = 1, 2, ... , n,<a href="#section-5.3.4.4-2.3.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.4.4-2.3.2.2">where InitValue is initialized by the InitValue field value of the IPlir message.<a href="#section-5.3.4.4-2.3.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="section-5.3.4.4-3">
 Calculation of the end-to-end MAC ICV in the IntegrityCheckValue field of the IPlir message is implemented 
 according to the AES-256 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b], wherein<a href="#section-5.3.4.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4.4-4.1">the packet end-to-end MAC key K_MAC is used as the key,<a href="#section-5.3.4.4-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.4.4-4.2">data in the IPlir body fields in the order of their appearance in the IPlir message are used as plaintext,<a href="#section-5.3.4.4-4.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.4.4-4.3">the MAC length s is 64 bits.<a href="#section-5.3.4.4-4.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.4.4-5">
 The diagram of encryption and end-to-end MAC is shown in Figure 14.<a href="#section-5.3.4.4-5" class="pilcrow">¶</a></p>
<span id="name-figure-14-diagram-of-encryp"></span><figure id="figure-14">
              <div class="alignLeft art-text artwork" id="section-5.3.4.4-6.1">
<pre>
                +-----------------------------------+
                |           IPlir header            |
                |                ...                |
                |   +---------------------------+   |
           +--------|     SourceIdentifier      |   |
           |    |   +---------------------------+   |
           |    |                ...                |
           |    |   +---------------------------+   |
           +--------|      SequenceNumber       |   |
           |    |   +---------------------------+   |
           +--------|        InitValue          |----------+
           |    |   +---------------------------+   |      |
           |    +-----------------------------------+      |
           |    |            IPlir body             |--+   |
           |    +-----------------------------------+  |   |
           |    |           IPlir trailer           |  |   |
           |    |                ...                |  |   |
           |    +-----------------------------------+  |   |
           |                                           |   |
           v                                           v   v
+---------------------------------+  +------+  +-------------------+
|     KDF in Counter Mode         |-&gt;|K_ENC |-&gt;|      AES-256      |
|   [NIST.SP.800-108] based on    |  +------+  |  [NIST.FIPS.197]  |
| AES-256 [NIST.FIPS.197] in the  |            |  in the CTR mode  |
|   CMAC mode [NIST.SP.800-38b]   |  +------+  | [NIST.SP.800-38a] |
|                                 |-&gt;|K_MAC |  |                   |
+---------------------------------+  +------+  +-------------------+
            ^                            |               |
            |                            v               |
+-----------------------+       +-------------------+    |
| Exchange keys between |       |      AES-256      |    |
| source and destination|   +---|  [NIST.FIPS.197]  |    |
|        hosts          |   |   | in the CMAC mode  |    |
+-----------------------+   |   | [NIST.SP.800-38b] |    |
                            |   +-------------------+    |
    +-----------------------+             ^              |
    |                                     |              |
    |   +---------------------------------+              |
    |   |                                                |
    |   |   +---+-----------------------------------+    |
    |   |   |   |           IPlir header            |    |
    |   |   |   |                ...                |    |
    |   |   |   |   +---------------------------+   |    |
    |   |   |   |   |     SourceIdentifier      |   |    |
    |   |   |   |   +---------------------------+   |    |
    |   |   |   |                ...                |    |
    |   +---|   |   +---------------------------+   |    |
    |       |   |   |      SequenceNumber       |   |    |
    |       |   |   +---------------------------+   |    |
    |       |   |   |        InitValue          |   |    |
    |       |   |   +---------------------------+   |    |
    |       |   +-----------------------------------+    |
    |       |   |       Encrypted IPlir body        |&lt;---+
    |       +---+-----------------------------------+
    |           |           IPlir trailer           |
    |           |   +---------------------------+   |
    +--------------&gt;|     InterityCheckValue    |   |
                |   +---------------------------+   |
                |                ...                |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-figure-14-diagram-of-encryp" class="selfRef">Figure 14 - Diagram of Encryption and End-to-End MAC Using the AES-256-CTR-CMAC Cryptographic Suite</a>
              </figcaption></figure>
<p id="section-5.3.4.4-7">
 Calculation of the transit MAC TICV in the TransitIntegrityCheckValue field of the 
 IPlir message is implemented according to the AES-256 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b], wherein<a href="#section-5.3.4.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.4.4-8.1">the packet transit MAC key K_TMAC is used as the key,<a href="#section-5.3.4.4-8.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.4.4-8.2">data in the IPlir header fields, the encrypted IPlir body and IntegrityCheckValue, TransitIdentifier, 
 TransitInitValue fields data in the order of their appearance in the IPlir message are used as associated 
 authenticated data protected by MAC,<a href="#section-5.3.4.4-8.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.4.4-8.3">the MAC length s is 64 bits.<a href="#section-5.3.4.4-8.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.4.4-9">
 The diagram of transit MAC is shown in Figure 15.<a href="#section-5.3.4.4-9" class="pilcrow">¶</a></p>
<span id="name-figure-15-diagram-of-transi"></span><figure id="figure-15">
              <div class="alignLeft art-text artwork" id="section-5.3.4.4-10.1">
<pre>
                +-----------------------------------+--+
                |           IPlir header            |  |
                |                ...                |  |
                |   +---------------------------+   |  |
           +--------|      SequenceNumber       |   |  |
           |    |   +---------------------------+   |  |
           |    |                ...                |  |
           |    +-----------------------------------+  |
           |    |        Encrypted IPlir body       |  |---+
           |    +-----------------------------------+  |   |
           |    |           IPlir trailer           |  |   |
           |    |                ...                |  |   |
           |    |   +---------------------------+   |  |   |
           +--------|     TransitIdentifier     |   |  |   |
           |    |   +---------------------------+   |  |   |
           +--------|                           |   |  |   |
           |    |   |     TransitInitValue      |   |  |   |
           |    |   |                           |   |  |   |
           |    |   +---------------------------+---|--+   |
           |    |                ...                |      |
           |    +-----------------------------------+      |
           |                                               |
           v                                               v
+---------------------------------+            +-------------------+
|     KDF in Counter Mode         |  +------+  |      AES-256      |
|   [NIST.SP.800-108] based on    |-&gt;|K_TMAC|-&gt;|  [NIST.FIPS.197]  |
| AES-256 [NIST.FIPS.197] in the  |  +------+  | in the CMAC mode  |
|   CMAC mode [NIST.SP.800-38b]   |            | [NIST.SP.800-38b] |
+---------------------------------+            +-------------------+
                 ^                                       |
                 |                                       |
     +-----------------------+                           |
     | Exchange keys between |                           |
     |     transit hosts     |                           |
     +-----------------------+                           |
                                                         |
                +-----------------------------------+    |
                |           IPlir header            |    |
                |                ...                |    |
                |   +---------------------------+   |    |
                |   |      SequenceNumber       |   |    |
                |   +---------------------------+   |    |
                |                ...                |    |
                +-----------------------------------+    |
                |        Encrypted IPlir body       |    |
                +-----------------------------------+    |
                |           IPlir trailer           |    |
                |                ...                |    |
                |   +---------------------------+   |    |
                |   |     TransitIdentifier     |   |    |
                |   +---------------------------+   |    |
                |   |                           |   |    |
                |   |     TransitInitValue      |   |    |
                |   |                           |   |    |
                |   +---------------------------+   |    |
                |   | TransitInterityCheckValue |&lt;-------+
                |   +---------------------------+   |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-figure-15-diagram-of-transi" class="selfRef">Figure 15 - Diagram of Transit MAC Using the AES-256-CTR-CMAC Cryptographic Suite</a>
              </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="AESCFBCMAC">
<section id="section-5.3.5">
          <h4 id="name-aes-256-cfb-cmac-cryptograp">
<a href="#section-5.3.5" class="section-number selfRef">5.3.5. </a><a href="#name-aes-256-cfb-cmac-cryptograp" class="section-name selfRef">AES-256-CFB-CMAC cryptographic suite: CS = 134</a>
          </h4>
<p id="section-5.3.5-1">
 AES-256-CTR-CMAC Cryptographic Suite Description:<a href="#section-5.3.5-1" class="pilcrow">¶</a></p>
<table class="left" id="table-10">
            <caption><a href="#table-10" class="selfRef">Table 10</a></caption>
<thead>
              <tr>
                <th class="text-center" rowspan="1" colspan="1">Parameter</th>
                <th class="text-center" rowspan="1" colspan="1">Value</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">EncAlg</td>
                <td class="text-center" rowspan="1" colspan="1">AES-256 [NIST.FIPS.197] in the CFB mode [NIST.SP.800-38a]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">AES-256 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACAlg</td>
                <td class="text-center" rowspan="1" colspan="1">AES-256 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b]</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">MACLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TMACLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">IVLen</td>
                <td class="text-center" rowspan="1" colspan="1">128 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">TIVLen</td>
                <td class="text-center" rowspan="1" colspan="1">64 bits</td>
              </tr>
              <tr>
                <td class="text-center" rowspan="1" colspan="1">KDAlg</td>
                <td class="text-center" rowspan="1" colspan="1">see the description below </td>
              </tr>
            </tbody>
          </table>
<div id="KeyAESCFBCMAC">
<section id="section-5.3.5.1">
            <h5 id="name-exchange-keys-5">
<a href="#section-5.3.5.1" class="section-number selfRef">5.3.5.1. </a><a href="#name-exchange-keys-5" class="section-name selfRef">Exchange keys</a>
            </h5>
<p id="section-5.3.5.1-1">
 For each pair of interacting hosts, there is a single exchange key with a length of 256 bits 
 designed for derivation of packet encryption keys, end-to-end MAC keys, and transit MAC keys.<a href="#section-5.3.5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.3.5.1-2">
 There may be several exchange keys for a pair of interacting hosts. The KN field value of the 
 IPlir message (for derivation of packet encryption keys and packet end-to-end MAC keys) or the 
 TKN field value of the IPlir message (for derivation of packet transit MAC keys) is used to 
 determine a specific single exchange key.<a href="#section-5.3.5.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IVAESCFBCMAC">
<section id="section-5.3.5.2">
            <h5 id="name-requirements-for-initializing-v">
<a href="#section-5.3.5.2" class="section-number selfRef">5.3.5.2. </a><a href="#name-requirements-for-initializing-v" class="section-name selfRef">Requirements for initializing values</a>
            </h5>
<p id="section-5.3.5.2-1">
 The end-to-end initializing value InitValue in the InitValue field of the IPlir message should 
 have a length of 128 bits and be unique for each IPlir packet the encryption and end-to-end MAC 
 of which are implemented by the same sender host using the same single exchange key.<a href="#section-5.3.5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.3.5.2-2">
 The transit initializing value TransitInitValue in the TransitInitValue field of the IPlir 
 message should have a length of 64 bits and be unique for each IPlir packet the transit MAC 
 of which is implemented by the same (transit) host using the same single exchange key.<a href="#section-5.3.5.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="KDFAESCFBCMAC">
<section id="section-5.3.5.3">
            <h5 id="name-key-derivation-algorithms-5">
<a href="#section-5.3.5.3" class="section-number selfRef">5.3.5.3. </a><a href="#name-key-derivation-algorithms-5" class="section-name selfRef">Key derivation algorithms</a>
            </h5>
<p id="section-5.3.5.3-1">
 The packet encryption key K_ENC of 256-bit length and the packet end-to-end MAC key K_MAC of 
 256-bit length are calculated as follows:<a href="#section-5.3.5.3-1" class="pilcrow">¶</a></p>
<p id="section-5.3.5.3-2">
 K_ENC = K_1 || K_2,<a href="#section-5.3.5.3-2" class="pilcrow">¶</a></p>
<p id="section-5.3.5.3-3">
 K_MAC = K_3 || K_4,<a href="#section-5.3.5.3-3" class="pilcrow">¶</a></p>
<p id="section-5.3.5.3-4">
 where each value of K_i \in V_128, i = 1,2,3,4 is calculated as per KDF in Counter Mode [NIST.SP.800-108] using AES-256 
 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b] as the PRF, wherein<a href="#section-5.3.5.3-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.5.3-5.1">the single exchange key corresponding to the specified sender and recipient hosts, and the KN field 
 value of the IPlir message is used as the key for the PRF,<a href="#section-5.3.5.3-5.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.5.3-5.2">
                <p id="section-5.3.5.3-5.2.1">a binary string as shown below is used as the input data for the PRF: IntToVec_8(i)||Label||aL||IV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.5.3-5.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.5.3-5.2.2.1">Label = StrToVec_48('ENCMAC'),<a href="#section-5.3.5.3-5.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-5.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.5.3-5.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-5.2.2.3">IV_KDF = InitValue, where InitValue is initialized by the InitValue field value of the IPlir message,<a href="#section-5.3.5.3-5.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-5.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.5.3-5.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-5.2.2.5">Node = SourceIdentifier, where SourceIdentifier is initialized by the SourceIdentifier field value of the IPlir message,<a href="#section-5.3.5.3-5.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-5.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the InitValue, 
 SequenceNumber and SourceIdentifier fields of the IPlir message,<a href="#section-5.3.5.3-5.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-5.2.2.7">oL = IntToVec_16(OutputBitLength), where OutputBitLength = 512,<a href="#section-5.3.5.3-5.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.5.3-5.3">the PRF output length is 128 bits.<a href="#section-5.3.5.3-5.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.5.3-6">
 The packet transit MAC key K_TMAC of 256-bit length is calculated as follows:<a href="#section-5.3.5.3-6" class="pilcrow">¶</a></p>
<p id="section-5.3.5.3-7">
 K_TMAC = K_1 || K_2,<a href="#section-5.3.5.3-7" class="pilcrow">¶</a></p>
<p id="section-5.3.5.3-8">
 where each value of K_i \in V_128, i = 1,2 is calculated as per KDF in Counter Mode [NIST.SP.800-108] using AES-256 
 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b] as the PRF, wherein<a href="#section-5.3.5.3-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.5.3-9.1">the single exchange key corresponding to the specified (transit) hosts the IPlir packet passes through and the 
 TKN field value of the IPlir message is used as the key for the PRF,<a href="#section-5.3.5.3-9.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.5.3-9.2">
                <p id="section-5.3.5.3-9.2.1">a binary string as shown below is used as the input data for the PRF: IntToVec_8(i)||Label||aL||TIV_KDF||SN||Node||cL||oL, where<a href="#section-5.3.5.3-9.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.5.3-9.2.2.1">Label = StrToVec_48('TMAC'),<a href="#section-5.3.5.3-9.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-9.2.2.2">aL = IntToVec_8(LabelByteLength), where LabelByteLength = 6,<a href="#section-5.3.5.3-9.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-9.2.2.3">TIV_KDF = TransitInitValue, where TransitInitValue is initialized by the TransitInitValue field value of the IPlir message,<a href="#section-5.3.5.3-9.2.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-9.2.2.4">SN = SequenceNumber, where SequenceNumber is initialized by the SequenceNumber field value of the IPlir message,<a href="#section-5.3.5.3-9.2.2.4" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-9.2.2.5">Node = TransitIdentifier, where TransitIdentifier is initialized by the TransitIdentifier field value of the IPlir message,<a href="#section-5.3.5.3-9.2.2.5" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-9.2.2.6">cL = IntToVec_16(ContextByteLength), where ContextByteLength is the sum of byte lengths of the TransitInitValue, 
 SequenceNumber and TransitIdentifier fields of the IPlir message,<a href="#section-5.3.5.3-9.2.2.6" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.3-9.2.2.7">oL = IntToVec_16(OutputBitLength), where OutputBitLength = 256,<a href="#section-5.3.5.3-9.2.2.7" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-5.3.5.3-9.3">the PRF output length is 128 bits.<a href="#section-5.3.5.3-9.3" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
<div id="EncAESCFBCMAC">
<section id="section-5.3.5.4">
            <h5 id="name-encryption-and-mac-algorithms-3">
<a href="#section-5.3.5.4" class="section-number selfRef">5.3.5.4. </a><a href="#name-encryption-and-mac-algorithms-3" class="section-name selfRef">Encryption and MAC algorithms</a>
            </h5>
<p id="section-5.3.5.4-1">
 The IPlir body is encrypted according to the AES-256 [NIST.FIPS.197] in the CFB mode [NIST.SP.800-38a], wherein<a href="#section-5.3.5.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.5.4-2.1">the packet encryption key K_ENC is used as the key,<a href="#section-5.3.5.4-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.5.4-2.2">data in the IPlir body fields in the order of their appearance in the IPlir message are used as plaintext,<a href="#section-5.3.5.4-2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.5.4-2.3">
                <p id="section-5.3.5.4-2.3.1">the value of IV_ENC \in V_128 is used as the initializing value:<a href="#section-5.3.5.4-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.5.4-2.3.2.1">IV_ENC = InitValue,<a href="#section-5.3.5.4-2.3.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-5.3.5.4-2.3.2.2">where InitValue is initialized by the InitValue field value of the IPlir message.<a href="#section-5.3.5.4-2.3.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="section-5.3.5.4-3">
 Calculation of the end-to-end MAC ICV in the IntegrityCheckValue field of the IPlir message is implemented 
 according to the AES-256 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b], wherein<a href="#section-5.3.5.4-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.5.4-4.1">the packet end-to-end MAC key K_MAC is used as the key,<a href="#section-5.3.5.4-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.5.4-4.2">data in the IPlir body fields in the order of their appearance in the IPlir message are used as plaintext,<a href="#section-5.3.5.4-4.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.5.4-4.3">the MAC length s is 64 bits.<a href="#section-5.3.5.4-4.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.5.4-5">
 The diagram of encryption and end-to-end MAC is shown in Figure 16.<a href="#section-5.3.5.4-5" class="pilcrow">¶</a></p>
<span id="name-figure-16-diagram-of-encryp"></span><figure id="figure-16">
              <div class="alignLeft art-text artwork" id="section-5.3.5.4-6.1">
<pre>
                +-----------------------------------+
                |           IPlir header            |
                |                ...                |
                |   +---------------------------+   |
           +--------|     SourceIdentifier      |   |
           |    |   +---------------------------+   |
           |    |                ...                |
           |    |   +---------------------------+   |
           +--------|      SequenceNumber       |   |
           |    |   +---------------------------+   |
           +--------|        InitValue          |----------+
           |    |   +---------------------------+   |      |
           |    +-----------------------------------+      |
           |    |            IPlir body             |--+   |
           |    +-----------------------------------+  |   |
           |    |           IPlir trailer           |  |   |
           |    |                ...                |  |   |
           |    +-----------------------------------+  |   |
           |                                           |   |
           v                                           v   v
+---------------------------------+  +------+  +-------------------+
|     KDF in Counter Mode         |-&gt;|K_ENC |-&gt;|      AES-256      |
|   [NIST.SP.800-108] based on    |  +------+  |  [NIST.FIPS.197]  |
| AES-256 [NIST.FIPS.197] in the  |            |  in the CFB mode  |
|   CMAC mode [NIST.SP.800-38b]   |  +------+  | [NIST.SP.800-38a] |
|                                 |-&gt;|K_MAC |  |                   |
+---------------------------------+  +------+  +-------------------+
            ^                            |               |
            |                            v               |
+-----------------------+       +-------------------+    |
| Exchange keys between |       |      AES-256      |    |
| source and destination|   +---|  [NIST.FIPS.197]  |    |
|        hosts          |   |   | in the CMAC mode  |    |
+-----------------------+   |   | [NIST.SP.800-38b] |    |
                            |   +-------------------+    |
    +-----------------------+             ^              |
    |                                     |              |
    |   +---------------------------------+              |
    |   |                                                |
    |   |   +---+-----------------------------------+    |
    |   |   |   |           IPlir header            |    |
    |   |   |   |                ...                |    |
    |   |   |   |   +---------------------------+   |    |
    |   |   |   |   |     SourceIdentifier      |   |    |
    |   |   |   |   +---------------------------+   |    |
    |   |   |   |                ...                |    |
    |   +---|   |   +---------------------------+   |    |
    |       |   |   |      SequenceNumber       |   |    |
    |       |   |   +---------------------------+   |    |
    |       |   |   |        InitValue          |   |    |
    |       |   |   +---------------------------+   |    |
    |       |   +-----------------------------------+    |
    |       |   |       Encrypted IPlir body        |&lt;---+
    |       +---+-----------------------------------+
    |           |           IPlir trailer           |
    |           |   +---------------------------+   |
    +--------------&gt;|     InterityCheckValue    |   |
                |   +---------------------------+   |
                |                ...                |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-figure-16-diagram-of-encryp" class="selfRef">Figure 16 - Diagram of Encryption and End-to-End MAC Using the AES-256-CFB-CMAC Cryptographic Suite</a>
              </figcaption></figure>
<p id="section-5.3.5.4-7">
 Calculation of the transit MAC TICV in the TransitIntegrityCheckValue field of the 
 IPlir message is implemented according to the AES-256 [NIST.FIPS.197] in the CMAC mode [NIST.SP.800-38b], wherein<a href="#section-5.3.5.4-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.5.4-8.1">the packet transit MAC key K_TMAC is used as the key,<a href="#section-5.3.5.4-8.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.5.4-8.2">data in the IPlir header fields, the encrypted IPlir body and IntegrityCheckValue, TransitIdentifier, 
 TransitInitValue fields data in the order of their appearance in the IPlir message are used as associated 
 authenticated data protected by MAC,<a href="#section-5.3.5.4-8.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-5.3.5.4-8.3">the MAC length s is 64 bits.<a href="#section-5.3.5.4-8.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-5.3.5.4-9">
 The diagram of transit MAC is shown in Figure 17.<a href="#section-5.3.5.4-9" class="pilcrow">¶</a></p>
<span id="name-figure-17-diagram-of-transi"></span><figure id="figure-17">
              <div class="alignLeft art-text artwork" id="section-5.3.5.4-10.1">
<pre>
                +-----------------------------------+--+
                |           IPlir header            |  |
                |                ...                |  |
                |   +---------------------------+   |  |
           +--------|      SequenceNumber       |   |  |
           |    |   +---------------------------+   |  |
           |    |                ...                |  |
           |    +-----------------------------------+  |
           |    |        Encrypted IPlir body       |  |---+
           |    +-----------------------------------+  |   |
           |    |           IPlir trailer           |  |   |
           |    |                ...                |  |   |
           |    |   +---------------------------+   |  |   |
           +--------|     TransitIdentifier     |   |  |   |
           |    |   +---------------------------+   |  |   |
           +--------|                           |   |  |   |
           |    |   |     TransitInitValue      |   |  |   |
           |    |   |                           |   |  |   |
           |    |   +---------------------------+---|--+   |
           |    |                ...                |      |
           |    +-----------------------------------+      |
           |                                               |
           v                                               v
+---------------------------------+            +-------------------+
|     KDF in Counter Mode         |  +------+  |      AES-256      |
|   [NIST.SP.800-108] based on    |-&gt;|K_TMAC|-&gt;|  [NIST.FIPS.197]  |
| AES-256 [NIST.FIPS.197] in the  |  +------+  | in the CMAC mode  |
|   CMAC mode [NIST.SP.800-38b]   |            | [NIST.SP.800-38b] |
+---------------------------------+            +-------------------+
                 ^                                       |
                 |                                       |
     +-----------------------+                           |
     | Exchange keys between |                           |
     |     transit hosts     |                           |
     +-----------------------+                           |
                                                         |
                +-----------------------------------+    |
                |           IPlir header            |    |
                |                ...                |    |
                |   +---------------------------+   |    |
                |   |      SequenceNumber       |   |    |
                |   +---------------------------+   |    |
                |                ...                |    |
                +-----------------------------------+    |
                |        Encrypted IPlir body       |    |
                +-----------------------------------+    |
                |           IPlir trailer           |    |
                |                ...                |    |
                |   +---------------------------+   |    |
                |   |     TransitIdentifier     |   |    |
                |   +---------------------------+   |    |
                |   |                           |   |    |
                |   |     TransitInitValue      |   |    |
                |   |                           |   |    |
                |   +---------------------------+   |    |
                |   | TransitInterityCheckValue |&lt;-------+
                |   +---------------------------+   |
                +-----------------------------------+
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-figure-17-diagram-of-transi" class="selfRef">Figure 17 - Diagram of Transit MAC Using the AES-256-CFB-CMAC Cryptographic Suite</a>
              </figcaption></figure>
</section>
</div>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="Processing">
<section id="section-6">
      <h2 id="name-iplir-packet-processing">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iplir-packet-processing" class="section-name selfRef">IPlir packet processing</a>
      </h2>
<p id="section-6-1">
 For cryptographic processing of network packets, the algorithms used and their application procedure 
 are determined by the cryptographic suite.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
 The cryptographic suite  for protection of the source IP packet is chosen depending on the corresponding 
 security policy of the sender host and the destination host context on the recipient end. The logic and 
 procedure of processing IPlir packets protected using a certain cryptographic suite depend on the IPlir 
 packet reception policy and the sender host context on the recipient end. The necessity and procedure of 
 using transit MAC are determined based on the sender host security policy and IPlir packet reception 
 policies of transit hosts and the recipient host.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">
 Depending on security policies and other requirements, protection of the recipient host or transit host 
 against replay of previously transmitted IPlir packets for reprocessing may be required. The IPlir protocol 
 makes it possible to arrange such protection by using counter values and/or timestamps, as well as by 
 tracking the history of their change on transit hosts and the recipient host. As an example, SequenceNumber, 
 InitValue, TransitInitValue field values can be used as counter values, Timestamp field values can be used as 
 timestamps. Description of specific mechanisms designed for protection against replay of previously transmitted 
 IPlir packets is beyond the scope of this document.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="Fragmentation">
<section id="section-6.1">
        <h3 id="name-ip-and-iplir-packet-fragmen">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-ip-and-iplir-packet-fragmen" class="section-name selfRef">IP and IPlir packet fragmentation</a>
        </h3>
<p id="section-6.1-1">
 When packing data in IP packets, the IP protocol can fragment (break down into fragments) messages of 
 the higher transport layer protocols UDP, TCP, etc. This processing results in several (linked) 
 IP packets, each called an IP fragment.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
 The IPlir protocol in transport and light tunnel modes should only be applied to whole (non-fragmented) 
 IP packets, but not IP fragments. In the tunnel mode, the IPlir protocol can be applied to both whole IP 
 packets and IP fragments.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">
 In case of encapsulation in IPv4, the IPlir packet, just like any other IPv4 packet, can be fragmented 
 by routers during transmission. Before the IPlir packet is processed on the end of the recipient or 
 transit host, the IPlir packet must be defragmented.<a href="#section-6.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="SenderHost">
<section id="section-6.2">
        <h3 id="name-source-ip-packet-protection">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-source-ip-packet-protection" class="section-name selfRef">Source IP packet protection by the sender host</a>
        </h3>
<p id="section-6.2-1">
 If the sender host decides to protect a specific IP packet, an IPlir packet is created as follows.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.2-2">
<li id="section-6.2-2.1">
            <p id="section-6.2-2.1.1">The recipient and transit host contexts along with the applied security policy determine:<a href="#section-6.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.1.2.1">TIV_AEAD = LSB_63(TransitInitValue),<a href="#section-6.2-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.1.2.2">where TransitInitValue is initialized by the TransitInitValue field value of the IPlir message,<a href="#section-6.2-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-6.2-2.2">
            <p id="section-6.2-2.2.1">Based on the recipient and transit host contexts along with the cryptographic suite:<a href="#section-6.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-2.2.2.1">TIV_AEAD = LSB_63(TransitInitValue),<a href="#section-6.2-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.2-2.2.2.2">where TransitInitValue is initialized by the TransitInitValue field value of the IPlir message,<a href="#section-6.2-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-6.2-2.3">The IPlir packet fields are filled in considering the data from the source IP packet and the data generated previously.<a href="#section-6.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.4">The IPlir body is encrypted (if required by the security policy) and the end-to-end MAC value 
 is calculated as prescribed by the cryptographic suite. The end-to-end MAC value is placed in the corresponding field 
 of the IPlir trailer.<a href="#section-6.2-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.5">If transit integrity control is required, the corresponding fields and flags of the IPlir header and IPlir trailer 
 are filled in, the transit MAC value is calculated. The transit MAC value is placed in the corresponding field of the IPlir trailer.<a href="#section-6.2-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.2-2.6">An IPlir packet is generated, wherein parts of the source IP packet are located according to the rules specified in Section 4.4.<a href="#section-6.2-2.6" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="ForwardHost">
<section id="section-6.3">
        <h3 id="name-iplir-packet-processing-on-">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-iplir-packet-processing-on-" class="section-name selfRef">IPlir packet processing on the forward host</a>
        </h3>
<p id="section-6.3-1">
 After receiving an IPlir packet, the transit host processes the IPlir packet as follows.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.3-2">
<li id="section-6.3-2.1">It checks whether the received IPlir packet corresponds to the IPlir packet reception policy. If the packet does not comply 
 with the policy, it is blocked.<a href="#section-6.3-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.2">If the IPlir version in the IPlir header is not supported by the host, the packet is blocked.<a href="#section-6.3-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.3">The IPlir packet is matched to the context of the sender host or the previous transit host. 
 If the context is not found or contains cryptographic suites not matching the set from the IPlir header, the packet is blocked.<a href="#section-6.3-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.4">If the suite from the IPlir header does not imply transit MAC, the packet is blocked.<a href="#section-6.3-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.5">Based on the context of the previous transit host and the IPlir header, the packet transit MAC key is derived. 
 The IPlir packet integrity is verified by checking the transit MAC. If the transit MAC is not correct, the packet is blocked.<a href="#section-6.3-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.6">Based on the recipient host context, the next transit host is determined on the transit host 
 (or it is determined that the IPlir packet can be delivered to the recipient host directly). 
 If the context of the next transit host (or recipient host) is not found, the packet is blocked.<a href="#section-6.3-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.7">If the found context contains cryptographic suites not matching the set from the IPlir header, the packet is blocked.<a href="#section-6.3-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.8">Based on the context of the next transit host, IPlir header and IPlir trailer, 
 the packet transit MAC key and transit initializing value are generated. The necessary number of the packet 
 transit MAC key and the transit host identifier are established in the IPlir message. 
 The transit initializing value is located in the TransitInitValue field.<a href="#section-6.3-2.8" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.9">The transit MAC value is calculated and placed in the corresponding field of the IPlir trailer.<a href="#section-6.3-2.9" class="pilcrow">¶</a>
</li>
          <li id="section-6.3-2.10">An IPlir packet is generated, wherein parts of the source IP packet are located according to the rules specified in Section 4.4.<a href="#section-6.3-2.10" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.3-3">
 There may be cases when the security policies require a transit MAC to be added to the routed packet without checking 
 the previous value or, vice versa, the received IPlir packet integrity to be checked without calculating a new transit 
 MAC value, as well as cases when no transit protection is required. In this case:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-4.1">If no integrity verification of the received transit IPlir packet is required, steps 3, 4, 5 of the algorithm are skipped,<a href="#section-6.3-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-4.2">If no transit MAC calculation is required, steps 7, 8, 9 of the above algorithm are skipped,<a href="#section-6.3-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.3-4.3">If transit protection is not required, steps 3, 4, 5, 7, 8, 9 of the above algorithm are skipped.<a href="#section-6.3-4.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="RecipientHost">
<section id="section-6.4">
        <h3 id="name-source-ip-packet-recovery-b">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-source-ip-packet-recovery-b" class="section-name selfRef">Source IP packet recovery by the recipient host</a>
        </h3>
<p id="section-6.4-1">
 After receiving the IPlir packet, the recipient host restores the source IP packet as follows.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-6.4-2">
<li id="section-6.4-2.1">It checks whether the received IPlir packet corresponds to the IPlir packet reception policy. If the packet does not 
 comply with the policy, it is blocked.<a href="#section-6.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.2">If the IPlir version in the IPlir header is not supported by the host, the packet is blocked.<a href="#section-6.4-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.3">The IPlir packet is matched to the context of the previous transit host. If the context is not 
 found or contains cryptographic suites not matching the set from the IPlir header, the packet is blocked.<a href="#section-6.4-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.4">Based on the context of the previous transit host and the IPlir header, the packet transit MAC key is derived. 
 The IPlir packet integrity is verified by checking the transit MAC. If the transit MAC is not correct, the packet is blocked.<a href="#section-6.4-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.5">The IPlir packet is matched to the context of the sender host. If the context is not found or contains cryptographic 
 suites not matching the suite from the IPlir header, the packet is blocked.<a href="#section-6.4-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.6">Based on the context of the sender host and the IPlir header, the packet encryption key and packet end-to-end MAC key are derived.<a href="#section-6.4-2.6" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.7">The end-to-end MAC is checked and, if the IPlir body was encrypted, the packet IPlir body is decrypted as 
 defined by the cryptographic suite. If the end-to-end MAC is not correct, the packet is blocked.<a href="#section-6.4-2.7" class="pilcrow">¶</a>
</li>
          <li id="section-6.4-2.8">The IP packet is restored according to the rules of Section 4.4.<a href="#section-6.4-2.8" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-6.4-3">
 There may be cases when the security policies do not require transit MAC checking by the recipient host. 
 Then steps 3, 4 of the algorithm are skipped.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="IANACON">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">
                This document has no IANA actions.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="NIST.FIPS.197">[NIST.FIPS.197]</dt>
        <dd>
<span class="refAuthor">NIST</span>, <span class="refTitle">"Advanced encryption standard (AES)"</span>, <span class="seriesInfo">NIST NIST FIPS 197</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.197</span>, <time datetime="2001-11" class="refDate">November 2001</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf">https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.197.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-108">[NIST.SP.800-108]</dt>
        <dd>
<span class="refAuthor">Chen, L.</span>, <span class="refTitle">"Recommendation for key derivation using pseudorandom functions (revised)"</span>, <span class="seriesInfo">NIST NIST SP 800-108</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-108</span>, <time datetime="2009" class="refDate">2009</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-108.pdf">https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-108.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-38a">[NIST.SP.800-38a]</dt>
        <dd>
<span class="refAuthor">Dworkin, M J.</span>, <span class="refTitle">"Recommendation for block cipher modes of operation :methods and techniques"</span>, <span class="seriesInfo">NIST NIST SP 800-38a</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38a</span>, <time datetime="2001" class="refDate">2001</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf">https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38a.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-38b">[NIST.SP.800-38b]</dt>
        <dd>
<span class="refAuthor">Dworkin, M J.</span>, <span class="refTitle">"Recommendation for block cipher modes of operation :the CMAC mode for authentication"</span>, <span class="seriesInfo">NIST NIST SP 800-38b</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38b</span>, <time datetime="2016" class="refDate">2016</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-38b.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-38b.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST.SP.800-38d">[NIST.SP.800-38d]</dt>
        <dd>
<span class="refAuthor">Dworkin, M J.</span>, <span class="refTitle">"Recommendation for block cipher modes of operation :GaloisCounter Mode (GCM) and GMAC"</span>, <span class="seriesInfo">NIST NIST SP 800-38d</span>, <span class="seriesInfo">DOI 10.6028/NIST.SP.800-38d</span>, <time datetime="2007" class="refDate">2007</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf">https://nvlpubs.nist.gov/nistpubs/Legacy/SP/nistspecialpublication800-38d.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7801">[RFC7801]</dt>
        <dd>
<span class="refAuthor">Dolmatov, V., Ed.</span>, <span class="refTitle">"GOST R 34.12-2015: Block Cipher "Kuznyechik""</span>, <span class="seriesInfo">RFC 7801</span>, <span class="seriesInfo">DOI 10.17487/RFC7801</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7801">https://www.rfc-editor.org/info/rfc7801</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8891">[RFC8891]</dt>
        <dd>
<span class="refAuthor">Dolmatov, V., Ed.</span> and <span class="refAuthor">D. Baryshkov</span>, <span class="refTitle">"GOST R 34.12-2015: Block Cipher "Magma""</span>, <span class="seriesInfo">RFC 8891</span>, <span class="seriesInfo">DOI 10.17487/RFC8891</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8891">https://www.rfc-editor.org/info/rfc8891</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9058">[RFC9058]</dt>
      <dd>
<span class="refAuthor">Smyshlyaev, S., Ed.</span>, <span class="refAuthor">Nozdrunov, V.</span>, <span class="refAuthor">Shishkin, V.</span>, and <span class="refAuthor">E. Griboedova</span>, <span class="refTitle">"Multilinear Galois Mode (MGM)"</span>, <span class="seriesInfo">RFC 9058</span>, <span class="seriesInfo">DOI 10.17487/RFC9058</span>, <time datetime="2021-06" class="refDate">June 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9058">https://www.rfc-editor.org/info/rfc9058</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="GOST3413-2015">[GOST3413-2015]</dt>
      <dd>
<span class="refAuthor">Federal Agency on Technical Regulating and Metrology</span>, <span class="refTitle">"Information technology. Cryptographic data security. Modes of operation for block ciphers"</span>, <span class="seriesInfo"> GOST R 34.13-2015</span>, <time datetime="2015" class="refDate">2015</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Davletshina Alexandra (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">InfoTeCS</span></div>
<div dir="auto" class="left"><span class="street-address">2B stroenie 1, ul. Otradnaya</span></div>
<div dir="auto" class="left"><span class="locality">Moscow</span></div>
<div dir="auto" class="left"><span class="postal-code">127273</span></div>
<div dir="auto" class="left"><span class="country-name">Russian Federation</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+7%20(495)%20737-61-92" class="tel">+7 (495) 737-61-92</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:Aleksandra.Davletshina@infotecs.ru" class="email">Aleksandra.Davletshina@infotecs.ru</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Urivskiy Alexey</span></div>
<div dir="auto" class="left"><span class="org">InfoTeCS</span></div>
<div dir="auto" class="left"><span class="street-address">2B stroenie 1, ul. Otradnaya</span></div>
<div dir="auto" class="left"><span class="locality">Moscow</span></div>
<div dir="auto" class="left"><span class="postal-code">127273</span></div>
<div dir="auto" class="left"><span class="country-name">Russian Federation</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+7%20(495)%20737-61-92" class="tel">+7 (495) 737-61-92</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:urivskiy@infotecs.ru" class="email">urivskiy@infotecs.ru</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rybkin Andrey</span></div>
<div dir="auto" class="left"><span class="org">InfoTeCS</span></div>
<div dir="auto" class="left"><span class="street-address">2B stroenie 1, ul. Otradnaya</span></div>
<div dir="auto" class="left"><span class="locality">Moscow</span></div>
<div dir="auto" class="left"><span class="postal-code">127273</span></div>
<div dir="auto" class="left"><span class="country-name">Russian Federation</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+7%20(495)%20737-61-92" class="tel">+7 (495) 737-61-92</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:Andrey.Rybkin@infotecs.ru" class="email">Andrey.Rybkin@infotecs.ru</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tychina Leonid</span></div>
<div dir="auto" class="left"><span class="org">InfoTeCS</span></div>
<div dir="auto" class="left"><span class="street-address">2B stroenie 1, ul. Otradnaya</span></div>
<div dir="auto" class="left"><span class="locality">Moscow</span></div>
<div dir="auto" class="left"><span class="postal-code">127273</span></div>
<div dir="auto" class="left"><span class="country-name">Russian Federation</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+7%20(495)%20737-61-92" class="tel">+7 (495) 737-61-92</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:tychina@infotecs.ru" class="email">tychina@infotecs.ru</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Parshin Ilia</span></div>
<div dir="auto" class="left"><span class="org">InfoTeCS</span></div>
<div dir="auto" class="left"><span class="street-address">2B stroenie 1, ul. Otradnaya</span></div>
<div dir="auto" class="left"><span class="locality">Moscow</span></div>
<div dir="auto" class="left"><span class="postal-code">127273</span></div>
<div dir="auto" class="left"><span class="country-name">Russian Federation</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+7%20(495)%20737-61-92" class="tel">+7 (495) 737-61-92</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:Parshin.Ilia@infotecs.ru" class="email">Parshin.Ilia@infotecs.ru</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
