<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>IPv6 over Controller Area Network</title>
<meta content="Alexander Wachter" name="author">
<meta content="
       Controller Area Network (CAN) is a fieldbus initially designed for automotive applications.  It is a multi-master bus with 11-bit or 29-bit frame identifiers. The CAN standard (ISO 11898 series) defines the physical and data-link layer.  This document describes how to transfer IPv6 packets over CAN using ISO-TP, a dedicated addressing scheme, and IP header compression (IPHC). 
    " name="description">
<meta content="xml2rfc 2.32.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-wachter-6lo-can-00" name="ietf.draft">
<link href="/tmp/draft-wachter-6lo-can-00-zAL0xk.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  dd {
    page-break-before: avoid;
  }
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0;
}
/* Additional page break settings */
@media print {
  table, .references dd {
    page-break-inside: avoid;
  }
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">6LoCAN</td>
<td class="right">October 2019</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wachter</td>
<td class="center">Expires 19 April 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">6Lo Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-wachter-6lo-can-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2019-10-17" class="published">17 October 2019</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-04-19">19 April 2020</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Wachter</div>
<div class="org">Graz University of Technology</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">IPv6 over Controller Area Network</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Controller Area Network (CAN) is a fieldbus initially designed for automotive applications.  It is a multi-master bus with 11-bit or 29-bit frame identifiers. The CAN standard (ISO 11898 series) defines the physical and data-link layer.  This document describes how to transfer IPv6 packets over CAN using ISO-TP, a dedicated addressing scheme, and IP header compression (IPHC).<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 April 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2019 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-boilerplate.3">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.1">
            <p id="section-boilerplate.3-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-boilerplate.3-1.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.1.2.1">
                <p id="section-boilerplate.3-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-boilerplate.3-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.1.2.2">
                <p id="section-boilerplate.3-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-controller-area-network-ove" class="xref">Controller Area Network Overview</a><a href="#section-boilerplate.3-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.1.2.3">
                <p id="section-boilerplate.3-1.1.2.3.1"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-iso-tp-overview" class="xref">ISO-TP Overview</a><a href="#section-boilerplate.3-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.2">
            <p id="section-boilerplate.3-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-addressing" class="xref">Addressing</a><a href="#section-boilerplate.3-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.2.2.1">
                <p id="section-boilerplate.3-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-unicast" class="xref">Unicast</a><a href="#section-boilerplate.3-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.2.2.2">
                <p id="section-boilerplate.3-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-multicast" class="xref">Multicast</a><a href="#section-boilerplate.3-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.2.2.3">
                <p id="section-boilerplate.3-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-address-generation" class="xref">Address Generation</a><a href="#section-boilerplate.3-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.3">
            <p id="section-boilerplate.3-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-link-layer-duplicate-addres" class="xref">Link-Layer Duplicate Address Detection</a><a href="#section-boilerplate.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.4">
            <p id="section-boilerplate.3-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-stateless-address-autoconfi" class="xref">Stateless Address Autoconfiguration</a><a href="#section-boilerplate.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.5">
            <p id="section-boilerplate.3-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-ipv6-link-local-address" class="xref">IPv6 Link-Local Address</a><a href="#section-boilerplate.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.6">
            <p id="section-boilerplate.3-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iso-tp" class="xref">ISO-TP</a><a href="#section-boilerplate.3-1.6.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.1">
                <p id="section-boilerplate.3-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-multicast-2" class="xref">Multicast</a><a href="#section-boilerplate.3-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.2">
                <p id="section-boilerplate.3-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-unicast-2" class="xref">Unicast</a><a href="#section-boilerplate.3-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.3">
                <p id="section-boilerplate.3-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-frame-format" class="xref">Frame Format</a><a href="#section-boilerplate.3-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.4">
                <p id="section-boilerplate.3-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-single-frame" class="xref">Single-Frame</a><a href="#section-boilerplate.3-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.5">
                <p id="section-boilerplate.3-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-first-frame" class="xref">First-Frame</a><a href="#section-boilerplate.3-1.6.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.6">
                <p id="section-boilerplate.3-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-consecutive-frame" class="xref">Consecutive-Frame</a><a href="#section-boilerplate.3-1.6.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="toc ulEmpty" id="section-boilerplate.3-1.6.2.7">
                <p id="section-boilerplate.3-1.6.2.7.1"><a href="#section-6.7" class="xref">6.7</a>.  <a href="#name-flow-control-frame" class="xref">Flow-Control-Frame</a><a href="#section-boilerplate.3-1.6.2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.7">
            <p id="section-boilerplate.3-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-frame-format-2" class="xref">Frame Format</a><a href="#section-boilerplate.3-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.8">
            <p id="section-boilerplate.3-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-ethernet-border-translator" class="xref">Ethernet Border Translator</a><a href="#section-boilerplate.3-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.9">
            <p id="section-boilerplate.3-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-boilerplate.3-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.10">
            <p id="section-boilerplate.3-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-boilerplate.3-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.11">
            <p id="section-boilerplate.3-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-reference-implementation" class="xref">Reference Implementation</a><a href="#section-boilerplate.3-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.12">
            <p id="section-boilerplate.3-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-boilerplate.3-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="toc ulEmpty" id="section-boilerplate.3-1.13">
            <p id="section-boilerplate.3-1.13.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a><a href="#section-boilerplate.3-1.13.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Controller Area Network (CAN) is mostly known for its use in the automotive domain.  However, it is also used in industrial applications as CANopen, building automation and many more.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">It is a two-wire wired-AND multi-master bus that uses CSMA/CR in its arbitration field.  CAN uses 11-bit (standard ID) and 29-bit (extended ID) identifiers to identify frames.  The maximum payload data size is 8 octets for classical CAN and 64 octets for CAN-FD.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The minimal MTU of IPv6 is 1280 octets, and therefore, a mechanism to support a larger payload is needed.  This document uses a slightly modified version of the ISO-TP protocol to transfer data up to 4095 octets per packet.  Mapping addresses to identifiers uses an addressing scheme with a 14-bit source address, a 14-bit destination address, and a multicast bit.  This scheme uses extended identifiers only.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">To make data transfer more efficient IPHC <span>[<a href="#RFC6282" class="xref">RFC6282</a>]</span> is used.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Due to the limited address space of 14 bits, random address generation would generate duplicate addresses with an unacceptably high probability.  For this reason, a link-layer duplicate address detection is introduced to resolve address conflicts.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">An Ethernet border translator is designed to connect a 6LoCAN bus segment to other networks.<a href="#section-1-6" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">NOT RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="controller-area-network-overview">
<section id="section-1.2">
        <h3 id="name-controller-area-network-ove">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-controller-area-network-ove" class="section-name selfRef">Controller Area Network Overview</a>
        </h3>
<p id="section-1.2-1">This section provides a brief overview of Controller Area Network (CAN), as specified in [ISO 11898-1:2015].  CAN has two wires, CAN High and CAN Low, where CAN High is tied to 5V and CAN Low to 0V when transmitting a dominant (0) bit.  Both wires are at the same level (approximately 2.5V) when transmitting a recessive (1) bit.  Because of the wired-AND structure, a dominant bit overrides a recessive bit.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">To resolve collisions in the arbitration field, a CAN controller checks for overridden recessive bits.  The sender that was sending the recessive bit then stops the transmission.  Therefore an identifier with all zeros has the highest priority.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">CAN controllers are usually able to filter frames by identifiers and only pass frames where the filter matches.  The identifiers can be masked in order to define which bits of the identifier must match and which ones are ignored.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iso-tp-overview">
<section id="section-1.3">
        <h3 id="name-iso-tp-overview">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-iso-tp-overview" class="section-name selfRef">ISO-TP Overview</a>
        </h3>
<p id="section-1.3-1">A subset of ISO-TP (ISO 15765-2) is used to fragment and reassemble the packets.  This subset of ISO-TP can send packets with a payload size of up to 4095 octets, enough for IPv6 minimum MTU size of 1280 octets.  ISO-TP is designed for CAN and its small payload data size and therefore preferred over <span>[<a href="#RFC4944" class="xref">RFC4944</a>]</span> fragmentation.<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.3-2">The 6LoWPAN fragmentation would use more than the half of the available payload for the fragmentation headers.  This fact prevents 6LoWPAN fragmentation from being used for 6LoCAN.<a href="#section-1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="addressing">
<section id="section-2">
      <h2 id="name-addressing">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-addressing" class="section-name selfRef">Addressing</a>
      </h2>
<p id="section-2-1">This section provides information about the 14-bit node address to CAN identifier mapping.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">Because CAN uses identifiers to identify the frame's content, an addressing scheme is introduced to map node addresses to identifiers.  Every node has a unique 14-bit address. This address is assigned either statically or randomly.  The addressing scheme uses the 29-bit extended identifier only. It is a combination of a source address, a destination address, and a multicast bit.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The address 0x3DFE is reserved for link-layer duplicate address detection, and address 0x3DF0 is reserved for the Ethernet border translator.  Addresses from 0x0100 to 0x3DEF are used as node addresses.  Other addresses (0x0000 to 0x00FF and 0x3DF0 to 0x3FFF) are reserved or used for special purposes.  Note that a lower address number has a higher priority on the bus.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">6LoCAN does not use the 11-bit standard identifiers. They may be used for other purposes.<a href="#section-2-4" class="pilcrow">¶</a></p>
<span id="name-address-ranges"></span><div id="tab-address-ranges">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-address-ranges" class="selfRef">Address ranges </a>
        </caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Address</th>
            <th class="text-left" rowspan="1" colspan="1">Description</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0x3DFE - 0x3FFF</td>
            <td class="text-left" rowspan="1" colspan="1">Reserved</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0x3DFE</td>
            <td class="text-left" rowspan="1" colspan="1">LLDAD</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0x3DF1 - 0x3DFD</td>
            <td class="text-left" rowspan="1" colspan="1">Reserved</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0x3DF0</td>
            <td class="text-left" rowspan="1" colspan="1">Ethernet Translator</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0x0100 - 0x3DEF</td>
            <td class="text-left" rowspan="1" colspan="1">Node addresses</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">0x0000 - 0x00FF</td>
            <td class="text-left" rowspan="1" colspan="1">Reserved</td>
          </tr>
        </tbody>
      </table>
</div>
<span id="name-addressing-scheme"></span><div id="fig-identifier-layout">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-2-6.1">
<pre> 0|0            1|1            2|
 0|1            4|5            8|
+-+--------------+--------------+
|M|     DEST     |     SRC      |
+-+--------------+--------------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-addressing-scheme" class="selfRef">Addressing Scheme </a>
        </figcaption></figure>
</div>
<p id="section-2-7">M : Multicast.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">DEST : Destination Address (14 bits).<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">SRC : Source Address (14 bits).<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">For example, a destination of 0x3055 and source address of 0x3AAF result in the following identifier:<a href="#section-2-10" class="pilcrow">¶</a></p>
<span id="name-unicast-identifier-example"></span><div id="fig-unicast-id">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-2-11.1">
<pre> 0|0            1|1            2|
 0|1            4|5            8|
+-+--------------+--------------+
|0|11000001010101|11101010101111|
+-+--------------+--------------+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-unicast-identifier-example" class="selfRef">Unicast identifier example </a>
        </figcaption></figure>
</div>
<p id="section-2-12">A multicast group of 1 and a source address of 0x3AAF result in the following identifier:<a href="#section-2-12" class="pilcrow">¶</a></p>
<span id="name-multicast-identifier-exampl"></span><div id="fig-bulticast-id">
<figure id="figure-3">
        <div class="artwork art-text alignLeft" id="section-2-13.1">
<pre> 0|0            1|1            2|
 0|1            4|5            8|
+-+--------------+--------------+
|1|00000000000001|11101010101111|
+-+--------------+--------------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-multicast-identifier-exampl" class="selfRef">Multicast identifier example </a>
        </figcaption></figure>
</div>
<div id="unicast">
<section id="section-2.1">
        <h3 id="name-unicast">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-unicast" class="section-name selfRef">Unicast</a>
        </h3>
<p id="section-2.1-1">For unicast packets, the multicast bit is set to zero, and the 14-bit source address is the address of the sender.  The 14-bit destination address of the receiver is discovered by IPv6 NDP defined in <span>[<a href="#RFC4861" class="xref">RFC4861</a>]</span>.  Every node MUST be able to receive all frames targeting its address as the destination address.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="multicast">
<section id="section-2.2">
        <h3 id="name-multicast">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-multicast" class="section-name selfRef">Multicast</a>
        </h3>
<p id="section-2.2-1">For multicast packets, the multicast bit is set to one, and the 14-bit source address is the address of the sender.  The 14-bit destination address is the last 14 bits of the multicast group.  Every node MUST be able to receive all frames matching the last 14 bits of all joined multicast groups as the destination address.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="address-generation">
<section id="section-2.3">
        <h3 id="name-address-generation">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-address-generation" class="section-name selfRef">Address Generation</a>
        </h3>
<p id="section-2.3-1">Every node has a 14-bit address. This address MUST be unique within the CAN bus segment.  The address can either be statically defined or assigned randomly.  For the random address assignment, the node tries randomly chosen addresses until the link-layer duplicate address detection succeeds.  The link-layer duplicate address detection prevents nodes from assigning an address already in use.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="link-layer-duplicate-address-detection">
<section id="section-3">
      <h2 id="name-link-layer-duplicate-addres">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-link-layer-duplicate-addres" class="section-name selfRef">Link-Layer Duplicate Address Detection</a>
      </h2>
<p id="section-3-1">This section provides information about how to perform link-layer duplicate address detection (LLDAD).<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">LLDAD is introduced to prevent collisions of CAN identifiers and makes it possible to use random address assignment with only 14 bits of address space.  To perform an LLDAD, a LLDAD-request is sent. If there is no DAD-response sent back, the DAD is considered successful.  The node MUST wait for a response for at least 100ms.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">LLDAD-requests are remote transmission request (RTR) frames with the desired address as the destination and 14 bits entropy as the source address.  The entropy prevents identifier collisions when nodes are trying to get the same address at the same time.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">DAD-responses are data-frames sent to the LLDAD address (0x3DFE) with the responder's address as the source address.  Both LLDAD-request and DAD-response have a data length of zero.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">The node MUST be configured to receive RTR frames with the desired address as the destination address before the LLDAD-request is sent and frames with the LLDAD address as long as the LLDAD is in progress. This prevents from assigning the same address to more than one node when sending the LLDAD-request at the same time.  The ability to receive RTR frames with the desired address as the destination address MUST be kept as long as the node uses the address.  The response to LLDAD-requests that matches the node address MUST be sent before the requesting node stops waiting for the response, which is 100ms.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6"><a href="#fig-dad-fail" class="xref">Figure 4</a> shows a DAD Fail example where node A performs a LLDAD-request on address 0x3055 where this address is already in use by node B.<a href="#section-3-6" class="pilcrow">¶</a></p>
<span id="name-dad-fail-example"></span><div id="fig-dad-fail">
<figure id="figure-4">
        <div class="artwork art-text alignCenter" id="section-3-7.1">
<pre>     Node A            Node B
       |--LLDAD-request-&gt;|
       |                 |
       |&lt;-LLDAD-response-|

LLDAD-request identifier:
This frame is a Remote Transmission Request (RTR)
|0|0            1|1            2|
|0|1            4|5            8|
+-+--------------+--------------+
|0|11000001010101|   entropy    |
+-+--------------+--------------+

DAD-response identifier:
|0|0            1|1            2|
|0|1            4|5            8|
+-+--------------+--------------+
|0|11110111111110|11000001010101|
+-+--------------+--------------+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-dad-fail-example" class="selfRef">DAD Fail example </a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="stateless-address-autoconfiguration">
<section id="section-4">
      <h2 id="name-stateless-address-autoconfi">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-stateless-address-autoconfi" class="section-name selfRef">Stateless Address Autoconfiguration</a>
      </h2>
<p id="section-4-1">This section defines how to obtain an IPv6 Interface Identifier.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">It is RECOMMENDED to form an IID derived from the node's address. IIDs generated from the node address result in most efficient IPHC header compression.  However, IIDs MAY also be generated from other sources.  The general procedure for creating an IID is described in Appendix A of <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span>, "Creating Modified EUI-64 Format Interface Identifiers", as updated by <span>[<a href="#RFC7136" class="xref">RFC7136</a>]</span>.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">The Interface Identifier for link-local addresses SHOULD be formed by concatenating the node's 14-bit address to the six octets 0x00, 0x00, 0x00, 0xFF, 0xFE, 0x00 and two bits 0b00.  For example, an address of hexadecimal value 0x3AAF results in the following IID:<a href="#section-4-3" class="pilcrow">¶</a></p>
<span id="name-iid-from-address-0x3aaf"></span><div id="fig-generate-iid">
<figure id="figure-5">
        <div class="artwork art-text alignLeft" id="section-4-4.1">
<pre>|0              1|1              3|3              4|4              6|
|0              5|6              1|2              7|8              3|
+----------------+----------------+----------------+----------------+
|0000000000000000|0000000011111111|1111111000000000|0011101010101111|
+----------------+----------------+----------------+----------------+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-iid-from-address-0x3aaf" class="selfRef">IID from Address 0x3AAF </a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="ipv6-link-local-address">
<section id="section-5">
      <h2 id="name-ipv6-link-local-address">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-ipv6-link-local-address" class="section-name selfRef">IPv6 Link-Local Address</a>
      </h2>
<p id="section-5-1">The IPv6 link-local address <span>[<a href="#RFC4291" class="xref">RFC4291</a>]</span> for a 6LoCAN interface is formed by appending the Interface Identifier, as defined above, to the prefix FE80::/64.<a href="#section-5-1" class="pilcrow">¶</a></p>
<span id="name-link-local-address-from-iid"></span><div id="fig-link-loca-address">
<figure id="figure-6">
        <div class="artwork art-text alignLeft" id="section-5-2.1">
<pre>  10 bits            54 bits                  64 bits
+----------+-----------------------+----------------------------+
|1111111010|         (zeros)       |    Interface Identifier    |
+----------+-----------------------+----------------------------+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-link-local-address-from-iid" class="selfRef">Link-Local address from IID </a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="iso-tp">
<section id="section-6">
      <h2 id="name-iso-tp">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iso-tp" class="section-name selfRef">ISO-TP</a>
      </h2>
<p id="section-6-1">This section provides information about the use of ISO-TP (ISO 15765-2) in this document.  Parts of ISO-TP are used to provide a reliable way for sending up to 4095 octets as a packet.  It includes a flow-control mechanism for unicast-packets and timeouts.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">Multicast packets do not use any flow-control mechanism and are therefore not covered by the ISO-TP standard.  However, the fragmentation and reassembly mechanism is still used for multicast packets.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">ISO-TP defines four different types of frames: Single-Frames (SF), First-Frames (FF), Consecutive-Frames (CF), and Flow Control Frames (FC).  Single-Frames are used when the payload data size is small enough to fit into a single CAN frame.  For larger payload data sizes, a First-Frame indicates the start of the message, Consecutive-Frames carry the payload data and Flow Control Frames steer the transmission.  Network address extension and packet size larger than 4095 octets defined by ISO 15765-2 MUST NOT be used for 6LoCAN.  Single-Frame packets are only useful for CAN-FD because the eight octets of classical CAN are too small for any IPv6 header.<a href="#section-6-3" class="pilcrow">¶</a></p>
<div id="multicast-1">
<section id="section-6.1">
        <h3 id="name-multicast-2">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-multicast-2" class="section-name selfRef">Multicast</a>
        </h3>
<p id="section-6.1-1">Multicast packets MUST be transferred in a Single-Frame when the packet fits in a single frame.  Multicast packets that are too big for Single-Frames start with a First-Frame (FF).  The FF contains information about the entire payload data size and payload data bytes to fill the rest of the remaining frame.  The First-Frame is followed by a break of 1 millisecond to allow the receivers to prepare for the data reception.  Consecutive-Frames carry the rest of the payload data and a 4-bit sequence number to detect missing or out of order frames.  The number of Consecutive-Frames depends on the CAN frame data size and the payload data size.  Consecutive-Frames SHALL have the maximum possible CAN data size.  The last Consecutive-Frame may have to include padding at the end.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<span id="name-multicast-packet-sequence"></span><div id="fig-multicast-sequence">
<figure id="figure-7">
          <div class="artwork art-text alignCenter" id="section-6.1-2.1">
<pre>Sender   Multicast Listener
  |-----FF----&gt;|
  |  I 1 ms I  |
  |----CF 1---&gt;|
  |----CF 2---&gt;|
  |     .      |
  |     .      |
  |----CF n---&gt;|
  |            |
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-multicast-packet-sequence" class="selfRef">Multicast packet sequence </a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="unicast-1">
<section id="section-6.2">
        <h3 id="name-unicast-2">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-unicast-2" class="section-name selfRef">Unicast</a>
        </h3>
<p id="section-6.2-1">Unicast transfers use the same format for First-Frames and Consecutive-Frames as the multicast transfer does.  In contrast to multicast, unicast transfers use Flow-Control-Frames to steer the sender's behavior and signalize readiness.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The receiver can choose a block size and a minimum separation time (ST min).<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">The block size (BS) defines how many frames are transmitted before the sender MUST wait for another FC Frame.  A zero BS is allowed and denotes that the sender MUST NOT wait for another FC Frame.  ST min defines the minimal pause between the end of the previous frame and the start of the next frame.  The receiver MAY change BS and ST min for following FC Frames.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">The receiver MUST answer a FF within 1 second. After this timeout the sender SHOULD abort and stop waiting for an FC frame.  CF frames MUST have a separation time less than or equal to one second. After this timeout, a receiver SHOULD abort and stop waiting for CF.  Receivers and sender SHOULD handle more than one packet reception from different peers at the same time.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<span id="name-unicast-packet-sequence"></span><div id="fig-unicast-sequence">
<figure id="figure-8">
          <div class="artwork art-text alignCenter" id="section-6.2-5.1">
<pre>Sender      Receiver
  |-----FF----&gt;|
  |            |
  |&lt;----FC-----|
  |            |
  |----CF 1---&gt;|
  | I ST min I |
  |----CF 2---&gt;|
  |      .     |
  |      .     |
  |---CF BS---&gt;|
  |            |
  |&lt;----FC-----|
  |            |
  |--CF BS+1--&gt;|
  | I ST min I |
  |--CF BS+2--&gt;|
  |      .     |
  |      .     |
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-unicast-packet-sequence" class="selfRef">Unicast packet sequence.  </a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="frame-format">
<section id="section-6.3">
        <h3 id="name-frame-format">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-frame-format" class="section-name selfRef">Frame Format</a>
        </h3>
<p id="section-6.3-1">The frame format of ISO-TP is described in this section.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">The first 4 bits denote the Protocol Control Information (PCI).  This information is used to distinguish the different frame types.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<span id="name-iso-tp-frame-format"></span><div id="fig-iso-tp-frame-format">
<figure id="figure-9">
          <div class="artwork art-text alignLeft" id="section-6.3-3.1">
<pre>|0  0|0
|0  3|4
+----+-----
|PCI |
+----+-----
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-iso-tp-frame-format" class="selfRef">ISO-TP Frame format </a>
          </figcaption></figure>
</div>
<span id="name-pci-numbers"></span><div id="tab-pci-numbers">
<table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-pci-numbers" class="selfRef">PCI Numbers </a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Number</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">Single-Frame</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">First-Frame</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">Consecutive-Frame</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">Flow-Control-Frame</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">4-15</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="single-frame">
<section id="section-6.4">
        <h3 id="name-single-frame">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-single-frame" class="section-name selfRef">Single-Frame</a>
        </h3>
<p id="section-6.4-1">The Single-Frame PCI is 0, and the rest of the octet is padded with 0.  This format is compatible with ISO-TP with data size greater than 16 octets.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<span id="name-single-frame-format"></span><div id="fig-single-frame">
<figure id="figure-10">
          <div class="artwork art-text alignLeft" id="section-6.4-2.1">
<pre>|0  0|0  0|       1|1
|0  3|4  7|       5|6
+----+----+--------+--------
|0000|0000|  Size  | Data
+----+----+--------+--------
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-single-frame-format" class="selfRef">Single-Frame Format </a>
          </figcaption></figure>
</div>
<p id="section-6.4-3">Size : Number of payload data octets.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="first-frame">
<section id="section-6.5">
        <h3 id="name-first-frame">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-first-frame" class="section-name selfRef">First-Frame</a>
        </h3>
<p id="section-6.5-1">The First-Frame PCI is 1, and the remaining 4-bit nibble of the first byte carries the upper 4-bit nibble of the payload data length.  The second byte contains the lower byte of the payload data length. The rest of the frame is filled with payload data.  The First-Fame MUST have a data length of the maximum CAN data length.  For example, classic CAN has a maximum data length of 8 octets, and therefore six payload bytes are included in the FF.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<span id="name-first-frame-format"></span><div id="fig-first-frame">
<figure id="figure-11">
          <div class="artwork art-text alignLeft" id="section-6.5-2.1">
<pre>|0  0|0           1|1
|0  3|4           5|6
+----+-------------+-------
|0001|    Size     | Data
+----+-------------+-------
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-first-frame-format" class="selfRef">First-Frame Format </a>
          </figcaption></figure>
</div>
<p id="section-6.5-3">Size : Number of payload data octets<a href="#section-6.5-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="consecutive-frame">
<section id="section-6.6">
        <h3 id="name-consecutive-frame">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-consecutive-frame" class="section-name selfRef">Consecutive-Frame</a>
        </h3>
<p id="section-6.6-1">The Consecutive-Frame PCI is two, and the remaining 4-bit nibble of the first byte carries an index.  This index starts with one for the first CF and wraps around at 16. Then it starts at 0 again.  The index is used to check for lost or out of order frames. When the index is not sequential, the reception MUST be aborted.  The last Consecutive-Frame may have to include padding at the end to obtain a valid data length for CAN-FD frames.  The RECOMMENDED padding value is 0xCC.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<span id="name-consecutive-frame-format"></span><div id="fig-consecutive-frame">
<figure id="figure-12">
          <div class="artwork art-text alignLeft" id="section-6.6-2.1">
<pre>|0  0|0  0|0
|0  3|4  7|8
+----+----+---------
|0010|Idx | Data
+----+----+---------
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-consecutive-frame-format" class="selfRef">Consecutive-Frame Format </a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="flow-control-frame">
<section id="section-6.7">
        <h3 id="name-flow-control-frame">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-flow-control-frame" class="section-name selfRef">Flow-Control-Frame</a>
        </h3>
<p id="section-6.7-1">The Flow-Control-Frame PCI is three, and the remaining 4-bit nibble of the first byte carries a Flow-State (FS). The second byte is the block size, and the third byte is the ST min.  The Flow-States are:<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<span id="name-flow-state"></span><div id="tab-flow-state">
<table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-flow-state" class="selfRef">Flow-State </a>
          </caption>
<thead>
            <tr>
              <th class="text-center" rowspan="1" colspan="1">Number</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">CTS (Continue To Send)</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">WAIT</td>
            </tr>
            <tr>
              <td class="text-center" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">OVFLW (Overflow)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-6.7-3">CTS advises the sender to continue sending CF frames.<a href="#section-6.7-3" class="pilcrow">¶</a></p>
<p id="section-6.7-4">WAIT resets the timeout for receiving an FC frame on the sender side. The sender SHOULD only accept a limited number of wait states and silently abort when reaching the limit.<a href="#section-6.7-4" class="pilcrow">¶</a></p>
<p id="section-6.7-5">OVFLW is sent when the receiver is running out of resources and can't handle the packet. The sender MUST abort when receiving an OVFLW Flow-State.<a href="#section-6.7-5" class="pilcrow">¶</a></p>
<span id="name-flow-control-frame-format"></span><div id="fig-flow-control-frame">
<figure id="figure-13">
          <div class="artwork art-text alignLeft" id="section-6.7-6.1">
<pre>|0  0|0  0|       1|1      2|
|0  3|4  7|       5|6      3|
+----+----+--------+--------+
|0011| FS |   BS   | ST min |
+----+----+--------+--------+
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-flow-control-frame-format" class="selfRef">Flow-Control-Frame Format </a>
          </figcaption></figure>
</div>
<p id="section-6.7-7">FS : Frame State<a href="#section-6.7-7" class="pilcrow">¶</a></p>
<p id="section-6.7-8">BS : Block Size<a href="#section-6.7-8" class="pilcrow">¶</a></p>
<p id="section-6.7-9">ST min : Minimal Separation Time<a href="#section-6.7-9" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-frame-format">
<section id="section-7">
      <h2 id="name-frame-format-2">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-frame-format-2" class="section-name selfRef">Frame Format</a>
      </h2>
<p id="section-7-1">This section provides information about data arrangement in the frame data field.<a href="#section-7-1" class="pilcrow">¶</a></p>
<span id="name-6locan-frame-format"></span><div id="fig-frame-format">
<figure id="figure-14">
        <div class="artwork art-text alignLeft" id="section-7-2.1">
<pre>+----------------------------+-------------------------------------+
| ISO-TP Header (1-3 octets) | Dispatch + LOWPAN_IPHC (2-3 octets) | 
+----------------------------+-------------+-----------------------+
| In-line IPv6 Header Fields (0-38 octets) | Payload 
+------------------------------------------+----------
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-6locan-frame-format" class="selfRef">6LoCAN Frame Format </a>
        </figcaption></figure>
</div>
<p id="section-7-3">Packets with a destination or source address of the 0x3DF0 (Translator address) carry the Ethernet MAC address inline directly after the ISO-TP Header.  For packets destined for the translator, it is the destination MAC address, and for packets originated by the translator, it is the source MAC address.<a href="#section-7-3" class="pilcrow">¶</a></p>
<span id="name-6locan-translator-frame-for"></span><div id="fig-frame-format-translator">
<figure id="figure-15">
        <div class="artwork art-text alignLeft" id="section-7-4.1">
<pre>+----------------------------+--------------------------------+
| ISO-TP Header (1-3 octets) | Ethernet MAC Address (48 bits) |
+----------------------------+-------+------------------------+
| Dispatch + LOWPAN_IPHC (2-3 octets) |
+------------------------------------+-----+----------
| In-line IPv6 Header Fields (0-38 octets) | Payload 
+------------------------------------------+----------
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-6locan-translator-frame-for" class="selfRef">6LoCAN Translator Frame Format </a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="ethernet-border-translator">
<section id="section-8">
      <h2 id="name-ethernet-border-translator">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-ethernet-border-translator" class="section-name selfRef">Ethernet Border Translator</a>
      </h2>
<p id="section-8-1">This section provides information about translating 6LoCAN packets to Ethernet frames.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The Ethernet Border Translator connects 6LoCAN bus-segments either to other 6LoCAN bus-segments or other technologies.  Ethernet is a widely used technology that provides enough bandwidth to connect several 6LoCAN segments.  A mechanism like the 6LBR is not necessary because there is no routing on 6LoCAN segments.  To provide routing or switching capabilities, the Ethernet Border Translator connects a 6LoCAN network to such devices via Ethernet.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Bus segments MUST NOT have more than one translator. The translator has a fixed node address (0x3DF0) and a range of Ethernet MAC addresses.  Every packet sent to this node address or any multicast address is forwarded to Ethernet.  Every Ethernet frame matching the MAC address range and every multicast Ethernet frame is forwarded to the 6LoCAN bus-segment.<a href="#section-8-3" class="pilcrow">¶</a></p>
<p id="section-8-4">For translating a 6LoCAN packet to an Ethernet frame, the source address is extended with the first 34 bits of the translator MAC address and the IPHC compressed headers are decompressed.  The destination MAC is carried in-line before the compressed IPv6 header (see <a href="#sec-frame-format" class="xref">Section 7</a>, <a href="#fig-frame-format-translator" class="xref">Figure 15</a>).  ICMPv6 messages MUST be checked for Link-Layer Address Options (LLAO), and if an LLAO is present, it MUST be changed to the extended link-layer address.  For translating Ethernet frames to 6LoCAN packets, the source MAC address is carried in-line, the destination node address is the last 14 bits of the MAC address, and the IPv6 headers are compressed using IPHC.<a href="#section-8-4" class="pilcrow">¶</a></p>
<p id="section-8-5">For multicast Ethernet frames, the last 14 bits of the multicast group is the destination address, and the multicast bit is set. The destination address MAY also be reconstructed from the destination multicast address.  The destination Ethernet MAC address is formed from the destination IP address as described in <span>[<a href="#RFC2464" class="xref">RFC2464</a>]</span> section 7.<a href="#section-8-5" class="pilcrow">¶</a></p>
<p id="section-8-6">If the translator includes a network stack, the translator MUST NOT use a MAC address within the ranges used for translation, with the following exception: The translator MAY use the extended MAC address that corresponds to the translator node address.<a href="#section-8-6" class="pilcrow">¶</a></p>
<p id="section-8-7"><a href="#fig-translator-setup" class="xref">Figure 18</a> shows an example setup of a 6LoCAN segment connected to an Ethernet network.<a href="#section-8-7" class="pilcrow">¶</a></p>
<p id="section-8-8"><a href="#fig-unicast-mac-translation" class="xref">Figure 16</a> shows a translation from Ethernet MAC to CAN identifier.  The source (src) MAC address is carried in-line in the CAN frame data.  The translator MAC address for this example is 02:00:5E:10:3D:F0.<a href="#section-8-8" class="pilcrow">¶</a></p>
<span id="name-example-address-translation"></span><div id="fig-unicast-mac-translation">
<figure id="figure-16">
        <div class="artwork art-text alignLeft" id="section-8-9.1">
<pre>|0                            4|4                              9
|0                            7|8                              5
+------------------------------+-------------------------------+
| dest MAC (02:00:5E:10:30:55) |  src MAC (02:00:5E:10:00:FF)  |
+------------------------------+-------------------------------+
                          Ethernet MAC

|0|0            1|1            2|
|0|1            4|5            8|
+-+--------------+--------------+
|0|dest (0x3055) | src (0x3DF0) |
+-+--------------+--------------+
            CAN identifier
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-example-address-translation" class="selfRef">Example address translation from Ethernet MAC to CAN identifier.  </a>
        </figcaption></figure>
</div>
<p id="section-8-10"><a href="#fig-multicast-mac-translation" class="xref">Figure 17</a> shows a translation from a multicast Ethernet MAC to CAN identifier.  The source MAC address is carried in-line in the CAN frame data.<a href="#section-8-10" class="pilcrow">¶</a></p>
<span id="name-example-address-translation-"></span><div id="fig-multicast-mac-translation">
<figure id="figure-17">
        <div class="artwork art-text alignLeft" id="section-8-11.1">
<pre>|0                            4|4                             9|
|0                            7|8                             5|
+------------------------------+-------------------------------+
| dest MAC (33:33:00:01:00:01) |  src MAC (02:00:5E:10:00:FF)  |
+------------------------------+-------------------------------+
                          Ethernet MAC

|0|0            1|1            2|
|0|1            4|5            8|
+-+--------------+--------------+
|1|dest (0x0001) | src (0x3DF0) |
+-+--------------+--------------+
            CAN identifier
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-example-address-translation-" class="selfRef">Example address translation from Ethernet to CAN for multicast Frames.  </a>
        </figcaption></figure>
</div>
<p id="section-8-12"><a href="#fig-unicast-id-translation" class="xref">Section 8</a> shows a translation CAN identifier to Ethernet MAC.  The destination (dest) MAC address is carried inline in the CAN frame data.  The translator MAC address for this example is 02:00:5E:10:3D:F0.<a href="#section-8-12" class="pilcrow">¶</a></p>
<div id="fig-unicast-id-translation">
<div class="artwork art-text alignLeft" id="section-8-13">
<pre>|0|0            1|1            2|
|0|1            4|5            8|
+-+--------------+--------------+
|0|dest (0x3DF0) | src (0x3055) |
+-+--------------+--------------+
            CAN identifier
|0                            4|4                             9|
|0                            7|8                             5|
+------------------------------+-------------------------------+
| dest MAC (02:00:5E:10:00:FF) |  src MAC (02:00:5E:10:30:55)  |
+------------------------------+-------------------------------+
                          Ethernet MAC
</pre><a href="#section-8-13" class="pilcrow">¶</a>
</div>
</div>
<span id="name-example-setup-with-ethernet"></span><div id="fig-translator-setup">
<figure id="figure-18">
        <div class="artwork art-text alignCenter" id="section-8-14.1">
<pre>                                          +-----+  +-----+
                                          |CAN  |  |CAN  |  ...
                                          |node |  |node |
                                          +--+--+  +--+--+
+--------+---+     +---+----------+---+      |        |
|        |   |     |   |Ethernet  |   |      |        |
| Switch |ETH|&lt;---&gt;|ETH|Border    |CAN|------+--------+---- ...
|        |   |     |   |Translator|   |
+--------+---+     +---+----------+---+
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-example-setup-with-ethernet" class="selfRef">Example setup with Ethernet Border Translator </a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-9-1">The MAC addresses generated by extending the node's address may be randomly generated and, therefore, MUST NOT set the UAA-bit.<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-considerations">
<section id="section-10">
      <h2 id="name-security-considerations">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-10-1">This document doesn't provide any security mechanisms.  Traffic on the bus can be intersected, spoofed, or destroyed.  For confidentiality and integrity, mechanisms like TLS or IPsec need to be applied.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">The small 14-bit node address space makes it hard to track nodes globally and therefore has inherent privacy properties.<a href="#section-10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reference-implementation">
<section id="section-11">
      <h2 id="name-reference-implementation">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-reference-implementation" class="section-name selfRef">Reference Implementation</a>
      </h2>
<p id="section-11-1">As a reference, this standard proposal is implemented in the Zephyr RTOS from version 2.0 ongoing.  This implementation can be tested with the overlay-6locan.conf on echo<em>server and echo</em>client application.<a href="#section-11-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-12">
      <h2 id="name-normative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC2464">[RFC2464]</dt>
      <dd>
<span class="refAuthor">Crawford, M.</span>, <span class="refTitle">"Transmission of IPv6 Packets over Ethernet Networks"</span>, <span class="seriesInfo">RFC 2464</span>, <span class="seriesInfo">DOI 10.17487/RFC2464</span>, <time datetime="1998-12">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2464">https://www.rfc-editor.org/info/rfc2464</a>&gt;</span>. </dd>
<dt id="RFC4291">[RFC4291]</dt>
      <dd>
<span class="refAuthor">Hinden, R.</span><span class="refAuthor"> and S. Deering</span>, <span class="refTitle">"IP Version 6 Addressing Architecture"</span>, <span class="seriesInfo">RFC 4291</span>, <span class="seriesInfo">DOI 10.17487/RFC4291</span>, <time datetime="2006-02">February 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4291">https://www.rfc-editor.org/info/rfc4291</a>&gt;</span>. </dd>
<dt id="RFC4861">[RFC4861]</dt>
      <dd>
<span class="refAuthor">Narten, T.</span><span class="refAuthor">, Nordmark, E.</span><span class="refAuthor">, Simpson, W.</span><span class="refAuthor">, and H. Soliman</span>, <span class="refTitle">"Neighbor Discovery for IP version 6 (IPv6)"</span>, <span class="seriesInfo">RFC 4861</span>, <span class="seriesInfo">DOI 10.17487/RFC4861</span>, <time datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4861">https://www.rfc-editor.org/info/rfc4861</a>&gt;</span>. </dd>
<dt id="RFC4944">[RFC4944]</dt>
      <dd>
<span class="refAuthor">Montenegro, G.</span><span class="refAuthor">, Kushalnagar, N.</span><span class="refAuthor">, Hui, J.</span><span class="refAuthor">, and D. Culler</span>, <span class="refTitle">"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"</span>, <span class="seriesInfo">RFC 4944</span>, <span class="seriesInfo">DOI 10.17487/RFC4944</span>, <time datetime="2007-09">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4944">https://www.rfc-editor.org/info/rfc4944</a>&gt;</span>. </dd>
<dt id="RFC6282">[RFC6282]</dt>
      <dd>
<span class="refAuthor">Hui, J., Ed.</span><span class="refAuthor"> and P. Thubert</span>, <span class="refTitle">"Compression Format for IPv6 Datagrams over IEEE 802.15.4-Based Networks"</span>, <span class="seriesInfo">RFC 6282</span>, <span class="seriesInfo">DOI 10.17487/RFC6282</span>, <time datetime="2011-09">September 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6282">https://www.rfc-editor.org/info/rfc6282</a>&gt;</span>. </dd>
<dt id="RFC7136">[RFC7136]</dt>
      <dd>
<span class="refAuthor">Carpenter, B.</span><span class="refAuthor"> and S. Jiang</span>, <span class="refTitle">"Significance of IPv6 Interface Identifiers"</span>, <span class="seriesInfo">RFC 7136</span>, <span class="seriesInfo">DOI 10.17487/RFC7136</span>, <time datetime="2014-02">February 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7136">https://www.rfc-editor.org/info/rfc7136</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
    <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
</dl>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Alexander Wachter</span></div>
<div dir="auto" class="left"><span class="org">Graz University of Technology</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:alexander@wachter.cloud" class="email">alexander@wachter.cloud</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
