



Internet Engineering Task Force                          SudhinJacob
Internet-Draft                                          Kishore Tiruveedhula
Intended status: Standards Track                        Juniper Networks
Expires: August 2, 2016                                  February 1, 2016


                   Benchmarking Methodology for EVPN
                      draft-kishjac-bmwg-evpntest-00

Abstract

   This document defines the methodologies for benchmarking performance
   of EVPN.  EVPN been implemented with many varying designs in order to
   achieve their intended network functionality.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on August 2, 2016.

Copyright Notice

   Copyright (c) 2016 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.





Jacob & Tiruveedhula     Expires August 2, 2016                 [Page 1]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
     1.1.  Requirements Language . . . . . . . . . . . . . . . . . .   3
   2.  Test Topology . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Network . . . . . . . . . . . . . . . . . . . . . . . . . . .   4
   4.  Test Procedure  . . . . . . . . . . . . . . . . . . . . . . .   5
     4.1.  To check the time taken to learn the mac address in DUT .   5
     4.2.  To check the time taken to flush the mac address  . . . .   5
     4.3.  To check the time taken to flush the local entry due to
           CE link failure . . . . . . . . . . . . . . . . . . . . .   6
     4.4.  To check the time taken to learn 1,00,000 routes from
           remote peer by DUT  . . . . . . . . . . . . . . . . . . .   6
     4.5.  To check the time taken by DUT to flush 1,00,000 routes
           learned from remote PE after stopping the traffic at
           remote PE . . . . . . . . . . . . . . . . . . . . . . . .   7
     4.6.  To check the time taken by DUT to flush 1,00,000 routes
           learned from remote PE after R1 traffic generator link
           failure . . . . . . . . . . . . . . . . . . . . . . . . .   7
     4.7.  To check the time taken by DUT to learn  1,00,000 routes
           from local and 1,00,000 from remote.  . . . . . . . . . .   8
     4.8.  To check the time taken by DUT to flush 1,00,000 routes
           from remote when R1 traffic generator link failure. . . .   8
     4.9.  To check the loop formation due to DF election by adding
           a a MHPE. . . . . . . . . . . . . . . . . . . . . . . . .   9
   5.  Reliability . . . . . . . . . . . . . . . . . . . . . . . . .   9
     5.1.  To check the whether there is traffic loss due to routing
           engine failover for redundancy test.  . . . . . . . . . .   9
     5.2.  To check the whether DF election is taking place properly
           after the one of the MH PE reboot.  . . . . . . . . . . .  10
   6.  Scale . . . . . . . . . . . . . . . . . . . . . . . . . . . .  10
     6.1.  To Scale the DUT to 32k EVI and clear bgp in DUT with out
           traffic.  . . . . . . . . . . . . . . . . . . . . . . . .  10
     6.2.  To Scale the DUT to 32k EVI and clear bgp in DUT with
           traffic. Measure the convergence time . . . . . . . . . .  11
   7.  Soak Test . . . . . . . . . . . . . . . . . . . . . . . . . .  11
     7.1.  To Scale the DUT to 32k EVI in DUT with traffic and run
           the set up for 24hrs  . . . . . . . . . . . . . . . . . .  11
   8.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  12
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  12
   10. Security Considerations . . . . . . . . . . . . . . . . . . .  12
   11. References  . . . . . . . . . . . . . . . . . . . . . . . . .  12
     11.1.  Normative References . . . . . . . . . . . . . . . . . .  12
     11.2.  Informative References . . . . . . . . . . . . . . . . .  12
   Appendix A.  Appendix . . . . . . . . . . . . . . . . . . . . . .  13
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  13





Jacob & Tiruveedhula     Expires August 2, 2016                 [Page 2]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


1.  Introduction

   EVPN which is defined in RFC7432 which describes procedures for BGP
   MPLS-based Ethernet VPNs(EVPN).  This document defines the
   methodologies for benchmarking performance of EVPN.  EVPN been
   implemented with many varying designs in order to achieve their
   intended network functionality.  Hence, the authors have taken the
   approach of considering EVPN as a black box, defining the methodology
   to benchmark the evpn feature using various testing methodologies.

1.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

2.  Test Topology


































Jacob & Tiruveedhula     Expires August 2, 2016                 [Page 3]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


                             Topology Diagram


            | Traffic Generator
   +----------+
   |          |
   |  R1      |
   |          |
   +----------+
       |
       |
   +----------+
   |          |
   |  RR      |
   |          |
   +----------+-------------|
      |                     |
      |                     |
   +----------+       +-----------+
   |          |       |    MHPE2  |
   |   DUT    |       |           |
   |  MHPE1   |       |           |
   +----------+       +-----------+
        |                  |
   +----------+------------
   |          |
   |  CE      |
   |          |
   +----------+------------ Traffic Generator



                             Topology Diagram

                                 Figure 1

3.  Network

   The network consists of 5 routers and 2 traffic generator ports.  UT
   is acting as one of MH PE to CE.  The RR is acting as route reflector
   and core router.R1 is a Single home router running evpn.  All four
   routers except CE are running mpls,bgp.  CE is a dual home connected
   to DUT and MH PE1.  The testing will be done on DUT to bench mark the
   service.  UT and MHPE2 is running EVPN with SA/AA with CE.The DUT and
   and other PE's will be running 100 EVI's(EVPN instances) on 100 sub
   interfaces.





Jacob & Tiruveedhula     Expires August 2, 2016                 [Page 4]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


4.  Test Procedure

   The test defined to bench mark the performance of EVPN mac
   learning,convergence time in link failures,scale scenarios.

4.1.  To check the time taken to learn the mac address in DUT

   Objective:

   To check the time taken to learn the mac address locally and time
   taken to send the locally learned routes to peers.

   a.  Send 1,00,000 unicast frames from CE to MHPE1(DUT) working in SA
       mode with different source and destination address, where DUT is
       the DF so that it can forward the traffic.  Measure the time
       taken to learn these mac in forwarding table and control plane.

   b.  Measure the time taken to send these 1,00,000 type 2 routes from
       DUT to its peers.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
   be configured per IFD/Interface.  Using RT (traffic generator) to
   send the traffic to the routers.  Measurement The DUT mac table must
   learn the 1,00,000 mac address and measure the time taken to send
   1,00,000 routes to its peers by DUT.

4.2.  To check the time taken to flush the mac address

   Objective:

   Send 1,00,000 frames with different SA and DA to DUT from CE using
   traffic generator.  Then wait to learn all 1,00,000 mac address.
   Then stop the traffic.Wait to see how long it takes to flush these
   mac entries due to ageing.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.  For MH PE ESI
   must be configured per IFD/Interface.  Using RT(traffic generator) to
   send the traffic to the routers.

   Measurement:



Jacob & Tiruveedhula     Expires August 2, 2016                 [Page 5]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


   The DUT mac table must learn the 1,00,000 measure the time taken for
   flushing these 1,00,000 mac address due to ageing.

4.3.  To check the time taken to flush the local entry due to CE link
      failure

   Objective:

   Send 1,00,000 frames with different SA and DA to DUT from CE using
   traffic generator.  Then wait to learn all 1,00,000 mac address.
   Then fail the DUT CE link and measure the time taken to flush these
   1,00,000 routes from the mac table and from control plane.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and DUT.
   Once the bgp comes up check the DUT evpn table.  For MH PE ESI must
   be configured per IFD/Interface.  Using RT(traffic generator) to send
   the traffic to the routers.

   Measurement:

   The DUT mac table must learn the 1,00,000 measure the time taken for
   flushing these 1,00,000 mac address.

4.4.  To check the time taken to learn 1,00,000 routes from remote peer
      by DUT

   Objective:

   Send 1,00,000 frames with different SA and DA to DUT from R1 using
   traffic generator.  Measure the time taken to learn these 1,00,000
   routes from remote peer and program the mac address table.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.  For MH PE ESI
   must be configured per IFD/Interface.  Using RT(traffic generator) to
   send the traffic to the routers.

   Measurement:

   The DUT mac table must learn the 1,00,000 measure the time taken to
   learn the 1,00,000 mac address from remote peers.




Jacob & Tiruveedhula     Expires August 2, 2016                 [Page 6]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


4.5.  To check the time taken by DUT to flush 1,00,000 routes learned
      from remote PE after stopping the traffic at remote PE

   Objective:

   Send 1,00,000 frames with different SA and DA to DUT from R1 using
   traffic generator.  After stopping the traffic at remote PE R1
   traffic generator due to mac ageing it will withdraw its routes from
   remote PE's.  Measure the time taken to flush these routes from DUT
   mac table.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
   be configured per IFD/Interface.  Using RT(traffic generator) to send
   the traffic to the routers.

   Measurement:

   Measure the time taken to flush 1,00,000 remote routes from mac table
   of DUT due to ageing.

4.6.  To check the time taken by DUT to flush 1,00,000 routes learned
      from remote PE after R1 traffic generator link failure

   Objective:

   Send 1,00,000 frames with different SA and DA to DUT from R1 using
   traffic generator.  Bring down the link between R1 and traffic
   generator.  Then measure the time taken to flush the DUT mac address
   table.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.  All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
   be configured per IFD/Interface.  Using RT(traffic generator) to send
   the traffic to the routers.

   Measurement:

   Measure the time taken to flush 1,00,000 remote routes from mac table
   of DUT.





Jacob & Tiruveedhula     Expires August 2, 2016                 [Page 7]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


4.7.  To check the time taken by DUT to learn 1,00,000 routes from local
      and 1,00,000 from remote.

   Objective:

   Send 1,00,000 frames with different SA and DA to DUT from R1 using
   traffic generator.  Send 1,00,000 frames with different SA and DA
   from traffic generator connected to CE.  The SA and DA of flows must
   be complimentary to have unicast flows.  Measure the time taken by
   the DUT to learn 2,00,000 in mac table and in control plane.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.  For MH PE ESI
   must be configured per IFD/Interface.  Using RT(traffic generator) to
   send the traffic to the routers.

   Measurement:

   Measure the time taken to learn 2,00,000 routes in control and mac
   address table in DUT

4.8.  To check the time taken by DUT to flush 1,00,000 routes from
      remote when R1 traffic generator link failure.

   Objective:

   Send 1,00,000 frames with different SA and DA to DUT from R1 using
   traffic generator.  Send 1,00,000 frames with different SA and DA
   from traffic generator connected to CE.  The SA and DA of flows must
   be complimentary to have unicast flows.Fail the R1 traffic generator
   link and measure the time taken to flush 2,00,000 routes in DUT mac
   address table.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.  For MH PE ESI
   must be configured per IFD/Interface.  Using RT(traffic generator) to
   send the traffic to the routers.

   Measurement:

   Measure the time taken to flush 1,00,000 routes from control plane
   and mac address table due to remote link failure.



Jacob & Tiruveedhula     Expires August 2, 2016                 [Page 8]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


4.9.  To check the loop formation due to DF election by adding a a MHPE.

   Objective:

   Send 1,00,000 frames from CE to DUT from traffic generator with
   different SA and DA.  Wait to learn all 1,00,000 mac address.  Then
   add R1 to the same Ethernet segment by configuring the same ESI value
   configured in DUT,MHPE2 in IFD.  Then the new DF election take place
   during that time there should not be any loop and measure the time
   taken to come up the new DF.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.  For MH PE ESI
   must be configured per IFD/Interface.  Using RT(traffic generator) to
   send the traffic to the routers.

   Measurement:

   Measure the time taken for new DF election in DUT and there should
   not be any loop or forwarding the BUM traffic back to the same
   segment.

5.  Reliability

5.1.  To check the whether there is traffic loss due to routing engine
      failover for redundancy test.

   Objective:

   Send 1,00,000 frames from CE to DUT from traffic generator with
   different SA and DA.  Send 1,00,000 frames from traffic generator to
   R1 with different SA and DA so that 2,00,000 mac address will be
   learned in DUT.  There is a bi directional traffic flow with 1,00,000
   pps in each direction.  Then do a routing engine failover.
   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
   be configured per IFD/Interface.  Using RT(traffic generator) to send
   the traffic to the routers.

   Measurement:





Jacob & Tiruveedhula     Expires August 2, 2016                 [Page 9]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


   There should not be any traffic loss,No change in the DF role.  No
   withdraw of any routes.

5.2.  To check the whether DF election is taking place properly after
      the one of the MH PE reboot.

   Objective:

   Send 1,00,000 frames from CE to DUT from traffic generator with
   different SA and DA.  Send 1,00,000 frames from traffic generator to
   R1 with different SA and DA so that 2,00,000 mac address will be
   learned in DUT.  There is a bi directional traffic flow with 1,00,000
   pps in each direction.  Then reboot DUT since there are 2 MH PE's the
   other PE will become the DF then after DUT comes back, then DF
   election has to re initiate.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
   be configured per IFD/Interface.  Using RT(traffic generator) to send
   the traffic to the routers.

   Measurement

   The DF election has to take place again once the DUT comes back
   online.There should not be any DF stuck casefor 100 EVI's.

6.  Scale

6.1.  To Scale the DUT to 32k EVI and clear bgp in DUT with out traffic.

   Objective:

   The main purpose of the test the DUT performance to scale 32k EVI's.
   Then clear bgp neighbor.  There should not be any loss of routes or
   any crashes.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
   be configured per IFD/Interface.  Using RT(traffic generator) to send
   the traffic to the routers.

   Measurement



Jacob & Tiruveedhula     Expires August 2, 2016                [Page 10]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


   There should not be any loss of route types 1,2,3 and 4 in DUT.

6.2.  To Scale the DUT to 32k EVI and clear bgp in DUT with traffic.
      Measure the convergence time

   Objective:

   The main purpose of the test the DUT performance to scale 32k EVI's
   with traffic.  Then clear bgp neighbor.  There should not be any loss
   of routes or any crashes.  Send 1,00,000 frames from CE to DUT from
   traffic generator with different SA and DA for 5 EVI's.  Send
   1,00,000 frames from traffic generator to R1 with different SA and DA
   for 5 EVI's.so that 10,00,000 mac address will be learned in DUT.
   There is a bi directional traffic flow with 5,00,000 pps in each
   direction.  Then clear the bgp nei in DUT after the bgp comes up and
   started learning the routes, measure the time taken to learn all
   10,00,000 mac routes.

   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
   be configured per IFD/Interface.  Using RT(traffic generator) to send
   the traffic to the routers.

   Measurement:

   The DUT must learn all 10,00,000 mac address.Measure the time taken
   to learn 10,00,000 mac.

7.  Soak Test

7.1.  To Scale the DUT to 32k EVI in DUT with traffic and run the set up
      for 24hrs

   Objective:

   The main purpose of the test the DUT performance to scale 32k EVI's
   with traffic.  Then clear bgp neighbor.  There should not be any loss
   of routes or any crashes.  Send 1,00,000 frames from CE to DUT from
   traffic generator with different SA and DA for 5 EVI's.  Send
   1,00,000 frames from traffic generator to R1 with different SA and DA
   for 5 EVI's.so that 10,00,000 mac address will be learned in DUT.
   There is a bi directional traffic flow with 5,00,000 pps in each
   direction.Keep the setup up and running for 24 hrs,take hourly CPU
   utilization,memory usage.




Jacob & Tiruveedhula     Expires August 2, 2016                [Page 11]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


   Procedure:

   Configure EVPN EVI in R1,MHPE2,DUT.All 4 routers except CE are
   running mpls,bgp,RR is acting as route reflector to R1,MHPE2 and
   DUT.Once the bgp comes up check the DUT evpn table.For MH PE ESI must
   be configured per IFD/Interface.  Using RT(traffic generator) to send
   the traffic to the routers.

   Measurement:

   Take the hourly reading of CPU,process memory.There should not be any
   leak,crashes,CPU spikes.

8.  Acknowledgements

   We would like to thank Bhuvaneswaran Vengainathan of Veryx
   Technologies and Al Morton of (ATT) for their support and
   encouragements.

9.  IANA Considerations

   This memo includes no request to IANA.

10.  Security Considerations

   There is no additional consideration from RFC 6192.

11.  References

11.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC2544]  Bradner, S. and J. McQuaid, "Benchmarking Methodology for
              Network Interconnect Devices", RFC 2544,
              DOI 10.17487/RFC2544, March 1999,
              <http://www.rfc-editor.org/info/rfc2544>.

11.2.  Informative References

   [RFC7432]  Sajassi, A., Ed., Aggarwal, R., Bitar, N., Isaac, A.,
              Uttaro, J., Drake, J., and W. Henderickx, "BGP MPLS-Based
              Ethernet VPN", RFC 7432, DOI 10.17487/RFC7432, February
              2015, <http://www.rfc-editor.org/info/rfc7432>.




Jacob & Tiruveedhula     Expires August 2, 2016                [Page 12]

Internet-Draft        EVPN Benchmarking Methodology         January 2016


Appendix A.  Appendix

Authors' Addresses


   Kishore Tiruveedhula
   Juniper Networks
   10 Technology Park Dr
   Westford, MA  01886
   USA

   Phone: +1 9785898861
   Email: kishoret@juniper.net



   Sudhin Jacob (editor)
   Juniper Networks
   Bangalore
   India

   Phone: +91 8061212543
   Email: sjacob@juniper.net
          sudhinjacob@rediffmail.com






























Jacob & Tiruveedhula     Expires August 2, 2016                [Page 13]
