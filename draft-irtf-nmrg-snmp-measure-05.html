<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>SNMP Traffic Measurements and Trace Exchange Formats</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="SNMP Traffic Measurements and Trace Exchange Formats">
<meta name="keywords" content="Network Management, Simple Network Management Protocol, SNMP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">NMRG</td><td class="header">J. Schoenwaelder</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Jacobs University Bremen</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">May 19, 2008</td></tr>
<tr><td class="header">Expires: November 20, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />SNMP Traffic Measurements and Trace Exchange Formats<br />draft-irtf-nmrg-snmp-measure-05.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on November 20, 2008.</p>

<h3>Abstract</h3>

<p>
          The Simple Network Management Protocol (SNMP) is widely
          deployed to monitor, control and (sometimes also) configure
          network elements.  Even though the SNMP technology is well
          documented, it remains relatively unclear how SNMP is used
          in practice and what typical SNMP usage patterns are.
        
</p>
<p>
          This document describes an approach to carrying out large
          scale SNMP traffic measurements in order to develop a better
          understanding how SNMP is used in real world production
          networks. It describes the motivation, the measurement
          approach, and the tools and data formats needed to carry out
          such a study.
        
</p>
<p>
          This document was produced within the IRTF's Network
          Management Research Group (NMRG) and represents the
          consensus of all of the active contributors to this group.
        
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#anchor1">2.</a>&nbsp;
Measurement Approach<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">2.1.</a>&nbsp;
Capturing Traffic Traces<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.2.</a>&nbsp;
Converting Traffic Traces<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.3.</a>&nbsp;
Filtering Traffic Traces<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.4.</a>&nbsp;
Storing Traffic Traces<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.5.</a>&nbsp;
Analyzing Traffic Traces<br />
<a href="#analysis">3.</a>&nbsp;
Analysis of Traffic Traces<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.</a>&nbsp;
Basic Statistics<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.</a>&nbsp;
Periodic vs. Aperiodic Traffic<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.3.</a>&nbsp;
Message Size and Latency Distributions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.4.</a>&nbsp;
Concurrency Levels<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.5.</a>&nbsp;
Table Retrieval Approaches<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.6.</a>&nbsp;
Trap-Directed Polling - Myths or Reality?<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.7.</a>&nbsp;
Popular MIB Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">3.8.</a>&nbsp;
Usage of Obsolete Objects<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">3.9.</a>&nbsp;
Encoding Length Distributions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">3.10.</a>&nbsp;
Counters and Discontinuities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">3.11.</a>&nbsp;
Spin Locks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">3.12.</a>&nbsp;
Row Creation<br />
<a href="#anchor19">4.</a>&nbsp;
Trace Exchange Formats<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#xml">4.1.</a>&nbsp;
XML Representation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#csv">4.2.</a>&nbsp;
CSV Representation<br />
<a href="#anchor20">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor21">6.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor22">7.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        The Simple Network Management Protocol (SNMP) was introduced
        in the late 1980s <a class='info' href='#RFC1052'>[RFC1052]<span> (</span><span class='info'>Cerf, V., &ldquo;IAB Recommendations for the Development of             Internet Network Management Standards,&rdquo; April&nbsp;1998.</span><span>)</span></a> and has since then
        evolved to what is known today as the SNMP version 3 Framework
        (SNMPv3) <a class='info' href='#RFC3410'>[RFC3410]<span> (</span><span class='info'>Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;Introduction and Applicability Statements for             Internet Standard Management Framework,&rdquo; December&nbsp;2002.</span><span>)</span></a>. While SNMP is widely
        deployed, it is not clear what protocol versions are being
        used, which protocol features are being used, how SNMP usage
        differs in different types of networks or organizations, which
        information is frequently queried, and what typical SNMP
        interactions patterns occur in real world production networks.
      
</p>
<p>
        There have been several publications in the recent past
        dealing with the performance of SNMP in general <a class='info' href='#SM99'>[SM99]<span> (</span><span class='info'>Sprenkels, R. and J. Martin-Flatin, &ldquo;Bulk Transfers of MIB Data,&rdquo; March&nbsp;1999.</span><span>)</span></a><a class='info' href='#Mal02'>[Mal02]<span> (</span><span class='info'>Malowidzki, M., &ldquo;GetBulk Worth Fixing,&rdquo; December&nbsp;2002.</span><span>)</span></a><a class='info' href='#Pat01'>[Pat01]<span> (</span><span class='info'>Pattinson, C., &ldquo;A Study of the Behaviour of the Simple Network Management Protocol,&rdquo; October&nbsp;2001.</span><span>)</span></a>,
        the impact of SNMPv3 security <a class='info' href='#DSR01'>[DSR01]<span> (</span><span class='info'>Du, X., Shayman, M., and M. Rozenblit, &ldquo;Implementation and Performance Analysis of SNMP on a TLS/TCP Base,&rdquo; May&nbsp;2001.</span><span>)</span></a><a class='info' href='#CT04'>[CT04]<span> (</span><span class='info'>Corrente, A. and L. Tura, &ldquo;Security Performance Analysis of SNMPv3 with Respect to SNMPv2c,&rdquo; April&nbsp;2004.</span><span>)</span></a>, or the relative performance of SNMP compared
        to Web Services <a class='info' href='#PDMQ04'>[PDMQ04]<span> (</span><span class='info'>Pras, A., Drevers, T., van de Meent, R., and D. Quartel, &ldquo;Comparing the Performance of SNMP and Web Services based Management,&rdquo; November&nbsp;2004.</span><span>)</span></a><a class='info' href='#PFGL04'>[PFGL04]<span> (</span><span class='info'>Pavlou, G., Flegkas, P., Gouveris, S., and A. Liotta, &ldquo;On Management Technologies and the Potential of Web Services,&rdquo; July&nbsp;2004.</span><span>)</span></a>. While these papers are generally useful to
        better understand the impact of various design decisions and
        technologies, some of these papers lack a strong foundation
        because authors typically assume certain SNMP interaction
        patterns without having experimental evidence that the
        assumptions are correct. In fact, there are many speculations
        on how SNMP is being used in real world production networks
        and performance comparisons are based on limited test cases,
        but no systematic measurements have been performed and
        published so far.
      
</p>
<p>
        Many authors use the ifTable of the IF-MIB <a class='info' href='#RFC2863'>[RFC2863]<span> (</span><span class='info'>McCloghrie, K. and F. Kastenholz, &ldquo;The Interfaces Group MIB,&rdquo; June&nbsp;2000.</span><span>)</span></a> or the tcpConnTable of the TCP-MIB <a class='info' href='#RFC4022'>[RFC4022]<span> (</span><span class='info'>Raghunarayan, R., &ldquo;Management Information Base for the Transmission              Control Protocol (TCP),&rdquo; March&nbsp;2005.</span><span>)</span></a> as a starting point for their analysis and
        comparison. Despite the fact that there is no evidence that
        operations on these tables dominate SNMP traffic, it is even
        more unclear how these tables are read and which optimizations
        are done (or not done) by real world applications. It is also
        unclear what the actual traffic trade-off between periodic
        polling and more aperiodic bulk data retrieval is.
        Furthermore, we do not generally understand how much traffic
        is devoted to standardized MIB objects and how much traffic
        deals with proprietary MIB objects and whether the operation
        mix between these object classes differs between different
        operational environments (e.g., backbone networks, access
        networks, enterprise networks).
      
</p>
<p>
	This document recommends an approach to collecting, codifying,
	and handling SNMP traffic traces in order to find answers to
	some of these questions. It describes the tools that have been
	developed to allow network operators to collect traffic traces
	and to share them with research groups interested in analyzing
	and modeling network management interactions.
      
</p>
<p>
	While the SNMP trace collection and analysis effort was
	initiated by the research community, network operators can
	benefit from the SNMP measurements too.  Several new tools are
	being developed as part of this effort that can be used to
	capture and analyze the traffic generated by management
	stations. This resulting information can then be used to
	improve the efficiency and scalability of management systems.
      
</p>
<p>
	The measurement approach described in this document is by
	design limited to the study of SNMP traffic. Studies of other
	management protocols or the impact of management protocols
	such as SNMP on other traffic sharing the same network
	resources is left to future efforts.
      
</p>
<p>
        This is an informational document, produced within the IRTF's
        Network Management Research Group (NMRG) and represents the
        consensus of all of the active contributors to this group.
      
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Measurement Approach</h3>

<p>
        This section outlines the process of doing SNMP traffic
        measurements and analysis. The process consists of the
        following five basic steps:
      
</p>
<p>
        </p>
<ol class="text">
<li>
            Capture raw SNMP traffic traces in <a href='http://en.wikipedia.org/wiki/Pcap'>pcap packet
            capture files</a>.
          
</li>
<li>
            Convert the raw traffic traces into a structured machine
            and human readable format. A suitable XML schema has been
            developed for this purpose which captures all SNMP message
            details. Another more compact comma separated values (CSV)
            format has been developed which only keeps key information
            about SNMP messages.
          
</li>
<li>
            Filter the converted traffic traces to hide or anonymize
            sensitive information. While the filtering is conceptually
            a separate step, filtering may actually be implemented as
            part of the previous data conversion step for efficiency
            reasons.
          
</li>
<li>
            Submit the filtered traffic traces to a repository from
            where they can be retrieved and analyzed. Such a
            repository may be public, it may be under the control of a
            research group, or it may be under the control of a
            network operator who commits to run analysis scripts on
            the repository on behalf of researchers.
          
</li>
<li>
            Analyze the traces by creating and executing analysis
            scripts which extract and aggregate information.
          
</li>
</ol><p>
      
</p>
<p>
        Several of the steps listed above require the involvement of
        network operators supporting the SNMP measurement projects.
        In many cases, the filtered XML and CSV representation of the
        SNMP traces will be the interface between the researchers
        writing analysis scripts and the operators involved in the
        measurement activity. It is therefore important to have a well
        defined specification of these interfaces.
      
</p>
<p>
        This section provides some advice and concrete hints how the
        steps listed above can be carried out efficiently.  Some
        special tools have been developed to assist network operators
        and researchers so that the time spent on supporting SNMP
        traffic measurement projects is limited. The following
        sections describe the five steps and some tools in more
        detail.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Capturing Traffic Traces</h3>

<p>
          Capturing SNMP traffic traces can be done using packet
          sniffers such as <a href='http://www.tcpdump.org/'>tcpdump</a>, <a href='http://www.wireshark.org/'>wireshark</a>, or
          similar applications.  Some care must be taken to specify
          pcap filter expressions that match the SNMP transport
          endpoints used to carry SNMP traffic (typically 'udp and
          (port 161 or port 162)').  Furthermore, it is necessary to
          ensure that full packets are captured, that is packets are
          not truncated (tcpdump option -s 0). Finally, it is
          necessary to carefully select the placement of the capturing
          probe within the network. Especially on bridged LANs, it is
          important to ensure that all management traffic is captured
          and that the probe has access to all virtual LANs carrying
          management traffic. This usually requires placing the
          probe(s) close to the management system(s) and to configure
          dedicated monitoring ports on bridged networks. Some bridges
          have restrictions concerning their monitoring capabilities
          and this should be investigated and documented where
          necessary.
        
</p>
<p>
          It is recommended to capture at least a full week of data to
          capture diurnal patterns and one cycle of weekly behavior.
          Operators are strongly encouraged to capture traces over
          even longer periods of time. Tools such as <a href='http://www.tcpdump.org/'>tcpslice</a> or <a href='http://indev.insu.com/Fwctl/pcapmerge.html'>pcapmerge</a>
          can be used to split or merge pcap trace files as needed.
        
</p>
<p>
          Several operating systems can offload some of the TCP/IP
          processing such as the calculation of transport layer
          checksum to network interface cards. Traces that include
          traffic to/from a capturing interface which supports TCP/IP
          offloading can include incorrect transport layer checksums.
          The simplest solution is of course to turn checksum
          offloading off while capturing traces (if that is feasible
          without losing too many packets). The other solution is to
          correct or ignore checksums during the subsequent conversion
          of the raw pcap files.
        
</p>
<p>
          It is important to note that the raw pcap files should
          ideally be kept in permanent storage (e.g., compressed and
          encrypted on a CD ROM or DVD). To verify measurements, it
          might be necessary to go back to the original pcap files if,
          for example, bugs in the tools described below have been
          detected and fixed.
        
</p>
<p>
          For each captured trace, some meta data should be recorded
          and made available. The meta data should include information
          such as where the trace was collected (name of the network
          and name of the organization owning the network, description
          of the measurement point in the network topology where the
          trace was collected), when it was collected, contact
          information, the size of the trace, any known special
          events, equipment failures, or major infrastructure changes
          during the data collection period and so on. It is also
          extremely useful to provide a unique identification. There
          are special online services such as <a href='http://www.datcat.org/'>DatCat</a> where meta
          data can be stored and which provide unique identifiers.
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Converting Traffic Traces</h3>

<p>
          Raw traces in pcap format must be converted into a format
          that is human readable while remaining also machine readable
          for efficient post-processing. Human readability makes it
          easy for an operator to verify that no sensitive data is
          left in a trace while machine readability is needed to
          efficiently extract relevant information.
        
</p>
<p>
          The natural choice here is to use an XML format since XML is
          human as well as machine readable and there are many tools
          and high-level scripting language application programming
          interfaces (APIs) that can be used to process XML documents
          and to extract meaningful information. However, XML is also
          pretty verbose which increases processing overhead. In
          particular, the usage of XML streaming APIs is strongly
          suggested since APIs that require an in memory
          representation of XML documents do not handle large traces
          well.
        
</p>
<p>
          <a class='info' href='#xml'>Section&nbsp;4.1<span> (</span><span class='info'>XML Representation</span><span>)</span></a> of this document defines a RELAX NG
          schema <a class='info' href='#OASISRNG'>[OASISRNG]<span> (</span><span class='info'>Clark, J. and M. Makoto, &ldquo;RELAX NG Specification,&rdquo; December&nbsp;2001.</span><span>)</span></a> for representing SNMP
          traffic traces in XML.  The schema captures all relevant
          details of an SNMP message in the XML format. Note that the
          XML format retains some information about the original
          ASN.1/BER encoding to support message size analysis.
        
</p>
<p>
          A lightweight alternative to the full blown XML
          representation based on comma separated values (CSV) is
          defined in <a class='info' href='#csv'>Section&nbsp;4.2<span> (</span><span class='info'>CSV Representation</span><span>)</span></a>. The CSV format only
          captures selected parts of SNMP messages and is thus more
          compact and faster to process.
        
</p>
<p>
          As explained in the previous sections, analysis programs
          which process raw pcap files should have an option to ignore
          incorrect checksums caused by TCP/IP offloading. In
          addition, analysis programs which process raw pcap files
          should be able to perform IP reassembly for SNMP messages
          that were fragmented at the IP layer.
        
</p>
<p>
          The <a href='https://svn.eecs.jacobs-university.de/svn/schoenw/src/snmpdump'>snmpdump</a>
          package has been developed to convert raw pcap files into
          XML and CSV format. The snmpdump program reads pcap, XML, or
          CSV files as input and produces XML files or CSV files as
          output. Specific elements can be filtered as required to
          protect sensitive data.
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Filtering Traffic Traces</h3>

<p>
          Filtering sensitive data (e.g., access control lists or
          community strings) can be achieved by manipulating the XML
          representation of an SNMP trace.  Standard XSLT processors
          (e.g., <a href='http://xmlsoft.org/XSLT/'>xsltproc</a>) can be
          used for this purpose. People familiar with the scripting
          language Perl might be interested in choosing a suitable
          <a href='http://perl-xml.sourceforge.net/faq/'>Perl
          module to manipulate XML documents</a>.
        
</p>
<p>
          The snmpdump program, for example, can filter out sensitive
          information, e.g., by deleting or clearing all XML elements
          whose name matches a regular expression. Data type specific
          anonymization transformations that maintain lexicographic
          ordering for values that appear in instance identifiers
          <a class='info' href='#HS06'>[HS06]<span> (</span><span class='info'>Harvan, M. and J. Schoenwaelder, &ldquo;Prefix- and Lexicographical-order-preserving IP Address             Anonymization,&rdquo; April&nbsp;2006.</span><span>)</span></a> can be applied. Note that
          anonymization transformations are often bound to an
          initialization key and depend on the data being anonymized
          in an anonymization run.  As a consequence, users must be
          careful when they merge data from independently anonymized
          traces. More information about network traffic trace
          anonymization techniques can be found in <a class='info' href='#XFA02'>[XFA02]<span> (</span><span class='info'>Xu, J., Fan, J., and M. Ammar, &ldquo;Prefix-Preserving IP Address Anonymization:             Measurement-based Security Evaluation and a New             Cryptography-based Scheme,&rdquo; November&nbsp;2002.</span><span>)</span></a>, <a class='info' href='#FXAM04'>[FXAM04]<span> (</span><span class='info'>Fan, J., Xu, J., Ammar, M., and S. Moon, &ldquo;Prefix-Preserving IP Address Anonymization,&rdquo; October&nbsp;2004.</span><span>)</span></a>, <a class='info' href='#PAPL06'>[PAPL06]<span> (</span><span class='info'>Pang, R., Allman, M., Paxson, V., and J. Lee, &ldquo;The Devil and Packet Trace Anonymization,&rdquo; January&nbsp;2006.</span><span>)</span></a>, and <a class='info' href='#RW07'>[RW07]<span> (</span><span class='info'>Ramaswamy, R. and T. Wolf, &ldquo;High-Speed Prefix-Preserving {IP} Address Anonymization 	    for Passive Measurement Systems,&rdquo; February&nbsp;2007.</span><span>)</span></a>.
        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Storing Traffic Traces</h3>

<p>
          The raw pcap traces as well as the XML / CSV formatted
          traces should be stored in a stable archive or repository.
          Such an archive or repository might either be maintained by
          research groups (e.g., the NMRG) or by network operators or
          both. It is of key importance that captured traces are not
          lost or modified as they may form the basis of future
          research projects and may also be needed to verify published
          research results.  Access to the archive might be restricted
          to those who have signed some sort of a non-disclosure
          agreement.
        
</p>
<p>
	  While this document recommends that raw traces should be
	  kept, it must be noted that there are situations where this
	  may not be feasible.  The recommendation to keep raw traces
	  may be ignored for example to comply with data protection
	  laws or to protect a network operator from being forced to
	  provide the data to other organizations.
	
</p>
<p>
          Lossless compression algorithms embodied in programs such as
          gzip or bzip2 can be used to compress even large trace files
          down to a size where they can be burned on DVDs for cheap
          long-term storage.
        
</p>
<p>
          It must be stressed again that it is important to keep the
          original pcap traces in addition to the XML / CSV formatted
          traces since the pcap traces are the most authentic source
          of information.  Improvements in the tool chain may require
          going back to the original pcap traces and rebuilding all
          intermediate formats from them.
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Analyzing Traffic Traces</h3>

<p>
          Scripts that analyze traffic traces must be verified for
          correctness. Ideally, all scripts used to analyze traffic
          traces will be publically accessible so that third parties
          can verify them. Furthermore, sharing scripts will enable
          other parties to repeat an analysis on other traffic traces
          and to extend such analysis scripts. It might be useful to
          establish and common, versioning repository for analysis
          scripts.
        
</p>
<p>
          Due to the availability of XML parsers and the simplicity of
          the CSV format, trace files can be processed with tools
          written in almost any programming language. However, in
          order to facilitate a common vocabulary and to allow
          operators to easily read scripts they execute on trace
          files, it is suggested that analysis scripts be written is
          scripting languages such as Perl using suitable Perl modules
          to manipulate XML documents <a href='http://perl-xml.sourceforge.net/faq/'>http://perl-xml.sourceforge.net/faq/</a>.  Using a
          scripting language such as Perl instead of system
          programming languages such as C or C++ has the advantage of
          reducing development time and making scripts more accessible
          to operators who may want to verify scripts before running
          them on trace files which may contain sensitive data.
        
</p>
<p>
          The snmpdump tool provides an API to process SNMP messages
          in C/C++. While the coding of trace analysis programs in
          C/C++ should in general be avoided for code readability,
          verifiability and portability reasons, using C/C++ might be
          the only option in dealing with very large traces
          efficiently.
        
</p>
<p>
	  Any results produced by analyzing a trace must be
	  interpreted in the context of the trace. The nature of the
	  network, the attachment point used to collect the trace, the
	  nature of the applications generating SNMP traffic, or the
	  events that happened while the trace was collected clearly
	  influence the result. It is therefore important to be
	  careful when drawing general conclusions based on a
	  potentially (too) limited data set.
	
</p>
<a name="analysis"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Analysis of Traffic Traces</h3>

<p>
        This section discusses several questions that can be answered
        by analyzing SNMP traffic traces. The questions raised in the
        following subsections are meant to be illustrative and no
        attempt has been made to provide a complete list.
      
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Basic Statistics</h3>

<p>
	    Basic statistics cover things such as
	    </p>
<ul class="text">
<li>protocol version used,
</li>
<li>protocol operations used,
</li>
<li>message size distribution,
</li>
<li>error message type frequency, or
</li>
<li>usage of authentication and encryption mechanisms.
</li>
</ul><p>
	    The OID names of the objects manipulated can be
	    categorized into OID subtrees, for example to identify
	    'standardized', 'proprietary', and 'experimental' objects.
          
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Periodic vs. Aperiodic Traffic</h3>

<p>
	    SNMP is used to periodically poll devices as well as to
	    retrieve information at the request of an operator or
	    application.  The periodic polling leads to periodic
	    traffic patterns while on-demand information retrieval
	    causes more aperiodic traffic patterns.  It is worthwhile
	    to understand what the relationship is between the amount
	    of periodic and aperiodic traffic.  It will be interesting
	    to understand whether there are multiple levels of
	    periodicity at different time scales.
	  
</p>
<p>
	    Periodic polling behavior may be dependent on the
	    application and polling engine it uses.  For example, some
	    management platforms allow applications to specify how
	    long polled values may be kept in a cache before they are
	    polled again. Such optimizations needs to be considered
	    when analyzing traces for periodic and aperiodic traffic.
	  
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Message Size and Latency Distributions</h3>

<p>
            SNMP messages are size constrained by the transport
            mappings used and the buffers provided by the SNMP
            engines. For the further evolution of the SNMP framework,
            it would be useful to know what the actual message size
            distributions are. It would be useful to understand the
            latency distributions, especially the distribution of the
            processing times by SNMP command responders. Some SNMP
            implementations approximate networking delays by measuring
            request-response times and it would be useful to
            understand to what extent this is a viable approach.
          
</p>
<p>
	    Some SNMP implementations update their counters from the
	    underlying instrumentation following adaptive algorthms,
	    not necessarily periodically, and not necessarily
	    on-demand. The granularity of internal counter updates may
	    impact latency measurements and should be taken into
	    account.
	  
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Concurrency Levels</h3>

<p>
            SNMP allows management stations to retrieve information
            from multiple agents concurrently. It will be interesting
            to identify what the typical concurrency level is that can
            be observed on production networks or whether management
            applications prefer more sequential ways of retrieving
            data.
          
</p>
<p>
	    Furthermore, it will be interesting to analyze how many
	    redundant requests coming from applications are processed
	    almost simultaneously by a device.  The concurrency level
	    and the amount of redundant requests has implications on
	    caching strategies employed by SNMP agents.
	  
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Table Retrieval Approaches</h3>

<p>
            Tables can be read in several different ways. The simplest
            and most inefficient approach is to retrieve tables
            object-by-object in column-by-column order. More advanced
            approaches try to read tables row-by-row or even
            multiple-rows-by-multiple-rows. The retrieval of index
            elements can be suppressed in most cases or only a subset
            of columns of a table are retrieved. It will be useful to
            know which of these approaches are used on production
            networks since this has a direct implication on agent
            implementation techniques and caching strategies.
          
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Trap-Directed Polling - Myths or Reality?</h3>

<p>
            SNMP is built around a concept called trap-directed
            polling.  Management applications are responsible to
            periodically poll SNMP agents to determine their
            status. SNMP agents can in addition send traps to notify
            SNMP managers about events so that SNMP managers can adapt
            their polling strategy and basically react faster than
            normal polling would allow to do.
          
</p>
<p>
            Analysis of SNMP traffic traces can identify whether
            trap-directed polling is actually deployed. In particular,
            the question that should be addressed is whether SNMP
            notifications lead to changes in the short-term polling
            behavior of management stations. In particular, it should
            be investigated to what extent SNMP managers use automated
            procedures to track down the meaning of the event conveyed
            by an SNMP notification.
          
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
Popular MIB Definitions</h3>

<p>
            An analysis of object identifier prefixes can identify the
            most popular MIB modules and the most important object
            types or notification types defined by these modules. Such
            information would be very valuable for the further
            maintenance and development of these and related MIB
            modules.
          
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.8"></a><h3>3.8.&nbsp;
Usage of Obsolete Objects</h3>

<p>
            Several objects from the early days have been obsoleted
            because they cannot properly represent today's networks. A
            typical example is the ipRouteTable which was obsoleted
            because it was not able to represent classless routing,
            introduced and deployed on the Internet in 1993. Some of
            these obsolete objects are still mentioned in popular
            publications as well as research papers. It will be
            interesting to find out whether they are also still used
            by management applications or whether management
            applications have been updated to use the replacement
            objects.
          
</p>
<p>
	    Depending on the data recorded in a trace, it might be
	    possible to determine the age of devices by looking at
	    values of objects such as sysObjectID and sysDecr <a class='info' href='#RFC3418'>[RFC3418]<span> (</span><span class='info'>Presuhn, R., Case, J., McCloghrie, K., Rose, M., and S. Waldbusser, &ldquo;Management Information Base (MIB) for the             Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>. The age of a device can then be taken
	    into consideration when analyzing the use of obsolete and
	    deprecated objects.
	  
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.9"></a><h3>3.9.&nbsp;
Encoding Length Distributions</h3>

<p>
            It will be useful to understand the encoding length
            distributions for various data types. Assumptions about
            encoding length distributions are sometimes used to
            estimate SNMP message sizes in order to meet transport and
            buffer size constraints.
          
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.10"></a><h3>3.10.&nbsp;
Counters and Discontinuities</h3>

<p>
            Counters can experience discontinuities <a class='info' href='#RFC2578'>[RFC2578]<span> (</span><span class='info'>McCloghrie, K., Perkins, D., and J. Schoenwaelder, &ldquo;Structure of Management Information Version 2 (SMIv2),&rdquo; April&nbsp;1999.</span><span>)</span></a>. A widely used discontinuity indicator
            is the sysUpTime scalar of the SNMPv2-MIB <a class='info' href='#RFC3418'>[RFC3418]<span> (</span><span class='info'>Presuhn, R., Case, J., McCloghrie, K., Rose, M., and S. Waldbusser, &ldquo;Management Information Base (MIB) for the             Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a>, which can be reset through a warm
            start to indicate counter discontinuities. Some MIB
            modules introduce more specific discontinuity indicators,
            e.g., the ifCounterDiscontinuityTime of the IF-MIB <a class='info' href='#RFC2863'>[RFC2863]<span> (</span><span class='info'>McCloghrie, K. and F. Kastenholz, &ldquo;The Interfaces Group MIB,&rdquo; June&nbsp;2000.</span><span>)</span></a>. It will be interesting to study to
            what extent these objects are actually used by management
            applications to handle discontinuity events.
          
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.11"></a><h3>3.11.&nbsp;
Spin Locks</h3>

<p>
            Cooperating command generators can use advisory locks to
            coordinate their usage of SNMP write operations. The
            snmpSetSerialNo scalar of the SNMPv2-MIB <a class='info' href='#RFC3418'>[RFC3418]<span> (</span><span class='info'>Presuhn, R., Case, J., McCloghrie, K., Rose, M., and S. Waldbusser, &ldquo;Management Information Base (MIB) for the             Simple Network Management Protocol (SNMP),&rdquo; December&nbsp;2002.</span><span>)</span></a> is the default course-grain
            coordination object. It will be interesting to find out
            whether there are command generators which coordinate
            themselves using these spin locks.
          
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.12"></a><h3>3.12.&nbsp;
Row Creation</h3>

<p>
            Row creation is an operation not natively supported by the
            protocol operations. Instead, conceptual tables supporting
            row creation typically provide a control column which uses
            the RowStatus textual convention defined in the SNMPv2-TC
            <a class='info' href='#RFC2579'>[RFC2579]<span> (</span><span class='info'>McCloghrie, K., Perkins, D., and J. Schoenwaelder, &ldquo;Textual Conventions for SMIv2,&rdquo; April&nbsp;1999.</span><span>)</span></a> module. The RowStatus itself
            supports different row creation modes, namely
            createAndWait (dribble-mode) and createAndGo (one-shot
            mode).  Different approaches can be used to derive the
            instance identifier if it does not have special semantics
            associated. It will be useful to study which of the
            various row creation approaches are actually used by
            management applications on production networks.
          
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Trace Exchange Formats</h3>

<a name="xml"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
XML Representation</h3>

<p>
        The XML format has been designed to keep all information
        associated with SNMP messages. The format is specified in
        RELAX NG compact notation <a class='info' href='#OASISRNC'>[OASISRNC]<span> (</span><span class='info'>Clark, J., &ldquo;RELAX NG Compact Syntax,&rdquo; November&nbsp;2002.</span><span>)</span></a>. Freely
        available tools such as <a href='http://www.relaxng.org/'>trang</a> can be used to
        convert RELAX NG compact syntax to other XML schema notations.
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
# Relax NG grammar for the XML SNMP trace format.
#
# Published as part of RFC XXXX.
#
# $Id: measure.xml 2877 2008-05-19 18:52:29Z schoenw $

default namespace = "urn:ietf:params:xml:ns:snmp-trace-1.0"

start =
  element snmptrace {
    packet.elem*
  }

packet.elem =
  element packet {
    element time-sec  { xsd:unsignedInt },
    element time-usec { xsd:unsignedInt },
    element src-ip    { ipaddress.type },
    element src-port  { xsd:unsignedInt },
    element dst-ip    { ipaddress.type },
    element dst-port  { xsd:unsignedInt },
    snmp.elem
  }

snmp.elem =
  element snmp {
    length.attrs?,
    message.elem
  }

message.elem =
  element version   { length.attrs, xsd:int },
  element community { length.attrs, xsd:hexBinary },
  pdu.elem

message.elem |=
  element version { length.attrs, xsd:int },
  element message {
    length.attrs,
    element msg-id         { length.attrs, xsd:unsignedInt },
    element max-size       { length.attrs, xsd:unsignedInt },
    element flags          { length.attrs, xsd:hexBinary },
    element security-model { length.attrs, xsd:unsignedInt }
  },
  usm.elem?,
  element scoped-pdu {
    length.attrs,
    element context-engine-id { length.attrs, xsd:hexBinary },
    element context-name      { length.attrs, xsd:string },
    pdu.elem
  }

usm.elem =
  element usm {
    length.attrs,
    element auth-engine-id    { length.attrs, xsd:hexBinary },
    element auth-engine-boots { length.attrs, xsd:unsignedInt },
    element auth-engine-time  { length.attrs, xsd:unsignedInt },
    element user              { length.attrs, xsd:hexBinary },
    element auth-params       { length.attrs, xsd:hexBinary },
    element priv-params       { length.attrs, xsd:hexBinary }
  }

pdu.elem =
  element trap {
    length.attrs,
    element enterprise        { length.attrs, oid.type },
    element agent-addr        { length.attrs, ipv4address.type },
    element generic-trap      { length.attrs, xsd:int },
    element specific-trap     { length.attrs, xsd:int },
    element time-stamp        { length.attrs, xsd:int },
    element variable-bindings { length.attrs, varbind.elem* }
  }

pdu.elem |=
  element (get-request | get-next-request | get-bulk-request |
           set-request | inform-request | snmpV2-trap |
           response | report) {
    length.attrs,
    element request-id        { length.attrs, xsd:int },
    element error-status      { length.attrs, xsd:int },
    element error-index       { length.attrs, xsd:int },
    element variable-bindings { length.attrs, varbind.elem* }
  }

varbind.elem =
  element varbind { length.attrs, name.elem, value.elem }

name.elem =
  element name { length.attrs, oid.type }

value.elem =
  element null              { length.attrs, empty } |
  element integer32         { length.attrs, xsd:int } |
  element unsigned32        { length.attrs, xsd:unsignedInt } |
  element counter32         { length.attrs, xsd:unsignedInt } |
  element counter64         { length.attrs, xsd:unsignedLong } |
  element timeticks         { length.attrs, xsd:unsignedInt } |
  element ipaddress         { length.attrs, ipv4address.type } |
  element octet-string      { length.attrs, xsd:hexBinary } |
  element object-identifier { length.attrs, oid.type } |
  element opaque            { length.attrs, xsd:hexBinary } |
  element no-such-object    { length.attrs, empty } |
  element no-such-instance  { length.attrs, empty } |
  element end-of-mib-view   { length.attrs, empty }

# The blen attribute indicates the number of octets used by the BER
# encoded tag / length / value triple. The vlen attribute indicates
# the number of octets used by the BER encoded value alone.

length.attrs =
  ( attribute blen { xsd:unsignedShort },
    attribute vlen { xsd:unsignedShort } )?

oid.type =
  xsd:string {
    pattern =
      "([0-1](\.[1-3]?[0-9]))|(2.(0|([1-9]\d*)))" ~
      "(\.(0|([1-9]\d*))){0,126}"
  }

# The types below are for IP addresses. Note that SNMP's buildin
# IpAddress type only supports IPv4 addresses; IPv6 addresses are only
# introduced to cover SNMP over IPv6 endpoints.

ipv4address.type =
  xsd:string {
    pattern =
   "((0|1[0-9]{0,2}|2([0-4][0-9]?|5[0-5]?|[6-9])?|[3-9][0-9]?)\.){3}" ~
   "(0|1[0-9]{0,2}|2([0-4][0-9]?|5[0-5]?|[6-9])?|[3-9][0-9]?)"
  }

ipv6address.type =
  xsd:string {
    pattern =
      "(([0-9a-fA-F]+:){7}[0-9a-fA-F]+)|" ~
      "(([0-9a-fA-F]+:)*[0-9a-fA-F]+)?::(([0-9a-fA-F]+:)*[0-9a-fA-F]+)?"
  }

ipaddress.type = ipv4address.type | ipv6address.type
</pre></div>
<p>
	The following example shows an SNMP trace file in XML format
	containing an SNMPv1 get-next-request message for the OID
	1.3.6.1.2.1.1.3 (sysUpTime) and the response message returned
	by the agent.
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;snmptrace&gt;
  &lt;packet&gt;
    &lt;time-sec&gt;1147212206&lt;/time-sec&gt;
    &lt;time-usec&gt;739609&lt;/time-usec&gt;
    &lt;src-ip&gt;192.0.2.1&lt;/src-ip&gt;
    &lt;src-port&gt;60371&lt;/src-port&gt;
    &lt;dst-ip&gt;192.0.2.2&lt;/dst-ip&gt;
    &lt;dst-port&gt;12345&lt;/dst-port&gt;
    &lt;snmp blen="42" vlen="40"&gt;
      &lt;version blen="3" vlen="1"&gt;1&lt;/version&gt;
      &lt;community blen="8" vlen="6"&gt;7075626c6963&lt;/community&gt;
      &lt;get-next-request blen="29" vlen="27"&gt;
        &lt;request-id blen="6" vlen="4"&gt;1804289383&lt;/request-id&gt;
        &lt;error-status blen="3" vlen="1"&gt;0&lt;/error-status&gt;
        &lt;error-index blen="3" vlen="1"&gt;0&lt;/error-index&gt;
        &lt;variable-bindings blen="15" vlen="13"&gt;
          &lt;varbind blen="13" vlen="11"&gt;
            &lt;name blen="9" vlen="7"&gt;1.3.6.1.2.1.1.3&lt;/name&gt;
            &lt;null blen="2" vlen="0"/&gt;
          &lt;/varbind&gt;
        &lt;/variable-bindings&gt;
      &lt;/get-next-request&gt;
    &lt;/snmp&gt;
  &lt;/packet&gt;
  &lt;packet&gt;
    &lt;time-sec&gt;1147212206&lt;/time-sec&gt;
    &lt;time-usec&gt;762891&lt;/time-usec&gt;
    &lt;src-ip&gt;192.0.2.2&lt;/src-ip&gt;
    &lt;src-port&gt;12345&lt;/src-port&gt;
    &lt;dst-ip&gt;192.0.2.1&lt;/dst-ip&gt;
    &lt;dst-port&gt;60371&lt;/dst-port&gt;
    &lt;snmp blen="47" vlen="45"&gt;
      &lt;version blen="3" vlen="1"&gt;1&lt;/version&gt;
      &lt;community blen="8" vlen="6"&gt;7075626c6963&lt;/community&gt;
      &lt;response blen="34" vlen="32"&gt;
        &lt;request-id blen="6" vlen="4"&gt;1804289383&lt;/request-id&gt;
        &lt;error-status blen="3" vlen="1"&gt;0&lt;/error-status&gt;
        &lt;error-index blen="3" vlen="1"&gt;0&lt;/error-index&gt;
        &lt;variable-bindings blen="20" vlen="18"&gt;
          &lt;varbind blen="18" vlen="16"&gt;
            &lt;name blen="10" vlen="8"&gt;1.3.6.1.2.1.1.3.0&lt;/name&gt;
            &lt;unsigned32 blen="6" vlen="4"&gt;26842224&lt;/unsigned32&gt;
          &lt;/varbind&gt;
        &lt;/variable-bindings&gt;
      &lt;/response&gt;
    &lt;/snmp&gt;
  &lt;/packet&gt;
&lt;/snmptrace&gt;
</pre></div>
<a name="csv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
CSV Representation</h3>

<p>
        The comma separated values (CSV) format has been designed to
        capture only the most relevant information about an SNMP
        message. In situations where all information about an SNMP
        message must be captured, the XML format defined above must be
        used. The CSV format uses the following fields:
      
</p>
<p>
        </p>
<ol class="text">
<li>
            Time-stamp in the format seconds.microseconds since 1970,
            for example "1137764769.425484".
          
</li>
<li>
            Source IP address in dotted quad notation (IPv4), for
            example "192.0.2.1", or compact hexadecimal notation
            (IPv6), for example "2001:DB8::1".
          
</li>
<li>
            Source port number represented as a decimal number, for
            example "4242".
          
</li>
<li>
            Destination IP address in dotted quad notation (IPv4), for
            example "192.0.2.1", or compact hexadecimal notation
            (IPv6), for example "2001:DB8::1".
          
</li>
<li>
            Destination port number represented as a decimal number, for
            example "161".
          
</li>
<li>
            Size of the SNMP message (a decimal number) counted in
            octets, for example "123". The size excludes all transport,
            network, and link-layer headers.
          
</li>
<li>
            SNMP message version represented as a decimal number. The
            version 0 stands for SNMPv1, 1 for SNMPv2c, and 3 for
            SNMPv3, for example "3".
          
</li>
<li>
            SNMP protocol operation indicated by one of the keywords
            get-request, get-next-request, get-bulk-request, set-request,
            trap, snmpV2-trap, inform-request, response, report.
          
</li>
<li>
            SNMP request-id in decimal notation, for example "1511411010".
          
</li>
<li>
            SNMP error-status in decimal notation, for example "0".
          
</li>
<li>
            SNMP error-index in decimal notation, for example "0".
          
</li>
<li>
            Number of variable-bindings contained in the varbind-list in
            decimal notation, for example "5".
          
</li>
<li>
            For each varbind in the varbind list, three output elements
            are generated
            
<ol class="text">
<li>
                Object name given as object identifier in dotted decimal
                notation, for example "1.3.6.1.2.1.1.3.0".
              
</li>
<li>
                Object base type name or exception name, that is one
                of the following: null, integer32, unsigned32,
                counter32, counter64, timeticks, ipaddress,
                octet-string, object-identifier, opaque,
                no-such-object, no-such-instance, and end-of-mib-view.
              
</li>
<li>
                Object value is printed as a number if the underlying
                base type is numeric. An IPv4 addresses is rendered in
                the dotted quad notation and an IPv6 address is
                rendered in the usual hexadecimal notation. An octet
                string value is printed in hexadecimal format while an
                object identifier value is printed in dotted decimal
                notation. In case of an exception, the object value is
                empty.
              
</li>
</ol>
          
</li>
</ol><p>
      
</p>
<p>
        Note that the format does not preserve the information needed
        to understand SNMPv1 traps. It is therefore recommended that
        implementations are able to convert the SNMPv1 trap format
        into the trap format used by SNMPv2c and SNMPv3, according to
        the rules defined in <a class='info' href='#RFC3584'>[RFC3584]<span> (</span><span class='info'>Frye, R., Levi, D., Routhier, S., and B. Wijnen, &ldquo;Coexistence between Version 1, Version 2, and Version 3             of the Internet-standard Network Management Framework,&rdquo; August&nbsp;2003.</span><span>)</span></a>. The activation
        of trap format conversion should be the user's choice.
      
</p>
<p>
	The following example shows an SNMP trace file in CSV format
	containing an SNMPv1 get-next-request message for the OID
	1.3.6.1.2.1.1.3 (sysUpTime) and the response message returned
	by the agent. (Note that the example uses backslash line
	continuation marks in order to fit the example into the RFC
	format. Backslash line continuations are not part of the CSV
	format.)
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
1147212206.739609,192.0.2.1,60371,192.0.2.2,12345,42,1,\
  get-next-request,1804289383,0,0,1,1.3.6.1.2.1.1.3,null,
1147212206.762891,192.0.2.2,12345,192.0.2.1,60371,47,1,\
  response,1804289383,0,0,1,1.3.6.1.2.1.1.3.0,timeticks,26842224
</pre></div>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
        SNMP traffic traces usually contain sensitive information. It
        is therefore necessary to (a) remove unwanted information and
        (b) to anonymize the remaining necessary information before
        traces are made available for analysis. It is recommended to
        encrypt traces when they are archived.
      
</p>
<p>
        Implementations that generate CSV or XML traces from raw pcap
        files should have an option to suppress or anonymize values.
        Note that instance identifiers of tables also include values
        and it might therefore be necessary to suppress or anonymize
        (parts of) the instance identifiers. Similarly, the packet and
        message headers typically contain sensitive information about
        the source and destination of SNMP messages as well as
        authentication information (community strings or user names).
      
</p>
<p>
        Anonymization techniques can be applied to keep information in
        traces which could otherwise reveal sensitive information.
        When using anonymization, values should only be kept when the
        underlying data type is known and an appropriate anonymization
        transformation is available (filter-in principle). For values
        appearing in instance identifiers, it is usually desirable to
        maintain the lexicographic order. Special anonymization
        transformations which preserve this property have been
        developed, although their anonymization strength is usually
        reduced compared to transformations that do not preserve
        lexicographic ordering <a class='info' href='#HS06'>[HS06]<span> (</span><span class='info'>Harvan, M. and J. Schoenwaelder, &ldquo;Prefix- and Lexicographical-order-preserving IP Address             Anonymization,&rdquo; April&nbsp;2006.</span><span>)</span></a>.
      
</p>
<p>
	The meta data associated with traces and in particular
	information about the organization owning a network and the
	description of the measurement point in the network topology
	where a trace was collected may be misused to decide/pinpoint
	where and how to attack a network. Meta data therefore needs
	to be properly protected.
      
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>
	This document requests that IANA register a URI for the SNMP
	XML trace format namespace in the IETF XML registry <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>.  Following the format in RFC 3688, the
	following registration is requested.
      
</p>
<p>
	URI: Please assign the URI "urn:ietf:params:xml:ns:snmp-trace-1.0"
	for use by the SNMP trace format.
      
</p>
<p>
	Registrant Contact: The NMRG of the IRTF.
      
</p>
<p>
	XML: N/A, the requested URI is an XML namespace.
      
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Acknowledgements</h3>

<p>
        This document was influenced by discussions within the Network
        Management Research Group (NMRG). Special thanks to Remco van
        de Meent for writing the initial Perl script that lead to the
        development of the snmpdump software package and Matus Harvan
        for his work on lexicographic order preserving anonymization
        transformations.  Aiko Pras contributed ideas to <a class='info' href='#analysis'>Section&nbsp;3<span> (</span><span class='info'>Analysis of Traffic Traces</span><span>)</span></a> while David Harrington helped to improve
        the readability of this document.
      
</p>
<p>
	Last call reviews have been received from Bert Wijnen, Aiko
	Pras, Frank Strauss, Remco van de Meent, Giorgio Nunzi, Wes
	Hardacker, Liam Fallon, Sharon Chisholm, David Perkins, Deep
	Medhi, Randy Bush, David Harrington, Dan Romascanu, Luca Deri,
	and Marc Burgess. Karen R. Sollins reviewed the document for
	the Internet Research Steering Group (IRSG).
      
</p>
<p>
        Part of this work was funded by the European Commission under
        grant FP6-2004-IST-4-EMANICS-026854-NOE.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2578">[RFC2578]</a></td>
<td class="author-text">McCloghrie, K., Perkins, D., and J. Schoenwaelder, &ldquo;<a href="http://tools.ietf.org/html/rfc2578">Structure of Management Information Version 2 (SMIv2)</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2578, April&nbsp;1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASISRNG">[OASISRNG]</a></td>
<td class="author-text">Clark, J. and M. Makoto, &ldquo;RELAX NG Specification,&rdquo; OASIS&nbsp;Committee Specification, December&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="OASISRNC">[OASISRNC]</a></td>
<td class="author-text">Clark, J., &ldquo;RELAX NG Compact Syntax,&rdquo; OASIS&nbsp;Committee Specification, November&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3584">[RFC3584]</a></td>
<td class="author-text">Frye, R., Levi, D., Routhier, S., and B. Wijnen, &ldquo;<a href="http://tools.ietf.org/html/rfc3584">Coexistence between Version 1, Version 2, and Version 3
            of the Internet-standard Network Management Framework</a>,&rdquo; RFC&nbsp;3584, August&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3688">[RFC3688]</a></td>
<td class="author-text">Mealling, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>,&rdquo; RFC&nbsp;3688, January&nbsp;2004.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1052">[RFC1052]</a></td>
<td class="author-text">Cerf, V., &ldquo;<a href="http://tools.ietf.org/html/rfc1052">IAB Recommendations for the Development of
            Internet Network Management Standards</a>,&rdquo; RFC&nbsp;1052, April&nbsp;1998.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2579">[RFC2579]</a></td>
<td class="author-text">McCloghrie, K., Perkins, D., and J. Schoenwaelder, &ldquo;<a href="http://tools.ietf.org/html/rfc2579">Textual Conventions for SMIv2</a>,&rdquo; STD&nbsp;58, RFC&nbsp;2579, April&nbsp;1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3418">[RFC3418]</a></td>
<td class="author-text">Presuhn, R., Case, J., McCloghrie, K., Rose, M., and S. Waldbusser, &ldquo;<a href="http://tools.ietf.org/html/rfc3418">Management Information Base (MIB) for the
            Simple Network Management Protocol (SNMP)</a>,&rdquo; STD&nbsp;62, RFC&nbsp;3418, December&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2863">[RFC2863]</a></td>
<td class="author-text">McCloghrie, K. and F. Kastenholz, &ldquo;<a href="http://tools.ietf.org/html/rfc2863">The Interfaces Group MIB</a>,&rdquo; RFC&nbsp;2863, June&nbsp;2000.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3410">[RFC3410]</a></td>
<td class="author-text">Case, J., Mundy, R., Partain, D., and B. Stewart, &ldquo;<a href="http://tools.ietf.org/html/rfc3410">Introduction and Applicability Statements for
            Internet Standard Management Framework</a>,&rdquo; RFC&nbsp;3410, December&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4022">[RFC4022]</a></td>
<td class="author-text">Raghunarayan, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4022">Management Information Base for the Transmission 
            Control Protocol (TCP)</a>,&rdquo; RFC&nbsp;4022, March&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="PDMQ04">[PDMQ04]</a></td>
<td class="author-text">Pras, A., Drevers, T., van de Meent, R., and D. Quartel, &ldquo;Comparing the Performance of SNMP and Web Services based Management,&rdquo; IEEE electronic Transactions on Network and Service Management&nbsp;1(2), November&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="Pat01">[Pat01]</a></td>
<td class="author-text">Pattinson, C., &ldquo;A Study of the Behaviour of the Simple Network Management Protocol,&rdquo; Proc. 12th IFIP/IEEE Workshop on Distributed Systems: Operations and Management&nbsp;, October&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="DSR01">[DSR01]</a></td>
<td class="author-text">Du, X., Shayman, M., and M. Rozenblit, &ldquo;Implementation and Performance Analysis of SNMP on a TLS/TCP Base,&rdquo; Proc. 7th IFIP/IEEE International Symposium on Integrated Network Management&nbsp;, May&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="CT04">[CT04]</a></td>
<td class="author-text">Corrente, A. and L. Tura, &ldquo;Security Performance Analysis of SNMPv3 with Respect to SNMPv2c,&rdquo; Proc. 2004 IEEE/IFIP Network Operations and 
        Management Symposium&nbsp;, April&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="PFGL04">[PFGL04]</a></td>
<td class="author-text">Pavlou, G., Flegkas, P., Gouveris, S., and A. Liotta, &ldquo;On Management Technologies and the Potential of Web Services,&rdquo; IEEE Communications Magazine&nbsp;42(7), July&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="SM99">[SM99]</a></td>
<td class="author-text">Sprenkels, R. and J. Martin-Flatin, &ldquo;Bulk Transfers of MIB Data,&rdquo; Simple Times&nbsp;7(1), March&nbsp;1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="Mal02">[Mal02]</a></td>
<td class="author-text">Malowidzki, M., &ldquo;GetBulk Worth Fixing,&rdquo; Simple Times&nbsp;10(1), December&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="HS06">[HS06]</a></td>
<td class="author-text">Harvan, M. and J. Schoenwaelder, &ldquo;Prefix- and Lexicographical-order-preserving IP Address
            Anonymization,&rdquo; IEEE/IFIP Network Operations and Management Symposium&nbsp;NOMS 2006, April&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="XFA02">[XFA02]</a></td>
<td class="author-text">Xu, J., Fan, J., and M. Ammar, &ldquo;Prefix-Preserving IP Address Anonymization:
            Measurement-based Security Evaluation and a New
            Cryptography-based Scheme,&rdquo; 10th IEEE International Conference on
			  Network Protocols&nbsp;ICNP'02, November&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="FXAM04">[FXAM04]</a></td>
<td class="author-text">Fan, J., Xu, J., Ammar, M., and S. Moon, &ldquo;Prefix-Preserving IP Address Anonymization,&rdquo; Computer Networks&nbsp;46(2), October&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="PAPL06">[PAPL06]</a></td>
<td class="author-text">Pang, R., Allman, M., Paxson, V., and J. Lee, &ldquo;The Devil and Packet Trace Anonymization,&rdquo; Computer Communication Review&nbsp;36(1), January&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RW07">[RW07]</a></td>
<td class="author-text">Ramaswamy, R. and T. Wolf, &ldquo;High-Speed Prefix-Preserving {IP} Address Anonymization
	    for Passive Measurement Systems,&rdquo; IEEE Transactions on Networking&nbsp;15(1), February&nbsp;2007.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juergen Schoenwaelder</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jacobs University Bremen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Campus Ring 1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">28725 Bremen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 421 200-3587</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:j.schoenwaelder@jacobs-university.de">j.schoenwaelder@jacobs-university.de</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
