<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Diameter Mobile IPv6: Support for Home Agent
      to Diameter Server Interaction</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Diameter Mobile IPv6: Support for Home Agent
      to Diameter Server Interaction">
<meta name="keywords" content="Internet-Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Diameter Maintenance and</td><td class="header">J. Korhonen, Ed.</td></tr>
<tr><td class="header">Extensions (DIME)</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Bournelle</td></tr>
<tr><td class="header">Expires: October 30, 2009</td><td class="header">Orange Labs</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">G. Giaretta</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Qualcomm</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Nakhjiri</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Motorola</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">April 28, 2009</td></tr>
</table></td></tr></table>
<h1><br />Diameter Mobile IPv6: Support for Home Agent
      to Diameter Server Interaction<br />draft-ietf-dime-mip6-split-17.txt</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on October 30, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>Mobile IPv6 deployments may want to bootstrap their operations dynamically based on an
        interaction between the Home Agent and the Diameter server of the Mobile Service Provider.
        This document specifies the interaction between a Mobile IP Home Agent and a
        Diameter server.
</p>
<p>This
         document defines the Home Agent to the Diameter server communication when
         the mobile node authenticates using the Internet Key Exchange v2 protocol with the
         Extensible Authentication Protocol or using the Mobile IPv6 Authentication Protocol. In
         addition to authentication and authorization, the configuration of Mobile IPv6 specific
        parameters and accounting is specified in this document.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#anchor1">3.</a>&nbsp;
Application Identifiers<br />
<a href="#anchor2">4.</a>&nbsp;
Protocol Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">4.1.</a>&nbsp;
Support for Mobile IPv6 with IKEv2 and EAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.2.</a>&nbsp;
Support for the Mobile IPv6 Authentication Protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.3.</a>&nbsp;
Mobile IPv6 Session Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.3.1.</a>&nbsp;
Session-Termination-Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.3.2.</a>&nbsp;
Session-Termination-Answer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.3.3.</a>&nbsp;
Abort-Session-Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.3.4.</a>&nbsp;
Abort-Session-Answer<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#accounting_models">4.4.</a>&nbsp;
Accounting for Mobile IPv6 services<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.4.1.</a>&nbsp;
Accounting-Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.4.2.</a>&nbsp;
Accounting-Answer<br />
<a href="#Command-Code-Values">5.</a>&nbsp;
Command Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.1.</a>&nbsp;
Command Code for Mobile IPv6 with IKEv2 and EAP<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.1.1.</a>&nbsp;
Diameter-EAP-Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.1.2.</a>&nbsp;
Diameter-EAP-Answer<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.2.</a>&nbsp;
Command Codes for Mobile IPv6 Authentication Protocol Support<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.2.1.</a>&nbsp;
MIP6-Request<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.2.2.</a>&nbsp;
MIP6-Answer<br />
<a href="#avps">6.</a>&nbsp;
AVPs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">6.1.</a>&nbsp;
User-Name AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">6.2.</a>&nbsp;
Service-Selection AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">6.3.</a>&nbsp;
MIP-MN-AAA-SPI AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">6.4.</a>&nbsp;
MIP-MN-HA-SPI AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">6.5.</a>&nbsp;
MIP-Mobile-Node-Address AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">6.6.</a>&nbsp;
MIP6-Agent-Info AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">6.7.</a>&nbsp;
MIP-Careof-Address AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">6.8.</a>&nbsp;
MIP-Authenticator AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">6.9.</a>&nbsp;
MIP-MAC-Mobility-Data AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#mip-session-key">6.10.</a>&nbsp;
MIP-Session-Key AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">6.11.</a>&nbsp;
MIP-MSA-Lifetime AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">6.12.</a>&nbsp;
MIP-MN-HA-MSA AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">6.13.</a>&nbsp;
MIP-Algorithm-Type AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">6.14.</a>&nbsp;
MIP-Replay-Mode AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">6.15.</a>&nbsp;
MIP6-Feature-Vector AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">6.16.</a>&nbsp;
MIP-Timestamp AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">6.17.</a>&nbsp;
QoS-Capability AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">6.18.</a>&nbsp;
QoS-Resources AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">6.19.</a>&nbsp;
Chargeable-User-Identity AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">6.20.</a>&nbsp;
MIP6-Auth-Mode AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#accounting">6.21.</a>&nbsp;
Accounting AVPs<br />
<a href="#result">7.</a>&nbsp;
Result-Code AVP Values<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">7.1.</a>&nbsp;
Success<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">7.2.</a>&nbsp;
Permanent Failures<br />
<a href="#anchor39">8.</a>&nbsp;
AVP Occurrence Tables<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">8.1.</a>&nbsp;
DER, DEA, MIR and MIA AVP/Command-Code Table<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">8.2.</a>&nbsp;
Coupled Accounting Model AVP Table<br />
<a href="#anchor42">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">9.1.</a>&nbsp;
Command Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">9.2.</a>&nbsp;
AVP Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">9.3.</a>&nbsp;
Result-Code AVP Values<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">9.4.</a>&nbsp;
Application Identifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor47">9.5.</a>&nbsp;
Namespaces<br />
<a href="#SecurityConsiderations">10.</a>&nbsp;
Security Considerations<br />
<a href="#anchor48">11.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Performing the Mobile IPv6 protocol <a class='info' href='#RFC3775'>[RFC3775]<span> (</span><span class='info'>Johnson, D., Perkins, C., and J. Arkko, &ldquo;Mobility Support in IPv6,&rdquo; June&nbsp;2004.</span><span>)</span></a>, requires the Mobile Node
         (MN) to own a Home Address (HoA) and to have an assigned Home Agent
         (HA) to the MN.  The MN needs to register with the HA in order to enable
         its reachability and mobility, when away from its home link.  The registration
         process itself may require an establishment of IPsec security associations
         (SA) and cryptographic material between the MN and the HA. Alternatively, the
         registration process may be secured using a mobility message authentication
         option, which enables IPv6 mobility in a MN without having to establish an
         IPsec SA with its HA. Providing the collection of home address, HA address and
         keying material is generally referred to as the Mobile IPv6 bootstrapping
         problem <a class='info' href='#RFC4640'>[RFC4640]<span> (</span><span class='info'>Patel, A. and G. Giaretta, &ldquo;Problem Statement for bootstrapping Mobile IPv6 (MIPv6),&rdquo; September&nbsp;2006.</span><span>)</span></a>. The purpose of this specification is to provide Diameter
         support for the interaction between the HA and the
         Authentication, Authorization, and Accounting (AAA) server. This specification
         satisfies the requirements defined in <a class='info' href='#I-D.ietf-mext-aaa-ha-goals'>[I&#8209;D.ietf&#8209;mext&#8209;aaa&#8209;ha&#8209;goals]<span> (</span><span class='info'>Giaretta, G., Guardini, I., Demaria, E., Bournelle, J., and R. Lopez, &ldquo;AAA Goals for Mobile IPv6,&rdquo; May&nbsp;2008.</span><span>)</span></a> for the bootstrapping problem in
         the split scenario <a class='info' href='#RFC5026'>[RFC5026]<span> (</span><span class='info'>Giaretta, G., Kempf, J., and V. Devarapalli, &ldquo;Mobile IPv6 Bootstrapping in Split Scenario,&rdquo; October&nbsp;2007.</span><span>)</span></a> and also specifies Diameter support for the
         Authentication Protocol for Mobile IPv6 <a class='info' href='#RFC4285'>[RFC4285]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; January&nbsp;2006.</span><span>)</span></a>. The Diameter support
         defined in this specification also applies to Dual Stack
         Mobile IPv6 <a class='info' href='#I-D.ietf-mext-nemo-v4traversal'>[I&#8209;D.ietf&#8209;mext&#8209;nemo&#8209;v4traversal]<span> (</span><span class='info'>Soliman, H., &ldquo;Mobile IPv6 Support for Dual Stack Hosts and Routers,&rdquo; April&nbsp;2009.</span><span>)</span></a>.
      
</p>
<p>From a Mobility Service Provider (MSP) perspective, it is important to verify
        that the MN is authenticated and authorized to utilize Mobile
        IPv6 service, and is accounted for those. Only when the MN is authenticated and authorized, the MSP allows
        the bootstrapping of Mobile IPv6 parameters. Thus, prior to processing the Mobile IPv6
        registrations, the HA participates in the authentication of the MN to verify the MN's
        identity. The HA also participates in the Mobile IPv6 authorization process involving the
        Diameter infrastructure. The HA, due to its role in traffic forwarding, may also perform
        accounting for the Mobile IPv6 service provided to the MN.
</p>
<p>This document enables the following functionality:
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>Authentication:</dt>
<dd>Verifying the MN's identity. As a Diameter client 
            supporting the new Diameter Mobile IPv6 application,
            the HA may need to support more than one authentication type depending on the
            environment. Although the authentication is performed by the AAA server there is an
            impact for the HA as different set of command codes are needed for the respective
            authentication procedures. <br />

          
</dd>
<dt>Authorization:</dt>
<dd>The HA must verify that the user is authorized to the
            Mobile IPv6 service using the assistance of the MSP Diameter servers. This is
            accomplished through the use of new Diameter applications specifically designed for
            performing Mobile IPv6 authorization decisions. This
            document defines required AAA procedures and
            requires the HA to support them and to participate in this authorization
              signaling.<br />

          
</dd>
<dt>Accounting:</dt>
<dd> For accounting purposes and capacity planning, it is required
            that the HA provides accounting reports to the Diameter infrastructure and thus to
            support the related Diameter accounting procedures.<br />

          
</dd>
<dt>Session Management:</dt>
<dd>The management of the
             mobility services may require the Diameter server or the HA to
             terminate the Mobile IPv6 service before the binding
             expires. This document defines procedures for the AAA based session
             management.<br />

          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        <a class='info' href='#arch-mip6'>Figure&nbsp;1<span> (</span><span class='info'>Architecture Overview</span><span>)</span></a> depicts the reference architecture
        for this document.
</p><br /><hr class="insert" />
<a name="arch-mip6"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                     +--------+
                                     |Diameter|
                                     |Server  |
                                     +--------+
                                         ^
                                Back-End | Diameter Mobile IPv6
                                Protocol | HA&lt;-&gt;AAA Server
                                Support  | Interaction
                                         | (this document)
                                         v
 +---------+                      +---------------+
 | Mobile  |  Front-End Protocol  |Home Agent /   |
 | Node    |&lt;--------------------&gt;|Diameter Client|
 +---------+  IKEv2 or RFC 4285   +---------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Architecture Overview&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>Mobile IPv6 signaling between the MN and the HA can be protected using two different
        mechanisms, namely using IPsec or the Authentication Protocol for Mobile IPv6
        <a class='info' href='#RFC4285'>[RFC4285]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; January&nbsp;2006.</span><span>)</span></a>.
        For these two approaches several different
        authentication and key exchange solutions are available. When
        IPsec is used to protect Mobile IPv6 signaling messages, Internet Key Exchange
        v2 (IKEv2) is
        used <a class='info' href='#RFC4877'>[RFC4877]<span> (</span><span class='info'>Devarapalli, V. and F. Dupont, &ldquo;Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a> for the setup of the IPsec SAs. IKEv2 supports
        Extensible Authentication Protocol (EAP) based initiator authentication,
        certificates and pre-shared
        secrets. Alternatively, the Authentication Protocol for Mobile IPv6 uses a
        mechanism that is very similar to the one used for protecting
        Mobile IPv4 signaling messages.
      
</p>
<p>The ability to use different credentials and methods to
         authenticate the MN has an impact on the AAA interactions
         between the HA (acting as a Diameter client) and the Diameter
         Server. This specification is only limited to the following
         MN authentication methods:
      
</p>
<p>
        </p>
<ul class="text">
<li>IKEv2 usage with EAP
</li>
<li>Mobile IPv6 Authentication Protocol
</li>
</ul><p>
      
</p>
<p>New authentication mechanisms may be added later by separate specifications.
      
</p>
<p>For accounting of Mobile IPv6 services provided to the MN, this specification uses the
         Diameter Base Protocol accounting defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
      
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p> The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD
        NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as
        described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      
</p>
<p>The Mobile IPv6 bootstrapping terminology is taken from <a class='info' href='#RFC4640'>[RFC4640]<span> (</span><span class='info'>Patel, A. and G. Giaretta, &ldquo;Problem Statement for bootstrapping Mobile IPv6 (MIPv6),&rdquo; September&nbsp;2006.</span><span>)</span></a>. Additional terminology is defined below:
      
</p>
<p>
            </p>
<blockquote class="text"><dl>
<dt>Authentication, Authorization, and Accounting (AAA):</dt>
<dd>
                  <br />

                   AAA protocol based on Diameter <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> with required EAP support <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
                   <br />
<br />

               
</dd>
<dt>Home AAA (AAAH):</dt>
<dd>
                  <br />
 An authentication,
                  authorization and accounting server 
                  located in user's home network i.e., in the home
                  realm.
               
</dd>
</dl></blockquote><p>
         
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Application Identifiers</h3>

<p>This specification defines two new Diameter applications and
      their respective Application Identifiers:
      
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   Diameter Mobile IPv6 IKE   (MIP6I)  TBD by IANA
   Diameter Mobile IPv6 Auth  (MIP6A)  TBD by IANA

</pre></div>
<p>The MIP6I Application Identifier is used when the MN is authenticated
         and authorized using IKEv2. The MIP6A Application Identifier is used
         when the MN is authenticated and authorized using the Mobile IPv6
         Authentication Protocol.
      
</p>
<p>Mobile IPv6 related accounting information generated by the HA uses
         either the MIP6I or the MIP6A Application Identifier in the case of coupled
         accounting model. The Diameter Base Accounting Application Identifier
         (value of 3) is used in case of the split accounting
         model. Refer to <a class='info' href='#accounting_models'>Section&nbsp;4.4<span> (</span><span class='info'>Accounting for Mobile IPv6 services</span><span>)</span></a> for more information
         regarding the accounting models.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Description</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Support for Mobile IPv6 with IKEv2 and EAP</h3>

<p>The use of IKEv2 with EAP between the MN and the HA allows the AAA to authenticate the
          MN. When EAP is used with IKEv2, the Diameter EAP application logic and procedures, as defined 		  in <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, are re-used. EAP methods that do not establish a shared key SHOULD
          NOT be used, as they are subject to a number of man-in-the-middle attacks as stated in
          Section 2.16 and Section 5 of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. AVPs specific to Mobile
          IPv6 bootstrapping are added to the EAP application commands. 
</p>
<p>
          <a class='info' href='#fig-ikev2-diameter-msg'>Figure&nbsp;2<span> (</span><span class='info'>Mobile IPv6 bootstrapping using IKEv2 and EAP</span><span>)</span></a> shows the message flow involved during the
          authentication phase when EAP is used. The 
          communication between the mobile node and the home agent use the
          conventions defined in <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>. Similarly,
          the communication between the home agent and the Diameter server use
          the conventions defined in <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
          
</p><br /><hr class="insert" />
<a name="fig-ikev2-diameter-msg"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 Mobile                           Home                      Diameter
 Node                             Agent                     Server
  |                                 |                          |
  | HDR, SAi1, KEi, Ni  (1)         |                          |
  |--------------------------------&gt;|                          |
  |                                 |                          |
  | HDR, SAr1, KEr, Nr, [CERTREQ](2)|                          |
  |&lt;--------------------------------|                          |
  |                                 |                          |
  | HDR, SK{IDi,[CERTREQ,] [IDr,]   |                          |
  | [CP(CFG_REQUEST),]              |                          |
  | SAi2, TSi, TSr} (3)             | DER (EAP-Response) (4) + |
  |--------------------------------&gt;| MIP6 Bootstrapping AVPs  |
  |                                 |-------------------------&gt;|
  |                                 |                          |
  |                                 | DEA (EAP-Request) (5)    |
  | HDR, SK{IDr, [CERT,] AUTH, EAP} |&lt;-------------------------|
  |&lt;------------------------------- |                          |
  |                                 |                          |
  | HDR, SK{EAP}                    |                          |
  |--------------------------------&gt;| DER (EAP-Response)       |
  |                                 |-------------------------&gt;|
  |                                 |                          |
  |                                 | DEA (EAP-Request)        |
  | HDR, SK{EAP-Request}            |&lt;-------------------------|
  |&lt;--------------------------------|                          |
  |                                 |                          |
  | HDR, SK{EAP-Response}           |                          |
  |--------------------------------&gt;| DER (EAP-Response)       |
  |                                 |-------------------------&gt;|
  :               ...               :          ...             :
  |                                 |                          |
  |                                 | DEA (EAP-Success) +      |
  |                                 | MIP6 Bootstrapping AVPs  |
  | HDR, SK{EAP-Success}            |&lt;-------------------------|
  |&lt;--------------------------------|                          |
  |                                 |                          |
  | HDR, SK{AUTH}                   |                          |
  |--------------------------------&gt;|                          |
  |                                 |                          |
  | HDR, SK{AUTH, [CP(CFG_REPLY,]   |                          |
  | SAr2, TSi, TSr}                 |                          |
  |&lt;--------------------------------|                          |
  |                                 |                          |
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Mobile IPv6 bootstrapping using IKEv2 and EAP&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>The MN and the HA start the interaction with an IKE_SA_INIT exchange. In this phase
          cryptographic algorithms are negotiated, nonces and Diffie-Hellman parameters are
          exchanged. Message (3) starts the IKE_AUTH phase. This second phase authenticates the
          previous messages, exchanges identities and certificates and establishes the first
          CHILD_SA. It is used to mutually authenticate the MN (acting as an IKEv2 Initiator) and
          the HA (acting as an IKEv2 Responder). The identity of the user/MN is provided in the IDi
          field. The MN indicates its willingness to be authenticated via EAP by omitting the AUTH
          field in message (3) (see Section 2.16 of <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a>). 
</p>
<p>As part of the authentication process, the MN MAY request a Home-Address, a Home Prefix
          or suggests one, see <a class='info' href='#RFC4877'>[RFC4877]<span> (</span><span class='info'>Devarapalli, V. and F. Dupont, &ldquo;Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a>, using a CFG_REQUEST payload in the message
          (3).
</p>
<p>The HA extracts the IDi field from the message (3) and sends a Diameter-EAP-Request (DER)
          message (4) towards the authenticating Diameter server. The EAP-Payload AVP contains a
          EAP-Response/Identity with the identity extracted from the IDi field. 
</p>
<p>This message is routed to the MN's Diameter server/EAP server. The Diameter server selects
          the EAP method and replies with the Diameter-EAP-Answer (DEA) Message. Depending on the type of EAP method
          chosen, a number of DER and DEA messages carry the method specific exchanges between the
          MN and the Diameter server/EAP server. 
</p>
<p>At the end of the EAP authentication phase, the Diameter server indicates the result of
           the authentication in the Result-Code AVP and provides the corresponding EAP packet (EAP
           Success or EAP Failure). The last IKEv2 message sent by the HA contains the Home Address
           or the Home Prefix. In the latter case, a CREATE_CHILD_SA exchange is necessary to setup
           IPsec SAs for Mobile IPv6 signaling.
        
</p>
<p>In some deployment scenarios, the HA may also act as an IKEv2
           Responder for a conventional IPsec VPN access. The challenge in this case is that the
           IKEv2 responder may not know if IKEv2 is used for Mobile IPv6
           service or for IPsec VPN access service. A network operator needs to
           be aware of this  limitation. One solution already supported by IKEv2
           is to use different responder identities when operating as a
           conventional IPsec VPN gateway or as a HA. The MN can then indicate
           the preferred responder type using the appropriate IDr payload in
           the IKE_AUTH message.
        
</p>
<p>Eventually, when the HA receives a Binding Update (BU), the HA
           authenticates and authorizes the
           MN. It is RECOMMENDED that the HA sends an accounting request message
           every time it receives a BU.
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Support for the Mobile IPv6 Authentication Protocol</h3>

<p>
          <a class='info' href='#rfc4285-flow'>Figure&nbsp;3<span> (</span><span class='info'>Mobile IPv6            Bootstrapping using the Mobile IPv6 Authentication            Protocol</span><span>)</span></a> shows the message sequence
          between the MN, the HA and the Diameter server during the
          registration when Mobile IPv6 Authentication Protocol is
          used. A BU and a Binding Acknowledgement (BA) messages are used
          in the binding registration process.
        
</p>
<p>Receiving a BU at the HA initiates a MIP6-Request
           to be sent to the Diameter server. The Diameter server in
           turn responds with a MIP6-Answer. The HA
           may assign a Home Address to the MN and provide it to the
           Diameter server in the MIP-Mobile-Node-Address AVP. 
        
</p>
<p>According to <a class='info' href='#RFC4285'>[RFC4285]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; January&nbsp;2006.</span><span>)</span></a> the
          MN uses the Mobile Node Identifier Option, specifically the
          MN-NAI mobility option (as defined in <a class='info' href='#RFC4283'>[RFC4283]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Mobile Node Identifier Option for Mobile IPv6 (MIPv6),&rdquo; November&nbsp;2005.</span><span>)</span></a>) to identify itself. The HA MUST copy the
          MN-NAI mobility option value to the User-Name AVP in the
          subsequent request messages. 
        
</p>
<p>The procedure described in this specification for the
           Mobile IPv6 Authentication Protocol is only needed for the
           initially received BU for which the HA does not have an
           existing security association. When the HA receives
           subsequent BUs, they are processed locally in the HA. It is
           RECOMMENDED that the HA sends an accounting request message
           every time it receives a Binding Update. However, the HA
           MAY re-authorize the MN with the Diameter server at any
           time depending on the deployment and the local policy.
        
</p>
<p>This specification assumes that in the case Mobile IPv6
           Authentication Protocol is used, the MN-AAA option is included in the
           BU as defined in <a class='info' href='#RFC4285'>[RFC4285]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; January&nbsp;2006.</span><span>)</span></a> and the Diameter
           server computes required session keys after having successfully
           authenticated the MN. The computation of the session keys is out of
           scope of this specification. Other possible ways of using Mobile
           IPv6 Authentication Protocol are also out of scope of this
           specification and would require a new specification to describe the
           detailed behavior of the HA-AAAH interface and corresponding session
           key derivation.
        
</p>
<p>
          <br /><hr class="insert" />
<a name="rfc4285-flow"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Mobile                                Home                Diameter
  Node                                  Agent                 Server
    |                                     |                     |
    |                                     | MIP6-Request + MIP6 |
    |       Binding Update                | Bootstrapping AVPs  |
    |------------------------------------&gt;|--------------------&gt;|
    | (Mobile Node Identifier Option,     |                     |
    |  Mobility Message Replay Protection |                     |
    |  Option, Authentication Option)     |                     |
    |                                     |                     |
    |                                     | MIP6-Answer + MIP6  |
    |       Binding Acknowledgement       | Bootstrapping AVPs  |
    |&lt;------------------------------------|&lt;--------------------|
    | (Mobile Node Identifier Option      |                     |
    |  Mobility Message Replay Protection |                     |
    |  Option, Authentication Option)     |                     |
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Mobile IPv6
           Bootstrapping using the Mobile IPv6 Authentication
           Protocol&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Mobile IPv6 Session Management</h3>

<p>The Diameter server may maintain state or may be stateless. This
           is indicated in the Auth-Session-State AVP (or its absence). The
           HA MUST support the Authorization Session
           State Machine defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
        
</p>
<p>This specification makes an assumption that each SA created
           between the MN and the HA as a result of a successful IKEv2
           negotiation or a Mobile IPv6 Authentication
           Protocol exchange correspond to one Diameter session. In IKEv2
           case we specifically mean the created IKE SA.
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Session-Termination-Request</h3>

<p>The Session-Termination-Request (STR) message <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>
             is sent by the HA to inform the Diameter server that an authorized
             session is being terminated. This means that the HA MUST terminate the
             corresponding Mobile IPv6 binding and also
             terminate the corresponding SA.
          
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Session-Termination-Answer</h3>

<p>The Session-Termination-Answer (STA) message <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the
            Diameter server to acknowledge the notification that the session has been
          terminated.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.3"></a><h3>4.3.3.&nbsp;
Abort-Session-Request</h3>

<p>The Abort-Session-Request (ASR) message <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the
            Diameter server to the HA to terminate the authorized session. This fulfills one
            of the requirement
            described in <a class='info' href='#I-D.ietf-mext-aaa-ha-goals'>[I&#8209;D.ietf&#8209;mext&#8209;aaa&#8209;ha&#8209;goals]<span> (</span><span class='info'>Giaretta, G., Guardini, I., Demaria, E., Bournelle, J., and R. Lopez, &ldquo;AAA Goals for Mobile IPv6,&rdquo; May&nbsp;2008.</span><span>)</span></a>. When the HA receives
            the ASR message, it MUST terminate the corresponding SA. Subsequently,
            the HA MUST take further actions to terminate the corresponding Mobile IPv6
            binding.
          
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.4"></a><h3>4.3.4.&nbsp;
Abort-Session-Answer</h3>

<p>The Abort-Session-Answer (ASA) message <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the Home
            Agent in response to an ASR message.
</p>
<a name="accounting_models"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Accounting for Mobile IPv6 services</h3>

<p>The HA MUST be able act as a Diameter client collecting accounting records needed for
          service control and charging. The HA MUST support the accounting procedures (specifically
          the command codes mentioned below) and the Accounting Session State Machine as defined in
            <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. The command codes, exchanged between the HA and Diameter
          server for accounting purposes, are provided in the following subsections.
</p>
<p>The Diameter application design guideline <a class='info' href='#I-D.ietf-dime-app-design-guide'>[I&#8209;D.ietf&#8209;dime&#8209;app&#8209;design&#8209;guide]<span> (</span><span class='info'>Fajardo, V., Tschofenig, H., and L. Morand, &ldquo;Diameter Applications Design Guidelines,&rdquo; March&nbsp;2010.</span><span>)</span></a>
          defines two separate models for accounting:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>Split accounting model:</dt>
<dd><br />
 According to this model,
              the accounting messages use the Diameter Base Accounting Application Identifier (value of 3).
              Since accounting is treated as an independent application, accounting commands may be
              routed separately from the rest of application messages and thus the accounting
              messages generally end up in a central accounting server. Since Diameter Mobile IPv6
              application does not define its own unique accounting commands, this is the preferred
              choice, since it permits use of centralized accounting for several
                applications.<br />
<br />

</dd>
<dt>Coupled accounting model:</dt>
<dd><br />
 In this model, the
              accounting messages will use either the MIP6I
              or the MIP6A Application Identifiers. This
              means that accounting messages will be routed like any other Mobile IPv6 application
              messages. This requires the Diameter server in charge of Mobile IPv6 application to
              handle the accounting records (e.g., sends them to a proper accounting server).
</dd>
</dl></blockquote><p>
        
</p>
<p>As mentioned above, the preferred choice is to use the split accounting model and thus to
          choose Diameter Base Accounting Application Identifier (value of 3) for accounting messages.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.1"></a><h3>4.4.1.&nbsp;
Accounting-Request</h3>

<p>The Accounting-Request command <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the HA to the
            Diameter server to exchange accounting information regarding the MN with the Diameter
            server.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4.2"></a><h3>4.4.2.&nbsp;
Accounting-Answer</h3>

<p>The Accounting-Answer command <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> is sent by the Diameter server
            to the HA to acknowledge an Accounting-Request.
</p>
<a name="Command-Code-Values"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Command Codes</h3>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Command Code for Mobile IPv6 with IKEv2 and EAP</h3>

<p>For the use of Mobile IPv6 with IKEv2 and EAP this document
          reuses the Diameter EAP application <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>
          commands: Diameter-EAP-Request (DER) and Diameter-EAP-Answer
          (DEA).
          This specification extends the existing DER and DEA command ABNFs
          with a number of AVPs to support Mobile IPv6
          split scenario bootstrapping. Other than new additional AVPs
          and the corresponding additions to the command ABNFs, the
          Diameter EAP application command ABNFs remain unchanged. The
          ABNF language is defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
        
</p>
<p>
          <br /><hr class="insert" />
<a name="cmd-eap"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Command-Name          Abbrev. Code Reference Application
---------------------------------------------------------------------
Diameter-EAP-Request  DER     268  RFC 4072  Diameter Mobile IPv6 IKE
Diameter-EAP-Answer   DEA     268  RFC 4072  Diameter Mobile IPv6 IKE
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Command Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.1"></a><h3>5.1.1.&nbsp;
Diameter-EAP-Request</h3>

<p>The Diameter-EAP-Request (DER) message, indicated by the
             Command-Code field set to 268 and the 'R' bit set in the Command Flags field, is sent by
             the HA to the Diameter server to initiate a Mobile IPv6 service authentication and
             authorization procedure. The Application-ID field of the Diameter Header MUST be set to the
             Diameter Mobile IPv6 IKE Application ID (value of TDB).
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;Diameter-EAP-Request&gt; ::= &lt; Diameter Header: 268, REQ, PXY &gt;
                           &lt; Session-Id &gt;
                           { Auth-Application-Id }
                           { Origin-Host }
                           { Origin-Realm }
                           { Destination-Realm }
                           { Auth-Request-Type }
                           [ Destination-Host ]
                           [ NAS-Identifier ]
                           [ NAS-IP-Address ]
                           [ NAS-IPv6-Address ]
                           [ NAS-Port-Type ]
                           [ User-Name ]
                           ...
                           { EAP-Payload }
                           ...
                           [ MIP6-Feature-Vector ]
                           [ MIP6-Agent-Info ]
                         *2[ MIP-Mobile-Node-Address ]
                           [ Chargeable-User-Identity ]
                           [ Service-Selection ]
                           [ QoS-Capability ]
                         * [ QoS-Resources ]
                           ...
                         * [ AVP ]
</pre></div><p>

          
</p>
<p>Mobile IPv6 bootstrapping AVPs are only included in the
             first DER message send by the HA. The subsequent DER
             messages required 
             by the EAP-method do not need to include any Mobile
             IPv6 bootstrapping AVPs. The MN is both authenticated and
             authorized for the mobility service during the EAP
             authentication. Thus, the Auth-Request-Type AVP MUST be set to
             the value AUTHORIZE_AUTHENTICATE. 
          
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1.2"></a><h3>5.1.2.&nbsp;
Diameter-EAP-Answer</h3>

<p>The Diameter-EAP-Answer (DEA) message, indicated by
             the Command-Code field set to 268 and 'R' bit cleared in the Command Flags field, is
             sent in response to the Diameter-EAP-Request message
             (DER). The
             Application-Id field in the Diameter message header MUST be set to the Diameter Mobile IPv6
             IKE Application-Id (value of TBD). If the Mobile IPv6
             authentication procedure was successful then the response MAY include any set of
             bootstrapping AVPs.
          
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;Diameter-EAP-Answer&gt; ::= &lt; Diameter Header: 268, PXY &gt;
                          &lt; Session-Id &gt;
                          { Auth-Application-Id }
                          { Auth-Request-Type }
                          { Result-Code }
                          { Origin-Host }
                          { Origin-Realm }
                          [ User-Name ]
                          [ EAP-Payload ]
                          [ EAP-Reissued-Payload ]
                          [ EAP-Master-Session-Key ]
                          [ EAP-Key-Name ]
                          [ Multi-Round-Time ]
                          ...
                        *2[ MIP-Mobile-Node-Address ]
                          [ MIP6-Feature-Vector ]
                          [ MIP6-Agent-Info ]
                          [ Service-Selection ]
                        * [ QoS-Resources ]
                          [ Chargeable-User-Identity ]
                          ...
                        * [ AVP ]
</pre></div><p>

          
</p>
<p>If the EAP-based authentication and the authorization for the
             mobility service succeeds, then the Mobile IPv6
             bootstrapping AVPs are included in the last DEA message
             that also carries the EAP-Success EAP payload. The other
             DEA messages required by the used EAP-method do not
             include any Mobile IPv6 bootstrapping AVPs.
          
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Command Codes for Mobile IPv6 Authentication Protocol Support</h3>

<p>This section defines the commands that are used for
          support with the Mobile IPv6 Authentication
          Protocol.
        
</p>
<p>There are multiple ways of deploying and utilizing Mobile
           IPv6 Authentication Protocol, especially regarding the
           associated AAA interactions. In order to support multiple
           deployment models this specification defines the
           MIP6-Auth-Mode AVP that in the request message tells the
           mode that the HA supports. This specification defines a
           method that requires the use of the MN-AAA option with the
           Mobile IPv6 Authentication Protocol.
        
</p>
<p>
          <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Command-Name       Abbrev. Code  Reference Application
---------------------------------------------------------------------
MIP6-Request       MIR     TBD   5.3.1     Diameter Mobile IPv6 Auth
MIP6-Answer        MIA     TBD   5.3.2     Diameter Mobile IPv6 Auth
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Command Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
MIP6-Request</h3>

<p>The MIP6-Request (MIR), indicated by the Command-Code field set to TBD and the
            'R' bit set in the Command Flags field, is sent by the HA, acting as a Diameter client,
            in order to request the authentication and authorization
            of a MN.
</p>
<p>Although the HA provides the Diameter server with replay protection related
             information, the HA is responsible for the replay protection.
          
</p>
<p>The message format is shown below.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;MIP6-Request&gt; ::= &lt; Diameter Header: TBD, REQ, PXY &gt;
                   &lt; Session-ID &gt;
                   { Auth-Application-Id }
                   { User-Name }
                   { Destination-Realm }
                   { Origin-Host }
                   { Origin-Realm }
                   { Auth-Request-Type }
                   [ Destination-Host ]
                   [ Origin-State-Id ]
                   [ NAS-Identifier ]
                   [ NAS-IP-Address ]
                   [ NAS-IPv6-Address ]
                   [ NAS-Port-Type ]
                   [ Called-Station-Id ]
                   [ Calling-Station-Id ]
                   [ MIP6-Feature-Vector ]
                   { MIP6-Auth-Mode }
                   [ MIP-MN-AAA-SPI ]
                   [ MIP-MN-HA-SPI ]
                1*2{ MIP-Mobile-Node-Address }
                   { MIP6-Agent-Info }
                   { MIP-Careof-Address }
                   [ MIP-Authenticator ]
                   [ MIP-MAC-Mobility-Data ]
                   [ MIP-Timestamp ]
                   [ QoS-Capability ]
                 * [ QoS-Resources ]
                   [ Chargeable-User-Identity ]
                   [ Service-Selection ]
                   [ Authorization-Lifetime ]
                   [ Auth-Session-State ]
                 * [ Proxy-Info ]
                 * [ Route-Record ]
                 * [ AVP ]
</pre></div><p>

          
</p>
<p>If the MN is both authenticated and authorized for the
             mobility service, then the Auth-Request-Type AVP is set to
             the value AUTHORIZE_AUTHENTICATE. This is the case when
             the MIP6-Auth-Mode is set to the value MIP6_AUTH_MN_AAA.
          
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
MIP6-Answer</h3>

<p> The MIP6-Answer (MIA) message, indicated by the Command-Code field set to TBD
            and the 'R' bit cleared in the Command Flags field, is sent by the Diameter server in
            response to the MIP6-Request message. The User-Name AVP MAY be included in the MIA
            if it is present in the MIR. The Result-Code AVP MAY contain one of the values defined
            in <a class='info' href='#result'>Section&nbsp;7<span> (</span><span class='info'>Result-Code AVP Values</span><span>)</span></a>, in addition to the values defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
</p>
<p>An MIA message with the Result-Code AVP set to DIAMETER_SUCCESS MUST include the
            MIP-Mobile-Node-Address AVP.
</p>
<p> The message format is shown below.
</p>
<p>
            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;MIP6-Answer&gt; ::= &lt; Diameter Header: TBD, PXY &gt;
                  &lt; Session-Id &gt;
                  { Auth-Application-Id }
                  { Result-Code }
                  { Origin-Host }
                  { Origin-Realm }
                  { Auth-Request-Type }
                  [ User-Name ]
                  [ Authorization-Lifetime ]
                  [ Auth-Session-State ]
                  [ Error-Message ]
                  [ Error-Reporting-Host ]
                  [ Re-Auth-Request-Type ]
                  [ MIP6-Feature-Vector ]
                  [ MIP-Agent-Info ]
                *2[ MIP-Mobile-Node-Address ]
                  [ MIP-MN-HA-MSA ]
                * [ QoS-Resources ]
                  [ Chargeable-User-Identity ]
                  [ Service-Selection ]
                  [ Origin-State-Id ]
                * [ Proxy-Info ]
                * [ Redirect-Host ]
                  [ Redirect-Host-Usage ]
                  [ Redirect-Max-Cache-Time ]
                * [ Failed-AVP ]
                * [ AVP ]
</pre></div><p>

          
</p>
<a name="avps"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
AVPs</h3>

<p>To provide support for <a class='info' href='#RFC4285'>[RFC4285]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; January&nbsp;2006.</span><span>)</span></a> and for
         <a class='info' href='#RFC4877'>[RFC4877]<span> (</span><span class='info'>Devarapalli, V. and F. Dupont, &ldquo;Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a> the AVPs in the following subsections are
         needed. <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>, <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> and
         <a class='info' href='#RFC4005'>[RFC4005]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> defined AVPs are
         reused whenever possible without changing the existing 
         semantics of those AVPs.
      
</p>
<p>
        <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                          +--------------------+
                                          |   AVP Flag rules   |
                                          +----+---+------+----+----+
                 AVP  Defined             |    |   |SHOULD|MUST|MAY |
 Attribute Name  Code in       Value Type |MUST|MAY| NOT  | NOT|Encr|
+-----------------------------------------+----+---+------+----+----+
|MIP6-Feature-   124  RFC5447  Unsigned64 |  M | P |      | V  | Y  |
|  Vector                                 |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP-Mobile-                              |  M | P |      | V  | Y  |
|  Node-Address  334  RFC4004  Address    |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP6-Agent-Info 486  RFC5447  Grouped    |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|User-Name       1    RFC3588  UTF8String |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|Service-        TBD  6.2      UTF8String |  M | P |      | V  | Y  |
|  Selection                              |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|QoS-Capability  TBD  Note 1   Grouped    |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|QoS-Resources   TBD  Note 1   Grouped    |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|MIP-MN-HA-MSA   TBD  6.12     Grouped    |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|Chargeable-User-              OctetString|  M | P |      | V  | Y  |
|  Identity      89   6.19                |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AVPs for Mobile IPv6 IKE Application&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<p>Note 1: The QoS-Capability and the QoS-Resource AVPs are defined
        in Sections 4.1 and 4.3 of <a class='info' href='#I-D.ietf-dime-qos-attributes'>[I&#8209;D.ietf&#8209;dime&#8209;qos&#8209;attributes]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;Traffic Classification and Quality of Service Attributes for Diameter,&rdquo; December&nbsp;2009.</span><span>)</span></a>.
      
</p>
<p>
        <br /><hr class="insert" />
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                          +--------------------+
                                          |   AVP Flag rules   |
                                          +----+---+------+----+----+
                 AVP  Section             |    |   |SHOULD|MUST|MAY |
 Attribute Name  Code Defined  Value Type |MUST|MAY| NOT  | NOT|Encr|
+-----------------------------------------+----+---+------+----+----+
|MIP6-Feature-   124  RFC5447  Unsigned64 |  M | P |      | V  | Y  |
|  Vector                                 |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|User-Name       1    RFC3588  UTF8String |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|Service-        TBD  6.2      UTF8String |  M | P |      | V  | Y  |
|  Selection                              |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP-MN-AAA-SPI  341  RFC4004  Unsigned32 |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|MIP-MN-HA-SPI   TBD  6.4      Unsigned32 |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|MIP-Mobile-     333  RFC4004  Address    |  M | P |      | V  | Y  |
|  Node-Address                           |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP6-Agent-Info 486  RFC5447  Grouped    |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|MIP-Careof-     TBD  6.7      Address    |  M | P |      | V  | Y  |
|  Address                                |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP-            TBD  6.8      OctetString|  M | P |      | V  | Y  |
|  Authenticator                          |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP-MAC-        TBD  6.9      OctetString|  M | P |      | V  | Y  |
|  Mobility-Data                          |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP-Session-Key 343  6.10     OctetString|  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|MIP-MSA-        367  RFC4004  Unsigned32 |  M | P |      | V  | Y  |
|  Lifetime                               |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP-MN-HA-MSA   TBD  6.12     Grouped    |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|MIP-Algorithm-  345  6.13     Enumerated |  M | P |      | V  | Y  |
|  Type                                   |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP-Replay-Mode 346  6.14     Enumerated |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|MIP-Timestamp   TBD  6.16     OctetString|  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|QoS-Capability  TBD  Note 1   Grouped    |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|QoS-Resources   TBD  Note 1   Grouped    |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|Chargeable-User-              OctetString|  M | P |      | V  | Y  |
|  Identity      89   6.19                |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
|MIP6-Auth-Mode  TBD  6.20     Enumerated |  M | P |      | V  | Y  |
+-----------------------------------------+----+---+------+----+----+
|Rest of the AVPs     RFC3588             |  M | P |      | V  | Y  |
|in the MIR &amp; MIA     RFC4005             |    |   |      |    |    |
|excluding *[AVP]                         |    |   |      |    |    |
+-----------------------------------------+----+---+------+----+----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;AVPs for the Mobile IPv6 Auth Application&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

      
</p>
<p>Note 1: The QoS-Capability and the QoS-Resource AVPs are defined
          in Sections 4.1 and 4.3 of <a class='info' href='#I-D.ietf-dime-qos-attributes'>[I&#8209;D.ietf&#8209;dime&#8209;qos&#8209;attributes]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;Traffic Classification and Quality of Service Attributes for Diameter,&rdquo; December&nbsp;2009.</span><span>)</span></a>.
      
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
User-Name AVP</h3>

<p>The User-Name AVP (AVP Code 1) is of type UTF8String and contains an NAI extracted from
          the MN-NAI mobility option included in the received BU message. Alternatively, the NAI can
          be extracted from the IKEv2 IDi payload included in the IKE_AUTH message sent by the
          IKE initiator. 
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Service-Selection AVP</h3>

<p>The Service-Selection AVP (AVP Code TBD) is of type
           UTF8String and contains the name of the service or the
           external network that the mobility service should be
           associated with. In the scope of this specification the value 
           can extracted from the IKEv2 IDr payload, if available in
           the IKE_AUTH  message sent by the IKE
           initiator. Alternatively, if the Mobile IPv6
           Authentication Protocol is used, then the Service-Selection AVP contains the string 
           extracted from the Service Selection Mobility Option <a class='info' href='#RFC5149'>[RFC5149]<span> (</span><span class='info'>Korhonen, J., Nilsson, U., and V. Devarapalli, &ldquo;Service Selection for Mobile IPv6,&rdquo; February&nbsp;2008.</span><span>)</span></a>, if available in the received
           BU. Future specification may define additional ways to
           populate the Service-Selection AVP with the required
           information. 
        
</p>
<p>The AVP is also available to be used in messages sent from
           the Diameter server to the Diameter client. For example, if the
           request message did not contain the Service-Selection AVP but
           the MN was assigned with a default service, the Diameter server MAY
           return the name of the assigned default service to the HA.
	    
</p>
<p>If the Service-Selection AVP is present in both the request and
           the reply messages, it SHOULD contain the same service name. If
           the services differ, the HA MAY treat that as authorization
           failure.
        
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
MIP-MN-AAA-SPI AVP</h3>

<p>The MIP-MN-AAA-SPI AVP (AVP Code 341) is of type Unsigned32 and
           contains an SPI code extracted from the Mobility Message
           Authentication Option included in the received BU
           message. This AVP is re-used from <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
        
</p>
<p>When the MIP6-Auth-Mode AVP is set to value MIP6_AUTH_MN_AAA, this
           AVP MUST be present in the MIR message.
        
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
MIP-MN-HA-SPI AVP</h3>

<p>The MIP-MN-HA-SPI AVP (AVP Code TBD) is of type Unsigned32 and contains
           an SPI value that can be used with other parameters for identifying the
           security association required for the validation of the Mobile IPv6
           MN-HA Authentication Option.
        
</p>
<p>When the MIP6-Auth-Mode AVP is set to value MIP6_AUTH_MN_AAA, and
           the Diameter server returns a valid MIP-MN-HA-MSA AVP in the MIA
           message, this AVP MUST be present inside the MIP-MN-HA-MSA AVP.
        
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
MIP-Mobile-Node-Address AVP</h3>

<p>The MIP-Mobile-Node-Address AVP (AVP Code 333) is of type Address and contains the HA
          assigned IPv6 or IPv4 Home Address of the Mobile Node. 
</p>
<p> If the MIP-Mobile-Node-Address AVP contains the unspecified
          IPv6 address (0::0) or the all zeroes IPv4 address (0.0.0.0) in a request
          message, then the HA expects the Diameter server to assign the Home Address in a
          subsequent answer message. If the Diameter server
          assigns only an IPv6 Home Network
          Prefix to the Mobile
          Node the lower 64 bits of the MIP-Mobile-Node-Address AVP provided address MUST be set to
          zero.
</p>
<p> This AVP is re-used from <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.6"></a><h3>6.6.&nbsp;
MIP6-Agent-Info AVP</h3>

<p>The MIP6-Agent-Info AVP (AVP Code 486) is defined in Section 4.2.1 of <a class='info' href='#RFC5447'>[RFC5447]<span> (</span><span class='info'>Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C., and K. Chowdhury, &ldquo;Diameter Mobile IPv6: Support for Network Access Server to Diameter Server Interaction,&rdquo; February&nbsp;2009.</span><span>)</span></a> and  contains the IPv6
           or the IPv4 address information of the HA. The HA address in a
           request message is the same as in the received BU
           message that triggered the authentication and authorization
           procedure towards the Diameter server. One use case is e.g., to inform the
           Diameter server of the dynamically assigned HA.
        
</p>
<p>If the MIP6-Agent-Info AVP is present in an answer
           message and the Result-Code AVP is set to DIAMETER_SUCCESS_RELOCATE_HA, then the
           Diameter server is indicating to the HA that it MUST
           initiate a HA switch procedure towards the MN
           (e.g., using the procedure defined in <a class='info' href='#RFC5142'>[RFC5142]<span> (</span><span class='info'>Haley, B., Devarapalli, V., Deng, H., and J. Kempf, &ldquo;Mobility Header Home Agent Switch Message,&rdquo; January&nbsp;2008.</span><span>)</span></a>). If the Result-Code AVP is set to any
           other value, then the HA SHOULD initiate the HA
           switch procedure towards the MN. The address information of the assigned HA
           is defined in the MIP6-Agent-Info AVP.
        
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.7"></a><h3>6.7.&nbsp;
MIP-Careof-Address AVP</h3>

<p>The MIP-Careof-Address AVP (AVP Code TBD) is of type Address and contains the IPv6
          or the IPv4
          Care-of Address of the Mobile Node. The HA extracts this IP address from the
          received BU message. 
       
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.8"></a><h3>6.8.&nbsp;
MIP-Authenticator AVP</h3>

<p>The MIP-Authenticator AVP (AVP Code TBD) is of type OctetString
           and contains the Authenticator Data from the received BU message.
           The HA extracts this data from the MN-AAA Mobility Message
           Authentication Option included in the received BU message.
        
</p>
<p>When the MIP6-Auth-Mode AVP is set to value MIP6_AUTH_MN_AAA,
           this AVP MUST be present in the MIR message.
        
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.9"></a><h3>6.9.&nbsp;
MIP-MAC-Mobility-Data AVP</h3>

<p>The MIP-MAC-Mobility-Data AVP (AVP Code TBD) is of type OctetString
           and contains the MAC_Mobility_Data calculated by the HA as defined
           in <a class='info' href='#RFC4285'>[RFC4285]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; January&nbsp;2006.</span><span>)</span></a> for the MN-AAA Mobility Message
           Authentication Option.
        
</p>
<p>When the MIP6-Auth-Mode AVP is set to value MIP6_AUTH_MN_AAA, 
           this AVP MUST be present in the MIR message.
        
</p>
<a name="mip-session-key"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.10"></a><h3>6.10.&nbsp;
MIP-Session-Key AVP</h3>

<p>The MIP-Session-Key AVP (AVP Code 343) is of type OctetString and contains
          the MN-HA shared secret (i.e.,
          the session key) for the associated Mobile IPv6 MH-HA authentication option. When the
          Diameter server computes the session key it is placed in this AVP.
          How the Diameter server computes the session key is not defined in
          this specification. The Session key derivation is deployment
          specific and needs to be defines in a respective deployment specific
          system specification.
        
</p>
<p>This AVP is re-used from <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
        
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.11"></a><h3>6.11.&nbsp;
MIP-MSA-Lifetime AVP</h3>

<p>The MIP-MSA-Lifetime AVP (AVP Code 367) is of type Unsigned32 and represents the period of time (in
          seconds) for which the session key (see <a class='info' href='#mip-session-key'>Section&nbsp;6.10<span> (</span><span class='info'>MIP-Session-Key AVP</span><span>)</span></a>)
          is valid. The associated session key MUST NOT be
          used if the lifetime has expired. 
</p>
<p> This AVP is re-used from <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.12"></a><h3>6.12.&nbsp;
MIP-MN-HA-MSA AVP</h3>

<p>The MIP-MN-HA-MSA AVP (AVP Code TBD) is of type Grouped and contains the session related information
          for use with the Mobile IPv6 Authentication Protocol.
</p>
<p>
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
MIP-MN-HA-MSA ::= &lt; AVP Header: TBD &gt;
                  { MIP-Session-Key }
                  { MIP-MSA-Lifetime }
                  [ MIP-MN-HA-SPI ]
                  [ MIP-Algorithm-Type ]
                  [ MIP-Replay-Mode ]
                * [ AVP ]
</pre></div><p>

        
</p>
<p>The MIP-MN-HA-SPI sub-AVP within the MIP-MN-HA-MSA grouped AVP
           identifies the security association required for the validation
           of the Mobile IPv6 MN-HA Authentication Option. The absence of the
           MIP-Replay-Mode AVP MUST be treated as no replay protection
           was selected. 
        
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.13"></a><h3>6.13.&nbsp;
MIP-Algorithm-Type AVP</h3>

<p>The MIP-Algorithm-Type AVP (AVP Code 345) is of type Enumerated and
           contains Algorithm identifier for the
          associated Mobile IPv6 MN-HA Authentication Option. The Diameter server selects the
          algorithm type. Existing algorithm types are defined in
          <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> that also fulfill current
          RFC 4285 requirements. This AVP is re-used from
          <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
       
</p>
<p>When the MIP6-Auth-Mode AVP is set to value MIP6_AUTH_MN_AAA, and
          the Diameter server returns a valid MIP-MN-HA-MSA AVP in the MIA
          message, this AVP MUST be present inside the MIP-MN-HA-MSA AVP.
       
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.14"></a><h3>6.14.&nbsp;
MIP-Replay-Mode AVP</h3>

<p>The MIP-Replay-Mode AVP (AVP Code 346) is of type Enumerated and
           contains the replay mode the HA
           for authenticating the mobile node. Out of all possible replay modes
           defined in <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, the following
           are supported by this specification:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    1   None
    2   Timestamp

</pre></div>
<p>This AVP is re-used from <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.15"></a><h3>6.15.&nbsp;
MIP6-Feature-Vector AVP</h3>

<p>The MIP6-Feature-Vector AVP (AVP Code 124) is defined in
           <a class='info' href='#RFC5447'>[RFC5447]<span> (</span><span class='info'>Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C., and K. Chowdhury, &ldquo;Diameter Mobile IPv6: Support for Network Access Server to Diameter Server Interaction,&rdquo; February&nbsp;2009.</span><span>)</span></a>. However, this specification does not define
           any Mobile IPv6 split scenario bootstrapping
           specific capability flag.
        
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.16"></a><h3>6.16.&nbsp;
MIP-Timestamp AVP</h3>

<p>The MIP-Timestamp AVP (AVP Code TBD) is of type OctetString and 
           contains eight octets timestamp value (i.e. 64 bits timestamp)
           from the Mobility message replay protection option, defined in 
           <a class='info' href='#RFC4285'>[RFC4285]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; January&nbsp;2006.</span><span>)</span></a>. The HA extracts this
           value from the received BU message, if available.
           The HA includes this AVP in the MIR message when
           the MN-AAA Mobility Message Authentication Option is available in
           the received BU and the Diameter server is expected to
           return the key material required for the calculation 
           and validation of the Mobile IPv6 MN-HA Authentication
           Option (and the MIP6-Auth-Mode AVP is set to value
           MIP6_AUTH_MN_AAA). 
        
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.17"></a><h3>6.17.&nbsp;
QoS-Capability AVP</h3>

<p>The QoS-Capability AVP is defined in <a class='info' href='#I-D.ietf-dime-qos-attributes'>[I&#8209;D.ietf&#8209;dime&#8209;qos&#8209;attributes]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;Traffic Classification and Quality of Service Attributes for Diameter,&rdquo; December&nbsp;2009.</span><span>)</span></a> and
          contains a list of supported Quality of Service profiles.
        
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.18"></a><h3>6.18.&nbsp;
QoS-Resources AVP</h3>

<p>The QoS-Resources AVP is defined in <a class='info' href='#I-D.ietf-dime-qos-attributes'>[I&#8209;D.ietf&#8209;dime&#8209;qos&#8209;attributes]<span> (</span><span class='info'>Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;Traffic Classification and Quality of Service Attributes for Diameter,&rdquo; December&nbsp;2009.</span><span>)</span></a> and
          provides QoS and packet filtering capabilities.
        
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.19"></a><h3>6.19.&nbsp;
Chargeable-User-Identity AVP</h3>

<p>The Chargeable-User-Identity AVP (AVP code 89) is of type
           OctetString and contains an unique temporary handle of the
           user. The Chargeable-User-Identity is defined in
           <a class='info' href='#RFC4372'>[RFC4372]<span> (</span><span class='info'>Adrangi, F., Lior, A., Korhonen, J., and J. Loughney, &ldquo;Chargeable User Identity,&rdquo; January&nbsp;2006.</span><span>)</span></a>.
        
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.20"></a><h3>6.20.&nbsp;
MIP6-Auth-Mode AVP</h3>

<p>The MIP6-Auth-Mode (AVP Code TBD) is of type Enumerated and
           contains information of the used Mobile IPv6 Authentication
           Protocol mode. This specification defines only one value
           MIP6_AUTH_MN_AAA and the corresponding AAA interactions when
           MN-AAA security association is used to authenticate the
           Binding Update as described in <a class='info' href='#RFC4285'>[RFC4285]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; January&nbsp;2006.</span><span>)</span></a>.
           When the MIP6-Auth_Mode AVP is set to the
           value of MIP6_AUTH_MN_AAA, the Auth-Request-Type AVP MUST
           be set to the value of AUTHORIZE_AUTHENTICATE.
        
</p>
<p>If the Diameter server does not support the Mobile IPv6
           Authentication Protocol usage mode proposed by the HA, then
           the Diameter server MUST fail the
           authentication/authorization and MUST set the Result-Code AVP to
           the value of DIAMETER_ERROR_AUTH_MODE.
        
</p>
<a name="accounting"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.21"></a><h3>6.21.&nbsp;
Accounting AVPs</h3>

<p>Diameter Mobile IPv6 applications, either MIP6I or MIP6A, are used
           in the case of the coupled account model. 
           Diameter Mobile IPv4 application <a class='info' href='#RFC4004'>[RFC4004]<span> (</span><span class='info'>Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;Diameter Mobile IPv4 Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> accounting
           AVPs are reused in this document. The following AVPs SHOULD be included in the
           accounting request message:
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>o</dt>
<dd>Accounting-Input-Octets: Number of octets in IP
              packets received from the mobile node.
            
</dd>
<dt>o</dt>
<dd>Accounting-Output-Octets: Number of octets in IP
              packets sent by the mobile node
            
</dd>
<dt>o</dt>
<dd>Accounting-Input-Packets: Number of IP packets
              received from the mobile node.
            
</dd>
<dt>o</dt>
<dd>Accounting-Output-Packets: Number of IP packets
              sent by the mobile node.
            
</dd>
<dt>o</dt>
<dd>Acct-Multi-Session-Id: Used to link together
            	multiple related accounting sessions, where each session would have a unique
            	Session-Id, but the same Acct-Multi-Session-Id AVP.
</dd>
<dt>o</dt>
<dd>Acct-Session-Time: Indicates the length
            	of the current session in seconds.
</dd>
<dt>o</dt>
<dd>MIP6-Feature-Vector: The supported features for this mobility
                              service session.
            
</dd>
<dt>o</dt>
<dd>MIP-Mobile-Node-Address: The Home Address of the mobile node.
            
</dd>
<dt>o</dt>
<dd>MIP-Agent-Info: The current home agent of the mobile node.
            
</dd>
<dt>o</dt>
<dd>Chargeable-User-Identity: The unique
            temporary identity of the user. This AVP MUST be included
            if it is available in the home agent.
            
</dd>
<dt>o</dt>
<dd>Service-Selection: Currently selected
               mobility service.
            
</dd>
<dt>o</dt>
<dd>QoS-Resources: Assigned QoS resources for the mobile node.
            
</dd>
<dt>o</dt>
<dd>QoS-Capability: The
              QoS capability related to the assigned QoS-Resources.
            
</dd>
<dt>o</dt>
<dd>MIP-Careof-Address: The current Care-of Address of the
              mobile node.
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="result"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Result-Code AVP Values</h3>

<p>This section defines new Result-Code <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> values that MUST be supported
        by all Diameter implementations that conform to this specification.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Success</h3>

<p>Errors that fall within the Success category are used to inform a
           peer that a request has been successfully completed.
        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>DIAMETER_SUCCESS_RELOCATE_HA (Status Code TBD)</dt>
<dd><br />
 This result code is used by the Diameter
                server to inform the HA that the MN MUST be
                switched to another HA.
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Permanent Failures</h3>

<p>Errors that fall within the permanent failures category are used to inform the peer that
          the request failed and SHOULD NOT be attempted again.
        
</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>DIAMETER_ERROR_MIP6_AUTH_MODE (Status Code
               TBD)</dt>
<dd><br />
 This error code is used
               by the Diameter server to inform the peer that the
               requested Mobile IPv6 Authentication Protocol usage
               mode is not supported.
            
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
AVP Occurrence Tables</h3>

<p>The following tables present the AVPs defined in this document and their occurrences in
        Diameter messages. Note that AVPs that can only be present within a Grouped AVP are not
        represented in this table.
</p>
<p>The table uses the following symbols:
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>0:</dt>
<dd><br />
The AVP MUST NOT be present in the
              message.<br />
<br />

</dd>
<dt>0+:</dt>
<dd><br />
Zero or more instances of the AVP MAY be present
            in the message.<br />
<br />

</dd>
<dt>0-1:</dt>
<dd><br />
Zero or one instance of the AVP MAY be present
            in the message.<br />
<br />

</dd>
<dt>1:</dt>
<dd><br />
One instance of the AVP MUST be present in the
            message. 
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
DER, DEA, MIR and MIA AVP/Command-Code Table</h3>

<p>
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                                  +-----------------------+
                                  |     Command-Code      |
                                  |-----+-----+-----+-----+
   AVP Name                       | DER | DEA | MIR | MIA |
   -------------------------------|-----+-----+-----+-----+
   MIP6-Feature-Vector            | 0-1 | 0-1 | 0-1 | 0-1 |
   MIP-Mobile-Node-Address        | 1-2 | 0-2 | 1-2 | 0-2 |
   MIP-MN-AAA-SPI                 |  0  |  0  | 0-1 |  0  |
   MIP-MN-HA-SPI                  |  0  |  0  | 0-1 |  0  |
   MIP6-Agent-Info                |  1  | 0-1 |  1  | 0-1 |
   MIP-Careof-Address             |  0  |  0  | 0-1 |  0  |
   MIP-Authenticator              |  0  |  0  | 0-1 |  0  |
   MIP-MAC-Mobility-Data          |  0  |  0  | 0-1 |  0  |
   MIP-MSA-Lifetime               |  0  |  0  |  0  |  1  |
   MIP-MN-HA-MSA                  |  0  |  0  |  0  | 0-1 |
   MIP-Timestamp                  |  0  |  0  | 0-1 | 0-1 |
   User-Name                      | 0-1 | 0-1 |  1  | 0-1 |
   Service-Selection              | 0-1 | 0-1 | 0-1 | 0-1 |
   QoS-Resources                  |  0+ |  0+ |  0+ |  0+ |
   QoS-Capability                 | 0-1 |  0  | 0-1 |  0  |
   Chargeable-User-Identity       | 0-1 | 0-1 | 0-1 | 0-1 |
   MIP6-Auth-Mode                 |  0  |  0  |  1  |  0  |
                                  +-----+-----+-----+-----+
</pre></div><p>

        
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Coupled Accounting Model AVP Table</h3>

<p> The table in this section is used to represent which AVPs defined in this document are
          to be present in the Accounting messages, as defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
</p>
<p>
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                           +-------------+
                                           | Command-Code|
                                           |------+------+
      Attribute Name                       |  ACR |  ACA |
      -------------------------------------|------+------+
      Accounting-Input-Octets              | 0-1  |  0-1 |
      Accounting-Input-Packets             | 0-1  |  0-1 |
      Accounting-Output-Octets             | 0-1  |  0-1 |
      Accounting-Output-Packets            | 0-1  |  0-1 |
      Acct-Multi-Session-Id                | 0-1  |  0-1 |
      Acct-Session-Time                    | 0-1  |  0-1 |
      MIP6-Feature-Vector                  | 0-1  |  0-1 |
      MIP6-Agent-Info                      | 0-1  |  0-1 |
      MIP-Mobile-Node-Address              | 0-2  |  0-2 |
      Event-Timestamp                      | 0-1  |   0  |
      MIP-Careof-Address                   | 0-1  |   0  |
      Service-Selection                    | 0-1  |   0  |
      QoS-Capability                       |  0+  |   0+ |
      QoS-Resources                        |  0+  |   0+ |
      Chargeable-User-Identity             | 0-1  |   0  |
      -------------------------------------|------+------+
</pre></div><p>

        
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This section contains the namespaces that have either been created in this specification or
        had their values assigned to existing namespaces managed by IANA.
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Command Codes</h3>

<p> IANA is requested to allocate a command code value for the following new commands
            from the Command Code namespace defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. See <a class='info' href='#Command-Code-Values'>Section&nbsp;5<span> (</span><span class='info'>Command Codes</span><span>)</span></a> for the assignment of the
          namespace in this specification. 
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Command Code                       | Value
-----------------------------------+------
MIP6-Request                 (MIR) | TBD
MIP6-Answer                  (MIA) | TBD

</pre></div>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
AVP Codes</h3>

<p> This specification requires IANA to register the following new AVPs from the AVP Code
          namespace defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.<br />
<br />

          </p>
<ul class="text">
<li>MIP-Careof-Address
</li>
<li>MIP-Authenticator
</li>
<li>MIP-MAC-Mobility-Data
</li>
<li>MIP-Timestamp
</li>
<li>MIP-MN-HA-SPI
</li>
<li>MIP-MN-HA-MSA
</li>
<li>Service-Selection
</li>
<li>MIP6-Auth-Mode
</li>
</ul><br />
<br />
<p>The AVPs are defined in <a class='info' href='#avps'>Section&nbsp;6<span> (</span><span class='info'>AVPs</span><span>)</span></a>.
        
</p>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Result-Code AVP Values</h3>

<p>This specification requests IANA to allocate new values to the Result-Code AVP (AVP Code
           268) namespace defined in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. See <a class='info' href='#result'>Section&nbsp;7<span> (</span><span class='info'>Result-Code AVP Values</span><span>)</span></a> for the
           assignment of the namespace in this specification.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Result-Code                                   | Value
----------------------------------------------+------
DIAMETER_SUCCESS_RELOCATE_HA                  | TBD
DIAMETER_ERROR_MIP6_AUTH_MODE                 | TBD

</pre></div>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
Application Identifier</h3>

<p> This specification requires IANA to allocate two new
          values "Diameter Mobile IPv6 IKE" and "Diameter Mobile
          IPv6 Auth" from the Application Identifier namespace defined
          in <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Application Identifier             | Value
-----------------------------------+------
Diameter Mobile IPv6 IKE   (MIP6I) | TBD
Diameter Mobile IPv6 Auth  (MIP6A) | TBD

</pre></div>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.5"></a><h3>9.5.&nbsp;
Namespaces</h3>

<p>IANA is requested to create a new registry "MIP6
           Authentication Mode" registry for use with the
           enumerated MIP6-Auth-Mode AVP. The registry will initially
           contain the following value:
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Token                                        | Value    | Description
---------------------------------------------+----------+------------
MIP6_AUTH_MN_AAA                             | 1        | RFC TBD
</pre></div><p>

        
</p>
<p>Allocation of new values follow the example policies
           described in <a class='info' href='#RFC5226'>[RFC5226]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> new values for the 
           MIP6-Auth-Mode AVP will be assigned based on the "Specification
           Required" policy. The value 0 (zero) is reserved and the
           maximum value is 4294967295 (i.e. 2^32-1).
        
</p>
<a name="SecurityConsiderations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p> The security considerations for the Diameter interaction required to accomplish the split
          scenario are described in <a class='info' href='#RFC5026'>[RFC5026]<span> (</span><span class='info'>Giaretta, G., Kempf, J., and V. Devarapalli, &ldquo;Mobile IPv6 Bootstrapping in Split Scenario,&rdquo; October&nbsp;2007.</span><span>)</span></a>.
          Additionally, the security considerations of the Diameter Base protocol <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>, Diameter EAP application <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> are applicable to
          this document.
      
</p>
<p>The Diameter messages may be transported between the HA and
         the Diameter server via one or more AAA brokers or Diameter
         agents. In this case the HA to the Diameter server AAA
         communication rely on the security properties of the
         intermediating AAA inter-connection networks, AAA brokers and Diameter
         agents (such as proxies).
      
</p>
<p>In case of the Authentication Protocol for Mobile IPv6 <a class='info' href='#RFC4285'>[RFC4285]<span> (</span><span class='info'>Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;Authentication Protocol for Mobile IPv6,&rdquo; January&nbsp;2006.</span><span>)</span></a>, 
         this specification expects that the Diameter server derives the 
         MN-HA Security Association and returns the associated session key (i.e.
         the MN-HA shared session key) to the HA. However, this specification
         does not define nor other IETF specification
         defines how the Diameter server actually derives 
         required keys. The details of the key derivation depends on the
         deployment where this specification is used and therefore the
         security properties of the system depend on how this is done.
         
      
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>The authors would like to thank Jari Arkko, Tolga Asversen, Pasi Eronen, Santiago Zapata
        Hernandez, Anders Kristensen, Avi Lior, John Loughney, Ahmad Muhanna, Behcet Sarikaya,
        Basavaraj Patil, Vijay Devarapalli, Lionel Morand, Domagoj
        Premec, Semyon Mizikovsky and Yoshihiro Ohba for all the useful
        discussions. Ahmad Muhanna provided a detailed review of the
        document in August 2007. Pasi Eronen provided detailed comments and
        text proposals during the IESG review that helped to improved this
        document greatly.
      
</p>
<p>We would also like to thank our Area Director, Dan Romascanu, for his support.
</p>
<p>Hannes Tschofenig would like to thank the European Commission support in the co-funding of
        the ENABLE project, where this work is partly being developed.
</p>
<p>Julien Bournelle would like to thank GET/INT since he began this work while he was under
        their employ.
</p>
<p>Madjid Nakhjiri would like to thank Huawei USA as most of his
         contributions to this draft were possible while he was under
         their employ.
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dime-qos-attributes">[I-D.ietf-dime-qos-attributes]</a></td>
<td class="author-text">Korhonen, J., Tschofenig, H., Arumaithurai, M., Jones, M., and A. Lior, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-qos-attributes-15.txt">Traffic Classification and Quality of Service Attributes for Diameter</a>,&rdquo; draft-ietf-dime-qos-attributes-15 (work in progress), December&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-qos-attributes-15.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3588">[RFC3588]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3775">[RFC3775]</a></td>
<td class="author-text">Johnson, D., Perkins, C., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3775">Mobility Support in IPv6</a>,&rdquo; RFC&nbsp;3775, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3775.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4004">[RFC4004]</a></td>
<td class="author-text">Calhoun, P., Johansson, T., Perkins, C., Hiller, T., and P. McCann, &ldquo;<a href="http://tools.ietf.org/html/rfc4004">Diameter Mobile IPv4 Application</a>,&rdquo; RFC&nbsp;4004, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4004.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4005">[RFC4005]</a></td>
<td class="author-text">Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;<a href="http://tools.ietf.org/html/rfc4005">Diameter Network Access Server Application</a>,&rdquo; RFC&nbsp;4005, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4005.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4072">[RFC4072]</a></td>
<td class="author-text">Eronen, P., Hiller, T., and G. Zorn, &ldquo;<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>,&rdquo; RFC&nbsp;4072, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4072.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4283">[RFC4283]</a></td>
<td class="author-text">Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;<a href="http://tools.ietf.org/html/rfc4283">Mobile Node Identifier Option for Mobile IPv6 (MIPv6)</a>,&rdquo; RFC&nbsp;4283, November&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4283.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4285">[RFC4285]</a></td>
<td class="author-text">Patel, A., Leung, K., Khalil, M., Akhtar, H., and K. Chowdhury, &ldquo;<a href="http://tools.ietf.org/html/rfc4285">Authentication Protocol for Mobile IPv6</a>,&rdquo; RFC&nbsp;4285, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4285.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4372">[RFC4372]</a></td>
<td class="author-text">Adrangi, F., Lior, A., Korhonen, J., and J. Loughney, &ldquo;<a href="http://tools.ietf.org/html/rfc4372">Chargeable User Identity</a>,&rdquo; RFC&nbsp;4372, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4372.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4877">[RFC4877]</a></td>
<td class="author-text">Devarapalli, V. and F. Dupont, &ldquo;<a href="http://tools.ietf.org/html/rfc4877">Mobile IPv6 Operation with IKEv2 and the Revised IPsec Architecture</a>,&rdquo; RFC&nbsp;4877, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4877.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5026">[RFC5026]</a></td>
<td class="author-text">Giaretta, G., Kempf, J., and V. Devarapalli, &ldquo;<a href="http://tools.ietf.org/html/rfc5026">Mobile IPv6 Bootstrapping in Split Scenario</a>,&rdquo; RFC&nbsp;5026, October&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5026.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5142">[RFC5142]</a></td>
<td class="author-text">Haley, B., Devarapalli, V., Deng, H., and J. Kempf, &ldquo;<a href="http://tools.ietf.org/html/rfc5142">Mobility Header Home Agent Switch Message</a>,&rdquo; RFC&nbsp;5142, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5142.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5149">[RFC5149]</a></td>
<td class="author-text">Korhonen, J., Nilsson, U., and V. Devarapalli, &ldquo;<a href="http://tools.ietf.org/html/rfc5149">Service Selection for Mobile IPv6</a>,&rdquo; RFC&nbsp;5149, February&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5149.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5447">[RFC5447]</a></td>
<td class="author-text">Korhonen, J., Bournelle, J., Tschofenig, H., Perkins, C., and K. Chowdhury, &ldquo;<a href="http://tools.ietf.org/html/rfc5447">Diameter Mobile IPv6: Support for Network Access Server to Diameter Server Interaction</a>,&rdquo; RFC&nbsp;5447, February&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5447.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dime-app-design-guide">[I-D.ietf-dime-app-design-guide]</a></td>
<td class="author-text">Fajardo, V., Tschofenig, H., and L. Morand, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-app-design-guide-11.txt">Diameter Applications Design Guidelines</a>,&rdquo; draft-ietf-dime-app-design-guide-11 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dime-app-design-guide-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mext-aaa-ha-goals">[I-D.ietf-mext-aaa-ha-goals]</a></td>
<td class="author-text">Giaretta, G., Guardini, I., Demaria, E., Bournelle, J., and R. Lopez, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mext-aaa-ha-goals-01.txt">AAA Goals for Mobile IPv6</a>,&rdquo; draft-ietf-mext-aaa-ha-goals-01 (work in progress), May&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mext-aaa-ha-goals-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-mext-nemo-v4traversal">[I-D.ietf-mext-nemo-v4traversal]</a></td>
<td class="author-text">Soliman, H., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-mext-nemo-v4traversal-10.txt">Mobile IPv6 Support for Dual Stack Hosts and Routers</a>,&rdquo; draft-ietf-mext-nemo-v4traversal-10 (work in progress), April&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-mext-nemo-v4traversal-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4640">[RFC4640]</a></td>
<td class="author-text">Patel, A. and G. Giaretta, &ldquo;<a href="http://tools.ietf.org/html/rfc4640">Problem Statement for bootstrapping Mobile IPv6 (MIPv6)</a>,&rdquo; RFC&nbsp;4640, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4640.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jouni Korhonen (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  FIN-02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jouni.nospam@gmail.com">jouni.nospam@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  FIN-02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Julien Bournelle</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Orange Labs</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">38-4O rue du general Leclerc</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Issy-Les-Moulineaux  92794</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:julien.bournelle@orange-ftgroup.com">julien.bournelle@orange-ftgroup.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gerardo Giaretta</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Qualcomm</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5775 MoreHouse Dr</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Diego, CA  92121</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gerardo.giaretta@gmail.com">gerardo.giaretta@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Madjid Nakhjiri</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Motorola</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:madjid.nakhjiri@motorola.com">madjid.nakhjiri@motorola.com</a></td></tr>
</table>
</body></html>
