



Network Working Group                                       K. Murchison
Internet-Draft                                                 R. Signes
Intended status: Experimental                                M. Horsfall
Expires: 28 August 2022                                         Fastmail
                                                        24 February 2022


     Sieve Email Filtering: Extension for Processing iMIP Messages
                  draft-murchison-sieve-processimip-00

Abstract

   This document describes the "processimip" extension to the Sieve
   email filtering language.  The "processimip" extension gives Sieve
   the ability to process messages using the iCalendar Message-Based
   Interoperability Protocol (iMIP).

Open Issues

   1.  The Cyrus implementation used at Fastmail also adds an
       :invitesonly option to the processimip action in order to emulate
       existing functionality elsewhere within our stack.  Is there any
       interest in formalizing this option?  This may be superfluous as
       it might not make sense to auto-process an initial invitation but
       then NOT auto-process future updates to an event.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on 28 August 2022.

Copyright Notice

   Copyright (c) 2022 IETF Trust and the persons identified as the
   document authors.  All rights reserved.




Murchison, et al.        Expires 28 August 2022                 [Page 1]

Internet-Draft             Sieve Process iMIP              February 2022


   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents (https://trustee.ietf.org/
   license-info) in effect on the date of publication of this document.
   Please review these documents carefully, as they describe your rights
   and restrictions with respect to this document.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Conventions Used in This Document . . . . . . . . . . . . . .   3
   3.  Capability Identifier . . . . . . . . . . . . . . . . . . . .   3
   4.  Process iMIP Action . . . . . . . . . . . . . . . . . . . . .   3
     4.1.  Addresses Argument  . . . . . . . . . . . . . . . . . . .   4
     4.2.  Updates Only Argument . . . . . . . . . . . . . . . . . .   4
     4.3.  Calendar ID Argument  . . . . . . . . . . . . . . . . . .   4
     4.4.  Delete Canceled Argument  . . . . . . . . . . . . . . . .   4
     4.5.  Outcome Argument  . . . . . . . . . . . . . . . . . . . .   5
     4.6.  Error String Argument . . . . . . . . . . . . . . . . . .   5
     4.7.  Examples  . . . . . . . . . . . . . . . . . . . . . . . .   5
   5.  Implementation Status . . . . . . . . . . . . . . . . . . . .   5
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   6
   7.  Privacy Considerations  . . . . . . . . . . . . . . . . . . .   6
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   6
     8.1.  Registration of Sieve Extension . . . . . . . . . . . . .   6
   9.  Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   7
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .   7
     10.1.  Normative References . . . . . . . . . . . . . . . . . .   7
     10.2.  Informative References . . . . . . . . . . . . . . . . .   7
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   8

1.  Introduction

   Users typically receive invites, replies, and cancelations for
   events, tasks, etc. via Internet mail messages.  It is sometimes
   desirable to have such messages automatically parsed and the attached
   iCalendar [RFC5545] objects added to, updated on, or deleted from the
   user's calendars.

   This document defines an extension to the Sieve language [RFC5228]
   that enables scripts to process messages using the iCalendar
   Message-Based Interoperability Protocol (iMIP) [RFC6047].
   Specifically, this extension provides the ability to alter iCalendar
   objects on a user's calendars referenced in iMIP messages.








Murchison, et al.        Expires 28 August 2022                 [Page 2]

Internet-Draft             Sieve Process iMIP              February 2022


2.  Conventions Used in This Document

   Conventions for notations are as in Section 1.1 of [RFC5228],
   including use of the "Usage:" label for the definition of action and
   tagged arguments syntax.

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in
   BCP 14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  Capability Identifier

   Sieve interpreters that implement this extension have an identifier
   of "processimip" for use with the capability mechanism.

4.  Process iMIP Action

   Usage: processimip [ :addresses <string-list> ]
                      [ :updatesonly | :calendarid <string> ]
                      [ :deletecanceled ]
                      [ :outcome <variablename: string> ]
                      [ :errstr <variablename: string> ]

   The "processimip" action can be used with or without the "variables"
   [RFC5229] extension.  When the "variables" extension is enabled in a
   script using <require "variables">, the script can use the ":outcome"
   (Section 4.5) and ":errstr" (Section 4.6) arguments to the
   "processimip" action described below.  When the "variables" extension
   is not enabled, the ":outcome" and ":errstr" arguments MUST NOT be
   used and MUST cause an error according to [RFC5228].

   "processimip" MUST NOT process a message unless it is a well-formed
   iMIP message and one of the recipient user's email addresses matches
   the Calendar User Address (see Section 3.3.3 of [RFC5545]) of the
   intended target of the message, as determined by the iTIP method (see
   Section 1.4 of [RFC5546]) of the message:

      "REPLY": Value of the "Organizer" property (see Section 3.8.4.1 of
      [RFC5545])

      "REQUEST", "CANCEL", "ADD": Value of one of the "Attendee"
      properties (see Section 3.8.4.3 of [RFC5545])

   The recipient user's email address matches the Calender User Address
   of the target if the Calendar User Address is in the form of a mailto
   URI and the email address matches the "addr-spec" of the URI.



Murchison, et al.        Expires 28 August 2022                 [Page 3]

Internet-Draft             Sieve Process iMIP              February 2022


   An email address is considered to belong to the recipient if it is
   one of:

   1.  an email address known by the implementation to be associated
       with the recipient,

   2.  the final envelope recipient address if it's available to the
       implementation, or

   3.  an address specified by the script writer via the :addresses
       (Section 4.1) argument.

   The "processimip" action does not cancel the implicit keep.

4.1.  Addresses Argument

   The optional :addresses argument is used to specify email addresses
   that belong to the recipient in addition to the addresses known to
   the implementation.

4.2.  Updates Only Argument

   The optional :updatesonly argument is used to limit the messages
   processed to those targeting existing iCalendar objects only.  If the
   message contains a new iCalendar object (initial invitation), the
   implementation MUST NOT add the object to a calendar.

   If :updatesonly is omitted, new iCalendar objects (initial
   invitations) may be added to one of the user's calendars.

4.3.  Calendar ID Argument

   The optional :calendarid argument specifies the identifier of the
   calendar onto which new iCalendar objects (initial invitations)
   should placed.

   If :calendarid is omitted, new iCalendar objects will be placed on
   the user's "default" calendar as determined by the implementation.

4.4.  Delete Canceled Argument

   The optional :deletecanceled argument is used to tell the
   implementation that if it receives a cancelation message, it should
   remove the associated iCalendar object from the calendar.

   If :deletecanceled is omitted, the associated iCalendar object will
   be marked as canceled and will remain on the calendar.




Murchison, et al.        Expires 28 August 2022                 [Page 4]

Internet-Draft             Sieve Process iMIP              February 2022


4.5.  Outcome Argument

   The optional :outcome argument specifies the name of a variable into
   which one of the following strings specifying the outcome of the
   action will be stored:

   *  "no_action": No action was performed (E.g., the message wasn't an
      iMIP message, or the message contained a new iCalendar object but
      the ":updatesonly" argument was used)

   *  "added": A new iCalendar object was added to a calendar

   *  "update": An iCalendar resource was updated or canceled

   *  "error": An error processing the iMIP message occurred

4.6.  Error String Argument

   The optional :errstr argument specifies the name of a variable into
   which a string describing the reason for the outcome will be stored.

4.7.  Examples

   TODO: Actually add examples.

5.  Implementation Status

   < RFC Editor: before publication please remove this section and the
   reference to [RFC7942] >

   This section records the status of known implementations of the
   protocol defined by this specification at the time of posting of this
   Internet-Draft, and is based on a proposal described in [RFC7942].
   The description of implementations in this section is intended to
   assist the IETF in its decision processes in progressing drafts to
   RFCs.  Please note that the listing of any individual implementation
   here does not imply endorsement by the IETF.  Furthermore, no effort
   has been spent to verify the information presented here that was
   supplied by IETF contributors.  This is not intended as, and must not
   be construed to be, a catalog of available implementations or their
   features.  Readers are advised to note that other implementations may
   exist.









Murchison, et al.        Expires 28 August 2022                 [Page 5]

Internet-Draft             Sieve Process iMIP              February 2022


   According to [RFC7942], "this will allow reviewers and working groups
   to assign due consideration to documents that have the benefit of
   running code, which may serve as evidence of valuable experimentation
   and feedback that have made the implemented protocols more mature.
   It is up to the individual working groups to use this information as
   they see fit".

5.1.  Cyrus Server

   The open source Cyrus Server (http://www.cyrusimap.org/) project is a
   highly scalable enterprise mail system which supports Sieve email
   filtering at the point of final delivery.  This production level
   Sieve implementation supports all of the requirements described in
   this document.  This implementation is freely distributable under a
   BSD style license from Computing Services at Carnegie Mellon
   University (http://www.cmu.edu/computing/).

6.  Security Considerations

   Security considerations are discussed in [RFC5228].

   TODO: Discuss calendar SPAM.

7.  Privacy Considerations

   It is believed that this extension doesn't introduce any privacy
   considerations beyond those in [RFC5228].

8.  IANA Considerations

8.1.  Registration of Sieve Extension

   This document defines the following new Sieve extension to be added
   to the registry defined in Section 6.2 of [RFC5228] and located here:
   https://www.iana.org/assignments/sieve-extensions/sieve-
   extensions.xhtml#sieve-extensions

   IANA are requested to add a capability to the Sieve Extensions
   registry:

      To: iana@iana.org

      Subject: Registration of new Sieve extension

      Capability name: processimip

      Description: Adds the "processimip" action command to add and
      update iCalendar objects on a user's calendars.



Murchison, et al.        Expires 28 August 2022                 [Page 6]

Internet-Draft             Sieve Process iMIP              February 2022


      RFC number: RFC XXXX

      Contact address: The Sieve discussion list <sieve@ietf.org>

9.  Acknowledgments

   The authors would like to thank the following individuals for
   contributing their ideas and support for writing this specification:
   Ned Freed and Alexey Melnikov.

10.  References

10.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC5228]  Guenther, P., Ed. and T. Showalter, Ed., "Sieve: An Email
              Filtering Language", RFC 5228, DOI 10.17487/RFC5228,
              January 2008, <https://www.rfc-editor.org/info/rfc5228>.

   [RFC5229]  Homme, K., "Sieve Email Filtering: Variables Extension",
              RFC 5229, DOI 10.17487/RFC5229, January 2008,
              <https://www.rfc-editor.org/info/rfc5229>.

   [RFC6047]  Melnikov, A., Ed., "iCalendar Message-Based
              Interoperability Protocol (iMIP)", RFC 6047,
              DOI 10.17487/RFC6047, December 2010,
              <https://www.rfc-editor.org/info/rfc6047>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

10.2.  Informative References

   [RFC5545]  Desruisseaux, B., Ed., "Internet Calendaring and
              Scheduling Core Object Specification (iCalendar)",
              RFC 5545, DOI 10.17487/RFC5545, September 2009,
              <https://www.rfc-editor.org/info/rfc5545>.

   [RFC5546]  Daboo, C., Ed., "iCalendar Transport-Independent
              Interoperability Protocol (iTIP)", RFC 5546,
              DOI 10.17487/RFC5546, December 2009,
              <https://www.rfc-editor.org/info/rfc5546>.




Murchison, et al.        Expires 28 August 2022                 [Page 7]

Internet-Draft             Sieve Process iMIP              February 2022


   [RFC7942]  Sheffer, Y. and A. Farrel, "Improving Awareness of Running
              Code: The Implementation Status Section", BCP 205,
              RFC 7942, DOI 10.17487/RFC7942, July 2016,
              <https://www.rfc-editor.org/info/rfc7942>.

Authors' Addresses

   Kenneth Murchison
   Fastmail US LLC
   1429 Walnut Street - Suite 1201
   Philadelphia, PA 19102
   United States of America
   Email: murch@fastmailteam.com


   Ricardo Signes
   Fastmail US LLC
   1429 Walnut Street - Suite 1201
   Philadelphia, PA 19102
   United States of America
   Email: rjbs@fastmailteam.com


   Matthew Horsfall
   Fastmail US LLC
   1429 Walnut Street - Suite 1201
   Philadelphia, PA 19102
   United States of America
   Email: alh@fastmailteam.com






















Murchison, et al.        Expires 28 August 2022                 [Page 8]
