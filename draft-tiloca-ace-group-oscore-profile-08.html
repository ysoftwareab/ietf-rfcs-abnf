<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Group OSCORE Profile of the Authentication and Authorization for Constrained Environments Framework</title>
<meta content="Marco Tiloca" name="author">
<meta content="Rikard HÃ¶glund" name="author">
<meta content="Ludwig Seitz" name="author">
<meta content="Francesca Palombini" name="author">
<meta content="
       This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework. The profile uses Group OSCORE to provide communication security between a Client and a (set of) Resource Server(s) as members of an OSCORE Group. The profile securely binds an OAuth 2.0 Access Token with the public key of the Client associated with the private key used in the OSCORE group. The profile uses Group OSCORE to achieve server authentication, as well as proof-of-possession for the Client's public key. Also, it provides proof of the Client's membership to the correct OSCORE group, by binding the Access Token to information from the Group OSCORE Security Context, thus allowing the Resource Server(s) to verify the Client's membership upon receiving a message protected with Group OSCORE from the Client. 
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-tiloca-ace-group-oscore-profile-08" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-tiloca-ace-group-oscore-profile-08-pmkw_g7d.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Group OSCORE Profile of ACE</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tiloca, et al.</td>
<td class="center">Expires 8 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">ACE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-tiloca-ace-group-oscore-profile-08</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-07" class="published">7 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-08">8 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">R. HÃ¶glund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">L. Seitz</div>
<div class="org">Combitech</div>
</div>
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Group OSCORE Profile of the Authentication and Authorization for Constrained Environments Framework</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework. The profile uses Group OSCORE to provide communication security between a Client and a (set of) Resource Server(s) as members of an OSCORE Group. The profile securely binds an OAuth 2.0 Access Token with the public key of the Client associated with the private key used in the OSCORE group. The profile uses Group OSCORE to achieve server authentication, as well as proof-of-possession for the Client's public key. Also, it provides proof of the Client's membership to the correct OSCORE group, by binding the Access Token to information from the Group OSCORE Security Context, thus allowing the Resource Server(s) to verify the Client's membership upon receiving a message protected with Group OSCORE from the Client.<a href="#section-abstract-1" class="pilcrow">Â¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">Â¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Constrained RESTful Environments Working Group mailing list (ace@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/ace/">https://mailarchive.ietf.org/arch/browse/ace/</a></span>.<a href="#section-note.1-2" class="pilcrow">Â¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://gitlab.com/crimson84/draft-tiloca-ace-group-oscore-profile">https://gitlab.com/crimson84/draft-tiloca-ace-group-oscore-profile</a></span>.<a href="#section-note.1-3" class="pilcrow">Â¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-4">
<a href="#name-status-of-this-memo-4" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-4">
<a href="#name-copyright-notice-4" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">Â¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">â²</a><h2 id="name-table-of-contents-4">
<a href="#name-table-of-contents-4" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.Â Â <a href="#name-introduction-4" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.Â Â <a href="#name-terminology-4" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.Â Â <a href="#name-protocol-overview" class="xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.Â Â <a href="#name-pre-conditions" class="xref">Pre-Conditions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.Â Â <a href="#name-access-token-retrieval" class="xref">Access Token Retrieval</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.Â Â <a href="#name-access-token-posting" class="xref">Access Token Posting</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.Â Â <a href="#name-secure-communication" class="xref">Secure Communication</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.Â Â <a href="#name-client-as-communication" class="xref">Client-AS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.Â Â <a href="#name-c-to-as-post-to-token-endpo" class="xref">C-to-AS: POST to Token Endpoint</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.1">
                    <p id="section-toc.1-1.3.2.1.2.1.1"><a href="#section-3.1.1" class="xref">3.1.1</a>.Â Â <a href="#name-context_id-parameter" class="xref">'context_id' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.2">
                    <p id="section-toc.1-1.3.2.1.2.2.1"><a href="#section-3.1.2" class="xref">3.1.2</a>.Â Â <a href="#name-salt_input-parameter" class="xref">'salt_input' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.3">
                    <p id="section-toc.1-1.3.2.1.2.3.1"><a href="#section-3.1.3" class="xref">3.1.3</a>.Â Â <a href="#name-client_cred_verify-paramete" class="xref">'client_cred_verify' Parameter</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1.2.4">
                    <p id="section-toc.1-1.3.2.1.2.4.1"><a href="#section-3.1.4" class="xref">3.1.4</a>.Â Â <a href="#name-client_cred_verify_mac-para" class="xref">'client_cred_verify_mac' Parameter</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.Â Â <a href="#name-as-to-c-access-token" class="xref">AS-to-C: Access Token</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.Â Â <a href="#name-salt-input-claim" class="xref">Salt Input Claim</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.Â Â <a href="#name-context-id-input-claim" class="xref">Context ID Input Claim</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.Â Â <a href="#name-client-rs-communication" class="xref">Client-RS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.Â Â <a href="#name-c-to-rs-post-to-authz-info-" class="xref">C-to-RS POST to authz-info Endpoint</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.Â Â <a href="#name-rs-to-c-201-created" class="xref">RS-to-C: 2.01 (Created)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.Â Â <a href="#name-client-rs-secure-communicat" class="xref">Client-RS Secure Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.Â Â <a href="#name-client-side" class="xref">Client Side</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.Â Â <a href="#name-resource-server-side" class="xref">Resource Server Side</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.4">
                <p id="section-toc.1-1.4.2.4.1"><a href="#section-4.4" class="xref">4.4</a>.Â Â <a href="#name-access-rights-verification" class="xref">Access Rights Verification</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.5">
                <p id="section-toc.1-1.4.2.5.1"><a href="#section-4.5" class="xref">4.5</a>.Â Â <a href="#name-change-of-clients-authentic" class="xref">Change of Client's Authentication Credential in the Group</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.Â Â <a href="#name-secure-communication-with-t" class="xref">Secure Communication with the AS</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.Â Â <a href="#name-discarding-the-security-con" class="xref">Discarding the Security Context</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.Â Â <a href="#name-cbor-mappings" class="xref">CBOR Mappings</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.Â Â <a href="#name-security-considerations-4" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.Â Â <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>.Â <a href="#name-iana-considerations-4" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.Â Â <a href="#name-ace-profile-registry" class="xref">ACE Profile Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.Â Â <a href="#name-oauth-parameters-registry" class="xref">OAuth Parameters Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#section-10.3" class="xref">10.3</a>.Â Â <a href="#name-oauth-parameters-cbor-mappi" class="xref">OAuth Parameters CBOR Mappings Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#section-10.4" class="xref">10.4</a>.Â Â <a href="#name-cbor-web-token-claims-regis" class="xref">CBOR Web Token Claims Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#section-10.5" class="xref">10.5</a>.Â Â <a href="#name-tls-exporter-label-registry" class="xref">TLS Exporter Label Registry</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>.Â <a href="#name-references-4" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.Â Â <a href="#name-normative-references-4" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.Â Â <a href="#name-informative-references-4" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-A" class="xref">Appendix A</a>.Â Â <a href="#name-dual-mode-group-oscore-osco" class="xref">Dual Mode (Group OSCORE &amp; OSCORE)</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1">
                <p id="section-toc.1-1.12.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.Â Â <a href="#name-protocol-overview-3" class="xref">Protocol Overview</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.1">
                    <p id="section-toc.1-1.12.2.1.2.1.1"><a href="#appendix-A.1.1" class="xref">A.1.1</a>.Â Â <a href="#name-pre-conditions-2" class="xref">Pre-Conditions</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.2">
                    <p id="section-toc.1-1.12.2.1.2.2.1"><a href="#appendix-A.1.2" class="xref">A.1.2</a>.Â Â <a href="#name-access-token-posting-2" class="xref">Access Token Posting</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.3">
                    <p id="section-toc.1-1.12.2.1.2.3.1"><a href="#appendix-A.1.3" class="xref">A.1.3</a>.Â Â <a href="#name-setup-of-the-pairwise-oscor" class="xref">Setup of the Pairwise OSCORE Security Context</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.1.2.4">
                    <p id="section-toc.1-1.12.2.1.2.4.1"><a href="#appendix-A.1.4" class="xref">A.1.4</a>.Â Â <a href="#name-secure-communication-2" class="xref">Secure Communication</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2">
                <p id="section-toc.1-1.12.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.Â Â <a href="#name-client-as-communication-2" class="xref">Client-AS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.1">
                    <p id="section-toc.1-1.12.2.2.2.1.1"><a href="#appendix-A.2.1" class="xref">A.2.1</a>.Â Â <a href="#name-c-to-as-post-to-token-endpoi" class="xref">C-to-AS: POST to Token Endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.2.2.2">
                    <p id="section-toc.1-1.12.2.2.2.2.1"><a href="#appendix-A.2.2" class="xref">A.2.2</a>.Â Â <a href="#name-as-to-c-access-token-2" class="xref">AS-to-C: Access Token</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3">
                <p id="section-toc.1-1.12.2.3.1"><a href="#appendix-A.3" class="xref">A.3</a>.Â Â <a href="#name-client-rs-communication-2" class="xref">Client-RS Communication</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.1">
                    <p id="section-toc.1-1.12.2.3.2.1.1"><a href="#appendix-A.3.1" class="xref">A.3.1</a>.Â Â <a href="#name-c-to-rs-post-to-authz-info-e" class="xref">C-to-RS POST to authz-info Endpoint</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.2">
                    <p id="section-toc.1-1.12.2.3.2.2.1"><a href="#appendix-A.3.2" class="xref">A.3.2</a>.Â Â <a href="#name-rs-to-c-201-created-2" class="xref">RS-to-C: 2.01 (Created)</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.3">
                    <p id="section-toc.1-1.12.2.3.2.3.1"><a href="#appendix-A.3.3" class="xref">A.3.3</a>.Â Â <a href="#name-oscore-setup-client-side" class="xref">OSCORE Setup - Client Side</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.4">
                    <p id="section-toc.1-1.12.2.3.2.4.1"><a href="#appendix-A.3.4" class="xref">A.3.4</a>.Â Â <a href="#name-oscore-setup-resource-serve" class="xref">OSCORE Setup - Resource Server Side</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.5">
                    <p id="section-toc.1-1.12.2.3.2.5.1"><a href="#appendix-A.3.5" class="xref">A.3.5</a>.Â Â <a href="#name-access-rights-verification-2" class="xref">Access Rights Verification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.3.2.6">
                    <p id="section-toc.1-1.12.2.3.2.6.1"><a href="#appendix-A.3.6" class="xref">A.3.6</a>.Â Â <a href="#name-change-of-clients-authentica" class="xref">Change of Client's Authentication Credential in the Group</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.4">
                <p id="section-toc.1-1.12.2.4.1"><a href="#appendix-A.4" class="xref">A.4</a>.Â Â <a href="#name-secure-communication-with-th" class="xref">Secure Communication with the AS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.5">
                <p id="section-toc.1-1.12.2.5.1"><a href="#appendix-A.5" class="xref">A.5</a>.Â Â <a href="#name-discarding-the-security-cont" class="xref">Discarding the Security Context</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.6">
                <p id="section-toc.1-1.12.2.6.1"><a href="#appendix-A.6" class="xref">A.6</a>.Â Â <a href="#name-cbor-mappings-2" class="xref">CBOR Mappings</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.7">
                <p id="section-toc.1-1.12.2.7.1"><a href="#appendix-A.7" class="xref">A.7</a>.Â Â <a href="#name-security-considerations-5" class="xref">Security Considerations</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12.2.8">
                <p id="section-toc.1-1.12.2.8.1"><a href="#appendix-A.8" class="xref">A.8</a>.Â Â <a href="#name-privacy-considerations-2" class="xref">Privacy Considerations</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#appendix-B" class="xref">Appendix B</a>.Â Â <a href="#name-profile-requirements" class="xref">Profile Requirements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#appendix-C" class="xref"></a><a href="#name-acknowledgments-2" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#appendix-D" class="xref"></a><a href="#name-authors-addresses-4" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction-4">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-4" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">A number of applications rely on a group communication model, where a Client can access a resource shared by multiple Resource Servers at once, e.g., over IP multicast. Typical examples are switching of luminaries, actuators control, and distribution of software updates. Secure communication in the group can be achieved by sharing a set of keying material, which is typically provided upon joining the group.<a href="#section-1-1" class="pilcrow">Â¶</a></p>
<p id="section-1-2">For some of such applications, it may be just fine to enforce access control in a straightforward fashion. That is, any Client authorized to join the group, hence to get the group keying material, can be also implicitly authorized to perform any action at any resource of any Server in the group. An example of application where such implicit authorization might be used is a simple lighting scenario, where the lightbulbs are the Servers, while the user account on an app on the user's phone is the Client. In this case, it might be fine to not require additional authorization evidence from any user account, if it is acceptable that any current group member is also authorized to switch on and off any light, or to check their status.<a href="#section-1-2" class="pilcrow">Â¶</a></p>
<p id="section-1-3">However, in different instances of such applications, the approach above is not desirable, as different group members are intended to have different access rights to resources of other group members. That is, access control to the secure group communication channel and access control to the resource space provided by servers in the group should remain logically separated domains. For instance, a more fine-grained approach is required in the two following use cases.<a href="#section-1-3" class="pilcrow">Â¶</a></p>
<p id="section-1-4">As a first case, an application provides control of smart locks acting as Servers in the group, where: a first type of Client, e.g., a user account of a child, is allowed to only query the status of the smart locks; while a second type of Client, e.g., a user account of a parent, is allowed to both query and change the status of the smart locks. Further similar applications concern the enforcement of different sets of permissions in groups with sensor/actuator devices, e.g., thermostats, acting as Servers. Also, some group members may even be intended as Servers only. Hence, they must be prevented from acting as Clients altogether and from accessing resources at other Servers, especially when attempting to perform non-safe operations.<a href="#section-1-4" class="pilcrow">Â¶</a></p>
<p id="section-1-5">As a second case, building automation scenarios often rely on Servers that, under different circumstances, enforce different level of priority for processing received commands. For instance, BACnet deployments consider multiple classes of Clients, e.g., a normal light switch (C1) and an emergency fire panel (C2). Then, a C1 Client is not allowed to override a command from a C2 Client, until the latter relinquishes control at its higher priority. That is: i) only C2 Clients should be able to adjust the minimum required level of priority on the Servers, so rightly locking out C1 Clients if needed; and ii) when a Server is set to accept only high-priority commands, only C2 Clients should be able to perform such commands otherwise allowed also to C1 Clients. Given the different maximum authority of different Clients, fine-grained access control would effectively limit the execution of high- and emergency-priority commands only to devices that are in fact authorized to do so. Besides, it would prevent a misconfigured or compromised device from initiating a high-priority command and lock out normal control.<a href="#section-1-5" class="pilcrow">Â¶</a></p>
<p id="section-1-6">In the cases above, being a legitimate group member and storing the group keying material is not supposed to imply any particular access rights. Also, introducing a different security group for each different set of access rights would result in additional keying material to distribute and manage. In particular, if the access rights for a single node change, this would require to evict that node from the current group, followed by that node joining a different group aligned with its new access rights. Moreover, the keying material of both groups would have to be renewed for their current members. Overall, this would have a non negligible impact on operations and performance in the system.<a href="#section-1-6" class="pilcrow">Â¶</a></p>
<p id="section-1-7">A fine-grained access control model can be rather enforced within a same group, by using the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. That is, a Client has to first obtain authorization credentials in the form of an Access Token, and post it to the Resource Server(s) in the group before accessing the intended resources.<a href="#section-1-7" class="pilcrow">Â¶</a></p>
<p id="section-1-8">The ACE framework delegates to separate profile documents how to secure communications between the Client and the Resource Server. However each of the current profiles of ACE defined in <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span> <span>[<a href="#I-D.ietf-ace-dtls-authorize" class="xref">I-D.ietf-ace-dtls-authorize</a>]</span> <span>[<a href="#I-D.ietf-ace-mqtt-tls-profile" class="xref">I-D.ietf-ace-mqtt-tls-profile</a>]</span> admits a single security protocol that cannot be used to protect group messages sent over IP multicast.<a href="#section-1-8" class="pilcrow">Â¶</a></p>
<p id="section-1-9">This document specifies the "coap_group_oscore" profile of the ACE framework, where a Client uses CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> or CoAP over IP multicast <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span> to communicate to one or multiple Resource Servers, which are members of an application group and share a common set of resources. This profile uses Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> as the security protocol to protect messages exchanged between the Client and the Resource Servers. Hence, it requires that both the Client and the Resource Servers have previously joined the same OSCORE group.<a href="#section-1-9" class="pilcrow">Â¶</a></p>
<p id="section-1-10">That is, this profile describes how access control is enforced for a Client after it has joined an OSCORE group, to access resources at other members in that group. The process for joining the OSCORE group through the respective Group Manager as defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> takes place before the process described in this document, and is out of the scope of this profile.<a href="#section-1-10" class="pilcrow">Â¶</a></p>
<p id="section-1-11">The Client proves its access to be authorized to the Resource Server by using an Access Token, which is bound to a key (the proof-of-possession key). This profile uses Group OSCORE to achieve server authentication, as well as proof-of-possession for the Client's public key used in the OSCORE group in question. Note that the proof of possession is not done by a dedicated protocol element, but rather occurs after the first Group OSCORE exchange.<a href="#section-1-11" class="pilcrow">Â¶</a></p>
<p id="section-1-12">Furthermore, this profile provides proof of the Client's membership to the correct OSCORE group, by binding the Access Token to the Client's authentication credential used in the group and including the Client's public public key, as well as to information from the pre-established Group OSCORE Security Context. This allows the Resource Server to verify the Client's group membership upon reception of a message protected with Group OSCORE from that Client.<a href="#section-1-12" class="pilcrow">Â¶</a></p>
<p id="section-1-13">OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> specifies how to use COSE <span>[<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span><span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span> to secure CoAP messages. Group OSCORE builds on OSCORE to provide secure group communication, and ensures source authentication: by means of digital signatures embedded in protected messages (in group mode); or by protecting messages with pairwise keying material derived from the asymmetric keys of the two peers exchanging the message (in pairwise mode).<a href="#section-1-13" class="pilcrow">Â¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology-4">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology-4" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">Â¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with the terms and concepts related to CBOR <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span>, COSE <span>[<a href="#I-D.ietf-cose-rfc8152bis-struct" class="xref">I-D.ietf-cose-rfc8152bis-struct</a>]</span><span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>, CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. These especially include:<a href="#section-1.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-3.1">Group Manager, as the entity responsible for a set of groups where communications among members are secured with Group OSCORE.<a href="#section-1.1-3.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-1.1-3.2">
            <p id="section-1.1-3.2.1">Authentication credential, as the set of information associated with an entity, including that entity's public key and parameters associated with the public key. Examples of authentication credentials are CBOR Web Tokens (CWTs) and CWT Claims Sets (CCSs) <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>, X.509 certificates <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span> and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>.<a href="#section-1.1-3.2.1" class="pilcrow">Â¶</a></p>
<p id="section-1.1-3.2.2">
Members of an OSCORE group have an associated authentication credential in the format used in the group. As per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-2.3" class="relref">Section 2.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, an authentication credential provides the public key as well as the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-1.1-3.2.2" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-1.1-4">Readers are expected to be familiar with the terms and concepts described in the ACE framework for authentication and authorization <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, as well as in the OSCORE profile of ACE <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>. The terminology for entities in the considered architecture is defined in OAuth 2.0 <span>[<a href="#RFC6749" class="xref">RFC6749</a>]</span>. In particular, this includes Client (C), Resource Server (RS), and Authorization Server (AS).<a href="#section-1.1-4" class="pilcrow">Â¶</a></p>
<p id="section-1.1-5">Note that, unless otherwise indicated, the term "endpoint" is used here following its OAuth definition, aimed at denoting resources such as /token and /introspect at the AS, and /authz-info at the RS. This document does not use the CoAP definition of "endpoint", which is "An entity participating in the CoAP protocol".<a href="#section-1.1-5" class="pilcrow">Â¶</a></p>
<p id="section-1.1-6">Additionally, this document makes use of the following terminology.<a href="#section-1.1-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-7.1">Equivalent COSE Key: a COSE Key built from an authentication credential used in the OSCORE group. The equivalent COSE Key preserves all the main information elements from the authentication credential, in particular the key coordinates and the comprehensive set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-1.1-7.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-1.1-7.2">Pairwise-only group: an OSCORE group that uses only the pairwise mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-9" class="relref">Section 9</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-1.1-7.2" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-1.1-8">Examples throughout this document are expressed in CBOR diagnostic notation, without the tag and value abbreviations.<a href="#section-1.1-8" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-protocol-overview">
<section id="section-2">
      <h2 id="name-protocol-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-2-1">This section provides an overview of this profile, i.e., on how to use the ACE framework for authentication and authorization <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> to secure communications between a Client and a (set of) Resource Server(s) using Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-2-1" class="pilcrow">Â¶</a></p>
<p id="section-2-2">Note that this profile of ACE describes how access control can be enforced for a node after it has joined an OSCORE group, to access resources at other members in that group.<a href="#section-2-2" class="pilcrow">Â¶</a></p>
<p id="section-2-3">In particular, the process for joining the OSCORE group through the respective Group Manager as defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> must take place before the process described in this document, and is out of the scope of this profile.<a href="#section-2-3" class="pilcrow">Â¶</a></p>
<p id="section-2-4">An overview of the protocol flow for this profile is shown in <a href="#fig-protocol-overview" class="xref">Figure 1</a>. In the figure, it is assumed that both RS1 and RS2 are associated with the same AS. It is also assumed that C, RS1 and RS2 have previously joined an OSCORE group with Group Identifier (gid) "abcd0000", and got assigned Sender ID (sid) "0", "1" and "2" in the group, respectively. The names of messages coincide with those of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> when applicable.<a href="#section-2-4" class="pilcrow">Â¶</a></p>
<span id="name-protocol-overview-2"></span><div id="fig-protocol-overview">
<figure id="figure-1">
        <div class="alignCenter art-text artwork" id="section-2-5.1">
<pre>
C                           RS1          RS2                         AS
| [--- Resource Request --&gt;] |            |                           |
|                            |            |                           |
| [&lt;----  AS Request ------] |            |                           |
|       Creation Hints       |            |                           |
|                            |            |                           |
|-------- POST /token -----------------------------------------------&gt;|
|  (aud: RS1, sid: 0, gid: abcd0000, ...) |                           |
|                            |            |                           |
|                            |            |                           |
|&lt;-------------------------------- Access Token + RS Information -----|
|                            | (aud: RS1, sid: 0, gid: abcd0000, ...) |
|                            |            |                           |
|---- POST /authz-info -----&gt;|            |                           |
|      (access_token)        |            |                           |
|                            |            |                           |
|&lt;--- 2.01 Created ----------|            |                           |
|                            |            |                           |
|-------- POST /token -----------------------------------------------&gt;|
|  (aud: RS2, sid: 0, gid: abcd0000, ...) |                           |
|                            |            |                           |
|                            |            |                           |
|                            |            |                           |
|&lt;-------------------------------- Access Token + RS Information -----|
|                            | (aud: RS2, sid: 0, gid: abcd0000, ...) |
|                            |            |                           |
|----- POST /authz-info -----------------&gt;|                           |
|       (access_token)       |            |                           |
|                            |            |                           |
|                            |            |                           |
|&lt;--- 2.01 Created -----------------------|                           |
|                            |            |                           |
|-- Group OSCORE Request -+-&gt;|            |                           |
| (kid: 0, gid: abcd0000) \--------------&gt;|                           |
|                            |            |                           |
|                         /proof-of-possession/                       |
|                            |            |                           |
|                            |            |                           |
|&lt;-- Group OSCORE Response --|            |                           |
|         (kid: 1)           |            |                           |
|                            |            |                           |
/proof-of-possession/        |            |                           |
|                            |            |                           |
/Mutual authentication       |            |                           |
 between C and RS1/          |            |                           |
|                            |            |                           |
|                            |            |                           |
|&lt;-- Group OSCORE Response ---------------|                           |
|         (kid: 2)           |            |                           |
|                            |            |                           |
/proof-of-possession/        |            |                           |
|                            |            |                           |
/Mutual authentication       |            |                           |
 between C and RS2/          |            |                           |
|                            |            |                           |
|            ...             |            |                           |
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-protocol-overview-2" class="selfRef">Protocol Overview.</a>
        </figcaption></figure>
</div>
<div id="sec-protocol-overview-pre-conditions">
<section id="section-2.1">
        <h3 id="name-pre-conditions">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-pre-conditions" class="section-name selfRef">Pre-Conditions</a>
        </h3>
<p id="section-2.1-1">Using Group OSCORE and this profile requires both the Client and the Resource Servers to have previously joined the same OSCORE group. This especially includes the derivation of the Group OSCORE Security Context and the assignment of unique Sender IDs to use in the group. Nodes may join the OSCORE group through the respective Group Manager by using the approach defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>, which is also based on ACE.<a href="#section-2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-2.1-2">After the Client and Resource Servers have joined the group, this profile provides access control for accessing resources on those Resource Servers, by securely communicating with Group OSCORE.<a href="#section-2.1-2" class="pilcrow">Â¶</a></p>
<p id="section-2.1-3">As a pre-requisite for this profile, the Client has to have successfully joined the OSCORE group where also the Resource Servers (RSs) are members. Depending on the limited information initially available, the Client may have to first discover the exact OSCORE group used by the RSs for the resources of interest, e.g., by using the approach defined in <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="xref">I-D.tiloca-core-oscore-discovery</a>]</span>.<a href="#section-2.1-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-overview-token-retrieval">
<section id="section-2.2">
        <h3 id="name-access-token-retrieval">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-access-token-retrieval" class="section-name selfRef">Access Token Retrieval</a>
        </h3>
<p id="section-2.2-1">This profile requires that the Client retrieves an Access Token from the AS for the resource(s) it wants to access on each of the RSs, using the /token endpoint, as specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8" class="relref">Section 5.8</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. In a general case, it can be assumed that different RSs are associated with different ASs, even if the RSs are members of a same OSCORE group.<a href="#section-2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-2.2-2">In the Access Token request to the AS, the Client MUST include the Group Identifier of the OSCORE group and its own Sender ID in that group. The AS MUST specify these pieces of information in the Access Token, included in the Access Token response to the Client.<a href="#section-2.2-2" class="pilcrow">Â¶</a></p>
<p id="section-2.2-3">Furthermore, in the Access Token request to the AS, the Client MUST also include: its own public key used in the OSCORE group; and a proof-of-possession (PoP) evidence to proof possession of the corresponding private key. The PoP evidence is computed over a PoP input uniquely related to the secure communication association between the Client and the AS. The AS MUST include also the public key indicated by the Client in the Access Token.<a href="#section-2.2-3" class="pilcrow">Â¶</a></p>
<p id="section-2.2-4">The Access Token request and response MUST be confidentiality-protected and ensure authenticity. This profile RECOMMENDS the use of OSCORE between the Client and the AS, to reduce the number of libraries the client has to support. Other protocols fulfilling the security requirements defined in Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5" class="relref">5</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-6" class="relref">6</a> of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> MAY alternatively be used, such as TLS <span>[<a href="#RFC8446" class="xref">RFC8446</a>]</span> or DTLS <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span><span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>.<a href="#section-2.2-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-overview-token-posting">
<section id="section-2.3">
        <h3 id="name-access-token-posting">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-access-token-posting" class="section-name selfRef">Access Token Posting</a>
        </h3>
<p id="section-2.3-1">After having retrieved the Access Token from the AS, the Client posts the Access Token to the RS, using the /authz-info endpoint and mechanisms specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.10" class="relref">Section 5.10</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, as well as Content-Format = application/ace+cbor. When using this profile, the communication with the /authz-info endpoint is not protected.<a href="#section-2.3-1" class="pilcrow">Â¶</a></p>
<p id="section-2.3-2">If the Access Token is valid, the RS replies to this POST request with a 2.01 (Created) response with Content-Format = application/ace+cbor. Also, the RS associates the received Access Token with the Group OSCORE Security Context identified by the Group Identifier specified in the Access Token, following <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>. In practice, the RS maintains a collection of Security Contexts with associated authorization information, for all the clients that it is currently communicating with, and the authorization information is a policy used as input when processing requests from those clients.<a href="#section-2.3-2" class="pilcrow">Â¶</a></p>
<p id="section-2.3-3">Finally, the RS stores the association between i) the authorization information from the Access Token; and ii) the Group Identifier of the OSCORE group together with the Sender ID and the authentication credential of the Client in that group. This binds the Access Token with the Group OSCORE Security Context of the OSCORE group.<a href="#section-2.3-3" class="pilcrow">Â¶</a></p>
<p id="section-2.3-4">Finally, when the Client communicates with the RS using the Group OSCORE Security Context, the RS verifies that the Client is a legitimate member of the OSCORE group and especially the exact group member with the same Sender ID associated with the Access Token. This occurs when verifying a request protected with Group OSCORE, since the request includes the Client's Sender ID and either it embeds a signature computed also over that Sender ID (if protected with the group mode), or it is protected by means of pairwise symmetric keying material derived from the asymmetric keys of the two peers (if protected with the pairwise mode).<a href="#section-2.3-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-overview-communication">
<section id="section-2.4">
        <h3 id="name-secure-communication">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-secure-communication" class="section-name selfRef">Secure Communication</a>
        </h3>
<p id="section-2.4-1">The Client can send a request protected with Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> to the RS. This can be a unicast request addressed to the RS, or a multicast request addressed to the OSCORE group where the RS is also a member. To this end, the Client uses the Group OSCORE Security Context already established upon joining the OSCORE group, e.g., by using the approach defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. The RS may send a response back to the Client, protecting it by means of the same Group OSCORE Security Context.<a href="#section-2.4-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-c-as-comm">
<section id="section-3">
      <h2 id="name-client-as-communication">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-client-as-communication" class="section-name selfRef">Client-AS Communication</a>
      </h2>
<p id="section-3-1">This section details the Access Token POST Request that the Client sends to the /token endpoint of the AS, as well as the related Access Token response.<a href="#section-3-1" class="pilcrow">Â¶</a></p>
<p id="section-3-2">The Access Token MUST be bound to the public key of the client as proof-of-possession key (pop-key), by means of the 'cnf' claim.<a href="#section-3-2" class="pilcrow">Â¶</a></p>
<div id="sec-c-as-token-endpoint">
<section id="section-3.1">
        <h3 id="name-c-to-as-post-to-token-endpo">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-c-to-as-post-to-token-endpo" class="section-name selfRef">C-to-AS: POST to Token Endpoint</a>
        </h3>
<p id="section-3.1-1">The Client-to-AS request is specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. The Client MUST send this POST request to the /token endpoint over a secure channel that guarantees authentication, message integrity and confidentiality.<a href="#section-3.1-1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-2">The POST request is formatted as the analogous Client-to-AS request in the OSCORE profile of ACE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>), with the following additional parameters that MUST be included in the payload.<a href="#section-3.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">'context_id', defined in <a href="#context_id" class="xref">Section 3.1.1</a> of this document. This parameter specifies the Group Identifier (GID), i.e., the Id Context of an OSCORE group where the Client and the RS are currently members. In particular, the Client wishes to communicate with the RS using the Group OSCORE Security Context associated with that OSCORE group.<a href="#section-3.1-3.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.1-3.2">'salt_input', defined in <a href="#salt_input" class="xref">Section 3.1.2</a> of this document. This parameter includes the Sender ID that the Client has in the OSCORE group whose GID is specified in the 'context_id' parameter above.<a href="#section-3.1-3.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.1-3.3">
            <p id="section-3.1-3.3.1">'req_cnf', defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-params-16#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-ace-oauth-params" class="xref">I-D.ietf-ace-oauth-params</a>]</span>. This parameter follows the syntax from <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="xref">RFC8747</a>]</span> when including Value Type "COSE_Key" (1) and specifying an asymmetric key. In particular, the specified public key is the COSE Key equivalent to the authentication credential that the Client uses in the OSCORE group. The specified public key will be used as the pop-key bound to the Access Token.<a href="#section-3.1-3.3.1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-3.3.2">
Alternative Value Types defined in future specifications are fine to consider, if indicating a non-encrypted asymmetric key or full-fledged autentication credential.<a href="#section-3.1-3.3.2" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-3.1-4">In addition, the Client computes its proof-of-possession (PoP) evidence, in order to prove possession of its own private key used in the OSCORE group to the AS. This allows the AS to verify that the Client indeed owns the private key associated with that public key, as its alleged identity credential within the OSCORE group.<a href="#section-3.1-4" class="pilcrow">Â¶</a></p>
<p id="section-3.1-5">To this end, the Client MUST use as PoP input the byte representation of a quantity that uniquely represents the secure communication association between the Client and the AS. It is RECOMMENDED that the Client considers the following as PoP input.<a href="#section-3.1-5" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-6.1">If the Client and the AS communicate over (D)TLS, the PoP input is an exporter value computed as defined in <span><a href="https://rfc-editor.org/rfc/rfc8446#section-7.5" class="relref">Section 7.5</a> of [<a href="#RFC8446" class="xref">RFC8446</a>]</span>. In particular, the exporter label MUST be 'EXPORTER-ACE-Sign-Challenge-Client-AS' defined in <a href="#iana-tls-exporter-label" class="xref">Section 10.5</a> of this document, together with an empty 'context_value', and 32 bytes as 'key_length'.<a href="#section-3.1-6.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.1-6.2">
            <p id="section-3.1-6.2.1">If the Client and the AS communicate over OSCORE, the PoP input is the output PRK of a HKDF-Extract step <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>, i.e., PRK = HMAC-Hash(salt, IKM). In particular, 'salt' takes (x1 | x2), where x1 is the ID Context of the OSCORE Security Context between the Client and the AS, x2 is the Sender ID of the Client in that Security Context, and | denotes byte string concatenation. Also, 'IKM' is the OSCORE Master Secret of the OSCORE Security Context between the Client and the AS.<a href="#section-3.1-6.2.1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-6.2.2">
The HKDF MUST be one of the HMAC-based HKDF <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span> algorithms defined for COSE <span>[<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span>. The Client and AS may agree on the HKDF algorithm to use during the Client's registration at the AS. HKDF SHA-256 is mandatory to implement.<a href="#section-3.1-6.2.2" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-3.1-7">Then, the Client computes the PoP evidence as follows.<a href="#section-3.1-7" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-8.1">If the OSCORE group is not a pairwise-only group, the PoP evidence MUST be a signature. The Client computes the signature by using the same private key and signature algorithm it uses for signing messages in the OSCORE group. The private key corresponds to the authentication credential used in the OSCORE group, for which the equivalent COSE Key is specified in the 'req_cnf' parameter above.<a href="#section-3.1-8.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.1-8.2">
            <p id="section-3.1-8.2.1">If the OSCORE group is a pairwise-only group, the PoP evidence MUST be a MAC computed as follows, by using the HKDF Algorithm HKDF SHA-256, which consists of composing the HKDF-Extract and HKDF-Expand steps <span>[<a href="#RFC5869" class="xref">RFC5869</a>]</span>.<a href="#section-3.1-8.2.1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-8.2.2">
MAC = HKDF(salt, IKM, info, L)<a href="#section-3.1-8.2.2" class="pilcrow">Â¶</a></p>
<p id="section-3.1-8.2.3">
The input parameters of HKDF are as follows.<a href="#section-3.1-8.2.3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-8.2.4.1">salt takes as value the empty byte string.<a href="#section-3.1-8.2.4.1" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-3.1-8.2.4.2">
                <p id="section-3.1-8.2.4.2.1">IKM is computed as a cofactor Diffie-Hellman shared secret, see Section 5.7.1.2 of <span>[<a href="#NIST-800-56A" class="xref">NIST-800-56A</a>]</span>, using an ECDH algorithm pre-agreed between Client and AS. The Client uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the AS. For X25519 and X448, the procedure is described in <span><a href="https://rfc-editor.org/rfc/rfc7748#section-5" class="relref">Section 5</a> of [<a href="#RFC7748" class="xref">RFC7748</a>]</span>.<a href="#section-3.1-8.2.4.2.1" class="pilcrow">Â¶</a></p>
<p id="section-3.1-8.2.4.2.2">
The Client's private key corresponds to the Client's authentication credential used in the OSCORE group, for which the equivalent COSE Key is specified in the 'req_cnf' parameter above. The Client may obtain the Diffie-Hellman public key of the AS during its registration process at the AS.<a href="#section-3.1-8.2.4.2.2" class="pilcrow">Â¶</a></p>
<p id="section-3.1-8.2.4.2.3">
The Client and AS may agree on the ECDH algorithm to use during the Client's registration at the AS. The ECDH-SS + HKDF-256 algorithm specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-rfc8152bis-algs-12#section-6.3.1" class="relref">Section 6.3.1</a> of [<a href="#I-D.ietf-cose-rfc8152bis-algs" class="xref">I-D.ietf-cose-rfc8152bis-algs</a>]</span> is mandatory to implement.<a href="#section-3.1-8.2.4.2.3" class="pilcrow">Â¶</a></p>
</li>
              <li class="normal" id="section-3.1-8.2.4.3">info takes as value the PoP input.<a href="#section-3.1-8.2.4.3" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-3.1-8.2.4.4">L is equal to 8, i.e., the size of the MAC, in bytes.<a href="#section-3.1-8.2.4.4" class="pilcrow">Â¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-3.1-9">Finally, the Client MUST include one of the two following parameters in the payload of the POST request to the AS.<a href="#section-3.1-9" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-10.1">'client_cred_verify', defined in <a href="#client_cred_verify" class="xref">Section 3.1.3</a> of this document, specifying the Client's PoP evidence as a signature, which is computed as defined above. This parameter MUST be included if and only if the OSCORE group is not a pairwise-only group.<a href="#section-3.1-10.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.1-10.2">'client_cred_verify_mac', defined in <a href="#client_cred_verify_mac" class="xref">Section 3.1.4</a> of this document, specifying the Client's PoP evidence as a MAC, which is computed as defined above. This parameter MUST be included if and only if the OSCORE group is a pairwise-only group.<a href="#section-3.1-10.2" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-3.1-11">An example of such a request is shown in <a href="#fig-example-C-to-AS-symm" class="xref">Figure 2</a>.<a href="#section-3.1-11" class="pilcrow">Â¶</a></p>
<span id="name-example-c-to-as-post-token-"></span><div id="fig-example-C-to-AS-symm">
<figure id="figure-2">
          <div class="alignLeft art-text artwork" id="section-3.1-12.1">
<pre>
     Header: POST (Code=0.02)
     Uri-Host: "as.example.com"
     Uri-Path: "token"
     Content-Format: "application/ace+cbor"
     Payload:
     {
       "audience" : "tempSensor4711",
       "scope" : "read",
       "context_id" : h'abcd0000',
       "salt_input" : h'00',
       "req_cnf" : {
         "COSE_Key" : {
           "kty" : EC2,
           "crv" : P-256,
           "x" : h'd7cc072de2205bdc1537a543d53c60a6acb62eccd890c7fa
                   27c9e354089bbe13',
           "y" : h'f95e1d4b851a2cc80fff87d8e23f22afb725d535e515d020
                   731e79a3b4e47120'
         }
       },
       "client_cred_verify" : h'...'
       (signature content omitted for brevity)
     }
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-example-c-to-as-post-token-" class="selfRef">Example C-to-AS POST /token request for an Access Token bound to an asymmetric key.</a>
          </figcaption></figure>
</div>
<div id="context_id">
<section id="section-3.1.1">
          <h4 id="name-context_id-parameter">
<a href="#section-3.1.1" class="section-number selfRef">3.1.1. </a><a href="#name-context_id-parameter" class="section-name selfRef">'context_id' Parameter</a>
          </h4>
<p id="section-3.1.1-1">The 'context_id' parameter is an OPTIONAL parameter of the Access Token request message defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This parameter provides a value that the Client wishes to use with the RS as a hint for a security context. Its exact content is profile specific.<a href="#section-3.1.1-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="salt_input">
<section id="section-3.1.2">
          <h4 id="name-salt_input-parameter">
<a href="#section-3.1.2" class="section-number selfRef">3.1.2. </a><a href="#name-salt_input-parameter" class="section-name selfRef">'salt_input' Parameter</a>
          </h4>
<p id="section-3.1.2-1">The 'salt_input' parameter is an OPTIONAL parameter of the Access Token request message defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This parameter provides a value that the Client wishes to use as part of a salt with the RS, for deriving cryptographic keying material. Its exact content is profile specific.<a href="#section-3.1.2-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="client_cred_verify">
<section id="section-3.1.3">
          <h4 id="name-client_cred_verify-paramete">
<a href="#section-3.1.3" class="section-number selfRef">3.1.3. </a><a href="#name-client_cred_verify-paramete" class="section-name selfRef">'client_cred_verify' Parameter</a>
          </h4>
<p id="section-3.1.3-1">The 'client_cred_verify' parameter is an OPTIONAL parameter of the Access Token request message defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.1." class="relref">Section 5.8.1.</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This parameter provides a signature computed by the Client to prove the possession of its own private key.<a href="#section-3.1.3-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="client_cred_verify_mac">
<section id="section-3.1.4">
          <h4 id="name-client_cred_verify_mac-para">
<a href="#section-3.1.4" class="section-number selfRef">3.1.4. </a><a href="#name-client_cred_verify_mac-para" class="section-name selfRef">'client_cred_verify_mac' Parameter</a>
          </h4>
<p id="section-3.1.4-1">The 'client_cred_verify_mac' parameter is an OPTIONAL parameter of the Access Token request message defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.1." class="relref">Section 5.8.1.</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This parameter provides a Message Authentication Code (MAC) computed by the Client to prove the possession of its own private key.<a href="#section-3.1.4-1" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-as-c-token">
<section id="section-3.2">
        <h3 id="name-as-to-c-access-token">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-as-to-c-access-token" class="section-name selfRef">AS-to-C: Access Token</a>
        </h3>
<p id="section-3.2-1">After having verified the POST request to the /token endpoint and that the Client is authorized to obtain an Access Token corresponding to its Access Token request, the AS MUST verify the proof-of-possession (PoP) evidence. In particular, the AS proceeds as follows.<a href="#section-3.2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">As PoP input, the AS uses the same value considered by the Client in <a href="#sec-c-as-token-endpoint" class="xref">Section 3.1</a>.<a href="#section-3.2-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.2-2.2">As public key of the Client, the AS uses the one specified in the 'req_cnf' parameter of the Access Token request.<a href="#section-3.2-2.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.2-2.3">If the Access Token request includes the 'client_cred_verify' parameter, this specifies the PoP evidence as a signature. Then, the AS verifies the signature by using the public key of the Client.<a href="#section-3.2-2.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">If the Access Token request includes the 'client_cred_verify_mac' parameter, this specifies the PoP evidence as a Message Authentication Code (MAC).<a href="#section-3.2-2.4.1" class="pilcrow">Â¶</a></p>
<p id="section-3.2-2.4.2">
Then, the AS recomputes the MAC through the same process taken by the Client when preparing the value of the 'client_cred_verify_mac' parameter for the Access Token (see <a href="#sec-c-as-token-endpoint" class="xref">Section 3.1</a>), with the difference that the AS uses its own Diffie-Hellman private key and the Diffie-Hellman public key of the Client. The verification succeeds if and only if the recomputed MAC is equal to the MAC conveyed as PoP evidence in the Access Token request.<a href="#section-3.2-2.4.2" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-3.2-3">If both the 'client_cred_verify' and 'client_cred_verify_mac' parameters are present, or if the verification of the PoP evidence fails, the AS considers the Client request invalid.<a href="#section-3.2-3" class="pilcrow">Â¶</a></p>
<p id="section-3.2-4">If the Client request was invalid, or not authorized, the AS returns an error response as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-3.2-4" class="pilcrow">Â¶</a></p>
<p id="section-3.2-5">If all verifications are successful, the AS responds as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. In particular:<a href="#section-3.2-5" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">The AS can signal that the use of Group OSCORE is REQUIRED for a specific Access Token by including the 'ace_profile' parameter with the value "coap_group_oscore" in the Access Token response. The Client MUST use Group OSCORE towards all the Resource Servers for which this Access Token is valid. Usually, it is assumed that constrained devices will be pre-configured with the necessary profile, so that this kind of profile signaling can be omitted.<a href="#section-3.2-6.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.2-6.2">The AS MUST NOT include the 'rs_cnf' parameter defined in <span>[<a href="#I-D.ietf-ace-oauth-params" class="xref">I-D.ietf-ace-oauth-params</a>]</span>. In general, the AS may not be aware of the authentication credentials (and public keys included thereof) that the RSs use in the OSCORE group. Also, the Client is able to retrieve the authentication credentials of other group members from the responsible Group Manager, both upon joining the group or later on as a group member, as defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-3.2-6.2" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-3.2-7">The AS MUST include the following information as metadata of the issued Access Token. The use of CBOR web tokens (CWT) as specified in <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span> is RECOMMENDED.<a href="#section-3.2-7" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-8.1">The profile "coap_group_oscore". If the Access Token is a CWT, this is placed in the 'ace_profile' claim of the Access Token, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.10" class="relref">Section 5.10</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-3.2-8.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.2-8.2">The salt input specified in the 'salt_input' parameter of the Token Request. If the Access Token is a CWT, the content of the 'salt_input' parameter MUST be placed in the 'salt_input' claim of the Access Token, defined in <a href="#salt_input_claim" class="xref">Section 3.2.1</a> of this document.<a href="#section-3.2-8.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.2-8.3">The Context Id input specified in the 'context_id' parameter of the Token Request. If the Access Token is a CWT, the content of the 'context_id' parameter MUST be placed in the 'contextId_input' claim of the Access Token, defined in <a href="#contextId_input_claim" class="xref">Section 3.2.2</a> of this document.<a href="#section-3.2-8.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-3.2-8.4">
            <p id="section-3.2-8.4.1">The public key that the client uses in the OSCORE group and specified in the 'req_cnf' parameter of the Token request.<a href="#section-3.2-8.4.1" class="pilcrow">Â¶</a></p>
<p id="section-3.2-8.4.2">
If the Access Token is a CWT, the public key MUST be specified in the 'cnf' claim, which follows the syntax from <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="xref">RFC8747</a>]</span> when including Value Type "COSE_Key" (1) and specifying an asymmetric key. In particular, the 'cnf' claim includes the same COSE Key specified in the 'req_cnf' parameter of the Token Request, i.e., the COSE Key equivalent to the authentication credential that the Client uses in the OSCORE group.<a href="#section-3.2-8.4.2" class="pilcrow">Â¶</a></p>
<p id="section-3.2-8.4.3">
Alternative Value Types defined in future specifications are fine to consider, if indicating a non-encrypted asymmetric key or full-fledged autentication credential.<a href="#section-3.2-8.4.3" class="pilcrow">Â¶</a></p>
</li>
        </ul>
<p id="section-3.2-9"><a href="#fig-example-AS-to-C" class="xref">Figure 3</a> shows an example of such an AS response. The access token has been truncated for readability.<a href="#section-3.2-9" class="pilcrow">Â¶</a></p>
<span id="name-example-as-to-c-access-toke"></span><div id="fig-example-AS-to-C">
<figure id="figure-3">
          <div class="alignLeft art-text artwork" id="section-3.2-10.1">
<pre>
     Header: Created (Code=2.01)
     Content-Type: "application/ace+cbor"
     Payload:
     {
       "access_token" : h'8343a1010aa2044c53 ...'
        (remainder of CWT omitted for brevity),
       "ace_profile" : "coap_group_oscore",
       "expires_in" : 3600
     }
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-as-to-c-access-toke" class="selfRef">Example AS-to-C Access Token response with the Group OSCORE profile.</a>
          </figcaption></figure>
</div>
<p id="section-3.2-11"><a href="#fig-example-AS-to-C-CWT" class="xref">Figure 4</a> shows an example CWT Claims Set, containing the Client's public key in the group (as pop-key) in the 'cnf' claim.<a href="#section-3.2-11" class="pilcrow">Â¶</a></p>
<span id="name-example-cwt-claims-set-with"></span><div id="fig-example-AS-to-C-CWT">
<figure id="figure-4">
          <div class="alignLeft art-text artwork" id="section-3.2-12.1">
<pre>
     {
       "aud" : "tempSensorInLivingRoom",
       "iat" : "1360189224",
       "exp" : "1360289224",
       "scope" :  "temperature_g firmware_p",
       "cnf" : {
         "COSE_Key" : {
           "kty" : EC2,
           "crv" : P-256,
           "x" : h'd7cc072de2205bdc1537a543d53c60a6acb62eccd890c7fa
                   27c9e354089bbe13',
           "y" : h'f95e1d4b851a2cc80fff87d8e23f22afb725d535e515d020
                   731e79a3b4e47120'
       },
       "salt_input" : h'00',
       "contextId_input" : h'abcd0000'
     }
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-cwt-claims-set-with" class="selfRef">Example CWT Claims Set with OSCORE parameters.</a>
          </figcaption></figure>
</div>
<p id="section-3.2-13">The same CWT Claims Set as in <a href="#fig-example-AS-to-C-CWT" class="xref">Figure 4</a> and encoded in CBOR is shown in <a href="#fig-example-AS-to-C-CWT-encoding" class="xref">Figure 5</a>, using the value abbreviations defined in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and <span>[<a href="#RFC8747" class="xref">RFC8747</a>]</span>. The bytes in hexadecimal are reported in the first column, while their corresponding CBOR meaning is reported after the "#" sign on the second column, for easiness of readability.<a href="#section-3.2-13" class="pilcrow">Â¶</a></p>
<p id="section-3.2-14">NOTE: it should be checked (and in case fixed) that the values used below (which are not yet registered) are the final values registered by IANA.<a href="#section-3.2-14" class="pilcrow">Â¶</a></p>
<span id="name-example-cwt-claims-set-with-"></span><div id="fig-example-AS-to-C-CWT-encoding">
<figure id="figure-5">
          <div class="alignLeft art-text artwork" id="section-3.2-15.1">
<pre>
A7                                      # map(7)
   03                                   # unsigned(3)
   76                                   # text(22)
      74656D7053656E736F72496E4C6976696E67526F6F6D
   06                                   # unsigned(6)
   1A 5112D728                          # unsigned(1360189224)
   04                                   # unsigned(4)
   1A 51145DC8                          # unsigned(1360289224)
   09                                   # unsigned(9)
   78 18                                # text(24)
      74656D70657261747572655F67206669726D776172655F70
   08                                   # unsigned(8)
   A1                                   # map(1)
      01                                # unsigned(1)
      A4                                # map(4)
         01                             # unsigned(1)
         02                             # unsigned(2)
         20                             # negative(0)
         01                             # unsigned(1)
         21                             # negative(1)
         58 20                          # bytes(32)
            D7CC072DE2205BDC1537A543D53C60A6ACB62ECCD890C7FA27C9
            E354089BBE13
         22                             # negative(2)
         58 20                          # bytes(32)
            F95E1D4B851A2CC80FFF87D8E23F22AFB725D535E515D020731E
            79A3B4E47120
   18 3C                                # unsigned(60)
   41                                   # bytes(1)
      00
   18 3D                                # unsigned(61)
   44                                   # bytes(4)
      ABCD0000
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-cwt-claims-set-with-" class="selfRef">Example CWT Claims Set with OSCORE parameters, CBOR encoded.</a>
          </figcaption></figure>
</div>
<div id="salt_input_claim">
<section id="section-3.2.1">
          <h4 id="name-salt-input-claim">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-salt-input-claim" class="section-name selfRef">Salt Input Claim</a>
          </h4>
<p id="section-3.2.1-1">The 'salt_input' claim provides a value that the Client requesting the Access Token wishes to use as a part of a salt with the RS, e.g., for deriving cryptographic material.<a href="#section-3.2.1-1" class="pilcrow">Â¶</a></p>
<p id="section-3.2.1-2">This parameter specifies the value of the salt input, encoded as a CBOR byte string.<a href="#section-3.2.1-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="contextId_input_claim">
<section id="section-3.2.2">
          <h4 id="name-context-id-input-claim">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-context-id-input-claim" class="section-name selfRef">Context ID Input Claim</a>
          </h4>
<p id="section-3.2.2-1">The 'contextId_input' claim provides a value that the Client requesting the Access Token wishes to use with the RS, as a hint for a security context.<a href="#section-3.2.2-1" class="pilcrow">Â¶</a></p>
<p id="section-3.2.2-2">This parameter specifies the value of the Context ID input, encoded as a CBOR byte string.<a href="#section-3.2.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-c-rs-comm">
<section id="section-4">
      <h2 id="name-client-rs-communication">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-client-rs-communication" class="section-name selfRef">Client-RS Communication</a>
      </h2>
<p id="section-4-1">This section details the POST request and response to the /authz-info endpoint between the Client and the RS.<a href="#section-4-1" class="pilcrow">Â¶</a></p>
<p id="section-4-2">The proof-of-possession required to bind the Access Token to the Client is explicitly performed when the RS receives and verifies a request from the Client protected with Group OSCORE, either with the group mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>) or with the pairwise mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-9" class="relref">Section 9</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-4-2" class="pilcrow">Â¶</a></p>
<p id="section-4-3">In particular, the RS uses the Client's public key bound to the Access Token, either when verifying the signature of the request (if protected with the group mode), or when verifying the request as integrity-protected with pairwise keying material derived from the two peers' authentication credentials and asymmetric keys (if protected with the pairwise mode). In either case, the RS also authenticates the Client.<a href="#section-4-3" class="pilcrow">Â¶</a></p>
<p id="section-4-4">Similarly, when receiving a protected response from the RS, the Client uses the RS's public key either when verifying the signature of the response (if protected with the group mode), or when verifying the response as integrity-protected with pairwise keying material derived from the two peers' authentication credentials and asymmetric keys (if protected with the pairwise mode). In either case, the Client also authenticates the RS. Mutual authentication is only achieved after the client has successfully verified the protected response from the RS.<a href="#section-4-4" class="pilcrow">Â¶</a></p>
<p id="section-4-5">Therefore, an attacker using a stolen Access Token cannot generate a valid Group OSCORE message as protected through the Client's private key, and thus cannot prove possession of the pop-key bound to the Access Token. Also, if a Client legitimately owns an Access Token but has not joined the OSCORE group, it cannot generate a valid Group OSCORE message, as it does not store the necessary keying material shared among the group members.<a href="#section-4-5" class="pilcrow">Â¶</a></p>
<p id="section-4-6">Furthermore, a Client C1 is supposed to obtain a valid Access Token from the AS, as including the public key associated with its own private key used in the OSCORE group, together with its own Sender ID in that OSCORE group (see <a href="#sec-c-as-token-endpoint" class="xref">Section 3.1</a>). This allows the RS receiving an Access Token to verify with the Group Manager of that OSCORE group whether such a Client has indeed that Sender ID and an authentication credential including that public key in the OSCORE group.<a href="#section-4-6" class="pilcrow">Â¶</a></p>
<p id="section-4-7">As a consequence, a different Client C2, also member of the same OSCORE group, is not able to impersonate C1, by: i) getting a valid Access Token, specifying the Sender ID of C1 and a different (made-up) public key; ii) successfully posting the Access Token to RS; and then iii) attempting to communicate using Group OSCORE impersonating C1, while blaming C1 for the consequences.<a href="#section-4-7" class="pilcrow">Â¶</a></p>
<div id="sec-c-rs-authz">
<section id="section-4.1">
        <h3 id="name-c-to-rs-post-to-authz-info-">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-c-to-rs-post-to-authz-info-" class="section-name selfRef">C-to-RS POST to authz-info Endpoint</a>
        </h3>
<p id="section-4.1-1">The Client posts the Access Token to the /authz-info endpoint of the RS, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-4.1-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-rs-c-created">
<section id="section-4.2">
        <h3 id="name-rs-to-c-201-created">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-rs-to-c-201-created" class="section-name selfRef">RS-to-C: 2.01 (Created)</a>
        </h3>
<p id="section-4.2-1">The RS MUST verify the validity of the Access Token as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, with the following additions.<a href="#section-4.2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.1">The RS MUST check that the claims 'salt_input', 'contextId_input' and 'cnf' are included in the Access Token.<a href="#section-4.2-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.2-2.2">
            <p id="section-4.2-2.2.1">The RS considers: the content of the 'contextId_input' claim as the GID of the OSCORE group; the content of the 'salt_input' claim as the Sender ID that the Client has in the group; and the content of the 'cnf' claim as the COSE Key equivalent to the authentication credential that the Client uses in the group.<a href="#section-4.2-2.2.1" class="pilcrow">Â¶</a></p>
<p id="section-4.2-2.2.2">
The RS MUST check whether it already stores an authentication credential associated with the pair (GID, Sender ID) above, such that the COSE Key specified in the 'cnf' claim is its equivalent COSE Key.<a href="#section-4.2-2.2.2" class="pilcrow">Â¶</a></p>
<p id="section-4.2-2.2.3">
If this is not the case, the RS MUST request the Client's authentication credential to the Group Manager of the OSCORE group as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-13#section-10" class="relref">Section 10</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>, specifying the Client's Sender ID in the OSCORE group, i.e., the value of the 'salt_input' claim. Then, the RS performs the following actions.<a href="#section-4.2-2.2.3" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-2.2.4.1">The RS MUST check whether the Client's authentication credential retrieved from the Group Manager is such that the COSE Key specified in the 'cnf' claim of the Access Token is its equivalent COSE Key.<a href="#section-4.2-2.2.4.1" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-4.2-2.2.4.2">The RS MUST check that the Client's Sender ID provided by the Group Manager together with the Client's authentication credential matches the one retrieved from the 'salt_input' claim of the Access Token.<a href="#section-4.2-2.2.4.2" class="pilcrow">Â¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-4.2-3">If any of the checks above fails, the RS MUST consider the Access Token non valid, and MUST respond to the Client with an error response code equivalent to the CoAP code 4.00 (Bad Request).<a href="#section-4.2-3" class="pilcrow">Â¶</a></p>
<p id="section-4.2-4">If the Access Token is valid and further checks on its content are successful, the RS associates the authorization information from the Access Token with the Group OSCORE Security Context.<a href="#section-4.2-4" class="pilcrow">Â¶</a></p>
<p id="section-4.2-5">In particular, the RS associates the authorization information from the Access Token with the 3-tuple (GID, SaltInput, AuthCred), where GID is the Group Identifier of the OSCORE Group, while SaltInput and AuthCred are the Sender ID and the authentication credential that the Client uses in that OSCORE group, respectively.<a href="#section-4.2-5" class="pilcrow">Â¶</a></p>
<p id="section-4.2-6">The RS MUST keep this association up-to-date over time, as the 3-tuple (GID, SaltInput, AuthCred) associated with the Access Token might change. In particular:<a href="#section-4.2-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.2-7.1">If the OSCORE group is rekeyed (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-13#section-20" class="relref">Section 20</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>), the Group Identifier also changes in the group, and the new one replaces the current 'GID' value in the 3-tuple.<a href="#section-4.2-7.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-4.2-7.2">If the Client requests and obtains a new OSCORE Sender ID from the Group Manager (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-2.5.3.1" class="relref">Section 2.5.3.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> and <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-13#section-9" class="relref">Section 9</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>), the new Sender ID replaces the current 'SaltInput' value in the 3-tuple.<a href="#section-4.2-7.2" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-4.2-8">Finally, the RS MUST send a 2.01 (Created) response to the Client, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.10.1" class="relref">Section 5.10.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-4.2-8" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-client-rs-secure-communication">
<section id="section-4.3">
        <h3 id="name-client-rs-secure-communicat">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-client-rs-secure-communicat" class="section-name selfRef">Client-RS Secure Communication</a>
        </h3>
<p id="section-4.3-1">When previously joining the OSCORE group, both the Client and RS have already established the related Group OSCORE Security Context to communicate as group members. Therefore, they can simply start to securely communicate using Group OSCORE, without deriving any additional keying material or security association.<a href="#section-4.3-1" class="pilcrow">Â¶</a></p>
<div id="client-side">
<section id="section-4.3.1">
          <h4 id="name-client-side">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-client-side" class="section-name selfRef">Client Side</a>
          </h4>
<p id="section-4.3.1-1">After having received the 2.01 (Created) response from the RS, following the POST request to the authz-info endpoint, the Client starts the communication with the RS, by sending a request protected with Group OSCORE using the Group OSCORE Security Context <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-4.3.1-1" class="pilcrow">Â¶</a></p>
<p id="section-4.3.1-2">When communicating with the RS to access the resources as specified by the authorization information, the Client MUST use the Group OSCORE Security Context of the OSCORE group, whose GID was specified in the 'context_id' parameter of the Token request.<a href="#section-4.3.1-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="resource-server-side">
<section id="section-4.3.2">
          <h4 id="name-resource-server-side">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-resource-server-side" class="section-name selfRef">Resource Server Side</a>
          </h4>
<p id="section-4.3.2-1">After successful validation of the Access Token as defined in <a href="#sec-rs-c-created" class="xref">Section 4.2</a> and after having sent the 2.01 (Created) response, the RS can start to communicate with the Client using Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-4.3.2-1" class="pilcrow">Â¶</a></p>
<p id="section-4.3.2-2">When processing an incoming request protected with Group OSCORE, the RS MUST consider as valid Client's authentication credential only the one associated to the stored Access Token. As defined in <a href="#sec-client-public-key-change" class="xref">Section 4.5</a>, a possible change of authentication credential requires the Client to upload to the RS a new Access Token bound to the new authentication credential.<a href="#section-4.3.2-2" class="pilcrow">Â¶</a></p>
<p id="section-4.3.2-3">Additionally, for every incoming request, if Group OSCORE verification succeeds, the verification of access rights is performed as described in <a href="#sec-c-rs-access-rights" class="xref">Section 4.4</a>.<a href="#section-4.3.2-3" class="pilcrow">Â¶</a></p>
<p id="section-4.3.2-4">After the expiration of the Access Token related to a Group OSCORE Security Context, if the Client uses the Group OSCORE Security Context to send a request for any resource intended for OSCORE group members and that requires an active Access Token, the RS MUST respond with a 4.01 (Unauthorized) error message protected with the Group OSCORE Security Context.<a href="#section-4.3.2-4" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-c-rs-access-rights">
<section id="section-4.4">
        <h3 id="name-access-rights-verification">
<a href="#section-4.4" class="section-number selfRef">4.4. </a><a href="#name-access-rights-verification" class="section-name selfRef">Access Rights Verification</a>
        </h3>
<p id="section-4.4-1">The RS MUST follow the procedures defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.10.2" class="relref">Section 5.10.2</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. If an RS receives a Group OSCORE-protected request from a Client, the RS processes it according to <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-4.4-1" class="pilcrow">Â¶</a></p>
<p id="section-4.4-2">If the Group OSCORE verification succeeds, and the target resource requires authorization, the RS retrieves the authorization information from the Access Token associated with the Group OSCORE Security Context. Then, the RS MUST verify that the action requested on the resource is authorized.<a href="#section-4.4-2" class="pilcrow">Â¶</a></p>
<p id="section-4.4-3">The response code MUST be 4.01 (Unauthorized) if the RS has no valid Access Token for the Client. If the RS has an Access Token for the Client but no actions are authorized on the target resource, the RS MUST reject the request with a 4.03 (Forbidden). If the RS has an Access Token for the Client but the requested action is not authorized, the RS MUST reject the request with a 4.05 (Method Not Allowed).<a href="#section-4.4-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-client-public-key-change">
<section id="section-4.5">
        <h3 id="name-change-of-clients-authentic">
<a href="#section-4.5" class="section-number selfRef">4.5. </a><a href="#name-change-of-clients-authentic" class="section-name selfRef">Change of Client's Authentication Credential in the Group</a>
        </h3>
<p id="section-4.5-1">During its membership in the OSCORE group, the client might change the authentication credential it uses in the group. When this happens, the Client uploads the new authentication credential to the Group Manager, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-13#section-11" class="relref">Section 11</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#section-4.5-1" class="pilcrow">Â¶</a></p>
<p id="section-4.5-2">After that, and in order to continue communicating with the RS, the Client MUST perform the following actions.<a href="#section-4.5-2" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-4.5-3">
<li id="section-4.5-3.1">
            <p id="section-4.5-3.1.1">The Client requests a new Access Token to the AS, as defined in <a href="#sec-c-as-comm" class="xref">Section 3</a>. In particular, when sending the POST request as defined in <a href="#sec-c-as-token-endpoint" class="xref">Section 3.1</a>, the Client indicates:<a href="#section-4.5-3.1.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-4.5-3.1.2.1">The current Group Identifier of the OSCORE group, as value of the 'context_id' parameter.<a href="#section-4.5-3.1.2.1" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-4.5-3.1.2.2">The current Sender ID it has in the OSCORE group, as value of the 'salt_input' parameter.<a href="#section-4.5-3.1.2.2" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-4.5-3.1.2.3">The public key of the new authentication credential it uses in the OSCORE group, as value of the 'req_cnf' parameter. In particular, the specified public key is the COSE Key equivalent to the new authentication credential that the Client uses in the OSCORE group.<a href="#section-4.5-3.1.2.3" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="section-4.5-3.1.2.4">The proof-of-possession (PoP) evidence corresponding to the public key of the new authentication credential, as value of the 'client_cred_verify' or 'client_cred_verify_mac' parameter.<a href="#section-4.5-3.1.2.4" class="pilcrow">Â¶</a>
</li>
            </ul>
</li>
          <li id="section-4.5-3.2">After receiving the response from the AS (see <a href="#sec-as-c-token" class="xref">Section 3.2</a>), the Client performs the same exchanges with the RS as defined in <a href="#sec-c-rs-comm" class="xref">Section 4</a>.<a href="#section-4.5-3.2" class="pilcrow">Â¶</a>
</li>
        </ol>
<p id="section-4.5-4">When receiving the new Access Token, the RS performs the same steps defined in <a href="#sec-rs-c-created" class="xref">Section 4.2</a>, with the following addition, in case the new Access Token is successfully verified and stored. The RS also deletes the old Access Token, i.e., the one whose associated 3-tuple has the same GID and SaltInput values as in the 3-tuple including the new authentication credential of the Client and associated with the new Access Token.<a href="#section-4.5-4" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-comm-as">
<section id="section-5">
      <h2 id="name-secure-communication-with-t">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-secure-communication-with-t" class="section-name selfRef">Secure Communication with the AS</a>
      </h2>
<p id="section-5-1">As specified in the ACE framework (see Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8" class="relref">5.8</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.9" class="relref">5.9</a> of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>), the requesting entity (RS and/or Client) and the AS communicate via the /token or /introspection endpoint. The use of CoAP and OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> for this communication is RECOMMENDED in this profile. Other protocols fulfilling the security requirements defined in Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5" class="relref">5</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-6" class="relref">6</a> of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> (such as HTTP and DTLS or TLS) MAY be used instead.<a href="#section-5-1" class="pilcrow">Â¶</a></p>
<p id="section-5-2">If OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> is used, the requesting entity and the AS are expected to have a pre-established Security Context in place. How this Security Context is established is out of the scope of this profile. Furthermore, the requesting entity and the AS communicate using OSCORE through the /introspection endpoint as specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.9" class="relref">Section 5.9</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, and through the /token endpoint as specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8" class="relref">Section 5.8</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-5-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-discard-context">
<section id="section-6">
      <h2 id="name-discarding-the-security-con">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-discarding-the-security-con" class="section-name selfRef">Discarding the Security Context</a>
      </h2>
<p id="section-6-1">As members of an OSCORE group, the Client and the RS may independently leave the group or be forced to, e.g., if compromised or suspected so. Upon leaving the OSCORE group, the Client or RS also discards the Group OSCORE Security Context, which may anyway be renewed by the Group Manager through a group rekeying process (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-6-1" class="pilcrow">Â¶</a></p>
<p id="section-6-2">The Client or RS can acquire a new Group OSCORE Security Context, by re-joining the OSCORE group, e.g., by using the approach defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. In such a case, the Client SHOULD request a new Access Token and post it to the RS.<a href="#section-6-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-cbor-mappings">
<section id="section-7">
      <h2 id="name-cbor-mappings">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-cbor-mappings" class="section-name selfRef">CBOR Mappings</a>
      </h2>
<p id="section-7-1">The new parameters defined in this document MUST be mapped to CBOR types as specified in <a href="#fig-cbor-mappings-parameters" class="xref">Figure 6</a>, using the given integer abbreviation for the map key.<a href="#section-7-1" class="pilcrow">Â¶</a></p>
<span id="name-cbor-mappings-for-new-param"></span><div id="fig-cbor-mappings-parameters">
<figure id="figure-6">
        <div class="alignCenter art-text artwork" id="section-7-2.1">
<pre>
/------------------------+----------+------------\
| Parameter name         | CBOR Key | Value Type |
|------------------------+----------+------------|
| context_id             | TBD      | bstr       |
| salt_input             | TBD      | bstr       |
| client_cred_verify     | TBD      | bstr       |
| client_cred_verify_mac | TBD      | bstr       |
\------------------------+----------+------------/
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-cbor-mappings-for-new-param" class="selfRef">CBOR mappings for new parameters.</a>
        </figcaption></figure>
</div>
<p id="section-7-3">The new claims defined in this document MUST be mapped to CBOR types as specified in <a href="#fig-cbor-mappings-claims" class="xref">Figure 7</a>, using the given integer abbreviation for the map key.<a href="#section-7-3" class="pilcrow">Â¶</a></p>
<span id="name-cbor-mappings-for-new-claim"></span><div id="fig-cbor-mappings-claims">
<figure id="figure-7">
        <div class="alignCenter art-text artwork" id="section-7-4.1">
<pre>
/-----------------+----------+------------\
| Claim name      | CBOR Key | Value Type |
|-----------------+----------+------------|
| salt_input      | TBD      | bstr       |
| contextId_input | TBD      | bstr       |
\-----------------+----------+------------/
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-cbor-mappings-for-new-claim" class="selfRef">CBOR mappings for new claims.</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-security-considerations">
<section id="section-8">
      <h2 id="name-security-considerations-4">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations-4" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. Thus, the general security considerations from the ACE framework also apply to this profile.<a href="#section-8-1" class="pilcrow">Â¶</a></p>
<p id="section-8-2">The proof-of-possession (PoP) key bound to an Access Token is always an asymmetric key, i.e., the public key that the Client uses in the OSCORE group. This means that there is never a same shared secret used as PoP key with possible multiple RSs. Therefore, it is possible and safe for the AS to issue an Access Token whose audience comprises multiple RSs.<a href="#section-8-2" class="pilcrow">Â¶</a></p>
<p id="section-8-3">In such a case, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-6.1" class="relref">Section 6.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, the AS has to ensure the integrity protection of the Access Token by protecting it through an asymmetric signature. In addition, the used audience has to correctly identify all the RSs that are intended recipients of the Access Token. As a particular case, the audience can be the name of the OSCORE group, if the Access Token is intended to all the RSs in that group.<a href="#section-8-3" class="pilcrow">Â¶</a></p>
<p id="section-8-4">Furthermore, this document inherits the general security considerations about Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, as to the specific use of Group OSCORE according to this profile.<a href="#section-8-4" class="pilcrow">Â¶</a></p>
<p id="section-8-5">Group OSCORE is designed to secure point-to-point as well as point-to-multipoint communications, providing a secure binding between a single request and multiple corresponding responses. In particular, Group OSCORE fulfills the same security requirements of OSCORE, for group requests and responses.<a href="#section-8-5" class="pilcrow">Â¶</a></p>
<p id="section-8-6">Group OSCORE ensures source authentication of messages both in group mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>) and in pairwise mode (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-9" class="relref">Section 9</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-8-6" class="pilcrow">Â¶</a></p>
<p id="section-8-7">When protecting an outgoing message in group mode, the sender uses its private key to compute a digital signature, which is embedded in the protected message. The group mode can be used to protect messages sent over multicast to multiple recipients, or sent over unicast to one recipient.<a href="#section-8-7" class="pilcrow">Â¶</a></p>
<p id="section-8-8">When protecting an outgoing message in pairwise mode, the sender uses a pairwise symmetric key, as derived from the asymmetric keys of the two peers exchanging the message. The pairwise mode can be used to protect only messages intended to one recipient.<a href="#section-8-8" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-privacy-considerations">
<section id="section-9">
      <h2 id="name-privacy-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-9-1">This document specifies a profile for the Authentication and Authorization for Constrained Environments (ACE) framework <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. Thus the general privacy considerations from the ACE framework also apply to this profile.<a href="#section-9-1" class="pilcrow">Â¶</a></p>
<p id="section-9-2">As this profile uses Group OSCORE, the privacy considerations from <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> apply to this document as well.<a href="#section-9-2" class="pilcrow">Â¶</a></p>
<p id="section-9-3">An unprotected response to an unauthorized request may disclose information about the RS and/or its existing relationship with the Client. It is advisable to include as little information as possible in an unencrypted response. However, since both the Client and the RS share a Group OSCORE Security Context, unauthorized, yet protected requests are followed by protected responses, which can thus include more detailed information.<a href="#section-9-3" class="pilcrow">Â¶</a></p>
<p id="section-9-4">Although it may be encrypted, the Access Token is sent in the clear to the /authz-info endpoint at the RS. Thus, if the Client uses the same single Access Token from multiple locations with multiple Resource Servers, it can risk being tracked through the Access Token's value.<a href="#section-9-4" class="pilcrow">Â¶</a></p>
<p id="section-9-5">Note that, even though communications are protected with Group OSCORE, some information might still leak, due to the observable size, source address and destination address of exchanged messages.<a href="#section-9-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="iana">
<section id="section-10">
      <h2 id="name-iana-considerations-4">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-iana-considerations-4" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-10-1">This document has the following actions for IANA.<a href="#section-10-1" class="pilcrow">Â¶</a></p>
<div id="iana-ace-oauth-profile">
<section id="section-10.1">
        <h3 id="name-ace-profile-registry">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-ace-profile-registry" class="section-name selfRef">ACE Profile Registry</a>
        </h3>
<p id="section-10.1-1">IANA is asked to add the following entry to the "ACE Profile" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-8.8" class="relref">Section 8.8</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-10.1-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.1-2.1">Name: coap_group_oscore<a href="#section-10.1-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.1-2.2">Description: Profile to secure communications between constrained nodes using the Authentication and Authorization for Constrained Environments framework, by enabling authentication and fine-grained authorization of members of an OSCORE group, that use a pre-established Group OSCORE Security Context to communicate with Group OSCORE. Optionally, the dual mode defined in <a href="#full-version" class="xref">Appendix A</a> additionally establishes a pairwise OSCORE Security Context, and thus also enables OSCORE communication between two members of the OSCORE group.<a href="#section-10.1-2.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.1-2.3">CBOR Value: TBD (value between 1 and 255)<a href="#section-10.1-2.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.1-2.4">Reference: [[this document]]<a href="#section-10.1-2.4" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-oauth-params">
<section id="section-10.2">
        <h3 id="name-oauth-parameters-registry">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-oauth-parameters-registry" class="section-name selfRef">OAuth Parameters Registry</a>
        </h3>
<p id="section-10.2-1">IANA is asked to add the following entries to the "OAuth Parameters" registry.<a href="#section-10.2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-2.1">Name: "context_id"<a href="#section-10.2-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-2.2">Parameter Usage Location: token request<a href="#section-10.2-2.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-2.3">Change Controller: IESG<a href="#section-10.2-2.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-2.4">Specification Document(s): <a href="#context_id" class="xref">Section 3.1.1</a> of [[this document]]<a href="#section-10.2-2.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.2-3"></p>
<ul class="normal">
<li class="normal" id="section-10.2-4.1">Name: "salt_input"<a href="#section-10.2-4.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-4.2">Parameter Usage Location: token request<a href="#section-10.2-4.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-4.3">Change Controller: IESG<a href="#section-10.2-4.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-4.4">Specification Document(s): <a href="#salt_input" class="xref">Section 3.1.2</a> of [[this document]]<a href="#section-10.2-4.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.2-5"></p>
<ul class="normal">
<li class="normal" id="section-10.2-6.1">Name: "client_cred_verify"<a href="#section-10.2-6.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-6.2">Parameter Usage Location: token request<a href="#section-10.2-6.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-6.3">Change Controller: IESG<a href="#section-10.2-6.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-6.4">Specification Document(s): <a href="#client_cred_verify" class="xref">Section 3.1.3</a> of [[this document]]<a href="#section-10.2-6.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.2-7"></p>
<ul class="normal">
<li class="normal" id="section-10.2-8.1">Name: "client_cred_verify_mac"<a href="#section-10.2-8.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-8.2">Parameter Usage Location: token request<a href="#section-10.2-8.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-8.3">Change Controller: IESG<a href="#section-10.2-8.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-8.4">Specification Document(s): <a href="#client_cred_verify_mac" class="xref">Section 3.1.4</a> of [[this document]]<a href="#section-10.2-8.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.2-9"></p>
<ul class="normal">
<li class="normal" id="section-10.2-10.1">Name: "client_cred"<a href="#section-10.2-10.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-10.2">Parameter Usage Location: token request<a href="#section-10.2-10.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-10.3">Change Controller: IESG<a href="#section-10.2-10.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.2-10.4">Specification Document(s): <a href="#client_cred-appendix" class="xref">Appendix A.2.1.1</a> of [[this document]]<a href="#section-10.2-10.4" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-token-cbor-mappings">
<section id="section-10.3">
        <h3 id="name-oauth-parameters-cbor-mappi">
<a href="#section-10.3" class="section-number selfRef">10.3. </a><a href="#name-oauth-parameters-cbor-mappi" class="section-name selfRef">OAuth Parameters CBOR Mappings Registry</a>
        </h3>
<p id="section-10.3-1">IANA is asked to add the following entries to the "OAuth Parameters CBOR Mappings" registry defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-8.10" class="relref">Section 8.10</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#section-10.3-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.3-2.1">Name: "context_id"<a href="#section-10.3-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-2.2">CBOR Key: TBD<a href="#section-10.3-2.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-2.3">Value Type: bstr<a href="#section-10.3-2.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-2.4">Reference: <a href="#context_id" class="xref">Section 3.1.1</a> of [[this document]]<a href="#section-10.3-2.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.3-3"></p>
<ul class="normal">
<li class="normal" id="section-10.3-4.1">Name: "salt_input"<a href="#section-10.3-4.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-4.2">CBOR Key: TBD<a href="#section-10.3-4.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-4.3">Value Type: bstr<a href="#section-10.3-4.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-4.4">Reference: <a href="#salt_input" class="xref">Section 3.1.2</a> of [[this document]]<a href="#section-10.3-4.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.3-5"></p>
<ul class="normal">
<li class="normal" id="section-10.3-6.1">Name: "client_cred_verify"<a href="#section-10.3-6.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-6.2">CBOR Key: TBD<a href="#section-10.3-6.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-6.3">Value Type: bstr<a href="#section-10.3-6.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-6.4">Reference: <a href="#client_cred_verify" class="xref">Section 3.1.3</a> of [[this document]]<a href="#section-10.3-6.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.3-7"></p>
<ul class="normal">
<li class="normal" id="section-10.3-8.1">Name: "client_cred_verify_mac"<a href="#section-10.3-8.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-8.2">CBOR Key: TBD<a href="#section-10.3-8.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-8.3">Value Type: bstr<a href="#section-10.3-8.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-8.4">Reference: <a href="#client_cred_verify_mac" class="xref">Section 3.1.4</a> of [[this document]]<a href="#section-10.3-8.4" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.3-9"></p>
<ul class="normal">
<li class="normal" id="section-10.3-10.1">Name: "client_cred"<a href="#section-10.3-10.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-10.2">CBOR Key: TBD<a href="#section-10.3-10.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-10.3">Value Type: bstr<a href="#section-10.3-10.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.3-10.4">Reference: <a href="#client_cred-appendix" class="xref">Appendix A.2.1.1</a> of [[this document]]<a href="#section-10.3-10.4" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-token-cwt-claims">
<section id="section-10.4">
        <h3 id="name-cbor-web-token-claims-regis">
<a href="#section-10.4" class="section-number selfRef">10.4. </a><a href="#name-cbor-web-token-claims-regis" class="section-name selfRef">CBOR Web Token Claims Registry</a>
        </h3>
<p id="section-10.4-1">IANA is asked to add the following entries to the "CBOR Web Token Claims" registry.<a href="#section-10.4-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.4-2.1">Claim Name: "salt_input"<a href="#section-10.4-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-2.2">Claim Description: Client provided salt input<a href="#section-10.4-2.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-2.3">JWT Claim Name: "N/A"<a href="#section-10.4-2.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-2.4">Claim Key: TBD<a href="#section-10.4-2.4" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-2.5">Claim Value Type(s): bstr<a href="#section-10.4-2.5" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-2.6">Change Controller: IESG<a href="#section-10.4-2.6" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-2.7">Specification Document(s): <a href="#salt_input_claim" class="xref">Section 3.2.1</a> of [[this document]]<a href="#section-10.4-2.7" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.4-3"></p>
<ul class="normal">
<li class="normal" id="section-10.4-4.1">Claim Name: "contextId_input"<a href="#section-10.4-4.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-4.2">Claim Description: Client context id input<a href="#section-10.4-4.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-4.3">JWT Claim Name: "N/A"<a href="#section-10.4-4.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-4.4">Claim Key: TBD<a href="#section-10.4-4.4" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-4.5">Claim Value Type(s): bstr<a href="#section-10.4-4.5" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-4.6">Change Controller: IESG<a href="#section-10.4-4.6" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-4.7">Specification Document(s): <a href="#contextId_input_claim" class="xref">Section 3.2.2</a> of [[this document]]<a href="#section-10.4-4.7" class="pilcrow">Â¶</a>
</li>
        </ul>
<p id="section-10.4-5"></p>
<ul class="normal">
<li class="normal" id="section-10.4-6.1">Claim Name: "client_cred"<a href="#section-10.4-6.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-6.2">Claim Description: Client Credential<a href="#section-10.4-6.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-6.3">JWT Claim Name: "N/A"<a href="#section-10.4-6.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-6.4">Claim Key: TBD<a href="#section-10.4-6.4" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-6.5">Claim Value Type(s): map<a href="#section-10.4-6.5" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-6.6">Change Controller: IESG<a href="#section-10.4-6.6" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.4-6.7">Specification Document(s): <a href="#client_cred_claim-appendix" class="xref">Appendix A.2.2.2</a> of [[this document]]<a href="#section-10.4-6.7" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
<div id="iana-tls-exporter-label">
<section id="section-10.5">
        <h3 id="name-tls-exporter-label-registry">
<a href="#section-10.5" class="section-number selfRef">10.5. </a><a href="#name-tls-exporter-label-registry" class="section-name selfRef">TLS Exporter Label Registry</a>
        </h3>
<p id="section-10.5-1">IANA is asked to add the following entry to the "TLS Exporter Label" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc5705#section-6" class="relref">Section 6</a> of [<a href="#RFC5705" class="xref">RFC5705</a>]</span> and updated in <span><a href="https://rfc-editor.org/rfc/rfc8447#section-12" class="relref">Section 12</a> of [<a href="#RFC8447" class="xref">RFC8447</a>]</span>.<a href="#section-10.5-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.5-2.1">Value: EXPORTER-ACE-Sign-Challenge-Client-AS<a href="#section-10.5-2.1" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.5-2.2">DTLS-OK: Y<a href="#section-10.5-2.2" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.5-2.3">Recommended: N<a href="#section-10.5-2.3" class="pilcrow">Â¶</a>
</li>
          <li class="normal" id="section-10.5-2.4">Reference: [[this document]] (<a href="#sec-c-as-token-endpoint" class="xref">Section 3.1</a>)<a href="#section-10.5-2.4" class="pilcrow">Â¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-11">
      <h2 id="name-references-4">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-references-4" class="section-name selfRef">References</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-normative-references-4">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-normative-references-4" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-key-groupcomm-oscore">[I-D.ietf-ace-key-groupcomm-oscore]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Park, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Key Management for OSCORE Groups in ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-key-groupcomm-oscore-13</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-oscore-13.txt">https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-oscore-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-46</span>, <time datetime="2021-11-08" class="refDate">8 November 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-46.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-46.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-params">[I-D.ietf-ace-oauth-params]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refTitle">"Additional OAuth Parameters for Authorization in Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-params-16</span>, <time datetime="2021-09-07" class="refDate">7 September 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oauth-params-16.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oauth-params-16.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oscore-profile">[I-D.ietf-ace-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"OSCORE Profile of the Authentication and Authorization for Constrained Environments Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-profile-19</span>, <time datetime="2021-05-06" class="refDate">6 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oscore-profile-19.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oscore-profile-19.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-06</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-06.txt">https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">J. Park</span>, <span class="refTitle">"Group OSCORE - Secure Group Communication for CoAP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-14</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-14.txt">https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-14.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-algs">[I-D.ietf-cose-rfc8152bis-algs]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Initial Algorithms"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-algs-12</span>, <time datetime="2020-09-24" class="refDate">24 September 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-algs-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-rfc8152bis-struct">[I-D.ietf-cose-rfc8152bis-struct]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE): Structures and Process"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-rfc8152bis-struct-15</span>, <time datetime="2021-02-01" class="refDate">1 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt">https://www.ietf.org/archive/id/draft-ietf-cose-rfc8152bis-struct-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-800-56A">[NIST-800-56A]</dt>
        <dd>
<span class="refAuthor">Barker, E.</span>, <span class="refAuthor">Chen, L.</span>, <span class="refAuthor">Roginsky, A.</span>, <span class="refAuthor">Vassilev, A.</span>, and <span class="refAuthor">R. Davis</span>, <span class="refTitle">"Recommendation for Pair-Wise Key-Establishment Schemes Using Discrete Logarithm Cryptography - NIST Special Publication 800-56A, Revision 3"</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf">https://nvlpubs.nist.gov/nistpubs/SpecialPublications/NIST.SP.800-56Ar3.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5705">[RFC5705]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"Keying Material Exporters for Transport Layer Security (TLS)"</span>, <span class="seriesInfo">RFC 5705</span>, <span class="seriesInfo">DOI 10.17487/RFC5705</span>, <time datetime="2010-03" class="refDate">March 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5705">https://www.rfc-editor.org/info/rfc5705</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5869">[RFC5869]</dt>
        <dd>
<span class="refAuthor">Krawczyk, H.</span> and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"HMAC-based Extract-and-Expand Key Derivation Function (HKDF)"</span>, <span class="seriesInfo">RFC 5869</span>, <span class="seriesInfo">DOI 10.17487/RFC5869</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5869">https://www.rfc-editor.org/info/rfc5869</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6749">[RFC6749]</dt>
        <dd>
<span class="refAuthor">Hardt, D., Ed.</span>, <span class="refTitle">"The OAuth 2.0 Authorization Framework"</span>, <span class="seriesInfo">RFC 6749</span>, <span class="seriesInfo">DOI 10.17487/RFC6749</span>, <time datetime="2012-10" class="refDate">October 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6749">https://www.rfc-editor.org/info/rfc6749</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6920">[RFC6920]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Kutscher, D.</span>, <span class="refAuthor">Dannewitz, C.</span>, <span class="refAuthor">Ohlman, B.</span>, <span class="refAuthor">Keranen, A.</span>, and <span class="refAuthor">P. Hallam-Baker</span>, <span class="refTitle">"Naming Things with Hashes"</span>, <span class="seriesInfo">RFC 6920</span>, <span class="seriesInfo">DOI 10.17487/RFC6920</span>, <time datetime="2013-04" class="refDate">April 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6920">https://www.rfc-editor.org/info/rfc6920</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8447">[RFC8447]</dt>
        <dd>
<span class="refAuthor">Salowey, J.</span> and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"IANA Registry Updates for TLS and DTLS"</span>, <span class="seriesInfo">RFC 8447</span>, <span class="seriesInfo">DOI 10.17487/RFC8447</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8447">https://www.rfc-editor.org/info/rfc8447</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11.2">
        <h3 id="name-informative-references-4">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-informative-references-4" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-ace-dtls-authorize">[I-D.ietf-ace-dtls-authorize]</dt>
        <dd>
<span class="refAuthor">Gerdes, S.</span>, <span class="refAuthor">Bergmann, O.</span>, <span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Datagram Transport Layer Security (DTLS) Profile for Authentication and Authorization for Constrained Environments (ACE)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-dtls-authorize-18</span>, <time datetime="2021-06-04" class="refDate">4 June 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-dtls-authorize-18.txt">https://www.ietf.org/archive/id/draft-ietf-ace-dtls-authorize-18.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-mqtt-tls-profile">[I-D.ietf-ace-mqtt-tls-profile]</dt>
        <dd>
<span class="refAuthor">Sengul, C.</span> and <span class="refAuthor">A. Kirby</span>, <span class="refTitle">"Message Queuing Telemetry Transport (MQTT)-TLS profile of Authentication and Authorization for Constrained Environments (ACE) Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-mqtt-tls-profile-15</span>, <time datetime="2022-03-01" class="refDate">1 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-mqtt-tls-profile-15.txt">https://www.ietf.org/archive/id/draft-ietf-ace-mqtt-tls-profile-15.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">HÃ¶glund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-03</span>, <time datetime="2022-01-10" class="refDate">10 January 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-03.txt">https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls13">[I-D.ietf-tls-dtls13]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls13-43</span>, <time datetime="2021-04-30" class="refDate">30 April 2021</time>, <span>&lt;<a href="https://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-43.txt">https://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-43.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-oscore-discovery">[I-D.tiloca-core-oscore-discovery]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Amsuess, C.</span>, and <span class="refAuthor">P. V. D. Stok</span>, <span class="refTitle">"Discovery of OSCORE Groups with the CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-oscore-discovery-11</span>, <time datetime="2022-03-07" class="refDate">7 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-11.txt">https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-11.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7925">[RFC7925]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7925">https://www.rfc-editor.org/info/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8446">[RFC8446]</dt>
      <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refTitle">"The Transport Layer Security (TLS) Protocol Version 1.3"</span>, <span class="seriesInfo">RFC 8446</span>, <span class="seriesInfo">DOI 10.17487/RFC8446</span>, <time datetime="2018-08" class="refDate">August 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8446">https://www.rfc-editor.org/info/rfc8446</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="full-version">
<section id="appendix-A">
      <h2 id="name-dual-mode-group-oscore-osco">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-dual-mode-group-oscore-osco" class="section-name selfRef">Dual Mode (Group OSCORE &amp; OSCORE)</a>
      </h2>
<p id="appendix-A-1">This appendix defines the dual mode of this profile, which allows using both OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> as security protocols, by still relying on a single Access Token.<a href="#appendix-A-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A-2">That is, the dual mode of this profile specifies how a Client uses CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> to communicate to a single Resource Server, or CoAP over IP multicast <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span> to communicate to multiple Resource Servers that are members of a group and share a common set of resources.<a href="#appendix-A-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A-3">In particular, the dual mode of this profile uses two complementary security protocols to provide secure communication between the Client and the Resource Server(s). That is, it defines the use of either OSCORE or Group OSCORE to protect unicast requests addressed to a single Resource Server, as well as possible responses. Additionally, it defines the use of Group OSCORE to protect multicast requests sent to a group of Resource Servers, as well as possible individual responses. Like in the main mode of this profile, the Client and the Resource Servers need to have already joined the same OSCORE group, for instance by using the approach defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>, which is also based on ACE.<a href="#appendix-A-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A-4">The Client proves its access to be authorized to the Resource Server by using an Access Token, which is bound to a key (the proof-of-possession key). This profile mode uses OSCORE to achieve proof of possession, and OSCORE or Group OSCORE to achieve server authentication.<a href="#appendix-A-4" class="pilcrow">Â¶</a></p>
<p id="appendix-A-5">Unlike in the main mode of this profile, where a public key is used as pop-key, this dual mode uses OSCORE-related, symmetric keying material as pop-key instead. Furthermore, this dual mode provides proof of Client's membership to the correct OSCORE group, by securely binding the pre-established Group OSCORE Security Context to the pairwise OSCORE Security Context newly established between the Client and the Resource Server.<a href="#appendix-A-5" class="pilcrow">Â¶</a></p>
<p id="appendix-A-6">In addition to the terminology used for the main mode of this profile, the rest of this appendix refers also to "pairwise OSCORE Security Context" as to an OSCORE Security Context established between only one Client and one Resource Server, and used to communicate with OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#appendix-A-6" class="pilcrow">Â¶</a></p>
<div id="sec-protocol-overview-appendix">
<section id="appendix-A.1">
        <h3 id="name-protocol-overview-3">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-protocol-overview-3" class="section-name selfRef">Protocol Overview</a>
        </h3>
<p id="appendix-A.1-1">This section provides an overview on how to use the ACE framework for authentication and authorization <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> to secure communications between a Client and a (set of) Resource Server(s) using OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and/or Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#appendix-A.1-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1-2">Just as for main mode of this profile overviewed in <a href="#sec-protocol-overview" class="xref">Section 2</a>, the process for joining the OSCORE group through the respective Group Manager as defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> must take place before the process described in the rest of this section, and is out of the scope of this profile.<a href="#appendix-A.1-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1-3">An overview of the protocol flow for the dual mode of this profile is shown in <a href="#fig-protocol-overview-appendix" class="xref">Figure 8</a>. In the figure, it is assumed that both RS1 and RS2 are associated with the same AS. It is also assumed that C, RS1 and RS2 have previously joined an OSCORE group with Group Identifier (gid) "abcd0000", and got assigned Sender ID (sid) "0", "1" and "2" in the group, respectively. The names of messages coincide with those of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> when applicable.<a href="#appendix-A.1-3" class="pilcrow">Â¶</a></p>
<span id="name-protocol-overview-4"></span><div id="fig-protocol-overview-appendix">
<figure id="figure-8">
          <div class="alignCenter art-text artwork" id="appendix-A.1-4.1">
<pre>
C                           RS1          RS2                         AS
| [--- Resource Request --&gt;] |            |                           |
|                            |            |                           |
| [&lt;----  AS Request ------] |            |                           |
|       Creation Hints       |            |                           |
|                            |            |                           |
|-------- POST /token -----------------------------------------------&gt;|
| (aud: RS1, sid: 0, gid: abcd0000, ...)  |                           |
|                            |            |                           |
|&lt;-------------------------------- Access Token + RS Information -----|
|                            | (aud: RS1, sid: 0, gid: abcd0000, ...) |
|                            |            |                           |
|---- POST /authz-info -----&gt;|            |                           |
|  (access_token, N1, ID1)   |            |                           |
|                            |            |                           |
|&lt;-- 2.01 Created (N2, ID2) -|            |                           |
|                            |            |                           |
/Pairwise            /Pairwise            |                           |
 Security Context     Security Context    |                           |
 Derivation/          Derivation/         |                           |
|                            |            |                           |
|-------- POST /token -----------------------------------------------&gt;|
| (aud: RS2, sid: 0, gid: abcd0000, ...)  |                           |
|                            |            |                           |
|&lt;-------------------------------- Access Token + RS Information -----|
|                            | (aud: RS2, sid: 0, gid: abcd0000, ...) |
|                            |            |                           |
|---- POST /authz-info ------------------&gt;|                           |
|  (access_token, N1', ID1') |            |                           |
|                            |            |                           |
|&lt;-- 2.01 Created (N2', ID2')-------------|                           |
|                            |            |                           |
/Pairwise Security           |   /Pairwise Security                   |
 Context Derivation/         |    Context Derivation/                 |
|                            |            |                           |
|----- OSCORE Request ------&gt;|            |                           |
|        (kid: ID2)          |            |                           |
|                            |            |                           |
|                            |            |                           |
|                            |            |                           |
|                            |            |                           |
|                /Proof-of-possession;    |                           |
|                 Pairwise Security       |                           |
|                 Context storage/        |                           |
|                            |            |                           |
|&lt;---- OSCORE Response ------|            |                           |
|                            |            |                           |
/Proof-of-possession;        |            |                           |
 Pairwise Security           |            |                           |
 Context storage/            |            |                           |
|                            |            |                           |
/Mutual authentication       |            |                           |
 between C and RS1           |            |                           |
 (as OSCORE peers)/          |            |                           |
|                            |            |                           |
|                            |            |                           |
|- Group OSCORE Request -+--&gt;|            |                           |
| (kid: 0, gid: abcd0000) \--------------&gt;|                           |
|                            |            |                           |
|&lt;-- Group OSCORE Response --|            |                           |
|         (kid: 1)           |            |                           |
|                            |            |                           |
/Mutual authentication       |            |                           |
 between C and RS1           |            |                           |
 (as group members)/         |            |                           |
|                            |            |                           |
|&lt;-- Group OSCORE Response ---------------|                           |
|         (kid: 2)           |            |                           |
|                            |            |                           |
/Mutual authentication       |            |                           |
 between C and RS2           |            |                           |
 (as group members)/         |            |                           |
|                            |            |                           |
|            ...             |            |                           |
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-protocol-overview-4" class="selfRef">Protocol Overview.</a>
          </figcaption></figure>
</div>
<div id="sec-protocol-overview-pre-conditions-appendix">
<section id="appendix-A.1.1">
          <h4 id="name-pre-conditions-2">
<a href="#appendix-A.1.1" class="section-number selfRef">A.1.1. </a><a href="#name-pre-conditions-2" class="section-name selfRef">Pre-Conditions</a>
          </h4>
<p id="appendix-A.1.1-1">The same pre-conditions for the main mode of this profile (see <a href="#sec-protocol-overview-pre-conditions" class="xref">Section 2.1</a>) hold for the dual mode described in this appendix.<a href="#appendix-A.1.1-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-overview-token-posting-appendix">
<section id="appendix-A.1.2">
          <h4 id="name-access-token-posting-2">
<a href="#appendix-A.1.2" class="section-number selfRef">A.1.2. </a><a href="#name-access-token-posting-2" class="section-name selfRef">Access Token Posting</a>
          </h4>
<p id="appendix-A.1.2-1">After having retrieved the Access Token from the AS, the Client generates a nonce N1 and an identifier ID1 unique in the sets of its own Recipient IDs from its pairwise OSCORE Security Contexts. The client then posts both the Access Token, N1 and its chosen ID to the RS, using the /authz-info endpoint and mechanisms specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.10" class="relref">Section 5.10</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and Content-Format = application/ace+cbor.<a href="#appendix-A.1.2-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.2-2">When using the dual mode of this profile, the communication with the authz-info endpoint is not protected, except for update of access rights. Note that, when using the dual mode, this request can alternatively be protected with Group OSCORE, using the Group OSCORE Security Context paired with the pairwise OSCORE Security Context originally established with the first Access Token posting.<a href="#appendix-A.1.2-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.2-3">If the Access Token is valid, the RS replies to this POST request with a 2.01 (Created) response with Content-Format = application/ace+cbor, which in a CBOR map contains a nonce N2 and an identifier ID2 unique in the sets of its own Recipient IDs from its pairwise OSCORE Security Contexts.<a href="#appendix-A.1.2-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-oscore-setup-appendix">
<section id="appendix-A.1.3">
          <h4 id="name-setup-of-the-pairwise-oscor">
<a href="#appendix-A.1.3" class="section-number selfRef">A.1.3. </a><a href="#name-setup-of-the-pairwise-oscor" class="section-name selfRef">Setup of the Pairwise OSCORE Security Context</a>
          </h4>
<p id="appendix-A.1.3-1">After sending the 2.01 (Created) response, the RS sets the ID Context of the pairwise OSCORE Security Context (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3" class="relref">Section 3</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>) to the Group Identifier of the OSCORE group specified in the Access Token, concatenated with N1, concatenated with N2, concatenated with the value in the contextId parameter of the OSCORE_Input_Material provided in the 'cnf' claim of the Access Token.<a href="#appendix-A.1.3-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.3-2">Then, the RS derives the complete pairwise OSCORE Security Context associated with the received Access Token, following <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>. In practice, the RS maintains a collection of Security Contexts with associated authorization information, for all the clients that it is currently communicating with, and the authorization information is a policy used as input when processing requests from those clients.<a href="#appendix-A.1.3-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.3-3">During the derivation process, the RS uses: the ID Context above; the exchanged nonces N1 and N2; the identifier ID1 received from the Client, set as its own OSCORE Sender ID; the identifier ID2 provided to the Client, set as its Recipient ID for the Client; and the parameters in the Access Token. The derivation process uses also the Master Secret of the OSCORE group, that the RS knows as a group member, as well as the Sender ID of the Client in the OSCORE group, which is specified in the Access Token. This ensures that the pairwise OSCORE Security Context is securely bound to the Group OSCORE Security Context of the OSCORE group.<a href="#appendix-A.1.3-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.3-4">Finally, the RS stores the association between i) the authorization information from the Access Token; and ii) the Group Identifier of the OSCORE group together with the Sender ID and the authentication credential of the Client in that group.<a href="#appendix-A.1.3-4" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.3-5">After having received the nonce N2, the Client sets the ID Context in its pairwise OSCORE Security Context (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3" class="relref">Section 3</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>) to the Group Identifier of the OSCORE group, concatenated with N1, concatenated with N2, concatenated with the value in the contextId parameter of the OSCORE_Input_Material provided in the 'cnf' parameter of the Access Token response from the AS. Then, the Client derives the complete pairwise OSCORE Security Context, following <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#appendix-A.1.3-5" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.3-6">During the derivation process, the Client uses: the ID Context above, the exchanged nonces N1 and N2; the identifier ID1 provided to the RS, set as its own Recipient ID for the RS; the identifier ID2 received from the RS, set as its own OSCORE Sender ID; and the parameters received from the AS. The derivation process uses also the Master Secret of the OSCORE group, that the Client knows as a group member, as well as its own Sender ID in the OSCORE group.<a href="#appendix-A.1.3-6" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.3-7">When the Client communicates with the RS using the pairwise OSCORE Security Context, the RS achieves proof-of-possession of the credentials bound to the Access Token. Also, the RS verifies that the Client is a legitimate member of the OSCORE group.<a href="#appendix-A.1.3-7" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-protocol-overview-communication-appendix">
<section id="appendix-A.1.4">
          <h4 id="name-secure-communication-2">
<a href="#appendix-A.1.4" class="section-number selfRef">A.1.4. </a><a href="#name-secure-communication-2" class="section-name selfRef">Secure Communication</a>
          </h4>
<p id="appendix-A.1.4-1">Other than starting the communication with the RS using Group OSCORE as described in <a href="#sec-client-rs-secure-communication" class="xref">Section 4.3</a>, the Client can send to the RS a request protected with OSCORE, using the pairwise OSCORE Security Context.<a href="#appendix-A.1.4-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.4-2">If the request is successfully verified, then the RS stores the pairwise OSCORE Security Context, and uses it to protect the possible response, as well as further communications with the Client, until the Access Token is deleted, due to, for example, expiration. This pairwise OSCORE Security Context is discarded when an Access Token (whether the same or different) is used to successfully derive a new pairwise OSCORE Security Context.<a href="#appendix-A.1.4-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.4-3">As discussed in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-7" class="relref">Section 7</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>, the use of random nonces N1 and N2 during the exchange between the Client and the RS prevents the reuse of an Authenticated Encryption with Associated Data (AEAD) nonce/key pair for two different messages. Reuse might otherwise occur when Client and RS derive a new pairwise OSCORE Security Context from an existing (non-expired) Access Token, e.g., in case of reboot of either the Client or the RS, and might lead to loss of both confidentiality and integrity.<a href="#appendix-A.1.4-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A.1.4-4">Additionally, just as per the main mode of this profile (see <a href="#sec-client-rs-secure-communication" class="xref">Section 4.3</a>), the Client and RS can also securely communicate by protecting messages with Group OSCORE, using the Group OSCORE Security Context already established upon joining the OSCORE group.<a href="#appendix-A.1.4-4" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-c-as-comm-appendix">
<section id="appendix-A.2">
        <h3 id="name-client-as-communication-2">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-client-as-communication-2" class="section-name selfRef">Client-AS Communication</a>
        </h3>
<p id="appendix-A.2-1">This section details the Access Token POST Request that the Client sends to the /token endpoint of the AS, as well as the related Access Token response.<a href="#appendix-A.2-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2-2"><span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span> defines how to derive a pairwise OSCORE Security Context based on a shared Master Secret and a set of other parameters, established between the OSCORE client and server, which the client receives from the AS in this exchange.<a href="#appendix-A.2-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2-3">The proof-of-possession key (pop-key) received from the AS in this exchange MUST be used to build the Master Secret in OSCORE (see <a href="#sec-c-rs-setup-client-appendix" class="xref">Appendix A.3.3</a> and <a href="#sec-c-rs-setup-server-appendix" class="xref">Appendix A.3.4</a>).<a href="#appendix-A.2-3" class="pilcrow">Â¶</a></p>
<div id="sec-c-as-token-endpoint-appendix">
<section id="appendix-A.2.1">
          <h4 id="name-c-to-as-post-to-token-endpoi">
<a href="#appendix-A.2.1" class="section-number selfRef">A.2.1. </a><a href="#name-c-to-as-post-to-token-endpoi" class="section-name selfRef">C-to-AS: POST to Token Endpoint</a>
          </h4>
<p id="appendix-A.2.1-1">The Client-to-AS request is specified in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.1" class="relref">Section 5.8.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. The Client MUST send this POST request to the /token endpoint over a secure channel that guarantees authentication, message integrity and confidentiality.<a href="#appendix-A.2.1-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.1-2">The POST request is formatted as the analogous Client-to-AS request in the main mode of this profile (see <a href="#sec-c-as-token-endpoint" class="xref">Section 3.1</a>), with the following modifications.<a href="#appendix-A.2.1-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.1-3.1">The parameter 'req_cnf' MUST NOT be included in the payload.<a href="#appendix-A.2.1-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-3.2">The parameter 'client_cred', defined in <a href="#client_cred-appendix" class="xref">Appendix A.2.1.1</a> of this document, MUST be included in the payload. This parameter specifies the public key that the Client uses in the OSCORE group, whose identifier is indicated in the 'context_id' parameter. In particular, the specified public key is the COSE Key equivalent to the authentication credential that the Client uses in the OSCORE group.<a href="#appendix-A.2.1-3.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.2.1-3.3">The proof-of-possession (PoP) evidence included in the 'client_cred_verify' or 'client_cred_verify_mac' parameter is computed by using the Client's private key associated with the public key in the 'client_cred' parameter above.<a href="#appendix-A.2.1-3.3" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="appendix-A.2.1-4">An example of such a request is shown in <a href="#fig-example-C-to-AS-symm-appendix" class="xref">Figure 9</a>.<a href="#appendix-A.2.1-4" class="pilcrow">Â¶</a></p>
<span id="name-example-c-to-as-post-token-r"></span><div id="fig-example-C-to-AS-symm-appendix">
<figure id="figure-9">
            <div class="alignLeft art-text artwork" id="appendix-A.2.1-5.1">
<pre>
     Header: POST (Code=0.02)
     Uri-Host: "as.example.com"
     Uri-Path: "token"
     Content-Format: "application/ace+cbor"
     Payload:
     {
       "audience" : "tempSensor4711",
       "scope" : "read",
       "context_id" : h'abcd0000',
       "salt_input" : h'00',
       "client_cred" : {
         "COSE_Key" : {
           "kty" : EC2,
           "crv" : P-256,
           "x" : h'd7cc072de2205bdc1537a543d53c60a6acb62eccd890c7fa
                   27c9e354089bbe13',
           "y" : h'f95e1d4b851a2cc80fff87d8e23f22afb725d535e515d020
                   731e79a3b4e47120'
         }
       },
       "client_cred_verify" : h'...'
       (signature content omitted for brevity),
     }
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-example-c-to-as-post-token-r" class="selfRef">Example C-to-AS POST /token request for an Access Token bound to a symmetric key.</a>
            </figcaption></figure>
</div>
<p id="appendix-A.2.1-6">Later on, the Client may want to update its current access rights, without changing the existing pairwise OSCORE Security Context with the RS. In this case, the Client MUST include in its POST request to the /token endpoint a 'req_cnf' parameter, defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-params-16#section-3.1" class="relref">Section 3.1</a> of [<a href="#I-D.ietf-ace-oauth-params" class="xref">I-D.ietf-ace-oauth-params</a>]</span>, which MUST include a 'kid' field, as defined in <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="xref">RFC8747</a>]</span>. The 'kid' field has as value a CBOR byte string containing the OSCORE_Input_Material Identifier (assigned as discussed in <a href="#sec-as-c-token-appendix" class="xref">Appendix A.2.2</a>).<a href="#appendix-A.2.1-6" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.1-7">This identifier, together with other information such as audience, can be used by the AS to determine the shared secret bound to the proof-of-possession Access Token and therefore MUST identify a symmetric key that was previously generated by the AS as a shared secret for the communication between the Client and the RS. The AS MUST verify that the received value identifies a proof-of-possession key that has previously been issued to the requesting Client. If that is not the case, the Client-to-AS request MUST be declined with the error code "invalid_request" as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#appendix-A.2.1-7" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.1-8">This POST request for updating the access rights of an Access Token SHOULD NOT include the parameters 'salt_input', 'context_id', 'client_cred' and 'client_cred_verify'. An exception is the case defined in <a href="#sec-client-public-key-change-dual-mode" class="xref">Appendix A.3.6</a>, where the Client, following a change of authentication credential in the OSCORE group, requests a new Access Token associated with the public key of the new authentication credential, while still without changing the existing pairwise OSCORE Security Context with the RS.<a href="#appendix-A.2.1-8" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.1-9">An example of such a request is shown in <a href="#fig-example-C-to-AS-symm-kid-appendix" class="xref">Figure 10</a>.<a href="#appendix-A.2.1-9" class="pilcrow">Â¶</a></p>
<span id="name-example-c-to-as-post-token-re"></span><div id="fig-example-C-to-AS-symm-kid-appendix">
<figure id="figure-10">
            <div class="alignLeft art-text artwork" id="appendix-A.2.1-10.1">
<pre>
     Header: POST (Code=0.02)
     Uri-Host: "as.example.com"
     Uri-Path: "token"
     Content-Format: "application/ace+cbor"
     Payload:
     {
       "audience" : "tempSensor4711",
       "scope" : "read",
       "req_cnf" : {
         "kid" : h'01'
       }
     }
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-example-c-to-as-post-token-re" class="selfRef">Example C-to-AS POST /token request for updating rights to an Access Token bound to a symmetric key.</a>
            </figcaption></figure>
</div>
<div id="client_cred-appendix">
<section id="appendix-A.2.1.1">
            <h5 id="name-client_cred-parameter">
<a href="#appendix-A.2.1.1" class="section-number selfRef">A.2.1.1. </a><a href="#name-client_cred-parameter" class="section-name selfRef">'client_cred' Parameter</a>
            </h5>
<p id="appendix-A.2.1.1-1">The 'client_cred' parameter is an OPTIONAL parameter of the Access Token request message defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.1." class="relref">Section 5.8.1.</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. This parameter provides an asymmetric key that the Client wishes to use as its own public key, but which is not used as proof-of-possession key.<a href="#appendix-A.2.1.1-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.1.1-2">This parameter follows the syntax of the 'cnf' claim from <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="xref">RFC8747</a>]</span> when including Value Type "COSE_Key" (1) and specifying an asymmetric key. Alternative Value Types defined in future specifications are fine to consider if indicating a non-encrypted asymmetric key.<a href="#appendix-A.2.1.1-2" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-as-c-token-appendix">
<section id="appendix-A.2.2">
          <h4 id="name-as-to-c-access-token-2">
<a href="#appendix-A.2.2" class="section-number selfRef">A.2.2. </a><a href="#name-as-to-c-access-token-2" class="section-name selfRef">AS-to-C: Access Token</a>
          </h4>
<p id="appendix-A.2.2-1">After having verified the POST request to the /token endpoint and that the Client is authorized to obtain an Access Token corresponding to its Access Token request, the AS MUST verify the proof-of-possession (PoP) evidence.<a href="#appendix-A.2.2-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-2">In particular, the AS proceeds as defined in <a href="#sec-as-c-token" class="xref">Section 3.2</a>, with the difference that it uses the public key specified in the 'client_cred' parameter as public key of the Client.<a href="#appendix-A.2.2-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-3">If both the 'client_cred_verify' and 'client_cred_verify_mac' parameters are present, or if the verification of the PoP evidence fails, the AS considers the Client request invalid. The AS does not perform this operation when asked to update a previously released Access Token.<a href="#appendix-A.2.2-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-4">If all verifications are successful, the AS responds as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.2" class="relref">Section 5.8.2</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. If the Client request was invalid, or not authorized, the AS returns an error response as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-5.8.3" class="relref">Section 5.8.3</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#appendix-A.2.2-4" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-5">The AS can signal that the use of OSCORE and Group OSCORE is REQUIRED for a specific Access Token by including the "ace_profile" parameter with the value "coap_group_oscore" in the Access Token response. This means that the Client MUST use OSCORE and/or Group OSCORE towards all the Resource Servers for which this Access Token is valid.<a href="#appendix-A.2.2-5" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-6">In particular, the Client MUST follow <a href="#sec-c-rs-setup-client-appendix" class="xref">Appendix A.3.3</a> to derive the pairwise OSCORE Security Context to use for communications with the RS. Instead, the Client has already established the related Group OSCORE Security Context to communicate with members of the OSCORE group, upon previously joining that group.<a href="#appendix-A.2.2-6" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-7">Usually, it is assumed that constrained devices will be pre-configured with the necessary profile, so that this kind of profile signaling can be omitted.<a href="#appendix-A.2.2-7" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-8">In contrast with the main mode of this profile, the Access Token response to the Client is analogous to the one in the OSCORE profile of ACE, as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>. In particular, the AS provides an OSCORE_Input_Material object, which is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span> and included in the 'cnf' parameter (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-params-16#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-ace-oauth-params" class="xref">I-D.ietf-ace-oauth-params</a>]</span>) of the Access Token response.<a href="#appendix-A.2.2-8" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-9">The AS MUST send different OSCORE_Input_Material (and therefore different Access Tokens) to different authorized clients, in order for the RS to differentiate between clients.<a href="#appendix-A.2.2-9" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-10">In the issued Access Token, the AS MUST include as metadata the same information as defined in the main mode of this profile (see <a href="#sec-as-c-token" class="xref">Section 3.2</a>) with the following modifications.<a href="#appendix-A.2.2-10" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.2-11.1">
              <p id="appendix-A.2.2-11.1.1">The public key that the client uses in the OSCORE group and specified in the 'client_cred' parameter of the Token request (see <a href="#sec-c-as-token-endpoint-appendix" class="xref">Appendix A.2.1</a>) MUST also be included in the Access Token.<a href="#appendix-A.2.2-11.1.1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-11.1.2">
If the Access Token is a CWT, the AS MUST include it in the 'client_cred' claim of the Access Token, defined in <a href="#client_cred_claim-appendix" class="xref">Appendix A.2.2.2</a> of this document. In particular, the 'client_cred' claim includes the same COSE Key specified in the 'client_cred' parameter of the Token Request, i.e., the COSE Key equivalent to the authentication credential that the Client uses in the OSCORE group.<a href="#appendix-A.2.2-11.1.2" class="pilcrow">Â¶</a></p>
</li>
            <li class="normal" id="appendix-A.2.2-11.2">The OSCORE_Input_Material specified in the 'cnf' parameter of the Access Token response MUST also be included in the Access Token. If the Access Token is a CWT, the same OSCORE_Input_Material included in the 'cnf' parameter of the Access Token response MUST be included in the 'osc' field of the 'cnf' claim of the Access Token (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>).<a href="#appendix-A.2.2-11.2" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="appendix-A.2.2-12"><a href="#fig-example-AS-to-C-appendix" class="xref">Figure 11</a> shows an example of such an AS response. The access token has been truncated for readability.<a href="#appendix-A.2.2-12" class="pilcrow">Â¶</a></p>
<span id="name-example-as-to-c-access-token"></span><div id="fig-example-AS-to-C-appendix">
<figure id="figure-11">
            <div class="alignLeft art-text artwork" id="appendix-A.2.2-13.1">
<pre>
     Header: Created (Code=2.01)
     Content-Type: "application/ace+cbor"
     Payload:
     {
       "access_token" : h'8343a1010aa2044c53 ...'
        (remainder of CWT omitted for brevity),
       "ace_profile" : "coap_group_oscore",
       "expires_in" : 3600,
       "cnf" : {
         "osc" : {
           "alg" : AES-CCM-16-64-128,
           "id"  : h'01',
           "ms" : h'f9af838368e353e78888e1426bd94e6f',
           "salt" : h'1122',
           "contextId" : h'99'
         }
       }
     }
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-example-as-to-c-access-token" class="selfRef">Example AS-to-C Access Token response with the Group OSCORE profile.</a>
            </figcaption></figure>
</div>
<p id="appendix-A.2.2-14"><a href="#fig-example-AS-to-C-CWT-appendix" class="xref">Figure 12</a> shows an example CWT, containing the necessary OSCORE parameters in the 'cnf' claim.<a href="#appendix-A.2.2-14" class="pilcrow">Â¶</a></p>
<span id="name-example-cwt-with-oscore-par"></span><div id="fig-example-AS-to-C-CWT-appendix">
<figure id="figure-12">
            <div class="alignLeft art-text artwork" id="appendix-A.2.2-15.1">
<pre>
     {
       "aud" : "tempSensorInLivingRoom",
       "iat" : 1360189224,
       "exp" : 1360289224,
       "scope" :  "temperature_g firmware_p",
       "cnf" : {
         "osc" : {
           "alg" : AES-CCM-16-64-128,
           "id"  : h'01',
           "ms" : h'f9af838368e353e78888e1426bd94e6f',
           "salt" : h'1122',
           "contextId" : h'99'
       },
       "salt_input" : h'00',
       "contextId_input" : h'abcd0000',
       "client_cred" : {
         "COSE_Key" : {
           "kty" : EC2,
           "crv" : P-256,
           "x" : h'd7cc072de2205bdc1537a543d53c60a6acb62eccd890c7fa
                   27c9e354089bbe13',
           "y" : h'f95e1d4b851a2cc80fff87d8e23f22afb725d535e515d020
                   731e79a3b4e47120'
         }
       }
     }
</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-example-cwt-with-oscore-par" class="selfRef">Example CWT with OSCORE parameters.</a>
            </figcaption></figure>
</div>
<p id="appendix-A.2.2-16">The same CWT as in <a href="#fig-example-AS-to-C-CWT-appendix" class="xref">Figure 12</a> and encoded in CBOR is shown in <a href="#fig-example-AS-to-C-CWT-encoding-appendix" class="xref">Figure 13</a>, using the value abbreviations defined in <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span> and <span>[<a href="#RFC8747" class="xref">RFC8747</a>]</span>.<a href="#appendix-A.2.2-16" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-17">NOTE: it should be checked (and in case fixed) that the values used below (which are not yet registered) are the final values registered in IANA.<a href="#appendix-A.2.2-17" class="pilcrow">Â¶</a></p>
<span id="name-example-cwt-with-oscore-para"></span><div id="fig-example-AS-to-C-CWT-encoding-appendix">
<figure id="figure-13">
            <div class="alignLeft art-text artwork" id="appendix-A.2.2-18.1">
<pre>
A8                                      # map(8)
   03                                   # unsigned(3)
   76                                   # text(22)
      74656D7053656E736F72496E4C6976696E67526F6F6D
   06                                   # unsigned(6)
   1A 5112D728                          # unsigned(1360189224)
   04                                   # unsigned(4)
   1A 51145DC8                          # unsigned(1360289224)
   09                                   # unsigned(9)
   78 18                                # text(24)
      74656D70657261747572655F67206669726D776172655F70
   08                                   # unsigned(8)
   A1                                   # map(1)
      04                                # unsigned(4)
      A5                                # map(5)
         04                             # unsigned(4)
         0A                             # unsigned(10)
         00                             # unsigned(0)
         41                             # bytes(1)
            01                          # "\x01"
         02                             # unsigned(2)
         50                             # bytes(16)
            F9AF838368E353E78888E1426BD94E6F
         05                             # unsigned(5)
         42                             # bytes(2)
            1122                        # "\x11\""
         06                             # unsigned(6)
         41                             # bytes(1)
            99                          # "\x99"
   18 3C                                # unsigned(60)
   41                                   # bytes(1)
      00
   18 3D                                # unsigned(61)
   44                                   # bytes(4)
      ABCD0000
   18 3E                                # unsigned(62)
   A1                                   # map(1)
      01                                # unsigned(1)
      A4                                # map(4)
         01                             # unsigned(1)
         02                             # unsigned(2)
         20                             # negative(0)
         01                             # unsigned(1)
         21                             # negative(1)
         58 20                          # bytes(32)
            D7CC072DE2205BDC1537A543D53C60A6ACB62ECCD890C7FA27C9
            E354089BBE13
         22                             # negative(2)
         58 20                          # bytes(32)
            F95E1D4B851A2CC80FFF87D8E23F22AFB725D535E515D020731E
            79A3B4E47120
</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-example-cwt-with-oscore-para" class="selfRef">Example CWT with OSCORE parameters.</a>
            </figcaption></figure>
</div>
<p id="appendix-A.2.2-19">If the Client has requested an update to its access rights using the same pairwise OSCORE Security Context, which is valid and authorized, the AS MUST omit the 'cnf' parameter in the response to the client.<a href="#appendix-A.2.2-19" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-20">Instead, the updated Access Token conveyed in the AS-to-C response MUST include a 'cnf' claim specifying a 'kid' field, as defined in <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="xref">RFC8747</a>]</span>. The response from the AS MUST carry the OSCORE Input Material identifier in the 'kid' field within the 'cnf' claim of the Access Token. That is, the 'kid' field is a CBOR byte string, with value the same value of the 'kid' field of the 'req_cnf' parameter from the C-to-AS request for updating rights to the Access Token (see <a href="#fig-example-C-to-AS-symm-kid-appendix" class="xref">Figure 10</a>). This information needs to be included in the Access Token, in order for the RS to identify the previously generated pairwise OSCORE Security Context.<a href="#appendix-A.2.2-20" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2-21"><a href="#fig-example-AS-to-C-kid-appendix" class="xref">Figure 14</a> shows an example of such an AS response. The Access Token has been truncated for readability.<a href="#appendix-A.2.2-21" class="pilcrow">Â¶</a></p>
<span id="name-example-as-to-c-access-token-"></span><div id="fig-example-AS-to-C-kid-appendix">
<figure id="figure-14">
            <div class="alignLeft art-text artwork" id="appendix-A.2.2-22.1">
<pre>
     Header: Created (Code=2.01)
     Content-Type: "application/ace+cbor"
     Payload:
     {
       "access_token" : h'8343a1010aa2044c53 ...'
        (remainder of CWT omitted for brevity),
       "profile" : "coap_group_oscore",
       "expires_in" : 3600
     }
</pre>
</div>
<figcaption><a href="#figure-14" class="selfRef">Figure 14</a>:
<a href="#name-example-as-to-c-access-token-" class="selfRef">Example AS-to-C Access Token response with the Group OSCORE profile, for update of access rights.</a>
            </figcaption></figure>
</div>
<p id="appendix-A.2.2-23"><a href="#fig-example-AS-to-C-CWT-kid-appendix" class="xref">Figure 15</a> shows an example CWT, containing the necessary OSCORE parameters in the 'cnf' claim for update of access rights.<a href="#appendix-A.2.2-23" class="pilcrow">Â¶</a></p>
<span id="name-example-cwt-with-oscore-param"></span><div id="fig-example-AS-to-C-CWT-kid-appendix">
<figure id="figure-15">
            <div class="alignLeft art-text artwork" id="appendix-A.2.2-24.1">
<pre>
     {
       "aud" : "tempSensorInLivingRoom",
       "iat" : 1360189224,
       "exp" : 1360289224,
       "scope" :  "temperature_h",
       "cnf" : {
         "kid" : h'01'
       }
     }
</pre>
</div>
<figcaption><a href="#figure-15" class="selfRef">Figure 15</a>:
<a href="#name-example-cwt-with-oscore-param" class="selfRef">Example CWT with OSCORE parameters for update of access rights.</a>
            </figcaption></figure>
</div>
<div id="client_cred_hash-appendix">
<section id="appendix-A.2.2.1">
            <h5 id="name-public-key-hash-as-client-c">
<a href="#appendix-A.2.2.1" class="section-number selfRef">A.2.2.1. </a><a href="#name-public-key-hash-as-client-c" class="section-name selfRef">Public Key Hash as Client Credential</a>
            </h5>
<p id="appendix-A.2.2.1-1">As a possible optimization to limit the size of the Access Token, the AS may specify as value of the 'client_cred' claim simply the hash of the Client's public key, i.e., the hash of the COSE Key K equivalent to the authentication credential that the Client uses in the OSCORE group.<a href="#appendix-A.2.2.1-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2.1-2">The specifically used hash-function MUST be collision-resistant on byte-strings, and MUST be selected from the "Named Information Hash Algorithm" Registry defined in <span><a href="https://rfc-editor.org/rfc/rfc6920#section-9.4" class="relref">Section 9.4</a> of [<a href="#RFC6920" class="xref">RFC6920</a>]</span>.<a href="#appendix-A.2.2.1-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2.1-3">In particular, the AS provides the Client with an Access Token as defined in <a href="#sec-as-c-token-appendix" class="xref">Appendix A.2.2</a>, with the following differences.<a href="#appendix-A.2.2.1-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2.1-4">The AS prepares INPUT_HASH as follows, with | denoting byte string concatenation.<a href="#appendix-A.2.2.1-4" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.2.1-5.1">If the equivalent COSE Key K has COSE Key Type OKP, INPUT_HASH = i, where 'i' is the x-parameter of the COSE_Key specified in the 'client_cred' parameter of the Token request, encoded as a CBOR byte string.<a href="#appendix-A.2.2.1-5.1" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="appendix-A.2.2.1-5.2">If the equivalent COSE Key K has COSE Key Type EC2, INPUT_HASH = (i_1 | i_2), where 'i_1' and 'i_2' are the x-parameter and y-parameter of the COSE_Key specified in the 'client_cred' parameter of the Token request, respectively, each encoded as a CBOR byte string.<a href="#appendix-A.2.2.1-5.2" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="appendix-A.2.2.1-5.3">If the equivalent COSE Key K has COSE Key Type RSA, INPUT_HASH = (i_1 | i_2), where 'i_1' and 'i_2' are the n-parameter and e-parameter of the COSE_Key specified in the 'client_cred' parameter of the Token request, respectively, each encoded as a CBOR byte string.<a href="#appendix-A.2.2.1-5.3" class="pilcrow">Â¶</a>
</li>
            </ul>
<p id="appendix-A.2.2.1-6">Then, the AS hashes INPUT_HASH according to the procedure described in <span>[<a href="#RFC6920" class="xref">RFC6920</a>]</span>, with the output OUTPUT_HASH in binary format, as described in <span><a href="https://rfc-editor.org/rfc/rfc6920#section-6" class="relref">Section 6</a> of [<a href="#RFC6920" class="xref">RFC6920</a>]</span>.<a href="#appendix-A.2.2.1-6" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2.1-7">Finally, the AS includes a single entry within the 'client_cred' claim of the Access Token. This entry has label "kid" (3) defined in <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="xref">RFC8747</a>]</span>, and value a CBOR byte string wrapping OUTPUT_HASH.<a href="#appendix-A.2.2.1-7" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2.1-8">Upon receiving the Access Token, the RS processes it according to <a href="#sec-rs-c-created-appendix" class="xref">Appendix A.3.2</a>, with the following differences.<a href="#appendix-A.2.2.1-8" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2.1-9">The RS considers: the content of the 'contextId_input' claim as the GID of the OSCORE group; the content of the 'salt_input' claim as the Sender ID that the Client has in the group; and the content of the 'client_cred' claim as the hash RECEIVED_HASH of a COSE Key equivalent to the authentication credential that the Client uses in the group.<a href="#appendix-A.2.2.1-9" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2.1-10">The RS MUST check whether it already stores an authentication credential associated with the pair (GID, Sender ID) above, such that the recomputed hash NEW_HASH of its equivalent COSE Key matches with RECEIVED_HASH from the 'client_cred' claim.<a href="#appendix-A.2.2.1-10" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2.1-11">If this is not the case, the RS MUST request the Client's authentication credential to the Group Manager of the OSCORE group as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-13#section-10" class="relref">Section 10</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>, specifying the Client's Sender ID in the OSCORE group, i.e., the value of the 'salt_input' claim. Then, the RS performs the following actions.<a href="#appendix-A.2.2.1-11" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.2.2.1-12.1">The RS MUST check whether RECEIVED_HASH matches with the recomputed hash NEW_HASH of a COSE Key equivalent to the Client's authentication credential retrieved from the Group Manager.<a href="#appendix-A.2.2.1-12.1" class="pilcrow">Â¶</a>
</li>
              <li class="normal" id="appendix-A.2.2.1-12.2">The RS MUST check that the Client's Sender ID provided by the Group Manager together with the Client's authentication credential matches the one retrieved from the 'salt_input' claim of the Access Token.<a href="#appendix-A.2.2.1-12.2" class="pilcrow">Â¶</a>
</li>
            </ul>
<p id="appendix-A.2.2.1-13">The RS MUST calculate NEW_HASH using the same method used by the AS described above, and using the same hash function. The hash function to use can be determined from the information conveyed in the 'client_cred' claim, as the procedure described in <span>[<a href="#RFC6920" class="xref">RFC6920</a>]</span> also encodes the used hash function as metadata of the hash value.<a href="#appendix-A.2.2.1-13" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="client_cred_claim-appendix">
<section id="appendix-A.2.2.2">
            <h5 id="name-client-credential-claim">
<a href="#appendix-A.2.2.2" class="section-number selfRef">A.2.2.2. </a><a href="#name-client-credential-claim" class="section-name selfRef">Client Credential Claim</a>
            </h5>
<p id="appendix-A.2.2.2-1">The 'client_cred' claim provides an asymmetric key that the Client owning the Access Token wishes to use as its own public key, but which is not used as proof-of-possession key.<a href="#appendix-A.2.2.2-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.2.2.2-2">This parameter follows the syntax of the 'cnf' claim from <span><a href="https://rfc-editor.org/rfc/rfc8747#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC8747" class="xref">RFC8747</a>]</span> when including Value Type "COSE_Key" (1) and specifying an asymmetric key. Alternative Value Types defined in future specifications are fine to consider, if indicating a non-encrypted asymmetric key or full-fledged autentication credential.<a href="#appendix-A.2.2.2-2" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-c-rs-comm-appendix">
<section id="appendix-A.3">
        <h3 id="name-client-rs-communication-2">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-client-rs-communication-2" class="section-name selfRef">Client-RS Communication</a>
        </h3>
<p id="appendix-A.3-1">This section details the POST request and response to the /authz-info endpoint between the Client and the RS. With respect to the exchanged messages and their content, the Client and the RS perform as defined in the OSCORE profile of ACE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-4" class="relref">Section 4</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>).<a href="#appendix-A.3-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3-2">That is, the Client generates a nonce N1 and posts it to the RS, together with: an identifier ID1 unique in the sets of its own Recipient IDs from its pairwise OSCORE Security Contexts; and the Access Token that includes the material provisioned by the AS.<a href="#appendix-A.3-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3-3">Then, the RS generates a nonce N2, and an identifier ID2 unique in the sets of its own Recipient IDs from its pairwise OSCORE Security Contexts. After that, the RS derives a pairwise OSCORE Security Context as described in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>. In particular, it uses the two exchanged nonces and the two identifiers established with the Client, as well as two shared secrets together with additional pieces of information specified in the Access Token.<a href="#appendix-A.3-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3-4">Both the client and the RS generate the pairwise OSCORE Security Context using the pop-key as part of the OSCORE Master Secret. In addition, the derivation of the pairwise OSCORE Security Context takes as input also information related to the OSCORE group, i.e., the Master Secret and Group Identifier of the group, as well as the Sender ID of the Client in the group. Hence, the derived pairwise OSCORE Security Context is also securely bound to the Group OSCORE Security Context of the OSCORE Group. Thus, the proof-of-possession required to bind the Access Token to the Client occurs after the first OSCORE message exchange.<a href="#appendix-A.3-4" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3-5">Therefore, an attacker using a stolen Access Token cannot generate a valid pairwise OSCORE Security Context and thus cannot prove possession of the pop-key. Also, if a Client legitimately owns an Access Token but has not joined the OSCORE group, that Client cannot generate a valid pairwise OSCORE Security Context either, since it lacks the Master Secret used in the OSCORE group.<a href="#appendix-A.3-5" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3-6">Besides, just as in the main mode (see <a href="#sec-c-rs-comm" class="xref">Section 4</a>), the RS is able to verify whether the Client has indeed the claimed Sender ID and authentication credential in the OSCORE group.<a href="#appendix-A.3-6" class="pilcrow">Â¶</a></p>
<div id="sec-c-rs-authz-appendix">
<section id="appendix-A.3.1">
          <h4 id="name-c-to-rs-post-to-authz-info-e">
<a href="#appendix-A.3.1" class="section-number selfRef">A.3.1. </a><a href="#name-c-to-rs-post-to-authz-info-e" class="section-name selfRef">C-to-RS POST to authz-info Endpoint</a>
          </h4>
<p id="appendix-A.3.1-1">The Client MUST generate a nonce N1, an OSCORE Recipient ID (ID1), and post them to the /authz-info endpoint of the RS together with the Access Token, as defined in the OSCORE profile of ACE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-4.1" class="relref">Section 4.1</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>).<a href="#appendix-A.3.1-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.1-2">The same recommendations, considerations and behaviors defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-4.1" class="relref">Section 4.1</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span> hold.<a href="#appendix-A.3.1-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.1-3">If the Client has already posted a valid Access Token, has already established a pairwise OSCORE Security Context with the RS, and wants to update its access rights, the Client can do so by posting the new Access Token (retrieved from the AS and specifying the updated set of access rights) to the /authz-info endpoint.<a href="#appendix-A.3.1-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.1-4">The Client MUST protect the request using either the pairwise OSCORE Security Context established during the first Access Token exchange, or the Group OSCORE Security Context associated with that pairwise OSCORE Security Context.<a href="#appendix-A.3.1-4" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.1-5">In either case, the Client MUST only send the Access Token in the payload, i.e., no nonce or identifier are sent. After proper verification (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-4.2" class="relref">Section 4.2</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>), the new Access Token will supersede the old one at the RS, by replacing the corresponding authorization information. At the same time, the RS will maintain the same pairwise OSCORE Security Context and Group OSCORE Security Context, as now both associated with the new Access Token.<a href="#appendix-A.3.1-5" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-rs-c-created-appendix">
<section id="appendix-A.3.2">
          <h4 id="name-rs-to-c-201-created-2">
<a href="#appendix-A.3.2" class="section-number selfRef">A.3.2. </a><a href="#name-rs-to-c-201-created-2" class="section-name selfRef">RS-to-C: 2.01 (Created)</a>
          </h4>
<p id="appendix-A.3.2-1">The RS MUST verify the validity of the Access Token as defined in <a href="#sec-rs-c-created" class="xref">Section 4.2</a>, with the following modifications.<a href="#appendix-A.3.2-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.3.2-2.1">If the POST request to /authz-info is not protected, the RS checks that the 'cnf' claim is included in the Access Token and that it contains an OSCORE_Input_Material object. Also, the RS checks that the 'salt_input', 'client_cred' and 'contextId_input' claims are included in the Access Token.<a href="#appendix-A.3.2-2.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.2-2.2">If the POST request to /authz-info is protected with the pairwise OSCORE Security Context shared with the Client or with the Group OSCORE Security Context of the OSCORE group, i.e., the Client is requesting an update of access rights, the RS checks that the 'cnf' claim is included in the Access Token and that it contains only the 'kid' field.<a href="#appendix-A.3.2-2.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.2-2.3">If the 'salt_input', 'client_cred' and 'contextId_input' claims are included in the Access Token, the RS extracts the content of 'client_cred'. Then, the RS considers that content as the COSE Key equivalent to the authentication credential that the Client uses in the group, whose GID is specified in the 'contextId_input' claim. The RS can compare this public key with the actual COSE Key equivalent to the authentication credential of the claimed Client, retrieved from its local storage or from the Group Manager (see <a href="#sec-rs-c-created" class="xref">Section 4.2</a>).<a href="#appendix-A.3.2-2.3" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="appendix-A.3.2-3">If any of the checks fails, the RS MUST consider the Access Token non valid, and MUST respond to the Client with an error response code equivalent to the CoAP code 4.00 (Bad Request).<a href="#appendix-A.3.2-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.2-4">If the Access Token is valid and further checks on its content are successful, the RS proceeds as follows.<a href="#appendix-A.3.2-4" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.2-5">In case the POST request to /authz-info was not protected, the RS MUST generate a nonce N2, an OSCORE Recipient ID (ID2), and include them in the 2.01 (Created) response to the Client, as defined in the OSCORE profile of ACE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-4.2" class="relref">Section 4.2</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>).<a href="#appendix-A.3.2-5" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.2-6">Instead, in case the POST request to /authz-info was protected, the RS MUST ignore any nonce and identifiers in the request, if any was sent. Then, the RS MUST check that the 'kid' field of the 'cnf' claim in the new Access Token matches the identifier of the OSCORE Input Material of a pairwise OSCORE Security Context such that:<a href="#appendix-A.3.2-6" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.3.2-7.1">The pairwise OSCORE Security Context was used to protect the request, if this was protected with OSCORE; or<a href="#appendix-A.3.2-7.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.2-7.2">The pairwise OSCORE Security Context is bound to the Group OSCORE Security Context used to protect the request, if this was protected with Group OSCORE.<a href="#appendix-A.3.2-7.2" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="appendix-A.3.2-8">If either verification is successful, the new Access Token supersedes the old one at the RS. Besides, the RS associates the new Access Token to the same pairwise OSCORE Security Context identified above, as also bound to a Group OSCORE Security Context. The RS MUST respond with a 2.01 (Created) response with no payload, protected with the same Security Context used to protect the request.  In particular, no new pairwise OSCORE Security Context is established between the Client and the RS. If any verification fails, the RS MUST respond with a 4.01 (Unauthorized) error response.<a href="#appendix-A.3.2-8" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.2-9">Further recommendations, considerations and behaviors defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-4.2" class="relref">Section 4.2</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span> hold for this document.<a href="#appendix-A.3.2-9" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-c-rs-setup-client-appendix">
<section id="appendix-A.3.3">
          <h4 id="name-oscore-setup-client-side">
<a href="#appendix-A.3.3" class="section-number selfRef">A.3.3. </a><a href="#name-oscore-setup-client-side" class="section-name selfRef">OSCORE Setup - Client Side</a>
          </h4>
<p id="appendix-A.3.3-1">Once having received the 2.01 (Created) response from the RS, following an unprotected POST request to the /authz-info endpoint, the Client MUST extract the nonce N2 from the 'nonce2' parameter, and the Client identifier from the 'ace_server_recipientid' parameter in the CBOR map of the response payload. Note that this identifier is used by C as Sender ID in the pairwise OSCORE Security Context to be established with the RS, and is different as well as unrelated to the Sender ID of C in the OSCORE group.<a href="#appendix-A.3.3-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.3-2">Then, the Client performs the following actions, in order to set up and fully derive the pairwise OSCORE Security Context for communicating with the RS.<a href="#appendix-A.3.3-2" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.3.3-3.1">The Client MUST set the ID Context of the pairwise OSCORE Security Context as the concatenation of: i) GID, i.e., the Group Identifier of the OSCORE group, as specified by the Client in the 'context_id' parameter of the Client-to-AS request; ii) the nonce N1; iii) the nonce N2; and iv) CID, i.e., the value in the contextId parameter of the OSCORE_Input_Material provided in the 'cnf' parameter of the Access Token response from the AS. The concatenation occurs in this order: ID Context = GID | N1 | N2 | CID, where | denotes byte string concatenation.<a href="#appendix-A.3.3-3.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.3-3.2">The Client MUST set the updated Master Salt of the pairwise OSCORE Security Context as the concatenation of SaltInput, MSalt, the nonce N1, the nonce N2 and GMSalt, where: i) SaltInput is the Sender ID that the Client has in the OSCORE group, which is known to the Client as a member of the OSCORE group; ii) MSalt is the (optional) Master Salt in the pairwise OSCORE Security Context (received from the AS in the Token); and iii) GMSalt is the (optional) Master Salt in the Group OSCORE Security Context, which is known to the Client as a member of the OSCORE group. The concatenation occurs in this order: Master Salt = SaltInput | MSalt | N1 | N2 | GMSalt, where | denotes byte string concatenation. Optional values, if not specified, are not included in the concatenation. The five parameters SaltInput, MSalt, N1, N2 and GMSalt are to be concatenated as encoded CBOR byte strings. An example of Master Salt construction using CBOR encoding is given in <a href="#fig-example-master-salt-construction" class="xref">Figure 16</a>.<a href="#appendix-A.3.3-3.2" class="pilcrow">Â¶</a>
</li>
          </ul>
<span id="name-example-of-master-salt-cons"></span><div id="fig-example-master-salt-construction">
<figure id="figure-16">
            <div class="alignLeft art-text artwork" id="appendix-A.3.3-4.1">
<pre>
SaltInput, MSalt, N1, N2 and GMSalt, in CBOR diagnostic notation:
      SaltInput = h'00'
      MSalt = h'f9af838368e353e78888e1426bd94e6f'
      N1 = h'018a278f7faab55a'
      N2 = h'25a8991cd700ac01'
      GMSalt = h'99'

SaltInput, MSalt, N1, N2 and GMSalt, as CBOR encoded byte strings:
      SaltInput = 0x4100
      MSalt = 0x50f9af838368e353e78888e1426bd94e6f
      N1 = 0x48018a278f7faab55a
      N2 = 0x4825a8991cd700ac01
      GMSalt = 0x4199

Master Salt = 0x41 00
                50 f9af838368e353e78888e1426bd94e6f
                48 018a278f7faab55a
                48 25a8991cd700ac01
                41 99
</pre>
</div>
<figcaption><a href="#figure-16" class="selfRef">Figure 16</a>:
<a href="#name-example-of-master-salt-cons" class="selfRef">Example of Master Salt construction using CBOR encoding.</a>
            </figcaption></figure>
</div>
<ul class="normal">
<li class="normal" id="appendix-A.3.3-5.1">The Client MUST set the Master Secret of the pairwise OSCORE Security Context to the concatenation of MSec and GMSec, where: i) MSec is the value of the 'ms' parameter in the OSCORE_Input_Material of the 'cnf' parameter, received from the AS in <a href="#sec-as-c-token-appendix" class="xref">Appendix A.2.2</a>; while ii) GMSec is the Master Secret of the Group OSCORE Security Context, which is known to the Client as a member of the OSCORE group.<a href="#appendix-A.3.3-5.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.3-5.2">The Client MUST set the Recipient ID as ace_client_recipientid, sent as described in <a href="#sec-c-rs-authz-appendix" class="xref">Appendix A.3.1</a>.<a href="#appendix-A.3.3-5.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.3-5.3">The Client MUST set the Sender ID as ace_server_recipientid, received as described in <a href="#sec-c-rs-authz-appendix" class="xref">Appendix A.3.1</a>.<a href="#appendix-A.3.3-5.3" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.3-5.4">The Client MUST set the AEAD Algorithm, ID Context, HKDF, and OSCORE Version as indicated in the corresponding parameters received from the AS in <a href="#sec-as-c-token-appendix" class="xref">Appendix A.2.2</a>, if present in the OSCORE_Input_Material of the 'cnf' parameter. In case these parameters are omitted, the default values SHALL be used as described in Sections <a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">3.2</a> and <a href="https://rfc-editor.org/rfc/rfc8613#section-5.4" class="relref">5.4</a> of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#appendix-A.3.3-5.4" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="appendix-A.3.3-6">Finally, the client MUST derive the complete pairwise OSCORE Security Context following <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#appendix-A.3.3-6" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.3-7">From then on, when communicating with the RS to access the resources as specified by the authorization information, the Client MUST use the newly established pairwise OSCORE Security Context or the Group OSCORE Security Context of the OSCORE Group where both the Client and the RS are members.<a href="#appendix-A.3.3-7" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.3-8">If any of the expected parameters is missing (e.g., any of the mandatory parameters from the AS or the RS), or if ace_client_recipientid equals ace_server_recipientid (and as a consequence the Sender and Recipient Keys derived would be equal, see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>), then the client MUST stop the exchange, and MUST NOT derive the pairwise OSCORE Security Context. The Client MAY restart the exchange, to get the correct security input material.<a href="#appendix-A.3.3-8" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.3-9">The Client can use this pairwise OSCORE Security Context to send requests to the RS protected with OSCORE. Besides, the Client can use the Group OSCORE Security Context for protecting unicast requests to the RS, or multicast requests to the OSCORE group including also the RS. Mutual authentication as group members is only achieved after the client has successfully verified the Group OSCORE protected response from the RS. Similarly, mutual authentication as OSCORE peers is only achieved after the client has successfully verified the OSCORE protected response from the RS, using the pairwise OSCORE Security Context.<a href="#appendix-A.3.3-9" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.3-10">Note that the ID Context of the pairwise OSCORE Security Context can be assigned by the AS, communicated and set in both the RS and Client after the exchange specified in this profile is executed. Subsequently, the Client and RS can update their ID Context by running a mechanism such as the one defined in Appendix B.2 of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> if they both support it and are configured to do so. In that case, the ID Context in the pairwise OSCORE Security Context will not match the "contextId" parameter of the corresponding OSCORE_Input_Material. Running the procedure in Appendix B.2 of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> results in the keying material in the pairwise OSCORE Security Contexts of the Client and RS being updated. The Client can achieve the same result by re-posting the Access Token to the unprotected /authz-info endpoint at the RS, as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-4.1" class="relref">Section 4.1</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>, although without updating the ID Context.<a href="#appendix-A.3.3-10" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-c-rs-setup-server-appendix">
<section id="appendix-A.3.4">
          <h4 id="name-oscore-setup-resource-serve">
<a href="#appendix-A.3.4" class="section-number selfRef">A.3.4. </a><a href="#name-oscore-setup-resource-serve" class="section-name selfRef">OSCORE Setup - Resource Server Side</a>
          </h4>
<p id="appendix-A.3.4-1">After validation of the Access Token as defined in <a href="#sec-rs-c-created-appendix" class="xref">Appendix A.3.2</a> and after sending the 2.01 (Created) response to an unprotected POST request to the /authz-info endpoint, the RS performs the following actions, in order to set up and fully derive the pairwise OSCORE Security Context created to communicate with the Client.<a href="#appendix-A.3.4-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.3.4-2.1">The RS MUST set the ID Context of the pairwise OSCORE Security Context as the concatenation of: i) GID, i.e., the Group Identifier of the OSCORE group, as specified in the 'contextId' parameter of the OSCORE_Input_Material, in the 'cnf' claim of the Access Token received from the Client (see <a href="#sec-c-rs-authz-appendix" class="xref">Appendix A.3.1</a>); ii) the nonce N1; iii) the nonce N2; and iv) CID which is the value in the contextId parameter of the OSCORE_Input_Material provided in the 'cnf' claim of the Access Token. The concatenation occurs in this order: ID Context = GID | N1 | N2 | CID, where | denotes byte string concatenation.<a href="#appendix-A.3.4-2.1" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.4-2.2">The RS MUST set the new Master Salt of the pairwise OSCORE Security Context as the concatenation of SaltInput, MSalt, the nonce N1, the nonce N2 and GMSalt, where: i) SaltInput is the Sender ID that the Client has in the OSCORE group, as specified in the 'salt_input' claim included in the Access Token received from the Client (see <a href="#sec-c-rs-authz-appendix" class="xref">Appendix A.3.1</a>); ii) MSalt is the (optional) Master Salt in the pairwise OSCORE Security Context as specified in the 'salt' parameter in the OSCORE_Input_Material of the 'cnf' claim, included in the Access Token received from the Client; and iii) GMSalt is the (optional) Master Salt in the Group OSCORE Security Context, which is known to the RS as a member of the OSCORE group. The concatenation occurs in this order: Master Salt = SaltInput | MSalt | N1 | N2  | GMSalt, where | denotes byte string concatenation. Optional values, if not specified, are not included in the concatenation. The same considerations for building the Master Salt, considering the inputs as encoded CBOR byte strings as in <a href="#fig-example-master-salt-construction" class="xref">Figure 16</a>, hold also for the RS.<a href="#appendix-A.3.4-2.2" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.4-2.3">The RS MUST set the Master Secret of the pairwise OSCORE Security Context to the concatenation of MSec and GMSec, where: i) MSec is the value of the 'ms' parameter in the OSCORE_Input_Material of the 'cnf' claim, included in the Access Token received from the Client (see <a href="#sec-c-rs-authz-appendix" class="xref">Appendix A.3.1</a>); while ii) GMSec is the Master Secret of the Group OSCORE Security Context, which is known to the RS as a member of the OSCORE group.<a href="#appendix-A.3.4-2.3" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.4-2.4">The RS MUST set the Recipient ID as ace_server_recipientid, sent as described in <a href="#sec-rs-c-created-appendix" class="xref">Appendix A.3.2</a>.<a href="#appendix-A.3.4-2.4" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.4-2.5">The RS MUST set the Sender ID as ace_client_recipientid, received as described in <a href="#sec-rs-c-created-appendix" class="xref">Appendix A.3.2</a>.<a href="#appendix-A.3.4-2.5" class="pilcrow">Â¶</a>
</li>
            <li class="normal" id="appendix-A.3.4-2.6">The RS MUST set the AEAD Algorithm, ID Context, HKDF, and OSCORE Version from the corresponding parameters received from the Client in the Access Token (see <a href="#sec-c-rs-authz-appendix" class="xref">Appendix A.3.1</a>), if present in the OSCORE_Input_Material of the 'cnf' claim. In case these parameters are omitted, the default values SHALL be used as described in Sections <a href="https://rfc-editor.org/rfc/rfc8613#section-3.2" class="relref">3.2</a> and <a href="https://rfc-editor.org/rfc/rfc8613#section-5.4" class="relref">5.4</a> of <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#appendix-A.3.4-2.6" class="pilcrow">Â¶</a>
</li>
          </ul>
<p id="appendix-A.3.4-3">Finally, the RS MUST derive the complete pairwise OSCORE Security Context following <span><a href="https://rfc-editor.org/rfc/rfc8613#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#appendix-A.3.4-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.4-4">Once having completed the derivation above, the RS MUST associate the authorization information from the Access Token with the just established pairwise OSCORE Security Context. Furthermore, as defined in <a href="#sec-rs-c-created" class="xref">Section 4.2</a>, the RS MUST associate the authorization information from the Access Token with the Group OSCORE Security Context.<a href="#appendix-A.3.4-4" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.4-5">Then, the RS uses this pairwise OSCORE Security Context to verify requests from and send responses to the Client protected with OSCORE, when this Security Context is used. If OSCORE verification fails, error responses are used, as specified in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8" class="relref">Section 8</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#appendix-A.3.4-5" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.4-6">Besides, the RS uses the Group OSCORE Security Context to verify (multicast) requests from and send responses to the Client protected with Group OSCORE. When processing an incoming request protected with Group OSCORE, the RS MUST consider as valid authentication credential of the Client only the authentication credential associated with the stored Access Token. As defined in <a href="#sec-client-public-key-change-dual-mode" class="xref">Appendix A.3.6</a>, a change of authentication credential in the group requires the Client to upload to the RS a new Access Token, where the 'client_cred' claim specifies a COSE Key equivalent to the new authentication credential that the Client has in the group.<a href="#appendix-A.3.4-6" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.4-7">If Group OSCORE verification fails, error responses are used, as specified in Sections <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-8" class="relref">8</a> and <a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-14#section-9" class="relref">9</a> of <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. Additionally, for every incoming request, if OSCORE or Group OSCORE verification succeeds, the verification of access rights is performed as described in <a href="#sec-c-rs-access-rights-appendix" class="xref">Appendix A.3.5</a>.<a href="#appendix-A.3.4-7" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.4-8">After the deletion of the Access Token related to a pairwise OSCORE Security Context and to a Group OSCORE Security Context, due to, for example, expiration, the RS MUST NOT use the pairwise OSCORE Security Context. The RS MUST respond with an unprotected 4.01 (Unauthorized) error message to received requests that correspond to a pairwise OSCORE Security Context with a deleted Access Token. Also, if the Client uses the Group OSCORE Security Context to send a request for any resource intended for OSCORE group members and that requires an active Access Token, the RS MUST respond with a 4.01 (Unauthorized) error message protected with the Group OSCORE Security Context.<a href="#appendix-A.3.4-8" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.4-9">The same considerations, related to the value of the ID Context changing, as in <a href="#sec-c-rs-setup-client-appendix" class="xref">Appendix A.3.3</a> hold also for the RS.<a href="#appendix-A.3.4-9" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-c-rs-access-rights-appendix">
<section id="appendix-A.3.5">
          <h4 id="name-access-rights-verification-2">
<a href="#appendix-A.3.5" class="section-number selfRef">A.3.5. </a><a href="#name-access-rights-verification-2" class="section-name selfRef">Access Rights Verification</a>
          </h4>
<p id="appendix-A.3.5-1">The RS MUST follow the procedures defined in <a href="#sec-c-rs-access-rights" class="xref">Section 4.4</a>.<a href="#appendix-A.3.5-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.5-2">Additionally, if the RS receives an OSCORE-protected request from a Client, the RS processes it according to <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#appendix-A.3.5-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.5-3">If the OSCORE verification succeeds, and the target resource requires authorization, the RS retrieves the authorization information from the Access Token associated with the pairwise OSCORE Security Context and to the Group OSCORE Security Context. Then, the RS MUST verify that the action requested on the resource is authorized.<a href="#appendix-A.3.5-3" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.5-4">The response code MUST be 4.01 (Unauthorized) if the RS has no valid Access Token for the Client.<a href="#appendix-A.3.5-4" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-client-public-key-change-dual-mode">
<section id="appendix-A.3.6">
          <h4 id="name-change-of-clients-authentica">
<a href="#appendix-A.3.6" class="section-number selfRef">A.3.6. </a><a href="#name-change-of-clients-authentica" class="section-name selfRef">Change of Client's Authentication Credential in the Group</a>
          </h4>
<p id="appendix-A.3.6-1">During its membership in the OSCORE group, the client might change the authentication credential it uses in the group. When this happens, the Client uploads the new authentication credential to the Group Manager, as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-13#section-11" class="relref">Section 11</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#appendix-A.3.6-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.3.6-2">After that, the Client may still have an Access Token previously uploaded to the RS, which is not expired yet and still valid to the best of the Client's knowledge. Then, in order to continue communicating with the RS, the Client MUST perform the following actions.<a href="#appendix-A.3.6-2" class="pilcrow">Â¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-A.3.6-3">
<li id="appendix-A.3.6-3.1">
              <p id="appendix-A.3.6-3.1.1">The Client requests a new Access Token to the AS, as defined in <a href="#sec-c-as-token-endpoint-appendix" class="xref">Appendix A.2.1</a> for the update of access rights, i.e., with the 'req_cnf' parameter including only a 'kid' field. In particular, when sending the POST request to the AS, the Client indicates:<a href="#appendix-A.3.6-3.1.1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A.3.6-3.1.2.1">The current Group Identifier of the OSCORE group, as value of the 'context_id' parameter.<a href="#appendix-A.3.6-3.1.2.1" class="pilcrow">Â¶</a>
</li>
                <li class="normal" id="appendix-A.3.6-3.1.2.2">The current Sender ID it has in the OSCORE group, as value of the 'salt_input' parameter.<a href="#appendix-A.3.6-3.1.2.2" class="pilcrow">Â¶</a>
</li>
                <li class="normal" id="appendix-A.3.6-3.1.2.3">The public key of the new authentication credential it uses in the OSCORE group, as value of the 'client_cred' parameter. In particular, the specified public key is the COSE Key equivalent to the new authentication credential that the Client uses in the OSCORE group.<a href="#appendix-A.3.6-3.1.2.3" class="pilcrow">Â¶</a>
</li>
                <li class="normal" id="appendix-A.3.6-3.1.2.4">The proof-of-possession (PoP) evidence corresponding to the public key of the new authentication credential, as value of the 'client_cred_verify' or 'client_cred_verify_mac' parameter.<a href="#appendix-A.3.6-3.1.2.4" class="pilcrow">Â¶</a>
</li>
                <li class="normal" id="appendix-A.3.6-3.1.2.5">The same current or instead new set of access rights, as value of the 'scope' parameter.<a href="#appendix-A.3.6-3.1.2.5" class="pilcrow">Â¶</a>
</li>
              </ul>
</li>
            <li id="appendix-A.3.6-3.2">After receiving the response from the AS (see <a href="#sec-as-c-token-appendix" class="xref">Appendix A.2.2</a>), the Client performs the same exchanges with the RS as defined in <a href="#sec-c-rs-comm-appendix" class="xref">Appendix A.3</a>, with the following difference: the POST request to /authz-info for uploading the new Access Token MUST be protected with the pairwise OSCORE Security Context shared with the RS.<a href="#appendix-A.3.6-3.2" class="pilcrow">Â¶</a>
</li>
          </ol>
<p id="appendix-A.3.6-4">When receiving the new Access Token, the RS performs the same steps defined in <a href="#sec-rs-c-created-appendix" class="xref">Appendix A.3.2</a>. In particular, no new pairwise OSCORE Security Context is established between the Client and the RS.<a href="#appendix-A.3.6-4" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-comm-as-appendix">
<section id="appendix-A.4">
        <h3 id="name-secure-communication-with-th">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-secure-communication-with-th" class="section-name selfRef">Secure Communication with the AS</a>
        </h3>
<p id="appendix-A.4-1">The same considerations for secure communication with the AS as defined in <a href="#sec-comm-as" class="xref">Section 5</a> hold.<a href="#appendix-A.4-1" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-discard-context-appendix">
<section id="appendix-A.5">
        <h3 id="name-discarding-the-security-cont">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-discarding-the-security-cont" class="section-name selfRef">Discarding the Security Context</a>
        </h3>
<p id="appendix-A.5-1">The Client and the RS MUST follow what is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-6" class="relref">Section 6</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span> about discarding the pairwise OSCORE Security Context.<a href="#appendix-A.5-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.5-2">Additionally, they MUST follow what is defined in the main mode of the profile (see <a href="#sec-discard-context" class="xref">Section 6</a>), with respect to the Group OSCORE Security Context.<a href="#appendix-A.5-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.5-3">The Client or RS can acquire a new Group OSCORE Security Context, by re-joining the OSCORE group, e.g., by using the approach defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. In such a case, the Client SHOULD request a new Access Token and post it to the RS, in order to establish a new pairwise OSCORE Security Context and bind it to the Group OSCORE Security Context obtained upon re-joining the group.<a href="#appendix-A.5-3" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-cbor-mappings-appendix">
<section id="appendix-A.6">
        <h3 id="name-cbor-mappings-2">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-cbor-mappings-2" class="section-name selfRef">CBOR Mappings</a>
        </h3>
<p id="appendix-A.6-1">The new parameters defined in this document MUST be mapped to CBOR types as specified in <a href="#fig-cbor-mappings-parameters" class="xref">Figure 6</a>, with the following addition, using the given integer abbreviation for the map key.<a href="#appendix-A.6-1" class="pilcrow">Â¶</a></p>
<span id="name-cbor-mappings-for-new-parame"></span><div id="fig-cbor-mappings-parameters-appendix">
<figure id="figure-17">
          <div class="alignCenter art-text artwork" id="appendix-A.6-2.1">
<pre>
/----------------+----------+------------\
| Parameter name | CBOR Key | Value Type |
|----------------+----------+------------|
| client_cred    | TBD      | map        |
\----------------+----------+------------/
</pre>
</div>
<figcaption><a href="#figure-17" class="selfRef">Figure 17</a>:
<a href="#name-cbor-mappings-for-new-parame" class="selfRef">CBOR mappings for new parameters.</a>
          </figcaption></figure>
</div>
<p id="appendix-A.6-3">The new claims defined in this document MUST be mapped to CBOR types as specified in <a href="#fig-cbor-mappings-claims" class="xref">Figure 7</a>, with the following addition, using the given integer abbreviation for the map key.<a href="#appendix-A.6-3" class="pilcrow">Â¶</a></p>
<span id="name-cbor-mappings-for-new-claims"></span><div id="fig-cbor-mappings-claims-appendix">
<figure id="figure-18">
          <div class="alignCenter art-text artwork" id="appendix-A.6-4.1">
<pre>
/--------------+----------+------------\
| Claim name   | CBOR Key | Value Type |
|--------------+----------+------------|
| client_cred  | TBD      | map        |
\--------------+----------+------------/
</pre>
</div>
<figcaption><a href="#figure-18" class="selfRef">Figure 18</a>:
<a href="#name-cbor-mappings-for-new-claims" class="selfRef">CBOR mappings for new claims.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sec-security-considerations-appendix">
<section id="appendix-A.7">
        <h3 id="name-security-considerations-5">
<a href="#appendix-A.7" class="section-number selfRef">A.7. </a><a href="#name-security-considerations-5" class="section-name selfRef">Security Considerations</a>
        </h3>
<p id="appendix-A.7-1">The dual mode of this profile inherits the security considerations from the main mode (see <a href="#sec-security-considerations" class="xref">Section 8</a>), as well as from the security considerations of the OSCORE profile of ACE <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>. Also, the security considerations about OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> hold for the dual mode of this profile, as to the specific use of OSCORE.<a href="#appendix-A.7-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.7-2">Unlike the main mode and consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oauth-authz-46#section-6.1" class="relref">Section 6.1</a> of [<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>, the dual mode of this profile cannot be used to issue an Access Token for an audience that comprises multiple RSs. This is because the proof-of-possession key bound to an Access Token is the OSCORE Master Secret included in the OSCORE_Input_Material object of the 'cnf' claim, and it has to be shared only between the Client and one RS.<a href="#appendix-A.7-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="sec-privacy-considerations-appendix">
<section id="appendix-A.8">
        <h3 id="name-privacy-considerations-2">
<a href="#appendix-A.8" class="section-number selfRef">A.8. </a><a href="#name-privacy-considerations-2" class="section-name selfRef">Privacy Considerations</a>
        </h3>
<p id="appendix-A.8-1">The same privacy considerations as defined in the main mode of this profile apply (see <a href="#sec-privacy-considerations" class="xref">Section 9</a>).<a href="#appendix-A.8-1" class="pilcrow">Â¶</a></p>
<p id="appendix-A.8-2">In addition, as this profile mode also uses OSCORE, the privacy considerations from <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> apply as well, as to the specific use of OSCORE.<a href="#appendix-A.8-2" class="pilcrow">Â¶</a></p>
<p id="appendix-A.8-3">Furthermore, this profile mode inherits the privacy considerations from the OSCORE profile of ACE <span>[<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>.<a href="#appendix-A.8-3" class="pilcrow">Â¶</a></p>
</section>
</div>
</section>
</div>
<div id="profile-requirements">
<section id="appendix-B">
      <h2 id="name-profile-requirements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-profile-requirements" class="section-name selfRef">Profile Requirements</a>
      </h2>
<p id="appendix-B-1">This appendix lists the specifications on this profile based on the    requirements of the ACE framework, as requested in Appendix C of <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>.<a href="#appendix-B-1" class="pilcrow">Â¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-B-2.1">(Optional) discovery process of how the Client finds the right AS for an RS it wants to send a request to: Not specified.<a href="#appendix-B-2.1" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.2">Communication protocol the Client and the RS must use: CoAP.<a href="#appendix-B-2.2" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.3">Security protocol(s) the Client and RS must use: Group OSCORE, i.e., exchange of secure messages by using a pre-established Group OSCORE Security Context. The optional dual mode defined in <a href="#full-version" class="xref">Appendix A</a> additionally uses OSCORE, i.e., establishment of a pairwise OSCORE Security Context and exchange of secure messages.<a href="#appendix-B-2.3" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.4">How the Client and the RS mutually authenticate: Explicitly, by possession of a common Group OSCORE Security Context, and by either: usage of digital signatures embedded in messages, if protected with the group mode of Group OSCORE; or protection of messages with the pairwise mode of Group OSCORE, by using pairwise symmetric keys, derived from the asymmetric keys of the two peers exchanging the message. Note that the mutual authentication is not completed before the Client has verified an OSCORE or a Group OSCORE response using the corresponding security context.<a href="#appendix-B-2.4" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.5">Content-format of the protocol messages: "application/ace+cbor".<a href="#appendix-B-2.5" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.6">Proof-of-Possession protocol(s) and how to select one; which key types (e.g., symmetric/asymmetric) supported: Group OSCORE algorithms; distributed and verified asymmetric keys. In the optional dual mode defined in <a href="#full-version" class="xref">Appendix A</a>: OSCORE algorithms; pre-established symmetric keys.<a href="#appendix-B-2.6" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.7">profile identifier: coap_group_oscore<a href="#appendix-B-2.7" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.8">(Optional) how the RS talks to the AS for introspection: HTTP/CoAP (+ TLS/DTLS/OSCORE).<a href="#appendix-B-2.8" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.9">How the client talks to the AS for requesting a token: HTTP/CoAP (+ TLS/DTLS/OSCORE).<a href="#appendix-B-2.9" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.10">How/if the authz-info endpoint is protected: Not protected.<a href="#appendix-B-2.10" class="pilcrow">Â¶</a>
</li>
        <li class="normal" id="appendix-B-2.11">(Optional) other methods of token transport than the authz-info endpoint: Not specified.<a href="#appendix-B-2.11" class="pilcrow">Â¶</a>
</li>
      </ul>
</section>
</div>
<div id="acknowldegment">
<section id="appendix-C">
      <h2 id="name-acknowledgments-2">
<a href="#name-acknowledgments-2" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-C-1">The authors sincerely thank Benjamin Kaduk, John Mattsson, Dave Robin, Jim Schaad and Goeran Selander for their comments and feedback.<a href="#appendix-C-1" class="pilcrow">Â¶</a></p>
<p id="appendix-C-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-C-2" class="pilcrow">Â¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-D">
      <h2 id="name-authors-addresses-4">
<a href="#name-authors-addresses-4" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard HÃ¶glund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ludwig Seitz</span></div>
<div dir="auto" class="left"><span class="org">Combitech</span></div>
<div dir="auto" class="left"><span class="street-address">DjÃ¤knegatan 31</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">21135 MalmÃ¶</span> <span class="locality">MalmÃ¶</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ludwig.seitz@combitech.com" class="email">ludwig.seitz@combitech.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
