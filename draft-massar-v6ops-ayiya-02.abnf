message   = epochtime LF title LF [URL] LF [text]

epochtime = *DIGIT

title     = *( %x2D | %x2E | %x30-39 | %x41-5A | %x61-7A )

URL       = [ "http://" | "https://" ] *(%x23 | %x25 | %x26 |
               %x2B | %x2E-3A | %x3F-5A | %x61-7A)

text      = *( LF | %x20-7E )

description = *[ LF | %x20-7E ]


endpoint = (IPv4address | IPv6address) [ SP (tcp-port | udp-port) ]

tcp-port = port

udp-port = port

port     = *DIGIT

response       = ayiya-version " " client-version " " os-version

ayiya-version  = "AYIYA/draft-02"

client-version = version

os-version     = version

version        = name [ "/" release ]

name           = chars

release        = chars

chars          = *( %x2D | %x2E | %x30-39 | %x41-5A | %x61-7A )

i = (curr_time + (CLOCK_OFF*2)) -
             (epochtime + (CLOCK_OFF*2));
