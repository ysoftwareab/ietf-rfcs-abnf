<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Design Discussion of Route Leaks Solution Methods</title>
<meta content="Kotikalapudi Sriram" name="author">
<meta content="
       
This document captures the design rationale of the route leaks solution document (see draft-ietf-idr-route-leak-detection-mitigation, draft-ietf-grow-route-leak-detection-mitigation).  The designers needed to balance many competing factors, and this document provides insights into the design questions and their resolution.
       
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="BGP, BGPsec, Route Leak, Route-Leak Mitigation, BGP Security" name="keyword">
<meta content="draft-sriram-idr-route-leak-solution-discussion-07" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-sriram-idr-route-leak-solution-discussion-07-yutf1kdd.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Route Leak Solution Discussion</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Sriram</td>
<td class="center">Expires 8 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">IDR Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-sriram-idr-route-leak-solution-discussion-07</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03-07" class="published">7 March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-08">8 September 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">K. Sriram, <span class="editor">Ed.</span>
</div>
<div class="org">USA NIST</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Design Discussion of Route Leaks Solution Methods</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
This document captures the design rationale of the route leaks solution document (see draft-ietf-idr-route-leak-detection-mitigation, draft-ietf-grow-route-leak-detection-mitigation).  The designers needed to balance many competing factors, and this document provides insights into the design questions and their resolution.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-9">
<a href="#name-status-of-this-memo-9" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 8 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-9">
<a href="#name-copyright-notice-9" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-9">
<a href="#name-table-of-contents-9" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-9" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-related-prior-work" class="xref">Related Prior Work</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-design-rationale-and-discus" class="xref">Design Rationale and Discussion</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-explanation-of-rules-1-and-" class="xref">Explanation of Rules 1 and 2 in the solution document</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-is-route-leak-solution-with" class="xref">Is route-leak solution without cryptographic protection an attack vector?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-combining-results-of-route-" class="xref">Combining results of route-leak detection, OV and BGPsec validation for path selection decision</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-are-there-cases-when-valley" class="xref">Are there cases when valley-free violations can be considered legitimate?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-comparison-with-other-metho" class="xref">Comparison with other methods (routing security BCPs)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.6">
                <p id="section-toc.1-1.3.2.6.1"><a href="#section-3.6" class="xref">3.6</a>.  <a href="#name-per-hop-rlp-field-or-single" class="xref">Per-Hop RLP Field or Single RLP Flag per Update?</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7">
                <p id="section-toc.1-1.3.2.7.1"><a href="#section-3.7" class="xref">3.7</a>.  <a href="#name-prevention-of-route-leaks-a" class="xref">Prevention of Route Leaks at Local AS: Intra-AS Messaging</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.7.2.1">
                    <p id="section-toc.1-1.3.2.7.2.1.1"><a href="#section-3.7.1" class="xref">3.7.1</a>.  <a href="#name-non-transitive-bgp-communit" class="xref">Non-Transitive BGP Community for Intra-AS Messaging</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.8">
                <p id="section-toc.1-1.3.2.8.1"><a href="#section-3.8" class="xref">3.8</a>.  <a href="#name-stopgap-solution-when-only-" class="xref">Stopgap Solution when Only Origin Validation is Deployed</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-security-considerations-9" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations-9" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-references-7" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-normative-references-9" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-informative-references-7" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="xref"></a><a href="#name-acknowledgements-4" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="xref"></a><a href="#name-contributors-6" class="xref">Contributors</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-address-2" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction-9">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-9" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">

This document captures the design rationale of the route leaks solution document <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span> <span>[<a href="#I-D.ietf-grow-route-leak-detection-mitigation" class="xref">I-D.ietf-grow-route-leak-detection-mitigation</a>]</span>.  The designers needed to balance many competing factors, and this document provides insights into the design questions and their resolution.<a href="#section-1-1" class="pilcrow">¶</a></p>
</section>
<div id="prior-work">
<section id="section-2">
      <h2 id="name-related-prior-work">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-related-prior-work" class="section-name selfRef">Related Prior Work</a>
      </h2>
<p id="section-2-1">
The solution described in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span> is based on setting an attribute in BGP route announcement to manage the transmission/receipt of the announcement based on the type of neighbor (e.g., customer, transit provider, etc.). Documented prior work related to this basic idea and mechanism dates back to at least the 1980's. Some examples of prior work are: (1) Information flow rules described in <span>[<a href="#proceedings-sixth-ietf" class="xref">proceedings-sixth-ietf</a>]</span> (see pp. 195-196); (2) Link Type described in <span>[<a href="#RFC1105-obsolete" class="xref">RFC1105-obsolete</a>]</span> (see pp. 4-5); (3) Hierarchical Recording described in <span>[<a href="#draft-kunzinger-idrp-ISO10747-01" class="xref">draft-kunzinger-idrp-ISO10747-01</a>]</span> (see Section 6.3.1.12). The problem of route leaks and possible solution mechanisms based on encoding peering-link type information, e.g., P2C (i.e., Transit-Provider to Customer), C2P (i.e., Customer to Transit-Provider), p2p (i.e., peer to peer) etc., in BGPsec updates and protecting the same under BGPsec path signatures have been discussed in IETF SIDR WG at least since 2011. <span>[<a href="#draft-dickson-sidr-route-leak-solns" class="xref">draft-dickson-sidr-route-leak-solns</a>]</span> attempted to describe these mechanisms in a BGPsec context. The draft expired in 2012. <span>[<a href="#draft-dickson-sidr-route-leak-solns" class="xref">draft-dickson-sidr-route-leak-solns</a>]</span> defined neighbor relationships on a per link basis, but in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span> the relationship is encoded per prefix, as routes for prefixes with different peering relationships may be sent over the same link. Also <span>[<a href="#draft-dickson-sidr-route-leak-solns" class="xref">draft-dickson-sidr-route-leak-solns</a>]</span> proposed a second signature block for the link type encoding, separate from the path signature block in BGPsec. By contrast, in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span>, when BGPsec-based solution is considered, cryptographic protection is provided for Route-Leak Protection (RLP) encoding using the same signature block as that for path signatures (see Section 3.2.2 in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span>).<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="discuss">
<section id="section-3">
      <h2 id="name-design-rationale-and-discus">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-design-rationale-and-discus" class="section-name selfRef">Design Rationale and Discussion</a>
      </h2>
<p id="section-3-1">
This section provides design justifications for the solution specified in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span>, and also answers some questions that are anticipated or have been raised in the IETF IDR and SIDR working group meetings.<a href="#section-3-1" class="pilcrow">¶</a></p>
<div id="theorem">
<section id="section-3.1">
        <h3 id="name-explanation-of-rules-1-and-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-explanation-of-rules-1-and-" class="section-name selfRef">Explanation of Rules 1 and 2 in the solution document</a>
        </h3>
<p id="section-3.1-1">
In Section 3.3 in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span>, Rules 1 and 2 were stated and the route leak mitigation policy was based on these rules to preserve the property of stable route convergence (i.e., avoid possibility of persistent route oscillations). Rule 1 is stated as follows:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-2.1">
Rule 1: If ISP A receives a route r1 from customer AS C and another route r2 from provider (or peer) AS B (for the same prefix), and both routes r1 and r2 contain AS C and AS X (any X not equal to C) in the path and contain [X] in their RLP Attributes, then prioritize the customer (AS C) route over the provider (or peer) route.<a href="#section-3.1-2.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-3">
The rationale for Rule 1 can be developed as follows.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">
Preference condition for route stability: Prefer customer routes over peer or provider routes (see pp. 25-27 in <span>[<a href="#Gao-Rexford" class="xref">Gao-Rexford</a>]</span>).<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">
Topology condition for route stability: No cycle of customer-provider relationships (see pp. 25-27 in <span>[<a href="#Gao-Rexford" class="xref">Gao-Rexford</a>]</span>).<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">
Route-Leak Detection Theorem: Let it be given that ISP A receives a route r1 from customer AS C and another route r2 from provider AS B (for the same prefix), and each of the routes r1 and r2 contains AS C and AS X in its AS path and contains [X] in its RLP Attribute. Then, clearly r1 is in violation of [X]. It follows that r2 is also necessarily in violation of [X].<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">
Proof: Let us suppose that r2 is not in violation of [X]. That implies that r2's path from C to B to A included only P2C links. That would mean that there is a cycle of customer-provider relationships involving the ASes in the AS path in r2. However, any such cycle is ruled out in practice by the topology condition for route stability as stated above. QED.<a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">
Corollary 1: The route leak detection theorem holds also when "provider AS B" in the theorem is replaced by "peer AS B". (Here peer means a lateral peer.)<a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">
Proof: Since r2 contains [X] in the RLP Attribute set by an AS prior to peer AS B, it follows that r2 is in violation of [X]. QED.<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.1-10">
It can be observed that Rule 1 follows from the combination of the Theorem, Corollary 1 and the preference condition for route stability (stated above).<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1-11">
In Section 3.3 in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span>, Rule 2 is stated as follows:<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-12.1">
Rule 2: If ISP A receives a route r1 from peer AS C and another route r2 from provider AS B (for the same prefix), and both routes r1 and r2 contain AS C and AS X (any X not equal to C) in the path and contain [X] in their RLP Attributes, then prioritize the peer (AS C) route over the provider (AS B) route.<a href="#section-3.1-12.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.1-13">
The rationale for Rule 2 can be developed as follows.<a href="#section-3.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1-14">
Corollary 2: The route leak detection theorem holds also when "customer AS C" in the theorem is replaced by "peer AS C".<a href="#section-3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.1-15">
Proof for Corollary 2: Let us suppose that r2 is not in violation of [X]. That implies that r2's path from C to B to A included only P2C links. This results in a topology in which A's lateral peer B is also A's transit provider's transit provider. This gives rise to possibility of looping of routes since A can send routes to its transit B, B can forward the routes to its transit C, and C can forward the routes to its peer A. But such looping is forbidden by the topology condition stated above.<a href="#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16">
It can be observed that Rule 2 follows from Corollary 2. In essence, if the provider route (r2) is a detoured (longer) version of the lateral peer route (r1), and violates the same RLP [X] as does the peer route, then prefer the shorter route (r2) via the peer.<a href="#section-3.1-16" class="pilcrow">¶</a></p>
<p id="section-3.1-17">
Rules 1 and 2 are<a href="#section-3.1-17" class="pilcrow">¶</a></p>
</section>
</div>
<div id="vector">
<section id="section-3.2">
        <h3 id="name-is-route-leak-solution-with">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-is-route-leak-solution-with" class="section-name selfRef">Is route-leak solution without cryptographic protection an attack vector?</a>
        </h3>
<p id="section-3.2-1"> 
It has been asked if a route-leak solution without BGPsec, i.e., when RLP Fields are not protected, can turn into a new attack vector. The answer seems to be: not really! Even the NLRI and AS_PATH in BGP updates are attack vectors, and RPKI/OV/BGPsec seek to fix that. Consider the following. Say, if 99% of route leaks are accidental and 1% are malicious, and if route-leak solution without BGPsec eliminates the 99%, then perhaps it is worth it (step in the right direction). When BGPsec comes into deployment, the route-leak protection (RLP) bits can be mapped into BGPsec (using the Flags field) and then necessary security will be in place as well (within each BGPsec island as and when they emerge).<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2"> 
Further, let us consider the worst-case damage that can be caused by maliciously manipulating the RLP Field values in an implementation without cryptographic protection (i.e., sans BGPsec). Manipulation of the RLP bits can result in one of two types of attacks: (a) Upgrade attack and (b) Downgrade attack. Descriptions and discussions about these attacks follow. In what follows, P2C stands for transit provider to customer (Down); C2P stands for customer to transit provider (Up), and p2p stands for peer to peer (lateral or non-transit relationship).<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3"> 
(a) Upgrade attack: An AS that wants to intentionally leak a route would alter the RLP encodings for the preceding hops from 1 (i.e., 'Do not Propagate Up or Lateral') to 0 (default) wherever applicable. This poses no problem for a route that keeps propagating in the 'Down' (P2C) direction. However, for a route that propagates 'Up' (C2P) or 'Lateral' (p2p), the worst that can happen is that a route leak goes undetected. That is, a receiving router would not be able to detect the leak for the route in question by the RLP mechanism described here. However, the receiving router may still detect and mitigate it in some cases by applying other means such as prefix filters <span>[<a href="#RFC7454" class="xref">RFC7454</a>]</span> <span>[<a href="#NIST-800-54" class="xref">NIST-800-54</a>]</span>. If some malicious leaks go undetected (when RLP is deployed without BGPsec) that is possibly a small price to pay for the ability to detect the bulk of route leaks that are accidental.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4"> 
(b) Downgrade attack: RLP encoding is set to 1 (i.e., 'Do not Propagate Up or Lateral') when it should be set to 0 (default). This would result in a route being mis-detected and marked as a route leak. By default, RLP encoding is set to 0, and that helps reduce errors of this kind (i.e., accidental downgrade incidents). Every AS or ISP wants reachability for prefixes it originates and for its customer prefixes. So, an AS or ISP is not likely to change an RLP value 0 to 1 intentionally. If a route leak is detected (due to intentional or accidental downgrade) by a receiving router, it would prefer an alternate 'clean' route from a transit provider or peer over a 'marked' route from a customer. It may end up with a suboptimal path. In order to have reachability, the receiving router would accept a 'marked' route if there is no alternative that is 'clean'. So, RLP downgrade attacks (intentional or accidental) would be quite rare, and the consequences do not appear to be grave.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="combine">
<section id="section-3.3">
        <h3 id="name-combining-results-of-route-">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-combining-results-of-route-" class="section-name selfRef">Combining results of route-leak detection, OV and BGPsec validation for path selection decision</a>
        </h3>
<p id="section-3.3-1"> 
Combining the results of route-leak detection, OV, and BGPsec validation for path selection decision is up to local policy in a receiving router. As an example, a router may always give precedence to outcomes of OV and BGPsec validation over that of route-leak detection. That is, if an update fails OV or BGPsec validation, then the update is not considered a candidate for path selection. Instead, an alternate update is chosen that passed OV and BGPsec validation and additionally was not marked as route leak.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2"> 
If only OV is deployed (and not BGPsec), then there are six possible combinations between OV and route-leak detection outcomes. Because there are three possible outcomes for OV (NotFound, Valid, and Invalid) and two possible outcomes for route-leak detection (marked as leak and not marked). If OV and BGPsec are both deployed, then there are twelve possible combinations between OV, BGPsec validation, and route-leak detection outcomes. As stated earlier, since BGPsec protects the RLP encoding, there would be added certainty in route-leak detection outcome if an update is BGPsec valid (see <a href="#vector" class="xref">Section 3.2</a>).<a href="#section-3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="viola">
<section id="section-3.4">
        <h3 id="name-are-there-cases-when-valley">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-are-there-cases-when-valley" class="section-name selfRef">Are there cases when valley-free violations can be considered legitimate?</a>
        </h3>
<p id="section-3.4-1"> 
There are studies in the literature <span>[<a href="#Anwar" class="xref">Anwar</a>]</span> <span>[<a href="#Giotsas" class="xref">Giotsas</a>]</span> <span>[<a href="#Wijchers" class="xref">Wijchers</a>]</span> observing and analyzing the behavior of routes announced in BGP updates using data gathered from the Internet. The studies have focused on how often there appear to be valley-free (e.g., Gao-Rexford <span>[<a href="#Gao" class="xref">Gao</a>]</span> model) violations, and if they can be explained <span>[<a href="#Anwar" class="xref">Anwar</a>]</span>. One important consideration for explanation of the violations is per-prefix routing policies, i.e., routes for prefixes with different peering relationships may be sent over the same link. One encouraging result reported in <span>[<a href="#Anwar" class="xref">Anwar</a>]</span> is that when per-prefix routing policies are taken into consideration in the data analysis, more than 80% of the observed routing decisions fit the valley-free model (see Section 4.3 and SPA-1 data in Figure 2). <span>[<a href="#Anwar" class="xref">Anwar</a>]</span> also observes, "it is well known that this model [the basic Gao-Rexford model and some variations of it] fails to capture many aspects of the interdomain routing system. These aspects include AS relationships that vary based on the geographic region or destination prefix, and traffic engineering via hot-potato routing or load balancing." So, there may be potential for explaining the remaining (20% or less) violations of valley-free as well.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2"> 
One major design factor is that the Route-Leak Protection (RLP) encoding is per prefix. Hence, the solution is consistent with ISPs' per-prefix routing policies. Large global and other major ISPs will be the likely early adopters, and they are expected to have expertise in setting policies (including per prefix policies, if applicable), and make proper use of the RLP indications on a per prefix basis. When the large ISPs participate in this solution deployment, it is envisioned that they would form a ring of protection against route leaks, and co-operatively avoid many of the common types of route leaks that are observed. Route leaks may still happen occasionally within the customer cones (if some customer ASes are not participating or not diligently implementing RLP), but such leaks are unlikely to propagate from one large participating ISP to another.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="comp1">
<section id="section-3.5">
        <h3 id="name-comparison-with-other-metho">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-comparison-with-other-metho" class="section-name selfRef">Comparison with other methods (routing security BCPs)</a>
        </h3>
<p id="section-3.5-1"> 
It is reasonable to ask if techniques considered in BCPs such as<span>[<a href="#RFC7454" class="xref">RFC7454</a>]</span> (BGP Operations and Security) and <span>[<a href="#NIST-800-54" class="xref">NIST-800-54</a>]</span> may be adequate to address route leaks. The prefix filtering recommendations in the BCPs may be complementary but not adequate. The difficulty is in ISPs' ability to construct prefix filters that represent their customer cones (CC) accurately, especially when there are many levels in the hierarchy within the CC. In the RLP-encoding based solution described here, each AS sets RLP for each route propagated and thus signals if it must not be subsequently propagated to a transit provider or peer.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2"> 
AS path based Outbound Route Filter (ORF) described in <span>[<a href="#I-D.ietf-idr-aspath-orf" class="xref">I-D.ietf-idr-aspath-orf</a>]</span> is also an interesting complementary technique. It can be used as an automated collaborative messaging system (implemented in BGP) for ISPs to try to develop a complete view of the ASes and AS paths in their CCs. Once an ISP has that view, then AS path filters can be possibly used to detect route leaks. One limitation of this technique is that it cannot duly take into account the fact that routes for prefixes with different peering relationships may be sent over the same link between ASes. Also, the success of AS path based ORF depends on whether ASes at all levels of the hierarchy in a CC participate and provide accurate information (in the ORF messages) about the AS paths they expect to have in their BGP updates.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="per-hop">
<section id="section-3.6">
        <h3 id="name-per-hop-rlp-field-or-single">
<a href="#section-3.6" class="section-number selfRef">3.6. </a><a href="#name-per-hop-rlp-field-or-single" class="section-name selfRef">Per-Hop RLP Field or Single RLP Flag per Update?</a>
        </h3>
<p id="section-3.6-1"> 
The route-leak detection and mitigation mechanism described in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span> is based on setting RLP Fields on a per-hop basis. There is another possible mechanism based on a single RLP flag per update.<a href="#section-3.6-1" class="pilcrow">¶</a></p>
<p id="section-3.6-2"> 
Method A - Per-Hop RLP Field: The sender (eBGP router) on each hop in the AS path sets its RLP Field = 1 if sending the update to a customer or lateral peer (see Section 3.2 in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span>). No AS (if operating correctly) would rewrite the RLP Field set by any preceding AS.<a href="#section-3.6-2" class="pilcrow">¶</a></p>
<p id="section-3.6-3">
Method Z - Single RLP Flag per Update: As it propagates, the update would have at most one RLP flag. Once an eBGP router (in the update path) determines that it is sending an update towards a customer or lateral peer AS, it sets the RLP flag. The flag value equals the AS number of the eBGP router that is setting it. Once the flag is set, subsequent ASes in the path must propagate the flag as is.<a href="#section-3.6-3" class="pilcrow">¶</a></p>
<p id="section-3.6-4">
To compare Methods A and Z, consider the example illustrated in <a href="#fig4" class="xref">Figure 1</a>. Consider a partial deployment scenario in which AS1, AS2, AS3 and AS5 participate in RLP, and AS4 does not. AS1 (2 levels deep in AS3's customer cone) has imperfect RLP operation. Each complying AS's route leak mitigation policy is to prefer an update not marked as route leak (see Section 3.3 in <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span>). If there is no alternative, then a transit-provider may accept and propagate a marked update from a customer to avoid unreachability. In this example, multi-homed AS4 leaks a route received for prefix Q from transit-provider AS3 to transit-provider AS5.<a href="#section-3.6-4" class="pilcrow">¶</a></p>
<span id="name-example-for-comparison-of-m"></span><div id="fig4">
<figure id="figure-1">
          <div class="alignLeft art-text artwork" id="section-3.6-5.1">
<pre>

                     +-----------+  RLP=1    +-----------+
                     |    AS3    |----------&gt;|    AS5    |
                     |(Major ISP)|        U2 |(Major ISP)|
                     +-----------+           +-----------+
                        /\       \            /\ U1
 Route for Q propagated /         \RLP=1      /
   due to lack of      /RLP=0      \         / (route leak;
  alternate route     /            \/       /   bad behavior)
              +---------+       +-------------+
              |   AS2   |       |     AS4     |
              +---------+       +-------------+
                  /\             (legacy; does not support RLP)
                  /
                 /
                /RLP=1 (set incorrectly)
               /
     +----------+
     |    AS1   |
     +----------+
        /\
        /
       / Prefix Q

</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-example-for-comparison-of-m" class="selfRef">Example for comparison of Method A vs. Method Z</a>
          </figcaption></figure>
</div>
<p id="section-3.6-6">
If Method A is implemented in the network, the two BGP updates for prefix Q received at AS5 are (note that AS4 is not participating in RLP):<a href="#section-3.6-6" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.6-7.1">
U1A: Q [AS4 AS3 AS2 AS1] {RLP3(AS3)=1, RLP2(AS2)=0, RLP1(AS1)=1} ..... from AS4<a href="#section-3.6-7.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.6-7.2">
U2A: Q [AS3 AS2 AS1] {RLP3(AS3)=1, RLP2(AS2)=0, RLP1(AS1)=1} ..... from AS3<a href="#section-3.6-7.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-8">
Alternatively, if Method Z is implemented in the network, the two BGP updates for prefix Q received at AS5 are:<a href="#section-3.6-8" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-3.6-9.1">
U1B: Q [AS4 AS3 AS2 AS1] {RLP(AS1)=1}  ..... from AS4<a href="#section-3.6-9.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-3.6-9.2">
U2B: Q [AS3 AS2 AS1] {RLP(AS1)=1}  ..... from AS3<a href="#section-3.6-9.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.6-10">
All received routes for prefix Q at AS5 are marked as route leak in either case (Method A or Z). In the case of Method A, AS5 can use additional information gleaned from the RLP fields in the updates to possibly make a better best path selection. For example, AS5 can determine that U1A update received from its customer AS4 exhibits violation of two RLP fields (those set by AS1 and AS3) and one of them was set just two hops away. But U2A update exhibits that only one RLP field was violated and that was set three hops back. Based on this logic, AS5 may prefer U2A over U1A (even though U1A is a customer route). This would be a good decision. However, Method Z does not facilitate this kind of more rational decision process. With Method Z, both updates U1B and U2B exhibit that they violated only one RLP field (set by AS1 several hops away). AS5 may then prefer U1B over U2B since U1B is from a customer, and that would be bad decision. This illustrates that, due to more information in per-hop RLP Fields, Method A seems to be operationally more beneficial than Method Z.<a href="#section-3.6-10" class="pilcrow">¶</a></p>
<p id="section-3.6-11">
Further, for detection and notification of neighbor AS's non-compliance, Method A (per-hop RLP) is better than Method Z (single RLP). With Method A, the bad behavior of AS4 would be explicitly evident to AS5 since it violated AS3's (only two hops away) RLP field as well. AS5 would alert AS4 and AS2 would alert AS1 about lack of compliance (when Method A is used). With Method Z, the alerting process may not be as expeditious.<a href="#section-3.6-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intra-AS">
<section id="section-3.7">
        <h3 id="name-prevention-of-route-leaks-a">
<a href="#section-3.7" class="section-number selfRef">3.7. </a><a href="#name-prevention-of-route-leaks-a" class="section-name selfRef">Prevention of Route Leaks at Local AS: Intra-AS Messaging</a>
        </h3>
<p id="section-3.7-1">
Note: The intra-AS messaging for route leak prevention can be done using a non-transitive BGP Community or Attribute. The Community-based method is described below. For the BGP Attribute-based method, see <span>[<a href="#I-D.ietf-idr-bgp-open-policy" class="xref">I-D.ietf-idr-bgp-open-policy</a>]</span>.<a href="#section-3.7-1" class="pilcrow">¶</a></p>
<div id="community">
<section id="section-3.7.1">
          <h4 id="name-non-transitive-bgp-communit">
<a href="#section-3.7.1" class="section-number selfRef">3.7.1. </a><a href="#name-non-transitive-bgp-communit" class="section-name selfRef">Non-Transitive BGP Community for Intra-AS Messaging</a>
          </h4>
<p id="section-3.7.1-1">
The following procedure (or similar) for intra-AS messaging (i.e., between ingress and egress routers) for prevention of route leaks is a fairly common practice used by large ISPs. (Note: This information was gathered from discussions on the NANOG mailing list <span>[<a href="#Nanog-thread-June2016" class="xref">Nanog-thread-June2016</a>]</span> as well as through private discussions with operators of large ISP networks.)<a href="#section-3.7.1-1" class="pilcrow">¶</a></p>
<p id="section-3.7.1-2">
Routes are tagged on ingress to an AS with communities for origin, including the type of eBGP peer it was learned from (customer, provider or lateral peer), geographic location, etc. The community attributes are carried across the AS with the routes. 

These communities are used along with additional logic in route policies to determine which routes are to be announced to which eBGP peers and which are to be dropped. 

In this process, the ISP's AS also ensures that routes learned from a transit-provider or a lateral peer (i.e., non-transit) at an ingress router are not leaked at an egress router to another transit-provider or lateral peer.<a href="#section-3.7.1-2" class="pilcrow">¶</a></p>
<p id="section-3.7.1-3">
Additionally, in many cases, ISP network operators' outbound policies require explicit matches for expected communities before passing routes. This helps ensure that that if an update has been entered into the RIB-in but has missed its ingress community tagging (due to a missing/misapplied ingress policy), it will not be inadvertently leaked.<a href="#section-3.7.1-3" class="pilcrow">¶</a></p>
<p id="section-3.7.1-4">
The above procedure (or a simplified version of it) is also applicable when an AS consists of a single eBGP router. It is recommended that all AS operators SHOULD implement the procedure described above (or similar that is appropriate for their network) to prevent route leaks that they have direct control over.<a href="#section-3.7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="stopgap">
<section id="section-3.8">
        <h3 id="name-stopgap-solution-when-only-">
<a href="#section-3.8" class="section-number selfRef">3.8. </a><a href="#name-stopgap-solution-when-only-" class="section-name selfRef">Stopgap Solution when Only Origin Validation is Deployed</a>
        </h3>
<p id="section-3.8-1">

A stopgap method is described here for detection and mitigation of route leaks for the intermediate phase when OV is deployed but BGP protocol on the wire is unchanged. The stopgap solution can be in the form of construction of a prefix filter list from ROAs. A suggested procedure for constructing such a list comprises of the following steps:<a href="#section-3.8-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.8-2.1">
ISP makes a list of all the ASes (Cust_AS_List) that are in its customer cone (ISP's own AS is also included in the list). (Some of the ASes in Cust_AS_List may be multi-homed to another ISP and that is OK.)<a href="#section-3.8-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.8-2.2">
ISP downloads from the RPKI repositories a complete list (Cust_ROA_List) of valid ROAs that contain any of the ASes in Cust_AS_List.<a href="#section-3.8-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.8-2.3">
ISP creates a list of all the prefixes (Cust_Prfx_List) that are contained in any of the ROAs in Cust_ROA_List.<a href="#section-3.8-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.8-2.4">
Cust_Prfx_List is the allowed list of prefixes that is permitted by the ISP's AS, and will be forwarded by the ISP to upstream ISPs, customers, and peers.<a href="#section-3.8-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.8-2.5">
A route for a prefix that is not in Cust_Prfx_List but announced by one of ISP's customers is 'marked' as a potential route leak. Further, the ISP's router SHOULD prefer an alternate route that is Valid (i.e., valid according to origin validation) and 'clean' (i.e., not marked) over the 'marked' route. The alternate route may be from a peer, transit provider, or different customer.<a href="#section-3.8-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.8-3">
Special considerations regarding the above procedure may be needed for DDoS mitigation service providers. They typically originate or announce a DDoS victim's prefix to their own ISP on a short notice during a DDoS emergency. Some provisions would need to be made for such cases, and they can be determined with the help of inputs from DDoS mitigation service providers.<a href="#section-3.8-3" class="pilcrow">¶</a></p>
<p id="section-3.8-4">
For developing a list of all the ASes (Cust_AS_List) that are in the customer cone of an ISP, the AS path based Outbound Route Filter (ORF) technique <span>[<a href="#I-D.ietf-idr-aspath-orf" class="xref">I-D.ietf-idr-aspath-orf</a>]</span> can be helpful (see discussion in <a href="#comp1" class="xref">Section 3.5</a>).<a href="#section-3.8-4" class="pilcrow">¶</a></p>
<p id="section-3.8-5">
Another technique based on AS_PATH filters is described in <span>[<a href="#Snijders" class="xref">Snijders</a>]</span>. This method is applicable to very large ISPs that have lateral peering. For a pair of such very large ISPs, say A and B, the method depends on ISP A communicating out-of-band (e.g., by email) with ISP B about whether or not it (ISP A) has any transit providers. This out-of-band knowledge enables ISP B to apply suitable AS_PATH filtering criteria for routes involving the presence of ISP A in the path and prevent certain kinds of route leaks (see <span>[<a href="#Snijders" class="xref">Snijders</a>]</span> for details).<a href="#section-3.8-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="Security">
<section id="section-4">
      <h2 id="name-security-considerations-9">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-security-considerations-9" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-4-1">

This document requires no security considerations.  See <span>[<a href="#I-D.ietf-idr-route-leak-detection-mitigation" class="xref">I-D.ietf-idr-route-leak-detection-mitigation</a>]</span> for security considerations for the solution for route leaks detection and mitigation.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations-9">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations-9" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1"> 
This document has no IANA actions.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-references-7">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references-7" class="section-name selfRef">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references-9">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references-9" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC4271">[RFC4271]</dt>
      <dd>
<span class="refAuthor">Rekhter, Y., Ed.</span>, <span class="refAuthor">Li, T., Ed.</span>, and <span class="refAuthor">S. Hares, Ed.</span>, <span class="refTitle">"A Border Gateway Protocol 4 (BGP-4)"</span>, <span class="seriesInfo">RFC 4271</span>, <span class="seriesInfo">DOI 10.17487/RFC4271</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4271">https://www.rfc-editor.org/info/rfc4271</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references-7">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references-7" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Anwar">[Anwar]</dt>
        <dd>
<span class="refAuthor">Anwar, R.</span>, <span class="refAuthor">Niaz, H.</span>, <span class="refAuthor">Choffnes, D.</span>, <span class="refAuthor">Cunha, I.</span>, <span class="refAuthor">Gill, P.</span>, and <span class="refAuthor">N. Katz-Bassett</span>, <span class="refTitle">"Investigating Interdomain Routing Policies in the Wild"</span>, <span class="seriesInfo"> ACM Internet Measurement Conference (IMC)</span>, <time datetime="2015-10" class="refDate">October 2015</time>, <span>&lt;<a href="http://www.cs.usc.edu/assets/007/94928.pdf">http://www.cs.usc.edu/assets/007/94928.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="draft-dickson-sidr-route-leak-solns">[draft-dickson-sidr-route-leak-solns]</dt>
        <dd>
<span class="refAuthor">Dickson, B.</span>, <span class="refTitle">"Route Leaks -- Proposed Solutions"</span>, <span class="seriesInfo"> IETF Internet Draft (expired)</span>, <time datetime="2012-03" class="refDate">March 2012</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-dickson-sidr-route-leak-solns-01">https://tools.ietf.org/html/draft-dickson-sidr-route-leak-solns-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="draft-kunzinger-idrp-ISO10747-01">[draft-kunzinger-idrp-ISO10747-01]</dt>
        <dd>
<span class="refAuthor">Kunzinger, C.</span>, <span class="refTitle">"Inter-Domain Routing Protocol (IDRP)"</span>, <span class="seriesInfo"> IETF Internet Draft (expired)</span>, <time datetime="1994-11" class="refDate">November 1994</time>, <span>&lt;<a href="https://tools.ietf.org/pdf/draft-kunzinger-idrp-ISO10747-01.pdf">https://tools.ietf.org/pdf/draft-kunzinger-idrp-ISO10747-01.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Gao">[Gao]</dt>
        <dd>
<span class="refAuthor">Gao, L.</span> and <span class="refAuthor">J. Rexford</span>, <span class="refTitle">"Stable Internet routing without global coordination"</span>, <span class="seriesInfo"> IEEE/ACM Transactions on Networking</span>, <time datetime="2001-12" class="refDate">December 2001</time>, <span>&lt;<a href="http://www.cs.princeton.edu/~jrex/papers/sigmetrics00.long.pdf">http://www.cs.princeton.edu/~jrex/papers/sigmetrics00.long.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Gao-Rexford">[Gao-Rexford]</dt>
        <dd>
<span class="refAuthor">Freedman, M.</span>, <span class="refTitle">"Interdomain Routing Policy"</span>, <span class="seriesInfo"> Princeton University COS 461 Lecture Notes; Slides 25-27</span>, <span>&lt;<a href="http://www.cs.princeton.edu/courses/archive/spr11/cos461/docs/lec17-bgp-policy.ppt">http://www.cs.princeton.edu/courses/archive/spr11/cos461/docs/lec17-bgp-policy.ppt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Gill">[Gill]</dt>
        <dd>
<span class="refAuthor">Gill, P.</span>, <span class="refAuthor">Schapira, M.</span>, and <span class="refAuthor">S. Goldberg</span>, <span class="refTitle">"A Survey of Interdomain Routing Policies"</span>, <span class="seriesInfo"> ACM SIGCOMM Computer Communication Review</span>, <time datetime="2014-01" class="refDate">January 2014</time>, <span>&lt;<a href="https://www.cs.bu.edu/~goldbe/papers/survey.pdf">https://www.cs.bu.edu/~goldbe/papers/survey.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Giotsas">[Giotsas]</dt>
        <dd>
<span class="refAuthor">Giotsas, V.</span> and <span class="refAuthor">S. Zhou</span>, <span class="refTitle">"Valley-free violation in Internet routing - Analysis based on BGP Community data"</span>, <span class="seriesInfo"> IEEE ICC 2012</span>, <time datetime="2012-06" class="refDate">June 2012</time>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-grow-route-leak-detection-mitigation">[I-D.ietf-grow-route-leak-detection-mitigation]</dt>
        <dd>
<span class="refAuthor">Sriram, K.</span> and <span class="refAuthor">A. Azimov</span>, <span class="refTitle">"Methods for Detection and Mitigation of BGP Route Leaks"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-grow-route-leak-detection-mitigation-06</span>, <time datetime="2021-10-24" class="refDate">24 October 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-grow-route-leak-detection-mitigation-06.txt">https://www.ietf.org/archive/id/draft-ietf-grow-route-leak-detection-mitigation-06.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-aspath-orf">[I-D.ietf-idr-aspath-orf]</dt>
        <dd>
<span class="refAuthor">Hares, S.</span> and <span class="refAuthor">K. Patel</span>, <span class="refTitle">"AS Path Based Outbound Route Filter for BGP-4"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-aspath-orf-13</span>, <time datetime="2016-12-19" class="refDate">19 December 2016</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-aspath-orf-13.txt">https://www.ietf.org/archive/id/draft-ietf-idr-aspath-orf-13.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-bgp-open-policy">[I-D.ietf-idr-bgp-open-policy]</dt>
        <dd>
<span class="refAuthor">Azimov, A.</span>, <span class="refAuthor">Bogomazov, E.</span>, <span class="refAuthor">Bush, R.</span>, <span class="refAuthor">Patel, K.</span>, and <span class="refAuthor">K. Sriram</span>, <span class="refTitle">"Route Leak Prevention and Detection using Roles in UPDATE and OPEN Messages"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-bgp-open-policy-23</span>, <time datetime="2022-03-03" class="refDate">3 March 2022</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-bgp-open-policy-23.txt">https://www.ietf.org/archive/id/draft-ietf-idr-bgp-open-policy-23.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-idr-route-leak-detection-mitigation">[I-D.ietf-idr-route-leak-detection-mitigation]</dt>
        <dd>
<span class="refAuthor">Sriram, K.</span> and <span class="refAuthor">A. Azimov</span>, <span class="refTitle">"Methods for Detection and Mitigation of BGP Route Leaks"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-idr-route-leak-detection-mitigation-11</span>, <time datetime="2019-04-18" class="refDate">18 April 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-idr-route-leak-detection-mitigation-11.txt">https://www.ietf.org/archive/id/draft-ietf-idr-route-leak-detection-mitigation-11.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Luckie">[Luckie]</dt>
        <dd>
<span class="refAuthor">Luckie, M.</span>, <span class="refAuthor">Huffaker, B.</span>, <span class="refAuthor">Dhamdhere, A.</span>, <span class="refAuthor">Giotsas, V.</span>, and <span class="refAuthor">kc. claffy</span>, <span class="refTitle">"AS Relationships, Customer Cones, and Validation"</span>, <span class="seriesInfo"> IMC 2013</span>, <time datetime="2013-10" class="refDate">October 2013</time>, <span>&lt;<a href="http://www.caida.org/~amogh/papers/asrank-IMC13.pdf">http://www.caida.org/~amogh/papers/asrank-IMC13.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Nanog-thread-June2016">[Nanog-thread-June2016]</dt>
        <dd>
<span class="refTitle">"Intra-AS messaging for route leak prevention"</span>, <span class="seriesInfo">NANOG Email List - Discussion Thread </span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="http://mailman.nanog.org/pipermail/nanog/2016-June/thread.html#86348">http://mailman.nanog.org/pipermail/nanog/2016-June/thread.html#86348</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="NIST-800-54">[NIST-800-54]</dt>
        <dd>
<span class="refAuthor">Kuhn, D.R.</span>, <span class="refAuthor">Sriram, K.</span>, and <span class="refAuthor">D. Montgomery</span>, <span class="refTitle">"Border Gateway Protocol Security"</span>, <span class="seriesInfo"> NIST Special Publication 800-54</span>, <time datetime="2007-07" class="refDate">July 2007</time>, <span>&lt;<a href="http://csrc.nist.gov/publications/nistpubs/800-54/SP800-54.pdf">http://csrc.nist.gov/publications/nistpubs/800-54/SP800-54.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="proceedings-sixth-ietf">[proceedings-sixth-ietf]</dt>
        <dd>
<span class="refAuthor">Gross, P.</span>, <span class="refTitle">"Proceedings of the April 22-24, 1987 Internet Engineering Task Force"</span>, <time datetime="1987-04" class="refDate">April 1987</time>, <span>&lt;<a href="https://www.ietf.org/proceedings/06.pdf">https://www.ietf.org/proceedings/06.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1105-obsolete">[RFC1105-obsolete]</dt>
        <dd>
<span class="refAuthor">Lougheed, K.</span> and <span class="refAuthor">Y. Rekhter</span>, <span class="refTitle">"A Border Gateway Protocol (BGP)"</span>, <span class="seriesInfo"> IETF RFC (obsolete)</span>, <time datetime="1989-06" class="refDate">June 1989</time>, <span>&lt;<a href="https://tools.ietf.org/html/rfc1105">https://tools.ietf.org/html/rfc1105</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7454">[RFC7454]</dt>
        <dd>
<span class="refAuthor">Durand, J.</span>, <span class="refAuthor">Pepelnjak, I.</span>, and <span class="refAuthor">G. Doering</span>, <span class="refTitle">"BGP Operations and Security"</span>, <span class="seriesInfo">BCP 194</span>, <span class="seriesInfo">RFC 7454</span>, <span class="seriesInfo">DOI 10.17487/RFC7454</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7454">https://www.rfc-editor.org/info/rfc7454</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7908">[RFC7908]</dt>
        <dd>
<span class="refAuthor">Sriram, K.</span>, <span class="refAuthor">Montgomery, D.</span>, <span class="refAuthor">McPherson, D.</span>, <span class="refAuthor">Osterweil, E.</span>, and <span class="refAuthor">B. Dickson</span>, <span class="refTitle">"Problem Definition and Classification of BGP Route Leaks"</span>, <span class="seriesInfo">RFC 7908</span>, <span class="seriesInfo">DOI 10.17487/RFC7908</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7908">https://www.rfc-editor.org/info/rfc7908</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8205">[RFC8205]</dt>
        <dd>
<span class="refAuthor">Lepinski, M., Ed.</span> and <span class="refAuthor">K. Sriram, Ed.</span>, <span class="refTitle">"BGPsec Protocol Specification"</span>, <span class="seriesInfo">RFC 8205</span>, <span class="seriesInfo">DOI 10.17487/RFC8205</span>, <time datetime="2017-09" class="refDate">September 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8205">https://www.rfc-editor.org/info/rfc8205</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Snijders">[Snijders]</dt>
        <dd>
<span class="refAuthor">Snijders, J.</span>, <span class="refTitle">"Practical everyday BGP filtering with AS_PATH filters: Peer Locking"</span>, <span class="seriesInfo">NANOG 67 Chicago, IL, USA</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="https://www.nanog.org/sites/default/files/Snijders_Everyday_Practical_Bgp.pdf">https://www.nanog.org/sites/default/files/Snijders_Everyday_Practical_Bgp.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Wijchers">[Wijchers]</dt>
      <dd>
<span class="refAuthor">Wijchers, B.</span> and <span class="refAuthor">B. Overeinder</span>, <span class="refTitle">"Quantitative Analysis of BGP Route Leaks"</span>, <span class="seriesInfo"> RIPE-69</span>, <time datetime="2014-11" class="refDate">November 2014</time>, <span>&lt;<a href="https://ripe69.ripe.net/presentations/157-RIPE-69-Routing-WG.pdf">https://ripe69.ripe.net/presentations/157-RIPE-69-Routing-WG.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-acknowledgements-4">
<a href="#name-acknowledgements-4" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1">
The authors wish to thank Jared Mauch, Jeff Haas, Job Snijders, Warren Kumari, Amogh Dhamdhere, Jakob Heitz, Geoff Huston, Ruediger Volk, Sue Hares, John Scudder, Wes George, Chris Morrow, Sandy Murphy, Danny McPherson, and Eric Osterweil for comments, suggestions, and critique. The authors are also thankful to Padma Krishnaswamy, Oliver Borchert, and Okhee Kim for their review and comments.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B">
      <h2 id="name-contributors-6">
<a href="#name-contributors-6" class="section-name selfRef">Contributors</a>
      </h2>
<p id="appendix-B-1">
The following people made significant contributions to this document and should be considered co-authors:<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="appendix-B-2">
<pre>

Alexander Azimov
Yandex
Email: a.e.azimov@gmail.com

Brian Dickson
Independent
Email: brian.peter.dickson@gmail.com

Doug Montgomery
USA National Institute of Standards and Technology
Email: dougm@nist.gov

Keyur Patel
Arrcus
Email: keyur@arrcus.com

Andrei Robachevsky
Internet Society
Email: robachevsky@isoc.org

Eugene Bogomazov
Qrator Labs
Email: eb@qrator.net

Randy Bush
Internet Initiative Japan
Email: randy@psg.com

</pre><a href="#appendix-B-2" class="pilcrow">¶</a>
</div>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address-2">
<a href="#name-authors-address-2" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Kotikalapudi Sriram (<span class="role">editor</span>)</span></div>
<div dir="auto" class="left"><span class="org">USA National Institute of Standards and Technology</span></div>
<div dir="auto" class="left"><span class="street-address">100 Bureau Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Gaithersburg</span>, <span class="region">MD</span> <span class="postal-code">20899</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ksriram@nist.gov" class="email">ksriram@nist.gov</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
