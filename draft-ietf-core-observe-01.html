<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Observing Resources in CoAP</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Overview">
<link href="#rfc.section.3" rel="Chapter" title="3 Observation Relationships">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Establishment">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Maintenance">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Termination">
<link href="#rfc.section.4" rel="Chapter" title="4 Notifications">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Strategies">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Retransmission">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Reordering">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Caching">
<link href="#rfc.section.5" rel="Chapter" title="5 Lifetime Option">
<link href="#rfc.section.6" rel="Chapter" title="6 Interactions with other CoAP features">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Request Methods">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Block-wise Transfers">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Resource Discovery">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgements">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Examples">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Proxying">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Changelog">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="CoAP is a RESTful application protocol for constrained nodes and networks. The state of a resource on a CoAP server can change over time.  This specification provides a simple extension for CoAP that gives clients the ability to observe such changes." />
  <meta name="description" content="CoAP is a RESTful application protocol for constrained nodes and networks. The state of a resource on a CoAP server can change over time.  This specification provides a simple extension for CoAP that gives clients the ability to observe such changes." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">CoRE Working Group</td>
<td class="right">K. Hartke</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Universitaet Bremen TZI</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Z. Shelby</td>
</tr>
<tr>
<td class="left">Expires: August 11, 2011</td>
<td class="right">Sensinode</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">February 07, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Observing Resources in CoAP<br />
  <span class="filename">draft-ietf-core-observe-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>CoAP is a RESTful application protocol for constrained nodes and networks. The state of a resource on a CoAP server can change over time.  This specification provides a simple extension for CoAP that gives clients the ability to observe such changes.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on August 11, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Overview</a>
</li>
<li>3.   <a href="#rfc.section.3">Observation Relationships</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Establishment</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Maintenance</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Termination</a>
</li>
<li>4.   <a href="#rfc.section.4">Notifications</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Strategies</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Retransmission</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Reordering</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Caching</a>
</li>
<li>5.   <a href="#rfc.section.5">Lifetime Option</a>
</li>
<li>6.   <a href="#rfc.section.6">Interactions with other CoAP features</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Request Methods</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Block-wise Transfers</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">Resource Discovery</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgements</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Examples</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Proxying</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Changelog</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#introduction" id="introduction">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">CoAP <a href="#I-D.ietf-core-coap">[I-D.ietf-core-coap]</a> is an Application Protocol for Constrained Nodes/Networks. It is intended to provide RESTful services <a href="#REST">[REST]</a> not unlike HTTP <a href="#RFC2616">[RFC2616]</a>, while reducing the complexity of implementation as well as the size of packets exchanged in order to make these services useful in a highly constrained network of themselves highly constrained nodes.</p>
<p id="rfc.section.1.p.2">The state of a resource on a CoAP server can change over time. We want to give CoAP clients the ability to observe this change.  However, existing approaches from the HTTP world, such as repeated polling or long-polls, generate significant complexity and/or overhead and thus are less applicable in the constrained CoAP world.  Instead, a much simpler mechanism is provided to solve the basic problem of resource observation.  Note that there is no intention for this mechanism to solve the full set of problems that the existing HTTP solutions solve, or to replace publish/subscribe networks that solve a much more general problem <a href="#RFC5989">[RFC5989]</a>.</p>
<p id="rfc.section.1.p.3">This short specification describes an architecture and a protocol design that realizes the well-known subject/observer design pattern within the REST-based environment of CoAP.</p>
<p id="rfc.section.1.p.4">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#overview" id="overview">Overview</a>
</h1>
<p id="rfc.section.2.p.1">In the subject/observer design pattern, an object, called the subject, maintains a list of interested parties, called observers, and notifies them automatically when a predefined condition, event or state change occurs. The pattern supports a clean separation between components, such as data storage and user interface.</p>
<p id="rfc.section.2.p.2">The subject typically provides a method for observers to register themselves with the subject (see <a href="#fig-design-pattern">Figure 1</a>).  The order in which observers receive notifications is not defined; the subject is free to use any method to determine the order.</p>
<div id="#rfc.figure.1"></div>
<div id="#fig-design-pattern"></div>
<pre>
Observer           Subject
   |                  |
   |     Register     |
   +-----------------&gt;|
   |                  |
   |   Notification   |
   |&lt;-----------------+
   |                  |
   |   Notification   |
   |&lt;-----------------+
   |                  |
   |   Notification   |
   |&lt;-----------------+
   |                  |
</pre>
<p id="rfc.section.2.p.3">The design pattern is realized in CoAP as follows: </p>

<dl>
<dt>Subject:</dt>
<dd style="margin-left: 8">In the context of CoAP, the subject is a resource located at some CoAP server. The state of the resource may change over time, ranging from infrequent changes to continuous state updates.</dd>
<dt>Observer:</dt>
<dd style="margin-left: 8">The observer is a CoAP client that is interested in the current state of the resource at any given time.</dd>
<dt>Observation Relationship:</dt>
<dd style="margin-left: 8">A client registers itself with a resource by sending a modified GET request to the server hosting the resource. The request causes the server to establish an observation relationship between the client and the resource. The response to the GET request supplies the client with a representation of the current resource state.</dd>
<dt>Notification:</dt>
<dd style="margin-left: 8">Whenever the state of a resource changes, the server notifies each client that has an observation relationship to the resource. The notification is an additional response to the GET request; it supplies the client with a representation of the new resource state. The response echoes the token specified by the client in the request, so the client can easily correlate notifications.</dd>
<dt>Lifetime:</dt>
<dd style="margin-left: 8">For robustness, an observation relationship is automatically ended after a negotiated duration of time. A client needs to refresh the relationship before the lifetime ends if it wants to be kept in the list of observers. The server includes the remaining lifetime duration in each notification.</dd>
</dl>

<p> </p>
<p><a href="#fig-example">Figure 2</a> shows an example of a CoAP client establishing an observation relationship with a resource on a CoAP server and then being notified, once upon registration and then whenever the state of the resource changes.</p>
<div id="#rfc.figure.2"></div>
<div id="#fig-example"></div>
<pre>
Client              Server
   |                  |
   | GET /temperature |
   | Lifetime: 60 sec |  (establish observation relationship)
   | Token:    0x4a   |
   +-----------------&gt;|
   |                  |
   | 2.00 OK "22.9 C" |
   | Lifetime: 60 sec |  (initial notification of current state)
   | Token:    0x4a   |
   |&lt;-----------------+
   |                  |
   | 2.00 OK "22.8 C" |
   | Lifetime: 44 sec |  (notification upon state change)
   | Token:    0x4a   |
   |&lt;-----------------+
   |                  |
   | 2.00 OK "23.1 C" |
   | Lifetime: 12 sec |  (notification upon state change)
   | Token:    0x4a   |
   |&lt;-----------------+
   |                  |
</pre>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#observations" id="observations">Observation Relationships</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#establishment" id="establishment">Establishment</a>
</h1>
<p id="rfc.section.3.1.p.1">A client registers itself with a resource by sending a GET request that includes a Lifetime Option. (See <a href="#option">Section 5</a> for the option definition.) When a server receives such a request, it satisfies the request as with a basic GET request and, upon success, establishes an observation relationship between the client and the target resource.</p>
<p id="rfc.section.3.1.p.2">The Lifetime Option indicates the duration for which the server is requested to maintain the observation relationship before it is ended. The server MUST NOT establish the relationship with a duration longer than requested, although it MAY choose to cut short the remaining lifetime upon registration (or any time while the relationship is established). The server MUST include the remaining lifetime in each response sent in reply to the GET request, including the initial response.</p>
<p id="rfc.section.3.1.p.3">A server that is unable or unwilling to establish an observation relationship between a client to a resource MUST silently ignore the Lifetime Option and process the GET request as usual. The resulting response will not include a Lifetime Option, implying that no observation relationship was established.</p>
<p id="rfc.section.3.1.p.4">The token specified by the client in the GET request will be echoed by the server in the initial response and in all notifications sent to the client during the lifetime of the observation relationship.  See <a href="#notifications">Section 4</a> for the details on notifications.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#maintenance" id="maintenance">Maintenance</a>
</h1>
<p id="rfc.section.3.2.p.1">For robustness, an observation relationship has to be maintained through periodic refreshing. If the relationship is not refreshed, it ends after the duration that is negotiated using the Lifetime Option.  A client refreshes an observation relationship by repeating the original GET request shortly before the observation lifetime ends.</p>
<p id="rfc.section.3.2.p.2">When a server receives such a repeated request (i.e. a GET request from a client for which an observation relationship already exists), it MUST NOT establish a second relationship but replace or update the existing one with the new duration.</p>
<p id="rfc.section.3.2.p.3">The exact rules for determining if two requests request to establish the same observation relationship are as follows: </p>

<ul>
<li>The request URI of the two requests MUST match.</li>
<li>The sources of the two requests MUST match. How this is determined depends on the security mode used (see Section 10 of <a href="#I-D.ietf-core-coap">[I-D.ietf-core-coap]</a>): With NoSec, the IP address and port number of the request sources must match. With other security modes, in addition to the IP address and UDP port number matching, the requests must have the same security context.</li>
<li>The Message IDs and any Token Options in the two requests MUST NOT be taken into account.</li>
</ul>

<p> </p>
<p id="rfc.section.3.2.p.4">A client MAY refresh an observation relationship at any time before the lifetime ends, for example, when it didn't receive a notification for some time. However, it is RECOMMENDED that the client does not refresh the relationship for the time specified in the Max-Age Option of the most recent notification received, including the initial response.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#termination" id="termination">Termination</a>
</h1>
<p id="rfc.section.3.3.p.1">The observation relationship between a client and a resource MUST be ended when one of the following conditions occurs: </p>

<ul>
<li>The age of the observation relationship becomes greater than the negotiated lifetime.</li>
<li>The server sends a notification response with a non-success response code (4.xx or 5.xx).</li>
<li>The client rejects a confirmable notification with a RST message.</li>
<li>The last attempt of transmitting a confirmable notification to the client times out.</li>
</ul>

<p> </p>
<p id="rfc.section.3.3.p.2">A client MAY terminate an observation relationship before its lifetime ends. It can do so by performing one of the following actions: </p>

<ul>
<li>The client rejects a confirmable notification with a RST message.  </li>
<li>The client refreshes the observation relationship with a value of 0 seconds, which will cause the server to end any observation relationship immediately after returning the initial response.</li>
</ul>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#notifications" id="notifications">Notifications</a>
</h1>
<p id="rfc.section.4.p.1">When an observation relationship is established between a client and a resource, the client is notified of resource state changes by additional responses sent in reply to the GET request to the client.  Each such notification response MUST echo the token specified in the request and specify the remaining duration for which the server maintains the observation relationship. The order in which observers are notified about a state change is not defined; the server is free to use any method to determine the order.</p>
<p id="rfc.section.4.p.2">A notification SHOULD have a 2.00 (OK) or 2.03 (Valid) response code.  However, in the event the state of a resource is changed in a way that would cause a basic GET request to return an error code (for example, when the resource is deleted), the server SHOULD notify the client with a notification with an appropriate error code and MUST end the observation relationship.</p>
<p id="rfc.section.4.p.3">The representation format (i.e. the media type) used in any notification response during the lifetime of an observation relation MUST be the same format used in the initial response to the GET request.  If the server is unable to continue sending notifications in the same representation format, it SHOULD send a 5.00 (Internal Server Error) notification response and MUST end the observation relationship.</p>
<p id="rfc.section.4.p.4">A notification may be confirmable or non-confirmable, and the server can employ different strategies in how it notifies a client; see <a href="#strategies">Section 4.1</a> below. The objective is that the state observed by the client eventually becomes consistent with the actual state of the resource.</p>
<p id="rfc.section.4.p.5">If a client does not recognize the token in a confirmable notification, it SHOULD reject the message with a RST message (in which case the server MUST end the observation). Otherwise, the client MUST acknowledge the message with an ACK message as normal. See <a href="#retransmission">Section 4.2</a> for details on the retransmission of confirmable messages.</p>
<p id="rfc.section.4.p.6">Note that notifications may arrive in a different order than sent by the server due to network latency. A client must be prepared to receive notifications before the initial response to a GET request, after an error notification or after the client has requested the server to end the observation relationship. See <a href="#reordering">Section 4.3</a> for further details on message reordering.</p>
<p id="rfc.section.4.p.7">Notifications MAY be cached by CoAP end-points. This is detailed in <a href="#caching">Section 4.4</a>.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#strategies" id="strategies">Strategies</a>
</h1>
<p id="rfc.section.4.1.p.1">The objective when notifying clients of state changes is that the state observed by the client eventually becomes consistent with the actual state of the resource. This allows the server some liberties in how it sends notifications, as long as it works towards the objective.</p>
<p id="rfc.section.4.1.p.2">A notification may be sent confirmable or non-confirmable. The message type used is typically application-dependent and MAY be determined by the server for each notification individually. For example, for resources that change in a somewhat predictable or regular fashion, notifications can be sent in non-confirmable messages. For resources that change infrequently, notifications can be sent in confirmable messages. The server can combine these two approaches depending on the frequency of state changes and the importance of individual notifications.</p>
<p id="rfc.section.4.1.p.3">A server MAY choose to omit notifying a client of a state change if it knows that it will send another notification soon (e.g., when the state is changing frequently or maybe even continuously). Similarly, it MAY choose to notify a client about the same state change more than once. For example, when state changes occur in bursts, the server can omit some notifications, send the others in non-confirmable messages, and make sure that the client observes the latest state change by repeating the last notification in a confirmable message.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#retransmission" id="retransmission">Retransmission</a>
</h1>
<p id="rfc.section.4.2.p.1">According to the core CoAP protocol, confirmable messages are retransmitted in exponentially increasing intervals for a certain number of attempts until they are acknowledged by the client. In the context of observing a resource, it is undesirable to continue transmitting the representation of a resource state when the state changed in the meantime. There are many reasons why a client might not acknowledge a confirmable message, ranging from short interruptions in the network to a permanent failure of the client.</p>
<p id="rfc.section.4.2.p.2">When a server is retransmitting a confirmable message with a notification, waiting for an acknowledgement, and wants to notify the client of a state change using a new confirmable message, it MUST stop retransmitting the old notification and MUST attempt to transmit the new notification with the number of attempts remaining from the old notification. When the last attempt to retransmit a confirmable message with a notification for a resource times out, the observation relationship is ended.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#reordering" id="reordering">Reordering</a>
</h1>
<p id="rfc.section.4.3.p.1">Messages with notifications can arrive in a different order than they were sent. Since the objective is eventual consistency, a client can safely discard a notification that arrives later than a newer notification. For this purpose, the remaining lifetime indicated by notifications as a result of an observation request MUST be strictly decreasing and the client SHOULD specify a token in a refresh request that is different from the token in the previous request.</p>
<p id="rfc.section.4.3.p.2">A client MAY discard a notification under the following conditions: </p>

<ul>
<li>The client receives a notification with a token other than that specified in the most recent request.</li>
<li>The client receives a notification with the right token but also with an indicated remaining lifetime duration longer than the duration specified in the previous notification.</li>
</ul>

<p> </p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#caching" id="caching">Caching</a>
</h1>
<p id="rfc.section.4.4.p.1">As notifications are just additional responses to a GET request, the same rules on caching apply as to basic responses: CoAP end-points MAY cache the responses and thereby reduce the response time and network bandwidth consumption. Both the freshness model and the validation model are supported.</p>
<p id="rfc.section.4.4.p.2">When a response is fresh in the cache, GET requests can be satisfied without contacting the origin server. The observation mechanism ensures that the cache has a fresh response for most of the duration of the observation lifetime. This is particularly useful when the cache is located at an CoAP intermediary such as a proxy or reverse proxy.  (Note that the freshness of the stored response is determined by its Max-Age Option, not the existence of an observation relationship. So a request can cause the end-point to refresh cache and observation relationship even while having an relationship.)</p>
<p id="rfc.section.4.4.p.3">When an end-point has one or more responses stored, it can use the Etag Option to give the origin server an opportunity to select a stored response to be used. The end-point SHOULD add an Etag Option specifying the entity-tag of each stored response that is applicable.  It MUST keep those responses in the cache until the observation lifetime ends, the relationship is terminated or a refresh request with a new set of entity-tags is. When the observed resource changes its state and the origin server is about to send a 2.00 (OK) notification, then, whenever that notification has an entity-tag in the set of entity-tags specified by the client, it sends a 2.03 (Valid) response with an appropriate Etag Option instead. The server MUST NOT assume that the recipient has any response stored other than those identified by the entity-tags in the most recent observation request.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#option" id="option">Lifetime Option</a>
</h1>
<div id="#rfc.table.1"></div>
<div id="#options"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Options</caption>
<thead><tr>
<th class="right">No.</th>
<th class="left">C/E</th>
<th class="left">Name</th>
<th class="left">Format</th>
<th class="left">Length</th>
<th class="left">Default</th>
</tr></thead>
<tbody><tr>
<td class="right">10</td>
<td class="left">Elective</td>
<td class="left">Lifetime</td>
<td class="left">uint</td>
<td class="left">1-4 B</td>
<td class="left">0</td>
</tr></tbody>
</table>
<p id="rfc.section.5.p.1">The Lifetime Option, when present, modifies the GET method so it does not only retrieve a representation of the current state of the resource identified by the request URI once, but also lets the server notify the client of changes to the resource state for the duration specified in the option.</p>
<p id="rfc.section.5.p.2">In a response, the Lifetime Option indicates a lower bound (e.g., by rounding down) for the remaining observation lifetime.  (Note that the server can always choose to cut short the observation lifetime before it echoes this lifetime back in a response.)</p>
<p id="rfc.section.5.p.3">The option's value is encoded as a variable-length unsigned integer (see Appendix A of <a href="#I-D.ietf-core-coap">[I-D.ietf-core-coap]</a>) that indicates a duration of time measured in seconds.</p>
<p id="rfc.section.5.p.4">Note that a Lifetime value of 0 is indicated by leaving out the Lifetime option, which then defaults to 0.</p>
<p id="rfc.section.5.p.5">Since the Lifetime Option is elective, a GET request that includes the Lifetime Option will automatically fall back to a basic GET request if the server does not support observations.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#interactions" id="interactions">Interactions with other CoAP features</a>
</h1>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#methods" id="methods">Request Methods</a>
</h1>
<p id="rfc.section.6.1.p.1">If a client has an observation relationship with a resource and performs a POST, PUT or DELETE request on that resource, the request MUST NOT affect the observation relationship. However, since such a request can affect the observed resource, it can cause the server to send a notification with a resource state representation or end the observation relationship with an error notification (e.g., when a DELETE request is successful and the observed resource no longer exists).</p>
<p id="rfc.section.6.1.p.2">Note that a client cannot perform a GET request on a resource to get a representation of the current resource state without affecting the lifetime of an existing observation relation to that resource: the client is already notified by the server with a fresh representation whenever the state changes. If the client wants to make sure that is has a fresh representation and wants to continue being notified, it should refresh the observation relationship as described in <a href="#maintenance">Section 3.2</a>. If the client wants to make sure it has a fresh representation and does not want to continue being notified, it should perform a GET request with a lifetime duration of 0 seconds as described in <a href="#termination">Section 3.3</a>.  </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> <a href="#block" id="block">Block-wise Transfers</a>
</h1>
<p id="rfc.section.6.2.p.1">Resources that are the subject of an observation relationship may be larger than can be comfortably processed or transferred in one CoAP message.  CoAP provides a block-wise transfer mechanism to address this problem <a href="#I-D.ietf-core-block">[I-D.ietf-core-block]</a>.  The following rules apply to the combination of block-wise transfers with notifications:</p>
<p></p>

<ul>
<li>As with basic GET transfers, the client can indicate its desired block size in a Block option in the GET request.  If it implements Block, the server SHOULD take note of the block size not just for the initial response but also for further notifications in this observation relationship.</li>
<li>Notification responses can make use of the Block option.  With increasing block numbers, the Lifetime option value MUST stay the same or decrease.  The client SHOULD use the Lifetime information from the last block.  All blocks in a notification response SHOULD also carry an Etag option to ensure they are reassembled correctly.</li>
</ul>

<p> </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> <a href="#discovery" id="discovery">Resource Discovery</a>
</h1>
<p id="rfc.section.6.3.p.1">Clients can discover interesting resources to observe using CoRE Resource Discovery <a href="#I-D.ietf-core-link-format">[I-D.ietf-core-link-format]</a>. Links with the "obs" attribute indicate resources that MUST support the mechanism in this document and are RECOMMENDED to change their state at least once in a while.</p>
<p id="rfc.section.6.3.p.2">The "obs" attribute is used as a flag, and thus it has no value component. The attribute MUST NOT appear more than once in a link.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#security" id="security">Security Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The security considerations of the base protocol <a href="#I-D.ietf-core-coap">[I-D.ietf-core-coap]</a> apply.</p>
<p id="rfc.section.7.p.2">Note that the considerations about amplification attacks are somewhat amplified in an observation relationship.  In NoSec mode, a server MUST therefore strictly limit the number of messages generated from an observation relationship that it sends between receiving packets that confirm the actual interest of the recipient in the data; i.e., any notifications sent in Non-Confirmable messages MUST be interspersed with Confirmable messages.  (An Attacker may still spoof the acknowledgements if the Confirmable messages are sufficiently predictable.)</p>
<p id="rfc.section.7.p.3">As with any protocol that creates state, attackers may attempt to exhaust the resources that the server has available for maintaining observation relationships.  Servers MAY want to access-control this creation of state.  As degraded behavior, the server can always fall back to a basic GET (no Lifetime option) if it is unwilling or unable to establish the observation relationship, including if resources for state are exhausted or nearing exhaustion. </p>
<p id="rfc.section.7.p.4">Intermediaries MUST be careful to ensure that notifications cannot be employed to create a loop.  A simple way to break any loops is to employ caches for forwarding notifications in intermediaries.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#iana-considerations" id="iana-considerations">IANA Considerations</a>
</h1>
<p id="rfc.section.8.p.1">The following entry is added to the CoAP Option Numbers registry:</p>
<div id="#rfc.table.2"></div>
<div id="#tab-option-registry"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>New CoAP Option Numbers</caption>
<thead><tr>
<th class="right">Number</th>
<th class="left">Name</th>
<th class="left">Reference</th>
</tr></thead>
<tbody><tr>
<td class="right">10</td>
<td class="left">Lifetime</td>
<td class="left">[RFCXXXX]</td>
</tr></tbody>
</table>
<p id="rfc.section.8.p.2">The following entry is added to the CoRE Target Attribute registry: </p>
<div id="#rfc.table.3"></div>
<div id="#tab-target-attribute-registry"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>New CoRE Target Attributes</caption>
<thead><tr>
<th class="left">Name</th>
<th class="left">Reference</th>
</tr></thead>
<tbody><tr>
<td class="left">obs</td>
<td class="left">[RFCXXXX]</td>
</tr></tbody>
</table>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#acknowledgements" id="acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.9.p.1">Carsten Bormann was an original author of this draft and is acknowledged for significant contribution to this document.</p>
<p id="rfc.section.9.p.2">Klaus Hartke was funded by the Klaus Tschira Foundation.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-coap">[I-D.ietf-core-coap]</b></td>
<td class="top">
<a>Shelby, Z</a>, <a>Hartke, K</a>, <a>Bormann, C</a> and <a>B Frank</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-coap-04">Constrained Application Protocol (CoAP)</a>", Internet-Draft draft-ietf-core-coap-04, January 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-link-format">[I-D.ietf-core-link-format]</b></td>
<td class="top">
<a>Shelby, Z</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-link-format-02">CoRE Link Format</a>", Internet-Draft draft-ietf-core-link-format-02, December 2010.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-core-block">[I-D.ietf-core-block]</b></td>
<td class="top">
<a>Shelby, Z</a> and <a>C Bormann</a>, "<a href="http://tools.ietf.org/html/draft-ietf-core-block-01">Blockwise transfers in CoAP</a>", Internet-Draft draft-ietf-core-block-01, January 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="World Wide Web Consortium">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="World Wide Web Consortium">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="World Wide Web Consortium">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5989">[RFC5989]</b></td>
<td class="top">
<a>Roach, A.B.</a>, "<a href="http://tools.ietf.org/html/rfc5989">A SIP Event Package for Subscribing to Changes to an HTTP Resource</a>", RFC 5989, October 2010.</td>
</tr>
<tr>
<td class="reference"><b id="REST">[REST]</b></td>
<td class="top">
<a title="University of California, Irvine">Fielding, R</a>, "<a>Architectural Styles and the Design of Network-based Software Architectures</a>", 2000.<p>(Seminal dissertation introducing the REST architectural style.)</p>
</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#examples" id="examples">Examples</a>
</h1>
<div id="#rfc.figure.3"></div>
<div id="#fig-example-1"></div>
<pre>
Client  Server
   |      |
   |      |
   +-----&gt;|   Header:    GET (T=CON, Code=1, MID=0x1633)
   | GET  |   Token:     0x4a
   |      |   Uri:       coap://sensor.example/temperature
   |      |   Lifetime:  60sec
   |      |
   |      |
   |&lt;-----+   Header:    2.00 OK (T=ACK, Code=64, MID=0x1633)
   | 2.00 |   Token:     0x4a
   |      |   Lifetime:  60sec
   |      |   Payload:   "22.9 C"
   |      |
   |      |
   |&lt;-----+   Header:    2.00 OK (T=NON, Code=64, MID=0x7b50)
   | 2.00 |   Token:     0x4a
   |      |   Lifetime:  59sec
   |      |   Payload:   "22.8 C"
   |      |
   |      |
   |&lt;-----+   Header:    2.00 OK (T=NON, Code=64, MID=0x7b51)
   | 2.00 |   Token:     0x4a
   |      |   Lifetime:  58sec
   |      |   Payload:   "22.5 C"
   |      |
</pre>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> <a href="#proxying" id="proxying">Proxying</a>
</h1>
<div id="#rfc.figure.4"></div>
<div id="#fig-example-4"></div>
<pre>
Client  Proxy  Server
   |      |      |
   |      |      |
   |      +-----&gt;|   Header:    GET (T=CON, Code=1, MID=0x5fb8)
   |      | GET  |   Token:     0x1a
   |      |      |   Uri:       coap://sensor.example/status
   |      |      |   Lifetime:  3600 sec
   |      |      |
   |      |      |
   |      |&lt;-----+   Header:    2.00 OK (T=ACK, Code=64, MID=0x5fb8)
   |      | 2.00 |   Token:     0x1a
   |      |      |   Lifetime:  3600 sec
   |      |      |   Max-Age    120 sec
   |      |      |   Payload:   "ready"
   |      |      |
   |      |      |
   +-----&gt;|      |   Header:    GET (T=CON, Code=1, MID=0x1633)
   | GET  |      |   Token:     0x9a
   |      |      |   Proxy-Uri: coap://sensor.example/status
   |      |      |
   |      |      |
   |&lt;-----+      |   Header:    2.00 OK (T=ACK, Code=1, MID=0x1633)
   | 2.00 |      |   Token:     0x9a
   |      |      |   Max-Age:   113 sec
   |      |      |   Payload:   "ready"
   |      |      |
   |      |      |
   |      |&lt;-----+   Header:    2.00 OK (T=NON, Code=64, MID=0x5fc0)
   |      | 2.00 |   Token:     0x1a
   |      |      |   Lifetime:  1780 sec
   |      |      |   Max-Age:   120 sec
   |      |      |   Payload:   "busy"
   |      |      |
   |      |      |
   +-----&gt;|      |   Header:    GET (T=CON, Code=1, MID=0x1634)
   | GET  |      |   Token:     0x9b
   |      |      |   Proxy-Uri: coap://sensor.example/status
   |      |      |
   |      |      |
   |&lt;-----+      |   Header:    2.00 OK (T=ACK, Code=1, MID=0x1634)
   | 2.00 |      |   Token:     0x9b
   |      |      |   Max-Age:   89 sec
   |      |      |   Payload:   "busy"
   |      |      |
</pre>
<div id="#rfc.figure.5"></div>
<div id="#fig-example-5"></div>
<pre>
Client  Proxy  Server
   |      |      |
   |      |      |
   +-----&gt;|      |   Header:    (T=CON, Code=1, MID=0x1633)
   | GET  |      |   Token:     0x6a
   |      |      |   Proxy-Uri: coap://sensor.example/status
   |      |      |   Lifetime:  360 sec
   |      |      |
   |      |      |
   |&lt; - - +      |   Header:    (T=ACK, Code=0, MID=0x1633)
   |      |      |
   |      |      |
   |      +-----&gt;|   Header:    GET (T=CON, Code=1, MID=0xaf90)
   |      | GET  |   Token:     0xaa
   |      |      |   Uri:       coap://sensor.example/status
   |      |      |   Lifetime:  1800 sec
   |      |      |
   |      |      |
   |      |&lt;-----+   Header:    2.00 (T=ACK, Code=64, MID=0xaf90)
   |      | 2.00 |   Token:     0xaa
   |      |      |   Lifetime:  1800 sec
   |      |      |   Payload:   "ready"
   |      |      |
   |      |      |
   |&lt;-----+      |   Header:    2.00 (T=CON, Code=64, MID=0xaf94)
   | 2.00 |      |   Token:     0x6a
   |      |      |   Lifetime:  346 sec
   |      |      |   Payload:   "ready"
   |      |      |
   |      |      |
   + - - &gt;|      |   Header:    (T=ACK, Code=0, MID=0x...)
   |      |      |
   |      |      |
   |      |&lt;-----+   Header:    2.00 (T=CON, Code=64, MID=0x5a20)
   |      | 2.00 |   Token:     0xaa
   |      |      |   Lifetime:  1460 sec
   |      |      |   Payload:   "busy"
   |      |      |
   |      |      |
   |      + - - &gt;|   Header:    (T=ACK, Code=0, MID=0x5a20)
   |      |      |
   |      |      |
   |&lt;-----+      |   Header:    2.00 (T=CON, Code=64, MID=0xaf9b)
   | 2.00 |      |   Token:     0x6a
   |      |      |   Lifetime:  6 sec
   |      |      |   Payload:   "busy"
   |      |      |
   |      |      |
   + - - &gt;|      |   Header:    (T=ACK, Code=0, MID=0xaf9b)
   |      |      |
</pre>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> <a href="#changelog" id="changelog">Changelog</a>
</h1>
<p id="rfc.section.Appendix B.p.1">Changes from ietf-00 to ietf-01: </p>

<ul>
<li>Name of the option is now simply "Lifetime".</li>
<li>Terminology changed from "subscriptions" to "observation relationships" (#33).</li>
<li>Clarified establishment of observation relationships.</li>
<li>Clarified that an observation is only identified by the URI of the observed resource and the identity of the client (#66).</li>
<li>Clarified rules for establishing observation relationships (#68).</li>
<li>Clarified conditions under which an observation relationship is terminated.</li>
<li>Added explanation on how clients can terminate an observation relationship before the lifetime ends (#34).</li>
<li>Clarified that the overriding objective for notifications is eventual consistency of the actual and the observed state (#67).</li>
<li>Specified how a server needs to deal with clients not acknowledging confirmable messages carrying notifications (#69).</li>
<li>Added a mechanism to detect message reordering (#35).</li>
<li>Added an explanation of how notifications can be cached, supporting both the freshness and the validation model (#39, #64).</li>
<li>Clarified that non-GET requests do not affect observation relationships, and that GET requests without Lifetime Option affecting relationships is by design (#65).</li>
<li>Described interaction with block-wise transfers (#36).</li>
<li>Added Resource Discovery section (#99).</li>
<li>Added IANA Considerations.</li>
<li>Added Security Considerations (#40).</li>
<li>Added examples (#38).</li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Klaus Hartke</span> 
	  <span class="n hidden">
		<span class="family-name">Hartke</span>
	  </span>
	</span>
	<span class="org vcardline">Universitaet Bremen TZI</span>
	<span class="adr">
	  <span>Postfach 330440</span>

	  <span class="vcardline">
		<span class="locality">Bremen</span>,  
		<span class="region"></span>
		<span class="code">D-28359</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49-421-218-63905</span>

<span class="vcardline">EMail: <a href="mailto:hartke@tzi.org">hartke@tzi.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Zach Shelby</span> 
	  <span class="n hidden">
		<span class="family-name">Shelby</span>
	  </span>
	</span>
	<span class="org vcardline">Sensinode</span>
	<span class="adr">
	  <span>Kidekuja 2</span>

	  <span class="vcardline">
		<span class="locality">Vuokatti</span>,  
		<span class="region"></span>
		<span class="code">88600</span>
	  </span>
	  <span class="country-name vcardline">Finland</span>
	</span>
	<span class="vcardline">Phone: +358407796297</span>

<span class="vcardline">EMail: <a href="mailto:zach@sensinode.com">zach@sensinode.com</a></span>

  </address>
</div>

</body>
</html>