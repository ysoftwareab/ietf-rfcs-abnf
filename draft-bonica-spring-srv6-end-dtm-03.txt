



SPRING Working Group                                            S. Hegde
Internet-Draft                                                 R. Bonica
Intended status: Standards Track                        Juniper Networks
Expires: August 16, 2021                                       P. Shaofu
                                                               G. Mirsky
                                                                Z. Zhang
                                                         ZTE Corporation
                                                       February 12, 2021


                   The SRv6 END.DTM Endpoint Behavior
                  draft-bonica-spring-srv6-end-dtm-03

Abstract

   This document describes a new SRv6 endpoint behavior, called END.DTM.
   END.DTM supports inter-working between SRv6 and SR-MPLS.  Like any
   endpoint behavior, END.DTM contains a function and arguments.  The
   function causes the processing node to decapsulate a packet, impose
   an SR-MPLS label stack and forward the packet.  The arguments
   determine SR-MPLS label stack contents.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on August 16, 2021.

Copyright Notice

   Copyright (c) 2021 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents



Hegde, et al.            Expires August 16, 2021                [Page 1]

Internet-Draft                   END.DTM                   February 2021


   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Overview  . . . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Requirements Language . . . . . . . . . . . . . . . . . . . .   3
   3.  Use-case  . . . . . . . . . . . . . . . . . . . . . . . . . .   3
   4.  Processing  . . . . . . . . . . . . . . . . . . . . . . . . .   4
   5.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   5
   6.  Security Considerations . . . . . . . . . . . . . . . . . . .   5
   7.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   5
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .   5
     8.1.  Normative References  . . . . . . . . . . . . . . . . . .   6
     8.2.  Informative References  . . . . . . . . . . . . . . . . .   6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   7

1.  Overview

   Segment Routing (SR) [RFC8402] allows source nodes to steer packets
   through SR paths.  It can be implemented over IPv6 [RFC8200] or MPLS
   [RFC3031].  When SR is implemented over IPv6, it is called SRv6
   [I-D.ietf-spring-srv6-network-programming].  When SR is implemented
   over MPLS, it is called SR-MPLS [RFC8660].

   This document describes a new SRv6 endpoint behavior, called END.DTM.
   END.DTM supports inter-working between SRv6 and SR-MPLS.  Like any
   endpoint behavior, END.DTM contains a function and arguments.  The
   function causes the processing node to:

   o  Decapsulate a packet (i.e., remove an IPv6 header and its
      extensions).

   o  Impose an SR-MPLS label stack.

   o  Forward the packet.

   The arguments determine MPLS-label stack contents and anything that
   might be encoded in the MPLS-label stack (e.g., transport class
   [I-D.hegde-spring-mpls-seamless-sr])








Hegde, et al.            Expires August 16, 2021                [Page 2]

Internet-Draft                   END.DTM                   February 2021


2.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 [RFC2119] [RFC8174] when, and only when, they appear in all
   capitals, as shown here.

3.  Use-case

        ------       ------       ------       ------       ------
       |Node 1| --- |Node 2| --- |Node 3| --- |Node 4| --- |Node 5|
        ------       ------       ------       ------       ------

                       Seg. A     Seg. B       Seg. C       Seg. D

        <-----------SRv6 Part ----------><-------SR-MPLS Part------>

                        Figure 1: END.DTM Use-case

   Figure 1 depicts an inter-working SR path.  The SR path originates on
   Node 1 and terminates on Node 5.  It contains:

   o  An SRv6 part

   o  An SR-MPLS part

   The SRv6 part includes Nodes 1, 2 and 3.  These nodes MUST be
   SRv6-capable but are NOT REQUIRED to be SR-MPLS capable.  An END.DTM
   segment is instantiated on Node 3.  Therefore, Node 3 MUST be able to
   push an SR-MPLS label stack and process its uppermost entry.
   However, it is NOT REQUIRED to process incoming MPLS labels.

   The SRv6 part also includes:

   o  Segment A - An END segment that is instantiated on Node 2.

   o  Segment B - An END.DTM segment that is instantiated on Node 3.

   The SR-MPLS part includes Nodes 4 and 5.  These nodes MUST be SR-
   MPLS-capable but are NOT REQUIRED to be SRv6 capable.

   The SR-MPLS part also includes:

   o  Segment C - A prefix segment that is instantiated on Node 4.

   o  Segment D - A prefix segment that is instantiated on Node 5.




Hegde, et al.            Expires August 16, 2021                [Page 3]

Internet-Draft                   END.DTM                   February 2021


   The following paragraphs describe how a packet traverses this inter-
   working SR path:

   Node 1 encapsulates the packet in an SRv6 header.  The SRv6 header
   contains the following Segment Identifiers (SID):

   o  A SID representing Segment A, encoded in the Destination Address
      field of the IPv6 header.

   o  A SID representing Segment B, encoded in a Segment Routing Header
      (SRH) [RFC8754].

   Node 1 sends the packet to Node 2.  When the packet arrives at Node
   2, The Destination Address field in the IPv6 header represents a
   locally instantiated END SID.  Node 2 processes the packet as
   follows:

   o  Decrement the Segments Left field in the SRH

   o  Copy the next SID from the SRH to the Destination Address field of
      the IPv6 header.

   o  Forward the packet to Node 3.

   When the packet arrives at Node 3, The Destination Address field in
   the IPv6 header represents a locally instantiated END.DTM SID.  Node
   3 processes the packet as follows:

   o  Decapsulate the packet (i.e., remove the IPv6 header and its
      extensions, including the SRH)

   o  Push two SR-MPLS label stack entries, representing Segments D and
      C.  Set the MPLS Traffic Class and TTL values to reflect the
      Traffic Class and Hop count values received in the IPv6 header.

   o  Forward the packet to Node 4.

   When the packet arrives at Node 4, it is encapsulated in an SR-MPLS
   label stack.  Node 4 processes the packet as described in SR-MPLS
   [RFC8660].

4.  Processing

   The End.DTM SID MUST be the last segment in a SR Policy.  Its
   arguments are associated with an SR-MPLS label stack.

   When Node N receives a packet destined to S and S is a locally
   instantiated End.DTM SID, Node N executes the following procedure:



Hegde, et al.            Expires August 16, 2021                [Page 4]

Internet-Draft                   END.DTM                   February 2021


   S01. When an IPv6 Routing Header is processed {
   S02.   If (Segments Left != 0) {
   S03.      Send an ICMP Parameter Problem to the Source Address,
                Code 0 (Erroneous header field encountered),
                Pointer set to the Segments Left field,
                interrupt packet processing and discard the packet.
   S04.   }
   S05.   Proceed to process the next header in the packet
   S06. }


   When processing the Upper-layer header of a packet matching a FIB
   entry locally instantiated as an End.DTM SID, N executes the following
   procedure:

   S01. Decapsulate the packet (i.e., remove the outer IPv6 Header and all
        its extension headers)
   S02. Push the SR-MPLS label stack that is associated with the END.DTM
        arguments. Set the MPLS Traffic Class and TTL values to reflect
        the Traffic Class and Hop count values received in the IPv6 header.
   S03. Submit the packet to the MPLS FIB lookup for transmission to the
        new destination

5.  IANA Considerations

   This document requires no IANA action.

   The authors will request an early allocation from the "SRv6 Endpoint
   Behaviors" sub-registry of the "Segment Routing Parameters" registry.

6.  Security Considerations

   Because SR inter-working requires co-operation between inter-working
   domains, this document introduces no security consideration beyond
   those addressed in [RFC8402], [RFC8754] and
   [I-D.ietf-spring-srv6-network-programming].

7.  Acknowledgements

   Thanks to Bruno Decraene, Takuya Miyasaka and Jeff Tantsura for their
   comments.

8.  References








Hegde, et al.            Expires August 16, 2021                [Page 5]

Internet-Draft                   END.DTM                   February 2021


8.1.  Normative References

   [I-D.ietf-spring-srv6-network-programming]
              Filsfils, C., Camarillo, P., Leddy, J., Voyer, D.,
              Matsushima, S., and Z. Li, "SRv6 Network Programming",
              draft-ietf-spring-srv6-network-programming-28 (work in
              progress), December 2020.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

   [RFC8200]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", STD 86, RFC 8200,
              DOI 10.17487/RFC8200, July 2017,
              <https://www.rfc-editor.org/info/rfc8200>.

   [RFC8402]  Filsfils, C., Ed., Previdi, S., Ed., Ginsberg, L.,
              Decraene, B., Litkowski, S., and R. Shakir, "Segment
              Routing Architecture", RFC 8402, DOI 10.17487/RFC8402,
              July 2018, <https://www.rfc-editor.org/info/rfc8402>.

   [RFC8660]  Bashandy, A., Ed., Filsfils, C., Ed., Previdi, S.,
              Decraene, B., Litkowski, S., and R. Shakir, "Segment
              Routing with the MPLS Data Plane", RFC 8660,
              DOI 10.17487/RFC8660, December 2019,
              <https://www.rfc-editor.org/info/rfc8660>.

   [RFC8754]  Filsfils, C., Ed., Dukes, D., Ed., Previdi, S., Leddy, J.,
              Matsushima, S., and D. Voyer, "IPv6 Segment Routing Header
              (SRH)", RFC 8754, DOI 10.17487/RFC8754, March 2020,
              <https://www.rfc-editor.org/info/rfc8754>.

8.2.  Informative References

   [I-D.hegde-spring-mpls-seamless-sr]
              Hegde, S., Bowers, C., Xu, X., Gulko, A., Bogdanov, A.,
              Uttaro, J., Jalil, L., Khaddam, M., and A. Alston,
              "Seamless Segment Routing", draft-hegde-spring-mpls-
              seamless-sr-04 (work in progress), January 2021.






Hegde, et al.            Expires August 16, 2021                [Page 6]

Internet-Draft                   END.DTM                   February 2021


   [RFC3031]  Rosen, E., Viswanathan, A., and R. Callon, "Multiprotocol
              Label Switching Architecture", RFC 3031,
              DOI 10.17487/RFC3031, January 2001,
              <https://www.rfc-editor.org/info/rfc3031>.

Authors' Addresses

   Shraddha Hegde
   Juniper Networks
   Embassy Business Park
   Bangalore, KA  560093
   India

   Email: shraddha@juniper.net


   Ron Bonica
   Juniper Networks
   Herndon, Virginia  20171
   USA

   Email: rbonica@juniper.net


   Peng Shaofu
   ZTE Corporation
   Peoples Republic of China

   Email: peng.shaofu@zte.com.cn


   Greg Mirsky
   ZTE Corporation
   USA

   Email: gregimirsky@gmail.com


   Zheng Zhang
   ZTE Corporation
   Peoples Republic of China

   Email: zhang.zheng@zte.com.cn








Hegde, et al.            Expires August 16, 2021                [Page 7]
