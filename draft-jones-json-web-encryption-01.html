<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>JSON Web Encryption (JWE)</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 JSON Web Encryption (JWE) Overview">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Example JWE">
<link href="#rfc.section.4" rel="Chapter" title="4 JWE Header">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Reserved Header Parameter Names">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Public Header Parameter Names">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Private Header Parameter Names">
<link href="#rfc.section.5" rel="Chapter" title="5 Message Encryption">
<link href="#rfc.section.6" rel="Chapter" title="6 Message Decryption">
<link href="#rfc.section.7" rel="Chapter" title="7 CEK Encryption">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Asymmetric Encryption">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Symmetric Encryption">
<link href="#rfc.section.8" rel="Chapter" title="8 Composition">
<link href="#rfc.section.9" rel="Chapter" title="9 Encrypting JWEs with Cryptographic Algorithms">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Encrypting a JWE with TBD">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Additional Algorithms">
<link href="#rfc.section.10" rel="Chapter" title="10 IANA Considerations">
<link href="#rfc.section.11" rel="Chapter" title="11 Security Considerations">
<link href="#rfc.section.11.1" rel="Chapter" title="11.1 Unicode Comparison Security Issues">
<link href="#rfc.section.12" rel="Chapter" title="12 Open Issues and Things To Be Done (TBD)">
<link href="#rfc.references" rel="Chapter" title="13 References">
<link href="#rfc.references.1" rel="Chapter" title="13.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="13.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A JWE Examples">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 JWE Example using TBD Algorithm">
<link href="#rfc.appendix.Appendix%20A.1.1" rel="Chapter" title="Appendix A.1.1 Encrypting">
<link href="#rfc.appendix.Appendix%20A.1.2" rel="Chapter" title="Appendix A.1.2 Decrypting">
<link href="#rfc.appendix.Appendix%20B" rel="Chapter" title="Appendix B Algorithm Identifier Cross-Reference">
<link href="#rfc.appendix.Appendix%20C" rel="Chapter" title="Appendix C Acknowledgements">
<link href="#rfc.appendix.Appendix%20D" rel="Chapter" title="Appendix D Document History">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="JSON Web Encryption (JWE) is a means of representing encrypted content using JSON data structures.  Related signature capabilities are described in the separate JSON Web Signature (JWS) specification.  " />
  <meta name="description" content="JSON Web Encryption (JWE) is a means of representing encrypted content using JSON data structures.  Related signature capabilities are described in the separate JSON Web Signature (JWS) specification.  " />
  <meta name="keywords" content="RFC, Request for Comments, I-D, Internet-Draft, Assertion, Simple Web Token, Security Token, SWT, JavaScript Object Notation, JSON, JSON Web Token, JWT, JSON Web Signature, JWS, JSON Web Encryption, JWE, JSON Web Key, JWK" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">M.B. Jones</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Microsoft</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">E. Rescorla</td>
</tr>
<tr>
<td class="left">Expires: May 03, 2012</td>
<td class="right">RTFM, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">J. Hildebrand</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Cisco Systems, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">October 31, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">JSON Web Encryption (JWE)<br />
  <span class="filename">draft-jones-json-web-encryption-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>JSON Web Encryption (JWE) is a means of representing encrypted content using JSON data structures.  Related signature capabilities are described in the separate JSON Web Signature (JWS) specification.  </p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 03, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">JSON Web Encryption (JWE) Overview</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Example JWE</a>
</li>
<li>4.   <a href="#rfc.section.4">JWE Header</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Reserved Header Parameter Names</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Public Header Parameter Names</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Private Header Parameter Names</a>
</li>
<li>5.   <a href="#rfc.section.5">Message Encryption</a>
</li>
<li>6.   <a href="#rfc.section.6">Message Decryption</a>
</li>
<li>7.   <a href="#rfc.section.7">CEK Encryption</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Asymmetric Encryption</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Symmetric Encryption</a>
</li>
<li>8.   <a href="#rfc.section.8">Composition</a>
</li>
<li>9.   <a href="#rfc.section.9">Encrypting JWEs with Cryptographic Algorithms</a>
</li>
<li>9.1.   <a href="#rfc.section.9.1">Encrypting a JWE with TBD</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">Additional Algorithms</a>
</li>
<li>10.   <a href="#rfc.section.10">IANA Considerations</a>
</li>
<li>11.   <a href="#rfc.section.11">Security Considerations</a>
</li>
<li>11.1.   <a href="#rfc.section.11.1">Unicode Comparison Security Issues</a>
</li>
<li>12.   <a href="#rfc.section.12">Open Issues and Things To Be Done (TBD)</a>
</li>
<li>13.   <a href="#rfc.references">References</a>
</li>
<li>13.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>13.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">JWE Examples</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">JWE Example using TBD Algorithm</a>
</li>
<li>Appendix A.1.1.   <a href="#rfc.appendix.Appendix%20A.1.1">Encrypting</a>
</li>
<li>Appendix A.1.2.   <a href="#rfc.appendix.Appendix%20A.1.2">Decrypting</a>
</li>
<li>Appendix B.   <a href="#rfc.appendix.Appendix%20B">Algorithm Identifier Cross-Reference</a>
</li>
<li>Appendix C.   <a href="#rfc.appendix.Appendix%20C">Acknowledgements</a>
</li>
<li>Appendix D.   <a href="#rfc.appendix.Appendix%20D">Document History</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">JSON Web Encryption (JWE) is a compact encryption format intended for space constrained environments such as HTTP Authorization headers and URI query parameters.  It provides a wrapper for encrypted content using JSON <a href="#RFC4627">RFC 4627</a> <cite title="NONE">[RFC4627]</cite> data structures.  The JWE encryption mechanisms are independent of the type of content being encrypted.  A related signature capability is described in a separate JSON Web Signature (JWS) <a href="#JWS">[JWS]</a> specification.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p></p>

<dl>
<dt>JSON Web Encryption (JWE)</dt>
<dd style="margin-left: 8">A data structure representing an encrypted version of a Plaintext.  The structure consists of three parts: the JWE Header, the JWE Encrypted Key, and the JWE Ciphertext.  </dd>
<dt>Plaintext</dt>
<dd style="margin-left: 8">The bytes to be encrypted - a.k.a., the message.  </dd>
<dt>Ciphertext</dt>
<dd style="margin-left: 8">The encrypted version of the Plaintext.  </dd>
<dt>Content Encryption Key (CEK)</dt>
<dd style="margin-left: 8">A symmetric key generated to encrypt the Plaintext for the recipient to produce the Ciphertext, which is encrypted to the recipient as the JWE Encrypted Key.  </dd>
<dt>JWE Header</dt>
<dd style="margin-left: 8">A string containing a JSON object that describes the encryption operations applied to create the JWE Encrypted Key and the JWE Ciphertext.  </dd>
<dt>JWE Encrypted Key</dt>
<dd style="margin-left: 8">The Content Encryption Key (CEK) is encrypted with the intended recipient's key and the resulting encrypted content is recorded as a byte array, which is referred to as the JWE Encrypted Key.  </dd>
<dt>JWE Ciphertext</dt>
<dd style="margin-left: 8">A byte array containing the Ciphertext.  </dd>
<dt>Encoded JWE Header</dt>
<dd style="margin-left: 8">Base64url encoding of the bytes of the UTF-8 <a href="#RFC3629">RFC 3629</a> <cite title="NONE">[RFC3629]</cite> representation of the JWE Header.  </dd>
<dt>Encoded JWE Encrypted Key</dt>
<dd style="margin-left: 8">Base64url encoding of the JWE Encrypted Key.  </dd>
<dt>Encoded JWE Ciphertext</dt>
<dd style="margin-left: 8">Base64url encoding of the JWE Ciphertext.  </dd>
<dt>Header Parameter Names</dt>
<dd style="margin-left: 8">The names of the members within the JWE Header.  </dd>
<dt>Header Parameter Values</dt>
<dd style="margin-left: 8">The values of the members within the JWE Header.  </dd>
<dt>Base64url Encoding</dt>
<dd style="margin-left: 8">For the purposes of this specification, this term always refers to the URL- and filename-safe Base64 encoding described in <a href="#RFC4648">RFC 4648</a> <cite title="NONE">[RFC4648]</cite>, Section 5, with the (non URL-safe) '=' padding characters omitted, as permitted by Section 3.2.  (See Appendix C of <a href="#JWS">[JWS]</a> for notes on implementing base64url encoding without padding.) </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> JSON Web Encryption (JWE) Overview</h1>
<p id="rfc.section.3.p.1">JWE represents encrypted content using JSON data structures and base64url encoding.  The representation consists of three parts: the JWE Header, the JWE Encrypted Key, and the JWE Ciphertext.  The three parts are base64url-encoded for transmission, and typically represented as the concatenation of the encoded strings in that order, with the three strings being separated by period ('.') characters, as is done when used in JSON Web Tokens (JWTs) <a href="#JWT">[JWT]</a>.  </p>
<p id="rfc.section.3.p.2">JWE utilizes encryption to ensure the confidentiality of the contents of the Plaintext.  JWE does not add a content integrity check if not provided by the underlying encryption algorithm.  If such a check is needed, an algorithm providing it such as AES-GCM <a href="#NIST-800-38D">[NIST-800-38D]</a> can be used, or alternatively, it can be provided through composition by encrypting a representation of the signed content.  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#ExampleJWE" id="ExampleJWE">Example JWE</a>
</h1>
<p id="rfc.section.3.1.p.1">The following example JWE Header declares that: </p>

<ul>
<li>the Content Encryption Key is encrypted to the recipient using the RSA-PKCS1_1.5 algorithm to produce the JWE Encrypted Key, </li>
<li>the Plaintext is encrypted using the AES-256-GCM algorithm to produce the JWE Ciphertext, </li>
<li>the specified 64-bit Initialization Vector with the base64url encoding <samp>__79_Pv6-fg</samp> was used, and </li>
<li>the thumbprint of the X.509 certificate that corresponds to the key used to encrypt the JWE has the base64url encoding <samp>7noOPq-hJ1_hCnvWh6IeYI2w9Q0</samp>.  </li>
</ul>

<p> </p>
<div id="#rfc.figure.1"></div>
<pre>{"alg":"RSA1_5",
 "enc":"A256GCM",
 "iv":"__79_Pv6-fg",
 "x5t":"7noOPq-hJ1_hCnvWh6IeYI2w9Q0"}</pre>
<p id="rfc.section.3.1.p.2">Base64url encoding the bytes of the UTF-8 representation of the JWE Header yields this Encoded JWE Header value: </p>
<div id="#rfc.figure.2"></div>
<pre>TBD</pre>
<p id="rfc.section.3.1.p.3">TBD: Finish this example by showing generation of a Content Encryption Key (CEK), using the CEK to encrypt the Plaintext to produce the Ciphertext (and base64url encoding it), and using the recipient's key to encrypt the CEK to produce the JWE Encrypted Key (and base64url encoding it).  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> JWE Header</h1>
<p id="rfc.section.4.p.1">The members of the JWE Header describe the encryption applied to the Plaintext.  Implementations MUST understand the entire contents of the header; otherwise, the JWE MUST be rejected for processing.  </p>
<p id="rfc.section.4.p.2">The member names within the JWE Header are referred to as Header Parameter Names.  These names MUST be unique.  The corresponding values are referred to as Header Parameter Values.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#ReservedHeaderParameterName" id="ReservedHeaderParameterName">Reserved Header Parameter Names</a>
</h1>
<p id="rfc.section.4.1.p.1">The following header parameter names are reserved.  All the names are short because a core goal of JWE is for the representations to be compact.  </p>
<p id="rfc.section.4.1.p.2">TBD: Describe the relationship between the JWS and JWE header parameters - especially the <samp>alg</samp> parameter, which can contain either signature algorithms (from JWS) or encryption algorithms (from JWE), and the key reference parameters <samp>jku</samp>, <samp>kid</samp>, <samp>x5u</samp>, and <samp>x5t</samp>.  </p>
<div id="#rfc.table.1"></div>
<div id="#HeaderParameterTable"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Reserved Header Parameter Definitions</caption>
<thead><tr>
<th class="left">Header Parameter Name</th>
<th class="left">JSON Value Type</th>
<th class="left">Header Parameter Syntax</th>
<th class="left">Header Parameter Semantics</th>
</tr></thead>
<tbody>
<tr>
<td class="left">alg</td>
<td class="left">string</td>
<td class="left">StringOrURI</td>
<td class="left">The <samp>alg</samp> (algorithm) header parameter identifies the cryptographic algorithm used to secure the JWE Encrypted Key.  A list of reserved <samp>alg</samp> values is presented in <a href="#AlgTable">Table 3</a>.  The processing of the <samp>alg</samp> (algorithm) header parameter requires that the value of the <samp>alg</samp> header parameter MUST be one that is both supported and for which there exists a key for use with that algorithm associated with the intended recipient.  The <samp>alg</samp> value is case sensitive.  This header parameter is REQUIRED.  </td>
</tr>
<tr>
<td class="left">enc</td>
<td class="left">string</td>
<td class="left">StringOrURI</td>
<td class="left">The <samp>enc</samp> (encryption method) header parameter identifies the symmetric encryption algorithm used to secure the Ciphertext.  A list of reserved <samp>enc</samp> values is presented in <a href="#EncTable">Table 4</a>.  The processing of the <samp>enc</samp> (encryption method) header parameter requires that the value of the <samp>enc</samp> header parameter MUST be one that is supported.  The <samp>enc</samp> value is case sensitive.  This header parameter is REQUIRED.  </td>
</tr>
<tr>
<td class="left">iv</td>
<td class="left">string</td>
<td class="left">String</td>
<td class="left">Initialization Vector (<samp>iv</samp>) value for algorithms requiring it, represented as a base64url encoded string.  This header parameter is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">epk</td>
<td class="left">object</td>
<td class="left">JWK Key Object</td>
<td class="left">Ephemeral Public Key (<samp>epk</samp>) value created by the originator for the use in ECDH-ES <a href="#RFC6090">RFC 6090</a> <cite title="NONE">[RFC6090]</cite> encryption.  This key is represented in the same manner as a JSON Web Key <a href="#JWK">[JWK]</a> JWK Key Object value, containing <samp>curve</samp>, <samp>x</samp>, and <samp>y</samp> members.  The inclusion of the JWK Key Object <samp>algorithm</samp> member is OPTIONAL.  This header parameter is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">zip</td>
<td class="left">string</td>
<td class="left">String</td>
<td class="left">Compression algorithm (<samp>zip</samp>) applied to the Plaintext before encryption, if any.  This specification defines the value <samp>GZIP</samp> to refer to the encoding format produced by the file compression program "gzip" (GNU zip) as described in <a href="#RFC1952">[RFC1952]</a>; this format is a Lempel-Ziv coding (LZ77) with a 32 bit CRC.  If no <samp>zip</samp> parameter is present, or its value is <samp>none</samp>, no compression is applied to the Plaintext before encryption.  The <samp>zip</samp> value is case sensitive.  This header parameter is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">jku</td>
<td class="left">string</td>
<td class="left">URL</td>
<td class="left">The <samp>jku</samp> (JSON Web Key URL) header parameter is an absolute URL that refers to a resource for a set of JSON-encoded public keys, one of which corresponds to the key that was used to encrypt the JWE.  The keys MUST be encoded as described in the JSON Web Key (JWK) <a href="#JWK">[JWK]</a> specification.  The protocol used to acquire the resource MUST provide integrity protection.  An HTTP GET request to retrieve the certificate MUST use TLS <a href="#RFC2818">RFC 2818</a> <cite title="NONE">[RFC2818]</cite> <a href="#RFC5246">RFC 5246</a> <cite title="NONE">[RFC5246]</cite> with server authentication <a href="#RFC6125">RFC 6125</a> <cite title="NONE">[RFC6125]</cite>.  This header parameter is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">kid</td>
<td class="left">string</td>
<td class="left">String</td>
<td class="left">The <samp>kid</samp> (key ID) header parameter is a hint indicating which key was used to encrypt the JWE.  This allows originators to explicitly signal a change of key to recipients.  The interpretation of the contents of the <samp>kid</samp> parameter is unspecified.  This header parameter is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">x5u</td>
<td class="left">string</td>
<td class="left">URL</td>
<td class="left">The <samp>x5u</samp> (X.509 URL) header parameter is an absolute URL that refers to a resource for the X.509 public key certificate or certificate chain corresponding to the key used to encrypt the JWE.  The identified resource MUST provide a representation of the certificate or certificate chain that conforms to <a href="#RFC5280">RFC 5280</a> <cite title="NONE">[RFC5280]</cite> in PEM encoded form <a href="#RFC1421">RFC 1421</a> <cite title="NONE">[RFC1421]</cite>.  The protocol used to acquire the resource MUST provide integrity protection.  An HTTP GET request to retrieve the certificate MUST use TLS <a href="#RFC2818">RFC 2818</a> <cite title="NONE">[RFC2818]</cite> <a href="#RFC5246">RFC 5246</a> <cite title="NONE">[RFC5246]</cite> with server authentication <a href="#RFC6125">RFC 6125</a> <cite title="NONE">[RFC6125]</cite>.  This header parameter is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">x5t</td>
<td class="left">string</td>
<td class="left">String</td>
<td class="left">The <samp>x5t</samp> (x.509 certificate thumbprint) header parameter provides a base64url encoded SHA-1 thumbprint (a.k.a. digest) of the DER encoding of the X.509 certificate that corresponds to the key that was used to encrypt the JWE.  This header parameter is OPTIONAL.  </td>
</tr>
<tr>
<td class="left">typ</td>
<td class="left">string</td>
<td class="left">String</td>
<td class="left">The <samp>typ</samp> (type) header parameter is used to declare the type of the encrypted content.  The <samp>typ</samp> value is case sensitive.  This header parameter is OPTIONAL.  </td>
</tr>
</tbody>
</table>
<p id="rfc.section.4.1.p.3">Additional reserved header parameter names MAY be defined via the IANA JSON Web Encryption Header Parameters registry, as per <a href="#IANA">Section 10</a>.  The syntax values used above are defined as follows: </p>
<div id="#rfc.table.2"></div>
<div id="#SyntaxDefinitions"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Header Parameter Syntax Definitions</caption>
<thead><tr>
<th class="left">Syntax Name</th>
<th class="left">Syntax Definition</th>
</tr></thead>
<tbody>
<tr>
<td class="left">String</td>
<td class="left">Any string value MAY be used.  </td>
</tr>
<tr>
<td class="left">StringOrURI</td>
<td class="left">Any string value MAY be used but a value containing a ":" character MUST be a URI as defined in <a href="#RFC3986">RFC 3986</a> <cite title="NONE">[RFC3986]</cite>.  </td>
</tr>
<tr>
<td class="left">URL</td>
<td class="left">A URL as defined in <a href="#RFC1738">RFC 1738</a> <cite title="NONE">[RFC1738]</cite>.  </td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#PublicHeaderParameterName" id="PublicHeaderParameterName">Public Header Parameter Names</a>
</h1>
<p id="rfc.section.4.2.p.1">Additional header parameter names can be defined by those using JWE. However, in order to prevent collisions, any new header parameter name or algorithm value SHOULD either be defined in the IANA JSON Web Encryption Header Parameters registry or be defined as a URI that contains a collision resistant namespace.  In each case, the definer of the name or value MUST take reasonable precautions to make sure they are in control of the part of the namespace they use to define the header parameter name.  </p>
<p id="rfc.section.4.2.p.2">New header parameters should be introduced sparingly, as they can result in non-interoperable JWEs.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> <a href="#PrivateHeaderParameterName" id="PrivateHeaderParameterName">Private Header Parameter Names</a>
</h1>
<p id="rfc.section.4.3.p.1">A producer and consumer of a JWE may agree to any header parameter name that is not a Reserved Name <a href="#ReservedHeaderParameterName">Section 4.1</a> or a Public Name <a href="#PublicHeaderParameterName">Section 4.2</a>. Unlike Public Names, these private names are subject to collision and should be used with caution.  </p>
<p id="rfc.section.4.3.p.2">New header parameters should be introduced sparingly, as they can result in non-interoperable JWEs.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#sec.encryption" id="sec.encryption">Message Encryption</a>
</h1>
<p id="rfc.section.5.p.1">The message encryption process is as follows:</p>
<p></p>

<ol>
<li>Generate a random Content Encryption Key (CEK). The CEK MUST have a length at least equal to that of the required encryption keys and MUST be generated randomly.  See <a href="#RFC4086">RFC 4086</a> <cite title="NONE">[RFC4086]</cite> for considerations on generating random values.  </li>
<li>Encrypt the CEK for the recipient (see <a href="#sec.encrypt_cek">Section 7</a>).  </li>
<li>Generate a random IV (if required for the algorithm).  </li>
<li>Compress the Plaintext if a <samp>zip</samp> parameter was included.  </li>
<li>Serialize the (compressed) Plaintext into a bitstring M.  </li>
<li>Encrypt M using the CEK and IV to form the bitstring C.  </li>
<li>Set the Encoded JWE Ciphertext equal to the base64url encoded representation of C.  </li>
<li>Create the JWE Header containing the encryption parameters used.  </li>
<li>Base64url encoded the UTF-8 representation of the JWE Header to create the Encoded JWE Header.  </li>
<li>The three encoded parts, taken together, are the result of the encryption.  </li>
</ol>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#sec.decryption" id="sec.decryption">Message Decryption</a>
</h1>
<p id="rfc.section.6.p.1">The message decryption process is the reverse of the encryption process.  If any of these steps fails, the JWE MUST be rejected.</p>
<p></p>

<ol>
<li>The Encoded JWE Header, the Encoded JWE Encrypted Key, and the Encoded JWE Ciphertext MUST be successfully base64url decoded following the restriction that no padding characters have been used.  </li>
<li>The resulting JWE Header MUST be completely valid JSON syntax conforming to <a href="#RFC4627">RFC 4627</a> <cite title="NONE">[RFC4627]</cite>.  </li>
<li>The resulting JWE Header MUST be validated to only include parameters and values whose syntax and semantics are both understood and supported.  </li>
<li>Verify that the JWE Header appears to reference a key known to the recipient.  </li>
<li>Decrypt the JWE Encrypted Key to produce the CEK.  </li>
<li>Decrypt the binary representation of the JWE Ciphertext using the CEK.  </li>
<li>Uncompress the result of the previous step, if a <samp>zip</samp> parameter was included.  </li>
<li>Output the result.  </li>
</ol>

<p> </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#sec.encrypt_cek" id="sec.encrypt_cek">CEK Encryption</a>
</h1>
<p id="rfc.section.7.p.1">JWE supports two forms of CEK encryption: </p>
<p></p>

<ul>
<li>Asymmetric encryption under the recipient's public key.  </li>
<li>Symmetric encryption under a shared key.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#sec.asymmetric_encryption" id="sec.asymmetric_encryption">Asymmetric Encryption</a>
</h1>
<p id="rfc.section.7.1.p.1">In the asymmetric encryption mode, the CEK is encrypted under the recipient's public key. The asymmetric encryption modes defined for use with this in this specification are listed in in <a href="#AlgTable">Table 3</a>.  </p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#sec.symmetric_encryption" id="sec.symmetric_encryption">Symmetric Encryption</a>
</h1>
<p id="rfc.section.7.2.p.1">In the symmetric encryption mode, the CEK is encrypted under a symmetric key shared between the sender and receiver.  The symmetric encryption modes defined for use with this in this specification are listed in in <a href="#AlgTable">Table 3</a>.  For GCM, the random 64-bit IV is prepended to the ciphertext.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#sec.msg-composition" id="sec.msg-composition">Composition</a>
</h1>
<p id="rfc.section.8.p.1">This document does not specify a combination signed and encrypted mode. However, because the contents of a message can be arbitrary, encryption and data origin authentication can be provided by recursively encapsulating multiple JWE and JWS messages. In general, senders SHOULD sign the message and then encrypt the result (thus encrypting the signature). This prevents attacks in which the signature is stripped, leaving just an encrypted message, as well as providing privacy for the signer.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#Encrypting" id="Encrypting">Encrypting JWEs with Cryptographic Algorithms</a>
</h1>
<p id="rfc.section.9.p.1">JWE uses cryptographic algorithms to encrypt the Content Encryption Key (CEK) and the Plaintext.  This section specifies a set of specific algorithms for these purposes.  </p>
<p id="rfc.section.9.p.2">The table below <a href="#AlgTable">Table 3</a> is the set of <samp>alg</samp> header parameter values that are reserved by this specification.  These algorithms are used to encrypt the CEK, which produces the JWE Encrypted Key.  </p>
<div id="#rfc.table.3"></div>
<div id="#AlgTable"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>JWE Reserved alg Parameter Values</caption>
<thead><tr>
<th class="left">alg Parameter Value</th>
<th class="left">Encryption Algorithm</th>
</tr></thead>
<tbody>
<tr>
<td class="left">RSA1_5</td>
<td class="left">RSA using RSA-PKCS1-1.5 padding, as defined in <a href="#RFC3447">RFC 3447</a> <cite title="NONE">[RFC3447]</cite>
</td>
</tr>
<tr>
<td class="left">RSA-OAEP</td>
<td class="left">RSA using Optimal Asymmetric Encryption Padding (OAEP), as defined in <a href="#RFC3447">RFC 3447</a> <cite title="NONE">[RFC3447]</cite>
</td>
</tr>
<tr>
<td class="left">ECDH-ES</td>
<td class="left">Elliptic Curve Diffie-Hellman Ephemeral Static, as defined in <a href="#RFC6090">RFC 6090</a> <cite title="NONE">[RFC6090]</cite>, and using the Concat KDF, as defined in <a href="#NIST-800-56A">[NIST-800-56A]</a>, where the Digest Method is SHA-256</td>
</tr>
<tr>
<td class="left">A128KW</td>
<td class="left">Advanced Encryption Standard (AES) Key Wrap Algorithm using 128 bit keys, as defined in <a href="#RFC3394">RFC 3394</a> <cite title="NONE">[RFC3394]</cite>
</td>
</tr>
<tr>
<td class="left">A256KW</td>
<td class="left">Advanced Encryption Standard (AES) Key Wrap Algorithm using 256 bit keys, as defined in <a href="#RFC3394">RFC 3394</a> <cite title="NONE">[RFC3394]</cite>
</td>
</tr>
<tr>
<td class="left">A128GCM</td>
<td class="left">Advanced Encryption Standard (AES) using 128 bit keys in Galois/Counter Mode, as defined in <a href="#FIPS-197">[FIPS-197]</a> and <a href="#NIST-800-38D">[NIST-800-38D]</a>
</td>
</tr>
<tr>
<td class="left">A256GCM</td>
<td class="left">Advanced Encryption Standard (AES) using 256 bit keys in Galois/Counter Mode, as defined in <a href="#FIPS-197">[FIPS-197]</a> and <a href="#NIST-800-38D">[NIST-800-38D]</a>
</td>
</tr>
</tbody>
</table>
<p id="rfc.section.9.p.3">The table below <a href="#EncTable">Table 4</a> is the set of <samp>enc</samp> header parameter values that are reserved by this specification.  These algorithms are used to encrypt the Plaintext, which produces the Ciphertext.  </p>
<div id="#rfc.table.4"></div>
<div id="#EncTable"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>JWE Reserved enc Parameter Values</caption>
<thead><tr>
<th class="left">enc Parameter Value</th>
<th class="left">Symmetric Encryption Algorithm</th>
</tr></thead>
<tbody>
<tr>
<td class="left">A128CBC</td>
<td class="left">Advanced Encryption Standard (AES) using 128 bit keys in Cipher Block Chaining mode, as defined in <a href="#FIPS-197">[FIPS-197]</a> and <a href="#NIST-800-38A">[NIST-800-38A]</a>
</td>
</tr>
<tr>
<td class="left">A256CBC</td>
<td class="left">Advanced Encryption Standard (AES) using 256 bit keys in Cipher Block Chaining mode, as defined in <a href="#FIPS-197">[FIPS-197]</a> and <a href="#NIST-800-38A">[NIST-800-38A]</a>
</td>
</tr>
<tr>
<td class="left">A128GCM</td>
<td class="left">Advanced Encryption Standard (AES) using 128 bit keys in Galois/Counter Mode, as defined in <a href="#FIPS-197">[FIPS-197]</a> and <a href="#NIST-800-38D">[NIST-800-38D]</a>
</td>
</tr>
<tr>
<td class="left">A256GCM</td>
<td class="left">Advanced Encryption Standard (AES) using 256 bit keys in Galois/Counter Mode, as defined in <a href="#FIPS-197">[FIPS-197]</a> and <a href="#NIST-800-38D">[NIST-800-38D]</a>
</td>
</tr>
</tbody>
</table>
<p id="rfc.section.9.p.4">Of these algorithms, only RSA-PKCS1-1.5 with 2048 bit keys, AES-128-CBC, and AES-256-CBC MUST be implemented by conforming implementations.  It is RECOMMENDED that implementations also support ECDH-ES with 256 bit keys, AES-128-GCM, and AES-256-GCM.  Support for other algorithms and key sizes is OPTIONAL.  </p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> <a href="#EncryptingWithTBD" id="EncryptingWithTBD">Encrypting a JWE with TBD</a>
</h1>
<p id="rfc.section.9.1.p.1">TBD: Descriptions of the particulars of each specified algorithm go here.  </p>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> <a href="#MoreAlgs" id="MoreAlgs">Additional Algorithms</a>
</h1>
<p id="rfc.section.9.2.p.1">Additional algorithms MAY be used to protect JWEs with corresponding <samp>alg</samp> and <samp>enc</samp> header parameter values being defined to refer to them. New <samp>alg</samp> and <samp>enc</samp> header parameter values SHOULD either be defined in the IANA JSON Web Encryption Algorithms registry or be a URI that contains a collision resistant namespace.  In particular, the use of algorithm identifiers defined in <a href="#W3C.REC-xmlenc-core-20021210">[W3C.REC-xmlenc-core-20021210]</a>, <a href="#W3C.CR-xmlenc-core1-20110303">[W3C.CR-xmlenc-core1-20110303]</a>, and related specifications is permitted.  </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.10.p.1">This specification calls for: </p>

<ul>
<li>A new IANA registry entitled "JSON Web Encryption Header Parameters" for reserved header parameter names is defined in <a href="#ReservedHeaderParameterName">Section 4.1</a>.  Inclusion in the registry is RFC Required in the <a href="#RFC5226">RFC 5226</a> <cite title="NONE">[RFC5226]</cite> sense for reserved JWE header parameter names that are intended to be interoperable between implementations.  The registry will just record the reserved header parameter name and a pointer to the RFC that defines it. This specification defines inclusion of the header parameter names defined in <a href="#HeaderParameterTable">Table 1</a>.  </li>
<li>A new IANA registry entitled "JSON Web Encryption Algorithms" for reserved values used with the <samp>alg</samp> and <samp>enc</samp> header parameter values, as defined in <a href="#MoreAlgs">Section 9.2</a>. Inclusion in the registry is RFC Required in the <a href="#RFC5226">RFC 5226</a> <cite title="NONE">[RFC5226]</cite> sense. The registry will record the <samp>alg</samp> or <samp>enc</samp> value and a pointer to the RFC that defines it.  This specification defines inclusion of the algorithm values defined in <a href="#AlgTable">Table 3</a> and <a href="#EncTable">Table 4</a>.  </li>
</ul>

<p> </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.11.p.1">TBD: Lots of work to do here. We need to remember to look into any issues relating to security and JSON parsing. One wonders just how secure most JSON parsing libraries are. Were they ever hardened for security scenarios? If not, what kind of holes does that open up? Also, we need to walk through the JSON standard and see what kind of issues we have especially around comparison of names.  For instance, comparisons of header parameter names and other parameters must occur after they are unescaped. Need to also put in text about: Importance of keeping secrets secret. Rotating keys. Strengths and weaknesses of the different algorithms.  </p>
<p id="rfc.section.11.p.2">TBD: Need to put in text about why strict JSON validation is necessary.  Basically, that if malformed JSON is received then the intent of the sender is impossible to reliably discern.  One example of malformed JSON that MUST be rejected is an object in which the same member name occurs multiple times.  </p>
<p id="rfc.section.11.p.3">TBD: We need a section on generating randomness in browsers - it's easy to screw up.  </p>
<p id="rfc.section.11.p.4">When utilizing TLS to retrieve information, the authority providing the resource MUST be authenticated and the information retrieved MUST be free from modification.  </p>
<h1 id="rfc.section.11.1">
<a href="#rfc.section.11.1">11.1.</a> Unicode Comparison Security Issues</h1>
<p id="rfc.section.11.1.p.1">Header parameter names in JWEs are Unicode strings.  For security reasons, the representations of these names must be compared verbatim after performing any escape processing (as per <a href="#RFC4627">RFC 4627</a> <cite title="NONE">[RFC4627]</cite>, Section 2.5).  </p>
<p id="rfc.section.11.1.p.2">This means, for instance, that these JSON strings must compare as being equal ("enc", "\u0065nc"), whereas these must all compare as being not equal to the first set or to each other ("ENC", "Enc", "en\u0043").  </p>
<p id="rfc.section.11.1.p.3">JSON strings MAY contain characters outside the Unicode Basic Multilingual Plane.  For instance, the G clef character (U+1D11E) may be represented in a JSON string as "\uD834\uDD1E".  Ideally, JWE implementations SHOULD ensure that characters outside the Basic Multilingual Plane are preserved and compared correctly; alternatively, if this is not possible due to these characters exercising limitations present in the underlying JSON implementation, then input containing them MUST be rejected.  </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> <a href="#TBD" id="TBD">Open Issues and Things To Be Done (TBD)</a>
</h1>
<p id="rfc.section.12.p.1">The following items remain to be done in this draft: </p>

<ul>
<li>Describe the relationship between the JWE, JWS, and JWT header parameters.  In particular, point out that the set of "alg" values defined by each must be compatible and non-overlapping.  </li>
<li>Consider whether we want to define composite signing/encryption operations (as was the consensus to do at IIW, as documented at http://self-issued.info/?p=378).  </li>
<li>Consider whether reusing the JWS <samp>jku</samp>, <samp>kid</samp>, <samp>x5u</samp>, and <samp>x5t</samp> parameters is the right thing to do, particularly as it effectively precludes specifying composite operations.  </li>
<li>Consider whether to add parameters for directly including keys in the header, either as JWK Key Objects, or X.509 cert values, or both.  </li>
<li>Consider whether to add version numbers.  </li>
<li>Consider which of the open issues from the JWS and JWT specs also apply here.  </li>
<li>Think about how to best describe the concept currently described as "the bytes of the UTF-8 representation of".  Possible terms to use instead of "bytes of" include "byte sequence", "octet series", and "octet sequence".  Also consider whether we want to add an overall clarifying statement somewhere in each spec something like "every place we say 'the UTF-8 representation of X', we mean 'the bytes of the UTF-8 representation of X'".  That would potentially allow us to omit the "the bytes of" part everywhere else.  </li>
<li>Finish the Security Considerations section.  </li>
<li>Write a note in the Security Considerations section about how <samp>x5t</samp> (x.509 certificate thumbprint) should be deprecated because of known problems with SHA-1.  </li>
<li>Should StringOrURI use IRIs rather than RFC 3986 URIs? </li>
<li>Provide a more robust description of the use of the IV.  The current statement "For GCM, the random 64-bit IV is prepended to the ciphertext" in the Symmetric Encryption section is almost certainly out of place.  </li>
<li>It would be good to say somewhere, in normative language, that eventually the algorithms and/or key sizes currently specified will no longer be considered sufficiently secure and will be removed.  Therefore, implementers MUST be prepared for this eventuality.  </li>
<li>Consider whether a media type should be proposed, such as "application/jwe".  </li>
<li>Should we define the use of RFC 5649 key wrapping functions, which allow arbitrary key sizes, in addition to the current use of RFC 3394 key wrapping functions, which require that keys be multiples of 64 bits?  Is this needed in practice? </li>
</ul>

<p> </p>
<h1 id="rfc.references">
<a href="#rfc.references">13.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">13.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1421">[RFC1421]</b></td>
<td class="top">
<a href="mailto:104-8456@mcimail.com" title="Internet Architecture Board (IAB) Internet Research Task Force (IRTF), MIT's Programming Systems Research Group (PSRG), Internet Engineering Task Force (IETF), Privacy Enhanced Mail Work Group (PEM WG)">Linn, J.</a>, "<a href="http://tools.ietf.org/html/rfc1421">Privacy Enhancement for Internet Electronic Mail: Part I: Message Encryption and Authentication Procedures</a>", RFC 1421, February 1993.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1738">[RFC1738]</b></td>
<td class="top">
<a href="mailto:timbl@info.cern.ch" title="CERN, World-Wide Web project">Berners-Lee, T.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox PARC">Masinter, L.</a> and <a href="mailto:mpm@boombox.micro.umn.edu" title="University of Minnesota, Computer and Information Services">M. McCahill</a>, "<a href="http://tools.ietf.org/html/rfc1738">Uniform Resource Locators (URL)</a>", RFC 1738, December 1994.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1952">[RFC1952]</b></td>
<td class="top">
<a href="mailto:ghost@aladdin.com" title="Aladdin Enterprises">Deutsch, P.</a>, <a href="mailto:gzip@prep.ai.mit.edu">Gailly, J-L.</a>, <a href="mailto:madler@alumni.caltech.edu">Adler, M.</a>, <a href="mailto:ghost@aladdin.com">Deutsch, L.P.</a> and <a href="mailto:randeg@alumni.rpi.edu">G. Randers-Pehrson</a>, "<a href="http://tools.ietf.org/html/rfc1952">GZIP file format specification version 4.3</a>", RFC 1952, May 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2818">[RFC2818]</b></td>
<td class="top">
<a>Rescorla, E.</a>, "<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>", RFC 2818, May 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3394">[RFC3394]</b></td>
<td class="top">
<a>Schaad, J.</a> and <a>R. Housley</a>, "<a href="http://tools.ietf.org/html/rfc3394">Advanced Encryption Standard (AES) Key Wrap Algorithm</a>", RFC 3394, September 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3447">[RFC3447]</b></td>
<td class="top">
<a>Jonsson, J.</a> and <a>B. Kaliski</a>, "<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>", RFC 3447, February 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3629">[RFC3629]</b></td>
<td class="top">
<a>Yergeau, F.</a>, "<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>", STD 63, RFC 3629, November 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3986">[RFC3986]</b></td>
<td class="top">
<a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com" title="Day Software">Fielding, R.</a> and <a href="mailto:LMM@acm.org" title="Adobe Systems Incorporated">L. Masinter</a>, "<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>", STD 66, RFC 3986, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4086">[RFC4086]</b></td>
<td class="top">
<a>Eastlake, D.</a>, <a>Schiller, J.</a> and <a>S. Crocker</a>, "<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>", BCP 106, RFC 4086, June 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4627">[RFC4627]</b></td>
<td class="top">
<a>Crockford, D.</a>, "<a href="http://tools.ietf.org/html/rfc4627">The application/json Media Type for JavaScript Object Notation (JSON)</a>", RFC 4627, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4648">[RFC4648]</b></td>
<td class="top">
<a>Josefsson, S.</a>, "<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>", RFC 4648, October 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5280">[RFC5280]</b></td>
<td class="top">
<a>Cooper, D.</a>, <a>Santesson, S.</a>, <a>Farrell, S.</a>, <a>Boeyen, S.</a>, <a>Housley, R.</a> and <a>W. Polk</a>, "<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>", RFC 5280, May 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5785">[RFC5785]</b></td>
<td class="top">
<a>Nottingham, M.</a> and <a>E. Hammer-Lahav</a>, "<a href="http://tools.ietf.org/html/rfc5785">Defining Well-Known Uniform Resource Identifiers (URIs)</a>", RFC 5785, April 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6090">[RFC6090]</b></td>
<td class="top">
<a>McGrew, D.</a>, <a>Igoe, K.</a> and <a>M. Salter</a>, "<a href="http://tools.ietf.org/html/rfc6090">Fundamental Elliptic Curve Cryptography Algorithms</a>", RFC 6090, February 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6125">[RFC6125]</b></td>
<td class="top">
<a>Saint-Andre, P.</a> and <a>J. Hodges</a>, "<a href="http://tools.ietf.org/html/rfc6125">Representation and Verification of Domain-Based Application Service Identity within Internet Public Key Infrastructure Using X.509 (PKIX) Certificates in the Context of Transport Layer Security (TLS)</a>", RFC 6125, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="FIPS-197">[FIPS-197]</b></td>
<td class="top">
<a>National Institute of Standards and Technology (NIST) </a>, "<a>Advanced Encryption Standard (AES)</a>", FIPS PUB 197, November 2001.</td>
</tr>
<tr>
<td class="reference"><b id="NIST-800-38A">[NIST-800-38A]</b></td>
<td class="top">
<a>National Institute of Standards and Technology (NIST) </a>, "<a>Recommendation for Block Cipher Modes of Operation</a>", NIST PUB 800-38A, December 2001.</td>
</tr>
<tr>
<td class="reference"><b id="NIST-800-38D">[NIST-800-38D]</b></td>
<td class="top">
<a>National Institute of Standards and Technology (NIST) </a>, "<a>Recommendation for Block Cipher Modes of Operation: Galois/Counter Mode (GCM) and GMAC</a>", NIST PUB 800-38D, December 2001.</td>
</tr>
<tr>
<td class="reference"><b id="NIST-800-56A">[NIST-800-56A]</b></td>
<td class="top">
<a>National Institute of Standards and Technology (NIST) </a>, "<a>Recommendation for Pair-Wise Key Establishment Schemes Using Discrete Logarithm Cryptography (Revised)</a>", NIST PUB 800-56A, March 2007.</td>
</tr>
<tr>
<td class="reference"><b id="JWS">[JWS]</b></td>
<td class="top">
<a href="mailto:mbj@microsoft.com" title="Microsoft">Jones, M.B.</a>, <a href="mailto:balfanz@google.com" title="Google">Balfanz, D.</a>, <a href="mailto:ve7jtb@ve7jtb.com" title="independent">Bradley, J.</a>, <a href="mailto:yarong@microsoft.com" title="Microsoft">Goland, Y.Y.</a>, <a href="mailto:jpanzer@google.com" title="Google">Panzer, J.</a>, <a href="mailto:n-sakimura@nri.co.jp" title="Nomura Research Institute">Sakimura, N.</a> and <a href="mailto:pt@fb.com" title="Facebook">P. Tarjan</a>, "<a>JSON Web Signature (JWS)</a>", October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="JWK">[JWK]</b></td>
<td class="top">
<a href="mailto:mbj@microsoft.com" title="Microsoft">Jones, M.B.</a>, "<a>JSON Web Key (JWK)</a>", October 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">13.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3275">[RFC3275]</b></td>
<td class="top">
<a>Eastlake, D.</a>, <a>Reagle, J.</a> and <a>D. Solo</a>, "<a href="http://tools.ietf.org/html/rfc3275">(Extensible Markup Language) XML-Signature Syntax and Processing</a>", RFC 3275, March 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5652">[RFC5652]</b></td>
<td class="top">
<a>Housley, R.</a>, "<a href="http://tools.ietf.org/html/rfc5652">Cryptographic Message Syntax (CMS)</a>", STD 70, RFC 5652, September 2009.</td>
</tr>
<tr>
<td class="reference"><b id="W3C.REC-xmlenc-core-20021210">[W3C.REC-xmlenc-core-20021210]</b></td>
<td class="top">
<a>Eastlake, D.</a> and <a>J. Reagle</a>, "<a>XML Encryption Syntax and Processing</a>", World Wide Web Consortium Recommendation REC-xmlenc-core-20021210, December 2002.</td>
</tr>
<tr>
<td class="reference"><b id="W3C.CR-xmlenc-core1-20110303">[W3C.CR-xmlenc-core1-20110303]</b></td>
<td class="top">
<a>Eastlake, D.</a>, <a>Hirsch, F.</a>, <a>Reagle, J.</a> and <a>T. Roessler</a>, "<a>XML Encryption Syntax and Processing Version 1.1</a>", World Wide Web Consortium CR CR-xmlenc-core1-20110303, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="JWT">[JWT]</b></td>
<td class="top">
<a href="mailto:mbj@microsoft.com" title="Microsoft">Jones, M.B.</a>, <a href="mailto:balfanz@google.com" title="Google">Balfanz, D.</a>, <a href="mailto:ve7jtb@ve7jtb.com" title="independent">Bradley, J.</a>, <a href="mailto:yarong@microsoft.com" title="Microsoft">Goland, Y.Y.</a>, <a href="mailto:jpanzer@google.com" title="Google">Panzer, J.</a>, <a href="mailto:n-sakimura@nri.co.jp" title="Nomura Research Institute">Sakimura, N.</a> and <a href="mailto:pt@fb.com" title="Facebook">P. Tarjan</a>, "<a>JSON Web Token (JWT)</a>", October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.rescorla-jsms">[I-D.rescorla-jsms]</b></td>
<td class="top">
<a>Rescorla, E</a> and <a>J Hildebrand</a>, "<a href="http://tools.ietf.org/html/draft-rescorla-jsms-00">JavaScript Message Security Format</a>", Internet-Draft draft-rescorla-jsms-00, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="JSS">[JSS]</b></td>
<td class="top">
<a title="independent">Bradley, J.</a> and <a title="Nomura Research Institute">N.  Sakimura (editor)</a>, "<a>JSON Simple Sign</a>", September 2010.</td>
</tr>
<tr>
<td class="reference"><b id="JCA">[JCA]</b></td>
<td class="top">
<a>Oracle, </a>, "<a>Java Cryptography Architecture</a>", 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#JWEExamples" id="JWEExamples">JWE Examples</a>
</h1>
<p id="rfc.section.Appendix A.p.1">This section provides several examples of JWEs.  </p>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> <a href="#TBDExample" id="TBDExample">JWE Example using TBD Algorithm</a>
</h1>
<h1 id="rfc.appendix.Appendix A.1.1">
<a href="#rfc.appendix.Appendix%20A.1.1">Appendix A.1.1.</a> Encrypting</h1>
<p id="rfc.section.Appendix A.1.1.p.1">TBD: Demonstrate encryption steps with this algorithm </p>
<h1 id="rfc.appendix.Appendix A.1.2">
<a href="#rfc.appendix.Appendix%20A.1.2">Appendix A.1.2.</a> Decrypting</h1>
<p id="rfc.section.Appendix A.1.2.p.1">TBD: Demonstrate decryption steps with this algorithm </p>
<h1 id="rfc.appendix.Appendix B">
<a href="#rfc.appendix.Appendix%20B">Appendix B.</a> <a href="#algxref" id="algxref">Algorithm Identifier Cross-Reference</a>
</h1>
<p id="rfc.section.Appendix B.p.1">This appendix contains a table cross-referencing the <samp>alg</samp> and <samp>enc</samp> values used in this specification with the equivalent identifiers used by other standards and software packages.  See <a href="#RFC3275">XML DSIG</a> <cite title="NONE">[RFC3275]</cite> and <a href="#JCA">Java Cryptography Architecture</a> <cite title="NONE">[JCA]</cite> for more information about the names defined by those documents.  </p>
<div id="#rfc.table.5"></div>
<div id="#algxreftable"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Algorithm Identifier Cross-Reference</caption>
<thead><tr>
<th class="left">Algorithm</th>
<th class="left">JWE</th>
<th class="left">XML ENC</th>
<th class="left">JCA</th>
<th class="left">OID</th>
</tr></thead>
<tbody>
<tr>
<td class="left">RSA using RSA-PKCS1-1.5 padding</td>
<td class="left">RSA1_5</td>
<td class="left">http://www.w3.org/2001/04/xmlenc#rsa-1_5</td>
<td class="left">RSA/ECB/PKCS1Padding</td>
<td class="left">TBD</td>
</tr>
<tr>
<td class="left">RSA using Optimal Asymmetric Encryption Padding (OAEP)</td>
<td class="left">RSA-OAEP</td>
<td class="left">http://www.w3.org/2001/04/xmlenc#rsa-oaep-mgf1p</td>
<td class="left">RSA/ECB/OAEPWithSHA-1AndMGF1Padding</td>
<td class="left">TBD</td>
</tr>
<tr>
<td class="left">Elliptic Curve Diffie-Hellman Ephemeral Static</td>
<td class="left">ECDH-ES</td>
<td class="left">http://www.w3.org/2009/xmlenc11#ECDH-ES</td>
<td class="left">TBD</td>
<td class="left">TBD</td>
</tr>
<tr>
<td class="left">Advanced Encryption Standard (AES) Key Wrap Algorithm <a href="#RFC3394">RFC 3394</a> <cite title="NONE">[RFC3394]</cite> using 128 bit keys</td>
<td class="left">A128KW</td>
<td class="left">http://www.w3.org/2001/04/xmlenc#kw-aes128</td>
<td class="left">TBD</td>
<td class="left">TBD</td>
</tr>
<tr>
<td class="left">Advanced Encryption Standard (AES) Key Wrap Algorithm <a href="#RFC3394">RFC 3394</a> <cite title="NONE">[RFC3394]</cite> using 256 bit keys</td>
<td class="left">A256KW</td>
<td class="left">http://www.w3.org/2001/04/xmlenc#kw-aes256</td>
<td class="left">TBD</td>
<td class="left">TBD</td>
</tr>
<tr>
<td class="left">Advanced Encryption Standard (AES) using 128 bit keys in Cipher Block Chaining mode</td>
<td class="left">A128CBC</td>
<td class="left">http://www.w3.org/2001/04/xmlenc#aes128-cbc</td>
<td class="left">AES/CBC/PKCS5Padding</td>
<td class="left">TBD</td>
</tr>
<tr>
<td class="left">Advanced Encryption Standard (AES) using 256 bit keys in Cipher Block Chaining mode</td>
<td class="left">A256CBC</td>
<td class="left">http://www.w3.org/2001/04/xmlenc#aes256-cbc</td>
<td class="left">AES/CBC/PKCS5Padding</td>
<td class="left">TBD</td>
</tr>
<tr>
<td class="left">Advanced Encryption Standard (AES) using 128 bit keys in Galois/Counter Mode</td>
<td class="left">A128GCM</td>
<td class="left">http://www.w3.org/2009/xmlenc11#aes128-gcm</td>
<td class="left">AES/GCM/NoPadding</td>
<td class="left">TBD</td>
</tr>
<tr>
<td class="left">Advanced Encryption Standard (AES) using 256 bit keys in Galois/Counter Mode</td>
<td class="left">A256GCM</td>
<td class="left">http://www.w3.org/2009/xmlenc11#aes256-gcm</td>
<td class="left">AES/GCM/NoPadding</td>
<td class="left">TBD</td>
</tr>
</tbody>
</table>
<h1 id="rfc.appendix.Appendix C">
<a href="#rfc.appendix.Appendix%20C">Appendix C.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.Appendix C.p.1">Solutions for encrypting JSON content were also explored by <a href="#JSS">[JSS]</a> and <a href="#I-D.rescorla-jsms">[I-D.rescorla-jsms]</a>, both of which significantly influenced this draft.  This draft attempts to explicitly reuse as much from <a href="#W3C.CR-xmlenc-core1-20110303">[W3C.CR-xmlenc-core1-20110303]</a> and <a href="#RFC5652">RFC 5652</a> <cite title="NONE">[RFC5652]</cite> as possible, while utilizing simple compact JSON-based data structures.  </p>
<p id="rfc.section.Appendix C.p.2">Special thanks are due to John Bradley and Nat Sakimura for the discussions that helped inform the content of this specification and to Eric Rescorla and Joe Hildebrand for allowing the reuse of some of the text from <a href="#I-D.rescorla-jsms">[I-D.rescorla-jsms]</a> in this document.  </p>
<h1 id="rfc.appendix.Appendix D">
<a href="#rfc.appendix.Appendix%20D">Appendix D.</a> Document History</h1>
<p id="rfc.section.Appendix D.p.1">-01 </p>

<ul>
<li>Changed type of Ephemeral Public Key (<samp>epk</samp>) from string to JSON object, so that a JWK Key Object value can be used directly.  </li>
<li>Specified that the Digest Method for ECDH-ES is SHA-256.  (The specification was previously silent about the choice of digest method.) </li>
<li>The <samp>jku</samp> and <samp>x5u</samp> URLs are now required to be absolute URLs.  </li>
<li>Removed this unnecessary language from the <samp>kid</samp> description: "Omitting this parameter is equivalent to setting it to an empty string".  </li>
<li>Use the same language as RFC 2616 does when describing <samp>GZIP</samp> message compression.  </li>
</ul>

<p> </p>
<p id="rfc.section.Appendix D.p.2">-00 </p>

<ul><li>First encryption draft based upon consensus decisions at IIW documented at http://self-issued.info/?p=378.  The ability to provide encryption for JSON Web Tokens (JWTs) <a href="#JWT">[JWT]</a> is a primary use case.  </li></ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Michael B. Jones</span> 
	  <span class="n hidden">
		<span class="family-name">Jones</span>
	  </span>
	</span>
	<span class="org vcardline">Microsoft</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mbj@microsoft.com">mbj@microsoft.com</a></span>

<span class="vcardline">URI: <a href="http://self-issued.info/">http://self-issued.info/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Eric Rescorla</span> 
	  <span class="n hidden">
		<span class="family-name">Rescorla</span>
	  </span>
	</span>
	<span class="org vcardline">RTFM, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ekr@rtfm.com">ekr@rtfm.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Joe Hildebrand</span> 
	  <span class="n hidden">
		<span class="family-name">Hildebrand</span>
	  </span>
	</span>
	<span class="org vcardline">Cisco Systems, Inc.</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jhildebr@cisco.com">jhildebr@cisco.com</a></span>

  </address>
</div>

</body>
</html>