<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Authentication and Confidentiality in PIM-SM
    Link-local Messages</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Authentication and Confidentiality in PIM-SM
    Link-local Messages">
<meta name="keywords" content="Security, PIM-SM">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">PIM Working Group</td><td class="header">W. Atwood</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">S. Islam</td></tr>
<tr><td class="header">Updates: <a href='http://tools.ietf.org/html/rfc4601'>4601</a> (if&nbsp;approved)</td><td class="header">Concordia University/CSE</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">M. Siami</td></tr>
<tr><td class="header">Expires: March 1, 2009</td><td class="header">Concordia University/CIISE</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">August 28, 2008</td></tr>
</table></td></tr></table>
<h1><br />Authentication and Confidentiality in PIM-SM
    Link-local Messages<br />draft-ietf-pim-sm-linklocal-04</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on March 1, 2009.</p>

<h3>Abstract</h3>

<p>RFC 4601 mandates the use of IPsec to ensure authentication of the link-local
      messages in the Protocol Independent Multicast - Sparse Mode (PIM-SM) routing
      protocol. This document specifies mechanisms to authenticate the PIM-SM link local
      messages using the IP security (IPsec) Authentication Header (AH) or Encapsulating Security Payload (ESP).  It specifies optional mechanisms to provide confidentiality using the ESP.  Manual keying is specified as the mandatory and default group key management solution.  To deal with issues of scalability and security that exist with manual keying, an optional automated group key management mechanism is specified.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Transport Mode vs. Tunnel Mode<br />
<a href="#anchor4">4.</a>&nbsp;
Authentication<br />
<a href="#anchor5">5.</a>&nbsp;
Confidentiality<br />
<a href="#anchor6">6.</a>&nbsp;
 IPsec Requirements<br />
<a href="#anchor7">7.</a>&nbsp;
Key Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">7.1.</a>&nbsp;
Manual Key Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">7.2.</a>&nbsp;
Automated Key Management<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">7.3.</a>&nbsp;
Communications Patterns<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">7.4.</a>&nbsp;
Neighbor Relationships<br />
<a href="#numberSA">8.</a>&nbsp;
Number of Security Associations<br />
<a href="#anchor12">9.</a>&nbsp;
Rekeying<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">9.1.</a>&nbsp;
Rekeying Procedure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">9.2.</a>&nbsp;
KeyRollover Interval<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">9.3.</a>&nbsp;
Rekeying Interval<br />
<a href="#anchor16">10.</a>&nbsp;
IPsec Protection Barrier and GSPD<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ManKeying">10.1.</a>&nbsp;
Manual Keying<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">10.1.1.</a>&nbsp;
SAD Entries<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">10.1.2.</a>&nbsp;
SPD Entries<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AutoKeying">10.2.</a>&nbsp;
Automatic Keying<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">10.2.1.</a>&nbsp;
SAD Entries<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">10.2.2.</a>&nbsp;
GSPD Entries<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">10.2.3.</a>&nbsp;
PAD Entries<br />
<a href="#SAlookup">11.</a>&nbsp;
Security Association Lookup<br />
<a href="#anchor22">12.</a>&nbsp;
Activating the Anti-replay Mechanism<br />
<a href="#anchor23">13.</a>&nbsp;
Implementing a Security Association Database per Interface<br />
<a href="#ESN">14.</a>&nbsp;
Extended Sequence Number<br />
<a href="#anchor24">15.</a>&nbsp;
Security Considerations<br />
<a href="#anchor25">16.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">17.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">17.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">17.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>All the PIM-SM <a class='info' href='#RFC4601'>[RFC4601]<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a> control
      messages have IP protocol number 103. These messages are either unicast,
      or multicast with TTL = 1. The source address used for unicast messages
      is a domain-wide reachable address. For the multicast messages, a
      link-local address of the interface on which the message is being sent
      is used as the source address and a special multicast address,
      ALL_PIM_ROUTERS (224.0.0.13 in IPv4 and ff02::d in IPv6) is used as the
      destination address. These messages are called link-local messages.
      Hello, Join/Prune and Assert messages are included in this category. A
      forged link-local message may be sent to the ALL_PIM_ROUTERS multicast
      address by an attacker. This type of message affects the construction of
      the distribution tree <a class='info' href='#RFC4601'>[RFC4601]<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a>. The
      effects of these forged messages are outlined in section 6.1 of <a class='info' href='#RFC4601'>[RFC4601]<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a>. Some of the effects are very
      severe, whereas some are minor.
</p>
<p>PIM-SM version 2 was originally specified in RFC 2117, and revised in
      RFC 2362 and RFC 4601. RFC 4601 obsoletes RFC 2362, and
      corrects a number of deficiencies. The Security Considerations section of
      RFC 4601 is based primarily on the new Authentication
      Header (AH) specification described in <a class='info' href='#RFC4302'>RFC
      4302<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4302].
</p>
<p>Securing the unicast messages can be achieved by the use of a normal
      unicast IPsec Security Association between the two communicants.
      Securing the user data exchanges is covered in  <a class='info' href='#RFC3740'>RFC 3740<span> (</span><span class='info'>Hardjono, T. and B. Weis, &ldquo;The Multicast Group Security Architecture,&rdquo; March&nbsp;2004.</span><span>)</span></a> [RFC3740]. This document focuses on the security issues
      for link-local messages. It provides some guidelines to take advantage of
      the new permitted AH functionality in RFC 4302, and to bring the PIM-SM specification into alignment with the new AH specification. This document
      recommends manual key management as mandatory to implement, i.e., that all
      implementations MUST support, and begins the discussion of an automated key management protocol that the PIM routers can use.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED",
      "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
      "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].  They indicate
      requirement levels for compliant PIM-SM implementations.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Transport Mode vs. Tunnel Mode</h3>

<p>The transport mode Security Association (SA) is generally used
      between two hosts or routers/gateways when they are acting as hosts. The
      SA must be a tunnel mode SA if either end of the security association is
      a router/gateway. Two hosts MAY establish a tunnel mode SA between
      themselves. PIM-SM link-local messages are exchanged between routers.
      However, since the packets are locally delivered, the routers assume the
      role of hosts in the context of the tunnel mode SA. All implementations
      conforming to this specification MUST support transport mode SA to
      provide required IPsec security to PIM-SM link-local messages. They MAY
      also support tunnel mode SA to provide required IPsec security to PIM-SM
      link-local messages.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Authentication</h3>

<p>Implementations conforming to this specification MUST support
      authentication for PIM-SM link-local messages.
</p>
<p>In order to provide
      authentication to PIM-SM link-local messages, implementations MUST
      support <a class='info' href='#RFC4303'>ESP<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4303] and MAY support <a class='info' href='#RFC4302'>AH<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4302].
</p>
<p>If ESP in transport mode is used, it will only provide authentication to PIM-SM protocol packets excluding the IPv6 header, extension headers, and options. (Note: The IPv4 exclusions need to be listed here as well.)
</p>
<p>If AH in transport mode is used, it will provide authentication to PIM-SM protocol packets, selected portions of the IPv6 header, extension headers and options.  (Note: the IPv4 coverage needs to be listed here as well.)
</p>
<p>When authentication for PIM-SM link-local messages is enabled, </p>
<ul class="text">
<li>PIM-SM link-local packets that are not protected with AH or ESP MUST be
          silently discarded.
</li>
<li>PIM-SM link-local packets that fail the authentication checks
          MUST be silently discarded.
</li>
</ul><p>
			
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Confidentiality</h3>

<p>Implementations conforming to this specification SHOULD support confidentiality for PIM-SM.
</p>
<p>If confidentiality is provided, ESP MUST be used.
</p>
<p>When PIM-SM confidentiality is enabled,</p>
<ul class="text">
<li>PIM-SM packets that are not protected with ESP MUST be silently discarded.
</li>
<li>PIM-SM packets that fail the confidentiality checks MUST be silently discarded.
</li>
</ul><p>
			
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
 IPsec Requirements</h3>

<p>In order to implement this specification, the following IPsec
      capabilities are required.
</p>
<p>
				</p>
<blockquote class="text"><dl>
<dt>Transport mode</dt>
<dd>
						IPsec in
          transport mode MUST be supported.
</dd>
<dt>Multiple Security Policy Databases (SPDs)</dt>
<dd>
						The implementation MUST support multiple SPDs with an SPD selection function that provides an ability to choose a specific SPD based on interface.
</dd>
<dt>Selectors</dt>
<dd>
						The implementation
          MUST be able to use source address, destination address, protocol, and direction as selectors in the
          SPD.
</dd>
<dt>Interface ID tagging</dt>
<dd>
						The implementation MUST be able to tag the inbound packets with the ID of the interface (physical or virtual) via which it arrived.
</dd>
<dt>Manual key support</dt>
<dd>
						Manually configured keys MUST be able to secure the
          specified traffic.
</dd>
<dt>Encryption and authentication algorithms</dt>
<dd>
						The implementation MUST NOT allow the user to choose stream ciphers as the encryption algorithm for securing PIM-SM packets since the stream ciphers are not suitable for manual keys.  Except when in conflict with the above statement, the key words "MUST", "MUST NOT", "REQUIRED", "SHOULD", and "SHOULD NOT" that appear in <a class='info' href='#RFC4835'>RFC 4835<span> (</span><span class='info'>Manral, V., &ldquo;Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; April&nbsp;2007.</span><span>)</span></a> [RFC4835] for algorithms to be supported are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119] for PIM-SM support as well.
</dd>
<dt>Encapsulation of ESP packet</dt>
<dd>
						IP encapsulation of ESP packets MUST be supported.  For  simplicity, UDP encapsulation of ESP packets SHOULD NOT be used.
</dd>
</dl></blockquote><p>
			
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Key Management</h3>

<p>All the implementations MUST support manual configuration of the SAs
      that will be used to authenticate PIM-SM link-local messages. This does not preclude the use of a negotiation protocol such as the
      Internet Key Exchange (IKE) <a class='info' href='#RFC4306'>[RFC4306]<span> (</span><span class='info'>Kaufman, C., &ldquo;Internet Key Exchange (IKEv2) Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> or Group
      Secure Association Key Management Protocol (GSAKMP) <a class='info' href='#RFC4535'>[RFC4535]<span> (</span><span class='info'>Harney, H., Meth, U., Colegrove, A., and G. Gross, &ldquo;GSAKMP: Group Secure Association Key Management Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a> to establish SAs.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
Manual Key Management</h3>

<p>To establish the SAs at PIM-SM routers, manual key configuration will
      be feasible when the number of peers (directly connected routers) is
      small. The Network Administrator will configure a router manually during
      its boot up process. At that time, the authentication method and the choice
      of keys SHOULD be configured. The SAD entry will be created. The Network
      Administrator will also configure the Security Policy Database of a router to
      ensure the use of the associated SA while sending a link-local
      message.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.2"></a><h3>7.2.&nbsp;
Automated Key Management</h3>

<p>All the link-local messages of the PIM-SM protocol are sent to the
      destination address, ALL_PIM_ROUTERS, which is a multicast address. By
      using the sender address in conjunction with the destination address for
      Security Association lookup, link-local communication turns to an SSM or
      "one to many" communication. Since IKE is based on the Diffie-Hellman
      key agreement protocol and works only for two communicating parties, it
      is not possible to use IKE for providing the required "one to many"
      authentication.
</p>
<p>One option is to use Group Domain Of Interpretation (GDOI)
      <a class='info' href='#RFC3547'>[RFC3547]<span> (</span><span class='info'>Baugher, M., Weis, B., Hardjono, T., and H. Harney, &ldquo;The Group Domain of Interpretation,&rdquo; July&nbsp;2003.</span><span>)</span></a>, which enables a group of users or
      devices to exchange encrypted data using IPsec data encryption. GDOI has
      been developed to be used in multicast applications, where the number of
      end users or devices may be large and the end users or devices can
      dynamically join/leave a multicast group. However, a PIM router is not
      expected to join/leave very frequently, and the number of routers is
      small when compared to the possible number of users of a multicast application. Moreover,
      most of the PIM routers will be located inside the same administrative
      domain and are considered as trusted parties. It is possible that a
      subset of GDOI functionalities will be sufficient.
</p>
<p>A framework for automating key management for RSVP is given in <a class='info' href='#I-D.ietf-tsvwg-rsvp-security-groupkeying'>[I&#8209;D.ietf&#8209;tsvwg&#8209;rsvp&#8209;security&#8209;groupkeying]<span> (</span><span class='info'>Behringer, M. and F. Faucheur, &ldquo;Applicability of Keying Methods for RSVP Security,&rdquo; June&nbsp;2009.</span><span>)</span></a>.  A companion modification for GDOI is presented in <a class='info' href='#I-D.weis-gdoi-for-rsvp'>[I&#8209;D.weis&#8209;gdoi&#8209;for&#8209;rsvp]<span> (</span><span class='info'>Weis, B., &ldquo;Group Domain of Interpretation (GDOI) support for RSVP,&rdquo; February&nbsp;2008.</span><span>)</span></a>.  NOTE: A similar pair of documents will be prepared for PIM-SM.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.3"></a><h3>7.3.&nbsp;
Communications Patterns</h3>

<p>
      Before discussing the set of security associations that are required to properly manage a multicast region that is under the control of a single administration, it is necessary to understand the communications patterns that will exist among the routers in this region.  From the perspective of a speaking router, the information from that router is sent (multicast) to all of its neighbors.  From the perspective of a listening router, the information coming from each of its neighbors is distinct from the information coming from every other router to which it is directly connected.  Thus an administrative region contains many (small) distinct groups, all of which happen to be using the same multicast destination address (e.g., ALL_PIM_ROUTERS, see <a class='info' href='#SAlookup'>Section&nbsp;11<span> (</span><span class='info'>Security Association Lookup</span><span>)</span></a>), and each of which is centered on the associated speaking router.
</p>
<p>Consider the example configuration as shown in Figure 1.
</p>
<p>
				
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 R2    R3    R4    R5    R6
 |     |     |     |     |
 |     |     |     |     |
---------   ---------------
        |     |
        |     |
         \   /
           R1
         /   \
        |     |
        |     |
---------    --------------------
       |       |    |    |    |
       |       |    |    |    |
      R7      R8   R9   R10  R11
       |       |    |    |    |
                    |
                    |
                -------------
                 |    |    |
                 |    |    |
                R12  R13  R14

       Figure 1: Set of router interconnections</pre></div>
<p>
</p>
			

<p>In this configuration, router R1 has four interfaces, and is the speaking router for a group whose listening routers are routers R2 through R11.  Router R9 is the speaking router for a group whose listening routers are routers R1, R8 and R10-R14.
</p>
<p>From the perspective of R1 as a speaking router, if a Security Association SA1 is assigned to protect outgoing packets from R1, then it is necessary to distribute the key for this association to each of the routers R2 through R11.  Similarly, from the perspective of R9 as a speaking router, if a Security Association is assigned to protect the outgoing packets from R9, then it is necessary to distribute the key for this association to each of the routers R1, R8, and R10 through R14.
</p>
<p>From the perspective of R1 as a listening router, all packets arriving from R2 through R11 need to be distinguished from each other, to permit selecting the correct Security Association in the SAD.  (Packets from each of the peer routers (R2 through R11) represent communication from a different speaker, even though they are sent using the same destination address.)  For a multicast Security Association, RFC 4301 permits using the Source Address in the selection function.  If the source addresses used by routers R2 through R11 are globally unique, then the source addresses of the peer routers are sufficient to achieve the differentiation.  If the sending routers use link-local addresses, then these addresses are unique only on a per-interface basis, and it is necessary to use the Interface ID tag as an additional selector, i.e., either the selection function has to have the Interface ID tag as one of its inputs, or separate SADs have to be maintained for each interface.
</p>
<p>If the assumption of connectivity to the key server can be made (which is true in the PIM-SM case), then the GC/KS can be centrally located (and duplicated for reliability).  If this assumption cannot be made (i.e., in the case of adjacencies for a unicast router), then some form of "local" key server must be available for each group.  Given that the listening routers are never more than one hop away from the speaking router, the speaking router is the obvious place to locate the "local" key server.  This has the additional advantage that there is no need to duplicate the local key server for reliability, since if the key server is down, it is very likely that the speaking router is also down.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.4"></a><h3>7.4.&nbsp;
Neighbor Relationships</h3>

<p>Each distinct group consists of one speaker, and the set of directly connected listeners.  If the decision is made to maintain one Security Association per speaker (see <a class='info' href='#numberSA'>Section&nbsp;8<span> (</span><span class='info'>Number of Security Associations</span><span>)</span></a>), then the key server will need to be aware of the adjacencies of each speaker.  Procedures for doing this are under study.
</p>
<a name="numberSA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Number of Security Associations</h3>

<p>The number of Security Associations to be maintained by a PIM router
      depends on the required security level and available key management.
      This SHOULD be decided by the Network Administrator. Two different ways are
      shown in Figure 2 and 3. It is assumed that A, B and C are three PIM
      routers, where B and C are directly connected with A, and there is no
      direct link between B and C.
</p>
<p>
				
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                     |
                  B                  |
                SAb     ------------&gt;|
                SAa     &lt;------------|
                                     |
                  A                  |
                SAb     &lt;------------|
                SAa     ------------&gt;|
                SAc     &lt;------------|
                                     |
                  C                  |
                SAc     ------------&gt;|
                SAa     &lt;------------|
                                     |
                        Directly connected network

       Figure 2: Activate unique Security Association for each peer</pre></div>
<p>
</p>
			

<p>The first method, shown in Figure 2 is OPTIONAL to implement. In this
      method, each node will use a unique SA for its outbound traffic. A, B,
      and C will use SAa, SAb, and SAc, respectively for sending any traffic.
      Each node will look up the SA to be used based on the source address. A
      will use SAb and SAc for packets received from B and C, respectively.
      The number of SAs to be activated and maintained by a PIM router will be
      equal to the number of directly connected routers plus one, for sending
      its own traffic. Also, the addition of a PIM router in the network will
      require the addition of another SA on every directly connected PIM
      router. This solution will be scalable and practically feasible with an
      automated key management protocol. However, it MAY be used with manual
      key management, if the number of directly connected router(s) is
      small.
</p>
<p>
				
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>                 B                   |
                SAo     ------------&gt;|
                SAi     &lt;------------|
                                     |
                 A                   |
                SAo     ------------&gt;|
                SAi     &lt;------------|
                                     |
                 C                   |
                SAo     ------------&gt;|
                SAi     &lt;------------|
                                     |
                        Directly connected network

       Figure 3: Activate two Security Associations
</pre></div>
<p>
</p>
			

<p>The second method, shown in Figure 3, MUST be supported by every
      implementation. In this simple method, all the nodes will use two SAs,
      one for sending (SAo) and the other for receiving (SAi) traffic. Thus, the
      number of SAs is always two and will not be affected by addition of a
      PIM router. Although two different SAs are used in this method, the SA parameters (keys, SPI, etc.) for the two SAs are identical, i.e., the same information is shared among all the routers in an administrative region.  This document RECOMMENDS the above method for manual key
      configuration. However, it MAY also be used with automated key configuration.
      When manually configured, the method suffers from impersonation
      attacks as mentioned in the Security Considerations section.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Rekeying</h3>

<p> To maintain the security of a link, the authentication and encryption key values SHOULD be changed periodically.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Rekeying Procedure</h3>

<p>The following three-step procedure SHOULD be provided to rekey the routers on a link without dropping PIM-SM protocol packets or disrupting the adjacency.
</p>
<p></p>
<ol class="text">
<li>For every router on the link, create an additional inbound SA for the interface being rekeyed using a new SPI and the new key.
</li>
<li>For every router on the link, replace the original outbound SA with one using the new SPI and key values.  The SA replacement operation should be atomic with respect to sending PIM-SM packets on the link, so that no PIM-SM packets are sent without authentication/encryption
</li>
<li>For every router on the link, remove the original inbound SA.
</li>
</ol><p>
				
</p>
<p>Note that all routers on the link must complete step 1 before any begin step 2.  Likewise, all the routers on the link must complete step 2 before any begin step 3.
</p>
<p>One way to control the progression from one step to another is for each router to have a configurable time constant KeyRolloverInterval.  After the router begins step 1 on a given link, it waits for this interval and then moves to step 2.  Likewise, after moving to step 2, it waits for this interval and then moves to step 3.
</p>
<p>In order to achieve smooth key transition, all routers on a link should use the same value for KeyRolloverInterval and should initiate the key rollover process within this time period.
</p>
<p>At the end of this time period, all the routers on the link will have a single inbound and outbound SA for PIM-SM with the new SPI and key values.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
KeyRollover Interval</h3>

<p>The configured value of KeyRolloverInterval should be long enough to allow the administrator to change keys on all the PIM-SM routers.  As this value can vary significantly depending on the implementation and the deployment, it is left to the administrator to choose an appropriate value.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Rekeying Interval</h3>

<p>This section analyzes the security provided by manual keying and recommends that the encryption and authentication keys SHOULD be changed at least every 90 days.
</p>
<p>The weakest security provided by the security mechanisms discussed in this specification is when NULL encryption (for ESP) or no encryption (for AH) is used with the HMAC-MD5 authentication.  Any other algorithm combinations will be at least as hard to break as the ones mentioned above.  This is shown by the following reasonable assumptions:
</p>
<p></p>
<ul class="text">
<li>NULL Encryption and HMAC-SHA-1 Authentication will be more secure as HMAC-SHA-1 is considered to be more secure than HMAC-MD5.
</li>
<li>NON-NULL Encryption and NULL Authentication combination is not applicable as this specification mandates authentication when PIM-SM security is enabled.
</li>
<li>Data Encryption Security (DES) Encryption and HMAC-MD5 Authentication will be more secure because of the additional security provided by DES.
</li>
<li>Other encryption algorithms such as 3DES and the Advanced Encryption Standard (AES) will be more secure than DES.
</li>
</ul><p>
				
</p>
<p>RFC 3562 <a class='info' href='#RFC3562'>[RFC3562]<span> (</span><span class='info'>Leech, M., &ldquo;Key Management Considerations for the TCP MD5 Signature Option,&rdquo; July&nbsp;2003.</span><span>)</span></a> analyzes the rekeying requirements for the TCP MD5 signature option.  The analysis provided in RFC 3562 is also applicable to this specification as the analysis is independent of data patterns.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IPsec Protection Barrier and GSPD</h3>

<a name="ManKeying"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
Manual Keying</h3>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1.1"></a><h3>10.1.1.&nbsp;
SAD Entries</h3>

<p>The Administrator must configure the necessary Security Associations.  Each SA entry has the Source Address of an authorized peer, and a Destination Address of ALL_PIM_ROUTERS.  Unique SPI values for the manually configured SAs MUST be assigned by the Administrator, to ensure that the SPI does not conflict with existing SPI values in the SAD.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1.2"></a><h3>10.1.2.&nbsp;
SPD Entries</h3>

<p>The Administrator must configure the necessary SPD entries.  The SPD entry must ensure that any outbound IP traffic packet traversing the IPsec boundary, with PIM as its next layer protocol, PIM message type of Hello, Join/Prune, bootstrap or Assert, sent to the Destination Address of ALL_PIM_ROUTERS, is protected by AH.  If the IPsec implementation does not identify PIM message types as a selector, the "local port" selector can be used, with suitable adjustment.
</p>
<a name="AutoKeying"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2"></a><h3>10.2.&nbsp;
Automatic Keying</h3>

<p>When automatic keying is used, the SA creation is done dynamically using a group key management protocol.  The GSPD and PAD tables are configured by the Administrator.  The PAD table provides the link between the IPsec subsystem and the group key management protocol.  For automatic keying, the implementation MUST support the multicast extensions described in <a class='info' href='#I-D.ietf-msec-ipsec-extensions'>[I&#8209;D.ietf&#8209;msec&#8209;ipsec&#8209;extensions]<span> (</span><span class='info'>Weis, B., Gross, G., and D. Ignjatic, &ldquo;Multicast Extensions to the Security Architecture for the Internet  Protocol,&rdquo; June&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2.1"></a><h3>10.2.1.&nbsp;
SAD Entries</h3>

<p>All PIM routers participate in an authentication scheme that identifies permitted neighbors and achieves peer authentication during SA negotiation, leading to child SAs being established and saved in the SAD.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2.2"></a><h3>10.2.2.&nbsp;
GSPD Entries</h3>

<p>The Administrator must configure the necessary GSPD entries for "send only" directionality.  This rule MUST trigger the group key management protocol for a registration exchange.  This exchange will set up the outbound SAD entry that encrypts the multicast PIM control message.  Considering that this rule is "sender only", no inbound SA is created in the reverse direction.
</p>
<p>In addition, the registration exchange will install GSPD entries corresponding to each legitimate peer router, with direction "receive only".
</p>
<p>To account for new, legitimate neighbors, the Administrator MUST configure a GSPD entry for "any" peer router, destined to the ALL_PIM_ROUTERS address.  This entry will trigger a query to the group key management protocol, to establish the legitimacy (or lack of it) of the new peer, and install the necessary SAD "receive only" entry.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.2.3"></a><h3>10.2.3.&nbsp;
PAD Entries</h3>

<p>The PAD must be configured by the Administrator with information to permit identification of legitimate group members and senders.  This will be detailed in a companion document (to be written).
</p>
<a name="SAlookup"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Security Association Lookup</h3>

<p>For an SA that carries unicast traffic, three parameters (SPI,
      destination address and security protocol type (AH or ESP)) are used in
      the Security Association lookup process for inbound packets. The SPI is
      sufficient to specify an SA. However, an implementation may use the SPI
      in conjunction with the IPsec protocol type (AH or ESP) for the SA
      lookup process. According to RFC 4301 <a class='info' href='#RFC4301'>[RFC4301]<span> (</span><span class='info'>Kent, S. and K. Seo, &ldquo;Security Architecture for the Internet Protocol,&rdquo; December&nbsp;2005.</span><span>)</span></a> and
      the AH specification <a class='info' href='#RFC4302'>[RFC4302]<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a>, for multicast SAs,
      in conjunction with the SPI, the destination address or the destination
      address plus the sender address may also be used in the SA lookup. The
      security protocol field is not employed for a multicast SA lookup.
</p>
<p>The reason for the various prohibitions in the IPsec RFCs concerning
      multisender multicast SAs lies in the difficulty of coordinating the
      multiple senders. However, if the use of multicast for link-local
      messages is examined, it may be seen that in fact the communication need
      not be coordinated---from the prospective of a receiving router, each
      peer router is an independent sender. In effect, link-local
      communication is an SSM communication that happens to use an ASM address
      (which is shared among all the routers).
</p>
<p>Given that it is always possible to distinguish a connection using IPsec from a  connection not using IPsec, it is recommended that the address ALL_PIM_ROUTERS be used, to maintain consistency with present practice.
</p>
<p>Given that the sender address of an incoming packet may be only locally unique (because of the use of link-local addresses), it will be
      necessary for a receiver to use the interface ID tag to sort out the associated SA for
      that sender.  Therefore, this document mandates that the interface ID tag, 
      the SPI and the sender address MUST be used in the SA lookup
      process.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Activating the Anti-replay Mechanism</h3>

<p>Although link-level messages on a link constitute a multiple-sender,
      multiple-receiver group, the use of the interface ID tag and sender address for SA lookup
      essentially resolves the communication into a separate SA for each
      sender/destination pair, even for the case where only two SAs (with identical SA parameters) are used for the entire administrative region. Therefore, the statement in the AH RFC (section
      2.5 of <a class='info' href='#RFC4302'>[RFC4302]<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a>) that "for a multi-sender SA, the
      anti-replay features are not available" becomes irrelevant to the PIM-SM
      link-local message exchange.
</p>
<p>To activate the anti-replay mechanism in a unicast communication, the
      receiver uses the sliding window protocol and it maintains a sequence
      number for this protocol. This sequence number starts from zero. Each
      time the sender sends a new packet, it increments this number by one. In
      a multi-sender multicast group communication, a single sequence number
      for the entire group would not be enough.
</p>
<p>The whole scenario is different for PIM link-local messages. These
      messages are sent to local links with TTL = 1. A link-local message
      never propagates through one router to another. The use of the sender
      address and the interface ID tag for SA lookup converts the relationship from a multiple-sender
      group to multiple single-sender associations. This specification
      RECOMMENDS activation of the anti-replay mechanism only if the SAs are
      assigned using an automated key management procedure. In manual key management,
      the anti-replay SHOULD NOT be activated. If the number of router(s) to
      be assigned manually is small, the Network Administrator MAY consider to
      activate anti-replay. If anti-replay is activated a PIM router MUST
      maintain a different sliding window for each directly connected
      sender.
</p>
<p>If the SAs are activated according to Figure 3, that is all the nodes
      use only two SAs, one SA for sending and the other is for receiving
      traffic, a PIM router MAY still activate the anti-replay mechanism. Instead
      of maintaining only two SAs, the router will maintain the same number of
      SAs as explained in the first method (see Figure 2) (because of the differentiation based on sender address). For each active SA
      a corresponding sequence number MUST be maintained. Thus, a PIM router
      will maintain a number of identical SAs, except that the sender address, interface ID tag and
      the sequence number are different for each SA. In this way a PIM router will be at least
      free from all the attacks that can be performed by replaying PIM-SM
      packets.
</p>
<p>Note that when activating anti-replay with manual key configuration, the following actions must be taken by the network administrator:
</p>
<p>
				</p>
<blockquote class="text"><dl>
<dt>a.</dt>
<dd>If a new router is added, the Network Administrator MUST add a new SA entry in each peer router.
</dd>
<dt>b.</dt>
<dd>If an existing router has to restart, the Network Administrator MUST refresh the counter (ESN, see <a class='info' href='#ESN'>Section&nbsp;14<span> (</span><span class='info'>Extended Sequence Number</span><span>)</span></a>) to zero for all the peer routers.  This implies deleting all the existing SAs and adding a new SA with the same configuration and a re-initialized counter.
</dd>
</dl></blockquote><p>
			
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Implementing a Security Association Database per Interface</h3>

<p>RFC 4601 suggests that it may be desirable to implement a separate Security Association Database (SAD) for each router interface.
      The use of link-local addresses in certain circumstances implies that differentiation of ambiguous speaker addresses requires the use of the interface ID tag in the SA lookup.  One way to do this is through the use of multiple SADs.  Alternatively, the interface ID tag may be a specific component of the selector algorithm.  This is in conformance with RFC 4301, which explicitly removes the requirement for separate SADs that was present in RFC 2401 <a class='info' href='#RFC2401'>[RFC2401]<span> (</span><span class='info'>Kent, S. and R. Atkinson, &ldquo;Security Architecture for the Internet Protocol,&rdquo; November&nbsp;1998.</span><span>)</span></a>.
</p>
<a name="ESN"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
Extended Sequence Number</h3>

<p>In the <a class='info' href='#RFC4302'>[RFC4302]<span> (</span><span class='info'>Kent, S., &ldquo;IP Authentication Header,&rdquo; December&nbsp;2005.</span><span>)</span></a>, there is a provision for a
      64-bit Extended Sequence Number (ESN) as the counter of the sliding
      window used in the anti-replay protocol. Both the sender and the
      receiver maintain a 64-bit counter for the sequence number, although
      only the lower order 32 bits is sent in the transmission. In other
      words, it will not affect the present header format of AH. If ESN is
      used, a sender router can send 2^64 -1 packets without any intervention.
      This number is very large, and from a PIM router's point of view, a PIM
      router can never exceed this number in its lifetime. This makes it
      reasonable to permit manual configuration for a small number of PIM
      routers, since the sequence number will never roll over. For this
      reason, when manual configuration is used, ESN SHOULD be deployed as the
      sequence number for the sliding window protocol.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
Security Considerations</h3>

<p>The whole document considers the security issues of PIM link-local
      messages and proposes a mechanism to protect them.
</p>
<p>Limitations of manual keys:
</p>
<p>The following are some of the known limitations of the usage of
      manual keys.
</p>
<p>
				</p>
<ul class="text">
<li>If replay protection cannot be provided, the PIM routers will not
          be secured against all the attacks that can be performed by
          replaying PIM packets.
</li>
<li>Manual keys are usually long lived (changing them often is a
          tedious task). This gives an attacker enough time to discover the
          keys.
</li>
<li>As the administrator is manually configuring the keys, there is a
          chance that the configured keys are weak (there are known weak keys
          for DES/3DES at least).
</li>
</ul><p>
			
</p>
<p>Impersonation attacks:
</p>
<p>The usage of the same key on all the PIM routers connected to a link
      leaves them all insecure against impersonation attacks if any one of the
      PIM routers is compromised, malfunctioning, or misconfigured.
</p>
<p>Detailed analysis of various vulnerabilities of routing protocols is
      provided in <a class='info' href='#RFC4593'>RFC 4593<span> (</span><span class='info'>Barbir, A., Murphy, S., and Y. Yang, &ldquo;Generic Threats to Routing Protocols,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4593]. For
      further discussion of PIM-SM and multicast security the reader is
      referred to <a class='info' href='#I-D.ietf-pim-lasthop-threats'>[I&#8209;D.ietf&#8209;pim&#8209;lasthop&#8209;threats]<span> (</span><span class='info'>Savola, P. and J. Lingard, &ldquo;Host Threats to Protocol Independent Multicast (PIM),&rdquo; May&nbsp;2008.</span><span>)</span></a>, <a class='info' href='#RFC4609'>RFC 4609<span> (</span><span class='info'>Savola, P., Lehtonen, R., and D. Meyer, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM) Multicast Routing Security Issues and Enhancements,&rdquo; October&nbsp;2006.</span><span>)</span></a> [RFC4609] and the Security
      Considerations section of <a class='info' href='#RFC4601'>RFC 4601<span> (</span><span class='info'>Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised),&rdquo; August&nbsp;2006.</span><span>)</span></a> [RFC4601].
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.16"></a><h3>16.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.17"></a><h3>17.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>17.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4601">[RFC4601]</a></td>
<td class="author-text">Fenner, B., Handley, M., Holbrook, H., and I. Kouvelas, &ldquo;<a href="http://tools.ietf.org/html/rfc4601">Protocol Independent Multicast - Sparse Mode (PIM-SM): Protocol Specification (Revised)</a>,&rdquo; RFC&nbsp;4601, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4601.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc4601.pdf">PDF</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4302">[RFC4302]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4302">IP Authentication Header</a>,&rdquo; RFC&nbsp;4302, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4302.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4301">[RFC4301]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4301.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4303">[RFC4303]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4303, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4303.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4835">[RFC4835]</a></td>
<td class="author-text">Manral, V., &ldquo;<a href="http://tools.ietf.org/html/rfc4835">Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)</a>,&rdquo; RFC&nbsp;4835, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4835.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>17.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2401">[RFC2401]</a></td>
<td class="author-text"><a href="mailto:kent@bbn.com">Kent, S.</a> and <a href="mailto:rja@corp.home.net">R. Atkinson</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2401">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;2401, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2401.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2401.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2401.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3562">[RFC3562]</a></td>
<td class="author-text">Leech, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3562">Key Management Considerations for the TCP MD5 Signature Option</a>,&rdquo; RFC&nbsp;3562, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3562.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IslamThesis">[IslamThesis]</a></td>
<td class="author-text">Islam, S., &ldquo;Security Issues in PIM-SM Link-local Messages, Master's
          Thesis, Concordia University,&rdquo; December&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="IslamLCN2004">[IslamLCN2004]</a></td>
<td class="author-text">Islam, S., &ldquo;Security Issues in PIM-SM Link-local Messages, Proceedings of
          LCN 2004,&rdquo; November&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4306">[RFC4306]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4306.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4535">[RFC4535]</a></td>
<td class="author-text">Harney, H., Meth, U., Colegrove, A., and G. Gross, &ldquo;<a href="http://tools.ietf.org/html/rfc4535">GSAKMP: Group Secure Association Key Management Protocol</a>,&rdquo; RFC&nbsp;4535, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4535.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3547">[RFC3547]</a></td>
<td class="author-text">Baugher, M., Weis, B., Hardjono, T., and H. Harney, &ldquo;<a href="http://tools.ietf.org/html/rfc3547">The Group Domain of Interpretation</a>,&rdquo; RFC&nbsp;3547, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3547.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4593">[RFC4593]</a></td>
<td class="author-text">Barbir, A., Murphy, S., and Y. Yang, &ldquo;<a href="http://tools.ietf.org/html/rfc4593">Generic Threats to Routing Protocols</a>,&rdquo; RFC&nbsp;4593, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4593.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3740">[RFC3740]</a></td>
<td class="author-text">Hardjono, T. and B. Weis, &ldquo;<a href="http://tools.ietf.org/html/rfc3740">The Multicast Group Security Architecture</a>,&rdquo; RFC&nbsp;3740, March&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3740.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-pim-lasthop-threats">[I-D.ietf-pim-lasthop-threats]</a></td>
<td class="author-text">Savola, P. and J. Lingard, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-pim-lasthop-threats-04.txt">Host Threats to Protocol Independent Multicast (PIM)</a>,&rdquo; draft-ietf-pim-lasthop-threats-04 (work in progress), May&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-pim-lasthop-threats-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4609">[RFC4609]</a></td>
<td class="author-text">Savola, P., Lehtonen, R., and D. Meyer, &ldquo;<a href="http://tools.ietf.org/html/rfc4609">Protocol Independent Multicast - Sparse Mode (PIM-SM) Multicast Routing Security Issues and Enhancements</a>,&rdquo; RFC&nbsp;4609, October&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4609.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tsvwg-rsvp-security-groupkeying">[I-D.ietf-tsvwg-rsvp-security-groupkeying]</a></td>
<td class="author-text">Behringer, M. and F. Faucheur, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-rsvp-security-groupkeying-05.txt">Applicability of Keying Methods for RSVP Security</a>,&rdquo; draft-ietf-tsvwg-rsvp-security-groupkeying-05 (work in progress), June&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tsvwg-rsvp-security-groupkeying-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.weis-gdoi-for-rsvp">[I-D.weis-gdoi-for-rsvp]</a></td>
<td class="author-text">Weis, B., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-weis-gdoi-for-rsvp-01.txt">Group Domain of Interpretation (GDOI) support for RSVP</a>,&rdquo; draft-weis-gdoi-for-rsvp-01 (work in progress), February&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-weis-gdoi-for-rsvp-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-msec-ipsec-extensions">[I-D.ietf-msec-ipsec-extensions]</a></td>
<td class="author-text">Weis, B., Gross, G., and D. Ignjatic, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-msec-ipsec-extensions-09.txt">Multicast Extensions to the Security Architecture for the Internet  Protocol</a>,&rdquo; draft-ietf-msec-ipsec-extensions-09 (work in progress), June&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-msec-ipsec-extensions-09.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">J. William Atwood</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Concordia University/CSE</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1455 de Maisonneuve Blvd, West</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Montreal, QC  H3G 1M8</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1(514)848-2424 ext3046</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:bill@cse.concordia.ca">bill@cse.concordia.ca</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://users.encs.concordia.ca/~bill">http://users.encs.concordia.ca/~bill</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Salekul Islam</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Concordia University/CSE</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1455 de Maisonneuve Blvd, West</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Montreal, QC  H3G 1M8</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:salek_is@cse.concordia.ca">salek_is@cse.concordia.ca</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://users.encs.concordia.ca/~salek_is">http://users.encs.concordia.ca/~salek_is</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Maziar Siami</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Concordia University/CIISE</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1455 de Maisonneuve Blvd, West</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Montreal, QC  H3G 1M8</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:m_siamis@ciise.concordia.ca">m_siamis@ciise.concordia.ca</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
