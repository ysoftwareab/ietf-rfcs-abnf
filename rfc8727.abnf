start = iodef

iodef-version = -24
iodef-lang = -23
iodef-format-id = -22
iodef-private-enum-name = -21
iodef-private-enum-id = -20
iodef-Incident = -19
iodef-AdditionalData = -18
iodef-value = -17
iodef-translation-id = -16
iodef-name = -15
iodef-dtype = -14
iodef-ext-dtype = -13
iodef-meaning = -12
iodef-formatid = -11
iodef-restriction = -10
iodef-ext-restriction = -9
iodef-observable-id = -8
iodef-SoftwareReference = -7
iodef-URL = -6
iodef-Description = -5
iodef-spec-name = -4
iodef-ext-spec-name = -3
iodef-purpose = -2
iodef-ext-purpose = -1
iodef-status = 0
iodef-ext-status = 1
iodef-IncidentID = 2
iodef-AlternativeID = 3
iodef-RelatedActivity = 4
iodef-DetectTime = 5
iodef-StartTime = 6
iodef-EndTime = 7
iodef-RecoveryTime = 8
iodef-ReportTime = 9
iodef-GenerationTime = 10
iodef-Discovery = 11
iodef-Assessment = 12
iodef-Method = 13
iodef-Contact = 14
iodef-EventData = 15
iodef-Indicator = 16
iodef-History = 17
iodef-id = 18
iodef-instance = 19
iodef-ThreatActor = 20
iodef-Campaign = 21
iodef-IndicatorID = 22
iodef-Confidence = 23
iodef-ThreatActorID = 24
iodef-CampaignID = 25
iodef-role = 26
iodef-ext-role = 27
iodef-type = 28
iodef-ext-type = 29
iodef-ContactName = 30
iodef-ContactTitle = 31
iodef-RegistryHandle = 32
iodef-PostalAddress = 33
iodef-Email = 34
iodef-Telephone = 35
iodef-Timezone = 36
iodef-handle = 37
iodef-registry = 38
iodef-ext-registry = 39
iodef-PAddress = 40
iodef-EmailTo = 41
iodef-TelephoneNumber = 42
iodef-source = 43
iodef-ext-source = 44
iodef-DetectionPattern = 45
iodef-DetectionConfiguration = 46
iodef-Application = 47
iodef-Reference = 48
iodef-AttackPattern = 49
iodef-Vulnerability = 50
iodef-Weakness = 51
iodef-SpecID = 52
iodef-ext-SpecID = 53
iodef-ContentID = 54
iodef-RawData = 55
iodef-Platform = 56
iodef-Scoring = 57
iodef-ReferenceName = 58
iodef-specIndex = 59
iodef-ID = 60
iodef-occurrence = 61
iodef-IncidentCategory = 62
iodef-Impact = 63
iodef-SystemImpact = 64
iodef-BusinessImpact = 65
iodef-TimeImpact = 66
iodef-MonetaryImpact = 67
iodef-IntendedImpact = 68
iodef-Counter = 69
iodef-MitigatingFactor = 70
iodef-Cause = 71
iodef-severity = 72
iodef-completion = 73
iodef-ext-severity = 74
iodef-metric = 75
iodef-ext-metric = 76
iodef-duration = 77
iodef-ext-duration = 78
iodef-currency = 79
iodef-rating = 80
iodef-ext-rating = 81
iodef-HistoryItem = 82
iodef-action = 83
iodef-ext-action = 84
iodef-DateTime = 85
iodef-DefinedCOA = 86
iodef-System = 87
iodef-Expectation = 88
iodef-RecordData = 89
iodef-category = 90
iodef-ext-category = 91
iodef-interface = 92
iodef-spoofed = 93
iodef-virtual = 94
iodef-ownership = 95
iodef-ext-ownership = 96
iodef-Node = 97
iodef-NodeRole = 98
iodef-Service = 99
iodef-OperatingSystem = 100
iodef-AssetID = 101
iodef-DomainData = 102
iodef-Address = 103
iodef-Location = 104
iodef-vlan-name = 105
iodef-vlan-num = 106
iodef-unit = 107
iodef-ext-unit = 108
iodef-system-status = 109
iodef-ext-system-status = 110
iodef-domain-status = 111
iodef-ext-domain-status = 112
iodef-Name = 113
iodef-DateDomainWasChecked = 114
iodef-RegistrationDate = 115
iodef-ExpirationDate = 116
iodef-RelatedDNS = 117
iodef-NameServers = 118
iodef-DomainContacts = 119
iodef-Server = 120
iodef-SameDomainContact = 121
iodef-ip-protocol = 122
iodef-ServiceName = 123
iodef-Port = 124
iodef-Portlist = 125
iodef-ProtoCode = 126
iodef-ProtoType = 127
iodef-ProtoField = 128
iodef-ApplicationHeaderField = 129
iodef-EmailData = 130
iodef-IANAService = 131
iodef-EmailFrom = 132
iodef-EmailSubject = 133
iodef-EmailX-Mailer = 134
iodef-EmailHeaderField = 135
iodef-EmailHeaders = 136
iodef-EmailBody = 137
iodef-EmailMessage = 138
iodef-HashData = 139
iodef-Signature = 140
iodef-RecordPattern = 141
iodef-RecordItem = 142
iodef-FileData = 143
iodef-WindowsRegistryKeysModified = 144
iodef-CertificateData = 145
iodef-offset = 146
iodef-offsetunit = 147
iodef-ext-offsetunit = 148
iodef-Key = 149
iodef-registryaction = 150
iodef-ext-registryaction = 151
iodef-KeyName = 152
iodef-KeyValue = 153
iodef-Certificate = 154
iodef-X509Data = 155
iodef-File = 156
iodef-FileName = 157
iodef-FileSize = 158
iodef-FileType = 159
iodef-AssociatedSoftware = 160
iodef-FileProperties = 161
iodef-scope = 162
iodef-HashTargetID = 163
iodef-Hash = 164
iodef-FuzzyHash = 165
iodef-DigestMethod = 166
iodef-DigestValue = 167
iodef-CanonicalizationMethod = 168
iodef-FuzzyHashValue = 169
iodef-AlternativeIndicatorID = 170
iodef-Observable = 171
iodef-uid-ref = 172
iodef-IndicatorExpression = 173
iodef-IndicatorReference = 174
iodef-AttackPhase = 175
iodef-BulkObservable = 176
iodef-BulkObservableFormat = 177
iodef-BulkObservableList = 178
iodef-operator = 179
iodef-ext-operator = 180
iodef-euid-ref = 181
iodef-AttackPhaseID = 182

iodef = {
iodef-version => text,
iodef-Incident => [+ Incident],
duration = "second" / "minute" / "hour" / "day" / "month" /
lang = "" / text .regexp "[a-zA-Z]{1,8}(-[a-zA-Z0-9]{1,8})*"

restriction = "public" / "partner" / "need-to-know" / "private" /
SpecID = "urn:ietf:params:xml:ns:mile:mmdef:1.2" /  "private"
IDtype = text .regexp "[a-zA-Z_][a-zA-Z0-9_.-]*"
IDREFType = IDtype
URLtype = uri
TimeZonetype = text .regexp "Z|[\\+\\-](0[0-9]|1[0-4]):[0-5][0-9]"
PortlistType = text .regexp
                           "[0-9]+(\\-[0-9]+)?(,[0-9]+(\\-[0-9]+)?)*"
action = "nothing" / "contact-source-site" / "contact-target-site" /
DATETIME = tdate

BYTE = eb64legacy

MLStringType = {
iodef-value => text,
PositiveFloatType = float32 .gt 0

PAddressType = MLStringType

ExtensionType  = {
iodef-value => text,
iodef-dtype => "boolean" / "byte" / "bytes" / "character" /
SoftwareType = {
    ? iodef-SoftwareReference => SoftwareReference,
    ? iodef-URL => [+ URLtype],
    ? iodef-Description => [+ MLStringType]
SoftwareReference = {
    ? iodef-value => text,
iodef-spec-name => "custom" / "cpe" / "swid" / "ext-value",
Incident = {
iodef-purpose => "traceback" / "mitigation" / "reporting" /
iodef-IncidentID => IncidentID,
iodef-GenerationTime => DATETIME,
iodef-Contact => [+ Contact],
IncidentID = {
iodef-id => text,
iodef-name => text,
AlternativeID = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
iodef-IncidentID => [+ IncidentID]
RelatedActivity = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? iodef-IncidentID => [+ IncidentID],
    ? iodef-URL => [+ URLtype],
    ? iodef-ThreatActor => [+ ThreatActor],
    ? iodef-Campaign => [+ Campaign],
    ? iodef-IndicatorID => [+ IndicatorID],
    ? iodef-Confidence => Confidence,
    ? iodef-Description => [+ text],
    ? iodef-AdditionalData => [+ ExtensionType]
ThreatActor = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? iodef-ThreatActorID => [+ text],
    ? iodef-URL => [+ URLtype],
    ? iodef-Description => [+ MLStringType],
    ? iodef-AdditionalData => [+ ExtensionType]
Campaign  = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? iodef-CampaignID => [+ text],
    ? iodef-URL => [+ URLtype],
    ? iodef-Description => [+ MLStringType],
    ? iodef-AdditionalData => [+ ExtensionType]
Contact = {
iodef-role => "creator" / "reporter" / "admin" / "tech" /
iodef-type => "person" / "organization" / "ext-value",
RegistryHandle = {
iodef-handle => text,
iodef-registry => "internic" / "apnic" / "arin" / "lacnic" /
PostalAddress = {
    ? iodef-type => "street" / "mailing" / "ext-value",
    ? iodef-ext-type => text,
iodef-PAddress => PAddressType,
Email = {
    ? iodef-type => "direct" / "hotline" / "ext-value",
    ? iodef-ext-type => text,
iodef-EmailTo => text,
Telephone = {
    ? iodef-type => "wired" / "mobile" / "fax" / "hotline" /
    "ext-value",
    ? iodef-ext-type => text,
iodef-TelephoneNumber => text,
Discovery = {
    ? iodef-source => "nidps" / "hips" / "siem" / "av" /
DetectionPattern = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? iodef-observable-id => IDtype,
    (iodef-Description => [+ MLStringType] //
iodef-DetectionConfiguration => [+ text]),
iodef-Application => SoftwareType
Method = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? iodef-Reference => [+ Reference],
    ? iodef-Description => [+ MLStringType],
    ? iodef-AttackPattern => [+ STRUCTUREDINFO],
    ? iodef-Vulnerability => [+ STRUCTUREDINFO],
    ? iodef-Weakness => [+ STRUCTUREDINFO],
    ? iodef-AdditionalData => [+ ExtensionType]
STRUCTUREDINFO = {
iodef-SpecID => SpecID,
Platform = {
iodef-SpecID => SpecID,
Scoring = {
iodef-SpecID => SpecID,
Reference = {
    ? iodef-observable-id => IDtype,
    ? iodef-ReferenceName => ReferenceName,
    ? iodef-URL => [+ URLtype],
    ? iodef-Description => [+ MLStringType]
ReferenceName = {
iodef-specIndex => integer,
iodef-ID => IDtype
Assessment = {
    ? iodef-occurrence => "actual" / "potential",
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? iodef-observable-id => IDtype,
    ? iodef-IncidentCategory => [+ MLStringType],
iodef-Impact => [+ {iodef-SystemImpact => SystemImpact} /
             {iodef-BusinessImpact => BusinessImpact /
             {iodef-TimeImpact => TimeImpact} /
             {iodef-MonetaryImpact => MonetaryImpact} /
             {iodef-IntendedImpact => BusinessImpact}],
SystemImpact = {
    ? iodef-severity => "low" / "medium" / "high",
    ? iodef-completion => "failed" / "succeeded",
iodef-type => "takeover-account" / "takeover-service" /
BusinessImpact = {
iodef-type => "breach-proprietary" / "breach-privacy" /
TimeImpact = {
iodef-value => PositiveFloatType,
iodef-metric => "labor" / "elapsed" / "downtime" / "ext-value",
MonetaryImpact = {
iodef-value => PositiveFloatType,
Confidence = {
iodef-value => float32,
iodef-rating => "low" / "medium" / "high" / "numeric" / "unknown" /
History = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
iodef-HistoryItem => [+ HistoryItem]
HistoryItem = {
iodef-action => action .default "other",
iodef-DateTime => DATETIME,
EventData = {
    ? iodef-restriction => restriction .default "default",
    ? iodef-ext-restriction => text,
    ? iodef-observable-id => IDtype,
    ? iodef-Description => [+ MLStringType],
    ? iodef-DetectTime => DATETIME,
    ? iodef-StartTime => DATETIME,
    ? iodef-EndTime => DATETIME,
    ? iodef-RecoveryTime => DATETIME,
    ? iodef-ReportTime => DATETIME,
    ? iodef-Contact => [+ Contact],
    ? iodef-Discovery => [+ Discovery],
    ? iodef-Assessment => Assessment,
    ? iodef-Method => [+ Method],
    ? iodef-System => [+ System],
    ? iodef-Expectation => [+ Expectation],
    ? iodef-RecordData => [+ RecordData],
    ? iodef-EventData => [+ EventData],
    ? iodef-AdditionalData => [+ ExtensionType]
Expectation = {
    ? iodef-action => action .default "other",
    ? iodef-ext-action => text,
    ? iodef-severity => "low" / "medium" / "high",
    ? iodef-restriction => restriction .default "default",
    ? iodef-ext-restriction => text,
    ? iodef-observable-id => IDtype,
    ? iodef-Description => [+ MLStringType],
    ? iodef-DefinedCOA => [+ text],
    ? iodef-StartTime => DATETIME,
    ? iodef-EndTime => DATETIME,
    ? iodef-Contact => Contact
System = {
    ? iodef-category => "source" / "target" / "intermediate" /
iodef-Node => Node,
Node = {
    (iodef-DomainData => [+ DomainData] //
iodef-Address => [+ Address]),
Address = {
iodef-value => text,
iodef-category => "asn" / "atm" / "e-mail" / "ipv4-addr" /
NodeRole = {
iodef-category => "client" / "client-enterprise" /
Counter = {
iodef-value => float32,
iodef-type => "count" / "peak" / "average" / "ext-value",
iodef-unit => "byte" / "mbit" / "packet" / "flow" / "session" /
DomainData = {
iodef-system-status => "spoofed" / "fraudulent" /
iodef-domain-status => "reservedDelegation" / "assignedAndActive" /
iodef-Name => text,
NameServers = {
iodef-Server => text,
iodef-Address => [+ Address]
DomainContacts = {
    (iodef-SameDomainContact => text // iodef-Contact => [+ Contact])
Service = {
    ? iodef-ip-protocol => integer,
    ? iodef-observable-id => IDtype,
    ? iodef-ServiceName => ServiceName,
    ? iodef-Port => integer,
    ? iodef-Portlist => PortlistType,
    ? iodef-ProtoCode => integer,
    ? iodef-ProtoType => integer,
    ? iodef-ProtoField => integer,
    ? iodef-ApplicationHeaderField => [+ ExtensionType],
    ? iodef-EmailData => EmailData,
    ? iodef-Application => SoftwareType
ServiceName = {
    ? iodef-IANAService => text,
    ? iodef-URL => [+ URLtype],
    ? iodef-Description => [+ MLStringType]
EmailData = {
    ? iodef-observable-id => IDtype,
    ? iodef-EmailTo => [+ text],
    ? iodef-EmailFrom => text,
    ? iodef-EmailSubject => text,
    ? iodef-EmailX-Mailer => text,
    ? iodef-EmailHeaderField => [+ ExtensionType],
    ? iodef-EmailHeaders => text,
    ? iodef-EmailBody => text,
    ? iodef-EmailMessage => text,
    ? iodef-HashData => [+ HashData],
    ? iodef-Signature => [+ BYTE]
RecordData = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? iodef-observable-id => IDtype,
    ? iodef-DateTime => DATETIME,
    ? iodef-Description => [+ MLStringType],
    ? iodef-Application => SoftwareType,
    ? iodef-RecordPattern => [+ RecordPattern],
    ? iodef-RecordItem => [+ ExtensionType],
    ? iodef-URL => [+ URLtype],
    ? iodef-FileData => [+ FileData],
    ? iodef-WindowsRegistryKeysModified =>
                                   [+ WindowsRegistryKeysModified],
    ? iodef-CertificateData => [+ CertificateData],
    ? iodef-AdditionalData => [+ ExtensionType]
RecordPattern = {
iodef-value => text,
iodef-type => "regex" / "binary" / "xpath" /
WindowsRegistryKeysModified = {
    ? iodef-observable-id => IDtype,
iodef-Key => [+ Key]
Key = {
    ? iodef-registryaction => "add-key" / "add-value" / "delete-key" /
iodef-KeyName => text,
CertificateData = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? iodef-observable-id => IDtype,
iodef-Certificate => [+ Certificate]
Certificate = {
    ? iodef-observable-id => IDtype,
iodef-X509Data => BYTE,
FileData = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? iodef-observable-id => IDtype,
iodef-File => [+ File]
File = {
    ? iodef-observable-id => IDtype,
    ? iodef-FileName => text,
    ? iodef-FileSize => integer,
    ? iodef-FileType => text,
    ? iodef-URL => [+ URLtype],
    ? iodef-HashData => HashData,
    ? iodef-Signature => [+ BYTE],
    ? iodef-AssociatedSoftware => SoftwareType,
    ? iodef-FileProperties => [+ ExtensionType]
HashData = {
iodef-scope => "file-contents" / "file-pe-section" /
Hash = {
iodef-DigestMethod => BYTE,
iodef-DigestValue => BYTE,
FuzzyHash = {
iodef-FuzzyHashValue => [+ ExtensionType],
Indicator = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
iodef-IndicatorID => IndicatorID,
iodef-IndicatorExpression => IndicatorExpression //
iodef-IndicatorReference => IndicatorReference),
IndicatorID = {
iodef-id => IDtype,
iodef-name => text,
iodef-version => text
AlternativeIndicatorID = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
iodef-IndicatorID => [+ IndicatorID]
Observable = {
    ? iodef-restriction => restriction .default "private",
    ? iodef-ext-restriction => text,
    ? (iodef-System => System // iodef-Address => Address //
iodef-DomainData => DomainData //
iodef-EmailData => EmailData //
iodef-Service => Service //
iodef-WindowsRegistryKeysModified =>
                                     WindowsRegistryKeysModified //
iodef-FileData => FileData //iodef-CertificateData =>
                                                 CertificateData //
iodef-RegistryHandle =>RegistryHandle// iodef-RecordData =>
                                                     RecordData //
iodef-EventData => EventData // iodef-Incident => Incident //
iodef-Expectation => Expectation // iodef-Reference =>
                                                       Reference //
iodef-Assessment => Assessment //
iodef-DetectionPattern => DetectionPattern //
iodef-HistoryItem => HistoryItem //
iodef-BulkObservable => BulkObservable //
iodef-AdditionalData => [+ ExtensionType])
BulkObservable = {
    ? iodef-type => "asn" / "atm" / "e-mail" / "ipv4-addr" /
iodef-BulkObservableList => text,
BulkObservableFormat = {
    (iodef-Hash => Hash // iodef-AdditionalData => [+ ExtensionType])
IndicatorExpression = {
    ? iodef-operator => "not" / "and" / "or" / "xor" .default "and",
    ? iodef-ext-operator => text,
    ? iodef-IndicatorExpression => [+ IndicatorExpression],
    ? iodef-Observable => [+ Observable],
    ? iodef-uid-ref => [+ IDREFType],
    ? iodef-IndicatorReference => [+ IndicatorReference],
    ? iodef-Confidence => Confidence,
    ? iodef-AdditionalData => [+ ExtensionType]
IndicatorReference = {
    (iodef-uid-ref => IDREFType // iodef-euid-ref => text),
    ? iodef-version => text
AttackPhase = {
    ? iodef-AttackPhaseID => [+ text],
    ? iodef-URL => [+ URLtype],
    ? iodef-Description => [+ MLStringType],
    ? iodef-AdditionalData => [+ ExtensionType]
