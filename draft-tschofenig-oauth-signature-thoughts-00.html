<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Thoughts about Digital Signatures for the Open Web Authentication
    (OAuth) Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Thoughts about Digital Signatures for the Open Web Authentication
    (OAuth) Protocol">
<meta name="keywords" content="Internet-Draft, OAuth, Open Web Authentication, Signatures, Security, Message Authentication">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">OAUTH</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">B. Cook</td></tr>
<tr><td class="header">Expires: April 21, 2011</td><td class="header">BT</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 18, 2010</td></tr>
</table></td></tr></table>
<h1><br />Thoughts about Digital Signatures for the Open Web Authentication
    (OAuth) Protocol<br />draft-tschofenig-oauth-signature-thoughts-00.txt</h1>

<h3>Abstract</h3>

<p>The initial version of the Open Web Authentication Protocol (OAuth 1.0), often referred to as the community addition, included an 
      mechanism for putting a digital signature (when using asymmetric keys) or a keyed message digest (when using symmetric keys) to a resource request when presenting the OAuth token.
      This cryptographic mechanism has lead to lots of discussions, particularly about the problems implementers had, the use cases
      it supports, and the benefit-cost tradeoff. 
</p>
<p>This document tries to describe the use of the so-called 'OAuth Signature' mechamism in an unbiased and less emotional way with the main purpose to conclude the discussions.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 21, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#threats">3.</a>&nbsp;
Security Threats<br />
<a href="#mitigation">4.</a>&nbsp;
Threat Mitigation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#confidentiality">4.1.</a>&nbsp;
Confidentiality Protection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#intended">4.2.</a>&nbsp;
Sender Constraint<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#confirmation">4.3.</a>&nbsp;
Key Confirmation<br />
<a href="#summary">5.</a>&nbsp;
Summary<br />
<a href="#ops-cons">6.</a>&nbsp;
Operational Considerations<br />
<a href="#sec-cons">7.</a>&nbsp;
Security Considerations<br />
<a href="#conclusion">8.</a>&nbsp;
Conclusion<br />
<a href="#iana">9.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor1">10.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The initial version of the Open Web Authentication Protocol (OAuth 1.0) included an 
      mechanism for putting a digital signature (when using asymmetric keys) or a keyed message digest (when using symmetric keys) to a resource request when presenting the OAuth token.
      OAuth 2.0 generalized the structure a bit and the abstract and simplified description of the protocol has the following structure:
      
          <br /><hr class="insert" />
<a name="oauth-simplified"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                      ,-.
                     (* *)
                      `+'  User
                       '
    :------------   ---|---  ~~~~~~~~~~:
    : Service         / \              : Management
    : Interaction    /   \             : of Resources
    :                  : Consent       :
    :                  :               :
    :                  :               :
    :              +---:-+ Carol       :
    :    1.        |Carol| as          :
    :  Obtain   .'&gt;|     | Asserting   :
    :  Access .'   +-----+ Party       :
    :  Token.'                         :
    :     .'                           :
    :   .'                             :
    : v'                               :
  +-:---+                           +--:--+ Bob
  |Alice|&lt;-------------------------&gt;|Bob  | as
  |     |      2. Authenticated     |     | Relying
  +-----+         Request +         +-----+ Party
                  Access Token

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: OAuth Simplified&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

        
</p>
<p>We use symbolic names in <a class='info' href='#oauth-simplified'>Figure&nbsp;1<span> (</span><span class='info'>OAuth Simplified</span><span>)</span></a>. A few remarks about the figure. In addition to illustrating the message exchange between Alice, Bob, and Carl it also highlights the importance of the user in the exchange in providing consent, triggering the entire interaction as part of invoking a service, and in managing a resource that is work delegating access to.
</p>
<p>From a cryptographic point of view the following aspects of the OAuth 1.0 specification are worth mentioning:

</p>
<ul class="text">
<li>The format and content of the Access Token is not specified.
</li>
<li>The authenticated request shown in (2) is essentially a basic HTTP authentication mechanism that supports symmetric as well as asymmetric credentials. The purpose is to authenticate Alice to Bob; no mutual authentication. The procedure for obtaining these credentials is outside the scope. To ensure liveness of the authentication a timestamp and a nonce is included in the request (and is included in the digital signature and the keyed message digest).
</li>
<li>The authenticated request signing is optional to implement and optional to use. When the authenticated request signature is omitted (called bearer token) then TLS. Details about what ciphersuite to use with TLS and what required features are needed are not available. 
</li>
</ul><p>

</p>
<p>OAuth 2.0 <a class='info' href='#I-D.ietf-oauth-v2'>[I&#8209;D.ietf&#8209;oauth&#8209;v2]<span> (</span><span class='info'>Hammer-Lahav, E., Recordon, D., and D. Hardt, &ldquo;The OAuth 2.0 Protocol,&rdquo; July&nbsp;2010.</span><span>)</span></a> currently does not provide text for authenticated requests in the specification nor does it mandate the use of TLS.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
        "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
        RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>This document uses the terminology defined in RFC 4949 <a class='info' href='#RFC4949'>[RFC4949]<span> (</span><span class='info'>Shirey, R., &ldquo;Internet Security Glossary, Version 2,&rdquo; August&nbsp;2007.</span><span>)</span></a>. The terms 'keyed hash' and 'keyed message digest' are used interchangable.

</p>
<p>All discussions in this document refer to the abstract names, namely Alice, Bob, and Carol, shown in <a class='info' href='#oauth-simplified'>Figure&nbsp;1<span> (</span><span class='info'>OAuth Simplified</span><span>)</span></a>.
</p>
<a name="threats"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Security Threats</h3>

<p>The following list presents several common threats against protocols utilizing some form of tokens. This list of threats is based on NIST Special Publication 800-63 <a class='info' href='#NIST800-63'>[NIST800&#8209;63]<span> (</span><span class='info'>Burr, W., Dodson, D., Perlner, R., Polk, T., Gupta, S., and E. Nabbus, &ldquo;NIST Special Publication 800-63-1, INFORMATION SECURITY,&rdquo; December&nbsp;2008.</span><span>)</span></a>. We exclude a discussion of threats related to any form of registration and authentication.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Token manufacture/modification:</dt>
<dd> An attacker may generate a bogus token or modify the token content (such as the authentication or attribute statements) of an existing token, causing Bob to grant inappropriate access to the Alice. For example, an attacker may modify the token to extend the validity period; Alice may modify the assertion to have access to information that they should not be able to view.
</dd>
<dt>Token disclosure:</dt>
<dd>Tokens may contain authentication and attribute statements that include sensitive information.
</dd>
<dt>Token redirect:</dt>
<dd>An attacker uses the token generated for consumption by Bob to obtain access to a second Relying Party.
</dd>
<dt>Token reuse:</dt>
<dd> An attacker attempts to use a token that has already been used once with Bob.
</dd>
</dl></blockquote><p> 

</p>
<p>A Web authentication protocol must provide a consistent story on how to deal with all these threats. We excluded one threat from the list, namely 'token repudiation'. Token repudiation refers to a property whereby Bob is given an assurance that Carol cannot deny to have created a token for Alice. We believe that such a property is interesting from theoretical point of view but most deployments perfer to deal with the violation of this security property via business actions rather than using cryptography.
</p>
<a name="mitigation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Threat Mitigation</h3>

<p>A large range of threats can be mitigated by protecting the content of the token, using a digitial signature or a keyed message digest. Alternatively, the content of the token could be passed by reference rather than by value (requiring a separate message exchange to resolve the reference to the token content). To simplify the subsequent description we assume that the token itself is digitally signed by Carol and therefore cannot be modified. This also provides the basis for non-repudiation.
</p>
<p>To deal with token redirect it is important for Carol to include the identity of the intended recipient, namely Bob. Carol would have to be told that Bob is the intended recipient.
</p>
<p>To provide protection against token disclosure two approaches are possible, namely (a) not to include sensitive information inside the token or (b) to ensure confidentiality protection. The latter feature requires at least the communication interaction between the Alice and Carol as well as the interaction between Alice and Bob to experience confidentiality protection. As an example, Transport Layer Security with a ciphersuite that offers confidentiality protection has to be applied. Encrypting the token content is another alternative. 

</p>
<p>To deal with the last threat, namely token reuse, more choices are available. First, it is highly advisable for Carol to restrict the lifetime of the token by putting a validity time field inside the protected part of the token. This is, however, largely independent of the potential approaches described in the sub-sections below. 
</p>
<a name="confidentiality"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Confidentiality Protection</h3>

<p>In this approach confidentiality protection of the exchange is provided on the communication interfaces between Alice and Bob, and Alice and Carol. No eavesdropper on the wire is able to observe the token exchange. Consequently, a replay is not possible. Carol wants to ensure that it only hands out tokens to entities it has authenticated first and who are authorized. For this purpose, authentication of Alice to Carol will be a requirement. This is, however, true for the description in <a class='info' href='#intended'>Section&nbsp;4.2<span> (</span><span class='info'>Sender Constraint</span><span>)</span></a> and <a class='info' href='#confirmation'>Section&nbsp;4.3<span> (</span><span class='info'>Key Confirmation</span><span>)</span></a> as well. Furthermore, Alice has to make sure it does not distribute the token to entities other than Bob. For that purpose Alice will have to authenticate Bob before transmitting the token.

</p>
<a name="intended"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Sender Constraint</h3>

<p>Instead of providing confidentiality protection Carl could also put the identity of Alice into the protected token with the following semantic: 'This token is only valid when presented by Alice.' When the token is then presented to Bob how does he know that it was provided by Alice? He has to authenticate Alice! There are many choices for authenticating Alice to Bob, such as, client-side certificates in TLS <a class='info' href='#RFC5246'>[RFC5246]<span> (</span><span class='info'>Dierks, T. and E. Rescorla, &ldquo;The Transport Layer Security (TLS) Protocol Version 1.2,&rdquo; August&nbsp;2008.</span><span>)</span></a>, or pre-shared secrets within TLS <a class='info' href='#RFC4279'>[RFC4279]<span> (</span><span class='info'>Eronen, P. and H. Tschofenig, &ldquo;Pre-Shared Key Ciphersuites for Transport Layer Security (TLS),&rdquo; December&nbsp;2005.</span><span>)</span></a>. The choice of the preferred authentication mechanism and credential type may depend on a number of factors, including </p>
<ul class="text">
<li>security properties
</li>
<li>available infrastructure
</li>
<li>library support
</li>
<li>credential cost (financial)
</li>
<li>performance
</li>
<li>integration into the existing IT infrastructure
</li>
<li>operational overhead for configuration and distribution of credentials
</li>
</ul><p> 

</p>
<p>This long list hints to the challenge of selecting at least one mandatory-to-implement mechanism.
</p>
<a name="confirmation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Key Confirmation</h3>

<p>A variation of the mechanism of sender authentication described in <a class='info' href='#intended'>Section&nbsp;4.2<span> (</span><span class='info'>Sender Constraint</span><span>)</span></a> is to replace authentication with the proof-of-possession of a specific key, i.e. key confirmation. In this model Bob would not authenticate Alice but would rather verify whether Alice knows a secret. This mechanism corresponds to the message signature approach defined by the OAuth 1.0 signature mechanisms <a class='info' href='#RFC5849'>[RFC5849]<span> (</span><span class='info'>Hammer-Lahav, E., &ldquo;The OAuth 1.0 Protocol,&rdquo; April&nbsp;2010.</span><span>)</span></a> or by Kerberos <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a> when utilizing the AP_REQ/AP_REP exchange (see <a class='info' href='#I-D.hardjono-oauth-kerberos'>[I&#8209;D.hardjono&#8209;oauth&#8209;kerberos]<span> (</span><span class='info'>Hardjono, T., &ldquo;OAuth 2.0 support for the Kerberos V5 Authentication Protocol,&rdquo; June&nbsp;2010.</span><span>)</span></a> for a comparision between Kerberos and OAuth).
</p>
<p>To illustrate key confirmation the first examples borrows from Kerberos and symmetric key cryptography. Assume that Carol shares a long-term secret with Bob, called K(Carol-Bob). This secret would be established between them in an initial registration phase outside the scope of the actual protocol run. When Alice requests a token Carol creates a fresh and unique key Ks and places it into the token encrypted with K(Carol-Bob). Additionally, Carol attaches Ks when it sends the token to Alice over a confidentialy protected channel. When Alice sends a request to Bob it has to use Ks to sign the request (in whatever form or whatever layer). Bob, when receiving the message, retrieves the token, verifies it and uses K(Carol-Bob) to decrypt Ks and to verify the signature.  

</p>
<p>Note that in this example one could imagine that the mechanism to protect the token itself is based on a symmetric key based mechanism to avoid any form of public key infrastructure but this aspect is not further eleborated in the scenario.
</p>
<p>A similar mechanism can also be designed using asymmetric cryptography. When Alice requests a token Carol creates an ephemeral public / privacy key pair PK/SK and places the public key PK into the protected token. When Carol returns the token to Alice it also provides the PK/SK key pair over a confidentialy protected channel. When Alice sends a request to Bob it has to use the privacy key SK to sign the request. Again, the details are secondary. Bob, when receiving the message, retrieves the token, verifies it and extracts the public key PK. It uses this ephemeral public key to verify the attached signature.
</p>
<a name="summary"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Summary</h3>

<p>In the design of the OAuth security mechanisms the following design decisions have to be made: 
   </p>
<blockquote class="text"><dl>
<dt>Threats:</dt>
<dd> <a class='info' href='#threats'>Section&nbsp;3<span> (</span><span class='info'>Security Threats</span><span>)</span></a> lists a few security threats. Are these the threats you care about? Are threats missing?
</dd>
<dt>Threat Mitigation:</dt>
<dd> <a class='info' href='#mitigation'>Section&nbsp;4<span> (</span><span class='info'>Threat Mitigation</span><span>)</span></a> illustrates how to address the threats listed in <a class='info' href='#threats'>Section&nbsp;3<span> (</span><span class='info'>Security Threats</span><span>)</span></a>. Do you agree that these are the approaches to address the threats? Do you agree that the three approaches to address token re-use (see <a class='info' href='#confidentiality'>Section&nbsp;4.1<span> (</span><span class='info'>Confidentiality Protection</span><span>)</span></a>, <a class='info' href='#intended'>Section&nbsp;4.2<span> (</span><span class='info'>Sender Constraint</span><span>)</span></a>, and <a class='info' href='#confirmation'>Section&nbsp;4.3<span> (</span><span class='info'>Key Confirmation</span><span>)</span></a>) are roughly equivalent from a security point of view (even though they are not equivalent from an operational perspective)?   

</dd>
<dt>Token Protection and Token Content:</dt>
<dd> Do you agree that many security properties are dependent on the token content and the token protection?
</dd>
</dl></blockquote><p>

</p>
<a name="ops-cons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Operational Considerations</h3>

<p>It is worth pointing out that the operational aspects in the deployment of OAuth have an impact on the design. While the authors believe that the three approaches to address token re-use are equivalent there are operational challenges with each of them. The purpose of the discussion in this section is therefore to determine, which approach encourages good practices that lead to better security of the overall system based on the most likely behavior of its actors.
</p>
<p>The three approaches are: </p>
<blockquote class="text"><dl>
<dt>Confidentiality Protection:</dt>
<dd>The weak point with this approach, see <a class='info' href='#confidentiality'>Section&nbsp;4.1<span> (</span><span class='info'>Confidentiality Protection</span><span>)</span></a>, is that Alice has to be careful to whom she discloses the token. Everyone who is in possession of the token is granted access to the data. Furthermore, Alice has to trust Bob to secure the token at rest; unauthorized disclosure could be harmful particularly when the token has a rather long lifetime. Intiuitively, one would argue that tokens are easy to mint and used for a small time duration only.
</dd>
<dt>Sender Constraint:</dt>
<dd>The weak point with this approach, see <a class='info' href='#intended'>Section&nbsp;4.2<span> (</span><span class='info'>Sender Constraint</span><span>)</span></a>, is to setup the authentication infrastructure such that Alice can be authenticated towards Bob. Additionally, Carol to correctly encode Alice's identity in the token for verification by Bob. Depending on the chosen layer for providing client-side authentication there may be additional challenges due Web server load balancing, lack of API access to identity information, etc. 

</dd>
<dt>Key Confirmation:</dt>
<dd>The weak point with this approach, see <a class='info' href='#confirmation'>Section&nbsp;4.3<span> (</span><span class='info'>Key Confirmation</span><span>)</span></a>, is the increased complexity: a key distribution protocol has to be defined.  
  
</dd>
</dl></blockquote><p> 
   
</p>
<a name="sec-cons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>The main focus of this document is on security. Nevertheless, the authors would like to point out that the design of the stoken encoding and token content is currently not standardized. While this motivated by the current OAuth deployment environment and the desire to offer flexibility there are concerns about the ability of those deploying OAuth making reasonable design choices. We recommend to consult 'How to Implement Secure (Mostly) Stateless Tokens' <a class='info' href='#I-D.rescorla-stateless-tokens'>[I&#8209;D.rescorla&#8209;stateless&#8209;tokens]<span> (</span><span class='info'>Rescorla, E., &ldquo;How to Implement Secure (Mostly) Stateless Tokens,&rdquo; March&nbsp;2007.</span><span>)</span></a> before designing a custom token format.
</p>
<p>RFC 4962 <a class='info' href='#RFC4962'>[RFC4962]<span> (</span><span class='info'>Housley, R. and B. Aboba, &ldquo;Guidance for Authentication, Authorization, and Accounting (AAA) Key Management,&rdquo; July&nbsp;2007.</span><span>)</span></a> gives useful guidelines for designers of key management protocols. While the document was written with the AAA framework and network access authentication in mind the offered suggestions are useful for the design of OAuth and particularly interesting for solutions belonging to the 'key confirmation' class. These requirements include 
   </p>
<ol class="text">
<li>Cryptographic algorithm independent
</li>
<li>Strong, fresh session keys
</li>
<li>Limit key scope
</li>
<li>Replay detection mechanism
</li>
<li>Authenticate all parties
</li>
<li>Keying material confidentiality and integrity
</li>
<li>Confirm ciphersuite selection
</li>
<li>Uniquely named keys
</li>
<li>Prevent the Domino effect
</li>
<li>Bind key to its context
</li>
<li>Confidentiality of identity
</li>
<li>Authorization restriction
</li>
</ol><p>
   
</p>
<p>The authors believe it is useful to consider these requirements in the protocol design since the 'token' terminology seems to implicitly suggest to hand out cryptographic keying material and meta-data for usage in multiple, potentially unbounded contexts, with a (very) long lifetime.
</p>
<a name="conclusion"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Conclusion</h3>

<p>The authors argue that the best approach for providing security for OAuth is to 
    </p>
<ol class="text">
<li>describe security threats similar to the writeup in <a class='info' href='#threats'>Section&nbsp;3<span> (</span><span class='info'>Security Threats</span><span>)</span></a>.
</li>
<li>offer recommendations for the protection and the content of the token. A document with a detailed description of the token encoding and the token content (including security protection) is likely to provide users with help in designing their own custom extensions. This document does not need to be part of the OAuth 2.0 base specification. <a class='info' href='#I-D.rescorla-stateless-tokens'>[I&#8209;D.rescorla&#8209;stateless&#8209;tokens]<span> (</span><span class='info'>Rescorla, E., &ldquo;How to Implement Secure (Mostly) Stateless Tokens,&rdquo; March&nbsp;2007.</span><span>)</span></a> and the Kerberos Token format <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a> will provide valuable source of inspiration. 
    
</li>
<li>define a mandatory-to-implement solution based on 'key confirmation' (using symmetric keys) since it provides the fewest number of operational drawbacks. A symmetric key based approach was chosen because of performance reasons even though it requires Carol and Bob to share a long-term secret. It is highly recommended to compare the design against the requirements outlined in <a class='info' href='#RFC4962'>[RFC4962]<span> (</span><span class='info'>Housley, R. and B. Aboba, &ldquo;Guidance for Authentication, Authorization, and Accounting (AAA) Key Management,&rdquo; July&nbsp;2007.</span><span>)</span></a>.
</li>
<li>strongly recommend the usage of TLS between Alice and Bob mainly for the additional security services TLS provides, such as confidentiality protection. TLS will be useful for access to protected resources for the exchange of sensitive information. In case that server-side authentication is a concern the usage of channel bindings <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a> should be investigated since they allow binding an anonymous Diffie-Hellman exchange during the TLS handshake with the high-layer security exchange.
</li>
</ol><p>
    
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This document does not require actions by IANA.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgments</h3>

<p>The authors would like to thank the OAuth working group for their discussion input.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-oauth-v2">[I-D.ietf-oauth-v2]</a></td>
<td class="author-text">Hammer-Lahav, E., Recordon, D., and D. Hardt, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-10.txt">The OAuth 2.0 Protocol</a>,&rdquo; draft-ietf-oauth-v2-10 (work in progress), July&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-oauth-v2-10.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4949">[RFC4949]</a></td>
<td class="author-text">Shirey, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4949">Internet Security Glossary, Version 2</a>,&rdquo; RFC&nbsp;4949, August&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4949.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4279">[RFC4279]</a></td>
<td class="author-text">Eronen, P. and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc4279">Pre-Shared Key Ciphersuites for Transport Layer Security (TLS)</a>,&rdquo; RFC&nbsp;4279, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4279.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5246.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4120">[RFC4120]</a></td>
<td class="author-text">Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;<a href="http://tools.ietf.org/html/rfc4120">The Kerberos Network Authentication Service (V5)</a>,&rdquo; RFC&nbsp;4120, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4120.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.hardjono-oauth-kerberos">[I-D.hardjono-oauth-kerberos]</a></td>
<td class="author-text">Hardjono, T., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-hardjono-oauth-kerberos-00.txt">OAuth 2.0 support for the Kerberos V5 Authentication Protocol</a>,&rdquo; draft-hardjono-oauth-kerberos-00 (work in progress), June&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-hardjono-oauth-kerberos-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.rescorla-stateless-tokens">[I-D.rescorla-stateless-tokens]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-rescorla-stateless-tokens-01.txt">How to Implement Secure (Mostly) Stateless Tokens</a>,&rdquo; draft-rescorla-stateless-tokens-01 (work in progress), March&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-rescorla-stateless-tokens-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4962">[RFC4962]</a></td>
<td class="author-text">Housley, R. and B. Aboba, &ldquo;<a href="http://tools.ietf.org/html/rfc4962">Guidance for Authentication, Authorization, and Accounting (AAA) Key Management</a>,&rdquo; BCP&nbsp;132, RFC&nbsp;4962, July&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4962.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5849">[RFC5849]</a></td>
<td class="author-text">Hammer-Lahav, E., &ldquo;<a href="http://tools.ietf.org/html/rfc5849">The OAuth 1.0 Protocol</a>,&rdquo; RFC&nbsp;5849, April&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5849.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST800-63">[NIST800-63]</a></td>
<td class="author-text">Burr, W., Dodson, D., Perlner, R., Polk, T., Gupta, S., and E. Nabbus, &ldquo;<a href="http://csrc.nist.gov/publications/PubsDrafts.html#SP-800-63-Rev.%201">NIST Special Publication 800-63-1, INFORMATION SECURITY</a>,&rdquo; December&nbsp;2008.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Blaine Cook</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BT</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ireland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:romeda@gmail.com">romeda@gmail.com</a></td></tr>
</table>
</body></html>
