sigs = hash(call-id | tag1 | tag2)

srtps = hash(SRTP master key | SRTP master salt)

pvi = g^svi mod p

hvi=hash(pvi | hashr1-5 | cipherr1-5 | atl1-5 | pktr1-5 | sasr1-5)

pvr = g^svr mod p

rs1IDr = HMAC(rs1, "Responder")

rs2IDr = HMAC(rs2, "Responder")

sigsIDr = HMAC(sigs, "Responder")

srtpsIDr = HMAC(srtps, "Responder")

other_secretIDr = HMAC(other_secret, "Responder")

DHResult = pvi^svr mod p

DHSS = hash(DHResult)

s0 = hash(DHSS | s1 | s2 | s3 | s4 | s5)

rs1IDi = HMAC(rs1, "Initiator")

rs2IDi = HMAC(rs2, "Initiator")

sigsIDi = HMAC(sigs, "Initiator")

srtpsIDi = HMAC(srtps, "Initiator")

other_secretIDi = HMAC(other_secret, "Initiator")

DHResult = pvr^svi mod p

DHSS = hash(DHResult)

rs1IDr = HMAC(rs1, "Responder")

rs2IDr = HMAC(rs2, "Responder")

sigsIDr = HMAC(sigs, "Responder")

srtpsIDr = HMAC(srtps, "Responder")

other_secretIDr = HMAC(other_secret, "Responder")
s0 = hash(DHSS | s1 | s2 | s3 | s4 | s5)

srtpkeyi = HMAC(s0,"Initiator SRTP master key")

srtpsalti = HMAC(s0,"Initiator SRTP master salt")

srtpkeyr = HMAC(s0,"Responder SRTP master key")

srtpsaltr = HMAC(s0,"Responder SRTP master salt")

ZRTPsess = HMAC(s0,"ZRTP Session Key")

hmackeyi = HMAC(s0,"Initiator HMAC key")

hmackeyr = HMAC(s0,"Responder HMAC key")

rs1 = HMAC (s0, "retained secret")

flagoctet = D * 2^2 + S * 2^1 + V * 2^0

hmac = HMAC(hmackey, "known plaintext" | flagoctet )

s0n= HMAC(ZRTPSess, nonce)
srtpkeyin = HMAC(s0n,"Initiator SRTP master key")

srtpsaltin = HMAC(s0n,"Initiator SRTP master salt")

srtpkeyrn = HMAC(s0n,"Responder SRTP master key")

srtpsaltrn = HMAC(s0n,"Responder SRTP master salt")

hmackeyin = HMAC(s0n,"Initiator HMAC key")

hmackeyrn = HMAC(s0n,"Responder HMAC key")

clear_hmac = HMAC(hmackey, "GoClear")

sasvalue = last 32 bits of hash(pvi | pvr | "Short Authentication
a=keymgt [20] or a=crypto [19] attribute can be used as a shared
a=zrtp-sas attribute will never be present in the initial offer/
zrtp-attribute    = "a=zrtp"

zrtp-sas-attribute    = "a=zrtp-sas:" sas-string

sas-string            = non-ws-string

non-ws-string         = 1*(VCHAR/%x80-FF)
                               ;string of visible characters


zrtp-sasvalue-attribute = "a=zrtp-sasvalue:" sas-value

sas-value               = 1*(HEXDIG)


v=0
o=bob 2890844527 2890844527 IN IP4 client.biloxi.example.com
s=
c=IN IP4 client.biloxi.example.com
a=zrtp
t=0 0
m=audio 3456 RTP/AVP 97 33
a=rtpmap:97 iLBC/8000
a=rtpmap:33 no-op/8000


v=0
o=bob 2890844527 2890844528 IN IP4 client.biloxi.example.com
s=
c=IN IP4 client.biloxi.example.com
a=zrtp
t=0 0
m=audio 3456 RTP/AVP 97 33
a=rtpmap:97 iLBC/8000
a=rtpmap:33 no-op/8000
a=zrtp-sas:opz
a=ztrp-sasvalue:45e387ff

v=0
o=bob 2890844527 2890844528 IN IP4 client.biloxi.example.com
s=
c=IN IP4 client.biloxi.example.com
a=zrtp
t=0 0
m=audio 3456 RTP/AVP 97 33
a=rtpmap:97 iLBC/8000
a=rtpmap:33 no-op/8000
a=zrtp-sas:opz
a=ztrp-sasvalue:45e387ff
m=video 51372 RTP/AVP 31 33
a=rtpmap:31 H261/90000
a=rtpmap:33 no-op/8000
a=zrtp-sas:qvj
a=ztrp-sasvalue:5e017f3a


