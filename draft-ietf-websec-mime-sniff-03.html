<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Media Type Sniffing </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions">
<link href="#rfc.section.3" rel="Chapter" title="3 Metadata">
<link href="#rfc.section.4" rel="Chapter" title="4 Web Pages">
<link href="#rfc.section.5" rel="Chapter" title="5 Text or Binary">
<link href="#rfc.section.6" rel="Chapter" title="6 Unknown Type">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Signature for MP4">
<link href="#rfc.section.7" rel="Chapter" title="7 Image">
<link href="#rfc.section.8" rel="Chapter" title="8 Video">
<link href="#rfc.section.9" rel="Chapter" title="9 Fonts">
<link href="#rfc.section.10" rel="Chapter" title="10 Feed or HTML">
<link href="#rfc.references" rel="Chapter" title="11 References">
<link href="#rfc.references.1" rel="Chapter" title="11.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="11.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Many web servers supply incorrect Content-Type header fields with their HTTP responses.  In order to be compatible with these servers, user agents consider the content of HTTP responses as well as the Content-Type header fields when determining the effective media type of the response.  This document describes an algorithm for determining the effective media type of HTTP responses that balances security and compatibility considerations." />
  <meta name="description" content="Many web servers supply incorrect Content-Type header fields with their HTTP responses.  In order to be compatible with these servers, user agents consider the content of HTTP responses as well as the Content-Type header fields when determining the effective media type of the response.  This document describes an algorithm for determining the effective media type of HTTP responses that balances security and compatibility considerations." />
  <meta name="keywords" content="Internet-Draft" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">None</td>
<td class="right">A. Barth</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">I. Hickson</td>
</tr>
<tr>
<td class="left">Expires: November 09, 2011</td>
<td class="right">Google, Inc.</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">May 08, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Media Type Sniffing <br />
  <span class="filename">draft-ietf-websec-mime-sniff-03</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Many web servers supply incorrect Content-Type header fields with their HTTP responses.  In order to be compatible with these servers, user agents consider the content of HTTP responses as well as the Content-Type header fields when determining the effective media type of the response.  This document describes an algorithm for determining the effective media type of HTTP responses that balances security and compatibility considerations.</p>
<p>Please send feedback on this draft to websec@ietf.org.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on November 09, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions</a>
</li>
<li>3.   <a href="#rfc.section.3">Metadata</a>
</li>
<li>4.   <a href="#rfc.section.4">Web Pages</a>
</li>
<li>5.   <a href="#rfc.section.5">Text or Binary</a>
</li>
<li>6.   <a href="#rfc.section.6">Unknown Type</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Signature for MP4</a>
</li>
<li>7.   <a href="#rfc.section.7">Image</a>
</li>
<li>8.   <a href="#rfc.section.8">Video</a>
</li>
<li>9.   <a href="#rfc.section.9">Fonts</a>
</li>
<li>10.   <a href="#rfc.section.10">Feed or HTML</a>
</li>
<li>11.   <a href="#rfc.references">References</a>
</li>
<li>11.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>11.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> <a href="#intro" id="intro">Introduction</a>
</h1>
<p id="rfc.section.1.p.1">The HTTP Content-Type header field indicates the media type of an HTTP response.  However, many HTTP servers supply a Content-Type that does not match the actual contents of the response.  Historically, web browsers have tolerated these servers by examining the content of HTTP responses in addition to the Content-Type header field to determine the effective media type of the response.</p>
<p id="rfc.section.1.p.2">Without a clear specification of how to "sniff" the media type, each user agent implementor was forced to reverse engineer the behavior of the other user agents and to develop their own algorithm.  These divergent algorithms have lead to a lack of interoperability between user agents and to security issues when the server intends an HTTP response to be interpreted as one media type but some user agents interpret the responses as another media type.</p>
<p id="rfc.section.1.p.3">These security issues are most severe when an "honest" server lets potentially malicious users upload files and then serves the contents of those files with a low-privilege media type (such as text/plain or image/jpeg).  (Malicious servers, of course, can specify an arbitrary media type in the Content-Type header field.)  In the absence of media type sniffing, this user-generated content would not be interpreted as a high-privilege media type, such as text/html.  However, if a user agent does interpret a low-privilege media type, such as image/gif, as a high-privilege media type, such as text/html, the user agent has created a privilege escalation vulnerability in the server.  For example, a malicious user might be able to leverage content sniffing to mount a cross-site script attack by including JavaScript code in the uploaded file that a user agent treats as text/html.</p>
<p id="rfc.section.1.p.4">This document describes a content sniffing algorithm that carefully balances the compatibility needs of user agent implementors with the security constraints.  The algorithm has been constructed with reference to content sniffing algorithms present in popular user agents, an extensive database of existing web content, and metrics collected from implementations deployed to a sizable number of users <a href="#BarthCaballeroSong2009">[BarthCaballeroSong2009]</a>.</p>
<p id="rfc.section.1.p.5">WARNING!  Whenever possible, user agents SHOULD NOT employ a content sniffing algorithm.  However, if a user agent does employ a content sniffing algorithm, the user agent SHOULD use the algorithm in this document because using a different content sniffing algorithm than servers expect causes security problems.  For example, if a server believes that the client will treat a contributed file as an image (and thus treat it as benign), but a user agent believes the content to be HTML (and thus privileged to execute any scripts contained therein), an attacker might be able to steal the user's authentication credentials and mount other cross-site scripting attacks.</p>
<p id="rfc.section.1.p.6">Conformance requirements phrased as algorithms or specific steps MAY be implemented in any manner, so long as the end result is equivalent. (In particular, the algorithms defined in this specification are intended to be easy to follow, and not intended to be performant.)</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#conventions" id="conventions">Conventions</a>
</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<p id="rfc.section.2.p.2">Requirements phrased in the imperative as part of algorithms (such as "strip any leading space characters" or "return false and abort these steps") are to be interpreted with the meaning of the key word ("MUST", "SHOULD", "MAY", etc) used in introducing the algorithm.</p>
<p id="rfc.section.2.p.3">Conformance requirements phrased as algorithms or specific steps can be implemented in any manner, so long as the end result is equivalent.  In particular, the algorithms defined in this specification are intended to be easy to understand and are not intended to be performant.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#metadata" id="metadata">Metadata</a>
</h1>
<p id="rfc.section.3.p.1">The explicit media type metadata information associated with sequence of octets depends on the protocol that was used to fetch the octets.</p>
<p id="rfc.section.3.p.2">For octets received via HTTP, the Content-Type HTTP header field, if present, indicates the media type. Let the official-type be the media type indicted by the HTTP Content-Type header field, if present.  If the Content-Type header field is absent or if its value cannot be interpreted as a media type (e.g. because its value doesn't contain a U+002F SOLIDUS ('/') character), then there is no official-type.  (Such messages are invalid according to <a href="#RFC2616">[RFC2616]</a> </p>

<ul class="empty"><li>Note: If an HTTP response contains multiple Content-Type header fields, the user agent MUST use the textually last Content-Type header field to the official-type. For example, if the last Content-Type header field contains the value "foo", then there is no official media type because "foo" cannot be interpreted as a media type (even if the HTTP response contains another Content-Type header field that could be interpreted as a media type).</li></ul>

<p> </p>
<p id="rfc.section.3.p.3">For octets fetched from the file system, user agents should use platform-specific conventions (e.g., operating system file extension/type mappings) to determine the official-type.  </p>

<ul class="empty"><li>Note: It is essential that file extensions are not used for determining the media type for octets fetched over HTTP because, in some cases, file extensions can be supplied by malicious parties. For example, most PHP installations let the attacker append arbitrary path information to URLs (e.g., http://example.com/foo.php/bar.html) and thereby determine the file extension.</li></ul>

<p> </p>
<p id="rfc.section.3.p.4">For octets fetched over some other protocols, e.g. FTP <a href="#RFC0959">[RFC0959]</a>, there is no type information.</p>
<p id="rfc.section.3.p.5">Note: Comparisons between media types, as defined by MIME specifications, are done in an ASCII case-insensitive manner.  <a href="#RFC2046">[RFC2046]</a></p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#web-pages" id="web-pages">Web Pages</a>
</h1>
<div id="#rfc.figure.1"></div>
<pre>
    +-------------------------------+--------------------------------+
    | Bytes in Hexadecimal          | Textual Representation         |
    +-------------------------------+--------------------------------+
    | 74 65 78 74 2f 70 6c 61 69 6e | text/plain                     |
    +-------------------------------+--------------------------------+
    | 74 65 78 74 2f 70 6c 61 69 6e | text/plain; charset=ISO-8859-1 |
    | 3b 20 63 68 61 72 73 65 74 3d |                                |
    | 49 53 4f 2d 38 38 35 39 2d 31 |                                |
    +-------------------------------+--------------------------------+
    | 74 65 78 74 2f 70 6c 61 69 6e | text/plain; charset=iso-8859-1 |
    | 3b 20 63 68 61 72 73 65 74 3d |                                |
    | 69 73 6f 2d 38 38 35 39 2d 31 |                                |
    +-------------------------------+--------------------------------+
    | 74 65 78 74 2f 70 6c 61 69 6e | text/plain; charset=UTF-8      |
    | 3b 20 63 68 61 72 73 65 74 3d |                                |
    | 55 54 46 2d 38                |                                |
    +-------------------------------+--------------------------------+
          </pre>
<p id="rfc.section.4.p.1">The user agent MUST use the following algorithm to determine the sniffed-type of a sequence of octets: </p>

<p>...then jump to the "text or binary" section below.  </p>
<ol>
<li>If the user agent is configured to strictly obey the official-type, then let the sniffed-type be the official-type and abort these steps.</li>
<li>If the octets were fetched via HTTP and there is an HTTP Content-Type header field and the value of the last such header field has octets that *exactly* match the octets contained in one of the following lines: </li>
<li>If there is no official-type, jump to the "unknown type" section below.</li>
<li>If the official-type is "unknown/unknown", "application/unknown", or "*/*", jump to the "unknown type" section below.</li>
<li>If the official-type ends in "+xml", or if it is either "text/xml" or "application/xml", then let the sniffed-type be the official-type and abort these steps.</li>
<li>If the official-type is an image type supported by the user agent (e.g., "image/png", "image/gif", "image/jpeg", etc), then jump to the "images" section below.</li>
<li>If the official-type is "text/html", then jump to the "feed or HTML" section below.</li>
<li>Let the sniffed-type be the official type.</li>
</ol>

<p> </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#text-or-binary" id="text-or-binary">Text or Binary</a>
</h1>
<p id="rfc.section.5.p.1">This section defines the *rules for distinguishing if a resource is text or binary*.</p>
<div id="#rfc.figure.2"></div>
<pre>
                +----------------------+--------------+
                | Bytes in Hexadecimal | Description  |
                +----------------------+--------------+
                | FE FF                | UTF-16BE BOM |
                | FF FE                | UTF-16LE BOM |
                | EF BB BF             | UTF-8 BOM    |
                +----------------------+--------------+
            </pre>
<p></p>

<p>...then let the sniffed-type be "text/plain" and abort these steps.  </p>
<div id="#rfc.figure.3"></div>
<pre>
                      +-------------------------+
                      | Binary Data Byte Ranges |
                      +-------------------------+
                      | 0x00 -- 0x08            |
                      | 0x0B                    |
                      | 0x0E -- 0x1A            |
                      | 0x1C -- 0x1F            |
                      +-------------------------+
            </pre>
<ol>
<li>The user agent MAY wait for 512 or more octets to arrive.  <ul class="empty"><li>Note: Waiting for 512 octets octets to arrive causes the text-or-binary algorithm to be deterministic for a given sequence of octets. However, in some cases, the user agent might need to wait an arbitrary length of time for these octets to arrive. User agents SHOULD wait for 512 octets to arrive, when feasible.</li></ul>
<p> </p>
</li>
<li>Let n be the smaller of either 512 or the number of octets that have already arrived.</li>
<li>If n is greater than or equal to 3, and the first 2 or 3 octets match one of the following octet sequences: </li>
<li>If none of the first n octets are binary data octets then let the sniffed-type be "text/plain" and abort these steps.  </li>
<li>If the first octets match one of the octet sequences in the "pattern" column of the table in the "unknown type" section below, ignoring any rows whose cell in the "security" column says "scriptable" (or "n/a"), then let the sniffed-type be the type given in the corresponding cell in the "sniffed type" column on that row and abort these steps.  <ul class="empty"><li>WARNING! It is critical that this step not ever return a scriptable type (e.g., text/html), because otherwise that would allow a privilege escalation attack.</li></ul>
<p> </p>
</li>
<li>Otherwise, let the sniffed-type be "application/octet-stream" and abort these steps.</li>
</ol>

<p> </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#unknown-type" id="unknown-type">Unknown Type</a>
</h1>
<p></p>

<ol>
<li>The user agent MAY wait for 512 or more octets to arrive for the same reason as in the "text or binary" section above.</li>
<li>Let n be the smaller of either 512 or the number of octets that have already arrived.</li>
<li>For each row in the table below: <ul>
<li>If the row has no "WS" octets: <ol>
<li>Let pattern-length be the length of the pattern.</li>
<li>If n is smaller than pattern-length then skip this row.</li>
<li>Apply the bit-wise "and" operator to the first pattern-length octets and the given mask, and let the result be the masked-data.</li>
<li>If the octets of the masked-data matches the given pattern octets exactly, then let the sniffed-type be the type given in the cell of the third column in that row and abort these steps.</li>
</ol>
<p> </p>
</li>
<li>If the row has a "WS" octet or a "_&gt;" octet: <ol>
<li>Let index-pattern be an index into the mask and pattern octet strings of the row.</li>
<li>Let index-stream be an index into the octet stream being examined.</li>
<li>LOOP: If index-stream points beyond the end of the octet stream, then this row doesn't match and skip this row.</li>
<li>Examine the index-stream-th octet of the octet stream as follows: <ul>
<li>If the index-pattern-th octet of the pattern is a normal hexadecimal octet and not a "WS" octet or a "_&gt;" octet: <ul class="empty">
<li>If the bit-wise "and" operator, applied to the index-stream-th octet of the stream and the index-pattern-th octet of the mask, yield a value different than the index-pattern-th octet of the pattern, then skip this row.</li>
<li>Otherwise, increment index-pattern to the next octet in the mask and pattern and index-stream to the next octet in the octet stream.</li>
</ul>
<p> </p>
</li>
<li>Otherwise, if the index-pattern-th octet of the pattern is a "WS" octet: <ul class="empty">
<li>"WS" means "whitespace", and allows insignificant whitespace to be skipped when sniffing for a type signature.</li>
<li>If the index-stream-th octet of the stream is one of 0x09 (ASCII TAB), 0x0A (ASCII LF), 0x0C (ASCII FF), 0x0D (ASCII CR), or 0x20 (ASCII space), then increment only the index-stream to the next octet in the octet stream.</li>
<li>Otherwise, increment only the index-pattern to the next octet in the mask and pattern.</li>
</ul>
<p> </p>
</li>
<li>Otherwise, if the index-pattern-th octet of the pattern is a "_&gt;" octet: <ul class="empty">
<li>"_&gt;" means "space-or-bracket", and allows HTML tag names to terminate with either a space or a greater than sign.</li>
<li>If index-stream-th octet of the stream is different than 0x20 (ASCII space) or 0x3E (ASCII "&gt;"), then skip this row.</li>
<li>Otherwise, increment index-pattern to the next octet in the mask and pattern and index-stream to the next octet in the octet stream.</li>
</ul>
<p> </p>
</li>
</ul>
<p> </p>
</li>
<li>If index-pattern does not point beyond the end of the mask and pattern octet strings, then jump back to the LOOP step in this algorithm.</li>
<li>Otherwise, let the sniffed-type be the type given in the cell of the third column in that row and abort these steps.</li>
</ol>
<p> </p>
</li>
</ul>
<p> </p>
</li>
<li>If the first n octets match the signature for MP4 (as define in <a href="#mp4-signature">Section 6.1</a>), then let the sniffed-type be video/mp4 and abort these steps.</li>
<li>If none of the first n octets are binary data (as defined in the "text or binary" section), then let the sniffed-type be "text/plain" and abort these steps.</li>
<li>Otherwise, let the sniffed-type be "application/octet-stream" and abort these steps.</li>
</ol>

<p> </p>
<div id="#rfc.figure.4"></div>
<pre>
+-------------------+-------------------+-----------------+------------+
| Mask in Hex       | Pattern in Hex    | Sniffed Type    | Security   |
+-------------------+-------------------+-----------------+------------+
| FF FF FF DF DF DF | WS 3C 21 44 4F 43 | text/html       | Scriptable |
| DF DF DF DF FF DF | 54 59 50 45 20 48 |                 |            |
| DF DF DF FF       | 54 4D 4C _&gt;       |                 |            |
| Comment: &lt;!DOCTYPE HTML                                              |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF DF | WS 3C 48 54 4D 4C | text/html       | Scriptable |
| FF                | _&gt;                |                 |            |
| Comment: &lt;HTML                                                       |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF DF | WS 3C 48 45 41 44 | text/html       | Scriptable |
| FF                | _&gt;                |                 |            |
| Comment: &lt;HEAD                                                       |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF DF | WS 3C 53 43 52 49 | text/html       | Scriptable |
| DF DF FF          | 50 54 _&gt;          |                 |            |
| Comment: &lt;SCRIPT                                                     |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF DF | WS 3C 49 46 52 41 | text/html       | Scriptable |
| DF DF FF          | 4d 45 _&gt;          |                 |            |
| Comment: &lt;IFRAME                                                     |
+-------------------+-------------------+-----------------+------------+
| FF FF DF FF FF    | WS 3C 48 31 _&gt;    | text/html       | Scriptable |
| Comment: &lt;H1                                                         |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF FF | WS 3C 44 49 56 _&gt; | text/html       | Scriptable |
| Comment: &lt;DIV                                                        |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF DF | WS 3C 46 4f 4e 54 | text/html       | Scriptable |
| FF                | _&gt;                |                 |            |
| Comment: &lt;FONT                                                       |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF DF | WS 3C 54 41 42 4c | text/html       | Scriptable |
| DF FF             | 45 _&gt;             |                 |            |
| Comment: &lt;TABLE                                                      |
+-------------------+-------------------+-----------------+------------+
| FF FF DF FF       | WS 3C 41 _&gt;       | text/html       | Scriptable |
| Comment: &lt;A                                                          |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF DF | WS 3C 53 54 59 4c | text/html       | Scriptable |
| DF FF             | 45 _&gt;             |                 |            |
| Comment: &lt;STYLE                                                      |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF DF | WS 3C 54 49 54 4c | text/html       | Scriptable |
| DF FF             | 45 _&gt;             |                 |            |
| Comment: &lt;TITLE                                                      |
+-------------------+-------------------+-----------------+------------+
| FF FF DF FF       | WS 3C 42 _&gt;       | text/html       | Scriptable |
| Comment: &lt;B                                                          |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF DF DF | WS 3C 42 4f 44 59 | text/html       | Scriptable |
| FF                | _&gt;                |                 |            |
| Comment: &lt;BODY                                                       |
+-------------------+-------------------+-----------------+------------+
| FF FF DF DF FF    | WS 3C 42 52 _&gt;    | text/html       | Scriptable |
| Comment: &lt;BR                                                         |
+-------------------+-------------------+-----------------+------------+
| FF FF DF FF       | WS 3C 50 _&gt;       | text/html       | Scriptable |
| Comment: &lt;P                                                          |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF FF FF | WS 3C 21 2d 2d _&gt; | text/html       | Scriptable |
| Comment: &lt;!--                                                        |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF FF FF | WS 3C 3f 78 6d 6c | text/xml        | Scriptable |
| Comment: &lt;?xml (Note the case sensitivity and lack of trailing _&gt;)  |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF FF    | 25 50 44 46 2D    | application/pdf | Scriptable |
| Comment: The string "%PDF-", the PDF signature.                      |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF FF FF | 25 21 50 53 2D 41 | application/    | Safe       |
| FF FF FF FF FF    | 64 6F 62 65 2D    |      postscript |            |
| Comment: The string "%!PS-Adobe-", the PostScript signature.         |
+-------------------+-------------------+-----------------+------------+
| FF FF 00 00       | FE FF 00 00       | text/plain      | n/a        |
| Comment: UTF-16BE BOM                                                |
+-------------------+-------------------+-----------------+------------+
| FF FF 00 00       | FF FE 00 00       | text/plain      | n/a        |
| Comment: UTF-16LE BOM                                                |
+-------------------+-------------------+-----------------+------------+
| FF FF FF 00       | EF BB BF 00       | text/plain      | n/a        |
| Comment: UTF-8 BOM                                                   |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF FF FF | 47 49 46 38 37 61 | image/gif       | Safe       |
| Comment: The string "GIF87a", a GIF signature.                       |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF FF FF | 47 49 46 38 39 61 | image/gif       | Safe       |
| Comment: The string "GIF89a", a GIF signature.                       |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF FF FF | 89 50 4E 47 0D 0A | image/png       | Safe       |
| FF FF             | 1A 0A             |                 |            |
| Comment: The PNG signature.                                          |
+-------------------+-------------------+-----------------+------------+
| FF FF FF          | FF D8 FF          | image/jpeg      | Safe       |
| Comment: A JPEG SOI marker followed by a octet of another marker.    |
+-------------------+-------------------+-----------------+------------+
| FF FF             | 42 4D             | image/bmp       | Safe       |
| Comment: The string "BM", a BMP signature.                           |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF 00 00 | 52 49 46 46 00 00 | image/webp      | Safe       |
| 00 00 FF FF FF FF | 00 00 57 45 42 50 |                 |            |
| FF FF             | 56 50             |                 |            |
| Comment: "RIFF" followed by four bytes, followed by "WEBPVP".        |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF       | 00 00 01 00       | image/vnd.      | Safe       |
|                   |                   |  microsoft.icon |            |
| Comment: A Windows Icon signature.                                   |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF FF    | 4F 67 67 53 00    | application/ogg | Safe       |
| Comment: An Ogg audio or video signature.                     |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF 00 00 | 52 49 46 46 00 00 | audio/wave      | Safe       |
| 00 00 FF FF FF FF | 00 00 57 41 56 45 |                 |            |
| Comment: "RIFF" followed by four bytes, followed by "WAVE".          |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF       | 1A 45 DF A3       | video/webm      | Safe       |
| Comment: The WebM signature [TODO: Use more octets?]                 |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF FF FF | 52 61 72 20 1A 07 | application/    | Safe       |
| FF                | 00                | x-rar-compressed|            |
| Comment: A RAR archive.                                              |
+-------------------+-------------------+-----------------+------------+
| FF FF FF FF       | 50 4B 03 04       | application/zip | Safe       |
| Comment: A ZIP archive.                                              |
+-------------------+-------------------+-----------------+------------+
| FF FF FF          | 1F 8B 08          | application/    | Safe       |
|                   |                   |          x-gzip |            |
| Comment: A GZIP archive.                                             |
+-------------------+-------------------+-----------------+------------+
[TODO: MP3 audio.]
        </pre>
<p id="rfc.section.6.p.2">The table used by the above algorithm is: </p>
<p id="rfc.section.6.p.3">User agents MAY support additional types if necessary, by implicitly adding to the above table. However, user agents SHOULD NOT not use any other patterns for types already mentioned in the table above because this could then be used for privilege escalation (where, e.g., a server uses the above table to determine that content is not HTML and thus safe from cross-site scripting attacks, but then a user agent detects it as HTML anyway and allows script to execute). In extending this table, user agents SHOULD NOT introduce any privilege escalation vulnerabilities.</p>
<p id="rfc.section.6.p.4">Note: The column marked "security" is used by the algorithm in the "text or binary" section, to avoid sniffing text/plain content as a type that can be used for a privilege escalation attack.</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> <a href="#mp4-signature" id="mp4-signature">Signature for MP4</a>
</h1>
<p id="rfc.section.6.1.p.1">This section defines whether a sequence of n octets *matches the signature for MP4*.</p>
<p id="rfc.section.6.1.p.2">If n is less than 4, then the sequence does not match the signature for MP4 and abort these steps.</p>
<p id="rfc.section.6.1.p.3">Let box-size be the value of the first four octets, interpreted as a 32 bit unsigned, little-endian integer.</p>
<p id="rfc.section.6.1.p.4">If n is less than box-size or if box-size is not evenly divisible by 4, then the sequence does not match the signature for MP4 and abort these steps.</p>
<p id="rfc.section.6.1.p.5">If octets 5 through 8 (inclusive) of the sequence are not 0x66 0x74 0x79 0x70 (the ASCII string "ftyp"), then the sequence does not match the signature for MP4 and abort these steps.</p>
<p id="rfc.section.6.1.p.6">For each i from 2 to box-size/4 - 1 (inclusive): </p>

<ol>
<li>If i is equal to 3, continue to the next i, if any. (These octets correspond to the minor version number.)</li>
<li>If octets 4*i through 4*i + 3 (inclusive) of the sequence are 0x6D 0x70 0x34 (the ASCII string "mp4"), then the sequence *does* match the signature for MP4 and abort these steps.</li>
</ol>

<p> </p>
<p id="rfc.section.6.1.p.7">The sequence does not match the signature for MP4.</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#image" id="image">Image</a>
</h1>
<p id="rfc.section.7.p.1">This section defines the *rules for sniffing images specifically*.</p>
<p id="rfc.section.7.p.2">If the official-type is "image/svg+xml", then let the sniffed-type be the official-type (an XML type) and abort these steps.</p>
<p id="rfc.section.7.p.3">If the first octets match one of the signatures in <a href="#unknown-type">Section 6</a> for one of the following media types, then let the sniffed-type be the corresponding media type and abort these steps: </p>

<ul>
<li>image/gif</li>
<li>image/png</li>
<li>image/jpeg</li>
<li>image/bmp</li>
<li>image/vnd.microsoft.icon</li>
<li>image/webp</li>
</ul>

<p> </p>
<p id="rfc.section.7.p.4">Otherwise, let the sniffed-type be the official-type and abort these steps.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#video" id="video">Video</a>
</h1>
<p id="rfc.section.8.p.1">This section defines the *rules for sniffing videos specifically*.</p>
<p id="rfc.section.8.p.2">If the first octets match one of the signatures in <a href="#unknown-type">Section 6</a> for one of the following media types, then let the sniffed-type be the corresponding media type and abort these steps: </p>

<ul>
<li>video/mp4</li>
<li>video/webm</li>
<li>application/ogg</li>
</ul>

<p> </p>
<p id="rfc.section.8.p.3">Otherwise, let the sniffed-type be the official-type and abort these steps.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#fonts" id="fonts">Fonts</a>
</h1>
<p id="rfc.section.9.p.1">This section defines the *rules for sniffing fonts specifically*.</p>
<p id="rfc.section.9.p.2">TODO</p>
<p id="rfc.section.9.p.3">Otherwise, let the sniffed-type be the official-type and abort these steps.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> <a href="#feed-or-html" id="feed-or-html">Feed or HTML</a>
</h1>
<div id="#rfc.figure.5"></div>
<pre>
+----------------------+------------------------------------+---------+
| Bytes in Hexadecimal | Requirement                        | Comment |
+----------------------+------------------------------------+---------+
| 72 73 73             | Let the sniffed-type be            | rss     |
|                      | "application/rss+xml" and abort    |         |
|                      | these steps.                       |         |
+----------------------+------------------------------------+---------+
| 66 65 65 64          | Let the sniffed-type be            | feed    |
|                      | "application/atom+xml" and abort   |         |
|                      | these steps.                       |         |
+----------------------+------------------------------------+---------+
| 72 64 66 3A 52 44 46 | Continue to the next step in this  | rdf:RDF |
|                      | algorithm.                         |         |
+----------------------+------------------------------------+---------+
          </pre>
<p></p>

<p>If none of the octet sequences above match the octets in s starting at pos, then let the sniffed-type be "text/html" and abort these steps.  </p>
<ol>
<li>The user agent MAY wait for 512 or more octets to arrive for the same reason as in the "text or binary" section above.</li>
<li>Let s be the stream of octets, and let s[i] represent the octet in s with position i, treating s as zero-indexed (so the first octet is at i=0).</li>
<li>If at any point this algorithm requires the user agent to determine the value of a octet in s which has not yet arrived, or which is past the first 512 octets, or which is beyond the end of the octet stream, the algorithm stops and the sniffed-type is "text/html".  <ul class="empty"><li>Note: User agents are allowed, by the first step of this algorithm, to wait until the first 512 octets have arrived.</li></ul>
<p> </p>
</li>
<li>Initialize pos to 0.</li>
<li>If s[0] equals 0xEF, s[1] equals 0xBB, and s[2] equals 0xBF, then set pos to 3. (This skips over a leading UTF-8 BOM, if any.)</li>
<li>LOOP: Examine s[pos].  <ul>
<li>If it equals 0x09 (ASCII tab), 0x20 (ASCII space), 0x0A (ASCII LF), or 0x0D (ASCII CR) <ul class="empty"><li>Increase pos by 1 and repeat this step.</li></ul>
<p> </p>
</li>
<li>If it equals 0x3C (ASCII "&lt;") <ul class="empty"><li>Increase pos by 1 and go to the next step.</li></ul>
<p> </p>
</li>
<li>If it is anything else <ul class="empty"><li>Let the sniffed-type be "text/html" and abort these steps.</li></ul>
<p> </p>
</li>
</ul>
<p> </p>
</li>
<li>If the octets with positions pos to pos+2 in s are exactly equal to 0x21, 0x2D, 0x2D respectively (ASCII for "!--"), then: <ol>
<li>Increase pos by 3.</li>
<li>If the octets with positions pos to pos+2 in s are exactly equal to 0x2D, 0x2D, 0x3E respectively (ASCII for "--&gt;"), then increase pos by 3 and jump back to the previous step (the step labeled loop start) in the overall algorithm in this section.</li>
<li>Otherwise, increase pos by 1.</li>
<li>Return to step 2 in these substeps.</li>
</ol>
<p> </p>
</li>
<li>If s[pos] equals 0x21 (ASCII "!"): <ol>
<li>Increase pos by 1.</li>
<li>If s[pos] equals 0x3E, then increase pos by 1 and jump back to the step labeled LOOP in the overall algorithm in this section.</li>
<li>Otherwise, return to step 1 in these substeps.</li>
</ol>
<p> </p>
</li>
<li>If s[pos] equals 0x3F (ASCII "?"): <ol>
<li>Increase pos by 1.</li>
<li>If s[pos] and s[pos+1] equal 0x3F and 0x3E respectively, then increase pos by 1 and jump back to the step labeled LOOP in the overall algorithm in this section.</li>
<li>Otherwise, return to step 1 in these substeps.</li>
</ol>
<p> </p>
</li>
<li>Otherwise, if the octets in s starting at pos match any of the sequences of octets in the first column of the following table, then the user agent MUST follow the steps given in the corresponding cell in the second column of the same row.  </li>
<li>Initialize RDF-flag to 0.</li>
<li>Initialize RSS-flag to 0.</li>
<li>If the octets with positions pos to pos+23 in s are exactly equal to 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x70, 0x75, 0x72, 0x6C, 0x2E, 0x6F, 0x72, 0x67, 0x2F, 0x72, 0x73, 0x73, 0x2F, 0x31, 0x2E, 0x30, 0x2F respectively (ASCII for "http://purl.org/rss/1.0/"), then: <ol>
<li>Increase pos by 23.</li>
<li>Set RSS-flag to 1.</li>
</ol>
<p> </p>
</li>
<li>If the octets with positions pos to pos+42 in s are exactly equal to 0x68, 0x74, 0x74, 0x70, 0x3A, 0x2F, 0x2F, 0x77, 0x77, 0x77, 0x2E, 0x77, 0x33, 0x2E, 0x6F, 0x72, 0x67, 0x2F, 0x31, 0x39, 0x39, 0x39, 0x2F, 0x30, 0x32, 0x2F, 0x32, 0x32, 0x2D, 0x72, 0x64, 0x66, 0x2D, 0x73, 0x79, 0x6E, 0x74, 0x61, 0x78, 0x2D, 0x6E, 0x73, 0x23 respectively (ASCII for "http://www.w3.org/1999/02/22-rdf-syntax-ns#"), then: <ol>
<li>Increase pos by 42.</li>
<li>Set RDF-flag to 1.</li>
</ol>
<p> </p>
</li>
<li>Increase pos by 1.</li>
<li>If RDF-flag is 1 and RSS-flag is 1, then let the sniffed-type be "application/rss+xml" and abort these steps.</li>
<li>If pos points beyond the end of the octet stream s, then continue to step 19 of this algorithm.</li>
<li>Jump back to step 13 of this algorithm.</li>
<li>Let the sniffed-type be "text/html" and abort these steps.</li>
</ol>

<p> </p>
<p id="rfc.section.10.p.2">For efficiency reasons, implementations might wish to implement this algorithm and the algorithm for detecting the character encoding of HTML documents in parallel.</p>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">11.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2046">[RFC2046]</b></td>
<td class="top">
<a href="mailto:ned@innosoft.com" title="Innosoft International, Inc.">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com" title="First Virtual Holdings">N. Borenstein</a>, "<a href="http://tools.ietf.org/html/rfc2046">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types </a>", RFC 2046, November 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels </a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2616">[RFC2616]</b></td>
<td class="top">
<a href="mailto:fielding@ics.uci.edu" title="University of California, Irvine">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="W3C">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="MIT Laboratory for Computer Science">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a> and <a href="mailto:timbl@w3.org" title="W3C">T. Berners-Lee</a>, "<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>", RFC 2616, June 1999.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">11.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC0959">[RFC0959]</b></td>
<td class="top">
<a title="Information Sciences Institute (ISI)">Postel, J.</a> and <a>J. Reynolds</a>, "<a href="http://tools.ietf.org/html/rfc959">File Transfer Protocol</a>", STD 9, RFC 959, October 1985.</td>
</tr>
<tr>
<td class="reference"><b id="BarthCaballeroSong2009">[BarthCaballeroSong2009]</b></td>
<td class="top">
<a title="UC Berkeley">Barth, A.</a>, <a title="UC Berkeley and CMU">Caballero, J.</a> and <a title="UC Berkeley">D. Song</a>, "<a>Secure Content Sniffing for Web Browsers, or How to Stop Papers from Reviewing Themselves</a>", 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Adam Barth</span> 
	  <span class="n hidden">
		<span class="family-name">Barth</span>
	  </span>
	</span>
	<span class="org vcardline">Google, Inc.  </span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ietf@adambarth.com">ietf@adambarth.com</a></span>

<span class="vcardline">URI: <a href="http://www.adambarth.com/">http://www.adambarth.com/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ian Hickson</span> 
	  <span class="n hidden">
		<span class="family-name">Hickson</span>
	  </span>
	</span>
	<span class="org vcardline">Google, Inc.  </span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ian@hixie.ch">ian@hixie.ch</a></span>

<span class="vcardline">URI: <a href="http://ln.hixie.ch/">http://ln.hixie.ch/</a></span>

  </address>
</div>

</body>
</html>