
Network Working Group                                        Keith Moore
Internet Draft                                   University of Tennessee
Expires: 20 July 1995                                     Greg Vaudreuil
                                                  Octel Network Services
                                                         20 January 1995


                      An Extensible Message Format
                   for Delivery Status Notifications

                 draft-ietf-notary-mime-delivery-04.txt


Status of this Memo

This document is an Internet-Draft.  Internet-Drafts are working
documents of the Internet Engineering Task Force (IETF), its areas, and
its working groups.  Note that other groups may also distribute working
documents as Internet-Drafts.

Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time.  It is inappropriate to use Internet-Drafts as reference material
or to cite them other than as ``work in progress.''

To learn the current status of any Internet-Draft, please check the
``1id-abstracts.txt'' listing contained in the Internet- Drafts Shadow
Directories on ftp.is.co.za (Africa), nic.nordu.net (Europe),
munnari.oz.au (Pacific Rim), ds.internic.net (US East Coast), or
ftp.isi.edu (US West Coast).


Abstract

This memo defines a MIME content-type that may be used by a message
transfer agent (MTA) or electronic mail gateway to report the result of
an attempt to deliver a message to one or more recipients.  This
content-type is intended as a machine-processable replacement for the
various types of delivery status notifications currently used in
Internet electronic mail.

Because many messages are sent between the Internet and other messaging
systems (such as X.400 or the so-called "LAN-based" systems), the DSN
protocol is designed to be useful in a multi-protocol messaging
environment.  To this end, the protocol described in this memo provides
for the carriage of "foreign" addresses and error codes, in addition to
those normally used in Internet mail.  Additional attributes may also be
defined to support "tunneling" of foreign notifications through Internet
mail.








Moore/Vaudreuil           Expires 20 July 1995                  [Page 1]

Delivery Status Notifications                            20 January 1995



1. Introduction

This memo defines a MIME [1] content-type for delivery status
notifications (DSNs).  A DSN can be used to notify the sender of a
message of any of several conditions:  failed delivery, delayed
delivery, successful delivery, or the gatewaying of a message into an
environment that may not support DSNs.  The "message/delivery-status"
content-type defined herein is intended for use within the framework of
the "multipart/report" content type defined in [2].

This memo defines only the format of the notifications.  An extension to
the Simple Message Transfer Protocol (SMTP) [3] to fully support such
notifications is the subject of a separate memo [4].


1.1. Purposes

The DSNs defined in this memo are expected to serve several purposes:

+ Inform human beings of the status of message delivery processing, as
  well as the reasons for any delivery problems or outright failures, in
  a manner which is largely language-independent;

+ Allow mail user agents to keep track of the delivery status of
  messages sent, by associating returned DSNs with earlier message
  transmissions;

+ Allow mailing list expanders to automatically maintain their
  subscriber lists when delivery attempts repeatedly fail;

+ Convey delivery and non-delivery notifications resulting from attempts
  to deliver messages to "foreign" mail systems via a gateway;

+ Allow "foreign" notifications to be tunneled through a MIME-capable
  message system and back into the original messaging system that issued
  the original notification, or even to a third messaging system;

+ Allow language-independent, yet reasonably precise, indications of the
  reason for the failure of a message to be delivered (once status codes
  of sufficient precision are defined); and

+ Provide sufficient information to remote MTA maintainers (via "trouble
  tickets") so that they can understand the nature of reported errors.
  This feature is used in the case that failure to deliver a message is
  due to the malfunction of a remote MTA and the sender wants to report
  the problem to the remote MTA administrator.








Moore/Vaudreuil           Expires 20 July 1995                  [Page 2]

Delivery Status Notifications                            20 January 1995





1.2. Requirements

These purposes place the following constraints on the notification
protocol:

+ It must be readable by humans as well as being machine-parsable.

+ It must provide enough information to allow message senders (or the
  user agents) to unambiguously associate a DSN with the message that
  was sent and the original recipient address for which the DSN is
  issued (if such information is available), even if the message was
  forwarded to another recipient address.

+ It must be able to preserve the reason for the success or failure of a
  delivery attempt in a remote messaging system, using the "language"
  (mailbox addresses and status codes) of that remote system.

+ It must also be able to describe the reason for the success or failure
  of a delivery attempt, independent of any particular human language or
  of the "language" of any particular mail system.

+ It must preserve enough information to allow the maintainer of a
  remote MTA to understand (and if possible, reproduce) the conditions
  that caused a delivery failure at that MTA.

+ For any notifications issued by foreign mail systems, which are
  translated by a mail gateway to the DSN format, the DSN must preserve
  the "type" of the foreign addresses and error codes, so that these may
  be correctly interpreted by gateways.

A DSN contains a set of per-message fields which identify the message
and the transaction during which the message was submitted, along with
other fields that apply to all delivery attempts described by the DSN.
The DSN also includes a set of per-recipient fields to convey the result
of the attempt to deliver the message to each of one or more recipients.


1.3. Terminology

A message may be transmitted through several message transfer agents
(MTAs) on its way to a recipient.  For a variety of reasons, recipient
addresses may be rewritten during this process, so each MTA may
potentially see a different recipient address.  Depending on the purpose
for which a DSN is used, different formats of a particular recipient
address will be needed.

Several DSN fields are defined in terms of the view from a particular
MTA in the transmission.  The MTAs are assigned the following names:




Moore/Vaudreuil           Expires 20 July 1995                  [Page 3]

Delivery Status Notifications                            20 January 1995



a. Original MTA

The Original MTA is the one to which the message is submitted for
delivery by the sender of the message.

Note: Each time a message is re-sent to a completely different set of
recipients (say to the subscribers of a mailing list), the Original MTA
for the new recipients of that message is the one to which the message
is initially submitted for delivery to the new list of recipients.

b. Reporting MTA

For any DSN, the Reporting MTA is the one which is reporting the results
of delivery attempts described in the DSN.

If the delivery attempts described occurred in a "foreign" (non-
Internet) mail system, and the DSN was produced by translating the
foreign notice into DSN format, the Reporting MTA will still identify
the "foreign" MTA where the delivery attempts occurred.

c. Preceding MTA

The Preceding MTA is the MTA from which the Reporting MTA received the
message, and accepted responsibility for delivery of the message.

d. Remote MTA

If an MTA determines that it must relay a message to one or more
recipients, but the message cannot be transferred to its "next hop" MTA,
or if the "next hop" MTA refuses to accept responsibility for delivery
of the message to one or more of its intended recipients, the relaying
MTA may need to issue a DSN on behalf of the recipients for whom the
message cannot be delivered.  In this case the relaying MTA is the
Reporting MTA, and the "next hop" MTA is known as the Remote MTA.

Figure 1 illustrates the relationship between the various MTAs:


+-----+    +--------+           +---------+    +---------+      +------+
|     | => |Original| => ... => |Preceding| => |Reporting| ===> |Remote|
| user|    |   MTA  |           |   MTA   |    |   MTA   | <No! |  MTA |
|agent|    +--------+           +---------+    +----v----+      +------+
|     |                                             |
|     | <-------------------------------------------+
+-----+      (DSN returned to sender by Reporting MTA)


       Figure 1.  Original, Preceding, Reporting and Remote MTAs


Each of these MTAs may provide information which is useful in a DSN:



Moore/Vaudreuil           Expires 20 July 1995                  [Page 4]

Delivery Status Notifications                            20 January 1995



+ Ideally, the DSN will contain the address of each recipient as
  originally specified to the Original MTA by the sender of the message.
  This version of the address is needed (rather than a forwarding
  address or some modified version of the original address) so that the
  sender may compare the recipient address in the DSN with the address
  in the sender's records (e.g. an address book for an individual, the
  list of subscribers for a mailing list) and take appropriate action.

  Similarly, the DSN may contain an "envelope identifier" that was known
  to both the sender's user agent and the Original MTA at the time of
  message submission, and which if included in the DSN, can be used by
  the sender to keep track of which messages were or were not delivered.

+ If a message was (a) forwarded to a different address than that
  specified by the sender, (b) gatewayed to a different mail system than
  that used by the sender, or (c) subjected to address rewriting during
  transmission, the "final" form of the recipient address (i.e. the one
  seen by the Reporting MTA) will be different than the original
  (sender-specified) recipient address.  Just as the sender's user agent
  (or the sender) prefers the original recipient address, so the "final"
  address is needed when reporting a problem to the postmaster of the
  site where message delivery failed, because only the final recipient
  address will allow her to reproduce the conditions that caused the
  failure.

+ A "failure" DSN should contain the most accurate explanation for the
  delivery failure that is available.  For ease of interpretation, this
  information should be a format which is independent of the mail
  transport system that issued the DSN.  However, if a foreign error
  code is translated into some transport-independent format, some
  information may be lost.  It is therefore desirable to provide both a
  transport-independent status code and a mechanism for reporting
  transport-specific codes.  Depending on the circumstances that
  produced delivery failure, the transport-specific code might be
  obtained from either the Reporting MTA or the Remote MTA.

Since different values for "recipient address" and "delivery status
code" are needed according to the circumstance in which a DSN will be
used, and since the MTA that issues the DSN cannot anticipate those
circumstances, the DSN format described here may contain both the
original and final forms of a recipient address, and both a transport-
independent and a transport-specific indication of delivery status.

Extension fields may also be added by the Reporting MTA as needed to
provide additional information for use in a trouble ticket or to
preserve information for tunneling of foreign delivery reports through
Internet DSNs.

The Original, Reporting, and Remote MTAs may exist in very different
environments and use dissimilar transport protocols, MTA names, address
formats, and delivery status codes.  DSNs therefore do not assume any



Moore/Vaudreuil           Expires 20 July 1995                  [Page 5]

Delivery Status Notifications                            20 January 1995



particular format for mailbox addresses, MTA names, or transport-
specific status codes.  Instead, the various DSN fields that carry such
quantities consist of a "type" subfield followed by a subfield whose
contents may be any octet string, and whose format is indicated by the
"type" subfield.  This allows a DSN to convey these quantities
regardless of format.


2. Format of a Delivery Status Notification

A DSN is a MIME message with a top-level content-type of
multipart/report (defined in [2]).  When a multipart/report content is
used to transmit a DSN:

+ The report-type parameter of the multipart/report content is
  "delivery-status".

+ The first component of the multipart/report contains a human-readable
  explanation of the DSN, as described in [5].

+ The second component of the multipart/report is of content-type
  message/delivery-status, described in section 2.1 of this document.

+ If the original message or a portion of the message is to be returned
  to the sender, it appears as the third compoment of the
  multipart/report.

  NOTE: For delivery status notifications gatewayed from foreign
  systems, the headers of the original message may not be available. In
  this case the third component of the DSN may be omitted, or it may
  contain "simulated" RFC 822 headers which contain equivalent
  information.  In particular, it is very desirable to preserve the
  subject, date, and message-id (or equivalent) fields from the original
  message.

The DSN MUST be addressed (in both the message header and the transport
envelope) to the return address from the transport envelope which
accompanied the original message for which the DSN was generated.  (For
a message that arrived via SMTP, the envelope return address appears in
the MAIL FROM command.)

The From field of the message header of the DSN SHOULD contain the
address of a human who is responsible for maintaining the mail system at
the Reporting MTA site (e.g.  Postmaster), so that a reply to the DSN
will reach that person.  Exception: if a DSN is translated from a
foreign delivery report, and the gateway performing the translation
cannot determine the appropriate address, the From field of the DSN MAY
be the address of a human who is responsible for maintaining the
gateway.

The envelope sender address of the DSN SHOULD be chosen to ensure that



Moore/Vaudreuil           Expires 20 July 1995                  [Page 6]

Delivery Status Notifications                            20 January 1995



no delivery status reports will be issued in response to the DSN itself,
and MUST be chosen so that DSNs will not generate mail loops.  (If an
SMTP transaction is used to send a DSN, the MAIL FROM address MUST be an
empty string.)

A particular DSN describes the delivery status for exactly one message.
However, an MTA MAY report on the delivery status for several recipients
of the same message in a single DSN.  Due to the nature of the mail
transport system (where responsibility for delivery of a message to its
recipients may be split among several MTAs, and delivery to any
particular recipient may be delayed), multiple DSNs may be still be
issued in response to a single message submission.


2.1 The message/delivery-status content-type

The message/delivery-status content-type is defined as follows:

     MIME type name:                message
     MIME subtype name:             delivery-status
     Optional parameters:           none
     Encoding considerations:       "7bit" encoding is sufficient and
                                    should be used to maintain
                                    readability when viewed by non-MIME
                                    mail readers.
     Security considerations:       discussed in section 4 of this memo.

The message/delivery-status report type for use in the multipart/report
is "delivery-status".

The body of a message/delivery-status consists of one or more "fields"
formatted according to the ABNF of RFC 822 header "fields" (see [6]).
The per-message fields appear first, followed by a blank line.
Following the per-message fields are one or more groups of per-recipient
fields.  Each group of per-recipient fields is preceded by a blank line.
Using the ABNF of RFC 822, the syntax of the message/delivery-status
content is as follows:

     delivery-status-content =
          per-message-fields 1*( CRLF per-recipient-fields )

The per-message fields are described in section 2.2.  The per-recipient
fields are described in section 2.3.


2.1.1 General conventions for DSN fields

Since these fields are defined according to the rules of RFC 822, the
same conventions for continuation lines and comments apply.
Notification fields may be continued onto multiple lines by beginning
each additional line with a SPACE or TAB.  Text which appears in



Moore/Vaudreuil           Expires 20 July 1995                  [Page 7]

Delivery Status Notifications                            20 January 1995



parenthesis is considered a comment and not part of the contents of that
notification field.  Field names are case-insensitive, so the names of
notification fields may be spelled in any combination of upper and lower
case letters.  Comments in DSN fields may use the "encoded-word"
construct defined in [7].

A number of DSN fields are defined to have a portion of a field body of
"xtext".  "xtext" is used to allow encoding sequences of octets which do
not consist entirely of ASCII characters, and also to allow comments to
be inserted in the data.  Any octet may be represented by "+" followed
by two upper case hexadecimal digits.  With certain exceptions, octets
that correspond to ASCII characters may be represented as themselves.
SPACE and HTAB characters are ignored.  Comments may be included by
enclosing them in parenthesis.  Except within comments, encoded-words
such as defined in [7] may NOT be used in xtext.

"xtext" is formally defined as follows:

     xtext = *( xchar / hexchar / linear-white-space / comment )

     xchar = any ASCII CHAR between "!" (33) and "~" (126) inclusive,
          except for "+", "\" and "(".

"hexchar"s are intended to encode octets that cannot be represented as
plain text, either because they are reserved, or because they are non-
printable.  However, any octet value may be represented by a "hexchar".

     hexchar = ASCII "+" immediately followed by two upper case
          hexadecimal digits

When encoding an octet sequence as xtext:

+ Any ASCII CHAR between "!" and "~" MAY be encoded as itself.  (Some
  CHARs in this range may also be encoded as "hexchar"s, at the
  implementor's discretion.)

+ ASCII CHARs that fall outside the range above must be encoded as
  "hexchar".

+ Line breaks (CR LF SPACE) MAY be inserted as necessary to keep line
  lengths from becoming excessive.

+ Comments MAY be added to clarify the meaning for human readers.


2.1.2 "*-type" subfields

Several DSN fields require a "-type" subfield that specifies the format
of a mailbox address, status code, or MTA name.  These types are defined
as follows:




Moore/Vaudreuil           Expires 20 July 1995                  [Page 8]

Delivery Status Notifications                            20 January 1995



+ An "address-type" specifies the format of a mailbox address.  For
  example, Internet mail addresses use the "rfc822" address-type.

       address-type = atom

+ A "diagnostic-type" specifies the format of a status code.  For
  example, when a DSN field contains a reply code reported via the
  Simple Mail Transfer Protocol [3], the "smtp" diagnostic-type is used.

       diagnostic-type = atom

+ An "MTA-name-type" specifies the format of an MTA name.  For example,
  for an SMTP server on an Internet host, the MTA name is the domain
  name of that host, and the "dns" MTA-name-type is used.

       MTA-name-type = atom

The Internet Assigned Numbers Authority (IANA) will maintain a registry
of address-types, diagnostic-types, and MTA-name-types, along with
descriptions of the meanings and acceptable values of each, or a
reference to a one or more specifications that provide such
descriptions.  (The "rfc822" address-type, "smtp" diagnostic-type, and
"dns" MTA-name-type are defined in [4].)

The registration for an address-type should include the name of the
address-type and a specification (or a reference to a specification)
that describes the syntax for that type of electronic mail address.

The registration for a diagnostic-type should include the name of the
diagnostic-type and a specification that describes the syntax of
diagnostic codes and the meanings of legal values for such codes.

The registration of an MTA-name-type should include the name of the MTA-
name-type and a description of the syntax of such names.

IANA will not accept registrations for any address-type, diagnostic-
type, or MTA-name-type name that begins with "X-".  These type names are
reserved for experimental use.


2.1.3 Lexical tokens imported from RFC 822

The following lexical tokens, defined in [6], are used in the ABNF
grammar for DSNs: atom, CHAR, comment, CR, CRLF, date-time, DIGIT, LF,
linear-white-space, SPACE.


2.2 Per-Message DSN Fields

Some fields of a DSN apply to all of the delivery attempts described by
that DSN.  These fields may appear at most once in any DSN.  These



Moore/Vaudreuil           Expires 20 July 1995                  [Page 9]

Delivery Status Notifications                            20 January 1995



fields are used to correlate the DSN with the original message
transaction and to provide additional information which may be useful to
gateways.

     per-message-fields =
          [ original-envelope-id-field CRLF ]
          reporting-mta-field CRLF
          [ received-from-mta-field CRLF ]
          [ arrival-date-field CRLF ]
          *( extension-field CRLF )


2.2.1 The Original-Envelope-Id field

The optional Original-Envelope-Id field contains an "envelope
identifier" which uniquely identifies the transaction during which the
message was submitted, and was either (a) specified by the sender and
supplied to the sender's MTA, or (b) generated by the sender's MTA and
made available to the sender when the message was submitted.  Its
purpose is to allow the sender (or her user agent) to associate the
returned DSN with the specific transaction in which the message was
sent.

The Original-Envelope-Id field is defined as follows:

     original-envelope-id-field =
          "Original-Envelope-Id" ":" envelope-id

     envelope-id = xtext

There may be at most one Original-Envelope-Id field per DSN.  If an
original "envelope identifier" is not available when a DSN is issued,
the Original-Envelope-Id DSN field SHOULD NOT be included in the DSN.

NOTE: An MTA should not supply an envelope-id for a message if one was
not present in the transmission envelope.  For the envelope-id field to
be useful, it must be unique for each message transmission, known by the
sender of the original message when the message was sent, and be
transmitted along with the message envelope.  However, the MTA issuing
the DSN has no way of knowing whether the envelope-id it received in a
message envelope is the same as the "original" one known by the message
sender.  Some mail protocols require an envelope-id or similar token,
and a gateway into such an environment will have to concoct one without
the sender's knowledge.  If a DSN is issued for such a message, it may
contain an envelope-id which is not specified by the sender.  In general
this seems unavoidable.

The envelope-id is NOT case-insensitive.  The DSN must preserve the
original case and spelling of the envelope-id.





Moore/Vaudreuil           Expires 20 July 1995                 [Page 10]

Delivery Status Notifications                            20 January 1995



NOTE: The Original-Envelope-Id is NOT the same as the Message-Id from
the message header.  The Message-Id identifies the content of the
message, while the Original-Envelope-Id identifies the transaction in
which the message is sent.


2.2.2 The Reporting-MTA DSN field

     reporting-mta-field =
          "Reporting-MTA" ":" mta-name-type ";" mta-name

     mta-name = xtext

The Reporting-MTA field is defined as follows:

A DSN describes the results of attempts to deliver, relay, or gateway a
message to one or more recipients.  The Reporting-MTA is the MTA which
attempted to perform the delivery, relay, or gateway operation described
in the DSN.  This field is required.

Note that the Reporting-MTA is not necessarily the MTA which actually
issued the DSN.  For example:

+ If an SMTP client attempts to relay a message to an SMTP server and
  receives an error reply to a RCPT command, the client is responsible
  for generating the DSN, and the client's domain name will appear in
  the Reporting-MTA field.

+ If an attempt to deliver a message outside of the Internet resulted in
  a nondelivery notification which was gatewayed back into Internet
  mail, the Reporting-MTA field of the resulting DSN would be that of
  the MTA that originally reported the delivery failure, not that of the
  gateway which converted the foreign notification into a DSN.

The mta-name portion of the Reporting-MTA field is formatted according
to the conventions indicated by the mta-name-type subfield.

Because the exact spelling of an MTA name may be significant in a
particular environment, MTA names must be considered case-sensitive.


2.2.3 The Received-From-MTA DSN field

The optional Received-From-MTA field indicates the name of the MTA from
which the message was received.  (In Figure 1, this MTA is labeled the
"preceding" MTA.)

     received-from-mta-field =
          "Received-From-MTA" ":" mta-name-type ";" mta-name

If the message was received from an Internet host, the contents of the



Moore/Vaudreuil           Expires 20 July 1995                 [Page 11]

Delivery Status Notifications                            20 January 1995



mta-name subfield should be the Internet domain name corresponding to
the network address of that host.  (In this case, the mta-name-type will
usually be "smtp", but may be different if another protocol was used.)

The mta-name portion of the Received-From-MTA field is formatted
according to the conventions indicated by the mta-name-type subfield.

Since case is significant in some mail systems, the exact spelling,
including case, of the MTA name should be preserved.


2.2.4 The Arrival-Date DSN field

The optional Arrival-Date field indicates the date and time at which the
message arrived at the Reporting MTA.  If the Date field is also
provided in a per-recipient field, this can be used to determine the
interval between when the message arrived at the Reporting MTA and when
the report was issued for that recipient.

     arrival-date-field = "Arrival-Date" ":" date-time

The date and time are expressed in RFC 822 'date-time' format.  Numeric
timezones ([+/-]HHMM format) MUST be used.


2.3 Per-Recipient DSN fields

A DSN contains information about attempts to deliver a message to one or
more recipients.  The delivery information for any particular recipient
is contained in a group of contiguous per-recipient fields.

The syntax for the group of per-recipient fields is as follows:


     per-recipient-fields =
          [ original-recipient-field CRLF ]
          final-recipient-field CRLF
          action-field CRLF
          status-field CRLF
          [ remote-mta-field CRLF ]
          [ diagnostic-code-field CRLF ]
          [ last-attempt-date-field CRLF ]
          [ expiry-date-field CRLF ]
          *( extension-field CRLF )


2.3.1 Original-Recipient field

The Original-Recipient field indicates the original recipient address as
specified by the sender of the message for which the DSN is being
issued.



Moore/Vaudreuil           Expires 20 July 1995                 [Page 12]

Delivery Status Notifications                            20 January 1995



     original-recipient-field =
          "Original-Recipient" ":" address-type ";" generic-address
     generic-address = xtext

The address-type field indicates the type of the original recipient
address.  If the message originated within the Internet, the address-
type field field will normally be "rfc822", and the address will be
according to the syntax specified in [6].  The value "unknown" should be
used if the Reporting MTA cannot determine the type of the original
recipient address from the message envelope.

This field is optional.  It should be included only if the sender-
specified recipient address was present in the message envelope, such as
by the ESMTP extensions defined in [4].  This address is the same as
that provided by the sender and can be used to automatically correlate
DSN reports and message transactions.


2.3.2 Final-Recipient field

The Final-Recipient field indicates the recipient for which this set of
per-recipient fields applies.  This field is required in each set of
per-recipient data.

The syntax of the field is as follows:

     final-recipient-field =
          "Final-Recipient" ":" address-type ";" generic-address

The address subfield of the recipient field should contain the mailbox
address of the recipient (from the transport envelope) as it was when
the message was accepted for delivery by the Reporting MTA.

The Final-Recipient address may differ from the address originally
provided by the sender, because it may have been transformed during
forwarding and gatewaying into an totally unrecognizable mess.
However, in the absence of the optional Original-Recipient field, the
Final-Recipient field and any returned content may be all the
information available to correlate the DSN with a particular message
submission.

The address-type field indicates the type of address expected by the
reporting MTA in that context; for example, recipient addresses
obtained via SMTP will normally be of address-type "rfc822".

NOTE: The Reporting MTA is not expected to ensure that the address
actually conforms to the syntax conventions of the address-type.
Instead, it should report exactly the address received in the
envelope, without any changes other than those needed to encode the
address in "xtext".




Moore/Vaudreuil           Expires 20 July 1995                 [Page 13]

Delivery Status Notifications                            20 January 1995



Since mailbox addresses (including those used in the Internet) may be
case sensitive, the case of alphabetic characters in the address must
be preserved.



2.3.3 Action field

The Action field indicates the action performed by the Reporting-MTA
as a result of its attempt to deliver the message to this recipient
address.  This field MUST be present for each recipient named in the
DSN.

The syntax for the action-field is:

     action-field = "Action" ":" action-value

     action-value = "failure" / "delayed" / "delivered" / "relayed"

The action-value may be spelled in any combination of upper and lower
case characters.

"failure"    indicates that the message could not be delivered to the
             recipient.  The Reporting MTA has abandoned any attempts to
             deliver the message to this recipient.  No further
             notifications should be expected.

"delayed"    indicates that the Reporting MTA has so far been unable to
             deliver or relay the message, but it will continue to
             attempt to do so.  Additional notification messages may be
             issued as the message is further delayed or successfully
             delivered, or if delivery attempts are later abandoned.

"delivered"  indicates that the message was successfully delivered to
             the recipient address specified by the sender, which
             includes "delivery" to a mailing list expander.  It does
             not indicate that the message has been read.  This is a
             terminal state and no further DSN for this recipient should
             be expected.

"relayed"    indicates that the message has been relayed or gatewayed
             into a "foreign" environment that does not accept
             responsibility for generating DSNs according to this
             specification.  Additional notification messages may be
             provided by the "foreign" environment that may or may not
             conform to this specification.  (However, for subsequent
             notifications, the Original-Recipient and Original-
             Envelope-ID fields will almost certainly not be included
             because they will no longer be available.)





Moore/Vaudreuil           Expires 20 July 1995                 [Page 14]

Delivery Status Notifications                            20 January 1995




NOTE ON ACTION VS. STATUS CODES:  Although the 'action' field might seem
to be redundant with the 'status' field, this is not the case.  In
particular, a "temporary failure" ("4") status code could be used with
an action-value of either "delayed" or "failure".


2.3.4 Status field

The per-recipient Status field contains a transport-independent status
code which indicates the delivery status of the message to that
recipient.  This field MUST be present for each delivery attempt which
is described by a DSN.

The syntax of the status field is:

     status-field = "Status" ":" status-code

     status-code = DIGIT "." 1*DIGIT "." 1*DIGIT

Status codes thus consist of three numerical fields separated by ".".
The first sub-field indicates whether the delivery attempt was
successful (2 = success, 4 = persistent temporary failure, 5 = permanent
failure).  The second sub-field indicates the probable source of any
delivery anomalies, and the third sub-field denotes a precise error
condition.

DSN status codes must be defined by standards track RFCs.  IANA will
maintain a registry of such codes.

Initially, the following three status codes are defined:

     2.0.0  successful relay, gateway, or delivery operation
     4.0.0  unspecified persistent temporary failure
     5.0.0  unspecified permanent failure

NOTE: An extensive set of status codes is currently under development
(see [5]) which, if approved for standardization, will supplement the
list above.  Eventually the list may be incorporated into a future
version of this memo.

Although status-codes are purely numeric, explanatory text may be
included as a comment in parentheses following the status-code.


2.3.5 Remote-MTA field

The value associated with the Remote-MTA DSN field should be a printable
ASCII representation of the name of the "remote" MTA that reported
delivery status to the "reporting" MTA.




Moore/Vaudreuil           Expires 20 July 1995                 [Page 15]

Delivery Status Notifications                            20 January 1995



     remote-mta-field = "Remote-MTA" ":" mta-name-type ";" mta-name

NOTE: The Remote-MTA field preserves the "while talking to" information
that was provided in some pre-existing nondelivery reports.

This field is optional.  It SHOULD NOT be included if no remote MTA was
involved in the attempted delivery of the message to that recipient.


2.3.6 Diagnostic-Code field

For a "failure" or "delayed" recipient, the Diagnostic-Code DSN field
contains the actual diagnostic code issued by the mail transport.  Since
such codes vary from one mail transport to another, the diagnostic-type
subfield is needed to specify which type of diagnostic code is
represented.

     diagnostic-code-field = "Diagnostic-Code" ":" diagnostic-type ";"
          xtext

NOTE:  The information in the Diagnostic-Code field may be somewhat
redundant with that from the Status field.  The Status field is needed
so that any DSN, regardless of origin, may be understood by any user
agent or gateway that parses DSNs.  Since the Status code will sometimes
be less precise than the actual transport diagnostic code, the
Diagnostic-Code field is provided to retain the latter information.
Such information may be useful in a trouble ticket sent to the
administrator of the Reporting MTA, or when tunneling foreign
nondelivery reports through DSNs.

If the Diagnostic Code was obtained from a Remote MTA during an attempt
to relay the message to that MTA, the Remote-MTA field should be
present.  When interpreting a DSN, the presence of a Remote-MTA field
indicates that the Diagnostic Code was issued by the Remote MTA.  The
absence of a Remote-MTA indicates that the Diagnostic Code was issued by
the Reporting MTA.

This field is optional, because some mail systems supply no additional
information beyond that which is returned in the 'action' and 'status'
fields.  However, this field should be included if transport-specific
diagnostic information is available.


2.3.7 Last-Attempt-Date field

The Last-Attempt-Date field gives the date and time of the last attempt
to relay, gateway, or deliver the message (whether successful or
unsuccessful) by the Reporting MTA.  This is not necessarily the same as
the value of the Date field from the header of the message used to
transmit this delivery status notification: In cases where the DSN was
generated by a gateway, the Date field in the message header should



Moore/Vaudreuil           Expires 20 July 1995                 [Page 16]

Delivery Status Notifications                            20 January 1995



contain the time the DSN was sent by the gateway and the DSN Last-
Attempt-Date field should be the time the last delivery attempt
occurred.

     last-attempt-date-field = "Last-Attempt-Date" ":" date-time

This field is optional.  It SHOULD NOT be included if the actual date
and time of the last delivery attempt are not available (which might be
the case if the DSN were being issued by a gateway).

The date and time are expressed in RFC 822 'date-time' format.  Numeric
timezones ([+/-]HHMM format) MUST be used.


2.3.8 Expiry-Date field

For DSNs of type "delay", the "Expiry-Date" field gives the date after
which the Reporting MTA expects to abandon all attempts to deliver the
message to that recipient.  The Expiry-Date field is optional for
"delay" DSNs, and SHOULD NOT appear in other DSNs.

     expiry-date-field = "Expiry-Date" ":" date-time

The date and time are expressed in RFC 822 'date-time' format.  Numeric
timezones ([+/-]HHMM format) MUST be used.


2.4 Extension fields

Additional per-message or per-recipient DSN fields may be defined in the
future by later revisions or extensions to this specification.
Extension-field names beginning with "X-" will never be defined as
standard fields; such names are reserved for experimental use.  DSN
field names NOT beginning with "X-" MUST be published in an RFC.

Extension DSN fields MAY also be defined for the following reasons:

+ To allow additional information from foreign delivery status reports
  to be tunneled through Internet DSNs.  The names of such DSN fields
  should begin with an indication of the foreign environment name (e.g.
  X400-Physical-Forwarding-Address).

+ To allow the transmission of diagnostic information which is specific
  to a particular mail transport protocol.  The names of such DSN fields
  should begin with an indication of the mail transport being used (e.g.
  SMTP-Remote-Recipient-Address).  Such fields should be used for
  diagnostic purposes only and not by user agents or mail gateways.

+ To allow transmission of diagnostic information which is specific to a
  particular message transfer agent (MTA).  The names of such DSN fields
  should begin with an indication of the MTA which produced the DSN.



Moore/Vaudreuil           Expires 20 July 1995                 [Page 17]

Delivery Status Notifications                            20 January 1995



  (e.g. Foomail-Queue-ID).

MTA implementors are encouraged to provide adequate information, via
extension fields if necessary, to allow an MTA maintainer to understand
the nature of correctable delivery failures and how to fix them.  For
example, if message delivery attempts are logged, the DSN might include
information which allows the MTA maintainer to easily find the log entry
for a failed delivery attempt.

If an MTA developer does not wish to register the meanings of such
extension fields, "X-" fields may be used for this purpose.  To avoid
name collisions, the MTA name should follow the "X-", (e.g.  "X-Foomail-
Log-ID").

All extension fields are assumed to have the following syntax:

     extension-field = extension-field-name ":" xtext

     extension-field-name = atom


3. Conformance and Usage Requirements

An MTA or gateway conforms to this specification if it generates DSNs
according to the protocol defined in this memo.  For MTAs and gateways
that do not support requests for positive delivery notification (such as
in [4]), it is sufficient that delivery failure reports use this
protocol.

A minimal implementation of this specification need generate only the
Reporting-MTA per-message field, and the Final-Recipient, Action, and
Status fields for each attempt to deliver a message to a recipient
described by the DSN.  Generation of the other fields, when appropriate,
is strongly recommended.

MTAs and gateways MUST NOT generate the Original-Recipient field of a
DSN unless the mail transfer protocol provides the address originally
specified by the sender at the time of submission. (Ordinary SMTP does
not make that guarantee, but the SMTP extension defined in [4] permits
such information to be carried in the envelope if it is available.)

Each sender-specified recipient address should result in at most one
"delivered" or "failure" DSN for that recipient.  If a DSN is requested
for a message that is forwarded to multiple recipients, the forwarding
MTA should normally issue a "relayed" DSN for the originally-specified
recipient and not propagate the request for a DSN to the forwarding
addresses.  Alternatively, the forwarding MTA can relay the request for
a DSN to exactly one of the forwarding addresses and not propagate the
request to the others.

Submission of a message to a mailing list exploder is considered final



Moore/Vaudreuil           Expires 20 July 1995                 [Page 18]

Delivery Status Notifications                            20 January 1995



delivery of the message.  Upon delivery of a message to a recipient
address corresponding to a mailing list expander, the Reporting MTA
should issue an appropriate DSN exactly as if the recipient address were
that of an ordinary mailbox.

NOTE:  This is actually intended to make DSNs usable by mailing lists
themselves.  Any message sent to a mailing list subscriber should have
its envelope return address pointing to the list maintainer [see RFC
1123, section 5.3.7(E)].  Since DSNs are sent to the envelope return
address, all DSNs resulting from delivery to the recipients of a mailing
list will be sent to the list maintainer.  The list maintainer may elect
to mechanically process DSNs upon receipt, and thus automatically delete
invalid addresses from the list.  (See section 10.)

This specification places no restrictions on the processing of DSNs
received by user agents or distribution lists.


4. Security considerations

The following security considerations apply when using DSNs:


4.1 Forgery

DSNs may be forged as easily as ordinary Internet electronic mail.  User
agents and automatic mail handling facilities (such as mail distribution
list expanders) that wish to make automatic use of DSNs should take
appropriate precautions to minimize the potential damage from denial-of-
service attacks.

Security threats related to forged DSNs include the sending of:

+ A falsified delivery notification when the message is not delivered to
  the indicated recipient,
+ A falsified non-delivery notification when the message was in fact
  delivered to the indicated recipient,
+ A falsified Final-Recipient address,
+ A falsified Remote-MTA identification,
+ A falsified relay notification when the message is "dead ended".
+ Unsolicited DSNs


4.2 Confidentality

Another dimension of security is confidentiality.  There may be cases in
which a message recipient is autoforwarding messages but does not wish
to divulge the address to which the messages are autoforwarded.  The
desire for such confidentiality will probably be heightened as "wireless
mailboxes", such as pagers, become more widely used as autoforward
addresses.



Moore/Vaudreuil           Expires 20 July 1995                 [Page 19]

Delivery Status Notifications                            20 January 1995



MTA authors are encouraged to provide a mechanism which enables the end
user to preserve the confidentality of a forwarding address.  Depending
on the degree of confidentiality required, and the nature of the
environment to which a message were being forwarded, this might be
accomplished by one or more of:

a. issuing a "relayed" DSN (if a positive DSN were requested) when a
   message were forwarded to a confidential forwarding address, and
   disabling requests for positive DSNs for the forwarded message,

b. omitting "Remote-*" or extension fields of a DSN whenever they would
   otherwise contain confidential information (such as a confidential
   forwarding address),

c. for messages forwarded to a confidential address, setting the
   envelope return address (e.g. SMTP MAIL FROM address) to the empty
   string (so that no DSNs would be sent from a downstream MTA to the
   original sender),

d. for messages forwarded to a confidential address, disabling delivery
   notifications for the forwarded message (e.g. if the "next-hop" MTA
   using ESMTP and supports the DSN extension, by using the NOTIFY=NEVER
   parameter to the RCPT command), or

e. when forwarding mail to a confidential address, having the forwarding
   MTA rewrite the envelope return address for the forwarded message and
   attempt delivery of that message as if it were the originator.  After
   obtaining final delivery status, it would issue a "proxy" DSN to the
   original sender.
In general, any optional DSN field may be omitted if the Reporting MTA
site determines that inclusion of the field would impose too great a
compromise of site confidentiality.  The need for such confidentiality
must be balanced against the utility of the omitted information in
trouble reports and DSNs gatewayed to foreign environments.

Implementors are cautioned that many existing MTAs will send nondelivery
notifications to a return address in the message header (rather than to
the one in the envelope), in violation of SMTP and other protocols.  If
a message is forwarded through such an MTA, no reasonable action on the
part of the forwarding MTA will prevent the downstream MTA from
compromising the forwarding address.  Likewise, if the recipient's MTA
automatically responds to messages based on a request in the message
header (such as the nonstandard, but widely used, Return-Receipt-To
extension header), it will also compromise the forwarding address.


4.3 Non-Repudiation

Within the framework of today's internet mail, the DSNs defined in this
memo provide valuable information to the mail user; however, even a
"failure" DSN can not be relied upon as a guarantee that a message was



Moore/Vaudreuil           Expires 20 July 1995                 [Page 20]

Delivery Status Notifications                            20 January 1995



not received by the recipient.  Even if DSNs are not actively forged,
conditions exist under which a message can be delivered despite the fact
that a failure DSN was issued.

For example, a race condition in the SMTP protocol allows for the
duplication of messages if the connection is dropped following a
completed DATA command, but before a response is seen by the SMTP
client.  This will cause the SMTP client to retransmit the message, even
though the SMTP server has already accepted it.  If one of those
delivery attempts succeeds and the other one fails, a "failure" DSN
could be issued even though the message actually reached the recipient.


5. Acknowledgments

The authors wish to thank the following people for their reviews of
earlier drafts of this document and their suggestions for improvement:
Eric Allman, Harald Alvestrand, Allan Cargille, Jim Conklin, Peter
Cowen, Dave Crocker, Ned Freed, Steve Kille, John Klensin, John Gardiner
Myers, Mark Nahabedian, Julian Onions, Jacob Palme, Jean Charles Roy,
and Gregory Sheehan.


6. References

[1] Borenstein, N., Freed, N. "Multipurpose Internet Mail Extensions",
    RFC 1521, Bellcore, Innosoft, September 1993.

[2] Vaudreuil, G. "Multipart/Report", Internet-Draft.

[3] Postel, J., "Simple Mail Transfer Protocol", STD 10, RFC 821,
    USC/Information Sciences Institute, August 1982.

[4] Moore, K.  "SMTP Service Extension for Delivery Status
    Notifications", Internet-Draft.

[5] Vaudreuil, G.  "Enhanced Mail System Status Codes", Internet-Draft.

[6] Crocker, D., "Standard for the Format of ARPA Internet Text
    Messages", STD 11, RFC 822, UDEL, August 1982.

[7] Moore, K. "MIME (Multipurpose Internet Mail Extensions) Part Two:
    Message Header Extensions for Non-Ascii Text", RFC 1522, University
    of Tennessee, September 1993.


7. Author's Addresses

Keith Moore
University of Tennessee
107 Ayres Hall



Moore/Vaudreuil           Expires 20 July 1995                 [Page 21]

Delivery Status Notifications                            20 January 1995



Knoxville, TN 37996-1301
USA
email: moore@cs.utk.edu

Gregory M. Vaudreuil
Octel Network Services
17080 Dallas Parkway
Dallas, TX 75248-1905
USA
email: Greg.Vaudreuil@Octel.Com












































Moore/Vaudreuil           Expires 20 July 1995                 [Page 22]

Delivery Status Notifications                            20 January 1995



8. Appendix - collected grammar

NOTE:  The following lexical tokens are defined in RFC 822:  atom, CHAR,
comment, CR, CRLF, date-time, DIGIT, LF, linear-white-space, SPACE.

action-field = "Action" ":" action-value

action-value = "failure" / "delayed" / "delivered" / "relayed"

address-type = atom

arrival-date-field = "Arrival-Date" ":" date-time

delivery-status-content =
     per-message-fields 1*( CRLF per-recipient-fields )

diagnostic-code-field = "Diagnostic-Code" ":" diagnostic-type ";" xtext

envelope-id = xtext

expiry-date-field = "Expiry-Date" ":" date-time

extension-field = extension-field-name ":" xtext

extension-field-name = atom

final-recipient-field =
     "Final-Recipient" ":" address-type ";" generic-address

generic-address = xtext

; "hexchar"s are used to encode octets that cannot be represented
; as plain text, either because they are reserved, or because
; they are non-printable.

hexchar = ASCII "+" immediately followed by two upper
     case hexadecimal digits

last-attempt-date-field = "Last-Attempt-Date" ":" date-time

mta-name = xtext

mta-name-type = atom

original-envelope-id-field =
     "Original-Envelope-Id" ":" envelope-id

original-recipient-field =
     "Original-Recipient" ":" address-type ";" generic-address

per-message-fields =



Moore/Vaudreuil           Expires 20 July 1995                 [Page 23]

Delivery Status Notifications                            20 January 1995



     [ original-envelope-id-field CRLF ]
     reporting-mta-field CRLF
     [ received-from-mta-field CRLF ]
     [ arrival-date-field CRLF ]
     *( extension-field CRLF )

per-recipient-fields =
     [ original-recipient-field CRLF ]
     final-recipient-field CRLF
     action-field CRLF
     status-field CRLF
     [ remote-mta-field CRLF ]
     [ diagnostic-code-field CRLF ]
     [ last-attempt-date-field CRLF ]
     [ expiry-date-field CRLF ]
     *( extension-field CRLF )

received-from-mta-field =
     "Received-From-MTA" ":" mta-name-type ";" mta-name

remote-mta-field = "Remote-MTA" ":" mta-name-type ";" mta-name

reporting-mta-field =
     "Reporting-MTA" ":" mta-name-type ";" mta-name

status-code = DIGIT "." 1*DIGIT "." 1*DIGIT

status-field = "Status" ":" status-code

diagnostic-type = atom

xchar = any ASCII CHAR between "!" (33) and "~" (126) inclusive,
     except for "+", "\" and "(".

xtext = *( xchar / hexchar / linear-white-space / comment )



















Moore/Vaudreuil           Expires 20 July 1995                 [Page 24]

Delivery Status Notifications                            20 January 1995



     9. Appendix - Guidelines for gatewaying DSNs

     NOTE:  This section provides non-binding recommendations for the
     construction of mail gateways that wish to provide semi-transparent
     delivery reports between the Internet and another electronic mail
     system.  Specific DSN gateway requirements for a particular pair of
     mail systems may be defined by other documents.


     9.1 Gatewaying from other mail systems to DSNs

     A mail gateway may issue a DSN to convey the contents of a
     "foreign" delivery or non-delivery notification over Internet mail.
     When there are appropriate mappings from the foreign notification
     elements to DSN fields, the information may be transmitted in those
     DSN fields.  Additional information (such as might be useful in a
     trouble ticket or needed to tunnel the foreign notification through
     the Internet) may be defined in extension DSN fields.  (Such fields
     should be given names that identify the foreign mail protocol, e.g.
     X400-* for X.400 NDN or DN protocol elements)

     The gateway must attempt to supply reasonable values for the
     Reporting-MTA, Final-Recipient, Action, and Status fields.  These
     will normally be obtained by translating the values from the remote
     delivery or non-delivery notification into their Internet-style
     equivalents.  However, some loss of information is to be expected.
     For example, the set of status-codes defined for DSNs may not be
     adequate to fully convey the delivery diagnostic code from the
     foreign system.  The gateway should assign the most precise code
     which describes the failure condition, falling back on "generic"
     codes such as 2.0.0 (success), 4.0.0 (temporary failure), and 5.0.0
     (permanent failure) when necessary.  The actual foreign diagnostic
     code should be retained in the Diagnostic-Code field (with an
     appropriate diagnostic-type value) for use in trouble tickets or
     tunneling.

     The sender-specified recipient address, and the original envelope-
     id, if present in the foreign transport envelope, should be
     preserved in the Original-Recipient and Original-Envelope-ID
     fields.  NOTE: While the gateway is not required to ensure that
     these fields be authentic, they should be supplied only if there is
     a reasonable chance that the field values correspond to those at
     the time of submission of the original message.

     The gateway should also attempt to preserve the "final" recipient
     addresses and MTA names from the foreign system.  In the interest
     of human readability, it may be desirable to encode foreign
     protocol elements as meaningful printable ASCII strings, rather
     than encoding the foreign protocol elements using xtext.





Moore/Vaudreuil           Expires 20 July 1995                 [Page 25]

Delivery Status Notifications                            20 January 1995





     9.2 Gatewaying from DSNs to other mail systems

     A DSN may be gatewayed from the Internet to foreign mail system.
     The primary purpose of such gatewaying is to convey delivery status
     information in a form that is usable by the destination system.  A
     secondary purpose is to allow "tunneling" of DSNs through foreign
     mail systems, in case the DSN may be gatewayed back into the
     Internet.

     In general, the recipient of the DSN (i.e., the sender of the
     original message) will want to know, for each recipient: the
     closest available approximation to the original recipient address,
     the delivery status (success, failure, or temporary failure), and
     for failed deliveries, a diagnostic code that describes the reason
     for the failure.  Ideally, each of these will be in the original
     sender's format.

     The gateway should make an attempt to preserve the Original-
     Recipient address and Original-Envelope-ID (if present), in the
     resulting foreign delivery status report.

     When reporting delivery failures, if the diagnostic-type subfield
     of the Diagnostic-Code field indicates that the original diagnostic
     code is understood by the destination environment, the information
     from the Diagnostic-Code field should be used.  Failing that, the
     information in the Status field should be mapped into the closest
     available diagnostic code used in the destination environment.

     If it is possible to tunnel a DSN through the destination
     environment, the gateway specification may define a means of
     preserving the DSN information in the delivery status reports used
     by that environment.




















Moore/Vaudreuil           Expires 20 July 1995                 [Page 26]

Delivery Status Notifications                            20 January 1995



     10. Appendix - Guidelines for use of DSNs by mailing list expanders

     DSNs are designed to be used by mailing list expanders to allow
     them to detect and automatically delete recipients for whom mail
     delivery fails repeatedly.

     When forwarding a message to list subscribers, the mailing list
     expander should always set the envelope return address (e.g. SMTP
     MAIL FROM address) to point to a special address which is set up to
     received nondelivery reports.  A "smart" mailing list expander can
     therefore intercept such nondelivery reports, and if they are in
     the DSN format, automatically examine them to determine for which
     recipients a message delivery failed or was delayed.

     The Original-Recipient field should be used if available, since it
     should exactly match the subscriber address known to the list.  If
     the Original-Recipient field is not available, the recipient field
     may resemble the list subscriber address.  Often, however, the list
     subscriber will have forwarded his mail to a different address, or
     the address may be subject to some re-writing, so heuristics may be
     required to successfully match an address from the recipient field.
     Care is needed in this case to minimize the possibility of false
     matches.

     The reason for delivery failure can be obtained from the Status and
     Action fields.  Reports for recipients with action values other
     than "failure" can generally be ignored; in particular, subscribers
     should not be removed from a list due to "delayed" reports.

     In general, almost any failure status code (even a "permanent" one)
     can result from a temporary condition.  It is therefore recommended
     that a list expander not delete a subscriber based on any single
     failure DSN (regardless of the status code), but only on the
     persistence of delivery failure over a period of time.

     However, some kinds of failures are less likely than others to have
     been caused by temporary conditions, and some kinds of failures are
     more likely to be noticed and corrected quickly than others.  Once
     more precise status codes are defined, it may be useful to
     differentiate between the status codes when deciding whether to
     delete a subscriber.  For example, on a list with a high message
     volume, it might be desirable to temporarily suspend delivery to a
     recipient address which causes repeated "temporary" failures,
     rather than simply deleting the recipient.  The duration of the
     suspension might depend on the type of error.  On the other hand, a
     "user unknown" error which persisted for several days could be
     considered a reliable indication that address were no longer valid.







Moore/Vaudreuil           Expires 20 July 1995                 [Page 27]

Delivery Status Notifications                            20 January 1995



     11. Appendix - Examples

     NOTE:  These examples are provided as illustration only, and are
     not considered part of the DSN protocol specification.  If an
     example conflicts with the protocol definition above, the example
     is wrong.

     Likewise, the use of *-type subfield names or extension fields in
     these examples is not to be construed as a definition for those
     type names or extension fields.

     These examples were manually translated from bounced messages using
     whatever information was available.









































Moore/Vaudreuil           Expires 20 July 1995                 [Page 28]

Delivery Status Notifications                            20 January 1995



     11.1  This is a simple DSN issued after repeated attempts to
     deliver a message failed.  In this case, the DSN is issued by the
     same MTA from which the message was originated.


     Date: Thu, 7 Jul 1994 17:16:05 -0400
     From: Mail Delivery Subsystem <MAILER-DAEMON@CS.UTK.EDU>
     Message-Id: <199407072116.RAA14128@CS.UTK.EDU>
     Subject: Returned mail: Cannot send message for 5 days
     To: <owner-info-mime@cs.utk.edu>
     MIME-Version: 1.0
     Content-Type: multipart/report; report-type=delivery-status;
           boundary="RAA14128.773615765/CS.UTK.EDU"


     --RAA14128.773615765/CS.UTK.EDU
     The original message was received at Sat, 2 Jul 1994 17:10:28 -0400
     from root@localhost

        ----- The following addresses had delivery problems -----
     <louisl@larry.slip.umd.edu>  (unrecoverable error)

        ----- Transcript of session follows -----
     <louisl@larry.slip.umd.edu>... Deferred: Connection timed out
           with larry.slip.umd.edu.
     Message could not be delivered for 5 days
     Message will be deleted from queue

     --RAA14128.773615765/CS.UTK.EDU
     content-type: message/delivery-status

     Final-MTA: dns; cs.utk.edu

     Original-Recipient: rfc822; louisl@larry.slip.umd.edu
     Final-Recipient: rfc822; louisl@larry.slip.umd.edu
     Action: failure
     Status: 4.0.0
     Diagnostic-Code: smtp; 426 (connection timed out)
     Last-Attempt-Date: Thu, 7 Jul 1994 17:15:49 -0400

     --RAA14128.773615765/CS.UTK.EDU
     content-type: message/rfc822

     [original message goes here]
     --RAA14128.773615765/CS.UTK.EDU--









Moore/Vaudreuil           Expires 20 July 1995                 [Page 29]

Delivery Status Notifications                            20 January 1995



     11.2  This is another DSN issued by the sender's MTA, which
     contains details of multiple delivery attempts.  Some of these were
     detected locally, and others by a remote MTA.


     Date: Fri, 8 Jul 1994 09:21:47 -0400
     From: Mail Delivery Subsystem <MAILER-DAEMON@CS.UTK.EDU>
     Subject: Returned mail: User unknown
     To: <owner-ups-mib@CS.UTK.EDU>
     MIME-Version: 1.0
     Content-Type: multipart/report; report-type=delivery-status;
           boundary="JAA13167.773673707/CS.UTK.EDU"


     --JAA13167.773673707/CS.UTK.EDU
     content-type: text/plain; charset=us-ascii
        ----- The following addresses had delivery problems -----
     <arathib@vnet.ibm.com>  (unrecoverable error)
     <wsnell@sdcc13.ucsd.edu>  (unrecoverable error)

     --JAA13167.773673707/CS.UTK.EDU
     content-type: message/delivery-status

     Final-MTA: dns; cs.utk.edu

     Original-Recipient: rfc822 ; arathib@vnet.ibm.com
     Final-Recipient: rfc822 ; arathib@vnet.ibm.com
     Action: failure
     Status: 5.0.0 (permanent failure)
     Diagnostic-Code: smtp; 550
      ('arathib@vnet.IBM.COM' is not a registered gateway user)
     Remote-MTA: dns; vnet.ibm.com

     Original-Recipient: rfc822; johnh@hpnjld.njd.hp.com
     Final-Recipient: rfc822; johnh@hpnjld.njd.hp.com
     Action: delayed
     Status: 4.0.0 (hpnjld.njd.jp.com: host name lookup failure)

     Original-Recipient: rfc822; wsnell@sdcc13.ucsd.edu
     Final-Recipient: rfc822; wsnell@sdcc13.ucsd.edu
     Action: failure
     Status: 5.0.0
     Diagnostic-Code: smtp; 550 (user unknown)
     Remote-MTA: dns; sdcc13.ucsd.edu

     --JAA13167.773673707/CS.UTK.EDU
     content-type: message/rfc822

     [original message goes here]
     --JAA13167.773673707/CS.UTK.EDU--




Moore/Vaudreuil           Expires 20 July 1995                 [Page 30]

Delivery Status Notifications                            20 January 1995



     11.3 A delivery report generated by Message Router (MAILBUS) and
     gatewayed by PMDF_MR to a DSN.  In this case the gateway did not
     have sufficient information to supply an original-recipient
     address.


     Disclose-recipients: prohibited
     Date: Fri, 08 Jul 1994 09:21:25 -0400 (EDT)
     From: Message Router Submission Agent <AMMGR@corp.timeplex.com>
     Subject: Status of : Re: Battery current sense
     To: owner-ups-mib@CS.UTK.EDU
     Message-id: <01HEGJ0WNBY28Y95LN@mr.timeplex.com>
     MIME-version: 1.0
     content-type: multipart/report; report-type=delivery-status;
           boundary="[;84229080704991/122306@SYS30]"

     --[;84229080704991/122306@SYS30]
     content-type: text/plain

     Invalid address - nair_s
     %DIR-E-NODIRMTCH, No matching Directory Entry found

     --[;84229080704991/122306@SYS30]
     content-type: message/delivery-status

     Final-MTA: mailbus; SYS30

     Final-Recipient: unknown; nair_s
     Status: 5.0.0 (unknown permanent failure)
     Action: failure
     --[;84229080704991/122306@SYS30]--























Moore/Vaudreuil           Expires 20 July 1995                 [Page 31]

Delivery Status Notifications                            20 January 1995



     11.4 A delay report from a multiprotocol MTA.  Note that there is
     no returned content, so no third body part appears in the DSN.


     From: <postmaster@nsfnet-relay.ac.uk>
     Message-Id: <199407092338.TAA23293@CS.UTK.EDU>
     Received: from nsfnet-relay.ac.uk by sun2.nsfnet-relay.ac.uk
     id <g.12954-0@sun2.nsfnet-relay.ac.uk>;
     Sun, 10 Jul 1994 00:36:51 +0100
     To: owner-info-mime@cs.utk.edu
     Date: Sun, 10 Jul 1994 00:36:51 +0100
     Subject: WARNING: message delayed at "nsfnet-relay.ac.uk"
     content-type: multipart/report; report-type=delivery-status;
           boundary=foobar

     --foobar
     content-type: text/plain

     The following message:

     UA-ID:  Reliable PC (...
     Q-ID:   sun2.nsf:77/msg.11820-0

     has not been delivered to the intended recipient:

     thomas@de-montfort.ac.uk

     despite repeated delivery attempts over the past 24 hours.

     The  usual cause of this problem is that the remote system is
     temporarily unavailable.

     Delivery will continue to be attempted up to a total elapsed
     time of  168 hours, ie 7 days.

     You  will  be  informed  if  delivery proves to be impossible
     within this time.

     Please quote the Q-ID in any queries regarding this mail.

     --foobar
     content-type: message/delivery-status

     Final-MTA: dns; sun2.nsfnet-relay.ac.uk

     Final-Recipient: rfc822; thomas@de-montfort.ac.uk
     Status: 4.0.0 (unknown temporary failure)
     Action: delayed
     --foobar--





Moore/Vaudreuil           Expires 20 July 1995                 [Page 32]

Delivery Status Notifications                            20 January 1995



     11.5  A DSN gatewayed from a X.400 nondelivery notification


     From: "UK.AC.NSF MTA" <postmaster@nsfnet-relay.ac.uk>
     To: na-digest-bounces@netlib2.cs.utk.edu
     Subject: Delivery Report (failure) for sdz009@prime.napier.ac.uk
     Date: Mon, 11 Jul 1994 02:09:43 +0100
     Message-ID: <"sun3.nsfne.309:11.06.94.01.09.27"@nsfnet-relay.ac.uk>
     content-type: multipart/report; report-type=delivery-status;
           boundary=foobar

     --foobar
     content-type: text/plain

     This report relates to your message: Subject: NA Digest, V. 94, # 27,
       Message-ID: <199407031824.OAA23971@localhost>,
       To: na-digest list:;
             of Sun, 3 Jul 1994 19:47:56 +0100

     Your message was not delivered to   sdz009@prime.napier.ac.uk
             for the following reason:
             Message timed out

     --foobar
     content-type: message/delivery-status

     Final-MTA: dns; sun3.nsfnet-relay.ac.uk
      (in /PRMD=uk.ac/ADMD= /C=gb/)

     Original-Recipient: rfc822; sdz009@prime.napier.ac.uk
     Final-Recipient: x400;
      /S=sdz009/OU=prime/O=napier/PRMD=UK.AC/ADMD=+20/C=GB/
     Action: failure
     Status: 4.0.0
     Diagnostic-Code: x400 ; 1/5
      (unable-to-transfer/maximum-time-expired)
     X400-Subject-Intermediate-Trace-Information:
      /PRMD=uk.ac/ADMD= /C=gb/
      arrival Sun, 3 Jul 1994 19:47:56 +0100 action Relayed
     X400-Subject-Intermediate-Trace-Information:
      /PRMD=uk.ac/ADMD= /C=gb/
      arrival Sun, 3 Jul 1994 19:24:03 +0100 action Relayed

     --foobar
     content-type: message/rfc822

     [returned content]
     --foobar--






Moore/Vaudreuil           Expires 20 July 1995                 [Page 33]


