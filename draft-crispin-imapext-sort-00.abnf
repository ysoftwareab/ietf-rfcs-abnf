sort-data       = "SORT" *(SP nz_number)

sort            = ["UID" SPACE] "SORT" SP
                     "(" sort-criterion *(SP sort-criterion) ")"
                     SP search_charset 1*(SP search_key)

sort-criterion  = ["REVERSE" SPACE] sort_key

sort-key        = "ARRIVAL" / "CC" / "DATE" / "FROM" / "SIZE" /
                     "SUBJECT" / "TO"

subject         = *(subj-leader / subj-blob) subj-base *subj-trailer

subj-repeat     = "[" 1*DIGIT "]"

subj-refwd      = ("re" / ("fw" ["d"])) [subj-repeat] ":"

subj-leader     = subj-refwd / WSP

subj-blob       = "[" 1*BLOBCHAR "]" *WSP

subj-trailer    = "(fwd)" / WSP

subj-base       = NONWSP *([WSP] NONWSP)

BLOBCHAR        = %x01-5c / %x5e-7f
                   ; any CHAR except ']'

NONWSP          = %x01-08 / %x0a-1f / %x21-7f
                   ; any CHAR other than WSP

