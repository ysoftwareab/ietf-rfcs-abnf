<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>NFSv4 Multi-Domain Access</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="NFSv4 Multi-Domain Access">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">NFSv4 Working Group</td><td class="header">W. Adamson</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">NetApp</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">K. Coffman</td></tr>
<tr><td class="header">Expires: April 29, 2010</td><td class="header">CITI, University of Michigan</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">N. Williams</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Sun Microsystems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 26, 2009</td></tr>
</table></td></tr></table>
<h1><br />NFSv4 Multi-Domain Access<br />draft-adamson-nfsv4-multi-domain-access-02</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 29, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The Network File System, version 4 (NFSv4) uses a
		representation of identity that allows the use of users
		and groups from multiple, distinct administrative
		domains, and NFSv4 allows the use of security mechanisms
		that authenticate principals from multiple, distinct
		administrative domains.  This document describes methods
		by which NFSv4 clients and servers can handle
		principals, users, groups from multiple administrative
		domains.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements notation<br />
<a href="#anchor2">2.</a>&nbsp;
Introduction<br />
<a href="#anchor3">3.</a>&nbsp;
Background<br />
<a href="#anchor4">4.</a>&nbsp;
Terminology<br />
<a href="#ONDISK">5.</a>&nbsp;
Local Representations of Global Identity<br />
<a href="#anchor5">5.1.</a>&nbsp;
Storing Name@Domainname<br />
<a href="#ID@DOMAIN">5.2.</a>&nbsp;
Storing Remote-ID@Domainname<br />
<a href="#STORE">5.2.1.</a>&nbsp;
Storing Remote-ID@Domain-ID<br />
<a href="#small-IDs">5.2.2.</a>&nbsp;
ID Mapping<br />
<a href="#anchor6">5.3.</a>&nbsp;
Use of Name Services<br />
<a href="#anchor7">5.3.1.</a>&nbsp;
Using LDAP with RFC2307 Schema<br />
<a href="#anchor8">5.3.2.</a>&nbsp;
Using Active Directory LDAP<br />
<a href="#anchor9">5.3.3.</a>&nbsp;
Resolving Domain Names to Domain IDs<br />
<a href="#anchor10">5.3.4.</a>&nbsp;
LDAP DIT Construction for a Federated Namespace<br />
<a href="#V4ACCESS">6.</a>&nbsp;
GSS-API Principal-to-NFSv4 Authorization Context<br />
<a href="#AUTHCRED">6.1.</a>&nbsp;
Using GSS-API Naming Extensions<br />
<a href="#anchor11">6.1.1.</a>&nbsp;
Using a PAC<br />
<a href="#PRINC_TO_USER">6.2.</a>&nbsp;
Mapping Principal Names to Usernames<br />
<a href="#anchor12">6.2.1.</a>&nbsp;
Using a Name Service to Map Principal Names to User Accounts<br />
<a href="#anchor13">6.3.</a>&nbsp;
User Group Membership Determination<br />
<a href="#LDAP-EXT">7.</a>&nbsp;
LDAP Schema Extensions for Multi-Domain NFSv4<br />
<a href="#GSSAUTH">7.1.</a>&nbsp;
LDAP Attribute for Principal Name to Local ID Translation<br />
<a href="#anchor14">8.</a>&nbsp;
Name Resolution<br />
<a href="#anchor15">8.1.</a>&nbsp;
Using LDAP Caching Proxies<br />
<a href="#anchor16">8.2.</a>&nbsp;
LDAP Schema Extensions for ID Mapping<br />
<a href="#anchor17">9.</a>&nbsp;
Multi-Domain Access Summary<br />
<a href="#anchor18">10.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
		"SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
		and "OPTIONAL" in this document are to be interpreted as
		described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>The <a class='info' href='#RFC3530'>NFS Version 4<span> (</span><span class='info'>Shepler, S., Callaghan, B., Robinson, D., Thurlow, R., Beame, C., Eisler, M., and D. Noveck, &ldquo;Network File System (NFS) version 4 Protocol,&rdquo; April&nbsp;2003.</span><span>)</span></a> [RFC3530] protocol
		enables the construction of a distributed file system
		which can join NFSv4.0 or <a class='info' href='#I-D.ietf-nfsv4-minorversion1'>NFSv4.1<span> (</span><span class='info'>Shepler, S., Eisler, M., and D. Noveck, &ldquo;NFS Version 4 Minor Version 1,&rdquo; December&nbsp;2008.</span><span>)</span></a> [I&#8209;D.ietf&#8209;nfsv4&#8209;minorversion1]
		servers from multiple administrative domains, each
		potentially using separate
		name resolution services and separate security services,
		into a common multi-domain name space.
</p>
<p>NFSv4 deals with two kinds of identities: authentication
		identities (referred to here as "principals") and
		authorization identities ("users" and "groups" of
		users).  NFSv4 supports multiple authentication methods,
		each authenticating an "initiator principal" (typically
		representing a user) to an "acceptor principals" (always
		corresponding to the server).  NFSv4 does not prescribe
		how to represent authorization identities on file
		systems.  All file access decisions constitute
		"authorization" and are made by servers using
		information about client principals (such as username,
		group memberships, and so on) and file metadata related
		to authorization, such as a file's access control list
		(ACL).
</p>
<p>Authentication in NFSv4 occurs at the the <a class='info' href='#RFC2203'>RPCSEC_GSS<span> (</span><span class='info'>Eisler, M., Chiu, A., and L. Ling, &ldquo;RPCSEC_GSS Protocol Specification,&rdquo; September&nbsp;1997.</span><span>)</span></a> [RFC2203] layer where
		<a class='info' href='#RFC2743'>GSS-API mechanisms<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a> [RFC2743]
		are used to authenticate users on NFSv4 clients to NFSv4
		servers, and to provide security services such as
		confidentiality and integrity protection for the
		protocol's messages.  The NFSv4 protocol specifies no
		particular representation for authentication identities
		as these are entirely mechanism-specific
</p>
<p>Authorization for file object access is done at the NFSv4
		protocol layer (i.e., above the RPCSEC_GSS layer), on
		the server side, based on an authenticated client
		principal's authorization context and the authorization
		meta-data of the file system objects that the client
		wishes to access.  File authorization meta-data is set
		and retrieved in the NFSv4 <a class='info' href='#RFC1831'>RPC<span> (</span><span class='info'>Srinivasan, R., &ldquo;RPC: Remote Procedure Call Protocol Specification Version 2,&rdquo; August&nbsp;1995.</span><span>)</span></a> [RFC1831] layer, specifically via
		the object's owner, owner_group and acl, dacl and sacl
		attributes (the last three being ACLs).  ACLs are lists
		of ACL entries (ACEs).  Each ACE has a "who" field
		identifying a subject to whom some permision is granted
		or denied.  The owner and owner_group attributes and the
		who ACE field, all reference users and groups.  On the
		wire, the protocol represents users and groups as
		strings of characters with this form: name@domain, where
		&lt;name&gt; is a user or group name, and &lt;domain&gt;
		is a the name of an administrative domain, more
		specifically a <a class='info' href='#RFC1034'>DNS<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a> [RFC1034]
		domainname.
</p>
<p>NFSv4 server implementations usually do not, and really
		ought not, store authorization identities on disk in the
		same form as is used on the wire.  The reason is that
		users' and groups' names change all too often, while
		searching for and updating file authorization meta-data
		after a user/group name change is not trivial,
		particularly in a global namespace spanning multiple
		administrative domains.
</p>
<p>NFSv4 servers therefore must perform two kinds of
		mappings: a) authentication identity to authorization
		context (a principal's user ID, group memberships,
		etcetera), and on-the-wire authorization identity
		representation to on-disk authorization identity
		representation.  Many aspects of these mappings are
		entirely implementation-specific, but some require name
		resolution services, and in order to interoperate
		servers must use such services in compatible ways.  Many
		implementations are limited to being able to represent
		users and groups from a single domain.
</p>
<p>In this document we address both of those kind of
		mappings, describing possible implementation strategies,
		and specifying a name service for interoperation in a
		global namespace <a class='info' href='#I-D.ietf-nfsv4-federated-fs-reqts'>[I&#8209;D.ietf&#8209;nfsv4&#8209;federated&#8209;fs&#8209;reqts]<span> (</span><span class='info'>Lentini, J., Everhart, C., Ellard, D., Tewari, R., and M. Naik, &ldquo;Requirements for Federated File Systems,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Background</h3>

<p>NFSv4 uses a syntax of the form "name@domain" to
		represent, on the wire, the NFSv4 ACL name for users and
		groups.  This design provides a level of indirection
		that allows a client and server with different internal
		representations of authorization identity to
		interoperate even when referring to authorization
		identities from different administrative domains.
</p>
<p>Multi-domain capable sites need to meet certain
		requirements in order to ensure that clients and servers
		can map name@domain to internal representations
		reliably:
</p>
<p>
		</p>
<ul class="text">
<li>name@domain MUST be unique within the DNS domain.
</li>
<li>Every local representation of a user and of a
			group MUST have a canonical name@domain, and it
			must be possible to return the canonical
			name@domain for any identity stored on disk, at
			least when required infrastructure servers (such
			as name services) are online.
</li>
</ul><p>
	    
</p>
<p>
		    As described in <a class='info' href='#I-D.ietf-nfsv4-minorversion1'>[I&#8209;D.ietf&#8209;nfsv4&#8209;minorversion1]<span> (</span><span class='info'>Shepler, S., Eisler, M., and D. Noveck, &ldquo;NFS Version 4 Minor Version 1,&rdquo; December&nbsp;2008.</span><span>)</span></a>
		    section 2.2.1.1 "RPC Security Flavors":
		
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
        NFSv4.1 clients and servers MUST implement RPCSEC_GSS.  (This
        requirement to implement is not a requirement to use.)  Other
        flavors, such as AUTH_NONE, and AUTH_SYS, MAY be implemented
        as well.
</pre></div>
<p>The AUTH_NONE security flavor can be useful to the
		multi-domain NFSv4 or federated name space to grant
		universal access to public data without any credentials.
</p>
<p>The AUTH_SYS security flavor uses a host-based
		authentication model where the [weakly-authenticated]
		client asserts the user's authorization identities using
		small integers as user and group identity
		representations.  Because of the small integer
		authorization ID representation, AUTH_SYS can only be
		used in a name space where all clients and servers share
		a uidNumber and gidNumber translation service.  A shared
		translation service is required because uidNumbers and
		gidNumbers are passed in the RPC credential; there is no
		negotiation of namespace in AUTH_SYS.  Collisions can
		occur if multiple translation services are used.  These
		and other issues are addressed in <a class='info' href='#I-D.williams-rpcsecgssv3'>[I&#8209;D.williams&#8209;rpcsecgssv3]<span> (</span><span class='info'>Williams, N., &ldquo;Remote Procedure Call (RPC) Security Version 3,&rdquo; January&nbsp;2009.</span><span>)</span></a> which describes
		a new version of RPCSEC_GSS that includes a modernized
		replacement for AUTH_SYS.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Terminology</h3>

<p>
		</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>Identity: a way to refer to a user or group.
</dd>
<dt></dt>
<dd>Principal: an entity that is authenticated by
			RPCSEC_GSS (usually, but not always, a user;
			rarely, if ever, a group; sometimes a host).
</dd>
<dt></dt>
<dd>Authorization context: the set of user and group
			IDs, privileges, labels, and other items
			relevant to authorization, corresponding to a
			subject (user or principal).
</dd>
<dt></dt>
<dd>Domain-local ID: Most installations assign
			numeric, local identifiers to users and groups,
			using a namespace local to their domain.  We
			call this a domain-local ID.
</dd>
<dt></dt>
<dd>Local representation of identity: an item such as
			a POSIX user IDentifier (UID) or group ID (GID),
			or a Windows Security IDentifier (SID), or other
			such local representation of a user or a group
			of users.
</dd>
<dt></dt>
<dd>Global representation of identity: a tuple
			consisting of a domain identifier (possibly the
			domain's name itself) and a domain-local
			user/group ID.  We do not propose a standard
			global representation of identity, but the
			concept is useful.
</dd>
<dt></dt>
<dd>Domain: a set of users and computers administered
			by a single entity, and identified by a DNS
			domain name.
</dd>
<dt></dt>
<dd>POSIX IDs: small non-negative integers (typically
			0..2^31 or 0..2^32) identifiers.  The namespace
			of user IDs (UIDs) is distinct from the
			namespace of group IDs (GIDs).
</dd>
<dt></dt>
<dd>Windows SIDs: an identifier of security entities,
			including users and groups.  The form of a SID
			is:
			S-1-&lt;authority&gt;&lt;RID_0&gt;&lt;RID_1&gt;&lt;RID_n&gt;
			By convention some authority numbers denote
			security entities, identified by RID_n, local to
			a domain identified by RIDs 0..n-1.  Domain RIDs
			are usually generated randomly within a "forest"
			of domains.
</dd>
<dt></dt>
<dd>Name resolution: mapping from {domain, name} to
			{domain, ID}, and vice-versa via lookups. Can be
			applied to local or remote domains.
</dd>
<dt></dt>
<dd>ID mapping: {domain-remote ID } to { domain-local
			ID } mappings.
</dd>
<dt></dt>
<dd>Logon service:  { user ID } -> { groups user is a
			member of, and other authorization context }
</dd>
</dl></blockquote><p>
	    
</p>
<a name="ONDISK"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Local Representations of Global Identity</h3>

<p>Multi-domain support starts at the fileserver where local
		ID forms need to be able to represent global identities
		from both, local and remote domains.  Local
		representation of global identity also applies to
		clients, particularly clients with local filesystems.
		There's a range of local solutions to this multi-domain
		ID representation problem. In this section we describe
		several approaches to representing a
		&lt;name&gt;@&lt;local or remote domain&gt; on disk.
		None of these approaches are REQUIRED; all are
		INFORMATIVE.  However, conventions relating to the use
		of name services are NORMATIVE.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Storing Name@Domainname</h3>

<p>One simple approach to the multiple domain problem is
		    the identity function applied to name@domain, with
		    the resultant ID stored on disk.
</p>
<p>This approach imposes a severe constraint on the
		    administrators of these domains: user and group
		    names must never be reused, as there is also no
		    realistic way to keep the name@domain on disk
		    representation up to date with user, group or domain
		    renames and removals.  Consider a remote domain's
		    NFSv4 servers where real-time employee join/leave
		    data may be (typically is!) considered privileged,
		    and remote servers may not be sufficiently
		    privileged to access it [elaborate...].
</p>
<a name="ID@DOMAIN"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Storing Remote-ID@Domainname</h3>

<p>Most installations assign numeric, local identifiers
		    to users and groups, using a namespace local to
		    their domain.  We call this a domain-local ID.  We
		    can then construct a global identity form consisting
		    of a domain ID and a domain-local user/group ID.
</p>
<p>The user or group renaming issue can be addressed by
		    using a global identity form where domain-local IDs
		    are required.  I.e., use name resolution to lookup
		    name@domain to find the ID local to the domain, and
		    join the ID with the result of the identity function
		    applied to the domain.  This function still has
		    a renaming problem with respect to DNS domain
		    renames, but that is a realistically manageable
		    problem.
</p>
<a name="STORE"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.1"></a><h3>5.2.1.&nbsp;
Storing Remote-ID@Domain-ID</h3>

<p>The DNS domain renaming issue in the previous
			section can be addressed by assigning and
			publishing a unique ID to each DNS domain.
			I.e., use name resolution to lookup name@domain
			to find some ID local to the domain, lookup the
			domain ID and store &lt;remote-ID,domain-ID&gt;.
</p>
<a name="small-IDs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2.2"></a><h3>5.2.2.&nbsp;
ID Mapping</h3>

<p>Many file systems exported by NFS only store
			32-bit user and group IDs which limit their
			ability to utilize the on disk representation
			described in <a class='info' href='#ID@DOMAIN'>Section&nbsp;5.2<span> (</span><span class='info'>Storing Remote-ID@Domainname</span><span>)</span></a>.
			Such systems may need to use an additional
			service to map between &lt;remote users, local
			user IDs&gt; and &lt;remote groups, local group
			IDs&gt;.  We call this an "ID mapping
			service".
</p>
<p>The use of an ID mapping service is not strictly
			necessary if the system operates on IDs large
			enough such that &lt;user/group ID, domain
			ID&gt; can be encoded into a native ID.
			However, a large class of operating systems,
			those which are Unix or Unix-like operating
			systems, such as Solaris and Linux, use 32-bit
			UIDs and GIDs in many services and therefore need
			mapping for backwards compatibility reasons.
</p>
<p>One example of such a service is to keep a local
			or distributed database for dynamically
			assigning a local 32 bit ID to every
			&lt;ID&gt;@&lt;domain-ID&gt;, or one could do
			that only for remote domains, reserving only a
			small part of the local 32-bit ID namespace for
			remote domains'
			users/groups.
</p>
<p>The remote ID and remote domain are then used as
			inputs to a name resolution service which
			contacts the remote domain name service to
			resolve the remote name.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Use of Name Services</h3>

<p>Such file systems often use a distributed directory
		    service for assigning domain local 32 bit IDs to
		    remote users and groups.  The <a class='info' href='#NIS'>Network Information Service<span> (</span><span class='info'>Sun Microsystems, &ldquo;System and Network Administration,&rdquo; March&nbsp;1990.</span><span>)</span></a> [NIS]
		    and the <a class='info' href='#RFC4511'>Lightweight Directory
			Access Protocol<span> (</span><span class='info'>Sermersheim, J., &ldquo;Lightweight Directory Access Protocol (LDAP): The Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a> [RFC4511] are the two broadly
		    used distributed directory service protocols used
		    for this purpose.  LDAP is used instead of NIS in
		    environments where scale and security are issues.
		    <a class='info' href='#LDAP-EXT'>Section&nbsp;7<span> (</span><span class='info'>LDAP Schema Extensions for Multi-Domain NFSv4</span><span>)</span></a> expands the LDAP
		    protocol to include mappings between name@domain and
		    local user and group IDs.
</p>
<p>Support for LDAP <a class='info' href='#RFC4511'>[RFC4511]<span> (</span><span class='info'>Sermersheim, J., &ldquo;Lightweight Directory Access Protocol (LDAP): The Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a> with the
		    RFC2307 schema <a class='info' href='#RFC2307'>[RFC2307]<span> (</span><span class='info'>Howard, L., &ldquo;An Approach for Using LDAP as a Network Information Service,&rdquo; March&nbsp;1998.</span><span>)</span></a> is
		    REQUIRED.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
Using LDAP with RFC2307 Schema</h3>

<p>Name resolution consists of searches with scope
			'sub', a base DN corresponding to a domain (more
			on this below) and a filter of either of these
			forms, with matching on objectClass being
			optional:
</p>
<p>
			</p>
<ul class="text">
<li>((objectClass=posixAccount)(uid="&lt;username&gt;))
</li>
<li>((objectClass=posixGroup)(cn="&lt;groupname&gt;))
</li>
<li>((objectClass=posixAccount)(uidNumber="&lt;UID&gt;))
</li>
<li>((objectClass=posixGroup)(gidNumber="&lt;GID&gt;))
</li>
</ul><p>
		    
</p>
<p>The base DN should be formatted from a domain's
			DNS domainname as follows.  First format the
			domainname as a string, then strip the trailing
			dot ('.'), if any, then replace all dots ('.')
			with ",DC=", then prepend "DC=" to the resulting
			string.  For example, foo.bar.example becomes
			"DC=foo,DC=bar,DC=example".  This convention is
			REQUIRED to be implemented.  Domains with base
			DNs that do not match this convention may be
			used, but their domainname-to-base-DN mappings
			must be published where NFSv4 clients and
			servers may find them; we provide no conventions
			for publishing such mappings.  Implementations
			MUST support the use of LDAP referrals to find
			LDAP servers authoritative for any given base
			DN.
</p>
<p>For example, to resolve a user named
			joe@foo.bar.example to a remote ID a system
			would do an LDAP search with
			DC=foo,DC=bar,DC=example as the base DN,
			scope='sub' and with a filter of
			((objectClass=posixAccount)(uid="&lt;username&gt;))
			looking for the uidNumber attribute.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
Using Active Directory LDAP</h3>

<p>[Add text describing searches by which to resolve
			name@domain to SIDs and vice versa.]
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
Resolving Domain Names to Domain IDs</h3>

<p>[Add text on mapping domainnames to domain
			IDs.]
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.4"></a><h3>5.3.4.&nbsp;
LDAP DIT Construction for a Federated Namespace</h3>

<p>[Add text on federated namespace LDAP DIT
			construction, and caching services.
</p>
<a name="V4ACCESS"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
GSS-API Principal-to-NFSv4 Authorization Context</h3>

<p>In order to authorize user access to files, the NFSv4
		server must map the RPCSEC_GSS client principal name or
		the underlying GSS-API security context to local
		security information including a local ID, a set of
		group IDs and other user privileges.  This security
		information is contained in an "authorization context"
		(also called an "access token" in some systems).
</p>
<p>Authorization contexts consist of:
</p>
<p>
		</p>
<ol class="text">
<li>UserID: This field contains the principal's
			global ID and/or local ID mapping thereof, and
			the name@domain form thereof.
</li>
<li>PrimarygroupID: This field contains the global ID
			and/or local ID mapping thereof for the
			principal's primary group, and the name@domain
			form thereof.
</li>
<li>Groups: This field contains an array of group IDs
			for the groups that the user is a member of, in
			global ID form and/or local ID mappings thereof,
			as well as in name@domain name@domain forms.
</li>
<li>As yet unspecified field(s) for privileges and
			authorizations granted to the principal, if
			any.
</li>
<li>As yet unspecified field(s) for other privilege
			information such as the multi-level security
			label range/set of the principal.
</li>
<li>Implementation-specific items relevant to
			authorization.
</li>
</ol><p>
	    
</p>
<p>The RPCSEC_GSS client principal authorization context
		determination may be mechanism-specific, and even
		operating system-specific, but from the NFSv4 server's
		point of view, it is a generic facility.  Below we
		describe several methods of authorization context
		determination.
</p>
<p>The NFSv4 authorization context SHOULD be obtained via
		discrete GSS-API name attributes <a class='info' href='#I-D.ietf-kitten-gssapi-naming-exts'>[I&#8209;D.ietf&#8209;kitten&#8209;gssapi&#8209;naming&#8209;exts]<span> (</span><span class='info'>Williams, N. and L. Johansson, &ldquo;GSS-API Naming Extensions,&rdquo; March&nbsp;2010.</span><span>)</span></a>
		corresponding to the above elements of authorization
		contexts.  URIs for those attributes are TBD.  If the
		named attribute interface is not available, or the
		attributes are not available, other means of determining
		a principal's authorization context SHOULD be used, such
		as those described in <a class='info' href='#AUTHCRED'>Section&nbsp;6.1<span> (</span><span class='info'>Using GSS-API Naming Extensions</span><span>)</span></a>
		and <a class='info' href='#PRINC_TO_USER'>Section&nbsp;6.2<span> (</span><span class='info'>Mapping Principal Names to Usernames</span><span>)</span></a>.
</p>
<a name="AUTHCRED"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Using GSS-API Naming Extensions</h3>

<p>Authorization context information can sometimes be
		    obtained from the credentials authenticating a
		    principal; the GSS-API represents such information
		    as attributes of the initiator prinicpal's name.
		    For example: Kerberos 5 <a class='info' href='#RFC4120'>[RFC4120]<span> (</span><span class='info'>Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;The Kerberos Network Authentication Service (V5),&rdquo; July&nbsp;2005.</span><span>)</span></a> has
		    a method for conveying "authorization data", both
		    client-asserted as well as KDC-authenticated
		    authorization data, and one KDC implementation uses
		    this feature to convey a "privilege attribute
		    certificate" (PAC) listing the principal's user and
		    group "security identifiers" (SIDs).  PKIX <a class='info' href='#RFC5280'>[RFC5280]<span> (</span><span class='info'>Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile,&rdquo; May&nbsp;2008.</span><span>)</span></a> certificates allow for
		    extensions that could be used similarly.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1.1"></a><h3>6.1.1.&nbsp;
Using a PAC</h3>

<p>The Windows operating system uses something
			called a "PAC", which contains a user Security
			IDentifier (SID) and a list of group SIDs.  Some
			Kerberos Key Distribution Centers (KDCs),
			notably Windows KDCs, issue Kerberos Tickets
			with PACs as Kerberos authorization data.  When
			a client principal is authenticated using such a
			ticket, the server SHOULD extract the PAC from
			the client's ticket and map, if need be, the
			SIDs in the PAC to local ID representations.
</p>
<p>The authorization context information in a PAC
			can be considered a single, authenticated,
			discrete GSS-API name attribute, in which case
			the server must parse it into its individual
			elements.
</p>
<p>[Add references.]
</p>
<a name="PRINC_TO_USER"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Mapping Principal Names to Usernames</h3>

<p>If suitable and sufficient authenticated name
		    attributes for the client principal are not
		    available, then the server may try to map the client
		    principal name to a local notion of user account,
		    and then lookup that user account's authorization
		    context information through name service
		    lookups.
</p>
<p>One simple method for Kerberos principal-to-username
		    mapping is to first apply an algorithmic or
		    table-based Kerberos client principal realm name to
		    domain name mapping, then a client principal name to
		    username mapping.  Finally, the server can look up
		    the user's authorization context using the user's
		    domain's name services.
</p>
<p>A trivial Kerberos realm-name-to-domainname mapping
		    consists of case-folding the realm name to
		    lower-case.  [Add notes about internationalization.]
		    Servers MUST implement this mapping as an option,
		    possibly as a default option.
</p>
<p>A trivial Kerberos principal name to username
		    mapping for 1-component principal names,
		    is the identity function.  Servers MUST implement
		    this mapping as an option, possibly as a default
		    option.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
Using a Name Service to Map Principal Names to User Accounts</h3>

<p>Name services such as the Solaris gsscred
			database where the local identity is looked
			up in a database keyed by the GSS exported
			name token, or LDAP with the extension
			described in <a class='info' href='#GSSAUTH'>Section&nbsp;7.1<span> (</span><span class='info'>LDAP Attribute for Principal Name to Local ID Translation</span><span>)</span></a>,
			can be used to map principal names to user
			accounts.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
User Group Membership Determination</h3>

<p>User group membership is easy to determine for
			users in a system's local domain: the operating
			system will already know how to do that.
</p>
<p>User group membership in remote domain's groups,
			or for remote users, may be determined using
			LDAP with the RFC2307 schema.  The RFC2307
			schema does not define the values of the
			'memberUid' attribute, but in practice it seems
			that those are expected to be the names of users
			as found in the 'uid' attribute of
			'posixAccount' entries.  There is work in
			progress to <a class='info' href='#I-D.howard-rfc2307bis'>update
			    RFC2307<span> (</span><span class='info'>Howard, L. and H. Chu, &ldquo;An Approach for Using LDAP as a Network Information Service,&rdquo; August&nbsp;2009.</span><span>)</span></a> [I&#8209;D.howard&#8209;rfc2307bis] to allow the use of DNs in
			the memberUid attribute, as well as group
			nesting.  Such use of memberUid should be
			backwards-compatible, since implementations that
			don't know about that use of memberUid will end
			up ignoring values which are not plain
			usernames.
</p>
<p>Assuming the ability to store DNs in the
			memberUid attribute, then, group membership
			determination can be done as follows.  Given a
			user ID whose DN has been resolved:
</p>
<p>
			</p>
<ol class="text">
<li>Search the user's domain for groups
				that the user is a member of in the
				user's home domain.  Filter out groups
				that are not local to the user's home
				domain.
</li>
<li>Search the server's domain for groups
				that the user is a member of in the
				server's home domain.
</li>
<li>Search the server's domain for groups
				that the user's group memberships
				determined in step 1 are members of.
</li>
<li>Continue searching for nested group
				memberships given the list of groups
				from steps 2 and 3.
</li>
</ol><p>
		    
</p>
<p>However, the above procedure has the same
			user/group name renaming issue.  By skipping
			step 2 we can get down to just a group renaming
			issue.  To fully address the rename issue we
			need either a new attribute or value type for
			memberUid, storing user/group IDs in
			some global ID representation.
</p>
<p>[Add text defining such a new attribute/value
			type.]
</p>
<a name="LDAP-EXT"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
LDAP Schema Extensions for Multi-Domain NFSv4</h3>

<a name="GSSAUTH"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7.1"></a><h3>7.1.&nbsp;
LDAP Attribute for Principal Name to Local ID Translation</h3>

<p>The gSSPrincipal objectclass allows for the use of the gSSAuthName 
		    attribute described in the following section.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                     objectclass ( 1.3.6.1.4.1.250.10.7
                     NAME 'gSSPrincipal'
                     DESC 'GSS Principal Name'
                     SUP  posixAccount
                     MAY ( gSSAuthName ) )
</pre></div>
<p>Here we present a new LDAP attribute that provides a
		    method for the translations between a local
		    ID and (multiple) GSS-API security principals, used
		    as described in <a class='info' href='#PRINC_TO_USER'>Section&nbsp;6.2<span> (</span><span class='info'>Mapping Principal Names to Usernames</span><span>)</span></a>.
</p>
<p>
			The gSSAuthName attribute stores a user's
			GSS-API principal name in exported name token
			form (see <a class='info' href='#RFC2743'>[RFC2743]<span> (</span><span class='info'>Linn, J., &ldquo;Generic Security Service Application Program Interface Version 2, Update 1,&rdquo; January&nbsp;2000.</span><span>)</span></a>).
		    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                        attributetype ( 1.3.6.1.4.1.250.10.6
                        NAME ( 'gSSAuthName')
                        DESC 'GSS-API exported principal name
                        exported token'
                        EQUALITY bitStringMatch
                        SYNTAX 1.3.6.1.4.1.1466.115.121.1.6)
</pre></div>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Name Resolution</h3>

<p>As noted in <a class='info' href='#STORE'>Section&nbsp;5.2.1<span> (</span><span class='info'>Storing Remote-ID@Domain-ID</span><span>)</span></a>, most local
		representations require a name service to perform ID to
		name translations.  Implementations are REQUIRED to
		support the use of LDAP as a name service, relying on
		LDAP referrals for federated namespace construction.
</p>
<p>Note that in a topographically widely separated set of
		domains the need to do name service lookups in various
		domains' name services may prove brittle, resulting in
		non-deterministic server behavior (e.g., sometimes a
		user can access share, sometimes they cannot; sometimes
		they appear to be members of some group, sometimes they
		do not).  To avoid this, site administrators may wish to
		maintain local caches of remote domains' name
		services such that LDAP searches for users/groups in
		remote domains can be satisfied locally for some set of
		key attributes (such as naming and ID attributes), with
		referrals used in all other cases.
</p>
<p>Domains in a federated namespace may provide each other
		with LDAP LDIF delta feeds by which to maintain cached
		LDAP contents up to date.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
Using LDAP Caching Proxies</h3>

<p>Many sites use a distributed name service such as
		    <a class='info' href='#RFC4511'>Lightweight Directory Access
			Protocol<span> (</span><span class='info'>Sermersheim, J., &ldquo;Lightweight Directory Access Protocol (LDAP): The Protocol,&rdquo; June&nbsp;2006.</span><span>)</span></a> [RFC4511] for distributing system
		    configuration data and providing name translation.
		    <a class='info' href='#RFC2307'>RFC2307<span> (</span><span class='info'>Howard, L., &ldquo;An Approach for Using LDAP as a Network Information Service,&rdquo; March&nbsp;1998.</span><span>)</span></a> [RFC2307] defines the
		    LDAP posixAccount object class and an associated set
		    of attributes used to resolve account information
		    such as user IDs to login names and group IDs to
		    group names.
</p>
<p>The LDAP posixAccount schema can be used to map
		    between the multiple domain local ID and the NFSv4
		    name@domain form by adding remote domain DN
		    hierarchies to the local LDAP name service.
</p>
<p>An LDAP service set up in this way is a caching proxy
		    because it caches remote domain information. The DN
		    hierarchy structure has the advantage of aiding
		    delta feeds from remote domains because each
		    domain's information is in it's own DN subtree.
</p>
<p>An example follows that shows the DN hierarchy for
		    sample.com's LDAP service.
</p><br /><hr class="insert" />
<a name="ldap-hierarchy"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                        dc=com/
                        dc=sample/
                        ou=People/
                        [all the rfc2307 people entries for
                        sample.com]
                        uid=bob

                        dc=edu/
                        dc=university/
                        ou=People/
                        [all the rfc2307 people entries for the
                        remote domain university.edu]
                        uid=alice
</pre></div>
<p>
			An LDAP hierarchy for two domains, the local
			sample.com domain and the remote university.edu
			domain.
		    
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="multi-domain-ldap"></a>

<p>
			More detail on two entries from sample.com's
			LDAP service:
		    
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                        dn: uid=bob,ou=People,dc=sample,dc=com
                        objectClass: top
                        objectClass: person
                        objectClass: organizationalPerson
                        objectClass: inetorgperson
                        objectClass: gSSPrincipal
                        cn: Bob B. Bar
                        sn: Bar
                        uidNumber: 5989
                        gidNumber: 100
                        gSSAuthName: &lt;bob@SAMPLE.COM&gt;
                        gSSAuthName: &lt;bob@SAMPLE-ENG.COM&gt;

                        dn: uid=alice,ou=People,dc=university,dc=edu
                        objectClass: top
                        objectClass: person
                        objectClass: organizationalPerson
                        objectClass: inetorgperson
                        objectClass: gSSPrincipal
                        cn: Alice A. Answer
                        sn: Answer
                        uidNumber: 5990
                        gidNumber: 100
                        remoteID: 1234
                        gSSAuthName: &lt;alice@UNIVERSITY.EDU&gt;
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p><a class='info' href='#multi-domain-ldap'>Figure&nbsp;2</a> shows two
		    entries in the sample.com LDAP service also shown in
		    <a class='info' href='#ldap-hierarchy'>Figure&nbsp;1</a>.  One entry is
		    for a local user Bob and one entry for a remote user
		    alice. The mappings of the local uidNumber to an
		    NFSv4 name@domain are also shown where the NFSv4
		    name@domain is expressed as a concatenation of the
		    posixAccount uid attribute and the DN domain.
</p>
<p><a class='info' href='#multi-domain-ldap'>Figure&nbsp;2</a> also
		    demonstrates the use of the gSSAuthName and remoteID
		    attributes. User bob@sample.com has a principal in
		    both the SAMPLE.COM and the SAMPLE_ENG.COM Kerberos
		    realms, and both map to his uidNumber. User
		    alice@university.edu has a principal in the
		    UNIVERSITY.EDU Kerberos realm, and a remoteID of
		    1234 which is her uidNumber in the university.edu
		    name service.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
LDAP Schema Extensions for ID Mapping</h3>

<p>[Add text.]
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Multi-Domain Access Summary</h3>

<p>File systems exported by the NFSv4 file server need to be
		able to represent user and group IDs from multiple
		domains.
</p>
<p>The RPCSEC_GSS client presents the GSS principal to the
		NFSv4 server which maps the GSS principal into the
		principal's authorization context via methods described
		in <a class='info' href='#V4ACCESS'>Section&nbsp;6<span> (</span><span class='info'>GSS-API Principal-to-NFSv4 Authorization Context</span><span>)</span></a>. The authorization
		context information is used to determine file access.
		Depending
		on the local representation as described in <a class='info' href='#ONDISK'>Section&nbsp;5<span> (</span><span class='info'>Local Representations of Global Identity</span><span>)</span></a>, ID mapping and/or name
		resolution may be required to translate between IDs and
		names contained in the authorization context.
</p>
<p>An NFSv4 SETATTR or GETATTR with an acl attribute
		presented to the NFSv4 server may also require ID
		mapping and/or name resolution to translate between the
		name@domain and the local file system ID.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Security Considerations</h3>

<p>Yet to be determined
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3530">[RFC3530]</a></td>
<td class="author-text">Shepler, S., Callaghan, B., Robinson, D., Thurlow, R., Beame, C., Eisler, M., and D. Noveck, &ldquo;<a href="http://tools.ietf.org/html/rfc3530">Network File System (NFS) version 4 Protocol</a>,&rdquo; RFC&nbsp;3530, April&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3530.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1831">[RFC1831]</a></td>
<td class="author-text"><a href="mailto:raj@eng.sun.com">Srinivasan, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1831">RPC: Remote Procedure Call Protocol Specification Version 2</a>,&rdquo; RFC&nbsp;1831, August&nbsp;1995 (<a href="http://www.rfc-editor.org/rfc/rfc1831.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2203">[RFC2203]</a></td>
<td class="author-text"><a href="mailto:mre@eng.sun.com">Eisler, M.</a>, <a href="mailto:hacker@eng.sun.com">Chiu, A.</a>, and <a href="mailto:lling@eng.sun.com">L. Ling</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2203">RPCSEC_GSS Protocol Specification</a>,&rdquo; RFC&nbsp;2203, September&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2203.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2203.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2203.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2743">[RFC2743]</a></td>
<td class="author-text"><a href="mailto:jlinn@rsasecurity.com">Linn, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2743">Generic Security Service Application Program Interface Version 2, Update 1</a>,&rdquo; RFC&nbsp;2743, January&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2743.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4120">[RFC4120]</a></td>
<td class="author-text">Neuman, C., Yu, T., Hartman, S., and K. Raeburn, &ldquo;<a href="http://tools.ietf.org/html/rfc4120">The Kerberos Network Authentication Service (V5)</a>,&rdquo; RFC&nbsp;4120, July&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4120.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4511">[RFC4511]</a></td>
<td class="author-text">Sermersheim, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4511">Lightweight Directory Access Protocol (LDAP): The Protocol</a>,&rdquo; RFC&nbsp;4511, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4511.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2307">[RFC2307]</a></td>
<td class="author-text"><a href="mailto:lukeh@xedoc.com">Howard, L.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2307">An Approach for Using LDAP as a Network Information Service</a>,&rdquo; RFC&nbsp;2307, March&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2307.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2307.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2307.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.howard-rfc2307bis">[I-D.howard-rfc2307bis]</a></td>
<td class="author-text">Howard, L. and H. Chu, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-howard-rfc2307bis-02.txt">An Approach for Using LDAP as a Network Information Service</a>,&rdquo; draft-howard-rfc2307bis-02 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-howard-rfc2307bis-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-nfsv4-federated-fs-reqts">[I-D.ietf-nfsv4-federated-fs-reqts]</a></td>
<td class="author-text">Lentini, J., Everhart, C., Ellard, D., Tewari, R., and M. Naik, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-nfsv4-federated-fs-reqts-06.txt">Requirements for Federated File Systems</a>,&rdquo; draft-ietf-nfsv4-federated-fs-reqts-06 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-nfsv4-federated-fs-reqts-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-kitten-gssapi-naming-exts">[I-D.ietf-kitten-gssapi-naming-exts]</a></td>
<td class="author-text">Williams, N. and L. Johansson, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-kitten-gssapi-naming-exts-06.txt">GSS-API Naming Extensions</a>,&rdquo; draft-ietf-kitten-gssapi-naming-exts-06 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-kitten-gssapi-naming-exts-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-nfsv4-minorversion1">[I-D.ietf-nfsv4-minorversion1]</a></td>
<td class="author-text">Shepler, S., Eisler, M., and D. Noveck, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-nfsv4-minorversion1-29.txt">NFS Version 4 Minor Version 1</a>,&rdquo; draft-ietf-nfsv4-minorversion1-29 (work in progress), December&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-nfsv4-minorversion1-29.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.williams-rpcsecgssv3">[I-D.williams-rpcsecgssv3]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-williams-rpcsecgssv3-00.txt">Remote Procedure Call (RPC) Security Version 3</a>,&rdquo; draft-williams-rpcsecgssv3-00 (work in progress), January&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-williams-rpcsecgssv3-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5280">[RFC5280]</a></td>
<td class="author-text">Cooper, D., Santesson, S., Farrell, S., Boeyen, S., Housley, R., and W. Polk, &ldquo;<a href="http://tools.ietf.org/html/rfc5280">Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile</a>,&rdquo; RFC&nbsp;5280, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5280.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NIS">[NIS]</a></td>
<td class="author-text">Sun Microsystems, &ldquo;System and Network Administration,&rdquo; March&nbsp;1990.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">William A. (Andy) Adamson</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NetApp</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:andros@netapp.com">andros@netapp.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kevin Coffman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">CITI, University of Michigan</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kwc@umich.edu">kwc@umich.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nicolas Williams</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sun Microsystems</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Nicolas.Williams@sun.com">Nicolas.Williams@sun.com</a></td></tr>
</table>
</body></html>
