Submitted to DHC Working Group                            Yves T'Joens
INTERNET DRAFT                                        Christian Hublet
<draft-ietf-dhc-pv4-reconfigure-05.txt>                        Alcatel
                                                    Peter De Schrijver
                                                                  Mind
                                                             June 2001
                                                Expires November, 2001

                       DHCP reconfigure extension


Status of this memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups. Note that other
   groups may also distribute working documents as Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six
   months. Internet-Drafts may be updated, replaced, or obsoleted by
   other documents at any time.  It is not appropriate to use Internet-
   Drafts as reference material or to cite them other than as a
   ``working draft'' or ``work in progress.''

     The list of current Internet-Drafts can be accessed at
     http://www.ietf.org/1id-abstracts.html

     The list of Internet-Draft Shadow Directories can be accessed at
     http://www.ietf.org/shadow.html.


   To view the entire list of current Internet-Drafts, please check the
   "1id-abstracts.txt" listing contained in the Internet-Drafts Shadow
   Directorieson ftp.is.co.za (Africa), ftp.nordu.net (Northern Europe),
   ftp.nis.garr.it (Southern Europe), munnari.oz.au(Pacific Rim),
   ftp.ietf.org (US East Coast), or ftp.isi.edu (US West Coast).

   Distribution of this memo is unlimited.

Abstract

   This draft defines extensions to DHCP [DHCP] to allow dynamic
   reconfiguration of a single host triggered by the DHCP server (eg. a
   new IP address and/or local configuration parameters). This is
   achieved by introducing a unicast FORCERENEW message which forces the
   client to the RENEW state. The behaviour for hosts using the DHCP
   INFORM message to obtain configuration information is also described.


1. Introduction

   The procedures as described within this draft allow the dynamic
   reconfiguration of individual hosts.



T'Joens & De Schrijver   Expires November 2001                  [Page 1]

Internet Draft   draft-ietf-dhc-pv4-reconfigure-05.txt         June 2001


1.1 Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY" and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

2. DHCP force renew

   This section describes the FORCERENEW message extension.

2.1 Terminology

   DHCP client : host to be reconfigured using DHCP.

   DHCP server : server which configured the DHCP client.

2.2 Force renew procedures

   The DHCP server sends a unicast FORCERENEW message to the client.
   Upon receipt of the unicast FORCERENEW message, the client will
   change its state to the RENEW state, and will then try to renew its
   lease according to normal DHCP procedures. If the server wants to
   assign a new IP address to the client, it will reply to the DHCP
   REQUEST with a DHCP NAK. The client will then go back to the init
   state and broadcast a DHCP DISCOVER message. The server can now
   assign a new IP address to the client by replying with a DHCP OFFER.
   If the FORCERENEW message is lost, the DHCP server will not receive a
   DHCP REQUEST from the client and it should retransmit the FORCERENEW
   message using an exponential backoff algorithm. Depending on the
   bandwidth of the network between server and client, the server should
   choose a delay. This delay grows exponentially as retransmissions
   fail. The amount of retransmissions should be limited.

   The procedures described above assume the server to send a unicast
   FORCERENEW message to the client. Receipt of a multicast FORCERENEW
   message by the client should be silently discarded.

   It can be that a client has obtained a network address through some
   other means (e.g., manual configuration) and has used a DHCP INFORM
   request to obtain other local configuration parameters. Such clients
   should respond to the receipt of a unicast FORCERENEW message with a
   new DHCP INFORM request so as to obtain a potential new set of local
   configuration parameters. Note that the usage of these procedures are
   limited to the set of options that are eligible for configuration by
   DHCP and should not override manually configured parameters.

   Note further that usage of the FORCERENEW message to reconfigure a
   client address or local configuration parameters can lead to the



T'Joens & De Schrijver   Expires November 2001                  [Page 2]

Internet Draft   draft-ietf-dhc-pv4-reconfigure-05.txt         June 2001


   interruption of active sessions, and that as such these  procedures
   should be used in controlled circumstances.

2.3 Example usage

2.3.1 Embedded DHCP clients

   The autoconfiguration of home gateways (more generically Network
   Termination equipment) for public networking purposes can be achieved
   through means of DHCP, as described in [DSL_autoconf]. In order to
   allow service changes or service interruption, the FORCERENEW message
   can trigger the home gateway to contact the DHCP server, prior to the
   expiry of the lease.

2.3.2 Hospitality service scenario

   In self provisioned networks, e.g., hotel rooms, the hotel owned DHCP
   server can hand out limited use IP addresses, that allows the
   customer to consume local services or select external services from a
   web browser interface. In order to allow external services through
   other service providers, e.g., global internet services or enterprise
   VPN services, the DHCP server can trigger the client to ask for a new
   DHCP initialization session so as to obtain e.g., a globally routed
   IP address.

2.3.3 Network renumbering

   Under tightly controlled conditions, the FORCERENEW procedures can be
   used to brute force the renumbering of entire subnets, client per
   client, under control of a DHCP server.

2.4 Rationale

   The approach as described in this document has a number of
   advantages. It does not require new states to be added to the DHCP
   client implementation. This minimizes the amount of code to be
   changed. It also allows lease RENEWAL to be driven by the server,
   which can be used to optimize network usage or DHCP server load.

3. Extended DHCP state diagram











T'Joens & De Schrijver   Expires November 2001                  [Page 3]

Internet Draft   draft-ietf-dhc-pv4-reconfigure-05.txt         June 2001


+--------+             +------+
| Init / |         +-->+ Init +<---------------+-------------------+
| Reboot |         |   +--+---+                |                   |
+---+----+     DHCPNAK/ -/Send DHCPDISCOVER    |                   |
    |          Restart    |     (broadcast)    |                   |
    |              |      v   v-------------+  |                   |
 -/Send DHCPREQUEST| +----+------+    DHCPOFFER/DHCPDECLINE        |
    |   (broadcast)| | Selecting |----------+  |                   |
    v              | +----+------+             |                   |
+---+----+         |   DHCPOFFER/DHCPREQUEST   |                   |
| Reboot +---------+  (broadcast)              |                   |
+---+----+                v                    |                   |
    |                +----+-------+            DHCPNAK /halt network
    |                + Requesting |            |       lease expired
   DHCPACK/          +----+-------+            |                   |
   Record lease           |                    |                   |
   set timers         DHCPACK/Record lease     |                   |
    |                     v   Set T1 & T2      |                   |
    |                  +--+----+DHCPFORCE  +---+---+          +----+---+
    +----------------->+ Bound +---------->+ Renew +--------->+ Rebind |
                       +--+-+--+T1 expires +-+-+---+T2 expires+----+---+
                          ^     /DHCPREQUEST | |    /broadcast     |
                       DHCPACK    to leasing | |    DHCPREQUEST    |
                          |        server    | |                   |
                          +----------------------------------------+


4. Message layout

   The FORCERENEW message makes use of the normal DHCP message layout
   with the introduction of a new DHCP message type. DHCP option 53
   (DHCP message type) is extended with a new value : DHCPFORCERENEW
   (TBD)

5. IANA Considerations

   The new value for DHCP option 53 (DHCP message type) to indicate a
   DHCPFORCERENEW message is TBD.

6. Security Considerations

   As in some network environments FORCERENEW can be used to snoop and
   spoof traffic, the FORCERENEW message MUST be authenticated using the
   procedures as described in [DHCP-AUTH]. FORCERENEW messages failing
   the authentication should be silently discarded by the client.

7. References




T'Joens & De Schrijver   Expires November 2001                  [Page 4]

Internet Draft   draft-ietf-dhc-pv4-reconfigure-05.txt         June 2001


   [DHCP] R.Droms, "Dynamic Host Configuration Protocol", RFC 2131,
   March 1997.

   [DHCP-AUTH] R. Droms et al., "Authentication for DHCP Messages",
   RFCxxxx, yyyy 2001.

   [DSL_autoconf] Working Text WT-059, "Auto-configuration for Basic
   Internet (IP-Based) Services", DSL Forum, May 2001

   [RFC2119] S. Bradner, "Key words for use in RFCs to Indicate
   Requirement Levels", BCP 14, RFC 2119, March 1997.

8. Acknowledgements

   The authors would like to thank David Allan, Nortel, for the
   constructive comments to these procedures.

9. Contacts

   Yves T'joens
   Alcatel Network Strategy Group
   Francis Wellesplein 1, 2018 Antwerp, Belgium
   Phone : +32 3 240 7890
   E-mail : yves.tjoens@alcatel.be

   Peter De Schrijver
   Mind NV
   Vaartkom 11
   3000 Leuven
   E-mail : p2@mind.be

   Christian Hublet
   Alcatel Carrier Internetworking Division
   De Villermontstraat 28, 2550 Kontich, Belgium
   Phone : +32 3 450 3322
   E-mail : Christian.Hublet@alcatel.be

8. Full Copyright Statement

   This document and translations of it may be copied and furnished to
   others, and derivative works that comment on or otherwise explain it
   or assist in its implmentation may be prepared, copied, published and
   distributed, in whole or in part, without restriction of any kind,
   provided that the above copyright notice and this paragraph are
   included on all such copies and derivative works.  However, this
   document itself may not be modified in any way, such as by removing
   the copyright notice or references to the Internet Society or other
   Internet organizations, except as needed for the purpose of



T'Joens & De Schrijver   Expires November 2001                  [Page 5]

Internet Draft   draft-ietf-dhc-pv4-reconfigure-05.txt         June 2001


   developing Internet standards in which case the procedures for
   copyrights defined in the Internet Standards process must be
   followed, or as required to translate it into languages other than
   English.

   The limited permissions granted above are perpetual and will not be
   revoked by the Internet Society or its successors or assigns.

   This document and the information contained herein is provided on an
   TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING
   BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE INFORMATION
   HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF
   MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.''






































T'Joens & De Schrijver   Expires November 2001                  [Page 6]

