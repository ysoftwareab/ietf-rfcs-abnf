j = (j + S [i] + S2 [i]) % 256;
temp = S [i];
i = (i+1) % 256;
j = (j + S[i]) % 256;
temp = S [i];
t = (S [i] + S [j]) % 256;
K = S [t];

state = ctx->state;
keyindex = 0;
stateindex = 0;
t = state[counter];
stateindex = (stateindex + key[keyindex] + t) & 0xff;
u = state[stateindex];
keyindex = 0;
state = ctx->state;
x = (ctx->x + 1) & 0xff;
sx = state[x];
y = (sx + ctx->y) & 0xff;
sy = state[y];
