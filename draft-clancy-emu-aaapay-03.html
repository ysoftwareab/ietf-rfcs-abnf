<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>EAP Method Support for Transporting AAA Payloads</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="EAP Method Support for Transporting AAA Payloads">
<meta name="keywords" content="EAP, RADIUS, Diameter, Channel Bindings">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">T. Clancy</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">LTS</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">A. Lior, Ed.</td></tr>
<tr><td class="header">Expires: May 16, 2010</td><td class="header">BWS</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">G. Zorn</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Network Zen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">K. Hoeper</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Motorola, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 12, 2009</td></tr>
</table></td></tr></table>
<h1><br />EAP Method Support for Transporting AAA Payloads<br />draft-clancy-emu-aaapay-03.txt</h1>

<h3>Abstract</h3>

<p>This document defines bindings for existing EAP methods to
	transport Diameter AVPs, called "AAA payloads".  The primary
	application is to support EAP channel bindings, but this could
	be used for other applications as well.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 16, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<br />
<a href="#overview">3.</a>&nbsp;
Overview and Requirements<br />
<br />
<a href="#tokenformat">4.</a>&nbsp;
AAA Payload Format<br />
<br />
<a href="#genmethodbindings">5.</a>&nbsp;
Bindings Requirements for EAP Methods<br />
<br />
<a href="#existingmethodbindings">6.</a>&nbsp;
Bindings for Existing EAP Methods<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#GPSKbinding">6.1.</a>&nbsp;
Generalized Pre-Shared Key (GPSK)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#PSKbinding">6.2.</a>&nbsp;
Pre-Shared Key (PSK)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#PAXbinding">6.3.</a>&nbsp;
Password Authenticated Exchange (PAX)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#TTLSbinding">6.4.</a>&nbsp;
Tunneled Transport Layer Security (TTLS)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#FASTbinding">6.5.</a>&nbsp;
Flexible Authentication via Secure Tunneling (FAST)<br />
<br />
<a href="#seccons">7.</a>&nbsp;
Security Considerations<br />
<br />
<a href="#ianacons">8.</a>&nbsp;
IANA Considerations<br />
<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document defines a payload which can be securely
	transported by an Extensible Authentication Method (EAP)
	method <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> that carries arbitrary
	Diameter Attribute-Value Pairs (AVPs) <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>.  While it may seem strange for EAP to encapsulate
	Authorization, Authentication, and Accounting (AAA) messages,
	since AAA typically encapsulates EAP, the security properties
	are different.  In particular, AAA data transported by EAP
	between the client and server will be protected by an
	end-to-end security relationship.  This provides a secure
	channel for doing things like channel bindings
	<a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>In this document, several words are used to signify the
        requirements of the specification.  These words are often
        capitalized. The key words "MUST", "MUST NOT", "REQUIRED",
        "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED",
        "MAY", and "OPTIONAL" in this document are to be interpreted
        as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Overview and Requirements</h3>

<p>Many EAP <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> methods have extensible
	properties that allow you to embed arbitrary data within a
	secure channel.  This channel is secured using keys derived
	during the EAP authentication.  These channels vary in the
	properties that they provide, typically either providing
	integrity protection or both confidentiality and integrity
	protection.
</p>
<p>In this document we define a payload format for encapsulating
	Diameter AVPs <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>, and via backwards
	compatability <a class='info' href='#RFC4005'>[RFC4005]<span> (</span><span class='info'>Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;Diameter Network Access Server Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, RADIUS TLVs
	<a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a>.  We provide bindings for a variety of
	existing EAP methods that would allow them to transport this
	data.  One specific application of this is to support EAP
	channel bindings <a class='info' href='#RFC5056'>[RFC5056]<span> (</span><span class='info'>Williams, N., &ldquo;On the Use of Channel Bindings to Secure Channels,&rdquo; November&nbsp;2007.</span><span>)</span></a><a class='info' href='#I-D.ietf-emu-chbind'>[I&#8209;D.ietf&#8209;emu&#8209;chbind]<span> (</span><span class='info'>Clancy, T. and K. Hoeper, &ldquo;Channel Binding Support for EAP Methods,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<p>The main goal is to provide the peer and server to exchange
	AAA messages protected by an end-to-end security association.
	As such, any EAP method transporting the AAA payloads defined
	in this document MUST support integrity protection.  To
	accomplish this, a method supporting AAA payloads MUST perform
	mutual authentication and derive session keys (i.e. MSK, etc),
	and during this derivation process MUST derive a unique,
	cryptographically independent, fresh key for protecting AAA
	payloads.  Protocols SHOULD also support confidentiality in
	addition to integrity protection.  Confidentiality is
	important for identity protection, as a variety of identities
	can be passed over this channel.
</p>
<a name="tokenformat"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
AAA Payload Format</h3>

<p>This section describes the formatting for the AAA Payloads.
      Each payload consists of the following fields:
</p>
<p></p>
<ul class="text">
<li>Version, 1 octet
</li>
<li>Flags, 1 octet
</li>
<li>length(Session-ID), 2 octets
</li>
<li>Session-ID <a class='info' href='#RFC5247'>[RFC5247]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; August&nbsp;2008.</span><span>)</span></a>, arbitrary length
</li>
<li>One or more Diameter AVPs <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>, arbitrary length
</li>
</ul>

<p>The version field is 1 octet.  This documents defines version
      0x01.
</p>
<p>The flags field is 1 octet, and is the logical AND of the
      following applicable values:
</p>
<p></p>
<ul class="text">
<li>0x01: Validation Failed
</li>
<li>0x02: Validation Inconclusive
</li>
<li>0x04: Validation Successful
</li>
</ul>

<p>The validation flag fields are used by the EAP server to convey
      the success of the consistency check to the EAP peer.  These
      flags SHOULD NOT be used in messages from the peer to
      server.
</p>
<p>The Session-ID field is arbitrary length and is proceeded by
      its 2-octet length specified in network-byte order.
</p>
<p>Following the Session-ID is an arbitrary number of Diameter
      AVPs.  AVPs already contain a length field internally, so they
      can be parsed without additional information.
</p>
<p>The payload can be graphically depicted as:
</p><br /><hr class="insert" />
<a name="chbindblob"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
--- bit offset ---&gt;
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Version=0x01 |     Flags     |       length(Session-ID)      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
...                         Session-ID                        ...
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
...                       Diameter AVP 1                      ...
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...                                                           ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
...                       Diameter AVP N                      ...
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="genmethodbindings"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Bindings Requirements for EAP Methods</h3>

<p>This section describes a set of general requirements for EAP methods
    implementing the protected exchange of arbitrary data using the techniques
    described in this draft.
</p>
<p>An EAP method requiring the protected exchange of payloads during its
    execution in order to enable certain features MUST:
</p>
<p></p>
<ul class="text">
<li>support at least one secure cryptographic algorithm that can be
            used for integrity protection, such as an HMAC; 
</li>
<li>derive a session key that can be used in the integrity protection
            algorithm, as soon as fresh EAP session keys are available; and
</li>
<li>define a container enabling the exchange of arbitrary
            payloads; and
</li>
<li>provide an integrity-protected channel for at least 3 protocols
            flows (i.e. 1.5 roundtrips) in which containers with payloads can be
            securely exchanged
</li>
</ul>

<p>Optionally an EAP method MAY also support an encryption algorithm that is
    used with a freshly derived encryption key to provide confidentiality of all
    data that is exchanged in the protected channel.
</p>
<p>Only existing EAP methods already satisfying these requirements can
    support features that require the protected exchange of AAA payloads.
</p>
<p>New EAP methods SHOULD be designed to meet all requirements.
</p>
<p>For features demanding the protected exchange of potentially large chunks
    of information, the support of fragmentation is RECOMMENDED.
</p>
<a name="existingmethodbindings"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Bindings for Existing EAP Methods</h3>

<p>This section describes how binding tokens can be included in some existing
    EAP methods that already meet the requirements for secure transport of arbitrary data as specified in <a class='info' href='#genmethodbindings'>Section&nbsp;5<span> (</span><span class='info'>Bindings Requirements for EAP Methods</span><span>)</span></a>.
</p>
<a name="GPSKbinding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Generalized Pre-Shared Key (GPSK)</h3>

<p>EAP-GPSK <a class='info' href='#RFC5433'>[RFC5433]<span> (</span><span class='info'>Clancy, T. and H. Tschofenig, &ldquo;Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method,&rdquo; February&nbsp;2009.</span><span>)</span></a> defines protected data payloads. The
    protected channel is available in three of its protocol flows, namely
    EAP-GPSK-2, EAP-GPSK-3, and EAP-GPSK-4, and provides integrity-protection.
    If a ciphersuite with encryption is selected (e.g. Ciphersuite 1 in
    <a class='info' href='#RFC5433'>[RFC5433]<span> (</span><span class='info'>Clancy, T. and H. Tschofenig, &ldquo;Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method,&rdquo; February&nbsp;2009.</span><span>)</span></a>) the channel also provides confidentiality.
</p>
<p>Use by GPSK simply requires instantiation of a new protected data
    specifier (PData/Specifier):
</p>
<p></p>
<ul class="text">
<li>0x0000002 (IANA-TBD): AAA Payload
</li>
</ul>

<a name="PSKbinding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Pre-Shared Key (PSK)</h3>

<p>EAP-PSK <a class='info' href='#RFC4764'>[RFC4764]<span> (</span><span class='info'>Bersani, F. and H. Tschofenig, &ldquo;The EAP-PSK Protocol: A Pre-Shared Key Extensible Authentication Protocol (EAP) Method,&rdquo; January&nbsp;2007.</span><span>)</span></a> defines a protected channel. In its
    standard mode, EAP-PSK provides a protected channel for payloads in two of
    its flows, namely EAP-PSK-2 and EAP-PSK-3. Features requiring additional
    flows can be supported in EAP-PSK extended authentication mode. The
    protected channel is integrity-protected and encrypted.
</p>
<p>Use by PSK simply requires instantiation of a new EXT_Type value:
</p>
<p></p>
<ul class="text">
<li>0x01 (IANA-TBD): AAA Payload
</li>
</ul>

<a name="PAXbinding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
Password Authenticated Exchange (PAX)</h3>

<p>EAP-PAX <a class='info' href='#RFC4746'>[RFC4746]<span> (</span><span class='info'>Clancy, T. and W. Arbaugh, &ldquo;Extensible Authentication Protocol (EAP) Password Authenticated Exchange,&rdquo; November&nbsp;2006.</span><span>)</span></a> provides an authenticated data
	    exchange (ADE) in three of its protocol flows (EAP-PAX-2, EAP-PAX-3, and
	    EAP-PAX-4). The channel provides integrity-protection but no encryption.
	    Channel binding is explicitly supported in EAP-PAX, in which case the
	    ADE flag needs to be set, and the ADE TYPE needs to be set to 0x02 for client
	    channel binding data and to 0x03 for server channel binding data.
</p>
<p>Additional features could be supported by instantiation of a new ADE
        type:
</p>
<p></p>
<ul class="text">
<li>0x04 (IANA-TBD): AAA Payload
</li>
</ul>

<a name="TTLSbinding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
Tunneled Transport Layer Security (TTLS)</h3>

<p>EAP-TTLS <a class='info' href='#RFC5281'>[RFC5281]<span> (</span><span class='info'>Funk, P. and S. Blake-Wilson, &ldquo;Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0),&rdquo; August&nbsp;2008.</span><span>)</span></a> uses Diameter
        Attribute-Value-Pairs (AVPs) for its messaging. As such it natively
        supports transporting AAA payloads. Once the TLS tunnel is established, a
        variable number of flows can be exchanged in the second phase, e.g. to
        exchange payloads in an integrity-protected and encrypted channel. No
        protocol changes are necessary.
</p>
<a name="FASTbinding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.5"></a><h3>6.5.&nbsp;
Flexible Authentication via Secure Tunneling (FAST)</h3>

<p>EAP-FAST <a class='info' href='#RFC4851'>[RFC4851]<span> (</span><span class='info'>Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST),&rdquo; May&nbsp;2007.</span><span>)</span></a> uses Type-Length-Values (TLVs) for
        its messaging. Once the TLS tunnel is established a variable number of
        flows can be exchanged in the second phase, e.g. to exchange payloads in
        an integrity-protected and encrypted channel. To embed binding tokens, a
        new TLV must be defined:
</p>
<p></p>
<ul class="text">
<li>0x15 (IANA-TBD): AAA Payload
</li>
</ul>

<a name="seccons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>Section 3 documented a variety of requirements for EAP
	methods to transport these AAA payloads.  They MUST support
	identity protection of arbitrary payloads, and SHOULD support
	confidentiality.  Each method's security considerations
	section would detail how they achieve those requirements.
</p>
<p>The payload includes the EAP Session-ID field.  This is to
	prevent replay attacks.  In particular, depending on how an
	EAP method implements their secured channel, it may or may not
	be cryptographically bound to the rest of the session.  By
	explicitly including the EAP Session-ID, we prevent replay
	attacks.  Implementations MUST verify the consistency of the
	Session-ID received in the AAA payloads.
</p>
<p>Certainly there are a whole host of issues surrounding the
	security of what may be contained within the AAA payload
	format.  If the information being transported requires
	confidentiality, then the method SHOULD support that.
	Otherwise sensitive data could be disclosed.
</p>
<a name="ianacons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>We require registry from a variety of IANA repositories.
</p>
<p>From "EAP-GPSK PData/Specifier":
</p>
<p></p>
<ul class="text">
<li>0x0000002 (IANA-TBD): AAA Payload
</li>
</ul>

<p>From "EAP EXT_Type Numbers":
</p>
<p></p>
<ul class="text">
<li>0x01 (IANA-TBD): AAA Payload
</li>
</ul>

<p>From "EAP-PAX ADE Type Namespace":
</p>
<p></p>
<ul class="text">
<li>0x04 (IANA-TBD): AAA Payload
</li>
</ul>

<p>From "EAP-FAST TLV Types":
</p>
<p></p>
<ul class="text">
<li>0x15 (IANA-TBD): AAA Payload
</li>
</ul>

<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3588">[RFC3588]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4764">[RFC4764]</a></td>
<td class="author-text">Bersani, F. and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc4764">The EAP-PSK Protocol: A Pre-Shared Key Extensible Authentication Protocol (EAP) Method</a>,&rdquo; RFC&nbsp;4764, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4764.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4005">[RFC4005]</a></td>
<td class="author-text">Calhoun, P., Zorn, G., Spence, D., and D. Mitton, &ldquo;<a href="http://tools.ietf.org/html/rfc4005">Diameter Network Access Server Application</a>,&rdquo; RFC&nbsp;4005, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4005.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4746">[RFC4746]</a></td>
<td class="author-text">Clancy, T. and W. Arbaugh, &ldquo;<a href="http://tools.ietf.org/html/rfc4746">Extensible Authentication Protocol (EAP) Password Authenticated Exchange</a>,&rdquo; RFC&nbsp;4746, November&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4746.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4851">[RFC4851]</a></td>
<td class="author-text">Cam-Winget, N., McGrew, D., Salowey, J., and H. Zhou, &ldquo;<a href="http://tools.ietf.org/html/rfc4851">The Flexible Authentication via Secure Tunneling Extensible Authentication Protocol Method (EAP-FAST)</a>,&rdquo; RFC&nbsp;4851, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4851.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5056">[RFC5056]</a></td>
<td class="author-text">Williams, N., &ldquo;<a href="http://tools.ietf.org/html/rfc5056">On the Use of Channel Bindings to Secure Channels</a>,&rdquo; RFC&nbsp;5056, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5056.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5281">[RFC5281]</a></td>
<td class="author-text">Funk, P. and S. Blake-Wilson, &ldquo;<a href="http://tools.ietf.org/html/rfc5281">Extensible Authentication Protocol Tunneled Transport Layer Security Authenticated Protocol Version 0 (EAP-TTLSv0)</a>,&rdquo; RFC&nbsp;5281, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5281.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5433">[RFC5433]</a></td>
<td class="author-text">Clancy, T. and H. Tschofenig, &ldquo;<a href="http://tools.ietf.org/html/rfc5433">Extensible Authentication Protocol - Generalized Pre-Shared Key (EAP-GPSK) Method</a>,&rdquo; RFC&nbsp;5433, February&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5433.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5247">[RFC5247]</a></td>
<td class="author-text">Aboba, B., Simon, D., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc5247">Extensible Authentication Protocol (EAP) Key Management Framework</a>,&rdquo; RFC&nbsp;5247, August&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5247.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-emu-chbind">[I-D.ietf-emu-chbind]</a></td>
<td class="author-text">Clancy, T. and K. Hoeper, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-emu-chbind-04.txt">Channel Binding Support for EAP Methods</a>,&rdquo; draft-ietf-emu-chbind-04 (work in progress), October&nbsp;2009.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">T. Charles Clancy</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Laboratory for Telecommunications Sciences</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US Department of Defense</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">College Park, MD</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:clancy@LTSnet.net">clancy@LTSnet.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Avi Lior (editor)</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bridgewater Systems Corporation</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">303 Terry Fox Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Suite 500</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ottawa, Ontario  K2K 3J1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 (613) 591-6655</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:avi@bridgewatersystems.com">avi@bridgewatersystems.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.bridgewatersystems.com/">http://www.bridgewatersystems.com/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Glen Zorn</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Network Zen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1310 East Thomas Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Seattle, Washington  98102</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 (206) 377-9035</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gwz@net-zen.net">gwz@net-zen.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Katrin Hoeper</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Motorola, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1301 E. Algonquin Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Schaumburg, Illinois  60196</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:khoeper@motorola.com">khoeper@motorola.com</a></td></tr>
</table>
</body></html>
