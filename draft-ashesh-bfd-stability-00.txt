



Routing Working Group                                          A. Mishra
Internet-Draft                                         Ciena Corporation
Intended status: Standards Track                           S. Pallagatti
Expires: January 1, 2015                                Juniper Networks
                                                         M. Jethanandani
                                                       Ciena Corporation
                                                                 M. Chen
                                                                  Huawei
                                                               A. Saxena
                                                       Ciena Corporation
                                                           June 30, 2014


                             BFD Stability
                   draft-ashesh-bfd-stability-00.txt

Abstract

   This document describes extensions to the Bidirectional Forwarding
   Detection (BFD) protocol to measure BFD stability.  Specifically, it
   describes a mechanism for detection of BFD frame loss, of delays in
   frame transmitter and receiver engines, and of inter-frame delays
   that might explain issues with a BFD session.

Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <xref
   target="RFC2119">RFC 2119</xref>.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on January 1, 2015.




Mishra, et al.           Expires January 1, 2015                [Page 1]

Internet-Draft                BFD Stability                    June 2014


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  BFD Null-Authentication TLV . . . . . . . . . . . . . . . . .   3
   3.  Theory of Operations  . . . . . . . . . . . . . . . . . . . .   4
     3.1.  Frame Loss  . . . . . . . . . . . . . . . . . . . . . . .   4
     3.2.  Inter-Frame Gap . . . . . . . . . . . . . . . . . . . . .   5
     3.3.  Frame Transmission Delay  . . . . . . . . . . . . . . . .   5
   4.  IANA Requirements . . . . . . . . . . . . . . . . . . . . . .   5
   5.  Security Consideration  . . . . . . . . . . . . . . . . . . .   6
   6.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .   6
   7.  Normative References  . . . . . . . . . . . . . . . . . . . .   6
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   6

1.  Introduction

   The Bidirectional Forwarding Detection (BFD) protocol operates by
   transmitting and receiving control frames, generally at high
   frequency, over the datapath being monitored.  In order to prevent
   significant data loss due to a datapath failure, the tolerance for
   lost or delayed frames (the Detection Time as described in RFC 5880)
   is set to the smallest feasible value.  In certain cases, this
   Detection Time is comparable to the inter-frame delays caused by
   random network events such as frame drops or frame processing
   (transmitter or receiver) delays.

   This document proposes a mechanism to measure such transient effects
   to detect instability in in the receive direction of the data path
   from the session peer in addition to the datapath fault detection
   mechanisms of BFD.  Such a mechanism presents significant value with
   the ability to measure the stability of BFD sessions and provides
   data to the operators.




Mishra, et al.           Expires January 1, 2015                [Page 2]

Internet-Draft                BFD Stability                    June 2014


   In addition to stability measurement, the information exchanged
   between BFD peers can be used for rudimentary, but low-overhead,
   authentication.

2.  BFD Null-Authentication TLV

   The functionality proposed for BFD stability measurement is achieved
   by appending the Null-Authentication TLV to the BFD control frame.

   The Null-Authentication TLV (called 0-Auth in this document) extends
   the existing BFD Authentication TLV structure by adding a new Auth-
   Type of <IANA Assigned>.  This TLV carries the Sequence Number for
   frame loss measurement, and Sender Timestamps for delay measurements.

       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |   Auth Type   |   Auth Len    |  Auth Key ID  |   Reserved    |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                        Sequence Number                        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                       Sender Timestamp 1 (IFG only)           |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      |                       Sender Timestamp 2 (IFG+TD only)        |
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   where:

   Auth Type: The Authentication Type, which in this case is <IANA
   assigned> (Null Authentication).

   Auth Len: The length of the Authentication Section, in bytes.  For
   Loss Measurement only, the length is set to 4.  For Loss and Inter-
   Frame Gap measurements, the length is set to 8.  For Loss, Inter-
   Frame Gap and Transmission Delay on sender node, the length is set to
   12.

   Auth Key ID: The Authentication Key ID in use for this packet.  This
   MUST be set to zero on transmit, and ignored on receipt.

   Reserved: This byte MUST be set to zero on transmit, and ignored on
   receipt.

   Sequence Number: This indicates the sequence number for this packet
   and MUST be present in every 0-Auth TLV.  This value is incremented
   by 1 for every frame transmitted while the session state is UP.  A
   value of 0 indicates a request by sender to reset the sequence number




Mishra, et al.           Expires January 1, 2015                [Page 3]

Internet-Draft                BFD Stability                    June 2014


   correlation logic at the receiver.  The first frame transmitted by
   the sender MAY set this field to 0.

   Inter-Frame Gap (IFG) Mode:

      Sender Timestamp 1 (IFG-ST): This is the Inter-Frame Gap Sender
      Timestamp (IFG-ST) and is added at the last possible instance on
      the sender (preferably on the PHY).  The difference between two
      such timestamps on consecutive frames is the Inter-Frame gap.

   Inter-Frame Gap and Transmission Delay (IFG & TD) Mode:

      Sender Timestamp 1 (TD-ST): This is the Transmission Delay Sender
      Timestamp (TD-ST) and is added at the first possible instance on
      the sender in the frame transmission engine.  The difference
      between TD-ST and the IFG-ST that follows the TD-ST is the Sender
      Transmission Delay.

      Sender Timestamp 2 (IFG-ST): This is the Inter-Frame Gap Sender
      Timestamp (IFG-ST) and is added at the last possible instance on
      the sender (preferably on the PHY).  The difference between two
      such timestamps on consecutive frames is the Inter-Frame gap.

3.  Theory of Operations

   This mechanism allows operator to read three measures of stability of
   BFD: Frame Loss, Inter-Frame Gap and Transmission Delay.  The
   Receiver Delay (interval between receipt of a frame on the PHY and
   the completion of processing in the receiver engine) can be measured
   using timestamps similar to the Sender Timestamps on the receiver
   node.

   +---------+                                       +---------+
   | Sender  |===================...=================| Receiver|
   +---------+                                       +---------+
       |     |                                       |    |
     TD-ST   |                                       |  RD-RT
           IFG-ST                                 IFG-RT

3.1.  Frame Loss

   This measurement counts the number of BFD control frames missed at
   the receiver due to a transient change in the network such as
   congestion.  Frame-loss is detected by comparing the Sequence Number
   field in the 0-Auth TLV in successive BFD CC frames.  The Sequence
   Number in each successive control frame generated on a BFD session by
   the transmitter is incremented by one.




Mishra, et al.           Expires January 1, 2015                [Page 4]

Internet-Draft                BFD Stability                    June 2014


   The first BFD Loss-Delay TLV processed by the receiver that has a
   non-zero sequence number is used for bootstrapping the logic.  Each
   successive frame after this is expected to have a Sequence Number
   that is one greater than the Sequence Number in the previous frame.

3.2.  Inter-Frame Gap

   This measurement is the difference between the IFG-ST on any two
   consecutive BFD CC frames that carry the 0-Auth TLV (IFG or IFG&TD
   mode only) for a session.  This is a key metric to determine
   transient changes in stability of BFD transmission engine or to
   determine the systems capability of handling the existing load.  A
   significant deviation of IFG from the negotiated transmission
   interval on the local node indicates potential instabilities in the
   BFD transmission engine.  Based on the IFG measurements, the operator
   MAY take action to configure the system to maintain normal operation
   of the node.

   Similar IFG measurements on the receiver can be made using timestamps
   (IFG-RT).  In conjunction with IFG-ST measurements, these can
   indicate delays caused by data-path.  While a constant delay may not
   be indicator of instability, large transient delays can decrease the
   BFD session stability significantly.

3.3.  Frame Transmission Delay

   This measurement (TD) is the interval between the timestamp (TD-ST)
   when the frame transmission timer expires, triggering the BFD control
   frame generation, and the timestamp (IFG-TD) when the frame reaches
   the last level in the frame processing logic on the transmitter where
   the frame can be manipulated.  Large variations in the TD
   measurements over time are indicative of non-deterministic
   transmission behavior of the BFD engine and can be a pre-cursor to
   BFD engine instability.

   Similar measurements for Receiver Delay (RD) can be made using IFG-RT
   and RD-RT timestamps, and indicate similar instabilities on the BFD
   receiver engine.

4.  IANA Requirements

   IANA is requested to assign new Auth-Type for the Null-Authentication
   TLV for BFD Stability Measurement.  The following number is
   suggested.

   Value Meaning

   6 Null-Authentication TLV



Mishra, et al.           Expires January 1, 2015                [Page 5]

Internet-Draft                BFD Stability                    June 2014


5.  Security Consideration

   Since this method uses an authentication TLV to achive the
   functionality, usage of this TLV will prevent the use of other
   authentication TLVs.

6.  Acknowledgements

   Nobo Akiya, Jeffery Haas, Peng Fan, Dileep Singh, Basil Saji, Sagar
   Soni and Mallik Mudigonda also conributed to this document.

7.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC5880]  Katz, D. and D. Ward, "Bidirectional Forwarding Detection
              (BFD)", RFC 5880, June 2010.

Authors' Addresses

   Ashesh Mishra
   Ciena Corporation
   3939 North 1st Street
   San Jose, CA  95134
   USA

   Email: mishra.ashesh@gmail.com


   Santosh Pallagatti
   Juniper Networks
   Juniper Networks, Exora Business Park
   Bangalore, Karnataka  560103
   India

   Phone: +
   Email: santoshpk@juniper.net


   Mahesh Jethanandani
   Ciena Corporation
   3939 North 1st Street
   San Jose, CA  95134
   USA

   Email: mjethanandani@gmail.com
   URI:   www.ciena.com



Mishra, et al.           Expires January 1, 2015                [Page 6]

Internet-Draft                BFD Stability                    June 2014


   Mach Chen
   Huawei

   Email: mach.chen@huawei.com


   Ankur Saxena
   Ciena Corporation
   3939 North 1st Street
   San Jose, CA  95134
   USA

   Email: ankurpsaxena@gmail.com






































Mishra, et al.           Expires January 1, 2015                [Page 7]
