<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Application Layer Multicast Extensions to RELOAD</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.2" rel="Chapter" title="2 Definitions">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Overlay Network">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Overlay Multicast">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Peer">
<link href="#rfc.section.3" rel="Chapter" title="3 Assumptions">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Overlay">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Overlay Multicast">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 RELOAD">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 NAT">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Tree Topology">
<link href="#rfc.section.4" rel="Chapter" title="4 Architecture Extensions to RELOAD">
<link href="#rfc.section.5" rel="Chapter" title="5 RELOAD ALM Usage">
<link href="#rfc.section.6" rel="Chapter" title="6 ALM Tree Control Signaling">
<link href="#rfc.section.7" rel="Chapter" title="7 ALM Messages Added to RELOAD Protocol">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 Introduction">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Tree Lifecycle Messages">
<link href="#rfc.section.7.2.1" rel="Chapter" title="7.2.1 Create Tree">
<link href="#rfc.section.7.2.2" rel="Chapter" title="7.2.2 Join">
<link href="#rfc.section.7.2.3" rel="Chapter" title="7.2.3 Join Accept">
<link href="#rfc.section.7.2.4" rel="Chapter" title="7.2.4 Join Confirm">
<link href="#rfc.section.7.2.5" rel="Chapter" title="7.2.5 Join Decline">
<link href="#rfc.section.7.2.6" rel="Chapter" title="7.2.6 Leave">
<link href="#rfc.section.7.2.7" rel="Chapter" title="7.2.7 Re-Form or Optimize Tree">
<link href="#rfc.section.7.2.8" rel="Chapter" title="7.2.8 Heartbeat">
<link href="#rfc.section.8" rel="Chapter" title="8 Scribe Algorithm">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Overview">
<link href="#rfc.section.8.2" rel="Chapter" title="8.2 Create">
<link href="#rfc.section.8.3" rel="Chapter" title="8.3 Join">
<link href="#rfc.section.8.4" rel="Chapter" title="8.4 Leave">
<link href="#rfc.section.8.5" rel="Chapter" title="8.5 JoinConfirm">
<link href="#rfc.section.8.6" rel="Chapter" title="8.6 JoinDecline">
<link href="#rfc.section.8.7" rel="Chapter" title="8.7 Multicast">
<link href="#rfc.section.9" rel="Chapter" title="9 Examples">
<link href="#rfc.section.9.1" rel="Chapter" title="9.1 Create Tree">
<link href="#rfc.section.9.2" rel="Chapter" title="9.2 Join Tree">
<link href="#rfc.section.9.3" rel="Chapter" title="9.3 Leave Tree">
<link href="#rfc.section.9.4" rel="Chapter" title="9.4 Add Direct Application Edge">
<link href="#rfc.section.9.5" rel="Chapter" title="9.5 Adjust Tree to Churn">
<link href="#rfc.section.9.6" rel="Chapter" title="9.6 Push Data">
<link href="#rfc.section.10" rel="Chapter" title="10 Kind Definitions">
<link href="#rfc.section.10.1" rel="Chapter" title="10.1 ALMTree Kind Definition">
<link href="#rfc.section.11" rel="Chapter" title="11 Configuration File Extensions">
<link href="#rfc.section.12" rel="Chapter" title="12 Change History">
<link href="#rfc.section.13" rel="Chapter" title="13 Open Issues">
<link href="#rfc.section.14" rel="Chapter" title="14 IANA Considerations">
<link href="#rfc.section.15" rel="Chapter" title="15 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="16 References">
<link href="#rfc.references.1" rel="Chapter" title="16.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="16.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Additional Stuff">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="We define a RELOAD Usage for Application Layer Multicast as well as extensions to RELOAD message layer to support ALM.  The ALM Usage is intended to support a variety of ALM control algorithms in an overlay-independent way.  Scribe is defined as an example algorithm.  " />
  <meta name="description" content="We define a RELOAD Usage for Application Layer Multicast as well as extensions to RELOAD message layer to support ALM.  The ALM Usage is intended to support a variety of ALM control algorithms in an overlay-independent way.  Scribe is defined as an example algorithm.  " />
  <meta name="keywords" content="application layer multicast" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">SAM Research Group</td>
<td class="right">J.F. Buford</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Avaya Labs Research</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">M. Kolberg, Ed.</td>
</tr>
<tr>
<td class="left">Expires: January 29, 2012</td>
<td class="right">University of Stirling</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 28, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Application Layer Multicast Extensions to RELOAD<br />
  <span class="filename">draft-samrg-sam-baseline-protocol-00</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>We define a RELOAD Usage for Application Layer Multicast as well as extensions to RELOAD message layer to support ALM.  The ALM Usage is intended to support a variety of ALM control algorithms in an overlay-independent way.  Scribe is defined as an example algorithm.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 29, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>2.   <a href="#rfc.section.2">Definitions</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Overlay Network</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Overlay Multicast</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Peer</a>
</li>
<li>3.   <a href="#rfc.section.3">Assumptions</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Overlay</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Overlay Multicast</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">RELOAD</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">NAT</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Tree Topology</a>
</li>
<li>4.   <a href="#rfc.section.4">Architecture Extensions to RELOAD</a>
</li>
<li>5.   <a href="#rfc.section.5">RELOAD ALM Usage</a>
</li>
<li>6.   <a href="#rfc.section.6">ALM Tree Control Signaling</a>
</li>
<li>7.   <a href="#rfc.section.7">ALM Messages Added to RELOAD Protocol</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">Introduction</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Tree Lifecycle Messages</a>
</li>
<li>7.2.1.   <a href="#rfc.section.7.2.1">Create Tree</a>
</li>
<li>7.2.2.   <a href="#rfc.section.7.2.2">Join</a>
</li>
<li>7.2.3.   <a href="#rfc.section.7.2.3">Join Accept</a>
</li>
<li>7.2.4.   <a href="#rfc.section.7.2.4">Join Confirm</a>
</li>
<li>7.2.5.   <a href="#rfc.section.7.2.5">Join Decline</a>
</li>
<li>7.2.6.   <a href="#rfc.section.7.2.6">Leave</a>
</li>
<li>7.2.7.   <a href="#rfc.section.7.2.7">Re-Form or Optimize Tree</a>
</li>
<li>7.2.8.   <a href="#rfc.section.7.2.8">Heartbeat</a>
</li>
<li>8.   <a href="#rfc.section.8">Scribe Algorithm</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">Overview</a>
</li>
<li>8.2.   <a href="#rfc.section.8.2">Create</a>
</li>
<li>8.3.   <a href="#rfc.section.8.3">Join</a>
</li>
<li>8.4.   <a href="#rfc.section.8.4">Leave</a>
</li>
<li>8.5.   <a href="#rfc.section.8.5">JoinConfirm</a>
</li>
<li>8.6.   <a href="#rfc.section.8.6">JoinDecline</a>
</li>
<li>8.7.   <a href="#rfc.section.8.7">Multicast</a>
</li>
<li>9.   <a href="#rfc.section.9">Examples</a>
</li>
<li>9.1.   <a href="#rfc.section.9.1">Create Tree</a>
</li>
<li>9.2.   <a href="#rfc.section.9.2">Join Tree</a>
</li>
<li>9.3.   <a href="#rfc.section.9.3">Leave Tree</a>
</li>
<li>9.4.   <a href="#rfc.section.9.4">Add Direct Application Edge</a>
</li>
<li>9.5.   <a href="#rfc.section.9.5">Adjust Tree to Churn</a>
</li>
<li>9.6.   <a href="#rfc.section.9.6">Push Data</a>
</li>
<li>10.   <a href="#rfc.section.10">Kind Definitions</a>
</li>
<li>10.1.   <a href="#rfc.section.10.1">ALMTree Kind Definition</a>
</li>
<li>11.   <a href="#rfc.section.11">Configuration File Extensions</a>
</li>
<li>12.   <a href="#rfc.section.12">Change History</a>
</li>
<li>13.   <a href="#rfc.section.13">Open Issues</a>
</li>
<li>14.   <a href="#rfc.section.14">IANA Considerations</a>
</li>
<li>15.   <a href="#rfc.section.15">Security Considerations</a>
</li>
<li>16.   <a href="#rfc.references">References</a>
</li>
<li>16.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>16.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Additional Stuff</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The concept of scalable adaptive multicast includes both scaling properties and adaptability properties. Scalability is intended to cover: </p>

<ul>
<li>large group size</li>
<li>large numbers of small groups</li>
<li>rate of group membership change</li>
<li>admission control for QoS</li>
<li>use with network layer QoS mechanisms</li>
<li>varying degrees of reliability</li>
<li>trees connect nodes over global internet</li>
</ul>

<p> Adaptability includes </p>

<ul>
<li>use of different control mechanisms for different multicast trees depending on initial application parameters or application class</li>
<li>changing multicast tree structure depending on changes in application requirements, network conditions, and membership</li>
</ul>

<p> </p>
<p id="rfc.section.1.p.2">Application Layer Multicast (ALM) has been demonstrated to be a viable multicast technology where native multicast isn't available.  Many ALM designs have been proposed.  This ALM Usage focuses on: <a href="#I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</a> has an application extension mechanism in which a new type of application defines a Usage.  A RELOAD Usage defines a set of data types and rules for their use.  In addition, this document describes additional message types and a new ALM algorithm plugin architectural component.</p>

<ul>
<li>ALM implemented in RELOAD-based overlays </li>
<li>Support for a variety of ALM control algorithms </li>
<li>Providing a basis for defining a separate hybrid-ALM RELOAD Usage </li>
</ul>

<p> RELOAD </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#definitions" id="definitions">Definitions</a>
</h1>
<p id="rfc.section.2.p.1">We adopt the terminology defined in section 2 of <a href="#I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</a>, specifically the distinction between Node, Peer, and Client.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Overlay Network</h1>
<div id="#rfc.figure.1"></div>
<div id="#overlay"></div>
<pre>
                    P    P    P   P     P
                  ..+....+....+...+.....+...
                 .                          +P
               P+                            .
                 .                          +P
                  ..+....+....+...+.....+...
                    P    P    P   P     P
            </pre>
<p id="rfc.section.2.1.p.1">Overlay network - An application layer virtual or logical network in which end points are addressable and that provides connectivity, routing, and messaging between end points. Overlay networks are frequently used as a substrate for deploying new network services, or for providing a routing topology not available from the underlying physical network. Many peer-to-peer systems are overlay networks that run on top of the Internet. In the above figure, "P" indicates overlay peers, and peers are connected in a logical address space. The links shown in the figure represent predecessor/successor links. Depending on the overlay routing model, additional or different links may be present.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Overlay Multicast</h1>
<p id="rfc.section.2.2.p.1">Overlay Multicast (OM): Hosts participating in a multicast session form an overlay network and utilize unicast connections among pairs of hosts for data dissemination. The hosts in overlay multicast exclusively handle group management, routing, and tree construction, without any support from Internet routers. This is also commonly known as Application Layer Multicast (ALM) or End System Multicast (ESM). We call systems which use proxies connected in an overlay multicast backbone "proxied overlay multicast" or POM.</p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Peer</h1>
<p id="rfc.section.2.3.p.1">Peer: an autonomous end system that is connected to the physical network and participates in and contributes resources to overlay construction, routing and maintenance. Some peers may also perform additional roles such as connection relays, super nodes, NAT traversal, and data storage.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#Assumptions" id="Assumptions">Assumptions</a>
</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Overlay</h1>
<p id="rfc.section.3.1.p.1">Peers connect in a large-scale overlay, which may be used for a variety of peer-to-peer applications in addition to multicast sessions. Peers may assume additional roles in the overlay beyond participation in the overlay and in multicast trees. We assume a single structured overlay routing algorithm is used. Any of a variety of multi-hop, one-hop, or variable-hop overlay algorithms could be used.</p>
<p id="rfc.section.3.1.p.2">Castro et al. <a href="#CASTRO2003">[CASTRO2003]</a>compared multi-hop overlays and found that tree-based construction in a single overlay out-performed using separate overlays for each multicast session. We use a single overlay rather than separate overlays per multicast sessions. </p>
<p id="rfc.section.3.1.p.3">An overlay multicast algorithm may leverage the overlay's mechanism for maintaining overlay state in the face of churn. For example, a peer may store a number of DHT (Distributed Hash Table) entries. When the peer gracefully leaves the overlay, it transfers those entries to the nearest peer. When another peer joins which is closer to some of the entries than the current peer which holds those entries, than those entries are migrated. Overlay churn affects multicast trees as well; remedies include automatic migration of the tree state and automatic re-join operations for dislocated children nodes.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Overlay Multicast</h1>
<p id="rfc.section.3.2.p.1">The overlay supports concurrent multiple multicast trees. The limit on number of concurrent trees depends on peer and network resources and is not an intrinsic property of the overlay. </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> RELOAD</h1>
<p id="rfc.section.3.3.p.1">We use RELOAD <a href="#I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</a> as the distibuted hash table (DHT) for data storage and overlay by which the peers interconnect and route messages. RELOAD is a generic P2P overlay, and application support is defined by profiles called Usages.  </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> NAT</h1>
<p id="rfc.section.3.4.p.1">Some nodes in the overlay may be in a private address space and behind firewalls. We use the RELOAD mechanisms for NAT traversal. We permit clients to be leaf nodes in an ALM tree.</p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> Tree Topology</h1>
<p id="rfc.section.3.5.p.1">All tree control messages are routed in the overlay.  Two types of data or media topologies are envisioned:  1) tree edges are paths in the overlay, 2) tree edges are direct connections between a parent and child peer in the tree, formed using the RELOAD AppAttach method.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Architecture Extensions to RELOAD</h1>
<p id="rfc.section.4.p.1">There are two changes, shown in the figure below.  New ALM messages are added to RELOAD Message Transport.  A plug-in for ALM algorithms handles the ALM state and control.  The ALM Algorithm is under control of the application via the Group API <a href="#I-D.irtf-samrg-common-api">[I-D.irtf-samrg-common-api]</a>.  </p>
<div id="#rfc.figure.2"></div>
<div id="#ALMUsage"></div>
<pre>
                                                 +---------+
                                                 |Group API|
                                                 +---------+
                                                      |
    ------------------- Application  ------------------------
        +-------+                                     |
        | ALM   |                                     |
        | Usage |                                     |
        +-------+                                     |
     -------------- Messaging Service Boundary --------------
                                                      |
       +--------+      +-----------+---------+    +---------+
       | Storage|&lt;---&gt; | RELOAD    | ALM     |&lt;--&gt;| ALM Alg |
       +--------+      | Message   | Messages|    +---------+
               ^       | Transport |         |
               |       +-----------+---------+
               v          |    |
              +-------------+  |
              | Topology    |  |
              | Plugin      |  |
              +-------------+  |
                 ^             |
                 v             v
              +-------------------+
              | Forwarding&amp;       |
              | Link Management   |
              +-------------------+
    
     ---------- Overlay Link Service Boundary --------------

            </pre>
<p id="rfc.section.4.p.2">The ALM components interact with RELOAD as follows: </p>

<ul>
<li>ALM uses the RELOAD data storage functionality to store a ALMTree instance when a new ALM tree is created in the overlay, and to retrieve ALMTree instance(s) for existing ALM trees.</li>
<li>ALM applications and management tools may use the RELOAD data storage functionality to store diagnostic information about the operation of tree, including average number of tree, delay from source to leaf nodes, bandwidth use, lost packet rate. In addition, diagnostic information may include statistics specific to the tree root, or to any node in the tree.</li>
</ul>

<p> </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> RELOAD ALM Usage</h1>
<p id="rfc.section.5.p.1">Applications of RELOAD are restricted in the data types that be can stored in the DHT. The profile of accepted data types for an application is referred to as a Usage. RELOAD is designed so that new applications can easily define new Usages. New RELOAD Usages are needed for multicast applications since the data types in base RELOAD and existing usages are not sufficient.</p>
<p id="rfc.section.5.p.2">We define an ALM Usage in RELOAD. This ALM Usage is sufficient for applications which require ALM functionality in the overlay. The figure below shows the internal structure of the ALM Usage. This contains the Group API (<a href="#I-D.irtf-samrg-common-api">[I-D.irtf-samrg-common-api]</a>) an ALM algorithm plugin (e.g. Scribe) and the ALM messages which are then sent out to the RELOAD network.</p>
<p id="rfc.section.5.p.3">A RELOAD Usage is required <a href="#I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</a> to define the following: </p>

<ul>
<li>Register Kind-Id points</li>
<li>Define data structures for each kind</li>
<li>Defines access control rules for each kind</li>
<li>Defines the Resource Name used to hash to the Resource ID where the kind is stored</li>
<li>Addresses restoration of values after recovery from a network partition</li>
<li>Defines the types of connections that can be initiated using AppConnect</li>
</ul>

<p> </p>
<p id="rfc.section.5.p.4">A ALM GroupID is a RELOAD Node-ID. The owner of a ALM group creates a RELOAD Node-ID as specified in <a href="#I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</a>. This means that a GroupID is used as a RELOAD Destination for overlay routing purposes.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> ALM Tree Control Signaling</h1>
<p id="rfc.section.6.p.1">Peers use the overlay to support ALM operations such as: </p>

<ul>
<li>Create tree</li>
<li>Join</li>
<li>Leave</li>
<li>Re-Form or optimize tree</li>
</ul>

<p> There are a variety of algorithms for peers to form multicast trees in the overlay. We permit multiple such algorithms to be supported in the overlay, since different algorithms may be more suitable for certain application requirements, and since we wish to support experimentation. Therefore, overlay messaging corresponding to the set of overlay multicast operations must carry algorithm identification information.</p>
<p id="rfc.section.6.p.2">For example, for small groups, the join point might be directly assigned by the rendezvous point, while for large trees the join request might be propagated down the tree with candidate parents forwarding their position directly to the new node.</p>
<p id="rfc.section.6.p.3">Here is a simplistic algorithm for forming a multicast tree in the overlay. Its main advantage is use of the overlay routing mechanism for routing both control and data messages. The group creator doesn't have to be the root of the tree or even in the tree. It doesn't consider per node load, admission control, or alternative paths.</p>
<div id="#rfc.figure.3"></div>
<div id="#create"></div>
<pre>
groupID = create();  // allocate a unique groupId 
                     // the root is the nearest
                     // peer in the overlay
                     // out of band advertisement or
                     // distribution of groupID, 
                     // perhaps by publishing in DHT
</pre>
<div id="#rfc.figure.4"></div>
<div id="#joinTree"></div>
<pre>
// out of band discovery of groupID, perhaps by lookup in DHT
joinTree(groupID); // sends "join groupID" message
</pre>
<p id="rfc.section.6.p.4">As stated earlier, multiple algorithms will co-exist in the overlay. </p>

<ol>
<li>Peer which initiates multicast group: <br><br> </li>
<li>Any joining peer: <br><br> <br><br> The overlay routes the join request using the overlay routing mechanism toward the peer with the nearest id to the groupID. This peer is the root. Peers on the path to the root join the tree as forwarding points.</li>
<li>Leave Tree: <br><br> leaveTree(groupID) // removes this node from the tree <br><br> Propagates a leave message to each child node and to the parent node. If the parent node is a forwarding node and this is its last child, then it propagates a leave message to its parent. A child node receiving a leave message from a parent sends a join message to the groupID.</li>
<li>Message forwarding: <br><br> multicastMsg(groupID, msg);</li>
<li>For the message forwarding there are two approaches: <ul>
<li>SSM tree: The creator of the tree is the source. It sends data messages to the tree root which are forwarded down the tree.</li>
<li>ASM tree: A node sending a data message sends the message to its parent and its children. Each node receiving a data message from one edge forwards it to remaining tree edges it is connected to.</li>
</ul>
</li>
</ol>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#sec-protocol" id="sec-protocol">ALM Messages Added to RELOAD Protocol</a>
</h1>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> Introduction</h1>
<p id="rfc.section.7.1.p.1">In this document we define messages for overlay multicast tree creation, using an existing proposal (RELOAD) in the P2P-SIP WG <a href="#I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</a> for a universal structured peer-to-peer overlay protocol. RELOAD provides the mechanism to support a number of overlay topologies. Hence the overlay multicast framework <a href="#I-D.irtf-sam-hybrid-overlay-framework">[I-D.irtf-sam-hybrid-overlay-framework]</a> (hereafter SAM framework) can be used with P2P-SIP, and that the SAM framework is overlay agnostic.</p>
<p id="rfc.section.7.1.p.2">As discussed in the SAM requirements draft, there are a variety of ALM tree formation and tree maintenance algorithms. The intent of this specification is to be algorithm agnostic, similar to how RELOAD is overlay algorithm agnostic. We assume that all control messages are propagated using overlay routed messages.</p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> Tree Lifecycle Messages</h1>
<p id="rfc.section.7.2.p.1">Peers use the overlay to transmit ALM (application layer multicast) operations defined in this section.</p>
<h1 id="rfc.section.7.2.1">
<a href="#rfc.section.7.2.1">7.2.1.</a> Create Tree</h1>
<p id="rfc.section.7.2.1.p.1">A new ALM tree is created in the overlay with the identity specified by GroupId. The usual interpretation of GroupId is that the peer with peer id closest to and less than the GroupId is the root of the tree. The tree has no children at the time it is created.</p>
<p id="rfc.section.7.2.1.p.2">The GroupId is generated from a well-known session key to be used by other Peers to address the multicast tree in the overlay. The generation of the GroupId from the SessionKey MUST be done using the overlay's id generation mechanism.</p>
<p id="rfc.section.7.2.1.p.3">A successful Create Tree causes an ALMTree structure to be stored in the overlay at the node responsible for NodeID equal to the GroupId.</p>
<div id="#rfc.figure.5"></div>
<pre>
      struct {  
        NodeID PeerId;
        opaque SessionKey&lt;0..2^32-1&gt;;
        NodeID GroupId;
        Dictionary Options;
      } ALMTree;
</pre>
<p id="rfc.section.7.2.1.p.4">PeerId: the overlay address of the peer that creates the multicast tree.</p>
<p id="rfc.section.7.2.1.p.5">SessionKey: a well-known string when hashed using the overlay's id generation algorithm produces the GroupId.</p>
<p id="rfc.section.7.2.1.p.6">GroupId: the overlay address of the root of the tree</p>
<p id="rfc.section.7.2.1.p.7">Options: name-value list of properties to be associated with the tree, such as the maximum size of the tree, restrictions on peers joining the tree, latency constraints, preference for distributed or centralized tree formation and maintenance, heartbeat interval.</p>
<p id="rfc.section.7.2.1.p.8">Tree creation is subject to access control since it involves an Store operation.  Before the Store of an ALMTree structure is permitted, the storing peer MUST check that: </p>

<ul>
<li>The certificate contains a SessionKey</li>
<li>The certificate contains a Node-ID that is the same as GroupID that it is being stored at Node-ID (this is the NODE-MATCH access policy) </li>
</ul>
<h1 id="rfc.section.7.2.2">
<a href="#rfc.section.7.2.2">7.2.2.</a> Join</h1>
<p id="rfc.section.7.2.2.p.1">Causes the distributed algorithm for peer join of a specific ALM group to be invoked. If successful, the PeerId is notified of one or more candidate parent peers in one or more JoinAccept messages. The particular ALM join algorithm is not specified in this protocol.</p>
<div id="#rfc.figure.6"></div>
<pre>
      struct {  
        NodeID PeerId;
        NodeID GroupId;
        Dictionary Options;
      } Join;
</pre>
<p id="rfc.section.7.2.2.p.2">PeerId: overlay address of joining/leaving peer</p>
<p id="rfc.section.7.2.2.p.3">GroupId: the overlay address of the root of the tree</p>
<p id="rfc.section.7.2.2.p.4">Options: name-value list of options proposed by joining peer</p>
<h1 id="rfc.section.7.2.3">
<a href="#rfc.section.7.2.3">7.2.3.</a> Join Accept</h1>
<p id="rfc.section.7.2.3.p.1">Tells the requesting joining peer that the indicated peer is available to act as its parent in the ALM tree specified by GroupId, with the corresponding Options specified. A peer MAY receive more than one JoinAccept from diffent candidate parent peers in the GroupId tree. The peer accepts a peer as parent using a JoinConfirm message. A JoinAccept which receives neither a JoinConfirm or JoinDecline response MUST expire.</p>
<div id="#rfc.figure.7"></div>
<pre>
      struct {  
        NodeID ParentPeerId;
        NodeID ChildPeerId;
        NodeID GroupId;
        Dictionary Options;
      } JoinAccept;
</pre>
<p id="rfc.section.7.2.3.p.2">ParentPeerId: overlay address of a peer which accepts the joining peer</p>
<p id="rfc.section.7.2.3.p.3">ChildPeerId: overlay address of joining peer</p>
<p id="rfc.section.7.2.3.p.4">GroupId: the overlay address of the root of the tree</p>
<p id="rfc.section.7.2.3.p.5">Options: name-value list of options accepted by parent peer</p>
<h1 id="rfc.section.7.2.4">
<a href="#rfc.section.7.2.4">7.2.4.</a> Join Confirm</h1>
<p id="rfc.section.7.2.4.p.1">A peer receiving a JoinAccept message which it wishes to accept MUST explicitly accept it before the expiration of the JoinAccept using a JoinConfirm message. The joining peer MUST include only those options from the JoinAccept which it also accepts, completing the negotiation of options between the two peers.</p>
<div id="#rfc.figure.8"></div>
<pre>
      struct {  
        NodeID ChildPeerId;
        NodeID ParentPeerId;
        NodeID GroupId;
        Dictionary Options;
      } JoinConfirm;
</pre>
<p id="rfc.section.7.2.4.p.2">ChildPeerId: overlay address of joining peer which is a child of the parent peer</p>
<p id="rfc.section.7.2.4.p.3">ParentPeerId: overlay address of the peer which is the parent of the joining peer</p>
<p id="rfc.section.7.2.4.p.4">GroupId: the overlay address of the root of the tree</p>
<p id="rfc.section.7.2.4.p.5">Options: name-value list of options accepted by both peers</p>
<h1 id="rfc.section.7.2.5">
<a href="#rfc.section.7.2.5">7.2.5.</a> Join Decline</h1>
<p id="rfc.section.7.2.5.p.1">A peer receiving a JoinAccept message which does not wish to accept it MAY explicitly decline it using a JoinDecline message.</p>
<div id="#rfc.figure.9"></div>
<pre>
      struct {  
        NodeID PeerId;
        NodeID ParentPeerId;
        NodeID GroupId;
      } JoinDecline;
</pre>
<p id="rfc.section.7.2.5.p.2">PeerId: overlay address of joining peer which declines the JoinAccept</p>
<p id="rfc.section.7.2.5.p.3">ParentPeerId: overlay address of the peer which issued a JoinAccept to this peer</p>
<p id="rfc.section.7.2.5.p.4">GroupId: the overlay address of the root of the tree</p>
<h1 id="rfc.section.7.2.6">
<a href="#rfc.section.7.2.6">7.2.6.</a> Leave</h1>
<p id="rfc.section.7.2.6.p.1">A peer which is part of an ALM tree idenfied by GroupId which intends to detach from either a child or parent peer SHOULD send a Leave message to the peer it wishes to detach from. A peer receiving a Leave message from a peer which is neither in its parent or child lists SHOULD ignore the message.</p>
<div id="#rfc.figure.10"></div>
<pre>
      struct {  
        NodeID PeerId;
        NodeID GroupId;
        Dictionary Options;
      } Leave;
</pre>
<p id="rfc.section.7.2.6.p.2">PeerId: overlay address of leaving peer</p>
<p id="rfc.section.7.2.6.p.3">GroupId: the overlay address of the root of the tree</p>
<p id="rfc.section.7.2.6.p.4">Options: name-value list of options</p>
<h1 id="rfc.section.7.2.7">
<a href="#rfc.section.7.2.7">7.2.7.</a> Re-Form or Optimize Tree</h1>
<p id="rfc.section.7.2.7.p.1">This triggers a reorganization of either the entire tree or only a sub-tree. It MAY include hints to specific peers of recommended parent or child peers to reconnect to. A peer receiving this message MAY ignore it, MAY propagate it to other peers in its subtree, and MAY invoke local algorithms for selecting preferred parent and/or child peers.</p>
<div id="#rfc.figure.11"></div>
<pre>
      struct {  
        NodeID GroupId;
        NodeID PeerId;
        Dictionary Options;
      } Reform;
</pre>
<p id="rfc.section.7.2.7.p.2">GroupId: the overlay address of the root of the tree</p>
<p id="rfc.section.7.2.7.p.3">PeerId: if omitted, then the tree is reorganized starting from the root, otherwise it is reorganized only at the sub-tree identified by PeerId.</p>
<p id="rfc.section.7.2.7.p.4">Options: name-value list of options</p>
<h1 id="rfc.section.7.2.8">
<a href="#rfc.section.7.2.8">7.2.8.</a> Heartbeat</h1>
<p id="rfc.section.7.2.8.p.1">A node signals to its adjacent nodes in the tree that it is alive. If a peer does not receive a Heartbeat message within N heartbeat time intervals, it MUST treat this as an explicit Leave message from the unresponsive peer. N is configurable.</p>
<div id="#rfc.figure.12"></div>
<pre>
      struct {  
        NodeID PeerId1;
        NodeID PeerId2;
        NodeID GroupId;
      } Heartbeat;
</pre>
<p id="rfc.section.7.2.8.p.2">PeerId1: source of heartbeat</p>
<p id="rfc.section.7.2.8.p.3">PeerId2: destination of heartbeat</p>
<p id="rfc.section.7.2.8.p.4">GroupId: overlay address of the root of the tree</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Scribe Algorithm</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> Overview</h1>
<p id="rfc.section.8.1.p.1">The following table shows a mapping between RELOAD ALM  messages (as defined in Section 5 of this draft) and Scribe messages as defined in <a href="#CASTRO2002">[CASTRO2002]</a>. </p>
<div id="#rfc.figure.13"></div>
<div id="#ScribeMapping"></div>
<pre>
         +------------------+-------------------+-----------------+
         | Section in Draft |RELOAD ALM Message | Scribe Message  |
         +------------------+-------------------+-----------------+
         | 5.2.1            | CreateALMTree     | Create          |
         +------------------+-------------------+-----------------+
         | 5.2.2            | Join              | Join            |
         +------------------+-------------------+-----------------+
         | 5.2.3            | JoinAccept        |                 |
         +------------------+-------------------+-----------------+
         | 5.2.4            | JoinConfirm       |                 |
         +------------------+-------------------+-----------------+
         | 5.2.5            | JoinDecline       |                 |
         +------------------+-------------------+-----------------+
         | 5.2.8            | Leave             | Leave           |
         +------------------+-------------------+-----------------+
         | 5.2.10           | Reform            |                 |
         +------------------+-------------------+-----------------+
         | 5.2.11           | Heartbeat         |                 |
         +------------------+-------------------+-----------------+
         | new              | Push/Deliver/Send | Multicast       |
         +------------------+-------------------+-----------------+
         |                  | Note 1            | deliver         |
         +------------------+-------------------+-----------------+
         |                  | Note 1            | forward         |
         +------------------+-------------------+-----------------+
         |                  | Note 1            | route           |
         +------------------+-------------------+-----------------+
         |                  | Note 1            | send            |
         +------------------+-------------------+-----------------+
            </pre>
<p id="rfc.section.8.1.p.2">Note 1: These Scribe messages are handled by RELOAD messages.</p>
<p id="rfc.section.8.1.p.3">The following sections describe the Scribe algorithm in more detail.</p>
<h1 id="rfc.section.8.2">
<a href="#rfc.section.8.2">8.2.</a> Create</h1>
<p id="rfc.section.8.2.p.1">This message will create a group with GroupId. This message will be delivered to the node whose NodeId is closest to the GroupId. This node becomes the rendevous point and root for the new multicast tree.  Groups may have multiple sources of multicast messages.  </p>
<div id="#rfc.figure.14"></div>
<pre>
CREATE : groups.add(msg.GroupId)
</pre>
<p id="rfc.section.8.2.p.2">GroupId: the overlay address of the root of the tree</p>
<h1 id="rfc.section.8.3">
<a href="#rfc.section.8.3">8.3.</a> Join</h1>
<p id="rfc.section.8.3.p.1">To join a multicast tree a node sends a JOIN request with the GroupId as the key. This message gets routed by the overlay to the rendevous point of the tree. If an intermediate node is already a forwarder for this tree, it will add the joining node as a child. Otherwise the node will create a child table for the group and adds the joining node. It will then send the JOIN request towards the rendevous point terminating the JOIN message from the child.  </p>
<p id="rfc.section.8.3.p.2">To adapt the Scribe algorithm into the ALM Usage proposed here, after a JOIN request is accepted, a JOINAccept message is returned to the joining node.  </p>
<div id="#rfc.figure.15"></div>
<pre>
JOIN : if(checkAccept(msg)) {
		    recvJoins.add(msg.source, msgGroupId)
		    SEND(JOINAccept(nodeID, msg.source, msg.GroupId))
		}
</pre>
<h1 id="rfc.section.8.4">
<a href="#rfc.section.8.4">8.4.</a> Leave</h1>
<p id="rfc.section.8.4.p.1">When leaving a multicast group a node will change its local state to indicate that it left the group.  If the node has no children in its table it will send a LEAVE request to its parent, which will travel up the multicast tree and will stop at a node which has still children remaining after removing the leaving node.  </p>
<div id="#rfc.figure.16"></div>
<pre>
LEAVE : groups[msg.GroupId].children.remove(msg.source)
           if (groups[msg.group].children = 0)
              SEND(msg,groups[msg.GroupId].parent)
</pre>
<h1 id="rfc.section.8.5">
<a href="#rfc.section.8.5">8.5.</a> JoinConfirm</h1>
<p id="rfc.section.8.5.p.1">This message is not part of the Scribe protocol, but required by the basic protocol proposed in this draft. Thus the usage will send this message to conirm a joining node accepting its parent node.  </p>
<div id="#rfc.figure.17"></div>
<pre>
JOINConfirm: if(recvJoins.contains(msg.source,msg.GroupId)){
		 if !(groups.contains(msg.GroupId)) {
            	   groups.add(msg.GroupId)
            	   SEND(msg,msg.GroupId)
		 }
                groups[msg.GroupId].children.add(msg.source)
			 recvJoins.del(msg.source, msgGroupId)
	      }
</pre>
<h1 id="rfc.section.8.6">
<a href="#rfc.section.8.6">8.6.</a> JoinDecline</h1>
<div id="#rfc.figure.18"></div>
<pre>
JOINDecline: if(recvJoins.contains(msg.source,msg.GroupId))
			 recvJoins.del(msg.source, msgGroupId)
</pre>
<h1 id="rfc.section.8.7">
<a href="#rfc.section.8.7">8.7.</a> Multicast</h1>
<p id="rfc.section.8.7.p.1">A message to be multicast to a group is sent to the rendevous node from where it is forwarded down the tree. If a node is a member of the tree rather than just a forwarder it will pass the multicast data up to the application.  </p>
<div id="#rfc.figure.19"></div>
<pre>
MULTICAST : foreach(groups[msg.GroupId].children as NodeId)
                   SEND(msg,NodeId)
            if memberOf(msg.GroupId)
                   invokeMessageHandler(msg.GroupId, msg)
</pre>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Examples</h1>
<p id="rfc.section.9.p.1">All peers in the examples are assumed to have completed bootstrapping.  "Pn" refers to peer N.  "GroupID" refers to a peer responsible for storing the ALMTree instance with GroupID.  </p>
<h1 id="rfc.section.9.1">
<a href="#rfc.section.9.1">9.1.</a> Create Tree</h1>
<div id="#rfc.figure.20"></div>
<div id="#CreateTreeExample"></div>
<pre>
     P1      P2      P3       P4      GroupID
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     | CreateTree    |        |       |
     |-------------------------------&gt;|
     |       |       |        |       |
     |       |       |        |       |
     |       |    CreateTreeResponse  |
     |&lt;-------------------------------|
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
            </pre>
<h1 id="rfc.section.9.2">
<a href="#rfc.section.9.2">9.2.</a> Join Tree</h1>
<div id="#rfc.figure.21"></div>
<div id="#JoinTreeExample"></div>
<pre>
     P1      P2      P3       P4      GroupID
     |       |       |        |       |
     |       |       |        |       |
     | Join                           |
     |-------------------------------&gt;|
     |       |       |        |       |
     | JoinAccept                     |
     |&lt;-------------------------------|
     |       |       |        |       |
     |       |       |        |       |
     |       |Join                    |
     |       |-----------------------&gt;|
     |       |       |        |       |
     |                            Join|
     |&lt;-------------------------------|
     |       |       |        |       |
     |JoinAccept     |        |       |
     |------&gt;|       |        |       |
     |       |       |        |       |
     |JoinConfirm    |        |       |
     |&lt;------|       |        |       |
     |       |       |        |       |
     |       |       |        |Join   |
     |       |       |        |------&gt;|
     |       |       |        |  Join |
     |&lt;-------------------------------|
     |       |       |        |       |
     | Join  |       |        |       |
     |------&gt;|       |        |       |
     |       |       |        |       |
     | JoinAccept    |        |       |
     |-----------------------&gt;|       |
     |       |       |        |       |
     |       | JoinAccept     |       |
     |       |---------------&gt;|       |
     |       |       |        |       |
     |       |       |        |       |
     |       |   Join Confirm |       |
     |&lt;-----------------------|       |
     |       |       |        |       |
     |       |   Join Decline |       |
     |       |&lt;---------------|       |
     |       |       |        |       |
     |       |       |        |       |
            </pre>
<h1 id="rfc.section.9.3">
<a href="#rfc.section.9.3">9.3.</a> Leave Tree</h1>
<div id="#rfc.figure.22"></div>
<div id="#LeaveTreeExample"></div>
<pre>
     P1      P2      P3       P4      GroupID
     |       |       |        |       |
     |       |       |        |       |
     |       |       |  Leave |       |
     |&lt;-----------------------|       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
     |       |       |        |       |
            </pre>
<h1 id="rfc.section.9.4">
<a href="#rfc.section.9.4">9.4.</a> Add Direct Application Edge</h1>
<h1 id="rfc.section.9.5">
<a href="#rfc.section.9.5">9.5.</a> Adjust Tree to Churn</h1>
<h1 id="rfc.section.9.6">
<a href="#rfc.section.9.6">9.6.</a> Push Data</h1>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Kind Definitions</h1>
<h1 id="rfc.section.10.1">
<a href="#rfc.section.10.1">10.1.</a> ALMTree Kind Definition</h1>
<p id="rfc.section.10.1.p.1">This section defines the ALMTree kind.</p>
<p id="rfc.section.10.1.p.2">Kind IDs  The Resource Name for the ALMTree Kind-ID is the SessionKey used to identify the ALM tree</p>
<p id="rfc.section.10.1.p.3">Data Model The data model is the ALMTree structure. </p>
<p id="rfc.section.10.1.p.4">Access Control  NODE-MATCH </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> Configuration File Extensions</h1>
<p id="rfc.section.11.p.1">In RELOAD, peers receive a configuration document at bootstrap time.  ALM parameter definitions for the configuration file will be defined in a later version.  </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> Change History</h1>
<p></p>

<ul><li>Version 02: Remove Hybrid ALM material.  Define ALMTree kind.  Define new RELOAD messages.  Define RELOAD architecture extensions. Add Scribe as base algorithm for ALM usage. Define code points. Define preliminary ALM-specific security issues.</li></ul>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> Open Issues</h1>
<p></p>

<ul>
<li>The specific capabilities of clients in terms of tree creation and being parents of other nodes will be described in subsequent versions.</li>
<li>ALM parameter definitions for the RELOAD configuration file will be defined in a later version. </li>
<li>Should any other ALM algorithms be mapped</li>
<li>
</ul>

<p> </p>
<h1 id="rfc.section.14">
<a href="#rfc.section.14">14.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.14.p.1">This memo includes no request to IANA.</p>
<p id="rfc.section.14.p.2">Code points for the kinds defined in this document MUST not conflict with any defined code points for RELOAD.  For Data Kind-IDs, the RELOAD specification states: "Code points in the range 0xf0000001 to 0xfffffffe are reserved for private use".  ALM Usage Kind-IDs will be defined in the private use range.</p>
<p id="rfc.section.14.p.3">Code points for new message types defined in this document must not conflict with any defined code points for RELOAD.  Unlike Data Kind-IDs which permit private code points, RELOAD does not define private or experimental code points for Message Codes.  For experimental purposes we recommend using message code points in the range 0x7000 to 0x70FF for the new message types defined in this specification:</p>
<p id="rfc.section.14.p.4">All ALM Usage messages support the RELOAD Message Extension mechanism.  </p>
<div id="#rfc.table.1"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<caption>Message Code Points</caption>
<thead><tr>
<th class="left">Message</th>
<th class="left">Code Point</th>
</tr></thead>
<tbody>
<tr>
<td class="left">CreateALMTree</td>
<td class="left">0x7000</td>
</tr>
<tr>
<td class="left">CreateALMTreeResponse</td>
<td class="left">0x7001</td>
</tr>
<tr>
<td class="left">Join</td>
<td class="left">0x7002</td>
</tr>
<tr>
<td class="left">JoinAccept</td>
<td class="left">0x7003</td>
</tr>
<tr>
<td class="left">JoinConfirm</td>
<td class="left">0x7004</td>
</tr>
<tr>
<td class="left">JoinDecline</td>
<td class="left">0x7005</td>
</tr>
<tr>
<td class="left">Leave</td>
<td class="left">0x7006</td>
</tr>
<tr>
<td class="left">LeaveResponse</td>
<td class="left">0x7007</td>
</tr>
<tr>
<td class="left">Reform</td>
<td class="left">0x7008</td>
</tr>
<tr>
<td class="left">ReformResponse</td>
<td class="left">0x7009</td>
</tr>
<tr>
<td class="left">Heartbeat</td>
<td class="left">0x700A</td>
</tr>
<tr>
<td class="left">Push</td>
<td class="left">0x700B</td>
</tr>
<tr>
<td class="left">PushResponse</td>
<td class="left">0x700C</td>
</tr>
</tbody>
</table>
<p id="rfc.section.14.p.5">No new Error Codes are defined.</p>
<p id="rfc.section.14.p.6">Application-ID: The ALM Usage Application-IDs must not conflict with other applications of reload.  Additionally if AppAttach is used, the port number must be selected to avoid conflicts. </p>
<p id="rfc.section.14.p.7">Access Control Policies: No new policies.</p>
<p id="rfc.section.14.p.8">ALM Algorithm Types:  There is currently one type: SCRIBE-RELOAD.</p>
<h1 id="rfc.section.15">
<a href="#rfc.section.15">15.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.15.p.1">Overlays are vulnerable to DOS and collusion attacks. We are not solving overlay security issues. We assume the node authentication model as defined in <a href="#I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</a>.</p>
<p id="rfc.section.15.p.2">ALM Usage specific security issues: </p>

<ul>
<li>Right to create GroupID at some NodeId </li>
<li>Right to store Tree info at some Location in the DHT </li>
<li>Limit on # messages / sec and bandwidth use </li>
<li>Right to join an ALM tree </li>
<li>
</ul>
<h1 id="rfc.references">
<a href="#rfc.references">16.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">16.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC0792">[RFC0792]</b></td>
<td class="top">
<a title="University of Southern California (USC)/Information Sciences Institute">Postel, J.</a>, "<a href="http://tools.ietf.org/html/rfc792">Internet Control Message Protocol</a>", STD 5, RFC 792, September 1981.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3376">[RFC3376]</b></td>
<td class="top">
<a>Cain, B.</a>, <a>Deering, S.</a>, <a>Kouvelas, I.</a>, <a>Fenner, B.</a> and <a>A. Thyagarajan</a>, "<a href="http://tools.ietf.org/html/rfc3376">Internet Group Management Protocol, Version 3</a>", RFC 3376, October 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3810">[RFC3810]</b></td>
<td class="top">
<a>Vida, R.</a> and <a>L. Costa</a>, "<a href="http://tools.ietf.org/html/rfc3810">Multicast Listener Discovery Version 2 (MLDv2) for IPv6</a>", RFC 3810, June 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4605">[RFC4605]</b></td>
<td class="top">
<a>Fenner, B.</a>, <a>He, H.</a>, <a>Haberman, B.</a> and <a>H. Sandick</a>, "<a href="http://tools.ietf.org/html/rfc4605">Internet Group Management Protocol (IGMP) / Multicast Listener Discovery (MLD)-Based Multicast Forwarding ("IGMP/MLD Proxying")</a>", RFC 4605, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4607">[RFC4607]</b></td>
<td class="top">
<a>Holbrook, H.</a> and <a>B. Cain</a>, "<a href="http://tools.ietf.org/html/rfc4607">Source-Specific Multicast for IP</a>", RFC 4607, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5058">[RFC5058]</b></td>
<td class="top">
<a>Boivie, R.</a>, <a>Feldman, N.</a>, <a>Imai, Y.</a>, <a>Livens, W.</a> and <a>D. Ooms</a>, "<a href="http://tools.ietf.org/html/rfc5058">Explicit Multicast (Xcast) Concepts and Options</a>", RFC 5058, November 2007.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">16.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1930">[RFC1930]</b></td>
<td class="top">
<a href="mailto:jhawk@bbnplanet.com" title="BBN Planet Corporation">Hawkinson, J.</a> and <a href="mailto:Tony.Bates@mci.net" title="MCI">T. Bates</a>, "<a href="http://tools.ietf.org/html/rfc1930">Guidelines for creation, selection, and registration of an Autonomous System (AS)</a>", BCP 6, RFC 1930, March 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3552">[RFC3552]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>B. Korver</a>, "<a href="http://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>", BCP 72, RFC 3552, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4286">[RFC4286]</b></td>
<td class="top">
<a>Haberman, B.</a> and <a>J. Martin</a>, "<a href="http://tools.ietf.org/html/rfc4286">Multicast Router Discovery</a>", RFC 4286, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1112">[RFC1112]</b></td>
<td class="top">
<a href="mailto:deering@PESCADERO.STANFORD.EDU" title="Stanford University, Computer Science Department">Deering, S.</a>, "<a href="http://tools.ietf.org/html/rfc1112">Host extensions for IP multicasting</a>", STD 5, RFC 1112, August 1989.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-mboned-auto-multicast">[I-D.ietf-mboned-auto-multicast]</b></td>
<td class="top">
<a>Thaler, D</a>, <a>Talwar, M</a>, <a>Aggarwal, A</a>, <a>Vicisano, L</a>, <a>Pusateri, T</a> and <a>T Morin</a>, "<a href="http://tools.ietf.org/html/draft-ietf-mboned-auto-multicast-11">Automatic IP Multicast Tunneling</a>", Internet-Draft draft-ietf-mboned-auto-multicast-11, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-p2psip-base">[I-D.ietf-p2psip-base]</b></td>
<td class="top">
<a>Jennings, C</a>, <a>Lowekamp, B</a>, <a>Rescorla, E</a>, <a>Baset, S</a> and <a>H Schulzrinne</a>, "<a href="http://tools.ietf.org/html/draft-ietf-p2psip-base-19">REsource LOcation And Discovery (RELOAD) Base Protocol</a>", Internet-Draft draft-ietf-p2psip-base-19, October 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.ietf-p2psip-sip">[I-D.ietf-p2psip-sip]</b></td>
<td class="top">
<a>Jennings, C</a>, <a>Lowekamp, B</a>, <a>Rescorla, E</a>, <a>Baset, S</a> and <a>H Schulzrinne</a>, "<a href="http://tools.ietf.org/html/draft-ietf-p2psip-sip-06">A SIP Usage for RELOAD</a>", Internet-Draft draft-ietf-p2psip-sip-06, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.matuszewski-p2psip-security-overview">[I-D.matuszewski-p2psip-security-overview]</b></td>
<td class="top">
<a>Yongchao, S</a>, <a>Matuszewski, M</a> and <a>D York</a>, "<a href="http://tools.ietf.org/html/draft-matuszewski-p2psip-security-overview-01">P2PSIP Security Overview and Risk Analysis</a>", Internet-Draft draft-matuszewski-p2psip-security-overview-01, October 2009.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.irtf-p2prg-rtc-security">[I-D.irtf-p2prg-rtc-security]</b></td>
<td class="top">
<a>Schulzrinne, H</a>, <a>Marocco, E</a> and <a>E Ivov</a>, "<a href="http://tools.ietf.org/html/draft-irtf-p2prg-rtc-security-05">Security Issues and Solutions in Peer-to-peer Systems for Realtime Communications</a>", Internet-Draft draft-irtf-p2prg-rtc-security-05, September 2009.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.irtf-samrg-common-api">[I-D.irtf-samrg-common-api]</b></td>
<td class="top">
<a>Waehlisch, M</a>, <a>Schmidt, T</a> and <a>S Venaas</a>, "<a href="http://tools.ietf.org/html/draft-irtf-samrg-common-api-03">A Common API for Transparent Hybrid Multicast</a>", Internet-Draft draft-irtf-samrg-common-api-03, July 2011.</td>
</tr>
<tr>
<td class="reference"><b id="I-D.irtf-sam-hybrid-overlay-framework">[I-D.irtf-sam-hybrid-overlay-framework]</b></td>
<td class="top">
<a>Buford, J</a>, "<a href="http://tools.ietf.org/html/draft-irtf-sam-hybrid-overlay-framework-02">Hybrid Overlay Multicast Framework</a>", Internet-Draft draft-irtf-sam-hybrid-overlay-framework-02, February 2008.</td>
</tr>
<tr>
<td class="reference"><b id="AGU1984">[AGU1984]</b></td>
<td class="top">
<a>Aguilar, L.</a>, "<a>Datagram Routing for Internet Multicasting</a>", ACM Sigcomm 84 1984, March 1984.</td>
</tr>
<tr>
<td class="reference"><b id="CASTRO2002">[CASTRO2002]</b></td>
<td class="top">
<a>Castro, M.</a>, <a>Druschel, P.</a>, <a>Kermarrec, A.-M.</a> and <a>A. Rowstron</a>, "<a>Scribe: A large-scale and decentralized application-level multicast infrastructure</a>", IEEE Journal on Selected Areas in Communications vol.20, No.8, October 2002.</td>
</tr>
<tr>
<td class="reference"><b id="CASTRO2003">[CASTRO2003]</b></td>
<td class="top">
<a>Castro, M.</a>, <a>Jones, M.</a>, <a>Kermarrec, A.-M.</a>, <a>Rowstron, A.</a>, <a>Theimer, M.</a>, <a>Wang, H.</a> and <a>A. Wolman</a>, "<a>An Evaluation of Scalable Application-level Multicast Built Using Peer-to-peer overlays</a>", Proceedings of IEEE INFOCOM 2003, April 2003.</td>
</tr>
<tr>
<td class="reference"><b id="HE2005">[HE2005]</b></td>
<td class="top">
<a>He, Q.</a> and <a>M. Ammar</a>, "<a>Dynamic Host-Group/Multi-Destination Routing for Multicast Sessions</a>", J. Telecommunication Systems vol. 28, pp. 409-433, 2005.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#app-additional" id="app-additional">Additional Stuff</a>
</h1>
<p id="rfc.section.Appendix A.p.1">This becomes an Appendix.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">John Buford</span> 
	  <span class="n hidden">
		<span class="family-name">Buford</span>
	  </span>
	</span>
	<span class="org vcardline">Avaya Labs Research</span>
	<span class="adr">
	  <span>233 Mt. Airy Rd</span>

	  <span class="vcardline">
		<span class="locality">Basking Ridge</span>,  
		<span class="region">New Jersey</span> 
		<span class="code">07920</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1 908 848 5675</span>

<span class="vcardline">EMail: <a href="mailto:buford@avaya.com">buford@avaya.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mario Kolberg</span> editor
	  <span class="n hidden">
		<span class="family-name">Kolberg</span>
	  </span>
	</span>
	<span class="org vcardline">University of Stirling</span>
	<span class="adr">
	  <span>Dept. Computing Science and Mathematics</span>

	  <span class="vcardline">
		<span class="locality">Stirling</span>,  
		<span class="region"></span>
		<span class="code">FK9 4LA</span>
	  </span>
	  <span class="country-name vcardline">UK</span>
	</span>
	<span class="vcardline">Phone: +44 1786 46 7440</span>

<span class="vcardline">EMail: <a href="mailto:mkolberg@ieee.org">mkolberg@ieee.org</a></span>

<span class="vcardline">URI: <a href="http://www.cs.stir.ac.uk/~mko">http://www.cs.stir.ac.uk/~mko</a></span>

  </address>
</div>

</body>
</html>