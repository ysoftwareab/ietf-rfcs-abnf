smallest = largest - ack_block

largest = previous_smallest - gap - 2

expected_pn  = largest_pn + 1
pn_win       = 1 << pn_nbits
pn_hwin      = pn_win / 2
pn_mask      = pn_win - 1
candidate_pn = (expected_pn & ~pn_mask) | truncated_pn
