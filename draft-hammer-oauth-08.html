<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The OAuth Core 1.0 Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The OAuth Core 1.0 Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">E. Hammer-Lahav, Ed.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">December 03, 2009</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">Expires: June 6, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />The OAuth Core 1.0 Protocol<br />draft-hammer-oauth-08</h1>

<h3>Abstract</h3>

<p>
        OAuth provides a method for clients to access server resources on behalf of a resource
        owner (such as a different client or an end-user). It also provides a process for end-users
        to authorize third party access to their server resources without sharing their credentials
        (typically, a username and password pair), using user-agent redirections.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on June 6, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Example<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Notational Conventions<br />
<a href="#redirect_workflow">2.</a>&nbsp;
Redirection-Based Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_step1">2.1.</a>&nbsp;
Temporary Credentials<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_step2">2.2.</a>&nbsp;
Resource Owner Authorization<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_step3">2.3.</a>&nbsp;
Token Credentials<br />
<a href="#requests">3.</a>&nbsp;
Authenticated Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.</a>&nbsp;
Making Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#verify_request">3.2.</a>&nbsp;
Verifying Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#nonce">3.3.</a>&nbsp;
Nonce and Timestamp<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#signature">3.4.</a>&nbsp;
Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.4.1.</a>&nbsp;
Signature Base String<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.4.2.</a>&nbsp;
HMAC-SHA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.4.3.</a>&nbsp;
RSA-SHA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.4.4.</a>&nbsp;
PLAINTEXT<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#param_include">3.5.</a>&nbsp;
Parameter Transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_header">3.5.1.</a>&nbsp;
Authorization Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_body">3.5.2.</a>&nbsp;
Form-Encoded Body<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#auth_query">3.5.3.</a>&nbsp;
Request URI Query<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#encoding">3.6.</a>&nbsp;
Percent Encoding<br />
<a href="#Security">4.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.1.</a>&nbsp;
Credentials Transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.2.</a>&nbsp;
RSA-SHA1 Signature Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#plain_ssl">4.3.</a>&nbsp;
PLAINTEXT Signature Method<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.4.</a>&nbsp;
Confidentiality of Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.5.</a>&nbsp;
Spoofing by Counterfeit Servers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.6.</a>&nbsp;
Proxying and Caching of Authenticated Content<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.7.</a>&nbsp;
Plaintext Storage of Credentials<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#client_cred_sec">4.8.</a>&nbsp;
Secrecy of the Client Credentials<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.9.</a>&nbsp;
Phishing Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.10.</a>&nbsp;
Scoping of Access Requests<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">4.11.</a>&nbsp;
Entropy of Secrets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">4.12.</a>&nbsp;
Denial of Service / Resource Exhaustion Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">4.13.</a>&nbsp;
SHA-1 Cryptographic Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">4.14.</a>&nbsp;
Signature Base String Limitations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">4.15.</a>&nbsp;
Cross-Site Request Forgery (CSRF)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">4.16.</a>&nbsp;
User Interface Redress<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">4.17.</a>&nbsp;
Automatic Processing of Repeat Authorizations<br />
<a href="#IANA">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor26">6.</a>&nbsp;
Acknowledgments<br />
<a href="#anchor27">Appendix&nbsp;A.</a>&nbsp;
Differences from the Community Edition<br />
<a href="#history">Appendix&nbsp;B.</a>&nbsp;
Document History<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
        In the traditional client-server authentication model, the client uses its credentials to
        access its resources hosted by the server. With the increasing use of distributed web
        services and cloud computing, third-party applications require access to these
        server-hosted resources.
      
</p>
<p>
        OAuth introduces a third role to the traditional client-server authentication model: the
        resource owner. In the OAuth model, the client (which is not the resource owner, but
        is acting on its behalf) requests access to resources controlled by the resource owner, but
        hosted by the server. In addition, OAuth allows the server to verify not only the resource
        owner authorization, but also the identity of the client making the request.
      
</p>
<p>
        OAuth provides a method for clients to access server resources on behalf of a resource
        owner (such as a different client or an end-user). It also provides a process for end-users
        to authorize third party access to their server resources without sharing their credentials
        (typically, a username and password pair), using user-agent redirections.
      
</p>
<p>
        For example, a web user (resource owner) can grant a printing service (client) access to
        her private photos stored at a photo sharing service (server), without sharing her
        username and password with the printing service. Instead, she authenticates directly with
        the photo sharing service which issues the printing service delegation-specific credentials.
      
</p>
<p>
        In order for the client to access resources, it first has to obtain permission from the
        resource owner. This permission is expressed in the form of a token and matching
        shared-secret. The purpose of the token is to make it unnecessary for the resource owner to
        share its credentials with the client. Unlike the resource owner credentials, tokens can be
        issued with a restricted scope and limited lifetime, and revoked independently.
      
</p>
<p>
        This specification consists of two parts. The first part defines a redirection-based
        user-agent process for end-users to authorize client access to their resources, by
        authenticating directly with the server and provisioning tokens to the client for use with
        the authentication method. The second part defines a method for making authenticated HTTP
        <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> requests using two sets of credentials, one identifying the
        client making the request, and a second identifying the resource owner on whose behalf the
        request is being made.
      
</p>
<p>
        The use of OAuth with any other transport protocol than <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> is
        undefined.
      
</p>
<p>
        The OAuth protocol was originally created by a small community of web developers from a
        variety of websites and other Internet services, who wanted to solve the common problem of
        enabling delegated access to protected resources.  The resulting OAuth protocol was
        stabilized at version 1.0 in October 2007, and revised in June 2009 and published as
        <a class='info' href='#OAuth Core 1.0 Revision A'>[OAuth Core 1.0 Revision A]<span> (</span><span class='info'>OAuth, OAuth Community., &ldquo;OAuth Core 1.0 Revision A,&rdquo; .</span><span>)</span></a>.
      
</p>
<p>
        This specification provides an informational documentation of OAuth Core 1.0 Revision A,
        addressing several errata reported since that time, as well as numerous editorial
        clarifications.  While this specification is not an item of the IETF's OAuth Working Group,
        which at the time of writing is working on an OAuth version that can be appropriate for
        publication on the standards track, it has been transferred to the IETF for change control
        by the authors of the original work.
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>
          </p>
<blockquote class="text"><dl>
<dt>client</dt>
<dd>
              
              An HTTP client (per <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>) capable of making
              <a class='info' href='#requests'>OAuth-authenticated requests<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a>.
            
</dd>
<dt>server</dt>
<dd>
              
              An HTTP server (per <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>) capable of accepting
              <a class='info' href='#requests'>OAuth-authenticated requests<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a>.
            
</dd>
<dt>protected resource</dt>
<dd>
              
              An access-restricted resource (per <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>) which can be obtained
              from the server using an <a class='info' href='#requests'>OAuth-authenticated request<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a>.
            
</dd>
<dt>resource owner</dt>
<dd>
              
              An entity capable of accessing and controlling protected resources by using credentials
              to authenticate with the server.
            
</dd>
<dt>credentials</dt>
<dd>
              Credentials are a pair of a unique identifier and a matching shared secret. OAuth
              defines three classes of credentials: client, temporary, and token, used to identify
              and authenticate the client making the request, the authorization request, and the
              access grant, respectively.
            
</dd>
<dt>token</dt>
<dd>
              
              An unique identifier issued by the server and used by the client to associate
              authenticated requests with the resource owner whose authorization is requested or
              has been obtained by the client. Tokens have a matching shared-secret that is used
              by the client to establish its ownership of the token, and its authority to represent
              the resource owner.
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
          The original community specification used a somewhat different terminology which maps to
          this specifications as follows (original community terms provided on left):
          
          </p>
<blockquote class="text"><dl>
<dt>Consumer:</dt>
<dd>client
</dd>
<dt>Service Provider:</dt>
<dd>server
</dd>
<dt>User:</dt>
<dd>resource owner
</dd>
<dt>Consumer Key and Secret:</dt>
<dd>client credentials
</dd>
<dt>Request Token and Secret:</dt>
<dd>temporary credentials
</dd>
<dt>Access Token and Secret:</dt>
<dd>token credentials
</dd>
</dl></blockquote><p>
        
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Example</h3>

<p>
          Jane (resource owner) has recently uploaded some private vacation photos (protected
          resources) to her photo sharing site 'photos.example.net' (server). She would like to use
          the 'printer.example.com' website (client) to print one of these photos. Typically, Jane
          signs-into 'photos.example.net' using her username and password.
        
</p>
<p>
          However, Jane does not wish to share her username and password with the 'printer.example.com'
          website, which needs to access the photo in order to print it. In order to provide its
          users with better service, 'printer.example.com' has signed-up for a set of 'photos.example.net'
          client credentials ahead of time:

          </p>
<blockquote class="text"><dl>
<dt>Client Identifier</dt>
<dd>
              
              dpf43f3p2l4k3l03
            
</dd>
<dt>Client Shared-Secret:</dt>
<dd>
              
              kd94hf93k423kf44
            
</dd>
</dl></blockquote><p>

          The 'printer.example.com' website has also configured its application to use the protocol
          endpoints listed in the 'photos.example.net' API documentation, which use the
          <tt>HMAC-SHA1</tt> signature method:

          </p>
<blockquote class="text"><dl>
<dt>Temporary Credential Request</dt>
<dd>
              
              https://photos.example.net/initiate
            
</dd>
<dt>Resource Owner Authorization URI:</dt>
<dd>
              
              https://photos.example.net/authorize
            
</dd>
<dt>Token Request URI:</dt>
<dd>
              
              https://photos.example.net/token
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
          Before 'printer.example.com' can ask Jane to grant it access to the photos, it must
          first establish a set of temporary credentials with 'photos.example.net' to identify
          the delegation request. To do so, the client sends the following HTTPS
          <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> request to the server:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /initiate HTTP/1.1
  Host: photos.example.net
  Authorization: OAuth realm="http://photos.example.net/",
     oauth_consumer_key="dpf43f3p2l4k3l03",
     oauth_signature_method="HMAC-SHA1",
     oauth_timestamp="137131200",
     oauth_nonce="wIjqoS",
     oauth_callback="http%3A%2F%2Fprinter.example.com%2Fready",
     oauth_signature="74KNZJeDHnMBp0EMJ9ZHt%2FXKycU%3D"

</pre></div>
<p>
          The server validates the request and replies with a set of temporary credentials in the
          body of the HTTP response (line breaks are for display purposes only):
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  oauth_token=hh5s93j4hdidpola&amp;oauth_token_secret=hdhd0244k9j7ao03&amp;
  oauth_callback_confirmed=true

</pre></div>
<p>
          The client redirects Jane's user-agent to the server's Resource Owner Authorization
          endpoint to obtain Jane's approval for accessing her private photos:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  https://photos.example.net/authorize?oauth_token=hh5s93j4hdidpola

</pre></div>
<p>
          The server requests Jane to sign-in using her username and password and if successful,
          asks her to approve granting 'printer.example.com' access to her private photos. Jane
          approves the request and her user-agent is redirected to the callback URI provided by
          the client in the previous request (line breaks are for display purposes only):
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  http://printer.example.com/ready?
  oauth_token=hh5s93j4hdidpola&amp;oauth_verifier=hfdp7dh39dks9884

</pre></div>
<p>
          The callback request informs the client that Jane completed the authorization process.
          The client then requests a set of token credentials using its temporary credentials
          (over a secure TLS channel):
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /token HTTP/1.1
  Host: photos.example.net
  Authorization: OAuth realm="http://photos.example.net/",
     oauth_consumer_key="dpf43f3p2l4k3l03",
     oauth_token="hh5s93j4hdidpola",
     oauth_signature_method="HMAC-SHA1",
     oauth_timestamp="137131201",
     oauth_nonce="walatlh",
     oauth_verifier="hfdp7dh39dks9884"
     oauth_signature="gKgrFCywp7rO0OXSjdot%2FIHF7IU%3D"

</pre></div>
<p>
          The server validates the request and replies with a set of token credentials in the body
          of the HTTP response:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  oauth_token=nnch734d00sl2jdk&amp;oauth_token_secret=pfkkdhi9sl3r4s00

</pre></div>
<p>
          With a set of token credentials, the client is now ready to request the private photo:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /photos?file=vacation.jpg&amp;size=original HTTP/1.1
  Host: photos.example.net
  Authorization: OAuth realm="http://photos.example.net/",
     oauth_consumer_key="dpf43f3p2l4k3l03",
     oauth_token="nnch734d00sl2jdk",
     oauth_signature_method="HMAC-SHA1",
     oauth_timestamp="137131202",
     oauth_nonce="chapoH",
     oauth_signature="MdpQcU8iPSUjWoN%2FUDMsK2sui9I%3D"

</pre></div>
<p>
          The 'photos.example.net' sever validates the request and responds with the requested
          photo. 'printer.example.com' is able to continue accessing Jane's private photos using
          the same set of token credentials for the duration of Jane's authorization, or until
          Jane revokes access.
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Notational Conventions</h3>

<p>
          The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT",
          "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in
          <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
        
</p>
<a name="redirect_workflow"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Redirection-Based Authorization</h3>

<p>
        OAuth uses tokens to represent the authorization granted to the client by the resource
        owner. Typically, token credentials are issued by the server at the resource owner's
        request, after authenticating the resource owner's identity (usually using a username and
        password).
      
</p>
<p>
        There are many ways in which a server can facilitate the provisioning of token credentials.
        This section defines one such way, using HTTP redirections and the resource owner's
        user-agent. This redirection-based authorization method includes three steps:

        </p>
<ol class="text">
<li>
            The client obtains a set of temporary credentials from the server (in the form of an
            identifier and shared-secret). The temporary credentials are used to identify the
            access request throughout the authorization process.
          
</li>
<li>
            The resource owner authorizes the server to grant the client's access request
            (identified by the temporary credentials).
          
</li>
<li>
            The client uses the temporary credentials to request a set of token credentials from
            the server, which will enable it to access the resource owner's protected resources.
          
</li>
</ol><p>
      
</p>
<p>
        The server MUST revoke the temporary credentials after being used once to obtain the token
        credentials. It is RECOMMENDED that the temporary credentials have a limited lifetime.
        Servers SHOULD enable resource owners to revoke token credentials after they have been
        issued to clients.
      
</p>
<p>
        In order for the client to perform these steps, the server needs to advertise the URIs of
        the following three endpoints:

        </p>
<blockquote class="text"><dl>
<dt>Temporary Credential Request</dt>
<dd>
            
            The endpoint used by the client to obtain a set of temporary credentials as described
            in <a class='info' href='#auth_step1'>Section&nbsp;2.1<span> (</span><span class='info'>Temporary Credentials</span><span>)</span></a>.
          
</dd>
<dt>Resource Owner Authorization</dt>
<dd>
            
            The endpoint to which the resource owner is redirected to grant authorization as
            described in <a class='info' href='#auth_step2'>Section&nbsp;2.2<span> (</span><span class='info'>Resource Owner Authorization</span><span>)</span></a>.
          
</dd>
<dt>Token Request</dt>
<dd>
            
            The endpoint used by the client to request a set of token credentials using the
            set of temporary credentials as described in <a class='info' href='#auth_step3'>Section&nbsp;2.3<span> (</span><span class='info'>Token Credentials</span><span>)</span></a>.
          
</dd>
</dl></blockquote><p>
      
</p>
<p>
        The three URIs advertised by the server MAY include a query component as defined by
        <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> section 3, but if present, the query MUST NOT contain any
        parameters beginning with the <tt>oauth_</tt> prefix, to avoid conflicts
        with the protocol parameters added to the URIs when used.
      
</p>
<p>
        The methods in which the server advertises and documents its three endpoints are beyond the
        scope of this specification. Clients should avoid making assumptions about the size of
        tokens and other server-generated values, which are left undefined by this specification.
        In addition, protocol parameters MAY include values which require encoding when
        transmitted. Clients and servers should not make assumptions about the possible range of
        their values.
      
</p>
<a name="auth_step1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Temporary Credentials</h3>

<p>
          The client obtains a set of temporary credentials from the server by making an
          <a class='info' href='#requests'>authenticated<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a> HTTP <tt>POST</tt>
          request to the Temporary Credential Request endpoint (unless the server advertises
          another HTTP request method for the client to use). The client constructs a request URI
          by adding the following REQUIRED parameter to the request (in addition to the other
          protocol parameters, using the same parameter transmission method):

          </p>
<blockquote class="text"><dl>
<dt>oauth_callback:</dt>
<dd>
              An absolute URI to which the server will redirect the resource owner back when the
              Resource Owner Authorization step (<a class='info' href='#auth_step2'>Section&nbsp;2.2<span> (</span><span class='info'>Resource Owner Authorization</span><span>)</span></a>) is completed. If the
              client is unable to receive callbacks or a callback URI has been established via other
              means, the parameter value MUST be set to <tt>oob</tt> (case sensitive),
              to indicate an out-of-band configuration.
            
</dd>
<dt>Servers MAY specify additional parameters.</dt>
<dd>
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
          When making the request, the client authenticates using only the client credentials. The
          client MAY omit the empty <tt>oauth_token</tt> protocol parameter
          from the request and MUST use the empty string as the token secret value.
        
</p>
<p>
          Since the request results in the transmission of plain text credentials in the HTTP
          response, the server SHOULD require the use of a transport-layer mechanisms such as TLS
          or SSL. This is true regardless of the signature method used by the client.
        
</p>
<p>
            For example, the client makes the following HTTPS request:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /request_temp_credentials HTTP/1.1
  Host: server.example.com
  Authorization: OAuth realm="http://server.example.com/",
     oauth_consumer_key="jd83jd92dhsh93js",
     oauth_signature_method="PLAINTEXT",
     oauth_callback="http%3A%2F%2Fclient.example.net%2Fcb%3Fx%3D1",
     oauth_signature="ja893SD9%26"

</pre></div>
<p>
          The server MUST <a class='info' href='#verify_request'>verify<span> (</span><span class='info'>Verifying Requests</span><span>)</span></a> the request and if valid,
          respond back to the client with a set of temporary credentials (in the form of an
          identifier and shared-secret). The temporary credentials are included in the HTTP
          response body using the <tt>application/x-www-form-urlencoded</tt>
          content type as defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
        
</p>
<p>
          The response contains the following REQUIRED parameters:

          </p>
<blockquote class="text"><dl>
<dt>oauth_token</dt>
<dd>
              
              The temporary credentials identifier.
            
</dd>
<dt>oauth_token_secret</dt>
<dd>
              
              The temporary credentials shared-secret.
            
</dd>
<dt>oauth_callback_confirmed:</dt>
<dd>
              MUST be present and set to <tt>true</tt>. The parameter is used
              to differentiate from previous versions of the protocol.
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
          Note that even though the parameter names include the term 'token', these credentials are
          not token credentials, but are used in the next two steps in a similar manner to token
          credentials.
        
</p>
<p>
            For example (line breaks are for display purposes only):
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  oauth_token=hdk48Djdsa&amp;oauth_token_secret=xyz4992k83j47x0b&amp;
  oauth_callback_confirmed=true

</pre></div>
<a name="auth_step2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Resource Owner Authorization</h3>

<p>
          Before the client requests a set of token credentials from the server, it MUST send
          the user to the server to authorize the request. The client constructs a request URI by
          adding the following REQUIRED query parameter to the Resource Owner Authorization
          endpoint URI:

          </p>
<blockquote class="text"><dl>
<dt>oauth_token</dt>
<dd>
              
              The temporary credentials identifier obtained in <a class='info' href='#auth_step1'>Section&nbsp;2.1<span> (</span><span class='info'>Temporary Credentials</span><span>)</span></a>
              in the <tt>oauth_token</tt> parameter. Servers MAY declare this
              parameter as OPTIONAL, in which case they MUST provide a way for the resource owner
              to indicate the identifier through other means.
            
</dd>
<dt>Servers MAY specify additional parameters.</dt>
<dd>
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
          The client directs the resource owner to the constructed URI using an HTTP redirection
          response, or by other means available to it via the resource owner's user-agent. The
          request MUST use the HTTP <tt>GET</tt> method.
        
</p>
<p>
            For example, the client redirects the resource owner's user-agent to make the following
            HTTPS request:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /authorize_access?oauth_token=hdk48Djdsa HTTP/1.1
  Host: server.example.com

</pre></div>
<p>
          The way in which the server handles the authorization request, including whether it uses
          a secure channel such as TLS/SSL is beyond the scope of this specification. However, the
          server MUST first verify the identity of the resource owner.
        
</p>
<p>
          When asking the resource owner to authorize the requested access, the server SHOULD
          present to the resource owner information about the client requesting access based on the
          association of the temporary credentials with the client identity. When displaying any
          such information, the server SHOULD indicate if the information has been verified.
        
</p>
<p>
          After receiving an authorization decision from the resource owner, the server redirects
          the resource owner to the callback URI if one was provided in the
          <tt>oauth_callback</tt> parameter or by other means.
        
</p>
<p>
          To make sure that the resource owner granting access is the same resource owner returning
          back to the client to complete the process, the server MUST generate a verification code:
          an unguessable value passed to the client via the resource owner and REQUIRED to complete
          the process. The server constructs the request URI by adding the following REQUIRED
          parameters to the callback URI query component:

          </p>
<blockquote class="text"><dl>
<dt>oauth_token</dt>
<dd>
              
              The temporary credentials identifier received from the client.
            
</dd>
<dt>oauth_verifier</dt>
<dd>
              
              The verification code.
            
</dd>
</dl></blockquote><p>

          If the callback URI already includes a query component, the server MUST append the
          OAuth parameters to the end of the existing query.
        
</p>
<p>
            For example, the server redirects the resource owner's user-agent to make the following
            HTTP request:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /cb?x=1&amp;oauth_token=hdk48Djdsa&amp;oauth_verifier=473f82d3 HTTP/1.1
  Host: client.example.net

</pre></div>
<p>
          If the client did not provide a callback URI, the server SHOULD display the value of the
          verification code, and instruct the resource owner to manually inform the client that
          authorization is completed. If the server knows a client to be running on a limited device
          it SHOULD ensure that the verifier value is suitable for manual entry.
        
</p>
<a name="auth_step3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Token Credentials</h3>

<p>
          The client obtains a set of token credentials from the server by making an
          <a class='info' href='#requests'>authenticated<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a> HTTP <tt>POST</tt>
          request to the Token Request endpoint (unless the server advertises another HTTP
          request method for the client to use). The client constructs a request URI by adding the
          following REQUIRED parameter to the request (in addition to the other protocol
          parameters, using the same parameter transmission method):

          </p>
<blockquote class="text"><dl>
<dt>oauth_verifier</dt>
<dd>
              
              The verification code received from the server in the previous step.
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
          When making the request, the client authenticates using the client credentials as well as
          the temporary credentials. The temporary credentials are used as a substitute for token
          credentials in the authenticated request and transmitted using the
          <tt>oauth_token</tt> parameter.
        
</p>
<p>
          Since the request results in the transmission of plain text credentials in the HTTP
          response, the server SHOULD require the use of a transport-layer mechanisms such as TLS
          or SSL. This is true regardless of the signature method used by the client.
        
</p>
<p>
            For example, the client makes the following HTTPS request:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  POST /request_token HTTP/1.1
  Host: server.example.com
  Authorization: OAuth realm="http://server.example.com/",
     oauth_consumer_key="jd83jd92dhsh93js",
     oauth_signature_method="PLAINTEXT",
     oauth_verifier="473f82d3",
     oauth_signature="ja893SD9%26xyz4992k83j47x0b"

</pre></div>
<p>
          The server MUST <a class='info' href='#verify_request'>verify<span> (</span><span class='info'>Verifying Requests</span><span>)</span></a> the validity of the request,
          ensure that the resource owner has authorized the provisioning of token credentials to
          the client, and ensure that the temporary credentials have not expired or been used
          before. The server MUST also verify the verification code received from the client. If
          the request is valid and authorized, the token credentials are included in the HTTP
          response body using the <tt>application/x-www-form-urlencoded</tt>
          content type as defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
        
</p>
<p>
          The response contains the following REQUIRED parameters:

          </p>
<blockquote class="text"><dl>
<dt>oauth_token</dt>
<dd>
              
              The token identifier.
            
</dd>
<dt>oauth_token_secret</dt>
<dd>
              
              The token shared-secret.
            
</dd>
</dl></blockquote><p>
        
</p>
<p>
            For example:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  HTTP/1.1 200 OK
  Content-Type: application/x-www-form-urlencoded

  oauth_token=j49ddk933skd9dks&amp;oauth_token_secret=ll399dj47dskfjdk

</pre></div>
<p>
          The server must retain the scope, duration, and other attributes approved by the resource
          owner, and enforce these restrictions when receiving a client request made with the token
          credentials issued.
        
</p>
<p>
          Once the client receives and stores the token credentials, it can proceed to access
          protected resources on behalf of the resource owner by making
          <a class='info' href='#requests'>authenticated request<span> (</span><span class='info'>Authenticated Requests</span><span>)</span></a> using the client credentials
          together with the token credentials received.
        
</p>
<a name="requests"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Authenticated Requests</h3>

<p>
        The HTTP authentication methods defined by <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>, enable clients
        to make authenticated HTTP requests. Clients using these methods gain access to protected
        resources by using their credentials (typically a username and password pair), which
        allow the server to verify their authenticity. Using these methods for delegation requires
        the client to assume the role of the resource owner.
      
</p>
<p>
        OAuth provides a method designed to include two sets of credentials with each request, one
        to identify the client, and another to identify the resource owner. Before a client can
        make authenticated requests on behalf of the resource owner, it must obtain a token
        authorized by the resource owner. <a class='info' href='#redirect_workflow'>Section&nbsp;2<span> (</span><span class='info'>Redirection-Based Authorization</span><span>)</span></a> provides one such
        method through which the client can obtain a token authorized by the resource owner.
      
</p>
<p>
        The client credentials take the form of a unique identifier, and an associated shared-secret
        or RSA key pair. Prior to making authenticated requests, the client establishes a set of
        credentials with the server. The process and requirements for provisioning these are
        outside the scope of this specification. Implementers are urged to consider the security
        ramifications of using client credentials, some of which are described in
        <a class='info' href='#client_cred_sec'>Section&nbsp;4.8<span> (</span><span class='info'>Secrecy of the Client Credentials</span><span>)</span></a>.
      
</p>
<p>
        Making authenticated requests requires prior knowledge of the server's configuration.
        OAuth includes multiple methods for transmitting protocol parameters with requests
				(<a class='info' href='#param_include'>Section&nbsp;3.5<span> (</span><span class='info'>Parameter Transmission</span><span>)</span></a>), as well as multiple methods for the client to
        prove its rightful ownership of the credentials used (<a class='info' href='#signature'>Section&nbsp;3.4<span> (</span><span class='info'>Signature</span><span>)</span></a>).
        The way in which clients discover the required configuration is outside the scope of
        this specification.
      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Making Requests</h3>

<p>
          An authenticated request includes several protocol parameters. Each parameter name
          begins with the <tt>oauth_</tt> prefix, and the parameter names and
          values are case sensitive. Clients make authenticated requests by calculating the values
          of a set of protocol parameters and adding them to the HTTP request as follows:

          </p>
<ol class="text">
<li>
              The client assigns value to each of these REQUIRED (unless specified otherwise)
              protocol parameters:

              
<blockquote class="text"><dl>
<dt>oauth_consumer_key</dt>
<dd>
                  
                  The identifier portion of the client credentials (equivalent to a username). The
                  parameter name reflects a deprecated term (Consumer Key) used in previous
                  revisions of the specification, and has been retained to maintain backward
                  compatibility.
                
</dd>
<dt>oauth_token</dt>
<dd>
                  
                  The token value used to associate the request with the resource owner. If the
                  request is not associated with a resource owner (no token available), clients
                  MAY omit the parameter.
                
</dd>
<dt>oauth_signature_method</dt>
<dd>
                  
                  The name of the signature method used by the client to sign the request,
                  as defined in <a class='info' href='#signature'>Section&nbsp;3.4<span> (</span><span class='info'>Signature</span><span>)</span></a>.
                
</dd>
<dt>oauth_timestamp</dt>
<dd>
                  
                  The timestamp value as defined in <a class='info' href='#nonce'>Section&nbsp;3.3<span> (</span><span class='info'>Nonce and Timestamp</span><span>)</span></a>. The parameter MAY
                  be omitted when using the <tt>PLAINTEXT</tt> signature method.
                
</dd>
<dt>oauth_nonce</dt>
<dd>
                  
                  The nonce value as defined in <a class='info' href='#nonce'>Section&nbsp;3.3<span> (</span><span class='info'>Nonce and Timestamp</span><span>)</span></a>. The parameter MAY be
                  omitted when using the <tt>PLAINTEXT</tt> signature method.
                
</dd>
<dt>oauth_version</dt>
<dd>
                  
                  OPTIONAL. If present, MUST be set to <tt>1.0</tt>. Provides
                  the version of the authentication process as defined in this specification.
                
</dd>
</dl></blockquote>
            
</li>
<li>
              The protocol parameters are added to the request using one of the transmission
              methods listed in <a class='info' href='#param_include'>Section&nbsp;3.5<span> (</span><span class='info'>Parameter Transmission</span><span>)</span></a>. Each parameter MUST NOT appear
              more than once per request.
            
</li>
<li>
              The client calculates and assigns the value of the <tt>oauth_signature</tt>
              parameter as described in <a class='info' href='#signature'>Section&nbsp;3.4<span> (</span><span class='info'>Signature</span><span>)</span></a> and adds the parameter to the
              request using the same method used in the previous step.
            
</li>
<li>
              The client sends the authenticated HTTP request to the server.
            
</li>
</ol><p>
        
</p>
<p>
            For example, to make the following HTTP request authenticated (the
            <tt>c2&amp;a3=2+q</tt> string in the following examples is used to
            illustrate the impact of a form-encoded entity-body) :
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /request?b5=%3D%253D&amp;a3=a&amp;c%40=&amp;a2=r%20b HTTP/1.1
  Host: example.com
  Content-Type: application/x-www-form-urlencoded

  c2&amp;a3=2+q

</pre></div>
<p>
            The client assigns values to the following protocol parameters using its client
            credentials, token credentials, the current timestamp, a uniquely generated nonce, and
            indicates it will use the <tt>HMAC-SHA1</tt> signature method:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  oauth_consumer_key:     9djdj82h48djs9d2
  oauth_token:            kkk9d7dh3k39sjv7
  oauth_signature_method: HMAC-SHA1
  oauth_timestamp:        137131201
  oauth_nonce:            7d8f3e4a

</pre></div>
<p>
            The client adds the protocol parameter to the request using the OAuth HTTP
            Authorization header field:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Authorization: OAuth realm="http://example.com/",
                 oauth_consumer_key="9djdj82h48djs9d2",
                 oauth_token="kkk9d7dh3k39sjv7",
                 oauth_signature_method="HMAC-SHA1",
                 oauth_timestamp="137131201",
                 oauth_nonce="7d8f3e4a"

</pre></div>
<p>
            Then calculates the value of the <tt>oauth_signature</tt> parameter,
            adds it to the request, and sends the HTTP request to the server:
          
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /request?b5=%3D%253D&amp;a3=a&amp;c%40=&amp;a2=r%20b HTTP/1.1
  Host: example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: OAuth realm="http://example.com/",
                 oauth_consumer_key="9djdj82h48djs9d2",
                 oauth_token="kkk9d7dh3k39sjv7",
                 oauth_signature_method="HMAC-SHA1",
                 oauth_timestamp="137131201",
                 oauth_nonce="7d8f3e4a",
                 oauth_signature="djosJKDKJSD8743243%2Fjdk33klY%3D"

  c2&amp;a3=2+q

</pre></div>
<a name="verify_request"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Verifying Requests</h3>

<p>
          Servers receiving an authenticated request MUST validate it by:

          </p>
<ul class="text">
<li>
              Recalculate the request signature independently as described in
              <a class='info' href='#signature'>Section&nbsp;3.4<span> (</span><span class='info'>Signature</span><span>)</span></a> and compare it to the value received from the client via
              the <tt>oauth_signature</tt> parameter.
            
</li>
<li>
              If using the <tt>HMAC-SHA1</tt> or
              <tt>RSA-SHA1</tt> signature methods, ensure that the combination
              of nonce/timestamp/token (if present) received from the client has not been used
              before in a previous request (the server MAY reject requests with stale timestamps as
              described in <a class='info' href='#nonce'>Section&nbsp;3.3<span> (</span><span class='info'>Nonce and Timestamp</span><span>)</span></a>).
            
</li>
<li>
              If a token is present, verify the scope and status of the client authorization as
              represented by the token (the server MAY choose to restrict token usage to the client
              to which it was issued).
            
</li>
<li>
              If the <tt>oauth_version</tt> parameter is present, ensure its
              value is <tt>1.0</tt>.
            
</li>
</ul><p>
        
</p>
<p>
          If the request fails verification, the server SHOULD respond with the appropriate HTTP
          response status code. The server MAY include further details about why the request was
          rejected in the response body.
        
</p>
<p>
          The server SHOULD return a 400 (bad request) status code
          when receiving a request with unsupported parameters, unsupported signature method,
          missing parameters, or duplicated protocol parameters. The server SHOULD return a 401
          (unauthorized) status code when receiving a request with invalid client credentials,
          invalid or expired token, invalid signature, or invalid or used nonce.
        
</p>
<a name="nonce"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Nonce and Timestamp</h3>

<p>
          The timestamp value MUST be a positive integer. Unless otherwise specified by the
          server's documentation, the timestamp is expressed in the number of seconds since
          January 1, 1970 00:00:00 GMT.
        
</p>
<p>
          A nonce is a random string, uniquely generated by the client to allow the server to
          verify that a request has never been made before and helps prevent replay attacks when
          requests are made over a non-secure channel. The nonce value MUST be unique across all
          requests with the same timestamp, client credentials, and token combinations.
        
</p>
<p>
          To avoid the need to retain an infinite number of nonce values for future checks, servers
          MAY choose to restrict the time period after which a request with an old timestamp is
          rejected. Note that this restriction implies a level of synchronization between the
          client's and server's clocks. Servers applying such a restriction MAY provide a way for
          the client to sync with the server's clock; alternatively both systems could synchronize
          with a trusted time service. Details of clock synchronization strategies are beyond the
          scope of this specification.
        
</p>
<a name="signature"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Signature</h3>

<p>
					OAuth-authenticated requests can have two sets of credentials: those passed via the
					<tt>oauth_consumer_key</tt> parameter and those in the
					<tt>oauth_token</tt> parameter. In order for the server to
          verify the authenticity of the request and prevent unauthorized access, the client needs
          to prove that it is the rightful owner of the credentials. This is accomplished using the
          shared-secret (or RSA key) part of each set of credentials.
        
</p>
<p>
          OAuth provides three methods for the client to prove its rightful ownership of the
          credentials: <tt>HMAC-SHA1</tt>, <tt>RSA-SHA1</tt>,
          and <tt>PLAINTEXT</tt>. These methods are generally referred to as
          signature methods, even though <tt>PLAINTEXT</tt> does not involve a
          signature. In addition, <tt>RSA-SHA1</tt> utilizes an RSA key instead
          of the shared-secrets associated with the client credentials.
        
</p>
<p>
          OAuth does not mandate a particular signature method, as each implementation can have its
          own unique requirements. Servers are free to implement and document their own custom
          methods. Recommending any particular method is beyond the scope of this specification.
          Implementers should review the <a class='info' href='#Security'>Security Considerations section<span> (</span><span class='info'>Security Considerations</span><span>)</span></a>
          before deciding on which method to support.
        
</p>
<p>
          The client declares which signature method is used via the
          <tt>oauth_signature_method</tt> parameter. It then generates a signature
          (or a string of an equivalent value), and includes it in the
          <tt>oauth_signature</tt> parameter. The server verifies the signature
          as specified for each method.
        
</p>
<p>
          The signature process does not change the request or its parameters, with the exception of
          the <tt>oauth_signature</tt> parameter.
        
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Signature Base String</h3>

<p>
            The signature base string is a consistent, reproducible concatenation of several
            of the HTTP request elements into a single string. The string is used as an input to
            the <tt>HMAC-SHA1</tt> and <tt>RSA-SHA1</tt>
            signature methods.
          
</p>
<p>
            The signature base string includes the following components of the HTTP request:
            
            </p>
<ul class="text">
<li>
                The HTTP request method (e.g. <tt>GET</tt>,
                <tt>POST</tt>, etc.).
              
</li>
<li>
                The authority as declared by the HTTP <tt>Host</tt> request
                header field.
              
</li>
<li>
                The path and query components of the request resource URI.
              
</li>
<li>
                The protocol parameters excluding the
                <tt>oauth_signature</tt>.
              
</li>
<li>
                Parameters included in the request entity-body if they comply with the strict
                restrictions defined in <a class='info' href='#collect_param'>Section&nbsp;3.4.1.3<span> (</span><span class='info'>Request Parameters</span><span>)</span></a>.
              
</li>
</ul><p>
          
</p>
<p>
            The signature base string does not cover the entire HTTP request. Most notably, it
            does not include the entity-body in most requests, nor does it include most HTTP
            entity-headers. It is important to note that the server cannot verify the authenticity
            of the excluded request components without using additional protections such as SSL/TLS or
            other methods.
          
</p>
<a name="base_string"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.1"></a><h3>3.4.1.1.&nbsp;
String Construction</h3>

<p>
              The signature base string is constructed by concatenating together, in order, the
              following HTTP request elements:

              </p>
<ol class="text">
<li>
                  The HTTP request method in uppercase. For example: <tt>HEAD</tt>,
                  <tt>GET</tt>, <tt>POST</tt>, etc. If the
                  request uses a custom HTTP method, it MUST be <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                
</li>
<li>
                  An <tt>&amp;</tt> character (ASCII code 38).
                
</li>
<li>
                  The base string URI from <a class='info' href='#sig_uri'>Section&nbsp;3.4.1.2<span> (</span><span class='info'>Base String URI</span><span>)</span></a>, after being
                  <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                
</li>
<li>
                  An <tt>&amp;</tt> character (ASCII code 38).
                
</li>
<li>
                  The request parameters as normalized in <a class='info' href='#sig_norm_param'>Section&nbsp;3.4.1.3.2<span> (</span><span class='info'>Parameters Normalization</span><span>)</span></a>, after
                  being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                
</li>
</ol><p>
            
</p>
<p>
                For example, the HTTP request:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /request?b5=%3D%253D&amp;a3=a&amp;c%40=&amp;a2=r%20b HTTP/1.1
  Host: example.com
  Content-Type: application/x-www-form-urlencoded
  Authorization: OAuth realm="http://example.com/",
                 oauth_consumer_key="9djdj82h48djs9d2",
                 oauth_token="kkk9d7dh3k39sjv7",
                 oauth_signature_method="HMAC-SHA1",
                 oauth_timestamp="137131201",
                 oauth_nonce="7d8f3e4a",
                 oauth_signature="djosJKDKJSD8743243%2Fjdk33klY%3D"

  c2&amp;a3=2+q

</pre></div>
<p>
                Is represented by the following signature base string (line breaks are for display
                purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET&amp;http%3A%2F%2Fexample.com%2Frequest&amp;a2%3Dr%2520b%26a3%3D2%2520q%
  26a3%3Da%26b5%3D%253D%25253D%26c%2540%3D%26c2%3D%26oauth_consumer_k
  ey%3D9djdj82h48djs9d2%26oauth_nonce%3D7d8f3e4a%26oauth_signature_me
  thod%3DHMAC-SHA1%26oauth_timestamp%3D137131201%26oauth_token%3Dkkk9
  d7dh3k39sjv7

</pre></div>
<a name="sig_uri"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.2"></a><h3>3.4.1.2.&nbsp;
Base String URI</h3>

<p>
              The scheme, authority, and path of the request resource URI <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>
              are included by constructing an <tt>http</tt> or
              <tt>https</tt> URI representing the request resource (without the
              query or fragment) as follows:

              </p>
<ol class="text">
<li>
                  The scheme and host MUST be in lowercase.
                
</li>
<li>
                  The host and port values MUST match the content of the HTTP request
                  <tt>Host</tt> header field.
                
</li>
<li>
                  The port MUST be included if it is not the default port for the scheme, and MUST
                  be excluded if it is the default. Specifically, the port MUST be excluded when
                  making an HTTP request <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> to port 80 or when making an
                  HTTPS request <a class='info' href='#RFC2818'>[RFC2818]<span> (</span><span class='info'>Rescorla, E., &ldquo;HTTP Over TLS,&rdquo; May&nbsp;2000.</span><span>)</span></a> to port 443. All other non-default port
                  numbers MUST be included.
                
</li>
</ol><p>
            
</p>
<p>
                For example, the HTTP request:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /r%20v/X?id=123 HTTP/1.1
  Host: EXAMPLE.COM:80

</pre></div>
<p>
                is represented by the base string URI:
                <tt>http://example.com/r%20v/X</tt>.
              
</p>
<p>
                In another example, the HTTPS request:
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /?q=1 HTTP/1.1
  Host: www.example.net:8080

</pre></div>
<p>
                is represented by the base string URI:
                <tt>https://www.example.net:8080/</tt>.
              
</p>
<a name="collect_param"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.3"></a><h3>3.4.1.3.&nbsp;
Request Parameters</h3>

<p>
              In order to guarantee a consistent and reproducible representation of the request
              parameters, the parameters are collected and decoded to their original decoded form.
              They are then sorted and encoded in a particular manner which is often different from
              their original encoding scheme, and concatenated into a single string.
            
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.3.1"></a><h3>3.4.1.3.1.&nbsp;
Parameter Sources</h3>

<p>
                The parameters from the following sources are collected into a single list of
                name/value pairs:

                </p>
<ul class="text">
<li>
                    The query component of the HTTP request URI as defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>
                    section 3.4. The query component is parsed into a list of name/value pairs by
                    treating it as an <tt>application/x-www-form-urlencoded</tt>
                    string, separating the names and values and decoding them as defined by
                    <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> section 17.13.4.
                  
</li>
<li>
                    The OAuth HTTP Authorization header field (<a class='info' href='#auth_header'>Section&nbsp;3.5.1<span> (</span><span class='info'>Authorization Header</span><span>)</span></a>) if
                    present. The header's content is parsed into a list of name/value pairs
                    excluding the <tt>realm</tt> parameter if present. The
                    parameter values are decoded as defined by <a class='info' href='#auth_header'>Section&nbsp;3.5.1<span> (</span><span class='info'>Authorization Header</span><span>)</span></a>.
                  
</li>
<li>
                    The HTTP request entity-body, but only if all of the following conditions are met:

                    
<ul class="text">
<li>
                        The entity-body is single-part.
                      
</li>
<li>
                        The entity-body follows the encoding requirements of the
                        <tt>application/x-www-form-urlencoded</tt> content-type as
                        defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
                      
</li>
<li>
                        The HTTP request entity-header includes the <tt>Content-Type</tt>
                        header field set to <tt>application/x-www-form-urlencoded</tt>.
                      
</li>
</ul>

                    The entity-body is parsed into a list of decoded name/value pairs as described in
                    <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a> section 17.13.4.
                  
</li>
</ul><p>
              
</p>
<p>
                The <tt>oauth_signature</tt> parameter MUST be excluded from the
                signature base string if present. Parameters not explicitly included in the request
                MUST be excluded from the signature base string (e.g. the
                <tt>oauth_version</tt> parameter when omitted).
              
</p>
<p>
                  For example, the HTTP request:
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    GET /request?b5=%3D%253D&amp;a3=a&amp;c%40=&amp;a2=r%20b HTTP/1.1
    Host: example.com
    Content-Type: application/x-www-form-urlencoded
    Authorization: OAuth realm="http://example.com/",
                   oauth_consumer_key="9djdj82h48djs9d2",
                   oauth_token="kkk9d7dh3k39sjv7",
                   oauth_signature_method="HMAC-SHA1",
                   oauth_timestamp="137131201",
                   oauth_nonce="7d8f3e4a",
                   oauth_signature="djosJKDKJSD8743243%2Fjdk33klY%3D"

    c2&amp;a3=2+q

</pre></div>
<p>
                  Contains the following (fully decoded) parameters used in the signature base
                  sting:
                
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Value</th></tr>
<tr>
<td align="center">b5</td>
<td align="center">=%3D</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">a</td>
</tr>
<tr>
<td align="center">c@</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">a2</td>
<td align="center">r b</td>
</tr>
<tr>
<td align="center">oauth_consumer_key</td>
<td align="center">9djdj82h48djs9d2</td>
</tr>
<tr>
<td align="center">oauth_token</td>
<td align="center">kkk9d7dh3k39sjv7</td>
</tr>
<tr>
<td align="center">oauth_signature_method</td>
<td align="center">HMAC-SHA1</td>
</tr>
<tr>
<td align="center">oauth_timestamp</td>
<td align="center">137131201</td>
</tr>
<tr>
<td align="center">oauth_nonce</td>
<td align="center">7d8f3e4a</td>
</tr>
<tr>
<td align="center">c2</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">2 q</td>
</tr>
</table>
<br clear="all" />

<p>
                Note that the value of <tt>b5</tt> is <tt>=%3D</tt>
                and not <tt>==</tt>. Both <tt>c@</tt> and
                <tt>c2</tt> have empty values. While the encoding rules
                specified in this specification for the purpose of constructing the signature base
                string exclude the use of a <tt>+</tt> character (ASCII code 43)
                to represent an encoded space character (ASCII code 32), this practice is widely
                used in <tt>application/x-www-form-urlencoded</tt> encoded
                values, and MUST be properly decoded, as demonstrated by one of the
                <tt>a3</tt> parameter instances (the <tt>a3</tt>
                parameter is used twice in this request).
              
</p>
<a name="sig_norm_param"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1.3.2"></a><h3>3.4.1.3.2.&nbsp;
Parameters Normalization</h3>

<p>
                The parameters collected in <a class='info' href='#collect_param'>Section&nbsp;3.4.1.3<span> (</span><span class='info'>Request Parameters</span><span>)</span></a> are normalized into a
                single string as follows:

                </p>
<ol class="text">
<li>
                    First, the name and value of each parameter are <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
    							
</li>
<li>
                    The parameters are sorted by name, using ascending byte value ordering. If
                    two or more parameters share the same name, they are sorted by their value.
                  
</li>
<li>
                    The name of each parameter is concatenated to its corresponding value using an
                    <tt>=</tt> character (ASCII code 61) as separator, even if the
                    value is empty.
                  
</li>
<li>
                    The sorted name/value pairs are concatenated together into a single string by
                    using an <tt>&amp;</tt> character (ASCII code 38) as separator.
                  
</li>
</ol><p>
              
</p>
<p>
                For example, the list of parameters from the previous section would be normalized as
                follows:
              
</p>
<p style='text-align: center'>
                  Encoded:
                
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Value</th></tr>
<tr>
<td align="center">b5</td>
<td align="center">%3D%253D</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">a</td>
</tr>
<tr>
<td align="center">c%40</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">a2</td>
<td align="center">r%20b</td>
</tr>
<tr>
<td align="center">oauth_consumer_key</td>
<td align="center">9djdj82h48djs9d2</td>
</tr>
<tr>
<td align="center">oauth_token</td>
<td align="center">kkk9d7dh3k39sjv7</td>
</tr>
<tr>
<td align="center">oauth_signature_method</td>
<td align="center">HMAC-SHA1</td>
</tr>
<tr>
<td align="center">oauth_timestamp</td>
<td align="center">137131201</td>
</tr>
<tr>
<td align="center">oauth_nonce</td>
<td align="center">7d8f3e4a</td>
</tr>
<tr>
<td align="center">c2</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">2%20q</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>
                  Sorted:
                
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center"><col align="center">
<tr><th align="center">Name</th><th align="center">Value</th></tr>
<tr>
<td align="center">a2</td>
<td align="center">r%20b</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">2%20q</td>
</tr>
<tr>
<td align="center">a3</td>
<td align="center">a</td>
</tr>
<tr>
<td align="center">b5</td>
<td align="center">%3D%253D</td>
</tr>
<tr>
<td align="center">c%40</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">c2</td>
<td align="center">&nbsp;</td>
</tr>
<tr>
<td align="center">oauth_consumer_key</td>
<td align="center">9djdj82h48djs9d2</td>
</tr>
<tr>
<td align="center">oauth_nonce</td>
<td align="center">7d8f3e4a</td>
</tr>
<tr>
<td align="center">oauth_signature_method</td>
<td align="center">HMAC-SHA1</td>
</tr>
<tr>
<td align="center">oauth_timestamp</td>
<td align="center">137131201</td>
</tr>
<tr>
<td align="center">oauth_token</td>
<td align="center">kkk9d7dh3k39sjv7</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>
                  Concatenated Pairs:
                
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="center">
<tr><th align="center">Name=Value</th></tr>
<tr>
<td align="center">a2=r%20b</td>
</tr>
<tr>
<td align="center">a3=2%20q</td>
</tr>
<tr>
<td align="center">a3=a</td>
</tr>
<tr>
<td align="center">b5=%3D%253D</td>
</tr>
<tr>
<td align="center">c%40=</td>
</tr>
<tr>
<td align="center">c2=</td>
</tr>
<tr>
<td align="center">oauth_consumer_key=9djdj82h48djs9d2</td>
</tr>
<tr>
<td align="center">oauth_nonce=7d8f3e4a</td>
</tr>
<tr>
<td align="center">oauth_signature_method=HMAC-SHA1</td>
</tr>
<tr>
<td align="center">oauth_timestamp=137131201</td>
</tr>
<tr>
<td align="center">oauth_token=kkk9d7dh3k39sjv7</td>
</tr>
</table>
<br clear="all" />

<p>
                  And concatenated together into a single string (line breaks are for display
                  purposes only):
                
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  a2=r%20b&amp;a3=2%20q&amp;a3=a&amp;b5=%3D%253D&amp;c%40=&amp;c2=&amp;oauth_consumer_key=9dj
  dj82h48djs9d2&amp;oauth_nonce=7d8f3e4a&amp;oauth_signature_method=HMAC-SHA1
  &amp;oauth_timestamp=137131201&amp;oauth_token=kkk9d7dh3k39sjv7

</pre></div>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
HMAC-SHA1</h3>

<p>
            The <tt>HMAC-SHA1</tt> signature method uses the HMAC-SHA1 signature
            algorithm as defined in <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>:

            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  digest = HMAC-SHA1 (key, text)

</pre></div><p>

          
</p>
<p>
            The HMAC-SHA1 function variables are used in following way:

            </p>
<blockquote class="text"><dl>
<dt>text</dt>
<dd>
                
                is set to the value of the signature base string from <a class='info' href='#base_string'>Section&nbsp;3.4.1.1<span> (</span><span class='info'>String Construction</span><span>)</span></a>.
              
</dd>
<dt>key</dt>
<dd>
                
                is set to the concatenated values of:

                
<ol class="text">
<li>
                    The client shared-secret, after being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                  
</li>
<li>
                    An <tt>&amp;</tt> character (ASCII code 38), which MUST be
                    included even when either secret is empty.
                  
</li>
<li>
                    The token shared-secret, after being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
                  
</li>
</ol>
              
</dd>
<dt>digest</dt>
<dd>
                
                is used to set the value of the <tt>oauth_signature</tt>
                protocol parameter, after the result octet string is base64-encoded per
                <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a> section 6.8.
              
</dd>
</dl></blockquote><p>
          
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3"></a><h3>3.4.3.&nbsp;
RSA-SHA1</h3>

<p>
            The <tt>RSA-SHA1</tt> signature method uses the RSASSA-PKCS1-v1_5
            signature algorithm as defined in <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a> section 8.2 (also known as
            PKCS#1), using SHA-1 as the hash function for EMSA-PKCS1-v1_5. To use this method, the
            client MUST have established client credentials with the server which included its RSA
            public key (in a manner which is beyond the scope of this specification).
          
</p>
<p>
            The signature base string is signed using the client's RSA private key per
            <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a> section 8.2.1:

            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  S = RSASSA-PKCS1-V1_5-SIGN (K, M)

</pre></div><p>


            Where:

            </p>
<blockquote class="text"><dl>
<dt>K</dt>
<dd>
                
                is set to the client's RSA private key,
              
</dd>
<dt>M</dt>
<dd>
                
                is set to the value of the signature base string from <a class='info' href='#base_string'>Section&nbsp;3.4.1.1<span> (</span><span class='info'>String Construction</span><span>)</span></a>, and
              
</dd>
<dt>S</dt>
<dd>
                
                is the result signature used to set the value of the <tt>oauth_signature</tt>
                protocol parameter, after the result octet string is base64-encoded per <a class='info' href='#RFC2045'>[RFC2045]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a>
                section 6.8.
              
</dd>
</dl></blockquote><p>
          
</p>
<p>
            The server verifies the signature per <a class='info' href='#RFC3447'>[RFC3447]<span> (</span><span class='info'>Jonsson, J. and B. Kaliski, &ldquo;Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1,&rdquo; February&nbsp;2003.</span><span>)</span></a> section 8.2.2:

            </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  RSASSA-PKCS1-V1_5-VERIFY ((n, e), M, S)

</pre></div><p>


            Where:

            </p>
<blockquote class="text"><dl>
<dt>(n, e)</dt>
<dd>
                
                is set to the client's RSA public key,
              
</dd>
<dt>M</dt>
<dd>
                
                is set to the value of the signature base string from <a class='info' href='#base_string'>Section&nbsp;3.4.1.1<span> (</span><span class='info'>String Construction</span><span>)</span></a>, and
              
</dd>
<dt>S</dt>
<dd>
                
                is set to the octet string value of the <tt>oauth_signature</tt>
                protocol parameter received from the client.
              
</dd>
</dl></blockquote><p>
          
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.4"></a><h3>3.4.4.&nbsp;
PLAINTEXT</h3>

<p>
            The <tt>PLAINTEXT</tt> method does not employ a signature algorithm
            and does not provide any security on its own as it transmits secrets in the clear. It
            SHOULD only be used with a transport-layer mechanism such as TLS or SSL as explained in
            <a class='info' href='#plain_ssl'>Section&nbsp;4.3<span> (</span><span class='info'>PLAINTEXT Signature Method</span><span>)</span></a>. It does not utilize the signature base string nor the
            <tt>oauth_timestamp</tt> and <tt>oauth_nonce</tt>
            parameters.
          
</p>
<p>
            The <tt>oauth_signature</tt> protocol parameter is set to the
            concatenated value of:

            </p>
<ol class="text">
<li>
                The client shared-secret, after being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
              
</li>
<li>
                An <tt>&amp;</tt> character (ASCII code 38), which MUST be
                included even when either secret is empty.
              
</li>
<li>
                The token shared-secret, after being <a class='info' href='#encoding'>encoded<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
              
</li>
</ol><p>
          
</p>
<a name="param_include"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Parameter Transmission</h3>

<p>
          When making an OAuth-authenticated request, protocol parameters as well as any other
          parameter using the <tt>oauth_</tt> prefix SHALL be included in the
          request using one and only one of the following locations, listed in order of decreasing
          preference:

          </p>
<ol class="text">
<li>
              The HTTP <tt>Authorization</tt> header field as described in
              <a class='info' href='#auth_header'>Section&nbsp;3.5.1<span> (</span><span class='info'>Authorization Header</span><span>)</span></a>.
            
</li>
<li>
              The HTTP request entity-body as described in <a class='info' href='#auth_body'>Section&nbsp;3.5.2<span> (</span><span class='info'>Form-Encoded Body</span><span>)</span></a>.
            
</li>
<li>
              The HTTP request URI query as described in <a class='info' href='#auth_query'>Section&nbsp;3.5.3<span> (</span><span class='info'>Request URI Query</span><span>)</span></a>.
            
</li>
</ol><p>
        
</p>
<p>
          In addition to these three methods, future extensions MAY define other methods for
          including protocol parameters in the request.
        
</p>
<a name="auth_header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.1"></a><h3>3.5.1.&nbsp;
Authorization Header</h3>

<p>
            Protocol parameters can be transmitted using the HTTP
            <tt>Authorization</tt> header field as defined by <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>
            with the auth-scheme name set to <tt>OAuth</tt> (case-insensitive).
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Authorization: OAuth realm="http://server.example.com/",
     oauth_consumer_key="0685bd9184jfhq22",
     oauth_token="ad180jjd733klru7",
     oauth_signature_method="HMAC-SHA1",
     oauth_signature="wOJIO9A2W5mFwDgiDvZbTSMK%2FPY%3D",
     oauth_timestamp="137131200",
     oauth_nonce="4572616e48616d6d65724c61686176",
     oauth_version="1.0"

</pre></div>
<p>
            Protocol parameters SHALL be included in the <tt>Authorization</tt>
            header field as follows:

            </p>
<ol class="text">
<li>
                Parameter names and values are encoded per
                <a class='info' href='#encoding'>Parameter Encoding<span> (</span><span class='info'>Percent Encoding</span><span>)</span></a>.
              
</li>
<li>
                Each parameter's name is immediately followed by an <tt>=</tt>
                character (ASCII code 61), a <tt>"</tt> character (ASCII code 34),
                the parameter value (MAY be empty), and another <tt>"</tt> character
                (ASCII code 34).
              
</li>
<li>
                Parameters are separated by a <tt>,</tt> character (ASCII code 44)
                and OPTIONAL linear whitespace per <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>.
              
</li>
<li>
                The OPTIONAL <tt>realm</tt> parameter MAY be added and
                interpreted per <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a> section 1.2.
              
</li>
</ol><p>
          
</p>
<p>
            Servers MAY indicate their support for the <tt>OAuth</tt>
            auth-scheme by returning the HTTP <tt>WWW-Authenticate</tt>
            response header field upon client requests for protected resources. As per
            <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a> such a response MAY include additional HTTP
            <tt>WWW-Authenticate</tt> header fields:
          
</p>
<p>
              For example:
            
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  WWW-Authenticate: OAuth realm="http://server.example.com/"

</pre></div>
<p>
            The realm parameter defines a protection realm per <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>
            section 1.2.
          
</p>
<a name="auth_body"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.2"></a><h3>3.5.2.&nbsp;
Form-Encoded Body</h3>

<p>
            Protocol parameters can be transmitted in the HTTP request entity-body, but only if the
            following REQUIRED conditions are met:

            </p>
<ul class="text">
<li>
                The entity-body is single-part.
              
</li>
<li>
                The entity-body follows the encoding requirements of the
                <tt>application/x-www-form-urlencoded</tt> content-type as
                defined by <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>.
              
</li>
<li>
                The HTTP request entity-header includes the <tt>Content-Type</tt>
                header field set to <tt>application/x-www-form-urlencoded</tt>.
              
</li>
</ul><p>

            
<p>
                For example (line breaks are for display purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  oauth_consumer_key=0685bd9184jfhq22&amp;oauth_token=ad180jjd733klr
  u7&amp;oauth_signature_method=HMAC-SHA1&amp;oauth_signature=wOJIO9A2W5
  mFwDgiDvZbTSMK%2FPY%3D&amp;oauth_timestamp=137131200&amp;oauth_nonce=4
  572616e48616d6d65724c61686176&amp;oauth_version=1.0

</pre></div>
            
            The entity-body MAY include other request-specific parameters, in which case, the
            protocol parameters SHOULD be appended following the request-specific parameters,
            properly separated by an <tt>&amp;</tt> character (ASCII code 38).
          

<a name="auth_query"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.3"></a><h3>3.5.3.&nbsp;
Request URI Query</h3>

<p>
            Protocol parameters can be transmitted by being added to the HTTP request URI as a
            query parameter as defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> section 3.

            
<p>
                For example (line breaks are for display purposes only):
              
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  GET /example/path?oauth_consumer_key=0685bd9184jfhq22&amp;
  oauth_token=ad180jjd733klru7&amp;oauth_signature_method=HM
  AC-SHA1&amp;oauth_signature=wOJIO9A2W5mFwDgiDvZbTSMK%2FPY%
  3D&amp;oauth_timestamp=137131200&amp;oauth_nonce=4572616e48616
  d6d65724c61686176&amp;oauth_version=1.0 HTTP/1.1

</pre></div>

            The request URI MAY include other request-specific query parameters, in which case,
            the protocol parameters SHOULD be appended following the request-specific parameters,
            properly separated by an <tt>&amp;</tt> character (ASCII code 38).
          

<a name="encoding"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Percent Encoding</h3>

<p>
          Existing percent-encoding methods do not guarantee a consistent construction of the
          signature base string. The following percent-encoding method is not defined to replace
          the existing encoding methods defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> and
          <a class='info' href='#W3C.REC-html40-19980424'>[W3C.REC&#8209;html40&#8209;19980424]<span> (</span><span class='info'>Hors, A., Jacobs, I., and D. Raggett, &ldquo;HTML 4.0 Specification,&rdquo; April&nbsp;1998.</span><span>)</span></a>. It is used only in the construction of the
          signature base string and the <a class='info' href='#auth_header'>authorization header field<span> (</span><span class='info'>Authorization Header</span><span>)</span></a>.
        
</p>
<p>
          This specification defines the following method for percent-encoding strings:

          </p>
<ol class="text">
<li>
              Text values are first encoded as UTF-8 octets per <a class='info' href='#RFC3629'>[RFC3629]<span> (</span><span class='info'>Yergeau, F., &ldquo;UTF-8, a transformation format of ISO 10646,&rdquo; November&nbsp;2003.</span><span>)</span></a> if they are
              not already. This does not include binary values which are not intended for human
              consumption.
            
</li>
<li>
              The values are then escaped using the <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a> percent-encoding
              (%XX) mechanism as follows:

              
<ul class="text">
<li>
                  Characters in the unreserved character set as defined by <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>
                  section 2.3 (ALPHA, DIGIT, "-", ".", "_", "~") MUST NOT be encoded.
                
</li>
<li>
                  All other characters MUST be encoded.
                
</li>
<li>
                  The two hexadecimal characters used to represent encoded characters MUST be
                  upper case.
                
</li>
</ul>
            
</li>
</ol><p>
        
</p>
<p>
          This method is different from the encoding scheme used by the
          <tt>application/x-www-form-urlencoded</tt> content-type (for example,
          it encodes space characters as <tt>%20</tt> and not using the 
          <tt>+</tt> character). It MAY be different from the
          percent-encoding functions provided by web development frameworks (e.g. encode different
          characters, use lower case hexadecimal characters).
        
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>
        As stated in <a class='info' href='#RFC2617'>[RFC2617]<span> (</span><span class='info'>Franks, J., Hallam-Baker, P., Hostetler, J., Lawrence, S., Leach, P., Luotonen, A., and L. Stewart, &ldquo;HTTP Authentication: Basic and Digest Access Authentication,&rdquo; June&nbsp;1999.</span><span>)</span></a>, the greatest sources of risks are usually found not
        in the core protocol itself but in policies and procedures surrounding its use. Implementers
        are strongly encouraged to assess how this protocol addresses their security requirements.
      
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Credentials Transmission</h3>

<p>
          This specification does not describe any mechanism for protecting tokens and
          shared-secrets from eavesdroppers when they are transmitted from the server to the
          client during the authorization phase. Servers should ensure that these transmissions are
          protected using transport-layer mechanisms such as TLS or SSL.
        
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
RSA-SHA1 Signature Method</h3>

<p>
          Authenticated requests made with <tt>RSA-SHA1</tt> signatures do not
          use the token shared-secret, or any provisioned client shared-secret. This means the request
          relies completely on the secrecy of the private key used by the client to sign requests.
        
</p>
<a name="plain_ssl"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
PLAINTEXT Signature Method</h3>

<p>
          When used with the <tt>PLAINTEXT</tt> method, the protocol makes no
          attempt to protect credentials from eavesdroppers or man-in-the-middle attacks. The
          <tt>PLAINTEXT</tt> method is only intended to be used in conjunction
          with a transport-layer security mechanism such as TLS or SSL which can provide such
          protection.
        
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Confidentiality of Requests</h3>

<p>
          While this protocol provides a mechanism for verifying the integrity of requests, it
          provides no guarantee of request confidentiality. Unless further precautions are taken,
          eavesdroppers will have full access to request content. Servers should carefully consider
          the kinds of data likely to be sent as part of such requests, and should employ
          transport-layer security mechanisms to protect sensitive resources.
        
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Spoofing by Counterfeit Servers</h3>

<p>
          This protocol makes no attempt to verify the authenticity of the server. A hostile party
          could take advantage of this by intercepting the client's requests and returning
          misleading or otherwise incorrect responses. Service providers should consider such
          attacks when developing services using this protocol, and should require transport-layer
          security for any requests where the authenticity of the server or of request responses is
          an issue.
        
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Proxying and Caching of Authenticated Content</h3>

<p>
          The <a class='info' href='#auth_header'>HTTP Authorization scheme<span> (</span><span class='info'>Authorization Header</span><span>)</span></a> is optional. However,
          <a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a> relies on the <tt>Authorization</tt> and
          <tt>WWW-Authenticate</tt> header fields to distinguish authenticated content
          so that it can be protected. Proxies and caches, in particular, may fail to adequately
          protect requests not using these header fields.
        
</p>
<p>
          For example, private authenticated content may be stored in (and thus retrievable from)
          publicly-accessible caches. Servers not using the
          <a class='info' href='#auth_header'>HTTP Authorization header field<span> (</span><span class='info'>Authorization Header</span><span>)</span></a> should take care to use other
          mechanisms, such as the <tt>Cache-Control</tt> header field, to ensure that
          authenticated content is protected.
        
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Plaintext Storage of Credentials</h3>

<p>
          The client shared-secret and token shared-secret function the same way passwords do in
          traditional authentication systems. In order to compute the signatures used in methods
          other than <tt>RSA-SHA1</tt>, the server must have access to these
          secrets in plaintext form. This is in contrast, for example, to modern operating systems,
          which store only a one-way hash of user credentials.
        
</p>
<p>
          If an attacker were to gain access to these secrets - or worse, to the server's database
          of all such secrets - he or she would be able to perform any action on behalf of any
          resource owner. Accordingly, it is critical that servers protect these secrets from
          unauthorized access.
        
</p>
<a name="client_cred_sec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.8"></a><h3>4.8.&nbsp;
Secrecy of the Client Credentials</h3>

<p>
          In many cases, the client application will be under the control of potentially untrusted
          parties. For example, if the client is a desktop application with freely available
          source code or an executable binary, an attacker may be able to download a copy for
          analysis. In such cases, attackers will be able to recover the client credentials.
        
</p>
<p>
          Accordingly, servers should not use the client credentials alone to verify the identity
          of the client. Where possible, other factors such as IP address should be used as well.
        
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.9"></a><h3>4.9.&nbsp;
Phishing Attacks</h3>

<p>
          Wide deployment of this and similar protocols may cause resource owners to become inured
          to the practice of being redirected to websites where they are asked to enter their
          passwords. If resource owners are not careful to verify the authenticity of these
          websites before entering their credentials, it will be possible for attackers to exploit
          this practice to steal resource owners' passwords.
        
</p>
<p>
          Servers should attempt to educate resource owners about the risks phishing attacks pose,
          and should provide mechanisms that make it easy for resource owners to confirm the
          authenticity of their sites. Client developers should consider the security implications
          of how they interact with a user-agent (e.g. separate window, embedded), and the ability
          of the end-user to verify the authenticity of the server website.
        
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.10"></a><h3>4.10.&nbsp;
Scoping of Access Requests</h3>

<p>
          By itself, this protocol does not provide any method for scoping the access rights
          granted to a client. However, most applications do require greater granularity of access
          rights. For example, servers may wish to make it possible to grant access to some
          protected resources but not others, or to grant only limited access (such as read-only
          access) to those protected resources.
        
</p>
<p>
          When implementing this protocol, servers should consider the types of access resource
          owners may wish to grant clients, and should provide mechanisms to do so. Servers should
          also take care to ensure that resource owners understand the access they are granting, as
          well as any risks that may be involved.
        
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.11"></a><h3>4.11.&nbsp;
Entropy of Secrets</h3>

<p>
          Unless a transport-layer security protocol is used, eavesdroppers will have full access
          to authenticated requests and signatures, and will thus be able to mount offline brute-force
          attacks to recover the credentials used. Servers should be careful to assign
          shared-secrets which are long enough, and random enough, to resist such attacks for at
          least the length of time that the shared-secrets are valid.
        
</p>
<p>
          For example, if shared-secrets are valid for two weeks, servers should ensure that it is
          not possible to mount a brute force attack that recovers the shared-secret in less than
          two weeks. Of course, servers are urged to err on the side of caution, and use the longest
          secrets reasonable.
        
</p>
<p>
          It is equally important that the pseudo-random number generator (PRNG) used to generate
          these secrets be of sufficiently high quality. Many PRNG implementations generate number
          sequences that may appear to be random, but which nevertheless exhibit patterns or other
          weaknesses which make cryptanalysis or brute force attacks easier. Implementers should be
          careful to use cryptographically secure PRNGs to avoid these problems.
        
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.12"></a><h3>4.12.&nbsp;
Denial of Service / Resource Exhaustion Attacks</h3>

<p>
          This specification includes a number of features which may make resource exhaustion
          attacks against servers possible. For example, this protocol requires servers to track
          used nonces. If an attacker is able to use many nonces quickly, the resources required to
          track them may exhaust available capacity. And again, this protocol can require servers
          to perform potentially expensive computations in order to verify the signature on
          incoming requests. An attacker may exploit this to perform a denial of service attack by
          sending a large number of invalid requests to the server.
        
</p>
<p>
          Resource Exhaustion attacks are by no means specific to this specification. However,
          implementers should be careful to consider the additional avenues of attack that this
          protocol exposes, and design their implementations accordingly. For example, entropy
          starvation typically results in either a complete denial of service while the system
          waits for new entropy or else in weak (easily guessable) secrets. When implementing this
          protocol, servers should consider which of these presents a more serious risk for their
          application and design accordingly.
        
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.13"></a><h3>4.13.&nbsp;
SHA-1 Cryptographic Attacks</h3>

<p>
          SHA-1, the hash algorithm used in <tt>HMAC-SHA1</tt> and
          <tt>RSA-SHA1</tt> signature methods, has been shown to have a number
          of cryptographic weaknesses that significantly reduce its resistance to collision
          attacks. While these weaknesses do not seem to affect the use of SHA-1 with the
          Hash-based Message Authentication Code (HMAC) and should not affect the
          <tt>HMAC-SHA1</tt> signature method, it may affect the use of the
          <tt>RSA-SHA1</tt> signature method. NIST has announced that it will
          phase out use of SHA-1 in digital signtures by 2010 <a class='info' href='#NIST SHA-1 Comments'>[NIST SHA&#8209;1 Comments]<span> (</span><span class='info'>Burr, W., &ldquo;NIST Comments on Cryptanalytic Attacks on SHA-1,&rdquo; .</span><span>)</span></a>.
        
</p>
<p>
          Practically speaking, these weaknesses are difficult to exploit, and by themselves do not
          pose a significant risk to users of this protocol. They may, however, make more efficient
          attacks possible, and  Servers should take this into account when considering whether
          SHA-1 provides an adequate level of security for their applications.
        
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.14"></a><h3>4.14.&nbsp;
Signature Base String Limitations</h3>

<p>
          The signature base string has been designed to support the signature methods defined in
          this specification. Those designing additional signature methods, should evaluated the
          compatibility of the signature base string with their security requirements.
        
</p>
<p>
          Since the signature base string does not cover the entire HTTP request, such as most
          request entity-body, most entity-headers, and the order in which parameters are sent,
          servers should employ additional mechanisms to protect such elements.
        
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.15"></a><h3>4.15.&nbsp;
Cross-Site Request Forgery (CSRF)</h3>

<p>
					Cross-Site Request Forgery (CSRF) is a web-based attack whereby HTTP requests are
          transmitted from a user that the website trusts or has authenticated. CSRF attacks on
          authorization approvals can allow an attacker to obtain authorization to protected
          resources without the consent of the User. Servers SHOULD strongly consider best
          practices in CSRF prevention at all the protocol authorization endpoints.
				
</p>
<p>
					CSRF attacks on OAuth callback URIs hosted by clients are also possible. Clients should
          prevent CSRF attacks on OAuth callback URIs by verifying that the resource owner at the
          client site intended to complete the OAuth negotiation with the server. The methods for
          preventing such CSRF attacks are beyond the scope of this specification.
				
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.16"></a><h3>4.16.&nbsp;
User Interface Redress</h3>

<p>
					Servers should protect the authorization process against UI Redress attacks (also known
          as "clickjacking"). As of the time of this writing, no complete defenses against UI
          redress are available. Servers can mitigate the risk of UI redress attacks through the
          following techniques:

					</p>
<ul class="text">
<li>
              Javascript frame busting.
            
</li>
<li>
              Javascript frame busting, and requiring that browsers have javascript enabled on the
              authorization page.
            
</li>
<li>
              Browser-specific anti-framing techniques.
            
</li>
<li>
              Requiring password reentry before issuing OAuth tokens.
            
</li>
</ul><p>
				
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.17"></a><h3>4.17.&nbsp;
Automatic Processing of Repeat Authorizations</h3>

<p>
					Servers may wish to automatically process authorization requests
					(<a class='info' href='#auth_step2'>Section&nbsp;2.2<span> (</span><span class='info'>Resource Owner Authorization</span><span>)</span></a>) from clients which have been previously
					authorized by the resource owner. When the resource owner is redirected to the server
					to grant access, the server detects that the resource owner has already granted
					access to that particular client. Instead of prompting the resource owner for approval,
					the server automatically redirects the resource owner back to the client.
				
</p>
<p>
					If the client credentials are compromised, automatic processing creates additional
					security risks. An attacker can use the stolen client credentials to redirect
					the resource owner to the server with an authorization request. The server
					will then grant access to the resource owner's data without the resource owner's
					explicit approval, or even awareness of an attack. If no automatic approval is
					implemented, an attacker must use social engineering to convince the resource owner to
					approve access.
				
</p>
<p>
					Servers can mitigate the risks associated with automatic processing by
					limiting the scope of token credentials obtained through automated approvals. Tokens
					credentials obtained through explicit resource owner consent can remain unaffected. Clients
					can mitigate the risks associated with automatic processing by protecting their client
					credentials.
				
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
        This memo includes no request to IANA.
      
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgments</h3>

<p>
        This specification is directly based on the OAuth Core 1.0 Revision A community
        specification which in turn was modeled after existing proprietary protocols and best
        practices that have been independently implemented by various companies.
      
</p>
<p>
        The community specification was edited by Eran Hammer-Lahav and authored by: Mark Atwood,
        Dirk Balfanz, Darren Bounds, Richard M. Conlan, Blaine Cook, Leah Culver,
        Breno de Medeiros, Brian Eaton, Kellan Elliott-McCrea, Larry Halff, Eran Hammer-Lahav,
        Ben Laurie, Chris Messina, John Panzer, Sam Quigley, David Recordon, Eran Sandler,
        Jonathan Sergent, Todd Sieling, Brian Slesinsky, and Andy Smith.
      
</p>
<p>
        The editor would like to thank the following individuals for their invaluable contribution
        to the publication of this edition of the protocol: Lisa Dusseault, Justin Hart,
        Avshalom Houri, Chris Messina, Mark Nottingham, Tim Polk, Peter Saint-Andre, Joseph Smarr,
        and Paul Walker.
      
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Differences from the Community Edition</h3>

<p>
				This specification includes the following changes made to the original community document
				<a class='info' href='#OAuth Core 1.0 Revision A'>[OAuth Core 1.0 Revision A]<span> (</span><span class='info'>OAuth, OAuth Community., &ldquo;OAuth Core 1.0 Revision A,&rdquo; .</span><span>)</span></a> in order to correct mistakes and omissions
        identified since the document has been published:
				
				</p>
<ul class="text">
<li>
						Adjusted nonce language to indicate it is unique per token/timestamp/client combination.
					
</li>
<li>
            Removed the requirement for timestamps to be equal to or greater than the timestamp
            used in the previous request.
          
</li>
<li>
            Changed the nonce and timestamp parameters to OPTIONAL when using the
            <tt>PLAINTEXT</tt> signature method.
          
</li>
<li>
						Extended signature base string coverage which includes <tt>application/x-www-form-urlencoded</tt>
						entity-body parameters when the HTTP method used is other than <tt>POST</tt> and URI query
						parameters when the HTTP method used is other than <tt>GET</tt>.
					
</li>
<li>
						Incorporated corrections to the instructions in each signature method to encode the signature
            value before inserting it into the <tt>oauth_signature</tt> parameter,
            removing errors which would have caused double-encoded values.
					
</li>
<li>
            Allowed omitting the <tt>oauth_token</tt> parameter when empty.
          
</li>
<li>
            Permitted sending requests for temporary credentials with an empty
            <tt>oauth_token</tt> parameter.
          
</li>
<li>
            Removed the restrictions from defining additional <tt>oauth_</tt>
            parameters.
          
</li>
</ul><p>
			
</p>
<a name="history"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Document History</h3>

<p>
        [[ To be removed by the RFC editor before publication as an RFC. ]]
      
</p>
<p>
        -08
        </p>
<ul class="text">
<li>
            Adjusted timestamp language to allow use of time servers for clock sync.
          
</li>
<li>
            Revised security language for SHA-1 weakness and applicability.
          
</li>
<li>
            Added link to the community specification.
          
</li>
<li>
            Minor editorial changes.
          
</li>
</ul><p>
      
</p>
<p>
        -07
        
        </p>
<ul class="text">
<li>
            Corrected typos.
          
</li>
<li>
            Changed examples to use HTTPS in authorization step.
          
</li>
<li>
            Clarified the use of 'oauth_' tokens in the three static endpoint URIs.
          
</li>
<li>
            Edited abstract and introduction.
          
</li>
</ul><p>
      
</p>
<p>
        -06

        </p>
<ul class="text">
<li>
            Moved parameter section into client instructions.
          
</li>
<li>
            Added more examples in the delegation section, including more complete HTTP responses.
          
</li>
<li>
            Removed language about restricting the use of the 'oauth_' prefix.
          
</li>
<li>
            Changed the nonce and timestamp parameters to optional when using PLAINTEXT.
          
</li>
<li>
            Allowed empty token in temporary credentials requests.
          
</li>
</ul><p>
      
</p>
<p>
        -05
        
        </p>
<ul class="text">
<li>
            Replaced the word 'lexicographical' with 'ascending' in sorting instructions.
          
</li>
<li>
            Added note that the 'a3' parameter appears twice in the example.
          
</li>
<li>
            Made the note about the encoding scheme being different from most common implementations
            more explicit.
          
</li>
<li>
            Moved and cleaned up the example from appendix to introduction. Removed crypto details
            from the example.
          
</li>
</ul><p>
      
</p>
<p>
        -04
        
        </p>
<ul class="text">
<li>
            Corrected typo and other minor editorial changes.
          
</li>
<li>
            Added warning about token sizes.
          
</li>
<li>
            Clarified that all 'oauth_' parameters must be transmitted using the same method.
          
</li>
<li>
            Added explicit requirement to exclude parameters not transmitted in a request in the
            signature base string (for example oauth_version when omitted).
          
</li>
<li>
            Explicitly set OAuth to use HTTP 1.1.
          
</li>
<li>
            Rearranged the signature base string section to provide a better narrative of how the
            HTTP request is normalized. Added the protocol parameters to the examples to better
            demonstrate how they are incorporated in practice.
          
</li>
<li>
            Flipped the document order between authentication and authorization.
          
</li>
<li>
            Removed the requirement for timestamps to be equal or greater than previous timestamps.
          
</li>
</ul><p>
      
</p>
<p>
				-03

				</p>
<ul class="text">
<li>
						Updated draft with changes from OAuth Core 1.0 Revision A to fix a session fixation exploit.
					
</li>
<li>
						Small editorial corrections.
					
</li>
<li>
						Removed confusing language from 'Denial of Service / Resource Exhaustion Attacks'.
					
</li>
<li>
						Added new 'Differences from the Community Edition' appendix.
					
</li>
<li>
						Updated acknowledgements section.
					
</li>
</ul><p>
			
</p>
<p>
        -02

        </p>
<ul class="text">
<li>
            Corrected mistake in parameter sorting order (c%40 comes before c2).
          
</li>
<li>
            Added requirement to normalize empty paths as '/'.
          
</li>
</ul><p>
      
</p>
<p>
        -01

        </p>
<ul class="text">
<li>
            Complete rewrite of the entire specification from scratch. Separated the spec structure
            into two parts and flipped their order.
          
</li>
<li>
            Corrected errors in instructions to encode the signature base string by some methods. The
            signature value is encoded using the transport rules, not the spec method for encoding.
          
</li>
<li>
            Replaced the entire terminology.
          
</li>
</ul><p>
      
</p>
<p>
        -00

        </p>
<ul class="text">
<li>
            Initial draft based on the OAuth Core 1.0 community specification
            with the following changes.
          
</li>
<li>
            Various changes required to accommodate the strict format requirements of the IETF,
            such as moving sections around (Security, Contributors, Introduction, etc.), cleaning
            references, adding IETF specific text, etc.
          
</li>
<li>
            Moved the Parameter Encoding sub-section from section 5 (Parameters) to section 9.1
            (Signature Base String) to make it clear it only applies to the signature base string.
          
</li>
<li>
            Nonce language adjusted to indicate it is unique per token/timestamp/consumer
            combination.
          
</li>
<li>
            Added security language regarding lack of token secrets in RSA-SHA1.
          
</li>
<li>
            Fixed the bug in the Normalize Request Parameters section. Removed the
            <tt>GET</tt> limitation from the third bullet (query parameters).
          
</li>
<li>
            Removed restriction of only signing application/x-www-form-urlencoded in
            <tt>POST</tt> requests, allowing the entity-body to be used with all
            HTTP request methods.
          
</li>
</ul><p>
      
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2045">[RFC2045]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</a>,&rdquo; RFC&nbsp;2045, November&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2045.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2616.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc2616.pdf">PDF</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2616.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2616.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2617">[RFC2617]</a></td>
<td class="author-text"><a href="mailto:john@math.nwu.edu">Franks, J.</a>, <a href="mailto:pbaker@verisign.com">Hallam-Baker, P.</a>, <a href="mailto:jeff@AbiSource.com">Hostetler, J.</a>, <a href="mailto:lawrence@agranat.com">Lawrence, S.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, Luotonen, A., and <a href="mailto:stewart@OpenMarket.com">L. Stewart</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2617">HTTP Authentication: Basic and Digest Access Authentication</a>,&rdquo; RFC&nbsp;2617, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2617.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2617.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2617.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2818">[RFC2818]</a></td>
<td class="author-text">Rescorla, E., &ldquo;<a href="http://tools.ietf.org/html/rfc2818">HTTP Over TLS</a>,&rdquo; RFC&nbsp;2818, May&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2818.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3447">[RFC3447]</a></td>
<td class="author-text">Jonsson, J. and B. Kaliski, &ldquo;<a href="http://tools.ietf.org/html/rfc3447">Public-Key Cryptography Standards (PKCS) #1: RSA Cryptography Specifications Version 2.1</a>,&rdquo; RFC&nbsp;3447, February&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3447.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3629">[RFC3629]</a></td>
<td class="author-text">Yergeau, F., &ldquo;<a href="http://tools.ietf.org/html/rfc3629">UTF-8, a transformation format of ISO 10646</a>,&rdquo; STD&nbsp;63, RFC&nbsp;3629, November&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3629.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="W3C.REC-html40-19980424">[W3C.REC-html40-19980424]</a></td>
<td class="author-text">Hors, A., Jacobs, I., and D. Raggett, &ldquo;<a href="http://www.w3.org/TR/1998/REC-html40-19980424">HTML 4.0 Specification</a>,&rdquo; World Wide Web Consortium Recommendation&nbsp;REC-html40-19980424, April&nbsp;1998 (<a href="http://www.w3.org/TR/1998/REC-html40-19980424">HTML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="NIST SHA-1 Comments">[NIST SHA-1 Comments]</a></td>
<td class="author-text">Burr, W., &ldquo;<a href="http://csrc.nist.gov/groups/ST/hash/statement.html">NIST Comments on Cryptanalytic Attacks on SHA-1</a>.&rdquo;</td></tr>
<tr><td class="author-text" valign="top"><a name="OAuth Core 1.0 Revision A">[OAuth Core 1.0 Revision A]</a></td>
<td class="author-text">OAuth, OAuth Community., &ldquo;<a href="http://oauth.net/core/1.0a">OAuth Core 1.0 Revision A</a>.&rdquo;</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eran Hammer-Lahav (editor)</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:eran@hueniverse.com">eran@hueniverse.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://hueniverse.com">http://hueniverse.com</a></td></tr>
</table>
</body></html>
