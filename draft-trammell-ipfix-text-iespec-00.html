<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>A Lightweight Textual Format for IPFIX Information Models and Templates</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="A Lightweight Textual Format for IPFIX Information Models and Templates">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IPFIX Working Group</td><td class="header">B. Trammell</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Hitachi Europe</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">April 16, 2010</td></tr>
<tr><td class="header">Expires: October 18, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />A Lightweight Textual Format for IPFIX Information Models and Templates<br />draft-trammell-ipfix-text-iespec-00.txt</h1>

<h3>Abstract</h3>

<p>This document describes a lightweight textual format for describing
    IPFIX Information Models, IPFIX Templates, and IPFIX Options Templates,
    designed for easy human readability and writability, and fast, easily
    implemented and deployed parsing and generation.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on October 18, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>

<a name="anchor1"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The IP Flow Information Export Protocol (IPFIX) <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> affords new levels of flexibility in defining Data
    Record formats through its Template mechanism, and new Information
    Elements via an <a class='info' href='#iana-ipfix-assignments'>IANA
    registry<span> (</span><span class='info'>Internet Assigned Numbers Authority, &ldquo;IP Flow Information Export Information Elements (http://www.iana.org/assignments/ipfix/ipfix.xml),&rdquo; .</span><span>)</span></a> [iana&#8209;ipfix&#8209;assignments], enterprise-specific Information Elements, and inline
    information model export as defined in <a class='info' href='#RFC5610'>[RFC5610]<span> (</span><span class='info'>Boschi, E., Trammell, B., Mark, L., and T. Zseby, &ldquo;Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements,&rdquo; July&nbsp;2009.</span><span>)</span></a>. However,
    XML representations of Information Elements as in the <a class='info' href='#iana-ipfix-assignments'>IANA registry<span> (</span><span class='info'>Internet Assigned Numbers Authority, &ldquo;IP Flow Information Export Information Elements (http://www.iana.org/assignments/ipfix/ipfix.xml),&rdquo; .</span><span>)</span></a> [iana&#8209;ipfix&#8209;assignments] require the inclusion
    of an XML parser in each IPFIX Exporting and Collecting Process for use at
    runtime, require transformation via XSLT (as used by IANA) in order to
    become human-readable, and are not particularly easily human-writiable.
    IPFIX Templates and Type Information Export as in <a class='info' href='#RFC5610'>[RFC5610]<span> (</span><span class='info'>Boschi, E., Trammell, B., Mark, L., and T. Zseby, &ldquo;Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements,&rdquo; July&nbsp;2009.</span><span>)</span></a>
    are excellent for runtime, but not particularly human-readable.
</p>
<p>This document proposes a simple textual syntax for describing IPFIX
    Information Elements and IPFIX Templates, with human readability, human
    writability, compactness, and ease of parser/generator implementation
    without requiring external XML support as design goals. It is intended
    both for use in human communication (e.g., in new Internet-Drafts
    containing higher-level descriptions of IPFIX Templates, or describing
    sets of new IPFIX Information Elements for supporting new applications of
    the protocol) as well as at runtime by IPFIX implementations.
</p>
<a name="anchor2"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>Terms used in this document that are defined in the Terminology section
    of the <a class='info' href='#RFC5101'>IPFIX Protocol<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> [RFC5101] document are to be
    interpreted as defined there. In addition, the following terms used in
    this document are defined as follows:
</p>
<blockquote class="text"><dl>
<dt>textual Information Element specifier (IESpec): </dt>
<dd>A string
      representing the four important aspects of an Information Element within
      the Information Model or within a Template: its name, its number (with
      Private Enterprise Number if applicable), its data type, and its
      length.
</dd>
<dt>fully-qualified IESpec: </dt>
<dd>An IESpec as above, containing
      enough information to define an information element: at least a name,
      number, and type, and a length for types without a native length.
      IESpecs must be fully qualified to be of used in defining an Information
      Model or extensions thereto.
</dd>
<dt>partial IESpec: </dt>
<dd>An IESpec that is not fully
      qualified.
</dd>
</dl></blockquote>
<p>Note that when the term Template is used in this document,
    it applies both to Templates and Options Templates as
    defined in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>, unless otherwise noted.
</p>
<a name="anchor3"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
Information Element Specifier Syntax</h3>

<p>The basis of this format is the textual Information Element Specifier,
    or IESpec. An IESpec contains each of the four important aspects of an
    Information Element: its name, its number, its type, and its size,
    separated by simple markup based on various types of brackets.
    Fully-qualified IESpecs may be used to specify existing or new Information
    Elements within an Information Model, while either fully-qualified or
    partial IESpecs may be used to define fields in a Template.
</p>
<p>Each aspect of information associated with an Information Element is
    associated with a type of brackets. Bare words are used for Information
    Element names, () parentheses for Information Element numbers, &lt;&gt;
    angles for Information Element data types, and [] square brackets for
    Information Element sizes. {} Curly braces are reserved for optional and
    contextual use, described later in the document.
</p>
<p>The basic form of a fully-qualified IESpec for an IANA-registered
    Information Element is as follows:
</p>
<p>name(number)&lt;type&gt;[size]
</p>
<p>where 'name' is the name of the Information Element in UTF-8, 'number'
    is the Information Element as a decimal integer, 'type' is the name of the
    data type as in the <a class='info' href='#iana-ipfix-assignments'>IANA
    informationElementDataTypes registry<span> (</span><span class='info'>Internet Assigned Numbers Authority, &ldquo;IP Flow Information Export Information Elements (http://www.iana.org/assignments/ipfix/ipfix.xml),&rdquo; .</span><span>)</span></a> [iana&#8209;ipfix&#8209;assignments], and 'size' is the length of
    the Information Element in octets as a decimal integer, where 65535 or the
    string 'v' signifies a variable-length Information Element. [size] may be
    omitted; in this case, the data type's native or default size is assumed
    (see section <a class='info' href='#sec-native-size'>Section&nbsp;3.1<span> (</span><span class='info'>Native Sizes of Data Types</span><span>)</span></a>.
</p>
<p>The basic form of a fully-qualified IESpec for an enterprise-specific
    Information Element is as follows:
</p>
<p>name(pen/number)&lt;type&gt;[size]
</p>
<p>where 'pen' is the Private Enterprise Number as a decimal integer.
</p>
<p>A fully-qualified IESpec is intended to give the implementation
    consuming it enough information about an Information Element to decode and
    display Data Records defined by Templates containing that Information
    Element. Range, unit, semantic, and description information, as in <a class='info' href='#RFC5610'>[RFC5610]<span> (</span><span class='info'>Boschi, E., Trammell, B., Mark, L., and T. Zseby, &ldquo;Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements,&rdquo; July&nbsp;2009.</span><span>)</span></a>, is not supported by this syntax.
</p>
<p>Example fully-qualified IESpecs follow:
</p>
<ul class="text">
<li>octetDeltaCount(1)&lt;unsigned64&gt;[8]
</li>
<li>octetDeltaCount(1)&lt;unsigned64&gt; (unsigned64 is natively 8 octets long)
</li>
<li>sourceIPv4Address(8)&lt;ipv4Address&gt;
</li>
<li>wlanSSID(146)&lt;string&gt;[v]
</li>
<li>sipRequestURI(35566/403)&lt;string&gt;[65535]
</li>
</ul>
<p>A partial IESpec is any IESpec that is not fully-qualified; these are
    useful when defining templates, or in other contexts in which the
    implementation already has an Information Model. A partial IESpec is
    assumed to take missing values from its Information Model (or,
    conceptually, from fully-qualified IESpecs which it matches). At minimum,
    a partial IESpec must contain a name, or a number. Any name, number, or
    type information given with a partial IESpec must match the values given
    in the Information Model; however, size information in a partial IESpec
    overrides size information in the Information Model; in this way, IESpecs
    can be used to express reduced-length encoding for Information
    Elements.
</p>
<p>Example partial IESpecs follow:
</p>
<ul class="text">
<li>octetDeltaCount
</li>
<li>octetDeltaCount[4] (reduced-length encoding)
</li>
<li>(1)
</li>
<li>(1)[4] (reduced length encoding; note that this is exactly equivalent to an Information Element specifier in a Template)
</li>
</ul>
<a name="sec-native-size"></a><br /><hr />
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Native Sizes of Data Types</h3>

<p>If absent in a fully-qualified IESpec, the size is assumed to be the
      native or default size for the type, as follows:
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Data Type</th><th align="left">Native Size</th></tr>
<tr>
<td align="left">&lt;octetArray&gt;</td>
<td align="left">[v], [65535] (variable)</td>
</tr>
<tr>
<td align="left">&lt;unsigned8&gt;</td>
<td align="left">[1]</td>
</tr>
<tr>
<td align="left">&lt;unsigned16&gt;</td>
<td align="left">[2]</td>
</tr>
<tr>
<td align="left">&lt;unsigned32&gt;</td>
<td align="left">[4]</td>
</tr>
<tr>
<td align="left">&lt;unsigned64&gt;</td>
<td align="left">[8]</td>
</tr>
<tr>
<td align="left">&lt;signed8&gt;</td>
<td align="left">[1]</td>
</tr>
<tr>
<td align="left">&lt;signed16&gt;</td>
<td align="left">[2]</td>
</tr>
<tr>
<td align="left">&lt;signed32&gt;</td>
<td align="left">[4]</td>
</tr>
<tr>
<td align="left">&lt;signed64&gt;</td>
<td align="left">[8]</td>
</tr>
<tr>
<td align="left">&lt;float32&gt;</td>
<td align="left">[4]</td>
</tr>
<tr>
<td align="left">&lt;float64&gt;</td>
<td align="left">[8]</td>
</tr>
<tr>
<td align="left">&lt;boolean&gt;</td>
<td align="left">[1]</td>
</tr>
<tr>
<td align="left">&lt;macAddress&gt;</td>
<td align="left">[6]</td>
</tr>
<tr>
<td align="left">&lt;string&gt;</td>
<td align="left">[v], [65535] (variable)</td>
</tr>
<tr>
<td align="left">&lt;dateTimeSeconds&gt;</td>
<td align="left">[4]</td>
</tr>
<tr>
<td align="left">&lt;dateTimeMilliseconds&gt;</td>
<td align="left">[8]</td>
</tr>
<tr>
<td align="left">&lt;dateTimeMicroseconds&gt;</td>
<td align="left">[8]</td>
</tr>
<tr>
<td align="left">&lt;dateTimeNanoseconds&gt;</td>
<td align="left">[8]</td>
</tr>
<tr>
<td align="left">&lt;ipv4Address&gt;</td>
<td align="left">[4]</td>
</tr>
<tr>
<td align="left">&lt;ipv6Address&gt;</td>
<td align="left">[16]</td>
</tr>
</table>
<br clear="all" />

<a name="anchor4"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
Defining an Information Model from IESpecs</h3>

<p>An Information Model, or an extension thereto (e.g., a set of
    enterprise-specific Information Elements supplied to a Collector to
    provide type information for information from a particular Exporter in the
    absence of support for <a class='info' href='#RFC5610'>[RFC5610]<span> (</span><span class='info'>Boschi, E., Trammell, B., Mark, L., and T. Zseby, &ldquo;Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements,&rdquo; July&nbsp;2009.</span><span>)</span></a>; or a set of new
    Information Elements compactly presented in an Internet-Draft describing a
    new IPFIX application) can be expressed simply as a newline-separated list
    of fully-qualified IESpecs.
</p>
<a name="anchor5"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
Defining a Template or Options Template from IESpecs</h3>

<p>A Template or Options Template can be expressed simply as an ordered newline-separated list of partial or fully-qualified IESpecs. IESpecs representing Scope Information Elements in an Options Template take the {scope} option as a suffix to the IESpec, e.g.:
</p>
<p>sourceIPv4Address{scope}
</p>
<p>A syntax for an encapsulation of templates (including e.g. template ID)
    is not yet defined.
</p>
<a name="anchor6"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>Any IPFIX implementation using externally-provided strings to define
    Information Models and Templates must perform validation on those strings
    to ensure safe operation, and ensure that parsers for these strings are
    not vulnerable to common faults (e.g. buffer overflows); further guidance
    is implementation and platform specific.
</p>
<a name="anchor7"></a><br /><hr />
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA.
</p>
<a name="rfc.references1"></a><br /><hr />
<h3>8.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5101">[RFC5101]</a></td>
<td class="author-text">Claise, B., &ldquo;<a href="http://tools.ietf.org/html/rfc5101">Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information</a>,&rdquo; RFC&nbsp;5101, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5101.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5610">[RFC5610]</a></td>
<td class="author-text">Boschi, E., Trammell, B., Mark, L., and T. Zseby, &ldquo;<a href="http://tools.ietf.org/html/rfc5610">Exporting Type Information for IP Flow Information Export (IPFIX) Information Elements</a>,&rdquo; RFC&nbsp;5610, July&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5610.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="iana-ipfix-assignments">[iana-ipfix-assignments]</a></td>
<td class="author-text">Internet Assigned Numbers Authority, &ldquo;IP Flow Information Export Information Elements (http://www.iana.org/assignments/ipfix/ipfix.xml).&rdquo;</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brian Trammell</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hitachi Europe</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">c/o ETH Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gloriastrasse 35</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">8092 Zurich</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Switzerland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+41 44 632 70 13</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:brian.trammell@hitachi-eu.com">brian.trammell@hitachi-eu.com</a></td></tr>
</table>
</body></html>
