<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DTN IP Neighbor Discovery (IPND)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DTN IP Neighbor Discovery (IPND)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">R. Beverly</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">D. Ellard</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">BBN</td></tr>
<tr><td class="header">Expires: February 10, 2010</td><td class="header">August 09, 2009</td></tr>
</table></td></tr></table>
<h1><br />DTN IP Neighbor Discovery (IPND)<br />draft-irtf-dtnrg-ipnd-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on February 10, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>
    Disruption Tolerant Networking (DTN) IP Neighbor Discovery
    (IPND), is a method for otherwise oblivious nodes to learn of the
    existence, availability, and addresses of other DTN participants.
    IPND both sends and listens for small IP UDP announcement
    "beacons."  Beacon messages are addressed to an IP unicast, multicast,
    or broadcast destination to discover specified remote
    neighbors, or unspecified local neighbors in the topology, e.g.
    within wireless range.  IPND beacons advertise neighbor
    availability by including the DTN node's canonical endpoint
    identifier.  IPND beacons optionally include service availability
    and parameters.  In this way, neighbor discovery and service
    discovery may be coupled or decoupled as required.  Once
    discovered, new neighbor pairs use advertised availabilities
    to connect, exchange routing information, etc.  This document
    describes DTN IPND.
    
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Terminology<br />
<a href="#anchor3">2.</a>&nbsp;
Protocol Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#multicast">2.1.</a>&nbsp;
Unknown Neighbors<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#unicast">2.2.</a>&nbsp;
Enumerated Neighbors<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#beacons">2.3.</a>&nbsp;
Beacon Message Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#services">2.3.1.</a>&nbsp;
Services<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#zero">2.3.2.</a>&nbsp;
Zero-length EID Beacons<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.4.</a>&nbsp;
Connection Establishment<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.5.</a>&nbsp;
Disconnection<br />
<a href="#anchor6">3.</a>&nbsp;
Relation to Other Discovery Protocols<br />
<a href="#anchor7">4.</a>&nbsp;
Implementation Experience<br />
<a href="#anchor8">5.</a>&nbsp;
Security Considerations<br />
<a href="#anchor9">6.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
    Delay and Disruption Tolerant Networks (DTNs) <a class='info' href='#RFC4838'>[RFC4838]<span> (</span><span class='info'>Cerf, V., Burleigh, S., Hooke, A., Torgerson, L., Durst, R., Scott, K., Fall, K., and H. Weiss, &ldquo;Delay-Tolerant Networking Architecture,&rdquo; April&nbsp;2007.</span><span>)</span></a> make no presumptions about network topology,
    routing, or availability.  DTNs therefore attempt to provide
    communication in challenged environments where, for instance,
    contemporaneous end-to-end paths do not exist.  Examples of such
    DTNs arise is a variety of contexts including mobile social
    networks, space communications, rural message delivery, military
    networks, etc.
    
</p>
<p>
    In many DTN scenarios, the identity and meeting
    schedule of other participating nodes is not known in advance.
    Therefore, an important primitive is Neighbor Discovery (ND), or
    the ability to dynamically locate other DTN nodes.  This document
    specifies Internet Protocol Neighbor Discovery (IPND).  In
    contrast to link or physical layer discovery, IPND enables a
    general form of neighbor discovery across a heterogeneous range
    of links, as are often found in DTN networks.  IPND is particularly
    useful in mobile, ad-hoc DTN environments where meeting
    opportunities are not known a priori and connections may appear
    or disappear without warning.  For example, two mobile nodes
    might come into radio distance of each other, discover the new
    connection, and move data along that connection before physically
    disconnecting.
    
</p>
<p>
    In addition to discovering neighbors, it is often valuable to
    simultaneously discover services available from that neighbor.
    Examples of DTN services include a neighbor's available
    Convergence Layer Adapters (CLAs) and their parameters (e.g.
    <a class='info' href='#TCPCLA'>[TCPCLA]<span> (</span><span class='info'>Demmer, M. and J. Ott, &ldquo;Delay Tolerant Networking TCP Convergence Layer Protocol,&rdquo; Nov&nbsp;2008.</span><span>)</span></a>), available routers (e.g. <a class='info' href='#PROPHET'>[PROPHET]<span> (</span><span class='info'>Lindgren, A. and A. Doria, &ldquo;Probabilistic Routing Protocol for Intermittently                        Connected Networks,&rdquo; Mar&nbsp;2006.</span><span>)</span></a>), tunnels, etc.  Newly discovered nodes will
    then typically participate in bundle <a class='info' href='#RFC5050'>[RFC5050]<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a>
    routing and delivery.  
    
</p>
<p>
    In other situations it is useful to decouple service
    discovery from neighbor discovery for efficiency and generality.
    For example, upon discovering a neighbor, a DTN node might
    initiate a separate negotiation process to establish 1-hop
    connectivity via a particular convergence layer, perform routing
    setup, exchange availability information, etc.  
    
</p>
<p>
    IPND beacons thus optionally advertise a node's available
    services while maintaining the ability to decouple node and
    service discovery as necessary.  This flexibility is important to
    various DTN use scenarios where connection opportunities may be
    limited (thus necessitating an atomic message for all
    availability information), bandwidth might be scarce (thus
    implying that service discovery should be an independent
    negotiation to lower beacon overhead), or connections have very
    large round-trip-times (service negotiation is therefore too
    costly with respect to time).
    
</p>
<p>
    DTN IPND is designed to be simple, efficient, and general.
    
</p>
<p>
    Although this document describes a neighbor discovery protocol
    in terms of IP, the principles and basic mechanisms used in this
    protocol may also be expressed in terms of other datagram protocols.
    
</p>
<p>
    The remainder of this document describes DTN IPND.
    
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Terminology</h3>

<p>
      The key words &quot;MUST&quot;, &quot;MUST NOT&quot;,
      &quot;REQUIRED&quot;, &quot;SHALL&quot;, &quot;SHALL NOT&quot;,
      &quot;SHOULD&quot;, &quot;SHOULD NOT&quot;, &quot;RECOMMENDED&quot;,
      &quot;MAY&quot;, and &quot;OPTIONAL&quot; in this document are to be
      interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      
</p>
<p>
      The following terminology is used for describing DTN IPND.
      
</p>
<p>
      </p>
<blockquote class="text">
<p>Bundle: A PDU as defined in <a class='info' href='#RFC5050'>[RFC5050]<span> (</span><span class='info'>Scott, K. and S. Burleigh, &ldquo;Bundle Protocol Specification,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</p>
<p>Node: A DTN entity in the network that receives and
           processes bundles.
</p>
<p>Beacon message: An IPND-specific message, defined in
           this document, used to announce the presence of a
           DTN node and parameters with which to connect to that
           node.
</p>
<p>Convergence layer adapter: A convergence layer adapter
           (CLA) sends and receives bundles on behalf of a node by 
           providing the conversion between bundles and a transport
           protocol such as TCP or UDP.
</p>
</blockquote><p>
      
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Protocol Description</h3>

<p>
    Nodes use DTN IPND beacons, small UDP messages in the IP
    underlay, to advertise presence.  Similarly, IPND beacons
    received from other nodes serve to detect the availability of DTN
    neighbors.  Nodes SHOULD both send and receive beacons.  These
    beacon messages, detailed in <a class='info' href='#beacons'>Section&nbsp;2.3<span> (</span><span class='info'>Beacon Message Format</span><span>)</span></a>, may be
    sent either as IP unicast, multicast, or broadcast UDP packets.
    The beacon message content is agnostic to the underlying
    transport mode.
    
</p>
<p>
    Broadcast beacons are designed to reach unknown neighbors in
    neighborhoods within the local network broadcast domain.
    Multicast <a class='info' href='#RFC1112'>[RFC1112]<span> (</span><span class='info'>Deering, S., &ldquo;Host extensions for IP multicasting,&rdquo; August&nbsp;1989.</span><span>)</span></a> beacons extend the scope of
    beacon dissemination to potentially include multiple networks
    across routed boundaries.  On broadcast media such as Ethernet or
    wireless, multicast and broadcast beacons are sent as link-layer
    broadcast messages.  
    
</p>
<p>
    Broadcast and multicast discovery are described in <a class='info' href='#multicast'>Section&nbsp;2.1<span> (</span><span class='info'>Unknown Neighbors</span><span>)</span></a>.  In contrast, unicast beacons are sent only
    to explicitly known and enumerated neighbors as described in
    <a class='info' href='#unicast'>Section&nbsp;2.2<span> (</span><span class='info'>Enumerated Neighbors</span><span>)</span></a>.
    
</p>
<p>
    Upon discovering a neighbor, IPND can establish a connection
    to the new neighbor via an IP-based Convergence Layer Adapter
    (CLA), for example the TCP <a class='info' href='#TCPCLA'>[TCPCLA]<span> (</span><span class='info'>Demmer, M. and J. Ott, &ldquo;Delay Tolerant Networking TCP Convergence Layer Protocol,&rdquo; Nov&nbsp;2008.</span><span>)</span></a> or UDP <a class='info' href='#UDPCLA'>[UDPCLA]<span> (</span><span class='info'>Kruse, H. and S. Ostermann, &ldquo;UDP Convergence Layers for the DTN Bundle                       and LTP Protocols,&rdquo; Nov&nbsp;2008.</span><span>)</span></a> CLA.  The CLA then negotiates the connection
    per its individual specification and installs the appropriate
    next-hop routing information in the BPA.
    
</p>
<a name="multicast"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Unknown Neighbors</h3>

<p>
      In the general case, the IP addresses of potential
      neighbors are not known in advance.  To discover unknown
      neighbors, IPND beacon messages are sent as IP packets with
      either multicast or broadcast destination addresses.  IPND MUST
      support multicast IP destination addresses <a class='info' href='#RFC1112'>[RFC1112]<span> (</span><span class='info'>Deering, S., &ldquo;Host extensions for IP multicasting,&rdquo; August&nbsp;1989.</span><span>)</span></a> and multicast IGMP group membership <a class='info' href='#RFC3376'>[RFC3376]<span> (</span><span class='info'>Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;Internet Group Management Protocol, Version 3,&rdquo; October&nbsp;2002.</span><span>)</span></a>.  IPND MAY support IP broadcast destinations.
      IPND multicast addresses SHOULD be from the IANA assigned local
      network control block 224.0.0/24 <a class='info' href='#RFC3171'>[RFC3171]<span> (</span><span class='info'>Albanna, Z., Almeroth, K., Meyer, D., and M. Schipper, &ldquo;IANA Guidelines for IPv4 Multicast Address Assignments,&rdquo; August&nbsp;2001.</span><span>)</span></a>.  This
      block of multicast addresses is intentionally scoped to the local
      network to prevent dissemination to the wider Internet.
      
</p>
<p>
      IPND MAY also use other multicast addresses as required, such as
      multicast addresses from the IANA assigned Internetwork Control
      Block <a class='info' href='#RFC3171'>[RFC3171]<span> (</span><span class='info'>Albanna, Z., Almeroth, K., Meyer, D., and M. Schipper, &ldquo;IANA Guidelines for IPv4 Multicast Address Assignments,&rdquo; August&nbsp;2001.</span><span>)</span></a>.
      
</p>
<p>
      In all cases, IPND MUST support a configurable IP time-to-live
      value for all beacon messages.
      
</p>
<a name="unicast"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Enumerated Neighbors</h3>

<p>
      IPND SHOULD support unicast beacons.  IPND is primarily
      designed for discovery of nodes in the current broadcast or
      multicast domain.  However, some situations mandate discovery
      across multiple Internet IP overlay hops.  Across the wide-area
      Internet, multicast or broadcast discovery is not feasible.  In
      such instances, the IP addresses of potential neighbors must be
      explicitly enumerated.  While the neighbor's address is therefore
      known, the availability of that neighbor is not known.  IPND thus
      permits DTN nodes to discover available remote neighbors across
      multiple IP overlay hops simply by enumerating their addresses.
      
</p>
<p>
      Note that unicast discovery scales with the square of the
      number of enumerated nodes, i.e. one beacon packet per enumerated
      destination.  Therefore, unicast discovery is intended for
      relatively small numbers of neighbors.
      
</p>
<a name="beacons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Beacon Message Format</h3>

<p>
      <a class='info' href='#beaconmsg'>Figure&nbsp;1<span> (</span><span class='info'>Beacon Message Format</span><span>)</span></a> depicts the format of beacon messages.
      Note that IPND follows the DTN convention of using Self-Delimiting 
      Numeric Values (SDNVs) <a class='info' href='#SDNV'>[SDNV]<span> (</span><span class='info'>Eddy, W., &ldquo;Using Self-Delimiting Numeric Values in                       Protocols,&rdquo; Jan&nbsp;2009.</span><span>)</span></a> to represent 
      variable length integers (denoted by *).  IPND MUST use UDP 
      checksums to ensure correctness.
      
</p><br /><hr class="insert" />
<a name="beaconmsg"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Version    |     Flags     |         Beacon Len (*)        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          EID Len  (*)         |   Canonical EID (variable)    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
/                   Service Blocks (optional)                   /
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Beacon Message Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
      The beacon message is comprised of the following fields:
      </p>
<ul class="text">
<li>Version: A 1-byte field indicating the version of IPND
         that constructed this beacon.  The present document
         describes version 0x01 of IPND.
</li>
<li>Flags: A 1-byte field indicating IPND processing flags.
         Two flags are currently defined.  0x00 indicates that 
         no special processing should be performed on the beacon.
         0x01 
         indicates that no length or local EID fields follow and
         allows for very short, efficient beacons;
         see <a class='info' href='#zero'>Section&nbsp;2.3.2<span> (</span><span class='info'>Zero-length EID Beacons</span><span>)</span></a> for details.
</li>
<li>Beacon Length: The byte length of the beacon inclusive of the entire
         beacon message, but exclusive of IP or UDP headers.
         The length field is an SDNV and is therefore variable
         length.  A two-octet length is shown for convenience of
         representation.
</li>
<li>EID Length: The byte length of the canonical EID contained
         in the beacon.  The EID length field is an SDNV and is 
         therefore variable length. A two-octet length is shown for 
         convenience of representation.
</li>
<li>Canonical EID: The canonical end node identifier of the neighbor 
         advertised by the beacon message.  The canonical EID is
         variable length and represented as a Uniform Resource
         Identifier <a class='info' href='#RFC3986'>[RFC3986]<span> (</span><span class='info'>Berners-Lee, T., Fielding, R., and L. Masinter, &ldquo;Uniform Resource Identifier (URI): Generic Syntax,&rdquo; January&nbsp;2005.</span><span>)</span></a>.
</li>
<li>Service Blocks: Optional announced services in the beacon,
         described in <a class='info' href='#services'>Section&nbsp;2.3.1<span> (</span><span class='info'>Services</span><span>)</span></a>.
</li>
</ul><p>
      
</p>
<a name="services"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Services</h3>

<p>
        As described previously, beacon messages may optionally
        include service availability information.  The services are
        intended to represent available CLAs, routers, etc., but are
        sufficiently general to accommodate unanticipated services 
        provided by the advertising node.
        
</p>
<p>
        For example, the source IP address of a received beacon
        suffices to identify the remote node at the IP level.  However,
        the IP address alone does not inform other processes via which
        transport mechanism (e.g. TCP or UDP) or via which transport port
        the remote node is offering a connection.  Similarly, nodes do
        not know which routers (e.g. <a class='info' href='#PROPHET'>[PROPHET]<span> (</span><span class='info'>Lindgren, A. and A. Doria, &ldquo;Probabilistic Routing Protocol for Intermittently                        Connected Networks,&rdquo; Mar&nbsp;2006.</span><span>)</span></a>) are
        running on a remote node in order to inform bundle exchange.
        
</p>
<p>
        Therefore, beacons may contain service blocks.  An
        end-node determines the length of the announced service blocks 
        as follows.  
        
</p>
<p>
        A node parses the beacon length and EID length SDNV
        fields.  Let v(b) represent the value of the beacon length and
        v(e) represent the value of the EID length.  The SDNV
        representation of beacon and EID length is itself variable
        length.  Let l(b) represent the on-wire length of the beacon
        length SDNV and l(e) represent the on-wire length of the EID
        length SDNV.  The total byte length of any option service blocks
        is then:
        
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
            service block length = v(b) - 2 - l(b) - l(e) - v(e)
</pre></div>
<p>
        The format of a service block is given in <a class='info' href='#servicesmsg'>Figure&nbsp;2<span> (</span><span class='info'>Service Block Format</span><span>)</span></a>.
        
</p><br /><hr class="insert" />
<a name="servicesmsg"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Service Name Len (*)      | Service Name (variable)       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Service Param Len (*)     | Service Parameters (variable) |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Service Block Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
         A service block is comprised of the following fields:
         </p>
<ul class="text">
<li>Service Name Length: The length of the advertised service
            name or description.  The service name length is an SDNV and
            is therefore variable length.  The service name MUST
            have non-zero length.
</li>
<li>Service Name: An identifying name for the service, e.g.
            "UDPCLA."
</li>
<li>Service Parameters Length: The length of service-specific
            parameters that accompany this announcement.  The service
            parameters length is an SDNV and is therefore variable 
            length.
</li>
<li>Service Parameters: Service-specific parameters required
            to use the service, e.g. "port=4453."
</li>
</ul><p>
         
</p>
<a name="zero"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Zero-length EID Beacons</h3>

<p>
        A beacon with a 0x01 flag has special meaning and
        indicates a "zero-length EID."  IPND MUST support zero-length EID
        beacons.  Neither the beacon length, canonical EID, nor any
        service block fields are present in these beacons, and the total
        length of the beacon is therefore only two octets.  Nodes SHALL
        assume that the canonical EID of a zero-length EID is the
        dotted-quad URI representation of the beacon's source IP address.  
        
</p>
<p>
        Zero-length beacons imply that any remote node receiving
        the beacon may connect via the source IP address of the beacon,
        using the UDP CLA on UDP port 4556.  This optimization is made
        for efficiency and ease of implementation reasons, for instance
        in constrained scenarios where devices are unwilling or unable to
        implement SDNV and a default connection procedure suffices. 
        
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Connection Establishment</h3>

<p>
      Once IPND discovers a new node and the connection
      parameters, it may initiate the connection.  The exact means by
      which IPND communicates with the CLAs is implementation
      dependent.  The specified CLA should establish the connection
      using the methods and conventions defined for that CLA.
      
</p>
<p>
      Note that two nodes may discover each other simultaneously 
      and attempt to initiate connections simultaneously.  In 
      instances of uni-directional CLAs, IPND must provide uni-directional
      discovery.  However, in general, bi-direction CLAs such as
      TCP should attempt to form a single connection rather than two
      separate connections.  IPND does not discern between uni and
      bi-directional connections or address potential race conditions
      in bilateral connection establishment.
      
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Disconnection</h3>

<p>
      Note that IPND SHOULD maintain state over all existing neighbors
      in order to prevent CLAs from needlessly attempting to establish
      connections between nodes that are already connected.  To maintain
      the current neighbor set, IPND removes stale neighbors after the
      defined neighbor receive timeout period elapses without receiving
      any beacon messages from a particular neighbor.  
      
</p>
<p>
      Upon detecting a neighbor that is no longer available, IPND
      MAY provide hints to the CLA that the neighbor is gone.  Note
      that some CLAs themselves provide keepalive-type functionality
      and therefore IPND is not necessarily required to detect down
      neighbors.  However, placing both discovery and availability
      information in IPND provides a single, coherent point in the
      system design to maintain neighbor information.
      
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Relation to Other Discovery Protocols</h3>

<p>
    A variety of discovery protocols exist in other contexts
    and domains.  These discovery protocols include the ability to
    discover available neighbors and services.  For example, the IETF
    zero configuration working group <a class='info' href='#RFC3927'>[RFC3927]<span> (</span><span class='info'>Cheshire, S., Aboba, B., and E. Guttman, &ldquo;Dynamic Configuration of IPv4 Link-Local Addresses,&rdquo; May&nbsp;2005.</span><span>)</span></a>, the
    bonjour protocol <a class='info' href='#BONJOUR'>[BONJOUR]<span> (</span><span class='info'>Cheshire, S., &ldquo;Bonjour,&rdquo; Apr&nbsp;2005.</span><span>)</span></a>, and the OLSR discovery
    protocol <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dearlove, C., and J. Dean, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; Mar&nbsp;2009.</span><span>)</span></a> all provide similar functionality.
    
</p>
<p>
    Other rendezvous mechanisms are possible that allow a node to
    find a neighbor of a particular type or with particular
    properties.  For example, the Domain Name System (DNS) or
    Distributed Hash Tables (DHTs) could be used to find a neighbor
    that provides an inter-planetary gateway.  Such advanced
    rendezvous schemes are beyond the scope of this document.
    
</p>
<p>
    In contrast, DTN-IPND is designed to be DTN-specific,
    efficient, and extremely lightweight.  For instance, DTN-IPND is
    capable of supporting arbitrary length DTN EIDs, and includes CLA
    information in order to maximize the utility of each beacon
    message without requiring multiple round-trip times in order to
    perform complex protocol negotiation.  
    
</p>
<p>
    While DTN-IPND MAY be used in non-DTN environments, its use is
    RECOMMENDED only in DTNs.
    
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Implementation Experience</h3>

<p>
    BBN Technologies has implemented and deployed DTN IPND as part of 
    the SPINDLE <a class='info' href='#SPINDLE'>[SPINDLE]<span> (</span><span class='info'>Krishnan, R., &ldquo;Survivable Policy-Influenced Networking:                        Disruption-tolerance through Learning and Evolution,&rdquo; Oct&nbsp;2006.</span><span>)</span></a> project.
    
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Security Considerations</h3>

<p>
    Neighbor discovery may be perceived as an impediment to
    security because it advertises a potential target for attacks.
    Discovering the existence of a particular node is orthogonal to
    securing the services of that node.  Nodes that desire or require
    higher-levels of security SHOULD disable the broadcast IPND
    beacons and rely instead on static neighbor configuration.
    
</p>
<p>
    Further, neighbor discovery represents a potential source of
    network congestion and contention.  Therefore, careful
    consideration should be made to the frequency and TTL scope of
    beacons when setting implementation-specific parameters,
    particularly when a setting affects larger regions of the
    network.
    
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>
    None at this time.
    
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3986">[RFC3986]</a></td>
<td class="author-text"><a href="mailto:timbl@w3.org">Berners-Lee, T.</a>, <a href="mailto:fielding@gbiv.com">Fielding, R.</a>, and <a href="mailto:LMM@acm.org">L. Masinter</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc3986">Uniform Resource Identifier (URI): Generic Syntax</a>,&rdquo; STD&nbsp;66, RFC&nbsp;3986, January&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3986.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc3986.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc3986.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="BONJOUR">[BONJOUR]</a></td>
<td class="author-text">Cheshire, S., &ldquo;<a href="http://www.apple.com/bonjour">Bonjour</a>,&rdquo; Apr&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="NHDP">[NHDP]</a></td>
<td class="author-text">Clausen, T., Dearlove, C., and J. Dean, &ldquo;<a href="http://tools.ietf.org/id/draft-ietf-manet-nhdp-09.txt">MANET Neighborhood Discovery Protocol (NHDP)</a>,&rdquo; Mar&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="PROPHET">[PROPHET]</a></td>
<td class="author-text">Lindgren, A. and A. Doria, &ldquo;<a href="http://www.dtnrg.org/docs/specs/draft-lindgren-dtnrg-prophet-02.txt">Probabilistic Routing Protocol for Intermittently 
                      Connected Networks</a>,&rdquo; Mar&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1112">[RFC1112]</a></td>
<td class="author-text"><a href="mailto:deering@PESCADERO.STANFORD.EDU">Deering, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1112">Host extensions for IP multicasting</a>,&rdquo; STD&nbsp;5, RFC&nbsp;1112, August&nbsp;1989 (<a href="http://www.rfc-editor.org/rfc/rfc1112.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3171">[RFC3171]</a></td>
<td class="author-text">Albanna, Z., Almeroth, K., Meyer, D., and M. Schipper, &ldquo;<a href="http://tools.ietf.org/html/rfc3171">IANA Guidelines for IPv4 Multicast Address Assignments</a>,&rdquo; RFC&nbsp;3171, August&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3171.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3376">[RFC3376]</a></td>
<td class="author-text">Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A. Thyagarajan, &ldquo;<a href="http://tools.ietf.org/html/rfc3376">Internet Group Management Protocol, Version 3</a>,&rdquo; RFC&nbsp;3376, October&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3376.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3927">[RFC3927]</a></td>
<td class="author-text">Cheshire, S., Aboba, B., and E. Guttman, &ldquo;<a href="http://tools.ietf.org/html/rfc3927">Dynamic Configuration of IPv4 Link-Local Addresses</a>,&rdquo; RFC&nbsp;3927, May&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc3927.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4838">[RFC4838]</a></td>
<td class="author-text">Cerf, V., Burleigh, S., Hooke, A., Torgerson, L., Durst, R., Scott, K., Fall, K., and H. Weiss, &ldquo;<a href="http://tools.ietf.org/html/rfc4838">Delay-Tolerant Networking Architecture</a>,&rdquo; RFC&nbsp;4838, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4838.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5050">[RFC5050]</a></td>
<td class="author-text">Scott, K. and S. Burleigh, &ldquo;<a href="http://tools.ietf.org/html/rfc5050">Bundle Protocol Specification</a>,&rdquo; RFC&nbsp;5050, November&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5050.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="SDNV">[SDNV]</a></td>
<td class="author-text">Eddy, W., &ldquo;<a href="http://tools.ietf.org/id/draft-irtf-dtnrg-sdnv-01.txt">Using Self-Delimiting Numeric Values in
                      Protocols</a>,&rdquo; Jan&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="SPINDLE">[SPINDLE]</a></td>
<td class="author-text">Krishnan, R., &ldquo;<a href="http://www.ir.bbn.com/projects/spindle">Survivable Policy-Influenced Networking: 
                      Disruption-tolerance through Learning and Evolution</a>,&rdquo; Oct&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="TCPCLA">[TCPCLA]</a></td>
<td class="author-text">Demmer, M. and J. Ott, &ldquo;<a href="http://tools.ietf.org/id/draft-irtf-dtnrg-tcp-clayer-02.txt">Delay Tolerant Networking TCP Convergence Layer Protocol</a>,&rdquo; Nov&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="UDPCLA">[UDPCLA]</a></td>
<td class="author-text">Kruse, H. and S. Ostermann, &ldquo;<a href="http://tools.ietf.org/id/draft-irtf-dtnrg-udp-clayer-00.txt">UDP Convergence Layers for the DTN Bundle
                      and LTP Protocols</a>,&rdquo; Nov&nbsp;2008.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Robert Beverly</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BBN Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10 Moulton St.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cambridge, MA  02138</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rbeverly@bbn.com">rbeverly@bbn.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Daniel Ellard</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">BBN Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10 Moulton St.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cambridge, MA  02138</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dellard@bbn.com">dellard@bbn.com</a></td></tr>
</table>
</body></html>
