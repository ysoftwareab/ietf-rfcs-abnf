<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Limits on Sending and Processing IPv6 Extension Headers</title>
<meta content="Tom Herbert" name="author">
<meta content="
       
    This specification defines various limits that may be applied to receiving,
    sending, and otherwise processing packets that contain IPv6 extension
    headers. The need for such limits is pragmatic to facilitate
    interoperability
    amongst hosts and routers in the presence of extension headers and thereby
    increasing the feasibility of deployment of extension headers. The limits
    described here establish the minimum baseline of support for use of extension
    headers in the Internet. If it is known that all communicating parties for
    a particular commumication, including end hosts and any intermediate nodes
    in the path, are capable
    of supporting more than the baseline then these default limits may be freely
    exceeded.
       
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="draft-ietf-6man-eh-limits-00" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/eh-limits-nqs0t1c1.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Extension Header Limits</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Herbert</td>
<td class="center">Expires 4 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-6man-eh-limits-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-01-31" class="published">31 January 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-04">4 August 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">T. Herbert</div>
<div class="org">SiPanda</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Limits on Sending and Processing IPv6 Extension Headers</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
    This specification defines various limits that may be applied to receiving,
    sending, and otherwise processing packets that contain IPv6 extension
    headers. The need for such limits is pragmatic to facilitate
    interoperability
    amongst hosts and routers in the presence of extension headers and thereby
    increasing the feasibility of deployment of extension headers. The limits
    described here establish the minimum baseline of support for use of extension
    headers in the Internet. If it is known that all communicating parties for
    a particular commumication, including end hosts and any intermediate nodes
    in the path, are capable
    of supporting more than the baseline then these default limits may be freely
    exceeded.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 4 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-related-work" class="xref">Related work</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-adherence-to-the-robustness" class="xref">Adherence to the Robustness Principle</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.1">
                    <p id="section-toc.1-1.1.2.2.2.1.1" class="keepWithNext"><a href="#section-1.2.1" class="xref">1.2.1</a>.  <a href="#name-be-conservative-in-what-you" class="xref">Be conservative in what you send</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.2.2.2">
                    <p id="section-toc.1-1.1.2.2.2.2.1" class="keepWithNext"><a href="#section-1.2.2" class="xref">1.2.2</a>.  <a href="#name-be-liberal-in-what-you-rece" class="xref">Be liberal in what you receive</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-overview-and-motivation-of-" class="xref">Overview and motivation of extension header limits</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-types-of-nodes" class="xref">Types of nodes</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-types-of-limits" class="xref">Types of limits</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-limits-on-extension-header-" class="xref">Limits on extension header length</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="xref">2.2.2</a>.  <a href="#name-limits-on-option-length" class="xref">Limits on option length</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.3">
                    <p id="section-toc.1-1.2.2.2.2.3.1"><a href="#section-2.2.3" class="xref">2.2.3</a>.  <a href="#name-limits-on-number-of-extensi" class="xref">Limits on number of extension headers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.4">
                    <p id="section-toc.1-1.2.2.2.2.4.1"><a href="#section-2.2.4" class="xref">2.2.4</a>.  <a href="#name-limits-on-number-of-options" class="xref">Limits on number of options</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.5">
                    <p id="section-toc.1-1.2.2.2.2.5.1"><a href="#section-2.2.5" class="xref">2.2.5</a>.  <a href="#name-limits-on-padding-options" class="xref">Limits on padding options</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2.2.6">
                    <p id="section-toc.1-1.2.2.2.2.6.1"><a href="#section-2.2.6" class="xref">2.2.6</a>.  <a href="#name-limit-on-ipv6-header-chain-" class="xref">Limit on IPv6 header chain length</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-requirements" class="xref">Requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-list-of-limits" class="xref">List of limits</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-host-requirements" class="xref">Host requirements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="xref">3.2.1</a>.  <a href="#name-sending-extension-headers" class="xref">Sending extension headers</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="xref">3.2.2</a>.  <a href="#name-receiving-extension-headers" class="xref">Receiving extension headers</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-intermediate-node-and-inter" class="xref">Intermediate node and intermediate destination requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-intermediate-destination-re" class="xref">Intermediate destination requirements</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
    Extension headers are a core component of the IPv6 protocol as specified in
    <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>. IPv6 extension headers were originally defined
    with few restrictions. For instance, there is no specified limit on the
    number of extension headers a packet may have, nor is there a limit on the
    length in bytes of extension headers in a packet (other than being limited
    by the MTU).
    Similarly, variable length extension headers typically do not have
    prescribed limits such as limits on the number of Hop-by-Hop or
    Destination options in a packet. The lack of limits essentially requires
    implementations
    to handle every conceivable usage of the protocol, including a
    myriad of use cases those are obviously outside the realm of ever being
    realistic or useful in real world deployment.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
    The lack of limits and the requirements for supporting a virtually
    open-ended protocol have led to a significant lack of support
    and deployment of extension headers <span>[<a href="#RFC7872" class="xref">RFC7872</a>]</span>. Instead of
    attempting to satisfy the protocol requirements concerning extension
    headers, some router and middlebox vendors have opted to either invent
    and apply their own ad hoc limits, relegate packets with extension headers
    to slow path processing, or have gone so far as to summarily discard
    all packets with extension headers <span>[<a href="#RFC9098" class="xref">RFC9098</a>]</span>.
    The net result of this situation is that deployment and use of extension
    headers is underwhelming to the extent that they are sometimes considered
    unusable on the Internet, and hence IPv6 extension headers have not lived
    up to their potential as the core extensibility mechanism of IPv6.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
    As an example, consider that Hop-by-Hop Options and Destination Options
    have no limit on how many options may be placed in a packet, nor any limits
    as to how many options a receiver must process. A single
    1500 byte MTU sized packet could legally contain a Hop-by-Hop Options
    extension header with over seven hundred two byte options. There is no
    use case for this other than being a Denial of Service attack where 
    an attacker simply creates packets with hundreds of small unknown
    Hop-by-Hop Options with the two high order bits in the option type set to 00
    meaning to skip the unknown option. Any node in that path that attempts to
    dutifully process all these options per the requirements of
    <span>[<a href="#RFC2460" class="xref">RFC2460</a>]</span> would be easily overwhelmed by the processing needed to parse
    these options (this is true for both hardware or software implementations).<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
    This specification describes various limits that hosts and
    intermediate nodes may apply to the processing of extension headers.
    The goal of establishing limits is to narrow the requirements to better
    match reasonable use cases thereby facilitating practical implementation.
    Subsequently, this increases the viability of extension headers as the
    extensibility mechanism of IPv6.<a href="#section-1-4" class="pilcrow">¶</a></p>
<section id="section-1.1">
        <h3 id="name-related-work">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-related-work" class="section-name selfRef">Related work</a>
        </h3>
<p id="section-1.1-1">
    Some of the problems of unlimited extension headers have been addressed
    in certain aspects.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">
    <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> relaxed the requirement that
    all nodes in the path must process Hop-by-Hop Options to be:<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-3">
          <dt id="section-1.1-3.1"></dt>
          <dd style="margin-left: 1.5em" id="section-1.1-3.2">
 NOTE: While [RFC2460] required that all nodes must examine and
 process the Hop-by-Hop Options header, it is now expected that nodes
 along a packet's delivery path only examine and process the
 Hop-by-Hop Options header if explicitly configured to do so.<a href="#section-1.1-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.1-4">
    Section 5.3 of <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span> defines a number of limits that
    hosts may apply to processing extensions. For instance:<a href="#section-1.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-5">
          <dt id="section-1.1-5.1"></dt>
          <dd style="margin-left: 1.5em" id="section-1.1-5.2">
 A host MAY set a limit on the maximum number of non-padding
 options allowed in the destination options and Hop-by-Hop extension
 headers.  If this feature is supported, the maximum number SHOULD be
 configurable, and the default value SHOULD be set to 8.<a href="#section-1.1-5.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-1.1-6">
   <span>[<a href="#RFC8883" class="xref">RFC8883</a>]</span> defines a set of ICMP errors that my be sent if
   a limit concerning extension headers is exceeded and a node discards a
   packet as a result. This RFC allows both hosts and routers to send such
   messages (effectively acknowledging that some routers drop
   packets with extension headers even though such behavior is non-conformant with
   <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>).<a href="#section-1.1-6" class="pilcrow">¶</a></p>
<p id="section-1.1-7">
   <span>[<a href="#RFC7872" class="xref">RFC7872</a>]</span> presents real-world data regarding the extent to
   which packets with IPv6 Extension Headers (EHs) are dropped in the Internet,
   and <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> summarizes the operational implications of IPv6
   extension headers, and attempts to analyze reasons why packets with IPv6
   extension headers are often dropped in the public Internet.<a href="#section-1.1-7" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2">
        <h3 id="name-adherence-to-the-robustness">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-adherence-to-the-robustness" class="section-name selfRef">Adherence to the Robustness Principle</a>
        </h3>
<p id="section-1.2-1">
The robustness principle, or Postel's Law, can be stated as "Be conservative
in what you send, liberal in what you receive". This section considers
the limits defined in this specification with respect to the robustness
principle.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<section id="section-1.2.1">
          <h4 id="name-be-conservative-in-what-you">
<a href="#section-1.2.1" class="section-number selfRef">1.2.1. </a><a href="#name-be-conservative-in-what-you" class="section-name selfRef">Be conservative in what you send</a>
          </h4>
<p id="section-1.2.1-1">
The limits on sending extension headers are well aligned with the send
clause of the robustness principle. A sender of extension headers is generally
constrained in its use of extension headers. Most of these limits are
assumed to be the default to apply in an arbitrary environment such as the
public Internet, that is they can be considered "baseline limits". These limits
may be relaxed if a sender has a priori information
that all possible nodes in path will properly handle packets that
exceed the baseline limits. In particular, if a sender is sending in a
limited domain, it might be known that all nodes in the limited domain have
sufficient capabilities to handle packets exceeding the baseline limits.<a href="#section-1.2.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-1.2.2">
          <h4 id="name-be-liberal-in-what-you-rece">
<a href="#section-1.2.2" class="section-number selfRef">1.2.2. </a><a href="#name-be-liberal-in-what-you-rece" class="section-name selfRef">Be liberal in what you receive</a>
          </h4>
<p id="section-1.2.2-1">
Considering the receive clause of the robustness principle, this specification
recommends
that receivers accept all packets with extension headers, however they may
ignore extension headers or options within extension headers (in accordance with
<span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>). In particular, the philosophy of this specification is that
intermediate nodes should not drop packets on the basis that they don't have sufficient
capabilities to process all the headers in a packet. As such, intermediate nodes may define
arbitrarily restrictive limits on what they process with regards to extension
headers as long as the action taken when those limits are exceeded is to
ignore items beyond the limit. Hosts are more constrained in this regard
since they generally can't correctly process a packet without processing all
the headers, so when limits are exceeded on a host, packets should be dropped.
It should be noted that hosts stacks inherently have more processing
capabilities than intermediate nodes, so it is expected that they should
be able to support higher limits for processing extension headers.<a href="#section-1.2.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2.2-2">
This specification does specify one hard requirement for receiving nodes,
namely nodes must be able to properly handle packets having an IPv6
header chain length up to 104 bytes. This requirement acknowledges that
some intermediate nodes perform deep packet inspection to extract
information from transport layer headers <span>[<a href="#RFC9098" class="xref">RFC9098</a>]</span>.
Often a node that requires parsing transport layer information will have a
fixed sized "parsing buffer" to contain packet headers. If the transport
layer headers within a packet are beyond the extent of the parsing buffer
then an implementation may take some detrimental action such as arbitrarily
dropping packets. To this end, this specification requires that any
intermediate node that requires access to to transport layer header must
minimally be able to parse at least 128 bytes of headers, from which the
104 byte limit for the IP header chain is derived.<a href="#section-1.2.2-2" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<section id="section-2">
      <h2 id="name-overview-and-motivation-of-">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-overview-and-motivation-of-" class="section-name selfRef">Overview and motivation of extension header limits</a>
      </h2>
<p id="section-2-1">
This specification considers extension header limits in three dimensions:
1) The types of nodes that may process extension headers and the requirements
specific to each type, 2) The types of limits that may be applied, 3) The action
taken when a limit is exceeded.<a href="#section-2-1" class="pilcrow">¶</a></p>
<section id="section-2.1">
        <h3 id="name-types-of-nodes">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-types-of-nodes" class="section-name selfRef">Types of nodes</a>
        </h3>
<p id="section-2.1-1">
For the purposes of describing handling of extension headers this specification
considers three types of node in an IPv6 network:<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.1-2">
          <dt id="section-2.1-2.1">*</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.2">
     Hosts: The source of an IPv6 packet, as addressed by the
     source address, or the final destination node of a packet as
     addressed by the destination address in a packet with no Routing
     header or as addressed by last segment in a Routing header.<a href="#section-2.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.3">*</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.4">
     Intermediate destination: An intermediate destination node in a
     Routing header as addressed by the destination address of a packet with
     a Routing header where the address is not the address for the last segment
     in the Routing header<a href="#section-2.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.1-2.5">*</dt>
          <dd style="margin-left: 1.5em" id="section-2.1-2.6">
     Intermediate nodes: A router on the path that is not addressed
     by the packet's destination address.<a href="#section-2.1-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-2.2">
        <h3 id="name-types-of-limits">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-types-of-limits" class="section-name selfRef">Types of limits</a>
        </h3>
<p id="section-2.2-1">
The limits and requirements for handling extension headers defined in this
specification fall in the following categories:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-2">
          <dt id="section-2.2-2.1">*</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.2">
     Limits on extension header length<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">*</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.4">
     Limits on option length<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">*</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.6">
     Limits on number of extension headers<a href="#section-2.2-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.7">*</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.8">
     Limits on number of options<a href="#section-2.2-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.9">*</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.10">
        Limits on padding for extension headers with options<a href="#section-2.2-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.11">*</dt>
          <dd style="margin-left: 1.5em" id="section-2.2-2.12">
         Limits on the length of the IPv6 header chain<a href="#section-2.2-2.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<section id="section-2.2.1">
          <h4 id="name-limits-on-extension-header-">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-limits-on-extension-header-" class="section-name selfRef">Limits on extension header length</a>
          </h4>
<p id="section-2.2.1-1">
   <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span> defines limits that may be defined for the length of an extension
   header. Those limits are extended to be applicable to intermediate nodes.
   <span>[<a href="#RFC8883" class="xref">RFC8883</a>]</span> defines ICMP Parameter Problem codes that may be
   sent when an extension header is exceeded.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2.2">
          <h4 id="name-limits-on-option-length">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-limits-on-option-length" class="section-name selfRef">Limits on option length</a>
          </h4>
<p id="section-2.2.2-1">
   A node may establish a limit on the size Hop-by-Hop or Destination options.
   Conceivably, such a limit could apply to all option types, or length limits
   may be specific to individual options. 
   <span>[<a href="#RFC8883" class="xref">RFC8883</a>]</span> defines ICMP Parameter Problem codes that may be
   sent when an option length limit is exceeded.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2.3">
          <h4 id="name-limits-on-number-of-extensi">
<a href="#section-2.2.3" class="section-number selfRef">2.2.3. </a><a href="#name-limits-on-number-of-extensi" class="section-name selfRef">Limits on number of extension headers</a>
          </h4>
<p id="section-2.2.3-1">
    A node may define a limit on the number of extension headers it will
    process. Although <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> only defines four types of
    extension headers, it does
    not preclude the same type of extension header being present multiple
    times. A limit on the number of extension headers could be useful to disallow
    packets that contain multiple instances of the same extension header.<a href="#section-2.2.3-1" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2.4">
          <h4 id="name-limits-on-number-of-options">
<a href="#section-2.2.4" class="section-number selfRef">2.2.4. </a><a href="#name-limits-on-number-of-options" class="section-name selfRef">Limits on number of options</a>
          </h4>
<p id="section-2.2.4-1">
    Limits may be established for the number of options sent or
    received (specifically applicable to Hop-by-Hop options and Destination
    options). The need for this limit arises from the fact that
    <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> does
    not specify a limit. Requiring nodes to process packets with tens or
    hundreds of options has no foreseeable use cases in deployment except as a
    denial of service attack.  <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span> has proposed such a limit for host
    processing of Hop-by-Hop and Destination options with a default of eight
    options. This specification extends that limit to be applicable to
    intermediate nodes.
    Specific limits may be established for number of non-padding options
    or the number of all options including padding.<a href="#section-2.2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.2.4-2">
    To derive a limit on all options, one can assume that at most one
    padding option is used between two non-padding options (an explicit
    limit on consecutive padding options is described below). With this
    assumption, we can extrapolate a reasonable limit on the number of all options
    that should be twice the limit of the number of non-padding options. Per
    <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span>, the recommended default limit for number of non-padding options
    is eight, so this specification establishes a maximum default limit
    of sixteen options including padding options.
    The choice of sixteen options as a default limit attempts to strikes a balance
    between allowing extensibility and maintaining reasonable expectations for
    node processing requirements.<a href="#section-2.2.4-2" class="pilcrow">¶</a></p>
<p id="section-2.2.4-3">
    With regards to extensibility, it is observed that in the
    almost thirty year history of IPv6 there are only thirteen defined
    non-deprecated Destination options and Hop-by-Hop options and three
    temporary assigned options. Current evidence suggests that having
    more than one Destination option or Hop-by-Hop option in a packet is rare,
    and extrapolating that point with the rate of new options being defined
    suggests a limit of eight non-padding options allows for sufficient
    extensibility in the foreseeable future.<a href="#section-2.2.4-3" class="pilcrow">¶</a></p>
<p id="section-2.2.4-4">
    With regards to processing requirements, TLVs, e.g. Hop-by-Hop
    options and Destination options, have historically been considered difficult
    to process efficiently due to their serial processing
    requirements and combinatorial nature. TLV processing has been a
    particularly acute problem for Ased SIC devices. Recently, there is a strong
    trend in programmable implementation even in high performance routers
    using emerging programming frameworks such as PANDA and P4. Programmable
    implementations are better equipped to handle
    TLVs, at least for a reasonably small number. It might also be pointed
    that the need to efficiently process TLVs
    exists in other protocols, for instance processing TCP requires processing
    of TLVs which are an intrinsic part of the protocol.<a href="#section-2.2.4-4" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2.5">
          <h4 id="name-limits-on-padding-options">
<a href="#section-2.2.5" class="section-number selfRef">2.2.5. </a><a href="#name-limits-on-padding-options" class="section-name selfRef">Limits on padding options</a>
          </h4>
<p id="section-2.2.5-1">
   <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> defines PAD1 and PADN options that respectively provide one byte
   or N bytes of padding in an extension header. The purpose of padding is
   to properly align the following non-padding option to it's expected
   alignment, or to add padding after the last Destination or Hop-by-Hop
   option so that the length of the extension header is a multiple of eight
   bytes as required by <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>. <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span> defines limits on number of
   bytes used for consecutive padding where the amount of padding between
   options or at the end of the extension header is no more than eight bytes;
   this limit is sufficient to align any following data after the padding to
   eight bytes. These limits are extended to be applicable to intermediate
   nodes.<a href="#section-2.2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.2.5-2">
   This specification allows a receiving node to set a requirement that
   consecutive padding options are not present in a packet; which in turn
   requires a sender to not place consecutive padding options in a packet. The
   rationale for this limit is that a PAD1 or PADN option is able to
   provide one to 257 bytes of padding, so a single padding option is
   sufficient for any expected use case of padding. 
   When the sender creates options, it can compute the amount of padding
   necessary to satisfy the alignment requirements of the following data. If
   one byte of padding is needed a PAD1 option is used, if more than one byte
   of padding is needed then an appropriate PADN options.<a href="#section-2.2.5-2" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2.6">
          <h4 id="name-limit-on-ipv6-header-chain-">
<a href="#section-2.2.6" class="section-number selfRef">2.2.6. </a><a href="#name-limit-on-ipv6-header-chain-" class="section-name selfRef">Limit on IPv6 header chain length</a>
          </h4>
<p id="section-2.2.6-1">
   Intermediate nodes often perform deep packet inspection (DPI) in
   order to implement various functions in the network. Routers perform
   DPI when they inspect packets beyond the IPv6 header or beyond Hop-by-Hop
   options if they are present. Some router implementations must inspect
   the transport layer headers in order to process and forward the packet, and
   if the transport layer headers are not readable a packet may be dropped.
   Even if a transport layer header is in plain text within a packet, some
   devices may not be capable of reading it if the header is
   too deep in the packet.<a href="#section-2.2.6-1" class="pilcrow">¶</a></p>
<p id="section-2.2.6-2">
   Hardware devices often have constraints on how much of the headers in
   a packet can be parsed for DPI. A typical design is that some portion
   of the beginning of a received packet is loaded into a memory buffer
   for header parsing (i.e. the parsing buffer). The size of this parsing
   buffer is often fixed per device.<a href="#section-2.2.6-2" class="pilcrow">¶</a></p>
<p id="section-2.2.6-3">
   To derive a size limit on the IPv6 header chain, we need to take into
   account headers in a packet that might be subject to DPI which
   include the link layer header through at least the pertinent fields
   of the transport layer header. The most common required information is
   the transport layer port numbers which typically occupy the first four
   bytes of the transport headers (e.g. TCP, UDP, SCTP, DCCP, etc.).
   Inspection of port numbers may be needed for stateless load
   balancing as well as port filtering. There are middleboxes that may
   need to inspect more of transport layer headers or the transport payload,
   however those can be considered specialized devices that perform work
   beyond simple packet forwarding and filtering and hence should have more
   capabilities for DPI.<a href="#section-2.2.6-3" class="pilcrow">¶</a></p>
<p id="section-2.2.6-4">
   In addition to limits on the length of the IP header chain, it is
   conceivable that there could be a limit on the length of the whole
   header chain. The whole header chain would comprise the IPv6 header
   chain as well as any headers that are part of network encapsulation
   that precede the innermost transport layer. The definition of such
   a limit is out of scope for this document, however
   <span>[<a href="#RFC8883" class="xref">RFC8883</a>]</span> defines an ICMP error to send when a limit on
   size of an aggregate header chain is exceeded.<a href="#section-2.2.6-4" class="pilcrow">¶</a></p>
<p id="section-2.2.6-5">
   This document specifies that the minimum supported limit for IPv6 header
   chains is 104 bytes. The value is derived by assuming that nodes have
   the ability to process at least the first 128 bytes of a packet (that is
   they have a parsing buffer that can contain at least 128 bytes).
   The 128 byte parsing buffer would be expected to at least contain:<a href="#section-2.2.6-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2.6-6">
            <dt id="section-2.2.6-6.1">*</dt>
            <dd style="margin-left: 1.5em" id="section-2.2.6-6.2">
     16 bytes for a Layer 2 header (e.g. Ethernet header)<a href="#section-2.2.6-6.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-2.2.6-6.3">*</dt>
            <dd style="margin-left: 1.5em" id="section-2.2.6-6.4">
     40 bytes for the IPv6 header<a href="#section-2.2.6-6.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-2.2.6-6.5">*</dt>
            <dd style="margin-left: 1.5em" id="section-2.2.6-6.6">
     64 bytes for the extension headers<a href="#section-2.2.6-6.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-2.2.6-6.7">*</dt>
            <dd style="margin-left: 1.5em" id="section-2.2.6-6.8">
     8 bytes for the transport layer (i.e the first eight bytes of
            the transport layer header<a href="#section-2.2.6-6.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-2.2.6-7">
    This scheme thus establishes a requirement that all Internet devices
    are capable of correctly processing packets with up to sixty-four bytes
    of extension headers, and subsequently it establishes a requirement
    that a host shouldn't send packets with more than sixty-four bytes of
    extension headers. Note that this establishes a global baseline requirement
    across the Internet, within a limited domain higher limits could be applied.<a href="#section-2.2.6-7" class="pilcrow">¶</a></p>
<p id="section-2.2.6-8">
    128 bytes is likely the minimal useful parsing buffer size in deployment
    today. Devices performing a very narrow DPI could conceptually use a
    smaller parsing buffer, for instance that
    could be as small as sixty-four bytes which accommodates an L2 header,
    IPv6 header, and eight bytes of transport header; however, such a device
    would be extremely limited in capabilities and if they do exist they are
    likely legacy devices that will eventually be decommissioned. Many routers
    now have the capability to perform DPI into encapsulation headers
    which implies they already have a larger parsing buffer than this baseline 
    minimum.<a href="#section-2.2.6-8" class="pilcrow">¶</a></p>
<p id="section-2.2.6-9">
    Similar to limiting the number of options allowing in a packet, setting
    a limit for IP header length chain is a tradeoff between extensibility
    and feasible implementation.<a href="#section-2.2.6-9" class="pilcrow">¶</a></p>
<p id="section-2.2.6-10">
    For extensibility, the pertinent extension headers contributing
    to the sixty-four byte limit are mostly Hop-by-Hop and Destination
    options.  The Routing Header extension header is really intended for
    limited domains and not the Internet (e.g. SRv6 Routing Header is confined to
    a Segment Routing Domain) and therefore would be subject to a domain
    specific limit for IP header chain length. Encryption Header may be used on
    the Internet, however encryption obfuscates the encapsulated transport
    headers such that such that intermediate nodes can't inspect them
    regardless of their position in a packet. Fragmentation may be used in the
    Internet, however only the first fragment of a fragmented packet might
    contain transport layer headers that could be read by an Intermediate node.
    In any case, the Fragment Header is only four bytes so that would not
    be a particularly large portion of a sixty-four byte limit.<a href="#section-2.2.6-10" class="pilcrow">¶</a></p>
<p id="section-2.2.6-11">
    The Authentication Header is usable on the Internet and does allow
    the transport layer headers to be in readable in plain text. However,
    Authentication Header is relatively large, typically thirty-two bytes or
    more, so it would contribute significantly to a limit on IP header
    chain length. On the other hand, the use of Authentication Header, without
    encryption, is currently rare on the Internet.<a href="#section-2.2.6-11" class="pilcrow">¶</a></p>
<p id="section-2.2.6-12">
    Individual Hop-by-Hop Destination Options may also be categorized as
    being intended for use over the Internet or just in limited domains.
    For instance, the IOAM Hop-by-Hop option is intended for use in limited
    domains.<a href="#section-2.2.6-12" class="pilcrow">¶</a></p>
<p id="section-2.2.6-13">
    Paring this down, the types extension headers and Destination and Hop-by-Hop
    options that might be used outside of limited domains are fairly limited.
    Options that are intended for use over the public
    Internet could be defined to be small and compact to promote not
    exceeding a sixty-four byte limit on extension headers, whereas options
    constrained to a limited domain could be larger since larger limits can
    be assumed.<a href="#section-2.2.6-13" class="pilcrow">¶</a></p>
<section id="section-2.2.6.1">
            <h5 id="name-action-when-limit-is-exceed">
<a href="#section-2.2.6.1" class="section-number selfRef">2.2.6.1. </a><a href="#name-action-when-limit-is-exceed" class="section-name selfRef">Action when limit is exceeded</a>
            </h5>
<p id="section-2.2.6.1-1">
    For each limit that is defined, an action is specified for when the limit
    is exceeded. The appropriate action depends on whether the processing
    node is the destination host, an intermediate destination, or an
    intermediate node. For a destination host, the typical action to take
    when a limit is exceeded is to discard the packet. This is appropriate
    since the destination host is required to process all of the headers in
    a packet, and if a limit is exceeded then it cannot process the packet
    so there is no other alternative but to discard.<a href="#section-2.2.6.1-1" class="pilcrow">¶</a></p>
<p id="section-2.2.6.1-2">
    For intermediate nodes, the typical action to take when a limit is
    exceeded is to stop processing headers at the point the limit is
    reached and to forward the packet on.
    <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> allows
    that an intermediate may not process the Hop-by-Hop Options extension
    headers therefore an intermediate node may  ignore all of the Hop-by-Hop
    options in a packet. This specification expands on that requirement
    to allow an intermediate node to process some arbitrary subset of
    consecutive Hop-by-Hop options in the TLV list and to ignore
    the following ones. In the case of an egregious violation of
    a limit, for instance an attacker sends three hundred options in a packet,
    the destination host can decide if the appropriate response is to drop (the
    destination host must process all options). Note that this provision
    motivates the sender to place Hop-by-Hop Options in the packet so that
    those considered more important are placed first.
    It should also be noted that <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> sets a default limit
    of eight; this specification adds a counterpart for sending hosts that
    they shouldn't send more than eight Hop-by-Hop options.<a href="#section-2.2.6.1-2" class="pilcrow">¶</a></p>
<p id="section-2.2.6.1-3">
    Intermediate destinations have characteristics of both hosts and
    intermediate modes. If a limit is exceeded related to Hop-by-Hop options
    then the suggested action in this specification is to assume
    the same processing of limits as intermediate nodes. If limits are
    exceeded that affect the processing specific to an intermediate
    destination, such as limits on Destination options
    before the Routing header, then the action should be to discard packet.<a href="#section-2.2.6.1-3" class="pilcrow">¶</a></p>
</section>
</section>
</section>
</section>
<section id="section-3">
      <h2 id="name-requirements">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-3-1">
This section lists the normative requirements related to sending and
processing extension headers.<a href="#section-3-1" class="pilcrow">¶</a></p>
<section id="section-3.1">
        <h3 id="name-list-of-limits">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-list-of-limits" class="section-name selfRef">List of limits</a>
        </h3>
<p id="section-3.1-1">
    The set of limits that a node may apply when processing extension headers
    include:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.1-2">
          <dt id="section-3.1-2.1">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.2">
     Too many non-padding or padding options<a href="#section-3.1-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.3">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.4">
     Extension header too big<a href="#section-3.1-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.5">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.6">
     Option too big<a href="#section-3.1-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.7">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.8">
     Too many consecutive padding options<a href="#section-3.1-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.9">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.10">
     Too many consecutive bytes of padding<a href="#section-3.1-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.11">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.12">
     Extension header chain too long<a href="#section-3.1-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.13">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.14">
     Aggregate header chain too long<a href="#section-3.1-2.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.1-2.15">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.1-2.16">
     Too many extension headers<a href="#section-3.1-2.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-3.2">
        <h3 id="name-host-requirements">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-host-requirements" class="section-name selfRef">Host requirements</a>
        </h3>
<section id="section-3.2.1">
          <h4 id="name-sending-extension-headers">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-sending-extension-headers" class="section-name selfRef">Sending extension headers</a>
          </h4>
<p id="section-3.2.1-1">
The requirements are:<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.1-2">
            <dt id="section-3.2.1-2.1">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.2">
    A host MUST NOT send more than 8 non-padding options in
    Destination Options in a packet unless it has explicit knowledge
    that the destination, or all intermediate destinations in the case
    of Destination Options before the routing header, are able to process
    a greater number of options.<a href="#section-3.2.1-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.3">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.4">
    A host MUST NOT send more than 8 non-padding options in
    Hop-by-Hop Options in a packet unless it has explicit knowledge that
    the final destination host is able to process a greater number of
    options.<a href="#section-3.2.1-2.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.5">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.6">
    A host SHOULD NOT send more than 8 non-padding options in
    Hop-by-Hop Options in a packet unless it has explicit knowledge that
    all possible intermediate nodes are able to process a greater number
    of options or will ignore options that exceeds their limit.<a href="#section-3.2.1-2.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.7">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.8">
    A host MUST NOT send a packet with an extension header larger
    than 64 bytes unless it has explicit knowledge that all
    nodes that might process the extension header are capable of
    processing a larger header.<a href="#section-3.2.1-2.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.9">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.10">
    A host MUST NOT send a packet with a Destination option or
    Hop-by-Hop option with Data Length greater than 60 bytes
    unless it has explicit knowledge that all nodes that might process
    the option are capable of processing ones with a larger Data Length.<a href="#section-3.2.1-2.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.11">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.12">
    A host node MUST NOT send a packet with an IPv6 header chain larger
    than 104 bytes unless it has explicit knowledge that all nodes in
    the path are capable of properly handling packets with larger header
    chains. This requirements is equivalently
    stated as a host MUST NOT send a packet with more than
    64 bytes of aggregate extension headers.<a href="#section-3.2.1-2.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.13">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.14">
    A host MUST NOT set more than one consecutive pad option, either
           PAD1 or PADN, in Destination options or Hop-by-Hop options.<a href="#section-3.2.1-2.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.15">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.16">
    A host MUST NOT send a PadN option in Hop-by-Hop Options or
    Destination Options with total length of more than seven bytes.<a href="#section-3.2.1-2.16" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.17">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.18">
    A host node MUST NOT send more than 16 options (padding or
    non-padding) Destination options in a packet unless it has explicit
    knowledge that the destination, or all intermediate destinations in
    the case of Destination Options before the routing header, are able
    to process a greater number of options. Note that if the above
    requirements on a host sending non-padding Destination options and
    requirements on option padding are met, then this requirement is
    implicitly satisfied.<a href="#section-3.2.1-2.18" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.1-2.19">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.1-2.20">
    A host node MUST NOT send more than 16 options (padding or
    non-padding) in Hop-by-Hop Options in a packet unless it has explicit
    knowledge that the final destination host is able to process a
    greater number of options. Note that if the above requirements on a
    host sending non-padding Hop-by-Hop options and requirements on
    padding are met, then this requirement is implicitly satisfied.<a href="#section-3.2.1-2.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
<section id="section-3.2.2">
          <h4 id="name-receiving-extension-headers">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-receiving-extension-headers" class="section-name selfRef">Receiving extension headers</a>
          </h4>
<p id="section-3.2.2-1">
Per <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>, a host node that receives a packet with extension headers
must process all the extension headers in the packet before accepting the
payload and processing the payload.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">
As described in <span>[<a href="#RFC8504" class="xref">RFC8504</a>]</span> a host may establish limits on the processing of
extension headers. This specification reiterates and updates those requirements
to allow for a host to send an RFC8883 error if a limit has been exceeded.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-3">
            <dt id="section-3.2.2-3.1">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-3.2">
     A host MAY set a limit on the maximum number of non-padding
         options allowed in the Destination Options or Hop-by-Hop Options
     extension headers.  If this limit is supported then the maximum
     number SHOULD
     be configurable, the limit MUST be greater than or equal to
     8, and the default value SHOULD be set to 8. The
     limits for Destination options and Hop-by-Hop options MAY be
     separately configurable. If a packet is received and the number of
     Destination or Hop-by-Hop options exceeds the limit, then the
     packet SHOULD be discarded and and an ICMP Parameter Problem with
     code 9 MAY be sent to the packet's source address.<a href="#section-3.2.2-3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.3">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-3.4">
     A host MAY set a limit on the maximum number of options (padding
     or non-padding) allowed in Destination Options or Hop-by-Hop
     Options extension headers. If this limit is supported then the
     maximum number SHOULD be configurable and the limit MUST be
     greater than or equal to 16. The limits for Destination options and
     Hop-by-Hop
     options MAY be separately configurable.  If a packet is received
     and the number of destination or Hop-by-Hop options exceeds the
     limit, then the packet SHOULD be discarded and and an ICMP Parameter
     Problem with code 9 MAY be sent to the packet's source address<a href="#section-3.2.2-3.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.5">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-3.6">
     A host node MAY set a limit on the length of an extension header.
     If this limit is supported then the limit SHOULD be configurable
     and the
     limit MUST be greater than or equal to 64 bytes. The length
     limits for different extension headers MAY be separately
     configurable.<a href="#section-3.2.2-3.6" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.7">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-3.8">
     A host node MAY set a limit on the Data Length of a Hop-by-Hop or
     Destination option. If this limit is supported then the limit
     SHOULD be configurable, and the limit MUST be greater than or
     equal to 60 bytes. The limits for Destination options and
     Hop-by-Hop options MAY be separately configurable. If a packet is
     received and a Hop-by-Hop or destination option has a length that
     exceeds the limit, then the packet SHOULD be discarded and an ICMP
     Parameter
     Problem with code 10 MAY be sent to the packet's source address.<a href="#section-3.2.2-3.8" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.9">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-3.10">
     A host MAY limit the number of consecutive PAD1 options in
     destination options or Hop-by-Hop options to 7. In this case, if
     there are more than 7 consecutive PAD1 options present, the packet
     SHOULD be discarded and an ICMP Parameter Problem with code 10
     MAY be sent to the packet's source address<a href="#section-3.2.2-3.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.11">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-3.12">
     A host MAY limit the number of bytes in a PADN option to be less
     than 8. In such a case, if a PADN option is present that has a
     length greater than 7, the packet SHOULD be discarded and an ICMP
     Parameter Problem with code 10 MAY be sent to the packet's
     source address.<a href="#section-3.2.2-3.12" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.13">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-3.14">
     A host MAY set a limit on the maximum length of Destination
     Options or Hop-by-Hop Options extension headers.  This value SHOULD
     be configurable, and if the limit is used then the limit
     MUST be greater than or equal to 64 bytes.
     If a packet is received and the length of the Destination or
            Hop-by-Hop Options extension header exceeds the length limit,
     then the packet SHOULD be discarded and an ICMP
            Parameter Problem with code 6 MAY be sent to the packet's
            source address.<a href="#section-3.2.2-3.14" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-3.2.2-3.15">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-3.16">
    A host node MAY set a limit on the maximum length of the
    IPv6 header chain, or equivalently a host MAY set a limit on the
    aggregate length of extension headers in a packet. If the limit is
    used then it MUST be greater than or equal to 104 bytes, or,
    equivalently, the limit on aggregate header extension length
    MUST be greater than or equal to 64 bytes.
    If a packet is received and the aggregate length of the IPv6
    header chain exceeds the limit then the
    packet SHOULD be discarded and an ICMP Parameter Problem with code
    7 MAY be sent to the packet's source address.<a href="#section-3.2.2-3.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.2.2-4">
Additional host requirements for receive.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2.2-5">
            <dt id="section-3.2.2-5.1">*</dt>
            <dd style="margin-left: 1.5em" id="section-3.2.2-5.2">
     A host MAY disallow consecutive padding options, either PAD1 or
     PADN, to be present in a packet. If consecutive padding options
     are received and disallowed by the host, the then packet SHOULD be
     discarded and an ICMP Parameter Problem with code 9 MAY be sent to
     the packet's source address.<a href="#section-3.2.2-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-3.3">
        <h3 id="name-intermediate-node-and-inter">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-intermediate-node-and-inter" class="section-name selfRef">Intermediate node and intermediate destination requirements</a>
        </h3>
<p id="section-3.3-1">
The following requirements are established for intermediate nodes and
intermediate destination nodes that receive and process packets with extension
header.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.3-2">
          <dt id="section-3.3-2.1">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-2.2">
    An intermediate node MUST be able to correctly forward packets that
    contain an IPv6 header chain of 104 or fewer bytes, or equivalently
    an intermediate node MUST be able to process a packet with an
    aggregate length of extension headers less than or equal to 64
    bytes.<a href="#section-3.3-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.3">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-2.4">
    Per <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span> an intermediate node MAY be configured to not process
    Hop-by-Hop Options. If a node is configured as such and a packet
    with Hop-by-Hop options is received, the extension header MUST be
    be skipped and the packet MUST otherwise be properly
    processed and forwarded.<a href="#section-3.3-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.5">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-2.6">
    An intermediate node MAY limit the number of non-padding 
    Hop-by-Hop options
    that it processes. If a limit is exceeded, that is a
    packet contains more non-padding options than are configured to
    process, the intermediate SHOULD stop processing the Hop-by-Hop
    Option and ignore any options in the chain beyond the limit. It is
    NOT RECOMMENDED that an intermediate node discards the packet
    because
    the limit is exceeded, however if it does so then the intermediate
    node MAY send an ICMP Parameter Problem with code
    10 MAY be sent to the packet's source address.<a href="#section-3.3-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.7">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-2.8">
    An intermediate node MAY limit the number of Hop-by-Hop
    options (padding or
    non-padding) that it processes. If a limit is exceeded, that is a
    packet contains more non-padding options than are configured to
    process, the intermediate SHOULD stop processing the Hop-by-Hop
    options and ignore any options in the chain beyond the limit. It is
    NOT RECOMMENDED that the intermediate node discards the packet
    because
    the limit is exceeded, however if it does so then the intermediate
    node MAY send an ICMP Parameter Problem with code
    10 to the packet's source address.<a href="#section-3.3-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.9">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-2.10">
    If an intermediate node encounters an unknown Hop-by-Hop option
    and the two high order bits are not 00 then the node SHOULD
    immediately stop processing the option chain and ignore any
    options in the chain beyond the unknown option. An intermediate node
    MAY either elect to discard the packet and MAY send an ICMP
    Parameter Problem per the requirements of <span>[<a href="#RFC8200" class="xref">RFC8200</a>]</span>; or the
    intermediate node MAY forward the packet.<a href="#section-3.3-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.3-2.11">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.3-2.12">
    An intermediate node MAY set a limit on the maximum length of
    Hop-by-Hop Options extension headers. This value SHOULD be
    configurable. If this limit is exceeded, that is a
    packet has an extension header larger then the limit, then
    the intermediate node SHOULD stop processing the Hop-by-Hop
    Option and ignore any options in the chain beyond the limit. It is
    NOT RECOMMENDED that the intermediate node discards the packet
    because the limit is exceeded, however if it does so then the
    intermediate node MAY send an ICMP Parameter Problem with code
    10 MAY be sent to the packet's source address.<a href="#section-3.3-2.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-3.4">
        <h3 id="name-intermediate-destination-re">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-intermediate-destination-re" class="section-name selfRef">Intermediate destination requirements</a>
        </h3>
<p id="section-3.4-1">
The following are requirements specific to intermediate destinations
pertaining to the processing of Destination Options before the Routing header.
For processing Hop-by-Hop options at an intermediate destination the requirement
for processing them at an intermediate node are assumed.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.4-2">
          <dt id="section-3.4-2.1">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.2">
    An intermediate destination MAY set a limit on the maximum length of
    Destination Options extension header before the Routing header.
    This value SHOULD be configurable, and the default is to accept
    options of any length. If a limit is defined is MUST be at least
    64 bytes. If the limit is exceeded then the intermediate destination
    SHOULD discard the packet and MAY send an ICMP Parameter Problem
    with code 6 to the packet's source address.<a href="#section-3.4-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.3">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.4">
    An intermediate destination node MAY limit the number of
    non-padding options in Destination Options before the Routing header.
    If a limit is exceeded, that is a packet contains more non-padding options
    than are configured to process, the intermediate destination node SHOULD
    discard the packet and MAY send an ICMP Parameter Problem with code 10
    to the packet's source address.<a href="#section-3.4-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.5">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.6">
    An intermediate destination node MAY limit the number of
    options (padding or non-padding) in Destination Options before the
    Routing header. If a limit is exceeded, that is a
    packet contains more non-padding options than are configured to
    process, the intermediate destination node SHOULD discard the
    packet and MAY send an ICMP Parameter Problem with code 10
    to the packet's source address.<a href="#section-3.4-2.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.7">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.8">
     An intermediate destination MAY limit the total number bytes in consecutive
     PAD1 options in Destination Options before the Routing Header
     7. If the limit is exceeded, that is there are more than seven
     bytes in consecutive PAD1 or PADN options present,
     the intermediate destination node SHOULD discard the
     packet and MAY send an ICMP Parameter Problem with code 10
     to the packet's source address.<a href="#section-3.4-2.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.9">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.10">
     A intermediate destination MAY limit the number of bytes in a PADN option
     in Destination Options before the Routing header to be less
     than 8. In such a case, if a PADN option is present that has a
     length greater than 7, the packet SHOULD be discarded and
     the intermediate destination node SHOULD discard the
     packet and MAY send an ICMP Parameter Problem with code 10
     to the packet's source address.<a href="#section-3.4-2.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.11">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.12">
     A intermediate destination MAY set a limit on the maximum number
     of non-padding
         options allowed in Destination options before the Routing header.
         If this feature is supported, the maximum number SHOULD be
     configurable, and the default value SHOULD be set to 8.
     If a packet is received and the number of Destination options
     before the Routing header exceeds the limit,
     the intermediate destination node SHOULD discard the
     packet and MAY send an ICMP Parameter Problem with code 10
     to the packet's source address.<a href="#section-3.4-2.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-3.4-2.13">*</dt>
          <dd style="margin-left: 1.5em" id="section-3.4-2.14">
     A intermediate MAY set a limit on the maximum length of Destination
     Options extension header before the Routing header. This value
     SHOULD
     be configurable, and the default is to accept options of any length.
     If a packet is received and the length of the Destination or Hop-by-
     Hop Options extension header exceeds the length limit,
     the intermediate destination node SHOULD discard the
     packet and MAY send an ICMP Parameter Problem with code 10
     to the packet's source address.<a href="#section-3.4-2.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-4">
      <h2 id="name-references">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-4.1">
        <h3 id="name-normative-references">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8200">[RFC8200]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">STD 86</span>, <span class="seriesInfo">RFC 8200</span>, <span class="seriesInfo">DOI 10.17487/RFC8200</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8200">https://www.rfc-editor.org/info/rfc8200</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8504">[RFC8504]</dt>
        <dd>
<span class="refAuthor">Chown, T.</span>, <span class="refAuthor">Loughney, J.</span>, and <span class="refAuthor">T. Winters</span>, <span class="refTitle">"IPv6 Node Requirements"</span>, <span class="seriesInfo">BCP 220</span>, <span class="seriesInfo">RFC 8504</span>, <span class="seriesInfo">DOI 10.17487/RFC8504</span>, <time datetime="2019-01" class="refDate">January 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8504">https://www.rfc-editor.org/info/rfc8504</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8883">[RFC8883]</dt>
      <dd>
<span class="refAuthor">Herbert, T.</span>, <span class="refTitle">"ICMPv6 Errors for Discarding Packets Due to Processing Limits"</span>, <span class="seriesInfo">RFC 8883</span>, <span class="seriesInfo">DOI 10.17487/RFC8883</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8883">https://www.rfc-editor.org/info/rfc8883</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-4.2">
        <h3 id="name-informative-references">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC2460">[RFC2460]</dt>
        <dd>
<span class="refAuthor">Deering, S.</span> and <span class="refAuthor">R. Hinden</span>, <span class="refTitle">"Internet Protocol, Version 6 (IPv6) Specification"</span>, <span class="seriesInfo">RFC 2460</span>, <span class="seriesInfo">DOI 10.17487/RFC2460</span>, <time datetime="1998-12" class="refDate">December 1998</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2460">https://www.rfc-editor.org/info/rfc2460</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7872">[RFC7872]</dt>
        <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Linkova, J.</span>, <span class="refAuthor">Chown, T.</span>, and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Observations on the Dropping of Packets with IPv6 Extension Headers in the Real World"</span>, <span class="seriesInfo">RFC 7872</span>, <span class="seriesInfo">DOI 10.17487/RFC7872</span>, <time datetime="2016-06" class="refDate">June 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7872">https://www.rfc-editor.org/info/rfc7872</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9098">[RFC9098]</dt>
      <dd>
<span class="refAuthor">Gont, F.</span>, <span class="refAuthor">Hilliard, N.</span>, <span class="refAuthor">Doering, G.</span>, <span class="refAuthor">Kumari, W.</span>, <span class="refAuthor">Huston, G.</span>, and <span class="refAuthor">W. Liu</span>, <span class="refTitle">"Operational Implications of IPv6 Packets with Extension Headers"</span>, <span class="seriesInfo">RFC 9098</span>, <span class="seriesInfo">DOI 10.17487/RFC9098</span>, <time datetime="2021-09" class="refDate">September 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9098">https://www.rfc-editor.org/info/rfc9098</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Tom Herbert</span></div>
<div dir="auto" class="left"><span class="org">SiPanda</span></div>
<div dir="auto" class="left">
<span class="locality">Santa Clara, CA</span>,  </div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:tom@herbertland.com" class="email">tom@herbertland.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
