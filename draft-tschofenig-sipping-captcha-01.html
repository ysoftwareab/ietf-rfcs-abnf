<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Completely Automated Public Turing
			Test to Tell Computers and Humans Apart (CAPTCHA) based Robot Challenges for SIP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Completely Automated Public Turing
			Test to Tell Computers and Humans Apart (CAPTCHA) based Robot Challenges for SIP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">SIPPING</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">E. Leppanen</td></tr>
<tr><td class="header">Expires: August 28, 2008</td><td class="header">Individual</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">S. Niccolini</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">NEC</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Arumaithurai</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">University of Goettingen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 25, 2008</td></tr>
</table></td></tr></table>
<h1><br />Completely Automated Public Turing
			Test to Tell Computers and Humans Apart (CAPTCHA) based Robot Challenges for SIP<br />draft-tschofenig-sipping-captcha-01.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 28, 2008.</p>

<h3>Abstract</h3>

<p>A common approach to deal with unwanted communication attempts is to rely on some
				form of authorization policies, typically whitelists. In order to populate the
				entries in such an access control list it is helpful to have a way to challenge the
				entity willing to engage in a conversation (unless they are already pre-authorized).
				One reason why this is desired is to deal with robots that are aggressively
				distributing messages.
</p>
<p> This document describes how "Completely Automated Public Turing Test to Tell
				Computers and Humans Apart" (CAPTCHA) tests, which require human interaction, are
				applied to SIP.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#Terminology">2.</a>&nbsp;
Terminology<br />
<a href="#behavior">3.</a>&nbsp;
UAC, UAS and Proxy Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SPIT-proxy-oper">3.1.</a>&nbsp;
Operation of a SIP Proxy or SIP UAS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="# UAC-oper">3.2.</a>&nbsp;
Operation of UAC<br />
<a href="#xml_structure">4.</a>&nbsp;
Description of the CAPTCHA XML Doument<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#xml_general">4.1.</a>&nbsp;
Structure of XML-Encoded CAPTCHA Challenge<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">4.2.</a>&nbsp;
MIME Type for CAPTCHA Challenge Document<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">4.3.</a>&nbsp;
The &lt;challenge&gt; Root Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">4.4.</a>&nbsp;
The &lt;media&gt; Element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.5.</a>&nbsp;
The &lt;uri&gt; element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.6.</a>&nbsp;
The &lt;data&gt; element<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.7.</a>&nbsp;
Values<br />
<a href="#syntax_header">5.</a>&nbsp;
Syntax<br />
<a href="#example">6.</a>&nbsp;
Example<br />
<a href="#schema">7.</a>&nbsp;
XML Schema<br />
<a href="#Security-Considerations">8.</a>&nbsp;
Security Considerations<br />
<a href="#IANA-Considerations">9.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IANA_captcha-header">9.1.</a>&nbsp;
Captcha Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IANA_resp-4xx">9.2.</a>&nbsp;
4xx Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IANA_ns">9.3.</a>&nbsp;
Namespace<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#IANA_ct">9.4.</a>&nbsp;
Content-Type registration for 'application/captcha-challenge+xml'<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">9.5.</a>&nbsp;
CAPTCHA Schema Registration<br />
<a href="#Acknowledgements">10.</a>&nbsp;
Acknowledgments<br />
<a href="#alternatives">11.</a>&nbsp;
Alternative Solution Approaches<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#challenge-sip-proxy">11.1.</a>&nbsp;
Challenge by Proxy<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#challenge-sip-proxy-outline">11.1.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SPIT-proxy-oper-direct-challenge">11.1.2.</a>&nbsp;
Operation of Proxy when it issues a challenge directly<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UAC-Oper-direct-challenge">11.1.3.</a>&nbsp;
Operation of UAC on receiving a CAPTCHA challenge from the SIP <br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#redirected-sip-proxy">11.2.</a>&nbsp;
SIP request redirected by the SIP Proxy<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#redirected-sip-proxy-overview">11.2.1.</a>&nbsp;
Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#SPIT-proxy-oper-redirect">11.2.2.</a>&nbsp;
Operation of Proxy when it redirects the INVITE to a CAPTCHA UA<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#UAC-oper-redirect">11.2.3.</a>&nbsp;
Operation of UAC when it recieves a challenge from a CAPTCHA UA<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#application-sip-proxy">11.3.</a>&nbsp;
SIP Application Interaction Framework<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative references<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative references<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> The problem of unwanted communication is an imminent challenge and only the
				combination of several techniques can provide some degree of protection. <a class='info' href='#RFC5039'>[RFC5039]<span> (</span><span class='info'>Rosenberg, J. and C. Jennings, &ldquo;The Session Initiation Protocol (SIP) and Spam,&rdquo; January&nbsp;2008.</span><span>)</span></a> provides four recommendations that should to be considered
				for an overall solution, namely, 
</p>
<p>
				</p>
<ul class="text">
<li>Strong Identity
</li>
<li>White Lists
</li>
<li>Solve the Introduction Problem
</li>
<li>Don't Wait Until its Too Late.
</li>
</ul><p>
			
</p>
<p> The human interaction required challenges are mainly used for solving the
				introduction problem targeting to handle requests from user agents with whom the
				recipient do not have former relations. For example, the challenge is initiated
				towards user agents that are not yet white or black-listed, or based on some other
				criteria. 
</p>
<p> The <a class='info' href='#I-D.tschofenig-sipping-framework-spit-reduction'>[I&#8209;D.tschofenig&#8209;sipping&#8209;framework&#8209;spit&#8209;reduction]<span> (</span><span class='info'>Tschofenig, H., Schulzrinne, H., Wing, D., Rosenberg, J., and D. Schwartz, &ldquo;A Framework to tackle Spam and Unwanted Communication for Internet  Telephony,&rdquo; July&nbsp;2008.</span><span>)</span></a> provides a
				framework for dealing with unwanted communication. The policy contains rules that
				are applied to requests if the conditions of a given rule matche. The actions of the
				matching rules are executed and one of the actions could be to provide a challenge
				that must be soved by a human before the request is forwarded to the called party
				triggering the corresponding user interface notifications to the user.
</p>
<p> There are different techniques already developed for challenging user agents.
				&quot;Completely Automated Public Turing Test to Tell Computes and Humans
				Apart&quot; (CAPTCHA) <a class='info' href='#captcha'>[captcha]<span> (</span><span class='info'>von Ahn, L., Blum, M., and J. Langford, &ldquo;Telling Humans and Computers Apart Automatically,&rdquo; February&nbsp;2004.</span><span>)</span></a> typically provides a human a task
				either to recognize something or a question to be answered using different media
				types. <a class='info' href='#Inaccessibility-of-CAPTCHA'>[Inaccessibility&#8209;of&#8209;CAPTCHA]<span> (</span><span class='info'>May, M., &ldquo;Inaccessibility of CAPTCHA; Alternatives to Visual Turing Tests on the 						Web,&rdquo; November&nbsp;2005.</span><span>)</span></a> provides alternatives to visual
				test for allowing systems to test for human users while preserving access by users
				with disabilities. Hashcash challenge <a class='info' href='#hashcash'>[hashcash]<span> (</span><span class='info'>Back, A., &ldquo;Hashcash - A Denial of Service Counter-Measure,&rdquo; August&nbsp;2002.</span><span>)</span></a> requires user agents
				to perform CPU-intensive computational puzzles making it difficult to send large
				amounts of requests. The hashcash concept has been proposed for usage with SIP in
					<a class='info' href='#I-D.jennings-sip-hashcash'>[I&#8209;D.jennings&#8209;sip&#8209;hashcash]<span> (</span><span class='info'>Jennings, C., &ldquo;Computational Puzzles for SPAM Reduction in SIP,&rdquo; July&nbsp;2007.</span><span>)</span></a>. 
</p>
<p> Using CAPTCHA techniques for SIP communication requires a mechanism for enabling
				user interaction to be associated with SIP requests. When a proxy or user agent
				server (UAS) server receives a SIP request that needs to be challenged, the proxy or
				UAS sends a challenge to the originator of the SIP request before continue handling
				of the request. After getting the answer to the challenge from the user, the user
				agent client (UAC) needs to provide the answer back towards the UAS in order to get
				the initial request passed to the recipient. 
</p>
<p> The challenge should offer multiple choices for the UACs to select depending on the
				capabilities of the device where the UAC is running. Also, the UAC should be able to
				authenticate and authorize the source of challenge. The UAC may receive the
				challenge via a URL or as direct media compoment(s). 
</p>
<p> The main goal is to support SIP dialog creating request such as SIP INVITE, but
				ideally the solution should also cover non-dialog creating requests, e.g., SIP
				MESSAGE.
				
			
</p>
<p>Note that this document presents several different solution approaches, see <a class='info' href='#alternatives'>Section&nbsp;11<span> (</span><span class='info'>Alternative Solution Approaches</span><span>)</span></a>. The solution presented in the main part of the document
				is aligned with the work done with <a class='info' href='#XEP-0158'>[XEP&#8209;0158]<span> (</span><span class='info'>Paterson, I., &ldquo;XEP-0158: Robot Challenges,&rdquo; October&nbsp;2006.</span><span>)</span></a> on CAPTCHAs for XMPP.
</p>
<a name="Terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p> In this document, the key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
				NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" are to be
				interpreted as described in RFC 2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> and indicate
				requirement levels for compliant implementations. 
</p>
<p> This document makes also use of the vocabulary defined in RFC 3261 <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a>. 
</p>
<a name="behavior"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
UAC, UAS and Proxy Behavior</h3>

<p> 
</p>
<a name="SPIT-proxy-oper"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Operation of a SIP Proxy or SIP UAS</h3>

<p> When a SIP proxy or a SIP UAS receives a SIP request from a UAC, its
					authorization engine may apply the policy to the SIP request, as, for example,
					defined in <a class='info' href='#RFC5025'>[RFC5025]<span> (</span><span class='info'>Rosenberg, J., &ldquo;Presence Authorization Rules,&rdquo; December&nbsp;2007.</span><span>)</span></a>. This authorization policy execution may
					result in the need for the proxy (or the UAS) to generate a challenge to the
					UAC, the proxy (or the UAS) can send the challenge directly, can send a URI of
					the challenge, or can redirect the request to a special CAPTCHA UA. 
</p>
<a name=" UAC-oper"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Operation of UAC</h3>

<p> The UAC either receives a CAPTCHA challenge or a URI of the challenge. The UAC
					is expected to solve the CAPTCHA puzzle and send the answer back to the SIP
					proxy server or to send a token to indicate that it has successfully solved the
					puzzle. 
</p>
<a name="xml_structure"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Description of the CAPTCHA XML Doument</h3>

<p>This section describes the content of the CAPTCHA XML document. The XML schema for it
				can be found in <a class='info' href='#schema'>Section&nbsp;7<span> (</span><span class='info'>XML Schema</span><span>)</span></a>.
</p>
<a name="xml_general"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Structure of XML-Encoded CAPTCHA Challenge</h3>

<p>A CAPTCHA challenge is an XML document <a class='info' href='#XML'>[XML]<span> (</span><span class='info'>Bray, T., &ldquo;Exensible Markup Language (XML) 1.0 (Second Edition),&rdquo; October&nbsp;2000.</span><span>)</span></a> that MUST be
					well-formed and MUST be valid according to the schema defined in this document,
					including extension schemas available to the validater and applicable to the XML
					document. The XML documents MUST be based on XML 1.0 and MUST be encoded using
					UTF-8.
</p>
<p>The namespace identifier for elements defined by this specification is a URN
						<a class='info' href='#RFC2141'>[RFC2141]<span> (</span><span class='info'>Moats, R., &ldquo;URN Syntax,&rdquo; May&nbsp;1997.</span><span>)</span></a>, using the namespace identifier 'ietf' defined by
						<a class='info' href='#RFC2648'>[RFC2648]<span> (</span><span class='info'>Moats, R., &ldquo;A URN Namespace for IETF Documents,&rdquo; August&nbsp;1999.</span><span>)</span></a> and extended by <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>. This URN
					is: urn:ietf:params:xml:ns:captcha. 
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
MIME Type for CAPTCHA Challenge Document</h3>

<p>The MIME type for the XML document is 'application/capcha-challenge+xml'.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
The &lt;challenge&gt; Root Element</h3>

<p>The root element of the XML document is &lt;challenge&gt;.
</p>
<p>The &lt;challenge&gt; element contains the namespace definition mentioned
					in <a class='info' href='#xml_general'>Section&nbsp;4.1<span> (</span><span class='info'>Structure of XML-Encoded CAPTCHA Challenge</span><span>)</span></a>. It also contains a mandatory 'id' attribute for
					correlating the challenge and the answer, and the 'min-tests' attribute with the
					default value set to 1. With the 'min-tests' attribute, it is possible to define
					the minimum amount of tests that need to be solved.
</p>
<p>The &lt;challenge&gt; element MUST have at least one child element. This
					document defines the &lt;media&gt; element as a child element. The
					&lt;challenge&gt; element may contain one or more &lt;media&gt;
					elements. 
</p>
<p>The &lt;challenge&gt; element may also be extended by XML elements or
					attributes defined with other namespaces.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
The &lt;media&gt; Element</h3>

<p>The &lt;media&gt; element contains one child element. This document
					defines the &lt;uri&gt; and &lt;data&gt; elements as child
					elements for allowing the CAPTCHA challenge be provided directly as content or
					as a reference to an external content. 
</p>
<p>The &lt;media&gt; element contains a mandatory 'var' attribute indicating
					the type of the challenge (see values from the 'var' column of <a class='info' href='#captcha-values'>Figure&nbsp;1<span> (</span><span class='info'>Information of CAPTCHA challenges</span><span>)</span></a>). It may also contain optional 'width' and
					'height' attributes for providing the size of the content. In addition, the
					element may contain an 'instr' attribute which purpose is to provide
					instructions related to the challenge (see the 'example generic instruction'
					column from <a class='info' href='#captcha-values'>Figure&nbsp;1<span> (</span><span class='info'>Information of CAPTCHA challenges</span><span>)</span></a>). The required tests can be
					indicated by setting the value of the 'required' attribute to 'true'.
</p>
<p>The &lt;media&gt; element may also be extended by XML elements or
					attributes defined with other namespaces.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
The &lt;uri&gt; element</h3>

<p>The &lt;uri&gt; element contains a mandatory 'type' attribute indicating
					the MIME type of the challenge. See values from the 'MIME type' column of <a class='info' href='#captcha-values'>Figure&nbsp;1<span> (</span><span class='info'>Information of CAPTCHA challenges</span><span>)</span></a>. The value of the &lt;uri&gt; element is a
					URL where the challenge can be fetched.
</p>
<p>The &lt;uri&gt; element may also be extended by XML attributes defined
					with other namespaces. 
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
The &lt;data&gt; element</h3>

<p>The &lt;data&gt; element contains a mandatory 'type' attribute indicating
					the MIME type of the challenge. See typical values from the 'MIME type' column
					of <a class='info' href='#captcha-values'>Figure&nbsp;1<span> (</span><span class='info'>Information of CAPTCHA challenges</span><span>)</span></a>. 
</p>
<p>The value of the &lt;data&gt; element is the content of the challenge.
</p>
<p>The &lt;data&gt; element may also be extended by XML attributes defined
					with other namespaces.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
Values</h3>

<p>The following table copied from <a class='info' href='#XEP-0158'>[XEP&#8209;0158]<span> (</span><span class='info'>Paterson, I., &ldquo;XEP-0158: Robot Challenges,&rdquo; October&nbsp;2006.</span><span>)</span></a> presents typical values
					for the CAPTCHA challenge. The 'var' column lists values for the 'var' attribute
					of the &lt;media&gt; element. The 'MIME type' column contains values of
					the corresponding 'type' attribute of the &lt;uri&gt; or
					&lt;data&gt; elements.
</p>
<p>
					<br /><hr class="insert" />
<a name="captcha-values"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+---------------+-------------+-------+--------+------------------------+
| 'var'         | Name        | Media | MIME   | Example generic        |
|               |             | type  | type   | instructions           |
+---------------+-------------+-------+--------+------------------------+
| ocr*          | Optical Char| image | image/ | Enter the code         |
|               | Recognition |       | jpeg   | you see                |
+---------------+-------------+-------+--------+------------------------+
| picture_recog | Picture     | image | image/ | Describe               |
|               | Recognition |       | jpeg   | the picture            |
+---------------+-------------+-------+--------+------------------------+
| video_recog   | Video       | video | video/ | Describe               |
|               | Recognition |       | mpeg   | the video              |
+---------------+-------------+-------+--------+------------------------+
| speech_recog  | Speech      | audio | audio/ | Enter the              |
|               | Recognition |       | x-wav  | words you hear         |
+---------------+-------------+-------+--------+------------------------+
| audio_recog   | Audio       | audio | audio/ | Describe the           |
|               | Recognition |       | x-wav  | sound you hear         |
+---------------+-------------+-------+--------+------------------------+
| picture_q     | Picture     | image | image/ | Answer the             |
|               | Question    |       | jpeg   | question you see       |
+---------------+-------------+-------+--------+------------------------+
| video_q       | Video       | video | video/ | Answer the             |
|               | Question    |       | mpeg   | question in video      |
+---------------+-------------+-------+--------+------------------------+
| speech_q      | Speech      | audio | audio/ | Answer the             |
|               | Question    |       | x-wav  | question you hear      |
+---------------+-------------+-------+--------+------------------------+
| qa            | Text Q &amp; A  | text  | text/  | Answer the question    |
|               |             |       | plain  |                        |
+---------------+-------------+-------+--------+------------------------+

* The image portrays random characters that humans can read but OCR
software cannot. To pass the challenge, the user must simply type the
characters. The correct answer SHOULD NOT depend on the language
specified by the 'xml:lang' attribute of the challenge.

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Information of CAPTCHA challenges&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
</p>
<a name="syntax_header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Syntax</h3>

<p>The Captcha header field carries the solution information. It has parameters called
				'id' and 'answer'. The 'id' parameter value is set to the same as the 'id' attribute
				of the CAPTCHA challenge sent to the UAC. The 'answer' parameter value is set to the
				answer of the CAPTCHA challenge.
</p>
<p>Example:
</p>
<p> Captcha: id="rjffe32"; answer="2";
</p>
<p>
</p>
<p>The ABNF for the header is: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 Captcha       = "Captcha" HCOLON captcha-parm *(COMMA captcha-param)
 captcha-param =  captcha-id SEMI captcha-answer *(SEMI generic-param)
 captcha-id   = "id" EQUAL quoted-string
 captcha-answer = "answer" EQUAL quoted-string
</pre></div><p>

			
</p>
<p>This document updates the Table 2 of <a class='info' href='#RFC3261'>[RFC3261]<span> (</span><span class='info'>Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;SIP: Session Initiation Protocol,&rdquo; June&nbsp;2002.</span><span>)</span></a> by adding the
				following: </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

    Header field         where   proxy   ACK  BYE  CAN  INV  OPT  REG
    ------------         -----   -----   ---  ---  ---  ---  ---  ---
    Captcha               R       dr      o    o    -    o    o    o

                                         SUB  NOT  REF  INF  UPD  PRA
                                         ---  ---  ---  ---  ---  ---
                                          o    o    o    o    o    o
</pre></div><p>

			
</p>
<a name="example"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Example</h3>

<p>The following XML document shows the content that is provided of a CAPTCHA the
				challenge message sent towards the sending party as shown in message (2) of <a class='info' href='#FIG2'>Figure&nbsp;3<span> (</span><span class='info'>Proxy returns URL to the CAPTCHA</span><span>)</span></a>.
</p>
<p>
				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;challenge xmlns="urn:ietf:params:xml:ns:captcha"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    id="73DE28A2"&gt;

    &lt;media var="urn:ietf:params:xml:ns:captcha:ocr"
		width="290" height="80"&gt;
        &lt;uri type="image/jpeg"&gt;
		http://www.example.com/challenges/ocr.jpeg?F3A6292C
	&lt;/uri&gt;
    &lt;/media&gt;

    &lt;media var="urn:ietf:params:xml:ns:captcha:audio_recog"&gt;
        &lt;uri type="audio/x-wav"&gt;
		http://www.example.com/challenges/audio.wav?F3A6292C
	&lt;/uri&gt;
    &lt;/media&gt;

    &lt;media var="urn:ietf:params:xml:ns:captcha:qa"&gt;
        &lt;data type="text/plain"&gt;Type the color of a stop light&lt;/data&gt;
    &lt;/media&gt;

&lt;/challenge&gt;
</pre></div><p>

			
</p>
<a name="schema"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
XML Schema</h3>

<p>This document defines the XML Schema based on the schema defined in Section 12 of
					<a class='info' href='#XEP-0158'>[XEP&#8209;0158]<span> (</span><span class='info'>Paterson, I., &ldquo;XEP-0158: Robot Challenges,&rdquo; October&nbsp;2006.</span><span>)</span></a>. 
</p>
<p>
				</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version='1.0' encoding='UTF-8'?&gt;

&lt;xs:schema xmlns:xs="http://www.w3.org/2001/XMLSchema"
    targetNamespace="urn:ietf:params:xml:ns:captcha"
    xmlns="urn:ietf:params:xml:ns:captcha"
    elementFormDefault="qualified"&gt;

    &lt;xs:element name="challenge" type="challengeType"/&gt;

    &lt;xs:complexType name="challengeType"&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:restriction base="xs:anyType"&gt;
                &lt;xs:sequence&gt;
                    &lt;xs:element ref="media"
                        minOccurs="1" maxOccurs="unbounded"/&gt;
                    &lt;xs:any namespace="##other"
                        minOccurs="0" processContents="lax"/&gt;
                &lt;/xs:sequence&gt;
                &lt;xs:attribute name="id"
                    use="required" type="xs:string"/&gt;
                &lt;xs:attribute name="min_tests" type="xs:unsignedInt"
                    default="1" use="optional" /&gt;

            &lt;/xs:restriction&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;

    &lt;xs:element name="media" type="mediaType"/&gt;

    &lt;xs:complexType name="mediaType"&gt;
        &lt;xs:complexContent&gt;
            &lt;xs:restriction base="xs:anyType"&gt;
                &lt;xs:choice minOccurs="1" maxOccurs="1"&gt;
                    &lt;xs:element ref="uri"
                        minOccurs="0" maxOccurs="unbounded"/&gt;
                    &lt;xs:element ref="data"
                        minOccurs="0" maxOccurs="unbounded"/&gt;
                    &lt;xs:any namespace="##other" minOccurs="0"
                        processContents="lax"/&gt;
                &lt;/xs:choice&gt;
                &lt;xs:attribute name="var"
                    use="required" type="xs:anyURI"/&gt;
                &lt;xs:attribute name="required" type="xs:boolean"
                    default="false" use="optional"/&gt;
                &lt;xs:attribute name="height"
                    type="xs:string" use="optional"/&gt;
                &lt;xs:attribute name="width"
                    type="xs:string" use="optional"/&gt;
                &lt;xs:attribute name="instr"
                    type="xs:string" use="optional"/&gt;
                &lt;xs:anyAttribute namespace="##any"
                    processContents="lax"/&gt;
            &lt;/xs:restriction&gt;
        &lt;/xs:complexContent&gt;
    &lt;/xs:complexType&gt;

    &lt;xs:element name="uri"&gt;
        &lt;xs:complexType&gt;
            &lt;xs:simpleContent&gt;
                &lt;xs:extension base="xs:string"&gt;
                    &lt;xs:attribute name="type" use="required"/&gt;
                    &lt;xs:anyAttribute namespace="##any"
                        processContents="lax"/&gt;
                &lt;/xs:extension&gt;
            &lt;/xs:simpleContent&gt;
        &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;

    &lt;xs:element name="data"&gt;
        &lt;xs:complexType&gt;
            &lt;xs:simpleContent&gt;
                &lt;xs:extension base="xs:string"&gt;
                    &lt;xs:attribute name="type" use="required"/&gt;
                    &lt;xs:anyAttribute namespace="##any"
                        processContents="lax"/&gt;
                &lt;/xs:extension&gt;
            &lt;/xs:simpleContent&gt;
        &lt;/xs:complexType&gt;
    &lt;/xs:element&gt;

&lt;/xs:schema&gt;
</pre></div><p>

			
</p>
<a name="Security-Considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>[Editor's Note: A future version of this document will describe security
				considerations.]
</p>
<a name="IANA-Considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This specification registers a new header and a new response code. IANA is requested
				to make the following updates in the registry at:
				http://www.iana.org/assignments/sip-parameters. It also registers a new namespace
				and a content type.
</p>
<a name="IANA_captcha-header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.1"></a><h3>9.1.&nbsp;
Captcha Header</h3>

<p>Add the following entry to the header sub-registry. </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     Header Name        compact    Reference
     -----------------  -------    ---------
     Captcha                       [RFC-XXXX]
</pre></div><p>

				
</p>
<a name="IANA_resp-4xx"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.2"></a><h3>9.2.&nbsp;
4xx Response</h3>

<p>Add the following entry to the response code sub-registry under the
					&quot;Request Failure 4xx&quot; heading. 
</p>
<p> 4xx CAPTCHA required [RFC-XXXX] 
</p>
<a name="IANA_ns"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.3"></a><h3>9.3.&nbsp;
Namespace</h3>

<p>This section registers a new XML namespace per the procedures in <a class='info' href='#RFC3688'>[RFC3688]<span> (</span><span class='info'>Mealling, M., &ldquo;The IETF XML Registry,&rdquo; January&nbsp;2004.</span><span>)</span></a>. </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
URI: urn:ietf:params:xml:ns:captcha

   Registrant Contact: IETF SIPPING Working Group, Hannes Tschofenig
      (hannes.tschofenig@nsn.com).

   XML:

   BEGIN
   &lt;?xml version="1.0"?&gt;
   &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML Basic 1.0//EN"
     "http://www.w3.org/TR/xhtml-basic/xhtml-basic10.dtd"&gt;
   &lt;html xmlns="http://www.w3.org/1999/xhtml"&gt;
   &lt;head&gt;
     &lt;meta http-equiv="content-type"
           content="text/html;charset=iso-8859-1"/&gt;
     &lt;title&gt;Namespace for CAPTCHA Challenge&lt;/title&gt;
   &lt;/head&gt;
   &lt;body&gt;
     &lt;h1&gt;Namespace for providing CAPTCHA challenge&lt;/h1&gt;
     &lt;h2&gt;urn:ietf:params:xml:ns:captcha&lt;/h2&gt;
   &lt;p&gt;See &lt;a href="[URL of published RFC]"&gt;RFCXXXX
       [NOTE TO IANA/RFC-EDITOR:
        Please replace XXXX with the RFC number of this
       specification.]&lt;/a&gt;.&lt;/p&gt;
   &lt;/body&gt;
   &lt;/html&gt;
   END
</pre></div><p>

				
</p>
<a name="IANA_ct"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.4"></a><h3>9.4.&nbsp;
Content-Type registration for 'application/captcha-challenge+xml'</h3>

<p>This specification requests the registration of a new MIME type according to the
					procedures of RFC 2048 <a class='info' href='#RFC2048'>[RFC2048]<span> (</span><span class='info'>Freed, N., Klensin, J., and J. Postel, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part Four: Registration Procedures,&rdquo; November&nbsp;1996.</span><span>)</span></a> and guidelines in RFC 3023 <a class='info' href='#RFC3023'>[RFC3023]<span> (</span><span class='info'>Murata, M., St. Laurent, S., and D. Kohn, &ldquo;XML Media Types,&rdquo; January&nbsp;2001.</span><span>)</span></a>. </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   MIME media type name: application

   MIME subtype name: captcha-challenge+xml
   Mandatory parameters: none
   Optional parameters: charset
     Indicates the character encoding of enclosed XML. Default is UTF-8.
   Encoding considerations:

      Uses XML, which can employ 8-bit characters, depending on the
      character encoding used. See RFC 3023 &lt;xref target="RFC3023"/&gt;,
      Section 3.2.

   Security considerations:

      This content type is designed to carry challenges for
      the user agent clients to solve in order to give a proof
      of being a human behind the generated request. This
      action is a part of a spam preventing mechanism.
      Appropriate precautions should be adopted to limit
      disclosure of this information. Please refer to RFCXXXX
      [NOTE TO IANA/RFC-EDITOR: Please replace XXXX
      with the RFC number of this specification.]
      Security Considerations section for more information.

   Interoperability considerations: none

   Published specification: RFCXXXX [NOTE TO IANA/RFC-EDITOR:
   Please replace XXXX with the RFC number of this specification.]
   this document

   Applications which use this media type: SIP applications

   Additional information:

      Magic Number: None
      File Extension: .xml
      Macintosh file type code: 'TEXT'

   Personal and email address for further information: Hannes
      Tschofenig, Hannes.Tschofenig@nsn.com
   Intended usage: LIMITED USE

   Author/Change controller:

      This specification is a work item of the IETF SIPPING working
      group, with mailing list address &lt;xxxxx @ietf.org&gt;.
</pre></div><p>

				
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9.5"></a><h3>9.5.&nbsp;
CAPTCHA Schema Registration</h3>

<p>
					</p>
<blockquote class="text"><dl>
<dt>URI:</dt>
<dd>urn:ietf:params:xml:schema:captcha
</dd>
<dt>Registrant Contact:</dt>
<dd>IETF SIPPING Working Group, Hannes
							Tschofenig (Hannes.Tschofenig@nsn.com).
</dd>
<dt>XML:</dt>
<dd>The XML schema to be registered is contained in <a class='info' href='#schema'>Section&nbsp;7<span> (</span><span class='info'>XML Schema</span><span>)</span></a>. Its first line is <div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
</pre></div> and its last line is<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
&lt;/xs:schema&gt;
</pre></div>
						
</dd>
</dl></blockquote><p>
				
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgments</h3>

<p>Years ago CAPTCHAs have been introduced for XMPP, see 'XEP-0158: Robot Challenges'
					<a class='info' href='#XEP-0158'>[XEP&#8209;0158]<span> (</span><span class='info'>Paterson, I., &ldquo;XEP-0158: Robot Challenges,&rdquo; October&nbsp;2006.</span><span>)</span></a>. The authors of this document believe that there is
				value in re-using it for SIP for Spam prevention. Hence, the authors would like to
				thank the XMPP community for their work on this subject. In particular, all credits
				go to Ian Paterson (ian.paterson@clientside.co.uk), the author of <a class='info' href='#XEP-0158'>[XEP&#8209;0158]<span> (</span><span class='info'>Paterson, I., &ldquo;XEP-0158: Robot Challenges,&rdquo; October&nbsp;2006.</span><span>)</span></a>. 
</p>
<p>We would like to thank Jonathan Rosenberg for his feedback to this draft.
</p>
<a name="alternatives"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Alternative Solution Approaches</h3>

<p> This section shows alternative solution approaches that can be used by a proxy to
				perform CAPTCHA tests. 
</p>
<a name="challenge-sip-proxy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1"></a><h3>11.1.&nbsp;
Challenge by Proxy</h3>

<a name="challenge-sip-proxy-outline"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1.1"></a><h3>11.1.1.&nbsp;
Overview</h3>

<p>
						<a class='info' href='#FIG1'>Figure&nbsp;2<span> (</span><span class='info'>Proxy returns the CAPTCHA directly with the response</span><span>)</span></a> and <a class='info' href='#FIG2'>Figure&nbsp;3<span> (</span><span class='info'>Proxy returns URL to the CAPTCHA</span><span>)</span></a> present high level messages
						flows for conveying a challenge (e.g., CAPTCHA) to the SIP UAC that
						initiated a dialog forming SIP request. In <a class='info' href='#FIG1'>Figure&nbsp;2<span> (</span><span class='info'>Proxy returns the CAPTCHA directly with the response</span><span>)</span></a> the
						challenge is included in the body of the SIP 4xx response while <a class='info' href='#FIG2'>Figure&nbsp;3<span> (</span><span class='info'>Proxy returns URL to the CAPTCHA</span><span>)</span></a> describes a case when the challenge is fetched via an
						URL that was provided with the response. After the user has managed to solve
						the challenge the UAC re-issues the request with the solution. The proxy
						removes the solution before forwarding the request to the SIP UAS. 
</p>
<p>
						<br /><hr class="insert" />
<a name="FIG1"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
SIP                                                SIP
UAC                       Proxy                     UAS
 |  1) SIP INVITE          |                         |
 |------------------------&gt;|                         |
 |                         |                         |
 |  2) 4xx + CAPTCHA       |                         |
 |&lt;------------------------|                         |
 |                         |                         |
 |                         |                         |
 |                         |                         |
 |                         |                         |
 |                         |                         |
 |                         |                         |
 |  3) Re-INVITE + Solution|                         |
 |------------------------&gt;|  4) SIP INVITE          |
 |                         |------------------------&gt;|
 |                         |  5) 200 OK              |
 |  6) 200 OK              |&lt;------------------------|
 |&lt;------------------------|                         |
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Proxy returns the CAPTCHA directly with the response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

					
</p>
<p>
						<br /><hr class="insert" />
<a name="FIG2"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    SIP                                                 SIP
    UAC                       Proxy                     UAS
     |  1) SIP INVITE          |                         |
     |------------------------&gt;|                         |
     |                         |                         |
     |  2) 4xx + CAPTCHA-Ref.  |                         |
     |&lt;------------------------|                         |
     |                         |                         |
 +---+----+                    |                         |
 |3) Fetch|                    |                         |
 |CAPTCHA |                    |                         |
 +---+----+                    |                         |
     |                         |                         |
     | 4) Re-INVITE + Solution |                         |
     |------------------------&gt;|  5) SIP INVITE          |
     |                         |------------------------&gt;|
     |                         |  6) 200 OK              |
     |  7) 200 OK              |&lt;------------------------|
     |&lt;------------------------|                         |
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Proxy returns URL to the CAPTCHA&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

					
</p>
<a name="SPIT-proxy-oper-direct-challenge"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1.2"></a><h3>11.1.2.&nbsp;
Operation of Proxy when it issues a challenge directly</h3>

<p> The proxy sends a 4xx response with an XML document containing the challenge
						in the body. The Content-Type used for the XML document is
						&prime;application/captcha-challenge+xml&prime;. 
</p>
<p> When the proxy receives a re-issued SIP request from the UAC, it validates
						the answer provided by the UAC in the CAPTCHA header field. In case the
						answer and other possible policies allow the request to get proxied further
						to the UAS, the proxy removes the CAPTCHA header. Depending on the policies
						and functionality of the proxy, the proxy may update the authorization
						policy according to the decision, e.g., insert the AoR of the user of the
						UAC to a white or black list. In case the answer was not satisfactory, the
						UAS acts according to a defined policy, e.g., rejects the request. 
</p>
<a name="UAC-Oper-direct-challenge"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.1.3"></a><h3>11.1.3.&nbsp;
Operation of UAC on receiving a CAPTCHA challenge from the SIP </h3>

<p> When the UAC receives a 4xx response with a MIME type
						'application/captcha-challenge+xml' in the body to be solved, the UAC first
						authenticates and authorizes the sender of the challenge.
</p>
<p> The UAC selects the challenges marked as mandatory and possibly some
						additional ones for UAC's execution or to be rendered to the user based on,
						e.g., the device capabilities. The UAC may also need to fetch the challenges
						from which URL links were provided. When the challenge gets solved, the UAC
						provides an answer in the CAPTCHA header field by re-issuing the SIP
						request, e.g., by sending a SIP re-INVITE. 
</p>
<a name="redirected-sip-proxy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2"></a><h3>11.2.&nbsp;
SIP request redirected by the SIP Proxy</h3>

<a name="redirected-sip-proxy-overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2.1"></a><h3>11.2.1.&nbsp;
Overview</h3>

<p> In this case, the SIP proxy redirects the INVITE from a SIP UAC to a CAPTCHA
						UAS. The CAPTCHA UA acknowledges the request for service and then, contacts
						the SIP UAC directly to issue the challenge. On performing the CAPTCHA
						tests, it initimates the SIP server of the result. 
</p>
<p> The redirect of the INVITE by the SIP server to a CAPTCHA UA is a simple
						call redirect, negotiation of the parameters for the CAPTCHA is done using
						the standard SDP negotiation. From the caller point of view this is just a
						call setup, the caller will be presented the CAPTCHA test depending on the
						media it supports (audio, video, text). In this way there is no need for
						additional signaling that would reveal the caller that a CAPTCHA needs to be
						solved. 
</p>
<p><a class='info' href='#FIG3'>Figure&nbsp;4<span> (</span><span class='info'>A case where the Proxy redirects the INVITE to a CAPTCHA UA and gets a SUCCCESS repsonse</span><span>)</span></a> presents a high level message flow showing a successful
						CAPTCHA test and <a class='info' href='#FIG4'>Figure&nbsp;5<span> (</span><span class='info'>A case where the Proxy redirects the INVITE to a CAPTCHA UA and gets a NOT SUCCCESS repsonse</span><span>)</span></a> presents a high level message flow
						conveying a unsuccessful CAPTCHA challenge by a UA. 
</p>
<p>
						<br /><hr class="insert" />
<a name="FIG3"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   SIP                 SIP Proxy                CAPTCHA               SIP
   UAC                 or UA                      UA                  UAS
    |                    |                         |                   |
    |                    |                         |                   |
    |INVITE(Callee)      |                         |                   |
    +-------------------&gt;|                         |                   |
    |                    |INVITE(Re-Directed to    |                   |
    |                    |CAPTCHA UA)              |                   |
    |                    +------------------------&gt;|                   |
    |                    |                         |                   |
    |                    |                         |                   |
    |                    |                   200 OK|                   |
    |                    |&lt;------------------------+                   |
    |                    |                         |                   |
    |              200 OK|                         |                   |
    |&lt;-------------------+                         |                   |
    |  /                 |                      \  |                   |
    |//------------------------------------------\\|                   |
    /                                              \                   |
    \    RTP ( AUDIO/ VIDEO Test Performed )       /                   |
    |\\------------------------------------------//|                   |
    |  \                 |                      /  |                   |
    |                    |                         |                   |
    |                    | &lt;IF Test was Successful&gt;|                   |
    |                    |  REFER TO Callee +      |                   |
    |                    |  Crypto cookie          |                   |
    |                    |&lt;------------------------+                   |
    |                    |                         |                   |
    |  REFER TO Callee + |                         |                   |
    |  Crypto cookie     |                         |                   |
    |&lt;-------------------+                         |                   |
    |                    |                         |                   |
    |INVITE(Callee) +    |                         |                   |
    |Crypto cookie       |                         |                   |
    +-------------------&gt;|                                             |
    |                    | INVITE (Callee) + Crypto cookie             |
    |                    +---------------------------------------------|
    |                    |                                             |
    |                    |                                       200 OK|
    |                    |&lt;--------------------------------------------+
    |                    |                         |                   |
    |              200 OK|                         |                   |
    |&lt;-------------------+                         |                   |
    |                    |                         |                   |
    |  /                 |                         |                \  |
    |//--------------------------------------------------------------\\|
    /                                                                  \
    \                    RTP ( REAL CONVERSATION )                     /
    |\\--------------------------------------------------------------//|
    |  \                 |                         |                /  |
    |                    |                         |                   |

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: A case where the Proxy redirects the INVITE to a CAPTCHA UA and gets a SUCCCESS repsonse&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

					
</p>
<p>
						<br /><hr class="insert" />
<a name="FIG4"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   SIP                 SIP Proxy                CAPTCHA               SIP
   UAC                 or UA                      UA                  UAS
    |                    |                         |                   |
    |                    |                         |                   |
    |INVITE(Callee)      |                         |                   |
    +-------------------&gt;|                         |                   |
    |                    |INVITE(Re-Directed to    |                   |
    |                    |CAPTCHA UA)              |                   |
    |                    +------------------------&gt;|                   |
    |                    |                         |                   |
    |                    |                         |                   |
    |                    |                   200 OK|                   |
    |                    |&lt;------------------------+                   |
    |                    |                         |                   |
    |              200 OK|                         |                   |
    |&lt;-------------------+                         |                   |
    |  /                 |                      \  |                   |
    |//------------------------------------------\\|                   |
    /                                              \                   |
    \    RTP ( AUDIO/ VIDEO Test Performed )       /                   |
    |\\------------------------------------------//|                   |
    |  \                 |                      /  |                   |
    |                    |                         |                   |
    |                    | &lt;IF Test was NOT        |                   |
    |                    |  SUCCESSFUL &gt;           |                   |
    |                    |  Bye / 4xx              |                   |
    |                    |&lt;------------------------+                   |
    |                    |                         |                   |
    |                    |                         |                   |
    |           Bye / 4xx|                         |                   |
    |&lt;-------------------+                         |                   |
    |                    |                         |                   |

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: A case where the Proxy redirects the INVITE to a CAPTCHA UA and gets a NOT SUCCCESS repsonse&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

					
</p>
<a name="SPIT-proxy-oper-redirect"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2.2"></a><h3>11.2.2.&nbsp;
Operation of Proxy when it redirects the INVITE to a CAPTCHA UA</h3>

<p> The SIP server redirects the INVITE to a CAPTCHA UA. The CAPTCHA UA,
						acknowledges the request for service by sending a "200 OK" message. The
						CAPTCHA UA, then proceeds to issue the CAPTCHA challenge to the user. 
</p>
<p> If the user is successful in solving the CAPTCHA challenge, the CAPTCHA UA
						issues a reference to the Callee along with crypto cookie to ensure that a
						replay attack isn't possible. The SIP server passes this information to the
						SIP UAC. The SIP UAC issues a new INVITE along with the obtained crypto
						cookie. <a class='info' href='#FIG3'>Figure&nbsp;4<span> (</span><span class='info'>A case where the Proxy redirects the INVITE to a CAPTCHA UA and gets a SUCCCESS repsonse</span><span>)</span></a> presents the message flow.
</p>
<p> If the user is not successful in solving the CAPTCHA challenge, the CAPTCHA
						UA issues a Bye message or a 4xx RESPONSE with an appropriate error message.
							<a class='info' href='#FIG4'>Figure&nbsp;5<span> (</span><span class='info'>A case where the Proxy redirects the INVITE to a CAPTCHA UA and gets a NOT SUCCCESS repsonse</span><span>)</span></a> presents the message flow. 
</p>
<a name="UAC-oper-redirect"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.2.3"></a><h3>11.2.3.&nbsp;
Operation of UAC when it recieves a challenge from a CAPTCHA UA</h3>

<p> When the UAC receives a challenge from a CAPTCHA UA, the UAC selects the
						challenges marked as mandatory and possibly some additional ones for UAC's
						execution or to be rendered to the user based on e.g. the device
						capabilities. When the challenge gets solved, the UAC provides an answer to
						the CAPTCHA UA. 
</p>
<a name="application-sip-proxy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11.3"></a><h3>11.3.&nbsp;
SIP Application Interaction Framework</h3>

<p>
					<a class='info' href='#I-D.ietf-sipping-app-interaction-framework'>[I&#8209;D.ietf&#8209;sipping&#8209;app&#8209;interaction&#8209;framework]<span> (</span><span class='info'>Rosenberg, J., &ldquo;A Framework for Application Interaction in the Session Initiation Protocol  (SIP),&rdquo; July&nbsp;2005.</span><span>)</span></a> defines a framework
					for interaction between users and SIP based applications. The framework covers
					both the &quot;presentation capable&quot; and &quot;presentation
					free&quot; user interfaces (UI) having different solutions to both. The user
					interaction with the presentation capable UI is handled by using SIP REFER and
					HTTP while the presentation free UI case utilize SIP events <a class='info' href='#RFC3265'>[RFC3265]<span> (</span><span class='info'>Roach, A., &ldquo;SIP-Specific Event Notification,&rdquo; June&nbsp;2002.</span><span>)</span></a> (SIP SUBSCRIBE and NOTIFY). Since there are different
					solutions for different cases, the UAC needs to indicate the supported
					application user interaction mechamisms when issuing a SIP request. 
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2048">[RFC2048]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a>, <a href="mailto:klensin@mci.net">Klensin, J.</a>, and <a href="mailto:Postel@ISI.EDU">J. Postel</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2048">Multipurpose Internet Mail Extensions (MIME) Part Four: Registration Procedures</a>,&rdquo; BCP&nbsp;13, RFC&nbsp;2048, November&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc2048.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2048.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2048.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2141">[RFC2141]</a></td>
<td class="author-text"><a href="mailto:jayhawk@ds.internic.net">Moats, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2141">URN Syntax</a>,&rdquo; RFC&nbsp;2141, May&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2141.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2141.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2141.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2648">[RFC2648]</a></td>
<td class="author-text"><a href="mailto:jayhawk@att.com">Moats, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2648">A URN Namespace for IETF Documents</a>,&rdquo; RFC&nbsp;2648, August&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3023">[RFC3023]</a></td>
<td class="author-text">Murata, M., St. Laurent, S., and D. Kohn, &ldquo;<a href="http://tools.ietf.org/html/rfc3023">XML Media Types</a>,&rdquo; RFC&nbsp;3023, January&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3023.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3261">[RFC3261]</a></td>
<td class="author-text">Rosenberg, J., Schulzrinne, H., Camarillo, G., Johnston, A., Peterson, J., Sparks, R., Handley, M., and E. Schooler, &ldquo;<a href="http://tools.ietf.org/html/rfc3261">SIP: Session Initiation Protocol</a>,&rdquo; RFC&nbsp;3261, June&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3688">[RFC3688]</a></td>
<td class="author-text">Mealling, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3688">The IETF XML Registry</a>,&rdquo; BCP&nbsp;81, RFC&nbsp;3688, January&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3688.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XML">[XML]</a></td>
<td class="author-text">Bray, T., &ldquo;Exensible Markup Language (XML) 1.0 (Second Edition),&rdquo; W3C CR&nbsp;CR-xml11-20011006, October&nbsp;2000.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-sipping-app-interaction-framework">[I-D.ietf-sipping-app-interaction-framework]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-app-interaction-framework-05.txt">A Framework for Application Interaction in the Session Initiation Protocol  (SIP)</a>,&rdquo; draft-ietf-sipping-app-interaction-framework-05 (work in progress), July&nbsp;2005 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-sipping-app-interaction-framework-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.jennings-sip-hashcash">[I-D.jennings-sip-hashcash]</a></td>
<td class="author-text">Jennings, C., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-jennings-sip-hashcash-06.txt">Computational Puzzles for SPAM Reduction in SIP</a>,&rdquo; draft-jennings-sip-hashcash-06 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-jennings-sip-hashcash-06.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.tschofenig-sipping-framework-spit-reduction">[I-D.tschofenig-sipping-framework-spit-reduction]</a></td>
<td class="author-text">Tschofenig, H., Schulzrinne, H., Wing, D., Rosenberg, J., and D. Schwartz, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-tschofenig-sipping-framework-spit-reduction-04.txt">A Framework to tackle Spam and Unwanted Communication for Internet  Telephony</a>,&rdquo; draft-tschofenig-sipping-framework-spit-reduction-04 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-tschofenig-sipping-framework-spit-reduction-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="Inaccessibility-of-CAPTCHA">[Inaccessibility-of-CAPTCHA]</a></td>
<td class="author-text">May, M., &ldquo;Inaccessibility of CAPTCHA; Alternatives to Visual Turing Tests on the
						Web,&rdquo; html&nbsp;http://www.w3.org/TR/turingtest/, November&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3265">[RFC3265]</a></td>
<td class="author-text">Roach, A., &ldquo;<a href="http://tools.ietf.org/html/rfc3265">SIP-Specific Event Notification</a>,&rdquo; RFC&nbsp;3265, June&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5025">[RFC5025]</a></td>
<td class="author-text">Rosenberg, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5025">Presence Authorization Rules</a>,&rdquo; RFC&nbsp;5025, December&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5025.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5039">[RFC5039]</a></td>
<td class="author-text">Rosenberg, J. and C. Jennings, &ldquo;<a href="http://tools.ietf.org/html/rfc5039">The Session Initiation Protocol (SIP) and Spam</a>,&rdquo; RFC&nbsp;5039, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5039.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="XEP-0158">[XEP-0158]</a></td>
<td class="author-text">Paterson, I., &ldquo;XEP-0158: Robot Challenges,&rdquo; html&nbsp;http://wiki.jabber.org/index.php/Robot Challenges (XEP-0158), October&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="captcha">[captcha]</a></td>
<td class="author-text">von Ahn, L., Blum, M., and J. Langford, &ldquo;Telling Humans and Computers Apart Automatically,&rdquo; html&nbsp;http://www.captcha.net, February&nbsp;2004.</td></tr>
<tr><td class="author-text" valign="top"><a name="hashcash">[hashcash]</a></td>
<td class="author-text">Back, A., &ldquo;Hashcash - A Denial of Service Counter-Measure,&rdquo; html&nbsp;http://hashcash.org, August&nbsp;2002.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@nsn.com">Hannes.Tschofenig@nsn.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.com">http://www.tschofenig.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eva Leppanen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Individual</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:eva.leppanen@hukassa.com">eva.leppanen@hukassa.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Saverio Niccolini</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">NEC Laboratories Europe, NEC Europe Ltd.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kurfuersten-Anlage 36</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Heidelberg  69115</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 (0) 6221 4342 118</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:saverio.niccolini@nw.neclab.eu">saverio.niccolini@nw.neclab.eu</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.nw.neclab.eu">http://www.nw.neclab.eu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mayutan Arumaithurai</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Goettingen</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mayutan.arumaithurai@gmail.com">mayutan.arumaithurai@gmail.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.mayutan.org">http://www.mayutan.org</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
