<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Extended URLFETCH for binary and converted parts</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Extended URLFETCH for binary and converted parts">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">D. Cridland</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Isode Limited</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">September 04, 2008</td></tr>
<tr><td class="header">Expires: March 8, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Extended URLFETCH for binary and converted parts<br />draft-cridland-urlfetch-binary-03</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on March 8, 2009.</p>

<h3>Abstract</h3>

<p>The URLFETCH command defined as part of URLAUTH provides a mechanism for third-parties to gain access to data held within messages in a user's private store, however, this data is sent verbatim, which is not suitable for a number of applications. This memo specifies a method for obtaining data in forms suitable for non-mail applications.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Conventions used in this document<br />
<a href="#anchor3">3.</a>&nbsp;
Extended URLFETCH<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Command Parameters<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Response Metadata<br />
<a href="#anchor6">4.</a>&nbsp;
Example Exchanges<br />
<a href="#anchor7">5.</a>&nbsp;
Formal Syntax<br />
<a href="#anchor8">6.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor9">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor10">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Although <a class='info' href='#URLAUTH'>[URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> provides a URLFETCH command which can be used to dereference a URL and return the body part data, it does so by returning the encoded form, without sufficient metadata to decode. This is suitable for use in mail applications such as <a class='info' href='#BURL'>[BURL]<span> (</span><span class='info'>Newman, C., &ldquo;Message Submission BURL Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>, where the encoded form is suitable, but not where access to the actual content is required, such as <a class='info' href='#STREAMING'>[STREAMING]<span> (</span><span class='info'>Cook, N., &ldquo;Streaming Internet Messaging Attachments,&rdquo; June&nbsp;2008.</span><span>)</span></a>.
</p>
<p>This memo specifies a mechanism which returns additional metadata about the part, such as its <a class='info' href='#MEDIATYPE'>[MEDIATYPE]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types,&rdquo; November&nbsp;1996.</span><span>)</span></a> type, as well as removing any content transfer encoding used on the body part.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions used in this document</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in <a class='info' href='#KEYWORDS'>[KEYWORDS]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>Protocol examples are line-wrapped for clarity. Protocol strings are prefixed with C: and S: for client and server respectively, and elided data is represented by [...]. Implementors should note these notations are for editorial clarity only.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Extended URLFETCH</h3>

<p>This extension is available in any IMAP server implementation which includes URLAUTH=BINARY within its capability string.
</p>
<p>Such servers accept additional, per-URL, parameters to the URLFETCH command, and will provide, upon request, specific data for each URL dereferenced.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Command Parameters</h3>

<p>The URLFETCH command is extended by the provision of optional parameters. The extended URLFETCH command is distinct by enclosing each URL and associated parameters in a parenthesized list. The absence of any parameters, or if the URL is sent unenclosed, causes the command to behave precisely as specified in <a class='info' href='#URLAUTH'>[URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>.
</p>
<p>Similarly, if the URL is invalid, the command will behave precisely as specified in <a class='info' href='#URLAUTH'>[URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>, and return a simple NIL.
</p>
<p>Available parameters are:
    </p>
<blockquote class="text"><dl>
<dt>BODYPARTSTRUCTURE</dt>
<dd>Provide a BODYPARTSTRUCTURE.<br />
<br />
BODYPARTSTRUCTURE is defined in <a class='info' href='#CONVERT'>[CONVERT]<span> (</span><span class='info'>Melnikov, A. and P. Coates, &ldquo;Internet Message Access Protocol - CONVERT Extension,&rdquo; July&nbsp;2008.</span><span>)</span></a>, and provides metadata useful for processing applications, such as the type of the data.<br />
<br />

</dd>
<dt>BINARY</dt>
<dd>Provide the data without any Content-Transfer-Encoding.<br />
<br />
In particular, this means that the data MAY contain NUL octets, and not be formed from textual lines. Data containing NUL octets MUST be transferred using the literal8 syntax defined in <a class='info' href='#BINARY'>[BINARY]<span> (</span><span class='info'>Nerenberg, L., &ldquo;IMAP4 Binary Content Extension,&rdquo; April&nbsp;2003.</span><span>)</span></a>.<br />
<br />

</dd>
<dt>BODY</dt>
<dd>Provide the data as-is.<br />
<br />
This will provide the same data as the unextended <a class='info' href='#URLAUTH'>[URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a> as a metadata item.<br />
<br />

</dd>
</dl></blockquote><p>
    
</p>
<p>Metadata items MUST NOT appear more than once per URL requested, and clients MUST NOT request both BINARY and BODY.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Response Metadata</h3>

<p>In order to carry any requested metadata and provide additional information to the consumer, the URLFETCH response is similarly extended.
</p>
<p>Following the URL itself, servers will include a series of parenthesized metadata elements. Defined metadata elements are as follows:
    </p>
<blockquote class="text"><dl>
<dt>BODYPARTSTRUCTURE</dt>
<dd>The BODYPARTSTRUCTURE provides information about the data contained in the response, as it has been returned. It will reflect any conversions or decoding that have taken place. In particular, this will show an identity encoding if BINARY is also requested.<br />
<br />

</dd>
<dt>BINARY</dt>
<dd>The BINARY item provides the content, without any content transfer encoding applied. If this is not possible (for example, the content transfer encoding is unknown to the server), then this MAY contain NIL. Servers MUST understand all identity content transfer encodings defined in <a class='info' href='#MIME'>[MIME]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a>, as well as the transformation encodings "Base64" <a class='info' href='#BASE64'>[BASE64]<span> (</span><span class='info'>Josefsson, S., &ldquo;The Base16, Base32, and Base64 Data Encodings,&rdquo; October&nbsp;2006.</span><span>)</span></a> and "Quoted-Printable" <a class='info' href='#MIME'>[MIME]<span> (</span><span class='info'>Freed, N. and N. Borenstein, &ldquo;Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies,&rdquo; November&nbsp;1996.</span><span>)</span></a>.<br />
<br />

</dd>
<dt>BODY</dt>
<dd>The BODY item provides the content as found in the message, with any content transfer encoding still applied. Requesting only the BODY will provide equivalent functionality to the unextended <a class='info' href='#URLAUTH'>[URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>, however using the extended syntax described herein.<br />
<br />

</dd>
</dl></blockquote>

<p>Note that unlike <a class='info' href='#CONVERT'>[CONVERT]<span> (</span><span class='info'>Melnikov, A. and P. Coates, &ldquo;Internet Message Access Protocol - CONVERT Extension,&rdquo; July&nbsp;2008.</span><span>)</span></a>, BODYPARTSTRUCTURE is not appended with the part specifier, as this is implicit in the URL.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Example Exchanges</h3>

<p>A client requests the data with no content transfer encoding.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
C: A001 URLFETCH  ("imap://joe@example.com/INBOX/;uid=20/;
   section=1.2;urlauth=anonymous:internal:
   91354a473744909de610943775f92038" BINARY)
S: * URLFETCH "imap://joe@example.com/INBOX/;uid=20/;
   section=1.2;urlauth=anonymous:internal:
   91354a473744909de610943775f92038" (BINARY {28}
S: Si vis pacem, para bellum.
S:
S: )
S: A001 OK URLFETCH completed
</pre></div>
<p>Note that the data here does not contain a NUL octet, therefore a literal - not literal8 - syntax has been used.
</p>
<p>A client again requests data with no content transfer encoding, but this time requests the body structure.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
C: A001 URLFETCH  ("imap://joe@example.com/INBOX/;uid=20/;
   section=1.3;urlauth=anonymous:internal:
   ae354a473744909de610943775f92038" BINARY BODYPARTSTRUCTURE)
S: * URLFETCH "imap://joe@example.com/INBOX/;uid=20/;
   section=1.3;urlauth=anonymous:internal:
   ae354a473744909de610943775f92038" (BODYPARTSTRUCTURE
   ("IMAGE" "PNG" () NIL NIL "BINARY" 123)) (BINARY ~{123}
S: [123 octets of data, some of which is NUL])
S: A001 OK URLFETCH completed
</pre></div>
<p>A client requests only the body structure.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
C: A001 URLFETCH  ("imap://joe@example.com/INBOX/;uid=20/;
   section=1.3;urlauth=anonymous:internal:
   ae354a473744909de610943775f92038" BODYPARTSTRUCTURE)
S: * URLFETCH "imap://joe@example.com/INBOX/;uid=20/;
   section=1.3;urlauth=anonymous:internal:
   ae354a473744909de610943775f92038" (BODYPARTSTRUCTURE
   ("IMAGE" "PNG" () NIL NIL "BASE64" 164))
S: A001 OK URLFETCH completed
</pre></div>
<p>A client requests the body structure, and the original content.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
C: A001 URLFETCH  ("imap://joe@example.com/INBOX/;uid=20/;
   section=1.3;urlauth=anonymous:internal:
   ae354a473744909de610943775f92038" BODYPARTSTRUCTURE BODY)
S: * URLFETCH "imap://joe@example.com/INBOX/;uid=20/;
   section=1.3;urlauth=anonymous:internal:
   ae354a473744909de610943775f92038" (BODYPARTSTRUCTURE
   ("IMAGE" "PNG" () NIL NIL "BASE64" 164)) (BODY {164}
S: [164 octets of base64 encoded data])
S: A001 OK URLFETCH completed
</pre></div>
<p>Some parts cannot be decoded, so the server will provide the BODYPARTSTRUCTURE of the part as-is, and NIL for the binary content:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
C: A001 URLFETCH ("imap://joe@example.com/INBOX/;uid=20/;
   section=1.4;urlauth=anonymous:internal:
   87ecbd02095b815e699503fc20d869c8" BODYPARTSTRUCTURE BINARY)
S: * URLFETCH "imap://joe@example.com/INBOX/;uid=20/;
   section=1.4;urlauth=anonymous:internal:
   87ecbd02095b815e699503fc20d869c8" (BODYPARTSTRUCTURE
   ("IMAGE" "PNG" () NIL NIL "X-BLURDYBLOOP" 123))
   (BINARY NIL)
S: A001 OK URLFETCH completed
</pre></div>
<p>If a part simply doesn't exist, however, or the URI is invalid for some other reason, then NIL is returned instead of metadata:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
C: A001 URLFETCH ("imap://joe@example.com/INBOX/;uid=20/;
   section=200;urlauth=anonymous:internal:
   88066d37e2e5410e1a6486350a8836ee" BODYPARTSTRUCTURE BODY)
S: * URLFETCH "imap://joe@example.com/INBOX/;uid=20/;
   section=200;urlauth=anonymous:internal:
   88066d37e2e5410e1a6486350a8836ee" NIL
S: A001 OK URLFETCH completed
</pre></div>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Formal Syntax</h3>

<p>This formal syntax uses ABNF as specified in <a class='info' href='#ABNF'>[ABNF]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>, and includes productions defined in <a class='info' href='#URLAUTH'>[URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>, <a class='info' href='#BINARY'>[BINARY]<span> (</span><span class='info'>Nerenberg, L., &ldquo;IMAP4 Binary Content Extension,&rdquo; April&nbsp;2003.</span><span>)</span></a>  and <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
<dfn>capability</dfn>       =/ "<span class='str'>URLAUTH=BINARY</span>"

   <em>; Command parameters; see Section 3.1</em>

<dfn>urlfetch</dfn>         =  "<span class='str'>URLFETCH</span>" <span class='rep'>1*</span>(<cite class='key'>SP</cite> <cite class='id'>url-fetch-arg</cite>)

<dfn>url-fetch-arg</dfn>    =  <cite class='id'>url-fetch-simple</cite> / <cite class='id'>url-fetch-ext</cite>

<dfn>url-fetch-simple</dfn> =  <cite class='id'>url-full</cite>
   <em>; Unextended URLFETCH.</em>

<dfn>url-fetch-ext</dfn>    =  "<span class='str'>(</span>" <cite class='id'>url-full</cite> <span class='rep'>*</span>(<cite class='key'>SP</cite> <cite class='id'>url-fetch-param</cite>) "<span class='str'>)</span>"
   <em>; If no url-fetch-param present, as unextended.</em>

<dfn>url-fetch-param</dfn>  =  "<span class='str'>BODY</span>" / "<span class='str'>BINARY</span>" / "<span class='str'>BODYPARTSTRUCTURE</span>" / <cite class='id'>atom</cite>

   <em>; Response; see Section 3.2</em>

<dfn>urlfetch-data</dfn>    =  "<span class='str'>*</span>" <cite class='key'>SP</cite> "<span class='str'>URLFETCH</span>"
                    <span class='rep'>1*</span>(<cite class='key'>SP</cite> (<cite class='id'>urldata-simple</cite> / <cite class='id'>urldata-ext</cite> /
                           <cite class='id'>urldata-error</cite>))

<dfn>urldata-error</dfn>    =  <cite class='key'>SP</cite> <cite class='id'>url-full</cite> <cite class='key'>SP</cite> <cite class='id'>nil</cite>

<dfn>urldata-simple</dfn>   =  <cite class='key'>SP</cite> <cite class='id'>url-full</cite> <cite class='key'>SP</cite> <cite class='id'>nstring</cite>
   <em>; If client issues url-fetch-simple, server MUST respond with</em>
   <em>; urldata-simple.</em>

<dfn>urldata-ext</dfn>      =  <cite class='key'>SP</cite> <cite class='id'>url-full</cite> <cite class='id'>url-metadata</cite>

<dfn>url-metadata</dfn>     =  <span class='rep'>1*</span>(<cite class='key'>SP</cite> "<span class='str'>(</span>" <cite class='id'>url-metadata-el</cite> "<span class='str'>)</span>")

<dfn>url-metadata-el</dfn>  =  <cite class='id'>url-meta-bodystruct</cite> / <cite class='id'>url-meta-body</cite> /
                    <cite class='id'>url-meta-binary</cite>

<dfn>url-bodystruct</dfn>   =  "<span class='str'>BODYPARTSTRUCTURE</span>" <cite class='key'>SP</cite> <cite class='id'>body</cite>

<dfn>url-binary</dfn>       =  "<span class='str'>BINARY</span>" <cite class='key'>SP</cite> ( <cite class='id'>nstring</cite> / <cite class='id'>literal8</cite> )
   <em>; If content contains a NUL octet, literal8 MUST be used.</em>
   <em>; Otherwise, content SHOULD use nstring.</em>
   <em>; On decoding error NIL should be used.</em>

<dfn>url-body</dfn>         =  "<span class='str'>BODY</span>" <cite class='key'>SP</cite> <cite class='id'>nstring</cite>

</pre></div>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>IMAP4 capabilities are registered by publishing a standards track or
   IESG approved experimental RFC.  The registry is currently located
   at:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      http://www.iana.org/assignments/imap4-capabilities
</pre></div>
<p>This document defines the URLFETCH=BINARY IMAP capability.  IANA is requested to add
   it to the registry accordingly.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>Implementors are directed to the security considerations within <a class='info' href='#IMAP'>[IMAP]<span> (</span><span class='info'>Crispin, M., &ldquo;INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1,&rdquo; March&nbsp;2003.</span><span>)</span></a>, <a class='info' href='#URLAUTH'>[URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>, and <a class='info' href='#BINARY'>[BINARY]<span> (</span><span class='info'>Nerenberg, L., &ldquo;IMAP4 Binary Content Extension,&rdquo; April&nbsp;2003.</span><span>)</span></a>.
</p>
<p>The ability of the holder of a URL to be able to fetch metadata about the content pointed to by the URL as well as the content itself allows a potential attacker to discover more about the content than was previously possible, including its original filename, and user-supplied description.
</p>
<p>The additional value of this information to an attacker in marginal, and applies only to those URLs for which the attacker does not have direct access, such as those produced by <a class='info' href='#URLAUTH'>[URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>. Implementors are therefore directed to the security considerations present in <a class='info' href='#URLAUTH'>[URLAUTH]<span> (</span><span class='info'>Crispin, M., &ldquo;Internet Message Access Protocol (IMAP) - URLAUTH Extension,&rdquo; May&nbsp;2006.</span><span>)</span></a>.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>Comments were received on the idea, and/or this draft, from Neil Cook, Philip Guenther, Alexey Melnikov, Ken Murchison and others. Whether in agreement or dissent, the comments have refined and otherwise influenced the document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ABNF">[ABNF]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5234.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="BASE64">[BASE64]</a></td>
<td class="author-text">Josefsson, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4648">The Base16, Base32, and Base64 Data Encodings</a>,&rdquo; RFC&nbsp;4648, October&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4648.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="BINARY">[BINARY]</a></td>
<td class="author-text">Nerenberg, L., &ldquo;<a href="http://tools.ietf.org/html/rfc3516">IMAP4 Binary Content Extension</a>,&rdquo; RFC&nbsp;3516, April&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3516.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="CONVERT">[CONVERT]</a></td>
<td class="author-text">Melnikov, A. and P. Coates, &ldquo;<a href="http://tools.ietf.org/html/rfc5259">Internet Message Access Protocol - CONVERT Extension</a>,&rdquo; RFC&nbsp;5259, July&nbsp;2008 (<a href="ftp://ftp.isi.edu/in-notes/rfc5259.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IMAP">[IMAP]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3501">INTERNET MESSAGE ACCESS PROTOCOL - VERSION 4rev1</a>,&rdquo; RFC&nbsp;3501, March&nbsp;2003 (<a href="ftp://ftp.isi.edu/in-notes/rfc3501.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="KEYWORDS">[KEYWORDS]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MIME">[MIME]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2045">Multipurpose Internet Mail Extensions (MIME) Part One: Format of Internet Message Bodies</a>,&rdquo; RFC&nbsp;2045, November&nbsp;1996 (<a href="ftp://ftp.isi.edu/in-notes/rfc2045.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="URLAUTH">[URLAUTH]</a></td>
<td class="author-text">Crispin, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4467">Internet Message Access Protocol (IMAP) - URLAUTH Extension</a>,&rdquo; RFC&nbsp;4467, May&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4467.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="BURL">[BURL]</a></td>
<td class="author-text">Newman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4468">Message Submission BURL Extension</a>,&rdquo; RFC&nbsp;4468, May&nbsp;2006 (<a href="ftp://ftp.isi.edu/in-notes/rfc4468.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="MEDIATYPE">[MEDIATYPE]</a></td>
<td class="author-text"><a href="mailto:ned@innosoft.com">Freed, N.</a> and <a href="mailto:nsb@nsb.fv.com">N. Borenstein</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2046">Multipurpose Internet Mail Extensions (MIME) Part Two: Media Types</a>,&rdquo; RFC&nbsp;2046, November&nbsp;1996 (<a href="ftp://ftp.isi.edu/in-notes/rfc2046.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="STREAMING">[STREAMING]</a></td>
<td class="author-text">Cook, N., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-lemonade-streaming-06.txt">Streaming Internet Messaging Attachments</a>,&rdquo; draft-ietf-lemonade-streaming-06 (work in progress), June&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-lemonade-streaming-06.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dave Cridland</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Isode Limited</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5 Castle Business Village</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">36, Station Road</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hampton, Middlesex  TW12 2BX</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">GB</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dave.cridland@isode.com">dave.cridland@isode.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
