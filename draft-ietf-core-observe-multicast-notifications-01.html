<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Observe Notifications as CoAP Multicast Responses</title>
<meta content="Marco Tiloca" name="author">
<meta content="Rikard Höglund" name="author">
<meta content="Christian Amsüss" name="author">
<meta content="Francesca Palombini" name="author">
<meta content='
       The Constrained Application Protocol (CoAP) allows clients to "observe" resources at a server, and receive notifications as unicast responses upon changes of the resource state. In some use cases, such as based on publish-subscribe, it would be convenient for the server to send a single notification addressed to all the clients observing a same target resource. This document updates RFC7252 and RFC7641, and defines how a server sends observe notifications as response messages over multicast, synchronizing  all the observers of a same resource on a same shared Token value. Besides, this document defines how Group OSCORE can be used to protect multicast notifications end-to-end between the server and the observer clients. 
    ' name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-core-observe-multicast-notifications-01" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 57.0.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-core-observe-multicast-notifications-01-1czvu637.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Observe Multicast Notifications</td>
<td class="right">July 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Tiloca, et al.</td>
<td class="center">Expires 13 January 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CoRE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-core-observe-multicast-notifications-01</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfc7252" class="eref">7252</a>, <a href="https://www.rfc-editor.org/rfc/rfc7641" class="eref">7641</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-07-12" class="published">12 July 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-01-13">13 January 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">R. Höglund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">C. Amsüss</div>
</div>
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson AB</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Observe Notifications as CoAP Multicast Responses</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The Constrained Application Protocol (CoAP) allows clients to "observe" resources at a server, and receive notifications as unicast responses upon changes of the resource state. In some use cases, such as based on publish-subscribe, it would be convenient for the server to send a single notification addressed to all the clients observing a same target resource. This document updates RFC7252 and RFC7641, and defines how a server sends observe notifications as response messages over multicast, synchronizing  all the observers of a same resource on a same shared Token value. Besides, this document defines how Group OSCORE can be used to protect multicast notifications end-to-end between the server and the observer clients.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Constrained RESTful Environments Working Group mailing list (core@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/core-wg/observe-multicast-notifications">https://github.com/core-wg/observe-multicast-notifications</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 13 January 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulBare toc ulEmpty">
<li class="compact ulBare toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-server-side-requirements" class="xref">Server-Side Requirements</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-request" class="xref">Request</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-informative-response" class="xref">Informative Response</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.2.2.1">
                    <p id="section-toc.1-1.2.2.2.2.1.1"><a href="#section-2.2.1" class="xref">2.2.1</a>.  <a href="#name-encoding-of-transport-speci" class="xref">Encoding of Transport-Specific Message Information</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.2.2.2">
                    <p id="section-toc.1-1.2.2.2.2.2.1"><a href="#section-2.2.2" class="xref">2.2.2</a>.  <a href="#name-encoding-of-transport-indep" class="xref">Encoding of Transport-Independent Message Information</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-notifications" class="xref">Notifications</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-congestion-control" class="xref">Congestion Control</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-cancellation" class="xref">Cancellation</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-client-side-requirements" class="xref">Client-Side Requirements</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-request-2" class="xref">Request</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-informative-response-2" class="xref">Informative Response</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-notifications-2" class="xref">Notifications</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-cancellation-2" class="xref">Cancellation</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-web-linking" class="xref">Web Linking</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-example" class="xref">Example</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-rough-counting-of-clients-i" class="xref">Rough Counting of Clients in the Group Observation</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-multicast-response-feedback" class="xref">Multicast-Response-Feedback-Divider Option</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-processing-on-the-client-si" class="xref">Processing on the Client Side</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-processing-on-the-server-si" class="xref">Processing on the Server Side</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-request-for-feedback" class="xref">Request for Feedback</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.6.2.3.2.2">
                    <p id="section-toc.1-1.6.2.3.2.2.1"><a href="#section-6.3.2" class="xref">6.3.2</a>.  <a href="#name-collection-of-feedback" class="xref">Collection of Feedback</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.6.2.3.2.3">
                    <p id="section-toc.1-1.6.2.3.2.3.1"><a href="#section-6.3.3" class="xref">6.3.3</a>.  <a href="#name-processing-of-feedback" class="xref">Processing of Feedback</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-protection-of-multicast-not" class="xref">Protection of Multicast Notifications with Group OSCORE</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-signaling-the-oscore-group-" class="xref">Signaling the OSCORE Group in the Informative Response</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-server-side-requirements-2" class="xref">Server-Side Requirements</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.7.2.2.2.1">
                    <p id="section-toc.1-1.7.2.2.2.1.1"><a href="#section-7.2.1" class="xref">7.2.1</a>.  <a href="#name-registration" class="xref">Registration</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.7.2.2.2.2">
                    <p id="section-toc.1-1.7.2.2.2.2.1"><a href="#section-7.2.2" class="xref">7.2.2</a>.  <a href="#name-informative-response-3" class="xref">Informative Response</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.7.2.2.2.3">
                    <p id="section-toc.1-1.7.2.2.2.3.1"><a href="#section-7.2.3" class="xref">7.2.3</a>.  <a href="#name-notifications-3" class="xref">Notifications</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.7.2.2.2.4">
                    <p id="section-toc.1-1.7.2.2.2.4.1"><a href="#section-7.2.4" class="xref">7.2.4</a>.  <a href="#name-cancellation-3" class="xref">Cancellation</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-client-side-requirements-2" class="xref">Client-Side Requirements</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.7.2.3.2.1">
                    <p id="section-toc.1-1.7.2.3.2.1.1"><a href="#section-7.3.1" class="xref">7.3.1</a>.  <a href="#name-informative-response-4" class="xref">Informative Response</a></p>
</li>
                  <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.7.2.3.2.2">
                    <p id="section-toc.1-1.7.2.3.2.2.1"><a href="#section-7.3.2" class="xref">7.3.2</a>.  <a href="#name-notifications-4" class="xref">Notifications</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-example-with-group-oscore" class="xref">Example with Group OSCORE</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-intermediaries" class="xref">Intermediaries</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-intermediaries-together-wit" class="xref">Intermediaries Together with End-to-End Security</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#section-10.1" class="xref">10.1</a>.  <a href="#name-listen-to-multicast-respons" class="xref">Listen-To-Multicast-Responses Option</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#section-10.2" class="xref">10.2</a>.  <a href="#name-message-processing" class="xref">Message Processing</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-informative-response-parame" class="xref">Informative Response Parameters</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-transport-protocol-informat" class="xref">Transport Protocol Information</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.13.2.1">
                <p id="section-toc.1-1.13.2.1.1"><a href="#section-13.1" class="xref">13.1</a>.  <a href="#name-listen-to-multicast-responses" class="xref">Listen-To-Multicast-Responses Option</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-media-type-registrations" class="xref">Media Type Registrations</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-coap-content-formats-regist" class="xref">CoAP Content-Formats Registry</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.14.2.3">
                <p id="section-toc.1-1.14.2.3.1"><a href="#section-14.3" class="xref">14.3</a>.  <a href="#name-informative-response-paramet" class="xref">Informative Response Parameters Registry</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.14.2.4">
                <p id="section-toc.1-1.14.2.4.1"><a href="#section-14.4" class="xref">14.4</a>.  <a href="#name-coap-transport-information-" class="xref">CoAP Transport Information Registry</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.14.2.5">
                <p id="section-toc.1-1.14.2.5.1"><a href="#section-14.5" class="xref">14.5</a>.  <a href="#name-coap-option-numbers-registr" class="xref">CoAP Option Numbers Registry</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.14.2.6">
                <p id="section-toc.1-1.14.2.6.1"><a href="#section-14.6" class="xref">14.6</a>.  <a href="#name-expert-review-instructions" class="xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-15" class="xref">15</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.15.2.1">
                <p id="section-toc.1-1.15.2.1.1"><a href="#section-15.1" class="xref">15.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.15.2.2">
                <p id="section-toc.1-1.15.2.2.1"><a href="#section-15.2" class="xref">15.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-different-sources-for-group" class="xref">Different Sources for Group Observation Data</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.16.2.1">
                <p id="section-toc.1-1.16.2.1.1"><a href="#appendix-A.1" class="xref">A.1</a>.  <a href="#name-topic-discovery-in-publish-" class="xref">Topic Discovery in Publish-Subscribe Settings</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.16.2.2">
                <p id="section-toc.1-1.16.2.2.1"><a href="#appendix-A.2" class="xref">A.2</a>.  <a href="#name-introspection-at-the-multic" class="xref">Introspection at the Multicast Notification Sender</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.17">
            <p id="section-toc.1-1.17.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-pseudo-code-for-rough-count" class="xref">Pseudo-Code for Rough Counting of Clients</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.17.2.1">
                <p id="section-toc.1-1.17.2.1.1"><a href="#appendix-B.1" class="xref">B.1</a>.  <a href="#name-client-side" class="xref">Client Side</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.17.2.2">
                <p id="section-toc.1-1.17.2.2.1"><a href="#appendix-B.2" class="xref">B.2</a>.  <a href="#name-client-side-optimized-versi" class="xref">Client Side - Optimized Version</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.17.2.3">
                <p id="section-toc.1-1.17.2.3.1"><a href="#appendix-B.3" class="xref">B.3</a>.  <a href="#name-server-side" class="xref">Server Side</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.18">
            <p id="section-toc.1-1.18.1"><a href="#appendix-C" class="xref">Appendix C</a>.  <a href="#name-oscore-group-self-managed-b" class="xref">OSCORE Group Self-Managed by the Server</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.19">
            <p id="section-toc.1-1.19.1"><a href="#appendix-D" class="xref">Appendix D</a>.  <a href="#name-phantom-request-as-determin" class="xref">Phantom Request as Deterministic Request</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.20">
            <p id="section-toc.1-1.20.1"><a href="#appendix-E" class="xref">Appendix E</a>.  <a href="#name-example-with-a-proxy" class="xref">Example with a Proxy</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.21">
            <p id="section-toc.1-1.21.1"><a href="#appendix-F" class="xref">Appendix F</a>.  <a href="#name-example-with-a-proxy-and-gr" class="xref">Example with a Proxy and Group OSCORE</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.22">
            <p id="section-toc.1-1.22.1"><a href="#appendix-G" class="xref">Appendix G</a>.  <a href="#name-example-with-a-proxy-and-de" class="xref">Example with a Proxy and Deterministic Requests</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.22.2.1">
                <p id="section-toc.1-1.22.2.1.1"><a href="#appendix-G.1" class="xref">G.1</a>.  <a href="#name-assumptions-and-walkthrough" class="xref">Assumptions and Walkthrough</a></p>
</li>
              <li class="compact toc ulEmpty ulBare" id="section-toc.1-1.22.2.2">
                <p id="section-toc.1-1.22.2.2.1"><a href="#appendix-G.2" class="xref">G.2</a>.  <a href="#name-message-exchange" class="xref">Message Exchange</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.23">
            <p id="section-toc.1-1.23.1"><a href="#appendix-H" class="xref">Appendix H</a>.  <a href="#name-document-updates" class="xref">Document Updates</a></p>
<ul class="compact toc ulEmpty ulBare">
<li class="compact toc ulEmpty ulBare" id="section-toc.1-1.23.2.1">
                <p id="section-toc.1-1.23.2.1.1"><a href="#appendix-H.1" class="xref">H.1</a>.  <a href="#name-version-00-to-01" class="xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.24">
            <p id="section-toc.1-1.24.1"><a href="#appendix-I" class="xref"></a><a href="#name-acknowledgments" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact ulBare toc ulEmpty" id="section-toc.1-1.25">
            <p id="section-toc.1-1.25.1"><a href="#appendix-J" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">The Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> has been extended with a number of mechanisms, including resource Observation <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>. This enables CoAP clients to register at a CoAP server as "observers" of a resource, and hence being automatically notified with an unsolicited response upon changes of the resource state.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">CoAP supports group communication over IP multicast <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>. This includes support for Observe registration requests over multicast, in order for clients to efficiently register as observers of a resource hosted at multiple servers.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">However, in a number of use cases, using multicast messages for responses would also be desirable. That is, it would be useful that a server sends observe notifications for a same target resource to multiple observers as responses over IP multicast.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">For instance, in CoAP publish-subscribe <span>[<a href="#I-D.ietf-core-coap-pubsub" class="xref">I-D.ietf-core-coap-pubsub</a>]</span>, multiple clients can subscribe to a topic, by observing the related resource hosted at the responsible broker. When a new value is published on that topic, it would be convenient for the broker to send a single multicast notification at once, to all the subscriber clients observing that topic.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">A different use case concerns clients observing a same registration resource at the CoRE Resource Directory <span>[<a href="#I-D.ietf-core-resource-directory" class="xref">I-D.ietf-core-resource-directory</a>]</span>. For example, multiple clients can benefit of observation for discovering (to-be-created) OSCORE groups <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, by retrieving from the Resource Directory updated links and descriptions to join them through the respective Group Manager <span>[<a href="#I-D.tiloca-core-oscore-discovery" class="xref">I-D.tiloca-core-oscore-discovery</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">More in general, multicast notifications would be beneficial whenever several CoAP clients observe a same target resource at a CoAP server, and can be all notified at once by means of a single response message. However, CoAP does not currently define response messages over IP multicast. This document fills this gap and provides the following twofold contribution.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">First, it updates <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> and <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>, by defining a method to deliver Observe notifications as CoAP responses addressed to multiple clients, e.g., over IP multicast. In the proposed method, the group of potential observers entrusts the server to manage the Token space for multicast notifications. By doing so, the server provides all the observers of a target resource with the same Token value to bind to their own observation. That Token value is then used in every multicast notification for the target resource. This is achieved by means of an informative unicast response sent by the server to each observer client.<a href="#section-1-7" class="pilcrow">¶</a></p>
<p id="section-1-8">Second, this document defines how to use Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> to protect multicast notifications end-to-end between the server and the observer clients. This is also achieved by means of the informative unicast response mentioned above, which additionally includes parameter values used by the server to protect every multicast notification for the target resource by using Group OSCORE. This provides a secure binding between each of such notifications and the observation of each of the clients.<a href="#section-1-8" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Readers are expected to be familiar with terms and concepts described in CoAP <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>, group communication for CoAP <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>, Observe <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>, CBOR <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span>, and Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">This document additionally defines the following terminology.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.1-4.1">Traditional observation. A resource observation associated to a single observer client, as defined in <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>.<a href="#section-1.1-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.2">Group observation. A resource observation associated to a group of clients. The server sends notifications for the group-observed resource over IP multicast to all the observer clients.<a href="#section-1.1-4.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.3">Phantom request. The CoAP request message that the server would have received to start or cancel a group observation on one of its resources. A phantom request is generated inside the server and does not hit the wire.<a href="#section-1.1-4.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.1-4.4">Informative response. A CoAP response message that the server sends to a given client via unicast, providing the client with information on a group observation.<a href="#section-1.1-4.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sec-server-side">
<section id="section-2">
      <h2 id="name-server-side-requirements">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-server-side-requirements" class="section-name selfRef">Server-Side Requirements</a>
      </h2>
<p id="section-2-1">The server can, at any time, start a group observation on one of its resources. Practically, the server may want to do that under the following circumstances.<a href="#section-2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-2.1">In the absence of observations for the target resource, the server receives a registration request from a first client wishing to start a traditional observation on that resource.<a href="#section-2-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-2.2">When a certain amount of traditional observations has been established on the target resource, the server decides to make those clients part of a group observation on that resource.<a href="#section-2-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-2-3">The server maintains an observer counter for each group observation to a target resource, as a rough estimation of the observers actively taking part in the group observation.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">The server initializes the counter to 0 when starting the group observation, and increments it after a new client starts taking part in that group observation. Also, the server should keep the counter up-to-date over time, for instance by using the method described in <a href="#sec-rough-counting" class="xref">Section 6</a>.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">This document does not describe a way for the client to influence the server's decision to start group observations.
That is done on purpose:
the specified mechanism is expected to be used in situations where sending individual notifications is not feasible, or not preferred beyond a certain number of clients observing a target resource.
If applications arise where negotiation does make sense,
they are welcome to specify additional means to opt in to multicast notifications.<a href="#section-2-5" class="pilcrow">¶</a></p>
<div id="ssec-server-side-request">
<section id="section-2.1">
        <h3 id="name-request">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-request" class="section-name selfRef">Request</a>
        </h3>
<p id="section-2.1-1">Assuming it is reachable at the address SRV_ADDR and port number SRV_PORT, the server starts a group observation on one of its resources as defined below. The server intends to send multicast notifications for the target resource to the multicast IP address GRP_ADDR and port number GRP_PORT.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-2.1-2">
<li id="section-2.1-2.1">The server builds a phantom observation request, i.e., a GET request with an Observe option set to 0 (register).<a href="#section-2.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.2">
            <p id="section-2.1-2.2.1">The server selects an available value T, from the Token space of a CoAP endpoint used for messages having:<a href="#section-2.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.1-2.2.2.1">As source address and port number, the IP multicast address GRP_ADDR and port number GRP_PORT.<a href="#section-2.1-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-2.1-2.2.2.2">As destination address and port number, the server address SRV_ADDR and port number SRV_PORT, intended for accessing the target resource.<a href="#section-2.1-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-2.1-2.2.3">
This Token space is under exclusive control of the server.<a href="#section-2.1-2.2.3" class="pilcrow">¶</a></p>
</li>
          <li id="section-2.1-2.3">The server processes the phantom observation request above, without transmitting it on the wire. The request is addressed to the resource for which the server wants to start the group observation, as if sent by the group of observers, i.e., with GRP_ADDR as source address and GRP_PORT as source port.<a href="#section-2.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.4">Upon processing the self-generated phantom registration request, the server interprets it as an observe registration received from the group of potential observer clients. In particular, from then on, the server MUST use T as its own local Token value associated to that observation, with respect to the (previous hop towards the) clients.<a href="#section-2.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.5">The server does not immediately respond to the phantom observation request with a multicast notification sent on the wire. The server stores the phantom observation request as is, throughout the lifetime of the group observation.<a href="#section-2.1-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-2.1-2.6">The server builds a CoAP response message INIT_NOTIF as initial multicast notification for the target resource, in response to the phantom observation request. This message is formatted as other multicast notifications (see <a href="#ssec-server-side-notifications" class="xref">Section 2.3</a>) and MUST include the current representation of the target resource as payload. The server stores the message INIT_NOTIF and does not transmit it. The server considers this message as the latest multicast notification for the target resource, until it transmits a new multicast notification for that resource as a CoAP message on the wire. After that, the server deletes the message INIT_NOTIF.<a href="#section-2.1-2.6" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="ssec-server-side-informative">
<section id="section-2.2">
        <h3 id="name-informative-response">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-informative-response" class="section-name selfRef">Informative Response</a>
        </h3>
<p id="section-2.2-1">After having started a group observation on a target resource, the server proceeds as follows.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">For each traditional observation ongoing on the target resource, the server MAY cancel that observation. Then, the server considers the corresponding clients as now taking part in the group observation, for which it increases the corresponding observer counter accordingly.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">The server sends to each of such clients an informative response message, encoded as a unicast response with response code 5.03 (Service Unavailable). As per <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>, such a response does not include an Observe option. The response MUST be Confirmable and MUST NOT encode link-local addresses.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<p id="section-2.2-4">The Content-Format of the informative response is set to application/informative-response+cbor, defined in <a href="#content-format" class="xref">Section 14.2</a>. The payload of the informative response is a CBOR map including the following parameters, whose CBOR labels are defined in <a href="#informative-response-params" class="xref">Section 11</a>.<a href="#section-2.2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2-5.1">'tp_info', with value a CBOR array. This includes the transport-specific information required to correctly receive multicast notifications bound to the phantom observation request. The CBOR array is formatted as defined in <a href="#sssec-transport-specific-encoding" class="xref">Section 2.2.1</a>. This parameter MUST be included.<a href="#section-2.2-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-5.2">'ph_req', with value the byte serialization of the transport-independent information of the phantom observation request (see <a href="#ssec-server-side-request" class="xref">Section 2.1</a>), encoded as a CBOR byte string. The value of the CBOR byte string is formatted as defined in <a href="#sssec-transport-independent-encoding" class="xref">Section 2.2.2</a>. This parameter MUST be included.<a href="#section-2.2-5.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.2-5.3">'last_notif', with value the byte serialization of the transport-independent information of the latest multicast notification for the target resource, encoded as a CBOR byte string. The value of the CBOR byte string is formatted as defined in <a href="#sssec-transport-independent-encoding" class="xref">Section 2.2.2</a>. This parameter MAY be included.<a href="#section-2.2-5.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.2-6">The CDDL notation <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span> provided below describes the payload of the informative response.<a href="#section-2.2-6" class="pilcrow">¶</a></p>
<span id="name-format-of-the-informative-r"></span><div id="informative-response-payload">
<figure id="figure-1">
          <div class="artwork art-text alignLeft" id="section-2.2-7.1">
<pre>
informative_response_payload = {
   1 =&gt; array, ; 'tp_info', i.e., transport-specific information
   2 =&gt; bstr,  ; 'ph_req' (transport-independent information)
 ? 3 =&gt; bstr   ; 'last_notif' (transport-independent information)
}
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-format-of-the-informative-r" class="selfRef">Format of the informative response payload</a>
          </figcaption></figure>
</div>
<p id="section-2.2-8">Upon receiving a registration request to observe the target resource, the server does not create a corresponding individual observation for the requesting client. Instead, the server considers that client as now taking part in the group observation of the target resource, of which it increments the observer counter by 1. Then, the server replies to the client with the same informative response message defined above, which MUST be Confirmable.<a href="#section-2.2-8" class="pilcrow">¶</a></p>
<p id="section-2.2-9">Note that this also applies when, with no ongoing traditional observations on the target resource, the server receives a registration request from a first client and decides to start a group observation on the target resource.<a href="#section-2.2-9" class="pilcrow">¶</a></p>
<div id="sssec-transport-specific-encoding">
<section id="section-2.2.1">
          <h4 id="name-encoding-of-transport-speci">
<a href="#section-2.2.1" class="section-number selfRef">2.2.1. </a><a href="#name-encoding-of-transport-speci" class="section-name selfRef">Encoding of Transport-Specific Message Information</a>
          </h4>
<p id="section-2.2.1-1">The CBOR array specified in the 'tp_info' parameter is formatted according to the following CDDL notation.<a href="#section-2.2.1-1" class="pilcrow">¶</a></p>
<span id="name-general-format-of-tp_info"></span><div id="tp-info-general">
<figure id="figure-2">
            <div class="artwork art-text alignLeft" id="section-2.2.1-2.1">
<pre>
tp_info = [
    srv_addr  ; Addressing information of the server
  ? req_info  ; Request data extension
]

srv_addr = (
    tp_id : int,  ; Identifier of the used transport protocol
  + elements      ; Number, format and encoding
                  ; based on the value of 'tp_id'
)

req_info = (
  + elements  ; Number, format and encoding based on
              ; the value of 'tp_id' in 'srv_addr'
)
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-general-format-of-tp_info" class="selfRef">General format of 'tp_info'</a>
            </figcaption></figure>
</div>
<p id="section-2.2.1-3">The 'srv_addr' element of 'tp_info' specifies the addressing information of the server, and includes at least one element 'tp_id' which is formatted as follows.<a href="#section-2.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-4.1">
              <p id="section-2.2.1-4.1.1">'tp_id' : this element is a CBOR integer, which specifies the transport protocol used to transport the CoAP response from the server, i.e., a multicast notification in this document.<a href="#section-2.2.1-4.1.1" class="pilcrow">¶</a></p>
<p id="section-2.2.1-4.1.2">
This element takes value from the "Value" column of the "CoAP Transport Information" registry defined in <a href="#iana-transport-protocol-identifiers" class="xref">Section 14.4</a> of this document. This element MUST be present. The value of this element determines:<a href="#section-2.2.1-4.1.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-4.1.3.1">How many elements are required to follow in 'srv_addr', as well as what information they convey, their encoding and their semantics.<a href="#section-2.2.1-4.1.3.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-2.2.1-4.1.3.2">How many elements are required in the 'req_info' element of the 'tp_info' array, as well as what information they convey, their encoding and their semantics.<a href="#section-2.2.1-4.1.3.2" class="pilcrow">¶</a>
</li>
              </ul>
<p id="section-2.2.1-4.1.4">
This document registers the integer value 1 ("UDP") to be used as value for the 'tp_id' element, when CoAP responses are transported over UDP. In such a case, the full encoding of the 'tp_info' CBOR array is as defined in <a href="#ssssec-udp-transport-specific" class="xref">Section 2.2.1.1</a>.<a href="#section-2.2.1-4.1.4" class="pilcrow">¶</a></p>
<p id="section-2.2.1-4.1.5">
Future specifications that consider CoAP multicast notifications transported over different transport protocols MUST:<a href="#section-2.2.1-4.1.5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1-4.1.6.1">Register an entry with an integer value to be used for 'tp_id', in the "CoAP Transport Information" registry defined in <a href="#iana-transport-protocol-identifiers" class="xref">Section 14.4</a> of this document.<a href="#section-2.2.1-4.1.6.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-2.2.1-4.1.6.2">Accordingly, define the elements of the 'tp_info' CBOR array, i.e., the elements following 'tp_id' in 'srv_addr' as well as the elements in 'req_info', as to what information they convey, their encoding and their semantics.<a href="#section-2.2.1-4.1.6.2" class="pilcrow">¶</a>
</li>
              </ul>
</li>
          </ul>
<p id="section-2.2.1-5">The 'req_info' element of 'tp_info' specifies transport-specific information related to a pertinent request message, i.e., the phantom observation request in this document. The exact format of 'req_info' depends on the value of 'tp_id'.<a href="#section-2.2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.2.1-6">Given a specific value of 'tp_id', the complete set of elements composing 'srv_addr' and 'req_info' in the 'tp_info' CBOR array is indicated by the two columns "Srv Addr" and "Req Info" of the "CoAP Transport Information" registry defined in <a href="#iana-transport-protocol-identifiers" class="xref">Section 14.4</a>, respectively.<a href="#section-2.2.1-6" class="pilcrow">¶</a></p>
<div id="ssssec-udp-transport-specific">
<section id="section-2.2.1.1">
            <h5 id="name-udp-transport-specific-info">
<a href="#section-2.2.1.1" class="section-number selfRef">2.2.1.1. </a><a href="#name-udp-transport-specific-info" class="section-name selfRef">UDP Transport-Specific Information</a>
            </h5>
<p id="section-2.2.1.1-1">When CoAP multicast notifications are transported over UDP as per <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> and <span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>, the server specifies the integer value 1 ("UDP") as value of 'tp_id' in the 'srv_addr' element of the 'tp_info' CBOR array in the error informative response. Then, the rest of the 'tp_info' CBOR array is defined as follows.<a href="#section-2.2.1.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.1-2.1">
                <p id="section-2.2.1.1-2.1.1">'srv_addr' includes two more elements following 'tp_id':<a href="#section-2.2.1.1-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.1-2.1.2.1">'srv_host': this element is a CBOR byte string, with value the destination IP address of the phantom observation request. This parameter is tagged and identified by the CBOR tag 260 "Network Address (IPv4 or IPv6 or MAC Address)".  That is, the value of the CBOR byte string is the IP address SRV_ADDR of the server hosting the target resource, from where the server will send multicast notifications for the target resource. This element MUST be present.<a href="#section-2.2.1.1-2.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.2.1.1-2.1.2.2">'srv_port': this element is a CBOR unsigned integer, with value the destination port number of the phantom observation request. That is, the specified value is the port number SRV_PORT, from where the server will send multicast notifications for the target resource. This element MUST be present.<a href="#section-2.2.1.1-2.1.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-2.2.1.1-2.2">
                <p id="section-2.2.1.1-2.2.1">'req_info' includes the following elements:<a href="#section-2.2.1.1-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.1.1-2.2.2.1">'token': this element is a CBOR byte string, with value the Token value of the phantom observation request generated by the server (see <a href="#ssec-server-side-request" class="xref">Section 2.1</a>). Note that the same Token value is used for the multicast notifications bound to that phantom observation request (see <a href="#ssec-server-side-notifications" class="xref">Section 2.3</a>). This element MUST be present.<a href="#section-2.2.1.1-2.2.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.2.1.1-2.2.2.2">'cli_addr': this element is a CBOR byte string, with value the source IP address of the phantom observation request. This parameter is tagged and identified by the CBOR tag 260 "Network Address (IPv4 or IPv6 or MAC Address)". That is, the value of the CBOR byte string is the IP multicast address GRP_ADDR, where the server will send multicast notifications for the target resource. This element MUST be present.<a href="#section-2.2.1.1-2.2.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-2.2.1.1-2.2.2.3">'cli_port': this element is a CBOR unsigned integer, with value the source port number of the phantom observation request. That is, the specified value is the port number GRP_PORT, where the server will send multicast notifications for the target resource. This element is OPTIONAL. If not included, the default port number 5683 is assumed.<a href="#section-2.2.1.1-2.2.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</li>
            </ul>
<p id="section-2.2.1.1-3">The CDDL notation provided below describes the full 'tp_info' CBOR array using the format above.<a href="#section-2.2.1.1-3" class="pilcrow">¶</a></p>
<span id="name-format-of-tp_info-with-udp-"></span><div id="tp-info-udp">
<figure id="figure-3">
              <div class="artwork art-text alignLeft" id="section-2.2.1.1-4.1">
<pre>
tp_info = [
    tp_id    : 1,             ; UDP as transport protocol
    srv_host : #6.260(bstr),  ; Src. address of multicast notifications
    srv_port : uint,          ; Src. port of multicast notifications
    token    : bstr,          ; Token of the phantom request and
                              ; associated multicast notifications
    cli_addr : #6.260(bstr),  ; Dst. address of multicast notifications
  ? cli_port : uint           ; Dst. port of multicast notifications
]
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-format-of-tp_info-with-udp-" class="selfRef">Format of 'tp_info' with UDP as transport protocol</a>
              </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="sssec-transport-independent-encoding">
<section id="section-2.2.2">
          <h4 id="name-encoding-of-transport-indep">
<a href="#section-2.2.2" class="section-number selfRef">2.2.2. </a><a href="#name-encoding-of-transport-indep" class="section-name selfRef">Encoding of Transport-Independent Message Information</a>
          </h4>
<p id="section-2.2.2-1">For both the parameters 'ph_req' and 'last_notif' in the informative response, the value of the byte string is the concatenation of the following components, in the order specified below.<a href="#section-2.2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2.2-2">When defining the value of each component, "CoAP message" refers to the phantom observation request for the 'ph_req' parameter, and to the corresponding latest multicast notification for the 'last_notif' parameter.<a href="#section-2.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.2.2-3.1">A single byte, with value the content of the Code field in the CoAP message.<a href="#section-2.2.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-3.2">The byte serialization of the complete sequence of CoAP options in the CoAP message.<a href="#section-2.2.2-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-2.2.2-3.3">If the CoAP message includes a non-zero length payload, the one-byte Payload Marker (0xff) followed by the payload.<a href="#section-2.2.2-3.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
</div>
<div id="ssec-server-side-notifications">
<section id="section-2.3">
        <h3 id="name-notifications">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-notifications" class="section-name selfRef">Notifications</a>
        </h3>
<p id="section-2.3-1">Upon a change in the status of the target resource under group observation, the server sends a multicast notification, intended to all the clients taking part in the group observation of that resource. In particular, each of such multicast notifications is formatted as follows.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.3-2.1">It MUST be Non-confirmable.<a href="#section-2.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-2.2">It MUST include an Observe option, as per <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>.<a href="#section-2.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-2.3">
            <p id="section-2.3-2.3.1">It MUST have the same Token value T of the phantom registration request that started the group observation. This Token value is specified in the 'token' element of 'req_info' under the 'tp_info' parameter, in the informative response message sent to all the observer clients.<a href="#section-2.3-2.3.1" class="pilcrow">¶</a></p>
<p id="section-2.3-2.3.2">
That is, every multicast notification for a target resource is not bound to the observation requests from the different clients, but rather to the phantom registration request associated to the whole set of clients taking part in the group observation of that resource.<a href="#section-2.3-2.3.2" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-2.3-2.4">It MUST be sent from the same IP address SRV_ADDR and port number SRV_PORT where: i) the original Observe registration requests are sent to by the clients; and ii) the corresponding informative responses are sent from by the server (see <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>). These are indicated to the observer clients as value of the 'srv_host' and 'srv_port' elements of 'srv_addr' under the 'tp_info' parameter, in the informative response message (see <a href="#ssssec-udp-transport-specific" class="xref">Section 2.2.1.1</a>). That is, redirection MUST NOT be used.<a href="#section-2.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.3-2.5">It MUST be sent to the IP multicast address GRP_ADDR and port number GRP_PORT. These are indicated to the observer clients as value of the 'cli_addr' and 'cli_port' elements of 'req_info' under the 'tp_info' parameter, in the informative response message (see <a href="#ssssec-udp-transport-specific" class="xref">Section 2.2.1.1</a>).<a href="#section-2.3-2.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.3-3">For each target resource with an active group observation, the server MUST store the latest multicast notification.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-server-side-congestion">
<section id="section-2.4">
        <h3 id="name-congestion-control">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-congestion-control" class="section-name selfRef">Congestion Control</a>
        </h3>
<p id="section-2.4-1">In order to not cause congestion, the server should conservatively control the sending of multicast notifications. In particular:<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2.4-2.1">The multicast notifications MUST be Non-confirmable.<a href="#section-2.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-2.2">In constrained environments such as low-power, lossy networks (LLNs), the server should only support multicast notifications for resources that are small. Following related guidelines from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-04#section-3.6" class="relref">Section 3.6</a> of [<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>, this can consist, for example, in having the payload of multicast notifications as limited to approximately 5% of the IP Maximum Transmit Unit (MTU) size, so that it fits into a single link-layer frame in case IPv6 over Low-Power Wireless Personal Area Networks (6LoWPAN) (see <span><a href="https://rfc-editor.org/rfc/rfc4944#section-4" class="relref">Section 4</a> of [<a href="#RFC4944" class="xref">RFC4944</a>]</span>) is
used.<a href="#section-2.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-2.3">The server SHOULD provide multicast notifications with the smallest possible IP multicast scope that fulfills the application needs. For example, following related guidelines from <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-04#section-3.6" class="relref">Section 3.6</a> of [<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span>, site-local scope is always preferred over global scope IP multicast, if this fulfills the application needs. Similarly, realm-local scope is always preferred over site-local scope, if this fulfills the application needs.<a href="#section-2.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-2.4-2.4">Following related guidelines from <span><a href="https://rfc-editor.org/rfc/rfc7641#section-4.5.1" class="relref">Section 4.5.1</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>, the server SHOULD NOT send more than one multicast notification every 3 seconds, and SHOULD use an even less aggressive rate when possible (see also <span><a href="https://rfc-editor.org/rfc/rfc8085#section-3.1.2" class="relref">Section 3.1.2</a> of [<a href="#RFC8085" class="xref">RFC8085</a>]</span>). The transmission rate of multicast notifications should also take into account the avoidance of a possible "broadcast storm" problem <span>[<a href="#MOBICOM99" class="xref">MOBICOM99</a>]</span>. This prevents a following, considerable increase of the channel load, whose origin would be likely attributed to a router rather than the server.<a href="#section-2.4-2.4" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="ssec-server-side-cancellation">
<section id="section-2.5">
        <h3 id="name-cancellation">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-cancellation" class="section-name selfRef">Cancellation</a>
        </h3>
<p id="section-2.5-1">At any point in time, the server may want to cancel a group observation of a target resource. For instance, the server may realize that no clients or not enough clients are interested in taking part in the group observation anymore. A possible approach that the server can use to assess this is defined in <a href="#sec-rough-counting" class="xref">Section 6</a>.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">In order to cancel the group observation, the server sends a multicast response with response code 5.03 (Service Unavailable), signaling that the group observation has been terminated. The response has the same Token value T of the phantom registration request, it has no payload, and it does not include an Observe option.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
<p id="section-2.5-3">The server sends the response to the same multicast IP address GRP_ADDR and port number GRP_PORT used to send the multicast notifications related to the target resource. Finally, the server releases the resources allocated for the group observation, and especially frees up the Token value T used at its CoAP endpoint.<a href="#section-2.5-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-client-side">
<section id="section-3">
      <h2 id="name-client-side-requirements">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-client-side-requirements" class="section-name selfRef">Client-Side Requirements</a>
      </h2>
<div id="ssec-client-side-request">
<section id="section-3.1">
        <h3 id="name-request-2">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-request-2" class="section-name selfRef">Request</a>
        </h3>
<p id="section-3.1-1">A client sends an observation request to the server as described in <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>, i.e., a GET request with an Observe option set to 0 (register). The request MUST NOT encode link-local addresses. If the server is not configured to accept registrations on that target resource with a group observation, this would still result in a positive notification response to the client as described in <span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span>.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-client-side-informative">
<section id="section-3.2">
        <h3 id="name-informative-response-2">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-informative-response-2" class="section-name selfRef">Informative Response</a>
        </h3>
<p id="section-3.2-1">Upon receiving the informative response defined in <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>, the client proceeds as follows.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2-2">
<li id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">The client configures an observation of the target resource. To this end, it relies on a CoAP endpoint used for messages having:<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.1.2.1">As source address and port number, the server address SRV_ADDR and port number SRV_PORT intended for accessing the target resource. These are specified as value of the 'srv_host' and 'srv_port' elements of 'srv_addr' under the 'tp_info' parameter, in the informative response (see <a href="#ssssec-udp-transport-specific" class="xref">Section 2.2.1.1</a>).<a href="#section-3.2-2.1.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-2.1.2.2">As destination address and port number, the IP multicast address GRP_ADDR and port number GRP_PORT. These are specified as value of the 'cli_addr' and 'cli_port' elements of 'req_info' under the 'tp_info' parameter, in the informative response (see <a href="#ssssec-udp-transport-specific" class="xref">Section 2.2.1.1</a>). If the 'cli_port' element is omitted in 'req_info', the client MUST assume the default port number 5683 as GRP_PORT.<a href="#section-3.2-2.1.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.2-2.2">
            <p id="section-3.2-2.2.1">The client rebuilds the phantom registration request, by using:<a href="#section-3.2-2.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.2.2.1">The transport-independent information, specified in the 'ph_req' parameter of the informative response.<a href="#section-3.2-2.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-2.2.2.2">The Token value T, specified in the 'token' element of 'req_info' under the 'tp_info' parameter of the informative response.<a href="#section-3.2-2.2.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.2-2.3">The client stores the phantom registration request, as associated to the observation of the target resource. In particular, the client MUST use the Token value T of this phantom registration request as its own local Token value associated to that group observation, with respect to the server. The particular way to achieve this is implementation specific.<a href="#section-3.2-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.4">
            <p id="section-3.2-2.4.1">If the informative response includes the parameter 'last_notif', the client rebuilds the latest multicast notification, by using:<a href="#section-3.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2-2.4.2.1">The transport-independent information, specified in the 'last_notif' parameter of the informative response.<a href="#section-3.2-2.4.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-3.2-2.4.2.2">The Token value T, specified in the 'token' element of 'req_info' under the 'tp_info' parameter of the informative response.<a href="#section-3.2-2.4.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
          <li id="section-3.2-2.5">If the informative response includes the parameter 'last_notif', the client processes the multicast notification rebuilt in step 4 as defined in <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>. In particular, the value of the Observe option is used as initial baseline for notification reordering in this group observation.<a href="#section-3.2-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.2-2.6">If a traditional observation to the target resource is ongoing, the client MAY silently cancel it without notifying the server.<a href="#section-3.2-2.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.2-3">If any of the expected fields in the informative response are not present or malformed, the client MAY try sending a new registration request to the server (see <a href="#ssec-client-side-request" class="xref">Section 3.1</a>). Otherwise, the client SHOULD explicitly withdraw from the group observation.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4"><a href="#appendix-different-sources" class="xref">Appendix A</a> describes possible alternative ways for clients to retrieve the phantom registration request and other information related to a group observation.<a href="#section-3.2-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-client-side-notifications">
<section id="section-3.3">
        <h3 id="name-notifications-2">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-notifications-2" class="section-name selfRef">Notifications</a>
        </h3>
<p id="section-3.3-1">After having successfully processed the informative response as defined in <a href="#ssec-client-side-informative" class="xref">Section 3.2</a>, the client will receive, accept and process multicast notifications about the state of the target resource from the server, as responses to the phantom registration request and with Token value T.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">The client relies on the value of the Observe option for notification reordering, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.4" class="relref">Section 3.4</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-client-side-cancellation">
<section id="section-3.4">
        <h3 id="name-cancellation-2">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-cancellation-2" class="section-name selfRef">Cancellation</a>
        </h3>
<p id="section-3.4-1">At a certain point in time, a client may become not interested in receiving further multicast notifications about a target resource. When this happens, the client can simply "forget" about being part of the group observation for that target resource, as per <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.6" class="relref">Section 3.6</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">When, later on, the server sends the next multicast notification, the client will not recognize the Token value T in the message. Since the multicast notification is Non-confirmable, it is OPTIONAL for the client to reject the multicast notification with a Reset message, as defined in <span><a href="https://rfc-editor.org/rfc/rfc7641#section-3.5" class="relref">Section 3.5</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">In case the server has canceled a group observation as defined in <a href="#ssec-server-side-cancellation" class="xref">Section 2.5</a>, the client simply forgets about the group observation and frees up the used Token value T for that endpoint, upon receiving the multicast error response defined in <a href="#ssec-server-side-cancellation" class="xref">Section 2.5</a>.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-web-linking">
<section id="section-4">
      <h2 id="name-web-linking">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-web-linking" class="section-name selfRef">Web Linking</a>
      </h2>
<p id="section-4-1">The possible use of multicast notifications in a group observation may be indicated by a target "grp_obs" attribute in a web link <span>[<a href="#RFC8288" class="xref">RFC8288</a>]</span> to a resource, e.g., using a link-format document <span>[<a href="#RFC6690" class="xref">RFC6690</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The "grp_obs" attribute is a hint, indicating that the server might send multicast notifications for observations of the resource targeted by the link. Note that this is simply a hint, i.e., it does not include any information required to participate in a group observation, and to receive and process multicast notifications.<a href="#section-4-2" class="pilcrow">¶</a></p>
<p id="section-4-3">A value MUST NOT be given for the "grp_obs" attribute; any present value MUST be ignored by parsers.  The "grp_obs" attribute MUST NOT appear more than once in a given link-value; occurrences after the first MUST be ignored by parsers.<a href="#section-4-3" class="pilcrow">¶</a></p>
<p id="section-4-4">The example in <a href="#example-web-link" class="xref">Figure 4</a> shows a use of the "grp_obs" attribute: the client does resource discovery on a server and gets back a list of resources, one of which includes the "grp_obs" attribute indicating that the server might send multicast notifications for observations of that resource. The link-format notation (see <span><a href="https://rfc-editor.org/rfc/rfc6690#section-5" class="relref">Section 5</a> of [<a href="#RFC6690" class="xref">RFC6690</a>]</span>) is used.<a href="#section-4-4" class="pilcrow">¶</a></p>
<span id="name-the-web-link"></span><div id="example-web-link">
<figure id="figure-4">
        <div class="artwork art-text alignLeft" id="section-4-5.1">
<pre>
REQ: GET /.well-known/core

RES: 2.05 Content
    &lt;/sensors/temp&gt;;grp_obs,
    &lt;/sensors/light&gt;;if="sensor"
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-the-web-link" class="selfRef">The Web Link</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-example-no-security">
<section id="section-5">
      <h2 id="name-example">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-example" class="section-name selfRef">Example</a>
      </h2>
<p id="section-5-1">The following example refers to two clients C_1 and C_2 that register to observe a resource /r at a Server S, which has address SRV_ADDR and listens to the port number SRV_PORT. Before the following exchanges occur, no clients are observing the resource /r , which has value "1234".<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The server S sends multicast notifications to the IP multicast address GRP_ADDR and port number GRP_PORT, and starts the group observation upon receiving a registration request from a first client that wishes to start a traditional observation on the resource /r.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The following notation is used for the payload of the informative responses:<a href="#section-5-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5-4.1">'bstr(X)' denotes a CBOR byte string with value the byte serialization of X, with '|' denoting byte concatenation.<a href="#section-5-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.2">'OPT' denotes a sequence of CoAP options. This refers to the phantom registration request encoded by the 'ph_req' parameter, or to the corresponding latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-5-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-5-4.3">'PAYLOAD' denotes a CoAP payload. This refers to the latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-5-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-example-of-group-observatio"></span><div id="example-no-oscore">
<figure id="figure-5">
        <div class="artwork art-text alignLeft" id="section-5-5.1">
<pre>
C_1     ----------------- [ Unicast ] ------------------------&gt; S  /r
 |  GET                                                         |
 |  Token: 0x4a                                                 |
 |  Observe: 0 (Register)                                       |
 |  &lt;Other options&gt;                                             |
 |                                                              |
 |               (S allocates the available Token value 0x7b .) |
 |                                                              |
 |                                                              |
 |                                                              |
 |      (S sends to itself a phantom observation request PH_REQ |
 |       as coming from the IP multicast address GRP_ADDR .)    |
 |         ------------------------------------------------     |
 |       /                                                      |
 |       \----------------------------------------------------&gt; |  /r
 |                                       GET                    |
 |                                       Token: 0x7b            |
 |                                       Observe: 0 (Register)  |
 |                                       &lt;Other options&gt;        |
 |                                                              |
 |                      (S creates a group observation of /r .) |
 |                                                              |
 |                          (S increments the observer counter  |
 |                           for the group observation of /r .) |
 |                                                              |
C_1 &lt;-------------------- [ Unicast ] ---------------------     S
 |  5.03                                                        |
 |  Token: 0x4a                                                 |
 |  Content-Format: application/informative-response+cbor       |
 |  Max-Age: 0                                                  |
 |  &lt;Other options&gt;                                             |
 |  Payload: {                                                  |
 |    tp_info    : [1, bstr(SRV_ADDR), SRV_PORT,                |
 |                  0x7b, bstr(GRP_ADDR), GRP_PORT],            |
 |    ph_req     : bstr(0x01 | OPT),                            |
 |    last_notif : bstr(0x45 | OPT | 0xff | PAYLOAD)            |
 |  }                                                           |
 |                                                              |
 |                                                              |

 |                                                              |
C_2     ----------------- [ Unicast ] ------------------------&gt; S  /r
 |  GET                                                         |
 |  Token: 0x01                                                 |
 |  Observe: 0 (Register)                                       |
 |  &lt;Other options&gt;                                             |
 |                                                              |
 |                          (S increments the observer counter  |
 |                           for the group observation of /r .) |
 |                                                              |
 |                                                              |
C_2 &lt;-------------------- [ Unicast ] ---------------------     S
 |  5.03                                                        |
 |  Token: 0x01                                                 |
 |  Content-Format: application/informative-response+cbor       |
 |  Max-Age: 0                                                  |
 |  &lt;Other options&gt;                                             |
 |  Payload: {                                                  |
 |    tp_info    : [1, bstr(SRV_ADDR), SRV_PORT,                |
 |                  0x7b, bstr(GRP_ADDR), GRP_PORT],            |
 |    ph_req     : bstr(0x01 | OPT),                            |
 |    last_notif : bstr(0x45 | OPT | 0xff | PAYLOAD)            |
 |  }                                                           |
 |                                                              |
 |          (The value of the resource /r changes to "5678".)   |
 |                                                              |
 |                                                              |
C_1                                                             |
 +  &lt;------------------- [ Multicast ] --------------------     S
C_2        (Destination address/port: GRP_ADDR/GRP_PORT)        |
 |  2.05                                                        |
 |  Token: 0x7b                                                 |
 |  Observe: 11                                                 |
 |  Content-Format: application/cbor                            |
 |  &lt;Other options&gt;                                             |
 |  Payload: : "5678"                                           |
 |                                                              |
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-example-of-group-observatio" class="selfRef">Example of group observation</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-rough-counting">
<section id="section-6">
      <h2 id="name-rough-counting-of-clients-i">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-rough-counting-of-clients-i" class="section-name selfRef">Rough Counting of Clients in the Group Observation</a>
      </h2>
<div id="multicast-response-feedback-divider-option">
<section id="section-6.1">
        <h3 id="name-multicast-response-feedback">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-multicast-response-feedback" class="section-name selfRef">Multicast-Response-Feedback-Divider Option</a>
        </h3>
<p id="section-6.1-1">In order to allow the server to keep an estimate of interested clients without creating undue traffic on the network, a new CoAP option is introduced, which SHOULD be supported by clients that listen to multicast responses.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The option is called Multicast-Response-Feedback-Divider. As summarized in <a href="#mrfd-table" class="xref">Figure 6</a>, the option is not Critical, not Safe-to-Forward, and integer valued. Since the option is not Safe-to-Forward, the column "N" indicates a dash for "not applicable".<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<span id="name-multicast-response-feedback-"></span><div id="mrfd-table">
<figure id="figure-6">
          <div class="artwork art-text alignCenter" id="section-6.1-3.1">
<pre>
+-----+---+---+---+---+---------------------+--------+------+---------+
| No. | C | U | N | R | Name                | Format | Len. | Default |
+-----+---+---+---+---+---------------------+--------+------+---------+
| TBD |   | x | - |   | Multicast-Response- | uint   | 0-1  | (none)  |
|     |   |   |   |   | Feedback-Divider    |        |      |         |
+-----+---+---+---+---+---------------------+--------+------+---------+

      C = Critical, U = Unsafe, N = NoCacheKey, R = Repeatable
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-multicast-response-feedback-" class="selfRef">Multicast-Response-Feedback-Divider</a>
          </figcaption></figure>
</div>
<p id="section-6.1-4">The Multicast-Response-Feedback-Divider option is of class E for OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span><span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-on-the-client-side">
<section id="section-6.2">
        <h3 id="name-processing-on-the-client-si">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-processing-on-the-client-si" class="section-name selfRef">Processing on the Client Side</a>
        </h3>
<p id="section-6.2-1">Upon receiving a response with a Multicast-Response-Feedback-Divider option, a client SHOULD acknowledge its interest in continuing receiving multicast notifications for the target resource, as described below.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The client picks an integer random number I, from 0 inclusive to the number Z = (2 ** Q) exclusive, where Q is the value specified in the option and "**" is the exponentiation operator. If I is different than 0, the client takes no further action. Otherwise, the client should wait a random fraction of the Leisure time (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>), and then registers a regular unicast observation on the same target resource.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<p id="section-6.2-3">To this end, the client essentially follows the steps that got it originally subscribed to group notifications for the target resource. In particular, the client sends an observation request to the server, i.e., a GET request with an Observe option set to 0 (register). The request MUST be addressed to the same target resource, and MUST have the same destination IP address and port number used for the original registration request, regardless the source IP address and port number of the received multicast notification.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
<p id="section-6.2-4">Since the observation registration is only done for its side effect of showing as an attempted observation at the server, the client MUST send the unicast request in a non confirmable way, and with the maximum No-Response setting <span>[<a href="#RFC7967" class="xref">RFC7967</a>]</span>. In the request, the client MUST include a Multicast-Response-Feedback-Divider option, whose value MUST be empty (Option Length = 0). The client does not need to wait for responses, and can keep processing further notifications on the same Token.<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<p id="section-6.2-5">The client MUST ignore the Multicast-Response-Feedback-Divider option, if the multicast notification is retrieved from the 'last_notif' parameter of an informative response (see <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>). A client includes the Multicast-Response-Feedback-Divider option only in a re-registration request triggered by the server as described above, and MUST NOT include it in any other request.<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<p id="section-6.2-6">As the Multicast-Response-Feedback-Divider option is unsafe to forward, a proxy needs to answer it on its own, and is later counted as a single client.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7"><a href="#appendix-psuedo-code-counting-client" class="xref">Appendix B.1</a> and <a href="#appendix-psuedo-code-counting-client-constrained" class="xref">Appendix B.2</a> provide a description in pseudo-code of the operations above performed by the client.<a href="#section-6.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-on-the-server-side">
<section id="section-6.3">
        <h3 id="name-processing-on-the-server-si">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-processing-on-the-server-si" class="section-name selfRef">Processing on the Server Side</a>
        </h3>
<p id="section-6.3-1">In order to avoid needless use of network resources, a server SHOULD keep a rough, updated count of the number of clients taking part in the group observation of a target resource. To this end, the server updates the value COUNT of the associated observer counter (see <a href="#sec-server-side" class="xref">Section 2</a>), for instance by using the method described below.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div id="request-for-feedback">
<section id="section-6.3.1">
          <h4 id="name-request-for-feedback">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-request-for-feedback" class="section-name selfRef">Request for Feedback</a>
          </h4>
<p id="section-6.3.1-1">When it wants to obtain a new estimated count, the server considers a number M of confirmations it would like to receive from the clients. It is up to applications to define policies about how the server determines and possibly adjusts the value of M.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2">Then, the server computes the value Q = max(L, 0), where:<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3.1-3.1">L is computed as L = ceil(log2(N / M)).<a href="#section-6.3.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-6.3.1-3.2">N is the current value of the observer counter, possibly rounded up to 1, i.e., N = max(COUNT, 1).<a href="#section-6.3.1-3.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-6.3.1-4">Finally, the server sets Q as the value of the Multicast-Response-Feedback-Divider option, which is sent within a successful multicast notification.<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
<p id="section-6.3.1-5">If several multicast notifications are sent in a burst fashion, it is RECOMMENDED for the server to include the Multicast-Response-Feedback-Divider option only in the first one of those notifications.<a href="#section-6.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="collection-of-feedback">
<section id="section-6.3.2">
          <h4 id="name-collection-of-feedback">
<a href="#section-6.3.2" class="section-number selfRef">6.3.2. </a><a href="#name-collection-of-feedback" class="section-name selfRef">Collection of Feedback</a>
          </h4>
<p id="section-6.3.2-1">The server collects unicast observation requests from the clients, for an amount of time of MAX_CONFIRMATION_WAIT seconds. During this time, the server regularly increments the observer counter when adding a new client to the group observation (see <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>).<a href="#section-6.3.2-1" class="pilcrow">¶</a></p>
<p id="section-6.3.2-2">It is up to applications to define the value of MAX_CONFIRMATION_WAIT, which has to take into account the transmission time of the multicast notification and of unicast observation requests, as well as the leisure time of the clients, which may be hard to know or estimate for the server.<a href="#section-6.3.2-2" class="pilcrow">¶</a></p>
<p id="section-6.3.2-3">If this information is not known to the server, it is recommended to define MAX_CONFIRMATION_WAIT as follows.<a href="#section-6.3.2-3" class="pilcrow">¶</a></p>
<p id="section-6.3.2-4">MAX_CONFIRMATION_WAIT = MAX_RTT + MAX_CLIENT_REQUEST_DELAY<a href="#section-6.3.2-4" class="pilcrow">¶</a></p>
<p id="section-6.3.2-5">where MAX_RTT is as defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.8.2" class="relref">Section 4.8.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> and has default value 202 seconds, while MAX_CLIENT_REQUEST_DELAY is equivalent to MAX_SERVER_RESPONSE_DELAY defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-groupcomm-bis-04#section-3.1.5" class="relref">Section 3.1.5</a> of [<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span> and has default value 250 seconds. In the absence of more specific information, the server can thus consider a conservative MAX_CONFIRMATION_WAIT of 452 seconds.<a href="#section-6.3.2-5" class="pilcrow">¶</a></p>
<p id="section-6.3.2-6">If more information is available in deployments, a much shorter MAX_CONFIRMATION_WAIT can be set. This can be based on a realistic round trip time (replacing MAX_RTT) and on the largest leisure time configured on the clients (replacing MAX_CLIENT_REQUEST_DELAY), e.g., DEFAULT_LEISURE = 5 seconds, thus shortening MAX_CONFIRMATION_WAIT to a few seconds.<a href="#section-6.3.2-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="processing-of-feedback">
<section id="section-6.3.3">
          <h4 id="name-processing-of-feedback">
<a href="#section-6.3.3" class="section-number selfRef">6.3.3. </a><a href="#name-processing-of-feedback" class="section-name selfRef">Processing of Feedback</a>
          </h4>
<p id="section-6.3.3-1">Once MAX_CONFIRMATION_WAIT seconds have passed, the server counts the R confirmations arrived as unicast observation requests to the target resource, since the multicast notification with the Multicast-Response-Feedback-Divider option has been sent. In particular, the server considers a unicast observation request as a confirmation from a client only if it includes a Multicast-Response-Feedback-Divider option with an empty value (Option Length = 0).<a href="#section-6.3.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3.3-2">Then, the server computes a feedback indicator as E = R * (2 ** Q), where "**" is the exponentiation operator. According to what defined by application policies, the server determines the next time when to ask clients for their confirmation, e.g., after a certain number of multicast notifications has been sent. For example, the decision can be influenced by the reception of no confirmations from the clients, i.e., R = 0, or by the value of the ratios (E/N) and (N/E).<a href="#section-6.3.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3.3-3">Finally, the server computes a new estimated count of the observers. To this end, the server first consider COUNT' as the current value of the observer counter at this point in time. Note that COUNT' may be greater than the value COUNT used at the beginning of this process, if the server has incremented the observer counter upon adding new clients to the group observation (see <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>).<a href="#section-6.3.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3.3-4">In particular, the server computes the new estimated count value as COUNT' + ((E - N) / D), where D &gt; 0 is an integer value used as dampener. This step has to be performed atomically. That is, until this step is completed, the server MUST hold the processing of an observation request for the same target resource from a new client. Finally, the server considers the result as the current observer counter, and assesses it for possibly canceling the group observation (see <a href="#ssec-server-side-cancellation" class="xref">Section 2.5</a>).<a href="#section-6.3.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3.3-5">This estimate is skewed by packet loss, but it gives the server a sufficiently good estimation for further counts and for deciding when to cancel the group observation. It is up to applications to define policies about how the server takes the newly updated estimate into account and determines whether to cancel the group observation.<a href="#section-6.3.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3.3-6">As an example, if the server currently estimates that N = COUNT = 32 observers are active and considers a constant M = 8, it sends out a notification with Multicast-Response-Feedback-Divider: 2. Then, out of 18 actually active clients, 5 send a re-registration request based on their random draw, of which one request gets lost, thus leaving 4 re-registration requests received by the server. Also, no new clients have been added to the group observation during this time, i.e., COUNT' is equal to COUNT. As a consequence, assuming that a dampener value D = 1 is used, the server computes the new estimated count value as 32 + (16 - 32) = 16, and keeps the group observation active.<a href="#section-6.3.3-6" class="pilcrow">¶</a></p>
<p id="section-6.3.3-7">To produce a most accurate updated counter, a server can include a Multicast-Response-Feedback-Divider option with value Q = 0 in its multicast notifications, as if M is equal to N. This will trigger all the active clients to state their interest in continuing receiving notifications for the target resource. Thus, the amount R of arrived confirmations is affected only by possible packet loss.<a href="#section-6.3.3-7" class="pilcrow">¶</a></p>
<p id="section-6.3.3-8"><a href="#appendix-psuedo-code-counting-server" class="xref">Appendix B.3</a> provides a description in pseudo-code of the operations above performed by the server, including example behaviors for scheduling the next count update and deciding whether to cancel the group observation.<a href="#section-6.3.3-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-secured-notifications">
<section id="section-7">
      <h2 id="name-protection-of-multicast-not">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-protection-of-multicast-not" class="section-name selfRef">Protection of Multicast Notifications with Group OSCORE</a>
      </h2>
<p id="section-7-1">A server can protect multicast notifications by using Group OSCORE <span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, thus ensuring they are protected end-to-end with the observer clients. This requires that both the server and the clients interested in receiving multicast notifications from that server are members of the same OSCORE group.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">In some settings, the OSCORE group to refer to can be pre-configured on the clients and the server. In such a case, a server which is aware of such pre-configuration can simply assume a client to be already member of the correct OSCORE group.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">In any other case, the server MAY communicate to clients what OSCORE group they are required to join, by providing additional guidance in the informative response as described in <a href="#sec-inf-response" class="xref">Section 7.1</a>. Note that clients can already be members of the right OSCORE group, in case they have previously joined it to securely communicate with the same server and/or with other servers to access their resources.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">Both the clients and the server MAY join the OSCORE group by using the approach described in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> and based on the ACE framework for Authentication and Authorization in constrained environments <span>[<a href="#I-D.ietf-ace-oauth-authz" class="xref">I-D.ietf-ace-oauth-authz</a>]</span>. Further details on how to discover the OSCORE group and join it are out of the scope of this document.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">If multicast notifications are protected using Group OSCORE, the original registration requests and related unicast (notification) responses MUST also be secured, including and especially the informative responses from the server.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">To this end, alternative security protocols than Group OSCORE, such as OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> and/or DTLS <span>[<a href="#RFC6347" class="xref">RFC6347</a>]</span><span>[<a href="#I-D.ietf-tls-dtls13" class="xref">I-D.ietf-tls-dtls13</a>]</span>, can be used to protect other exchanges via unicast between the server and each client, including the original client registration (see <a href="#sec-client-side" class="xref">Section 3</a>).<a href="#section-7-6" class="pilcrow">¶</a></p>
<div id="sec-inf-response">
<section id="section-7.1">
        <h3 id="name-signaling-the-oscore-group-">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-signaling-the-oscore-group-" class="section-name selfRef">Signaling the OSCORE Group in the Informative Response</a>
        </h3>
<p id="section-7.1-1">This section describes a mechanism for the server to communicate to the client what OSCORE group to join in order to decrypt and verify the multicast notifications protected with Group OSCORE. The client MAY use the information provided by the server to start the ACE joining procedure described in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. This mechanism is OPTIONAL to support for the client and server.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">Additionally to what defined in <a href="#sec-server-side" class="xref">Section 2</a>, the CBOR map in the informative response payload contains the following fields, whose CBOR labels are defined in <a href="#informative-response-params" class="xref">Section 11</a>.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.1">'join_uri', with value the URI for joining the OSCORE group at the respective Group Manager, encoded as a CBOR text string. If the procedure described in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> is used for joining, this field specifically indicates the URI of the group-membership resource at the Group Manager.<a href="#section-7.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.2">'sec_gp', with value the name of the OSCORE group, encoded as a CBOR text string.<a href="#section-7.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.3">Optionally, 'as_uri', with value the URI of the Authorization Server associated to the Group Manager for the OSCORE group, encoded as a CBOR text string.<a href="#section-7.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.4">Optionally, 'hkdf', with value the HKDF Algorithm used in the OSCORE group, encoded as a CBOR text string or integer. The value is taken from the 'Value' column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-7.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.5">
            <p id="section-7.1-3.5.1">Optionally, 'pub_key_enc', with value the encoding of the public keys used in the OSCORE group, encoded as a CBOR integer. The value is taken from the 'Label' column of the "COSE Header Parameters" Registry <span>[<a href="#COSE.Header.Parameters" class="xref">COSE.Header.Parameters</a>]</span>. Consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-2.3" class="relref">Section 2.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, acceptable values denote an encoding that MUST explicitly provide the full set of information related to the public key algorithm, including, e.g., the used elliptic curve (when applicable).<a href="#section-7.1-3.5.1" class="pilcrow">¶</a></p>
<p id="section-7.1-3.5.2">
At the time of writing this specification, acceptable public key encodings are CWTs <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span>, unprotected CWT claim sets <span>[<a href="#I-D.ietf-rats-uccs" class="xref">I-D.ietf-rats-uccs</a>]</span>, X.509 certificates <span>[<a href="#RFC7925" class="xref">RFC7925</a>]</span> and C509 certificates <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>. Further encodings may be available in the future, and would be acceptable to use as long as they comply with the criteria defined above.<a href="#section-7.1-3.5.2" class="pilcrow">¶</a></p>
<p id="section-7.1-3.5.3">
[ As to CWTs and unprotected CWT claim sets, there is a pending registration requested by draft-ietf-lake-edhoc. ]<a href="#section-7.1-3.5.3" class="pilcrow">¶</a></p>
<p id="section-7.1-3.5.4">
[ As to C509 certificates, there is a pending registration requested by draft-ietf-cose-cbor-encoded-cert. ]<a href="#section-7.1-3.5.4" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-3.6">Optionally, 'sign_enc_alg', with value the Signature Encryption Algorithm used in the OSCORE group to encrypt messages protected with the group mode, encoded as a CBOR text string or integer. The value is taken from the 'Value' column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-7.1-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.7">Optionally, 'sign_alg', with value the Signature Algorithm used to sign messages in the OSCORE group, encoded as a CBOR text string or integer. The value is taken from the 'Value' column of the "COSE Algorithms" registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-7.1-3.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-7.1-3.8">
            <p id="section-7.1-3.8.1">Optionally, 'sign_params', encoded as a CBOR array and including the following two elements:<a href="#section-7.1-3.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-3.8.2.1">'sign_alg_capab': a CBOR array, with the same format and value of the COSE capabilities array for the algorithm indicated in 'sign_alg', as specified for that algorithm in the 'Capabilities' column of the "COSE Algorithms" Registry <span>[<a href="#COSE.Algorithms" class="xref">COSE.Algorithms</a>]</span>.<a href="#section-7.1-3.8.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.1-3.8.2.2">'sign_key_type_capab': a CBOR array, with the same format and value of the COSE capabilities array for the COSE key type of the keys used with the algorithm indicated in 'sign_alg', as specified for that key type in the 'Capabilities' column of the "COSE Key Types" Registry <span>[<a href="#COSE.Key.Types" class="xref">COSE.Key.Types</a>]</span>.<a href="#section-7.1-3.8.2.2" class="pilcrow">¶</a>
</li>
            </ul>
</li>
        </ul>
<p id="section-7.1-4">The values of 'sign_alg', 'sign_params' and 'pub_key_enc' provide an early knowledge of the format and encoding of public keys used in the OSCORE group. Thus, the client does not need to ask the Group Manager for this information as a preliminary step before the (ACE) join process, or to perform a trial-and-error exchange with the Group Manager upon joining the group. Hence, the client is able to provide the Group Manager with its own public key in the correct expected format and encoding, at the very first step of the (ACE) join process.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
<p id="section-7.1-5">The values of 'hkdf', 'sign_enc_alg' and 'sign_alg' provide an early knowledge of the algorithms used in the OSCORE group. Thus, the client is able to decide whether to actually proceed with the (ACE) join process, depending on its support for the indicated algorithms.<a href="#section-7.1-5" class="pilcrow">¶</a></p>
<p id="section-7.1-6">As mentioned above, since this mechanism is OPTIONAL, all the fields are OPTIONAL in the informative response. However, the 'join_uri' and 'sec_gp' fields MUST be present if the mechanism is implemented and used. If any of the fields are present without the 'join_uri' and 'sec_gp' fields present, the client MUST ignore these fields, since they would not be sufficient to start the (ACE) join procedure. When this happens, the client MAY try sending a new registration request to the server (see <a href="#ssec-client-side-request" class="xref">Section 3.1</a>). Otherwise, the client SHOULD explicitly withdraw from the group observation.<a href="#section-7.1-6" class="pilcrow">¶</a></p>
<p id="section-7.1-7"><a href="#self-managed-oscore-group" class="xref">Appendix C</a> describes a possible alternative approach, where the server self-manages the OSCORE group, and provides the observer clients with the necessary keying material in the informative response. The approach in <a href="#self-managed-oscore-group" class="xref">Appendix C</a> MUST NOT be used together with the mechanism defined in this section for indicating what OSCORE group to join.<a href="#section-7.1-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sec-server-side-with-security">
<section id="section-7.2">
        <h3 id="name-server-side-requirements-2">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-server-side-requirements-2" class="section-name selfRef">Server-Side Requirements</a>
        </h3>
<p id="section-7.2-1">When using Group OSCORE to protect multicast notifications, the server performs the operations described in <a href="#sec-server-side" class="xref">Section 2</a>, with the following differences.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<div id="ssec-server-side-request-oscore">
<section id="section-7.2.1">
          <h4 id="name-registration">
<a href="#section-7.2.1" class="section-number selfRef">7.2.1. </a><a href="#name-registration" class="section-name selfRef">Registration</a>
          </h4>
<p id="section-7.2.1-1">The phantom registration request MUST be secured, by using Group OSCORE. In particular, the group mode of Group OSCORE defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> MUST be used.<a href="#section-7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.2.1-2">The server protects the phantom registration request as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8.1" class="relref">Section 8.1</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, as if it was the actual sender, i.e., by using its Sender Context. As a consequence, the server consumes the current value of its Sender Sequence Number SN in the OSCORE group, and hence updates it to SN* = (SN + 1). Consistently, the OSCORE option in the phantom registration request includes:<a href="#section-7.2.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.1-3.1">As 'kid', the Sender ID of the server in the OSCORE group.<a href="#section-7.2.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.2.1-3.2">As 'piv', the previously consumed Sender Sequence Number value SN of the server in the OSCORE group, i.e., (SN* - 1).<a href="#section-7.2.1-3.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="ssec-server-side-informative-oscore">
<section id="section-7.2.2">
          <h4 id="name-informative-response-3">
<a href="#section-7.2.2" class="section-number selfRef">7.2.2. </a><a href="#name-informative-response-3" class="section-name selfRef">Informative Response</a>
          </h4>
<p id="section-7.2.2-1">The value of the CBOR byte string in the 'ph_req' parameter encodes the phantom observation request as a message protected with Group OSCORE (see <a href="#ssec-server-side-request-oscore" class="xref">Section 7.2.1</a>). As a consequence: the specified Code is always 0.05 (FETCH); the sequence of CoAP options will be limited to the outer, non encrypted options; a payload is always present, as the authenticated ciphertext followed by the signature.<a href="#section-7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2.2-2">Similarly, the value of the CBOR byte string in the 'last_notif' parameter encodes the latest multicast notification as a message protected with Group OSCORE (see <a href="#ssec-server-side-notifications-oscore" class="xref">Section 7.2.3</a>). This applies also to the initial multicast notification INIT_NOTIF built in step 6 of <a href="#ssec-server-side-request" class="xref">Section 2.1</a>.<a href="#section-7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2.2-3">Optionally, the informative response includes information on the OSCORE group to join, as additional parameters (see <a href="#sec-inf-response" class="xref">Section 7.1</a>).<a href="#section-7.2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-server-side-notifications-oscore">
<section id="section-7.2.3">
          <h4 id="name-notifications-3">
<a href="#section-7.2.3" class="section-number selfRef">7.2.3. </a><a href="#name-notifications-3" class="section-name selfRef">Notifications</a>
          </h4>
<p id="section-7.2.3-1">The server MUST protect every multicast notification for the target resource with Group OSCORE. In particular, the group mode of Group OSCORE defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8" class="relref">Section 8</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> MUST be used.<a href="#section-7.2.3-1" class="pilcrow">¶</a></p>
<p id="section-7.2.3-2">The process described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8.3" class="relref">Section 8.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> applies, with the following additions when building the two OSCORE 'external_aad' to encrypt and sign the multicast notification (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-4.3" class="relref">Section 4.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>).<a href="#section-7.2.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.2.3-3.1">The 'request_kid' is the 'kid' value in the OSCORE option of the phantom registration request, i.e., the Sender ID of the server.<a href="#section-7.2.3-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.2.3-3.2">The 'request_piv' is the 'piv' value in the OSCORE option of the phantom registration request, i.e., the consumed Sender Sequence Number SN of the server.<a href="#section-7.2.3-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.2.3-3.3">The 'request_kid_context' is the 'kid context' value in the OSCORE option of the phantom registration request, i.e., the Group Identifier value (Gid) of the OSCORE group used as ID Context.<a href="#section-7.2.3-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.2.3-4">Note that these same values are used to protect each and every multicast notification sent for the target resource under this group observation.<a href="#section-7.2.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ssec-server-side-cancellation-oscore">
<section id="section-7.2.4">
          <h4 id="name-cancellation-3">
<a href="#section-7.2.4" class="section-number selfRef">7.2.4. </a><a href="#name-cancellation-3" class="section-name selfRef">Cancellation</a>
          </h4>
<p id="section-7.2.4-1">When canceling a group observation (see <a href="#ssec-server-side-cancellation" class="xref">Section 2.5</a>), the multicast response with error code 5.03 (Service Unavailable) is also protected with Group OSCORE, as per <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8.3" class="relref">Section 8.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. The server MUST use its own Sender Sequence Number as Partial IV to protect the error response, and include it as Partial IV in the OSCORE option of the response.<a href="#section-7.2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sec-client-side-with-security">
<section id="section-7.3">
        <h3 id="name-client-side-requirements-2">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-client-side-requirements-2" class="section-name selfRef">Client-Side Requirements</a>
        </h3>
<p id="section-7.3-1">When using Group OSCORE to protect multicast notifications, the client performs as described in <a href="#sec-client-side" class="xref">Section 3</a>, with the following differences.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<div id="ssec-client-side-informative-oscore">
<section id="section-7.3.1">
          <h4 id="name-informative-response-4">
<a href="#section-7.3.1" class="section-number selfRef">7.3.1. </a><a href="#name-informative-response-4" class="section-name selfRef">Informative Response</a>
          </h4>
<p id="section-7.3.1-1">Upon receiving the informative response from the server, the client performs as described in <a href="#ssec-client-side-informative" class="xref">Section 3.2</a>, with the following additions.<a href="#section-7.3.1-1" class="pilcrow">¶</a></p>
<p id="section-7.3.1-2">Once completed step 2, the client decrypts and verifies the rebuilt phantom registration request as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8.2" class="relref">Section 8.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, with the following differences.<a href="#section-7.3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.1-3.1">The client MUST NOT perform any replay check. That is, the client skips step 3 in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-7.3.1-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.3.1-3.2">
              <p id="section-7.3.1-3.2.1">If decryption and verification of the phantom registration request succeed:<a href="#section-7.3.1-3.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.1-3.2.2.1">The client MUST NOT update the Replay Window in the Recipient Context associated to the server. That is, the client skips the second bullet of step 6 in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-7.3.1-3.2.2.1" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-7.3.1-3.2.2.2">The client MUST NOT take any further process as normally expected according to <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>. That is, the client skips step 8 in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>. In particular, the client MUST NOT deliver the phantom registration request to the application, and MUST NOT take any action in the Token space of its unicast endpoint, where the informative response has been received.<a href="#section-7.3.1-3.2.2.2" class="pilcrow">¶</a>
</li>
                <li class="normal" id="section-7.3.1-3.2.2.3">The client stores the values of the 'kid', 'piv' and 'kid context' fields from the OSCORE option of the phantom registration request.<a href="#section-7.3.1-3.2.2.3" class="pilcrow">¶</a>
</li>
              </ul>
</li>
            <li class="normal" id="section-7.3.1-3.3">If decryption and verification of the phantom registration request fail, the client MAY try sending a new registration request to the server (see <a href="#ssec-client-side-request" class="xref">Section 3.1</a>). Otherwise, the client SHOULD explicitly withdraw from the group observation.<a href="#section-7.3.1-3.3" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.3.1-3.4">If the informative response includes the parameter 'last_notif', the client also decrypts and verifies the latest multicast notification rebuilt in step 4, just like it would for the multicast notifications transmitted as CoAP messages on the wire (see <a href="#ssec-client-side-notifications-oscore" class="xref">Section 7.3.2</a>). The client proceeds with step 5 if decryption and verification of the latest multicast notification succeed, or to step 6 otherwise.<a href="#section-7.3.1-3.4" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="ssec-client-side-notifications-oscore">
<section id="section-7.3.2">
          <h4 id="name-notifications-4">
<a href="#section-7.3.2" class="section-number selfRef">7.3.2. </a><a href="#name-notifications-4" class="section-name selfRef">Notifications</a>
          </h4>
<p id="section-7.3.2-1">After having successfully processed the informative response as defined in <a href="#ssec-client-side-informative-oscore" class="xref">Section 7.3.1</a>, the client will decrypt and verify every multicast notification for the target resource as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-8.4" class="relref">Section 8.4</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>, with the following difference.<a href="#section-7.3.2-1" class="pilcrow">¶</a></p>
<p id="section-7.3.2-2">For both decryption and signature verification, the client MUST set the 'external_aad' defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-4.3" class="relref">Section 4.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> as follows. The particular way to achieve this is implementation specific.<a href="#section-7.3.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.3.2-3.1">'request_kid' takes the value of the 'kid' field from the OSCORE option of the phantom registration request (see <a href="#ssec-client-side-informative-oscore" class="xref">Section 7.3.1</a>).<a href="#section-7.3.2-3.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.3.2-3.2">'request_piv' takes the value of the 'piv' field from the OSCORE option of the phantom registration request (see <a href="#ssec-client-side-informative-oscore" class="xref">Section 7.3.1</a>).<a href="#section-7.3.2-3.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.3.2-3.3">'request_kid_context' takes the value of the 'kid context' field from the OSCORE option of the phantom registration request (see <a href="#ssec-client-side-informative-oscore" class="xref">Section 7.3.1</a>).<a href="#section-7.3.2-3.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-7.3.2-4">Note that these same values are used to decrypt and verify each and every multicast notification received for the target resource.<a href="#section-7.3.2-4" class="pilcrow">¶</a></p>
<p id="section-7.3.2-5">The replay protection and checking of multicast notifications is performed as specified in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1.3.5.2" class="relref">Section 4.1.3.5.2</a> of [<a href="#RFC8613" class="xref">RFC8613</a>]</span>.<a href="#section-7.3.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sec-example-with-security">
<section id="section-8">
      <h2 id="name-example-with-group-oscore">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-example-with-group-oscore" class="section-name selfRef">Example with Group OSCORE</a>
      </h2>
<p id="section-8-1">The following example refers to two clients C_1 and C_2 that register to observe a resource /r at a Server S, which has address SRV_ADDR and listens to the port number SRV_PORT. Before the following exchanges occur, no clients are observing the resource /r , which has value "1234".<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">The server S sends multicast notifications to the IP multicast address GRP_ADDR and port number GRP_PORT, and starts the group observation upon receiving a registration request from a first client that wishes to start a traditional observation on the resource /r.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Pairwise communication over unicast is protected with OSCORE, while S protects multicast notifications with Group OSCORE. Specifically:<a href="#section-8-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-4.1">C_1 and S have a pairwise OSCORE Security Context. In particular, C_1 has 'kid' = 1 as Sender ID, and SN_1 = 101 as Sender Sequence Number. Also, S has 'kid' = 3 as Sender ID, and SN_3 = 301 as Sender Sequence Number.<a href="#section-8-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-4.2">C_2 and S have a pairwise OSCORE Security Context. In particular, C_2 has 'kid' = 2 as Sender ID, and SN_2 = 201 as Sender Sequence Number. Also, S has 'kid' = 4 as Sender ID, and SN_4 = 401 as Sender Sequence Number.<a href="#section-8-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-4.3">S is a member of the OSCORE group with name "myGroup", and 'kid context' = 0x57ab2e as Group ID. In the OSCORE group, S has 'kid' = 5 as Sender ID, and SN_5 = 501 as Sender Sequence Number.<a href="#section-8-4.3" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-8-5">The following notation is used for the payload of the informative responses:<a href="#section-8-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8-6.1">'bstr(X)' denotes a CBOR byte string with value the byte serialization of X, with '|' denoting byte concatenation.<a href="#section-8-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-6.2">'OPT' denotes a sequence of CoAP options. This refers to the phantom registration request encoded by the 'ph_req' parameter, or to the corresponding latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-8-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-6.3">'PAYLOAD' denotes an encrypted CoAP payload. This refers to the phantom registration request encoded by the 'ph_req' parameter, or to the corresponding latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-8-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-8-6.4">'SIGN' denotes the signature appended to an encrypted CoAP payload. This refers to the phantom registration request encoded by the 'ph_req' parameter, or to the corresponding latest multicast notification encoded by the 'last_notif' parameter.<a href="#section-8-6.4" class="pilcrow">¶</a>
</li>
      </ul>
<span id="name-example-of-group-observation"></span><div id="example-oscore">
<figure id="figure-7">
        <div class="artwork art-text alignLeft" id="section-8-7.1">
<pre>
C_1     ------------ [ Unicast w/ OSCORE ]  ------------------&gt; S  /r
 |  0.05 (FETCH)                                                |
 |  Token: 0x4a                                                 |
 |  OSCORE: {kid: 1; piv: 101; ...}                             |
 |  &lt;Other class U/I options&gt;                                   |
 |  0xff                                                        |
 |  Encrypted_payload {                                         |
 |    0x01 (GET),                                               |
 |    Observe: 0 (Register),                                    |
 |    &lt;Other class E options&gt;                                   |
 |  }                                                           |
 |                                                              |
 |              (S allocates the available Token value 0x7b .)  |
 |                                                              |
 |                                                              |
 |      (S sends to itself a phantom observation request PH_REQ |
 |       as coming from the IP multicast address GRP_ADDR .)    |
 |     ------------------------------------------------------   |
 |    /                                                         |
 |    \-------------------------------------------------------&gt; |  /r
 |                           0.05 (FETCH)                       |
 |                           Token: 0x7b                        |
 |                           OSCORE: {kid: 5 ; piv: 501;        |
 |                                    kid context: 57ab2e; ...} |
 |                           &lt;Other class U/I options&gt;          |
 |                           0xff                               |
 |                           Encrypted_payload {                |
 |                             0x01 (GET),                      |
 |                             Observe: 0 (Register),           |
 |                             &lt;Other class E options&gt;          |
 |                           }                                  |
 |                           &lt;Signature&gt;                        |
 |                                                              |
 |                                                              |
 |   (S steps SN_5 in the Group OSCORE Sec. Ctx : SN_5 &lt;== 502) |
 |                                                              |
 |                     (S creates a group observation of /r .)  |
 |                                                              |
 |                          (S increments the observer counter  |
 |                           for the group observation of /r .) |
 |                                                              |
 |                                                              |

 |                                                              |
C_1 &lt;--------------- [ Unicast w/ OSCORE ] ----------------     S
 |  2.05 (Content)                                              |
 |  Token: 0x4a                                                 |
 |  OSCORE: {piv: 301; ...}                                     |
 |  Max-Age: 0                                                  |
 |  &lt;Other class U/I options&gt;                                   |
 |  0xff                                                        |
 |  Encrypted_payload {                                         |
 |    5.03 (Service Unavailable),                               |
 |    Content-Format: application/informative-response+cbor,    |
 |    &lt;Other class E options&gt;,                                  |
 |    0xff,                                                     |
 |    CBOR_payload {                                            |
 |      tp_info    : [1, bstr(SRV_ADDR), SRV_PORT,              |
 |                    0x7b, bstr(GRP_ADDR), GRP_PORT],          |
 |      ph_req     : bstr(0x05 | OPT | 0xff | PAYLOAD | SIGN),  |
 |      last_notif : bstr(0x45 | OPT | 0xff | PAYLOAD | SIGN),  |
 |      join_uri   : "coap://myGM/ace-group/myGroup",           |
 |      sec_gp     : "myGroup"                                  |
 |    }                                                         |
 |  }                                                           |
 |                                                              |
C_2     ------------ [ Unicast w/ OSCORE ]  ------------------&gt; S  /r
 |  0.05 (FETCH)                                                |
 |  Token: 0x01                                                 |
 |  OSCORE: {kid: 2; piv: 201; ...}                             |
 |  &lt;Other class U/I options&gt;                                   |
 |  0xff                                                        |
 |  Encrypted_payload {                                         |
 |    0x01 (GET),                                               |
 |    Observe: 0 (Register),                                    |
 |    &lt;Other class E options&gt;                                   |
 |  }                                                           |
 |                                                              |
 |                          (S increments the observer counter  |
 |                           for the group observation of /r .) |
 |                                                              |
C_2 &lt;--------------- [ Unicast w/ OSCORE ] ----------------     S
 |  2.05 (Content)                                              |
 |  Token: 0x01                                                 |
 |  OSCORE: {piv: 401; ...}                                     |
 |  Max-Age: 0                                                  |
 |  &lt;Other class U/I options&gt;                                   |
 |  0xff,                                                       |
 |  Encrypted_payload {                                         |
 |    5.03 (Service Unavailable),                               |
 |    Content-Format: application/informative-response+cbor,    |
 |    &lt;Other class E options&gt;,                                  |
 |    0xff,                                                     |
 |    CBOR_payload {                                            |
 |      tp_info    : [1, bstr(SRV_ADDR), SRV_PORT,              |
 |                    0x7b, bstr(GRP_ADDR), GRP_PORT],          |
 |      ph_req     : bstr(0x05 | OPT | 0xff | PAYLOAD | SIGN),  |
 |      last_notif : bstr(0x45 | OPT | 0xff | PAYLOAD | SIGN),  |
 |      join_uri   : "coap://myGM/ace-group/myGroup",           |
 |      sec_gp     : "myGroup"                                  |
 |    }                                                         |
 |  }                                                           |
 |                                                              |
 |            (The value of the resource /r changes to "5678".) |
 |                                                              |
C_1                                                             |
 +  &lt;----------- [ Multicast w/ Group OSCORE ] ------------     S
C_2       (Destination address/port: GRP_ADDR/GRP_PORT)         |
 |  2.05 (Content)                                              |
 |  Token: 0x7b                                                 |
 |  OSCORE: {kid: 5; piv: 502;                                  |
 |           kid context: 57ab2e; ...}                          |
 |  &lt;Other class U/I options&gt;                                   |
 |  0xff                                                        |
 |  Encrypted_payload {                                         |
 |    2.05 (Content),                                           |
 |    Observe: [empty],                                         |
 |    Content-Format: application/cbor,                         |
 |    &lt;Other class E options&gt;,                                  |
 |    0xff,                                                     |
 |    CBOR_Payload : "5678"                                     |
 |  }                                                           |
 |  &lt;Signature&gt;                                                 |
 |                                                              |
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-example-of-group-observation" class="selfRef">Example of group observation with Group OSCORE</a>
        </figcaption></figure>
</div>
<p id="section-8-8">The two external_aad used to encrypt and sign the multicast notification above have 'request_kid' = 5, 'request_piv' = 501 and 'request_kid_context' = 0x57ab2e. These values are specified in the 'kid', 'piv' and 'kid context' field of the OSCORE option of the phantom observation request, which is encoded in the 'ph_req' parameter of the unicast informative response to the two clients. Thus, the two clients can build the two same external_aad for decrypting and verifying this multicast notification and the following ones.<a href="#section-8-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries">
<section id="section-9">
      <h2 id="name-intermediaries">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-intermediaries" class="section-name selfRef">Intermediaries</a>
      </h2>
<p id="section-9-1">This section specifies how the approach presented in <a href="#sec-server-side" class="xref">Section 2</a> and <a href="#sec-client-side" class="xref">Section 3</a> works when a proxy is used between the clients and the server. In addition to what specified in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-5.7" class="relref">Section 5.7</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span> and <span><a href="https://rfc-editor.org/rfc/rfc7641#section-5" class="relref">Section 5</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>, the following applies.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">A client sends its original observation request to the proxy. If the proxy is not already registered at the server for that target resource, the proxy forwards the observation request to the server, hence registering itself as an observer. If the server has an ongoing group observation for the target resource or decides to start one, the server considers the proxy as taking part in the group observation, and replies to the proxy with an informative response.<a href="#section-9-2" class="pilcrow">¶</a></p>
<p id="section-9-3">Upon receiving an informative response, the proxy performs as specified for the client in <a href="#sec-client-side" class="xref">Section 3</a>, with the peculiarity that "consuming" the last notification (if present) means populating its cache.<a href="#section-9-3" class="pilcrow">¶</a></p>
<p id="section-9-4">In particular, by using the information retrieved from the informative response, the proxy configures an observation of the target resource at the origin server, acting as a client directly taking part in the group observation.<a href="#section-9-4" class="pilcrow">¶</a></p>
<p id="section-9-5">As a consequence, the proxy will listen to the IP multicast address and port number indicated by the server in the informative response, as 'cli_addr' and 'cli_port' element of 'req_info' under the 'tp_info' parameter, respectively (see <a href="#ssssec-udp-transport-specific" class="xref">Section 2.2.1.1</a>). Furthermore, multicast notifications will match the phantom request stored at the proxy, based on the Token value specified in the 'token' element of 'req_info' under the 'tp_info' parameter in the informative response.<a href="#section-9-5" class="pilcrow">¶</a></p>
<p id="section-9-6">Then, the proxy performs the following actions.<a href="#section-9-6" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-9-7.1">If the 'last_notif' field is not present, the proxy responds to the client with an Empty Acknowledgement (if indicated by the message type, and if it has not already done so).<a href="#section-9-7.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-9-7.2">If the 'last_notif' field is present, the proxy rebuilds the latest multicast notification, as defined in <a href="#sec-client-side" class="xref">Section 3</a>. Then, the proxy responds to the client, by forwarding back the latest multicast notification.<a href="#section-9-7.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-9-8">When responding to an observation request from a client, the proxy also adds that client (and its Token) to the list of its registered observers for the target resource, next to the older observations.<a href="#section-9-8" class="pilcrow">¶</a></p>
<p id="section-9-9">Upon receiving a multicast notification from the server, the proxy forwards it back separately to each observer client over unicast. Note that the notification forwarded back to a certain client has the same Token value of the original observation request sent by that client to the proxy.<a href="#section-9-9" class="pilcrow">¶</a></p>
<p id="section-9-10">Note that the proxy configures the observation of the target resource at the server only once, when receiving the informative response associated to a (newly started) group observation for that target resource.<a href="#section-9-10" class="pilcrow">¶</a></p>
<p id="section-9-11">After that, when receiving an observation request from a following new client to be added to the same group observation, the proxy does not take any further action with the server. Instead, the proxy responds to the client either with the latest multicast notification if available from its cache, or with an Empty Acknowledgement otherwise, as defined above.<a href="#section-9-11" class="pilcrow">¶</a></p>
<p id="section-9-12">An example is provided in <a href="#intermediaries-example" class="xref">Appendix E</a>.<a href="#section-9-12" class="pilcrow">¶</a></p>
<p id="section-9-13">In the general case with a chain of two or more proxies, every proxy in the chain takes the role of client with the (next hop towards the) origin server. Note that the proxy adjacent to the origin server is the only one in the chain that receives informative responses and listens to an IP multicast address to receive notifications for the group observation. Furthermore, every proxy in the chain takes the role of server with the (previous hop towards the) origin client.<a href="#section-9-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries-e2e-security">
<section id="section-10">
      <h2 id="name-intermediaries-together-wit">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-intermediaries-together-wit" class="section-name selfRef">Intermediaries Together with End-to-End Security</a>
      </h2>
<p id="section-10-1">As defined in <a href="#sec-secured-notifications" class="xref">Section 7</a>, Group OSCORE can be used to protect multicast notifications end-to-end between the origin server and the clients. In such a case, additional actions are required when also the informative responses from the origin server are protected specifically end-to-end, by using OSCORE or Group OSCORE.<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">In fact, the proxy adjacent to the origin server is not able to access the encrypted payload of such informative responses. Hence, the proxy cannot retrieve the 'ph_req' and 'tp_info' parameters necessary to correctly receive multicast notifications and forward them back to the clients.<a href="#section-10-2" class="pilcrow">¶</a></p>
<p id="section-10-3">Then, differently from what defined in <a href="#intermediaries" class="xref">Section 9</a>, each proxy receiving an informative response simply forwards it back to the client that has sent the corresponding observation request. Note that the proxy does not even realize the message to be an actual informative response, since the outer Code field is set to 2.05 (Content).<a href="#section-10-3" class="pilcrow">¶</a></p>
<p id="section-10-4">Upon receiving the informative response, the client does not configure an observation of the target resource. Instead, the client performs a new observe registration request, by transmitting the re-built phantom request as intended to reach the proxy adjacent to the origin server. In particular, the client includes the new Listen-To-Multicast-Responses CoAP option defined in <a href="#ltmr-option" class="xref">Section 10.1</a>, to provide that proxy with the transport-specific information required for receiving multicast notifications for the group observation.<a href="#section-10-4" class="pilcrow">¶</a></p>
<p id="section-10-5">Details on the additional message exchange and processing are defined in <a href="#intermediaries-e2e-security-processing" class="xref">Section 10.2</a>.<a href="#section-10-5" class="pilcrow">¶</a></p>
<div id="ltmr-option">
<section id="section-10.1">
        <h3 id="name-listen-to-multicast-respons">
<a href="#section-10.1" class="section-number selfRef">10.1. </a><a href="#name-listen-to-multicast-respons" class="section-name selfRef">Listen-To-Multicast-Responses Option</a>
        </h3>
<p id="section-10.1-1">In order to allow the proxy to listen to the multicast notifications sent by the server, a new CoAP option is introduced. This option MUST be supported by clients interested to take part in group observations through intermediaries, and by proxies that collect multicast notifications and forward them back to the observer clients.<a href="#section-10.1-1" class="pilcrow">¶</a></p>
<p id="section-10.1-2">The option is called Listen-To-Multicast-Responses and is intended only for requests. As summarized in <a href="#ltmr-table" class="xref">Figure 8</a>, the option is critical and not Safe-to-Forward. Since the option is not Safe-to-Forward, the column "N" indicates a dash for "not applicable".<a href="#section-10.1-2" class="pilcrow">¶</a></p>
<span id="name-listen-to-multicast-response"></span><div id="ltmr-table">
<figure id="figure-8">
          <div class="artwork art-text alignCenter" id="section-10.1-3.1">
<pre>
+-----+---+---+---+---+-------------------+--------+--------+---------+
| No. | C | U | N | R | Name              | Format | Len.   | Default |
+-----+---+---+---+---+-------------------+--------+--------+---------+
| TBD | x | x | - |   | Listen-To-        |  (*)   | 3-1024 | (none)  |
|     |   |   |   |   | Multicast-        |        |        |         |
|     |   |   |   |   | Responses         |        |        |         |
+-----+---+---+---+---+-------------------+--------+--------+---------+

      C = Critical, U = Unsafe, N = NoCacheKey, R = Repeatable
      (*) See below.
</pre>
</div>
<figcaption><a href="#figure-8" class="selfRef">Figure 8</a>:
<a href="#name-listen-to-multicast-response" class="selfRef">Listen-To-Multicast-Responses</a>
          </figcaption></figure>
</div>
<p id="section-10.1-4">The Listen-To-Multicast-Responses option includes the serialization of a CBOR array. This specifies transport-specific message information required for listening to the multicast notifications of a group observation, and intended to the proxy adjacent to the origin server sending those notifications. In particular, the serialized CBOR array has the same format specified in <a href="#sssec-transport-specific-encoding" class="xref">Section 2.2.1</a> for the 'tp_info' parameter of the informative response (see <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>).<a href="#section-10.1-4" class="pilcrow">¶</a></p>
<p id="section-10.1-5">The Listen-To-Multicast-Responses option is of class U for OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span><span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-10.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries-e2e-security-processing">
<section id="section-10.2">
        <h3 id="name-message-processing">
<a href="#section-10.2" class="section-number selfRef">10.2. </a><a href="#name-message-processing" class="section-name selfRef">Message Processing</a>
        </h3>
<p id="section-10.2-1">Compared to <a href="#intermediaries" class="xref">Section 9</a>, the following additions apply when informative responses are protected end-to-end between the origin server and the clients.<a href="#section-10.2-1" class="pilcrow">¶</a></p>
<p id="section-10.2-2">After the origin server sends an informative response, each proxy simply forwards it back to the (previous hop towards the) origin client that has sent the observation request.<a href="#section-10.2-2" class="pilcrow">¶</a></p>
<p id="section-10.2-3">Once received the informative response, the origin client proceeds in a different way than in <a href="#ssec-client-side-informative-oscore" class="xref">Section 7.3.1</a>:<a href="#section-10.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-4.1">The client performs all the additional decryption and verification steps of <a href="#ssec-client-side-informative-oscore" class="xref">Section 7.3.1</a> on the phantom request specified in the 'ph_req' parameter and on the last notification specified in the 'last_notif' parameter (if present).<a href="#section-10.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-4.2">
            <p id="section-10.2-4.2.1">The client builds a ticket request (see Appendix B of <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="xref">I-D.amsuess-core-cachable-oscore</a>]</span>), as intended to reach the proxy adjacent to the origin server. The ticket request is formatted as follows.<a href="#section-10.2-4.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-4.2.2.1">The Token is chosen as the client sees fit. In fact, there is no reason for this Token to be the same as the phantom request's.<a href="#section-10.2-4.2.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-4.2.2.2">The outer Code field, the outer CoAP options and the encrypted payload with AEAD tag (protecting the inner Code, the inner CoAP options and the possible plain CoAP payload) concatenated with the signature are the same of the phantom request used for the group observation. That is, they are as specified in the 'ph_req' parameter of the received informative response.<a href="#section-10.2-4.2.2.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-4.2.2.3">An outer Observe option is included and set to 0 (Register). This will usually be set in the phantom request already.<a href="#section-10.2-4.2.2.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-4.2.2.4">The outer options Proxy-Scheme, Uri-Host and Uri-Port are included, and set to the same values they had in the original registration request sent by the client.<a href="#section-10.2-4.2.2.4" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-10.2-4.2.2.5">
                <p id="section-10.2-4.2.2.5.1">The new option Listen-To-Multicast-Responses is included as an outer option. The value is set to the serialization of the CBOR array specified by the 'tp_info' parameter of the informative response.<a href="#section-10.2-4.2.2.5.1" class="pilcrow">¶</a></p>
<p id="section-10.2-4.2.2.5.2">
Note that, except for transport-specific information such as the Token and Message ID values, every different client participating to the same group observation (hence rebuilding the same phantom request) will build the same ticket request.<a href="#section-10.2-4.2.2.5.2" class="pilcrow">¶</a></p>
<p id="section-10.2-4.2.2.5.3">
Note also that, identically to the phantom request, the ticket request is still protected with Group OSCORE, i.e., it has the same OSCORE option, encrypted payload and signature.<a href="#section-10.2-4.2.2.5.3" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
        </ul>
<p id="section-10.2-5">Then, the client sends the ticket request to the next hop towards the origin server. Every proxy in the chain forwards the ticket request to the next hop towards the origin server, until the last proxy in the chain is reached. This last proxy, adjacent to the origin server, proceeds as follows.<a href="#section-10.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-10.2-6.1">The proxy MUST NOT further forward the ticket request to the origin server.<a href="#section-10.2-6.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-6.2">The proxy removes the Proxy-Scheme, Uri-Host and Uri-Port options from the ticket request.<a href="#section-10.2-6.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-6.3">The proxy removes the Listen-To-Multicast-Responses option from the ticket request, and extracts the conveyed transport-specific information.<a href="#section-10.2-6.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-6.4">The proxy rebuilds the phantom request associated to the group observation, by using the ticket request as directly providing the required transport-independent information. This includes the outer Code field, the outer CoAP options and the encrypted payload with AEAD tag concatenated with the signature.<a href="#section-10.2-6.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-10.2-6.5">The proxy configures an observation of the target resource at the origin server, acting as a client directly taking part in the group observation. To this end, the proxy uses the rebuilt phantom request and the transport-specific information retrieved from the Listen-To-Multicast-Responses Option. The particular way to achieve this is implementation specific.<a href="#section-10.2-6.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-10.2-7">After that, the proxy will listen to the IP multicast address and port number indicated in the Listen-To-Multicast-Responses option, as 'cli_addr' and 'cli_port' element of the serialized CBOR array, respectively. Furthermore, multicast notifications will match the phantom request stored at the proxy, based on the Token value specified in the 'token' element of the serialized CBOR array in the Listen-To-Multicast-Responses option.<a href="#section-10.2-7" class="pilcrow">¶</a></p>
<p id="section-10.2-8">An example is provided in <a href="#intermediaries-example-e2e-security" class="xref">Appendix F</a>.<a href="#section-10.2-8" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="informative-response-params">
<section id="section-11">
      <h2 id="name-informative-response-parame">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-informative-response-parame" class="section-name selfRef">Informative Response Parameters</a>
      </h2>
<p id="section-11-1">This document defines a number of fields used in the informative response message defined in <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>.<a href="#section-11-1" class="pilcrow">¶</a></p>
<p id="section-11-2">The table below summarizes them and specifies the CBOR key to use instead of the full descriptive name. Note that the media type application/informative-response+cbor MUST be used when these fields are transported.<a href="#section-11-2" class="pilcrow">¶</a></p>
<table class="center" id="table-1">
        <caption><a href="#table-1" class="selfRef">Table 1</a></caption>
<thead>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Name</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Key</th>
            <th class="text-left" rowspan="1" colspan="1">CBOR Type</th>
            <th class="text-left" rowspan="1" colspan="1">Reference</th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">tp_info</td>
            <td class="text-left" rowspan="1" colspan="1">0</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">ph_req</td>
            <td class="text-left" rowspan="1" colspan="1">1</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">last_notif</td>
            <td class="text-left" rowspan="1" colspan="1">2</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">join_uri</td>
            <td class="text-left" rowspan="1" colspan="1">3</td>
            <td class="text-left" rowspan="1" colspan="1">text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="xref">Section 7.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sec_gp</td>
            <td class="text-left" rowspan="1" colspan="1">4</td>
            <td class="text-left" rowspan="1" colspan="1">text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="xref">Section 7.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">as_uri</td>
            <td class="text-left" rowspan="1" colspan="1">5</td>
            <td class="text-left" rowspan="1" colspan="1">text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="xref">Section 7.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">hkdf</td>
            <td class="text-left" rowspan="1" colspan="1">6</td>
            <td class="text-left" rowspan="1" colspan="1">int / text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="xref">Section 7.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">pub_key_enc</td>
            <td class="text-left" rowspan="1" colspan="1">7</td>
            <td class="text-left" rowspan="1" colspan="1">int</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="xref">Section 7.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sign_enc_alg</td>
            <td class="text-left" rowspan="1" colspan="1">8</td>
            <td class="text-left" rowspan="1" colspan="1">int / text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="xref">Section 7.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sign_alg</td>
            <td class="text-left" rowspan="1" colspan="1">9</td>
            <td class="text-left" rowspan="1" colspan="1">int / text string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="xref">Section 7.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">sign_params</td>
            <td class="text-left" rowspan="1" colspan="1">10</td>
            <td class="text-left" rowspan="1" colspan="1">array</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#sec-inf-response" class="xref">Section 7.1</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">gp_material</td>
            <td class="text-left" rowspan="1" colspan="1">11</td>
            <td class="text-left" rowspan="1" colspan="1">map</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#self-managed-oscore-group" class="xref">Appendix C</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">srv_pub_key</td>
            <td class="text-left" rowspan="1" colspan="1">12</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#self-managed-oscore-group" class="xref">Appendix C</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">srv_identifier</td>
            <td class="text-left" rowspan="1" colspan="1">13</td>
            <td class="text-left" rowspan="1" colspan="1">byte string</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#self-managed-oscore-group" class="xref">Appendix C</a>
</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">exp</td>
            <td class="text-left" rowspan="1" colspan="1">14</td>
            <td class="text-left" rowspan="1" colspan="1">uint</td>
            <td class="text-left" rowspan="1" colspan="1">
              <a href="#self-managed-oscore-group" class="xref">Appendix C</a>
</td>
          </tr>
        </tbody>
      </table>
</section>
</div>
<div id="transport-protocol-identifiers">
<section id="section-12">
      <h2 id="name-transport-protocol-informat">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-transport-protocol-informat" class="section-name selfRef">Transport Protocol Information</a>
      </h2>
<p id="section-12-1">This document defines some values of transport protocol identifiers to use within the 'tp_info' parameter of the informative response message defined in <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">According to the encoding specified in <a href="#sssec-transport-specific-encoding" class="xref">Section 2.2.1</a>, these values are used for the 'tp_id' element of 'srv_addr', under the 'tp_info' parameter.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">The table below summarizes them, specifies the integer value to use instead of the full descriptive name, and provides the corresponding full set of information elements to include in the 'tp_info' parameter.<a href="#section-12-3" class="pilcrow">¶</a></p>
<span id="name-transport-protocol-informati"></span><div id="values_tp_id">
<figure id="figure-9">
        <div class="artwork art-text alignLeft" id="section-12-4.1">
<pre>
+-----------+-------------+-------+----------+-----------+-----------+
| Transport | Description | Value | Srv Addr | Req Info  | Reference |
| Protocol  |             |       |          |           |           |
+-----------+-------------+-------+----------+-----------+-----------+
| Reserved  | This value  | 0     |          |           | [This     |
|           | is reserved |       |          |           | document] |
|           |             |       |          |           |           |
| UDP       | UDP is used | 1     | tp_id    |  token    | [This     |
|           | as per      |       | srv_host |  cli_host | document] |
|           | RFC7252     |       | srv_port | ?cli_port |           |
+-----------+-------------+-------+----------+-----------+-----------+
</pre>
</div>
<figcaption><a href="#figure-9" class="selfRef">Figure 9</a>:
<a href="#name-transport-protocol-informati" class="selfRef">Transport protocol information</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="sec-security-considerations">
<section id="section-13">
      <h2 id="name-security-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-13-1">The same security considerations from <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span><span>[<a href="#RFC7641" class="xref">RFC7641</a>]</span><span>[<a href="#I-D.ietf-core-groupcomm-bis" class="xref">I-D.ietf-core-groupcomm-bis</a>]</span><span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span><span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span> hold for this document.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">If multicast notifications are protected using Group OSCORE as per <a href="#sec-secured-notifications" class="xref">Section 7</a>, the following applies.<a href="#section-13-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-13-3.1">The original registration requests and related unicast (notification) responses MUST also be secured, including and especially the informative responses from the server. This prevents on-path active adversaries from altering the conveyed IP multicast address and serialized phantom registration request. Thus, it ensures secure binding between every multicast notification for a same observed resource and the phantom registration request that started the group observation of that resource.<a href="#section-13-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-13-3.2">A re-registration request, possibly including the Multicast-Response-Feedback-Divider option to support the rough counting of clients (see <a href="#sec-rough-counting" class="xref">Section 6</a>), MUST also be secured.<a href="#section-13-3.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-13-4">To this end, clients and servers SHOULD use OSCORE or Group OSCORE, so ensuring that the secure binding above is enforced end-to-end between the server and each observing client.<a href="#section-13-4" class="pilcrow">¶</a></p>
<div id="sec-security-considerations-ltmr">
<section id="section-13.1">
        <h3 id="name-listen-to-multicast-responses">
<a href="#section-13.1" class="section-number selfRef">13.1. </a><a href="#name-listen-to-multicast-responses" class="section-name selfRef">Listen-To-Multicast-Responses Option</a>
        </h3>
<p id="section-13.1-1">The CoAP option Listen-To-Multicast-Responses defined in <a href="#ltmr-option" class="xref">Section 10.1</a> is of class U for OSCORE and Group OSCORE <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span><span>[<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#section-13.1-1" class="pilcrow">¶</a></p>
<p id="section-13.1-2">This allows the proxy adjacent to the origin server to access the option value conveyed in a ticket request (see <a href="#intermediaries-e2e-security-processing" class="xref">Section 10.2</a>), and to retrieve from it the transport-specific information about a phantom request. By doing so, the proxy becomes able to configure an observation of the target resource and to receive multicast notifications matching to the phantom request.<a href="#section-13.1-2" class="pilcrow">¶</a></p>
<p id="section-13.1-3">Any proxy in the chain, as well as further possible intermediaries or on-path active adversaries, are thus able to remove the option or alter its content, before the ticket request reaches the proxy adjacent to the origin server.<a href="#section-13.1-3" class="pilcrow">¶</a></p>
<p id="section-13.1-4">Removing the option would result in the proxy adjacent to the origin server to not configure the group observation, if that has not happened yet. In such a case, the proxy would not receive the corresponding multicast notifications to be forwarded back to the clients.<a href="#section-13.1-4" class="pilcrow">¶</a></p>
<p id="section-13.1-5">Altering the option content would result in the proxy adjacent to the origin server to incorrectly configure a group observation (e.g., by indicating a wrong multicast IP address) hence preventing the correct reception of multicast notifications and their forwarding to the clients; or to configure bogus group observations that are currently not active on the origin server.<a href="#section-13.1-5" class="pilcrow">¶</a></p>
<p id="section-13.1-6">In order to prevent what described above, the ticket requests conveying the Listen-To-Multicast-Responses option can be additionally protected hop-by-hop.<a href="#section-13.1-6" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="iana">
<section id="section-14">
      <h2 id="name-iana-considerations">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-14-1">This document has the following actions for IANA.<a href="#section-14-1" class="pilcrow">¶</a></p>
<div id="media-type">
<section id="section-14.1">
        <h3 id="name-media-type-registrations">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-media-type-registrations" class="section-name selfRef">Media Type Registrations</a>
        </h3>
<p id="section-14.1-1">This document registers the media type 'application/informative-response+cbor' for error messages as informative response defined in <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>, when carrying parameters encoded in CBOR. This registration follows the procedures specified in <span>[<a href="#RFC6838" class="xref">RFC6838</a>]</span>.<a href="#section-14.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.1-2.1">Type name: application<a href="#section-14.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.2">Subtype name: informative-response+cbor<a href="#section-14.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.3">Required parameters: N/A<a href="#section-14.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.4">Optional parameters: N/A<a href="#section-14.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.5">Encoding considerations: Must be encoded as a CBOR map containing the parameters defined in <a href="#ssec-server-side-informative" class="xref">Section 2.2</a> of [this document].<a href="#section-14.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.6">Security considerations: See <a href="#sec-security-considerations" class="xref">Section 13</a> of [this document].<a href="#section-14.1-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.7">Interoperability considerations: N/A<a href="#section-14.1-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.8">Published specification: [this document]<a href="#section-14.1-2.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.9">Applications that use this media type: The type is used by CoAP servers and clients that support error messages as informative response defined in <a href="#ssec-server-side-informative" class="xref">Section 2.2</a> of [this document].<a href="#section-14.1-2.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.10">Fragment identifier considerations: N/A<a href="#section-14.1-2.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.11">Additional information: N/A<a href="#section-14.1-2.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.12">Person &amp; email address to contact for further information: <a href="mailto:iesg@ietf.org">iesg@ietf.org</a><a href="#section-14.1-2.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.13">Intended usage: COMMON<a href="#section-14.1-2.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.14">Restrictions on usage: None<a href="#section-14.1-2.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.15">Author: Marco Tiloca <a href="mailto:marco.tiloca@ri.se">marco.tiloca@ri.se</a><a href="#section-14.1-2.15" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.16">Change controller: IESG<a href="#section-14.1-2.16" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.1-2.17">Provisional registration?  No<a href="#section-14.1-2.17" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
<div id="content-format">
<section id="section-14.2">
        <h3 id="name-coap-content-formats-regist">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-coap-content-formats-regist" class="section-name selfRef">CoAP Content-Formats Registry</a>
        </h3>
<p id="section-14.2-1">IANA is asked to add the following entry to the "CoAP Content-Formats" sub-registry defined in <span><a href="https://rfc-editor.org/rfc/rfc7252#section-12.3" class="relref">Section 12.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>, within the "Constrained RESTful Environments (CoRE) Parameters" registry.<a href="#section-14.2-1" class="pilcrow">¶</a></p>
<p id="section-14.2-2">Media Type: application/informative-response+cbor<a href="#section-14.2-2" class="pilcrow">¶</a></p>
<p id="section-14.2-3">Encoding: -<a href="#section-14.2-3" class="pilcrow">¶</a></p>
<p id="section-14.2-4">ID: TBD<a href="#section-14.2-4" class="pilcrow">¶</a></p>
<p id="section-14.2-5">Reference: [this document]<a href="#section-14.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-informative-response-params">
<section id="section-14.3">
        <h3 id="name-informative-response-paramet">
<a href="#section-14.3" class="section-number selfRef">14.3. </a><a href="#name-informative-response-paramet" class="section-name selfRef">Informative Response Parameters Registry</a>
        </h3>
<p id="section-14.3-1">This document establishes the "Informative Response Parameters" IANA registry. The registry has been created to use the "Expert Review Required" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#iana-review" class="xref">Section 14.6</a>.<a href="#section-14.3-1" class="pilcrow">¶</a></p>
<p id="section-14.3-2">The columns of this registry are:<a href="#section-14.3-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.3-3.1">Name: This is a descriptive name that enables easier reference to the item. The name MUST be unique. It is not used in the encoding.<a href="#section-14.3-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.3-3.2">CBOR Key: This is the value used as CBOR key of the item. These values MUST be unique. The value can be a positive integer, a negative integer, or a string.<a href="#section-14.3-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.3-3.3">CBOR Type: This contains the CBOR type of the item, or a pointer to the registry that defines its type, when that depends on another item.<a href="#section-14.3-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.3-3.4">Reference: This contains a pointer to the public specification for the item.<a href="#section-14.3-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-14.3-4">This registry has been initially populated by the values in <a href="#informative-response-params" class="xref">Section 11</a>. The "Reference" column for all of these entries refers to sections of this document.<a href="#section-14.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-transport-protocol-identifiers">
<section id="section-14.4">
        <h3 id="name-coap-transport-information-">
<a href="#section-14.4" class="section-number selfRef">14.4. </a><a href="#name-coap-transport-information-" class="section-name selfRef">CoAP Transport Information Registry</a>
        </h3>
<p id="section-14.4-1">This document defines the subregistry "CoAP Transport Information" within the "CoRE Parameters" registry. The registry has been created to use the "Expert Review Required" registration procedure <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Expert review guidelines are provided in <a href="#iana-review" class="xref">Section 14.6</a>. It should be noted that, in addition to the expert review, some portions of the Registry require a specification, potentially a Standards Track RFC, to be supplied as well.<a href="#section-14.4-1" class="pilcrow">¶</a></p>
<p id="section-14.4-2">The columns of this registry are:<a href="#section-14.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.4-3.1">Transport Protocol: This is a descriptive name that enables easier reference to the item. The name MUST be unique. It is not used in the encoding.<a href="#section-14.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.4-3.2">Description: Text giving an overview of the transport protocol referred by this item.<a href="#section-14.4-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.4-3.3">Value: CBOR abbreviation for the transport protocol referred by this item. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>. Integer values from -256 to 255 are designated as Standards Action. Integer values from -65536 to -257 and from 256 to 65535 are designated as Specification Required. Integer values greater than 65535 are designated as Expert Review. Integer values less than -65536 are marked as Private Use.<a href="#section-14.4-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.4-3.4">Server Addr: List of elements providing addressing information of the server.<a href="#section-14.4-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.4-3.5">Req Info: List of elements providing transport-specific information related to a pertinent CoAP request. Optional elements are prepended by '?'.<a href="#section-14.4-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.4-3.6">Reference: This contains a pointer to the public specification for the item.<a href="#section-14.4-3.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-14.4-4">This registry has been initially populated by the values in <a href="#transport-protocol-identifiers" class="xref">Section 12</a>. The "Reference" column for all of these entries refers to sections of this document.<a href="#section-14.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-coap-options">
<section id="section-14.5">
        <h3 id="name-coap-option-numbers-registr">
<a href="#section-14.5" class="section-number selfRef">14.5. </a><a href="#name-coap-option-numbers-registr" class="section-name selfRef">CoAP Option Numbers Registry</a>
        </h3>
<p id="section-14.5-1">IANA is asked to enter the following option numbers to the "CoAP Option Numbers" registry defined in <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span> within the "CoRE Parameters" registry.<a href="#section-14.5-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignCenter" id="section-14.5-2">
<pre>
+--------+--------------------------------------+-----------------+
| Number |                 Name                 |    Reference    |
+--------+--------------------------------------+-----------------+
|  TBD   |  Multicast-Response-Feedback-Divider | [This document] |
+--------+--------------------------------------+-----------------+
|  TBD   |  Listen-To-Multicast-Responses       | [This document] |
+--------+--------------------------------------+-----------------+
</pre><a href="#section-14.5-2" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="iana-review">
<section id="section-14.6">
        <h3 id="name-expert-review-instructions">
<a href="#section-14.6" class="section-number selfRef">14.6. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-14.6-1">The IANA registries established in this document are defined as expert review.
This section gives some general guidelines for what the experts should be looking for, but they are being designated as experts for a reason so they should be given substantial latitude.<a href="#section-14.6-1" class="pilcrow">¶</a></p>
<p id="section-14.6-2">Expert reviewers should take into consideration the following points:<a href="#section-14.6-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-14.6-3.1">Point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments. The zones tagged as private use are intended for testing purposes and closed environments, code points in other ranges should not be assigned for testing.<a href="#section-14.6-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.6-3.2">Specifications are required for the standards track range of point assignment. Specifications should exist for specification required ranges, but early assignment before a specification is available is considered to be permissible. Specifications are needed for the first-come, first-serve range if they are expected to be used outside of closed environments in an interoperable way. When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-14.6-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-14.6-3.3">Experts should take into account the expected usage of fields when approving point assignment. The fact that there is a range for standards track documents does not mean that a standards track document cannot have points assigned outside of that range. The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a href="#section-14.6-3.3" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-15">
      <h2 id="name-references">
<a href="#section-15" class="section-number selfRef">15. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-15.1">
        <h3 id="name-normative-references">
<a href="#section-15.1" class="section-number selfRef">15.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Algorithms">[COSE.Algorithms]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Algorithms"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#algorithms">https://www.iana.org/assignments/cose/cose.xhtml#algorithms</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="COSE.Key.Types">[COSE.Key.Types]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Key Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#key-type">https://www.iana.org/assignments/cose/cose.xhtml#key-type</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-key-groupcomm-oscore">[I-D.ietf-ace-key-groupcomm-oscore]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Park, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Key Management for OSCORE Groups in ACE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-key-groupcomm-oscore-11</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-oscore-11.txt">https://www.ietf.org/archive/id/draft-ietf-ace-key-groupcomm-oscore-11.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oscore-profile">[I-D.ietf-ace-oscore-profile]</dt>
        <dd>
<span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, and <span class="refAuthor">M. Gunnarsson</span>, <span class="refTitle">"OSCORE Profile of the Authentication and Authorization for Constrained Environments Framework"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oscore-profile-19</span>, <time datetime="2021-05-06" class="refDate">6 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oscore-profile-19.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oscore-profile-19.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-groupcomm-bis">[I-D.ietf-core-groupcomm-bis]</dt>
        <dd>
<span class="refAuthor">Dijk, E.</span>, <span class="refAuthor">Wang, C.</span>, and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Group Communication for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-groupcomm-bis-04</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-04.txt">https://www.ietf.org/archive/id/draft-ietf-core-groupcomm-bis-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-oscore-groupcomm">[I-D.ietf-core-oscore-groupcomm]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Palombini, F.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">J. Park</span>, <span class="refTitle">"Group OSCORE - Secure Group Communication for CoAP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-oscore-groupcomm-12</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-12.txt">https://www.ietf.org/archive/id/draft-ietf-core-oscore-groupcomm-12.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4944">[RFC4944]</dt>
        <dd>
<span class="refAuthor">Montenegro, G.</span>, <span class="refAuthor">Kushalnagar, N.</span>, <span class="refAuthor">Hui, J.</span>, and <span class="refAuthor">D. Culler</span>, <span class="refTitle">"Transmission of IPv6 Packets over IEEE 802.15.4 Networks"</span>, <span class="seriesInfo">RFC 4944</span>, <span class="seriesInfo">DOI 10.17487/RFC4944</span>, <time datetime="2007-09" class="refDate">September 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4944">https://www.rfc-editor.org/info/rfc4944</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7641">[RFC7641]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"Observing Resources in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7641</span>, <span class="seriesInfo">DOI 10.17487/RFC7641</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7641">https://www.rfc-editor.org/info/rfc7641</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7967">[RFC7967]</dt>
        <dd>
<span class="refAuthor">Bhattacharyya, A.</span>, <span class="refAuthor">Bandyopadhyay, S.</span>, <span class="refAuthor">Pal, A.</span>, and <span class="refAuthor">T. Bose</span>, <span class="refTitle">"Constrained Application Protocol (CoAP) Option for No Server Response"</span>, <span class="seriesInfo">RFC 7967</span>, <span class="seriesInfo">DOI 10.17487/RFC7967</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7967">https://www.rfc-editor.org/info/rfc7967</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8085">[RFC8085]</dt>
        <dd>
<span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Fairhurst, G.</span>, and <span class="refAuthor">G. Shepherd</span>, <span class="refTitle">"UDP Usage Guidelines"</span>, <span class="seriesInfo">BCP 145</span>, <span class="seriesInfo">RFC 8085</span>, <span class="seriesInfo">DOI 10.17487/RFC8085</span>, <time datetime="2017-03" class="refDate">March 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8085">https://www.rfc-editor.org/info/rfc8085</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8288">[RFC8288]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Web Linking"</span>, <span class="seriesInfo">RFC 8288</span>, <span class="seriesInfo">DOI 10.17487/RFC8288</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8288">https://www.rfc-editor.org/info/rfc8288</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-15.2">
        <h3 id="name-informative-references">
<a href="#section-15.2" class="section-number selfRef">15.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.amsuess-core-cachable-oscore">[I-D.amsuess-core-cachable-oscore]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span> and <span class="refAuthor">M. Tiloca</span>, <span class="refTitle">"Cacheable OSCORE"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-amsuess-core-cachable-oscore-01</span>, <time datetime="2021-02-22" class="refDate">22 February 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-amsuess-core-cachable-oscore-01.txt">https://www.ietf.org/archive/id/draft-amsuess-core-cachable-oscore-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-ace-oauth-authz">[I-D.ietf-ace-oauth-authz]</dt>
        <dd>
<span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Authentication and Authorization for Constrained Environments (ACE) using the OAuth 2.0 Framework (ACE-OAuth)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-ace-oauth-authz-43</span>, <time datetime="2021-07-10" class="refDate">10 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-43.txt">https://www.ietf.org/archive/id/draft-ietf-ace-oauth-authz-43.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coap-pubsub">[I-D.ietf-core-coap-pubsub]</dt>
        <dd>
<span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Keranen, A.</span>, and <span class="refAuthor">J. Jimenez</span>, <span class="refTitle">"Publish-Subscribe Broker for the Constrained Application Protocol (CoAP)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coap-pubsub-09</span>, <time datetime="2019-09-30" class="refDate">30 September 2019</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-coap-pubsub-09.txt">https://www.ietf.org/archive/id/draft-ietf-core-coap-pubsub-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-coral">[I-D.ietf-core-coral]</dt>
        <dd>
<span class="refAuthor">Hartke, K.</span>, <span class="refTitle">"The Constrained RESTful Application Language (CoRAL)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-coral-03</span>, <time datetime="2020-03-09" class="refDate">9 March 2020</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-coral-03.txt">https://www.ietf.org/archive/id/draft-ietf-core-coral-03.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-resource-directory">[I-D.ietf-core-resource-directory]</dt>
        <dd>
<span class="refAuthor">Amsüss, C.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. V. D. Stok</span>, <span class="refTitle">"CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-resource-directory-28</span>, <time datetime="2021-03-07" class="refDate">7 March 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-core-resource-directory-28.txt">https://www.ietf.org/archive/id/draft-ietf-core-resource-directory-28.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J. P.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-01</span>, <time datetime="2021-05-25" class="refDate">25 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-01.txt">https://www.ietf.org/archive/id/draft-ietf-cose-cbor-encoded-cert-01.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-rats-uccs">[I-D.ietf-rats-uccs]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">O'Donoghue, J.</span>, <span class="refAuthor">Cam-Winget, N.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"A CBOR Tag for Unprotected CWT Claims Sets"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-rats-uccs-00</span>, <time datetime="2021-05-19" class="refDate">19 May 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-rats-uccs-00.txt">https://www.ietf.org/archive/id/draft-ietf-rats-uccs-00.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-tls-dtls13">[I-D.ietf-tls-dtls13]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Tschofenig, H.</span>, and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"The Datagram Transport Layer Security (DTLS) Protocol Version 1.3"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-tls-dtls13-43</span>, <time datetime="2021-04-30" class="refDate">30 April 2021</time>, <span>&lt;<a href="https://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-43.txt">https://www.ietf.org/internet-drafts/draft-ietf-tls-dtls13-43.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.tiloca-core-oscore-discovery">[I-D.tiloca-core-oscore-discovery]</dt>
        <dd>
<span class="refAuthor">Tiloca, M.</span>, <span class="refAuthor">Amsuess, C.</span>, and <span class="refAuthor">P. V. D. Stok</span>, <span class="refTitle">"Discovery of OSCORE Groups with the CoRE Resource Directory"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-tiloca-core-oscore-discovery-09</span>, <time datetime="2021-07-12" class="refDate">12 July 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-09.txt">https://www.ietf.org/archive/id/draft-tiloca-core-oscore-discovery-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MOBICOM99">[MOBICOM99]</dt>
        <dd>
<span class="refAuthor">Ni, S.-Y.</span>, <span class="refAuthor">Tseng, Y.-C.</span>, <span class="refAuthor">Chen, Y.-S.</span>, and <span class="refAuthor">J.-P. Sheu</span>, <span class="refTitle">"The Broadcast Storm Problem in a Mobile Ad Hoc Network"</span>, <span class="seriesInfo">Proceedings of the 5th annual ACM/IEEE international conference on Mobile computing and networking </span>, <time datetime="1999-08" class="refDate">August 1999</time>, <span>&lt;<a href="https://people.eecs.berkeley.edu/~culler/cs294-f03/papers/bcast-storm.pdf">https://people.eecs.berkeley.edu/~culler/cs294-f03/papers/bcast-storm.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6347">[RFC6347]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span> and <span class="refAuthor">N. Modadugu</span>, <span class="refTitle">"Datagram Transport Layer Security Version 1.2"</span>, <span class="seriesInfo">RFC 6347</span>, <span class="seriesInfo">DOI 10.17487/RFC6347</span>, <time datetime="2012-01" class="refDate">January 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6347">https://www.rfc-editor.org/info/rfc6347</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6690">https://www.rfc-editor.org/info/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7519">[RFC7519]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Bradley, J.</span>, and <span class="refAuthor">N. Sakimura</span>, <span class="refTitle">"JSON Web Token (JWT)"</span>, <span class="seriesInfo">RFC 7519</span>, <span class="seriesInfo">DOI 10.17487/RFC7519</span>, <time datetime="2015-05" class="refDate">May 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7519">https://www.rfc-editor.org/info/rfc7519</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7925">[RFC7925]</dt>
        <dd>
<span class="refAuthor">Tschofenig, H., Ed.</span> and <span class="refAuthor">T. Fossati</span>, <span class="refTitle">"Transport Layer Security (TLS) / Datagram Transport Layer Security (DTLS) Profiles for the Internet of Things"</span>, <span class="seriesInfo">RFC 7925</span>, <span class="seriesInfo">DOI 10.17487/RFC7925</span>, <time datetime="2016-07" class="refDate">July 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7925">https://www.rfc-editor.org/info/rfc7925</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
      <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="appendix-different-sources">
<section id="appendix-A">
      <h2 id="name-different-sources-for-group">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-different-sources-for-group" class="section-name selfRef">Different Sources for Group Observation Data</a>
      </h2>
<p id="appendix-A-1">While the clients usually receive the phantom registration request and other information related to the group observation through an Informative Response, the same data can be made available through different services, such as the following ones.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="topic-discovery-in-publish-subscribe-settings">
<section id="appendix-A.1">
        <h3 id="name-topic-discovery-in-publish-">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-topic-discovery-in-publish-" class="section-name selfRef">Topic Discovery in Publish-Subscribe Settings</a>
        </h3>
<p id="appendix-A.1-1">In a Publish-Subscribe scenario <span>[<a href="#I-D.ietf-core-coap-pubsub" class="xref">I-D.ietf-core-coap-pubsub</a>]</span>, a group observation can be discovered along with topic metadata. For instance, a discovery step can make the following metadata available.<a href="#appendix-A.1-1" class="pilcrow">¶</a></p>
<p id="appendix-A.1-2">This example assumes a CoRAL namespace <span>[<a href="#I-D.ietf-core-coral" class="xref">I-D.ietf-core-coral</a>]</span>, that contains properties analogous to those in the content-format application/informative-response+cbor.<a href="#appendix-A.1-2" class="pilcrow">¶</a></p>
<span id="name-group-observation-discovery"></span><div id="discovery-pub-sub">
<figure id="figure-10">
          <div class="artwork art-text alignLeft" id="appendix-A.1-3.1">
<pre>
Request:

    GET &lt;/ps/topics?rt=oic.r.temperature&gt;
    Accept: CoRAL

Response:

    2.05 Content
    Content-Format: CoRAL

    rdf:type &lt;http://example.org/pubsub/topic-list&gt;
    topic &lt;/ps/topics/1234&gt; {
        tp_info [1, h"7b", h"20010db80100..0001", 5683,
                 h"ff35003020010db8..1234", 5683],
        ph_req h"0160..",
        last_notif h"256105.."
    }
</pre>
</div>
<figcaption><a href="#figure-10" class="selfRef">Figure 10</a>:
<a href="#name-group-observation-discovery" class="selfRef">Group observation discovery in a Pub-Sub scenario</a>
          </figcaption></figure>
</div>
<p id="appendix-A.1-4">With this information from the topic discovery step, the client can already set up its multicast address and start receiving multicast notifications.<a href="#appendix-A.1-4" class="pilcrow">¶</a></p>
<p id="appendix-A.1-5">In heavily asymmetric networks like municipal notification services, discovery and notifications do not necessarily need to use the same network link. For example, a departure monitor could use its (costly and usually-off) cellular uplink to discover the topics it needs to update its display to, and then listen on a LoRA-WAN interface for receiving the actual multicast notifications.<a href="#appendix-A.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="introspection-at-the-multicast-notification-sender">
<section id="appendix-A.2">
        <h3 id="name-introspection-at-the-multic">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-introspection-at-the-multic" class="section-name selfRef">Introspection at the Multicast Notification Sender</a>
        </h3>
<p id="appendix-A.2-1">For network debugging purposes, it can be useful to query a server that sends multicast responses as matching a phantom registration request.<a href="#appendix-A.2-1" class="pilcrow">¶</a></p>
<p id="appendix-A.2-2">Such an interface is left for other documents to specify on demand. As an example, a possible interface can be as follows, and rely on the already known Token value of intercepted multicast notifications, associated to a phantom registration request.<a href="#appendix-A.2-2" class="pilcrow">¶</a></p>
<span id="name-group-observation-discovery-"></span><div id="discovery-introspection">
<figure id="figure-11">
          <div class="artwork art-text alignLeft" id="appendix-A.2-3.1">
<pre>
Request:

    GET &lt;/.well-known/core/mc-sender?token=6464&gt;

Response:

    2.05 Content
    Content-Format: application/informative-response+cbor

    {
        'tp_info': [1, h"7b", h"20010db80100..0001", 5683,
                    h"ff35003020010db8..1234", 5683],
        'ph_req': h"0160..",
        'last_notif' : h"256105.."
    }
</pre>
</div>
<figcaption><a href="#figure-11" class="selfRef">Figure 11</a>:
<a href="#name-group-observation-discovery-" class="selfRef">Group observation discovery with server introspection</a>
          </figcaption></figure>
</div>
<p id="appendix-A.2-4">For example, a network sniffer could offer sending such a request when unknown multicast notifications are seen in a network. Consequently, it can associate those notifications with a URI, or decrypt them, if member of the correct OSCORE group.<a href="#appendix-A.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="appendix-psuedo-code-counting">
<section id="appendix-B">
      <h2 id="name-pseudo-code-for-rough-count">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-pseudo-code-for-rough-count" class="section-name selfRef">Pseudo-Code for Rough Counting of Clients</a>
      </h2>
<p id="appendix-B-1">This appendix provides a description in pseudo-code of the two algorithms used for the rough counting of active observers, as defined in <a href="#sec-rough-counting" class="xref">Section 6</a>.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">In particular, <a href="#appendix-psuedo-code-counting-client" class="xref">Appendix B.1</a> describes the algorithm for the client side, while <a href="#appendix-psuedo-code-counting-client-constrained" class="xref">Appendix B.2</a> describes an optimized version for constrained clients. Finally, <a href="#appendix-psuedo-code-counting-server" class="xref">Appendix B.3</a> describes the algorithm for the server side.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
<div id="appendix-psuedo-code-counting-client">
<section id="appendix-B.1">
        <h3 id="name-client-side">
<a href="#appendix-B.1" class="section-number selfRef">B.1. </a><a href="#name-client-side" class="section-name selfRef">Client Side</a>
        </h3>
<div class="artwork art-text alignLeft" id="appendix-B.1-1">
<pre>
input:  int Q, // Value of the MRFD option
        int LEISURE_TIME, // DEFAULT_LEISURE from RFC 7252,
                          // unless overridden

output: None


int RAND_MIN = 0;
int RAND_MAX = (2**Q) - 1;
int I = randomInteger(RAND_MIN, RAND_MAX);

if (I == 0) {
    float fraction = randomFloat(0, 1);

    Timer t = new Timer();
    t.setAndStart(fraction * LEISURE_TIME);
    while(!t.isExpired());

    Request req = new Request();
    // Initialize as NON and with maximum
    // No-Response settings, set options ...

    Option opt = new Option(OBSERVE);
    opt.set(0);
    req.setOption(opt);

    opt = new Option(MRFD);
    req.setOption(opt);

    req.send(SRV_ADDR, SRV_PORT);
}
</pre><a href="#appendix-B.1-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="appendix-psuedo-code-counting-client-constrained">
<section id="appendix-B.2">
        <h3 id="name-client-side-optimized-versi">
<a href="#appendix-B.2" class="section-number selfRef">B.2. </a><a href="#name-client-side-optimized-versi" class="section-name selfRef">Client Side - Optimized Version</a>
        </h3>
<div class="artwork art-text alignLeft" id="appendix-B.2-1">
<pre>
input:  int Q, // Value of the MRFD option
        int LEISURE_TIME, // DEFAULT_LEISURE from RFC 7252,
                          // unless overridden

output: None


const unsigned int UINT_BIT = CHAR_BIT * sizeof(unsigned int);

if (respond_to(Q) == true) {
    float fraction = randomFloat(0, 1);

    Timer t = new Timer();
    t.setAndStart(fraction * LEISURE_TIME);
    while(!t.isExpired());

    Request req = new Request();
    // Initialize as NON and with maximum
    // No-Response settings, set options ...

    Option opt = new Option(OBSERVE);
    opt.set(0);
    req.setOption(opt);

    opt = new Option(MRFD);
    req.setOption(opt);

    req.send(SRV_ADDR, SRV_PORT);
}

bool respond_to(int Q) {
    while (Q &gt;= UINT_BIT) {
        if (rand() != 0) return false;
        Q -= UINT_BIT;
    }
    unsigned int mask = ~((~0u) &lt;&lt; Q);
    unsigned int masked = mask &amp; rand();
    return masked == 0;
}
</pre><a href="#appendix-B.2-1" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="appendix-psuedo-code-counting-server">
<section id="appendix-B.3">
        <h3 id="name-server-side">
<a href="#appendix-B.3" class="section-number selfRef">B.3. </a><a href="#name-server-side" class="section-name selfRef">Server Side</a>
        </h3>
<div class="artwork art-text alignLeft" id="appendix-B.3-1">
<pre>
input:  int COUNT, // Current observer counter
        int M, // Desired number of confirmations
        int MAX_CONFIRMATION_WAIT,
        Response notification, // Multicast notification to send

output: int NEW_COUNT // Updated observer counter


int D = 4; // Dampener value
int RETRY_NEXT_THRESHOLD = 4;
float CANCEL_THRESHOLD = 0.2;

int N = max(COUNT, 1);
int Q = max(ceil(log2(N / M)), 0);
Option opt = new Option(MRFD);
opt.set(Q);

notification.setOption(opt);
&lt;Finalize the notification message&gt;
notification.send(GRP_ADDR, GRP_PORT);

Timer t = new Timer();
t.setAndStart(MAX_CONFIRMATION_WAIT); // Time t1
while(!t.isExpired());

// Time t2

int R = &lt;number of requests to the target resource
         between t1 and t2, with the MRFD option&gt;;

int E = R * (2**Q);

// Determine after how many multicast notifications
// the next count update will be performed
if ((R == 0) || (max(E/N, N/E) &gt; RETRY_NEXT_THRESHOLD)) {
    &lt;Next count update with the next multicast notification&gt;
}
else {
    &lt;Next count update after 10 multicast notifications&gt;
}

// Compute the new count estimate
int COUNT_PRIME = &lt;current value of the observer counter&gt;;
int NEW_COUNT = COUNT_PRIME + ((E - N) / D);

// Determine whether to cancel the group observation
if (NEW_COUNT &lt; CANCEL_THRESHOLD) {
    &lt;Cancel the group observation&gt;;
    return 0;
}

return NEW_COUNT;
</pre><a href="#appendix-B.3-1" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="self-managed-oscore-group">
<section id="appendix-C">
      <h2 id="name-oscore-group-self-managed-b">
<a href="#appendix-C" class="section-number selfRef">Appendix C. </a><a href="#name-oscore-group-self-managed-b" class="section-name selfRef">OSCORE Group Self-Managed by the Server</a>
      </h2>
<p id="appendix-C-1">For simple settings, where no pre-arranged group with suitable memberships is available, the server can be responsible to setup and manage the OSCORE group used to protect the group observation.<a href="#appendix-C-1" class="pilcrow">¶</a></p>
<p id="appendix-C-2">In such a case, a client would implicitly request to join the OSCORE group when sending the observe registration request to the server. When replying, the server includes the group keying material and related information in the informative response (see <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>).<a href="#appendix-C-2" class="pilcrow">¶</a></p>
<p id="appendix-C-3">Additionally to what defined in <a href="#sec-server-side" class="xref">Section 2</a>, the CBOR map in the informative response payload contains the following fields, whose CBOR labels are defined in <a href="#informative-response-params" class="xref">Section 11</a>.<a href="#appendix-C-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1">
          <p id="appendix-C-4.1.1">'gp_material': this element is a CBOR map, which includes what the client needs in order to set up the Group OSCORE Security Context.<a href="#appendix-C-4.1.1" class="pilcrow">¶</a></p>
<p id="appendix-C-4.1.2">
This parameter has as value a subset of the Group_OSCORE_Input_Material object, which is defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-11#section-6.4" class="relref">Section 6.4</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span> and extends the OSCORE_Input_Material object encoded in CBOR as defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-oscore-profile-19#section-3.2.1" class="relref">Section 3.2.1</a> of [<a href="#I-D.ietf-ace-oscore-profile" class="xref">I-D.ietf-ace-oscore-profile</a>]</span>.<a href="#appendix-C-4.1.2" class="pilcrow">¶</a></p>
<p id="appendix-C-4.1.3">
In particular, the following elements of the Group_OSCORE_Input_Material object are included, using the same CBOR labels from the OSCORE Security Context Parameters Registry, as in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-11#section-6.4" class="relref">Section 6.4</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>.<a href="#appendix-C-4.1.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-4.1.4.1">'ms', 'contexId', 'pub_key_enc', 'sign_enc_alg', 'sign_alg' and 'sign_params'. These elements MUST be included.<a href="#appendix-C-4.1.4.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-C-4.1.4.2">'hkdf' and 'salt'. These elements MAY be included.<a href="#appendix-C-4.1.4.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="appendix-C-4.1.5">
The 'group_senderId' element of the Group_OSCORE_Input_Material object MUST NOT be included.<a href="#appendix-C-4.1.5" class="pilcrow">¶</a></p>
<p id="appendix-C-4.1.6">
If the optimization defined in this appendix is combined with the use of phantom requests as deterministic requests (see <a href="#deterministic-phantom-Request" class="xref">Appendix D</a>), the elements 'alg', 'ecdh_alg' and 'ecdh_params' of the Group_OSCORE_Input_Material object MUST also be included. Otherwise, they MUST NOT be included.<a href="#appendix-C-4.1.6" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-4.2">'srv_pub_key': this element is a CBOR byte string, which wraps the original binary representation of the server's public key used in the OSCORE group. In particular, the original binary representation complies with the encoding specified by the 'pub_key_enc' element of 'gp_material'.<a href="#appendix-C-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-C-4.3">'srv_identifier': this element MUST be included and is encoded as a CBOR byte string, with value the Sender ID that the server has in the OSCORE group.<a href="#appendix-C-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-C-4.4">'exp': with value the expiration time of the keying material of the OSCORE group specified in the 'gp_material' parameter, encoded as a CBOR unsigned integer. This field contains a numeric value representing the number of seconds from 1970-01-01T00:00:00Z UTC until the specified UTC date/time, ignoring leap seconds, analogous to what specified for NumericDate in <span><a href="https://rfc-editor.org/rfc/rfc7519#section-2" class="relref">Section 2</a> of [<a href="#RFC7519" class="xref">RFC7519</a>]</span>.<a href="#appendix-C-4.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-5">Note that the informative response does not require to include an explicit proof-of-possession (PoP) of the server's private key. Although the server is also acting as Group Manager and a PoP evidence of the Group Manager's private key is included in a full-fledged Joining Response (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-ace-key-groupcomm-oscore-11#section-6.4" class="relref">Section 6.4</a> of [<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>), such proof-of-possession will be achieved through every multicast notification, that the server sends as protected with the group mode of Group OSCORE and including a signature computed with its private key.<a href="#appendix-C-5" class="pilcrow">¶</a></p>
<p id="appendix-C-6">A client receiving an informative response uses the information above to set up the Group OSCORE Security Context, as described in <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-2" class="relref">Section 2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>. Note that the client does not obtain a Sender ID of its own, hence it installs a Security Context that a "silent server" would, i.e., without Sender Context. From then on, the client uses the received keying material to process the incoming multicast notifications from the server.<a href="#appendix-C-6" class="pilcrow">¶</a></p>
<p id="appendix-C-7">Since the server is also acting as Group Manager, the public key of the server provided in the 'srv_pub_key' element of the informative response is also used in the 'gm_public_key' element of the external_aad for encrypting and signing the phantom request and multicast notifications (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-4.3" class="relref">Section 4.3</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>)<a href="#appendix-C-7" class="pilcrow">¶</a></p>
<p id="appendix-C-8">Furthermore, the server complies with the following points.<a href="#appendix-C-8" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-9.1">
          <p id="appendix-C-9.1.1">The server MUST NOT self-manage OSCORE groups and provide the related keying material in the informative response for any other purpose than the protection of group observations, as defined in this document.<a href="#appendix-C-9.1.1" class="pilcrow">¶</a></p>
<p id="appendix-C-9.1.2">
The server MAY use the same self-managed OSCORE group to protect the phantom request and the multicast notifications of multiple group observations it hosts.<a href="#appendix-C-9.1.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="appendix-C-9.2">The server MUST NOT provide in the informative response the keying material of other OSCORE groups it is or has been a member of.<a href="#appendix-C-9.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-10">After the time indicated in the 'exp' field:<a href="#appendix-C-10" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-11.1">
          <p id="appendix-C-11.1.1">The server MUST stop using the keying material and MUST cancel the group observations for which that keying material is used (see <a href="#ssec-server-side-cancellation" class="xref">Section 2.5</a> and <a href="#ssec-server-side-cancellation-oscore" class="xref">Section 7.2.4</a>). If the server creates a new group observation as a replacement or follow-up using the same OSCORE group:<a href="#appendix-C-11.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-C-11.1.2.1">The server MUST update the Master Secret.<a href="#appendix-C-11.1.2.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-C-11.1.2.2">The server MUST update the ID Context used as Group Identifier (Gid), consistently with <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>.<a href="#appendix-C-11.1.2.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="appendix-C-11.1.2.3">The server MAY update the Master Salt.<a href="#appendix-C-11.1.2.3" class="pilcrow">¶</a>
</li>
          </ul>
</li>
        <li class="normal" id="appendix-C-11.2">The client MUST stop using the keying material and MAY re-register the observation at the server.<a href="#appendix-C-11.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-C-12">Before the keying material has expired, the server can send a multicast response with response code 5.03 (Service Unavailable) to the observing clients, protected with the current keying material. In particular, this is an informative response (see <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>), which additionally contains the abovementioned parameters for the next group keying material to be used. The response has the same Token value T of the phantom registration request and it does not include an Observe option. The server MUST use its own Sender Sequence Number as Partial IV to protect the error response, and include it as Partial IV in the OSCORE option of the response.<a href="#appendix-C-12" class="pilcrow">¶</a></p>
<p id="appendix-C-13">When some clients leave the OSCORE group and forget about the group observation, the server does not have to provide the remaining clients with any stale Sender IDs, as normally required for Group OSCORE (see <span><a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-oscore-groupcomm-12#section-3.2" class="relref">Section 3.2</a> of [<a href="#I-D.ietf-core-oscore-groupcomm" class="xref">I-D.ietf-core-oscore-groupcomm</a>]</span>). In fact, only two entities in the group have a Sender ID, i.e., the server and possibly the Deterministic Client, if the optimization defined in this appendix is combined with the use of phantom requests as deterministic requests (see <a href="#deterministic-phantom-Request" class="xref">Appendix D</a>). In particular, both of them never change their Sender ID during the group lifetime, while they both remain part of the group until the group ceases to exist.<a href="#appendix-C-13" class="pilcrow">¶</a></p>
<p id="appendix-C-14">As an alternative to renewing the keying material before it expires, the server can simply cancel the group observation (see <a href="#ssec-server-side-cancellation" class="xref">Section 2.5</a> and <a href="#ssec-server-side-cancellation-oscore" class="xref">Section 7.2.4</a>), which results in the eventual re-registration of the clients that are still interested in the group observation.<a href="#appendix-C-14" class="pilcrow">¶</a></p>
<p id="appendix-C-15">Applications requiring backward security and forward security are REQUIRED to use an actual group joining process (usually through a dedicated Group Manager), e.g., the ACE joining procedure defined in <span>[<a href="#I-D.ietf-ace-key-groupcomm-oscore" class="xref">I-D.ietf-ace-key-groupcomm-oscore</a>]</span>. The server can facilitate the clients by providing them information about the OSCORE group to join, as described in <a href="#sec-inf-response" class="xref">Section 7.1</a>.<a href="#appendix-C-15" class="pilcrow">¶</a></p>
</section>
</div>
<div id="deterministic-phantom-Request">
<section id="appendix-D">
      <h2 id="name-phantom-request-as-determin">
<a href="#appendix-D" class="section-number selfRef">Appendix D. </a><a href="#name-phantom-request-as-determin" class="section-name selfRef">Phantom Request as Deterministic Request</a>
      </h2>
<p id="appendix-D-1">In some settings, the server can assume that all the approaching clients already have the exact phantom observation request to use.<a href="#appendix-D-1" class="pilcrow">¶</a></p>
<p id="appendix-D-2">For instance, the clients can be pre-configured with the phantom observation request, or they may be expected to retrieve it through dedicated means (see <a href="#appendix-different-sources" class="xref">Appendix A</a>), before sending an observe registration request to the server.<a href="#appendix-D-2" class="pilcrow">¶</a></p>
<p id="appendix-D-3">If Group OSCORE is used to protect the group observation (see <a href="#sec-secured-notifications" class="xref">Section 7</a>), and the OSCORE group supports the concept of Deterministic Client <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="xref">I-D.amsuess-core-cachable-oscore</a>]</span>, then the server and each client in the OSCORE group can independently protect the phantom observation request possibly available as plain CoAP message. To this end, they use the approach defined in <span><a href="https://datatracker.ietf.org/doc/html/draft-amsuess-core-cachable-oscore-01#section-2" class="relref">Section 2</a> of [<a href="#I-D.amsuess-core-cachable-oscore" class="xref">I-D.amsuess-core-cachable-oscore</a>]</span> to compute a protected deterministic request, against which the protected multicast notifications will match for the group observation in question.<a href="#appendix-D-3" class="pilcrow">¶</a></p>
<p id="appendix-D-4">Note that, if the optimization defined in <a href="#self-managed-oscore-group" class="xref">Appendix C</a> is also used, the error informative response from the server has to include additional information, i.e., the Sender ID of the Deterministic Client in the OSCORE group, and the hash algorithm used to compute the deterministic request (see <span><a href="https://datatracker.ietf.org/doc/html/draft-amsuess-core-cachable-oscore-01#section-2.3.1" class="relref">Section 2.3.1</a> of [<a href="#I-D.amsuess-core-cachable-oscore" class="xref">I-D.amsuess-core-cachable-oscore</a>]</span>).<a href="#appendix-D-4" class="pilcrow">¶</a></p>
<p id="appendix-D-5">This optimization allows the server to not provide the same full phantom observation request to each client in the error informative response (see <a href="#ssec-server-side-informative" class="xref">Section 2.2</a>). That is, the informative response does not need to convey the full phantom request in the 'ph_req' parameter, but only the 'tp_info' parameter specifying the transport-specific information and (optionally) the 'last_notif' parameter specifying the latest sent multicast notification.<a href="#appendix-D-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries-example">
<section id="appendix-E">
      <h2 id="name-example-with-a-proxy">
<a href="#appendix-E" class="section-number selfRef">Appendix E. </a><a href="#name-example-with-a-proxy" class="section-name selfRef">Example with a Proxy</a>
      </h2>
<p id="appendix-E-1">This section provides an example when a proxy P is used between the clients and the server. The same assumptions and notation used in <a href="#sec-example-no-security" class="xref">Section 5</a> are used for this example. In addition, the proxy has address PRX_ADDR and listens to the port number PRX_PORT.<a href="#appendix-E-1" class="pilcrow">¶</a></p>
<p id="appendix-E-2">Unless explicitly indicated, all messages transmitted on the wire are sent over unicast.<a href="#appendix-E-2" class="pilcrow">¶</a></p>
<span id="name-example-of-group-observation-"></span><div id="example-proxy-no-oscore">
<figure id="figure-12">
        <div class="artwork art-text alignLeft" id="appendix-E-3.1">
<pre>
C1     C2     P        S
|      |      |        |
|      |      |        |  (The value of the resource /r is "1234")
|      |      |        |
+------------&gt;|        |  Token: 0x4a
| GET  |      |        |  Observe: 0 (Register)
|      |      |        |  Proxy-Uri: coap://sensor.example/r
|      |      |        |
|      |      +-------&gt;|  Token: 0x5e
|      |      | GET    |  Observe: 0 (Register)
|      |      |        |  Uri-Host: sensor.example
|      |      |        |  Uri-Path: r
|      |      |        |
|      |      |        |  (S allocates the available Token value 0x7b)
|      |      |        |
|      |      |        |  (S sends to itself a phantom observation
|      |      |        |  request PH_REQ as coming from the
|      |      |        |  IP multicast address GRP_ADDR)
|      |      |        |
|      |      |  ------+
|      |      | /      |
|      |      | \-----&gt;|  Token: 0x7b
|      |      |   GET  |  Observe: 0 (Register)
|      |      |        |  Uri-Host: sensor.example
|      |      |        |  Uri-Path: r
|      |      |        |
|      |      |        |  (S creates a group observation of /r)
|      |      |        |
|      |      |        |  (S increments the observer counter
|      |      |        |  for the group observation of /r)
|      |      |        |
|      |      |        |
|      |      |&lt;-------+  Token: 0x5e
|      |      | 5.03   |  Content-Format: application/
|      |      |        |     informative-response+cbor
|      |      |        |  Max-Age: 0
|      |      |        |  &lt;Other options&gt;
|      |      |        |  Payload: {
|      |      |        |    tp_info    : [1, bstr(SRV_ADDR), SRV_PORT,
|      |      |        |                  0x7b, bstr(GRP_ADDR),
|      |      |        |                  GRP_PORT],
|      |      |        |    ph_req     : bstr(0x01 | OPT),
|      |      |        |    last_notif : bstr(0x45 | OPT |
|      |      |        |                      0xff | PAYLOAD)
|      |      |        |  }
|      |      |        |
|      |      |        |  (PAYLOAD in 'last_notif' : "1234")
|      |      |        |
|      |      |        |
|      |      |        |  (The proxy starts listening to the
|      |      |        |   GRP_ADDR address and the GRP_PORT port.)
|      |      |        |
|      |      |        |  (The proxy adds C1 to its list of observers.)
|      |      |        |
|&lt;------------+        |  Token: 0x4a
| 2.05 |      |        |  Observe: 54120
|      |      |        |  Content-Format: application/cbor
|      |      |        |  &lt;Other options&gt;
|      |      |        |  Payload: "1234"
|      |      |        |
:      :      :        :
:      :      :        :
:      :      :        :
|      |      |        |
|      |      |        |
|      +-----&gt;|        |  Token: 0x01
|      | GET  |        |  Observe: 0 (Register)
|      |      |        |  Proxy-Uri: coap://sensor.example/r
|      |      |        |
|      |      |        |  (The proxy has a fresh cache representation)
|      |      |        |
|      |&lt;-----+        |  Token: 0x01
|      | 2.05 |        |  Observe: 54120
|      |      |        |  Content-Format: application/cbor
|      |      |        |  &lt;Other options&gt;
|      |      |        |  Payload: "1234"
|      |      |        |
:      :      :        :
:      :      :        :  (The value of the resource
:      :      :        :  /r changes to "5678".)
:      :      :        :
|      |      |  (*)   |
|      |      |&lt;-------+  Token: 0x7b
|      |      | 2.05   |  Observe: 11
|      |      |        |  Content-Format: application/cbor
|      |      |        |  &lt;Other options&gt;
|      |      |        |  Payload: "5678"
|      |      |        |
|&lt;------------+        |  Token: 0x4a
| 2.05 |      |        |  Observe: 54123
|      |      |        |  Content-Format: application/cbor
|      |      |        |  &lt;Other options&gt;
|      |      |        |  Payload: "5678"
|      |      |        |
|      |&lt;-----+        |  Token: 0x01
|      | 2.05 |        |  Observe: 54123
|      |      |        |  Content-Format: application/cbor
|      |      |        |  &lt;Other options&gt;
|      |      |        |  Payload: "5678"
|      |      |        |


(*) Sent over IP multicast to GROUP_ADDR:GROUP_PORT

</pre>
</div>
<figcaption><a href="#figure-12" class="selfRef">Figure 12</a>:
<a href="#name-example-of-group-observation-" class="selfRef">Example of group observation with a proxy</a>
        </figcaption></figure>
</div>
<p id="appendix-E-4">Note that the proxy has all the information to understand the observation request from C2, and can immediately start to serve the still fresh values.<a href="#appendix-E-4" class="pilcrow">¶</a></p>
<p id="appendix-E-5">This behavior is mandated by <span><a href="https://rfc-editor.org/rfc/rfc7641#section-5" class="relref">Section 5</a> of [<a href="#RFC7641" class="xref">RFC7641</a>]</span>, i.e., the proxy registers itself only once with the next hop and fans out the notifications it receives to all registered clients.<a href="#appendix-E-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries-example-e2e-security">
<section id="appendix-F">
      <h2 id="name-example-with-a-proxy-and-gr">
<a href="#appendix-F" class="section-number selfRef">Appendix F. </a><a href="#name-example-with-a-proxy-and-gr" class="section-name selfRef">Example with a Proxy and Group OSCORE</a>
      </h2>
<p id="appendix-F-1">This section provides an example when a proxy P is used between the clients and the server, and Group OSCORE is used to protect multicast notifications end-to-end between the server and the clients.<a href="#appendix-F-1" class="pilcrow">¶</a></p>
<p id="appendix-F-2">The same assumptions and notation used in <a href="#sec-example-with-security" class="xref">Section 8</a> are used for this example. In addition, the proxy has address PRX_ADDR and listens to the port number PRX_PORT.<a href="#appendix-F-2" class="pilcrow">¶</a></p>
<p id="appendix-F-3">Unless explicitly indicated, all messages transmitted on the wire are sent over unicast and protected with OSCORE end-to-end between a client and the server.<a href="#appendix-F-3" class="pilcrow">¶</a></p>
<span id="name-example-of-group-observation-w"></span><div id="example-proxy-oscore">
<figure id="figure-13">
        <div class="artwork art-text alignLeft" id="appendix-F-4.1">
<pre>
C1      C2      P         S
|       |       |         |
|       |       |         |  (The value of the resource /r is "1234")
|       |       |         |
+--------------&gt;|         |  Token: 0x4a
| FETCH |       |         |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 1; piv: 101; ...}
|       |       |         |  Uri-Host: sensor.example
|       |       |         |  Proxy-Scheme: coap
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r,
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |
|       |       +--------&gt;|  Token: 0x5e
|       |       | FETCH   |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 1; piv: 101; ...}
|       |       |         |  Uri-Host: sensor.example
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r,
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |
|       |       |         |
|       |       |         |  (S allocates the available
|       |       |         |   Token value 0x7b .)
|       |       |         |
|       |       |         |  (S sends to itself a phantom observation
|       |       |         |  request PH_REQ as coming from the
|       |       |         |  IP multicast address GRP_ADDR)
|       |       |         |
|       |       |  -------+
|       |       | /       |
|       |       | \------&gt;|  Token: 0x7b
|       |       |   FETCH |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 5; piv: 501;
|       |       |         |           kid context: 57ab2e; ...}
|       |       |         |  Uri-Host: sensor.example
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r,
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |  &lt;Signature&gt;
|       |       |         |
|       |       |         |  (S steps SN_5 in the Group OSCORE
|       |       |         |   Security Context : SN_5 &lt;== 502)
|       |       |         |
|       |       |         |  (S creates a group observation of /r)
|       |       |         |
|       |       |         |
|       |       |         |  (S increments the observer counter
|       |       |         |  for the group observation of /r)
|       |       |         |
|       |       |&lt;--------+  Token: 0x5e
|       |       | 2.05    |  OSCORE: {piv: 301; ...}
|       |       |         |  Max-Age: 0
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    5.03 (Service Unavailable),
|       |       |         |    Content-Format: application/
|       |       |         |       informative-response+cbor,
|       |       |         |    &lt;Other class E options&gt;,
|       |       |         |    0xff,
|       |       |         |    CBOR_payload {
|       |       |         |       tp_info : [1, bstr(SRV_ADDR),
|       |       |         |                  SRV_PORT, 0x7b,
|       |       |         |                  bstr(GRP_ADDR), GRP_PORT],
|       |       |         |       ph_req : bstr(0x05 | OPT | 0xff |
|       |       |         |                     PAYLOAD | SIGN),
|       |       |         |       last_notif : bstr(0x45 | OPT | 0xff |
|       |       |         |                         PAYLOAD | SIGN),
|       |       |         |       join_uri : "coap://myGM/
|       |       |         |                   ace-group/myGroup",
|       |       |         |       sec_gp : "myGroup"
|       |       |         |    }
|       |       |         |  }
|       |       |         |
|&lt;--------------+         |  Token: 0x4a
| 2.05  |       |         |  OSCORE: {piv: 301; ...}
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  (Same Encrypted_payload)
|       |       |         |
+--------------&gt;|         |  Token: 0x4b
| FETCH |       |         |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 5 ; piv: 501;
|       |       |         |           kid context: 57ab2e; ...}
|       |       |         |  Uri-Host: sensor.example
|       |       |         |  Proxy-Scheme: coap
|       |       |         |  Listen-To-
|       |       |         |  Multicast-Responses: {[1, bstr(SRV_ADDR),
|       |       |         |                         SRV_PORT, 0x7b,
|       |       |         |                         bstr(GRP_ADDR),
|       |       |         |                         GRP_PORT]
|       |       |         |                       }
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |  &lt;Signature&gt;
|       |       |         |
|       |       |         |
|       |       |         |  (The proxy starts listening to the
|       |       |         |   GRP_ADDR address and the GRP_PORT port.)
|       |       |         |
|       |       |         |  (The proxy adds C1 to
|       |       |         |   its list of observers.)
|       |       |         |
|&lt;--------------|         |
|       |  ACK  |         |
:       :       :         :
:       :       :         :
:       :       :         :
|       |       |         |
|       +------&gt;|         |  Token: 0x01
|       | FETCH |         |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 2; piv: 201; ...}
|       |       |         |  Uri-Host: sensor.example
|       |       |         |  Proxy-Scheme: coap
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r,
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |
|       |       +--------&gt;|  Token: 0x5f
|       |       | FETCH   |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 2; piv: 201; ...}
|       |       |         |  Uri-Host: sensor.example
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r,
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |
|       |       |&lt;--------+  Token: 0x5f
|       |       | 2.05    |  OSCORE: {piv: 401; ...}
|       |       |         |  Max-Age: 0
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    5.03 (Service Unavailable),
|       |       |         |    Content-Format: application/
|       |       |         |       informative-response+cbor,
|       |       |         |    &lt;Other class E options&gt;,
|       |       |         |    0xff,
|       |       |         |    CBOR_payload {
|       |       |         |       tp_info : [1, bstr(SRV_ADDR),
|       |       |         |                  SRV_PORT, 0x7b,
|       |       |         |                  bstr(GRP_ADDR), GRP_PORT],
|       |       |         |       ph_req : bstr(0x05 | OPT | 0xff |
|       |       |         |                     PAYLOAD | SIGN),
|       |       |         |       last_notif : bstr(0x45 | OPT | 0xff |
|       |       |         |                         PAYLOAD | SIGN),
|       |       |         |       join_uri : "coap://myGM/
|       |       |         |                   ace-group/myGroup",
|       |       |         |       sec_gp : "myGroup"
|       |       |         |    }
|       |       |         |  }
|       |       |         |
|       |&lt;------+         |  Token: 0x01
|       | 2.05  |         |  OSCORE: {piv: 401; ...}
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  (Same Encrypted_payload)
|       |       |         |
|       +------&gt;|         |  Token: 0x02
|       | FETCH |         |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 5; piv: 501;
|       |       |         |           kid context: 57ab2e; ...}
|       |       |         |  Uri-Host: sensor.example
|       |       |         |  Proxy-Scheme: coap
|       |       |         |  Listen-To-
|       |       |         |  Multicast-Responses: {[1, bstr(SRV_ADDR),
|       |       |         |                         SRV_PORT, 0x7b,
|       |       |         |                         bstr(GRP_ADDR),
|       |       |         |                         GRP_PORT]
|       |       |         |                       }
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |  &lt;Signature&gt;
|       |       |         |
|       |       |         |  (The proxy adds C2 to
|       |       |         |   its list of observers.)
|       |&lt;------|         |
|       |  ACK  |         |
|       |       |         |
:       :       :         :
:       :       :         :  (The value of the resource
:       :       :         :  /r changes to "5678".)
:       :       :         :
|       |       |   (*)   |
|       |       |&lt;--------+  Token: 0x7b
|       |       | 2.05    |  Observe: 11
|       |       |         |  OSCORE: {kid: 5; piv: 502;
|       |       |         |           kid context: 57ab2e; ...}
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    2.05 (Content),
|       |       |         |    Observe: [empty],
|       |       |         |    Content-Format: application/cbor,
|       |       |         |    &lt;Other class E options&gt;,
|       |       |         |    0xff,
|       |       |         |   CBOR_Payload : "5678"
|       |       |         |  }
|       |       |         |  &lt;Signature&gt;
|       |       |         |
|&lt;--------------+         |  Token: 0x4b
| 2.05  |       |         |  Observe: 54123
|       |       |         |  OSCORE: {kid: 5; piv: 502;
|       |       |         |           kid context: 57ab2e; ...}
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  (Same Encrypted_payload and Signature)
|       |       |         |
|       |&lt;------+         |  Token: 0x02
|       | 2.05  |         |  Observe: 54123
|       |       |         |  OSCORE: {kid: 5; piv: 502;
|       |       |         |           kid context: 57ab2e; ...}
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  (Same Encrypted_payload and signature)
|       |       |         |


(*) Sent over IP multicast to GROUP_ADDR:GROUP_PORT and protected
    with Group OSCORE end-to-end between the server and the clients.

</pre>
</div>
<figcaption><a href="#figure-13" class="selfRef">Figure 13</a>:
<a href="#name-example-of-group-observation-w" class="selfRef">Example of group observation with a proxy and Group OSCORE</a>
        </figcaption></figure>
</div>
<p id="appendix-F-5">Unlike in the unprotected example in <a href="#intermediaries-example" class="xref">Appendix E</a>, the proxy does <em>not</em> have all the information to perform request deduplication, and can only recognize the identical request once the client sends the ticket request.<a href="#appendix-F-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="intermediaries-example-e2e-security-det">
<section id="appendix-G">
      <h2 id="name-example-with-a-proxy-and-de">
<a href="#appendix-G" class="section-number selfRef">Appendix G. </a><a href="#name-example-with-a-proxy-and-de" class="section-name selfRef">Example with a Proxy and Deterministic Requests</a>
      </h2>
<p id="appendix-G-1">This section provides an example when a proxy P is used between the clients and the server, and Group OSCORE is used to protect multicast notifications end-to-end between the server and the clients.<a href="#appendix-G-1" class="pilcrow">¶</a></p>
<p id="appendix-G-2">In addition, the phantom request is especially a deterministic request (see <a href="#deterministic-phantom-Request" class="xref">Appendix D</a>), which is protected with the pairwise mode of Group OSCORE as defined in <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="xref">I-D.amsuess-core-cachable-oscore</a>]</span>.<a href="#appendix-G-2" class="pilcrow">¶</a></p>
<div id="intermediaries-example-e2e-security-det-intro">
<section id="appendix-G.1">
        <h3 id="name-assumptions-and-walkthrough">
<a href="#appendix-G.1" class="section-number selfRef">G.1. </a><a href="#name-assumptions-and-walkthrough" class="section-name selfRef">Assumptions and Walkthrough</a>
        </h3>
<p id="appendix-G.1-1">The example provided in this appendix as reflected by the message exchange shown in <a href="#intermediaries-example-e2e-security-det-exchange" class="xref">Appendix G.2</a> assumes the following.<a href="#appendix-G.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="appendix-G.1-2">
<li id="appendix-G.1-2.1">The OSCORE group supports deterministic requests. Thus, the server creates the phantom request as a deterministic request <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="xref">I-D.amsuess-core-cachable-oscore</a>]</span>, and stores it locally as one of its issued phantom requests, without starting the group observation yet.<a href="#appendix-G.1-2.1" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.2">The server makes the phantom request available through other means, e.g., a pub-sub broker, together with the transport-specific information for listening to multicast notifications bound to the phantom request (see <a href="#appendix-different-sources" class="xref">Appendix A</a>).<a href="#appendix-G.1-2.2" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.3">Since the phantom request is a deterministic request, the server can more efficiently make it available in its smaller, plain version. The clients can obtain it from the particular alternative source, and compute the protected version to use from the retrieved plain version.<a href="#appendix-G.1-2.3" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.4">If the client does not rely on a proxy between itself and the server, it simply sets the group observation and starts listening to multicast notifications. Building on point (2) above, the same would happen if the phantom request would not be specifically a deterministic request.<a href="#appendix-G.1-2.4" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.5">If the client relies on a proxy between itself and the server, it uses the phantom request as a ticket request. However, unlike the case considered in <a href="#intermediaries-e2e-security" class="xref">Section 10</a> when the ticket request is not deterministic, the client does not include a Listen-to-Multicast-Responses option in the phantom request sent to the proxy.<a href="#appendix-G.1-2.5" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.6">Unlike for the case considered in <a href="#intermediaries-e2e-security" class="xref">Section 10</a>, here the proxy does not know that the request is exactly a ticket request for subscribing to multicast notifications. Thus, the proxy simply forwards the ticket request to the server as it normally does for any request.<a href="#appendix-G.1-2.6" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.7">The server receives the ticket request, which is a deviation from the case where the ticket request is not deterministic and stops at the proxy (see <a href="#intermediaries-e2e-security" class="xref">Section 10</a>). Then, the server can clearly understand what is happening. In fact, as the result of an early check, the server recognizes the phantom request among the stored ones. This happens through a byte-by-byte comparison of the incoming message minus the transport-related fields, i.e., by considering only: i) the outer REST code; ii) the outer options; and iii) the ciphertext and signature from the message payload.<a href="#appendix-G.1-2.7" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.8">Having recognized the incoming request as one of the self-generated deterministic phantom requests made available at external sources, the server does not perform any OSCORE processing on it. This opens for replying to the proxy with an unprotected response, although not signaling any OSCORE-related error.<a href="#appendix-G.1-2.8" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.9">The server starts the group observation and replies with an error response, i.e., the usual 5.03 informative response, including: the transport information, the phantom request, and (optionally) the latest notification.<a href="#appendix-G.1-2.9" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.10">From the received 5.03 response, the proxy retrieves everything needed to set itself as an observer in the group observation, and it starts listening to multicast notifications. If the 5.03 response included a latest notification, the proxy caches it and forwards it back to the client, otherwise it replies with an empty ACK (if it has not done it already and the request from the client was Confirmable).<a href="#appendix-G.1-2.10" class="pilcrow">¶</a>
</li>
          <li id="appendix-G.1-2.11">Like in the case with a non-deterministic phantom request considered in <a href="#intermediaries-e2e-security" class="xref">Section 10</a>, the proxy fans out the multicast notifications to the origin clients as they come. Also, as new clients following the first one contact the proxy, this does not have to contact the server again as in <a href="#intermediaries-e2e-security" class="xref">Section 10</a>, since the deterministic phantom request would produce a cache hit as per <span>[<a href="#I-D.amsuess-core-cachable-oscore" class="xref">I-D.amsuess-core-cachable-oscore</a>]</span>. Thus, the proxy can serve such clients with the latest fresh multicast notification from its cache.<a href="#appendix-G.1-2.11" class="pilcrow">¶</a>
</li>
        </ol>
</section>
</div>
<div id="intermediaries-example-e2e-security-det-exchange">
<section id="appendix-G.2">
        <h3 id="name-message-exchange">
<a href="#appendix-G.2" class="section-number selfRef">G.2. </a><a href="#name-message-exchange" class="section-name selfRef">Message Exchange</a>
        </h3>
<p id="appendix-G.2-1">The same assumptions and notation used in <a href="#sec-example-with-security" class="xref">Section 8</a> are used for this example. As a recap of some specific value:<a href="#appendix-G.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G.2-2.1">Two clients C_1 and C_2 register to observe a resource /r at a Server S, which has address SRV_ADDR and listens to the port number SRV_PORT. Before the following exchanges occur, no clients are observing the resource /r , which has value "1234".<a href="#appendix-G.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-G.2-2.2">The server S sends multicast notifications to the IP multicast address GRP_ADDR and port number GRP_PORT, and starts the group observation upon receiving a registration request from a first client that wishes to start a traditional observation on the resource /r.<a href="#appendix-G.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-G.2-2.3">S is a member of the OSCORE group with 'kid context' = 0x57ab2e as Group ID. In the OSCORE group, S has 'kid' = 5 as Sender ID, and SN_5 = 501 as Sender Sequence Number.<a href="#appendix-G.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-G.2-3">In addition:<a href="#appendix-G.2-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-G.2-4.1">The proxy has address PRX_ADDR and listens to the port number PRX_PORT.<a href="#appendix-G.2-4.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-G.2-4.2">The deterministic client in the OSCORE group has 'kid' 9.<a href="#appendix-G.2-4.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="appendix-G.2-5">Unless explicitly indicated, all messages transmitted on the wire are sent over unicast and protected with Group OSCORE end-to-end between a client and the server.<a href="#appendix-G.2-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="appendix-G.2-6">
<pre>
C1      C2      P         S
|       |       |         |
|       |       |         |  (The value of the resource /r is "1234")
|       |       |         |
|       |       |         |  (The server prepares a deterministic
|       |       |         |   phantom request PH_REQ. The server
|       |       |         |   stores PH_REQ locally and makes it
|       |       |         |   available at an external source)
|       |       |         |
|       |       |         |  (C1 obtains PH_REQ and sends it to P)
|       |       |         |
|       |       |         |
+--------------&gt;|         |  Token: 0x4a
| FETCH |       |         |  Uri-Host: sensor.example
|       |       |         |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 9 ; piv: 0 ;
|       |       |         |           kid context: 0x57ab2e ; ... }
|       |       |         |  Proxy-Scheme: coap
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r,
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |
|       |       +--------&gt;|  Token: 0x5e
|       |       | FETCH   |  Uri-Host: sensor.example
|       |       |         |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 9 ; piv: 0 ;
|       |       |         |           kid context: 0x57ab2e ; ... }
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r,
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |
|       |       |         |  (S recognizes PH_REQ through byte-by-byte
|       |       |         |   comparison against the stored one, and
|       |       |         |   skips any OSCORE processing)
|       |       |         |
|       |       |         |  (S allocates the available
|       |       |         |   Token value 0x7b .)
|       |       |         |
|       |       |         |  (S sends to itself PH_REQ, with Token 0x7b
|       |       |         |   and as coming from the IP multicast
|       |       |         |   address GRP_ADDR; now the OSCORE
|       |       |         |   processing does happen, as specified
|       |       |         |   for a deterministic request)
|       |       |         |
|       |       |  -------|
|       |       | /       |
|       |       | \------&gt;|  Token: 0x7b
|       |       |   FETCH |  Uri-Host: sensor.example
|       |       |         |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 9 ; piv: 0 ;
|       |       |         |           kid context: 0x57ab2e ; ... }
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r,
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |
|       |       |         |  (S prepares the "last notification"
|       |       |         |   response defined below)
|       |       |         |
|       |       |         |  0x45 (2.05 Content)
|       |       |         |  Observe: 10
|       |       |         |  OSCORE: {kid: 5 ; piv: 501 ;
|       |       |         |           kid context: 57ab2e; ...}
|       |       |         |  Max-Age: 3000
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x45 (2.05 Content),
|       |       |         |    Observe: [empty],
|       |       |         |    Payload: "1234"
|       |       |         |  }
|       |       |         |
|       |       |         |  (S responds to the proxy with an
|       |       |         |   unprotected informative response)
|       |       |         |
|       |       |&lt;--------|  Token: 0x5e
|       |       | 5.03    |  Content-Format: application/
|       |       |         |    informative-response+cbor
|       |       |         |  Max-Age: 0
|       |       |         |  0xff,
|       |       |         |  CBOR_payload {
|       |       |         |     tp_info : [1, bstr(SRV_ADDR), SRV_PORT,
|       |       |         |                0x7b, bstr(GRP_ADDR),
|       |       |         |                GRP_PORT],
|       |       |         |     ph_req : &lt;the deterministic
|       |       |         |               phantom request&gt;,
|       |       |         |     last_notif : &lt;the "last notification"
|       |       |         |                   response prepared above&gt;
|       |       |         |    }
|       |       |         |  }
|       |       |         |
|       |       |         |  (P extracts PH_REQ and starts listening
|       |       |         |   to multicast notifications with Token
|       |       |         |   0x7b at GRP_ADDR:GRP_PORT)
|       |       |         |
|       |       |         |  (P extracts the "last notification"
|       |       |         |   response, caches it and forwards
|       |       |         |   it back to C1)
|       |       |         |
|&lt;--------------+         |  Token: 0x4a
| 2.05  |       |         |  Observe: 54120
|       |       |         |  OSCORE: {kid: 5 ; piv: 501 ;
|       |       |         |           kid context: 57ab2e; ...}
|       |       |         |  Max-Age: 2995
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x45 (2.05 Content),
|       |       |         |    Observe: [empty],
|       |       |         |    Payload: "1234"
|       |       |         |  }
|       |       |         |
:       :       :         |
:       :       :         |
:       :       :         |
|       |       |         |
|       |       |         |  (C2 obtains PH_REQ and sends it to P)
|       |       |         |
|       +------&gt;|         |  Token: 0x01
|       | FETCH |         |  Uri-Host: sensor.example
|       |       |         |  Observe: 0 (Register)
|       |       |         |  OSCORE: {kid: 9 ; piv: 0 ;
|       |       |         |           kid context: 57ab2e; ...}
|       |       |         |  Proxy-Scheme: coap
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x01 (GET),
|       |       |         |    Observe: 0 (Register),
|       |       |         |    Uri-Path: r,
|       |       |         |    &lt;Other class E options&gt;
|       |       |         |  }
|       |       |         |
|       |       |         |  (P serves C2 from it cache)
|       |       |         |
|       |&lt;------+         |  Token: 0x01
|       | 2.05  |         |  Observe: 54120
|       |       |         |  OSCORE: {kid: 5 ; piv: 501 ;
|       |       |         |           kid context: 57ab2e;
|       |       |         |  Max-Age: 1800
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x45 (2.05 Content),
|       |       |         |    Observe: [empty],
|       |       |         |    Payload: "1234"
|       |       |         |  }
|       |       |         |
:       :       :         |
:       :       :         |
:       :       :         |
|       |       |         |
|       |       |         |  (The value of the resource
|       |       |         |   /r changes to "5678".)
|       |       |         |
|       |       |   (*)   |
|       |       |&lt;--------|  Token: 0x7b
|       |       | 2.05    |  Observe: 11
|       |       |         |  OSCORE: {kid: 5; piv: 502 ; ...}
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  Encrypted_payload {
|       |       |         |    0x45 (2.05 Content),
|       |       |         |    Observe: [empty],
|       |       |         |    Content-Format: application/cbor,
|       |       |         |    &lt;Other class E options&gt;,
|       |       |         |    0xff,
|       |       |         |    CBOR_Payload : "5678"
|       |       |         |  }
|       |       |         |  &lt;Signature&gt;
|       |       |         |
|       |       |         |  (P updates its cache entry
|       |       |         |   with this notification)
|       |       |         |
|&lt;--------------+         |  Token: 0x4a
| 2.05  |       |         |  Observe: 54123
|       |       |         |  OSCORE: {kid: 5; piv: 502 ; ...}
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  (Same Encrypted_payload and signature)
|       |       |         |
|       |&lt;------+         |  Token: 0x01
|       | 2.05  |         |  Observe: 54123
|       |       |         |  OSCORE: {kid: 5; piv: 502 ; ...}
|       |       |         |  &lt;Other class U/I options&gt;
|       |       |         |  0xff
|       |       |         |  (Same Encrypted_payload and signature)
|       |       |         |


(*) Sent over IP multicast to GROUP_ADDR:GROUP_PORT and protected
    with Group OSCORE end-to-end between the server and the clients.
</pre><a href="#appendix-G.2-6" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="sec-document-updates">
<section id="appendix-H">
      <h2 id="name-document-updates">
<a href="#appendix-H" class="section-number selfRef">Appendix H. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-H-1">RFC EDITOR: PLEASE REMOVE THIS SECTION.<a href="#appendix-H-1" class="pilcrow">¶</a></p>
<div id="sec-00-01">
<section id="appendix-H.1">
        <h3 id="name-version-00-to-01">
<a href="#appendix-H.1" class="section-number selfRef">H.1. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-H.1-1.1">Simplified cancellation of the group observation, without using a phantom cancellation request.<a href="#appendix-H.1-1.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-H.1-1.2">Aligned parameter semantics with core-oscore-groupcomm and ace-key-groupcomm-oscore.<a href="#appendix-H.1-1.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-H.1-1.3">Clarifications about self-managed OSCORE group and use of deterministic requests for cacheable OSCORE.<a href="#appendix-H.1-1.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-H.1-1.4">New example with a proxy, Group OSCORE and a deterministic phantom request.<a href="#appendix-H.1-1.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="appendix-H.1-1.5">Fixes in the examples and editorial improvements.<a href="#appendix-H.1-1.5" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowldegment">
<section id="appendix-I">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-I-1">The authors sincerely thank Carsten Bormann, Klaus Hartke, Jaime Jimenez, John Mattsson, Ludwig Seitz, Jim Schaad and Goeran Selander for their comments and feedback.<a href="#appendix-I-1" class="pilcrow">¶</a></p>
<p id="appendix-I-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-I-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-J">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Höglund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Christian Amsüss</span></div>
<div dir="auto" class="left"><span class="street-address">Hollandstr. 12/4</span></div>
<div dir="auto" class="left">
<span class="postal-code">1020</span> <span class="locality">Vienna</span>
</div>
<div dir="auto" class="left"><span class="country-name">Austria</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:christian@amsuess.com" class="email">christian@amsuess.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson AB</span></div>
<div dir="auto" class="left"><span class="street-address">Torshamnsgatan 23</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
