<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Forward Secrecy for the Extensible Authentication Protocol Method for Authentication and Key Agreement (EAP-AKA' FS)</title>
<meta content="Jari Arkko" name="author">
<meta content="Karl Norrman" name="author">
<meta content="Vesa Torvinen" name="author">
<meta content="
       Many different attacks have been reported as part of revelations
  associated with pervasive surveillance. Some of the reported attacks
  involved compromising smart cards, such as attacking SIM card
  manufacturers and operators in an effort to compromise shared
  secrets stored on these cards. Since the publication of those
  reports, manufacturing and provisioning processes have gained much
  scrutiny and have improved. However, the danger of resourceful
  attackers for these systems is still a concern. 
       This specification is an optional extension to the EAP-AKA'
  authentication method which was defined in 
   . The extension, when
  negotiated, provides Forward Secrecy for the session key
  generated as a part of the authentication run in EAP-AKA'. This
  prevents an attacker who has gained access to the long-term
  pre-shared secret in a SIM card from being able to decrypt any past
  communications. In addition, if the attacker stays merely a passive
  eavesdropper, the extension prevents attacks against future
  sessions. This forces attackers to use active attacks instead.  
    " name="description">
<meta content="xml2rfc 3.12.3" name="generator">
<meta content="EAP" name="keyword">
<meta content="AKA" name="keyword">
<meta content="AKA'" name="keyword">
<meta content="3GPP" name="keyword">
<meta content="draft-ietf-emu-aka-pfs-06" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.3
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.8.0
    MarkupSafe 2.0.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-arkko-eap-aka-pfs-06-3yrz6wpa.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EAP-AKA' FS</td>
<td class="right">March 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Arkko, et al.</td>
<td class="center">Expires 7 September 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-emu-aka-pfs-06</dd>
<dt class="label-updates">Updates:</dt>
<dd class="updates">
<a href="https://www.rfc-editor.org/rfc/rfcRFC5448" class="eref">RFC5448</a> (if approved)</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-03" class="published">March 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-09-07">7 September 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Arkko</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">K. Norrman</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">V. Torvinen</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Forward Secrecy for the Extensible Authentication Protocol Method for Authentication and Key Agreement (EAP-AKA' FS)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Many different attacks have been reported as part of revelations
  associated with pervasive surveillance. Some of the reported attacks
  involved compromising smart cards, such as attacking SIM card
  manufacturers and operators in an effort to compromise shared
  secrets stored on these cards. Since the publication of those
  reports, manufacturing and provisioning processes have gained much
  scrutiny and have improved. However, the danger of resourceful
  attackers for these systems is still a concern.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">This specification is an optional extension to the EAP-AKA'
  authentication method which was defined in 
  <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>. The extension, when
  negotiated, provides Forward Secrecy for the session key
  generated as a part of the authentication run in EAP-AKA'. This
  prevents an attacker who has gained access to the long-term
  pre-shared secret in a SIM card from being able to decrypt any past
  communications. In addition, if the attacker stays merely a passive
  eavesdropper, the extension prevents attacks against future
  sessions. This forces attackers to use active attacks instead.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo-7">
<a href="#name-status-of-this-memo-7" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 2 September 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice-7">
<a href="#name-copyright-notice-7" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents-7">
<a href="#name-table-of-contents-7" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction-7" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-protocol-design-and-deploym" class="xref">Protocol Design and Deployment Objectives</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-background" class="xref">Background</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1" class="keepWithNext"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-aka" class="xref">AKA</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-eap-aka-protocol" class="xref">EAP-AKA' Protocol</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-attacks-against-long-term-s" class="xref">Attacks Against Long-Term Shared Secrets in Smart Cards</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-requirements-language-2" class="xref">Requirements Language</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-protocol-overview" class="xref">Protocol Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-extensions-to-eap-aka" class="xref">Extensions to EAP-AKA'</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-at_pub_ecdhe" class="xref">AT_PUB_ECDHE</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-at_kdf_fs" class="xref">AT_KDF_FS</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-new-key-derivation-function" class="xref">New Key Derivation Functions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-ecdhe-groups" class="xref">ECDHE Groups</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-message-processing-2" class="xref">Message Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.1">
                    <p id="section-toc.1-1.6.2.5.2.1.1"><a href="#section-6.5.1" class="xref">6.5.1</a>.  <a href="#name-eap-request-aka-identity" class="xref">EAP-Request/AKA'-Identity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.2">
                    <p id="section-toc.1-1.6.2.5.2.2.1"><a href="#section-6.5.2" class="xref">6.5.2</a>.  <a href="#name-eap-response-aka-identity" class="xref">EAP-Response/AKA'-Identity</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.3">
                    <p id="section-toc.1-1.6.2.5.2.3.1"><a href="#section-6.5.3" class="xref">6.5.3</a>.  <a href="#name-eap-request-aka-challenge" class="xref">EAP-Request/AKA'-Challenge</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.4">
                    <p id="section-toc.1-1.6.2.5.2.4.1"><a href="#section-6.5.4" class="xref">6.5.4</a>.  <a href="#name-eap-response-aka-challenge" class="xref">EAP-Response/AKA'-Challenge</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.5">
                    <p id="section-toc.1-1.6.2.5.2.5.1"><a href="#section-6.5.5" class="xref">6.5.5</a>.  <a href="#name-eap-request-aka-reauthentic" class="xref">EAP-Request/AKA'-Reauthentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.6">
                    <p id="section-toc.1-1.6.2.5.2.6.1"><a href="#section-6.5.6" class="xref">6.5.6</a>.  <a href="#name-eap-response-aka-reauthenti" class="xref">EAP-Response/AKA'-Reauthentication</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.7">
                    <p id="section-toc.1-1.6.2.5.2.7.1"><a href="#section-6.5.7" class="xref">6.5.7</a>.  <a href="#name-eap-response-aka-synchroniz" class="xref">EAP-Response/AKA'-Synchronization-Failure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.8">
                    <p id="section-toc.1-1.6.2.5.2.8.1"><a href="#section-6.5.8" class="xref">6.5.8</a>.  <a href="#name-eap-response-aka-authentica" class="xref">EAP-Response/AKA'-Authentication-Reject</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.9">
                    <p id="section-toc.1-1.6.2.5.2.9.1"><a href="#section-6.5.9" class="xref">6.5.9</a>.  <a href="#name-eap-response-aka-client-err" class="xref">EAP-Response/AKA'-Client-Error</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.10">
                    <p id="section-toc.1-1.6.2.5.2.10.1"><a href="#section-6.5.10" class="xref">6.5.10</a>. <a href="#name-eap-request-aka-notificatio" class="xref">EAP-Request/AKA'-Notification</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5.2.11">
                    <p id="section-toc.1-1.6.2.5.2.11.1"><a href="#section-6.5.11" class="xref">6.5.11</a>. <a href="#name-eap-response-aka-notificati" class="xref">EAP-Response/AKA'-Notification</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations-6" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations-7" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references-7" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references-7" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references-7" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-change-log" class="xref">Change Log</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-acknowledgments-3" class="xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-addresses-7" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction-7">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction-7" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Many different attacks have been reported as part of revelations
  associated with pervasive surveillance. Some of the reported attacks
  involved compromising smart cards, such as attacking SIM card
  manufacturers and operators in an effort to compromise shared
  secrets stored on these cards. Such attacks are conceivable, for
  instance, during the manufacturing process of cards, or during the
  transfer of cards and associated information to the operator. Since
  the publication of reports about such attacks, manufacturing and
  provisioning processes have gained much scrutiny and have
  improved.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">However, the danger of resourceful attackers attempting to gain
  information about SIM cards is still a concern. They are a
  high-value target and concern a large number of people.  Note that
  the attacks are largely independent of the used authentication
  technology; the issue is not vulnerabilities in algorithms or
  protocols, but rather the possibility of someone gaining unlawful
  access to key material. While the better protection of manufacturing
  and other processes is essential in protecting against this, there
  is one question that we as protocol designers can ask.  Is there
  something that we can do to limit the consequences of attacks,
  should they occur?<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">The authors want to provide a public specification of an
  extension that helps defend against one aspect of pervasive
  surveillance. This is important, given the large number of users such
  practices may affect. It is also a stated goal of the IETF to ensure
  that we understand the surveillance concerns related to IETF
  protocols and take appropriate countermeasures <span>[<a href="#RFC7258" class="xref">RFC7258</a>]</span>. This document does that for EAP-AKA'.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">This specification is an optional extension to the EAP-AKA'
  authentication method <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.
  While optional, the use of this extension is RECOMMENDED.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">The extension, when
  negotiated, provides Forward Secrecy for the session key
  generated as a part of the authentication run in EAP-AKA'.  This
  prevents an attacker who has gained access to the long-term
  pre-shared secret in a SIM card from being able to decrypt any past
  communications. In addition, if the attacker stays merely a passive
  eavesdropper, the extension prevents attacks against future
  sessions. This forces attackers to use active attacks instead. This
  is beneficial, because active attacks demand much more resources to
  launch, and can generally be detected much easier. As
  with other protocols, an active attacker with access to the
  long-term key material will of course be able to attack all future
  communications, but risks detection, particularly if done at
  scale. The attacker
  is forced to attempt to exfiltrate key material, if it can, on a
  continuous basis, as opposed to learning it once <span>[<a href="#RFC7624" class="xref">RFC7624</a>]</span>.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">Attacks against AKA authentication via compromising the long-term
  secrets in the SIM cards have been an active discussion topic in
  many contexts. Forward secrecy is on the list of features
  for the next release of 3GPP (5G Phase 2), and this document provides
  a basis for providing this feature in a particular fashion.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">It should also be noted that 5G network architecture includes the
  use of the EAP framework for authentication. While any methods can
  be run, the default authentication method within that context will
  be EAP-AKA'. As a result, improvements in EAP-AKA' security have a
  potential to improve security for large number of users.<a href="#section-1-7" class="pilcrow">¶</a></p>
</section>
<section id="section-2">
      <h2 id="name-protocol-design-and-deploym">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-protocol-design-and-deploym" class="section-name selfRef">Protocol Design and Deployment Objectives</a>
      </h2>
<p id="section-2-1">This extension specified here re-uses large portions of the
  current structure of 3GPP interfaces and functions, with the
  rationale that this will make the construction more easily adopted.
  In particular, the construction maintains the interface between the
  Universal Subscriber Identification Module (USIM) and the mobile
  terminal intact. As a consequence, there is no need to roll out new
  credentials to existing subscribers. The work is based on an earlier
  paper <span>[<a href="#TrustCom2015" class="xref">TrustCom2015</a>]</span>, and uses much of the same
  material, but applied to EAP rather than the underlying AKA
  method.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">It has been a goal to implement this change as an extension
  of the widely supported EAP-AKA' method, rather than a completely new
  authentication method. The extension is implemented as a set of
  new, optional attributes, that are provided alongside the
  base attributes in EAP-AKA'. Old implementations can ignore
  these attributes, but their presence will nevertheless be verified
  as part of base EAP-AKA' integrity verification process, helping
  protect against bidding down attacks. This extension does
  not increase the number of rounds necessary to complete the
  protocol.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">The use of this extension is at the discretion of the
  authenticating parties. It should be noted that FS and defenses
  against passive attacks are by no means a panacea, but they can
  provide a partial defense that increases the cost and risk
  associated with pervasive surveillance.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">While adding forward secrecy to the existing mobile
  network infrastructure can be done in multiple different ways, the
  authors believe that the approach chosen here is relatively easily
  deployable. In particular:<a href="#section-2-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-2-5.1">As noted above, no new credentials are needed; there is no
    change to SIM cards.<a href="#section-2-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.2">FS property can be incorporated into any current or future
    system that supports EAP, without changing
    any network functions beyond the EAP endpoints.<a href="#section-2-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.3">Key generation happens at the endpoints, enabling highest grade
    key material to be used both by the endpoints and the intermediate
    systems (such as access points that are given access to specific
    keys).<a href="#section-2-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-2-5.4">While EAP-AKA' is just one EAP method, for practical purposes
    forward secrecy being available for both EAP-TLS <span>[<a href="#RFC5216" class="xref">RFC5216</a>]</span> <span>[<a href="#RFC9190" class="xref">RFC9190</a>]</span> and
    EAP-AKA' ensures that for many practical systems forward
    secrecy can be enabled for either all or significant fraction of
    users.<a href="#section-2-5.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
<section id="section-3">
      <h2 id="name-background">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<section id="section-3.1">
        <h3 id="name-aka">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-aka" class="section-name selfRef">AKA</a>
        </h3>
<p id="section-3.1-1">AKA is based on challenge-response mechanisms and symmetric
    cryptography.  AKA typically runs in a UMTS Subscriber Identity
    Module (USIM) or a CDMA2000 (Removable) User Identity Module
    ((R)UIM). In contrast with its earlier GSM counterparts, AKA
    provides long key lengths and mutual authentication.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">AKA works in the following manner:<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.1-3.1">The identity module and the home environment have agreed on a
      secret key beforehand.<a href="#section-3.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.2">The actual authentication process starts by having the home
      environment produce an authentication vector, based on the secret
      key and a sequence number.  The authentication vector contains a
      random part RAND, an authenticator part AUTN used for
      authenticating the network to the identity module, an expected
      result part XRES, a 128-bit session key for integrity check IK,
      and a 128-bit session key for encryption CK.<a href="#section-3.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.3">The authentication vector is passed to the serving network, which
      uses it to authenticate the device.<a href="#section-3.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.4">The RAND and the AUTN are delivered to the identity module.<a href="#section-3.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.5">The identity module verifies the AUTN, again based on the secret
      key and the sequence number.  If this process is successful (the
      AUTN is valid and the sequence number used to generate AUTN is
      within the correct range), the identity module produces an
      authentication result RES and sends it to the serving network.<a href="#section-3.1-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.1-3.6">The serving network verifies the correct result from the identity
      module.  If the result is correct, IK and CK can be used to
      protect further communications between the identity module and the
      home environment.<a href="#section-3.1-3.6" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-3.2">
        <h3 id="name-eap-aka-protocol">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-eap-aka-protocol" class="section-name selfRef">EAP-AKA' Protocol</a>
        </h3>
<p id="section-3.2-1">When AKA are embedded into EAP, the authentication on
    the network side is moved to the home environment; the serving
    network performs the role of a pass-through authenticator.
    Figure 1 describes the basic flow in the EAP-AKA'
    authentication process. The definition of the full protocol
    behaviour, along with the definition of attributes AT_RAND,
    AT_AUTN, AT_MAC, and AT_RES can be found in <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span> and <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3.2-2">
<pre>
 Peer                                                    Server
    |                      EAP-Request/Identity             |
    |&lt;------------------------------------------------------|
    |                                                       |
    | EAP-Response/Identity                                 |
    | (Includes user's Network Access Identifier, NAI)      |
    |------------------------------------------------------&gt;|
    |         +-------------------------------------------------+
    |         | Server determines the network name and ensures  |
    |         | that the given access network is authorized to  |
    |         | use the claimed name. The server then runs the  |
    |         | AKA' algorithms generating RAND and AUTN,       |
    |         | derives session keys from CK' and IK'. RAND and |
    |         | AUTN are sent as AT_RAND and AT_AUTN attributes,|
    |         | whereas the network name is transported in the  |
    |         | AT_KDF_INPUT attribute. AT_KDF signals the used |
    |         | key derivation function. The session keys are   |
    |         | used in creating the AT_MAC attribute.          |
    |         +-------------------------------------------------+
    |                        EAP-Request/AKA'-Challenge     |
    |       (AT_RAND, AT_AUTN, AT_KDF, AT_KDF_INPUT, AT_MAC)|
    |&lt;------------------------------------------------------|
+-----------------------------------------------------+     |
| The peer determines what the network name should be,|     |
| based on, e.g.,  what access technology it is using.|     |
| The peer also retrieves the network name sent by    |     |
| the network from the AT_KDF_INPUT attribute. The    |     |
| two names are compared for discrepancies, and if    |     |
| necessary, the authentication is aborted. Otherwise,|     |
| the network name from AT_KDF_INPUT attribute is     |     |
| used in running the AKA' algorithms, verifying AUTN |     |
| from AT_AUTN and MAC from AT_MAC attributes. The    |     |
| peer then generates RES. The peer also derives      |     |
| session keys from CK'/IK'. The AT_RES and AT_MAC    |     |
| attributes are constructed.                         |     |
+-----------------------------------------------------+     |
    | EAP-Response/AKA'-Challenge                           |
    | (AT_RES, AT_MAC)                                      |
    |------------------------------------------------------&gt;|
    |         +-------------------------------------------------+
    |         | Server checks the RES and MAC values received   |
    |         | in AT_RES and AT_MAC, respectively. Success     |
    |         | requires both to be found correct.              |
    |         +-------------------------------------------------+
    |                                          EAP-Success  |
    |&lt;------------------------------------------------------|

           Figure 1: EAP-AKA' Authentication Process
</pre><a href="#section-3.2-2" class="pilcrow">¶</a>
</div>
</section>
<div id="attacks">
<section id="section-3.3">
        <h3 id="name-attacks-against-long-term-s">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-attacks-against-long-term-s" class="section-name selfRef">Attacks Against Long-Term Shared Secrets in Smart Cards</a>
        </h3>
<p id="section-3.3-1">Current 3GPP systems use SIM pre-shared key based protocols
    and Authentication and Key Agreement (AKA) to authenticate
    subscribers. The general security properties and potential
    vulnerabilities of AKA and EAP-AKA' are discussed in <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">An important vulnerability in that discussion relates to the
    recent reports of compromised long term pre-shared keys used in
    AKA <span>[<a href="#Heist2015" class="xref">Heist2015</a>]</span>. These attacks are not specific to
    AKA or EAP-AKA', as all security systems fail at least to some
    extent if key material is stolen. However, the reports indicate a
    need to look into solutions that can operate at least to an extent
    under these types of attacks. It is noted in <span>[<a href="#Heist2015" class="xref">Heist2015</a>]</span> that some security can be retained even in
    the face of the attacks by providing Forward Secrecy
    (FS) <span>[<a href="#DOW1992" class="xref">DOW1992</a>]</span> for the session key. If AKA would
    have provided FS, compromising the pre-shared key would not be
    sufficient to perform passive attacks; the attacker is, in
    addition, forced to be a Man-In-The-Middle (MITM) during the AKA
    run and subsequent communication between the parties.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="section-4">
      <h2 id="name-requirements-language-2">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-requirements-language-2" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-4-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
  "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
  "OPTIONAL" in this document are to be interpreted as described in BCP
  14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only
  when, they appear in all capitals, as shown here.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5">
      <h2 id="name-protocol-overview">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-5-1">Introducing FS for EAP-AKA' can be achieved by using an Elliptic
  Curve Diffie-Hellman (ECDH) exchange <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.  In
  EAP-AKA' FS this exchange is run in an ephemeral manner, i.e.,
  both sides generate temporary keys as specified in <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.
  This method is referred to as ECDHE, where the last 'E' stands
  for Ephemeral.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The enhancements in the EAP-AKA' FS protocol are compatible
  with the signaling flow and other basic structures of both AKA and
  EAP-AKA'. The intent is to implement the enhancement as optional
  attributes that legacy implementations can ignore.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">The purpose of the protocol is to achieve mutual authentication
  between the EAP server and peer, and to establish keying material
  for secure communication between the two.  This document specifies
  the calculation of key material, providing new properties that are
  not present in key material provided by EAP-AKA' in its original
  form.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Figure 2 below describes the overall process. Since our goal
  has been to not require new infrastructure or credentials, the
  flow diagrams also show the conceptual interaction with the USIM card
  and the 3GPP authentication server (HSS). The details of those
  interactions
  are outside the scope of this document, however, and the reader
  is referred to the 3GPP specifications .<a href="#section-5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-5-5">
<pre>
  USIM             Peer                     Server          HSS
    |               |                          |             |
    |               |    EAP-Req/Identity      |             |
    |               |&lt;-------------------------|             |
    |               |                          |             |
    |               |    EAP-Resp/Identity     |             |
    |               |-------------------------&gt;|             |
    |               |                          |             |
    |         +-------------------------------------------------+
    |         | Server now has an identity for the peer.        |
    |         | The server then asks the help of                |
    |         | HSS to run AKA algorithms, generating RAND,     |
    |         | AUTN, XRES, CK, IK. Typically, the HSS performs |
    |         | the first part of key derivations so that the   |
    |         | authentication server gets the CK' and IK' keys |
    |         | already tied to a particular network name.      |
    |         +-------------------------------------------------+
    |               |                          |             |
    |               |                          | ID,         |
    |               |                          | key deriv.  |
    |               |                          | function,   |
    |               |                          | network name|
    |               |                          |------------&gt;|
    |               |                          |             |
    |               |                          | RAND, AUTN, |
    |               |                          | XRES, CK',  |
    |               |                          | IK'         |
    |               |                          |&lt;------------|
    |               |                          |             |
    |         +-------------------------------------------------+
    |         | Server now has the needed authentication vector.|
    |         | It generates an ephemeral key pair, sends the   |
    |         | public key of that key pair and the first EAP   |
    |         | method message to the peer. In the message the  |
    |         | AT_PUB_ECDHE attribute carries the public key   |
    |         | and the AT_KDF_FS attribute carries other FS-   |
    |         | related parameters. Both of these are skippable |
    |         | attributes that can be ignored if the peer does |
    |         | not support this extension.                     |
    |         +-------------------------------------------------+
    |               |                          |             |
    |               | EAP-Req/AKA'-Challenge   |             |
    |               | AT_RAND, AT_AUTN, AT_KDF,|             |
    |               | AT_KDF_FS, AT_KDF_INPUT, |             |
    |               | AT_PUB_ECDHE, AT_MAC     |             |
    |               |&lt;-------------------------|             |
+-----------------------------------------------------+      |
| The peer checks if it wants to do the FS extension.|      |
| If yes, it will eventually respond with AT_PUB_ECDHE|      |
| and AT_MAC. If not, it will ignore AT_PUB_ECDHE and |      |
| AT_KDF_FS and base all calculations on basic        |      |
| EAP-AKA' attributes, continuing just as in EAP-AKA' |      |
| per RFC 5448 (draft-ietf-emu-rfc5448bis) rules.     |      |
| In any case, the peer needs to query the auth       |      |
| parameters from the USIM card.                      |      |
+-----------------------------------------------------+      |
    |               |                          |             |
    |  RAND, AUTN   |                          |             |
    |&lt;---------------|                         |             |
    |               |                          |             |
    |  CK, IK, RES  |                          |             |
    |--------------&gt;|                          |             |
    |               |                          |             |
+-----------------------------------------------------+      |
| The peer now has everything to respond. If it wants |      |
| to participate in the FS extension, it will then    |      |
| generate its key pair, calculate a shared key based |      |
| on its key pair and the server's public key.        |      |
| Finally, it proceeds to derive all EAP-AKA' key     |      |
| values and and constructs a full response.          |      |
+-----------------------------------------------------+      |
    |               |                          |             |
    |               | EAP-Resp/AKA'-Challenge  |             |
    |               | AT_RES, AT_PUB_ECDHE,    |             |
    |               | AT_MAC                   |             |
    |               |-------------------------&gt;|             |
    |         +-------------------------------------------------+
    |         | The server now has all the necessary values.    |
    |         | It generates the ECDHE shared secret            |
    |         | and checks the RES and MAC values received      |
    |         | in AT_RES and AT_MAC, respectively. Success     |
    |         | requires both to be found correct. Note that    |
    |         | when this specification is used, the keys       |
    |         | generated from EAP-AKA' are based on both       |
    |         | CK/IK as well as the ECDHE value. Even if there |
    |         | was an attacker who held the long-term secret   |
    |         | keys, only an active attacker could have        |
    |         | determined the generated session keys; in basic |
    |         | EAP-AKA' the keys are only based on CK and IK.  |
    |         +-------------------------------------------------+
    |               |                          |             |
    |               | EAP-Success              |             |
    |               |&lt;-------------------------|             |

           Figure 2: EAP-AKA' FS Authentication Process
</pre><a href="#section-5-5" class="pilcrow">¶</a>
</div>
</section>
<section id="section-6">
      <h2 id="name-extensions-to-eap-aka">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-extensions-to-eap-aka" class="section-name selfRef">Extensions to EAP-AKA'</a>
      </h2>
<div id="at_pub_dh">
<section id="section-6.1">
        <h3 id="name-at_pub_ecdhe">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-at_pub_ecdhe" class="section-name selfRef">AT_PUB_ECDHE</a>
        </h3>
<p id="section-6.1-1">The AT_PUB_ECDHE carries an ECDHE value.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The format of the AT_PUB_ECDHE attribute is shown below.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.1-3">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | AT_PUB_ECDHE  | Length        |    Value ...                  |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre><a href="#section-6.1-3" class="pilcrow">¶</a>
</div>
<p id="section-6.1-4">The fields are as follows:<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.1-5">
          <dt id="section-6.1-5.1">AT_PUB_ECDHE</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-5.2">This is set to TBA1 BY
           IANA.<a href="#section-6.1-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.3">Length</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-5.4">The length of the
           attribute, set as other attributes in EAP-AKA <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>.<a href="#section-6.1-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.1-5.5">Value</dt>
          <dd style="margin-left: 1.5em" id="section-6.1-5.6">
            <p id="section-6.1-5.6.1">This value is
           the sender's ECDHE public value. It is calculated as follows:<a href="#section-6.1-5.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-5.6.2.1">For X25519/Curve25519,
           the length of this value is 32 bytes, encoded in binary as specified
           <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> Section 6.1.<a href="#section-6.1-5.6.2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.1-5.6.2.2">For P-256, the length of this value is 33 bytes, encoded
           in binary as specified in <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>, using
           the compressed form from Section 2.7.1 of
           <span>[<a href="#SEC2" class="xref">SEC2</a>]</span>.<a href="#section-6.1-5.6.2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-6.1-5.6.3">

           To retain the security of the keys, the sender SHALL generate
           a fresh value for each run of the protocol.<a href="#section-6.1-5.6.3" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="at_kdf_dh">
<section id="section-6.2">
        <h3 id="name-at_kdf_fs">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-at_kdf_fs" class="section-name selfRef">AT_KDF_FS</a>
        </h3>
<p id="section-6.2-1">The AT_KDF_FS indicates the used or desired key
         generation function, if the Forward Secrecy extension
         is taken into use. It will also at the same time indicate the
         used or desired ECDHE group. A new attribute is needed to
         carry this information, as AT_KDF carries the legacy KDF
         value for those EAP peers that cannot or do not want to use
         this extension.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">The format of the AT_KDF_FS attribute is shown below.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.2-3">
<pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   | AT_KDF_FS     | Length        |    Key Derivation Function    |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre><a href="#section-6.2-3" class="pilcrow">¶</a>
</div>
<p id="section-6.2-4">The fields are as follows:<a href="#section-6.2-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2-5">
          <dt id="section-6.2-5.1">AT_KDF_FS</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-5.2">This is set to TBA2 BY
           IANA.<a href="#section-6.2-5.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-5.3">Length</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-5.4">The length of the
           attribute, MUST be set to 1.<a href="#section-6.2-5.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-5.5">Key Derivation Function</dt>
          <dd style="margin-left: 1.5em" id="section-6.2-5.6">An
           enumerated value representing the key derivation function that the
           server (or peer) wishes to use. See <a href="#kdf2" class="xref">Section 6.3</a> for the functions
           specified in this document. Note: This field has a
           different name space than the similar field in the AT_KDF
           attribute Key Derivation Function defined in <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.<a href="#section-6.2-5.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.2-6">Servers MUST send one or more AT_KDF_FS attributes in the
         EAP-Request/AKA'-Challenge message. These attributes represent the desired
         functions ordered by preference, the most preferred function being the first
         attribute. The most preferred function is the only one that the server includes a
         public key value for, however. So for a set of AT_KDF_FS attributes, there is
         always only one AT_PUB_ECDHE attribute.<a href="#section-6.2-6" class="pilcrow">¶</a></p>
<p id="section-6.2-7">Upon receiving a set of these attributes:<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.2-8.1">If the peer supports and is willing to use the key derivation function
    indicated by the first AT_KDF_FS attribute, and is willing and able to use the
    extension defined in this specification, the function is taken into use without
    any further negotiation.<a href="#section-6.2-8.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-8.2">If the peer does not support this function or is unwilling to use it, it
    responds to the server with an indication that a different function is
    needed. Similarly with the negotiation process defined in <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span> for AT_KDF, the peer sends
    EAP-Response/AKA'-Challenge message that contains only one attribute,
    AT_KDF_FS with the value set to the desired alternative function from among
    the ones suggested by the server earlier. If there is no suitable alternative,
    the peer has a choice of either falling back to EAP-AKA' or behaving as if AUTN
    had been incorrect and failing authentication (see Figure 3 of <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>). The peer MUST fail the authentication if there are any
    duplicate values within the list of AT_KDF_FS attributes (except where the
    duplication is due to a request to change the key derivation function; see
    below for further information).<a href="#section-6.2-8.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.2-8.3">If the peer does not recognize the extension defined in this specification
           or is unwilling to use it, it ignores the AT_KDF_FS attribute.<a href="#section-6.2-8.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.2-9">Upon receiving an EAP-Response/AKA'-Challenge with AT_KDF_FS from the
         peer, the server checks that the suggested AT_KDF_FS value was one of the
         alternatives in its offer. The first AT_KDF_FS value in the message from
         the server is not a valid alternative. If the peer has replied with
         the first AT_KDF_FS value, the server behaves as if AT_MAC of the
         response had been incorrect and fails the authentication. For an
         overview of the failed authentication process in the server side, see
         Section 3 and Figure 2 in <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>. Otherwise, the
         server re-sends the EAP-Response/AKA'-Challenge message, but adds the
         selected alternative to the beginning of the list of AT_KDF_FS
         attributes, and retains the entire list following it. Note that this
         means that the selected alternative appears twice in the set of AT_KDF
         values. Responding to the peer's request to change the key derivation
         function is the only legal situation where such duplication may
         occur.<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<p id="section-6.2-10">When the peer receives the new EAP-Request/AKA'-Challenge message,
         it MUST check that the requested change, and only the requested change
         occurred in the list of AT_KDF_FS attributes. If yes, it continues.  If
         not, it behaves as if AT_MAC had been incorrect and fails the
         authentication. If the peer receives multiple
         EAP-Request/AKA'-Challenge messages with differing AT_KDF_FS attributes
         without having requested negotiation, the peer MUST behave as if
         AT_MAC had been incorrect and fail the authentication.<a href="#section-6.2-10" class="pilcrow">¶</a></p>
</section>
</div>
<div id="kdf2">
<section id="section-6.3">
        <h3 id="name-new-key-derivation-function">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-new-key-derivation-function" class="section-name selfRef">New Key Derivation Functions</a>
        </h3>
<p id="section-6.3-1">Two new Key Derivation Function types are defined for
         "EAP-AKA' with ECDHE and X25519", represented by value 1, and
         "EAP-AKA' with ECDHE and P-256", represented by
         value 2. These represent a particular choice of key
         derivation function and at the same time selects an ECDHE
         group to be used.

         The Key Derivation Function type value is only used
         in the AT_KDF_FS attribute, and should not be confused with
         the different range of key derivation functions that can be
         represented in the AT_KDF attribute as defined in <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">Key derivation in this extension produces exactly the same
         keys for internal use within one authentication run as <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span> EAP-AKA' does.  For
         instance, K_aut that is used in AT_MAC is still exactly as it
         was in EAP-AKA'. The only change to key derivation is in
         re-authentication keys and keys exported out of the EAP
         method, MSK and EMSK. As a result, EAP-AKA' attributes such
         as AT_MAC continue to be usable even when this extension is
         in use.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">When the Key Derivation Function field in the AT_KDF_FS
         attribute is set to 1 and the Key Derivation Function field
         in the AT_KDF attribute is also set to 1, the Master Key (MK) is
         derived as follows below.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.3-4">
<pre>
       MK       = PRF'(IK'|CK',"EAP-AKA'"|Identity)
       MK_ECDHE = PRF'(IK'|CK'|SHARED_SECRET,"EAP-AKA' FS"|Identity)
       K_encr   = MK[0..127]
       K_aut    = MK[128..383]
       K_re     = MK_ECDHE[0..255]
       MSK      = MK_ECDHE[256..767]
       EMSK     = MK_ECDHE[768..1279]
</pre><a href="#section-6.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3-5">Where SHARED_SECRET is the shared secret computed via
  ECDHE, as specified in Section 6.1 of 
  
  Both the peer and the server MAY check for zero-value shared
  secret as specified in Section 6.1 of 

  The rest of computation proceeds as
  defined in Section 3.3 of <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>.
  <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>. If such checking is performed and the SHARED_SECRET has a zero value, both
  parties MUST behave as if the current EAP-AKA' authentication
  process starts again from the beginning.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-6.3-6.1">Note: The way that shared secret is tested for zero can,
    if performed inappropriately, provide an ability for
    attackers to listen to CPU power usage side channels. Refer
    to <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span> for a description of how to
    perform this check in a way that it does not become a
    problem.<a href="#section-6.3-6.1" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.3-7">
  <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.<a href="#section-6.3-7" class="pilcrow">¶</a></p>
<p id="section-6.3-8">For readability, an explanation of the notation used above
            is copied here: [n..m] denotes the substring from bit n to m.
            PRF' is a new pseudo-random function specified in <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.  K_encr is the encryption key, 128 bits,
            K_aut is the authentication key, 256 bits, K_re is the
            re-authentication key, 256 bits, MSK is the Master Session
            Key, 512 bits, and EMSK is the Extended Master Session Key,
            512 bits. MSK and EMSK are outputs from a successful EAP
            method run <span>[<a href="#RFC3748" class="xref">RFC3748</a>]</span>.<a href="#section-6.3-8" class="pilcrow">¶</a></p>
<p id="section-6.3-9">CK and IK are produced by the AKA algorithm. IK' and CK'
         are derived as specified in <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span> from IK
         and CK.<a href="#section-6.3-9" class="pilcrow">¶</a></p>
<p id="section-6.3-10">The value "EAP-AKA'" is an eight-characters-long ASCII string.  It is
         used as is, without any trailing NUL characters. Similarly,
         "EAP-AKA' FS" is an eleven-characters-long ASCII string, also
         used as is.<a href="#section-6.3-10" class="pilcrow">¶</a></p>
<p id="section-6.3-11">Identity is the peer identity as specified in Section 7 of <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>.<a href="#section-6.3-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="groups">
<section id="section-6.4">
        <h3 id="name-ecdhe-groups">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-ecdhe-groups" class="section-name selfRef">ECDHE Groups</a>
        </h3>
<p id="section-6.4-1">The selection of suitable groups for the elliptic curve
         computation is necessary. The choice of a group is made at
         the same time as deciding to use of particular key derivation
         function in AT_KDF_FS.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<p id="section-6.4-2">For "EAP-AKA' with ECDHE and
         X25519" the group is the Curve25519 group specified in
         <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>. The support for this group is REQUIRED.<a href="#section-6.4-2" class="pilcrow">¶</a></p>
<p id="section-6.4-3">For "EAP-AKA' with ECDHE and P-256" the group is the NIST
         P-256 group (SEC group secp256r1), specified in <span>[<a href="#FIPS186-4" class="xref">FIPS186-4</a>]</span>. The support for this group is
         OPTIONAL.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.5">
        <h3 id="name-message-processing-2">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-message-processing-2" class="section-name selfRef">Message Processing</a>
        </h3>
<p id="section-6.5-1">This section specifies the changes related to message processing
    when this extension is used in EAP-AKA'. It specifies when a
    message may be transmitted or accepted, which attributes are
    allowed in a message, which attributes are required in a message,
    and other message-specific details, where those details are
    different for this extension than the base EAP-AKA' or EAP-AKA
    protocol. Unless otherwise specified here, the rules from <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span> or <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span> apply.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<section id="section-6.5.1">
          <h4 id="name-eap-request-aka-identity">
<a href="#section-6.5.1" class="section-number selfRef">6.5.1. </a><a href="#name-eap-request-aka-identity" class="section-name selfRef">EAP-Request/AKA'-Identity</a>
          </h4>
<p id="section-6.5.1-1">No changes, except that the AT_KDF_FS or AT_PUB_ECDHE attributes
      MUST NOT be added to this message.  The appearance of these
      messages in a received message MUST be ignored.<a href="#section-6.5.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.5.2">
          <h4 id="name-eap-response-aka-identity">
<a href="#section-6.5.2" class="section-number selfRef">6.5.2. </a><a href="#name-eap-response-aka-identity" class="section-name selfRef">EAP-Response/AKA'-Identity</a>
          </h4>
<p id="section-6.5.2-1">No changes, except that the AT_KDF_FS or AT_PUB_ECDHE attributes
      MUST NOT be added to this message.  The appearance of these
      messages in a received message MUST be ignored.<a href="#section-6.5.2-1" class="pilcrow">¶</a></p>
</section>
<div id="procakachall">
<section id="section-6.5.3">
          <h4 id="name-eap-request-aka-challenge">
<a href="#section-6.5.3" class="section-number selfRef">6.5.3. </a><a href="#name-eap-request-aka-challenge" class="section-name selfRef">EAP-Request/AKA'-Challenge</a>
          </h4>
<p id="section-6.5.3-1">The server sends the EAP-Request/AKA'-Challenge on full authentication
      as specified by <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span> and <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.
      The attributes AT_RAND, AT_AUTN, and AT_MAC MUST be included and
      checked on reception as specified
      in <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>. They are also necessary
      for backwards compatibility.<a href="#section-6.5.3-1" class="pilcrow">¶</a></p>
<p id="section-6.5.3-2">In EAP-Request/AKA'-Challenge, there is no message-specific
      data covered by the MAC for the AT_MAC attribute. The AT_KDF_FS
      and AT_PUB_ECDHE attributes MUST be included. The AT_PUB_ECDHE
      attribute carries the server's public Diffie-Hellman key. If
      either AT_KDF_FS or AT_PUB_ECDHE is missing on reception, the peer
      MUST treat them as if neither one was sent, and the assume that
      the extension defined in this specification is not in use.<a href="#section-6.5.3-2" class="pilcrow">¶</a></p>
<p id="section-6.5.3-3">The AT_RESULT_IND, AT_CHECKCODE, AT_IV, AT_ENCR_DATA, AT_PADDING,
      AT_NEXT_PSEUDONYM, AT_NEXT_REAUTH_ID and other attributes may be
      included as specified in Section 9.3 of <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>.<a href="#section-6.5.3-3" class="pilcrow">¶</a></p>
<p id="section-6.5.3-4">When processing this message, the peer MUST process AT_RAND,
      AT_AUTN, AT_KDF_FS, AT_PUB_ECDHE before processing other attributes.
      Only if these attributes are verified to be valid, the peer
      derives keys and verifies AT_MAC.  If the peer is unable or
      unwilling to perform the extension specified in this document,
      it proceeds as defined in <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>. Finally, the
      operation in case an error occurs is specified in Section
      6.3.1. of <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>.<a href="#section-6.5.3-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="procakachallresp">
<section id="section-6.5.4">
          <h4 id="name-eap-response-aka-challenge">
<a href="#section-6.5.4" class="section-number selfRef">6.5.4. </a><a href="#name-eap-response-aka-challenge" class="section-name selfRef">EAP-Response/AKA'-Challenge</a>
          </h4>
<p id="section-6.5.4-1">The peer sends EAP-Response/AKA'-Challenge in response to a
      valid EAP-Request/AKA'-Challenge message, as specified by <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span> and <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.
      If the peer supports and is willing to perform the extension
      specified in this protocol, and the server had made a valid
      request involving the attributes specified in <a href="#procakachall" class="xref">Section 6.5.3</a>, the peer responds per the rules
      specified below. Otherwise, the peer responds as specified in
      <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span> and <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span> and ignores the attributes
      related to this extension. If the peer has not received
      attributes related to this extension from the Server, and has a
      policy that requires it to always use this extension, it behaves
      as if AUTN had been incorrect and fails the authentication.<a href="#section-6.5.4-1" class="pilcrow">¶</a></p>
<p id="section-6.5.4-2">The AT_MAC attribute MUST be included and checked as
      specified in <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>. In
      EAP-Response/AKA'-Challenge, there is no message-specific data
      covered by the MAC. The AT_PUB_ECDHE attribute MUST be included,
      and carries the peer's public Diffie-Hellman key.<a href="#section-6.5.4-2" class="pilcrow">¶</a></p>
<p id="section-6.5.4-3">The AT_RES attribute MUST be included and checked as
      specified in <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>.  When processing this
      message, the Server MUST process AT_RES before processing other
      attributes.  Only if these attribute is verified to be valid,
      the Server derives keys and verifies AT_MAC.<a href="#section-6.5.4-3" class="pilcrow">¶</a></p>
<p id="section-6.5.4-4">If the Server has proposed the use of the extension specified
      in this protocol, but the peer ignores and continues the basic
      EAP-AKA' authentication, the Server makes policy decision of
      whether this is allowed. If this is allowed, it continues the
      EAP-AKA' authentication to completion. If it is not allowed, the
      Server MUST behave as if authentication failed.<a href="#section-6.5.4-4" class="pilcrow">¶</a></p>
<p id="section-6.5.4-5">The AT_CHECKCODE, AT_RESULT_IND, AT_IV, AT_ENCR_DATA and other
      attributes may be included as specified in Section 9.4 of <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span>.<a href="#section-6.5.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="reauth">
<section id="section-6.5.5">
          <h4 id="name-eap-request-aka-reauthentic">
<a href="#section-6.5.5" class="section-number selfRef">6.5.5. </a><a href="#name-eap-request-aka-reauthentic" class="section-name selfRef">EAP-Request/AKA'-Reauthentication</a>
          </h4>
<p id="section-6.5.5-1">No changes, but note that the re-authentication process
      uses the keys generated in the original EAP-AKA' authentication,
      which, if the extension specified in this documents is in use,
      employs key material from the Diffie-Hellman procedure.<a href="#section-6.5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.5.6">
          <h4 id="name-eap-response-aka-reauthenti">
<a href="#section-6.5.6" class="section-number selfRef">6.5.6. </a><a href="#name-eap-response-aka-reauthenti" class="section-name selfRef">EAP-Response/AKA'-Reauthentication</a>
          </h4>
<p id="section-6.5.6-1">No changes, but as discussed in <a href="#reauth" class="xref">Section 6.5.5</a>,
      re-authentication is based on the key material generated by
      EAP-AKA' and the extension defined in this document.<a href="#section-6.5.6-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.5.7">
          <h4 id="name-eap-response-aka-synchroniz">
<a href="#section-6.5.7" class="section-number selfRef">6.5.7. </a><a href="#name-eap-response-aka-synchroniz" class="section-name selfRef">EAP-Response/AKA'-Synchronization-Failure</a>
          </h4>
<p id="section-6.5.7-1">No changes, except that the AT_KDF_FS or AT_PUB_ECDHE
      attributes MUST NOT be added to this message.
      The appearance of these messages in a received message MUST be ignored.<a href="#section-6.5.7-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.5.8">
          <h4 id="name-eap-response-aka-authentica">
<a href="#section-6.5.8" class="section-number selfRef">6.5.8. </a><a href="#name-eap-response-aka-authentica" class="section-name selfRef">EAP-Response/AKA'-Authentication-Reject</a>
          </h4>
<p id="section-6.5.8-1">No changes, except that the AT_KDF_FS or AT_PUB_ECDHE
      attributes MUST NOT be added to this message.
      The appearance of these messages in a received message MUST be ignored.<a href="#section-6.5.8-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.5.9">
          <h4 id="name-eap-response-aka-client-err">
<a href="#section-6.5.9" class="section-number selfRef">6.5.9. </a><a href="#name-eap-response-aka-client-err" class="section-name selfRef">EAP-Response/AKA'-Client-Error</a>
          </h4>
<p id="section-6.5.9-1">No changes, except that the AT_KDF_FS or AT_PUB_ECDHE
      attributes MUST NOT be added to this message.
      The appearance of these messages in a received message MUST be ignored.<a href="#section-6.5.9-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.5.10">
          <h4 id="name-eap-request-aka-notificatio">
<a href="#section-6.5.10" class="section-number selfRef">6.5.10. </a><a href="#name-eap-request-aka-notificatio" class="section-name selfRef">EAP-Request/AKA'-Notification</a>
          </h4>
<p id="section-6.5.10-1">No changes.<a href="#section-6.5.10-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.5.11">
          <h4 id="name-eap-response-aka-notificati">
<a href="#section-6.5.11" class="section-number selfRef">6.5.11. </a><a href="#name-eap-response-aka-notificati" class="section-name selfRef">EAP-Response/AKA'-Notification</a>
          </h4>
<p id="section-6.5.11-1">No changes.<a href="#section-6.5.11-1" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<section id="section-7">
      <h2 id="name-security-considerations-6">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations-6" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">This section deals only with the changes to security considerations
    as they differ from EAP-AKA', or as new information has been gathered
    since the publication of <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">The possibility of attacks against key storage offered in SIM or
    other smart cards has been a known threat. But as the discussion in
    <a href="#attacks" class="xref">Section 3.3</a> shows, the likelihood of practically
    feasible attacks has increased. Many of these attacks can be best
    dealt with improved processes, e.g., limiting the access to the key
    material within the factory or personnel, etc. But not all attacks can
    be entirely ruled out for well-resourced adversaries, irrespective
    of what the technical algorithms and protection measures are.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">This extension can provide assistance in situations where there
    is a danger of attacks against the key material on SIM cards by
    adversaries that can not or who are unwilling to mount active
    attacks against large number of sessions. This extension is most
    useful when used in a context where EAP keys are used without
    further mixing that can provide Forward Secrecy.  For
    instance, when used with IKEv2 <span>[<a href="#RFC7296" class="xref">RFC7296</a>]</span>, the
    session keys produced by IKEv2 have this property, so better
    characteristics of EAP keys is not that useful. However, typical
    link layer usage of EAP does not involve running Diffie-Hellman,
    so using EAP to authenticate access to a network is one situation
    where the extension defined in this document can be helpful.<a href="#section-7-3" class="pilcrow">¶</a></p>
<p id="section-7-4">This extension generates keying material using the ECDHE
    exchange in order to gain the FS property. This means that once
    an EAP-AKA' authentication run ends, the session that it was used
    to protect is closed, and the corresponding keys are forgotten,
    even someone who has recorded all of the data from the
    authentication run and session and gets access to all of the AKA
    long-term keys cannot reconstruct the keys used to protect the
    session or any previous session, without doing a brute force
    search of the session key space.<a href="#section-7-4" class="pilcrow">¶</a></p>
<p id="section-7-5">Even if a compromise of the long-term keys has occurred, FS is
    still provided for all future sessions, as long as the attacker
    does not become an active attacker. Of course, as with other
    protocols, if the attacker has learned the keys and does become an
    active attacker, there is no protection that that can be provided
    for future sessions. Among other things, such an active attacker
    can impersonate any legitimate endpoint in EAP-AKA', become a
    MITM in EAP-AKA' or the extension defined in this
    document, retrieve all keys, or turn off FS. Still, past sessions
    where FS was in use remain protected.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">Achieving FS requires that when a connection is closed, each
    endpoint MUST forget not only the ephemeral keys used by the
    connection but also any information that could be used to
    recompute those keys.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">The following security properties of
    EAP-AKA' are impacted through this extension:<a href="#section-7-7" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-7-8">
        <dt id="section-7-8.1">Protected ciphersuite negotiation</dt>
        <dd style="margin-left: 1.5em" id="section-7-8.2">
          <p id="section-7-8.2.1">
      
      EAP-AKA' has a negotiation mechanism for selecting the key
      derivation functions, and this mechanism has been extended by
      the extension specified in this document.  The resulting
      mechanism continues to be secure against bidding down
      attacks.<a href="#section-7-8.2.1" class="pilcrow">¶</a></p>
<p id="section-7-8.2.2">

      There are two specific needs in the negotiation mechanism:<a href="#section-7-8.2.2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-7-8.2.3">
            <dt id="section-7-8.2.3.1">Negotiating key derivation function within the extension</dt>
            <dd style="margin-left: 1.5em" id="section-7-8.2.3.2">
        The negotiation mechanism allows changing the offered key
        derivation function, but the change is visible in the final EAP-
        Request/AKA'-Challenge message that the server sends to the peer.
        This message is authenticated via the AT_MAC attribute, and
        carries both the chosen alternative and the initially offered
        list.  The peer refuses to accept a change it did not initiate.
        As a result, both parties are aware that a change is being made
        and what the original offer was.<a href="#section-7-8.2.3.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
<dt id="section-7-8.2.3.3">Negotiating the use of this extension</dt>
            <dd style="margin-left: 1.5em" id="section-7-8.2.3.4">
              <p id="section-7-8.2.3.4.1"> This extension is offered by the server
        through presenting the AT_KDF_FS and AT_PUB_ECDHE attributes in
        the EAP-Request/AKA'-Challenge message. These attributes are
        protected by AT_MAC, so attempts to change or omit them by an
        adversary will be detected.<a href="#section-7-8.2.3.4.1" class="pilcrow">¶</a></p>
<p id="section-7-8.2.3.4.2">

 Except of course, if the adversary holds the long-term shared
 secret and is willing to engage in an active attack. Such an
 attack can, for instance, forge the negotiation process so
 that no FS will be provided. However, as noted above, an
 attacker with these capabilities will in any case be able to
 impersonate any party in the protocol and perform MITM
 attacks. That is not a situation that can be improved by a
 technical solution. However, as discussed in the introduction,
 even an attacker with access to the long-term keys is required
 to be a MITM on each AKA run and subsequent communication,
 which makes mass surveillance more laborous.<a href="#section-7-8.2.3.4.2" class="pilcrow">¶</a></p>
<p id="section-7-8.2.3.4.3">
 
 The security properties of the extension also depend on a
 policy choice. As discussed in <a href="#procakachallresp" class="xref">Section 6.5.4</a>, both the peer and the server make
 a policy decision of what to do when it was willing to peform
 the extension specified in this protocol, but the other side
 does not wish to use the extension. Allowing this has the
 benefit of allowing backwards compatibility to equipment that
 did not yet support the extension. When the extension is not
 supported or negotiated by the parties, no FS can obviously
 provided.<a href="#section-7-8.2.3.4.3" class="pilcrow">¶</a></p>
<p id="section-7-8.2.3.4.4">
 
 If turning off the extension specified in this protocol is not
 allowed by policy, the use of legacy equipment that does not
 support this protocol is no longer possible. This may be
 appropriate when, for instance, support for the extension is
 sufficiently widespread, or required in a particular version
 of a mobile network.<a href="#section-7-8.2.3.4.4" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
</dl>
</dd>
        <dd class="break"></dd>
<dt id="section-7-8.3">Key derivation</dt>
        <dd style="margin-left: 1.5em" id="section-7-8.4">
          <p id="section-7-8.4.1">
      
      This extension provides key material that is based on
      the Diffie-Hellman keys, yet bound to the authentication
      through the SIM card. This means that subsequent payload communications between
      the parties are protected with keys that are not solely based on
      information in the clear (such as the RAND) and information
      derivable from the long-term shared secrets on the SIM
      card. As a result, if anyone successfully recovers
      shared secret information, they are unable to decrypt
      communications protected by the keys generated through this
      extension. Note that the recovery of shared secret information
      could occur either before or after the time that the protected
      communications are used. When this extension is used,
      communications at time t0 can be protected if at some later time
      t1 an adversary learns of long-term shared secret and has access
      to a recording of the encrypted communications.<a href="#section-7-8.4.1" class="pilcrow">¶</a></p>
<p id="section-7-8.4.2">Obviously, this extension is still
      vulnerable to attackers that are willing to perform an active
      attack and who at the time of the attack have access to the
      long-term shared secret.<a href="#section-7-8.4.2" class="pilcrow">¶</a></p>
<p id="section-7-8.4.3">

      This extension does not change the properties related to
      re-authentication. No new Diffie-Hellman run is performed during
      the re-authentication allowed by EAP-AKA'. However, if this
      extension was in use when the original EAP-AKA' authentication
      was performed, the keys used for re-authentication (K_re) are
      based on the Diffie-Hellman keys, and hence continue to be
      equally safe against expose of the long-term secrets as the
      original authentication.<a href="#section-7-8.4.3" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-7-9">In addition, it is worthwhile to discuss Denial-of-Service
  attacks and their impact on this protocol. The calculations involved
  in public key cryptography require computing power, which could be
  used in an attack to overpower either the peer or the server. While
  some forms of Denial-of-Service attacks are always possible, the
  following factors help mitigate the concerns relating to public key
  cryptography and EAP-AKA' FS.<a href="#section-7-9" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-10.1">In 5G context, other parts of the connection setup involve
    public key cryptography, so while performing additional operations
    in EAP-AKA' is an additional concern, it does not change the
    overall situation. As a result, the relevant system components
    need to be dimensioned appropriately, and detection and management
    mechanisms to reduce the effect of attacks need to be in
    place.<a href="#section-7-10.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-10.2">This specification is constructed so that a separation
    between the USIM and Peer on client side and the Server and HSS on
    network side is possible. This ensures that the most sensitive (or
    legacy) system components can not be the target of the attack. For
    instance, EAP-AKA' and public key cryptography takes place in the
    phone and not the low-power SIM card.<a href="#section-7-10.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-10.3">EAP-AKA' has been designed so that the first actual message in
    the authentication process comes from the Server, and that this
    message will not be sent unless the user has been identified as
    an active subscriber of the operator in question. While the initial identity
    can be spoofed before authentication has succeeded, this reduces the efficiency of
    an attack.<a href="#section-7-10.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-7-10.4">Finally, this memo specifies an order in which computations and
    checks must occur. When processing the EAP-Request/AKA'-Challenge
    message, for instance, the AKA authentication must be checked and
    succeed before the peer proceeds to calculating or processing the
    FS related parameters (see <a href="#procakachallresp" class="xref">Section 6.5.4</a>). The same is true of
    EAP-Response/AKA'-Challenge (see <a href="#procakachallresp" class="xref">Section 6.5.4</a>). This ensures that the parties need to
    show possession of the long-term secret in some way, and only then
    will the FS calculations become active. This limits the
    Denial-of-Service to specific, identified subscribers. While
    botnets and other forms of malicious parties could take advantage
    of actual subscribers and their key material, at least such
    attacks are (a) limited in terms of subscribers they control, and
    (b) identifiable for the purposes of blocking the affected
    subscribers.<a href="#section-7-10.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
<section id="section-8">
      <h2 id="name-iana-considerations-7">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations-7" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This extension of EAP-AKA' shares its attribute space and subtypes with EAP-SIM
  <span>[<a href="#RFC4186" class="xref">RFC4186</a>]</span>, EAP-AKA <span>[<a href="#RFC4186" class="xref">RFC4186</a>]</span>, and
  EAP-AKA' <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Two new Attribute Type value (TBA1, TBA2) in the skippable
  range need to be assigned for AT_PUB_ECDHE (<a href="#at_pub_dh" class="xref">Section 6.1</a>)
  and AT_KDF_FS (<a href="#at_kdf_dh" class="xref">Section 6.2</a>
  in the EAP-AKA and EAP-SIM Parameters registry under Attribute
  Types.<a href="#section-8-2" class="pilcrow">¶</a></p>
<p id="section-8-3">Also, a new registry should be created to represent
  Diffie-Hellman Key Derivation Function types. The "EAP-AKA' with
  ECDHE and X25519" and "EAP-AKA' with ECDHE and P-256"
  types (1 and 2, see <a href="#kdf2" class="xref">Section 6.3</a>) need to be assigned,
  along with one reserved value. The initial contents of this
  namespace are therefore as below; new values can be created through
  the Specification Required policy <span>[<a href="#RFC8126" class="xref">RFC8126</a>]</span>.<a href="#section-8-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-8-4">
<pre>
Value      Description                         Reference
------   ------------------------------------  ---------------
0        Reserved                              [TBD BY IANA: THIS RFC]
1        EAP-AKA' with ECDHE and X25519        [TBD BY IANA: THIS RFC]
2        EAP-AKA' with ECDHE and P-256         [TBD BY IANA: THIS RFC]
3-65535  Unassigned                            [TBD BY IANA: THIS RFC]
</pre><a href="#section-8-4" class="pilcrow">¶</a>
</div>
</section>
<section id="section-9">
      <h2 id="name-references-7">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references-7" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references-7">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references-7" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3748">[RFC3748]</dt>
        <dd>
<span class="refAuthor">Aboba, B.</span>, <span class="refAuthor">Blunk, L.</span>, <span class="refAuthor">Vollbrecht, J.</span>, <span class="refAuthor">Carlson, J.</span>, and <span class="refAuthor">H. Levkowetz, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol (EAP)"</span>, <span class="seriesInfo">RFC 3748</span>, <span class="seriesInfo">DOI 10.17487/RFC3748</span>, <time datetime="2004-06" class="refDate">June 2004</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3748">https://www.rfc-editor.org/info/rfc3748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4187">[RFC4187]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span> and <span class="refAuthor">H. Haverinen</span>, <span class="refTitle">"Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA)"</span>, <span class="seriesInfo">RFC 4187</span>, <span class="seriesInfo">DOI 10.17487/RFC4187</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4187">https://www.rfc-editor.org/info/rfc4187</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7624">[RFC7624]</dt>
        <dd>
<span class="refAuthor">Barnes, R.</span>, <span class="refAuthor">Schneier, B.</span>, <span class="refAuthor">Jennings, C.</span>, <span class="refAuthor">Hardie, T.</span>, <span class="refAuthor">Trammell, B.</span>, <span class="refAuthor">Huitema, C.</span>, and <span class="refAuthor">D. Borkmann</span>, <span class="refTitle">"Confidentiality in the Face of Pervasive Surveillance: A Threat Model and Problem Statement"</span>, <span class="seriesInfo">RFC 7624</span>, <span class="seriesInfo">DOI 10.17487/RFC7624</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7624">https://www.rfc-editor.org/info/rfc7624</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
        <dd>
<span class="refAuthor">Langley, A.</span>, <span class="refAuthor">Hamburg, M.</span>, and <span class="refAuthor">S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7748">https://www.rfc-editor.org/info/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8126">https://www.rfc-editor.org/info/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9048">[RFC9048]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Lehtovirta, V.</span>, <span class="refAuthor">Torvinen, V.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Improved Extensible Authentication Protocol Method for 3GPP Mobile Network Authentication and Key Agreement (EAP-AKA')"</span>, <span class="seriesInfo">RFC 9048</span>, <span class="seriesInfo">DOI 10.17487/RFC9048</span>, <time datetime="2021-10" class="refDate">October 2021</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9048">https://www.rfc-editor.org/info/rfc9048</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="FIPS186-4">[FIPS186-4]</dt>
        <dd>
<span class="refTitle">"Digital Signature Standard (DSS)"</span>, <time datetime="2013-07" class="refDate">July 2013</time>. </dd>
<dd class="break"></dd>
<dt id="SEC2">[SEC2]</dt>
      <dd>
<span class="refTitle">"SEC 2: Recommended Elliptic Curve Domain Parameters"</span>, <time datetime="2000-09" class="refDate">September 2000</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references-7">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references-7" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC4186">[RFC4186]</dt>
        <dd>
<span class="refAuthor">Haverinen, H., Ed.</span> and <span class="refAuthor">J. Salowey, Ed.</span>, <span class="refTitle">"Extensible Authentication Protocol Method for Global System for Mobile Communications (GSM) Subscriber Identity Modules (EAP-SIM)"</span>, <span class="seriesInfo">RFC 4186</span>, <span class="seriesInfo">DOI 10.17487/RFC4186</span>, <time datetime="2006-01" class="refDate">January 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4186">https://www.rfc-editor.org/info/rfc4186</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5216">[RFC5216]</dt>
        <dd>
<span class="refAuthor">Simon, D.</span>, <span class="refAuthor">Aboba, B.</span>, and <span class="refAuthor">R. Hurst</span>, <span class="refTitle">"The EAP-TLS Authentication Protocol"</span>, <span class="seriesInfo">RFC 5216</span>, <span class="seriesInfo">DOI 10.17487/RFC5216</span>, <time datetime="2008-03" class="refDate">March 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5216">https://www.rfc-editor.org/info/rfc5216</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5448">[RFC5448]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Lehtovirta, V.</span>, and <span class="refAuthor">P. Eronen</span>, <span class="refTitle">"Improved Extensible Authentication Protocol Method for 3rd Generation Authentication and Key Agreement (EAP-AKA')"</span>, <span class="seriesInfo">RFC 5448</span>, <span class="seriesInfo">DOI 10.17487/RFC5448</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5448">https://www.rfc-editor.org/info/rfc5448</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7258">[RFC7258]</dt>
        <dd>
<span class="refAuthor">Farrell, S.</span> and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Pervasive Monitoring Is an Attack"</span>, <span class="seriesInfo">BCP 188</span>, <span class="seriesInfo">RFC 7258</span>, <span class="seriesInfo">DOI 10.17487/RFC7258</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7258">https://www.rfc-editor.org/info/rfc7258</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7296">[RFC7296]</dt>
        <dd>
<span class="refAuthor">Kaufman, C.</span>, <span class="refAuthor">Hoffman, P.</span>, <span class="refAuthor">Nir, Y.</span>, <span class="refAuthor">Eronen, P.</span>, and <span class="refAuthor">T. Kivinen</span>, <span class="refTitle">"Internet Key Exchange Protocol Version 2 (IKEv2)"</span>, <span class="seriesInfo">STD 79</span>, <span class="seriesInfo">RFC 7296</span>, <span class="seriesInfo">DOI 10.17487/RFC7296</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7296">https://www.rfc-editor.org/info/rfc7296</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9190">[RFC9190]</dt>
        <dd>
<span class="refAuthor">Preuß Mattsson, J.</span> and <span class="refAuthor">M. Sethi</span>, <span class="refTitle">"EAP-TLS 1.3: Using the Extensible Authentication Protocol with TLS 1.3"</span>, <span class="seriesInfo">RFC 9190</span>, <span class="seriesInfo">DOI 10.17487/RFC9190</span>, <time datetime="2022-02" class="refDate">February 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc9190">https://www.rfc-editor.org/info/rfc9190</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="TrustCom2015">[TrustCom2015]</dt>
        <dd>
<span class="refAuthor">Arkko, J.</span>, <span class="refAuthor">Norrman, K.</span>, <span class="refAuthor">Naslund, M.</span>, and <span class="refAuthor">B. Sahlin</span>, <span class="refTitle">"A USIM compatible 5G AKA protocol with perfect forward secrecy"</span>, <span>2015 in Proceedings of the TrustCom 2015, IEEE (August None)</span>, <span>&lt;<a href="http://ieeexplore.ieee.org/document/7345414/">http://ieeexplore.ieee.org/document/7345414/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Heist2015">[Heist2015]</dt>
        <dd>
<span class="refAuthor">Scahill, J.</span> and <span class="refAuthor">J. Begley</span>, <span class="refTitle">"The great SIM heist"</span>, <span>2015, in https://firstlook.org/theintercept/2015/02/19/great-sim-heist/ (February None)</span>. </dd>
<dd class="break"></dd>
<dt id="DOW1992">[DOW1992]</dt>
      <dd>
<span class="refAuthor">Diffie, W.</span>, <span class="refAuthor">vanOorschot, P.</span>, and <span class="refAuthor">M. Wiener</span>, <span class="refTitle">"Authentication and Authenticated Key Exchanges"</span>, <span>1992, in Designs, Codes and Cryptography 2 (2): pp. 107-125 (June None)</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="appendix-A">
      <h2 id="name-change-log">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-change-log" class="section-name selfRef">Change Log</a>
      </h2>
<p id="appendix-A-1">The -06 version of the WG draft is a refresh and a
  reference update. However, the
  following should be noted:<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="appendix-A-2.1">The draft now uses "forward secrecy" terminology and references
    RFC 7624 per recommendations on mailing list discussion.<a href="#appendix-A-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="appendix-A-2.2">There's been mailing list disccussion about the encoding of the
    public values; the current text requires confirmation from the
    working group that it is sufficient.<a href="#appendix-A-2.2" class="pilcrow">¶</a>
</li>
      </ul>
<p id="appendix-A-3">The -05 version of the WG draft takes into account feedback from
  the working group list, about the number of bytes needed to encode
  P-256  values.<a href="#appendix-A-3" class="pilcrow">¶</a></p>
<p id="appendix-A-4">The -04 version of the WG draft takes into account feedback from
  the May 2020 WG interim meeting, correcting the reference to the
  NIST P-256 specification.<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<p id="appendix-A-5">The -03 version of the WG draft is first of all a refresh; there
  are no issues that we think need addressing, beyond the one for
  which there is a suggestion in -03: The specification now suggests
  an alternate group/curve as an optional one besides X25519. The
  specific choice of particular groups and algorithms is still up to the
  working group.<a href="#appendix-A-5" class="pilcrow">¶</a></p>
<p id="appendix-A-6">The -02 version of the WG draft took into account additional
  reviews, and changed the document to update RFC 5448 (or rather, its
  successor, <span>[<a href="#RFC9048" class="xref">RFC9048</a>]</span>), changed the
  wording of the recommendation with regards to the use of this
  extension, clarified the references to the definition of X25519 and
  Curve25519, clarified the distinction to ECDH methods that use
  partially static keys, and simplified the use of AKA and SIM card
  terminology. Some editorial changes were also made.<a href="#appendix-A-6" class="pilcrow">¶</a></p>
<p id="appendix-A-7">The -00 and -01 versions of the WG draft made no major 
  changes, only updates to some references.<a href="#appendix-A-7" class="pilcrow">¶</a></p>
<p id="appendix-A-8">The -05 version is merely a refresh while the draft was waiting
  for WG adoption.<a href="#appendix-A-8" class="pilcrow">¶</a></p>
<p id="appendix-A-9">The -04 version of this draft made only editorial changes.<a href="#appendix-A-9" class="pilcrow">¶</a></p>
<p id="appendix-A-10">The -03 version of this draft changed the naming of various
    protocol components, values, and notation to match with the use of
    ECDH in ephemeral mode. The AT_KDF_FS negotiation process was
    clarified in that exactly one key is ever sent in
    AT_KDF_ECDHE. The option of checking for zero key values IN ECDHE
    was added. The format of the actual key in AT_PUB_ECDHE was
    specified. Denial-of-service considerations for the FS process
    have been updated. Bidding down attacks against this extension
    itself are discussed extensively. This version also addressed
    comments from reviewers, including the August review from Mohit
    Sethi, and comments made during IETF-102 discussion.<a href="#appendix-A-10" class="pilcrow">¶</a></p>
</section>
<section id="appendix-B">
      <h2 id="name-acknowledgments-3">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgments-3" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The authors would like to note that the technical solution in
    this document came out of the TrustCom paper <span>[<a href="#TrustCom2015" class="xref">TrustCom2015</a>]</span>, whose authors were J. Arkko, K. Norrman,
    M. Naslund, and B. Sahlin. This document uses also a lot of
    material from <span>[<a href="#RFC4187" class="xref">RFC4187</a>]</span> by J. Arkko and
    H. Haverinen as well as <span>[<a href="#RFC5448" class="xref">RFC5448</a>]</span> by J. Arkko,
    V. Lehtovirta, and P. Eronen.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The authors would also like to thank Tero Kivinen, John
    Mattsson, Mohit Sethi, Vesa Lehtovirta, Russ Housley, Sean Turner,
    Eliot Lear, Joseph Salowey, Kathleen Moriarty, Zhang Fu, Bengt
    Sahlin, Ben Campbell, Prajwol Kumar Nakarmi, Goran Rune, Tim
    Evans, Helena Vahidi Mazinani, Anand R. Prasad, Rene Struik, and
    many other people at the IETF, GSMA and 3GPP groups for
    interesting discussions in this problem space.<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses-7">
<a href="#name-authors-addresses-7" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Jari Arkko</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left">FI-<span class="postal-code">02420</span> <span class="locality">Jorvas</span>
</div>
<div dir="auto" class="left"><span class="country-name">Finland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:jari.arkko@piuha.net" class="email">jari.arkko@piuha.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Karl Norrman</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16483</span> <span class="locality">Stockholm</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:karl.norrman@ericsson.com" class="email">karl.norrman@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Vesa Torvinen</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div dir="auto" class="left">FI-<span class="postal-code">02420</span> <span class="locality">Jorvas</span>
</div>
<div dir="auto" class="left"><span class="country-name">Finland</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vesa.torvinen@ericsson.com" class="email">vesa.torvinen@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
