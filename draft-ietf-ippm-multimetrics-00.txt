
Network Working Group                                         E. Stephan
Internet-Draft                                            France Telecom
Expires: July 14, 2006                                          L. Liang
                                                    University of Surrey
                                                               A. Morton
                                                               AT&T Labs
                                                        January 10, 2006


        IP Performance Metrics (IPPM) for spatial and multicast
                  draft-ietf-ippm-multimetrics-00.txt

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on July 14, 2006.

Copyright Notice

   Copyright (C) The Internet Society (2006).

Abstract

   The IETF IP Performance Metrics (IPPM) working group has standardized
   metrics for measuring end-to-end performance between 2 points.  This
   memo defines 2 sets of metrics to extend these end-to-end ones.  It
   defines spatial metrics for measuring the performance of segments
   along a path and metrics for measuring the performance of a group of



Stephan, et al.           Expires July 14, 2006                 [Page 1]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   users in multiparty communications.


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  Terminology  . . . . . . . . . . . . . . . . . . . . . . . . .  5
     2.1.  Multiparty metric  . . . . . . . . . . . . . . . . . . . .  5
     2.2.  Spatial metric . . . . . . . . . . . . . . . . . . . . . .  5
     2.3.  Spatial metric points of interest  . . . . . . . . . . . .  5
     2.4.  One-to-group metric  . . . . . . . . . . . . . . . . . . .  5
     2.5.  One-to-group metric points of interest . . . . . . . . . .  5
     2.6.  Reference point  . . . . . . . . . . . . . . . . . . . . .  5
     2.7.  Group of singletons  . . . . . . . . . . . . . . . . . . .  6
   3.  Motivations for spatial and one-to-group metrics . . . . . . .  6
     3.1.  spatial metrics  . . . . . . . . . . . . . . . . . . . . .  6
     3.2.  One-to-group metrics . . . . . . . . . . . . . . . . . . .  7
     3.3.  Discussion on Group-to-one and Group-to-group metrics  . .  7
   4.  Spatial metrics definitions  . . . . . . . . . . . . . . . . .  8
     4.1.  A Definition for Spatial One-way Delay Stream  . . . . . .  8
     4.2.  A Definition of a sample of One-way Delay of a sub path  . 11
     4.3.  A Definition for Spatial One-way Packet Loss Stream  . . . 13
     4.4.  A Definition for Spatial One-way Jitter Stream . . . . . . 15
     4.5.  Discussion on pure passive measurement of spatial
           metrics  . . . . . . . . . . . . . . . . . . . . . . . . . 17
     4.6.  Discussion on spatial statistics . . . . . . . . . . . . . 18
   5.  One-to-group metrics definitions . . . . . . . . . . . . . . . 18
     5.1.  A Definition for one-to-group One-way Delay Stream . . . . 18
     5.2.  A Definition for one-to-group One-way Packet Loss
           Stream . . . . . . . . . . . . . . . . . . . . . . . . . . 19
     5.3.  A Definition for one-to-group One-way Jitter Stream  . . . 20
     5.4.  Discussion on one-to-group statistics  . . . . . . . . . . 21
   6.  Extension from one-to-one to one-to-many measurement . . . . . 23
   7.  Open issues  . . . . . . . . . . . . . . . . . . . . . . . . . 24
   8.  Security Considerations  . . . . . . . . . . . . . . . . . . . 24
   9.  Acknowledgments  . . . . . . . . . . . . . . . . . . . . . . . 24
   10. IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 24
   11. References . . . . . . . . . . . . . . . . . . . . . . . . . . 25
     11.1. Normative References . . . . . . . . . . . . . . . . . . . 25
     11.2. Informative References . . . . . . . . . . . . . . . . . . 25
   Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . . . 27
   Intellectual Property and Copyright Statements . . . . . . . . . . 28









Stephan, et al.           Expires July 14, 2006                 [Page 2]

Internet-Draft        Spatial and Multicast Metrics         January 2006


1.  Introduction

   The metrics specified in this memo are built on notions introduced
   and discussed in the IPPM Framework document, RFC 2330 [RFC2330].
   The reader should be familiar with these documents.

   This memo makes use of definitions of end-to-end One-way Delay
   Metrics defined in the RFC 2679 [RFC2679] to define metrics for
   decomposition of end-to-end one-way delays measurements.

   This memo makes use of definitions of end-to-end One-way Packet loss
   Metrics defined in the RFC 2680 [RFC2680] to define metrics for
   decomposition of end-to-end one-way packet loss measurements.

   The IPPM WG defined a framework for metric definitions and end-to-end
   measurements:

   o  A general framework for defining performance metrics, described in
      the Framework for IP Performance Metrics, RFC 2330 [RFC2330];

   o  A One-way Active Measurement Protocol Requirements, RFC 3763
      [RFC3763];

   o  A One-way Active Measurement Protocol (OWAMP) [work in progress];

   o  An IP Performance Metrics Registry , RFC 4148 [RFC4148];

   It specified a set of end-to-end metrics, which conform to this
   framework:

   o  The IPPM Metrics for Measuring Connectivity, RFC 2678 [RFC2678];

   o  The One-way Delay Metric for IPPM, RFC 2679 [RFC2679];

   o  The One-way Packet Loss Metric for IPPM, RFC 2680 [RFC2680];

   o  The Round-trip Delay Metric for IPPM, RFC 2681 [RFC2681];

   o  A Framework for Defining Empirical Bulk Transfer Capacity Metrics
      RFC 3148 [RFC3148];

   o  One-way Loss Pattern Sample Metrics, RFC 3357 [RFC3357];

   o  IP Packet Delay Variation Metric for IPPM, RFC 3393 [RFC3393];

   o  Network performance measurement for periodic streams, RFC 3432
      [RFC3432];




Stephan, et al.           Expires July 14, 2006                 [Page 3]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   o  Packet Reordering Metric for IPPM [Work in progress];

   Based on these works, this memo defines 2 kinds of multi party
   metrics.

   Firstly it defines spatial metrics:

   o  A 'sample', called Type-P-Spatial-One-way-Delay-Stream, will be
      introduced to decompose an end-to-end Type-P-One-way-Delay in a
      spatial sequence of one-way delays.

   o  A 'sample', called Type-P-Spatial-One-way-Packet-Loss-Stream, will
      be introduced to decompose an end-to-end Type-P-One-way-Packet-
      Loss in a spatial sequence of packet loss.

   o  Using the Type-P-Spatial-One-way-Delay-Stream metric, a 'sample',
      called Type-P-Spatial-One-way-Jitter-Stream, will be introduced to
      decompose an end-to-end Type-P-One-way-ipdv in a spatial sequence
      of jitter.

   o  Using the Type-P-Spatial-One-way-Delay-Stream metric, a 'sample',
      called Type-P-subpath-One-way-Delay-Stream, will be introduced to
      define the one-way-delay between any host of the path.  This
      metrics is designed too for pure passive measurement methodology
      introduced by PSAMP WG.

   Then it defines one-to-group metrics.

   o  Using one test packet sent from one sender to a group of
      receivers, a 'sample', called Type-P-one-to-group-One-way-Delay-
      Stream, will be introduced to define the list of Type-P-one-way-
      delay between this sender and the group of receivers.

   o  Using one test packet sent from one sender to a group of
      receivers, a 'sample', called Type-P-one-to-group-One-way-Packet-
      Loss-Stream, will be introduced to define the list of Type-P-One-
      way-Packet-Loss between this sender and the group of receivers

   o  Using one test packet sent from one sender to a group of
      receivers, a 'sample', called Type-P-one-to-group-One-way-Jitter-
      Stream, will be introduced to define the list of Type-P-One-way-
      ipdv between this sender and the group of receivers

   o  Then a discussion section presents the set of statistics that may
      be computed on the top of these metrics to present the QoS in a
      view of a group of users as well as the requirements of relative
      QoS on multiparty communications.




Stephan, et al.           Expires July 14, 2006                 [Page 4]

Internet-Draft        Spatial and Multicast Metrics         January 2006


2.  Terminology

2.1.  Multiparty metric

   A metric is said to be multiparty if the definition involved more
   than two sources or destinations in the measurements.  All multiparty
   metrics define a set of hosts called "points of interest", where one
   host is the source and other hosts are the measurement collection
   points.  For example, if the set of points of interest is < ha, hb,
   hc, ..., hn >, where ha is the source and < hb, hc, ..., hn > are the
   destinations, then measurements may be conducted between < ha, hb>, <
   ha, hc>, ..., <ha, hn >.

2.2.  Spatial metric

   A metric is said to be spatial if one of the hosts involved is
   neither the source nor the destination of the metered packet.

2.3.  Spatial metric points of interest

   Points of interest of a spatial metric are the routers or sibling in
   the path between source and destination (in addition to the source
   and the destination themself).

2.4.  One-to-group metric

   A metric is said to be one-to-group if the measured packet is sent by
   one source and (potentially) received by several destinations.  Thus,
   the topology of the communication group can be viewed as a centre-
   distributed or server-client topology with the source as the centre/
   server in the topology.

2.5.  One-to-group metric points of interest

   Points of interest of One-to-group metrics are the set of host
   destinations receiving packets from the source (in addition to the
   source itself).

2.6.  Reference point

   The centre/server in the one-to-group measurement that is controlled
   by network operators can be a very good reference point where
   measurement data can be collected for further processing although the
   actual measurements have to be carried out at all points of interest.
   I.e., the measurement points will be all clients/receivers while the
   reference point acts as source for the one-to-group metric.  Thus, we
   can define the reference point as the host while the statistic
   calculation will be carried out.



Stephan, et al.           Expires July 14, 2006                 [Page 5]

Internet-Draft        Spatial and Multicast Metrics         January 2006


2.7.  Group of singletons

   A group of singletons is the set of results of the observation of the
   behaviour of the same packet at different places of a network.


3.  Motivations for spatial and one-to-group metrics

   All IPPM metrics are defined for end-to-end measurement.  These
   metrics provide very good guides for measurement in the pair
   communications.  However, further efforts should be put to define
   metrics for multiparty measurements such as one to one trajectory
   metrics and one to multipoint metrics.

3.1.  spatial metrics

   Decomposition of instantaneous end-to-end measures is needed:

   o  The PCE WG is extending existing protocols to permit remote path
      computation and path computation quality, including inter domain.
      One may say that in intra domain the decomposing the performance
      of a path is not whished.  However such decomposition is desirable
      in interdomain to qualify each AS computation with the initial
      request.  So it is necessary to define standard spatial metrics
      before going further in the computation of inter domain path with
      QoS constraint.

   o  Traffic engineering and troubleshooting applications require
      spatial views of the one-way delay consumption, identification of
      the location of the lost of packets and the decomposition of the
      jitter over the path.

   o  Monitoring the QoS of a multicast tree, of MPLS point-to-
      multipoint and inter-domain communication require spatial
      decomposition of the one-way delay, of the packet loss and of the
      jitter.

   o  Composition of metrics is a need to scale in the measurement
      plane.  The definition of composition metrics is a work in
      progress [I-D.morton-ippm-composition]; .  Spatial measure give
      typically the individual performance of an intra domain segment.
      It is the elementary piece of information to exchange for
      measuring interdomain performance based on composition of metrics.

   o  The PSAMP WG defines capabilities to sample packets in a way to to
      support measurement.  [I-D.boschi-export-perpktinfo]; defines a
      method to collect packets information to measure the instantaneous
      spatial performance without injecting test traffic.  Consequently



Stephan, et al.           Expires July 14, 2006                 [Page 6]

Internet-Draft        Spatial and Multicast Metrics         January 2006


      it is urgent to define a set of common spatial metrics for passive
      and active techniques which respect the IPPM framework [RFC2330].
      This need is emphases by the fact that end-to-end spatial
      measurement involves the 2 techniques;

3.2.  One-to-group metrics

   While the node-to-node based spatial measures can provide very useful
   data in the view of each connection, we also need measures to present
   the performance of a multiparty communication in the view of a group
   with consideration that it involves a group of people rather than
   two.  As a consequence a simple one-way metric cannot describe the
   multi-connection situation.  We need some new metrics to collect
   performance of all the connections for further statistics analysis.
   A group of metrics are proposed in this stage named one-to-group
   performance metrics based on the unicast metrics defined in IPPM WG.
   One-to-group metrics are trying to composite one-way metrics from one
   source to a group of destinations to make up new metrics.  The
   compositions are necessary for judging the network performance of
   multiparty communications and can also be used to describe the
   difference of the QoS served among a group of users.

   One-to-group performance metrics are needed for several reasons:

   o  For designing and engineering multicast trees and MPLS point-to-
      multipoint LSP;

   o  For evaluating and controlling of the quality of the multicast
      services;

   o  For controlling the performance of the inter domain multicast
      services;

   o  For presenting and evaluating the relative QoS requirements for
      the multiparty communications.

   To understand the connection situation between one source and any one
   receiver in the multiparty communication group, we need the
   collection of instantaneous end-to-end measures.  It will give us
   very detailed insight into each branch of the multicast tree in terms
   of end-to-end absolute QoS.  It can provide clear and helpful
   information for engineers to identify the connection with problems in
   a complex multiparty routing tree.

3.3.  Discussion on Group-to-one and Group-to-group metrics

   We note that points of interest can also be selected to define
   measurements on Group-to-one and Group-to-group topologies.  These



Stephan, et al.           Expires July 14, 2006                 [Page 7]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   topologies are currently beyond the scope of this memo, because they
   would involve multiple packets launched from different sources.
   However, we can give some clues here on these two cases.

   The measurements for group-to-one topology can be easily derived from
   the one-to-group measurement.  The measurement point is the reference
   point that is acting as a receiver while all of clients/receivers
   defined for one-to-group measurement act as sources in this case.

   For the group-to-group connection topology, we can hardly define the
   reference point and, therefore, have difficulty to define the
   measurement points.  However, we can always avoid this confusion by
   treating the connections as one-to-group or group-to-one in our
   measurements without consideration on how the real communication will
   be carried out.  For example, if one group of hosts < ha, hb, hc,
   ..., hn > are acting as sources to send data to another group of
   hosts < Ha, Hb, Hc, ..., Hm >, we can always decompose them into n
   one-to-group communications as < ha, Ha, Hb, Hc, ..., Hm >, < hb, Ha,
   Hb, Hc, ..., Hm >, <hc, Ha, Hb, Hc, ..., Hm >, ..., < hn, Ha, Hb, Hc,
   ..., Hm >.


4.  Spatial metrics definitions

   Spatial decomposition metrics are based on standard end-to-end
   metrics.

   The definition of a spatial metric is coupled with the corresponding
   end-to-end metric.  The methodoly is based on the measure of the same
   test packet and parameters of the corresponding end-to-end metric.

4.1.  A Definition for Spatial One-way Delay Stream

   This section is coupled with the definition of Type-P-One-way-Delay.
   When a parameter from section 3 of [RFC2679] is first used in this
   section, it will be tagged with a trailing asterisk.

   Sections 3.5 to 3.8 of [RFC2679] give requirements and applicability
   statements for end-to-end one-way-delay measurements.  They are
   applicable to each point of interest Hi involved in the measure.
   Spatial one-way-delay measurement SHOULD be respectful of them,
   especially those related to methodology, clock, uncertainties and
   reporting.

   Following we adapt some of them and introduce points specific to
   spatial measurement.





Stephan, et al.           Expires July 14, 2006                 [Page 8]

Internet-Draft        Spatial and Multicast Metrics         January 2006


4.1.1.  Metric Name

   Type-P-Spatial-One-way-Delay-Stream

4.1.2.  Metric Parameters

             + Src*, the IP address of the sender.

             + Dst*, the IP address of the receiver.

             + i, An integer which ordered the hosts in the path.

             + Hi, exchange points of the path digest.

             + T*, a time, the sending (or initial observation) time for
             a measured packet.

             + dT* a delay,  the one-way delay for a measured packet.

             + dT1,..., dTn a list of delay.

             + P*, the specification of the packet type.

             + <Src, H1, H2,..., Hn, Dst>, a path digest.


4.1.3.  Metric Units

   A sequence of times.

4.1.4.  Definition

   Given a Type-P packet sent by the sender Src at wire-time (first bit)
   T to the receiver Dst in the path <H1, H2,..., Hn>.  Given the
   sequence of values <T+dT1,T+dT2,...,T+dTn,T+dT> such that dT is the
   Type-P-One-way-Delay from Src to Dst and such that for each Hi of the
   path, T+dTi is either a real number corresponding to the wire-time
   the packet passes (last bit received) Hi, or undefined if the packet
   never passes Hi.

   Type-P-Spatial-One-way-Delay-Stream metric is defined for the path
   <Src, H1, H2,..., Hn, Dst> as the sequence of values
   <T,dT1,dT2,...,dTn,dT>.

4.1.5.  Discussion

   Following are specific issues which may occur:




Stephan, et al.           Expires July 14, 2006                 [Page 9]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   o  the delay looks to decrease: dTi > DTi+1. this seem typically du
      to some clock synchronisation issue. this point is discussed in
      the section 3.7.1.  "Errors or uncertainties related to Clocks" of
      of [RFC2679];

   o  The location of the point of interest in the device influences the
      result (see [I-D.quittek-ipfix-middlebox]).  If the packet is not
      observed on the input interface the delay includes buffering time
      and consequently an uncertainty due to the difference between
      'wire time' and 'host time';

4.1.6.  Interference with other test packet

   To avoid packet collision it is preferable to include a sequence
   number in the packet.

4.1.7.  loss threshold

   To determine if a dTi is defined or undefined it is necessary to
   define a period of time after which a packet is considered loss.

4.1.8.  Methodologies

   Section 3.6 of [RFC2679] gives methodologies for end-to-end one-way-
   delay measurements.  Most of them apply to each points interest Hi
   and are relevant to this section.

   Generally, for a given Type-P, in a given Hi, the methodology would
   proceed as follows:

   o  At each Hi, prepare to capture the packet sent a time T, take a
      timestamp Ti', determine the internal delay correction dTi',
      extract the timestamp T from the packet, then compute the one-way-
      delay from Src to Hi: dTi = Ti' - dTi' - T. The one-way delay is
      undefined (infinite) if the packet is not detected after the 'loss
      threshold' duration;

   o  Gather the set of dTi of each Hi and order them according to the
      path to build the Type-P-Spatial-One-way-Delay-Stream metric
      <T,dT1,dT2,...,dTn,dT> over the path <H1, H2,..., Hn>.

   It is out of the scope of this document to define how each Hi detects
   the packet.

4.1.9.  Reporting the metric

   Section 3.6 of [RFC2679] indicates the items to report.




Stephan, et al.           Expires July 14, 2006                [Page 10]

Internet-Draft        Spatial and Multicast Metrics         January 2006


4.1.10.  Path

   It is clear that a end-to-end Type-P-One-way-Delay can't determine
   the list of hosts the packet passes throught.  Section 3.8.4 of
   [RFC2679] says that the path traversed by the packet SHOULD be
   reported but is practically impossible to determine.

   This part of the job is provide by Type-P-Spatial-One-way-Delay-
   Stream metric because each points of interest Hi which capture the
   packet is part of the path.

4.2.  A Definition of a sample of One-way Delay of a sub path

   This metric is similar to the metric Type-P-One-way-Delay-Poisson-
   stream defined in [RFC2679] and to the metric Type-P-One-way-Delay-
   Periodic-Stream defined in [RFC3432].

   Nevertheless its definition differs because it is based of the
   decomposition of end-to-end One-way delay using the metric Type-P-
   Spatial-One-way-Delay-Stream defined above.

   It aims is to define a sample of One-way-Delay between a pair of
   hosts of a path usable by active and passive measurements.

   Sections 3.5 to 3.8 of [RFC2679] give requirements and applicability
   statements for end-to-end one-way-delay measurements.  They are
   applicable to each point of interest Hi involved in the measure.
   Subpath one-way-delay measurement SHOULD be respectful of them,
   especially those related to methodology, clock, uncertainties and
   reporting.

4.2.1.  Metric Name

   Type-P-subpath-One-way-Delay-Stream

















Stephan, et al.           Expires July 14, 2006                [Page 11]

Internet-Draft        Spatial and Multicast Metrics         January 2006


4.2.2.  Metric Parameters

             + Src*, the IP address of the sender.

             + Dst*, the IP address of the receiver.

             + i, An integer which orders exchange points in the path.

             + k, An integer which orders the packets sent.

         + <Src, H1, H2,..., Hn, Dst>, a path digest.

             + Ha, a host of the path digest different from Dst and Hb;

             + Hb, a host of the path digest different from Src and Ha.
               Hb order in the path must greater that Ha;

             + Hi, exchange points of the path digest.

             + dT1,..., dTn a list of delay.

             + P*, the specification of the packet type.



4.2.3.  Metric Units

   A sequence of pairs <Tk,dt>.

   T is one of time of the sequence T1...Tn;

   dT is a delay.

4.2.4.  Definition

   Given 2 hosts Ha and Hb of the path <Src, H1, H2,..., Hn, Dst>, given
   a flow of packets of Type-P sent from Src to Dst at the times T1,
   T2...  Tn.  At each of these times, we obtain a Type-P-Spatial-One-
   way-Delay-Stream <T1,dT1.1, dT1.2,..., dT1.n,dT1>.  We define the
   value of the sample Type-P-subpath-One-way-Delay-Stream as the
   sequence made up of the couples <Tk,dTk.b - dTk.a>. dTk.a is the
   delay between Src and Ha. dTk.b is the delay between Src and Hb.
   'dTk.b - dTk.a' is the one-way delay experienced by the packet sent
   at the time Tk by Src when going from Ha to Hb.

4.2.5.  Discussion

   Following are specific issues which may occur:



Stephan, et al.           Expires July 14, 2006                [Page 12]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   o  The definition permits the measure of <Tk,dTk.b - dTk.a> when a is
      Src.

   o  The definition permits the measure of <Tk,dTk.b - dTk.a> when b is
      Dst.

   o  the delay looks to decrease: dTi > DTi+1. this seem typically du
      to some clock synchronisation issue. this point is discussed in
      the section 3.7.1.  "Errors or uncertainties related to Clocks" of
      of [RFC2679];.

   o  The location of the point of interest in the device influences the
      result (see [I-D.quittek-ipfix-middlebox]).  If the packet is not
      observed on the input interface the delay includes buffering time
      and consequently an uncertainty due to the difference between
      'wire time' and 'host time';

   o  dTk.b may be observed and not dTk.a.

   o  Tk is unknown if the flow is made of end user packets, that is
      pure passive measure.  In this case Tk may be forced to Tk+dTk.a.
      This motivate separate metrics names for pure passive measurement
      or specific reporting information.

   o  Pure passive measure should consider packets of the same size and
      of the same Type-P.

4.2.6.  Interference with other packet

4.2.7.  loss threshold

   To determine if a dTi is defined or undefined it is necessary to
   define a period of time after which a packet is considered loss.

4.2.8.  Methodologies

   Both active and passive method should discussed.

4.2.9.  Reporting the metric

   Section 3.6 of [RFC2679] indicates the items to report.

4.2.10.  Path

4.3.  A Definition for Spatial One-way Packet Loss Stream

   This section is coupled with the definition of Type-P-One-way-Packet-
   Loss.  Then when a parameter from the section 2 of [RFC2680] is first



Stephan, et al.           Expires July 14, 2006                [Page 13]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   used in this section, it will be tagged with a trailing asterisk.

   Sections 2.5 to 2.8 of [RFC2680] give requirements and applicability
   statements for end-to-end one-way-Packet-Loss measurements.  They are
   applicable to each point of interest Hi involved in the measure.
   Spatial packet loss measurement SHOULD be respectful of them,
   especially those related to methodology, clock, uncertainities and
   reporting.

   Following we define the spatial metric, then we adapt some of the
   points above and introduce points specific to spatial measurement.

4.3.1.  Metric Name

   Type-P-Spatial-One-way-Packet-Loss-Stream

4.3.2.  Metric Parameters

           + Src*, the IP address of the sender.

           + Dst*, the IP address of the receiver.

           + i, An integer which ordered the hosts in the path.

           + Hi, exchange points of the path digest.

           + T*, a time, the sending (or initial observation) time for
          a measured packet.

           + dT1,..., dTn, dT, a list of delay.

           + P*, the specification of the packet type.

           + <Src, H1, H2,..., Hn, Dst>, a path digest.

           + B1, B2, ..., Bi, ..., Bn, a list of boolean values.


4.3.3.  Metric Units

   A sequence of boolean values.

4.3.4.  Definition

   Given a Type-P packet sent by the sender Src at time T to the
   receiver Dst in the path <H1, H2, ..., Hn>.  Given the sequence of
   times <T+dT1,T+dT2,...,T+dTn,T+dT> the packet passes <H1, H2 ..., Hn,
   Dst>,



Stephan, et al.           Expires July 14, 2006                [Page 14]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   Type-P-One-way-Packet-Lost-Stream metric is defined as the sequence
   of values <B1, B2, ..., Bn> such that for each Hi of the path, a
   value of Bi of 0 means that dTi is a finite value, and a value of 1
   means that dTi is undefined.

4.3.5.  Discussion

   Following are specific issues wich may occur:

   o  the result includes the sequence 1,0.  This case means that the
      packet was seen by a host but not by it successor on the path;

4.3.6.  Discussion

   The location of the meter in the device influences the result:

   o  Even if the packet is received by a device, it may be not observed
      by a meter located after a buffer;

4.3.7.  Sections in progress

4.4.  A Definition for Spatial One-way Jitter Stream

   This section uses parameters from the definition of Type-P-One-way-
   ipdv.  When a parameter from section 2 of [RFC3393] is first used in
   this section, it will be tagged with a trailing asterisk.

   Sections 3.5 to 3.7 of [RFC3393] give requirements and applicability
   statements for end-to-end one-way-ipdv measurements.  They are
   applicable to each point of interest Hi involved in the measure.
   Spatial one-way-ipdv measurement SHOULD be respectful of them,
   especially those related to methodology, clock, uncertainities and
   reporting.

   Following we adapt some of them and introduce points specific to
   spatial measurement.

4.4.1.  Metric Name

   Type-P-Spatial-One-way-Jitter-Stream











Stephan, et al.           Expires July 14, 2006                [Page 15]

Internet-Draft        Spatial and Multicast Metrics         January 2006


4.4.2.  Metric Parameters

             + Src*, the IP address of the sender.

             + Dst*, the IP address of the receiver.

             + i, An integer which ordered the hosts in the path.

             + Hi, exchange points of the path digest.

             + T1*, the time the first packet was sent.

             + T2*, the time the second packet was sent.

             + P, the specification of the packet type.


             + P1, the first packet sent at time T1.

             + P2, the second packet sent at time T2.

             + <Src, H1, H2,..., Hn, Dst>, a path digest.

             + <T1,dT1.1, dT1.2,..., dT1.n,dT1>,
             the Type-P-Spatial-One-way-Delay-Stream for packet sent at
             time T1;

             + <T2,dT2.1, dT2.2,..., dT2.n,dT2>,
             the Type-P-Spatial-One-way-Delay-Stream for packet sent at
             time T2;

             + L*, a packet length in bits. The packets of a Type P
             packet stream from which the
             Type-P-Spatial-One-way-Delay-Stream metric is taken MUST
             all be of the same length.


4.4.3.  Metric Units

   A sequence of times.

4.4.4.  Definition

   Given the Type-P packet having the size L and sent by the sender Src
   at wire-time (first bit) T1 to the receiver Dst in the path <H1,
   H2,..., Hn>.

   Given the Type-P packet having the size L and sent by the sender Src



Stephan, et al.           Expires July 14, 2006                [Page 16]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   at wire-time (first bit) T2 to the receiver Dst in the same path.

   Given the Type-P-Spatial-One-way-Delay-Stream <T1,dT1.1, dT1.2,...,
   dT1,n,dT1> of the packet P1.

   Given the Type-P-Spatial-One-way-Delay-Stream <T2,dT2.1, dT2.2,...,
   dT2,n,dT2> of the packet P2.

   Type-P-Spatial-One-way-Jitter-Stream metric is defined as the
   sequence of values <T2-T1,dT2.1-dT1.1,dT2.2-dT1.2,...,dT2.n-
   dT1.n,dT2-dT1> Such that for each Hi of the path <H1, H2,..., Hn>,
   dT2.i-dT1.i is either a real number if the packets P1 and P2 passes
   Hi at wire-time (last bit) dT1.i, respectively dT2.i, or undefined if
   at least one of them never passes Hi.  T2-T1 is the inter-packet
   emission interval and dT2-dT1 is ddT* the Type-P-One-way-ipdv at
   T1,T2*.

4.4.5.  Sections in progress

   See sections 3.5 to 3.7 of [RFC3393].

4.5.  Discussion on pure passive measurement of spatial metrics

   Spatial metrics may be measured without injecting test traffic as
   described in [I-D.boschi-export-perpktinfo] even if such a technique
   have some limitations.

   o  The packet is not a test packet, so it does not include the time
      it was sent.  Consequently a point of interest Hi ignores the time
      the packet was send.  So It is not possible to measure the first
      hop delay.  The collector ignores the time the packet was
      received.  So it is not possible to measure the last hop delay.
      One might says that most of the operational issues occur in the
      last mile and that consequently such measure are not useful.
      Nevertheless they are usable for network TE and interdomain QoS
      monitoring.

   o  The collector ignores the time the packet was send.  So it is not
      possible to determine that it is lost.

   o  A point of interest Hi ignores the time the packet is send because
      the packet does not carry the time it was injected in the network.
      So a probe Hi can not compute dTi.

   An alternative to these issues consist in considering that T is the
   time when H1 (the first passive probe of the path) observed the
   packet.




Stephan, et al.           Expires July 14, 2006                [Page 17]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   To avoid misunderstanding and to address specific reporting
   constraint a proposal consists in defining distinct metrics for pure
   passive measurement based on the definition above.  Having distinct
   metrics identifiers for spatial metrics and passive spatial metrics
   in the [RFC4148] will avoid interoperabily issues.  They may be named

   o  Type-P-Passive-One-way-delay-Stream

   o  Type-P-Passive-One-way-Packet-Loss-Stream

   o  Type-P-Passive-One-way-jitter-Stream

4.6.  Discussion on spatial statistics

   Do we define min, max, avg of spatial metrics ?

      having the maximum loss metric value could be interesting.  Say,
      the segment between router A and B always contributes loss metric
      value of "1" means it could be the potential problem segment.

      Uploading dTi of each Hi consume a lot of bandwidth.  Computing
      statistics (min, max and avg) of dTi locally in each Hi reduce the
      bandwidth consumption.


5.  One-to-group metrics definitions

5.1.  A Definition for one-to-group One-way Delay Stream

5.1.1.  Metric Name

   Type-P-one-to-group-One-way-Delay-Stream

5.1.2.  Metric Parameters

   o  Src, the IP address of a host acting as the source.

   o  Recv1,..., RecvN, the IP addresses of the N hosts acting as
      receivers.

   o  T, a time.

   o  dT1,...,dTn a list of time.

   o  P, the specification of the packet type.

   o  Gr, the multicast group address (optional).  The parameter Gr is
      the multicast group address if the measured packets are



Stephan, et al.           Expires July 14, 2006                [Page 18]

Internet-Draft        Spatial and Multicast Metrics         January 2006


      transmitted by multicast.  This parameter is to identify the
      measured traffic from other unicast and multicast traffic.  It is
      set to be optional in the metric to avoid losing any generality,
      i.e. to make the metric also applicable to unicast measurement
      where there is only one receivers.

5.1.3.  Metric Units

   The value of a Type-P-one-to-group-One-way-Delay-Stream is a set of
   singletons metrics Type-P-One-way-Delay [RFC2679].

5.1.4.  Definition

   Given a Type P packet sent by the source Src at Time T, given the N
   hosts { Recv1,...,RecvN } which receive the packet at the time {
   T+dT1,...,T+dTn }, a Type-P-one-to-group-One-way-Delay-Stream is
   defined as the set of the Type-P-One-way-Delay singleton between Src
   and each receiver with value of { dT1, dT2,...,dTn }.

5.2.  A Definition for one-to-group One-way Packet Loss Stream

5.2.1.  Metric Name

   Type-P-one-to-group-One-way-Packet-Loss-Stream

5.2.2.  Metric Parameters

   o  Src, the IP address of a host acting as the source.

   o  Recv1,..., RecvN, the IP addresses of the N hosts acting as
      receivers.

   o  T, a time.

   o  T1,...,Tn a list of time.

   o  P, the specification of the packet type.

   o  Gr, the multicast group address (optional).

5.2.3.  Metric Units

   The value of a Type-P-one-to-group-One-way-Packet-Loss-Stream is a
   set of singletons metrics Type-P-One-way-Packet-Loss [RFC2680].

5.2.4.  Definition

   Given a Type P packet sent by the source Src at T and the N hosts,



Stephan, et al.           Expires July 14, 2006                [Page 19]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   Recv1,...,RecvN, which should receive the packet at T1,...,Tn, a
   Type-P-one-to-group-One-way-Packet-Loss-Stream is defined as a set of
   the Type-P-One-way-Packet-Loss singleton between Src and each of the
   receivers {<T1,0|1>,<T2,0|1>,..., <Tn,0|1>}.

5.3.  A Definition for one-to-group One-way Jitter Stream

5.3.1.  Metric Name

   Type-P-one-to-group-One-way-Jitter-Stream

5.3.2.  Metric Parameters

           + Src, the IP address of a host acting as the source.

           + Recv1,..., RecvN, the IP addresses of the N hosts acting as
           receivers.

           + T1, a time.

           + T2, a time.

           + ddT1,...,ddTn, a list of time.

           + P, the specification of the packet type.

           + F, a selection function defining unambiguously the two
           packets from the stream selected for the metric.

    + Gr, the multicast group address (optional)

5.3.3.  Metric Units

   The value of a Type-P-one-to-group-One-way-Jitter-Stream is a set of
   singletons metrics Type-P-One-way-ipdv [RFC3393].

5.3.4.  Definition

   Given a Type P packet stream, Type-P-one-to-group-One-way- Jitter-
   Stream is defined for two packets from the source Src to the N hosts
   {Recv1,...,RecvN },which are selected by the selection function F, as
   the difference between the value of the Type-P-one-to-group-One-way-
   Delay-Stream from Src to { Recv1,..., RecvN } at time T1 and the
   value of the Type-P-one-to-group- One-way-Delay-Stream from Src to {
   Recv1,...,RecvN } at time T2.  T1 is the wire-time at which Scr sent
   the first bit of the first packet, and T2 is the wire-time at which
   Src sent the first bit of the second packet.  This metric is derived
   from the Type-P-one-to- group-One-way-Delay-Stream metric.



Stephan, et al.           Expires July 14, 2006                [Page 20]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   Therefore, for a set of real number {ddT1,...,ddTn},Type-P-one- to-
   group-One-way-Jitter-Stream from Src to { Recv1,...,RecvN } at T1, T2
   is {ddT1,...,ddTn} means that Src sent two packets, the first at
   wire-time T1 (first bit), and the second at wire-time T2 (first bit)
   and the packets were received by { Recv1,...,RecvN } at wire-time
   {dT1+T1,...,dTn+T1}(last bit of the first packet), and at wire-time
   {dT'1+T2,...,dT'n+T2} (last bit of the second packet), and that
   {dT'1-dT1,...,dT'n-dTn} ={ddT1,...,ddTn}.

5.4.  Discussion on one-to-group statistics

   The defined one-to-group metrics above can all be directly achieved
   from the relevant unicast one-way metrics.  They managed to collect
   all unicast measurement results of one-way metrics together in one
   profile and sort them by receivers and packets in a multicast group.
   They can provide sufficient information regarding the network
   performance in terms of each receiver and guide engineers to identify
   potential problem happened on each branch of a multicast routing
   tree.  However, these metrics can not be directly used to
   conveniently present the performance in terms of a group and neither
   to identify the relative QoS situation.

   One may say that no matter how many people join the communication,
   the connections can still be treated as a set of one-to-one
   connection.  However, we might not describe a multiparty
   communication by a set of one-way measurement metrics because of the
   difficulty for understanding and the lack of convenience.  For
   instance, an engineer might not describe the connections of a
   multiparty online conference in terms of one-to-group one-way delay
   for user A and B, B and C, and C and A because people might be
   confused.  If there are more users in the same communication, the
   description might be very long.  And he might use the one-way metrics
   with worst and the best value to give users an idea of the QoS range
   of the service they are providing.  But it is not clear enough and
   might not be accurate in a large multiparty communication scenario.

   From the QoS point of view, the multiparty communication services not
   only require the absolute QoS support but also the relative QoS.  The
   relative QoS means the difference between absolute QoS of all users.
   Directly using the one-way metrics cannot present the relative QoS
   situation.  However, if we use the variations of all users one-way
   parameters, we can have new metrics to measure the difference of the
   absolute QoS and hence provide the threshold value of relative QoS
   that a multiparty service might demand.  A very good example of the
   high relative QoS requirement is the online gaming.  A very light
   worse delay will result in failure in the game.  We have to use the
   new statistic metrics to define exactly how small the relative delay
   the online gaming requires.  There are many other services, e.g.



Stephan, et al.           Expires July 14, 2006                [Page 21]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   online biding, online stock market, etc., need a rule to judge the
   relative QoS requirement.  Therefore, we can see the importance of
   new statistic metrics to feed this need.

   We might use some one-to-group statistic conceptions to present the
   group performance and relative QoS.  In this stage, we define one-to-
   group mean stream and one-to-group variation stream.  These
   statistics are offered mostly to be illustrative of what could be
   done.

   One-to-group mean streams are trying to measure the overall QoS for a
   multicast group associated to one source.  It is a reflection of the
   absolute QoS of a multiparty communication service when we treat all
   receivers as one customer.  It can also present the trend of the
   absolute QoS of all receivers, i.e., it shows that most of the
   receivers in the multiparty communication service trend to receive an
   absolute QoS close to the mean.

   One-to-group variation streams are trying to measure how the QoS
   varies among all of the users in a multicast group associated to one
   source.  The word "variation" in this memo is the population standard
   deviation.  It reflects the relative QoS situation in a multiparty
   communication service, i.e., the level of the difference between the
   absolute QoS of each receivers.

   Using the one-to-group mean and one-to-group variation concepts, we
   can have a much clear understand on the QoS of a multiparty
   communication service in terms of its trend and range.  There can be
   mean and variation stream definitions for each of the three one-to-
   group metrics defined above.  We only present the definition of Type-
   P-one-to-group-One-way- Delay-Mean-Stream and Type-P-one-to-group-
   One-way-Delay-Variation-Stream as examples in this memo.

5.4.1.  Type-P-one-to-group-One-way-Delay-Mean-Stream

   Given a Type-P-one-to-group-One-way-Delay-Stream, the mean stream of
   all { dT1, dT2,...,dTn } for the packet from Src at time T to {
   Recv1,...,RecvN }.













Stephan, et al.           Expires July 14, 2006                [Page 22]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   For example, suppose we take a sample and the results are:

           Delay_Stream = <
           {T1,...,Tn}
           {T'1,...,T'n}
           {T''1,...T''n}
           >

   Then the mean stream would be:

           Delay_Mean_Stream = <
           DM1
           DM2
           DM3
           >
           = <
           sum{T1,...,Tn}/n
           sum{T'1,...,T'n}/n
           sum{T''1,...T''n}/n
           >

5.4.2.  Type-P-one-to-group-One-way-Delay-Variation-Stream

   Given a Type-P-one-to-group-One-way-Delay-Stream, the variation
   stream of all { dT1, dT2,...,dTn } for the packet from Src at time T
   to { Recv1,...,RecvN }.

   We still take the above Delay_Stream as a sample and the variation
   stream would be:

      Delay_Variation_Stream = <
      DV1
      DV2
      DV3
      >
      =<
      (SUM{(T1-DM1)^2,...,(Tn-DM1)^2)}/n)^(1/2)
      (SUM{(T'1-DM2)^2,...,(T'n-DM2)^2)}/n)^(1/2)
      (SUM{(T''1-DM3)^2,...,(T''n-DM3)^2)}/n)^(1/2)
      >


6.  Extension from one-to-one to one-to-many measurement

   The above one-to-group metrics were defined to compose measurement
   results of a group of users who receive the same data from one
   source.  Moreover, this is one of efforts to introducing the one-to-
   many concern to the IPPM working group with respect to the fact that



Stephan, et al.           Expires July 14, 2006                [Page 23]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   all existing documents in the group are unicast oriented, which talk
   about only one-to-one single "path" in measurements.  This concept
   can be extended from the "path" to "path tree" to cover both one-to-
   one and one-to-many communications.  Actually, the one-to-one
   communications can be viewed as a special case of one-to-many from
   the routing point of view.  The one-to-many communications build up a
   routing tree in the networks and one-to-one can be viewed as a
   special simplified tree without branches but only the "trunk".

   Therefore, the one-to-group metrics described in this memo can even
   be viewed as general metrics to measure the delay, jitter and packet
   loss in IP networks.  When it applies to one-to-one communications,
   the metrics will have N receivers while N equal to 1.  And the
   statistic metrics for one-to-one communications are exactly the one-
   to-group metrics themselves when calculated using the methods given.


7.  Open issues


8.  Security Considerations

   Active measumrement: see security section in owd pl, jitter rfcs
   (editor notes: add references).

   passive measurement: The rate of packet sampling is controled by hash
   funcion.  The analysis of such a function to generate packets that
   match the hash funcion may lead to a DoS attack toward the collector.
   The generation of packets with spoofing adresses may corrupt the
   results without any possibility to detect the spoofing.

   TODO: one-to-group metrics defined here are not intrusive: they rely
   on measures of owd... nevertheless they require collection of
   singletons which may overload the network the measurement controller
   is attach to.

   The one-to-group metrics are derived from one-way metrics and
   therefore, they have very close relationship.


9.  Acknowledgments

   Lei would like to acknowledge Zhili Sun from CCSR, University of
   Surrey, for his instruction and helpful comments on this work.


10.  IANA Considerations




Stephan, et al.           Expires July 14, 2006                [Page 24]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   Metrics defined in this memo will be registered in the IANA IPPM
   METRICS REGISTRY as described in initial version of the registry
   [RFC4148].


11.  References

11.1.  Normative References

   [RFC2330]  Paxson, V., Almes, G., Mahdavi, J., and M. Mathis,
              "Framework for IP Performance Metrics", RFC 2330,
              May 1998.

   [RFC2679]  Almes, G., Kalidindi, S., and M. Zekauskas, "A One-way
              Delay Metric for IPPM", RFC 2679, September 1999.

   [RFC2680]  Almes, G., Kalidindi, S., and M. Zekauskas, "A One-way
              Packet Loss Metric for IPPM", RFC 2680, September 1999.

   [RFC3393]  Demichelis, C. and P. Chimento, "IP Packet Delay Variation
              Metric for IP Performance Metrics (IPPM)", RFC 3393,
              November 2002.

   [RFC4148]  Stephan, E., "IP Performance Metrics (IPPM) Metrics
              Registry", BCP 108, RFC 4148, August 2005.

11.2.  Informative References

   [I-D.boschi-export-perpktinfo]
              Boschi, E. and L. Mark, "Use of IPFIX for Export of Per-
              Packet Information", draft-boschi-export-perpktinfo-01
              (work in progress), October 2005.

   [I-D.morton-ippm-composition]
              Stephan, E. and A. Morton, "Spatial Composition of
              Metrics", draft-morton-ippm-composition-01 (work in
              progress), October 2005.

   [I-D.quittek-ipfix-middlebox]
              Quittek, J., "Guidelines for IPFIX Implementations on
              Middleboxes", draft-quittek-ipfix-middlebox-00 (work in
              progress), February 2004.

   [RFC2678]  Mahdavi, J. and V. Paxson, "IPPM Metrics for Measuring
              Connectivity", RFC 2678, September 1999.

   [RFC2681]  Almes, G., Kalidindi, S., and M. Zekauskas, "A Round-trip
              Delay Metric for IPPM", RFC 2681, September 1999.



Stephan, et al.           Expires July 14, 2006                [Page 25]

Internet-Draft        Spatial and Multicast Metrics         January 2006


   [RFC3148]  Mathis, M. and M. Allman, "A Framework for Defining
              Empirical Bulk Transfer Capacity Metrics", RFC 3148,
              July 2001.

   [RFC3357]  Koodli, R. and R. Ravikanth, "One-way Loss Pattern Sample
              Metrics", RFC 3357, August 2002.

   [RFC3432]  Raisanen, V., Grotefeld, G., and A. Morton, "Network
              performance measurement with periodic streams", RFC 3432,
              November 2002.

   [RFC3763]  Shalunov, S. and B. Teitelbaum, "One-way Active
              Measurement Protocol (OWAMP) Requirements", RFC 3763,
              April 2004.





































Stephan, et al.           Expires July 14, 2006                [Page 26]

Internet-Draft        Spatial and Multicast Metrics         January 2006


Authors' Addresses

   Stephan Emile
   France Telecom Division R&D
   2 avenue Pierre Marzin
   Lannion,   F-22307

   Fax:   +33 2 96 05 18 52
   Email: emile.stephan@francetelecom.com


   Lei Liang
   CCSR, University of Surrey
   Guildford
   Surrey,   GU2 7XH

   Fax:   +44 1483 683641
   Email: L.Liang@surrey.ac.uk


   Al Morton
   200 Laurel Ave. South
   Middletown, NJ  07748
   USA

   Phone: +1 732 420 1571
   Email: acmorton@att.com
























Stephan, et al.           Expires July 14, 2006                [Page 27]

Internet-Draft        Spatial and Multicast Metrics         January 2006


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Disclaimer of Validity

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Copyright Statement

   Copyright (C) The Internet Society (2006).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.




Stephan, et al.           Expires July 14, 2006                [Page 28]
