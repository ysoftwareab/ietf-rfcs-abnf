<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>TM-RID Authentication Formats</title>
<meta content="Adam Wiethuechter" name="author">
<meta content="Stuart W. Card" name="author">
<meta content="Robert Moskowitz" name="author">
<meta content="
       
 This document describes how to include trust into the proposed ASTM 
 Remote ID specification defined in WK65041 by the F38 Committee 
 under a Broadcast Remote ID (RID) scenario. It defines a few 
 different message schemes (based on the authentication message) 
 that can be used to assure past messages sent by a UA and also act 
 as an assurance for UA trustworthiness in the absence of Internet 
 connectivity at the receiving node.
 
    " name="description">
<meta content="xml2rfc 2.39.0" name="generator">
<meta content="RFC" name="keyword">
<meta content="Request for Comments" name="keyword">
<meta content="I-D" name="keyword">
<meta content="Internet-Draft" name="keyword">
<meta content="HIP" name="keyword">
<meta content="TMRID" name="keyword">
<meta content="draft-wiethuechter-tmrid-auth-05" name="ietf.draft">
<link href="/tmp/draft-wiethuechter-tmrid-auth-05-rrEdWF.xml" type="application/rfc+xml" rel="alternate">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Avoid wrapping of URLs in references */
@media screen {
  .references a {
    white-space: nowrap;
  }
}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin: 0 0 0.25em 0;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/*
  The margin-left: 0 on <dd> removes all distinction
  between levels from nested <dl>s.  Undo that.
*/
dl.olPercent > dd,
dd {
  margin-left: revert;
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}</style>
<link href="rfc-local.css" type="text/css" rel="stylesheet">
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">TM-RID Auth Formats</td>
<td class="right">February 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wiethuechter, et al.</td>
<td class="center">Expires 21 August 2020</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">TMRID</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-wiethuechter-tmrid-auth-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-02-18" class="published">18 February 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2020-08-21">21 August 2020</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Wiethuechter</div>
<div class="org">AX Enterprize</div>
</div>
<div class="author">
      <div class="author-name">S. Card</div>
<div class="org">AX Enterprize</div>
</div>
<div class="author">
      <div class="author-name">R. Moskowitz</div>
<div class="org">HTT Consulting</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">TM-RID Authentication Formats</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
 This document describes how to include trust into the proposed ASTM 
 Remote ID specification defined in WK65041 by the F38 Committee 
 under a Broadcast Remote ID (RID) scenario. It defines a few 
 different message schemes (based on the authentication message) 
 that can be used to assure past messages sent by a UA and also act 
 as an assurance for UA trustworthiness in the absence of Internet 
 connectivity at the receiving node.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 August 2020.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-terms-and-definitions" class="xref">Terms and Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-terminology" class="xref">Requirements Terminology</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-definitions" class="xref">Definitions</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-background" class="xref">Background</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-problem-space-and-document-" class="xref">Problem Space And Document Focus</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-astm-authentication-message" class="xref">ASTM Authentication Message</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-thoughts-on-astm-authentica" class="xref">Thoughts on ASTM Authentication Message</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-hip-based-extensions-to-the" class="xref">HIP Based Extensions to the ASTM Authentication Message</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-hip-based-authentication-wr" class="xref">HIP Based Authentication Wrapper</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-inner-header" class="xref">Inner Header</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-trust-timestamp" class="xref">Trust Timestamp</a><a href="#section-toc.1-1.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="xref">4.1.3</a>.  <a href="#name-payload" class="xref">Payload</a><a href="#section-toc.1-1.4.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-signed-hash-lists" class="xref">Signed Hash Lists</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-hash-operation" class="xref">Hash Operation</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-pseudo-blockchain-hashes" class="xref">Pseudo-blockchain Hashes</a><a href="#section-toc.1-1.4.2.2.2.2.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-limitations" class="xref">Limitations</a><a href="#section-toc.1-1.4.2.2.2.3.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3">
                <p id="section-toc.1-1.4.2.3.1"><a href="#section-4.3" class="xref">4.3</a>.  <a href="#name-hip-based-offline-authentic" class="xref">HIP Based Offline Authentication</a><a href="#section-toc.1-1.4.2.3.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3.2.1">
                    <p id="section-toc.1-1.4.2.3.2.1.1"><a href="#section-4.3.1" class="xref">4.3.1</a>.  <a href="#name-certificate-registry-on-air" class="xref">Certificate: Registry on Aircraft</a><a href="#section-toc.1-1.4.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.4.2.3.2.2">
                    <p id="section-toc.1-1.4.2.3.2.2.1"><a href="#section-4.3.2" class="xref">4.3.2</a>.  <a href="#name-foward-error-correction" class="xref">Foward Error Correction</a><a href="#section-toc.1-1.4.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-example-use-cases" class="xref">Example Use Cases</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-trusted-messages" class="xref">Trusted Messages</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-wrapped-signed-hashes" class="xref">Wrapped Signed Hashes</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-acknowledgments" class="xref">Acknowledgments</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="toc ulEmpty">
<li class="toc ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
</ul>
</li>
<li class="toc ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
</ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
 UA Systems (UAS) are usually in a volatile environment when it 
 comes to communication. UA are generally small with little 
 computational (or flying)  horsepower to carry standard 
 communication equipment. This limits  the mediums of communication 
 to few viable options.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
 Observer systems (e.g. smartphones and tablets) place further 
 constraints on the communication options. The Remote ID Broadcast 
 messages MUST be available to applications on these platforms 
 without modifying the devices.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
 The ASTM standard focuses on two ways of communicating to a UAS for 
 RID: Broadcast and Network.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
 This document will focus on adding trust to Broadcast RID in the 
 current authentication message format, using the Host Identity 
 Protocol Version 2 (HIPv2) <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span> Hierarchical HIT (HHIT) <span>[<a href="#I-D.moskowitz-hip-hierarchical-hit" class="xref">I-D.moskowitz-hip-hierarchical-hit</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
</section>
<div id="terms">
<section id="section-2">
      <h2 id="name-terms-and-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-terms-and-definitions" class="section-name selfRef">Terms and Definitions</a>
      </h2>
<section id="section-2.1">
        <h3 id="name-requirements-terminology">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-terminology" class="section-name selfRef">Requirements Terminology</a>
        </h3>
<p id="section-2.1-1">
 The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", 
 "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", 
 and "OPTIONAL" in this document are to be interpreted as described 
 in BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they 
 appear in all capitals, as shown here.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-2.2">
        <h3 id="name-definitions">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
        </h3>
<dl class="dlNewline" id="section-2.2-1">
          <dt id="section-2.2-1.1">HI</dt>
<dd id="section-2.2-1.2">
 Host Identity. The public key portion of an assymetric 
 keypair from HIP. In this document it is assumed that the 
 HI is based on a EdDSA25519 keypair. This is supported by 
 new crypto defined in <span>[<a href="#I-D.moskowitz-hip-new-crypto" class="xref">I-D.moskowitz-hip-new-crypto</a>]</span>.<a href="#section-2.2-1.2" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-1.3">HIT</dt>
<dd id="section-2.2-1.4">
 Host Identity Tag. A 128 bit handle on the HI. Defined in 
 HIPv2 <span>[<a href="#RFC7401" class="xref">RFC7401</a>]</span>.<a href="#section-2.2-1.4" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-1.5">HHIT</dt>
<dd id="section-2.2-1.6">
 Hierarchical Host Identity Tag. A 128 bit handle on the HI 
 contain extra information not found in a standard HIT. 
 Defined in <span>[<a href="#I-D.moskowitz-hip-hierarchical-hit" class="xref">I-D.moskowitz-hip-hierarchical-hit</a>]</span>.<a href="#section-2.2-1.6" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-1.7">UA</dt>
<dd id="section-2.2-1.8">
 Unmanned Aircraft. In this document UA's are typically 
 though of as drones of commerical or military variety. This 
 is a very strict definition which can be relaxed to include 
 any and all aircraft that are unmanned.<a href="#section-2.2-1.8" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-1.9">UAS</dt>
<dd id="section-2.2-1.10">
 Unmanned Aircraft System. Composed of Unmanned Aircraft and 
 all required on-board subsystems, payload, control station, 
 other required off-board subsystems, any required launch 
 and recovery equipment, all required crew members, and C2 
 links between UA and the control station.<a href="#section-2.2-1.10" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-1.11">RID</dt>
<dd id="section-2.2-1.12">
 Remote ID. A unique identifier found on all UA to be used 
 in communication and in regulation of UA operation.<a href="#section-2.2-1.12" class="pilcrow">¶</a>
</dd>
<dt id="section-2.2-1.13">Observer</dt>
<dd id="section-2.2-1.14">
 Referred to in other UAS documents as a "user", but there 
 are also other classes of RID users, so we prefer 
 "observer" to denote an individual who has observed an UA 
 and wishes to know something about it, starting with its 
 RID.<a href="#section-2.2-1.14" class="pilcrow">¶</a>
</dd>
</dl>
</section>
</section>
</div>
<section id="section-3">
      <h2 id="name-background">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-background" class="section-name selfRef">Background</a>
      </h2>
<section id="section-3.1">
        <h3 id="name-problem-space-and-document-">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-problem-space-and-document-" class="section-name selfRef">Problem Space And Document Focus</a>
        </h3>
<p id="section-3.1-1">
 The current draft standard for Remote ID (RID) does not, in any 
 meaningful capacity, address the concerns of trust in the UA space 
 with communication in the Broadcast RID environment. This is a 
 requirement that will need to be addressed eventually for various 
 different parties that have a stake in the UA industry.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">
 The following subsections will provide a high level reference to 
 the ASTM standard for authentication messages and how their current 
 limitations effect trust in the Broadcast RID envirorment.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-3.2">
        <h3 id="name-astm-authentication-message">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-astm-authentication-message" class="section-name selfRef">ASTM Authentication Message</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-3.2-1">
<pre>

Page 0:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+  ASTM Authentication Headers  +---------------+
|                                               |               |
+-----------------------------------------------+               |
|                                                               |
|                                                               |
|                                                               |
|                Authentication Data / Signature                |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 1 - 4:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                Authentication Data / Signature                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

ASTM Header (1 byte):
        Contains basic ASTM information such as message type and
        protocol version.

ASTM Authentication Headers: (6 bytes)
    Contains header information for the authentication message
    from ASTM UAS RID Standard.

Authentication Data / Signature: (109 bytes: 17+23*4)
    Opaque authentication data.

</pre><a href="#section-3.2-1" class="pilcrow">¶</a>
</div>
<p id="section-3.2-2">
 The above diagram is the format defined by ASTM that is the
 frame which everything this document fits into. The specific
 details of the ASTM headers are abstracted away as they are not
 necessarily required for this document.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
</section>
<section id="section-3.3">
        <h3 id="name-thoughts-on-astm-authentica">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-thoughts-on-astm-authentica" class="section-name selfRef">Thoughts on ASTM Authentication Message</a>
        </h3>
<p id="section-3.3-1">
 The format proposed by the ASTM is designed with a few major 
 considerations in mind, which the authors feel put significant 
 limitations on the expansion of the standard.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">
 The primary consideration (in this context) is the use of the 
 Bluetooth 5.X Extended Frame format. This method allows for a 255 
 byte payload to be sent in what the ASTM refers to as a 
 "Message Pack".<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">
 The idea is to include up to five standard ASTM Broadcast RID 
 messages (each of which are 25 bytes) plus a single authentication 
 message (5 pages of 25 bytes each) in the Message Pack. The 
 reasoning is then the authentication message is for the entire 
 Message Pack.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">
 The authors have no issues with this proposed approach; this is a 
 valid format to use for the authentication message provided by the 
 ASTM. However, by limiting the authentication message to ONLY five 
 pages in the standard it ignores the possibility of other 
 formatting options to be created and used.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">
 Another issue with this format, not fully addressed in this document
 is fragmentation. Under Bluetooth 4.X, each page is sent seperately
 which can result in lose of pages on the reciever. This is disasterous
 as the loss of even a single page means any signature is incomplete.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<p id="section-3.3-6">
 With the current limitation of 5 pages, Forward Error Correction (FEC)
 is nearly impossible without sacrificing the amount of data sent. More
 pages would allow FEC to be performed on the Authentation message pages
 so loss of pages can be mitigated.<a href="#section-3.3-6" class="pilcrow">¶</a></p>
<p id="section-3.3-7">
 All these problems are further amplified by the speed at which UA fly and the 
 Oberserver's position to recieve transmissions. There is no guarentee
 that the Observer will recieve all the pages of even a 5 page Authentication
 Message in the time it takes a UA to traverse across their line of sight.
 Worse still is that is not including other UA in the area, which congestes
 the spectrum and could cause further confusion attempting to collate
 messages from various UA. This specific problem is out of scope for this
 document and our solutions in general, but should be noted as a design
 consideration.<a href="#section-3.3-7" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4">
      <h2 id="name-hip-based-extensions-to-the">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-hip-based-extensions-to-the" class="section-name selfRef">HIP Based Extensions to the ASTM Authentication Message</a>
      </h2>
<p id="section-4-1">
 The following section describes various methods that HIP can help 
 enable more trustworthy communication using the Authentication 
 Message as the base. Each diagram will show all pages of the 
 format filled out.<a href="#section-4-1" class="pilcrow">¶</a></p>
<section id="section-4.1">
        <h3 id="name-hip-based-authentication-wr">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-hip-based-authentication-wr" class="section-name selfRef">HIP Based Authentication Wrapper</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-4.1-1">
<pre>

Page 0:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+  ASTM Authentication Headers  +---------------+
|                                               |  Inner Header |
+-----------------------------------------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                             HHIT                              |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 1:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                 Trust Timestamp               /
+---------------+-----------------------------------------------+
/               |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                      Payload (Bytes 1-19)                     |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 2:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |            Payload (Bytes 20-24)              /
+---------------+               +-------------------------------+
/                               |                               |
+-------------------------------+                               |
|                                                               |
|                                                               |
|                                                               |
|                   HHIT Signature (Bytes 1-18)                 |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 3:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                   HHIT Signature (Bytes 19-41)                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 4:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                   HHIT Signature (Bytes 42-64)                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Inner Header (1 byte):
        See Inner Header section.

HHIT: (16 bytes)                
    HHIT using the EdDSA25519 HI.

Trust Timestamp: (4 bytes)     
    Timestamp denoting current time plus an offset to trust 
    message to. 

Payload: (24 bytes)             
    Opaque payload data. 

HHIT Signature: (64 bytes)      
    Signature over precedding fields using the EdDSA25519 keypair.

</pre><a href="#section-4.1-1" class="pilcrow">¶</a>
</div>
<p id="section-4.1-2">
 When this authentication format is recieved the HHIT is first 
 looked up in DNS by standard mechanisms to retrieve the HIP RR. 
 From this the HI can be used to perform signature verifiction. 
 The data signed is all the data preceding the 64 byte signature 
 (excluding the ASTM Headers and ASTM Authentication Headers).<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">
 When there is no Internet connectivity on the Observers device the 
 HI of the UA can be obtained by referencing the certificate sent in 
 the Offline Based Authentication format, if sent by the UA.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
<section id="section-4.1.1">
          <h4 id="name-inner-header">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-inner-header" class="section-name selfRef">Inner Header</a>
          </h4>
<p id="section-4.1.1-1">
 When the payload is another ASTM message then the first byte of 
 the full message should be used to fill in the Inner Header field.
 This byte can be signed but is primarily for identitying the 
 inner message type (for unpacking purposes if desired by the 
 Observer device).<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">
 Another use of the Inner Header byte is holding the H-Alg and H-Len
 fields if this format is used for Hashed Messages. See Section 5.2
 for a detailed example of this. When this format is used all 24 bytes
 of the payload MUST be filled with hash values. This requirement
 means that only even numbered hash lengths can be used.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">
 Any other wrapped messages that are not 24 bytes long and require
 padding on the payload MUST use the Inner Header to inform the
 reciever the length of payload in octets.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">
 To accomadate payload differences the use of AuthType in the ASTM
 Header section SHOULD be set in the range of 0xA-F (which is availible
 for Private Use). Only recommended values are defined here, as the
 allocation in the reserved space of this header is controlled by
 ASTM.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.1.1-5">
<pre>

    AuthType                            Values
    --------                            ------
    Wrapped ASTM Message                A
    Wrapped Hashes                      B
    Wrapped Message Length (octets)     C

</pre><a href="#section-4.1.1-5" class="pilcrow">¶</a>
</div>
</section>
<section id="section-4.1.2">
          <h4 id="name-trust-timestamp">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-trust-timestamp" class="section-name selfRef">Trust Timestamp</a>
          </h4>
<p id="section-4.1.2-1">
 Trust Timestamp MUST be current UNIX time plus an offset 
 into the future.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">
 To avoid replay attacks the Trust Timestamp field must be well
 founded. When wrapping a vector (position) message the payload
 WILL contain (by ASTM rules) constantly changing data, this 
 includes its own timestamp. In this case the Trust Timestamp
 could be argued as superfoulous.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">
 Other message types, such as Basic ID and Self-ID are static
 messages with no changing data. To protect a replay of these
 signed messages the Trust Timestamp is the field during signing
 to be guarenteed to change.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">
 The offset used against the UNIX timestamp is not defined in this
 document. Best practices to identify a acceptable offset should
 be used taking into consideration the UA envirorment, and propgation
 characteristics of the messages being sent.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
</section>
<section id="section-4.1.3">
          <h4 id="name-payload">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-payload" class="section-name selfRef">Payload</a>
          </h4>
<p id="section-4.1.3-1">
 The payload can be anything that fits within the 24 byte limit. 
 An example of what could be done with this format is found in 
 Section 5.1. If the payload is less than 24 bytes, null padding
 MUST be used to fill up to 24 bytes and the AuthType of 0xC
 MUST be used to identity message size.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4.2">
        <h3 id="name-signed-hash-lists">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-signed-hash-lists" class="section-name selfRef">Signed Hash Lists</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-4.2-1">
<pre>

Page 0:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+  ASTM Authentication Headers  +---------------+
|                                               | H-Alg | H-Len |
+---------------------------------------------------------------+
|                Hash of Previous Auth. Message                 |
+---------------------------------------------------------------+
|                Hash of Current Auth. Message                  |
+---------------------------------------------------------------+
|                          Message Hash                         |
+---------------------------------------------------------------+
|                          Message Hash                         |
+---------------------------------------------------------------+

Page 1:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+-------------------------------+
|  ASTM Header  | H-Alg | H-Len |            PADDING            |
+---------------+---------------+-------------------------------+
|                          Message Hash                         |
+---------------------------------------------------------------+
|                          Message Hash                         |
+---------------------------------------------------------------+
|                          Message Hash                         |
+---------------------------------------------------------------+
|                          Message Hash                         |
+---------------------------------------------------------------+
|                          Message Hash                         |
+---------------------------------------------------------------+

Page 2:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                    PADDING                    |
+---------------+               +-------------------------------+
|                               |                               |
+-------------------------------+                               |
|                                                               |
|                                                               |
|                                                               |
|                         HHIT Signature                        |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 3:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                         HHIT Signature                        |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 4:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                         HHIT Signature                        |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

H-Alg, H-Len: (4 bits), (4 bits)
    These are fields for relaying information of the Hash 
    algorithm used for the messages and the Hash length (in octets).
    For this example of the format a length of 4 bytes is
    used.

    H-Alg       Values
    -----       ------
    RESERVED    0
    cSHAKE128   1 [SP800-185] (RECOMMENDED)

Hash of Previous Auth. Message: (4 bytes)
    A hash of the previously sent Authentication message. 

Hash of Current Auth. Message: (4 bytes)
    A hash of the current Authentication message. 

Message Hash: (4 bytes)
    A hash of a previously sent message.

HHIT Signature: (64 bytes)
    EdDSA25519 signature using an EdDSA25519-based HI from HIP. 

</pre><a href="#section-4.2-1" class="pilcrow">¶</a>
</div>
<p id="section-4.2-2">
 This format is designed to provide provenance to Broadcast RID 
 messages sent by a given UAS. It should be noted that the HHIT is 
 not provided in the format like others specified here - instead it 
 must be obtained via the  Basic ID Message in a detached fashion.<a href="#section-4.2-2" class="pilcrow">¶</a></p>
<p id="section-4.2-3">
 By hashing previously sent messages and signing them we gain trust 
 in UAS previous reports. An observer who has been listening for any 
 length of time can hash received messages and cross check against 
 listed hashes. The signature is signed across the list of hashes.<a href="#section-4.2-3" class="pilcrow">¶</a></p>
<section id="section-4.2.1">
          <h4 id="name-hash-operation">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-hash-operation" class="section-name selfRef">Hash Operation</a>
          </h4>
<p id="section-4.2.1-1">
    With cSHAKE128 <span><a href="#NIST.SP.800-185" class="xref">NIST SP 800-185</a> [<a href="#NIST.SP.800-185" class="xref">NIST.SP.800-185</a>]</span>, the hash is computed as follows:<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2.1-2">
<pre>

     cSHAKE128(MAC|Message, 8*H-Len, "", "RemoteID Auth Hash")

</pre><a href="#section-4.2.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-3">
 The message MAC is prepended to the message, as the MAC is the only 
 information that links a UA's messages from a specific UA.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.2">
          <h4 id="name-pseudo-blockchain-hashes">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-pseudo-blockchain-hashes" class="section-name selfRef">Pseudo-blockchain Hashes</a>
          </h4>
<p id="section-4.2.2-1">
 Two special hashes are included; a previous authentication hash, 
 which links to the previous signed hash list message, as well as a 
 current hash. This gives a pseudo-blockchain provenance to the 
 authentication message that could be traced back if the observer 
 was present for extended periods of time.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">
 In regards to the creation and use of the current authentication 
 hash field:<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<ul class="ulEmpty">
<li class="ulEmpty" id="section-4.2.2-3.1">
 During creation and signing of this message format this field 
 MUST be set to 0. So the signature will be based on this field 
 being 0, as well as its own hash. It is an open question of if 
 we compute the hash, then sign or sign then compute.<a href="#section-4.2.2-3.1" class="pilcrow">¶</a>
</li>
<li class="ulEmpty" id="section-4.2.2-3.2">    
 There a few different ways to cycle this message. We can "roll 
 up" the hash of 'current' to 'previous' when needed or to 
 completely recompute the hash. This mostly depends on the 
 previous note.<a href="#section-4.2.2-3.2" class="pilcrow">¶</a>
</li>
</ul>
</section>
<section id="section-4.2.3">
          <h4 id="name-limitations">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-limitations" class="section-name selfRef">Limitations</a>
          </h4>
<p id="section-4.2.3-1">
 With the current format proposed by ASTM only 7 messages can be 
 hashed reasonably in the above format. PADDING and redundant H-Alg, H-Len 
 fields could be removed. This would increase the total list of 
 hashes to 9 while losing word alignment of the hashes in each page.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">
 To address this problem properly the authors feel that the 
 Authentication Messages needs to have a max bound of 10 pages, 
 instead of 5.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-4.3">
        <h3 id="name-hip-based-offline-authentic">
<a href="#section-4.3" class="section-number selfRef">4.3. </a><a href="#name-hip-based-offline-authentic" class="section-name selfRef">HIP Based Offline Authentication</a>
        </h3>
<div class="artwork art-text alignLeft" id="section-4.3-1">
<pre>

Page 0:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+  ASTM Authentication Headers  +---------------+
|                                               |               |
+-----------------------------------------------+               |
|                                                               |
|                                                               | 
|                                                               |
|         Certificate: Registry on Aircraft (Bytes 1-17)        |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 1-8:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|        Certificate: Registry on Aircraft (Bytes 18-200)       |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 9:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                     Foward Error Correction                   |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Certificate: Registry on Aircraft (200 bytes):
        A certificate granted by the Registry that asserts the binding
        of UA to the given Registry. Note that Page 8's final byte is 
        actually padding.

Foward Error Correction (FEC) (23 bytes):
        FEC on the previous 9 pages. 

</pre><a href="#section-4.3-1" class="pilcrow">¶</a>
</div>
<p id="section-4.3-2">
 This specific format does not currently fit within the ASTM 
 specification. Requiring a minimum of 200 bytes, this would require 
 the Authentication Message to have 10 pages, instead of the current 
 5 page limit. The rest of this section assumes 10 pages to
 demonstrate how this message is laid out and works.<a href="#section-4.3-2" class="pilcrow">¶</a></p>
<p id="section-4.3-3">
 What this grants is the ability to authenticate UA information when 
 the receiving device of the observer (e.g. a smartphone with a 
 dedicated RID application) has no Internet service (e.g. LTE 
 signal).<a href="#section-4.3-3" class="pilcrow">¶</a></p>
<p id="section-4.3-4">
 By including the device HI along with a signature from the registry 
 the UA is under, we can assert trust of a given UA without 
 requiring the need for immediate reverse lookups online.<a href="#section-4.3-4" class="pilcrow">¶</a></p>
<section id="section-4.3.1">
          <h4 id="name-certificate-registry-on-air">
<a href="#section-4.3.1" class="section-number selfRef">4.3.1. </a><a href="#name-certificate-registry-on-air" class="section-name selfRef">Certificate: Registry on Aircraft</a>
          </h4>
<p id="section-4.3.1-1">
 The bulk of this message is made up with the 200 byte certificate titled
 "Registry on Aircraft" (henceforth refered to as "Cra"). Below is
 Cra fully marked out inside the ASTM Authentication Message.<a href="#section-4.3.1-1" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.3.1-2">
<pre>

Page 0:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+  ASTM Authentication Headers  +---------------+
|                                               |               |
+-----------------------------------------------+               |
|                                                               |
|                                                               | 
|                          Registry HHIT                        |
|                                                               |
|                                                               |
|                                               +---------------+
|                                               |  UA HHIT (1)  |
+-----------------------------------------------+---------------+

Page 1:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                         UA HHIT (2-16)                        |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+
|                                                               |
|                           UA HI (1-8)                         |
|                                                               |
+---------------------------------------------------------------+

Page 2:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                           UA HI (9-31)                        |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 3:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+---------------+-------------------------------+
|  ASTM Header  |   UA HI (32)  |          UA Expiration        /
+---------------+---------------+-------------------------------+
/           Timestamp           |                               |
+-------------------------------+                               |
|                                                               |
|                                                               |
|                                                               |
|                        UA Signature (1-18)                    |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 4:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                        UA Signature (19-41)                   |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 5:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                        UA Signature (42-64)                   |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 6:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |         Registry Expiration Timestamp         /
+---------------+-----------------------------------------------+
/               |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                      Registry Signature (1-19)                |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 7:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                     Registry Signature (20-42)                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 8:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                     Registry Signature (43-64)                |
|                                                               |
|                                                               |
|                                               +---------------+
|                                               |    PADDING    |
+-----------------------------------------------+---------------+

Registry HHIT (16 bytes):
        Registry HHIT that UA is registered under and handle
        for the HI used in the signing of full certificate.

Certificate: Aircraft on Aircraft [Caa] (116 bytes):
        UA HHIT (16 bytes):
                Nominally the Aircraft HHIT (specificed here as UA)

        UA HI (32 bytes):
                Public half of EdDSA-25519 asymmetric keypair used
                to sign Caa.

        UA Expiration Timestamp (4 bytes):
                UNIX current time (at time of signing) + offset

        UA Signature (64 bytes):
                Signature with UA keypair using the data of UA HHIT,
                UA HI and UA Expiration Timestamp.

Registry Expiration Timestamp (4 bytes):
        UNIX current time (at time of signing) + offset
        
Registry Signature (64 bytes):
        Signature with Registry keypair using the data of 
        Registry HHIT, Caa and Registry Expiration Timestamp.

</pre><a href="#section-4.3.1-2" class="pilcrow">¶</a>
</div>
<p id="section-4.3.1-3">
 Cra is in practice a binding certificate between the Registry and
 the Aircraft, asserting the relationship between the two entities.
 Cra signs another certificate, Caa (Certificate: Aircraft on Aircraft), 
 that is created during UA provisioning.<a href="#section-4.3.1-3" class="pilcrow">¶</a></p>
<p id="section-4.3.1-4">
 Importantly this certificate allows Offline signature verification
 from the UA. This is as the UA HI is included in the certificate.
 Also included is the HHIT of the Registry to check the local
 shortlist of Registries that the Observer device trusts (mapping HHITs
 to HIs).<a href="#section-4.3.1-4" class="pilcrow">¶</a></p>
<p id="section-4.3.1-5">
 More details about Caa, Cra and other certificates and the provisioning
 process can be found HERE.<a href="#section-4.3.1-5" class="pilcrow">¶</a></p>
</section>
<section id="section-4.3.2">
          <h4 id="name-foward-error-correction">
<a href="#section-4.3.2" class="section-number selfRef">4.3.2. </a><a href="#name-foward-error-correction" class="section-name selfRef">Foward Error Correction</a>
          </h4>
<div class="artwork art-text alignLeft" id="section-4.3.2-1">
<pre>

Page 9:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                     Foward Error Correction                   |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

</pre><a href="#section-4.3.2-1" class="pilcrow">¶</a>
</div>
<p id="section-4.3.2-2">
 TBD<a href="#section-4.3.2-2" class="pilcrow">¶</a></p>
</section>
</section>
</section>
<section id="section-5">
      <h2 id="name-example-use-cases">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-example-use-cases" class="section-name selfRef">Example Use Cases</a>
      </h2>
<p id="section-5-1">
 This section introduces potentional use cases of the HIP based 
 extensions to the proposed ASTM standard authentication message.<a href="#section-5-1" class="pilcrow">¶</a></p>
<section id="section-5.1">
        <h3 id="name-trusted-messages">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-trusted-messages" class="section-name selfRef">Trusted Messages</a>
        </h3>
<p id="section-5.1-1">
 Using the HIP Based Authentication Wrapper any single Broadcast RID 
 message defined by ASTM can become what the authors refer to as a 
 "Trusted Message".<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1-2">
 One specific use case that is useful in the UAS RID space is the 
 creation of a "Trusted Vector Message". By placing a previous [or 
 new] vector message into the payload section of this format a 
 verifiable broadcast can be created.<a href="#section-5.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1-3">
 Due to being signed this creates an authentic vector that is hard 
 to spoof, which can confirm flight paths in near real time.<a href="#section-5.1-3" class="pilcrow">¶</a></p>
<p id="section-5.1-4">
 The figure below is a example of a "Trusted Vector Message".<a href="#section-5.1-4" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.1-5">
<pre>

Page 0:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+  ASTM Authentication Headers  +---------------+
|                                               | Vector Header |
+-----------------------------------------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                             HHIT                              |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 1:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                 Trust Timestamp               /
+---------------+-----------------------------------------------+
/               |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                    Vector Message (Bytes 1-19)                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 2:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |         Vector Message (Bytes 20-24)          /
+---------------+               +-------------------------------+
/                               |                               |
+-------------------------------+                               |
|                                                               |
|                                                               |
|                                                               |
|                   HHIT Signature (Bytes 1-18)                 |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 3:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                   HHIT Signature (Bytes 19-41)                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 4:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                   HHIT Signature (Bytes 42-64)                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

</pre><a href="#section-5.1-5" class="pilcrow">¶</a>
</div>
</section>
<section id="section-5.2">
        <h3 id="name-wrapped-signed-hashes">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-wrapped-signed-hashes" class="section-name selfRef">Wrapped Signed Hashes</a>
        </h3>
<p id="section-5.2-1">
 Using the HIP Based Authentication Wrapper a [short] list of hashes 
 can be signed. These hashes are of previous individual RID 
 messages.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
 This follows the format of the Signed Hash List, excluding the 
 psuedo-blockchain hashes found in the Signed Hash List.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">
 To the authors, this format has limited use due to numerous 
 concerns of replay attacks. It is suggested to instead use the full 
 Signed Hash List format.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-5.2-4">
<pre>

Page 0:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+  ASTM Authentication Headers  +---------------+
|                                               | H-Alg | H-Len |
+-----------------------------------------------+---------------+
|                                                               |
|                                                               |
|                                                               |
|                             HHIT                              |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 1:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                 Trust Timestamp               /
+---------------+-----------------------------------------------+
/               |                  Message Hash                 /
+---------------+-----------------------------------------------+
/               |                  Message Hash                 /
+---------------+-----------------------------------------------+
/               |                  Message Hash                 /
+---------------+-----------------------------------------------+
/               |                  Message Hash                 /
+---------------+-----------------------------------------------+
/               |                  Message Hash                 /
+---------------------------------------------------------------+

Page 2:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  /               |         Message Hash          /
+---------------+---------------+-------------------------------+
/                               |                               |
+-------------------------------+                               |
|                                                               |
|                                                               |
|                                                               |
|                   HHIT Signature (Bytes 1-18)                 |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 3:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                   HHIT Signature (Bytes 19-41)                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

Page 4:
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+---------------+-----------------------------------------------+
|  ASTM Header  |                                               |
+---------------+                                               |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
|                   HHIT Signature (Bytes 42-64)                |
|                                                               |
|                                                               |
|                                                               |
|                                                               |
+---------------------------------------------------------------+

</pre><a href="#section-5.2-4" class="pilcrow">¶</a>
</div>
</section>
</section>
<div id="IANA">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">
    TBD<a href="#section-6-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">
    TBD<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
<section id="section-8">
      <h2 id="name-acknowledgments">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="section-8-1">
    Ryan Quigly and James Mussi for early prototyping to find holes in the draft specifications.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="NIST.SP.800-185">[NIST.SP.800-185]</dt>
<dd>
<span class="refAuthor">Kelsey, J.</span><span class="refAuthor">, Change, S.</span><span class="refAuthor">, and R. Perlner</span>, <span class="refTitle">"SHA-3 derived functions: cSHAKE, KMAC, TupleHash and ParallelHash"</span>, <span class="seriesInfo">National Institute of Standards and Technology report</span>, <span class="seriesInfo">DOI 10.6028/nist.sp.800-185</span>, <time datetime="2016-12">December 2016</time>, <span>&lt;<a href="https://doi.org/10.6028/nist.sp.800-185">https://doi.org/10.6028/nist.sp.800-185</a>&gt;</span>. </dd>
<dt id="RFC2119">[RFC2119]</dt>
<dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dt id="RFC8174">[RFC8174]</dt>
<dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.moskowitz-hip-hhit-registries">[I-D.moskowitz-hip-hhit-registries]</dt>
<dd>
<span class="refAuthor">Moskowitz, R.</span><span class="refAuthor">, Card, S.</span><span class="refAuthor">, and A. Wiethuechter</span>, <span class="refTitle">"Hierarchical HIT Registries"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-moskowitz-hip-hhit-registries-01</span>, <time datetime="2019-10-17">17 October 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-moskowitz-hip-hhit-registries-01">https://tools.ietf.org/html/draft-moskowitz-hip-hhit-registries-01</a>&gt;</span>. </dd>
<dt id="I-D.moskowitz-hip-hierarchical-hit">[I-D.moskowitz-hip-hierarchical-hit]</dt>
<dd>
<span class="refAuthor">Moskowitz, R.</span><span class="refAuthor">, Card, S.</span><span class="refAuthor">, and A. Wiethuechter</span>, <span class="refTitle">"Hierarchical HITs for HIPv2"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-moskowitz-hip-hierarchical-hit-03</span>, <time datetime="2019-12-16">16 December 2019</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-moskowitz-hip-hierarchical-hit-03">https://tools.ietf.org/html/draft-moskowitz-hip-hierarchical-hit-03</a>&gt;</span>. </dd>
<dt id="I-D.moskowitz-hip-new-crypto">[I-D.moskowitz-hip-new-crypto]</dt>
<dd>
<span class="refAuthor">Moskowitz, R.</span><span class="refAuthor">, Card, S.</span><span class="refAuthor">, and A. Wiethuechter</span>, <span class="refTitle">"New Cryptographic Algorithms for HIP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-moskowitz-hip-new-crypto-04</span>, <time datetime="2020-01-23">23 January 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-moskowitz-hip-new-crypto-04">https://tools.ietf.org/html/draft-moskowitz-hip-new-crypto-04</a>&gt;</span>. </dd>
<dt id="RFC7401">[RFC7401]</dt>
<dd>
<span class="refAuthor">Moskowitz, R., Ed.</span><span class="refAuthor">, Heer, T.</span><span class="refAuthor">, Jokela, P.</span><span class="refAuthor">, and T. Henderson</span>, <span class="refTitle">"Host Identity Protocol Version 2 (HIPv2)"</span>, <span class="seriesInfo">RFC 7401</span>, <span class="seriesInfo">DOI 10.17487/RFC7401</span>, <time datetime="2015-04">April 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7401">https://www.rfc-editor.org/info/rfc7401</a>&gt;</span>. </dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Adam Wiethuechter</span></div>
<div dir="auto" class="left"><span class="org">AX Enterprize</span></div>
<div dir="auto" class="left"><span class="street-address">4947 Commercial Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Yorkville</span>, <span class="region">NY</span> <span class="postal-code">13495</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:adam.wiethuechter@axenterprize.com" class="email">adam.wiethuechter@axenterprize.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stuart W. Card</span></div>
<div dir="auto" class="left"><span class="org">AX Enterprize</span></div>
<div dir="auto" class="left"><span class="street-address">4947 Commercial Drive</span></div>
<div dir="auto" class="left">
<span class="locality">Yorkville</span>, <span class="region">NY</span> <span class="postal-code">13495</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stu.card@axenterprize.com" class="email">stu.card@axenterprize.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Robert Moskowitz</span></div>
<div dir="auto" class="left"><span class="org">HTT Consulting</span></div>
<div dir="auto" class="left">
<span class="locality">Oak Park</span>, <span class="region">MI</span> <span class="postal-code">48237</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rgm@labs.htt-consult.com" class="email">rgm@labs.htt-consult.com</a>
</div>
</address>
</section>
</div>
<script>var toc = document.getElementById("toc");
var tocToggle = toc.querySelector("h2");
var tocNav = toc.querySelector("nav");

// mobile menu toggle
tocToggle.onclick = function(event) {
    if (window.innerWidth < 1024) {
 var tocNavDisplay = tocNav.currentStyle ? tocNav.currentStyle.display : getComputedStyle(tocNav, null).display;
 if (tocNavDisplay == "none") {
     tocNav.style.display = "block";
 } else {
     tocNav.style.display = "none";
 }
    }
}

// toc anchor scroll to anchor
tocNav.addEventListener("click", function (event) {
    event.preventDefault();
    if (event.target.nodeName == 'A') {
 if (window.innerWidth < 1024) {
     tocNav.style.display = "none";
 }
 var href = event.target.getAttribute("href");
 var anchorId = href.substr(1);
 var anchor =  document.getElementById(anchorId);
 anchor.scrollIntoView(true);
 window.history.pushState("","",href);
    }
});

// switch toc mode when window resized
window.onresize = function () {
    if (window.innerWidth < 1024) {
 tocNav.style.display = "none";
    } else {
 tocNav.style.display = "block";
    }
}
</script>
</body>
</html>
