

INTERNET DRAFT                                               Gene Ma
Category: Informational              tti (telecom technologies inc.)
Date: October 1998                      
Expires: April 1999        

       H.323 Signaling and SS7 ISUP Gateway: Procedure Interworking
      	        <draft-ma-h323-isup-gateway-00.txt> 

Status of this Memo

This document is an Internet-Draft.  Internet-Drafts are working 
documents of the Internet Engineering Task Force (IETF), its areas, and 
its working groups.  Note that other groups may also distribute working 
documents as Internet-Drafts.

Internet-Drafts are draft documents valid for a maximum of six months 
and may be updated, replaced, or obsoleted by other documents at any 
time.  It is inappropriate to use Internet-Drafts as reference material 
or to cite them other than as "work in progress."

To view the entire list of current Internet-Drafts, please check the 
"1id-abstracts.txt" listing contained in the Internet-Drafts Shadow 
Directories on ftp.is.co.za (Africa), ftp.nordu.net (Northern Europe), 
ftp.nis.garr.it (Southern Europe), munnari.oz.au (Pacific Rim), 
ftp.ietf.org (US East Coast), or ftp.isi.edu (US West Coast).


Abstract

This document describes protocol procedure interworking in designing
signaling gateway between H.323 and SS7 ISUP, especially the procedure
and message mapping between H.225/H.245 and SS7 ISUP.


Table of Contents

1.0 Introduction
2.0 Acronyms
3.0 Basic Call Control and Signaling Overview
3.1 SS7 IUSP Protocol
3.2 H.225 and H.245 Protocols
4.0 H.323 to ISUP Interworking
4.1 Successful Basic Call Setup
4.2 Unsuccessful Basic Call Setup
4.3 Basic Call Release
5.0 Acknowledgements
6.0 References
7.0 Author


1.0 Introduction

One of the most important components in VoIP to ISDN/PSTN gateway is 
the signaling gateway, which is to perform protocol procedure 
interworking, message mapping, and gateway screening or firewall. H.225
and H.245 have been used by H.323 in VoIP for call signaling and media 
control protocols. In PSTN Common Channel Signaling, all the circuits
used for data or voice calls are controlled (i.e., setup and teardown)
by the SS7 ISUP protocol.

Because of the fundamental difference between packet-based IP network
and circuit-based ISDN/PSTN, the signaling protocols for these two 
networks are conceptually different. The H.323 to SS7 ISUP signaling
gateway needs to resolve the difference and interwork two protocols in
a smooth way, which is addressed in this document.


2.0 Acronyms

ACM - Address Complete Message
ANM - Answer Message
B-ISUP - Broadband ISUP
CIC - Circuit Identification Code
GK - Gate Keeper
IP - Internet Protocol
ISDN - Integrated Services Digital Network
ISUP - ISDN User Part
PSTN - Public Switched Telecommunication Network
RAS - Registration, Admission, and Status
REL - Release message
RLC - Release Complete Message
TSAP - Transport Service Access Point
VoIP - Voice over IP


3.0 Basic Call Control and Signaling Overview

3.1 SS7 IUSP Protocol

The SS7 ISUP protocol was created as the interexchange signaling between
ISDN access and PSTN , and also used as the interworking between ISDN
access and egress in PSTN. 

For an unrestricted 64-kpbs circuit switched example, the ISDN Q.931 and
SS7 ISUP interworking can be showed in Figure 1.

+--------+            +------+            +------+           +-------+
| Called |   Q.931    | Orig.|  SS7 ISUP  | Dest.|   Q.931   |Calling|
| Party  |            | Exch.|            | Exch.|           | Party |
+--------+            +------+            +------+           +-------+
    |                    |                    |                   |
    |--------SETUP------>|                    |                   |
    |                    |--------IAM-------->|                   |
    |<-----CALL PROC-----|                    |------SETUP------->|
    |                    |                    |                   |
    |                    |                    |<--CALL PROC (opt)-|
    |                    |                    |                   |
    |                    |                    |<-----ALERT--------|
    |                    |<-------ACM---------|                   |
    |<-------ALERT-------|                    |<-----CONN---------|
    |                    |<-------ANM---------|                   |
    |<-------CONN--------|                    |------CONN ACK---->|
    |                    |                    |                   |
    |---CONN ACK (opt)-->|                    |                   |
    |                    |                    |                   |
    +-------------------------------------------------------------+
    |                    Call Information Flow                    |
    +-------------------------------------------------------------+
    |                    |                    |                   |
    |                    |                    |<-----DISC---------|
    |                    |<-------REL---------|                   |
    |<------DISC---------|                    |------REL--------->|
    |                    |--------RLC-------->|                   |
    |-------REL--------->|                    |<-----REL COMP-----|
    |                    |                    |                   |
    |<------REL COMP-----|                    |                   |
    |                    |                    |                   |
       Figure 1. Q.931-ISUP interworking for an ISDN call control

One of the important information elements in the Q.931 SETUP message 
is the B-channel Bearer Capability, which is put in the ISUP User 
Service Information parameter to indicate the requested service from
the network. The ISUP uses the CIC parameter in all of its messages to 
identify the physical circuit(s) being set up based on the bearer
request from the called party.

In telecommunication industry, any emerging networks, including ISDNs,
have to interwork with other existing networks, notably the PSTNs that
are the largest and most numerous among the existing networks. For
example, a digital telephone set connected to an ISDN basic rate (2B+D)
interface certainly needs to be able to talk with a conventional set to
the conventional PSTN, which the bearer capability of speech or 3.1-kHz
audio is requested from the network to set up the call. By using ISUP,
there is no change required for either ISDN or PSTN, and protocol 
conversion is provided at the ISDN interworking exchanges.  

3.2 H.225 and H.245 Protocols

As we know, the packet-based IP network has the fundamental differences
from the circuit-based network PSTN. One of the important differences is
that there is no actual channel, such as ISDN B-channel or PSTN trunk
circuit, in the IP network. In other words, the H.323 terminals can have
more "channels", logical channels to carry more than one application,
such as video, audio or data, in ONE call. Because of this difference,
the call control in VoIP specified in ITU H.323 is more complicated.

In circuit-based network, the call signaling (i.e., setup and teardown)
and bearer capability control are processed in one protocol, Q.931 for
ISDN and ISUP for SS7 network. However, since different H.323 terminals
in VoIP may have different logical channel capabilities, ITU H.323 has
specified the call signaling and bearer capability control in two
separate protocols, H.225 and H.245.

The call signaling specified in H.225 begins by exchanging the RAS
information on the unreliable channel. This processing is followed by
the call setup sequence through a reliable channel, which is based on
Q.931 protocol with modifications. One modification is the bearer 
capability information element in SETUP message can be ignored if the
call is bounded in the packet-based network, in which the bearer is set
up by H.245. Another difference is that closing H.225 call signaling 
channel is not ending the call unless the H.245 channel is also closed.
The Release and DISConnect messages in Q.931 are forbidden in H.225 for
a H.323 entity.

H.245 uses the reliable H.225 call signaling channel to perform H.245
control functions, such as master/slave determination, terminal
capability exchange, open/closing logical channel, and others. During
the terminal capability exchange procedure, both ends are based on
their own terminal capability to set up the mutual acceptable bearer
service to the network. Then logical channel(s) are opened to handle
the bearer capability, for example, two channels for video and one for
audio. This procedure is very similar to the bearer capability request
in the ISDN Q.931 and SS7 ISUP.


4.0 H.323 to ISUP Interworking

After having a brief overview on call signaling and control for both
circuit-based and packet-based networks, interworking between SS7 ISUP
and H.323 (actually H.225 and H.245) becomes quite straightforward. As
mentioned in Section 3, the bearer capability set up within the packet-
based network is done by H.245. However, for a signaling gateway
between packet-based network and circuit network, the information from
the bearer capability information element in the H.225 SETUP message is
enough to set up a call in the ISDN or PSTN through SS7 ISUP. H.245 is
just used for logical channel set up based on bearer capability carried
in the H.225 SETUP message.

The following sections describes the procedure interworking between
ISUP and H.225/H.245.

4.1 Successful Basic Call Setup

In Figure 2, H.245 control channel procedure may only contain logical
channel setup messages since the H.323 terminal that initiate the call
knows only one logical channel with the requested bearer capability
needed for the call. Remember that circuit-based ISDN or PSTN has only
one bearer capability for a call. 

+------+        H.323/        +-----------+     SS7 ISUP    +------+
| H323 |        H.225/        | Signaling |                 | Dest.|
|  GK  |        H.245         |  Gateway  |                 | Exch.|
+------+                      +-----------+                 +------+
   |                                |                           |
   |----H.225 SETUP (with bearer)-->|                           |
   |                                |------------IAM----------->|
   |<---H.225 CALL PROC-------------|                           |
   |                                |<-----------ACM------------|
   |<---H.225 ALERT-----------------|                           |
   |                                |<-----------ANM------------|
   |<---H.225 CONN------------------|                           |
   |                                |                           |
   |<==H.245 Capability Exchanges==>|                           |
   |<==H.245 Logical Channel Setup=>|                           |
   |                                |                           |
   +------------------------------------------------------------+
   |                    Media Information Flow                  |
   +------------------------------------------------------------+
       Figure 2. Successful Call Setup by Signaling Interworking

The signaling gateway can, as optional, immediately start the H.245
logical channel setup procedure based on the TSAP address given in
the H.225 SETUP message without waiting for the CONNect message, which
can reduce the entire call setup time. However, media information will
not start to flow before the called party, a H.323 terminal in this
example, received the H.225 CONNect message, even H.245 has finished
the logical channel setup. We highly recommend the implementation of
signaling gateway to use this option for H.245 control channel setup,
which is showed in the following figure.

+------+        H.323/        +-----------+     SS7 ISUP    +------+
| H323 |        H.225/        | Signaling |                 | Dest.|
|  GK  |        H.245         |  Gateway  |                 | Exch.|
+------+                      +-----------+                 +------+
   |                                |                           |
   |----H.225 SETUP (with bearer)-->|                           |
   |                                |------------IAM----------->|
   |<---H.225 CALL PROC-------------|                           |
   |                                |                           |
   |<==H.245 Logical Channel Setup=>|                           |
   |                                |<-----------ACM------------|
   |<---H.225 ALERT-----------------|                           |
   |                                |                           |
   |<---H.225 CONN------------------|<-----------ANM------------|
   |                                |                           |
   +------------------------------------------------------------+
   |                     Media Information Flow                 |
   +------------------------------------------------------------+
       Figure 3. Successful Call Setup with a H.245 Option

For the call initiated from ISDN or PSTN side to a H.323 terminal, the
call setup procedure flow will be similar to Figure 2 or 3. Also, the
H.245 logical channel setup procedure can be performed based on the
bearer capability information in the ISUP IAM without waiting for the
H.225 CONNect message. Figure 4 shows a successful call setup from an
ISDN party to a H.323 terminal.

+------+        H.323/        +-----------+     SS7 ISUP    +------+
| H323 |        H.225/        | Signaling |                 | Dest.|
|  GK  |        H.245         |  Gateway  |                 | Exch.|
+------+                      +-----------+                 +------+
   |                                |                           |
   |                                |<-----------IAM------------|
   |<---H.225 SETUP (with bearer)---|                           |
   |                                |                           |
   |<==H.245 Capability Exchanges==>|                           |
   |<==H.245 Logical Channel Setup=>|                           |
   |                                |                           |
   |----H.225 ALERT---------------->|                           |
   |                                |------------ACM----------->|
   |----H.225 CONN----------------->|                           |
   |                                |------------ANM----------->|
   |                                |                           |
   +------------------------------------------------------------+
   |                     Media Information Flow                  |
   +------------------------------------------------------------+
       Figure 4. Successful Call Setup Initiated from ISDN

It is noted that no H.245 capability exchanges procedure is required
in the Figure 4. When a H.323 terminal initiates the call to an ISDN
called party, it knows its own terminal capability that is carried by
the bearer capability information element in the H.225 SETUP message
sent the signaling gateway. If the gateway has the compatible terminal
capability, it forms an ISUP IAM and sends to the ISDN called party
through SS7 ISUP protocol.  

4.2 Unsuccessful Basic Call Setup

In ISDN or PSTN, many causes are attributed to unsuccessful call setup,
such as called party busy, resource unavailable, bearer service not
implemented, and others. After the destination exchange receives the
IAM and determines that the call is not able to complete, it sends back
an ISUP REL message with the reason. At the originating exchange, the
ISUP REL message is mapped into the Q.931 DISConnect message and sent
to the calling party to end the call.

However, a H.225 reliable call signaling channel is not set up until
the H.225 CONNect message is received. Therefore, in an unsuccessful
call setup across between ISDN (or PSTN) and packet-based network, no
H.225 call signaling channel is established since no H.225 CONNect
message mapped from the ISUP ANM is received. Instead, H.245 session
end procedure is used to end the call. The Figures 5 and 6 show the
unsuccessful call setup caused by either the H.323 terminal or an ISDN
party.

+------+        H.323/        +-----------+     SS7 ISUP    +------+
| H323 |        H.225/        | Signaling |                 | Dest.|
|  GK  |        H.245         |  Gateway  |                 | Exch.|
+------+                      +-----------+                 +------+
   |                                |                           |
   |----H.225 SETUP (with bearer)-->|                           |
   |                                |------------IAM----------->|
   |<---H.225 CALL PROC-------------|                           |
   |                                |                           |
   |<==H.245 Logical Channel Setup=>|                           |
   |                                |<-----REL (with cause)-----|
   |<==H.245 End Session Command===>|                           |
   |                                |                           |   
      Figure 5. Unsuccessful Call Setup caused by the ISDN party


+------+        H.323/        +-----------+     SS7 ISUP    +------+
| H323 |        H.225/        | Signaling |                 | Dest.|
|  GK  |        H.245         |  Gateway  |                 | Exch.|
+------+                      +-----------+                 +------+
   |                                |                           |
   |                                |<-----------IAM------------|
   |<---H.225 SETUP (with bearer)---|                           |
   |                                |                           |
   |<===H.245 Capability Setup======|                           |
   |                                |                           |
   |====H.245 Capability Reject====>|                           |
   |                                |------REL (with cause)---->|
   |<===H.245 End Session Command==>|                           |
   |                                |                           |   
     Figure 6. Unsuccessful Call Setup caused by H.323 Terminal
 

4.3 Basic Call Release

In packet-based network, the H.225 Release Complete message and the
H.245 session end procedure are used to release an established call.
The call release initiated by the H.323 terminal through the signaling
gateway is showed in Figure 4.

+------+        H.323/          +-----------+    SS7 ISUP   +------+
| H323 |        H.225/          | Signaling |               | Dest.|
|  GK  |        H.245           |  Gateway  |               | Exch.|
+------+                        +-----------+               +------+
   |                                  |                         |
   |===H.245 End Session Command=====>|                         |
   |                                  |------------REL--------->|
   |<==H.245 End Session Command======|                         |
   |                                  |<-----------RLC----------|
   |----H.225 Release Complete------->|                         |
   |                                  |                         |
       Figure 7. Basic Call Release by Signaling Interworking

The call release initiated from the ISDN or PSTN side is showed in
Figure 6, which is the same as that is showed in Figure 5.

+------+        H.323/          +-----------+    SS7 ISUP   +------+
| H323 |        H.225/          | Signaling |               | Dest.|
|  GK  |        H.245           |  Gateway  |               | Exch.|
+------+                        +-----------+               +------+
   |                                  |                         |
   |                                  |<-----------REL----------|
   |<==H.245 End Session Command======|                         |
   |===H.245 End Session Command=====>|                         |
   |                                  |------------RLC--------->|
   |<---H.225 Release Complete--------|                         |
   |                                  |                         |   
         Figure 8. Basic Call Release by Signaling Interworking


5.0 Acknowledgement

The author would like to thank Wesley Hicks for his comments on this
document.


6.0 Further Studies

The H.323 to ISUP interworking presented in this document is based on
version 1 of the ITU-T H.323 standards. The next step is to consider
the fast connect procedures specified in the version 2 of the H.323 for
the signaling gateway design. It is also important to extend the current
work for signaling interworking between H.323 and B-ISUP.


7.0 References

[1] ANSI T1.113-1993, "Signaling System No. 7 (SS7) - Integrated
Services Digital Network (ISDN) User Part"

[2] ITU-T Recommendation Q.931-1993, "Digital Subscriber Signaling
System No. 1 (DSS 1) - ISDN User-Network Interface Layer 3
Specification for Basic Call Control"

[3] ITU-T Recommendation H.323-1996, "Visual telephone systems and 
equipment for area networks which provide a non-guaranteed quality of
service"

[4] ITU-T Recommendation Q.225-1996, "Media stream packetization and
synchronization on non-guaranteed quality of service LANs"

[5] ITU-T Recommendation Q.245-1996, "Control protocol for multimedia
communication"


8.0 Author

Gene Ma
tti (telecom technologies inc.)
1700 North Collins Blvd.
Richardson, Texas 75080
Tel: 972-301-4987
Email: gene.ma@ttimail.com
