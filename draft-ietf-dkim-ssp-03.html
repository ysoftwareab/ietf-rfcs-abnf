<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DKIM Author Signing Practices (ASP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DKIM Author Signing Practices (ASP)">
<meta name="keywords" content="email, e-mail, rfc2822, rfc 2822, rfc822, rfc 822, rfc2821, rfc
        2821, rfc821, rfc 821, rfc4871, rfc 4871, DKIM, domain keys, ASP,
	architecture, mta, user, delivery, smtp,
        submission, Internet, mailfrom, author, return address">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">E. Allman</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Sendmail, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">J. Fenton</td></tr>
<tr><td class="header">Expires: August 26, 2008</td><td class="header">Cisco Systems, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">M. Delany</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Yahoo! Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">J. Levine</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Taughannock Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">February 23, 2008</td></tr>
</table></td></tr></table>
<h1><br />DKIM Author Signing Practices (ASP)<br />draft-ietf-dkim-ssp-03</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on August 26, 2008.</p>

<h3>Abstract</h3>

<p>DomainKeys Identified Mail (DKIM) defines a domain-level
   authentication framework for email using public-key cryptography and
   key server technology to permit verification of the source and
   contents of messages by either Mail Transport Agents (MTAs) or Mail
   User Agents (MUAs).  The primary DKIM protocol is described in
   <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.

   This document describes the records that authors' domains can use to advertise
   their practices for signing their outgoing mail, and how other hosts can access
   those records.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Language and Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Terms Imported from DKIM Signatures Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Valid Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Author Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.4.</a>&nbsp;
Author Domain<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.5.</a>&nbsp;
Alleged Author<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.6.</a>&nbsp;
Author Signing Practices<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.7.</a>&nbsp;
Author Signature<br />
<a href="#anchor10">3.</a>&nbsp;
Operation Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.1.</a>&nbsp;
ASP Usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.2.</a>&nbsp;
ASP Results<br />
<a href="#anchor13">4.</a>&nbsp;
Detailed Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dnsrep">4.1.</a>&nbsp;
DNS Representation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.2.</a>&nbsp;
Publication of ASP Records<br />
<a href="#anchor15">5.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.1.</a>&nbsp;
ASP Specification Tag Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.2.</a>&nbsp;
ASP Outbound Signing Practices Registry<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.3.</a>&nbsp;
ASP Flags Registry<br />
<a href="#anchor19">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">6.1.</a>&nbsp;
ASP Threat Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">6.2.</a>&nbsp;
DNS Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#wildcards">6.3.</a>&nbsp;
DNS Wildcards<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
References - Normative<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
References - Informative<br />
<a href="#anchor24">Appendix&nbsp;A.</a>&nbsp;
Usage Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">A.1.</a>&nbsp;
Single Location Domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">A.2.</a>&nbsp;
Bulk Mailing Domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">A.3.</a>&nbsp;
Bulk Mailing Domains with Discardable Mail<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">A.4.</a>&nbsp;
Third Party Senders<br />
<a href="#anchor29">Appendix&nbsp;B.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor30">Appendix&nbsp;C.</a>&nbsp;
Change Log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">C.1.</a>&nbsp;
Changes since -ietf-dkim-02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">C.2.</a>&nbsp;
Changes since -ietf-dkim-ssp-01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">C.3.</a>&nbsp;
Changes since -ietf-dkim-ssp-00<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">C.4.</a>&nbsp;
Changes since -allman-ssp-02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">C.5.</a>&nbsp;
Changes since -allman-ssp-01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">C.6.</a>&nbsp;
Changes since -allman-ssp-00<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>DomainKeys Identified Mail (DKIM) defines a mechanism by which email
	 messages can be cryptographically signed, permitting a signing domain
	 to claim responsibility for the introduction of a message into the
	 mail stream.  Message recipients can verify the signature by querying
	 the signer's domain directly to retrieve the appropriate public key,
	 and thereby confirm that the message was attested to by a party in
	 possession of the private key for the signing domain.
</p>
<p>However, the legacy of the Internet is such that not all messages
	 will be signed, and the absence of a signature on a message is not an
	 a priori indication of forgery.  In fact, during early phases of
	 deployment it is very likely that most messages will remain
	 unsigned.  However, some domains might decide to sign all of their
	 outgoing mail, for example, to protect their brand name.  It is
	 desirable for such domains to be able to advertise that fact
	 to other hosts.  This is the topic of Author Signing Practices (ASP).
</p>
<p>Hosts implementing
	 this specification can inquire what Author Signing Practices
	 a domain advertises. This inquiry is called an Author
	 Signing Practices check.
</p>
<p>The detailed requirements for Author Signing Practices are given in
	 <a class='info' href='#RFC5016'>[RFC5016]<span> (</span><span class='info'>Thomas, M., &ldquo;Requirements for a DomainKeys Identified Mail (DKIM) Signing Practices Protocol,&rdquo; October&nbsp;2007.</span><span>)</span></a>.  This document refers extensively
	 to <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> and assumes the reader
	 is familiar with it.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Requirements Notation:</dt>
<dd>
	     The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
             NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
             "OPTIONAL" in this document are to be interpreted as described
             in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>
           
</dd>
</dl></blockquote><p>
       
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Language and Terminology</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Terms Imported from DKIM Signatures Specification</h3>

<p>Some terminology used herein is derived directly from
	   <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. 
	   In several cases, references in that document to Sender have
	   been changed to Author here, to emphasize the relationship to
	   the Author address(es) in the From: header field described
	   in <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>.
	   Briefly,
	 
	 </p>
<ul class="text">
<li>A "Signer" is the agent that signs a message, as defined in
	     section 2.1 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
<li>A "Selector" specifies which of the keys published by a signing
	     domain is to be queried, as defined in section 3.1 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
<li>A "Local-part" is the part of an address preceding the @ sign,
	     as defined in  <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a> and used in
	     <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
</ul>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Valid Signature</h3>

<p>A "Valid Signature" is any signature on a message which correctly
	   verifies using the procedure described in section 6.1 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Author Address</h3>

<p>An "Author Address" is an email address in the From header
	   field of a message <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>.
	   If the From header field
	   contains multiple addresses, the message has multiple Author Addresses.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Author Domain</h3>

<p>An "Author Domain" is everything to the right of the "@" in an
	   Author Address (excluding the "@" itself).
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Alleged Author</h3>

<p>An "Alleged Author" is an Author Address of a message;
	   it is "alleged" because it has not yet been
	   verified.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6"></a><h3>2.6.&nbsp;
Author Signing Practices</h3>

<p>"Author Signing Practices" (or just "practices") consist of a
	   machine-readable record published by the domain of an Alleged
	   Author which includes statements about the domain's practices 
	   with respect to mail it sends with its domain in the From: line.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.7"></a><h3>2.7.&nbsp;
Author Signature</h3>

<p>An "Author Signature" is any Valid Signature where the
	   identity of the user or agent on behalf of which the message is
	   signed (listed in the "<tt>i=</tt>"
	   tag or its default value from the "<tt>d=</tt>"
	   tag) matches an Author Address in the message.
	   When the identity of the user or agent includes a
	   Local-part, the identities match if the Local-parts match and
	   the domains match. Otherwise, 
	   the identities match if the domains match.
</p>
<p>For example, if
	   a message has a Valid Signature, with the DKIM-Signature
           field containing <tt>i=a@domain.example</tt>,
	   then domain.example
           is asserting that it takes responsibility for the message.
           If the message's From: field contains the address
	   <tt>b@domain.example</tt>
           and an ASP query produces a <tt>dkim=all</tt>
	   or <tt>dkim=discardable</tt> result,
           that would mean that the message does not have a valid Author
           Signature. Even though the message is signed by the same domain,
           its failure to satisfy ASP could be problematic.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Operation Overview</h3>

<p>Domain owners can publish Author Signing Practices via a query
	 mechanism such as the Domain Name System; specific details are
	 given in <a class='info' href='#dnsrep'>Section&nbsp;4.1<span> (</span><span class='info'>DNS Representation</span><span>)</span></a>.
</p>
<p>Hosts can look up the Author Signing Practices of
	 the domain(s) specified by the Author Address(es) as described in
	 <a class='info' href='#checkproc'>Section&nbsp;4.2.2<span> (</span><span class='info'>Author Signing Practices Lookup Procedure</span><span>)</span></a>.
	 If a message has multiple Author Addresses
	 the ASP lookups SHOULD be performed independently on each address.
	 This standard does not address the process a host might use to
	 combine the lookup results.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
ASP Usage</h3>

<p>Depending on the Author Domain(s) and the signatures in a
	   message, a recipient gets varying amounts of useful information
	   from each ASP lookup.

	 </p>
<ul class="text">
<li>If a message has no Valid Signature, the ASP result is directly
	     relevant to the message.
</li>
<li>If a message has a Valid Signature from an Author Domain,
	     ASP provides no benefit relative to that domain
	     since the message is already known
	     to be compliant with any possible ASP for that domain.
</li>
<li>If a message has a Valid Signature from a domain other than
	     an Author Domain, the receiver can use both the Signature and
	     the ASP result in its evaluation of the message.
</li>
</ul>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
ASP Results</h3>

<p>An Author Signing Practices lookup for an Author Address produces one of four possible
	   results:

	 

	 </p>
<ul class="text">
<li>Messages from this domain might or might not have an author signature.
	     This is the default
	     if the domain exists in the DNS but no record is found.
</li>
<li>All messages from this domain are signed.
</li>
<li>All messages from this domain are signed and discardable.
</li>
<li>The domain does not exist.
</li>
</ul>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Detailed Description</h3>

<a name="dnsrep"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
DNS Representation</h3>

<p>Author Signing Practices records are published using the DNS TXT
	     resource record type.
</p>
<p>NON-NORMATIVE DISCUSSION [to be removed before publication]:  There has been considerable discussion
	     on the DKIM WG mailing list regarding the relative advantages of
	     TXT and a new resource record (RR) type. Read the archive for details.
</p>
<p>The RDATA for ASP resource records is textual in format, with
	     specific syntax and semantics relating to their role in describing
	     Author Signing Practices.  The "Tag=Value List" syntax described in
	     section 3.2 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> is used.  Records not in compliance with
	     that syntax or the syntax of individual tags described in Section 4.3
	     MUST be ignored (considered equivalent to a NODATA result) for
	     purposes of ASP, although they MAY cause the logging
	     of warning messages via an appropriate system logging mechanism.
	     If the RDATA contains multiple character strings, the strings are
	     logically concatenated with no delimiters between the strings.
	   
</p>
<p>The ASP record for a domain is published at a location
	     in the domain's
	     DNS hierarchy prefixed by _asp._domainkey.; e.g., the ASP record for
	     example.com would be a TXT record that is published at
	     <tt>_asp._domainkey.example.com</tt>.
	     A domain MUST NOT publish more than one ASP record;
	     the semantics of an ASP lookup that returns multiple ASP records
	     for a single domain are undefined.
	     (Note that example.com and mail.example.com are different domains.)
	   
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Publication of ASP Records</h3>

<p>Author Signing Practices are intended to apply to all mail sent
        from the domain of an Alleged Author. In order to ensure that ASP
        applies to any hosts within that domain (e.g., www.example.com,
        ftp.example.com.) the ASP lookup algorithm looks up one level in
        the domain tree. For example, mail signed by www.example.com could
        be covered by the ASP record for example.com. This avoids
        the need to include an ASP record for every name
        within a given domain.
</p>
<p>Normally, a domain expressing Author Signing Practices will want to
        do so for both itself and all of its "descendants" (child domains at
        all lower levels). Domains wishing to do so MUST publish ASP records
        for the domain itself and any subdomains.
</p>
<p>Wildcards within a domain publishing ASP records pose a
	particular problem.  This is discussed in more detail in <a class='info' href='#wildcards'>Section&nbsp;6.3<span> (</span><span class='info'>DNS Wildcards</span><span>)</span></a>.
</p>
<a name="syntax"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Record Syntax</h3>

<p>ASP records use the "tag=value" syntax described in section 3.2 of
	     <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<p>Tags used in ASP records are described below.  Unrecognized tags MUST be
	     ignored. In the ABNF below, the WSP token is imported from
	     <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>.  The ALPHA and DIGIT tokens
	     are imported from <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>.

	   

	   </p>
<blockquote class="text"><dl>
<dt>dkim=</dt>
<dd>Outbound signing practices for the domain (plain-text;
	       REQUIRED).  Possible values are as follows:

	       
<blockquote class="text"><dl>
<dt>unknown</dt>
<dd>The domain might sign some or all email.
</dd>
<dt>all</dt>
<dd>All mail from the domain is signed
		   with an Author Signature.
</dd>
<dt>discardable</dt>
<dd>All mail from the domain is signed
		   with an Author Signature.
		   Furthermore, if a message arrives without a
		   valid Author Signature
		   due to modification in transit, submission via a path
		   without access to a signing key, or other reason,
		   the domain encourages the recipient(s) to discard it.
</dd>
</dl></blockquote>
             

	       
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      asp-dkim-tag = %x64.6b.69.6d *WSP "="
            *WSP ("unknown" / "all" / "discardable")
</pre></div>
	     
</dd>
<dt>t=</dt>
<dd>Flags, represented as a colon-separated list of names (plain-text;
	       OPTIONAL, default is that no flags are set).  Flag values are:

	       
<blockquote class="text"><dl>
<dt>s</dt>
<dd>The signing practices apply only to the named domain, and not
		   to subdomains.
</dd>
</dl></blockquote>

	       
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      asp-t-tag    = %x74 *WSP "=" *WSP { asp-t-tag-flag
            0*( *WSP ":" *WSP asp-t-tag-flag )
      asp-t-tag-flag = "s" / hyphenated-word
            ; for future extension
      hyphenated-word =  ALPHA [ *(ALPHA / DIGIT / "-")
            (ALPHA / DIGIT) ]
</pre></div>
	     
</dd>
<dt></dt>
<dd>Unrecognized flags MUST be ignored.
</dd>
</dl></blockquote>

<a name="checkproc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Author Signing Practices Lookup Procedure</h3>

<p>Hosts doing an ASP lookup MUST produce a result that is
        semantically equivalent to applying the following steps in the order
        listed below. In practice, several of these steps can be performed in
        parallel in order to improve performance. However, implementations
        SHOULD avoid doing unnecessary DNS lookups. For the purposes of this
        section a "valid ASP record" is one that is both syntactically and
        semantically correct; in particular, it matches the ABNF for a
        <tt>tag-list</tt> and includes a defined <tt>dkim=</tt> tag.</p>
<ol class="text">
<li><em>Fetch Named ASP Record.</em> The host
            MUST query DNS for a TXT record corresponding to the
            Author Domain prefixed by <tt>_asp._domainkey.</tt> (note the trailing
            dot). If the result of this query is a <tt>NOERROR</tt> response with an
            answer which is a valid ASP record, use that record;
	      otherwise, continue to the next step.
</li>
<li><em>Verify Domain Exists.</em> The host MUST
            perform a DNS query for a record corresponding to the Author
            Domain (with no prefix). The type of the query can be of any type,
            since this step is only to determine if the domain itself exists
            in DNS. This query MAY be done in parallel with the query made in
            step 2. If the result of this query is an
	      <tt>NXDOMAIN</tt> error, the algorithm MUST terminate
              with an appropriate error. 

	      
<blockquote class="text">
<p>NON-NORMATIVE DISCUSSION: Any resource record type
                could be used for this query since the existence of a
                resource record of any type will prevent an <tt>NXDOMAIN</tt> error. 
                MX is a reasonable choice for
                this purpose is because this record type is thought to
                be the most common for likely domains, and will
                therefore result in a result which can be more readily
                cached than a negative result.
</p>
</blockquote>
</li>
<li><em>Try Parent Domain.</em> The host MUST
            query DNS for a TXT record for the immediate parent
            domain, prefixed with <tt>_asp._domainkey.</tt>
 If the result of
            this query is anything other than a <tt>NOERROR</tt> response with a valid ASP
            record, the algorithm terminates with a result
            indicating that no ASP record was present. If the ASP "t"
            tag exists in the response and any of the flags is "s"
            (indicating it does not apply to a subdomain), the
	      algorithm also terminates without finding an ASP record.
            Otherwise, use that record.
</li>
</ol>

<p>If any of the queries involved in the Author Signing Practices
        Check result in a <tt>SERVFAIL</tt> error response,
        the algorithm terminates without returning a result;
        possible actions include queuing the message or returning an SMTP
        error indicating a temporary failure.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>ASP introduces some new namespaces that have been registered with
	 IANA.  In all cases, new values are assigned only for values that
	 have been documented in a published RFC that has IETF Consensus
	 <a class='info' href='#RFC2434'>[RFC2434]<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; October&nbsp;1998.</span><span>)</span></a>.
</p>
<p>INFORMATIVE NOTE [ to be removed before publication ]: RFC 4871 defines
	 a selector as a sub-domain, importing the term from RFC 2822.  A sub-domain
	 starts with a letter or digit, hence names such as _asp that start with
	 an underscore cannot collide with valid selectors.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
ASP Specification Tag Registry</h3>

<p>An ASP record provides for a list of specification tags.  IANA has
	   established the ASP Specification Tag Registry for
	   specification tags that can be used in ASP fields.
</p>
<p>The initial entries in the registry comprise:

	       </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      +------+-----------------+
      | TYPE | REFERENCE       |
      +------+-----------------+
      | dkim | (this document) |
      | t    | (this document) |
      +------+-----------------+
</pre></div><p>

<p>ASP Specification Tag Registry Initial Values
</p>
	 

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
ASP Outbound Signing Practices Registry</h3>

<p>The <tt>dkim=</tt> tag spec, defined in <a class='info' href='#syntax'>Section&nbsp;4.2.1<span> (</span><span class='info'>Record Syntax</span><span>)</span></a>, provides for
	   a value specifying Outbound Signing Practices.  IANA has
	   established the ASP Outbound Signing Practices Registry for
	   Outbound Signing Practices.
</p>
<p>The initial entries in the registry comprise:

	       </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      +-------------+-----------------+
      | TYPE        | REFERENCE       |
      +-------------+-----------------+
      | unknown     | (this document) |
      | all         | (this document) |
      | discardable | (this document) |
      +-------------+-----------------+
</pre></div><p>

<p>ASP Outbound Signing Practices Registry Initial Values
</p>
	 

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
ASP Flags Registry</h3>

<p>The <tt>t=</tt> tag spec, defined in <a class='info' href='#syntax'>Section&nbsp;4.2.1<span> (</span><span class='info'>Record Syntax</span><span>)</span></a>, provides for
	   a value specifying Flags.  IANA has
	   established the ASP Flags Registry for
	   ASP Flags.
</p>
<p>The initial entries in the registry comprise:

	       </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
      +------+-----------------+
      | TYPE | REFERENCE       |
      +------+-----------------+
      | s    | (this document) |
      +------+-----------------+
</pre></div><p>

<p>ASP Flags Registry Initial Values
</p>
	 

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>Security considerations in the Author Signing Practices are
    mostly related to attempts on the part of malicious senders to
    represent themselves as authors for whom they are not authorized
    to send mail, often in an attempt to defraud either the recipient
    or an Alleged Author.
</p>
<p>Additional security considerations regarding Author Signing
      Practices are found in <a class='info' href='#RFC4686'>the DKIM threat
      analysis<span> (</span><span class='info'>Fenton, J., &ldquo;Analysis of Threats Motivating DomainKeys Identified Mail (DKIM),&rdquo; September&nbsp;2006.</span><span>)</span></a> [RFC4686].
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
ASP Threat Model</h3>

<p>Email recipients often have a core set of content authors that
      they already trust.  Common examples include financial
      institutions with which they have an existing relationship and
      Internet web transaction sites with which they conduct
      business.
</p>
<p>Email abuse often seeks to exploit the name-recognition that
      recipients will have, for a legitimate email author, by
      using its domain name in the From: header field. Especially
      since many popular MUAs do not display the author's email
      address, there is no empirical evidence of the extent
      that this particular
      unauthorized use of a domain name contributes to recipient
      deception or that eliminating it will have significant effect.
</p>
<p>However, closing this exploit could facilitate some types of
      optimized processing by receive-side message filtering engines,
      since it could permit them to maintain higher-confidence
      assertions about From: header field uses of a domain, when the
      occurrence is authorized.
</p>
<p>Unauthorized uses of domain names occur elsewhere in messages,
      as do unauthorized uses of organizations' names.  These attacks
      are outside the scope of this specification.
</p>
<p>ASP does not provide any benefit--nor, indeed, have any effect
      at all--unless an external system acts upon the verdict, either by
      treating the message differently during the delivery process or by
      showing some indicator to the end recipient.  Such a system is out
      of scope for this specification.
</p>
<p>ASP Checkers perform up to three DNS lookups per Alleged Author
      Domain.  Since these lookups are driven by domain names in email
      message headers of possibly fraudulent email, legitimate ASP
      Checkers can become participants in traffic multiplication
      attacks.
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
DNS Attacks</h3>

<p>An attacker might attack the DNS infrastructure in an
	attempt to impersonate ASP records, in an attempt to influence
	a receiver's decision on how it will handle mail.  However,
	such an attacker is more likely to attack at a higher level,
	e.g., redirecting A or MX record lookups in order to
	capture traffic that was legitimately intended for the target
	domain.  These DNS security issues are addressed by
	<a class='info' href='#RFC4033'>DNSSEC<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4033].
</p>
<p>Because ASP operates within the framework of the legacy e-mail
	system, the default result in the absence of an ASP record is that
	the domain does not sign all of its messages.  It is therefore
	important that the ASP clients distinguish a DNS failure such as
	<tt>SERVFAIL</tt>
	from other DNS errors so that appropriate actions can be taken.
</p>
<a name="wildcards"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
DNS Wildcards</h3>

<p>Wildcards within a domain publishing ASP records, including
	  but not limited to wildcard MX records,
	  pose a particular
	  problem.  While referencing the immediate parent domain
	  allows the discovery of an ASP record corresponding to an
	  unintended immediate-child subdomain, wildcard records apply
	  at multiple levels.  For example, if there is a wildcard
	  MX record for "example.com", the domain
	  "foo.bar.example.com" can receive mail through the named
	  mail exchanger.  Conversely, the existence of the record
	  makes it impossible to tell whether "foo.bar.example.com" is
	  a legitimate name since a query for that name will not
	  return an <tt>NXDOMAIN</tt> error.
	  For that reason, ASP coverage
	  for subdomains of domains containing a wildcard record is
	  incomplete.

	<br />
<br />


	NON-NORMATIVE NOTE:  Complete ASP coverage of domains containing
	(or where any parent contains) wildcards generally cannot be
	provided by standard DNS servers.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;References - Normative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2434">[RFC2434]</a></td>
<td class="author-text"><a href="mailto:narten@raleigh.ibm.com">Narten, T.</a> and <a href="mailto:Harald@Alvestrand.no">H. Alvestrand</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2434">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;2434, October&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2434.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2434.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2434.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2822">[RFC2822]</a></td>
<td class="author-text">Resnick, P., &ldquo;<a href="http://tools.ietf.org/html/rfc2822">Internet Message Format</a>,&rdquo; RFC&nbsp;2822, April&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2822.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4686">[RFC4686]</a></td>
<td class="author-text">Fenton, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified Mail (DKIM)</a>,&rdquo; RFC&nbsp;4686, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4686.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;References - Informative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC5016">[RFC5016]</a></td>
<td class="author-text">Thomas, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5016">Requirements for a DomainKeys Identified Mail (DKIM) Signing Practices Protocol</a>,&rdquo; RFC&nbsp;5016, October&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5016.txt">TXT</a>).</td></tr>
</table>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Usage Examples</h3>

<p>These examples are intended to illustrate typical uses of ASP.
	 They are not intended to be exhaustive, nor to apply to every
	 domain's or mail system's individual situation.
</p>
<p>Domain managers are advised to consider the ways that mail
	   processing can modify messages in ways that will invalidate
	   an existing DKIM signature, such as mailing lists, courtesy
	   forwarders, and other paths that could add or modify
	   headers, or modify the message body.
	   In that case, if the modifications invalidate the DKIM signature,
	   recipient hosts will consider the mail not to
	   have an Author Signature, even though the signature was present
	   when the mail was originally sent.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Single Location Domains</h3>

<p>A common mail system configuration handles all of a domain's
	   users' incoming and outgoing mail through a single MTA or
	   group of MTAs.
	   In that case, the MTA(s) can be configured to sign outgoing
	   mail with an Author Signature.
</p>
<p>In this situation it might be appropriate to publish an ASP
	   record for the domain containing "all", depending on
	   whether the users also send mail through other paths that do
	   not apply an Author Signature.  Such paths could include
	   MTAs at hotels or hotspot networks used by travelling
	   users, or web sites that provide "mail an article"
	   features.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Bulk Mailing Domains</h3>

<p>Another common configuration uses a domain solely for bulk
	   or broadcast mail, with no individual human users, again typically
	   sending all the mail through a single MTA or group of MTAs
	   that can apply an Author Signature.
	   In this case, the domain's management can be confident that all
	   of its outgoing mail will be sent through the signing MTA.
	   Lacking individual users, the domain is unlikely to participate in
	   mailing lists, but could still send mail through other paths
	   that might invalidate signatures.
</p>
<p>Domain owners often use specialist mailing providers to
	   send their bulk mail.
	   In that case, the mailing provider needs access to a
	   suitable signing key in order to apply an Author Signature.
	   One possible route would be for the domain owner to generate
	   the key and give it to the mailing provider.
	   Another would be for the domain to delegate a subdomain to
	   the mailing provider, for example, bigbank.example might
	   delegate email.bigbank.example to such a provider.
	   In that case, the provider can generate the
	   keys and DKIM DNS records itself and use the subdomain
	   in the Author address in the mail.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
Bulk Mailing Domains with Discardable Mail</h3>

<p>In some cases, a domain might sign all its outgoing mail with
	   an Author Signature, but prefer that recipient systems
	   discard mail without a valid Author Signature to avoid confusion
	   from mail sent from sources that do not apply an Author Signature.
	   (This latter kind of mail is sometimes loosely called
	   "forgeries".)
	   In that case, it might be appropriate to publish an ASP record
	   containing "discardable".
	   Note that a domain SHOULD NOT publish a "discardable" record
	   if it wishes to maximize the likelihood that mail
	   from the domain is delivered,
	   since it could cause some fraction of the mail the
	   domain sends to be discarded.
</p>
<p>As a special case, if a domain sends no mail at all, it can safely
	   publish a "discardable" ASP record, since any mail with an
	   author address in the domain is a forgery.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4"></a><h3>A.4.&nbsp;
Third Party Senders</h3>

<p>Another common use case is for a third party to enter into
	   an agreement whereby that third party will send bulk or
	   other mail on behalf of a designated author domain, using
	   that domain in the RFC2822 From: or other headers. Due to
	   the many and varied complexities of such agreements, third
	   party signing is not addressed in this specification.  
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Acknowledgements</h3>

<p>This document greatly benefited from comments by
	 Steve Atkins, Jon Callas, Dave Crocker,
	 JD Falk, Arvel Hathcock,
	 Ellen Siegel, Michael Thomas, and Wietse Venema.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Change Log</h3>

<p><strong>NOTE TO RFC EDITOR: This section may be removed
      upon publication of this document as an RFC.</strong>
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1"></a><h3>C.1.&nbsp;
Changes since -ietf-dkim-02</h3>

<p>
	 </p>
<ul class="text">
<li>Merge in more text from ASP draft.
</li>
<li>Phrase actions as host's rather than checker.
</li>
<li>Explanatory description of i= matching.
</li>
<li>Lookup procedure consistently refers to one ASP record per lookup.
</li>
<li>Update security section w/ language from W. Venema
</li>
<li>Simplify imports of terms from other RFCs, add Local-part,
	     4234 -> 5234.
</li>
<li>Add usage example appendix.
</li>
<li>Add IANA considerations.
</li>
<li>Update authors list
</li>
</ul>

<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2"></a><h3>C.2.&nbsp;
Changes since -ietf-dkim-ssp-01</h3>

<p></p>
<ul class="text">
<li>Reworded introduction for clarity.
</li>
<li>Various definition
            clarifications.
</li>
<li>Changed names of practices to unknown, all, and discardable.
</li>
<li>Removed normative language mandating use of SSP in
	    particular situations (issue 1538).
</li>
<li>Clarified possible confusion over handling of syntax
            errors.
</li>
<li>Removed normative language from Introduction (issue 1538).
</li>
<li>Changed "Originator" to "Author" throughout (issue 1529).
</li>
<li>Removed all references to Third-Party Signatures (issues 1512,
            1521).
</li>
<li>Removed all mention of "Suspicious" (issues 1528, 1530).
</li>
<li>Removed "t=y" (testing) flag (issue 1540).
</li>
<li>Removed "handling" tag (issue 1513).
</li>
<li>Broke up the "Sender Signing Practices Check Procedure" into
            two algorithms: fetching the SSP record and interpretation thereof
            (issues 1531, 1535; partially addresses issue 1520).  Interpretation
	    is now the responsibility of the Evaluator.
</li>
<li>Document restructuring for better flow and remove redundancies
            (some may address issue 1523, but I'm not sure I understand that
            issue completely; also issues 1532, 1537).
</li>
<li>Removed all mention of how this interacts with users, even
            though it makes parts of the document harder to understand (issue
            1526).
</li>
<li>Introduced the concepts of "SSP Checker" and "Evaluator".
</li>
<li>Multiple author case now handled my separate invocations
	    of SSP checker by Evaluator (issue 1525).
</li>
<li>Removed check to avoid querying top-level domains.
</li>
<li>Changed ABNF use of whitespace from [FWS] to *WSP
	    (partially addresses issue 1543).
</li>
</ul>

<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.3"></a><h3>C.3.&nbsp;
Changes since -ietf-dkim-ssp-00</h3>

<p></p>
<ul class="text">
<li>Clarified Operation Overview and eliminated use of Legitimate
            as the counterpart of Suspicious since the words have different
            meanings.
</li>
<li>Improved discussion (courtesy of Arvel Hathcock) of the use of
            TXT records in DNS vs. a new RR type.
</li>
<li>Clarified publication rules for multilevel names.
</li>
<li>Better description of overall record syntax, in particular that
            records with unknown tags are considered syntactically
            correct.
</li>
<li>Clarified Sender Signing Practices Check Procedure, primarily
            by use of new term Author Domain.
</li>
<li>Eliminated section "Third-Party Signatures and Mailing Lists"
            that is better included in the DKIM overview document.
</li>
<li>Added "handling" tag to express alleged sending domain's
            preference about handling of Suspicious messages.
</li>
<li>Clarified handling of SERVFAIL error in SSP check.
</li>
<li>Replaced "entity" with "domain", since with the removal of
            user-granularity SSP, the only entities having sender signing
            policies are domains.
</li>
</ul>

<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.4"></a><h3>C.4.&nbsp;
Changes since -allman-ssp-02</h3>

<p></p>
<ul class="text">
<li>Removed user-granularity SSP and u= tag.
</li>
<li>Replaced DKIMP resource record with a TXT record.
</li>
<li>Changed name of the primary tag from "p" to "dkim".
</li>
<li>Replaced lookup algorithm with one which traverses upward at
            most one level.
</li>
<li>Added description of records to be published, and
            effect of wildcard records within the domain, on SSP.
</li>
</ul>

<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.5"></a><h3>C.5.&nbsp;
Changes since -allman-ssp-01</h3>

<p></p>
<ul class="text">
<li>Changed term "Sender Signing Policy" to "Sender Signing
            Practices".
</li>
<li>Changed query methodology to use a separate DNS resource record
            type, DKIMP.
</li>
<li>Changed tag values from SPF-like symbols to words.
</li>
<li>User level policies now default to that of the domain if not
            specified.
</li>
<li>Removed the "Compliance" section since we're still not clear on
            what goes here.
</li>
<li>Changed the "parent domain" policy to only search up one level
            (assumes that subdomains will publish SSP records if
            appropriate).
</li>
<li>Added detailed description of SSP check procedure.
</li>
</ul>

<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.6"></a><h3>C.6.&nbsp;
Changes since -allman-ssp-00</h3>

<p>From a "diff" perspective, the changes are extensive. Semantically,
        the changes are:</p>
<ul class="text">
<li>Added section on "Third-Party Signatures and Mailing Lists"
</li>
<li>Added "Compliance" (transferred from -base document). I'm not
            clear on what needs to be done here.
</li>
<li>Extensive restructuring.
</li>
</ul>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eric Allman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sendmail, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">6475 Christie Ave, Suite 350</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Emeryville, CA  94608</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 510 594 5501</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:eric+dkim@sendmail.org">eric+dkim@sendmail.org</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Jim Fenton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">MS SJ-9/2</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">170 W. Tasman Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Jose, CA  95134-1706</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 526 5914</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:fenton@cisco.com">fenton@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Mark Delany</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Yahoo! Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">701 First Avenue</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 408 349 6831</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:markd+dkim@yahoo-inc.com">markd+dkim@yahoo-inc.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Levine</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Taughannock Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">PO Box 727</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trumansburg, NY  14886</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 831 480 2300</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:standards@taugh.com">standards@taugh.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.taugh.com">http://www.taugh.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
