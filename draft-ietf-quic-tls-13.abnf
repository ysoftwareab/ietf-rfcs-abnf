initial_salt = 0x9c108f98520a5c5c32968e950e8a2c5fe06d6c38
initial_secret =
       HKDF-Extract(initial_salt, client_dst_connection_id)

client_initial_secret =
      HKDF-Expand-Label(initial_secret, "client in", Hash.length)
server_initial_secret =
      HKDF-Expand-Label(initial_secret, "server in", Hash.length)

sample_offset = 1 + len(connection_id) + 4

sample_offset = packet_length - sample_length
sample = packet[sample_offset..sample_offset+sample_length]

sample_offset = 6 + len(destination_connection_id) +
                       len(source_connection_id) +
                       len(payload_length) + 4

encrypted_pn = AES-CTR(pn_key, sample, packet_number)
counter = DecodeLE(sample[0..3])
nonce = DecodeLE(sample[4..7], sample[8..11], sample[12..15])
encrypted_pn = ChaCha20(pn_key, counter, nonce, packet_number)

encrypted_pn = packet_number XOR PRF(pn_key, sample)

