<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>The Web Origin Concept</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="The Web Origin Concept">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">websec</td><td class="header">A. Barth</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Google, Inc.</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">December 30, 2010</td></tr>
<tr><td class="header">Expires: July 3, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />The Web Origin Concept<br />draft-ietf-websec-origin-00</h1>

<h3>Abstract</h3>

<p>This document defines the concept of an "origin", which represents a
      web principal. Typically, user agents isolate content retrieved from
      different origins to prevent a malicious web site operator from
      interfering with the operation of benign web sites. In particular, this
      document defines how to compute an origin from a URI, how to serialize
      an origin to a string, and an HTTP header, named "Origin", for
      indicating which origin caused the user agent to issue a particular
      HTTP request.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on July 3, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#conventions">2.</a>&nbsp;
Conventions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#conformance-criteria">2.1.</a>&nbsp;
Conformance Criteria<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#syntax-notation">2.2.</a>&nbsp;
Syntax Notation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#terminology">2.3.</a>&nbsp;
Terminology<br />
<a href="#origin">3.</a>&nbsp;
Origin<br />
<a href="#same-origin">4.</a>&nbsp;
Comparing Origins<br />
<a href="#serialization">5.</a>&nbsp;
Serializing Origins<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#unicode-serialization">5.1.</a>&nbsp;
Unicode Serialization of an Origin<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ascii-serialization">5.2.</a>&nbsp;
ASCII Serialization of an Origin<br />
<a href="#origin-header">6.</a>&nbsp;
The HTTP Origin header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#origin-header-syntax">6.1.</a>&nbsp;
Syntax<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#origin-header-semantics">6.2.</a>&nbsp;
Semantics<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#origin-header-ua-requirements">6.3.</a>&nbsp;
User Agent Requirements<br />
<a href="#privacy">7.</a>&nbsp;
Privacy Considerations<br />
<a href="#security">8.</a>&nbsp;
Security Considerations<br />
<a href="#iana">9.</a>&nbsp;
IANA Considerations<br />
<a href="#implementation-considerations">10.</a>&nbsp;
Implementation Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#idna-migration">10.1.</a>&nbsp;
IDNA dependency and migration<br />
<a href="#rfc.references1">11.</a>&nbsp;
Normative References<br />
<a href="#anchor2">Appendix&nbsp;A.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>User agents interact with content created by a large number of
      authors. Although many of those authors are well-meaning, some authors
      might be malicious.  To the extent that user agents undertake actions
      based on content they process, user agent implementors might wish to
      restrict the ability of malicious authors to disrupt the confidentiality
      or integrity of other content or servers.
</p>
<p>As an example, consider an HTTP user agent that renders HTML content
      retrieved from various servers. If the user agent executes scripts
      contained in those documents, the user agent implementor might wish to
      prevent scripts retrieved from a malicious server from reading documents
      stored on an honest server, which might, for example, be behind a
      firewall.
</p>
<p>Traditionally, user agents have divided content according to its
      "origin". More specifically, user agents allow content retrieved from
      one origin to interact freely with other content retrieved from that
      origin, but user agents restrict how that content can interact with
      content from another origin.
</p>
<p>This document does not describe the restrictions user agents ought to
      impose on cross-origin interaction. Instead, this document defines the
      origin concept itself in such a way that other specifications, such for
      HTTP [cite] or for HTML [cite], can refer to this document for a
      precise, common definition of the web origin concept.
</p>
<p>Specifically, a user agent can compute the origin of a piece of
      content based on the URI from which the user agent retrieved the
      content. Given two origins computed in this way, the user agent can
      compare the origins to determine if they are "the same", which is useful
      for performing some security checks. Finally, given an origin, the user
      agent can serialize that origin into either an ASCII or a Unicode
      representation.
</p>
<p>This document also defines one use of the ASCII serialization: the
      HTTP Origin header. An Origin header attached to an HTTP request
      contains the ASCII serializations of the origins that caused the user
      agent to issue the HTTP request. The Origin header has a number of uses,
      including for cross-origin resource sharing [cite].
</p>
<a name="conventions"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Conventions</h3>

<a name="conformance-criteria"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Conformance Criteria</h3>

<p>The keywords "MUST", "MUST NOT", "REQUIRED", "SHOULD", "SHOULD
        NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
        interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>Requirements phrased in the imperative as part of algorithms (such
        as "strip any leading space characters" or "return false and abort
        these steps") are to be interpreted with the meaning of the key word
        ("MUST", "SHOULD", "MAY", etc) used in introducing the algorithm.
</p>
<p>Conformance requirements phrased as algorithms or specific steps
        can be implemented in any manner, so long as the end result is
        equivalent. In particular, the algorithms defined in this
        specification are intended to be easy to understand and are not
        intended to be performant.
</p>
<a name="syntax-notation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Syntax Notation</h3>

<p>This specification uses the Augmented Backus-Naur Form (ABNF)
        notation of <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
</p>
<p>The following core rules are included by reference, as defined in
        <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D., Ed. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>, Appendix B.1: ALPHA (letters), CR (carriage
        return), CRLF (CR LF), CTL (controls), DIGIT (decimal 0-9), DQUOTE
        (double quote), HEXDIG (hexadecimal 0-9/A-F/a-f), LF (line feed),
        OCTET (any 8-bit sequence of data), SP (space), HTAB (horizontal tab),
        CHAR (any US-ASCII character), VCHAR (any visible US-ASCII character),
        and WSP (whitespace).
</p>
<p>The OWS (optional whitespace) rule is used where zero or more
        linear whitespace characters MAY appear:
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
<dfn>OWS</dfn>            = <span class='rep'>*</span>( [ <cite class='id'>obs-fold</cite> ] <cite class='key'>WSP</cite> )
                 <em>; "optional" whitespace</em>
<dfn>obs-fold</dfn>       = <cite class='key'>CRLF</cite>
</pre></div><p>

        OWS SHOULD either not be produced or be produced as a single SP
        character.
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Terminology</h3>

<p>The terms user agent, client, server, proxy, and origin server have
        the same meaning as in the HTTP/1.1 specification (<a class='info' href='#RFC2616'>[RFC2616]<span> (</span><span class='info'>Fielding, R., Gettys, J., Mogul, J., Frystyk, H., Masinter, L., Leach, P., and T. Berners-Lee, &ldquo;Hypertext Transfer Protocol -- HTTP/1.1,&rdquo; June&nbsp;1999.</span><span>)</span></a>, Section 1.3).
</p>
<p>A globally unique identifier is a value which is different from all
        other previously existing values.  For example, a sufficiently long
        random string is likely to be a globally unique identifier.
</p>
<p>A idna-canonicalization host name is the string generated by the
        following algorithm:
        </p>
<ol class="text">
<li>Convert the host name to a sequence of NR-LDH labels (see
          Section 2.3.2.2 of <a class='info' href='#RFC5890'>[RFC5890]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA):           Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a>) and/or A-labels
          according to the appropriate IDNA specification <a class='info' href='#RFC5891'>[RFC5891]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names in Applications (IDNA):           Protocol,&rdquo; August&nbsp;2010.</span><span>)</span></a> or <a class='info' href='#RFC3490'>[RFC3490]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a> (see <a class='info' href='#idna-migration'>Section&nbsp;10.1<span> (</span><span class='info'>IDNA dependency and migration</span><span>)</span></a> of this specification)
</li>
<li>Convert the labels to lower case.
</li>
<li>Concatenate the labels, separating each label from the next
          with a %x2E (".") character.
</li>
</ol><p>
        
</p>
<a name="origin"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Origin</h3>

<p>An origin represents a web principal. Typically, user agents
      determine the origin of a piece of content from the URI from which they
      retrieved the content. In this section, we define how to compute an
      origin from a URI.
</p>
<p>The origin of a URI is the value computed by the following algorithm:
      </p>
<ol class="text">
<li>If the URI does not use a server-based naming authority, or if the
        URI is not an absolute URI, then return a globally unique
        identifier.
</li>
<li>Let uri-scheme be the scheme component of the URI, converted to
        lowercase.
</li>
<li>If the implementation doesn't support the protocol given by
        uri-scheme, then return a globally unique identifier.
</li>
<li>If uri-scheme is "file", the implementation MAY return an
        implementation-defined value.
        
<ol class="text">
<li>NOTE: Historically, user agents have granted content from the
          file scheme a tremendous number of privileges. However, granting all
          local files such wide privileges can lead to privilege escalation
          attacks. Some user agents have had success granting local files
          directory-based privileges, but this approach has not been widely
          adopted. Other user agent use a globally unique identifier each file
          URI, which is the most secure option.
</li>
</ol>
        
</li>
<li>Let uri-host be the idna-canonicalization of the host component of
        the URI.
</li>
<li>If there is no port component of the URI:
        
<ol class="text">
<li>Let uri-port be the default port for the protocol given by
          uri-scheme.
</li>
</ol>
        Otherwise:
        
<ol class="text">
<li>Let uri-port be the port component of the URI.
</li>
</ol>
        
</li>
<li>Return the triple (uri-scheme, uri-host, uri-port).
</li>
</ol><p>
      
</p>
<p>Implementations MAY define other types of origins in addition to the
      scheme/host/port triple type defined above. For example, an
      implementation might define an origin based on a public key or an
      implementation might append addition "sandbox" bits to a
      scheme/host/port triple.
</p>
<a name="same-origin"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Comparing Origins</h3>

<p>To origins are "the same" if, and only if, they are identical. In
      particular:
      </p>
<ul class="text">
<li>If the two origins are scheme/host/port triple, the two origins are
        the same if, and only if, they have identical schemes, hosts, and
        ports.
</li>
<li>An origin that is globally unique identifier cannot be the same as
        an origin that is a scheme/host/port triple.
</li>
<li>Two origins that are globally unique identifiers cannot be the same
        if they were created at different times, even if they were created for
        the same URI.
</li>
</ul><p>
      
</p>
<p>Two URIs are the same-origin if their origins are the same.
      </p>
<blockquote class="text">
<p>NOTE: A URI is not necessarily same-origin with itself. For
        example, a data URI is not same-origin with itself because data URIs
        do not use a server-based naming authority and therefore have globally
        unique identifiers as origins.
</p>
</blockquote><p>
      
</p>
<a name="serialization"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Serializing Origins</h3>

<p>This section defines how to serialize an origin to a unicode string
      and to an ASCII string.
</p>
<a name="unicode-serialization"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Unicode Serialization of an Origin</h3>

<p>The unicode-serialization of an origin is the value returned by the
        following algorithm:
        </p>
<ol class="text">
<li>If the origin is not a scheme/host/port triple, then return the
          string
          
<blockquote class="text">
<p>null
</p>
</blockquote>
          (i.e., the code point sequence U+006E, U+0075, U+006C, U+006C) and
          abort these steps.
</li>
<li>Otherwise, let result be the scheme part of the origin
          triple.
</li>
<li>Append the string "://" to result.
</li>
<li>Append the [TODO: IDNA ToUnicode] algorithm to each component of
          the host part of the origin triple, and append the results of each
          component, in the same order, separated by U+002E FULL STOP code
          points (".") to result.
</li>
<li>If the port part of the origin triple is different than the
          default port for the protocol given by the scheme part of the origin
          triple:
          
<ol class="text">
<li>Append a U+003A COLON code point (":") and the given port, in
            base ten, to result.
</li>
</ol>
          
</li>
<li>Return result.
</li>
</ol><p>
        
</p>
<p>[TODO: Check that we handle IPv6 literals correctly.]
</p>
<a name="ascii-serialization"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
ASCII Serialization of an Origin</h3>

<p>The ascii-serialization of an origin is the value returned by the
        following algorithm:
        </p>
<ol class="text">
<li>If the origin is not a scheme/host/port triple, then return the
          string
          
<blockquote class="text">
<p>null
</p>
</blockquote>
          (i.e., the code point sequence U+006E, U+0075, U+006C, U+006C) and
          abort these steps.
</li>
<li>Otherwise, let result be the scheme part of the origin
          triple.
</li>
<li>Append the string "://" to result.
</li>
<li>Append the host port of the origin triple to result.
</li>
<li>If the port part of the origin triple is different than the
          default port for the protocol given by the scheme part of the origin
          triple:
          
<ol class="text">
<li>Append a U+003A COLON code points (":") and the given port, in
            base ten, to result.
</li>
</ol>
          
</li>
<li>Return result.
</li>
</ol><p>
        
</p>
<a name="origin-header"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
The HTTP Origin header</h3>

<p>This section defines the HTTP Origin header.
</p>
<a name="origin-header-syntax"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Syntax</h3>

<p>The Origin header has the following syntax:
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

<dfn>origin</dfn>              = "<span class='str'>Origin:</span>" <cite class='id'>OWS</cite> <cite class='id'>origin-list-or-null</cite> <cite class='id'>OWS</cite>
<dfn>origin-list-or-null</dfn> = "<span class='str'>null</span>" / <cite class='id'>origin-list</cite>
<dfn>origin-list</dfn>         = <cite class='id'>serialized-origin</cite> <span class='rep'>*</span>( <cite class='key'>SP</cite> <cite class='id'>serialized-origin</cite> )
<dfn>serialized-origin</dfn>   = <cite class='id'>scheme</cite> "<span class='str'>://</span>" <cite class='id'>host</cite> [ "<span class='str'>:</span>" <cite class='id'>port</cite> ]
                    <em>; &lt;scheme&gt;, &lt;host&gt;, &lt;port&gt; productions from RFC3986</em>

</pre></div><p>

        
</p>
<a name="origin-header-semantics"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Semantics</h3>

<p>When included in an HTTP request, the Origin header indicates the
        origin(s) that caused the user agent to issue the request.
</p>
<p>For example, consider a user agent that executes scripts on behalf
        of origins. If one of those scripts causes the user agent to issue an
        HTTP request, the user agent might wish to use the Origin header to
        inform the server that the request was issued by the script.
</p>
<p>In some cases, a number of origins contribute to causing the user
        agents to issue an HTTP request. In those cases, the user agent can
        list all the origins in the Origin header. For example, if the HTTP
        request was initially issued by one origin but then later redirected
        by another origin, the user agent might wish to inform the server that
        two origins were involved in causing the user agent to issue the
        request.
</p>
<a name="origin-header-ua-requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
User Agent Requirements</h3>

<p>The user agent MAY include an Origin header in any HTTP
        request.
</p>
<p>The user agent MUST NOT include more than one Origin header field
        in any HTTP request.
</p>
<p>Whenever a user agent issues an HTTP request from a
        "privacy-sensitive" context, the user agent MUST send the value "null"
        in the Origin header.
        </p>
<blockquote class="text">
<p>NOTE: This document does not define the notion of a
          privacy-sensitive context. Applications that generate HTTP requests
          can designate contexts as privacy-sensitive to impose restrictions
          on how user agents generate Origin headers.
</p>
</blockquote><p>
        
</p>
<p>When generating an Origin header, the user agent MUST meet the
        following requirements:
        </p>
<ul class="text">
<li>Each of the serialized-origin productions in the grammar MUST be
          the ascii-serialization of an origin.
</li>
<li>No two consecutive serialized-origin productions in the grammar
          can be identical.  In particular, if the user agent would generate
          two consecutive serialized-origins, the user agent MUST NOT generate
          the second one.
</li>
</ul><p>
        
</p>
<p>If the user agent issued an HTTP request current-request because
        the user agent received 3xx Status Code response to another HTTP
        request previous-request for URI previous-uri:
        </p>
<ul class="text">
<li>The HTTP request current-request MUST include an Origin
          header.
</li>
<li>The value of the Origin header MUST be either:
          
<ul class="text">
<li>The string "null" (i.e., the byte sequence %x6E, %x75, %x6C,
            %x6C).
</li>
<li>The value of the Origin header in the previous-request.  The
            user agent MUST NOT choose this option if the ascii-serialization
            of previous-uri is not identical to the last serialized-origin in
            the Origin header of the previous request.
</li>
<li>The value of the Origin header in previous header extended with
            a space and the ascii-serialization of the origin of previous-uri.
            The user agent MUST NOT choose this option if the
            ascii-serialization of the origin of previous-uri is "null".
</li>
</ul>
          
</li>
</ul><p>
        
</p>
<p>The user agent SHOULD include the Origin header in an HTTP request if
      the user agent issues the HTTP request on behalf of an origin (e.g., not
      by the user operating a trusted user interface surface). In this case,
      the user agent SHOULD set the value of the Origin header to the
      ascii-serialization of that origin.
      </p>
<blockquote class="text">
<p>NOTE: This behavior differs from the usual user agent behavior for
        the HTTP Referer header, which user agents often suppress when an
        origin with an "https" scheme issues a request for a URI with an
        "http" scheme.
</p>
</blockquote><p>
      
</p>
<a name="privacy"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Privacy Considerations</h3>

<p>[TODO: Privacy considerations.]
</p>
<a name="security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>[TODO: Security considerations.]
</p>
<a name="iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>[TODO: Register the Origin header.]
</p>
<a name="implementation-considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Implementation Considerations</h3>

<a name="idna-migration"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10.1"></a><h3>10.1.&nbsp;
IDNA dependency and migration</h3>

<p>IDNA2008 <a class='info' href='#RFC5890'>[RFC5890]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA):           Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a> supersedes IDNA2003 <a class='info' href='#RFC3490'>[RFC3490]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a> but is not backwards-compatible. For this reason,
        there will be a transition period (possibly of a number of years).
        User agents SHOULD implement IDNA2008 <a class='info' href='#RFC5890'>[RFC5890]<span> (</span><span class='info'>Klensin, J., &ldquo;Internationalized Domain Names for Applications (IDNA):           Definitions and Document Framework,&rdquo; August&nbsp;2010.</span><span>)</span></a> and
        MAY implement [Unicode Technical Standard #46
        &lt;http://unicode.org/reports/tr46/&gt;] in order to facilitate a
        smoother IDNA transition. If a user agent does not implement IDNA2008,
        the user agent MUST implement IDNA2003 <a class='info' href='#RFC3490'>[RFC3490]<span> (</span><span class='info'>Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;Internationalizing Domain Names in Applications (IDNA),&rdquo; March&nbsp;2003.</span><span>)</span></a>.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2616">[RFC2616]</a></td>
<td class="author-text"><a href="mailto:fielding@ics.uci.edu">Fielding, R.</a>, <a href="mailto:jg@w3.org">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com">Mogul, J.</a>, <a href="mailto:frystyk@w3.org">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com">Leach, P.</a>, and <a href="mailto:timbl@w3.org">T. Berners-Lee</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>,&rdquo; RFC&nbsp;2616, June&nbsp;1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3490">[RFC3490]</a></td>
<td class="author-text">Faltstrom, P., Hoffman, P., and A. Costello, &ldquo;<a href="http://tools.ietf.org/html/rfc3490">Internationalizing Domain Names in Applications (IDNA)</a>,&rdquo; RFC&nbsp;3490, March&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3490.txt">TXT</a>).<p>
See <a class='info' href='#idna-migration'>Section&nbsp;10.1<span> (</span><span class='info'>IDNA dependency and migration</span><span>)</span></a> for an explanation why the
          normative reference to an obsoleted specification is needed.
</p>
</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text"><a href="mailto:dcrocker@bbiw.net">Crocker, D., Ed.</a> and <a href="mailto:paul.overell@thus.net">P. Overell</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5246">[RFC5246]</a></td>
<td class="author-text">Dierks, T. and E. Rescorla, &ldquo;<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>,&rdquo; RFC&nbsp;5246, August&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5890">[RFC5890]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5890">Internationalized Domain Names for Applications (IDNA):
          Definitions and Document Framework</a>,&rdquo; RFC&nbsp;5890, August&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5890.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5891">[RFC5891]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc5891">Internationalized Domain Names in Applications (IDNA):
          Protocol</a>,&rdquo; RFC&nbsp;5891, August&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc5891.txt">TXT</a>).</td></tr>
</table>

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Acknowledgements</h3>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Adam Barth</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Google, Inc.</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ietf@adambarth.com">ietf@adambarth.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.adambarth.com/">http://www.adambarth.com/</a></td></tr>
</table>
</body></html>
