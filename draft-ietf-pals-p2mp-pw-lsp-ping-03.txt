



PALS Workgroup                                                   P. Jain
Internet-Draft                                       Cisco Systems, Inc.
Intended status: Standards Track                              S. Boutros
Expires: October 27, 2017                                   VMWare, Inc.
                                                               S. Aldrin
                                                             Google Inc.
                                                          April 25, 2017


           Definition of P2MP PW TLV for LSP-Ping Mechanisms
                  draft-ietf-pals-p2mp-pw-lsp-ping-03

Abstract

   LSP-Ping is a widely deployed Operation, Administration, and
   Maintenance (OAM) mechanism in MPLS networks.  This document
   describes a mechanism to verify connectivity of Point-to-Multipoint
   (P2MP) Pseudowires (PW) using LSP Ping.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on October 27, 2017.

Copyright Notice

   Copyright (c) 2017 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of



Jain, et al.            Expires October 27, 2017                [Page 1]

Internet-Draft              P2MP PW LSP Ping                  April 2017


   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Specification of Requirements . . . . . . . . . . . . . . . .   3
   3.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   4.  Identifying a P2MP PW . . . . . . . . . . . . . . . . . . . .   3
     4.1.  P2MP Pseudowire Sub-TLV . . . . . . . . . . . . . . . . .   3
   5.  Encapsulation of OAM Ping Packets . . . . . . . . . . . . . .   4
   6.  Operations  . . . . . . . . . . . . . . . . . . . . . . . . .   4
   7.  Controlling Echo Responses  . . . . . . . . . . . . . . . . .   6
   8.  Security Considerations . . . . . . . . . . . . . . . . . . .   6
   9.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .   6
   10. Acknowledgments . . . . . . . . . . . . . . . . . . . . . . .   6
   11. References  . . . . . . . . . . . . . . . . . . . . . . . . .   6
     11.1.  Normative References . . . . . . . . . . . . . . . . . .   6
     11.2.  Informative References . . . . . . . . . . . . . . . . .   7
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .   8

1.  Introduction

   A Point-to-Multipoint (P2MP) Pseudowire (PW) emulates the essential
   attributes of a unidirectional P2MP Telecommunications service such
   as P2MP ATM over PSN.  Requirements for P2MP PW are described in
   [RFC7338].  P2MP PWs are carried over P2MP MPLS LSP.  The Procedures
   for P2MP PW signaling using BGP are described in [RFC7117] and LDP
   for single segment P2MP PWs are described in [I-D.ietf-pals-p2mp-pw].
   Many P2MP PWs can share the same P2MP MPLS LSP and this arrangement
   is called Aggregate P-tree.  The aggregate P2MP trees require an
   upstream assigned label so that on the tail of the P2MP LSP, the
   traffic can be associated with a VPN or a VPLS instance.  When a P2MP
   MPLS LSP carries only one VPN or VPLS service instance, the
   arrangement is called Inclusive P-Tree.  For Inclusive P-Trees, P2MP
   MPLS LSP label itself can uniquely identify the VPN or VPLS service
   being carried over P2MP MPLS LSP.  The P2MP MPLS LSP can also be used
   in Selective P-Tree arrangement for carrying multicast traffic.  In a
   Selective P-Tree arrangement, traffic to each multicast group in a
   VPN or VPLS instance is carried by a separate unique P-tree.  In
   Aggregate Selective P-tree arrangement, traffic to a set of multicast
   groups from different VPN or VPLS instances is carried over a same
   shared P-tree.

   The P2MP MPLS LSP are setup either using P2MP RSVP-TE [RFC4875] or
   Multipoint LDP (mDLP) [RFC6388].  Mechanisms for fault detection and
   isolation for data plane failures for P2MP MPLS LSPs are specified in




Jain, et al.            Expires October 27, 2017                [Page 2]

Internet-Draft              P2MP PW LSP Ping                  April 2017


   [RFC6425].  This document describes a mechanism to detect data plane
   failures for P2MP PW carried over P2MP MPLS LSPs.

   This document defines a new P2MP Pseudowire sub-TLV for Target FEC
   Stack for P2MP PW.  The P2MP Pseudowire sub-TLV is added in Target
   FEC Stack TLV by the originator of the Echo Request to inform the
   receiver at P2MP MPLS LSP tail, of the P2MP PW being tested.

   Multi-segment Pseudowires support is out of scope of this document at
   present and may be included in future.

2.  Specification of Requirements

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].

3.  Terminology

   ATM: Asynchronous Transfer Mode

   LSR: Label Switching Router

   MPLS-OAM: MPLS Operations, Administration and Maintenance

   P2MP-PW: Point-to-Multipoint PseudoWire

   PW: PseudoWire

   TLV: Type Length Value

4.  Identifying a P2MP PW

   This document introduces a new LSP Ping Target FEC Stack sub-TLV,
   P2MP Pseudowire sub-TLV, to identify the P2MP PW under test at the
   P2MP LSP Tail/Bud node.

4.1.  P2MP Pseudowire Sub-TLV

   The P2MP Pseudowire sub-TLV has the format shown in Figure 1.  This
   TLV is included in the echo request sent over P2MP PW by the
   originator of request.

   The Attachment Group Identifier (AGI) in P2MP Pseudowire Sub-TLV as
   described in Section 3.4.2 in [RFC4446], identifies the VPLS
   instance.  The Originating Router's IP address is the IPv4 or IPv6
   address of the P2MP PW root.




Jain, et al.            Expires October 27, 2017                [Page 3]

Internet-Draft              P2MP PW LSP Ping                  April 2017


       0                   1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | AGI Type    |   AGI Length  |                                 |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                                 |
       ~                          AGI Value                            ~
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       | IP Addr Len |                                                 |
       +-+-+-+-+-+-+-+                                                 |
       ~               Originating Routers IP Addr                     ~
       |                                                               |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                  Figure 1: P2MP Pseudowire sub-TLV format

   For Inclusive and Selective P2MP MPLS P-trees, the echo request is
   sent using the P2MP MPLS LSP label.

   For Aggregate Inclusive and Aggregate Selective P-trees, the echo
   request is sent using a label stack of [P2MP MPLS P-tree label,
   upstream assigned P2MP PW label].  The P2MP MPLS P-tree label is the
   outer label and upstream assigned P2MP PW label is inner label.

5.  Encapsulation of OAM Ping Packets

   The LSP Ping Echo request IPv4/UDP packets is encapsulated with the
   MPLS label stack as described in previous sections, followed by one
   of the two encapsulation options:

   o  GAL Label [RFC6426] followed IPv4(0x0021) or IPv6(0x0057) ACH
      [RFC4385]

   o  PW ACH [RFC4385]

   To ensure interoperability, implementations of this document MUST
   support both encapsulations.

6.  Operations

   In this section, we explain the operation of the LSP Ping over P2MP
   PW.  Figure 2 shows a P2MP PW PW1 setup from T-PE1 to remote PEs (T-
   PE2, T-PE3 and T-PE4).  The transport LSP associated with the P2MP
   PW1 can be MLDP P2MP MPLS LSP or P2MP TE tunnel.







Jain, et al.            Expires October 27, 2017                [Page 4]

Internet-Draft              P2MP PW LSP Ping                  April 2017


                 |<--------------P2MP PW---------------->|
          Native |                                       |  Native
         Service |     |<--PSN1->|      |<--PSN2->|      |  Service
          (AC)   V     V         V      V         V      V   (AC)
            |    +-----+         +------+         +------+    |
            |    |     |         |   P1 |=========|T-PE2 |AC3 |    +---+
            |    |     |         |   .......PW1.........>|-------->|CE3|
            |    |T-PE1|=========|   .  |=========|      |    |    +---+
            |    |  .......PW1........  |         +------+    |
            |    |  .  |=========|   .  |         +------+    |
            |    |  .  |         |   .  |=========|T-PE3 |AC4 |    +---+
    +---+   |AC1 |  .  |         |   .......PW1.........>|-------->|CE4|
    |CE1|------->|...  |         |      |=========|      |    |    +---+
    +---+   |    |  .  |         +------+         +------+    |
            |    |  .  |         +------+         +------+    |
            |    |  .  |=========|   P2 |=========|T-PE4 |AC5 |    +---+
            |    |  .......PW1..............PW1.........>|-------->|CE5|
            |    |     |=========|      |=========|      |    |    +---+
            |    +-----+         +------+         +------+    |

                               Figure 2: P2MP PW



   When an operator wants to perform a connectivity check for the P2MP
   PW1, the operator initiate a LSP-Ping request with the Target FEC
   Stack TLV containing P2MP Pseudowire sub-TLV in the echo request
   packet.  For an Inclusive P2MP P-tree arrangement, the echo request
   packet is sent over the P2MP MPLS LSP with one of the following two
   encapsulation options:

   o  {P2MP P-tree label, GAL} MPLS label stack and IPv4 or IPv6 ACH.

   o  {P2MP P-tree label} MPLS label stack and PW ACH.

   For an Aggregate Inclusive P-tree arrangement, the echo request
   packet is sent over the P2MP MPLS LSP with one of the following two
   encapsulation options:

   o  {P2MP P-tree label, P2MP PW upstream assigned label, GAL} MPLS
      label stack and IPv4 or IPv6 ACH.

   o  {P2MP P-tree label, P2MP PW upstream assigned label} MPLS label
      stack and PW ACH.

   The intermediate P routers do swap and replication based on the MPLS
   LSP label.  Once the echo request packet reaches remote terminating
   PEs, T-PEs use GAL label and the IPv4/IPv6 ACH Channel header or PW



Jain, et al.            Expires October 27, 2017                [Page 5]

Internet-Draft              P2MP PW LSP Ping                  April 2017


   ACH as the case may be, to determine that the packet is an OAM
   Packet.  The T-PEs process the packet and perform checks for the P2MP
   Pseudowire sub-TLV present in the Target FEC Stack TLV as described
   in Section 4.4 in [RFC4379] and respond according to [RFC4379]
   processing rules.

7.  Controlling Echo Responses

   The procedures described in [RFC6425] for preventing congestion of
   Echo Responses (Echo Jitter TLV) and limiting the echo reply to a
   single egress node (Node Address P2MP Responder Identifier TLV) can
   be applied to P2MP PW LSP Ping.

8.  Security Considerations

   The proposal introduced in this document does not introduce any new
   security considerations beyond that already apply to [RFC6425].

9.  IANA Considerations

   This document defines a new sub-TLV type to be included in Target FEC
   Stack TLV (TLV Type 1) [RFC4379] in LSP Ping.

   IANA is requested to assign a sub-TLV type value to the following
   sub-TLV from the "Multiprotocol Label Switching (MPLS) Label Switched
   Paths (LSPs) Parameters - TLVs" registry, "TLVs and sub- TLVs" sub-
   registry:

   o  P2MP Pseudowire sub-TLV

10.  Acknowledgments

   The authors would like to thank Shaleen Saxena, Greg Mirsky, Andrew
   G.  Malis, and Danny Prairie for their valuable input and comments.

11.  References

11.1.  Normative References

   [I-D.ietf-pals-p2mp-pw]
              Sivabalan, S. and S. Boutros, "Signaling Root-Initiated
              Point-to-Multipoint Pseudowire using LDP", draft-ietf-
              pals-p2mp-pw-02 (work in progress), January 2017.

   [RFC4379]  Kompella, K. and G. Swallow, "Detecting Multi-Protocol
              Label Switched (MPLS) Data Plane Failures", RFC 4379,
              DOI 10.17487/RFC4379, February 2006,
              <http://www.rfc-editor.org/info/rfc4379>.



Jain, et al.            Expires October 27, 2017                [Page 6]

Internet-Draft              P2MP PW LSP Ping                  April 2017


   [RFC4385]  Bryant, S., Swallow, G., Martini, L., and D. McPherson,
              "Pseudowire Emulation Edge-to-Edge (PWE3) Control Word for
              Use over an MPLS PSN", RFC 4385, DOI 10.17487/RFC4385,
              February 2006, <http://www.rfc-editor.org/info/rfc4385>.

   [RFC4446]  Martini, L., "IANA Allocations for Pseudowire Edge to Edge
              Emulation (PWE3)", BCP 116, RFC 4446,
              DOI 10.17487/RFC4446, April 2006,
              <http://www.rfc-editor.org/info/rfc4446>.

   [RFC6425]  Saxena, S., Ed., Swallow, G., Ali, Z., Farrel, A.,
              Yasukawa, S., and T. Nadeau, "Detecting Data-Plane
              Failures in Point-to-Multipoint MPLS - Extensions to LSP
              Ping", RFC 6425, DOI 10.17487/RFC6425, November 2011,
              <http://www.rfc-editor.org/info/rfc6425>.

   [RFC6426]  Gray, E., Bahadur, N., Boutros, S., and R. Aggarwal, "MPLS
              On-Demand Connectivity Verification and Route Tracing",
              RFC 6426, DOI 10.17487/RFC6426, November 2011,
              <http://www.rfc-editor.org/info/rfc6426>.

   [RFC7117]  Aggarwal, R., Ed., Kamite, Y., Fang, L., Rekhter, Y., and
              C. Kodeboniya, "Multicast in Virtual Private LAN Service
              (VPLS)", RFC 7117, DOI 10.17487/RFC7117, February 2014,
              <http://www.rfc-editor.org/info/rfc7117>.

11.2.  Informative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <http://www.rfc-editor.org/info/rfc2119>.

   [RFC4875]  Aggarwal, R., Ed., Papadimitriou, D., Ed., and S.
              Yasukawa, Ed., "Extensions to Resource Reservation
              Protocol - Traffic Engineering (RSVP-TE) for Point-to-
              Multipoint TE Label Switched Paths (LSPs)", RFC 4875,
              DOI 10.17487/RFC4875, May 2007,
              <http://www.rfc-editor.org/info/rfc4875>.

   [RFC5085]  Nadeau, T., Ed. and C. Pignataro, Ed., "Pseudowire Virtual
              Circuit Connectivity Verification (VCCV): A Control
              Channel for Pseudowires", RFC 5085, DOI 10.17487/RFC5085,
              December 2007, <http://www.rfc-editor.org/info/rfc5085>.







Jain, et al.            Expires October 27, 2017                [Page 7]

Internet-Draft              P2MP PW LSP Ping                  April 2017


   [RFC6388]  Wijnands, IJ., Ed., Minei, I., Ed., Kompella, K., and B.
              Thomas, "Label Distribution Protocol Extensions for Point-
              to-Multipoint and Multipoint-to-Multipoint Label Switched
              Paths", RFC 6388, DOI 10.17487/RFC6388, November 2011,
              <http://www.rfc-editor.org/info/rfc6388>.

   [RFC7338]  Jounay, F., Ed., Kamite, Y., Ed., Heron, G., and M. Bocci,
              "Requirements and Framework for Point-to-Multipoint
              Pseudowires over MPLS Packet Switched Networks", RFC 7338,
              DOI 10.17487/RFC7338, September 2014,
              <http://www.rfc-editor.org/info/rfc7338>.

Authors' Addresses

   Parag Jain
   Cisco Systems, Inc.
   2000 Innovation Drive
   Kanata, ON  K2K-3E8
   Canada

   Email: paragj@cisco.com


   Sami Boutros
   VMWare, Inc.
   USA

   Email: sboutros@vmware.com


   Sam Aldrin
   Google Inc.
   USA

   Email: aldrin.ietf@gmail.com
















Jain, et al.            Expires October 27, 2017                [Page 8]
