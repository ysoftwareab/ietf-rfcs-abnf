<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Diameter Network Access Server Application</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Terminology">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Requirements Language">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Advertising Application Support">
<link href="#rfc.section.2" rel="Chapter" title="2 NAS Calls, Ports, and Sessions">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Diameter Session Establishment">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Diameter Session Reauthentication or Reauthorization">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 Diameter Session Termination">
<link href="#rfc.section.3" rel="Chapter" title="3 Diameter NAS Application Messages">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 AA-Request (AAR) Command">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 AA-Answer (AAA) Command">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Re-Auth-Request (RAR) Command">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Re-Auth-Answer (RAA) Command">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Session-Termination-Request (STR) Command">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 Session-Termination-Answer (STA) Command">
<link href="#rfc.section.3.7" rel="Chapter" title="3.7 Abort-Session-Request (ASR) Command">
<link href="#rfc.section.3.8" rel="Chapter" title="3.8 Abort-Session-Answer (ASA) Command">
<link href="#rfc.section.3.9" rel="Chapter" title="3.9 Accounting-Request (ACR) Command">
<link href="#rfc.section.3.10" rel="Chapter" title="3.10 Accounting-Answer (ACA) Command">
<link href="#rfc.section.4" rel="Chapter" title="4 Diameter NAS Application AVPs">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Derived AVP Data Formats">
<link href="#rfc.section.4.1.1" rel="Chapter" title="4.1.1 QoSFilterRule">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 NAS Session AVPs">
<link href="#rfc.section.4.2.1" rel="Chapter" title="4.2.1 Call and Session Information">
<link href="#rfc.section.4.2.2" rel="Chapter" title="4.2.2 NAS-Port AVP">
<link href="#rfc.section.4.2.3" rel="Chapter" title="4.2.3 NAS-Port-Id AVP">
<link href="#rfc.section.4.2.4" rel="Chapter" title="4.2.4 NAS-Port-Type AVP">
<link href="#rfc.section.4.2.5" rel="Chapter" title="4.2.5 Called-Station-Id AVP">
<link href="#rfc.section.4.2.6" rel="Chapter" title="4.2.6 Calling-Station-Id AVP">
<link href="#rfc.section.4.2.7" rel="Chapter" title="4.2.7 Connect-Info AVP">
<link href="#rfc.section.4.2.8" rel="Chapter" title="4.2.8 Originating-Line-Info AVP">
<link href="#rfc.section.4.2.9" rel="Chapter" title="4.2.9 Reply-Message AVP">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 NAS Authentication AVPs">
<link href="#rfc.section.4.3.1" rel="Chapter" title="4.3.1 User-Password AVP">
<link href="#rfc.section.4.3.2" rel="Chapter" title="4.3.2 Password-Retry AVP">
<link href="#rfc.section.4.3.3" rel="Chapter" title="4.3.3 Prompt AVP">
<link href="#rfc.section.4.3.4" rel="Chapter" title="4.3.4 CHAP-Auth AVP">
<link href="#rfc.section.4.3.5" rel="Chapter" title="4.3.5 CHAP-Algorithm AVP">
<link href="#rfc.section.4.3.6" rel="Chapter" title="4.3.6 CHAP-Ident AVP">
<link href="#rfc.section.4.3.7" rel="Chapter" title="4.3.7 CHAP-Response AVP">
<link href="#rfc.section.4.3.8" rel="Chapter" title="4.3.8 CHAP-Challenge AVP">
<link href="#rfc.section.4.3.9" rel="Chapter" title="4.3.9 ARAP-Password AVP">
<link href="#rfc.section.4.3.10" rel="Chapter" title="4.3.10 ARAP-Challenge-Response AVP">
<link href="#rfc.section.4.3.11" rel="Chapter" title="4.3.11 ARAP-Security AVP">
<link href="#rfc.section.4.3.12" rel="Chapter" title="4.3.12 ARAP-Security-Data AVP">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 NAS Authorization AVPs">
<link href="#rfc.section.4.4.1" rel="Chapter" title="4.4.1 Service-Type AVP">
<link href="#rfc.section.4.4.2" rel="Chapter" title="4.4.2 Callback-Number AVP">
<link href="#rfc.section.4.4.3" rel="Chapter" title="4.4.3 Callback-Id AVP">
<link href="#rfc.section.4.4.4" rel="Chapter" title="4.4.4 Idle-Timeout AVP">
<link href="#rfc.section.4.4.5" rel="Chapter" title="4.4.5 Port-Limit AVP">
<link href="#rfc.section.4.4.6" rel="Chapter" title="4.4.6 NAS-Filter-Rule AVP">
<link href="#rfc.section.4.4.7" rel="Chapter" title="4.4.7 Filter-Id AVP">
<link href="#rfc.section.4.4.8" rel="Chapter" title="4.4.8 Configuration-Token AVP">
<link href="#rfc.section.4.4.9" rel="Chapter" title="4.4.9 QoS-Filter-Rule AVP">
<link href="#rfc.section.4.4.10" rel="Chapter" title="4.4.10 Framed Access Authorization AVPs">
<link href="#rfc.section.4.4.10.1" rel="Chapter" title="4.4.10.1 Framed-Protocol AVP">
<link href="#rfc.section.4.4.10.2" rel="Chapter" title="4.4.10.2 Framed-Routing AVP">
<link href="#rfc.section.4.4.10.3" rel="Chapter" title="4.4.10.3 Framed-MTU AVP">
<link href="#rfc.section.4.4.10.4" rel="Chapter" title="4.4.10.4 Framed-Compression AVP">
<link href="#rfc.section.4.4.10.5" rel="Chapter" title="4.4.10.5 IP Access Authorization AVPs">
<link href="#rfc.section.4.4.10.5.1" rel="Chapter" title="4.4.10.5.1 Framed-IP-Address AVP">
<link href="#rfc.section.4.4.10.5.2" rel="Chapter" title="4.4.10.5.2 Framed-IP-Netmask AVP">
<link href="#rfc.section.4.4.10.5.3" rel="Chapter" title="4.4.10.5.3 Framed-Route AVP">
<link href="#rfc.section.4.4.10.5.4" rel="Chapter" title="4.4.10.5.4 Framed-Pool AVP">
<link href="#rfc.section.4.4.10.5.5" rel="Chapter" title="4.4.10.5.5 Framed-Interface-Id AVP">
<link href="#rfc.section.4.4.10.5.6" rel="Chapter" title="4.4.10.5.6 Framed-IPv6-Prefix AVP">
<link href="#rfc.section.4.4.10.5.7" rel="Chapter" title="4.4.10.5.7 Framed-IPv6-Route AVP">
<link href="#rfc.section.4.4.10.5.8" rel="Chapter" title="4.4.10.5.8 Framed-IPv6-Pool AVP">
<link href="#rfc.section.4.4.10.6" rel="Chapter" title="4.4.10.6 IPX Access AVPs">
<link href="#rfc.section.4.4.10.6.1" rel="Chapter" title="4.4.10.6.1 Framed-IPX-Network AVP">
<link href="#rfc.section.4.4.10.7" rel="Chapter" title="4.4.10.7 AppleTalk Network Access AVPs">
<link href="#rfc.section.4.4.10.7.1" rel="Chapter" title="4.4.10.7.1 Framed-AppleTalk-Link AVP">
<link href="#rfc.section.4.4.10.7.2" rel="Chapter" title="4.4.10.7.2 Framed-AppleTalk-Network AVP">
<link href="#rfc.section.4.4.10.7.3" rel="Chapter" title="4.4.10.7.3 Framed-AppleTalk-Zone AVP">
<link href="#rfc.section.4.4.10.8" rel="Chapter" title="4.4.10.8 AppleTalk Remote Access AVPs">
<link href="#rfc.section.4.4.10.8.1" rel="Chapter" title="4.4.10.8.1 ARAP-Features AVP">
<link href="#rfc.section.4.4.10.8.2" rel="Chapter" title="4.4.10.8.2 ARAP-Zone-Access AVP">
<link href="#rfc.section.4.4.11" rel="Chapter" title="4.4.11 Non-Framed Access Authorization AVPs">
<link href="#rfc.section.4.4.11.1" rel="Chapter" title="4.4.11.1 Login-IP-Host AVP">
<link href="#rfc.section.4.4.11.2" rel="Chapter" title="4.4.11.2 Login-IPv6-Host AVP">
<link href="#rfc.section.4.4.11.3" rel="Chapter" title="4.4.11.3 Login-Service AVP">
<link href="#rfc.section.4.4.11.4" rel="Chapter" title="4.4.11.4 TCP Services">
<link href="#rfc.section.4.4.11.4.1" rel="Chapter" title="4.4.11.4.1 Login-TCP-Port AVP">
<link href="#rfc.section.4.4.11.5" rel="Chapter" title="4.4.11.5 LAT Services">
<link href="#rfc.section.4.4.11.5.1" rel="Chapter" title="4.4.11.5.1 Login-LAT-Service AVP">
<link href="#rfc.section.4.4.11.5.2" rel="Chapter" title="4.4.11.5.2 Login-LAT-Node AVP">
<link href="#rfc.section.4.4.11.5.3" rel="Chapter" title="4.4.11.5.3 Login-LAT-Group AVP">
<link href="#rfc.section.4.4.11.5.4" rel="Chapter" title="4.4.11.5.4 Login-LAT-Port AVP">
<link href="#rfc.section.4.5" rel="Chapter" title="4.5 NAS Tunneling AVPs">
<link href="#rfc.section.4.5.1" rel="Chapter" title="4.5.1 Tunneling AVP">
<link href="#rfc.section.4.5.2" rel="Chapter" title="4.5.2 Tunnel-Type AVP">
<link href="#rfc.section.4.5.3" rel="Chapter" title="4.5.3 Tunnel-Medium-Type AVP">
<link href="#rfc.section.4.5.4" rel="Chapter" title="4.5.4 Tunnel-Client-Endpoint AVP">
<link href="#rfc.section.4.5.5" rel="Chapter" title="4.5.5 Tunnel-Server-Endpoint AVP">
<link href="#rfc.section.4.5.6" rel="Chapter" title="4.5.6 Tunnel-Password AVP">
<link href="#rfc.section.4.5.7" rel="Chapter" title="4.5.7 Tunnel-Private-Group-Id AVP">
<link href="#rfc.section.4.5.8" rel="Chapter" title="4.5.8 Tunnel-Assignment-Id AVP">
<link href="#rfc.section.4.5.9" rel="Chapter" title="4.5.9 Tunnel-Preference AVP">
<link href="#rfc.section.4.5.10" rel="Chapter" title="4.5.10 Tunnel-Client-Auth-Id AVP">
<link href="#rfc.section.4.5.11" rel="Chapter" title="4.5.11 Tunnel-Server-Auth-Id AVP">
<link href="#rfc.section.4.6" rel="Chapter" title="4.6 NAS Accounting AVPs">
<link href="#rfc.section.4.6.1" rel="Chapter" title="4.6.1 Accounting-Input-Octets AVP">
<link href="#rfc.section.4.6.2" rel="Chapter" title="4.6.2 Accounting-Output-Octets AVP">
<link href="#rfc.section.4.6.3" rel="Chapter" title="4.6.3 Accounting-Input-Packets AVP">
<link href="#rfc.section.4.6.4" rel="Chapter" title="4.6.4 Accounting-Output-Packets AVP">
<link href="#rfc.section.4.6.5" rel="Chapter" title="4.6.5 Acct-Session-Time AVP">
<link href="#rfc.section.4.6.6" rel="Chapter" title="4.6.6 Acct-Authentic AVP">
<link href="#rfc.section.4.6.7" rel="Chapter" title="4.6.7 Accounting-Auth-Method AVP">
<link href="#rfc.section.4.6.8" rel="Chapter" title="4.6.8 Acct-Delay-Time AVP">
<link href="#rfc.section.4.6.9" rel="Chapter" title="4.6.9 Acct-Link-Count AVP">
<link href="#rfc.section.4.6.10" rel="Chapter" title="4.6.10 Acct-Tunnel-Connection AVP">
<link href="#rfc.section.4.6.11" rel="Chapter" title="4.6.11 Acct-Tunnel-Packets-Lost AVP">
<link href="#rfc.section.5" rel="Chapter" title="5 AVP Occurrence Tables">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 AA-Request/Answer AVP Table">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Accounting AVP Tables">
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Framed Access Accounting AVP Table">
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 Non-Framed Access Accounting AVP Table">
<link href="#rfc.section.6" rel="Chapter" title="6 IANA Considerations">
<link href="#rfc.section.7" rel="Chapter" title="7 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="8 References">
<link href="#rfc.references.1" rel="Chapter" title="8.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="8.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Acknowledgements">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 RFC 4005">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 RFC 4005bis">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document describes the Diameter protocol application used for Authentication, Authorization, and Accounting (AAA) services in the Network Access Server (NAS) environment.  When combined with the Diameter Base protocol, Transport Profile, and Extensible Authentication Protocol specifications, this application specification satisfies typical network access services requirements.  " />
  <meta name="description" content="This document describes the Diameter protocol application used for Authentication, Authorization, and Accounting (AAA) services in the Network Access Server (NAS) environment.  When combined with the Diameter Base protocol, Transport Profile, and Extensible Authentication Protocol specifications, this application specification satisfies typical network access services requirements.  " />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Network Working Group</td>
<td class="right">G. Zorn</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Network Zen</td>
</tr>
<tr>
<td class="left">Obsoletes: 4005 (if approved)</td>
<td class="right">July 11, 2011</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right"></td>
</tr>
<tr>
<td class="left">Expires: January 12, 2012</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Diameter Network Access Server Application<br />
  <span class="filename">draft-ietf-dime-rfc4005bis-05</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document describes the Diameter protocol application used for Authentication, Authorization, and Accounting (AAA) services in the Network Access Server (NAS) environment.  When combined with the Diameter Base protocol, Transport Profile, and Extensible Authentication Protocol specifications, this application specification satisfies typical network access services requirements.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 12, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Terminology</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Requirements Language</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Advertising Application Support</a>
</li>
<li>2.   <a href="#rfc.section.2">NAS Calls, Ports, and Sessions</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Diameter Session Establishment</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Diameter Session Reauthentication or Reauthorization</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">Diameter Session Termination</a>
</li>
<li>3.   <a href="#rfc.section.3">Diameter NAS Application Messages</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">AA-Request (AAR) Command</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">AA-Answer (AAA) Command</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Re-Auth-Request (RAR) Command</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Re-Auth-Answer (RAA) Command</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Session-Termination-Request (STR) Command</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">Session-Termination-Answer (STA) Command</a>
</li>
<li>3.7.   <a href="#rfc.section.3.7">Abort-Session-Request (ASR) Command</a>
</li>
<li>3.8.   <a href="#rfc.section.3.8">Abort-Session-Answer (ASA) Command</a>
</li>
<li>3.9.   <a href="#rfc.section.3.9">Accounting-Request (ACR) Command</a>
</li>
<li>3.10.   <a href="#rfc.section.3.10">Accounting-Answer (ACA) Command</a>
</li>
<li>4.   <a href="#rfc.section.4">Diameter NAS Application AVPs</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Derived AVP Data Formats</a>
</li>
<li>4.1.1.   <a href="#rfc.section.4.1.1">QoSFilterRule</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">NAS Session AVPs</a>
</li>
<li>4.2.1.   <a href="#rfc.section.4.2.1">Call and Session Information</a>
</li>
<li>4.2.2.   <a href="#rfc.section.4.2.2">NAS-Port AVP</a>
</li>
<li>4.2.3.   <a href="#rfc.section.4.2.3">NAS-Port-Id AVP</a>
</li>
<li>4.2.4.   <a href="#rfc.section.4.2.4">NAS-Port-Type AVP</a>
</li>
<li>4.2.5.   <a href="#rfc.section.4.2.5">Called-Station-Id AVP</a>
</li>
<li>4.2.6.   <a href="#rfc.section.4.2.6">Calling-Station-Id AVP</a>
</li>
<li>4.2.7.   <a href="#rfc.section.4.2.7">Connect-Info AVP</a>
</li>
<li>4.2.8.   <a href="#rfc.section.4.2.8">Originating-Line-Info AVP</a>
</li>
<li>4.2.9.   <a href="#rfc.section.4.2.9">Reply-Message AVP</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">NAS Authentication AVPs</a>
</li>
<li>4.3.1.   <a href="#rfc.section.4.3.1">User-Password AVP</a>
</li>
<li>4.3.2.   <a href="#rfc.section.4.3.2">Password-Retry AVP</a>
</li>
<li>4.3.3.   <a href="#rfc.section.4.3.3">Prompt AVP</a>
</li>
<li>4.3.4.   <a href="#rfc.section.4.3.4">CHAP-Auth AVP</a>
</li>
<li>4.3.5.   <a href="#rfc.section.4.3.5">CHAP-Algorithm AVP</a>
</li>
<li>4.3.6.   <a href="#rfc.section.4.3.6">CHAP-Ident AVP</a>
</li>
<li>4.3.7.   <a href="#rfc.section.4.3.7">CHAP-Response AVP</a>
</li>
<li>4.3.8.   <a href="#rfc.section.4.3.8">CHAP-Challenge AVP</a>
</li>
<li>4.3.9.   <a href="#rfc.section.4.3.9">ARAP-Password AVP</a>
</li>
<li>4.3.10.   <a href="#rfc.section.4.3.10">ARAP-Challenge-Response AVP</a>
</li>
<li>4.3.11.   <a href="#rfc.section.4.3.11">ARAP-Security AVP</a>
</li>
<li>4.3.12.   <a href="#rfc.section.4.3.12">ARAP-Security-Data AVP</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">NAS Authorization AVPs</a>
</li>
<li>4.4.1.   <a href="#rfc.section.4.4.1">Service-Type AVP</a>
</li>
<li>4.4.2.   <a href="#rfc.section.4.4.2">Callback-Number AVP</a>
</li>
<li>4.4.3.   <a href="#rfc.section.4.4.3">Callback-Id AVP</a>
</li>
<li>4.4.4.   <a href="#rfc.section.4.4.4">Idle-Timeout AVP</a>
</li>
<li>4.4.5.   <a href="#rfc.section.4.4.5">Port-Limit AVP</a>
</li>
<li>4.4.6.   <a href="#rfc.section.4.4.6">NAS-Filter-Rule AVP</a>
</li>
<li>4.4.7.   <a href="#rfc.section.4.4.7">Filter-Id AVP</a>
</li>
<li>4.4.8.   <a href="#rfc.section.4.4.8">Configuration-Token AVP</a>
</li>
<li>4.4.9.   <a href="#rfc.section.4.4.9">QoS-Filter-Rule AVP</a>
</li>
<li>4.4.10.   <a href="#rfc.section.4.4.10">Framed Access Authorization AVPs</a>
</li>
<li>4.4.10.1.   <a href="#rfc.section.4.4.10.1">Framed-Protocol AVP</a>
</li>
<li>4.4.10.2.   <a href="#rfc.section.4.4.10.2">Framed-Routing AVP</a>
</li>
<li>4.4.10.3.   <a href="#rfc.section.4.4.10.3">Framed-MTU AVP</a>
</li>
<li>4.4.10.4.   <a href="#rfc.section.4.4.10.4">Framed-Compression AVP</a>
</li>
<li>4.4.10.5.   <a href="#rfc.section.4.4.10.5">IP Access Authorization AVPs</a>
</li>
<li>4.4.10.5.1.   <a href="#rfc.section.4.4.10.5.1">Framed-IP-Address AVP</a>
</li>
<li>4.4.10.5.2.   <a href="#rfc.section.4.4.10.5.2">Framed-IP-Netmask AVP</a>
</li>
<li>4.4.10.5.3.   <a href="#rfc.section.4.4.10.5.3">Framed-Route AVP</a>
</li>
<li>4.4.10.5.4.   <a href="#rfc.section.4.4.10.5.4">Framed-Pool AVP</a>
</li>
<li>4.4.10.5.5.   <a href="#rfc.section.4.4.10.5.5">Framed-Interface-Id AVP</a>
</li>
<li>4.4.10.5.6.   <a href="#rfc.section.4.4.10.5.6">Framed-IPv6-Prefix AVP</a>
</li>
<li>4.4.10.5.7.   <a href="#rfc.section.4.4.10.5.7">Framed-IPv6-Route AVP</a>
</li>
<li>4.4.10.5.8.   <a href="#rfc.section.4.4.10.5.8">Framed-IPv6-Pool AVP</a>
</li>
<li>4.4.10.6.   <a href="#rfc.section.4.4.10.6">IPX Access AVPs</a>
</li>
<li>4.4.10.6.1.   <a href="#rfc.section.4.4.10.6.1">Framed-IPX-Network AVP</a>
</li>
<li>4.4.10.7.   <a href="#rfc.section.4.4.10.7">AppleTalk Network Access AVPs</a>
</li>
<li>4.4.10.7.1.   <a href="#rfc.section.4.4.10.7.1">Framed-AppleTalk-Link AVP</a>
</li>
<li>4.4.10.7.2.   <a href="#rfc.section.4.4.10.7.2">Framed-AppleTalk-Network AVP</a>
</li>
<li>4.4.10.7.3.   <a href="#rfc.section.4.4.10.7.3">Framed-AppleTalk-Zone AVP</a>
</li>
<li>4.4.10.8.   <a href="#rfc.section.4.4.10.8">AppleTalk Remote Access AVPs</a>
</li>
<li>4.4.10.8.1.   <a href="#rfc.section.4.4.10.8.1">ARAP-Features AVP</a>
</li>
<li>4.4.10.8.2.   <a href="#rfc.section.4.4.10.8.2">ARAP-Zone-Access AVP</a>
</li>
<li>4.4.11.   <a href="#rfc.section.4.4.11">Non-Framed Access Authorization AVPs</a>
</li>
<li>4.4.11.1.   <a href="#rfc.section.4.4.11.1">Login-IP-Host AVP</a>
</li>
<li>4.4.11.2.   <a href="#rfc.section.4.4.11.2">Login-IPv6-Host AVP</a>
</li>
<li>4.4.11.3.   <a href="#rfc.section.4.4.11.3">Login-Service AVP</a>
</li>
<li>4.4.11.4.   <a href="#rfc.section.4.4.11.4">TCP Services</a>
</li>
<li>4.4.11.4.1.   <a href="#rfc.section.4.4.11.4.1">Login-TCP-Port AVP</a>
</li>
<li>4.4.11.5.   <a href="#rfc.section.4.4.11.5">LAT Services</a>
</li>
<li>4.4.11.5.1.   <a href="#rfc.section.4.4.11.5.1">Login-LAT-Service AVP</a>
</li>
<li>4.4.11.5.2.   <a href="#rfc.section.4.4.11.5.2">Login-LAT-Node AVP</a>
</li>
<li>4.4.11.5.3.   <a href="#rfc.section.4.4.11.5.3">Login-LAT-Group AVP</a>
</li>
<li>4.4.11.5.4.   <a href="#rfc.section.4.4.11.5.4">Login-LAT-Port AVP</a>
</li>
<li>4.5.   <a href="#rfc.section.4.5">NAS Tunneling AVPs</a>
</li>
<li>4.5.1.   <a href="#rfc.section.4.5.1">Tunneling AVP</a>
</li>
<li>4.5.2.   <a href="#rfc.section.4.5.2">Tunnel-Type AVP</a>
</li>
<li>4.5.3.   <a href="#rfc.section.4.5.3">Tunnel-Medium-Type AVP</a>
</li>
<li>4.5.4.   <a href="#rfc.section.4.5.4">Tunnel-Client-Endpoint AVP</a>
</li>
<li>4.5.5.   <a href="#rfc.section.4.5.5">Tunnel-Server-Endpoint AVP</a>
</li>
<li>4.5.6.   <a href="#rfc.section.4.5.6">Tunnel-Password AVP</a>
</li>
<li>4.5.7.   <a href="#rfc.section.4.5.7">Tunnel-Private-Group-Id AVP</a>
</li>
<li>4.5.8.   <a href="#rfc.section.4.5.8">Tunnel-Assignment-Id AVP</a>
</li>
<li>4.5.9.   <a href="#rfc.section.4.5.9">Tunnel-Preference AVP</a>
</li>
<li>4.5.10.   <a href="#rfc.section.4.5.10">Tunnel-Client-Auth-Id AVP</a>
</li>
<li>4.5.11.   <a href="#rfc.section.4.5.11">Tunnel-Server-Auth-Id AVP</a>
</li>
<li>4.6.   <a href="#rfc.section.4.6">NAS Accounting AVPs</a>
</li>
<li>4.6.1.   <a href="#rfc.section.4.6.1">Accounting-Input-Octets AVP</a>
</li>
<li>4.6.2.   <a href="#rfc.section.4.6.2">Accounting-Output-Octets AVP</a>
</li>
<li>4.6.3.   <a href="#rfc.section.4.6.3">Accounting-Input-Packets AVP</a>
</li>
<li>4.6.4.   <a href="#rfc.section.4.6.4">Accounting-Output-Packets AVP</a>
</li>
<li>4.6.5.   <a href="#rfc.section.4.6.5">Acct-Session-Time AVP</a>
</li>
<li>4.6.6.   <a href="#rfc.section.4.6.6">Acct-Authentic AVP</a>
</li>
<li>4.6.7.   <a href="#rfc.section.4.6.7">Accounting-Auth-Method AVP</a>
</li>
<li>4.6.8.   <a href="#rfc.section.4.6.8">Acct-Delay-Time AVP</a>
</li>
<li>4.6.9.   <a href="#rfc.section.4.6.9">Acct-Link-Count AVP</a>
</li>
<li>4.6.10.   <a href="#rfc.section.4.6.10">Acct-Tunnel-Connection AVP</a>
</li>
<li>4.6.11.   <a href="#rfc.section.4.6.11">Acct-Tunnel-Packets-Lost AVP</a>
</li>
<li>5.   <a href="#rfc.section.5">AVP Occurrence Tables</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">AA-Request/Answer AVP Table</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Accounting AVP Tables</a>
</li>
<li>5.2.1.   <a href="#rfc.section.5.2.1">Framed Access Accounting AVP Table</a>
</li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">Non-Framed Access Accounting AVP Table</a>
</li>
<li>6.   <a href="#rfc.section.6">IANA Considerations</a>
</li>
<li>7.   <a href="#rfc.section.7">Security Considerations</a>
</li>
<li>8.   <a href="#rfc.references">References</a>
</li>
<li>8.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>8.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Acknowledgements</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">RFC 4005</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">RFC 4005bis</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document describes the Diameter protocol application used for AAA in the Network Access Server (NAS) environment.  When combined with the Diameter Base protocol <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>, Transport Profile <a href="#RFC3539">[RFC3539]</a>, and EAP <a href="#RFC4072">[RFC4072]</a> specifications, this specification satisfies the NAS-related requirements defined in <a href="#RFC2989">[RFC2989]</a> and <a href="#RFC3169">[RFC3169]</a>.  <br><br> First, this document describes the operation of a Diameter NAS application.  Then it defines the Diameter message Command-Codes.  The following sections list the AVPs used in these messages, grouped by common usage.  These are session identification, authentication, authorization, tunneling, and accounting.  The authorization AVPs are further broken down by service type.  </p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Terminology</h1>
<p id="rfc.section.1.1.p.1">Section 1.2 of the base Diameter specification <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> defines most of the terminology used in this document.  Additionally, the following terms and acronyms are used in this application: </p>

<dl>
<dt>NAS (Network Access Server)</dt>
<dd style="margin-left: 8">
<br> A device that provides an access service for a user to a network.  The service may be a network connection or a value-added service such as terminal emulation <a href="#RFC2881">[RFC2881]</a>.  </dd>
<dt>PPP (Point-to-Point Protocol)</dt>
<dd style="margin-left: 8">
<br> A multiprotocol serial datalink.  PPP is the primary IP datalink used for dial-in NAS connection service <a href="#RFC1661">[RFC1661]</a>.  </dd>
<dt>CHAP (Challenge Handshake Authentication Protocol)</dt>
<dd style="margin-left: 8">
<br> An authentication process used in PPP <a href="#RFC1994">[RFC1994]</a>.  </dd>
<dt>PAP (Password Authentication Protocol)</dt>
<dd style="margin-left: 8">
<br> A deprecated PPP authentication process, but often used for backward compatibility <a href="#RFC1334">[RFC1334]</a>.  </dd>
<dt>SLIP (Serial Line Interface Protocol)</dt>
<dd style="margin-left: 8">
<br> A serial datalink that only supports IP.  A design prior to PPP.  </dd>
<dt>ARAP (Appletalk Remote Access Protocol)</dt>
<dd style="margin-left: 8">
<br> A serial datalink for accessing Appletalk networks <a href="#ARAP">[ARAP]</a>.  </dd>
<dt>IPX (Internet Packet Exchange)</dt>
<dd style="margin-left: 8">
<br> The network protocol used by NetWare networks <a href="#IPX">[IPX]</a>.  </dd>
<dt>L2TP (Layer Two Tunneling Protocol) </dt>
<dd style="margin-left: 8">
<br><br> L2TP <a href="#RFC3931">[RFC3931]</a> provides a dynamic mechanism for tunneling Layer 2 "circuits" across a packet-oriented data network.  </dd>
<dt>LAC (L2TP Access Concentrator)</dt>
<dd style="margin-left: 8">
<br><br> An L2TP Control Connection Endpoint being used tocross-connect an L2TP session directly to a data link <a href="#RFC3931">[RFC3931]</a>.  </dd>
<dt>LAT (Local Area Transport)</dt>
<dd style="margin-left: 8">
<br> A Digital Equipment Corp. LAN protocol for terminal services <a href="#LAT">[LAT]</a>.  </dd>
<dt>LCP (Link Control Protocol)</dt>
<dd style="margin-left: 8">
<br><br> One of the three major components of PPP <a href="#RFC1661">[RFC1661]</a>.  LCP is used to automatically agree upon encapsulation format options, handle varying limits on sizes of packets, detect a looped-back link and other common misconfiguration errors, and terminate the link.  Other optional facilities provided are authentication of the identity of its peer on the link, and determination when a link is functioning properly and when it is failing.  </dd>
<dt>PAC (PPTP Access Concentrator)</dt>
<dd style="margin-left: 8">
<br><br> A device attached to one or more Public Switched Telephone Network (PSTN) or Integrated Services Digtal Network (ISDN) lines capable of PPP operation and of handling PPTP <a href="#RFC2637">[RFC2637]</a>.  </dd>
<dt>PPTP (Point-to-Point Tunneling Protocol)</dt>
<dd style="margin-left: 8">
<br><br> A protocol which allows PPP to be tunneled through an IP network <a href="#RFC2637">[RFC2637]</a>.  </dd>
<dt>VPN (Virtual Private Network)</dt>
<dd style="margin-left: 8">
<br> In this document, this term is used to describe access services that use tunneling methods.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Requirements Language</h1>
<p id="rfc.section.1.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 <a href="#RFC2119">[RFC2119]</a>.  </p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> <a href="#A-A-S" id="A-A-S">Advertising Application Support</a>
</h1>
<p id="rfc.section.1.3.p.1">Diameter applications conforming to this specification MUST advertise support by including the value of one (1) in the Auth-Application-Id of the Capabilities-Exchange-Request (CER), AA-Request (AAR), and AA-Answer (AAA) messages.  All other messages use the Base application id value <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> NAS Calls, Ports, and Sessions</h1>
<p id="rfc.section.2.p.1">The arrival of a new call or service connection at a port of a Network Access Server (NAS) starts a Diameter NAS message exchange.  Information about the call, the identity of the user, and the user's authentication information are packaged into a Diameter AA-Request (AAR) message and sent to a server.  <br><br> The server processes the information and responds with a Diameter AA-Answer (AAA) message that contains authorization information for the NAS, or a failure code (Result-Code AVP).  A value of DIAMETER_MULTI_ROUND_AUTH indicates an additional authentication exchange, and several AAR and AAA messages may be exchanged until the transaction completes.  <br><br> Depending on the value of the Auth-Request-Type AVP, the Diameter protocol allows authorization-only requests that contain no authentication information from the client.  This capability goes beyond the Call Check capabilities provided by RADIUS (<a href="#RFC2865">Section 5.6 of</a> <cite title="NONE">[RFC2865]</cite>) in that no access decision is requested.  As a result, service cannot be started as a result of a response to an authorization-only request without introducing a significant security vulnerability.  </p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Diameter Session Establishment</h1>
<p id="rfc.section.2.1.p.1">When the authentication or authorization exchange completes successfully, the NAS application SHOULD start a session context.  If the Result-Code of DIAMETER_MULTI_ROUND_AUTH is returned, the exchange continues until a success or error is returned.  <br><br> If accounting is active, the application MUST also send an Accounting message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>.  An Accounting-Record-Type of START_RECORD is sent for a new session.  If a session fails to start, the EVENT_RECORD message is sent with the reason for the failure described.  <br><br> Note that the return of an unsupportable Accounting-Realtime-Required value <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> would result in a failure to establish the session.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Diameter Session Reauthentication or Reauthorization</h1>
<p id="rfc.section.2.2.p.1">The Diameter Base protocol allows users to be periodically reauthenticated and/or reauthorized.  In such instances, the Session-Id AVP in the AAR message MUST be the same as the one present in the original authentication/authorization message.  <br><br> A Diameter server informs the NAS of the maximum time allowed before reauthentication or reauthorization via the Authorization-Lifetime AVP <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>.  A NAS MAY reauthenticate and/or reauthorize before the end, but A NAS MUST reauthenticate and/or reauthorize at the end of the period provided by the Authorization-Lifetime AVP.  The failure of a reauthentication exchange will terminate the service.  <br><br> Furthermore, it is possible for Diameter servers to issue an unsolicited reauthentication and/or reauthorization request (e.g., Re-Auth-Request (RAR) message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>) to the NAS.  Upon receipt of such a message, the NAS MUST respond to the request with a Re-Auth-Answer (RAA) message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>.  <br><br> If the RAR properly identifies an active session, the NAS will initiate a new local reauthentication or authorization sequence as indicated by the Re-Auth-Request-Type value.  This will cause the NAS to send a new AAR message using the existing Session-Id.  The server will respond with an AAA message to specify the new service parameters.  <br><br> If accounting is active, every change of authentication or authorization SHOULD generate an accounting message.  If the NAS service is a continuation of the prior user context, then an Accounting-Record-Type of INTERIM_RECORD indicating the new session attributes and cumulative status would be appropriate.  If a new user or a significant change in authorization is detected by the NAS, then the service may send two messages of the types STOP_RECORD and START_RECORD.  Accounting may change the subsession identifiers (Acct-Session-ID, or Acct-Sub-Session-Id) to indicate such sub-sessions.  A service may also use a different Session-Id value for accounting (see <a href="#I-D.ietf-dime-rfc3588bis">Section 9.6 of</a> <cite title="NONE">[I-D.ietf-dime-rfc3588bis]</cite>).  <br><br> However, the Diameter Session-ID AVP value used for the initial authorization exchange MUST be used to generate an STR message when the session context is terminated.  </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> Diameter Session Termination</h1>
<p id="rfc.section.2.3.p.1">When a NAS receives an indication that a user's session is being disconnected by the client (e.g., an LCP Terminate-Request message <a href="#RFC1661">[RFC1661]</a> is received) or an administrative command, the NAS MUST issue a Session-Termination-Request (STR) <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> to its Diameter Server.  This will ensure that any resources maintained on the servers are freed appropriately.  <br><br> Furthermore, a NAS that receives an Abort-Session-Request (ASR) <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> MUST issue an ASA if the session identified is active and disconnect the PPP (or tunneling) session.  <br><br> If accounting is active, an Accounting STOP_RECORD message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> MUST be sent upon termination of the session context.  <br><br> More information on Diameter Session Termination can be found in <a href="#I-D.ietf-dime-rfc3588bis">Sections 8.4 and 8.5 of</a> <cite title="NONE">[I-D.ietf-dime-rfc3588bis]</cite>.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Diameter NAS Application Messages</h1>
<p id="rfc.section.3.p.1">This section defines the Diameter message Command-Code <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> values that MUST be supported by all Diameter implementations conforming to this specification.  The Command Codes are as follows: </p>
<div id="#rfc.table.1"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Command Name</th>
<th class="center">Abbrev.</th>
<th class="center">Code</th>
<th class="left">Reference</th>
</tr></thead>
<tbody>
<tr>
<td class="left">AA-Request</td>
<td class="center">AAR</td>
<td class="center">265</td>
<td class="left"><a href="#AAR">Section 3.1</a></td>
</tr>
<tr>
<td class="left">AA-Answer</td>
<td class="center">AAA</td>
<td class="center">265</td>
<td class="left"><a href="#AAA">Section 3.2</a></td>
</tr>
<tr>
<td class="left">Re-Auth-Request</td>
<td class="center">RAR</td>
<td class="center">258</td>
<td class="left"><a href="#RAR">Section 3.3</a></td>
</tr>
<tr>
<td class="left">Re-Auth-Answer</td>
<td class="center">RAA</td>
<td class="center">258</td>
<td class="left"><a href="#RAA">Section 3.4</a></td>
</tr>
<tr>
<td class="left">Session-Termination-Request</td>
<td class="center">STR</td>
<td class="center">275</td>
<td class="left"><a href="#STR">Section 3.5</a></td>
</tr>
<tr>
<td class="left">Session-Termination-Answer</td>
<td class="center">STA</td>
<td class="center">275</td>
<td class="left"><a href="#STA">Section 3.6</a></td>
</tr>
<tr>
<td class="left">Abort-Session-Request</td>
<td class="center">ASR</td>
<td class="center">274</td>
<td class="left"><a href="#ASR">Section 3.7</a></td>
</tr>
<tr>
<td class="left">Abort-Session-Answer</td>
<td class="center">ASA</td>
<td class="center">274</td>
<td class="left"><a href="#ASA">Section 3.8</a></td>
</tr>
<tr>
<td class="left">Accounting-Request</td>
<td class="center">ACR</td>
<td class="center">271</td>
<td class="left"><a href="#ACR">Section 3.9</a></td>
</tr>
<tr>
<td class="left">Accounting-Answer</td>
<td class="center">ACA</td>
<td class="center">271</td>
<td class="left"><a href="#ACA">Section 3.10</a></td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#AAR" id="AAR">AA-Request (AAR) Command</a>
</h1>
<div id="#rfc.figure.1"></div>
<div id="#figAAR"></div>
<pre>
   Message Format
   
      &lt;AA-Request&gt; ::= &lt; Diameter Header: 265, REQ, PXY &gt;
                       &lt; Session-Id &gt;
                       { Auth-Application-Id }
                       { Origin-Host }
                       { Origin-Realm }
                       { Destination-Realm }
                       { Auth-Request-Type }
                       [ Destination-Host ]
                       [ NAS-Identifier ]
                       [ NAS-IP-Address ]
                       [ NAS-IPv6-Address ]
                       [ NAS-Port ]
                       [ NAS-Port-Id ]
                       [ NAS-Port-Type ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ Port-Limit ]
                       [ User-Name ]
                       [ User-Password ]
                       [ Service-Type ]
                       [ State ]
                       [ Authorization-Lifetime ]
                       [ Auth-Grace-Period ]
                       [ Auth-Session-State ]
                       [ Callback-Number ]
                       [ Called-Station-Id ]
                       [ Calling-Station-Id ]
                       [ Originating-Line-Info ]
                       [ Connect-Info ]
                       [ CHAP-Auth ]
                       [ CHAP-Challenge ]
                     * [ Framed-Compression ]
                       [ Framed-Interface-Id ]
                       [ Framed-IP-Address ]
                     * [ Framed-IPv6-Prefix ]
                       [ Framed-IP-Netmask ]
                       [ Framed-MTU ]
                       [ Framed-Protocol ]
                       [ ARAP-Password ]
                       [ ARAP-Security ]
                     * [ ARAP-Security-Data ]
                     * [ Login-IP-Host ]
                     * [ Login-IPv6-Host ]
                       [ Login-LAT-Group ]
                       [ Login-LAT-Node ]
                       [ Login-LAT-Port ]
                       [ Login-LAT-Service ]
                     * [ Tunneling ]
                     * [ Proxy-Info ]
                     * [ Route-Record ]
                     * [ AVP ]
</pre>
<p id="rfc.section.3.1.p.1">The AA-Request (AAR), which is indicated by setting the Command-Code field to 265 and the 'R' bit in the Command Flags field, is used to request authentication and/or authorization for a given NAS user.  The type of request is identified through the Auth-Request-Type AVP <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> The recommended value for most situations is AUTHORIZE_AUTHENTICATE.  <br><br> If Authentication is requested, the User-Name attribute SHOULD be present, as well as any additional authentication AVPs that would carry the password information.  A request for authorization SHOULD only include the information from which the authorization will be performed, such as the User-Name, Called-Station-Id, or Calling-Station-Id AVPs.  All requests SHOULD contain AVPs uniquely identifying the source of the call, such as Origin-Host and NAS-Port.  Certain networks MAY use different AVPs for authorization purposes.  A request for authorization will include some AVPs defined in <a href="#AUTHZ-AVP">Section 4.4</a>.  <br><br> It is possible for a single session to be authorized first and then for an authentication request to follow.  <br><br> This AA-Request message MAY be the result of a multi-round authentication exchange, which occurs when the AA-Answer message is received with the Result-Code AVP set to DIAMETER_MULTI_ROUND_AUTH.  A subsequent AAR message SHOULD be sent, with the User-Password AVP that includes the user's response to the prompt, and MUST include any State AVPs that were present in the AAA message.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#AAA" id="AAA">AA-Answer (AAA) Command</a>
</h1>
<div id="#rfc.figure.2"></div>
<div id="#figAAA"></div>
<pre>
   Message Format

      &lt;AA-Answer&gt; ::= &lt; Diameter Header: 265, PXY &gt;
                      &lt; Session-Id &gt;
                      { Auth-Application-Id }
                      { Auth-Request-Type }
                      { Result-Code }
                      { Origin-Host }
                      { Origin-Realm }
                      [ User-Name ]
                      [ Service-Type ]
                    * [ Class ]
                    * [ Configuration-Token ]
                      [ Acct-Interim-Interval ]
                      [ Error-Message ]
                      [ Error-Reporting-Host ]
                    * [ Failed-AVP ]
                      [ Idle-Timeout ]
                      [ Authorization-Lifetime ]
                      [ Auth-Grace-Period ]
                      [ Auth-Session-State ]
                      [ Re-Auth-Request-Type ]
                      [ Multi-Round-Time-Out ]
                      [ Session-Timeout ]
                      [ State ]
                    * [ Reply-Message ]
                      [ Origin-AAA-Protocol ]
                      [ Origin-State-Id ]
                    * [ Filter-Id ]
                      [ Password-Retry ]
                      [ Port-Limit ]
                      [ Prompt ]
                      [ ARAP-Challenge-Response ]
                      [ ARAP-Features ]
                      [ ARAP-Security ]
                    * [ ARAP-Security-Data ]
                      [ ARAP-Zone-Access ]
                      [ Callback-Id ]
                      [ Callback-Number ]
                      [ Framed-Appletalk-Link ]
                    * [ Framed-Appletalk-Network ]
                      [ Framed-Appletalk-Zone ]
                    * [ Framed-Compression ]
                      [ Framed-Interface-Id ]
                      [ Framed-IP-Address ]
                    * [ Framed-IPv6-Prefix ]
                      [ Framed-IPv6-Pool ]
                    * [ Framed-IPv6-Route ]
                      [ Framed-IP-Netmask ]
                    * [ Framed-Route ]
                      [ Framed-Pool ]
                      [ Framed-IPX-Network ]
                      [ Framed-MTU ]
                      [ Framed-Protocol ]
                      [ Framed-Routing ]
                    * [ Login-IP-Host ]
                    * [ Login-IPv6-Host ]
                      [ Login-LAT-Group ]
                      [ Login-LAT-Node ]
                      [ Login-LAT-Port ]
                      [ Login-LAT-Service ]
                      [ Login-Service ]
                      [ Login-TCP-Port ]
                    * [ NAS-Filter-Rule ]
                    * [ QoS-Filter-Rule ]
                    * [ Tunneling ]
                    * [ Redirect-Host ]
                      [ Redirect-Host-Usage ]
                      [ Redirect-Max-Cache-Time ]
                    * [ Proxy-Info ]
                    * [ AVP ]
</pre>
<p id="rfc.section.3.2.p.1">The AA-Answer (AAA) message is indicated by setting the Command-Code field to 265 and clearing the 'R' bit in the Command Flags field.  It is sent in response to the AA-Request (AAR) message.  If authorization was requested, a successful response will include the authorization AVPs appropriate for the service being provided, as defined in <a href="#AUTHZ-AVP">Section 4.4</a>.  <br><br> For authentication exchanges requiring more than a single round trip, the server MUST set the Result-Code AVP to DIAMETER_MULTI_ROUND_AUTH.  An AAA message with this result code MAY include one Reply-Message or more and MAY include zero or one State AVPs.  <br><br> If the Reply-Message AVP was present, the network access server SHOULD send the text to the user's client to display to the user, instructing the client to prompt the user for a response.  For example, this capability can be achieved in PPP via PAP.  If the access client is unable to prompt the user for a new response, it MUST treat the AA-Answer (AAA) with the Reply-Message AVP as an error and deny access.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#RAR" id="RAR">Re-Auth-Request (RAR) Command</a>
</h1>
<div id="#rfc.figure.3"></div>
<div id="#figRAR"></div>
<pre>
   Message Format

      &lt;RA-Request&gt;  ::= &lt; Diameter Header: 258, REQ, PXY &gt;
                       &lt; Session-Id &gt;
                       { Origin-Host }
                       { Origin-Realm }
                       { Destination-Realm }
                       { Destination-Host }
                       { Auth-Application-Id }
                       { Re-Auth-Request-Type }
                       [ User-Name ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ NAS-Identifier ]
                       [ NAS-IP-Address ]
                       [ NAS-IPv6-Address ]
                       [ NAS-Port ]
                       [ NAS-Port-Id ]
                       [ NAS-Port-Type ]
                       [ Service-Type ]
                       [ Framed-IP-Address ]
                       [ Framed-IPv6-Prefix ]
                       [ Framed-Interface-Id ]
                       [ Called-Station-Id ]
                       [ Calling-Station-Id ]
                       [ Originating-Line-Info ]
                       [ Acct-Session-Id ]
                       [ Acct-Multi-Session-Id ]
                       [ State ]
                     * [ Class ]
                       [ Reply-Message ]
                     * [ Proxy-Info ]
                     * [ Route-Record ]
                     * [ AVP ]
</pre>
<p id="rfc.section.3.3.p.1">A Diameter server may initiate a re-authentication and/or re- authorization service for a particular session by issuing a Re-Auth-Request (RAR) message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>.  <br><br> For example, for pre-paid services, the Diameter server that originally authorized a session may need some confirmation that the user is still using the services.  <br><br> If a NAS receives an RAR message with Session-Id equal to a currently active session and a Re-Auth-Type that includes authentication, it MUST initiate a re-authentication toward the user, if the service supports this particular feature.  </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#RAA" id="RAA">Re-Auth-Answer (RAA) Command</a>
</h1>
<div id="#rfc.figure.4"></div>
<div id="#figRAA"></div>
<pre>
   Message Format

      &lt;RA-Answer&gt;  ::= &lt; Diameter Header: 258, PXY &gt;
                       &lt; Session-Id &gt;
                       { Result-Code }
                       { Origin-Host }
                       { Origin-Realm }
                       [ User-Name ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ Error-Message ]
                       [ Error-Reporting-Host ]
                     * [ Failed-AVP ]
                     * [ Redirected-Host ]
                       [ Redirected-Host-Usage ]
                       [ Redirected-Host-Cache-Time ]
                       [ Service-Type ]
                     * [ Configuration-Token ]
                       [ Idle-Timeout ]
                       [ Authorization-Lifetime ]
                       [ Auth-Grace-Period ]
                       [ Re-Auth-Request-Type ]
                       [ State ]
                     * [ Class ]
                     * [ Reply-Message ]
                       [ Prompt ]
                     * [ Proxy-Info ]
                     * [ AVP ]
</pre>
<p id="rfc.section.3.4.p.1">The Re-Auth-Answer (RAA) message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> is sent in response to the RAR.  The Result-Code AVP MUST be present and indicates the disposition of the request.  <br><br> A successful RAA transaction MUST be followed by an AAR message.  </p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#STR" id="STR">Session-Termination-Request (STR) Command</a>
</h1>
<div id="#rfc.figure.5"></div>
<div id="#figSTR"></div>
<pre>	
   Message Format

      &lt;ST-Request&gt; ::= &lt; Diameter Header: 275, REQ, PXY &gt;
                      &lt; Session-Id &gt;
                      { Origin-Host }
                      { Origin-Realm }
                      { Destination-Realm }
                      { Auth-Application-Id }
                      { Termination-Cause }
                      [ User-Name ]
                      [ Destination-Host ]
                    * [ Class ]
                      [ Origin-AAA-Protocol ]
                      [ Origin-State-Id ]
                    * [ Proxy-Info ]
                    * [ Route-Record ]
                    * [ AVP ]
</pre>
<p id="rfc.section.3.5.p.1">The Session-Termination-Request (STR) message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> is sent by the NAS to inform the Diameter Server that an authenticated and/or authorized session is being terminated.  </p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> <a href="#STA" id="STA">Session-Termination-Answer (STA) Command</a>
</h1>
<div id="#rfc.figure.6"></div>
<div id="#figSTA"></div>
<pre>
   Message Format

      &lt;ST-Answer&gt;  ::= &lt; Diameter Header: 275, PXY &gt;
                       &lt; Session-Id &gt;
                       { Result-Code }
                       { Origin-Host }
                       { Origin-Realm }
                       [ User-Name ]
                     * [ Class ]
                       [ Error-Message ]
                       [ Error-Reporting-Host ]
                     * [ Failed-AVP ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                     * [ Redirect-Host ]
                       [ Redirect-Host-Usase ]
                       [ Redirect-Max-Cache-Time ]
                     * [ Proxy-Info ]
                     * [ AVP ]
</pre>
<p id="rfc.section.3.6.p.1">The Session-Termination-Answer (STA) message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> is sent by the Diameter Server to acknowledge the notification that the session has been terminated.  The Result-Code AVP MUST be present and MAY contain an indication that an error occurred while the STR was being serviced.  <br><br> Upon sending or receiving the STA, the Diameter Server MUST release all resources for the session indicated by the Session-Id AVP.  Any intermediate server in the Proxy-Chain MAY also release any resources, if necessary.  </p>
<h1 id="rfc.section.3.7">
<a href="#rfc.section.3.7">3.7.</a> <a href="#ASR" id="ASR">Abort-Session-Request (ASR) Command</a>
</h1>
<div id="#rfc.figure.7"></div>
<div id="#figASR"></div>
<pre>
   Message Format

      &lt;AS-Request&gt;  ::= &lt; Diameter Header: 274, REQ, PXY &gt;
                       &lt; Session-Id &gt;
                       { Origin-Host }
                       { Origin-Realm }
                       { Destination-Realm }
                       { Destination-Host }
                       { Auth-Application-Id }
                       [ User-Name ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ NAS-Identifier ]
                       [ NAS-IP-Address ]
                       [ NAS-IPv6-Address ]
                       [ NAS-Port ]
                       [ NAS-Port-Id ]
                       [ NAS-Port-Type ]
                       [ Service-Type ]
                       [ Framed-IP-Address ]
                       [ Framed-IPv6-Prefix ]
                       [ Framed-Interface-Id ]
                       [ Called-Station-Id ]
                       [ Calling-Station-Id ]
                       [ Originating-Line-Info ]
                       [ Acct-Session-Id ]
                       [ Acct-Multi-Session-Id ]
                       [ State ]
                     * [ Class ]
                     * [ Reply-Message ]
                     * [ Proxy-Info ]
                     * [ Route-Record ]
                     * [ AVP ]
</pre>
<p id="rfc.section.3.7.p.1">The Abort-Session-Request (ASR) message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> may be sent by any server to the NAS providing session service, to request that the session identified by the Session-Id be stopped.  </p>
<h1 id="rfc.section.3.8">
<a href="#rfc.section.3.8">3.8.</a> <a href="#ASA" id="ASA">Abort-Session-Answer (ASA) Command</a>
</h1>
<div id="#rfc.figure.8"></div>
<div id="#figASA"></div>
<pre>
   Message Format

      &lt;AS-Answer&gt;  ::= &lt; Diameter Header: 274, PXY &gt;
                       &lt; Session-Id &gt;
                       { Result-Code }
                       { Origin-Host }
                       { Origin-Realm }
                       [ User-Name ]
                       [ Origin-AAA-Protocol ]
                       [ Origin-State-Id ]
                       [ State]
                       [ Error-Message ]
                       [ Error-Reporting-Host ]
                     * [ Failed-AVP ]
                     * [ Redirected-Host ]
                       [ Redirected-Host-Usage ]
                       [ Redirected-Max-Cache-Time ]
                     * [ Proxy-Info ]
                     * [ AVP ]
</pre>
<p id="rfc.section.3.8.p.1">The ASA message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> is sent in response to the ASR.  The Result-Code AVP MUST be present and indicates the disposition of the request.  <br><br> If the session identified by Session-Id in the ASR was successfully terminated, Result-Code is set to DIAMETER_SUCCESS.  If the session is not currently active, the Result-Code AVP is set to DIAMETER_UNKNOWN_SESSION_ID.  If the access device does not stop the session for any other reason, the Result-Code AVP is set to DIAMETER_UNABLE_TO_COMPLY.  </p>
<h1 id="rfc.section.3.9">
<a href="#rfc.section.3.9">3.9.</a> <a href="#ACR" id="ACR">Accounting-Request (ACR) Command</a>
</h1>
<div id="#rfc.figure.9"></div>
<div id="#figACR"></div>
<pre>
   Message Format

      &lt;AC-Request&gt; ::= &lt; Diameter Header: 271, REQ, PXY &gt;
                      &lt; Session-Id &gt;
                      { Origin-Host }
                      { Origin-Realm }
                      { Destination-Realm }
                      { Accounting-Record-Type }
                      { Accounting-Record-Number }
                      [ Acct-Application-Id ]
                      [ Vendor-Specific-Application-Id ]
                      [ User-Name ]
                      [ Accounting-Sub-Session-Id ]
                      [ Acct-Session-Id ]
                      [ Acct-Multi-Session-Id ]
                      [ Origin-AAA-Protocol ]
                      [ Origin-State-Id ]
                      [ Destination-Host ]
                      [ Event-Timestamp ]
                      [ Acct-Delay-Time ]
                      [ NAS-Identifier ]
                      [ NAS-IP-Address ]
                      [ NAS-IPv6-Address ]
                      [ NAS-Port ]
                      [ NAS-Port-Id ]
                      [ NAS-Port-Type ]
                    * [ Class ]
                      [ Service-Type ]
                      [ Termination-Cause ]
                      [ Accounting-Input-Octets ]
                      [ Accounting-Input-Packets ]
                      [ Accounting-Output-Octets ]
                      [ Accounting-Output-Packets ]
                      [ Acct-Authentic ]
                      [ Accounting-Auth-Method ]
                      [ Acct-Link-Count ]
                      [ Acct-Session-Time ]
                      [ Acct-Tunnel-Connection ]
                      [ Acct-Tunnel-Packets-Lost ]
                      [ Callback-Id ]
                      [ Callback-Number ]
                      [ Called-Station-Id ]
                      [ Calling-Station-Id ]
                    * [ Connection-Info ]
                      [ Originating-Line-Info ]
                      [ Authorization-Lifetime ]
                      [ Session-Timeout ]
                      [ Idle-Timeout ]
                      [ Port-Limit ]
                      [ Accounting-Realtime-Required ]
                      [ Acct-Interim-Interval ]
                    * [ Filter-Id ]
                    * [ NAS-Filter-Rule ]
                    * [ Qos-Filter-Rule ]
                      [ Framed-AppleTalk-Link ]
                      [ Framed-AppleTalk-Network ]
                      [ Framed-AppleTalk-Zone ]
                      [ Framed-Compression ]
                      [ Framed-Interface-Id ]
                      [ Framed-IP-Address ]
                      [ Framed-IP-Netmask ]
                    * [ Framed-IPv6-Prefix ]
                      [ Framed-IPv6-Pool ]
                    * [ Framed-IPv6-Route ]
                      [ Framed-IPX-Network ]
                      [ Framed-MTU ]
                      [ Framed-Pool ]
                      [ Framed-Protocol ]
                    * [ Framed-Route ]
                      [ Framed-Routing ]
                    * [ Login-IP-Host ]
                    * [ Login-IPv6-Host ]
                      [ Login-LAT-Group ]
                      [ Login-LAT-Node ]
                      [ Login-LAT-Port ]
                      [ Login-LAT-Service ]
                      [ Login-Service ]
                      [ Login-TCP-Port ]
                    * [ Tunneling ]
                    * [ Proxy-Info ]
                    * [ Route-Record ]
                    * [ AVP ]
</pre>
<p id="rfc.section.3.9.p.1">The ACR message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> is sent by the NAS to report its session information to a target server downstream.  <br><br> Either the Acct-Application-Id AVP or the Vendor-Specific-Application-Id AVP MUST be present.  If the Vendor-Specific-Application-Id grouped AVP is present, it must have an Acct-Application-Id inside.  <br><br> The AVPs listed in the Base protocol specification <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> MUST be assumed to be present, as appropriate.  NAS service-specific accounting AVPs SHOULD be present as described in <a href="#ACCT-AVP">Section 4.6</a> and the rest of this specification.  </p>
<h1 id="rfc.section.3.10">
<a href="#rfc.section.3.10">3.10.</a> <a href="#ACA" id="ACA">Accounting-Answer (ACA) Command</a>
</h1>
<div id="#rfc.figure.10"></div>
<div id="#figACA"></div>
<pre>
   Message Format

      &lt;AC-Answer&gt; ::= &lt; Diameter Header: 271, PXY &gt;
                      &lt; Session-Id &gt;
                      { Result-Code }
                      { Origin-Host }
                      { Origin-Realm }
                      { Accounting-Record-Type }
                      { Accounting-Record-Number }
                      [ Acct-Application-Id ]
                      [ Vendor-Specific-Application-Id ]
                      [ User-Name ]
                      [ Accounting-Sub-Session-Id ]
                      [ Acct-Session-Id ]
                      [ Acct-Multi-Session-Id ]
                      [ Event-Timestamp ]
                      [ Error-Message ]
                      [ Error-Reporting-Host ]
                    * [ Failed-AVP ]
                      [ Origin-AAA-Protocol ]
                      [ Origin-State-Id ]
                      [ NAS-Identifier ]
                      [ NAS-IP-Address ]
                      [ NAS-IPv6-Address ]
                      [ NAS-Port ]
                      [ NAS-Port-Id ]
                      [ NAS-Port-Type ]
                      [ Service-Type ]
                      [ Termination-Cause ]
                      [ Accounting-Realtime-Required ]
                      [ Acct-Interim-Interval ]
                    * [ Class ]
                    * [ Proxy-Info ]
                    * [ AVP ]
</pre>
<p id="rfc.section.3.10.p.1">The ACA message <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> is used to acknowledge an Accounting-Request command.  The Accounting-Answer command contains the same Session-Id as the Request.  If the Accounting-Request was protected by end-to-end security, then the corresponding ACA message MUST be protected as well.  <br><br> Only the target Diameter Server or home Diameter Server SHOULD respond with the Accounting-Answer command.  <br><br> Either the Acct-Application-Id AVP or the Vendor-Specific-Application-Id AVP MUST be present, as it was in the request.  <br><br> The AVPs listed in the Base protocol specification <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> MUST be assumed to be present, as appropriate.  NAS service-specific accounting AVPs SHOULD be present as described in <a href="#ACCT-AVP">Section 4.6</a> and the rest of this specification.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#D-N-A-AVPs" id="D-N-A-AVPs">Diameter NAS Application AVPs</a>
</h1>
<p id="rfc.section.4.p.1">The following sections define a new derived AVP data format, a set of application-specific AVPs and describe the use of AVPs defined in other documents by the Diameter NAS Application.  </p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> <a href="#D-A-D-F" id="D-A-D-F">Derived AVP Data Formats</a>
</h1>
<h1 id="rfc.section.4.1.1">
<a href="#rfc.section.4.1.1">4.1.1.</a> <a href="#QFR-Format" id="QFR-Format">QoSFilterRule</a>
</h1>
<p id="rfc.section.4.1.1.p.1">The QosFilterRule format is derived from the OctetString AVP Base Format.  It uses the ASCII charset.  Packets may be marked or metered based on the following information: <br><br> QoSFilterRule filters MUST follow the following format: <br><br> <a href="#Q-F-R-AVP">Section 4.4.9</a>.  <br><br> The rule syntax is a modified subset of ipfw(8) from FreeBSD, and the ipfw.c code may provide a useful base for implementations.  </p>

<ul>
<li>Direction (in or out)</li>
<li>Source and destination IP address (possibly masked)</li>
<li>Protocol</li>
<li>Source and destination port (lists or ranges)</li>
<li>DSCP values (no mask or range)</li>
</ul>

<p> Rules for the appropriate direction are evaluated in order; the first matched rule terminates the evaluation.  Each packet is evaluated once.  If no rule matches, the packet is treated as best effort.  An access device unable to interpret or apply a QoS rule SHOULD NOT terminate the session.  </p>

<ul class="empty">
<li>action dir proto from src to dst [options]</li>
<li>where <br><br> <dl>
<dt>action</dt>
<dd style="margin-left: 12">
<dl>
<dt>tag</dt>
<dd style="margin-left: 8">Mark packet with a specific DSCP <a href="#RFC2474">[RFC2474]</a> </dd>
<dt>meter</dt>
<dd style="margin-left: 8">Meter traffic</dd>
</dl>
<p> </p>
<br><br> </dd>
<dt>dir</dt>
<dd style="margin-left: 12">The format is as described under IPFilterRule <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> <br><br> </dd>
<dt>proto</dt>
<dd style="margin-left: 12">The format is as described under IPFilterRule <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> <br><br> </dd>
<dt>src and dst</dt>
<dd style="margin-left: 12">The format is as described under IPFilterRule <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> <br><br> </dd>
</dl>
<p> </p>
</li>
</ul>

<p> </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> <a href="#SESSION-AVP" id="SESSION-AVP">NAS Session AVPs</a>
</h1>
<p id="rfc.section.4.2.p.1">Diameter reserves the AVP Codes 0 - 255 for RADIUS Attributes that are implemented in Diameter.  </p>
<h1 id="rfc.section.4.2.1">
<a href="#rfc.section.4.2.1">4.2.1.</a> Call and Session Information</h1>
<div id="#rfc.figure.11"></div>
<pre>
                                         +----------+
                                         | AVP Flag | 
                                         |   rules  |
                                         |----+-----+
                                         |MUST| MUST|  
Attribute Name          Section Defined  |    |  NOT|
-----------------------------------------|----+-----|
NAS-Port                4.2.2            | M  |  V  |
NAS-Port-Id             4.2.3            | M  |  V  |
NAS-Port-Type           4.2.4            | M  |  V  | 
Called-Station-Id       4.2.5            | M  |  V  | 
Calling-Station-Id      4.2.6            | M  |  V  |
Connect-Info            4.2.7            | M  |  V  |
Originating-Line-Info   4.2.8            |    |  V  | 
Reply-Message           4.2.9            | M  |  V  |
-----------------------------------------|----+-----|
</pre>
<p id="rfc.section.4.2.1.p.1">This section describes the AVPs specific to Diameter applications that are needed to identify the call and session context and status information.  On a request, this information allows the server to qualify the session.  <br><br> These AVPs are used in addition to the following AVPs from the base protocol specification <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>: <br><br> <br><br> The following table gives the possible flag values for the session level AVPs and specifies whether the AVP MAY be encrypted.  </p>

<ul class="empty">
<li>Session-Id</li>
<li>Auth-Application-Id</li>
<li>Origin-Host</li>
<li>Origin-Realm</li>
<li>Auth-Request-Type</li>
<li>Termination-Cause</li>
</ul>

<p> </p>
<h1 id="rfc.section.4.2.2">
<a href="#rfc.section.4.2.2">4.2.2.</a> <a href="#N-P" id="N-P">NAS-Port AVP</a>
</h1>
<p id="rfc.section.4.2.2.p.1">The NAS-Port AVP (AVP Code 5) is of type Unsigned32 and contains the physical or virtual port number of the NAS which is authenticating the user.  Note that "port" is meant in its sense as a service connection on the NAS, not as an IP protocol identifier.  <br><br> Either the NAS-Port AVP or the NAS-Port-Id AVP (<a href="#N-P-I">Section 4.2.3</a>) SHOULD be present in the AA-Request (AAR, <a href="#AAR">Section 3.1</a>) command if the NAS differentiates among its ports.  </p>
<h1 id="rfc.section.4.2.3">
<a href="#rfc.section.4.2.3">4.2.3.</a> <a href="#N-P-I" id="N-P-I">NAS-Port-Id AVP</a>
</h1>
<p id="rfc.section.4.2.3.p.1">The NAS-Port-Id AVP (AVP Code 87) is of type UTF8String and consists of ASCII text identifying the port of the NAS authenticating the user.  Note that "port" is meant in its sense as a service connection on the NAS, not as an IP protocol identifier.  <br><br> Either the NAS-Port-Id or the NAS-Port (<a href="#N-P">Section 4.2.2</a>) SHOULD be present in the AA-Request (AAR, <a href="#AAR">Section 3.1</a>) command if the NAS differentiates among its ports.  NAS-Port-Id is intended for use by NASes that cannot conveniently number their ports.  </p>
<h1 id="rfc.section.4.2.4">
<a href="#rfc.section.4.2.4">4.2.4.</a> NAS-Port-Type AVP</h1>
<p id="rfc.section.4.2.4.p.1">The NAS-Port-Type AVP (AVP Code 61) is of type Enumerated and contains the type of the port on which the NAS is authenticating the user.  This AVP SHOULD be present if the NAS uses the same NAS-Port number ranges for different service types concurrently.  <br><br> The currently supported values of the NAS-Port-Type AVP are listed in <a href="#RADIUSTypes">[RADIUSTypes]</a>.  </p>
<h1 id="rfc.section.4.2.5">
<a href="#rfc.section.4.2.5">4.2.5.</a> Called-Station-Id AVP</h1>
<p id="rfc.section.4.2.5.p.1">The Called-Station-Id AVP (AVP Code 30) is of type UTF8String and allows the NAS to send the ASCII string describing the Layer 2 address the user contacted in the request.  For dialup access, this can be a phone number obtained by using the Dialed Number Identification Service (DNIS) or a similar technology.  Note that this may be different from the phone number the call comes in on.  For use with IEEE 802 access, the Called-Station-Id MAY contain a MAC address formatted as described in <a href="#RFC3580">[RFC3580]</a>.  It SHOULD only be present in authentication and/or authorization requests.  <br><br> If the Called-Station-Id AVP is present in an AAR message, Auth-Request-Type AVP is set to AUTHORIZE_ONLY and the User-Name AVP is absent, the Diameter Server MAY perform authorization based on this AVP.  This can be used by a NAS to request whether a call should be answered based on the DNIS result.  <br><br> The codification of this field's allowed usage range is outside the scope of this specification.  </p>
<h1 id="rfc.section.4.2.6">
<a href="#rfc.section.4.2.6">4.2.6.</a> Calling-Station-Id AVP</h1>
<p id="rfc.section.4.2.6.p.1">The Calling-Station-Id AVP (AVP Code 31) is of type UTF8String and allows the NAS to send the ASCII string describing the Layer 2 address from which the user connected in the request.  For dialup access, this is the phone number the call came from, using Automatic Number Identification (ANI) or a similar technology.  For use with IEEE 802 access, the Calling-Station-Id AVP MAY contain a MAC address, formated as described in <a href="#RFC3580">[RFC3580]</a>.  It SHOULD only be present in authentication and/or authorization requests.  <br><br> If the Calling-Station-Id AVP is present in an AAR message, the Auth-Request-Type AVP is set to AUTHORIZE_ONLY and the User-Name AVP is absent, the Diameter Server MAY perform authorization based on the value of this AVP.  This can be used by a NAS to request whether a call should be answered based on the Layer 2 address (ANI, MAC Address, etc.) <br><br> The codification of this field's allowed usage range is outside the scope of this specification.  </p>
<h1 id="rfc.section.4.2.7">
<a href="#rfc.section.4.2.7">4.2.7.</a> Connect-Info AVP</h1>
<p id="rfc.section.4.2.7.p.1">The Connect-Info AVP (AVP Code 77) is of type UTF8String and is sent in the AA-Request message or an ACR message with the value of the Accounting-Record-Type AVP set to STOP.  When sent in the AA-Request, it indicates the nature of the user's connection.  The connection speed SHOULD be included at the beginning of the first Connect-Info AVP in the message.  If the transmit and receive connection speeds differ, both may be included in the first AVP with the transmit speed listed first (the speed at which the NAS modem transmits), then a slash (/), then the receive speed, and then other optional information.  <br><br> For example: "28800 V42BIS/LAPM" or "52000/31200 V90" <br><br> If sent in an ACR message with the value of the Accounting-Record-Type AVP set to STOP, this attribute may summarize statistics relating to session quality.  For example, in IEEE 802.11, the Connect-Info AVP may contain information on the number of link layer retransmissions.  The exact format of this attribute is implementation specific.  </p>
<h1 id="rfc.section.4.2.8">
<a href="#rfc.section.4.2.8">4.2.8.</a> Originating-Line-Info AVP</h1>
<p id="rfc.section.4.2.8.p.1">The Originating-Line-Info AVP (AVP Code 94) is of type OctetString and is sent by the NAS system to convey information about the origin of the call from an SS7 system.  <br><br> The Originating Line Information (OLI) element indicates the nature and/or characteristics of the line from which a call originated (e.g., pay phone, hotel, cellular).  Telephone companies are starting to offer OLI to their customers as an option over Primary Rate Interface (PRI).  Internet Service Providers (ISPs) can use OLI in addition to Called-Station-Id and Calling-Station-Id attributes to differentiate customer calls and to define different services.  <br><br> The Value field contains two octets (00 - 99).  ANSI T1.113 and BELLCORE 394 can be used for additional information about these values and their use.  For information on the currently assigned values, see <a href="#ANITypes">[ANITypes]</a>.  </p>
<h1 id="rfc.section.4.2.9">
<a href="#rfc.section.4.2.9">4.2.9.</a> Reply-Message AVP</h1>
<p id="rfc.section.4.2.9.p.1">The Reply-Message AVP (AVP Code 18) is of type UTF8String and contains text that MAY be displayed to the user.  When used in an AA-Answer message with a successful Result-Code AVP, it indicates success.  When found in an AAA message with a Result-Code other than DIAMETER_SUCCESS, the AVP contains a failure message.  <br><br> The Reply-Message AVP MAY contain text to prompt the user before another AA-Request attempt.  When used in an AA-Answer message containing a Result-Code AVP with the value DIAMETER_MULTI_ROUND_AUTH or in an Re-Auth-Request message, it MAY contain text to prompt the user for a response.  </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> NAS Authentication AVPs</h1>
<div id="#rfc.figure.12"></div>
<pre>
                                         +----------+
                                         | AVP Flag |
                                         |  rules   |
                                         |----+-----|
                                         |MUST| MUST|
Attribute Name           Section Defined |    |  NOT|
-----------------------------------------|----+-----|
User-Password                 4.3.1      | M  |  V  |
Password-Retry                4.3.2      | M  |  V  |
Prompt                        4.3.3      | M  |  V  |
CHAP-Auth                     4.3.4      | M  |  V  |
CHAP-Algorithm                4.3.5      | M  |  V  |
CHAP-Ident                    4.3.6      | M  |  V  |
CHAP-Response                 4.3.7      | M  |  V  |
CHAP-Challenge                4.3.8      | M  |  V  |
ARAP-Password                 4.3.9      | M  |  V  |
ARAP-Challenge-Response       4.3.10     | M  |  V  |
ARAP-Security                 4.3.11     | M  |  V  |
ARAP-Security-Data            4.3.12     | M  |  V  |
-----------------------------------------|----+-----|				
</pre>
<p id="rfc.section.4.3.p.1">This section defines the AVPs necessary to carry the authentication information in the Diameter protocol.  The functionality defined here provides a RADIUS-like AAA service <a href="#RFC2865">[RFC2865]</a> over a more reliable and secure transport, as defined in the base protocol <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>.  <br><br> The following table gives the possible flag values for the session level AVPs and specifies whether the AVP MAY be encrypted.  </p>
<h1 id="rfc.section.4.3.1">
<a href="#rfc.section.4.3.1">4.3.1.</a> User-Password AVP</h1>
<p id="rfc.section.4.3.1.p.1">The User-Password AVP (AVP Code 2) is of type OctetString and contains the password of the user to be authenticated, or the user's input in a multi-round authentication exchange.  <br><br> The User-Password AVP contains a user password or one-time password and therefore represents sensitive information.  As required in <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>, Diameter messages are encrypted by using IPsec <a href="#RFC4301">[RFC4301]</a> or TLS <a href="#RFC5246">[RFC5246]</a>.  Unless this AVP is used for one-time passwords, the User-Password AVP SHOULD NOT be used in untrusted proxy environments without encrypting it by using end-to-end security techniques.  <br><br> The clear-text password (prior to encryption) MUST NOT be longer than 128 bytes in length.  </p>
<h1 id="rfc.section.4.3.2">
<a href="#rfc.section.4.3.2">4.3.2.</a> Password-Retry AVP</h1>
<p id="rfc.section.4.3.2.p.1">The Password-Retry AVP (AVP Code 75) is of type Unsigned32 and MAY be included in the AA-Answer if the Result-Code indicates an authentication failure.  The value of this AVP indicates how many authentication attempts a user is permitted before being disconnected.  This AVP is primarily intended for use when the Framed-Protocol AVP (<a href="#F-P-AVP">Section 4.4.10.1</a>) is set to ARAP.  </p>
<h1 id="rfc.section.4.3.3">
<a href="#rfc.section.4.3.3">4.3.3.</a> Prompt AVP</h1>
<p id="rfc.section.4.3.3.p.1">The Prompt AVP (AVP Code 76) is of type Enumerated and MAY be present in the AA-Answer message.  When present, it is used by the NAS to determine whether the user's response, when entered, should be echoed.  <br><br> The supported values are listed in <a href="#RADIUSTypes">[RADIUSTypes]</a> </p>
<h1 id="rfc.section.4.3.4">
<a href="#rfc.section.4.3.4">4.3.4.</a> <a href="#C-AUTH-AVP" id="C-AUTH-AVP">CHAP-Auth AVP</a>
</h1>
<div id="#rfc.figure.13"></div>
<pre>
CHAP-Auth  ::= &lt; AVP Header: 402 &gt;
               { CHAP-Algorithm }
               { CHAP-Ident }
               [ CHAP-Response ]
             * [ AVP ]
</pre>
<p id="rfc.section.4.3.4.p.1">The CHAP-Auth AVP (AVP Code 402) is of type Grouped and contains the information necessary to authenticate a user using the PPP Challenge-Handshake Authentication Protocol (CHAP) <a href="#RFC1994">[RFC1994]</a>.  If the CHAP-Auth AVP is found in a message, the CHAP-Challenge AVP <a href="#C-C-AVP">Section 4.3.8</a> MUST be present as well.  The optional AVPs containing the CHAP response depend upon the value of the CHAP-Algorithm AVP <a href="#C-C-AVP">Section 4.3.8</a>.  The grouped AVP has the following ABNF grammar: </p>
<h1 id="rfc.section.4.3.5">
<a href="#rfc.section.4.3.5">4.3.5.</a> <a href="#C-A-AVP" id="C-A-AVP">CHAP-Algorithm AVP</a>
</h1>
<p id="rfc.section.4.3.5.p.1">The CHAP-Algorithm AVP (AVP Code 403) is of type Enumerated and contains the algorithm identifier used in the computation of the CHAP response <a href="#RFC1994">[RFC1994]</a>.  The following values are currently supported: </p>

<dl>
<dt>CHAP with MD5       5</dt>
<dd style="margin-left: 8">The CHAP response is computed by using the procedure described in <a href="#RFC1994">[RFC1994]</a> This algorithm requires that the CHAP-Response AVP <a href="#C-R-AVP">Section 4.3.7</a> MUST be present in the CHAP-Auth AVP <a href="#C-AUTH-AVP">Section 4.3.4</a>.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.3.6">
<a href="#rfc.section.4.3.6">4.3.6.</a> CHAP-Ident AVP</h1>
<p id="rfc.section.4.3.6.p.1">The CHAP-Ident AVP (AVP Code 404) is of type OctetString and contains the 1 octet CHAP Identifier used in the computation of the CHAP response <a href="#RFC1994">[RFC1994]</a> </p>
<h1 id="rfc.section.4.3.7">
<a href="#rfc.section.4.3.7">4.3.7.</a> <a href="#C-R-AVP" id="C-R-AVP">CHAP-Response AVP</a>
</h1>
<p id="rfc.section.4.3.7.p.1">The CHAP-Response AVP (AVP Code 405) is of type OctetString and contains the 16 octet authentication data provided by the user in response to the CHAP challenge <a href="#RFC1994">[RFC1994]</a>.  </p>
<h1 id="rfc.section.4.3.8">
<a href="#rfc.section.4.3.8">4.3.8.</a> <a href="#C-C-AVP" id="C-C-AVP">CHAP-Challenge AVP</a>
</h1>
<p id="rfc.section.4.3.8.p.1">The CHAP-Challenge AVP (AVP Code 60) is of type OctetString and contains the CHAP Challenge sent by the NAS to the CHAP peer <a href="#RFC1994">[RFC1994]</a>.  </p>
<h1 id="rfc.section.4.3.9">
<a href="#rfc.section.4.3.9">4.3.9.</a> ARAP-Password AVP</h1>
<p id="rfc.section.4.3.9.p.1">The ARAP-Password AVP (AVP Code 70) is of type OctetString and is only present when the Framed-Protocol AVP (<a href="#F-P-AVP">Section 4.4.10.1</a>) is included in the message and is set to ARAP.  This AVP MUST NOT be present if either the User-Password or the CHAP-Auth AVP is present.  See <a href="#RFC2869">[RFC2869]</a> for more information on the contents of this AVP.  </p>
<h1 id="rfc.section.4.3.10">
<a href="#rfc.section.4.3.10">4.3.10.</a> ARAP-Challenge-Response AVP</h1>
<p id="rfc.section.4.3.10.p.1">The ARAP-Challenge-Response AVP (AVP Code 84) is of type OctetString and is only present when the Framed-Protocol AVP (<a href="#F-P-AVP">Section 4.4.10.1</a>) is included in the message and is set to ARAP.  This AVP contains an 8 octet response to the dial-in client's challenge.  The Diameter server calculates this value by taking the dial-in client's challenge from the high-order 8 octets of the ARAP-Password AVP and performing DES encryption on this value with the authenticating user's password as the key.  If the user's password is fewer than 8 octets in length, the password is padded at the end with NULL octets to a length of 8 before it is used as a key.  </p>
<h1 id="rfc.section.4.3.11">
<a href="#rfc.section.4.3.11">4.3.11.</a> <a href="#A-S-AVP" id="A-S-AVP">ARAP-Security AVP</a>
</h1>
<p id="rfc.section.4.3.11.p.1">The ARAP-Security AVP (AVP Code 73) is of type Unsigned32 and MAY be present in the AA-Answer message if the Framed-Protocol AVP (<a href="#F-P-AVP">Section 4.4.10.1</a>) is set to the value of ARAP, and the Result-Code AVP (<a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>, Section 7.1) is set to DIAMETER_MULTI_ROUND_AUTH.  See <a href="#RFC2869">[RFC2869]</a> for more information on the contents of this AVP.  </p>
<h1 id="rfc.section.4.3.12">
<a href="#rfc.section.4.3.12">4.3.12.</a> ARAP-Security-Data AVP</h1>
<p id="rfc.section.4.3.12.p.1">The ARAP-Security-Data AVP (AVP Code 74) is of type OctetString and MAY be present in the AA-Request or AA-Answer message if the Framed-Protocol AVP (<a href="#F-P-AVP">Section 4.4.10.1</a>) is set to the value of ARAP and the Result-Code AVP (<a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>, Section 7.1) is set to DIAMETER_MULTI_ROUND_AUTH.  This AVP contains the security module challenge or response associated with the ARAP Security Module specified in the ARAP-Security AVP (<a href="#A-S-AVP">Section 4.3.11</a>).  </p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> <a href="#AUTHZ-AVP" id="AUTHZ-AVP">NAS Authorization AVPs</a>
</h1>
<div id="#rfc.figure.14"></div>
<pre>
                                         +----------+
                                         | AVP Flag |
                                         |  rules   |
                                         |----+-----|
                                         |MUST| MUST|
Attribute Name           Section Defined |    |  NOT|
-----------------------------------------|----+-----|
Service-Type                4.4.1        | M  |  V  |
Callback-Number             4.4.2        | M  |  V  |
Callback-Id                 4.4.3        | M  |  V  |
Idle-Timeout                4.4.4        | M  |  V  |
Port-Limit                  4.4.5        | M  |  V  |
NAS-Filter-Rule             4.4.6        | M  |  V  |
Filter-Id                   4.4.7        | M  |  V  |
Configuration-Token         4.4.8        | M  | P,V |
QoS-Filter-Rule             4.4.9        |    |     |
Framed-Protocol             4.4.10.1     | M  |  V  |
Framed-Routing              4.4.10.2     | M  |  V  |
Framed-MTU                  4.4.10.3     | M  |  V  |
Framed-Compression          4.4.10.4     | M  |  V  |
Framed-IP-Address           4.4.10.5.1   | M  |  V  |
Framed-IP-Netmask           4.4.10.5.2   | M  |  V  |
Framed-Route                4.4.10.5.3   | M  |  V  |
Framed-Pool                 4.4.10.5.4   | M  |  V  |
Framed-Interface-Id         4.4.10.5.5   | M  |  V  |
Framed-IPv6-Prefix          4.4.10.5.6   | M  |  V  |
Framed-IPv6-Route           4.4.10.5.7   | M  |  V  |
Framed-IPv6-Pool            4.4.10.5.8   | M  |  V  |
Framed-IPX-Network          4.4.10.6.1   | M  |  V  |
Framed-Appletalk-Link       4.4.10.7.1   | M  |  V  |
Framed-Appletalk-Network    4.4.10.7.2   | M  |  V  |
Framed-Appletalk-Zone       4.4.10.7.3   | M  |  V  |
ARAP-Features               4.4.10.8.1   | M  |  V  |
ARAP-Zone-Access            4.4.10.8.2   | M  |  V  |
Login-IP-Host               4.4.11.1     | M  |  V  |
Login-IPv6-Host             4.4.11.2     | M  |  V  |
Login-Service               4.4.11.3     | M  |  V  |
Login-TCP-Port              4.4.11.4.1   | M  |  V  |
Login-LAT-Service           4.4.11.5.1   | M  |  V  |
Login-LAT-Node              4.4.11.5.2   | M  |  V  |
Login-LAT-Group             4.4.11.5.3   | M  |  V  |
Login-LAT-Port              4.4.11.5.4   | M  |  V  |
-----------------------------------------|----+-----|
</pre>
<p id="rfc.section.4.4.p.1">This section contains the authorization AVPs supported in the NAS Application.  The Service-Type AVP SHOULD be present in all messages and, based on its value, additional AVPs defined in this section and <a href="#TUNNELING-AVPS">Section 4.5</a> MAY be present.  <br><br> The following table gives the possible flag values for the session level AVPs and specifies whether the AVP MAY be encrypted.  </p>
<h1 id="rfc.section.4.4.1">
<a href="#rfc.section.4.4.1">4.4.1.</a> <a href="#S-T-AVP" id="S-T-AVP">Service-Type AVP</a>
</h1>
<p id="rfc.section.4.4.1.p.1">The Service-Type AVP (AVP Code 6) is of type Enumerated and contains the type of service the user has requested or the type of service to be provided.  One such AVP MAY be present in an authentication and/or authorization request or response.  A NAS is not required to implement all of these service types.  It MUST treat unknown or unsupported Service-Types received in a response as a failure and end the session with a DIAMETER_INVALID_AVP_VALUE Result-Code.  <br><br> When used in a request, the Service-Type AVP SHOULD be considered a hint to the server that the NAS believes the user would prefer the kind of service indicated.  The server is not required to honor the hint.  Furthermore, if the service specified by the server is supported, but not compatible with the current mode of access, the NAS MUST fail to start the session.  The NAS MUST also generate the appropriate error message(s).  <br><br> The complete list of defined values that the Service-Type AVP can take can be found in <a href="#RFC2865">[RFC2865]</a> and <a href="#RADIUSTypes">[RADIUSTypes]</a>, but the following values require further qualification here: <br><br> </p>

<ul class="empty"><li>
<dl>
<dt>Login (1)</dt>
<dd style="margin-left: 8">
<br> The user should be connected to a host.  The message MAY include additional AVPs as defined in <a href="#TCP-S">Section 4.4.11.4</a> or <a href="#LAT-S">Section 4.4.11.5</a>.  <br><br> </dd>
<dt>Framed (2)</dt>
<dd style="margin-left: 8">
<br> A Framed Protocol, such as PPP or SLIP, should be started for the User.  The message MAY include additional AVPs defined in <a href="#F-A-A-AVP">Section 4.4.10</a>, or <a href="#TUNNELING-AVPS">Section 4.5</a> for tunneling services.  <br><br> </dd>
<dt>Callback Login (3)</dt>
<dd style="margin-left: 8">
<br> The user should be disconnected and called back, then connected to a host.  The message MAY include additional AVPs defined in this Section.  <br><br> </dd>
<dt>Callback Framed (4)</dt>
<dd style="margin-left: 8">
<br> The user should be disconnected and called back, and then a Framed Protocol, such as PPP or SLIP, should be started for the User.  The message MAY include additional AVPs defined in <a href="#F-A-A-AVP">Section 4.4.10</a>, or <a href="#TUNNELING-AVPS">Section 4.5</a> for tunneling services.  </dd>
</dl>
<p> </p>
</li></ul>

<p> </p>
<h1 id="rfc.section.4.4.2">
<a href="#rfc.section.4.4.2">4.4.2.</a> <a href="#C-N-AVP" id="C-N-AVP">Callback-Number AVP</a>
</h1>
<p id="rfc.section.4.4.2.p.1">The Callback-Number AVP (AVP Code 19) is of type UTF8String and contains a dialing string to be used for callback.  It MAY be used in an authentication and/or authorization request as a hint to the server that a Callback service is desired, but the server is not required to honor the hint in the corresponding response.  <br><br> The codification of this field's allowed usage range is outside the scope of this specification.  </p>
<h1 id="rfc.section.4.4.3">
<a href="#rfc.section.4.4.3">4.4.3.</a> Callback-Id AVP</h1>
<p id="rfc.section.4.4.3.p.1">The Callback-Id AVP (AVP Code 20) is of type UTF8String and contains the name of a place to be called, to be interpreted by the NAS.  This AVP MAY be present in an authentication and/or authorization response.  <br><br> This AVP is not roaming-friendly as it assumes that the Callback-Id is configured on the NAS.  Using the Callback-Number AVP <a href="#C-N-AVP">Section 4.4.2</a> is therefore preferable.  </p>
<h1 id="rfc.section.4.4.4">
<a href="#rfc.section.4.4.4">4.4.4.</a> Idle-Timeout AVP</h1>
<p id="rfc.section.4.4.4.p.1">The Idle-Timeout AVP (AVP Code 28) is of type Unsigned32 and sets the maximum number of consecutive seconds of idle connection allowable to the user before termination of the session or before a prompt is issued.  The default is none, or system specific.  </p>
<h1 id="rfc.section.4.4.5">
<a href="#rfc.section.4.4.5">4.4.5.</a> Port-Limit AVP</h1>
<p id="rfc.section.4.4.5.p.1">The Port-Limit AVP (AVP Code 62) is of type Unsigned32 and sets the maximum number of ports the NAS provides to the user.  It MAY be used in an authentication and/or authorization request as a hint to the server that multilink PPP <a href="#RFC1990">[RFC1990]</a> service is desired, but the server is not required to honor the hint in the corresponding response.  </p>
<h1 id="rfc.section.4.4.6">
<a href="#rfc.section.4.4.6">4.4.6.</a> <a href="#N-F-R-AVP" id="N-F-R-AVP">NAS-Filter-Rule AVP</a>
</h1>
<p id="rfc.section.4.4.6.p.1">The NAS-Filter-Rule AVP (AVP Code 400) is of type IPFilterRule and provides filter rules that need to be configured on the NAS for the user.  One or more of these AVPs MAY be present in an authorization response.  </p>
<h1 id="rfc.section.4.4.7">
<a href="#rfc.section.4.4.7">4.4.7.</a> Filter-Id AVP</h1>
<p id="rfc.section.4.4.7.p.1">The Filter-Id AVP (AVP Code 11) is of type UTF8String and contains the name of the filter list for this user.  Zero or more Filter-Id AVPs MAY be sent in an authorization answer.  <br><br> Identifying a filter list by name allows the filter to be used on different NASes without regard to filter-list implementation details.  However, this AVP is not roaming-friendly, as filter naming differs from one service provider to another.  <br><br> In environments where backward compatibility with RADIUS is not required, it is RECOMMENDED that the NAS-Filter-Rule AVP <a href="#N-F-R-AVP">Section 4.4.6</a> be used instead.  </p>
<h1 id="rfc.section.4.4.8">
<a href="#rfc.section.4.4.8">4.4.8.</a> Configuration-Token AVP</h1>
<p id="rfc.section.4.4.8.p.1">The Configuration-Token AVP (AVP Code 78) is of type OctetString and is sent by a Diameter Server to a Diameter Proxy Agent in an AA-Answer command to indicate a type of user profile to be used.  It should not be sent to a Diameter Client (NAS).  <br><br> The format of the Data field of this AVP is site specific.  </p>
<h1 id="rfc.section.4.4.9">
<a href="#rfc.section.4.4.9">4.4.9.</a> <a href="#Q-F-R-AVP" id="Q-F-R-AVP">QoS-Filter-Rule AVP</a>
</h1>
<p id="rfc.section.4.4.9.p.1">The QoS-Filter-Rule AVP (AVP Code 407) is of type QoSFilterRule <a href="#QFR-Format">Section 4.1.1</a> and provides QoS filter rules that need to be configured on the NAS for the user.  One or more such AVPs MAY be present in an authorization response.  <br><br> </p>

<dl>
<dt>DSCP &lt;color&gt;</dt>
<dd style="margin-left: 6">If action is set to tag <a href="#QFR-Format">Section 4.1.1</a> this option MUST be included in the rule.  <br><br> Color values are defined in <a href="#RFC2474">[RFC2474]</a>.  Exact matching of DSCP values is required (no masks or ranges).  </dd>
<dt>metering &lt;rate&gt; &lt;color_under&gt; &lt;color_over&gt;</dt>
<dd style="margin-left: 6">The metering option provides Assured Forwarding, as defined in <a href="#RFC2597">[RFC2597]</a>.  and MUST be present if the action is set to meter <a href="#QFR-Format">Section 4.1.1</a> The rate option is the throughput, in bits per second, used by the access device to mark packets.  Traffic over the rate is marked with the color_over codepoint, and traffic under the rate is marked with the color_under codepoint.  The color_under and color_over options contain the drop preferences and MUST conform to the recommended codepoint keywords described in <a href="#RFC2597">[RFC2597]</a> (e.g., AF13).  <br><br> The metering option also supports the strict limit on traffic required by Expedited Forwarding, as defined in <a href="#RFC3246">[RFC3246]</a>.  The color_over option may contain the keyword "drop" to prevent forwarding of traffic that exceeds the rate parameter.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4.4.10">
<a href="#rfc.section.4.4.10">4.4.10.</a> <a href="#F-A-A-AVP" id="F-A-A-AVP">Framed Access Authorization AVPs</a>
</h1>
<p id="rfc.section.4.4.10.p.1">This section lists the authorization AVPs necessary to support framed access, such as PPP and SLIP.  AVPs defined in this section MAY be present in a message if the Service-Type AVP was set to "Framed" or "Callback Framed".  </p>
<h1 id="rfc.section.4.4.10.1">
<a href="#rfc.section.4.4.10.1">4.4.10.1.</a> <a href="#F-P-AVP" id="F-P-AVP">Framed-Protocol AVP</a>
</h1>
<p id="rfc.section.4.4.10.1.p.1">The Framed-Protocol AVP (AVP Code 7) is of type Enumerated and contains the framing to be used for framed access.  This AVP MAY be present in both requests and responses.  The supported values are listed in <a href="#RADIUSTypes">[RADIUSTypes]</a>.  </p>
<h1 id="rfc.section.4.4.10.2">
<a href="#rfc.section.4.4.10.2">4.4.10.2.</a> Framed-Routing AVP</h1>
<p id="rfc.section.4.4.10.2.p.1">The Framed-Routing AVP (AVP Code 10) is of type Enumerated and contains the routing method for the user when the user is a router to a network.  This AVP SHOULD only be present in authorization responses.  The supported values are listed in  <a href="#RADIUSTypes">[RADIUSTypes]</a>.  </p>
<h1 id="rfc.section.4.4.10.3">
<a href="#rfc.section.4.4.10.3">4.4.10.3.</a> Framed-MTU AVP</h1>
<p id="rfc.section.4.4.10.3.p.1">The Framed-MTU AVP (AVP Code 12) is of type Unsigned32 and contains the Maximum Transmission Unit (MTU) to be configured for the user, when it is not negotiated by some other means (such as PPP).  This AVP SHOULD only be present in authorization responses.  The MTU value MUST be in the range from 64 to 65535.  </p>
<h1 id="rfc.section.4.4.10.4">
<a href="#rfc.section.4.4.10.4">4.4.10.4.</a> Framed-Compression AVP</h1>
<p id="rfc.section.4.4.10.4.p.1">The Framed-Compression AVP (AVP Code 13) is of type Enumerated and contains the compression protocol to be used for the link.  It MAY be used in an authorization request as a hint to the server that a specific compression type is desired, but the server is not required to honor the hint in the corresponding response.  <br><br> More than one compression protocol AVP MAY be sent.  The NAS is responsible for applying the proper compression protocol to the appropriate link traffic.  <br><br> The supported values are listed in <a href="#RADIUSTypes">[RADIUSTypes]</a>.  </p>
<h1 id="rfc.section.4.4.10.5">
<a href="#rfc.section.4.4.10.5">4.4.10.5.</a> IP Access Authorization AVPs</h1>
<p id="rfc.section.4.4.10.5.p.1">The AVPs defined in this section are used when the user requests, or is being granted, access service to IP.  </p>
<h1 id="rfc.section.4.4.10.5.1">
<a href="#rfc.section.4.4.10.5.1">4.4.10.5.1.</a> Framed-IP-Address AVP</h1>
<p id="rfc.section.4.4.10.5.1.p.1">The Framed-IP-Address AVP (AVP Code 8) <a href="#RFC2865">[RFC2865]</a> is of type OctetString and contains an IPv4 address of the type specified in the attribute value to be configured for the user.  It MAY be used in an authorization request as a hint to the server that a specific address is desired, but the server is not required to honor the hint in the corresponding response.  <br><br> Two values have special significance: 0xFFFFFFFF and 0xFFFFFFFE.  The value 0xFFFFFFFF indicates that the NAS should allow the user to select an address (i.e., negotiated).  The value 0xFFFFFFFE indicates that the NAS should select an address for the user (e.g., assigned from a pool of addresses kept by the NAS).  </p>
<h1 id="rfc.section.4.4.10.5.2">
<a href="#rfc.section.4.4.10.5.2">4.4.10.5.2.</a> Framed-IP-Netmask AVP</h1>
<p id="rfc.section.4.4.10.5.2.p.1">The Framed-IP-Netmask AVP (AVP Code 9) is of type OctetString and contains the four octets of the IPv4 netmask to be configured for the user when the user is a router to a network.  It MAY be used in an authorization request as a hint to the server that a specific netmask is desired, but the server is not required to honor the hint in the corresponding response.  This AVP MUST be present in a response if the request included this AVP with a value of 0xFFFFFFFF.  </p>
<h1 id="rfc.section.4.4.10.5.3">
<a href="#rfc.section.4.4.10.5.3">4.4.10.5.3.</a> Framed-Route AVP</h1>
<p id="rfc.section.4.4.10.5.3.p.1">The Framed-Route AVP (AVP Code 22) is of type UTF8String and contains the ASCII routing information to be configured for the user on the NAS.  Zero or more of these AVPs MAY be present in an authorization response.  <br><br> The string MUST contain a destination prefix in dotted quad form optionally followed by a slash and a decimal length specifier stating how many high-order bits of the prefix should be used.  This is followed by a space, a gateway address in dotted quad form, a space, and one or more metrics separated by spaces; for example, </p>

<ul class="empty"><li>"192.0.2.0/24 192.0.2.1 1"</li></ul>

<p> The length specifier may be omitted, in which case it should default to 8 bits for class A prefixes, to 16 bits for class B prefixes, and to 24 bits for class C prefixes; for example, </p>

<ul class="empty"><li>"192.0.2.0 192.0.2.1 1"</li></ul>

<p> Whenever the gateway address is specified as "0.0.0.0" the IP address of the user SHOULD be used as the gateway address.  </p>
<h1 id="rfc.section.4.4.10.5.4">
<a href="#rfc.section.4.4.10.5.4">4.4.10.5.4.</a> Framed-Pool AVP</h1>
<p id="rfc.section.4.4.10.5.4.p.1">The Framed-Pool AVP (AVP Code 88) is of type OctetString and contains the name of an assigned address pool that SHOULD be used to assign an address for the user.  If a NAS does not support multiple address pools, the NAS SHOULD ignore this AVP.  Address pools are usually used for IP addresses but can be used for other protocols if the NAS supports pools for those protocols.  <br><br> Although specified as type OctetString for compatibility with RADIUS <a href="#RFC2865">[RFC2865]</a>, the encoding of the Data field SHOULD also conform to the rules for the UTF8String Data Format.  </p>
<h1 id="rfc.section.4.4.10.5.5">
<a href="#rfc.section.4.4.10.5.5">4.4.10.5.5.</a> Framed-Interface-Id AVP</h1>
<p id="rfc.section.4.4.10.5.5.p.1">The Framed-Interface-Id AVP (AVP Code 96) is of type Unsigned64 and contains the IPv6 interface identifier to be configured for the user.  It MAY be used in authorization requests as a hint to the server that a specific interface id is desired, but the server is not required to honor the hint in the corresponding response.  </p>
<h1 id="rfc.section.4.4.10.5.6">
<a href="#rfc.section.4.4.10.5.6">4.4.10.5.6.</a> Framed-IPv6-Prefix AVP</h1>
<p id="rfc.section.4.4.10.5.6.p.1">The Framed-IPv6-Prefix AVP (AVP Code 97) is of type OctetString and contains the IPv6 prefix to be configured for the user.  One or more AVPs MAY be used in authorization requests as a hint to the server that specific IPv6 prefixes are desired, but the server is not required to honor the hint in the corresponding response.  </p>
<h1 id="rfc.section.4.4.10.5.7">
<a href="#rfc.section.4.4.10.5.7">4.4.10.5.7.</a> Framed-IPv6-Route AVP</h1>
<p id="rfc.section.4.4.10.5.7.p.1">The Framed-IPv6-Route AVP (AVP Code 99) is of type UTF8String and contains the ASCII routing information to be configured for the user on the NAS.  Zero or more of these AVPs MAY be present in an authorization response.  <br><br> The string MUST contain an IPv6 address prefix followed by a slash and a decimal length specifier stating how many high order bits of the prefix should be used.  This is followed by a space, a gateway address in hexadecimal notation, a space, and one or more metrics separated by spaces; for example, </p>

<ul class="empty"><li>"2001:db8::/32 2001:db8:106:a00:20ff:fe99:a998 1"</li></ul>

<p> Whenever the gateway address is the IPv6 unspecified address, the IP address of the user SHOULD be used as the gateway address, such as in: </p>

<ul class="empty"><li>"2001:db8::/32 :: 1"</li></ul>

<p> </p>
<h1 id="rfc.section.4.4.10.5.8">
<a href="#rfc.section.4.4.10.5.8">4.4.10.5.8.</a> Framed-IPv6-Pool AVP</h1>
<p id="rfc.section.4.4.10.5.8.p.1">The Framed-IPv6-Pool AVP (AVP Code 100) is of type OctetString and contains the name of an assigned pool that SHOULD be used to assign an IPv6 prefix for the user.  If the access device does not support multiple prefix pools, it MUST ignore this AVP.  <br><br> Although specified as type OctetString for compatibility with RADIUS <a href="#RFC3162">[RFC3162]</a>, the encoding of the Data field SHOULD also conform to the rules for the UTF8String Data Format.  </p>
<h1 id="rfc.section.4.4.10.6">
<a href="#rfc.section.4.4.10.6">4.4.10.6.</a> IPX Access AVPs</h1>
<p id="rfc.section.4.4.10.6.p.1">The AVPs defined in this section are used when the user requests, or is being granted, access to an IPX network service <a href="#IPX">[IPX]</a>.  </p>
<h1 id="rfc.section.4.4.10.6.1">
<a href="#rfc.section.4.4.10.6.1">4.4.10.6.1.</a> Framed-IPX-Network AVP</h1>
<p id="rfc.section.4.4.10.6.1.p.1">The Framed-IPX-Network AVP (AVP Code 23) is of type Unsigned32 and contains the IPX Network number to be configured for the user.  It MAY be used in an authorization request as a hint to the server that a specific address is desired, but the server is not required to honor the hint in the corresponding response.  <br><br> Two addresses have special significance: 0xFFFFFFFF and 0xFFFFFFFE.  The value 0xFFFFFFFF indicates that the NAS should allow the user to select an address (i.e., Negotiated).  The value 0xFFFFFFFE indicates that the NAS should select an address for the user (e.g., assign it from a pool of one or more IPX networks kept by the NAS).  </p>
<h1 id="rfc.section.4.4.10.7">
<a href="#rfc.section.4.4.10.7">4.4.10.7.</a> AppleTalk Network Access AVPs</h1>
<p id="rfc.section.4.4.10.7.p.1">The AVPs defined in this section are used when the user requests, or is being granted, access to an AppleTalk network <a href="#AppleTalk">[AppleTalk]</a>.  </p>
<h1 id="rfc.section.4.4.10.7.1">
<a href="#rfc.section.4.4.10.7.1">4.4.10.7.1.</a> Framed-AppleTalk-Link AVP</h1>
<p id="rfc.section.4.4.10.7.1.p.1">The Framed-AppleTalk-Link AVP (AVP Code 37) is of type Unsigned32 and contains the AppleTalk network number that should be used for the serial link to the user, which is another AppleTalk router.  This AVP MUST only be present in an authorization response and is never used when the user is not another router.  <br><br> Despite the size of the field, values range from 0 to 65,535.  The special value of 0 indicates an unnumbered serial link.  A value of 1 to 65,535 means that the serial line between the NAS and the user should be assigned that value as an AppleTalk network number.  </p>
<h1 id="rfc.section.4.4.10.7.2">
<a href="#rfc.section.4.4.10.7.2">4.4.10.7.2.</a> Framed-AppleTalk-Network AVP</h1>
<p id="rfc.section.4.4.10.7.2.p.1">The Framed-AppleTalk-Network AVP (AVP Code 38) is of type Unsigned32 and contains the AppleTalk Network number that the NAS should probe to allocate an AppleTalk node for the user.  This AVP MUST only be present in an authorization response and is never used when the user is not another router.  Multiple instances of this AVP indicate that the NAS may probe, using any of the network numbers specified.  <br><br> Despite the size of the field, values range from 0 to 65,535.  The special value 0 indicates that the NAS should assign a network for the user, using its default cable range.  A value between 1 and 65,535 (inclusive) indicates to the AppleTalk Network that the NAS should probe to find an address for the user.  </p>
<h1 id="rfc.section.4.4.10.7.3">
<a href="#rfc.section.4.4.10.7.3">4.4.10.7.3.</a> Framed-AppleTalk-Zone AVP</h1>
<p id="rfc.section.4.4.10.7.3.p.1">The Framed-AppleTalk-Zone AVP (AVP Code 39) is of type OctetString and contains the AppleTalk Default Zone to be used for this user.  This AVP MUST only be present in an authorization response.  Multiple instances of this AVP in the same message are not allowed.  <br><br> The codification of this field's allowed range is outside the scope of this specification.  </p>
<h1 id="rfc.section.4.4.10.8">
<a href="#rfc.section.4.4.10.8">4.4.10.8.</a> AppleTalk Remote Access AVPs</h1>
<p id="rfc.section.4.4.10.8.p.1">The AVPs defined in this section are used when the user requests, or is being granted, access to the AppleTalk network via the AppleTalk Remote Access Protocol <a href="#ARAP">[ARAP]</a>.  They are only present if the Framed-Protocol AVP <a href="#F-P-AVP">Section 4.4.10.1</a> is set to ARAP.  Section 2.2 of RFC 2869 <a href="#RFC2869">[RFC2869]</a> describes the operational use of these attributes.  </p>
<h1 id="rfc.section.4.4.10.8.1">
<a href="#rfc.section.4.4.10.8.1">4.4.10.8.1.</a> ARAP-Features AVP</h1>
<p id="rfc.section.4.4.10.8.1.p.1">The ARAP-Features AVP (AVP Code 71) is of type OctetString and MAY be present in the AA-Accept message if the Framed-Protocol AVP is set to the value of ARAP.  See <a href="#RFC2869">[RFC2869]</a> for more information about the format of this AVP.  </p>
<h1 id="rfc.section.4.4.10.8.2">
<a href="#rfc.section.4.4.10.8.2">4.4.10.8.2.</a> ARAP-Zone-Access AVP</h1>
<p id="rfc.section.4.4.10.8.2.p.1">The ARAP-Zone-Access AVP (AVP Code 72) is of type Enumerated and MAY be present in the AA-Accept message if the Framed-Protocol AVP is set to the value of ARAP.  <br><br> The supported values are listed in <a href="#RADIUSTypes">[RADIUSTypes]</a> and defined in <a href="#RFC2869">[RFC2869]</a>.  </p>
<h1 id="rfc.section.4.4.11">
<a href="#rfc.section.4.4.11">4.4.11.</a> Non-Framed Access Authorization AVPs</h1>
<p id="rfc.section.4.4.11.p.1">This section contains the authorization AVPs that are needed to support terminal server functionality.  AVPs defined in this section MAY be present in a message if the Service-Type AVP was set to "Login" or "Callback Login".  </p>
<h1 id="rfc.section.4.4.11.1">
<a href="#rfc.section.4.4.11.1">4.4.11.1.</a> Login-IP-Host AVP</h1>
<p id="rfc.section.4.4.11.1.p.1">The Login-IP-Host AVP (AVP Code 14) <a href="#RFC2865">[RFC2865]</a> is of type OctetString and contains the IPv4 address of a host with which to connect the user when the Login-Service AVP is included.  It MAY be used in an AA-Request command as a hint to the Diameter Server that a specific host is desired, but the Diameter Server is not required to honor the hint in the AA-Answer.  <br><br> Two addresses have special significance: all ones and 0.  The value of all ones indicates that the NAS SHOULD allow the user to select an address.  The value 0 indicates that the NAS SHOULD select a host to connect the user to.  </p>
<h1 id="rfc.section.4.4.11.2">
<a href="#rfc.section.4.4.11.2">4.4.11.2.</a> Login-IPv6-Host AVP</h1>
<p id="rfc.section.4.4.11.2.p.1">The Login-IPv6-Host AVP (AVP Code 98) <a href="#RFC3162">[RFC3162]</a> is of type OctetString and contains the IPv6 address of a host with which to connect the user when the Login-Service AVP is included.  It MAY be used in an AA-Request command as a hint to the Diameter Server that a specific host is desired, but the Diameter Server is not required to honor the hint in the AA-Answer.  <br><br> Two addresses have special significance, 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF and 0.  The value 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF indicates that the NAS SHOULD allow the user to select an address.  The value 0 indicates that the NAS SHOULD select a host to connect the user to.  </p>
<h1 id="rfc.section.4.4.11.3">
<a href="#rfc.section.4.4.11.3">4.4.11.3.</a> Login-Service AVP</h1>
<p id="rfc.section.4.4.11.3.p.1">The Login-Service AVP (AVP Code 15) is of type Enumerated and contains the service that should be used to connect the user to the login host.  This AVP SHOULD only be present in authorization responses.  The supported values are listed in <a href="#RFC2869">[RFC2869]</a>.  </p>
<h1 id="rfc.section.4.4.11.4">
<a href="#rfc.section.4.4.11.4">4.4.11.4.</a> <a href="#TCP-S" id="TCP-S">TCP Services</a>
</h1>
<p id="rfc.section.4.4.11.4.p.1">The AVP described in the following section MAY be present if the Login-Service AVP is set to Telnet, Rlogin, TCP Clear, or TCP Clear Quiet.  </p>
<h1 id="rfc.section.4.4.11.4.1">
<a href="#rfc.section.4.4.11.4.1">4.4.11.4.1.</a> Login-TCP-Port AVP</h1>
<p id="rfc.section.4.4.11.4.1.p.1">The Login-TCP-Port AVP (AVP Code 16) is of type Unsigned32 and contains the TCP port with which the user is to be connected when the Login-Service AVP is also present.  This AVP SHOULD only be present in authorization responses.  The value MUST NOT be greater than 65,535.  </p>
<h1 id="rfc.section.4.4.11.5">
<a href="#rfc.section.4.4.11.5">4.4.11.5.</a> <a href="#LAT-S" id="LAT-S">LAT Services</a>
</h1>
<p id="rfc.section.4.4.11.5.p.1">The AVPs described in this section MAY be present if the Login-Service AVP is set to LAT <a href="#LAT">[LAT]</a>.  </p>
<h1 id="rfc.section.4.4.11.5.1">
<a href="#rfc.section.4.4.11.5.1">4.4.11.5.1.</a> Login-LAT-Service AVP</h1>
<p id="rfc.section.4.4.11.5.1.p.1">The Login-LAT-Service AVP (AVP Code 34) is of type OctetString and contains the system with which the user is to be connected by LAT.  It MAY be used in an authorization request as a hint to the server that a specific service is desired, but the server is not required to honor the hint in the corresponding response.  This AVP MUST only be present in the response if the Login-Service AVP states that LAT is desired.  <br><br> Administrators use this service attribute when dealing with clustered systems.  In these environments, several different time-sharing hosts share the same resources (disks, printers, etc.), and administrators often configure each host to offer access (service) to each of the shared resources.  In this case, each host in the cluster advertises its services through LAT broadcasts.  <br><br> Sophisticated users often know which service providers (machines) are faster and tend to use a node name when initiating a LAT connection.  Some administrators want particular users to use certain machines as a primitive form of load balancing (although LAT knows how to do load balancing itself).  <br><br> The String field contains the identity of the LAT service to use.  The LAT Architecture allows this string to contain $ (dollar), - (hyphen), . (period), _ (underscore), numerics, upper- and lowercase alphabetics, and the ISO Latin-1 character set extension <a href="#ISO.8859-1.1987">[ISO.8859-1.1987]</a>.  All LAT string comparisons are case insensitive.  </p>
<h1 id="rfc.section.4.4.11.5.2">
<a href="#rfc.section.4.4.11.5.2">4.4.11.5.2.</a> Login-LAT-Node AVP</h1>
<p id="rfc.section.4.4.11.5.2.p.1">The Login-LAT-Node AVP (AVP Code 35) is of type OctetString and contains the Node with which the user is to be automatically connected by LAT.  It MAY be used in an authorization request as a hint to the server that a specific LAT node is desired, but the server is not required to honor the hint in the corresponding response.  This AVP MUST only be present in a response if the Login-Service-Type AVP is set to LAT.  <br><br> The String field contains the identity of the LAT service to use.  The LAT Architecture allows this string to contain $ (dollar), - (hyphen), . (period), _ (underscore), numerics, upper- and lowercase alphabetics, and the ISO Latin-1 character set extension <a href="#ISO.8859-1.1987">[ISO.8859-1.1987]</a>.  All LAT string comparisons are case insensitive.  </p>
<h1 id="rfc.section.4.4.11.5.3">
<a href="#rfc.section.4.4.11.5.3">4.4.11.5.3.</a> Login-LAT-Group AVP</h1>
<p id="rfc.section.4.4.11.5.3.p.1">The Login-LAT-Group AVP (AVP Code 36) is of type OctetString and contains a string identifying the LAT group codes this user is authorized to use.  It MAY be used in an authorization request as a hint to the server that a specific group is desired, but the server is not required to honor the hint in the corresponding response.  This AVP MUST only be present in a response if the Login-Service-Type AVP is set to LAT.  <br><br> LAT supports 256 different group codes, which LAT uses as a form of access rights.  LAT encodes the group codes as a 256-bit bitmap.  <br><br> Administrators can assign one or more of the group code bits at the LAT service provider; it will only accept LAT connections that have these group codes set in the bitmap.  The administrators assign a bitmap of authorized group codes to each user.  LAT gets these from the operating system and uses them in its requests to the service providers.  <br><br> The codification of the range of allowed usage of this field is outside the scope of this specification.  </p>
<h1 id="rfc.section.4.4.11.5.4">
<a href="#rfc.section.4.4.11.5.4">4.4.11.5.4.</a> Login-LAT-Port AVP</h1>
<p id="rfc.section.4.4.11.5.4.p.1">The Login-LAT-Port AVP (AVP Code 63) is of type OctetString and contains the Port with which the user is to be connected by LAT.  It MAY be used in an authorization request as a hint to the server that a specific port is desired, but the server is not required to honor the hint in the corresponding response.  This AVP MUST only be present in a response if the Login-Service-Type AVP is set to LAT.  <br><br> The String field contains the identity of the LAT service to use.  The LAT Architecture allows this string to contain $ (dollar), - (hyphen), . (period), _ (underscore), numerics, upper- and lower-case alphabetics, and the ISO Latin-1 character set extension <a href="#ISO.8859-1.1987">[ISO.8859-1.1987]</a>.  <br><br> All LAT string comparisons are case insensitive.  </p>
<h1 id="rfc.section.4.5">
<a href="#rfc.section.4.5">4.5.</a> <a href="#TUNNELING-AVPS" id="TUNNELING-AVPS">NAS Tunneling AVPs</a>
</h1>
<div id="#rfc.figure.15"></div>
<pre>
                                         +----------+
                                         | AVP Flag |
                                         |  rules   |
                                         |----+-----|
                                         |MUST| MUST|
Attribute Name          Section Defined  |    | NOT |
-----------------------------------------|----+-----|
Tunneling                   4.5.1        | M  |  V  |
Tunnel-Type                 4.5.2        | M  |  V  |
Tunnel-Medium-Type          4.5.3        | M  |  V  |
Tunnel-Client-Endpoint      4.5.4        | M  |  V  |
Tunnel-Server-Endpoint      4.5.5        | M  |  V  |
Tunnel-Password             4.5.6        | M  |  V  |
Tunnel-Private-Group-Id     4.5.7        | M  |  V  |
Tunnel-Assignment-Id        4.5.8        | M  |  V  |
Tunnel-Preference           4.5.9        | M  |  V  |
Tunnel-Client-Auth-Id       4.5.10       | M  |  V  |
Tunnel-Server-Auth-Id       4.5.11       | M  |  V  |
-----------------------------------------|----+-----|
 </pre>
<p id="rfc.section.4.5.p.1">Some NASes support compulsory tunnel services in which the incoming connection data is conveyed by an encapsulation method to a gateway elsewhere in the network.  This is typically transparent to the service user, and the tunnel characteristics may be described by the remote AAA server, based on the user's authorization information.  Several tunnel characteristics may be returned, and the NAS implementation may choose one.  See <a href="#RFC2868">[RFC2868]</a> and <a href="#RFC2867">[RFC2867]</a> for further information.  <br><br> The following table gives the possible flag values for the session level AVPs and specifies whether the AVP MAY be encrypted.  </p>
<h1 id="rfc.section.4.5.1">
<a href="#rfc.section.4.5.1">4.5.1.</a> Tunneling AVP</h1>
<div id="#rfc.figure.16"></div>
<pre>
Tunneling     ::= &lt; AVP Header: 401 &gt;
                  { Tunnel-Type }
                  { Tunnel-Medium-Type }
                  { Tunnel-Client-Endpoint }
                  { Tunnel-Server-Endpoint }
                  [ Tunnel-Preference ]
                  [ Tunnel-Client-Auth-Id ]
                  [ Tunnel-Server-Auth-Id ]
                  [ Tunnel-Assignment-Id ]
                  [ Tunnel-Password ]
                  [ Tunnel-Private-Group-Id ]	
 </pre>
<p id="rfc.section.4.5.1.p.1">The Tunneling AVP (AVP Code 401) is of type Grouped and contains the following AVPs, used to describe a compulsory tunnel service (<a href="#RFC2868">[RFC2868]</a>, <a href="#RFC2867">[RFC2867]</a>).  Its data field has the following ABNF grammar: </p>
<h1 id="rfc.section.4.5.2">
<a href="#rfc.section.4.5.2">4.5.2.</a> <a href="#T-T-AVP" id="T-T-AVP">Tunnel-Type AVP</a>
</h1>
<p id="rfc.section.4.5.2.p.1">The Tunnel-Type AVP (AVP Code 64) is of type Enumerated and contains the tunneling protocol(s) to be used (in the case of a tunnel initiator) or in use (in the case of a tunnel terminator).  It MAY be used in an authorization request as a hint to the server that a specific tunnel type is desired, but the server is not required to honor the hint in the corresponding response.  <br><br> The Tunnel-Type AVP SHOULD also be included in ACR messages.  <br><br> A tunnel initiator is not required to implement any of these tunnel types.  If a tunnel initiator receives a response that contains only unknown or unsupported Tunnel-Types, the tunnel initiator MUST behave as though a response were received with the Result-Code indicating a failure.  <br><br> The supported values are listed in <a href="#RADIUSTypes">[RADIUSTypes]</a>.  </p>
<h1 id="rfc.section.4.5.3">
<a href="#rfc.section.4.5.3">4.5.3.</a> <a href="#T-M-T-AVP" id="T-M-T-AVP">Tunnel-Medium-Type AVP</a>
</h1>
<p id="rfc.section.4.5.3.p.1">The Tunnel-Medium-Type AVP (AVP Code 65) is of type Enumerated and contains the transport medium to use when creating a tunnel for protocols (<a href="#RFC3931">such as L2TP</a> <cite title="NONE">[RFC3931]</cite>) that can operate over multiple transports.  It MAY be used in an authorization request as a hint to the server that a specific medium is desired, but the server is not required to honor the hint in the corresponding response.  <br><br> The supported values are listed in <a href="#RADIUSTypes">[RADIUSTypes]</a>.  </p>
<h1 id="rfc.section.4.5.4">
<a href="#rfc.section.4.5.4">4.5.4.</a> <a href="#T-C-E-AVP" id="T-C-E-AVP">Tunnel-Client-Endpoint AVP</a>
</h1>
<p id="rfc.section.4.5.4.p.1">The Tunnel-Client-Endpoint AVP (AVP Code 66) is of type UTF8String and contains the address of the initiator end of the tunnel.  It MAY be used in an authorization request as a hint to the server that a specific endpoint is desired, but the server is not required to honor the hint in the corresponding response.  This AVP SHOULD be included in the corresponding ACR messages, in which case it indicates the address from which the tunnel was initiated.  This AVP, along with the Tunnel-Server-Endpoint (<a href="#T-S-E-AVP">Section 4.5.5</a>) and Session-Id AVPs (<a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>, Section 8.8), can be used to provide a globally unique means to identify a tunnel for accounting and auditingpurposes.  <br><br> If the value of the Tunnel-Medium-Type AVP (<a href="#T-M-T-AVP">Section 4.5.3</a>) is IPv4 (1), then this string is either the fully qualified domain name (FQDN) of the tunnel client machine, or a "dotted-decimal" IP address.  Implementations MUST support the dotted-decimal format and SHOULD support the FQDN format for IP addresses.  <br><br> If Tunnel-Medium-Type is IPv6 (2), then this string is either the FQDN of the tunnel client machine, or a text representation of the address in either the preferred or alternate form <a href="#RFC3516">[RFC3516]</a>.  Conforming implementations MUST support the preferred form and SHOULD support both the alternate text form and the FQDN format for IPv6 addresses.  <br><br> If Tunnel-Medium-Type is neither IPv4 nor IPv6, then this string is a tag referring to configuration data local to the Diameter client that describes the interface or medium-specific client address to use.  </p>
<h1 id="rfc.section.4.5.5">
<a href="#rfc.section.4.5.5">4.5.5.</a> <a href="#T-S-E-AVP" id="T-S-E-AVP">Tunnel-Server-Endpoint AVP</a>
</h1>
<p id="rfc.section.4.5.5.p.1">The Tunnel-Server-Endpoint AVP (AVP Code 67) is of type UTF8String and contains the address of the server end of the tunnel.  It MAY be used in an authorization request as a hint to the server that a specific endpoint is desired, but the server is not required to honor the hint in the corresponding response.  <br><br> This AVP SHOULD be included in the corresponding ACR messages, in which case it indicates the address from which the tunnel was initiated.  This AVP, along with the Tunnel-Client-Endpoint (<a href="#T-C-E-AVP">Section 4.5.4</a>) and Session-Id AVP (<a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>, Section 8.8), can be used to provide a globally unique means to identify a tunnel for accounting and auditing purposes.  <br><br> If Tunnel-Medium-Type is IPv4 (1), then this string is either the fully qualified domain name (FQDN) of the tunnel server machine, or a "dotted-decimal" IP address.  Implementations MUST support the dotted-decimal format and SHOULD support the FQDN format for IP addresses.  <br><br> If Tunnel-Medium-Type is IPv6 (2), then this string is either the FQDN of the tunnel server machine, or a text representation of the address in either the preferred or alternate form <a href="#RFC3516">[RFC3516]</a>.  Implementations MUST support the preferred form and SHOULD support both the alternate text form and the FQDN format for IPv6 addresses.  <br><br> If Tunnel-Medium-Type is not IPv4 or IPv6, this string is a tag referring to configuration data local to the Diameter client that describes the interface or medium-specific server address to use.  </p>
<h1 id="rfc.section.4.5.6">
<a href="#rfc.section.4.5.6">4.5.6.</a> Tunnel-Password AVP</h1>
<p id="rfc.section.4.5.6.p.1">The Tunnel-Password AVP (AVP Code 69) is of type OctetString and may contain a password to be used to authenticate to a remote server.  <br><br> The Tunnel-Password AVP SHOULD NOT be used in untrusted proxy environments without encrypting it by using end-to-end security techniques.  </p>
<h1 id="rfc.section.4.5.7">
<a href="#rfc.section.4.5.7">4.5.7.</a> Tunnel-Private-Group-Id AVP</h1>
<p id="rfc.section.4.5.7.p.1">The Tunnel-Private-Group-Id AVP (AVP Code 81) is of type OctetString and contains the group Id for a particular tunneled session.  The Tunnel-Private-Group-Id AVP MAY be included in an authorization request if the tunnel initiator can predetermine the group resulting from a particular connection.  It SHOULD be included in the authorization response if this tunnel session is to be treated as belonging to a particular private group.  Private groups may be used to associate a tunneled session with a particular group of users.  For example, it MAY be used to facilitate routing of unregistered IP addresses through a particular interface.  This AVP SHOULD be included in the ACR messages that pertain to the tunneled session.  </p>
<h1 id="rfc.section.4.5.8">
<a href="#rfc.section.4.5.8">4.5.8.</a> Tunnel-Assignment-Id AVP</h1>
<p id="rfc.section.4.5.8.p.1">The Tunnel-Assignment-Id AVP (AVP Code 82) is of type OctetString and is used to indicate to the tunnel initiator the particular tunnel to which a session is to be assigned.  Some tunneling protocols, such as PPTP <a href="#RFC2637">[RFC2637]</a> and L2TP <a href="#RFC3931">[RFC3931]</a>, allow for sessions between the same two tunnel endpoints to be multiplexed over the same tunnel and also for a given session to use its own dedicated tunnel.  This attribute provides a mechanism for Diameter to inform the tunnel initiator (e.g., PAC, LAC) whether to assign the session to a multiplexed tunnel or to a separate tunnel.  Furthermore, it allows for sessions sharing multiplexed tunnels to be assigned to different multiplexed tunnels.  <br><br> A particular tunneling implementation may assign differing characteristics to particular tunnels.  For example, different tunnels may be assigned different QoS parameters.  Such tunnels may be used to carry either individual or multiple sessions.  The Tunnel-Assignment-Id attribute thus allows the Diameter server to indicate that a particular session is to be assigned to a tunnel providing an appropriate level of service.  It is expected that any QoS-related Diameter tunneling attributes defined in the future accompanying this one will be associated by the tunnel initiator with the Id given by this attribute.  In the meantime, any semantic given to a particular Id string is a matter left to local configuration in the tunnel initiator.  <br><br> The Tunnel-Assignment-Id AVP is of significance only to Diameter and the tunnel initiator.  The Id it specifies is only intended to be of local use to Diameter and the tunnel initiator.  The Id assigned by the tunnel initiator is not conveyed to the tunnel peer.  <br><br> This attribute MAY be included in authorization responses.  The tunnel initiator receiving this attribute MAY choose to ignore it and to assign the session to an arbitrary multiplexed or non-multiplexed tunnel between the desired endpoints.  This AVP SHOULD also be included in the Accounting-Request messages pertaining to the tunneled session.  <br><br> If a tunnel initiator supports the Tunnel-Assignment-Id AVP, then it should assign a session to a tunnel in the following manner: </p>

<ul>
<li>If this AVP is present and a tunnel exists between the specified endpoints with the specified Id, then the session should be assigned to that tunnel.  </li>
<li>If this AVP is present and no tunnel exists between the specified endpoints with the specified Id, then a new tunnel should be established for the session and the specified Id should be associated with the new tunnel.  </li>
<li>If this AVP is not present, then the session is assigned to an unnamed tunnel.  If an unnamed tunnel does not yet exist between the specified endpoints, then it is established and used for this session and for subsequent ones established without the Tunnel-Assignment-Id attribute.  A tunnel initiator MUST NOT assign a session for which a Tunnel-Assignment-Id AVP was not specified to a named tunnel (i.e., one that was initiated by a session specifying this AVP).  </li>
</ul>

<p> Note that the same Id may be used to name different tunnels if these tunnels are between different endpoints.  </p>
<h1 id="rfc.section.4.5.9">
<a href="#rfc.section.4.5.9">4.5.9.</a> Tunnel-Preference AVP</h1>
<p id="rfc.section.4.5.9.p.1">The Tunnel-Preference AVP (AVP Code 83) is of type Unsigned32 and is used to identify the relative preference assigned to each tunnel when more than one set of tunneling AVPs is returned within separate Grouped-AVP AVPs.  It MAY be used in an authorization request as a hint to the server that a specific preference is desired, but the server is not required to honor the hint in the corresponding response.  <br><br> For example, suppose that AVPs describing two tunnels are returned by the server, one with a Tunnel-Type of PPTP and the other with a Tunnel-Type of L2TP.  If the tunnel initiator supports only one of the Tunnel-Types returned, it will initiate a tunnel of that type.  If, however, it supports both tunnel protocols, it SHOULD use the value of the Tunnel-Preference AVP to decide which tunnel should be started.  The tunnel with the lowest numerical value in the Value field of this AVP SHOULD be given the highest preference.  The values assigned to two or more instances of the Tunnel-Preference AVP within a given authorization response MAY be identical.  In this case, the tunnel initiator SHOULD use locally configured metrics to decide which set of AVPs to use.  </p>
<h1 id="rfc.section.4.5.10">
<a href="#rfc.section.4.5.10">4.5.10.</a> Tunnel-Client-Auth-Id AVP</h1>
<p id="rfc.section.4.5.10.p.1">The Tunnel-Client-Auth-Id AVP (AVP Code 90) is of type UTF8String and specifies the name used by the tunnel initiator during the authentication phase of tunnel establishment.  It MAY be used in an authorization request as a hint to the server that a specific preference is desired, but the server is not required to honor the hint in the corresponding response.  This AVP MUST be present in the authorization response if an authentication name other than the default is desired.  This AVP SHOULD be included in the ACR messages pertaining to the tunneled session.  </p>
<h1 id="rfc.section.4.5.11">
<a href="#rfc.section.4.5.11">4.5.11.</a> Tunnel-Server-Auth-Id AVP</h1>
<p id="rfc.section.4.5.11.p.1">The Tunnel-Server-Auth-Id AVP (AVP Code 91) is of type UTF8String and specifies the name used by the tunnel terminator during the authentication phase of tunnel establishment.  It MAY be used in an authorization request as a hint to the server that a specific preference is desired, but the server is not required to honor the hint in the corresponding response.  This AVP MUST be present in the authorization response if an authentication name other than the default is desired.  This AVP SHOULD be included in the ACR messages pertaining to the tunneled session.  </p>
<h1 id="rfc.section.4.6">
<a href="#rfc.section.4.6">4.6.</a> <a href="#ACCT-AVP" id="ACCT-AVP">NAS Accounting AVPs</a>
</h1>
<div id="#rfc.figure.17"></div>
<pre>
                                         +----------+
                                         | AVP Flag |
                                         |  rules   |
                                         |----+-----|
                                 Section |MUST| MUST| 
Attribute Name                   Defined |    |  NOT|
-----------------------------------------|----+-----|
Accounting-Input-Octets           4.6.1  | M  |  V  | 
Accounting-Output-Octets          4.6.2  | M  |  V  |
Accounting-Input-Packets          4.6.3  | M  |  V  |
Accounting-Output-Packets         4.6.4  | M  |  V  |
Acct-Session-Time                 4.6.5  | M  |  V  |
Acct-Authentic                    4.6.6  | M  |  V  |
Accounting-Auth-Method            4.6.7  | M  |  V  |
Acct-Delay-Time                   4.6.8  | M  |  V  |
Acct-Link-Count                   4.6.9  | M  |  V  |
Acct-Tunnel-Connection            4.6.10 | M  |  V  |
Acct-Tunnel-Packets-Lost          4.6.11 | M  |  V  |
-----------------------------------------|----+-----|
</pre>
<p id="rfc.section.4.6.p.1">Applications implementing this specification use Diameter Accounting (as defined in <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>) and the AVPs in the following section.  Service-specific AVP usage is defined in the tables in <a href="#A-O-T">Section 5</a>.  <br><br> If accounting is active, Accounting Request (ACR) messages SHOULD be sent after the completion of any Authentication or Authorization transaction and at the end of a Session.  The value of the Accounting-Record-Type AVP <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> indicates the type of event.  All other AVPs identify the session and provide additional information relevant to the event.  <br><br> The successful completion of the first Authentication or Authorization transaction SHOULD cause a START_RECORD to be sent.  If additional Authentications or Authorizations occur in later transactions, the first exchange should generate a START_RECORD, and the later an INTERIM_RECORD.  For a given session, there MUST only be one set of matching START and STOP records, with any number of INTERIM_RECORDS in between, or one EVENT_RECORD indicating the reason a session wasn't started.  <br><br> The following table gives the possible flag values for the session level AVPs and specifies whether the AVP MAY be encrypted.  </p>
<h1 id="rfc.section.4.6.1">
<a href="#rfc.section.4.6.1">4.6.1.</a> Accounting-Input-Octets AVP</h1>
<p id="rfc.section.4.6.1.p.1">The Accounting-Input-Octets AVP (AVP Code 363) is of type Unsigned64 and contains the number of octets received from the user.  <br><br> For NAS usage, this AVP indicates how many octets have been received from the port in the course of this session.  It can only be present in ACR messages with an Accounting-Record-Type <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> of INTERIM_RECORD or STOP_RECORD.  </p>
<h1 id="rfc.section.4.6.2">
<a href="#rfc.section.4.6.2">4.6.2.</a> Accounting-Output-Octets AVP</h1>
<p id="rfc.section.4.6.2.p.1">The Accounting-Output-Octets AVP (AVP Code 364) is of type Unsigned64 and contains the number of octets sent to the user.  <br><br> For NAS usage, this AVP indicates how many octets have been sent to the port in the course of this session.  It can only be present in ACR messages with an Accounting-Record-Type of INTERIM_RECORD or STOP_RECORD.  </p>
<h1 id="rfc.section.4.6.3">
<a href="#rfc.section.4.6.3">4.6.3.</a> Accounting-Input-Packets AVP</h1>
<p id="rfc.section.4.6.3.p.1">The Accounting-Input-Packets (AVP Code 365) is of type Unsigned64 and contains the number of packets received from the user.  <br><br> For NAS usage, this AVP indicates how many packets have been received from the port over the course of a session being provided to a Framed User.  It can only be present in ACR messages with an Accounting-Record-Type of INTERIM_RECORD or STOP_RECORD.  </p>
<h1 id="rfc.section.4.6.4">
<a href="#rfc.section.4.6.4">4.6.4.</a> Accounting-Output-Packets AVP</h1>
<p id="rfc.section.4.6.4.p.1">The Accounting-Output-Packets (AVP Code 366) is of type Unsigned64 and contains the number of IP packets sent to the user.  <br><br> For NAS usage, this AVP indicates how many packets have been sent to the port over the course of a session being provided to a Framed User.  It can only be present in ACR messages with an Accounting-Record-Type of INTERIM_RECORD or STOP_RECORD.  </p>
<h1 id="rfc.section.4.6.5">
<a href="#rfc.section.4.6.5">4.6.5.</a> Acct-Session-Time AVP</h1>
<p id="rfc.section.4.6.5.p.1">The Acct-Session-Time AVP (AVP Code 46) is of type Unsigned32 and indicates the length of the current session in seconds.  It can only be present in ACR messages with an Accounting-Record-Type of INTERIM_RECORD or STOP_RECORD.  </p>
<h1 id="rfc.section.4.6.6">
<a href="#rfc.section.4.6.6">4.6.6.</a> Acct-Authentic AVP</h1>
<p id="rfc.section.4.6.6.p.1">The Acct-Authentic AVP (AVP Code 45) is of type Enumerated and specifies how the user was authenticated.  The supported values are listed in <a href="#RADIUSTypes">[RADIUSTypes]</a>.  </p>
<h1 id="rfc.section.4.6.7">
<a href="#rfc.section.4.6.7">4.6.7.</a> <a href="#A-A-M-AVP" id="A-A-M-AVP">Accounting-Auth-Method AVP</a>
</h1>
<p id="rfc.section.4.6.7.p.1">The Accounting-Auth-Method AVP (AVP Code 406) is of type Enumerated.  A NAS MAY include this AVP in an Accounting-Request message to indicate the method used to authenticate the user.  (Note that this AVP is semantically equivalent, and the supported values are identical, to the Microsoft MS-Acct-Auth-Type vendor-specific RADIUS attribute <a href="#RFC2548">[RFC2548]</a>).  </p>
<h1 id="rfc.section.4.6.8">
<a href="#rfc.section.4.6.8">4.6.8.</a> Acct-Delay-Time AVP</h1>
<p id="rfc.section.4.6.8.p.1">The Acct-Delay-Time AVP (AVP Code 41) is of type Unsigned32 and indicates the number of seconds the Diameter client has been trying to send the Accounting-Request (ACR).  The accounting server may subtract this value from the time when the ACR arrives at the server to calculate the approximate time of the event that caused the ACR to be generated.  <br><br> This AVP is not used for retransmissions at the transport level (TCP or SCTP).  Rather, it may be used when an ACR command cannot be transmitted because there is no appropriate peer to transmit it to or was rejected because it could not be delivered.  In these cases, the command MAY be buffered and transmitted later, when an appropriate peer-connection is available or after sufficient time has passed that the destination-host may be reachable and operational.  If the ACR is re-sent in this way, the Acct-Delay-Time AVP SHOULD be included.  The value of this AVP indicates the number of seconds that elapsed between the time of the first attempt at transmission and the current attempt.  </p>
<h1 id="rfc.section.4.6.9">
<a href="#rfc.section.4.6.9">4.6.9.</a> Acct-Link-Count AVP</h1>
<div id="#rfc.figure.18"></div>
<pre>
Acct-Multi-                   Accounting-     Acct-
Session-Id     Session-Id     Record-Type     Link-Count
--------------------------------------------------------
  "...10"        "...10"      START_RECORD        1
  "...10"        "...11"      START_RECORD        2
  "...10"        "...11"      STOP_RECORD         2
  "...10"        "...12"      START_RECORD        3
  "...10"        "...13"      START_RECORD        4
  "...10"        "...12"      STOP_RECORD         4
  "...10"        "...13"      STOP_RECORD         4
  "...10"        "...10"      STOP_RECORD         4
</pre>
<p id="rfc.section.4.6.9.p.1">The Acct-Link-Count AVP (AVP Code 51) is of type Unsigned32 and indicates the total number of links that have been active (current or closed) in a given multilink session at the time the accounting record is generated.  This AVP MAY be included in Accounting-Requests for any session that may be part of a multilink service.  <br><br> The Acct-Link-Count AVP may be used to make it easier for an accounting server to know when it has all the records for a given multilink service.  When the number of Accounting-Requests received with Accounting-Record-Type = STOP_RECORD and with the same Acct-Multi-Session-Id and unique Session-Ids equals the largest value of Acct-Link-Count seen in those Accounting-Requests, all STOP_RECORD Accounting-Requests for that multilink service have been received.  <br><br> The following example, showing eight Accounting-Requests, illustrates how the Acct-Link-Count AVP is used.  In the table below, only the relevant AVPs are shown, although additional AVPs containing accounting information will be present in the Accounting-Requests.  </p>
<h1 id="rfc.section.4.6.10">
<a href="#rfc.section.4.6.10">4.6.10.</a> Acct-Tunnel-Connection AVP</h1>
<p id="rfc.section.4.6.10.p.1">The Acct-Tunnel-Connection AVP (AVP Code 68) is of type OctetString and contains the identifier assigned to the tunnel session.  This AVP, along with the Tunnel-Client-Endpoint (<a href="#T-C-E-AVP">Section 4.5.4</a>) and Tunnel-Server-Endpoint (<a href="#T-S-E-AVP">Section 4.5.5</a>) AVPs, may be used to provide a means to uniquely identify a tunnel session for auditing purposes.  <br><br> The format of the identifier in this AVP depends upon the value of the Tunnel-Type AVP (<a href="#T-T-AVP">Section 4.5.2</a>).  For example, to identify an L2TP tunnel connection fully, the L2TP Tunnel Id and Call Id might be encoded in this field.  The exact encoding of this field is implementation dependent.  </p>
<h1 id="rfc.section.4.6.11">
<a href="#rfc.section.4.6.11">4.6.11.</a> Acct-Tunnel-Packets-Lost AVP</h1>
<p id="rfc.section.4.6.11.p.1">The Acct-Tunnel-Packets-Lost AVP (AVP Code 86) is of type Unsigned32 and contains the number of packets lost on a given tunnel.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#A-O-T" id="A-O-T">AVP Occurrence Tables</a>
</h1>
<p id="rfc.section.5.p.1">The following tables present the AVPs used by NAS applications in NAS messages and specify in which Diameter messages they may or may not be present.  Messages and AVPs defined in the base Diameter protocol <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> are not described in this document.  Note that AVPs that can only be present within a Grouped AVP are not represented in this table.  <br><br> The tables use the following symbols: </p>

<ul class="empty"><li>
<dl>
<dt>0</dt>
<dd style="margin-left: 5">The AVP MUST NOT be present in the message.</dd>
<dt>0+</dt>
<dd style="margin-left: 5">Zero or more instances of the AVP MAY be present in the message.</dd>
<dt>0-1</dt>
<dd style="margin-left: 5">Zero or one instance of the AVP MAY be present in the message.</dd>
<dt>1</dt>
<dd style="margin-left: 5">Exactly one instance of the AVP MUST be present in the message.</dd>
</dl>
<p> </p>
</li></ul>

<p> </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> AA-Request/Answer AVP Table</h1>
<div id="#rfc.figure.19"></div>
<pre>
                              +-----------+
                              |  Command  |
                              |-----+-----+
AVP Name                      | AAR | AAA |
------------------------------|-----+-----+
Acct-Interim-Interval         | 0   | 0-1 |
ARAP-Challenge-Response       | 0   | 0-1 |
ARAP-Features                 | 0   | 0-1 |
ARAP-Password                 | 0-1 | 0   |
ARAP-Security                 | 0-1 | 0-1 |
ARAP-Security-Data            | 0+  | 0+  |
ARAP-Zone-Access              | 0   | 0-1 |
Auth-Application-Id           | 1   | 1   |
Auth-Grace-Period             | 0-1 | 0-1 |
Auth-Request-Type             | 1   | 1   |
Auth-Session-State            | 0-1 | 0-1 |
Authorization-Lifetime        | 0-1 | 0-1 |
------------------------------|-----+-----+
</pre>
<div id="#rfc.figure.20"></div>
<pre>
                              +-----------+
                              |  Command  |
                              |-----+-----+
Attribute Name                | AAR | AAA |
------------------------------|-----+-----+
Callback-Id                   | 0   | 0-1 |
Callback-Number               | 0-1 | 0-1 |
Called-Station-Id             | 0-1 | 0   |
Calling-Station-Id            | 0-1 | 0   |
CHAP-Auth                     | 0-1 | 0   |
CHAP-Challenge                | 0-1 | 0   |
Class                         | 0   | 0+  |
Configuration-Token           | 0   | 0+  |
Connect-Info                  | 0+  | 0   |
Destination-Host              | 0-1 | 0   |
Destination-Realm             | 1   | 0   |
Error-Message                 | 0   | 0-1 |
Error-Reporting-Host          | 0   | 0-1 |
Failed-AVP                    | 0+  | 0+  |
Filter-Id                     | 0   | 0+  |
Framed-Appletalk-Link         | 0   | 0-1 |
Framed-Appletalk-Network      | 0   | 0+  |
Framed-Appletalk-Zone         | 0   | 0-1 |
Framed-Compression            | 0+  | 0+  |
Framed-Interface-Id           | 0-1 | 0-1 |
Framed-IP-Address             | 0-1 | 0-1 |
Framed-IP-Netmask             | 0-1 | 0-1 |
Framed-IPv6-Prefix            | 0+  | 0+  |
Framed-IPv6-Pool              | 0   | 0-1 |
Framed-IPv6-Route             | 0   | 0+  |
Framed-IPX-Network            | 0   | 0-1 |
Framed-MTU                    | 0-1 | 0-1 |
Framed-Pool                   | 0   | 0-1 |
Framed-Protocol               | 0-1 | 0-1 |
Framed-Route                  | 0   | 0+  |
Framed-Routing                | 0   | 0-1 |
Idle-Timeout                  | 0   | 0-1 |
Login-IP-Host                 | 0+  | 0+  |
Login-IPv6-Host               | 0+  | 0+  |
Login-LAT-Group               | 0-1 | 0-1 |
Login-LAT-Node                | 0-1 | 0-1 |
Login-LAT-Port                | 0-1 | 0-1 |
Login-LAT-Service             | 0-1 | 0-1 |
Login-Service                 | 0   | 0-1 |
Login-TCP-Port                | 0   | 0-1 |
Multi-Round-Time-Out          | 0   | 0-1 |
------------------------------|-----+-----+
</pre>
<div id="#rfc.figure.21"></div>
<pre>
                              +-----------+
                              |  Command  |
                              |-----+-----+
Attribute Name                | AAR | AAA |
------------------------------|-----+-----+
NAS-Filter-Rule               | 0   | 0+  |
NAS-Identifier                | 0-1 | 0   |
NAS-IP-Address                | 0-1 | 0   |
NAS-IPv6-Address              | 0-1 | 0   |
NAS-Port                      | 0-1 | 0   |
NAS-Port-Id                   | 0-1 | 0   |
NAS-Port-Type                 | 0-1 | 0   |
Origin-AAA-Protocol           | 0-1 | 0-1 |
Origin-Host                   | 1   | 1   |
Origin-Realm                  | 1   | 1   |
Origin-State-Id               | 0-1 | 0-1 |
Originating-Line-Info         | 0-1 | 0   |
Password-Retry                | 0   | 0-1 |
Port-Limit                    | 0-1 | 0-1 |
Prompt                        | 0   | 0-1 |
Proxy-Info                    | 0+  | 0+  |
QoS-Filter-Rule               | 0   | 0+  |
Re-Auth-Request-Type          | 0   | 0-1 |
Redirect-Host                 | 0   | 0+  |
Redirect-Host-Usage           | 0   | 0-1 |
Redirect-Max-Cache-Time       | 0   | 0-1 |
Reply-Message                 | 0   | 0+  |
Result-Code                   | 0   | 1   |
Route-Record                  | 0+  | 0   |
Service-Type                  | 0-1 | 0-1 |
Session-Id                    | 1   | 1   |
Session-Timeout               | 0   | 0-1 |
State                         | 0-1 | 0-1 |
Tunneling                     | 0+  | 0+  |
User-Name                     | 0-1 | 0-1 |
User-Password                 | 0-1 | 0   |
------------------------------|-----+-----+
</pre>
<p id="rfc.section.5.1.p.1">The table in this section is limited to the Command Codes defined in this specification.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Accounting AVP Tables</h1>
<p id="rfc.section.5.2.p.1">The tables in this section are used to show which AVPs defined in this document are to be present and used in NAS application Accounting messages.  These AVPs are defined in this document, as well as in <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a> and <a href="#RFC2866">[RFC2866]</a>.  </p>
<h1 id="rfc.section.5.2.1">
<a href="#rfc.section.5.2.1">5.2.1.</a> Framed Access Accounting AVP Table</h1>
<div id="#rfc.figure.22"></div>
<pre>
                                          +-----------+
                                          |  Command  |
                                          |-----+-----+
   Attribute Name                         | ACR | ACA |
   ---------------------------------------|-----+-----+
   Accounting-Auth-Method                 | 0-1 | 0   |
   Accounting-Input-Octets                | 1   | 0   |
   Accounting-Input-Packets               | 1   | 0   |
   Accounting-Output-Octets               | 1   | 0   |
   Accounting-Output-Packets              | 1   | 0   |
   Accounting-Record-Number               | 0-1 | 0-1 |
   Accounting-Record-Type                 | 1   | 1   |
   Accounting-Realtime-Required           | 0-1 | 0-1 |
   Accounting-Sub-Session-Id              | 0-1 | 0-1 |
   Acct-Application-Id                    | 0-1 | 0-1 |
   Acct-Session-Id                        | 1   | 0-1 |
   Acct-Multi-Session-Id                  | 0-1 | 0-1 |
   Acct-Authentic                         | 1   | 0   |
   Acct-Delay-Time                        | 0-1 | 0   |
   Acct-Interim-Interval                  | 0-1 | 0-1 |
   Acct-Link-Count                        | 0-1 | 0   |
   Acct-Session-Time                      | 1   | 0   |
   Acct-Tunnel-Connection                 | 0-1 | 0   |
   Acct-Tunnel-Packets-Lost               | 0-1 | 0   |
   Authorization-Lifetime                 | 0-1 | 0   |
   Callback-Id                            | 0-1 | 0   |
   Callback-Number                        | 0-1 | 0   |
   Called-Station-Id                      | 0-1 | 0   |
   Calling-Station-Id                     | 0-1 | 0   |
   Class                                  | 0+  | 0+  |
   Connection-Info                        | 0+  | 0   |
   Destination-Host                       | 0-1 | 0   |
   Destination-Realm                      | 1   | 0   |
   Event-Timestamp                        | 0-1 | 0-1 |
   Error-Message                          | 0   | 0-1 |
   Error-Reporting-Host                   | 0   | 0-1 |
   Failed-AVP                             | 0   | 0+  |
   ---------------------------------------|-----+-----+
</pre>
<div id="#rfc.figure.23"></div>
<pre>
                                       +-----------+
                                       |  Command  |
                                       |-----+-----+
Attribute Name                         | ACR | ACA |
---------------------------------------|-----+-----+
Framed-AppleTalk-Link                  | 0-1 | 0   |
Framed-AppleTalk-Network               | 0-1 | 0   |
Framed-AppleTalk-Zone                  | 0-1 | 0   |
Framed-Compression                     | 0-1 | 0   |
Framed-IP-Address                      | 0-1 | 0   |
Framed-IP-Netmask                      | 0-1 | 0   |
Framed-IPv6-Prefix                     | 0+  | 0   |
Framed-IPv6-Pool                       | 0-1 | 0   |
Framed-IPX-Network                     | 0-1 | 0   |
Framed-MTU                             | 0-1 | 0   |
Framed-Pool                            | 0-1 | 0   |
Framed-Protocol                        | 0-1 | 0   |
Framed-Route                           | 0-1 | 0   |
Framed-Routing                         | 0-1 | 0   |
NAS-Filter-Rule                        | 0+  | 0   |
NAS-Identifier                         | 0-1 | 0-1 |
NAS-IP-Address                         | 0-1 | 0-1 |
NAS-IPv6-Address                       | 0-1 | 0-1 |
NAS-Port                               | 0-1 | 0-1 |
NAS-Port-Id                            | 0-1 | 0-1 |
NAS-Port-Type                          | 0-1 | 0-1 |
Origin-AAA-Protocol                    | 0-1 | 0-1 |
Origin-Host                            | 1   | 1   |
Origin-Realm                           | 1   | 1   |
Origin-State-Id                        | 0-1 | 0-1 |
Originating-Line-Info                  | 0-1 | 0   |
Proxy-Info                             | 0+  | 0+  |
QoS-Filter-Rule                        | 0+  | 0   |
Route-Record                           | 0+  | 0   |
Result-Code                            | 0   | 1   |
Service-Type                           | 0-1 | 0-1 |
Session-Id                             | 1   | 1   |
Termination-Cause                      | 0-1 | 0-1 |
Tunnel-Assignment-Id                   | 0-1 | 0   |
Tunnel-Client-Endpoint                 | 0-1 | 0   |
Tunnel-Medium-Type                     | 0-1 | 0   |
Tunnel-Private-Group-Id                | 0-1 | 0   |
Tunnel-Server-Endpoint                 | 0-1 | 0   |
Tunnel-Type                            | 0-1 | 0   |
User-Name                              | 0-1 | 0-1 |
Vendor-Specific-Application-Id         | 0-1 | 0-1 |
---------------------------------------|-----+-----+
</pre>
<p id="rfc.section.5.2.1.p.1">The table in this section is used when the Service-Type AVP (<a href="#S-T-AVP">Section 4.4.1</a>) specifies Framed Access.  </p>
<h1 id="rfc.section.5.2.2">
<a href="#rfc.section.5.2.2">5.2.2.</a> Non-Framed Access Accounting AVP Table</h1>
<div id="#rfc.figure.24"></div>
<pre>
                                       +-----------+
                                       |  Command  |
                                       |-----+-----+
Attribute Name                         | ACR | ACA |
---------------------------------------|-----+-----+
Accounting-Auth-Method                 | 0-1 | 0   |
Accounting-Input-Octets                | 1   | 0   |
Accounting-Output-Octets               | 1   | 0   |
Accounting-Record-Type                 | 1   | 1   |
Accounting-Record-Number               | 0-1 | 0-1 |
Accounting-Realtime-Required           | 0-1 | 0-1 |
Accounting-Sub-Session-Id              | 0-1 | 0-1 |
Acct-Application-Id                    | 0-1 | 0-1 |
Acct-Session-Id                        | 1   | 0-1 |
Acct-Multi-Session-Id                  | 0-1 | 0-1 |
Acct-Authentic                         | 1   | 0   |
Acct-Delay-Time                        | 0-1 | 0   |
Acct-Interim-Interval                  | 0-1 | 0-1 |
Acct-Link-Count                        | 0-1 | 0   |
Acct-Session-Time                      | 1   | 0   |
Authorization-Lifetime                 | 0-1 | 0   |
Callback-Id                            | 0-1 | 0   |
Callback-Number                        | 0-1 | 0   |
Called-Station-Id                      | 0-1 | 0   |
Calling-Station-Id                     | 0-1 | 0   |
Class                                  | 0+  | 0+  |
Connection-Info                        | 0+  | 0   |
Destination-Host                       | 0-1 | 0   |
Destination-Realm                      | 1   | 0   |
Event-Timestamp                        | 0-1 | 0-1 |
Error-Message                          | 0   | 0-1 |
Error-Reporting-Host                   | 0   | 0-1 |
Failed-AVP                             | 0   | 0+  |
Login-IP-Host                          | 0+  | 0   |
Login-IPv6-Host                        | 0+  | 0   |
Login-LAT-Service                      | 0-1 | 0   |
Login-LAT-Node                         | 0-1 | 0   |
Login-LAT-Group                        | 0-1 | 0   |
Login-LAT-Port                         | 0-1 | 0   |
Login-Service                          | 0-1 | 0   |
Login-TCP-Port                         | 0-1 | 0   |
---------------------------------------|-----+-----+
</pre>
<div id="#rfc.figure.25"></div>
<pre>
                                       +-----------+
                                       |  Command  |
                                       |-----+-----+
Attribute Name                         | ACR | ACA |
---------------------------------------|-----+-----+
NAS-Identifier                         | 0-1 | 0-1 |
NAS-IP-Address                         | 0-1 | 0-1 |
NAS-IPv6-Address                       | 0-1 | 0-1 |
NAS-Port                               | 0-1 | 0-1 |
NAS-Port-Id                            | 0-1 | 0-1 |
NAS-Port-Type                          | 0-1 | 0-1 |
Origin-AAA-Protocol                    | 0-1 | 0-1 |
Origin-Host                            | 1   | 1   |
Origin-Realm                           | 1   | 1   |
Origin-State-Id                        | 0-1 | 0-1 |
Originating-Line-Info                  | 0-1 | 0   |
Proxy-Info                             | 0+  | 0+  |
QoS-Filter-Rule                        | 0+  | 0   |
Route-Record                           | 0+  | 0   |
Result-Code                            | 0   | 1   |
Session-Id                             | 1   | 1   |
Service-Type                           | 0-1 | 0-1 |
Termination-Cause                      | 0-1 | 0-1 |
User-Name                              | 0-1 | 0-1 |
Vendor-Specific-Application-Id         | 0-1 | 0-1 |
---------------------------------------|-----+-----+
</pre>
<p id="rfc.section.5.2.2.p.1">The table in this section is used when the Service-Type AVP (<a href="#S-T-AVP">Section 4.4.1</a>) specifies Non-Framed Access.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> IANA Considerations</h1>
<p id="rfc.section.6.p.1">This document does not request any action by IANA.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Security Considerations</h1>
<p id="rfc.section.7.p.1">This document describes the extension of Diameter for the NAS application.  The security considerations of the Diameter protocol itself have been discussed in <a href="#I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</a>.  Use of this application of Diameter MUST take into consideration the security issues and requirements of the Base protocol.  <br><br> This document does not contain a security protocol but does discuss how PPP authentication protocols can be carried within the Diameter protocol.  The PPP authentication protocols described are PAP and CHAP.  <br><br> The use of PAP SHOULD be discouraged, as it exposes users' passwords to possibly non-trusted entities.  However, PAP is also frequently used for use with One-Time Passwords, which do not expose a security risk.  <br><br> This document also describes how CHAP can be carried within the Diameter protocol, which is required for RADIUS backward compatibility.  The CHAP protocol, as used in a RADIUS environment, facilitates authentication replay attacks.  <br><br> The use of the EAP authentication protocols <a href="#RFC4072">[RFC4072]</a> can offer better security, given a method suitable for the circumstances.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">8.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">8.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="I-D.ietf-dime-rfc3588bis">[I-D.ietf-dime-rfc3588bis]</b></td>
<td class="top">
<a>Fajardo, V</a>, <a>Arkko, J</a>, <a>Loughney, J</a> and <a>G Zorn</a>, "<a href="http://tools.ietf.org/html/draft-ietf-dime-rfc3588bis-29">Diameter Base Protocol</a>", Internet-Draft draft-ietf-dime-rfc3588bis-29, August 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3539">[RFC3539]</b></td>
<td class="top">
<a>Aboba, B.</a> and <a>J. Wood</a>, "<a href="http://tools.ietf.org/html/rfc3539">Authentication, Authorization and Accounting (AAA) Transport Profile</a>", RFC 3539, June 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2865">[RFC2865]</b></td>
<td class="top">
<a>Rigney, C.</a>, <a>Willens, S.</a>, <a>Rubens, A.</a> and <a>W. Simpson</a>, "<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>", RFC 2865, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RADIUSTypes">[RADIUSTypes]</b></td>
<td class="top">
<a>IANA</a>, "<a>RADIUS Types</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="RFC3162">[RFC3162]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Zorn, G.</a> and <a>D. Mitton</a>, "<a href="http://tools.ietf.org/html/rfc3162">RADIUS and IPv6</a>", RFC 3162, August 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3516">[RFC3516]</b></td>
<td class="top">
<a>Nerenberg, L.</a>, "<a href="http://tools.ietf.org/html/rfc3516">IMAP4 Binary Content Extension</a>", RFC 3516, April 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1994">[RFC1994]</b></td>
<td class="top">
<a href="mailto:wsimpson@GreenDragon.com" title="DayDreamer Computer Systems Consulting Services">Simpson, W.</a>, "<a href="http://tools.ietf.org/html/rfc1994">PPP Challenge Handshake Authentication Protocol (CHAP)</a>", RFC 1994, August 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="ANITypes">[ANITypes]</b></td>
<td class="top">
<a>NANPA Number Resource Info</a>, "<a>ANI Assignments</a>", .</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">8.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2866">[RFC2866]</b></td>
<td class="top">
<a>Rigney, C.</a>, "<a href="http://tools.ietf.org/html/rfc2866">RADIUS Accounting</a>", RFC 2866, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5246">[RFC5246]</b></td>
<td class="top">
<a>Dierks, T.</a> and <a>E. Rescorla</a>, "<a href="http://tools.ietf.org/html/rfc5246">The Transport Layer Security (TLS) Protocol Version 1.2</a>", RFC 5246, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2548">[RFC2548]</b></td>
<td class="top">
<a href="mailto:glennz@microsoft.com" title="Microsoft Corporation">Zorn, G.</a>, "<a href="http://tools.ietf.org/html/rfc2548">Microsoft Vendor-specific RADIUS Attributes</a>", RFC 2548, March 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2869">[RFC2869]</b></td>
<td class="top">
<a>Rigney, C.</a>, <a>Willats, W.</a> and <a>P. Calhoun</a>, "<a href="http://tools.ietf.org/html/rfc2869">RADIUS Extensions</a>", RFC 2869, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2868">[RFC2868]</b></td>
<td class="top">
<a>Zorn, G.</a>, <a>Leifer, D.</a>, <a>Rubens, A.</a>, <a>Shriver, J.</a>, <a>Holdrege, M.</a> and <a>I. Goyret</a>, "<a href="http://tools.ietf.org/html/rfc2868">RADIUS Attributes for Tunnel Protocol Support</a>", RFC 2868, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2867">[RFC2867]</b></td>
<td class="top">
<a>Zorn, G.</a>, <a>Aboba, B.</a> and <a>D. Mitton</a>, "<a href="http://tools.ietf.org/html/rfc2867">RADIUS Accounting Modifications for Tunnel Protocol Support</a>", RFC 2867, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2881">[RFC2881]</b></td>
<td class="top">
<a>Mitton, D.</a> and <a>M. Beadles</a>, "<a href="http://tools.ietf.org/html/rfc2881">Network Access Server Requirements Next Generation (NASREQNG) NAS Model</a>", RFC 2881, July 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3169">[RFC3169]</b></td>
<td class="top">
<a>Beadles, M.</a> and <a>D. Mitton</a>, "<a href="http://tools.ietf.org/html/rfc3169">Criteria for Evaluating Network Access Server Protocols</a>", RFC 3169, September 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2989">[RFC2989]</b></td>
<td class="top">
<a>Aboba, B.</a>, <a>Calhoun, P.</a>, <a>Glass, S.</a>, <a>Hiller, T.</a>, <a>McCann, P.</a>, <a>Shiino, H.</a>, <a>Walsh, P.</a>, <a>Zorn, G.</a>, <a>Dommety, G.</a>, <a>Perkins, C.</a>, <a>Patil, B.</a>, <a>Mitton, D.</a>, <a>Manning, S.</a>, <a>Beadles, M.</a>, <a>Chen, X.</a>, <a>Sivalingham, S.</a>, <a>Hameed, A.</a>, <a>Munson, M.</a>, <a>Jacobs, S.</a>, <a>Lim, B.</a>, <a>Hirschman, B.</a>, <a>Hsu, R.</a>, <a>Koo, H.</a>, <a>Lipford, M.</a>, <a>Campbell, E.</a>, <a>Xu, Y.</a>, <a>Baba, S.</a> and <a>E. Jaques</a>, "<a href="http://tools.ietf.org/html/rfc2989">Criteria for Evaluating AAA Protocols for Network Access</a>", RFC 2989, November 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4072">[RFC4072]</b></td>
<td class="top">
<a>Eronen, P.</a>, <a>Hiller, T.</a> and <a>G. Zorn</a>, "<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>", RFC 4072, August 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3580">[RFC3580]</b></td>
<td class="top">
<a>Congdon, P.</a>, <a>Aboba, B.</a>, <a>Smith, A.</a>, <a>Zorn, G.</a> and <a>J. Roese</a>, "<a href="http://tools.ietf.org/html/rfc3580">IEEE 802.1X Remote Authentication Dial In User Service (RADIUS) Usage Guidelines</a>", RFC 3580, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4301">[RFC4301]</b></td>
<td class="top">
<a>Kent, S.</a> and <a>K. Seo</a>, "<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>", RFC 4301, December 2005.</td>
</tr>
<tr>
<td class="reference"><b id="AppleTalk">[AppleTalk]</b></td>
<td class="top">
<a>Sidhu, G.</a>, <a>Andrews, R.F.</a> and <a>A.B. Oppenheimer</a>, "<a>Inside AppleTalk</a>", Second Edition Apple Computer, 1990.</td>
</tr>
<tr>
<td class="reference"><b id="ARAP">[ARAP]</b></td>
<td class="top">
<a>Apple Computer</a>, "<a>Apple Remote Access Protocol (ARAP) Version 2.0 External Reference Specification</a>", R0612LL/B , September 1994.</td>
</tr>
<tr>
<td class="reference"><b id="IPX">[IPX]</b></td>
<td class="top">
<a>Novell, Inc.</a>, "<a>NetWare System Technical Interface Overview</a>",  #883-000780-001, June 1989.</td>
</tr>
<tr>
<td class="reference"><b id="LAT">[LAT]</b></td>
<td class="top">
<a>Digital Equipment Corp.</a>, "<a>Local Area Transport (LAT) Specification V5.0</a>",  AA-NL26A-TE, June 1989.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2474">[RFC2474]</b></td>
<td class="top">
<a href="mailto:kmn@cisco.com" title="Cisco Systems">Nichols, K.</a>, <a href="mailto:slblake@torrentnet.com" title="Torrent Networking Technologies">Blake, S.</a>, <a href="mailto:fred@cisco.com" title="Cisco Systems">Baker, F.</a> and <a href="mailto:black_david@emc.com" title="EMC Corporation">D.L. Black</a>, "<a href="http://tools.ietf.org/html/rfc2474">Definition of the Differentiated Services Field (DS Field) in the IPv4 and IPv6 Headers</a>", RFC 2474, December 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2597">[RFC2597]</b></td>
<td class="top">
<a href="mailto:jh@telia.fi" title="Telia Finland">Heinanen, J.</a>, <a href="mailto:fred@cisco.com" title="Cisco Systems">Baker, F.</a>, <a href="mailto:wweiss@lucent.com" title="Lucent Technologies">Weiss, W.</a> and <a href="mailto:jtw@lcs.mit.edu" title="MIT Laboratory for Computer Science">J. Wroclawski</a>, "<a href="http://tools.ietf.org/html/rfc2597">Assured Forwarding PHB Group</a>", RFC 2597, June 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3246">[RFC3246]</b></td>
<td class="top">
<a>Davie, B.</a>, <a>Charny, A.</a>, <a>Bennet, J.C.R.</a>, <a>Benson, K.</a>, <a>Le Boudec, J.Y.</a>, <a>Courtney, W.</a>, <a>Davari, S.</a>, <a>Firoiu, V.</a> and <a>D. Stiliadis</a>, "<a href="http://tools.ietf.org/html/rfc3246">An Expedited Forwarding PHB (Per-Hop Behavior)</a>", RFC 3246, March 2002.</td>
</tr>
<tr>
<td class="reference"><b id="ISO.8859-1.1987">[ISO.8859-1.1987]</b></td>
<td class="top">
<a>International Organization for Standardization</a>, "<a>Information technology - 8-bit single byte coded graphic - character sets - Part 1: Latin alphabet No. 1, JTC1/SC2</a>", ISO Standard 8859-1, 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1661">[RFC1661]</b></td>
<td class="top">
<a href="mailto:Bill.Simpson@um.cc.umich.edu" title="Daydreamer, Computer Systems Consulting Services">Simpson, W.</a>, "<a href="http://tools.ietf.org/html/rfc1661">The Point-to-Point Protocol (PPP)</a>", STD 51, RFC 1661, July 1994.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1334">[RFC1334]</b></td>
<td class="top">
<a href="mailto:brian@lloyd.com" title="Lloyd &amp; Associates">Lloyd, B.</a> and <a href="mailto:Bill.Simpson@um.cc.umich.edu" title="Daydreamer Computer Systems Consulting Services">W.A. Simpson</a>, "<a href="http://tools.ietf.org/html/rfc1334">PPP Authentication Protocols</a>", RFC 1334, October 1992.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3931">[RFC3931]</b></td>
<td class="top">
<a>Lau, J.</a>, <a>Townsley, M.</a> and <a>I. Goyret</a>, "<a href="http://tools.ietf.org/html/rfc3931">Layer Two Tunneling Protocol - Version 3 (L2TPv3)</a>", RFC 3931, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1990">[RFC1990]</b></td>
<td class="top">
<a href="mailto:sklower@CS.Berkeley.EDU" title="University of California,  Berkeley, Computer Science Department">Sklower, K.</a>, <a href="mailto:brian@lloyd.com" title="Lloyd Internetworking">Lloyd, B.</a>, <a href="mailto:glenn@lloyd.com" title="Lloyd Internetworking">McGregor, G.</a>, <a href="mailto:dcarr@Newbridge.COM" title="Newbridge Networks Corporation">Carr, D.</a> and <a href="mailto:70761.1664@compuserve.com" title="Sidewalk Software">T. Coradetti</a>, "<a href="http://tools.ietf.org/html/rfc1990">The PPP Multilink Protocol (MP)</a>", RFC 1990, August 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2637">[RFC2637]</b></td>
<td class="top">
<a href="mailto:kory@ascend.com" title="Ascend Communications">Hamzeh, K.</a>, <a href="mailto:gurdeep@microsoft.com" title="Microsoft Corporation">Pall, G.</a>, <a title="U.S. Robotics/3Com">Verthein, W.</a>, <a title="Copper Mountain Networks">Taarud, J.</a>, <a title="ECI Telematics">Little, W.</a> and <a href="mailto:glennz@microsoft.com" title="Microsoft Corporation">G. Zorn</a>, "<a href="http://tools.ietf.org/html/rfc2637">Point-to-Point Tunneling Protocol</a>", RFC 2637, July 1999.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> Acknowledgements</h1>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> RFC 4005</h1>
<p id="rfc.section.Appendix A.1.p.1">The authors would like to thank Carl Rigney, Allan C. Rubens, William Allen Simpson, and Steve Willens for their work on the original RADIUS protocol, from which many of the concepts in this specification were derived.  Thanks, also, to Carl Rigney for <a href="#RFC2866">[RFC2866]</a> and <a href="#RFC2869">[RFC2869]</a>; Ward Willats for <a href="#RFC2869">[RFC2869]</a>; Glen Zorn, Bernard Aboba, and Dave Mitton for <a href="#RFC2867">[RFC2867]</a> and <a href="#RFC3162">[RFC3162]</a>; and Dory Leifer, John Shriver, Matt Holdrege, Allan Rubens, Glen Zorn and Ignacio Goyret for their work on <a href="#RFC2868">[RFC2868]</a>.  This document stole text and concepts from both <a href="#RFC2868">[RFC2868]</a> and <a href="#RFC2869">[RFC2869]</a>.  Thanks go to Carl Williams for providing IPv6-specific text.  <br><br> The authors would also like to acknowledge the following people for their contributions in the development of the Diameter protocol: Bernard Aboba, Jari Arkko, William Bulley, Kuntal Chowdhury, Daniel C. Fox, Lol Grant, Nancy Greene, Jeff Hagg, Peter Heitman, Paul Krumviede, Fergal Ladley, Ryan Moats, Victor Muslin, Kenneth Peirce, Sumit Vakil, John R. Vollbrecht, and Jeff Weisberg.  <br><br> Finally, Pat Calhoun would like to thank Sun Microsystems, as most of the effort put into this document was done while he was in their employ.  </p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> RFC 4005bis</h1>
<p id="rfc.section.Appendix A.2.p.1">The vast majority of the text in this document was lifted directly from RFC 4005; the editor owes a debt of gratitude to the authors thereof (especially Dave Mitton, who somehow managed to make nroff paginate the AVP Occurance Tables correctly!).  <br><br> Thanks (in no particular order) to Jai-Jin Lim, Liu Hans, Sebastien Decugis, Jouni Korhonen and Stefan Winter for their useful reviews and helpful comments.  </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Glen Zorn</span> 
	  <span class="n hidden">
		<span class="family-name">Zorn</span>
	  </span>
	</span>
	<span class="org vcardline">Network Zen</span>
	<span class="adr">
	  <span>227/358 Thanon Sanphawut</span>

	  <span class="vcardline">
		<span class="locality">Bang Na</span>,  
		<span class="region">Bangkok</span> 
		<span class="code">10260</span>
	  </span>
	  <span class="country-name vcardline">Thailand</span>
	</span>
	<span class="vcardline">Phone: +66 (0) 87-040-4617</span>

<span class="vcardline">EMail: <a href="mailto:gwz@net-zen.net">gwz@net-zen.net</a></span>

  </address>
</div>

</body>
</html>