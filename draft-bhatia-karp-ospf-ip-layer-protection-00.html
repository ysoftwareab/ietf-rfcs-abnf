<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Mechanism to protect OSPFv2 authentication 
    from IP Layer Issues</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Mechanism to protect OSPFv2 authentication 
    from IP Layer Issues">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">KARP Working Group</td><td class="header">M. Bhatia</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Alcatel-Lucent</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">October 7, 2010</td></tr>
<tr><td class="header">Expires: April 10, 2011</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Mechanism to protect OSPFv2 authentication 
    from IP Layer Issues<br />draft-bhatia-karp-ospf-ip-layer-protection-00</h1>

<h3>Abstract</h3>

<p>The IP header is not covered by the MAC in the cryptographic authentication scheme  
      as described in RFC 2328 and RFC 5709, and an attack can be made to exploit  
      this omission. This draft proposes a simple change in how the authentication
      is computed to eliminate most of such attacks.
      
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on April 10, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in RFC2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>When used in lower case, these words convey their typical use in
        common language, and are not to be interpreted as described in RFC2119
        <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor1"></a><br /><hr />
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The OSPFv2 <a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> cryptographic 
    authentication as described in <a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> and 
   later updated in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a> does not include the IP
   header.  This can be exploited to launch several attacks as the source address 
  in the IP header is no longer protected. The OSPF specification,  in certain cases, requires the implementations to 
  look at the source address carried in the IP header to determine the neighbor the 
packet was recieved from. Changing the source address of a packet
   can thus, confuse the reciever which can be exploited to produce a number of denial of service attacks. 
<a class='info' href='#I-D.ietf-opsec-routing-protocols-crypto-issues'>[I&#8209;D.ietf&#8209;opsec&#8209;routing&#8209;protocols&#8209;crypto&#8209;issues]<span> (</span><span class='info'>Jaeggli, J., Hares, S., Bhatia, M., Manral, V., and R. White, &ldquo;Issues with existing Cryptographic Protection Methods for Routing Protocols,&rdquo; August&nbsp;2010.</span><span>)</span></a>.  If the packet is
   interpreted as coming from a different neighbor, the sequence number
   received from the neighbor may be updated.  This may disrupt
   communication with the legitimate neighbor.  Hello packets may be
   reflected to cause a neighbor to appear to have one-way
   communication.  Old Database descriptions may be reflected in cases
   where the per-packet sequence numbers are sufficiently divergent in
   order to disrupt an adjacency <a class='info' href='#I-D.hartman-ospf-analysis'>[I&#8209;D.hartman&#8209;ospf&#8209;analysis]<span> (</span><span class='info'>Hartman, S. and D. Zhang, &ldquo;Analysis of OSPF Security According to KARP Design Guide,&rdquo; June&nbsp;2010.</span><span>)</span></a>.
   
</p>
<p>
	<a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> states that implementations MUST offer keyed MD5 
   authentication. It is likely that this will be deprecated in favor of  the stronger algorithms
   described in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a> in future deployments.

</p>
<p>
	This draft proposes a simple change in the cryptographic authentication 
	mechanism, as currently described in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>,
    to prevent such IP layer attacks.
  
</p>
<a name="anchor2"></a><br /><hr />
<a name="rfc.section.2"></a><h3>2.&nbsp;
Cryptographic Authentication Mechanism in OSPFv2</h3>

<p>
	The overall cryptographic authentication process defined in 
 <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a> remains unchanged.
To reduce the potential for confusion, this section
   minimises the repetition of text from RFC 5709 and is
   incorporated here by reference  <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>. 
</p>
<p>RFC 5709, Section 3.3, describes how the cryptographic authentication
   must be computed. It requires OSPFv2 packet's Authentication Trailer 
	 (which is the appendage described in RFC 2328, Section D.4.3, Page 233, items
       (6)(a) and (6)(d)) to be filled with the value Apad where Apad is a 
	hexadecimal constant value 0x878FE1F3 repeated (L/4) times, where L is the length
	of the hash being used and is measured in octets rather than bits.
   
</p>
<a name="anchor3"></a><br /><hr />
<a name="rfc.section.3"></a><h3>3.&nbsp;
Proposed Enhancement</h3>

<p>
	
	This document updates the definition of  Apad which is currently a constant defined in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>  to
    the source address thats carried in the IP header of the OSPFv2 protocol packet. Routers at the sending side 
    must initialize Apad to a value of the source address that would be used when sending out the OSPFv2 packet, repeated 
   L/4 times, where L is the length of the hash, measured in octets.

The basic idea is to incorporate the source address
   from the IP header in the cryptographic authentication computation so that
  any change there can be detected.
</p>
<p>

   At the recieving end implementations MUST initialize Apad as the source
  address that exists in the IP Header of the incoming OSPFv2 protocol packet, repeated L/4 times, instead 
  of the constant that's currently defined in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>.

 Besides changing the value of Apad this document does not introduce any other
 changes to the authentication mechanism described in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>.



 
<p> This would prevent all attacks where a rogue OSPF router changes
 the source address of  the protocol packet  and reflects it on some other
 interface as the authentication check would fail and all such packets would get
rejected.

</p>


<a name="Security"></a><br /><hr />
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>This document enhances the security of OSPFv2 and provides a solution
           to prevent certain denial of service attacks that can be launched by changing
         the source address of the OSPFv2 protocol packet. The proposal defined  
       does not introduce any new  security concerns.
</p>
<a name="IANA"></a><br /><hr />
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA.
</p>
<a name="Acknowledgements"></a><br /><hr />
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p>
     
</p>
<a name="rfc.references"></a><br /><hr />
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2328">[RFC2328]</a></td>
<td class="author-text"><a href="mailto:jmoy@casc.com">Moy, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2328">OSPF Version 2</a>,&rdquo; STD&nbsp;54, RFC&nbsp;2328, April&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2328.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2328.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2328.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5709">[RFC5709]</a></td>
<td class="author-text">Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;<a href="http://tools.ietf.org/html/rfc5709">OSPFv2 HMAC-SHA Cryptographic Authentication</a>,&rdquo; RFC&nbsp;5709, October&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5709.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.hartman-ospf-analysis">[I-D.hartman-ospf-analysis]</a></td>
<td class="author-text">Hartman, S. and D. Zhang, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-hartman-ospf-analysis-01.txt">Analysis of OSPF Security According to KARP Design Guide</a>,&rdquo; draft-hartman-ospf-analysis-01 (work in progress), June&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-hartman-ospf-analysis-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-opsec-routing-protocols-crypto-issues">[I-D.ietf-opsec-routing-protocols-crypto-issues]</a></td>
<td class="author-text">Jaeggli, J., Hares, S., Bhatia, M., Manral, V., and R. White, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-opsec-routing-protocols-crypto-issues-07.txt">Issues with existing Cryptographic Protection Methods for Routing Protocols</a>,&rdquo; draft-ietf-opsec-routing-protocols-crypto-issues-07 (work in progress), August&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-opsec-routing-protocols-crypto-issues-07.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Manav Bhatia</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bangalore,   </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">India</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:manav.bhatia@alcatel-lucent.com">manav.bhatia@alcatel-lucent.com</a></td></tr>
</table>
</body></html>
