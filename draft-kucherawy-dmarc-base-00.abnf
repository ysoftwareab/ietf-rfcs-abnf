dmarc-uri = URI [ "!" 1*DIGIT [ "k" / "m" / "g" / "t" ] ]
               ; "URI" is imported from [URI]; commas (ASCII 0x2c)
               ; and exclamation points (ASCII 0x21) MUST be encoded

dmarc-record = dmarc-version dmarc-sep
                    [dmarc-request]
                    [dmarc-sep dmarc-srequest]
                    [dmarc-sep dmarc-auri]
                    [dmarc-sep dmarc-furi]
                    [dmarc-sep dmarc-adkim]
                    [dmarc-sep dmarc-aspf]
                    [dmarc-sep dmarc-ainterval]
                    [dmarc-sep dmarc-rfmt]
                    [dmarc-sep dmarc-percent]
                    [dmarc-sep]
                    ; components other than dmarc-version and
                    ; dmarc-request may appear in any order

dmarc-version = "v" *WSP "=DMARC1"

dmarc-sep = *WSP %3b *WSP

dmarc-request = "p" *WSP "=" *WSP ( "none" /
                                          "quarantine" / "reject" )

dmarc-srequest = "sp" *WSP "=" *WSP ( "none" /
                                           "quarantine" / "reject" )

dmarc-auri = "rua" *WSP "=" *WSP
                  dmarc-uri *(*WSP "," *WSP dmarc-uri)

dmarc-ainterval = "ri" *WSP "=" *WSP 1*DIGIT

dmarc-furi = "ruf" *WSP "=" *WSP
                  dmarc-uri *(*WSP "," *WSP dmarc-uri)

dmarc-rfmt = "rf" *WSP "=" *WSP
                  ( "afrf" / "iodef" )

dmarc-percent = "pct" *WSP "=" *WSP
                     1*3DIGIT

dmarc-adkim = "adkim"  *WSP "=" *WSP
                   ( "r" / "s" )

dmarc-aspf = "aspf" *WSP "=" *WSP
                  ( "r" / "s" )
id-align = "Identity-Alignment:" [CFWS]
                ( "none" / dmarc-method
                           *( [CFWS] "," [CFWS] dmarc-method ) )
                [CFWS]

dmarc-method = ( "dkim" / "spf" )
                  ; each may appear at most once in an id-align

filename = receiver "!" policy-domain "!" begin-timestamp "!"
                end-timestamp [ "!" unique-id ] "." extension

unique-id = token
              ; "token" is imported from [MIME]

receiver = domain
              ; imported from [MAIL]

policy-domain = domain

begin-timestamp = 1*DIGIT
                     ; seconds since 00:00:00 UTC January 1, 1970
                     ; indicating start of the time range contained
                     ; in the report

end-timestamp = 1*DIGIT
                   ; seconds since 00:00:00 UTC January 1, 1970
                   ; indicating end of the time range contained
                   ; in the report

extension = "xml" / "gzip"

dmarc-subject = %x52.65.70.6f.72.74 1*FWS    ; "Report"
                     %x44.6f.6d.61.69.6e.3a 1*FWS ; "Domain:"
                     domain-name 1*FWS            ; from RFC6376
                     %x53.75.62.6d.69.74.74.65.72.3a ; "Submitter:"
                     1*FWS domain-name 1*FWS
                     %x52.65.70.6f.72.74.2d.49.44.3a ; "Report-ID:"
                     msg-id                       ; from RFC5322

ruf=mailto:auth-reports@example.com"

ruf=mailto:auth-reports@thirdparty.example.net"

rua=mailto:dmarc-feedback@example.com"

rua=mailto:dmarc-feedback@example.com,
rua=mailto:dmarc-feedback@example.com"

boundary="----=_NextPart_000_024E_01CC9B0A.AFE54C00"
filename="mail.receiver.example!example.com!
                   1013662812!1013749130.gz"

targetNamespace="http://dmarc.org/dmarc-xml/0.1">

minOccurs="0"/>
maxOccurs="unbounded"/>
minOccurs="0"/>
minOccurs="0" maxOccurs="unbounded"/>
type="PolicyEvaluatedType"
minOccurs="0"/>
minOccurs="0"/>
minOccurs="1"/>
minOccurs="1"/>
minOccurs="1"/>
minOccurs="0"/>
minOccurs="1"/>
minOccurs="0"/>
minOccurs="1"/>
minOccurs="0" maxOccurs="unbounded"/>
maxOccurs="unbounded"/>
type="xs:decimal"/>
type="ReportMetadataType"/>
type="PolicyPublishedType"/>
maxOccurs="unbounded"/>
