<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DNAME Redirection in the DNS </title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 The DNAME Resource Record">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Format">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 The DNAME Substitution">
<link href="#rfc.section.2.3" rel="Chapter" title="2.3 DNAME Owner Name Matching the QNAME">
<link href="#rfc.section.2.4" rel="Chapter" title="2.4 Names Next to and Below a DNAME Record">
<link href="#rfc.section.2.5" rel="Chapter" title="2.5 Compression of the DNAME record.">
<link href="#rfc.section.3" rel="Chapter" title="3 Processing">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 CNAME synthesis">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Server algorithm">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Wildcards">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Acceptance and Intermediate Storage">
<link href="#rfc.section.3.4.1" rel="Chapter" title="3.4.1 Resolver Algorithm">
<link href="#rfc.section.4" rel="Chapter" title="4 DNAME Discussions in Other Documents">
<link href="#rfc.section.5" rel="Chapter" title="5 Other Issues with DNAME">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Canonical hostnames cannot be below DNAME owners">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Dynamic Update and DNAME">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 DNSSEC and DNAME">
<link href="#rfc.section.5.3.1" rel="Chapter" title="5.3.1 Signed DNAME, Unsigned Synthesized CNAME">
<link href="#rfc.section.5.3.2" rel="Chapter" title="5.3.2 DNAME Bit in NSEC Type Map">
<link href="#rfc.section.5.3.3" rel="Chapter" title="5.3.3 DNAME Chains as Strong as the Weakest Link">
<link href="#rfc.section.5.3.4" rel="Chapter" title="5.3.4 Validators Must Understand DNAME">
<link href="#rfc.section.5.3.4.1" rel="Chapter" title="5.3.4.1 DNAME in Bitmap Causes Invalid Name Error">
<link href="#rfc.section.5.3.4.2" rel="Chapter" title="5.3.4.2 Valid Name Error Response Involving DNAME in Bitmap">
<link href="#rfc.section.5.3.4.3" rel="Chapter" title="5.3.4.3 Response With Synthesized CNAME">
<link href="#rfc.section.6" rel="Chapter" title="6 Examples of DNAME Use in a Zone">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Organizational Renaming">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Classless Delegation of Shorter Prefixes">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Network Renumbering Support">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgments">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Changes from RFC 2672">
<link href="#rfc.appendix.Appendix%20A.1" rel="Chapter" title="Appendix A.1 Changes to Server Behavior">
<link href="#rfc.appendix.Appendix%20A.2" rel="Chapter" title="Appendix A.2 Changes to Client Behavior">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The DNAME record provides redirection for a sub-tree of the domain name tree in the DNS system. That is, all names that end with a particular suffix are redirected to another part of the DNS.  This is a revision to the original specification in RFC 2672 (which this document obsoletes) as well as updating RFC 3363 and RFC 4294 to align with this revision.  " />
  <meta name="description" content="The DNAME record provides redirection for a sub-tree of the domain name tree in the DNS system. That is, all names that end with a particular suffix are redirected to another part of the DNS.  This is a revision to the original specification in RFC 2672 (which this document obsoletes) as well as updating RFC 3363 and RFC 4294 to align with this revision.  " />
  <meta name="keywords" content="DNS, DNAME" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">DNS Extensions Working Group</td>
<td class="right">S. Rose</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">NIST</td>
</tr>
<tr>
<td class="left">Updates: 3363,4294 (if approved)</td>
<td class="right">W.C.A. Wijngaards</td>
</tr>
<tr>
<td class="left">Obsoletes: 2672 (if approved)</td>
<td class="right">NLnet Labs</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">November 14, 2011</td>
</tr>
<tr>
<td class="left">Expires: May 17, 2012</td>
<td class="right"></td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DNAME Redirection in the DNS <br />
  <span class="filename">draft-ietf-dnsext-rfc2672bis-dname-25</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The DNAME record provides redirection for a sub-tree of the domain name tree in the DNS system. That is, all names that end with a particular suffix are redirected to another part of the DNS.  This is a revision to the original specification in RFC 2672 (which this document obsoletes) as well as updating RFC 3363 and RFC 4294 to align with this revision.  </p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED" "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.  </p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on May 17, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">The DNAME Resource Record</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Format</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">The DNAME Substitution</a>
</li>
<li>2.3.   <a href="#rfc.section.2.3">DNAME Owner Name Matching the QNAME</a>
</li>
<li>2.4.   <a href="#rfc.section.2.4">Names Next to and Below a DNAME Record</a>
</li>
<li>2.5.   <a href="#rfc.section.2.5">Compression of the DNAME record.</a>
</li>
<li>3.   <a href="#rfc.section.3">Processing</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">CNAME synthesis</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Server algorithm</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Wildcards</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Acceptance and Intermediate Storage</a>
</li>
<li>3.4.1.   <a href="#rfc.section.3.4.1">Resolver Algorithm</a>
</li>
<li>4.   <a href="#rfc.section.4">DNAME Discussions in Other Documents</a>
</li>
<li>5.   <a href="#rfc.section.5">Other Issues with DNAME</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Canonical hostnames cannot be below DNAME owners</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Dynamic Update and DNAME</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">DNSSEC and DNAME</a>
</li>
<li>5.3.1.   <a href="#rfc.section.5.3.1">Signed DNAME, Unsigned Synthesized CNAME</a>
</li>
<li>5.3.2.   <a href="#rfc.section.5.3.2">DNAME Bit in NSEC Type Map</a>
</li>
<li>5.3.3.   <a href="#rfc.section.5.3.3">DNAME Chains as Strong as the Weakest Link</a>
</li>
<li>5.3.4.   <a href="#rfc.section.5.3.4">Validators Must Understand DNAME</a>
</li>
<li>5.3.4.1.   <a href="#rfc.section.5.3.4.1">DNAME in Bitmap Causes Invalid Name Error</a>
</li>
<li>5.3.4.2.   <a href="#rfc.section.5.3.4.2">Valid Name Error Response Involving DNAME in Bitmap</a>
</li>
<li>5.3.4.3.   <a href="#rfc.section.5.3.4.3">Response With Synthesized CNAME</a>
</li>
<li>6.   <a href="#rfc.section.6">Examples of DNAME Use in a Zone</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Organizational Renaming</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Classless Delegation of Shorter Prefixes</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">Network Renumbering Support</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgments</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Changes from RFC 2672</a>
</li>
<li>Appendix A.1.   <a href="#rfc.appendix.Appendix%20A.1">Changes to Server Behavior</a>
</li>
<li>Appendix A.2.   <a href="#rfc.appendix.Appendix%20A.2">Changes to Client Behavior</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">DNAME is a DNS Resource Record type originally defined in RFC 2672 <a href="#RFC2672">[RFC2672]</a>. DNAME provides redirection from a part of the DNS name tree to another part of the DNS name tree.  </p>
<p id="rfc.section.1.p.2">The DNAME RR and the CNAME RR <a href="#RFC1034">[RFC1034]</a> cause a lookup to (potentially) return data corresponding to a domain name different from the queried domain name.  The difference between the two resource records is that the CNAME RR directs the lookup of data at its owner to another single name, a DNAME RR directs lookups for data at descendants of its owner's name to corresponding names under a different (single) node of the tree.  </p>
<p id="rfc.section.1.p.3">Take for example, looking through a zone (see <a href="#RFC1034">RFC 1034</a> <cite title="NONE">[RFC1034]</cite>, section 4.3.2, step 3) for the domain name "foo.example.com" and a DNAME resource record is found at "example.com" indicating that all queries under "example.com" be directed to "example.net".  The lookup process will return to step 1 with the new query name of "foo.example.net".  Had the query name been "www.foo.example.com" the new query name would be "www.foo.example.net".  </p>
<p id="rfc.section.1.p.4">This document is a revision of the original specification of DNAME in <a href="#RFC2672">RFC 2672</a> <cite title="NONE">[RFC2672]</cite>.  DNAME was conceived to help with the problem of maintaining address-to-name mappings in a context of network renumbering.  With a careful set-up, a renumbering event in the network causes no change to the authoritative server that has the address-to-name mappings.  Examples in practice are classless reverse address space delegations.  </p>
<p id="rfc.section.1.p.5">Another usage of DNAME lies in aliasing of name spaces. For example, a zone administrator may want sub-trees of the DNS to contain the same information.  Examples include punycode alternates for domain spaces.  </p>
<p id="rfc.section.1.p.6">This revision of the DNAME specification does not change the wire format or the handling of DNAME Resource Records.  Discussion is added on problems that may be encountered when using DNAME.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> The DNAME Resource Record</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Format</h1>
<p id="rfc.section.2.1.p.1">The DNAME RR has mnemonic DNAME and type code 39 (decimal).  It is not class-sensitive.  </p>
<div id="#rfc.figure.1"></div>
<p></p>

<p>Its RDATA is comprised of a single field, &lt;target&gt;, which contains a fully qualified domain name that MUST be sent in uncompressed form <a href="#RFC1035">[RFC1035]</a>, <a href="#RFC3597">[RFC3597]</a>.  The &lt;target&gt; field MUST be present.  The presentation format of &lt;target&gt; is that of a domain name <a href="#RFC1035">[RFC1035]</a>.  </p>
<pre>
        &lt;owner&gt; &lt;ttl&gt; &lt;class&gt; DNAME &lt;target&gt;
  	</pre>
<p>The effect of the DNAME RR is the substitution of the record's &lt;target&gt; for its owner name, as a suffix of a domain name. This substitution is to be applied for all names below the owner name of the DNAME RR.  This substitution has to be applied for every DNAME RR found in the resolution process, which allows fairly lengthy valid chains of DNAME RRs.  </p>
<p id="rfc.section.2.1.p.3">Details of the substitution process, methods to avoid conflicting resource records, and rules for specific corner cases are given in the following subsections.  </p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> The DNAME Substitution</h1>
<p id="rfc.section.2.2.p.1">When following RFC 1034 <a href="#RFC1034">[RFC1034]</a>, section 4.3.2's algorithm's third step, "start matching down, label by label, in the zone" and a node is found to own a DNAME resource record a DNAME substitution occurs.  The name being sought may be the original query name or a name that is the result of a CNAME resource record being followed or a previously encountered DNAME.  As in the case when finding a CNAME resource record or NS resource record set, the processing of a DNAME will happen prior to finding the desired domain name.  </p>
<p id="rfc.section.2.2.p.2">A DNAME substitution is performed by replacing the suffix labels of the name being sought matching the owner name of the DNAME resource record with the string of labels in the RDATA field.  The matching labels end with the root label in all cases.  Only whole labels are replaced. See the table of examples for common cases and corner cases.  </p>
<div id="#rfc.figure.2"></div>
<p></p>

<p>In the table below, the QNAME refers to the query name. The owner is the DNAME owner domain name, and the target refers to the target of the DNAME record. The result is the resulting name after performing the DNAME substitution on the query name.  "no match" means that the query did not match the DNAME and thus no substitution is performed and a possible error message is returned (if no other result is possible).  Thus every line contains one example substitution.  In the examples below, 'cyc' and 'shortloop' contain loops.  </p>
<pre>
 QNAME            owner  DNAME   target         result
 ---------------- -------------- -------------- -----------------
 com.             example.com.   example.net.   &lt;no match&gt;
 example.com.     example.com.   example.net.   [0]
 a.example.com.   example.com.   example.net.   a.example.net.
 a.b.example.com. example.com.   example.net.   a.b.example.net.
 ab.example.com.  b.example.com. example.net.   &lt;no match&gt;
 foo.example.com. example.com.   example.net.   foo.example.net.
 a.x.example.com. x.example.com. example.net.   a.example.net.
 a.example.com.   example.com.   y.example.net. a.y.example.net.
 cyc.example.com. example.com.   example.com.   cyc.example.com.
 cyc.example.com. example.com.   c.example.com. cyc.c.example.com.
 shortloop.x.x.   x.             .              shortloop.x.
 shortloop.x.     x.             .              shortloop.

[0] The result depends on the QTYPE.  If the QTYPE = DNAME, then 
    the result is "example.com." else "&lt;no match&gt;"
  	</pre>
<p></p>
<p id="rfc.section.2.2.p.4">It is possible for DNAMEs to form loops, just as CNAMEs can form loops. DNAMEs and CNAMEs can chain together to form loops. A single corner case DNAME can form a loop. Resolvers and servers should be cautious in devoting resources to a query, but be aware that fairly long chains of DNAMEs may be valid.  Zone content administrators should take care to insure that there are no loops that could occur when using DNAME or DNAME/CNAME redirection.  </p>
<p id="rfc.section.2.2.p.5">The domain name can get too long during substitution. For example, suppose the target name of the DNAME RR is 250 octets in length (multiple labels), if an incoming QNAME that has a first label over 5 octets in length, the result would be a name over 255 octets.  If this occurs the server returns an RCODE of YXDOMAIN <a href="#RFC2136">[RFC2136]</a>. The DNAME record and its signature (if the zone is signed) are included in the answer as proof for the YXDOMAIN (value 6) RCODE.  </p>
<h1 id="rfc.section.2.3">
<a href="#rfc.section.2.3">2.3.</a> DNAME Owner Name Matching the QNAME</h1>
<p id="rfc.section.2.3.p.1">Unlike a CNAME RR, a DNAME RR redirects DNS names subordinate to its owner name; the owner name of a DNAME is not redirected itself.  The domain name that owns a DNAME record is allowed to have other resource record types at that domain name, except DNAMEs, CNAMEs or other types that have restrictions on what they can co-exist with.  When there is a match of the QTYPE to a type (or types) also owned by the owner name the response is sourced from the owner name.  E.g., a QTYPE of ANY would return the (available) types at the owner name, not the target name.  </p>
<p id="rfc.section.2.3.p.2">DNAME RRs MUST NOT appear at the same owner name as an NS RR unless the owner name is the zone apex as this would constitute data below a zone cut.  </p>
<p id="rfc.section.2.3.p.3">If a DNAME record is present at the zone apex, there is still a need to have the customary SOA and NS resource records there as well. Such a DNAME cannot be used to mirror a zone completely, as it does not mirror the zone apex.  </p>
<p id="rfc.section.2.3.p.4">These rules also allow DNAME records to be queried through RFC 1034 <a href="#RFC1034">[RFC1034]</a> compliant, DNAME-unaware caches.  </p>
<h1 id="rfc.section.2.4">
<a href="#rfc.section.2.4">2.4.</a> Names Next to and Below a DNAME Record</h1>
<p id="rfc.section.2.4.p.1">Resource records MUST NOT exist at any sub-domain of the owner of a DNAME RR.  To get the contents for names subordinate to that owner name, the DNAME redirection must be invoked and the resulting target queried.  A server MAY refuse to load a zone that has data at a sub-domain of a domain name owning a DNAME RR.  If the server does load the zone, those names below the DNAME RR will be occluded as described in RFC 2136 <a href="#RFC2136">[RFC2136]</a>, section 7.18.  Also a server SHOULD refuse to load a zone subordinate to the owner of a DNAME record in the ancestor zone.  See <a href="#dynamic">Section 5.2</a> for further discussion related to dynamic update.  </p>
<p id="rfc.section.2.4.p.2">DNAME is a singleton type, meaning only one DNAME is allowed per name.  The owner name of a DNAME can only have one DNAME RR, and no CNAME RRs can exist at that name.  These rules make sure that for a single domain name only one redirection exists, and thus no confusion which one to follow.  A server SHOULD refuse to load a zone that violates these rules.  </p>
<h1 id="rfc.section.2.5">
<a href="#rfc.section.2.5">2.5.</a> Compression of the DNAME record.</h1>
<p id="rfc.section.2.5.p.1">The DNAME owner name can be compressed like any other owner name.  The DNAME RDATA target name MUST NOT be sent out in compressed form and MUST be downcased for DNSSEC validation.  </p>
<p id="rfc.section.2.5.p.2">Although the previous DNAME specification <a href="#RFC2672">[RFC2672]</a> (that is obsoleted by this specification) talked about signaling to allow compression of the target name, such signaling has never been specified and this document also does not specify this signaling behavior.  </p>
<p id="rfc.section.2.5.p.3">RFC 2672 (obsoleted by this document) stated that the EDNS version had a meaning for understanding of DNAME and DNAME target name compression. This document revises RFC 2672, in that there is no EDNS version signaling for DNAME. </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Processing</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#cnamesynth" id="cnamesynth">CNAME synthesis</a>
</h1>
<p id="rfc.section.3.1.p.1">When preparing a response, a server performing a DNAME substitution will in all cases include the relevant DNAME RR in the answer section. Relevant cases includes the following: </p>

<ol>
<li>The DNAME is being employed as a substitution instruction.</li>
<li>The DNAME itself matches the QTYPE and the owner name matches QNAME.</li>
</ol>
<p id="rfc.section.3.1.p.2">When the owner name name matches the QNAME and the QTYPE matches another type owned there, the DNAME is not included in the answer.  </p>
<p id="rfc.section.3.1.p.3">A CNAME RR with TTL equal to the corresponding DNAME RR is synthesized and included in the answer section when the DNAME is employed as a substitution instruction.  The owner name of the CNAME is the QNAME of the query. The DNSSEC specification <a href="#RFC4033">[RFC4033]</a>, <a href="#RFC4034">[RFC4034]</a>, <a href="#RFC4035">[RFC4035]</a> says that the synthesized CNAME does not have to be signed.  The signed DNAME has an RRSIG and a validating resolver can check the CNAME against the DNAME record and validate the signature over the DNAME RR.  </p>
<p id="rfc.section.3.1.p.4">Servers MUST be able to answer a query for a synthesized CNAME. Like other query types this invokes the DNAME, and then the server synthesizes the CNAME and places it into the answer section. If the server in question is a cache, the synthesized CNAME's TTL SHOULD be equal to the decremented TTL of the cached DNAME.  </p>
<p id="rfc.section.3.1.p.5">Resolvers MUST be able to handle a synthesized CNAME TTL of zero or equal to the TTL of the corresponding DNAME record (as some older authoritative server implementations set the TTL of synthesized CNAMEs to zero). A TTL of zero means that the CNAME can be discarded immediately after processing the answer.  </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Server algorithm</h1>
<p id="rfc.section.3.2.p.1">Below is the server algorithm, which appeared in RFC 2672 Section 4.1.  </p>
<p></p>

<ol>
<li>Set or clear the value of recursion available in the response depending on whether the name server is willing to provide recursive service.  If recursive service is available and requested via the RD bit in the query, go to step 5, otherwise step 2.  <br><br> </li>
<li>Search the available zones for the zone which is the nearest ancestor to QNAME.  If such a zone is found, go to step 3, otherwise step 4.  <br><br> </li>
<li>Start matching down, label by label, in the zone.  The matching process can terminate several ways: <br><br> <ol style="list-style-type: lower-alpha">
<li>If the whole of QNAME is matched, we have found the node.  <br><br> If the data at the node is a CNAME, and QTYPE does not match CNAME, copy the CNAME RR into the answer section of the response, change QNAME to the canonical name in the CNAME RR, and go back to step 1.  <br><br> Otherwise, copy all RRs which match QTYPE into the answer section and go to step 6.  <br><br> </li>
<li>If a match would take us out of the authoritative data, we have a referral.  This happens when we encounter a node with NS RRs marking cuts along the bottom of a zone.  <br><br> Copy the NS RRs for the sub-zone into the authority section of the reply.  Put whatever addresses are available into the additional section, using glue RRs if the addresses are not available from authoritative data or the cache.  Go to step 4.  <br><br> </li>
<li>If at some label, a match is impossible (i.e., the corresponding label does not exist), look to see whether the last label matched has a DNAME record.  <br><br> If a DNAME record exists at that point, copy that record into the answer section.  If substitution of its &lt;target&gt; for its &lt;owner&gt; in QNAME would overflow the legal size for a &lt;domain- name&gt;, set RCODE to YXDOMAIN <a href="#RFC2136">[RFC2136]</a> and exit; otherwise perform the substitution and continue.  The server MUST synthesize a CNAME record as described above and include it in the answer section.  Go back to step 1.  <br><br> If there was no DNAME record, look to see if the "*" label exists.  <br><br> If the "*" label does not exist, check whether the name we are looking for is the original QNAME in the query or a name we have followed due to a CNAME or DNAME.  If the name is original, set an authoritative name error in the response and exit.  Otherwise just exit.  <br><br> If the "*" label does exist, match RRs at that node against QTYPE.  If any match, copy them into the answer section, but set the owner of the RR to be QNAME, and not the node with the "*" label.  If the data at the node with the "*" label is a CNAME, and QTYPE doesn't match CNAME, copy the CNAME RR into the answer section of the response changing the owner name to the QNAME, change QNAME to the canonical name in the CNAME RR, and go back to step 1. Otherwise, Go to step 6.  <br><br> </li>
</ol>
<p> </p>
</li>
<li>Start matching down in the cache.  If QNAME is found in the cache, copy all RRs attached to it that match QTYPE into the answer section.  If QNAME is not found in the cache but a DNAME record is present at an ancestor of QNAME, copy that DNAME record into the answer section.  If there was no delegation from authoritative data, look for the best one from the cache, and put it in the authority section.  Go to step 6.  <br><br> </li>
<li>Use the local resolver or a copy of its algorithm to answer the query.  Store the results, including any intermediate CNAMEs and DNAMEs, in the answer section of the response.  <br><br> </li>
<li>Using local data only, attempt to add other RRs which may be useful to the additional section of the query.  Exit.  </li>
</ol>
<p id="rfc.section.3.2.p.3">Note that there will be at most one ancestor with a DNAME as described in step 4 unless some zone's data is in violation of the no-descendants limitation in section 3.  An implementation might take advantage of this limitation by stopping the search of step 3c or step 4 when a DNAME record is encountered.  </p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Wildcards</h1>
<p id="rfc.section.3.3.p.1">The use of DNAME in conjunction with wildcards is discouraged <a href="#RFC4592">[RFC4592]</a>.  Thus records of the form "*.example.com DNAME example.net" SHOULD NOT be used.  </p>
<p id="rfc.section.3.3.p.2">The interaction between the expansion of the wildcard and the redirection of the DNAME is non-deterministic.  Because the processing is non-deterministic, DNSSEC validating resolvers may not be able to validate a wildcarded DNAME.  </p>
<p id="rfc.section.3.3.p.3">A server MAY give a warning that the behavior is unspecified if such a wildcarded DNAME is loaded.  The server MAY refuse it, refuse to load the zone or refuse dynamic updates.  </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Acceptance and Intermediate Storage</h1>
<p id="rfc.section.3.4.p.1">Recursive caching name servers can encounter data at names below the owner name of a DNAME RR, due to a change at the authoritative server where data from before and after the change resides in the cache. This conflict situation is a transitional phase that ends when the old data times out. The caching name server can opt to store both old and new data and treat each as if the other did not exist, or drop the old data, or drop the longer domain name. In any approach, consistency returns after the older data TTL times out.  </p>
<p id="rfc.section.3.4.p.2">Recursive caching name servers MUST perform CNAME synthesis on behalf of clients. </p>
<p id="rfc.section.3.4.p.3">If a recursive caching name server encounters a DNSSEC validated DNAME RR which contradicts information already in the cache (excluding CNAME records), it SHOULD cache the DNAME RR, but it MAY cache the CNAME record received along with it, subject to the rules for CNAME. If the DNAME RR cannot be validated via DNSSEC (i.e. not BOGUS, but not able to validate), the recursive caching server SHOULD NOT cache the DNAME RR but MAY cache the CNAME record received along with it, subject to the rules of CNAME.  </p>
<h1 id="rfc.section.3.4.1">
<a href="#rfc.section.3.4.1">3.4.1.</a> Resolver Algorithm</h1>
<p id="rfc.section.3.4.1.p.1">A resolver algorithm likewise changes to handle DNAME processing.  The complete algorithm becomes: </p>

<ol>
<li>See if the answer is in local information or can be synthesized from a cached DNAME, and if so return it to the client.  <br><br> </li>
<li>Find the best servers to ask.  <br><br> </li>
<li>Send queries until one returns a response.  </li>
<li>Analyze the response, either: <br><br> <ol style="list-style-type: lower-alpha">
<li>If the response answers the question or contains a name error, cache the data as well as returning it back to the client.  <br><br> </li>
<li>If the response contains a better delegation to other servers, cache the delegation information, and go to step 2.  <br><br> </li>
<li>If the response shows a CNAME and that is not the answer itself, cache the CNAME, change the SNAME to the canonical name in the CNAME RR and go to step 1.  <br><br> </li>
<li>If the response shows a DNAME and that is not the answer itself, cache the DNAME (upon successful DNSSEC validation if the client is a validating resolver).  If substitution of the DNAME's target name for its owner name in the SNAME would overflow the legal size for a domain name, return an implementation-dependent error to the application; otherwise perform the substitution and go to step 1.  <br><br> </li>
<li>If the response shows a server failure or other bizarre contents, delete the server from the SLIST and go back to step 3.  <br><br> </li>
</ol>
</li>
</ol>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> DNAME Discussions in Other Documents</h1>
<p id="rfc.section.4.p.1">In <a href="#RFC2181">[RFC2181]</a>, in Section 10.3., the discussion on MX and NS records touches on redirection by CNAMEs, but this also holds for DNAMEs.  </p>
<div id="#rfc.figure.3"></div>
<p></p>

<p>Excerpt from 10.3. MX and NS records (in RFC 2181). </p>
<pre>
        The domain name used as the value of a NS resource record, 
        or part of the value of a MX resource record must not be 
        an alias.  Not only is the specification clear on this 
        point, but using an alias in either of these positions 
        neither works as well as might be hoped, nor well fulfills 
        the ambition that may have led to this approach.  This 
        domain name must have as its value one or more address 
        records.  Currently those will be A records, however in 
        the future other record types giving addressing 
        information may be acceptable.  It can also have other 
        RRs, but never a CNAME RR.</pre>
<p></p>
<p id="rfc.section.4.p.3">The DNAME RR is discussed in RFC 3363, section 4, on A6 and DNAME.  The opening premise of this section is demonstrably wrong, and so the conclusion based on that premise is wrong.  In particular, <a href="#RFC3363">[RFC3363]</a> deprecates the use of DNAME in the IPv6 reverse tree, which is then carried forward as a recommendation in <a href="#RFC4294">[RFC4294]</a>.  Based on the experience gained in the meantime, <a href="#RFC3363">[RFC3363]</a> is revised, dropping all constraints on having DNAME RRs in these zones.  This would greatly improve the manageability of the IPv6 reverse tree.  These changes are made explicit below.  </p>
<div id="#rfc.figure.4"></div>
<p></p>

<p>In <a href="#RFC3363">[RFC3363]</a>, the paragraph</p>
<pre>
  "The issues for DNAME in the reverse mapping tree appears to be
  closely tied to the need to use fragmented A6 in the main tree: if
  one is necessary, so is the other, and if one isn't necessary, the
  other isn't either.  Therefore, in moving RFC 2874 to experimental,
  the intent of this document is that use of DNAME RRs in the reverse
  tree be deprecated."
        </pre>
<p>is to be replaced with the word "DELETED".</p>
<div id="#rfc.figure.5"></div>
<p></p>

<p>In <a href="#RFC4294">[RFC4294]</a>, the reference to DNAME was left in as an editorial oversight.  The paragraph </p>
<pre>
  "Those nodes are NOT RECOMMENDED to support the experimental A6 and
  DNAME Resource Records [RFC3363]."</pre>
<p></p>
<div id="#rfc.figure.6"></div>
<p>is to be replaced by</p>
<pre>
  "Those nodes are NOT RECOMMENDED to support the experimental 
  A6 Resource Record [RFC3363]."</pre>
<p></p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Other Issues with DNAME</h1>
<p id="rfc.section.5.p.1">There are several issues to be aware of about the use of DNAME.  </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Canonical hostnames cannot be below DNAME owners</h1>
<p id="rfc.section.5.1.p.1">The names listed as target names of MX, NS, PTR and SRV <a href="#RFC2782">[RFC2782]</a> records must be canonical hostnames. This means no CNAME or DNAME redirection may be present during DNS lookup of the address records for the host.  This is discussed in RFC 2181 <a href="#RFC2181">[RFC2181]</a>, section 10.3, and RFC 1912 <a href="#RFC1912">[RFC1912]</a>, section 2.4.  For SRV see RFC 2782 <a href="#RFC2782">[RFC2782]</a> page 4.  </p>
<p id="rfc.section.5.1.p.2">The upshot of this is that although the lookup of a PTR record can involve DNAMEs, the name listed in the PTR record can not fall under a DNAME.  The same holds for NS, SRV and MX records.  For example, when punycode alternates for a zone use DNAME then the NS, MX, SRV and PTR records that point to that zone must use names without punycode in their RDATA.  What must be done then is to have the domain names with DNAME substitution already applied to it as the MX, NS, PTR, SRV data.  These are valid canonical hostnames.  </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> <a href="#dynamic" id="dynamic">Dynamic Update and DNAME</a>
</h1>
<p id="rfc.section.5.2.p.1">DNAME records can be added, changed and removed in a zone using dynamic update transactions.  Adding a DNAME RR to a zone occludes any domain names that may exist under the added DNAME.  </p>
<p id="rfc.section.5.2.p.2">If a dynamic update message attempts to add a DNAME with a given owner name but a CNAME is associated with that name, then the server MUST ignore the DNAME. If a DNAME is already associated with that name, then it is replaced with the new DNAME.  Otherwise, add the DNAME. If a CNAME is added with a given owner name but a DNAME is associated with that name, then the CNAME MUST be ignored.  This is similar behavior for dynamic updates to an owner name of a CNAME RR <a href="#RFC2136">[RFC2136]</a>.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> DNSSEC and DNAME</h1>
<p id="rfc.section.5.3.p.1">The following subsections specify the behavior of implementations that understand both DNSSEC and DNAME (synthesis).  </p>
<h1 id="rfc.section.5.3.1">
<a href="#rfc.section.5.3.1">5.3.1.</a> Signed DNAME, Unsigned Synthesized CNAME</h1>
<p id="rfc.section.5.3.1.p.1">In any response, a signed DNAME RR indicates a non-terminal redirection of the query.  There might or might not be a server synthesized CNAME in the answer section; if there is, the CNAME will never be signed.  For a DNSSEC validator, verification of the DNAME RR and then checking that the CNAME was properly synthesized is sufficient proof.  </p>
<h1 id="rfc.section.5.3.2">
<a href="#rfc.section.5.3.2">5.3.2.</a> DNAME Bit in NSEC Type Map</h1>
<p id="rfc.section.5.3.2.p.1">In any negative response, the NSEC or NSEC3 <a href="#RFC5155">[RFC5155]</a> record type bit map SHOULD be checked to see that there was no DNAME that could have been applied.  If the DNAME bit in the type bit map is set and the query name is a sub-domain of the closest encloser that is asserted, then DNAME substitution should have been done, but the substitution has not been done as specified.  </p>
<h1 id="rfc.section.5.3.3">
<a href="#rfc.section.5.3.3">5.3.3.</a> DNAME Chains as Strong as the Weakest Link</h1>
<p id="rfc.section.5.3.3.p.1">A response can contain a chain of DNAME and CNAME redirections.  That chain can end in a positive answer or a negative (no name error or no data error) reply.  Each step in that chain results in resource records added to the answer or authority section of the response.  Only if all steps are secure can the AD bit be set for the response.  If one of the steps is bogus, the result is bogus.  </p>
<h1 id="rfc.section.5.3.4">
<a href="#rfc.section.5.3.4">5.3.4.</a> <a href="#validname" id="validname">Validators Must Understand DNAME</a>
</h1>
<p id="rfc.section.5.3.4.p.1">Below are examples of why DNSSEC validators MUST understand DNAME.  In the examples below, SOA records, wildcard denial NSECs and other material not under discussion has been omitted or shortened.  </p>
<h1 id="rfc.section.5.3.4.1">
<a href="#rfc.section.5.3.4.1">5.3.4.1.</a> DNAME in Bitmap Causes Invalid Name Error</h1>
<div id="#rfc.figure.7"></div>
<p></p>

<p></p>
<pre>;; Header: QR AA RCODE=3(NXDOMAIN)
;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags: do; udp: 4096

;; Question
foo.bar.example.com. IN A
;; Authority
bar.example.com. NSEC dub.example.com. A DNAME
bar.example.com. RRSIG NSEC [valid signature] 
  	</pre>
<p></p>
<p id="rfc.section.5.3.4.1.p.2">If this is the received response, then only by understanding that the DNAME bit in the NSEC bitmap means that foo.bar.example.com needed to have been redirected by the DNAME, the validator can see that it is a BOGUS reply from an attacker that collated existing records from the DNS to create a confusing reply.  </p>
<p id="rfc.section.5.3.4.1.p.3">If the DNAME bit had not been set in the NSEC record above then the answer would have validated as a correct name error response.  </p>
<h1 id="rfc.section.5.3.4.2">
<a href="#rfc.section.5.3.4.2">5.3.4.2.</a> Valid Name Error Response Involving DNAME in Bitmap</h1>
<div id="#rfc.figure.8"></div>
<p></p>

<p></p>
<pre>;; Header: QR AA RCODE=3(NXDOMAIN)
;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags: do; udp: 4096

;; Question
cee.example.com. IN A
;; Authority
bar.example.com. NSEC dub.example.com. A DNAME
bar.example.com. RRSIG NSEC [valid signature] 
  	</pre>
<p></p>
<h1 id="rfc.section.5.3.4.3">
<a href="#rfc.section.5.3.4.3">5.3.4.3.</a> Response With Synthesized CNAME</h1>
<div id="#rfc.figure.9"></div>
<p></p>

<p></p>
<pre>;; Header: QR AA RCODE=0(NOERROR)
;; OPT PSEUDOSECTION:
; EDNS: version: 0, flags: do; udp: 4096

;; Question
foo.bar.example.com. IN A
;; Answer
bar.example.com. DNAME bar.example.net.
bar.example.com. RRSIG DNAME [valid signature] 
foo.bar.example.com. CNAME foo.bar.example.net.
  	</pre>
<p></p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#example" id="example">Examples of DNAME Use in a Zone</a>
</h1>
<p id="rfc.section.6.p.1">Below are some examples of the use of DNAME in a zone.  These examples are by no means exhaustive.  </p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Organizational Renaming</h1>
<div id="#rfc.figure.10"></div>
<p id="rfc.section.6.1.p.1">If an organization with domain name FROBOZZ.EXAMPLE.NET became part of an organization with domain name ACME.EXAMPLE.COM, it might ease transition by placing information such as this in its old zone.  </p>

<p></p>
<pre>
    
    frobozz.example.net.  DNAME    frobozz-division.acme.example.com.
                          MX       10       mailhub.acme.example.com.
</pre>
<p id="rfc.section.6.1.p.2">The response to an extended recursive query for www.frobozz.example.net would contain, in the answer section, the DNAME record shown above and the relevant RRs for www.frobozz-division.acme.example.com.  </p>
<p id="rfc.section.6.1.p.3">If an organization wants to have aliases for names, for a different spelling or language, the same example applies.  Note that the MX RR at the zone apex is not redirected and has to be repeated in the target zone.  Also note that the services at mailhub or www.frobozz-division.acme.example.com. have to recognize and handle the aliases.  </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Classless Delegation of Shorter Prefixes</h1>
<div id="#rfc.figure.11"></div>
<p id="rfc.section.6.2.p.1">The classless scheme for in-addr.arpa delegation <a href="#RFC2317">[RFC2317]</a> can be extended to prefixes shorter than 24 bits by use of the DNAME record.  For example, the prefix 192.0.8.0/22 can be delegated by the following records.  </p>

<p></p>
<pre>
    $ORIGIN 0.192.in-addr.arpa.
    8/22    NS       ns.slash-22-holder.example.com.
    8       DNAME    8.8/22
    9       DNAME    9.8/22
    10      DNAME    10.8/22
    11      DNAME    11.8/22

</pre>
<div id="#rfc.figure.12"></div>
<p id="rfc.section.6.2.p.2">A typical entry in the resulting reverse zone for some host with address 192.0.9.33 might be </p>

<p></p>
<pre>
     $ORIGIN 8/22.0.192.in-addr.arpa.
     33.9    PTR     somehost.slash-22-holder.example.com.
</pre>
<p id="rfc.section.6.2.p.3">The same advisory remarks concerning the choice of the "/" character apply here as in <a href="#RFC2317">[RFC2317]</a> .  </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> Network Renumbering Support</h1>
<div id="#rfc.figure.13"></div>
<p id="rfc.section.6.3.p.1">If IPv4 network renumbering were common, maintenance of address space delegation could be simplified by using DNAME records instead of NS records to delegate.  </p>

<p></p>
<pre>
    $ORIGIN new-style.in-addr.arpa.
    189.190           DNAME    in-addr.example.net.

    $ORIGIN in-addr.example.net.
    188               DNAME    in-addr.customer.example.com.

    $ORIGIN in-addr.customer.example.
    1                 PTR      www.customer.example.com
    2                 PTR      mailhub.customer.example.com.
    ; etc ...
</pre>
<p id="rfc.section.6.3.p.2">This would allow the address space 190.189.0.0/16 assigned to the ISP "example.net" to be changed without the necessity of altering the zone files describing the use of that space by the ISP and its customers.  </p>
<p id="rfc.section.6.3.p.3">Renumbering IPv4 networks is currently so arduous a task that updating the DNS is only a small part of the labor, so this scheme may have a low value.  But it is hoped that in IPv6 the renumbering task will be quite different and the DNAME mechanism may play a useful part.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.7.p.1">The DNAME Resource Record type code 39 (decimal) originally has been registered by [RFC2672] in the DNS Resource Record (RR) Types registry table at http://www.iana.org/assignments/dns-parameters.  IANA should update the DNS resource record registry to point to this document for RR type 39.  </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.8.p.1">DNAME redirects queries elsewhere, which may impact security based on policy and the security status of the zone with the DNAME and the redirection zone's security status. For validating resolvers, the lowest security status of the links in the chain of CNAME and DNAME redirections is applied to the result.  </p>
<p id="rfc.section.8.p.2">If a validating resolver accepts wildcarded DNAMEs, this creates security issues.  Since the processing of a wildcarded DNAME is non-deterministic and the CNAME that was substituted by the server has no signature, the resolver may choose a different result than what the server meant, and consequently end up at the wrong destination. Use of wildcarded DNAMEs is discouraged in any case <a href="#RFC4592">[RFC4592]</a>.  </p>
<p id="rfc.section.8.p.3">A validating resolver MUST understand DNAME, according to <a href="#RFC4034">[RFC4034]</a>. The examples in <a href="#validname">Section 5.3.4</a> illustrate this need.  </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#Acknowledgments" id="Acknowledgments">Acknowledgments</a>
</h1>
<p id="rfc.section.9.p.1">The authors of this draft would like to acknowledge Matt Larson for beginning this effort to address the issues related to the DNAME RR type. The authors would also like to acknowledge Paul Vixie, Ed Lewis, Mark Andrews, Mike StJohns, Niall O'Reilly, Sam Weiler, Alfred Hoenes and Kevin Darcy for their review and comments on this document.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1034">[RFC1034]</b></td>
<td class="top">
<a title="Information Sciences Institute (ISI)">Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>", STD 13, RFC 1034, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a title="USC/ISI">Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2136">[RFC2136]</b></td>
<td class="top">
<a href="mailto:paul@vix.com" title="Internet Software Consortium">Vixie, P.</a>, <a href="mailto:set@thumper.bellcore.com" title="Bellcore">Thomson, S.</a>, <a href="mailto:yakov@cisco.com" title="Cisco Systems">Rekhter, Y.</a> and <a href="mailto:bound@zk3.dec.com" title="Digital Equipment Corp.">J. Bound</a>, "<a href="http://tools.ietf.org/html/rfc2136">Dynamic Updates in the Domain Name System (DNS UPDATE)</a>", RFC 2136, April 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2181">[RFC2181]</b></td>
<td class="top">
<a href="mailto:kre@munnari.OZ.AU" title="Computer Science">Elz, R.</a> and <a href="mailto:randy@psg.com" title="RGnet, Inc.">R. Bush</a>, "<a href="http://tools.ietf.org/html/rfc2181">Clarifications to the DNS Specification</a>", RFC 2181, July 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2317">[RFC2317]</b></td>
<td class="top">
<a href="mailto:Havard.Eidnes@runit.sintef.no" title="SINTEF RUNIT">Eidnes, H.</a>, <a title="Software Design, Inc.">de Groot, G.</a> and <a title="Internet Software Consortium">P. Vixie</a>, "<a href="http://tools.ietf.org/html/rfc2317">Classless IN-ADDR.ARPA delegation</a>", BCP 20, RFC 2317, March 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2782">[RFC2782]</b></td>
<td class="top">
<a href="mailto:arnt@troll.no" title="Troll Tech">Gulbrandsen, A.</a>, <a title="Internet Software Consortium">Vixie, P.</a> and <a href="mailto:levone@microsoft.com" title="Microsoft Corporation">L. Esibov</a>, "<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>", RFC 2782, February 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3597">[RFC3597]</b></td>
<td class="top">
<a>Gustafsson, A.</a>, "<a href="http://tools.ietf.org/html/rfc3597">Handling of Unknown DNS Resource Record (RR) Types</a>", RFC 3597, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4033">[RFC4033]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>", RFC 4033, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4034">[RFC4034]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>", RFC 4034, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4035">[RFC4035]</b></td>
<td class="top">
<a>Arends, R.</a>, <a>Austein, R.</a>, <a>Larson, M.</a>, <a>Massey, D.</a> and <a>S. Rose</a>, "<a href="http://tools.ietf.org/html/rfc4035">Protocol Modifications for the DNS Security Extensions</a>", RFC 4035, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4592">[RFC4592]</b></td>
<td class="top">
<a>Lewis, E.</a>, "<a href="http://tools.ietf.org/html/rfc4592">The Role of Wildcards in the Domain Name System</a>", RFC 4592, July 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5155">[RFC5155]</b></td>
<td class="top">
<a>Laurie, B.</a>, <a>Sisson, G.</a>, <a>Arends, R.</a> and <a>D. Blacka</a>, "<a href="http://tools.ietf.org/html/rfc5155">DNS Security (DNSSEC) Hashed Authenticated Denial of Existence</a>", RFC 5155, March 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1912">[RFC1912]</b></td>
<td class="top">
<a href="mailto:barr@math.psu.edu" title="The Pennsylvania State University, Department of Mathematics">Barr, D.</a>, "<a href="http://tools.ietf.org/html/rfc1912">Common DNS Operational and Configuration Errors</a>", RFC 1912, February 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2672">[RFC2672]</b></td>
<td class="top">
<a href="mailto:crawdad@fnal.gov" title="Fermilab MS 368">Crawford, M.</a>, "<a href="http://tools.ietf.org/html/rfc2672">Non-Terminal DNS Name Redirection</a>", RFC 2672, August 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3363">[RFC3363]</b></td>
<td class="top">
<a>Bush, R.</a>, <a>Durand, A.</a>, <a>Fink, B.</a>, <a>Gudmundsson, O.</a> and <a>T. Hain</a>, "<a href="http://tools.ietf.org/html/rfc3363">Representing Internet Protocol version 6 (IPv6) Addresses in the Domain Name System (DNS)</a>", RFC 3363, August 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3492">[RFC3492]</b></td>
<td class="top">
<a>Costello, A.</a>, "<a href="http://tools.ietf.org/html/rfc3492">Punycode: A Bootstring encoding of Unicode for Internationalized Domain Names in Applications (IDNA)</a>", RFC 3492, March 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4294">[RFC4294]</b></td>
<td class="top">
<a>Loughney, J.</a>, "<a href="http://tools.ietf.org/html/rfc4294">IPv6 Node Requirements</a>", RFC 4294, April 2006.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#appendix" id="appendix">Changes from RFC 2672</a>
</h1>
<h1 id="rfc.appendix.Appendix A.1">
<a href="#rfc.appendix.Appendix%20A.1">Appendix A.1.</a> Changes to Server Behavior</h1>
<p id="rfc.section.Appendix A.1.p.1">Major changes to server behavior from the original DNAME specification are summarized below: </p>

<ul>
<li>The rules for DNAME substitution have been clarified in Section 2.  </li>
<li>The EDNS option to signal DNAME understanding and compression has never been specified, and this document clarifies that there is no signaling method (Section 2.5).  </li>
<li>The TTL for synthesized CNAME RR's is now set to the TTL of the DNAME, not zero (Section 3.1).  </li>
<li>Caching recursive servers MUST perform CNAME synthesis on behalf of clients (Section 3.4).  </li>
<li>The revised server algorithm is detailed in Section 3.2.  </li>
<li>Rules for dynamic update messages adding a DNAME or CNAME RR to a zone where a CNAME or DNAME already exists is detailed in Section 5.2 </li>
</ul>

<p> </p>
<h1 id="rfc.appendix.Appendix A.2">
<a href="#rfc.appendix.Appendix%20A.2">Appendix A.2.</a> Changes to Client Behavior</h1>
<p id="rfc.section.Appendix A.2.p.1">Major changes to client behavior from the original DNAME specification are summarized below: </p>

<ul>
<li>Clients MUST be able to accept synthesized CNAME RR's with a TTL of either zero or the TTL of the DNAME RR that accompanies the CNAME RR.  </li>
<li>DNSSEC aware clients SHOULD cache DNAME RR's and MAY cache synthesized CNAME RR's it receives in the same response.  DNSSEC aware clients SHOULD also check the NSEC/NSEC3 type bitmap to verify that DNAME redirection is to be done. DNSSEC validators MUST understand DNAME (Section 5.3).  </li>
<li>The revised client algorithm is detailed in Section 3.4.1.  </li>
</ul>

<p> </p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Scott Rose</span> 
	  <span class="n hidden">
		<span class="family-name">Rose</span>
	  </span>
	</span>
	<span class="org vcardline">NIST </span>
	<span class="adr">
	  <span>100 Bureau Dr.</span>

	  <span class="vcardline">
		<span class="locality">Gaithersburg</span>,  
		<span class="region">MD</span> 
		<span class="code">20899</span>
	  </span>
	  <span class="country-name vcardline">USA</span>
	</span>
	<span class="vcardline">Phone: +1-301-975-8439</span>

<span class="vcardline">EMail: <a href="mailto:scottr.nist@gmail.com%20">scottr.nist@gmail.com </a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Wouter Wijngaards</span> 
	  <span class="n hidden">
		<span class="family-name">Wijngaards</span>
	  </span>
	</span>
	<span class="org vcardline">NLnet Labs </span>
	<span class="adr">
	  <span>Science Park 140</span>

	  <span class="vcardline">
		<span class="locality">Amsterdam</span>,  
		<span class="region"></span>
		<span class="code">1098 XG</span>
	  </span>
	  <span class="country-name vcardline">The Netherlands</span>
	</span>
	<span class="vcardline">Phone: +31-20-888-4551</span>

<span class="vcardline">EMail: <a href="mailto:wouter@nlnetlabs.nl%20">wouter@nlnetlabs.nl </a></span>

  </address>
</div>

</body>
</html>