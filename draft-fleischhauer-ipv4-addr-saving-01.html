<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>draft-fleischhauer-ipv4-addr-saving-01</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Abstract">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 Requirements Language">
<link href="#rfc.section.2" rel="Chapter" title="2 Problem Statement and Purpose of IPv4 address efficiency">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Architecture and Communication in a PPP Dual-Stack environment">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 The advantage of the dynamic address assigning feature">
<link href="#rfc.section.3" rel="Chapter" title="3 Specification">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Definition of the participating elements and their functionalities">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Assigning IPv4 address parameter on-demand after establishing PPP and IPv6 connectivity">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 Releasing unused IPv4 address parameters">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Timer Considerations">
<link href="#rfc.section.4" rel="Chapter" title="4 Acknowledgements">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.section.6" rel="Chapter" title="6 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="7 References">
<link href="#rfc.references.1" rel="Chapter" title="7.1 Normative Reference">
<link href="#rfc.references.2" rel="Chapter" title="7.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Workplan">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Today the Dual-Stack approach is the most straightforward and the most common way for introducing IPv6 into existing systems and networks.  However a typical drawback of implementing Dual-Stack is that each node will still require at least one IPv4 address. Hence, solely deploying Dual-Stack does not provide a sufficient solution to the IPv4 address exhaustion problem. Assuming a situation where most of the IP communication (e.g. always-on, VoIP etc.) can be provided via IPv6, the usage of public IPv4 addresses can significantly be reduced and the unused public IPv4 addresses can under certain circumstances be returned to the public IPv4 address pool of the service provider. New Dual-Stack enabled services can be introduced without increasing the public IPv4 address demand, when IPv6 will be the preferred network layer protocol.  This document describes such a solution in a Dual-Stack PPP session network scenario and explains the protocol mechanisms which are used." />
  <meta name="description" content="Today the Dual-Stack approach is the most straightforward and the most common way for introducing IPv6 into existing systems and networks.  However a typical drawback of implementing Dual-Stack is that each node will still require at least one IPv4 address. Hence, solely deploying Dual-Stack does not provide a sufficient solution to the IPv4 address exhaustion problem. Assuming a situation where most of the IP communication (e.g. always-on, VoIP etc.) can be provided via IPv6, the usage of public IPv4 addresses can significantly be reduced and the unused public IPv4 addresses can under certain circumstances be returned to the public IPv4 address pool of the service provider. New Dual-Stack enabled services can be introduced without increasing the public IPv4 address demand, when IPv6 will be the preferred network layer protocol.  This document describes such a solution in a Dual-Stack PPP session network scenario and explains the protocol mechanisms which are used." />
  <meta name="keywords" content="IPv4, IPv6, IPCP, IPv6CP, PPP, address saving, Dual-Stack, BBF WT-242, BBF TR-187" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">K. Fleischhauer, Ed.</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">O. Bonne&#223;</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">Deutsche Telekom AG</td>
</tr>
<tr>
<td class="left">Expires: March 11, 2012</td>
<td class="right">September 08, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">draft-fleischhauer-ipv4-addr-saving-01<br />
  <span class="filename">On demand IPv4 address provisioning in Dual-Stack PPP deployment scenarios </span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Today the Dual-Stack approach is the most straightforward and the most common way for introducing IPv6 into existing systems and networks.  However a typical drawback of implementing Dual-Stack is that each node will still require at least one IPv4 address. Hence, solely deploying Dual-Stack does not provide a sufficient solution to the IPv4 address exhaustion problem. Assuming a situation where most of the IP communication (e.g. always-on, VoIP etc.) can be provided via IPv6, the usage of public IPv4 addresses can significantly be reduced and the unused public IPv4 addresses can under certain circumstances be returned to the public IPv4 address pool of the service provider. New Dual-Stack enabled services can be introduced without increasing the public IPv4 address demand, when IPv6 will be the preferred network layer protocol.  This document describes such a solution in a Dual-Stack PPP session network scenario and explains the protocol mechanisms which are used.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on March 11, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Abstract</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">Requirements Language</a>
</li>
<li>2.   <a href="#rfc.section.2">Problem Statement and Purpose of IPv4 address efficiency</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Architecture and Communication in a PPP Dual-Stack environment</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">The advantage of the dynamic address assigning feature</a>
</li>
<li>3.   <a href="#rfc.section.3">Specification</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Definition of the participating elements and their functionalities</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Assigning IPv4 address parameter on-demand after establishing PPP and IPv6 connectivity</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">Releasing unused IPv4 address parameters</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Timer Considerations</a>
</li>
<li>4.   <a href="#rfc.section.4">Acknowledgements</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.section.6">Security Considerations</a>
</li>
<li>7.   <a href="#rfc.references">References</a>
</li>
<li>7.1.   <a href="#rfc.references.1">Normative Reference</a>
</li>
<li>7.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Workplan</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Abstract</h1>
<p id="rfc.section.1.p.1">The Dual-Stack approach as defined in <a href="#RFC4213">[RFC4213]</a> provides the most straightforward and most common way for introducing IPv6 <a href="#RFC2460">[RFC2460]</a> into existing systems and networks.  However a typical drawback of the Dual-Stack approach is that each network node will still require at least one IPv4 <a href="#RFC0791">[RFC0791]</a> address. Assuming a situation where most of the IP communication (e.g. always-on, VoIP etc.) can be provided via IPv6, the usage of public IPv4 addresses can be reduced significantly and the unused public IPv4 addresses may be returned to the public IPv4 address pool of the provider. This document describes how such a solution can be realised in a Dual-Stack PPP session scenario and details the protocol mechanisms of the solution which are also thought as contribution to <a href="#BBF-WT-242">[BBF-WT-242]</a>.</p>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> Requirements Language</h1>
<p id="rfc.section.1.1.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite></p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> <a href="#simple_list" id="simple_list">Problem Statement and Purpose of IPv4 address efficiency</a>
</h1>
<p id="rfc.section.2.p.1">The Broadband Forum describes in <a href="#BBF-TR-187">[BBF-TR-187]</a> a target IPv4/IPv6 Dual-Stack Architecture (assuming native implementation of IPv6). TR-187 builds on the capabilities of existing protocols such as Point-to-Point Protocol (PPP) <a href="#RFC1332">[RFC1332]</a> and Layer 2 Tunnelling Protocol (L2TP) <a href="#RFC2661">[RFC2661]</a> to provide IPv6 service in addition to today's IPv4 service. These protocols allow the parallel usage of IPv4 and IPv6 within a single PPP respectively L2TP session. Usually in such a scenario the service provider offers to the customer the usage of public IPv4 and IPv6 address resources during the duration of the PPP session. Because of the potential parallel usage of IPv4 and IPv6 within such a Dual-Stack PPP scenario an Public IPv4 address is always provisioned, also in the case where most of the communication is transported using IPv6. This document extends the sketched Dual-Stack deployment scenario for PPP and L2TPv2 with a mechanism that allows a temporary assignment and a release of an unused IPv4 address within such a Dual-Stack capable PPP session scenario. The IPv4 address may also only be provided on-demand later on, after initiating the Dual-Stack PPP session with an IPv6 address only.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Architecture and Communication in a PPP Dual-Stack environment</h1>
<p id="rfc.section.2.1.p.1">Assuming a Dual-Stack network access via PPP sessions, end devices can in general communicate via IPv4 and/or IPv6 transport, depending on their own and their IP communication partners capabilities. The actual usage of IPv4 or IPv6 or both protocols depends on the capabilities of the IP communication endpoints (e.g. protocol stack, applications, configuration of the preferences etc.), the network itself and also on the used communication services (like e.g. VoIP).  The later two are mainly in responsibility of the network and service provider. The approach, sketched in this document, is based on the assumption that the customer starts a Dual-Stack PPP session in "IPv6-only" mode and "adds" IPv4 later on only in the case that applications or services explicitly request IPv4 connectivity. When IPv4 connectivity is not needed during the whole time of PPP network connectivity than a continuous provisioning of a global IPv4 address to the customer device (e.g. end system, CPE etc.) is not necessary.  Therefore mechanisms are needed to provision and release public IPv4 addresses for Dual-Stack PPP sessions dynamically.</p>
<p id="rfc.section.2.1.p.2">The goal of the solution sketched in this document, is to limit and decrease the public IPv4 address pool size of the PPP network access provider. Assuming that always-on services are reachable via IPv6, a Dual-Stack capable PPP connected device should per default request IPv4 address parameters only on demand, when the need for establishing IPv4 connectivity has been detected and IPv4 traffic towards the PPP WAN interface (e.g. of a CPE) is intended. As already described above it is sufficient, when initially only IPv6 address parameters are provisioned to the PPP customer endpoint (e.g. end systems, Home Gateway, CPE).</p>
<p id="rfc.section.2.1.p.3">This means that this customer device does not initially start a complete Dual-Stack PPP session but an "IPv6 only" PPP session. The IPv4 part of the complete Dual-Stack is initiated later on only in the case that IPv4 connectivity is explicitly requested.</p>
<div id="#rfc.figure.1"></div>
<div id="#xml_happy_1"></div>
<p></p>

<p></p>
<pre>                             |       +------------+        |
                             |       |  external  |        |
                             |       |  Address   |        |
                             |       |    Pool    |        |
                             |       | Management |        |                                                      
                             |       +------------+        |
                             |      service | provider     |
                             |          AAA | area         |
+---------+                  +--------------|--------------+
| Private |__                               |
|   Host  |_ \                              |
|    1    | \ \IPv4                         |
+---------+  \ \                            |
              \ \               IPv4        |
           IPv6\ \_+---------+ over PPP+---------+  IPv4  +---------+
                \__|   CPE   |---------|   NAS   |--------|  Public |
                 __|  (PPP   |         |  (PPP   |        |   Host  |
                / _|  Peer)  |---------|  Peer)  |--------|    n    |
           IPv6/ / +---------+   IPv6  +---------+  IPv6  +---------+
              / /              over PPP
+---------+  / /IPv4
| Private |_/ / 
|  Host   |__/
|    n    | 
+---------+  

\_______________________/\__________________________________________/
    Private Internet                     Public Internet
         </pre>
<p id="rfc.section.2.1.p.5">The figure above shows the architecture of a PPP Dual-Stack environment for providing Internet access for residential customers.</p>
<p id="rfc.section.2.1.p.6">The abstract topology normally consists of 3 components:</p>
<p><a href="#RFC1918">[RFC1918]</a> is the local area network on customer site wherein IPv4 and IPv6 communication are provided. The Private Internet is an optional part of the PPP Dual-Stack architecture. Within the Customer LAN exist one or more private hosts which are connected to the local area network interfaces of the Customer Premise Equipment.  These hosts can have IPv4-only, IPv6-only or Dual-Stack communication capabilities. For IPv6 communication inside the Customer LAN Unique Local or public IPv6 addresses may be used. For IPv6 communication to the public Internet public IPv6 addresses should be used. For IPv4 communication within the Customer LAN and to the public Internet it is assumed that private IPv4 addresses must be used by the private hosts.  In order to ensure IPv4 communication to the public Internet the CPE must hence provide IPv4 Network Address Translation (NAT44) functionality and map the private IPv4 addresses of the private hosts to a public IPv4 address of the WAN interface of the NAT and vice versa. The NAT functionality on the CPE is the border element between the private IPv4 Internet (aka. Customer LAN) and the public IPv4 Internet. In the case of using public IPv6 addresses for the communication the CPE and its interfaces are an integral part of the public Internet.</p>

<ol>
<li>Private Internet (aka. Customer LAN)</li>
<li>Public Internet</li>
<li>Service Provider AAA area</li>
</ol>

<p>The Private Internet as defined in </p>
<p id="rfc.section.2.1.p.8">To the public Internet belong the Access Network of the service provider and all other networks outside the customer LAN that are addressed with global IPv4 and / or IPv6 addresses and can be accessed from the private Internet as well as from other systems within the public Internet.</p>
<p id="rfc.section.2.1.p.9">The focus of this draft is directed to the access network of the service provider where in our scenario PPP is used between the CPE and the NAS in order to provide customer access to the public Internet.</p>
<p id="rfc.section.2.1.p.10">The Service Provider AAA area is a network which consists of several systems to control the Network Access Server (NAS) and to provide AAA functionalities in order to reduce the load on the NAS.  Such Service Provider AAA functionalities include also management of the public IPv4 and public IPv6 address pools inside the NAS and can hence also be integrated directly into the NAS.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> The advantage of the dynamic address assigning feature</h1>
<p id="rfc.section.2.2.p.1">This approach is based on the assumption that the customer initiates a PPP session based on IPv6 and uses IPv4 only if applications or services require explicit IPv4 connectivity. A public IPv4 address can therefore provided sequentially to different customers during the runtime of their PPP connections. This enables a smooth migration from IPv4 to IPv6 in comparison to other IPv4-IPv6 migration approaches (e.g. NAT in service provider network). The customer will be provisioned with a public IPv4 address only in the case when global IPv4 connectivity is really needed and will not be provisioned with an IPv4 address per default when the Dual-Stack PPP session is initiated. Furthermore, a provisioned IPv4 address can be released (e.g. after a certain time interval) in the case that the CPE detects that there is no need any more for global IPv4 connectivity.  Or in other words, when global IPv4 connectivity is not needed during the whole time of the PPP session then a (continuous) provisioning of a public IPv4 address to the CPE is not necessary and the provisioning of a public IPv4 address can be done on-demand and dynamically.</p>
<p id="rfc.section.2.2.p.2">The main goal of this mechanism is to limit and decrease the pool size for public IPv4 addresses at the service provider site.</p>
<p id="rfc.section.2.2.p.3">A similar effect in limiting and decreasing the IPv4 address demand could also be achieved by using separate PPP sessions for IPv4 and IPv6. But in that case the following problems occur:</p>
<p></p>

<ul><li>For each additional PPP session additional AAA parameters have to be created and handled which leads to an extension of AAA domains and more complex processes.</li></ul>

<ul><li>Each additional PPP session will require additional resources on the PPP endpoints (e.g. for handling additional customer credentials) as well in devices that act as PPP intermediate agents.</li></ul>

<ul><li>Accounting and controlling of traffic classes on an access line or customer base will be impeded or at least complicated.</li></ul>

<p>Because of these reasons the introduction of IPv6 as additional network layer protocol on a access line with an additional PPP session is not recommended.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Specification</h1>
<p id="rfc.section.3.p.1">As defined in <a href="#RFC2661">RFC 2661</a> <cite title="NONE">[RFC2661]</cite> PPP and L2TP provide the following main functionalities:</p>
<p><a href="#RFC1332">RFC 1332 </a> <cite title="NONE">[RFC1332]</cite> and Internet Protocol (Version 6) Control Protocol (IPV6CP) <a href="#RFC2472">RFC 2472</a> <cite title="NONE">[RFC2472]</cite> are used. Whereas IPCP is responsible for configuring, enabling, and disabling the IPv4 protocol modules on both ends of the point-to-point link, IPV6CP is responsible for configuring, enabling, and disabling the IPv6 protocol modules on both ends of the point-to-point link. Once one of both network-layer protocols has been configured, datagrams from this network-layer protocol can be sent over the PPP link. Both NCP protocol mechanisms are independent from each other (see also requirement WLL-3 in <a href="#RFC6204">[RFC6204]</a>).</p>

<ol>
<li>A method for encapsulating datagrams over serial links.</li>
<li>A Link Control Protocol (LCP) for establishing, configuring, and testing the data-link connection.</li>
<li>(Optional) Authentication Protocol for one or both peers.</li>
<li>A family of Network Control Protocols (NCPs) for establishing and configuring different network-layer protocols.</li>
</ol>

<p>For provisioning of IPv4 or IPv6 communication parameters (e.g.  addresses, DNS resolver) as network-layer protocols only the NCPs Internet Protocol (Version 4) Control Protocol (IPCP) </p>
<p id="rfc.section.3.p.3">An implementation wishing to close a dedicated NCP connection (e.g.  IPCP or IPv6CP) SHOULD transmit a Terminate-Request to the peer. Upon reception of a Terminate-Request, a Terminate-Ack MUST be transmitted to the sender of the Terminate-Request. The PPP session itself and the other NCP connection inside the PPP session will remain existent. Only in the case that both NCP connections are closed, the PPP session will be terminated.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Definition of the participating elements and their functionalities</h1>
<p id="rfc.section.3.1.p.1">This chapter names the network elements that are involved in the message flows to enable the on-demand IPv4 address provisioning functionality and describes their functionalities related to this mechanism.</p>
<p id="rfc.section.3.1.p.2">Customer Edge Router (CER aka. CPE)/End System</p>
<p id="rfc.section.3.1.p.3">This is any device implementing a Dual-Stack PPP stack and acting as a PPP client to the PPP server in the service provider network in order to achieve connectivity to the service provider network. The PPP interface of this device is also called WAN interface <a href="#RFC6204">[RFC6204]</a>. In the case of a Customer Edge Router (CER) this is a node (e.g. intended for home or small office usage) which forwards IPv4 and IPv6 packets those are not explicitly addressed to itself . Therefore the demand for IPv4 connectivity of such a Customer Edge Router will be triggered either by own applications or by receiving IPv4 packets on its customer network facing interfaces that are addressed to the public Internet. In the case of an End System, this system is a node that intends to send IPv4 and/or IPv6 packets.  On a End System the IPv4 connectivity demand can only be triggered by own applications. However, in both cases the IPv4_idle_timer resides on the WAN interface in order to detect IPv4 packets passing the WAN interface (incoming/ outgoing) and to measure the related IPv4 idle time when no IPv4 packet has been sent or received.</p>
<p id="rfc.section.3.1.p.4">Network Access Server (NAS)/Layer 2 Network Server (LNS)</p>
<p id="rfc.section.3.1.p.5">The Network Access Server (NAS) is a device providing local Dual- Stack PPP connectivity to the Service Provider network and acting as a PPP server to the PPP client on the Customer Edge Router or customer end system. Within a RFC 2661 architecture the PPP server within the service provider network is the L2TP Network Server (LNS). The address pool management can be provided locally on the NAS/LNS or remotely. In the case of a local address pool management no information exchange to an external address pool management system is needed in order to assign or release IPv4 addresses. In the case of an external address pool management an information exchange between the NAS/LNS and the address pool management system is required.</p>
<p id="rfc.section.3.1.p.6">External Address Pool Management</p>
<p id="rfc.section.3.1.p.7">External Address Pool Management is used in the case when no local Address Pool Management system is implemented in the NAS/LNS. In this case it is necessary that the NAS/LNS communicates with an External Address Pool Management System for assigning or releasing IPv4 addresses. RADIUS as specified in <a href="#RFC2865">[RFC2865]</a> or DIAMETER as specified in <a href="#RFC3588">[RFC3588]</a> can be used as protocol between NAS/LNS and the External Address Pool Management System.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Assigning IPv4 address parameter on-demand after establishing PPP and IPv6 connectivity</h1>
<p id="rfc.section.3.2.p.1">A PPP client implementation wishing to open a connection MUST transmit a NCP Configure-Request to the PPP server. If every Configuration Option received in a NCP Configure-Request is recognizable and all values are acceptable, then the PPP server implementation MUST transmit a NCP Configure-Ack to the initiator of the NCP Configure-Request.</p>
<p id="rfc.section.3.2.p.2">Applied to the above sketched Dual-Stack PPP session use case the configuration and enabling of the IPv6 protocol module can be done immediately after a successful LCP data link configuration (and maybe successful authentication) of the PPP session.</p>
<p id="rfc.section.3.2.p.3">Separately from that, the IPv4 protocol module can be configured and enabled using IPCP. However this SHALL only be done in the case that an IPv4 connectivity demand has been detected on the PPP customer end system or CPE (PPP client). Therefore the NAS MUST not initiate the negotiation of IPCP.</p>
<div id="#rfc.figure.2"></div>
<div id="#xml_happy_2"></div>
<p></p>

<p></p>
<pre>
      CPE/End System                  NAS              ext.  Address 
         (PPP Peer)                (PPP Peer)         Pool management
             |                         |                      |
        1. -&gt;|                         |                      |
        2.   |-IPCP-Configure-Request-&gt;|                      |
        3.   |                         |----Access-Request---&gt;|  
        4.   |                         |&lt;---Access-Accept-----|
        5.   |&lt;-IPCP-Configure-Request-|                      |
        6.   |---IPCP-Configure-Ack---&gt;|                      |
        7.   |&lt;--IPCP-Configure-Nack---|                      |
        8.   |-IPCP-Configure-Request-&gt;|                      |
        9.   |&lt;---IPCP-Configure-Ack---|                      |
        10.  |                         |--Accounting-Request-&gt;|
        11.  |                         |&lt;---Accounting-Resp.--|
      </pre>
<p id="rfc.section.3.2.p.5">In the diagram above, the CPE/End System is triggered (1) to set up IPv4 connectivity via an already existing PPP session. The CPE/End System detects that there is no public IPv4 address for its WAN interface available and starts the negotiation of the needed IPv4 address parameter by sending an IPCP Configure-Request to the NAS (2).  The NAS will request the corresponding IPv4 connectivity parameters (e.g. IPv4 address, DNS resolver address) from a local (e.g. within the NAS) or remote database representing the Address Pool Management System(e.g. via RADIUS/DIAMETER) (3, 4). After this the PPP peers use the standard IPCP procedures to finalize the IPv4 address parameter negotiation (5, 6, 7, 8, 9). After the successful provisioning of the IPv4 address parameter the CPE/End system has full global IPv4 connectivity and can proceed with the IPv4 communication. In case of an external Address Pool Management, the NAS will send an Accounting-Request message (10) to the external Address Pool Management System in order to signal the successful negotiation of the IPv4 address parameter. The external Address Pool Management System will answer with an Accounting-Response (11) message.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> Releasing unused IPv4 address parameters</h1>
<p id="rfc.section.3.3.p.1">An implementation wishing to close a dedicated NCP connection (e.g.  IPCP or IPv6CP) SHOULD transmit a Terminate-Request to the peer. Upon reception of a NCP Terminate-Request, a Terminate-Ack MUST be transmitted to the sender of the Terminate-Request.</p>
<p id="rfc.section.3.3.p.2">In the PPP Dual-Stack session scenario discussed here, the generation of the Terminate-Request message for the IPCP part of the PPP Dual-Stack session MUST be triggered by an IPv4 traffic idle timer within the PPP client (e.g. end system, CPE). As long as there is still an ongoing IPv6 connection within the PPP session, the PPP session MUST be kept open. Equivalently, when no IPv6 connectivity is detected the IPV6CP session can be terminated again by sending an IPv6CP Terminate-Request and accepting this by a Terminate-Ack.  Afterwards the link layer connectivity and hence the whole PPP connection can be terminated by exchanging the LCP Terminate-Request and Terminate-Ack messages.</p>
<div id="#rfc.figure.3"></div>
<div id="#xml_happy_3"></div>
<p></p>

<p></p>
<pre>
      CPE/End System                  NAS              ext.  Address
         (PPP Peer)                (PPP Peer)         Pool Management
             |                         |                      |
        1. -&gt;|                         |                      |
        2.   |--IPCP-Termin.-Request--&gt;|                      |
        3.   |&lt;----IPCP-Termin.-Ack.---|                      |  
        4.   |                         |-Interim-Acc.-Requ.--&gt;|
        5.   |                         |&lt;---Accounting-Resp.--|</pre>
<p id="rfc.section.3.3.p.4">The termination of an IPCP session is illustrated in figure 3 above. Within this exemplary message flow it is assumed that there is still an IPV6CP connection active inside the Dual-Stack PPP session.  After the expiration of the IPv4 traffic idle timer (1) the CPE/End system sends an IPCP terminate request to the peer (2). The request will be answered with an Terminate-Ack message (3). The IPv4 address can be returned to the local address pool (e.g. within the NAS) or to the remote IPv4 address pool by sending Interim-Accounting messages (4, 5) (e.g. via RADIUS/DIAMETER).</p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> Timer Considerations</h1>
<p id="rfc.section.3.4.p.1">IPv4_Idle_Timer</p>
<p id="rfc.section.3.4.p.2">The sending of the Terminate-Request message MUST be triggered by an IPv4 traffic idle timer within the PPP client (e.g. end system, CPE). The timer value MUST be configurable to adopt the mechanism due to the needs of the applications which are using IPv4 and with respect to an optimization of the IPv4 address saving potential.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> <a href="#Acknowledgements" id="Acknowledgements">Acknowledgements</a>
</h1>
<p id="rfc.section.4.p.1">The author and contributors also wish to acknowledge the assistance of the following individuals or groups.</p>
<p id="rfc.section.4.p.2">Tina Tsou</p>
<p id="rfc.section.4.p.3">Sven Schmidtke</p>
<p id="rfc.section.4.p.4">Dan Wing</p>
<p id="rfc.section.4.p.5">Vernon Schryer</p>
<p id="rfc.section.4.p.6">Mark Townsley</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.5.p.1">This memo includes no request to IANA.</p>
<p id="rfc.section.5.p.2">TBD.</p>
<p id="rfc.section.5.p.3">All drafts are required to have an IANA considerations section (see <a href="#RFC5226">Guidelines for Writing an IANA Considerations Section in RFCs</a> <cite title="NONE">[RFC5226]</cite> for a guide). If the draft does not require IANA to do anything, the section contains an explicit statement that this is the case (as above). If there are no requirements for IANA, the section will be removed during conversion into an RFC by the RFC Editor.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.6.p.1">TBD.</p>
<p id="rfc.section.6.p.2">All drafts are required to have a security considerations section.  See <a href="#RFC3552">RFC 3552</a> <cite title="NONE">[RFC3552]</cite> for a guide.</p>
<h1 id="rfc.references">
<a href="#rfc.references">7.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">7.1.</a> Normative Reference</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC0791">[RFC0791]</b></td>
<td class="top">
<a title="University of Southern California (USC)/Information Sciences Institute">Postel, J.</a>, "<a href="http://tools.ietf.org/html/rfc791">Internet Protocol</a>", STD 5, RFC 791, September 1981.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1918">[RFC1918]</b></td>
<td class="top">
<a href="mailto:yakov@cisco.com" title="Cisco systems">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com" title="Chrysler Corporation">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net" title="RIPE Network Coordination Centre">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net" title="RIPE Network Coordination Centre">Groot, G.</a> and <a href="mailto:lear@sgi.com" title="Silicon Graphics, Inc.">E. Lear</a>, "<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>", BCP 5, RFC 1918, February 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4213">[RFC4213]</b></td>
<td class="top">
<a>Nordmark, E.</a> and <a>R. Gilligan</a>, "<a href="http://tools.ietf.org/html/rfc4213">Basic Transition Mechanisms for IPv6 Hosts and Routers</a>", RFC 4213, October 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2460">[RFC2460]</b></td>
<td class="top">
<a href="mailto:deering@cisco.com" title="Cisco Systems, Inc.">Deering, S.E.</a> and <a href="mailto:hinden@iprg.nokia.com" title="Nokia">R.M. Hinden</a>, "<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>", RFC 2460, December 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1332">[RFC1332]</b></td>
<td class="top">
<a href="mailto:Glenn.McGregor@Merit.edu" title="Merit Network, Inc.">McGregor, G.</a>, "<a href="http://tools.ietf.org/html/rfc1332">The PPP Internet Protocol Control Protocol (IPCP)</a>", RFC 1332, May 1992.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2661">[RFC2661]</b></td>
<td class="top">
<a href="mailto:townsley@cisco.com" title="Cisco Systems">Townsley, W.</a>, <a href="mailto:vandys@cisco.com" title="cisco Systems">Valencia, A.</a>, <a href="mailto:acr@del.com" title="Ascend Communications">Rubens, A.</a>, <a href="mailto:gurdeep@microsoft.com" title="Microsoft Corporation">Pall, G.</a>, <a href="mailto:gwz@acm.org" title="Microsoft Corporation">Zorn, G.</a> and <a href="mailto:palter@zev.net" title="RedBack Networks, Inc">B. Palter</a>, "<a href="http://tools.ietf.org/html/rfc2661">Layer Two Tunneling Protocol "L2TP"</a>", RFC 2661, August 1999.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2472">[RFC2472]</b></td>
<td class="top">
<a href="mailto:dhaskin@baynetworks.com" title="Bay Networks, Inc.">Haskin, D.</a> and <a href="mailto:eallen@baynetworks.com" title="Bay Networks, Inc.">E. Allen</a>, "<a href="http://tools.ietf.org/html/rfc2472">IP Version 6 over PPP</a>", RFC 2472, December 1998.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2865">[RFC2865]</b></td>
<td class="top">
<a>Rigney, C.</a>, <a>Willens, S.</a>, <a>Rubens, A.</a> and <a>W. Simpson</a>, "<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>", RFC 2865, June 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3588">[RFC3588]</b></td>
<td class="top">
<a>Calhoun, P.</a>, <a>Loughney, J.</a>, <a>Guttman, E.</a>, <a>Zorn, G.</a> and <a>J. Arkko</a>, "<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>", RFC 3588, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6204">[RFC6204]</b></td>
<td class="top">
<a>Singh, H.</a>, <a>Beebee, W.</a>, <a>Donley, C.</a>, <a>Stark, B.</a> and <a>O. Troan</a>, "<a href="http://tools.ietf.org/html/rfc6204">Basic Requirements for IPv6 Customer Edge Routers</a>", RFC 6204, April 2011.</td>
</tr>
<tr>
<td class="reference"><b id="BBF-WT-242">[BBF-WT-242]</b></td>
<td class="top">
<a>Broadbandforum</a>, "<a>Draft WT-242 IPv6 Transition Mechanisms for Broadband Networks</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="BBF-TR-187">[BBF-TR-187]</b></td>
<td class="top">
<a>Broadbandforum</a>, "<a>Technical Report TR187 IPv6 over PPP Broadband Access (Issue 1)</a>", May 2010.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">7.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3552">[RFC3552]</b></td>
<td class="top">
<a>Rescorla, E.</a> and <a>B. Korver</a>, "<a href="http://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>", BCP 72, RFC 3552, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5226">[RFC5226]</b></td>
<td class="top">
<a>Narten, T.</a> and <a>H. Alvestrand</a>, "<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>", BCP 26, RFC 5226, May 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#app-additional" id="app-additional">Workplan</a>
</h1>
<p id="rfc.section.Appendix A.p.1">v00 2011-03-07 KF/OB initial version</p>
<p id="rfc.section.Appendix A.p.2">v01 2011-09-06 adding figures + explanation + Feedback IETF80 &amp;mail discussion</p>
<p id="rfc.section.Appendix A.p.3">v02 before IETF 82 review + feedback mail discussion</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Karsten Fleischhauer</span> editor
	  <span class="n hidden">
		<span class="family-name">Fleischhauer</span>
	  </span>
	</span>
	<span class="org vcardline">Deutsche Telekom AG</span>
	<span class="adr">
	  <span>Heinrich-Hertz-Strasse 3-7</span>

	  <span class="vcardline">
		<span class="locality">64295 Darmstadt</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">DE</span>
	</span>
	<span class="vcardline">Phone: +49 6151 58 12831</span>

<span class="vcardline">EMail: <a href="mailto:k.fleischhauer@telekom.de">k.fleischhauer@telekom.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Olaf Bonneß</span> 
	  <span class="n hidden">
		<span class="family-name">Bonneß</span>
	  </span>
	</span>
	<span class="org vcardline">Deutsche Telekom AG</span>
	<span class="adr">
	  <span>Winterfeldtstr. 21-27</span>

	  <span class="vcardline">
		<span class="locality">10781 Berlin</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">DE</span>
	</span>
	<span class="vcardline">Phone: +49 30 835358826</span>

<span class="vcardline">EMail: <a href="mailto:olaf.bonness@telekom.de">olaf.bonness@telekom.de</a></span>

  </address>
</div>

</body>
</html>