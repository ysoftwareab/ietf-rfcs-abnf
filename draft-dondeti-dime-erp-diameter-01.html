<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Diameter Support for EAP Re-authentication Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Diameter Support for EAP Re-authentication Protocol">
<meta name="keywords" content="Internet-Draft, EAP, Diameter, Re-authentication, inter-authenticator roaming">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Diameter Maintenance and</td><td class="header">L. Dondeti</td></tr>
<tr><td class="header">Extensions (DIME)</td><td class="header">QUALCOMM, Inc.</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">Expires: May 22, 2008</td><td class="header">November 19, 2007</td></tr>
</table></td></tr></table>
<h1><br />Diameter Support for EAP Re-authentication Protocol<br />draft-dondeti-dime-erp-diameter-01.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 22, 2008.</p>

<h3>Abstract</h3>

<p>An EAP extension, called "EAP Re-authentication Protocol (ERP)", has been specified
                that supports an EAP method-independent protocol for efficient re-authentication
                between the peer and the server through an authenticator. This document specifies
                Diameter support for ERP. The Diameter EAP application is re-used for encapsulating
                the newly defined EAP Initiate and EAP Finish messages specified in the ERP
                specification. AVPs for request and delivery of
                Domain Specific Root Keys from the AAA/EAP server to the ER server are also specified. Additionally,
                this document also specifies Diameter processing rules relevant to ERP.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#anchor1">2.</a>&nbsp;
Terminology<br />
<a href="#anchor2">3.</a>&nbsp;
Assumptions<br />
<a href="#diameter_support">4.</a>&nbsp;
Diameter Support for ERP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#overview">4.1.</a>&nbsp;
Protocol Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dsrk">4.2.</a>&nbsp;
DSRK Request and Delivery<br />
<a href="#anchor3">5.</a>&nbsp;
Command Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">5.1.</a>&nbsp;
Diameter-EAP-Request (DER)<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">5.2.</a>&nbsp;
Diameter-EAP-Answer (DEA)<br />
<a href="#anchor6">6.</a>&nbsp;
Attribute Value Pair Definitions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">6.1.</a>&nbsp;
EAP-DSRK-Request AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">6.2.</a>&nbsp;
EAP-DSRK AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">6.3.</a>&nbsp;
EAP-DSRK-Name AVP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">6.4.</a>&nbsp;
EAP-DSRK-Lifetime AVP<br />
<a href="#anchor11">7.</a>&nbsp;
AVP Occurrence Table<br />
<a href="#anchor12">8.</a>&nbsp;
AVP Flag Rules<br />
<a href="#SecCons">9.</a>&nbsp;
Security Considerations<br />
<a href="#ianaCons">10.</a>&nbsp;
IANA Considerations<br />
<a href="#ack">11.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>RFC 4072 <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> specifies a Diameter application that carries EAP
                packets between a Diameter client and the Diameter Server/EAP
                server. <a class='info' href='#I-D.ietf-hokey-erx'>[2]<span> (</span><span class='info'>Narayanan, V. and L. Dondeti, &ldquo;EAP Extensions for EAP Re-authentication Protocol (ERP),&rdquo; March&nbsp;2008.</span><span>)</span></a> defines the EAP Re-authentication
                Protocol to allow faster re-authentication of a previously authenticated peer. In
                ERP, a peer authenticates to the network by proving possession of key material
                derived during a previous EAP exchange. For this purpose, an Extended Master Session
                Key (EMSK) based re-authentication key hierarchy has been defined <a class='info' href='#I-D.ietf-hokey-emsk-hierarchy'>[5]<span> (</span><span class='info'>Salowey, J., Dondeti, L., Narayanan, V., and M. Nakhjiri, &ldquo;Specification for the Derivation of Root Keys from an Extended Master  Session Key (EMSK),&rdquo; June&nbsp;2008.</span><span>)</span></a>. ERP may be executed between the ER
                peer and an ER server in the peer's home domain or the local domain visited by the
                peer. In the latter case, a Domain Specific Root Key (DSRK), derived from the EMSK,
                is provided to the local domain ER server. The peer and the local server
                subsequently use the re-authentication key hierarchy from the DSRK to authenticate
                and derive authenticator specific keys within that domain. To accomplish the reauthentication
                functionality, ERP defines two new EAP codes - EAP Initiate and EAP Finish. This document specifies the
                reuse of Diameter EAP application to carry these new EAP messages.
</p>
<p>The DSRK can be obtained as part of the regular EAP exchange or as part of an ERP
                bootstrapping exchange. The local ER server requesting the DSRK needs to be in the
                path of the EAP or ERP bootstrapping exchange in order to request and obtain the
                DSRK. This document also specifies how the DSRK is transported to the local ER server using Diameter. 
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p> The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
                "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be
                interpreted as described in RFC 2119 <a class='info' href='#RFC2119'>[3]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>. 
</p>
<p> This document uses terminology defined in <a class='info' href='#RFC3748'>[6]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>, <a class='info' href='#I-D.ietf-hokey-emsk-hierarchy'>[5]<span> (</span><span class='info'>Salowey, J., Dondeti, L., Narayanan, V., and M. Nakhjiri, &ldquo;Specification for the Derivation of Root Keys from an Extended Master  Session Key (EMSK),&rdquo; June&nbsp;2008.</span><span>)</span></a>, <a class='info' href='#I-D.ietf-hokey-erx'>[2]<span> (</span><span class='info'>Narayanan, V. and L. Dondeti, &ldquo;EAP Extensions for EAP Re-authentication Protocol (ERP),&rdquo; March&nbsp;2008.</span><span>)</span></a>,
                and <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>. 
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Assumptions</h3>

<p>This document defines additional optional AVPs for usage with the Diameter EAP
                application. Routing of these messages is therefore provided via the Diameter
                Application Identifier (among other elements), as specified by the Diameter Base
                protocol <a class='info' href='#RFC3588'>[4]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. Based on the deployment of ERP, a local Diameter server (the same
                entity serves as a Diameter proxy during the full EAP authentication)
                may play the role of the ER server for future re-authentication attempts. As such,
                the local Diameter server requesting the DSRK needs to be in the path of the current EAP
                exchange between the peer and the EAP server and also along in the future. The
                Diameter client is furthermore assumed to be able to route the re-authentication
                messages to the ER server. 
</p>
<a name="diameter_support"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Diameter Support for ERP</h3>

<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Protocol Overview</h3>

<p>Diameter may be used to transport ERP messages between the NAS (authenticator)
                    and an authentication server (ER server).
</p>
<p>In ERP, the peer sends an EAP Initiate Reauth message to the ER server via the
                    authenticator. Alternatively, the NAS may send an EAP Initiate Reauth-Start
                    message to the peer to trigger the start of ERP; the peer then responds with an
                    EAP Initiate Reauth message to the NAS.
</p>
<p>The general guidelines for encapsulating EAP messages in Diameter from RFC 4072
                        <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> apply to the new EAP messages defined for ERP as
                    well. The EAP Initiate Reauth message is encapsulated in an EAP-Payload AVP of a
                    Diameter EAP-Request message by the NAS and sent to the Diameter server. The NAS
                    MUST copy the contents of the value field of the 'rIKName as NAI' TLV or the
                    peer-id TLV (when the former is not present) of the EAP Initiate Reauth message
                    into a User-Name AVP of the Diameter EAP-Request.
</p>
<p>The ER server processes the EAP Initiate Reauth message in accordance with <a class='info' href='#I-D.ietf-hokey-erx'>[2]<span> (</span><span class='info'>Narayanan, V. and L. Dondeti, &ldquo;EAP Extensions for EAP Re-authentication Protocol (ERP),&rdquo; March&nbsp;2008.</span><span>)</span></a>, and if that is successful, it responds with
                    an EAP Finish Reauth message indicating a success ('R' flag set to 0). The
                    Diameter server MUST encapsulate the EAP Finish Reauth message with the R flag
                    set to zero in an EAP-Payload AVP attribute of a Diameter EAP-Answer message. An
                    EAP-Master-Session-Key AVP included in the Diameter EAP-Answer contains the
                    Re-authentication Master Session Key (rMSK). The Diameter Result Code, if any,
                    SHOULD be a success Result Code. 
</p>
<p>If the processing of the EAP Initiate Reauth message resulted in a failure, the
                    Diameter server MUST encapsulate an EAP Finish Reauth message indicating failure
                    ('R' flag set to 1) in an EAP-Payload AVP of a Diameter EAP-Answer message. The
                    Diameter Result Code, if any, SHOULD be a failure Result Code. Whether an EAP
                    Finish Reauth message is sent at all is specified in <a class='info' href='#I-D.ietf-hokey-erx'>[2]<span> (</span><span class='info'>Narayanan, V. and L. Dondeti, &ldquo;EAP Extensions for EAP Re-authentication Protocol (ERP),&rdquo; March&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="dsrk"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
DSRK Request and Delivery</h3>

<p>A local ER server, collocated with a Diameter proxy in the peer's visited domain,
                    may request a DSRK from the EAP server, either in the initial EAP exchange
                    (implicit bootstrapping) or in an ERP bootstrapping exchange (explicit
                    bootstrapping). It does this by including the EAP-DSRK-Request AVP in the
                    Diameter EAP-Response message. The EAP-DSRK-Request AVP contains the domain or
                    server identity required to derive the DSRK. 
</p>
<p>An EAP server MAY send the DSRK when it receives a valid Diameter EAP-Request
                    message containing an EAP-DSRK-Request AVP. An ER server MUST send the DSRK (or
                    send a failure result) when it receives a valid Diameter EAP-Request message
                    containing an EAP-DSRK-Request AVP along with a valid EAP Initiate Re-auth
                    packet with the bootstrapping flag turned on. If an EAP-DSRK-Request AVP is
                    included in any other Diameter EAP-Request message, the Diameter server MUST
                    reply with a failure result. An EAP-DSRK AVP MUST be used to send a DSRK; an
                    EAP-DSRK-Name AVP MUST be used to send the DSRK's keyname; and an
                    EAP-DSRK-Lifetime AVP MUST be used to send the DSRK's lifetime.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Command Codes</h3>

<p> This document re-uses the EAP application commands <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>:
</p>
<p>
                <br /><hr class="insert" />
<a name="cmd"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
Command-Name             Abbrev.   Code     Reference  Application

Diameter-EAP-Request      DER       268      RFC 4072   EAP
Diameter-EAP-Answer       DEA       268      RFC 4072   EAP
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: ERP Command Codes&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p>Re-Auth-Request (RAR) may trigger ERP.
</p>
<p>Session-Termination-Request
                (STR), Session-Termination-Answer (STA), Abort-Session-Request (ASR),
                Abort-Session-Answer (ASA), Accounting-Request (ACR), and Accounting-Answer (ACA)
                commands are used together with Diameter ERP, they follow the rules in the Diameter
                EAP application <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> and the Diameter Base specification <a class='info' href='#RFC3588'>[4]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>. The accounting commands use the Application Identifier value
                of 3 (Diameter Base Accounting); the others use 0 (Diameter Common Messages). 
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Diameter-EAP-Request (DER)</h3>

<p>The Diameter-EAP-Request (DER) message <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>, indicated by the
                    Command- Code field set to 268 and the 'R' bit set in the Command Flags field,
                    is sent by the NAS to the Diameter server to initiate a network access
                    authentication and authorization procedure.
</p>
<p>The DEA message format is the same as defined in <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> with an
                    addition of optional EAP Re-authentication Protocol (ERP) AVPs. The addition of
                    the EAP-DSRK-Request AVP to the Diameter-EAP-Request message indicates that an
                    ERP server is present and willing to participate in the ERP protocol for this
                    session. Furthermore, the EAP-DSRK-Request AVP provides identity information
                    about the domain of the ERP server. 
</p>
<p>
                    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  &lt;Diameter-EAP-Request&gt; ::= &lt; Diameter Header: 268, REQ, PXY &gt;
                             &lt; Session-Id &gt;
                             { Auth-Application-Id }
                             { Origin-Host }
                             { Origin-Realm }
                             { Destination-Realm }
                             { Auth-Request-Type }

                             [ EAP-DSRK-Request ]

                             [ User-Name ]
                             [ Destination-Host ]
                             ...
                           * [ AVP ]
</pre></div><p>

                
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Diameter-EAP-Answer (DEA)</h3>

<p>The Diameter-EAP-Answer (DEA) message defined in <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>,
                    indicated by the Command-Code field set to 268 and 'R' bit cleared in the
                    Command Flags field, is sent in response to the Diameter-EAP-Request message
                    (DER). 
</p>
<p>The DEA message format is the same as defined in <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a> with an
                    addition of optional EAP Re-authentication Protocol (ERP) AVPs. The addition of
                    the EAP-DSRK, EAP-DSRK-Name and the EAP-DSRK-Lifetime AVP to the
                    Diameter-EAP-Answer message indicates that an Diameter / ER server is able to
                    provide ERP support for this session and delivers keying material, lifetime and
                    a key name. 
</p>
<p>
                    </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  &lt;Diameter-EAP-Answer&gt; ::= &lt; Diameter Header: 268, PXY &gt;
                            &lt; Session-Id &gt;
                            { Auth-Application-Id }
                            { Auth-Request-Type }
                            { Result-Code }
                            { Origin-Host }
                            { Origin-Realm }

                            [ EAP-DSRK ]
                            [ EAP-DSRK-Name ]
                            [ EAP-DSRK-Lifetime ]

                            [ User-Name ]
                            ...
                          * [ AVP ]
</pre></div><p>

                
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Attribute Value Pair Definitions</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
EAP-DSRK-Request AVP</h3>

<p>The EAP-DSRK AVP (AVP Code TBD) is of type DiameterIdentity. This AVP fulfills
                    two purposes: First, it indicates that a ER server is located in the local
                    domain that is willing to play the role of an ER server for a particular
                    session. Second, it conveys information about the domain and ER server identity
                    to the Diameter/EAP server. 
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
EAP-DSRK AVP</h3>

<p>The EAP-DSRK AVP (AVP Code TBD) is of type OctetString. The Domain Specific Root
                    Key (DSRK) is carried in this payload. 
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
EAP-DSRK-Name AVP</h3>

<p>The EAP-DSRK-Name AVP (AVP Code TBD) is of type OctetString. This AVP contains
                    the name of the DSRK key that is later used during the re-authentication
                    exchange to select the correct DSRK. 
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.4"></a><h3>6.4.&nbsp;
EAP-DSRK-Lifetime AVP</h3>

<p>The EAP-DSRK-Lifetime AVP (AVP Code TBD) is of type Unsigned64 and contains the
                    DSRK lifetime in seconds.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
AVP Occurrence Table</h3>

<p>The following table lists the AVPs that may optionally be present in the DER and DEA
                commands <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>. 
</p>
<p>
                <br /><hr class="insert" />
<a name="naspavptable"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                +---------------+
                                |  Command-Code |
                                +-+-----+-----+-+
   Attribute Name                 | DER | DEA |
   -------------------------------|-----+-----+
   EAP-DSRK-Request               | 0-1 |  0  |
   EAP-DSRK                       |  0  | 0-1 |
   EAP-DSRK-Name                  |  0  | 0-1 |
   EAP-DSRK-Lifetime              |  0  | 0-1 |
                                  +-----+-----+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: DER and
                        DEA Commands AVP Table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p>When the EAP-DSRK AVP is present in the DEA then the EAP-DSRK-Name and the
                EAP-DSRK-Lifetime MUST also be present.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
AVP Flag Rules</h3>

<p>The following table describes the Diameter AVPs, their AVP Code values, types,
                possible flag values, and whether the AVP MAY be encrypted. The Diameter base <a class='info' href='#RFC3588'>[4]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> specifies the AVP Flag rules for AVPs in Section 4.5. 
</p>
<p>
                <br /><hr class="insert" />
<a name="flagstable"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                                          +---------------------+
                                          |    AVP Flag Rules   |
                                          +----+-----+----+-----+----+
                   AVP  Section           |    |     |SHLD|MUST |    |
Attribute Name     Code Defined Data Type |MUST| MAY |NOT |NOT  |Encr|
------------------------------------------+----+-----+----+-----+----+
EAP-DSRK-Request   TBD  4.7.1  DiamIdent  |    |  P  |    | V,M | Y  |
EAP-DSRK           TBD  4.7.2  OctetString|    |  P  |    | V,M | Y  |
EAP-DSRK-Name      TBD  4.7.3  OctetString|    |  P  |    | V,M | Y  |
EAP-DSRK-Lifetime  TBD  4.7.4  Unsigned64 |    |  P  |    | V,M | Y  |
------------------------------------------+----+-----+----+-----+----+

Due to space constraints, the short form DiamIdent is used to
represent DiameterIdentity.
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: AVP Flag Rules Table&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<a name="SecCons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Security Considerations</h3>

<p>The security considerations specified in RFC 4072 <a class='info' href='#RFC4072'>[1]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>,
                and RFC 3588 <a class='info' href='#RFC3588'>[4]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a> are applicable
                to this document. 
</p>
<p>EAP channel bindings may be necessary to ensure that the Diameter client and the
                server are in sync regarding the key Requesting Entity's Identity. Specifically, the
                Requesting Entity advertises its identity through the EAP lower layer, and the user
                or the EAP peer communicates that identity to the EAP server (and the EAP server
                communicates that identity to the Diameter server) via the EAP method for user/peer
                to server verification of the Requesting Entity's Identity. 
</p>
<a name="ianaCons"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
IANA Considerations</h3>

<p>This document requires IANA registration of the following new AVPs to the AVP
                registry established by RFC 3588 <a class='info' href='#RFC3588'>[4]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>: </p>
<ul class="text">
<li>EAP-DSRK-Request
</li>
<li>EAP-DSRK
</li>
<li>EAP-DSRK-Name
</li>
<li>EAP-DSRK-Lifetime
</li>
</ul><p>
            
</p>
<a name="ack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgments</h3>

<p>Vidya Narayanan reviewed a rough draft version and found some errors. Many thanks for
                her input.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC4072">[1]</a></td>
<td class="author-text">Eronen, P., Hiller, T., and G. Zorn, &ldquo;<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>,&rdquo; RFC&nbsp;4072, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4072.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-hokey-erx">[2]</a></td>
<td class="author-text">Narayanan, V. and L. Dondeti, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-hokey-erx-14.txt">EAP Extensions for EAP Re-authentication Protocol (ERP)</a>,&rdquo; draft-ietf-hokey-erx-14 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-hokey-erx-14.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[3]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3588">[4]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-hokey-emsk-hierarchy">[5]</a></td>
<td class="author-text">Salowey, J., Dondeti, L., Narayanan, V., and M. Nakhjiri, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-hokey-emsk-hierarchy-07.txt">Specification for the Derivation of Root Keys from an Extended Master  Session Key (EMSK)</a>,&rdquo; draft-ietf-hokey-emsk-hierarchy-07 (work in progress), June&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-hokey-emsk-hierarchy-07.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[6]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lakshminath Dondeti</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">QUALCOMM, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5775 Morehouse Dr</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">San Diego, CA</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1 858-845-1267</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ldondeti@qualcomm.com">ldondeti@qualcomm.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Otto-Hahn-Ring 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Munich, Bavaria  81739</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@nsn.com">Hannes.Tschofenig@nsn.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.com">http://www.tschofenig.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
