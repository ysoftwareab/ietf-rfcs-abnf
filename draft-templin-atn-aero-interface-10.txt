



Network Working Group                                    F. Templin, Ed.
Internet-Draft                                        The Boeing Company
Intended status: Standards Track                               A. Whyman
Expires: July 5, 2020                    MWA Ltd c/o Inmarsat Global Ltd
                                                         January 2, 2020


   Transmission of IPv6 Packets over Aeronautical ("aero") Interfaces
                  draft-templin-atn-aero-interface-10

Abstract

   Aeronautical mobile nodes (e.g., aircraft of various configurations)
   communicate with networked correspondents over multiple access
   network data links and configure mobile routers to connect their on-
   board networks.  An Air-to-Ground (A/G) interface specification is
   therefore needed for coordination with the ground domain network.
   This document specifies the transmission of IPv6 packets over
   aeronautical ("aero") interfaces.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on July 5, 2020.

Copyright Notice

   Copyright (c) 2020 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must



Templin & Whyman          Expires July 5, 2020                  [Page 1]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Requirements  . . . . . . . . . . . . . . . . . . . . . . . .   4
   4.  Aeronautical ("aero") Interface Model . . . . . . . . . . . .   4
   5.  Maximum Transmission Unit . . . . . . . . . . . . . . . . . .   7
   6.  Frame Format  . . . . . . . . . . . . . . . . . . . . . . . .   7
   7.  Link-Local Addresses  . . . . . . . . . . . . . . . . . . . .   7
   8.  Address Mapping - Unicast . . . . . . . . . . . . . . . . . .   8
   9.  Address Mapping - Multicast . . . . . . . . . . . . . . . . .  12
   10. Address Mapping for IPv6 Neighbor Discovery Messages  . . . .  13
   11. Conceptual Sending Algorithm  . . . . . . . . . . . . . . . .  13
     11.1.  Multiple Aero Interfaces . . . . . . . . . . . . . . . .  14
   12. Router Discovery and Prefix Registration  . . . . . . . . . .  14
   13. Detecting and Responding to MSE Failures  . . . . . . . . . .  17
   14. IANA Considerations . . . . . . . . . . . . . . . . . . . . .  17
   15. Security Considerations . . . . . . . . . . . . . . . . . . .  18
   16. Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  18
   17. References  . . . . . . . . . . . . . . . . . . . . . . . . .  18
     17.1.  Normative References . . . . . . . . . . . . . . . . . .  18
     17.2.  Informative References . . . . . . . . . . . . . . . . .  20
   Appendix A.  AERO Option Extensions for Pseudo-DSCP Mappings  . .  21
   Appendix B.  Prefix Length Considerations . . . . . . . . . . . .  22
   Appendix C.  VDL Mode 2 Considerations  . . . . . . . . . . . . .  22
   Appendix D.  Change Log . . . . . . . . . . . . . . . . . . . . .  23
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  25

1.  Introduction

   Aeronautical Mobile Nodes (MNs) such as aircraft of various
   configurations often have multiple data links for communicating with
   networked correspondents.  These data links may have differing
   performance, cost and availability characteristics that can change
   dynamically according to mobility patterns, flight phases, proximity
   to infrastructure, etc.

   Each MN receives an IPv6 Mobile Network Prefix (MNP) that can be used
   by on-board networks independently of the access network data links
   selected for data transport.  The MN performs router discovery (i.e.,
   similar to IPv6 customer edge routers [RFC7084]) and acts as a mobile
   router on behalf of its on-board networks.





Templin & Whyman          Expires July 5, 2020                  [Page 2]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   The MN configures a virtual interface (termed the "aero interface")
   as a thin layer over the underlying access network interfaces.  The
   aero interface is therefore the only interface abstraction exposed to
   the IPv6 layer and behaves according to the Non-Broadcast, Multiple
   Access (NBMA) interface principle, while underlying access network
   interfaces appear as link layer communication channels in the
   architecture.  The aero interface connects to a virtual overlay cloud
   service known as the "aero link".  The aero link spans a worldwide
   Internetwork that may be either a private-use infrastructure or the
   global public Internet itself.

   The aero interface provides a traffic engineering nexus for guiding
   inbound and outbound traffic to the correct underlying Access Network
   (ANET) interface(s).  The IPv6 layer sees the aero interface as a
   point of connection to the aero link.  Each aero link has one or more
   associated Mobility Service Prefixes (MSPs) from which aero link MNPs
   are derived.  If there are multiple aero links, the IPv6 layer will
   see multiple aero interfaces.

   The aero interface interacts with the ground-domain Mobility Service
   (MS) through IPv6 Neighbor Discovery (ND) control message exchanges
   [RFC4861].  The MS provides Mobility Service Endpoints (MSEs) that
   track MN movements and represent their MNPs in a global routing or
   mapping system.

   This document specifies the transmission of IPv6 packets [RFC8200]
   and MN/MS control messaging over aeronautical ("aero") interfaces.

2.  Terminology

   The terminology in the normative references applies; especially, the
   terms "link" and "interface" are the same as defined in the IPv6
   [RFC8200] and IPv6 Neighbor Discovery (ND) [RFC4861] specifications.

   The following terms are defined within the scope of this document:

   Access Network (ANET)
      a data link service network (e.g., an aviation radio access
      network, satellite service provider network, cellular operator
      network, etc.) protected by physical and/or link layer security.
      Each ANET provides an Access Router (AR), and connects to outside
      Internetworks via border security devices such as proxys,
      firewalls, packet filtering gateways, etc.

   ANET interface
      a node's attachment to a link in an ANET.

   Internetwork (INET)



Templin & Whyman          Expires July 5, 2020                  [Page 3]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


      a connected network region with a coherent IP addressing plan that
      provides transit forwarding services for ANET mobile nodes and
      INET correspondents.  Examples include private enterprise
      networks, aviation networks and the global public Internet itself.

   INET interface
      a node's attachment to a link in an INET.

   aero link
      a virtual overlay cloud service configured over one or more INETs
      and their connected ANETs.  An aero link may comprise multiple
      INET segments joined by bridges the same as for any link; the
      addressing plans in each segment may be mutually exclusive and
      managed by different administrative entities.

   aero interface
      a node's attachment to an aero link, and configured over one or
      more underlying ANET/INET interfaces.

   aero address
      an IPv6 link-local address constructed as specified in Section 7,
      and assigned to an aero interface.

3.  Requirements

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].  Lower case
   uses of these words are not to be interpreted as carrying RFC2119
   significance.

4.  Aeronautical ("aero") Interface Model

   An aero interface is a MN virtual interface configured over one or
   more ANET interfaces, which may be physical (e.g., an aeronautical
   radio link) or virtual (e.g., an Internet or higher-layer "tunnel").
   The MN coordinates with the MS through IPv6 ND message exchanges.

   The aero interface architectural layering model is the same as in
   [RFC7847], and augmented as shown in Figure 1.  The IPv6 layer
   therefore sees the aero interface as a single network layer interface
   with multiple underlying ANET interfaces that appear as link layer
   communication channels in the architecture.








Templin & Whyman          Expires July 5, 2020                  [Page 4]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


                                     +----------------------------+
                                     |          TCP/UDP           |
              Session-to-IP    +---->|                            |
              Address Binding  |     +----------------------------+
                               +---->|            IPv6            |
              IP Address       +---->|                            |
              Binding          |     +----------------------------+
                               +---->|       aero Interface       |
              Logical-to-      +---->|       (aero address)       |
              Physical         |     +----------------------------+
              Interface        +---->|  L2  |  L2  |       |  L2  |
              Binding                |(IF#1)|(IF#2)| ..... |(IF#n)|
                                     +------+------+       +------+
                                     |  L1  |  L1  |       |  L1  |
                                     |      |      |       |      |
                                     +------+------+       +------+

           Figure 1: Aero Interface Architectural Layering Model

   The aero virtual interface model gives rise to a number of
   opportunities:

   o  since aero interface link-local addresses are uniquely derived
      from an MNP (see: Section 7, no Duplicate Address Detection (DAD)
      messaging is necessary over the aero interface.

   o  ANET interfaces can remain unnumbered in environments where
      communications are coordinated entirely over the aero interface.

   o  as ANET interface properties change (e.g., link quality, cost,
      availability, etc.), any active ANET interface can be used to
      update the profiles of multiple additional ANET interfaces in a
      single message.  This allows for timely adaptation and service
      continuity under dynamically changing conditions.

   o  coordinating ANET interfaces in this way allows them to be
      represented in a unified MS profile with provisions for mobility
      and multilink operations.

   o  exposing a single virtual interface abstraction to the IPv6 layer
      allows for traffic engineering (including QoS based link
      selection, packet replication, load balancing, etc.) at the link
      layer while still permitting queuing at the IPv6 layer based on,
      e.g., traffic class, flow label, etc.

   o  the IPv6 layer sees the aero interface as a point of connection to
      the aero link; if there are multiple aero links (i.e., multiple
      MS's), the IPv6 layer will see multiple aero interfaces.



Templin & Whyman          Expires July 5, 2020                  [Page 5]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   Other opportunities are discussed in [RFC7847].

   Figure 2 depicts the architectural model for a MN connecting to the
   MS via multiple independent ANETs.  When an ANET interface becomes
   active, the MN sends native (i.e., unencapsulated) IPv6 ND messages
   via the underlying ANET interface.  IPv6 ND messages traverse the
   ground domain ANETs until they reach an Access Router (AR#1, AR#2,
   .., AR#n).  The AR then coordinates with a Mobility Service Endpoint
   (MSE#1, MSE#2, ..., MSE#m) in the INET and returns an IPv6 ND message
   response to the MN.  IPv6 ND messages traverse the ANET at layer 2;
   hence, the Hop Limit is not decremented.

                           +--------------+
                           |      MN      |
                           +--------------+
                           |aero interface|
                           +----+----+----+
                  +--------|IF#1|IF#2|IF#n|------ +
                 /         +----+----+----+        \
                /                 |                 \
               /         Native   |   IPv6           \
              v                   v                   v
           (:::)-.              (:::)-.              (:::)-.
      .-(::ANET:::)        .-(::ANET:::)        .-(::ANET:::)
        `-(::::)-'           `-(::::)-'           `-(::::)-'
          +----+               +----+               +----+
    ...   |AR#1|  ..........   |AR#2|   .........   |AR#n|  ...
   .      +-|--+               +-|--+               +-|--+     .
   .        |                    |                    |
   .        v                    v                    v        .
   .               <-----  Encapsulation ----->                .
   .                                                           .
   .      +-----+               (:::)-.                        .
   .      |MSE#2|           .-(::::::::)          +-----+      .
   .      +-----+       .-(:::   INET  :::)-.     |MSE#m|      .
   .                  (:::::    Routing  ::::)    +-----+      .
   .                     `-(::: System :::)-'                  .
   .  +-----+                `-(:::::::-'                      .
   .  |MSE#1|          +-----+               +-----+           .
   .  +-----+          |MSE#3|               |MSE#4|           .
   .                   +-----+               +-----+           .
   .                                                           .
   .                                                           .
   .       <----- Worldwide Connected Internetwork ---->       .
    ...........................................................

              Figure 2: MN/MS Coordination via Multiple ANETs




Templin & Whyman          Expires July 5, 2020                  [Page 6]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   After the initial IPv6 ND message exchange, the MN can send and
   receive unencapsulated IPv6 data packets over the aero interface.
   Traffic engineering will forward the packets via ARs in the correct
   underlying ANETs.  The AR encapsulates the packets according to the
   capabilities provided by the MS and forwards them to the next hop
   within the worldwide connected Internetwork via optimal routes.

5.  Maximum Transmission Unit

   All IPv6 interfaces MUST configure an MTU of at least 1280 bytes
   [RFC8200].  The aero interface configures its MTU based on the
   largest MTU among all underlying ANET interfaces.  The value may be
   overridden if an RA message with an MTU option is received.

   The aero interface returns internally-generated IPv6 Path MTU
   Discovery (PMTUD) Packet Too Big (PTB) messages [RFC8201] for packets
   admitted into the aero interface that are too large for the outbound
   underlying ANET interface.  Similarly, the aero interface performs
   PMTUD even if the destination appears to be on the same link since a
   proxy on the path could return a PTB message.  PMTUD therefore
   ensures that the aero interface MTU is adaptive and reflects the
   current path used for a given data flow.

   Applications that cannot tolerate loss due to MTU restrictions should
   refrain from sending packets larger than 1280 bytes, since dynamic
   path changes can reduce the path MTU at any time.  Applications that
   may benefit from sending larger packets even though the path MTU may
   change dynamically can use larger sizes.

6.  Frame Format

   The aero interface transmits IPv6 packets according to the native
   frame format of each underlying ANET interface.  For example, for
   Ethernet-compatible interfaces the frame format is specified in
   [RFC2464], for aeronautical radio interfaces the frame format is
   specified in standards such as ICAO Doc 9776 (VDL Mode 2 Technical
   Manual), for tunnels over IPv6 the frame format is specified in
   [RFC2473], etc.

7.  Link-Local Addresses

   Aero interfaces assign link-local addresses the same as any IPv6
   interface.  The link-local address format for aero interfaces is
   known as the "aero address".

   MN aero addresses begin with the prefix fe80::/64 followed by a
   64-bit prefix taken from the MNP (see: Appendix B).  The lowest-
   numbered aero address serves as the "base" address.  The MN uses the



Templin & Whyman          Expires July 5, 2020                  [Page 7]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   base aero address in IPv6 ND messages, but accepts packets destined
   to all aero addresses equally.  For example, for the MNP
   2001:db8:1000:2000::/56 the corresponding aero addresses are:

      fe80::2001:db8:1000:2000

      fe80::2001:db8:1000:2001

      fe80::2001:db8:1000:2002

      ... etc. ...

      fe80::2001:db8:1000:20ff

   MSE aero addresses are allocated from the range fe80::/96, and MUST
   be managed for uniqueness by the collective aero link administrative
   authorities.  The lower 32 bits of the address includes a unique
   integer value, e.g., fe80::1, fe80::2, fe80::3, etc.  The address
   fe80:: is the IPv6 link-local Subnet Router Anycast address [RFC4291]
   and the address fe80::ffff:ffff is reserved; hence, these values are
   not available for general assignment.

   The IPv6 addressing architecture [RFC4291] reserves the prefix ::/8;
   this assures that MNPs will not begin with ::/32 so that MN and MSE
   aero addresses cannot overlap.

   Since MN aero addresses are based on the distribution of
   administratively assured unique MNPs, and since MSE aero addresses
   are guaranteed unique through administrative assignment, aero
   interfaces set the autoconfiguration variable DupAddrDetectTransmits
   to 0 [RFC4862].

   IPv4-compatible aero addresses are allocated as fe80::ffff:[v4addr],
   i.e., fe80::/10, followed by 70 '0' bits, followed by 16 '1' bits,
   followed by a 32bit IPv4 address.  IPv4 address usage is outside the
   scope of this document.

8.  Address Mapping - Unicast

   Aero interfaces maintain a neighbor cache for tracking per-neighbor
   state and use the link-local address format specified in Section 7.
   IPv6 Neighbor Discovery (ND) [RFC4861] messages on aero interfaces
   observe the native Source/Target Link-Layer Address Option (S/TLLAO)
   formats of the underlying ANET interfaces (e.g., for Ethernet the S/
   TLLAO is specified in [RFC2464]).

   MNs such as aircraft typically have many wireless data link types
   (e.g. satellite-based, cellular, terrestrial, air-to-air directional,



Templin & Whyman          Expires July 5, 2020                  [Page 8]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   etc.) with diverse performance, cost and availability properties.
   The aero interface would therefore appear to have multiple link layer
   connections, and may include information for multiple ANET interfaces
   in a single message exchange.

   Aero interfaces use a new IPv6 ND option called the "Aeronautical
   Endpoint Registration Option (AERO)".  MNs invoke the MS by including
   an AERO option in Router Solicitation (RS) and (unsolicited) Neighbor
   Advertisement (NA) messages, and the MS includes an AERO option in
   unicast Router Advertisement (RA) responses to an RS.

   RS/NA messages sent by the MN include AERO options formatted as shown
   in Figure 3:






































Templin & Whyman          Expires July 5, 2020                  [Page 9]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Type     |     Length    | Prefix Length |R|  Reserved   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   ifIndex[1]  |   ifType[1]   |   Flags [1]   |Link[1]|QoS[1] |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P00|P01|P02|P03|P04|P05|P06|P07|P08|P09|P10|P11|P12|P13|P14|P15|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P16|P17|P18|P19|P20|P21|P22|P23|P24|P25|P26|P27|P28|P29|P30|P31|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P32|P33|P34|P35|P36|P37|P38|P39|P40|P41|P42|P43|P44|P45|P46|P47|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P48|P49|P50|P51|P52|P53|P54|P55|P56|P57|P58|P59|P60|P61|P62|P63|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   ifIndex[2]  |   ifType[2]   |   Flags [2]   |Link[2]|QoS[2] |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P00|P01|P02|P03|P04|P05|P06|P07|P08|P09|P10|P11|P12|P13|P14|P15|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P16|P17|P18|P19|P20|P21|P22|P23|P24|P25|P26|P27|P28|P29|P30|P31|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P32|P33|P34|P35|P36|P37|P38|P39|P40|P41|P42|P43|P44|P45|P46|P47|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P48|P49|P50|P51|P52|P53|P54|P55|P56|P57|P58|P59|P60|P61|P62|P63|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ...                            ...                            ...
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   ifIndex[N]  |   ifType[N]   |   Flags [N]   |Link[N]|QoS[N] |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P00|P01|P02|P03|P04|P05|P06|P07|P08|P09|P10|P11|P12|P13|P14|P15|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P16|P17|P18|P19|P20|P21|P22|P23|P24|P25|P26|P27|P28|P29|P30|P31|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P32|P33|P34|P35|P36|P37|P38|P39|P40|P41|P42|P43|P44|P45|P46|P47|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P48|P49|P50|P51|P52|P53|P54|P55|P56|P57|P58|P59|P60|P61|P62|P63|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          zero-padding                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Figure 3: Aeronautical Endpoint Registration Option (AERO) Format in
                              RS/NA Messages

   In this format:

   o  Type is set to TBD.





Templin & Whyman          Expires July 5, 2020                 [Page 10]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   o  Length is set to the number of 8 octet blocks in the option (with
      zero-padding added to the end of the option if necessary to
      produce an integral number of 8 octet blocks).

   o  Prefix Length is set to the length of the MNP embedded in the MN's
      aero address.

   o  R (the "Register" bit) is set to '1' to assert the MNP
      registration or set to '0' to request de-registration.

   o  Reserved is set to the value '0' on transmission.

   o  A set of N ANET interface "ifIndex-tuples" are included as
      follows:

      *  ifIndex[i] is set to an 8-bit integer value corresponding to a
         specific underlying ANET interface.  The first ifIndex-tuple
         MUST correspond to the ANET interface over which the message is
         sent.  Once the MN has assigned an ifIndex to an ANET
         interface, the assignment MUST remain unchanged while the MN
         remains registered in the network.  MNs MUST number each
         ifIndex with a value between '1' and '255' that represents a
         MN-specific 8-bit mapping for the actual ifIndex value assigned
         to the ANET interface by network management [RFC2863].

      *  ifType[i] is set to an 8-bit integer value corresponding to the
         underlying ANET interface identified by ifIndex.  The value
         represents an aero interface-specific 8-bit mapping for the
         actual IANA ifType value assigned to the ANET interface by
         network management [RFC2863].

      *  Flags[i] is an 8-bit flags field.  All flag bits are currently
         undefined and set to the value '0' on transmission.  Future
         updates may specify new flags.

      *  Link[i] encodes a 4-bit link metric.  The value '0' means the
         link is DOWN, and the remaining values mean the link is UP with
         metric ranging from '1' ("low") to '15' ("high").

      *  QoS[i] encodes the number of 4-byte blocks (between '0' and
         '15') of two-bit P[i] values that follow.  The first 4 blocks
         correspond to the 64 Differentiated Service Code Point (DSCP)
         values P00 - P63 [RFC2474].  If additional 4-byte P[i] blocks
         follow, their values correspond to "pseudo-DSCP" values P64,
         P65, P66, etc. numbered consecutively.  The pseudo-DSCP values
         correspond to ancillary QoS information defined for the
         specific aero interface (e.g., see Appendix A).




Templin & Whyman          Expires July 5, 2020                 [Page 11]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


      *  P[i] includes zero or more per-ifIndex 4-byte blocks of two-bit
         Preferences.  Each P[i] field is set to the value '0'
         ("disabled"), '1' ("low"), '2' ("medium") or '3' ("high") to
         indicate a QoS preference level for ANET interface selection
         purposes.  The first four blocks always correspond to the 64
         DSCP values.  If one or more of the blocks are absent (e.g.,
         for QoS values 0,1,2,3) the P[i] values for the missing blocks
         default to "medium".

   Unicast RA messages sent by the MS in response to MN RS messages
   include AERO options formatted as shown in Figure 4:

        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Type     |   Length = 1  | Prefix Length |R|  Reserved   |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |    ifIndex    |     ifType    |     Flags     | Link  |  QoS  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   Figure 4: Aeronautical Endpoint Registration Option (AERO) Format in
                                RA messages

   In this format:

   o  Type is set to TBD.

   o  Length is set to the constant value '1' (i.e., 1 unit of 8
      octets).

   o  Prefix Length is set to the length associated with the aero
      address of the destination MN.

   o  R is set to '1' to confirm registration or set to '0' to release/
      decline registration.

   o  ifIndex, ifType, Flags, Link and QoS echo the values of the same
      fields that were received in the first ifIndex-tuple of the
      soliciting RS.  The echoed values provide a nonce that allows the
      MN to associate the received RA with the soliciting RS.

9.  Address Mapping - Multicast

   The multicast address mapping of the native underlying ANET interface
   applies.  The mobile router on board the aircraft also serves as an
   IGMP/MLD Proxy for its EUNs and/or hosted applications per [RFC4605]
   while using the link layer address of the router as the link layer
   address for all multicast packets.



Templin & Whyman          Expires July 5, 2020                 [Page 12]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


10.  Address Mapping for IPv6 Neighbor Discovery Messages

   Per [RFC4861], IPv6 ND messages may be sent to either a multicast or
   unicast link-scoped IPv6 destination address.  However, IPv6 ND
   messaging must be coordinated between the MN and MS only without
   invoking other nodes on the ANET.

   For this reason, ANET links maintain unicast link-layer addresses
   ("MSADDR") for the purpose of supporting MN/MS IPv6 ND messaging.
   For Ethernet-compatible ANETs, this specification reserves one
   Ethernet unicast address 00-00-5E-00-52-14.  For non-Ethernet
   statically-addressed ANETs, MSADDR is reserved per the assigned
   numbers authority for the ANET addressing space.  For still other
   ANETs, MSADDR may be dynamically discovered through other means,
   e.g., link-layer beacons.

   MNs map all IPv6 ND messages they send (i.e., both multicast and
   unicast) to an MSADDR instead of to an ordinary unicast or multicast
   link-layer address.  In this way, all of the MN's IPv6 ND messages
   will be received by MS devices that are configured to accept packets
   destined to MSADDR.  Note that multiple MS devices on the link could
   be configured to accept packets destined to MSADDR, e.g., as a basis
   for supporting redundancy.

   Therefore, ARs MUST accept and process packets destined to MSADDR,
   while all other devices MUST NOT process packets destined to MSADDR.
   This model has a well-established operational experience in Proxy
   Mobile IPv6 (PMIP) [RFC5213][RFC6543].

11.  Conceptual Sending Algorithm

   The MN's IPv6 layer selects the outbound aero interface according to
   standard IPv6 requirements.  The aero interface maintains default
   routes and neighbor cache entries for MSEs, and may also include
   additional neighbor cache entries created through other means (e.g.,
   Address Resolution, static configuration, etc.).

   After a packet enters the aero interface, an outbound ANET interface
   is selected based on traffic engineering information such as DSCP,
   application port number, cost, performance, message size, etc.  Aero
   interface traffic engineering could also be configured to perform
   replication across multiple ANET interfaces for increased reliability
   at the expense of packet duplication.








Templin & Whyman          Expires July 5, 2020                 [Page 13]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


11.1.  Multiple Aero Interfaces

   MNs may associate with multiple MS instances concurrently.  Each MS
   instance represents a distinct aero link distinguished by its
   associated MSPs.  The MN configures a separate aero interface for
   each link so that multiple interfaces (e.g., aero0, aero1, aero2,
   etc.) are exposed to the IPv6 layer.

   Depending on local policy and configuration, an MN may choose between
   alternative active aero interfaces using a packet's DSCP, routing
   information or static configuration.  Interface selection based on
   per-packet source addresses is also enabled when the MSPs for each
   aero interface are known (e.g., discovered through Prefix Information
   Options (PIOs) and/or Route Information Options (RIOs)).

   Each aero interface can be configured over the same or different sets
   of ANET interfaces.  Each ANET distinguishes between the different
   aero links based on the MSPs represented in per-packet IPv6
   addresses.

   Multiple distinct aero links can therefore be used to support fault
   tolerance, load balancing, reliability, etc.  The architectural model
   parallels Layer 2 Virtual Local Area Networks (VLANs), where the MSPs
   serve as (virtual) VLAN tags.

12.  Router Discovery and Prefix Registration

   ARs process IPv6 ND messages destined to all-routers multicast,
   subnet router anycast and unicast link-local IPv6 addresses.  ARs
   configure the link-layer address MSADDR (see: Section 10) and act as
   a proxy for MSE addresses in the range fe80::1 through
   fe80::ffff:fffe.

   MNs interface with the MS by sending RS messages with AERO options.
   For each ANET interface, the MN sends RS messages with AERO options
   with link-layer destination address set to MSADDR and with network-
   layer destination address set to either a specific MSE aero address,
   subnet router anycast, or all-routers multicast.  The MN discovers
   MSE addresses either through an RA message response to an initial
   anycast/multicast RS or before sending an initial RS message.
   [RFC5214] provides example MSE address discovery methods, including
   information conveyed during data link login, name service lookups,
   static configuration, etc.

   The AR receives the RS messages and contacts the corresponding MSE.
   When the MSE responds, the AR returns an RA message with source
   address set to the MSE address, with an AERO option and with any




Templin & Whyman          Expires July 5, 2020                 [Page 14]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   information for the link that would normally be delivered in a
   solicited RA message.

   MNs configure aero interfaces that observe the properties discussed
   in the previous section.  The aero interface and its underlying
   interfaces are said to be in either the "UP" or "DOWN" state
   according to administrative actions in conjunction with the interface
   connectivity status.  An aero interface transitions to UP or DOWN
   through administrative action and/or through state transitions of the
   underlying interfaces.  When a first underlying interface transitions
   to UP, the aero interface also transitions to UP.  When all
   underlying interfaces transition to DOWN, the aero interface also
   transitions to DOWN.

   When an aero interface transitions to UP, the MN sends initial RS
   messages to register its MNP and an initial set of underlying ANET
   interfaces that are also UP.  The MN sends additional RS messages to
   refresh lifetimes and to register/deregister underlying ANET
   interfaces as they transition to UP or DOWN.

   ARs coordinate with the MSE and return RA messages with configuration
   information in response to a MN's RS messages.  The RAs include a
   Router Lifetime value and any necessary options, such as:

   o  PIOs with (A; L=0) that include MSPs for the link [RFC8028].

   o  RIOs [RFC4191] with more-specific routes.

   o  an MTU option that specifies the maximum acceptable packet size
      for the aero link

   The AR sends immediate unicast RA responses without delay; therefore,
   the 'MAX_RA_DELAY_TIME' and 'MIN_DELAY_BETWEEN_RAS' constants for
   multicast RAs do not apply.  The AR MAY send periodic and/or event-
   driven unsolicited RA messages, but is not required to do so for
   unicast advertisements [RFC4861].

   The MN sends RS messages from within the aero interface while using
   an UP underlying ANET interface as the outbound interface.  Each RS
   message is formatted as though it originated from the IPv6 layer, but
   the process is coordinated wholly from within the aero interface and
   is therefore opaque to the IPv6 layer.  The MN sends initial RS
   messages over an UP underlying interface with its aero address as the
   source.  The RS messages include AERO options with a valid Prefix
   Length as well as ifIndex-tuples appropriate for underlying ANET
   interfaces.  The AR processes RS message and forwards the information
   in the AERO option to the MSE.




Templin & Whyman          Expires July 5, 2020                 [Page 15]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   When the MSE processes the AR information, if the prefix registration
   was accepted the MSE injects the MNP into the routing/mapping system
   then caches the new Prefix Length, MNP and ifIndex-tuples.  The MSE
   then coordinates with the AR to return an RA message to the MN with
   an AERO option with a non-zero Router Lifetime if the prefix
   assertion was acceptable; otherwise, with a zero Router Lifetime.

   When the MN receives the RA message, it creates a default route with
   next hop address set to the MSE found in the RA source address and
   with link-layer address set to MSADDR.  The AR will then forward
   packets acting as a proxy between the MN and the MS.

   The MN then manages its underlying ANET interfaces according to their
   states as follows:

   o  When an underlying ANET interface transitions to UP, the MN sends
      an RS over the ANET interface with an AERO option.  The AERO
      option contains a first ifIndex-tuple with values specific to this
      ANET interface, and may contain additional ifIndex-tuples specific
      to other ANET interfaces.

   o  When an underlying ANET interface transitions to DOWN, the MN
      sends an RS or unsolicited NA message over any UP ANET interface
      with an AERO option containing an ifIndex-tuple for the DOWN ANET
      interface with Link(i) set to '0'.  The MN sends an RS when an
      acknowledgement is required, or an unsolicited NA when reliability
      is not thought to be a concern (e.g., if redundant transmissions
      are sent on multiple ANET interfaces).

   o  When a MN wishes to release from a current MSE, it sends RS
      messages over any UP ANET interfaces with an AERO option with R
      set to 0.  The corresponding MSE then withdraws the MNP from the
      routing/mapping system and returns an RA message with an AERO
      option with Router Lifetime set to 0.

   o  When all of a MNs underlying interfaces have transitioned to DOWN,
      the MSE withdraws the MNP the same as if it had received a message
      with an AERO option with R set to 0.

   The MN is responsible for retrying each RS exchange up to
   MAX_RTR_SOLICITATIONS times separated by RTR_SOLICITATION_INTERVAL
   seconds until an RA is received.  If no RA is received over multiple
   UP ANET interfaces, the MN declares this MSE unreachable and tries a
   different MSE.

   The IPv6 layer sees the aero interface as an ordinary IPv6 interface.
   Therefore, when the IPv6 layer sends an RS message the aero interface
   returns an internally-generated RA message as though the message



Templin & Whyman          Expires July 5, 2020                 [Page 16]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   originated from an IPv6 router.  The internally-generated RA message
   contains configuration information (such as Router Lifetime, MTU,
   etc.) that is consistent with the information received from the RAs
   generated by the MS.

   Whether the aero interface IPv6 ND messaging process is initiated
   from the receipt of an RS message from the IPv6 layer is an
   implementation matter.  Some implementations may elect to defer the
   IPv6 ND messaging process until an RS is received from the IPv6
   layer, while others may elect to initiate the process independently
   of any IPv6 layer messaging.

13.  Detecting and Responding to MSE Failures

   In environments where fast recovery from MSE failure is required, ARs
   SHOULD use proactive Neighbor Unreachability Detection (NUD) in a
   manner that parallels Bidirectional Forwarding Detection (BFD)
   [RFC5880] to track MSE reachability.  ARs can then quickly detect and
   react to failures so that cached information is re-established
   through alternate paths.  Proactive NUD control messaging is carried
   only over well-connected ground domain networks (i.e., and not low-
   end aeronautical radio links) and can therefore be tuned for rapid
   response.

   ARs employ proactive NUD with MSEs for which there are currently
   active ANET MNs.  If an MSE fails, ARs can quickly inform MNs of the
   outage by sending RA messages on the ANET interface.  The AR sends RA
   messages with source address set to the MSEs address, destination
   address set to all-nodes multicast, and Router Lifetime set to 0.

   The AR SHOULD send MAX_FINAL_RTR_ADVERTISEMENTS RA messages separated
   by small delays [RFC4861].  Any MNs on the ANET interface that have
   been using the (now defunct) MSE will receive the RA messages and
   associate with a new MSE.

14.  IANA Considerations

   The IANA is instructed to allocate an official Type number from the
   IPv6 Neighbor Discovery Option Formats registry for the Aero
   Registration (AR) option.  Implementations set Type to 253 as an
   interim value [RFC4727].

   The IANA is instructed to allocate one Ethernet unicast address,
   00-00-5E-00-52-14 [RFC5214] in the registry "IANA Ethernet Address
   Block - Unicast Use".






Templin & Whyman          Expires July 5, 2020                 [Page 17]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


15.  Security Considerations

   Security considerations are the same as defined for the specific
   access network interface types, and readers are referred to the
   appropriate interface specifications.

   IPv6 and IPv6 ND security considerations also apply, and are
   specified in the normative references.

16.  Acknowledgements

   The first version of this document was prepared per the consensus
   decision at the 7th Conference of the International Civil Aviation
   Organization (ICAO) Working Group-I Mobility Subgroup on March 22,
   2019.  Consensus to take the document forward to the IETF was reached
   at the 9th Conference of the Mobility Subgroup on November 22, 2019.
   Attendees and contributors included: Guray Acar, Danny Bharj,
   Francois D'Humieres, Pavel Drasil, Nikos Fistas, Giovanni Garofolo,
   Bernhard Haindl, Vaughn Maiolla, Tom McParland, Victor Moreno, Madhu
   Niraula, Brent Phillips, Liviu Popescu, Jacky Pouzet, Aloke Roy, Greg
   Saccone, Robert Segers, Michal Skorepa, Michel Solery, Stephane
   Tamalet, Fred Templin, Jean-Marc Vacher, Bela Varkonyi, Tony Whyman,
   Fryderyk Wrobel and Dongsong Zeng.

   The following individuals are acknowledged for their useful comments:
   Pavel Drasil, Zdenek Jaron, Michael Matyas, Madhu Niraula, Greg
   Saccone, Stephane Tamalet.  Naming of the IPv6 ND option was
   discussed on the 6man mailing list.

   This work is aligned with the NASA Safe Autonomous Systems Operation
   (SASO) program under NASA contract number NNA16BD84C.

   This work is aligned with the FAA as per the SE2025 contract number
   DTFAWA-15-D-00030.

17.  References

17.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.








Templin & Whyman          Expires July 5, 2020                 [Page 18]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   [RFC2474]  Nichols, K., Blake, S., Baker, F., and D. Black,
              "Definition of the Differentiated Services Field (DS
              Field) in the IPv4 and IPv6 Headers", RFC 2474,
              DOI 10.17487/RFC2474, December 1998,
              <https://www.rfc-editor.org/info/rfc2474>.

   [RFC4191]  Draves, R. and D. Thaler, "Default Router Preferences and
              More-Specific Routes", RFC 4191, DOI 10.17487/RFC4191,
              November 2005, <https://www.rfc-editor.org/info/rfc4191>.

   [RFC4291]  Hinden, R. and S. Deering, "IP Version 6 Addressing
              Architecture", RFC 4291, DOI 10.17487/RFC4291, February
              2006, <https://www.rfc-editor.org/info/rfc4291>.

   [RFC4727]  Fenner, B., "Experimental Values In IPv4, IPv6, ICMPv4,
              ICMPv6, UDP, and TCP Headers", RFC 4727,
              DOI 10.17487/RFC4727, November 2006,
              <https://www.rfc-editor.org/info/rfc4727>.

   [RFC4861]  Narten, T., Nordmark, E., Simpson, W., and H. Soliman,
              "Neighbor Discovery for IP version 6 (IPv6)", RFC 4861,
              DOI 10.17487/RFC4861, September 2007,
              <https://www.rfc-editor.org/info/rfc4861>.

   [RFC4862]  Thomson, S., Narten, T., and T. Jinmei, "IPv6 Stateless
              Address Autoconfiguration", RFC 4862,
              DOI 10.17487/RFC4862, September 2007,
              <https://www.rfc-editor.org/info/rfc4862>.

   [RFC8028]  Baker, F. and B. Carpenter, "First-Hop Router Selection by
              Hosts in a Multi-Prefix Network", RFC 8028,
              DOI 10.17487/RFC8028, November 2016,
              <https://www.rfc-editor.org/info/rfc8028>.

   [RFC8200]  Deering, S. and R. Hinden, "Internet Protocol, Version 6
              (IPv6) Specification", STD 86, RFC 8200,
              DOI 10.17487/RFC8200, July 2017,
              <https://www.rfc-editor.org/info/rfc8200>.

   [RFC8201]  McCann, J., Deering, S., Mogul, J., and R. Hinden, Ed.,
              "Path MTU Discovery for IP version 6", STD 87, RFC 8201,
              DOI 10.17487/RFC8201, July 2017,
              <https://www.rfc-editor.org/info/rfc8201>.








Templin & Whyman          Expires July 5, 2020                 [Page 19]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


17.2.  Informative References

   [RFC2225]  Laubach, M. and J. Halpern, "Classical IP and ARP over
              ATM", RFC 2225, DOI 10.17487/RFC2225, April 1998,
              <https://www.rfc-editor.org/info/rfc2225>.

   [RFC2464]  Crawford, M., "Transmission of IPv6 Packets over Ethernet
              Networks", RFC 2464, DOI 10.17487/RFC2464, December 1998,
              <https://www.rfc-editor.org/info/rfc2464>.

   [RFC2473]  Conta, A. and S. Deering, "Generic Packet Tunneling in
              IPv6 Specification", RFC 2473, DOI 10.17487/RFC2473,
              December 1998, <https://www.rfc-editor.org/info/rfc2473>.

   [RFC2863]  McCloghrie, K. and F. Kastenholz, "The Interfaces Group
              MIB", RFC 2863, DOI 10.17487/RFC2863, June 2000,
              <https://www.rfc-editor.org/info/rfc2863>.

   [RFC4605]  Fenner, B., He, H., Haberman, B., and H. Sandick,
              "Internet Group Management Protocol (IGMP) / Multicast
              Listener Discovery (MLD)-Based Multicast Forwarding
              ("IGMP/MLD Proxying")", RFC 4605, DOI 10.17487/RFC4605,
              August 2006, <https://www.rfc-editor.org/info/rfc4605>.

   [RFC5213]  Gundavelli, S., Ed., Leung, K., Devarapalli, V.,
              Chowdhury, K., and B. Patil, "Proxy Mobile IPv6",
              RFC 5213, DOI 10.17487/RFC5213, August 2008,
              <https://www.rfc-editor.org/info/rfc5213>.

   [RFC5214]  Templin, F., Gleeson, T., and D. Thaler, "Intra-Site
              Automatic Tunnel Addressing Protocol (ISATAP)", RFC 5214,
              DOI 10.17487/RFC5214, March 2008,
              <https://www.rfc-editor.org/info/rfc5214>.

   [RFC5880]  Katz, D. and D. Ward, "Bidirectional Forwarding Detection
              (BFD)", RFC 5880, DOI 10.17487/RFC5880, June 2010,
              <https://www.rfc-editor.org/info/rfc5880>.

   [RFC6543]  Gundavelli, S., "Reserved IPv6 Interface Identifier for
              Proxy Mobile IPv6", RFC 6543, DOI 10.17487/RFC6543, May
              2012, <https://www.rfc-editor.org/info/rfc6543>.

   [RFC7084]  Singh, H., Beebee, W., Donley, C., and B. Stark, "Basic
              Requirements for IPv6 Customer Edge Routers", RFC 7084,
              DOI 10.17487/RFC7084, November 2013,
              <https://www.rfc-editor.org/info/rfc7084>.





Templin & Whyman          Expires July 5, 2020                 [Page 20]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   [RFC7421]  Carpenter, B., Ed., Chown, T., Gont, F., Jiang, S.,
              Petrescu, A., and A. Yourtchenko, "Analysis of the 64-bit
              Boundary in IPv6 Addressing", RFC 7421,
              DOI 10.17487/RFC7421, January 2015,
              <https://www.rfc-editor.org/info/rfc7421>.

   [RFC7847]  Melia, T., Ed. and S. Gundavelli, Ed., "Logical-Interface
              Support for IP Hosts with Multi-Access Support", RFC 7847,
              DOI 10.17487/RFC7847, May 2016,
              <https://www.rfc-editor.org/info/rfc7847>.

Appendix A.  AERO Option Extensions for Pseudo-DSCP Mappings

   Adaptation of the aero interface to specific Internetworks such as
   the Aeronautical Telecommunications Network with Internet Protocol
   Services (ATN/IPS) includes link selection preferences based on
   transport port numbers in addition to the existing DSCP-based
   preferences.  ATN/IPS nodes maintain a map of transport port numbers
   to additional "pseudo-DSCP" P[i] preference fields beyond the first
   64.  For example, TCP port 22 maps to pseudo-DSCP value P67, TCP port
   443 maps to P70, UDP port 8060 maps to P76, etc.  Figure 5 shows an
   example AERO option with extended P[i] values beyond the base 64 used
   for DSCP mapping (i.e., for QoS values 5 or greater):

        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |      Type     |    Length     | Prefix Length |R|   Reserved  |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |    ifIndex    |    ifType     |     Flags     | Link  |QoS=5+ |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P00|P01|P02|P03|P04|P05|P06|P07|P08|P09|P10|P11|P12|P13|P14|P15|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P16|P17|P18|P19|P20|P21|P22|P23|P24|P25|P26|P27|P28|P29|P30|P31|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P32|P33|P34|P35|P36|P37|P38|P39|P40|P41|P42|P43|P44|P45|P46|P47|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P48|P49|P50|P51|P52|P53|P54|P55|P56|P57|P58|P59|P60|P61|P62|P63|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |P64|P65|P66|P67|P68|P69|P70|P71|P72|P73|P74|P75|P76|P77|P78|P79|
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       ...

               Figure 5: ATN/IPS Extended Aero Option Format







Templin & Whyman          Expires July 5, 2020                 [Page 21]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


Appendix B.  Prefix Length Considerations

   The 64-bit boundary in IPv6 addresses [RFC7421] determines the MN
   aero address format for encoding the most-significant 64 MNP bits
   into the least-significant 64 bits of the prefix fe80::/64 as
   discussed in Section 7.

   [RFC4291] defines the link-local address format as fe80::/10,followed
   by 54 unused bits, followed by the least-significant 64 bits of the
   address.  If the 64-bit boundary is relaxed through future standards
   activity, then the 54 unused bits can be employed for extended coding
   of MNPs of length /65 up to /118.

   The extended coding format would continue to encode MNP bits 0-63 in
   bits 64-127 of the aero address, while including MNP bits 64-117 in
   bits 10-63.  For example, the aero address corresponding to the MNP
   2001:db8:1111:2222:3333:4444:5555::/112 would be
   fe8c:ccd1:1115:5540:2001:db8:1111:2222, and would still be a valid
   IPv6 link-local unicast address per [RFC4291].

Appendix C.  VDL Mode 2 Considerations

   ICAO Doc 9776 is the "Technical Manual for VHF Data Link Mode 2"
   (VDLM2) that specifies an essential radio frequency data link service
   for aircraft and ground stations in worldwide civil aviation air
   traffic management.  The VDLM2 link type is "multicast capable"
   [RFC4861], but with considerable differences from common multicast
   links such as Ethernet and IEEE 802.11.

   First, the VDLM2 link data rate is only 31.5Kbps - multiple orders of
   magnitude less than most modern wireless networking gear.  Second,
   due to the low available link bandwidth only VDLM2 ground stations
   (i.e., and not aircraft) are permitted to send broadcasts, and even
   so only as compact layer 2 "beacons".  Third, aircraft employ the
   services of ground stations by performing unicast RS/RA exchanges
   upon receipt of beacons instead of listening for multicast RA
   messages and/or sending multicast RS messages.

   This beacon-oriented unicast RS/RA approach is necessary to conserve
   the already-scarce available link bandwidth.  Moreover, since the
   numbers of beaconing ground stations operating within a given spatial
   range must be kept as sparse as possible, it would not be feasible to
   have different classes of ground stations within the same region
   observing different protocols.  It is therefore highly desirable that
   all ground stations observe a common language of RS/RA as specified
   in this document.





Templin & Whyman          Expires July 5, 2020                 [Page 22]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


Appendix D.  Change Log

   << RFC Editor - remove prior to publication >>

   Differences from draft-templin-atn-aero-interface-09 to draft-
   templin-atn-aero-interface-10:

   o  Renamed ARO option to AERO option

   o  Re-worked Section 13 text to discuss proactive NUD.

   Differences from draft-templin-atn-aero-interface-08 to draft-
   templin-atn-aero-interface-09:

   o  Version and reference update

   Differences from draft-templin-atn-aero-interface-07 to draft-
   templin-atn-aero-interface-08:

   o  Removed "Classic" and "MS-enabled" link model discussion

   o  Added new figure for MN/AR/MSE model.

   o  New Section on "Detecting and responding to MSE failure".

   Differences from draft-templin-atn-aero-interface-06 to draft-
   templin-atn-aero-interface-07:

   o  Removed "nonce" field from AR option format.  Applications that
      require a nonce can include a standard nonce option if they want
      to.

   o  Various editorial cleanups.

   Differences from draft-templin-atn-aero-interface-05 to draft-
   templin-atn-aero-interface-06:

   o  New Appendix C on "VDL Mode 2 Considerations"

   o  New Appendix D on "RS/RA Messaging as a Single Standard API"

   o  Various significant updates in Section 5, 10 and 12.

   Differences from draft-templin-atn-aero-interface-04 to draft-
   templin-atn-aero-interface-05:

   o  Introduced RFC6543 precedent for focusing IPv6 ND messaging to a
      reserved unicast link-layer address



Templin & Whyman          Expires July 5, 2020                 [Page 23]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   o  Introduced new IPv6 ND option for Aero Registration

   o  Specification of MN-to-MSE message exchanges via the ANET access
      router as a proxy

   o  IANA Considerations updated to include registration requests and
      set interim RFC4727 option type value.

   Differences from draft-templin-atn-aero-interface-03 to draft-
   templin-atn-aero-interface-04:

   o  Removed MNP from aero option format - we already have RIOs and
      PIOs, and so do not need another option type to include a Prefix.

   o  Clarified that the RA message response must include an aero option
      to indicate to the MN that the ANET provides a MS.

   o  MTU interactions with link adaptation clarified.

   Differences from draft-templin-atn-aero-interface-02 to draft-
   templin-atn-aero-interface-03:

   o  Sections re-arranged to match RFC4861 structure.

   o  Multiple aero interfaces

   o  Conceptual sending algorithm

   Differences from draft-templin-atn-aero-interface-01 to draft-
   templin-atn-aero-interface-02:

   o  Removed discussion of encapsulation (out of scope)

   o  Simplified MTU section

   o  Changed to use a new IPv6 ND option (the "aero option") instead of
      S/TLLAO

   o  Explained the nature of the interaction between the mobility
      management service and the air interface

   Differences from draft-templin-atn-aero-interface-00 to draft-
   templin-atn-aero-interface-01:

   o  Updates based on list review comments on IETF 'atn' list from
      4/29/2019 through 5/7/2019 (issue tracker established)





Templin & Whyman          Expires July 5, 2020                 [Page 24]

Internet-Draft          IPv6 over AERO Interfaces           January 2020


   o  added list of opportunities afforded by the single virtual link
      model

   o  added discussion of encapsulation considerations to Section 6

   o  noted that DupAddrDetectTransmits is set to 0

   o  removed discussion of IPv6 ND options for prefix assertions.  The
      aero address already includes the MNP, and there are many good
      reasons for it to continue to do so.  Therefore, also including
      the MNP in an IPv6 ND option would be redundant.

   o  Significant re-work of "Router Discovery" section.

   o  New Appendix B on Prefix Length considerations

   First draft version (draft-templin-atn-aero-interface-00):

   o  Draft based on consensus decision of ICAO Working Group I Mobility
      Subgroup March 22, 2019.

Authors' Addresses

   Fred L. Templin (editor)
   The Boeing Company
   P.O. Box 3707
   Seattle, WA  98124
   USA

   Email: fltemplin@acm.org


   Tony Whyman
   MWA Ltd c/o Inmarsat Global Ltd
   99 City Road
   London  EC1Y 1AX
   England

   Email: tony.whyman@mccallumwhyman.com












Templin & Whyman          Expires July 5, 2020                 [Page 25]
