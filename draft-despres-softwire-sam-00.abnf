eLOC=E...    E <====S                        |
E=R.X  |                        |
                 customer SAM                   |
                       |                        |
R = rule exterior prefix = D[.C]
P = rule interior prefix = K[.H]
C = domain-exterior-prefix code (optional)
H = domain-exterior-prefix code (optional)
X = customer index (length x)
T = lifetime (optional)

iDST = P.(eDST-R).0*/p...
iDST = G
iDST = P.(eDST-R).0*/p...
E=2001:db8:9:c610:202:1002/96(v6) |                        |
E=2001:db8:9:c610:202:1003/96(v6) |                        |
P2 = 192.168.0.0/16.  The customer exterior prefix, which determines
K3=198.36.0.0/16), and one IPv6 prefix to be used for SAM (D=2001:
E=2001:db8:c610:202                 |
E=2001:db8:c622:202                 |
E=2001:db8:c624:202                 |
cn=e-d-xn=20-xn, Cn=n000::/cn :
E=198.16.4.4 <====S                            |
G=2001:db8:::1}, customer sites that are assigned /48 prefixes are
D1=198.16.0.0/14, D2=198.36.0.0/15, and D3=198.34.0.0/15.  Its IPv6
x1=18; G=2001:d00::1}, {R2=198.36.0.0/15; P2=2001:d20::/31; x2=17;
G=2001:d00::1}, and {R3=198.16.0.0/15; P3=2001:d30::/31; x3=17.
G=2001:d00::1}.  With them, customer sites of the ISP have each one
E=198.16.4.4 <====S                              |
E=198.34.5.5 <====S                              |
E=198.36.7.7 <====S                              |
E1=22001:db8::1:8:0:3:3:3/128(v6)        |
E2=2001:db8:2:2208:3:3:3:3/128(v6)       |
                 |                              |
P=fc00::/56; x=72; G=fc00::7:0:0:0:1} and {R2=2001:db8:2:2200::/
E1=22001:db8::1:8:0:3:3:3/128(v6)  <- unique address
E2=2001:db8:2:2208:3:3:3:3/128(v6) <- valid address
E3=2001:db8::3:8:3:3:3:3/128(v6)   <- preferred address
               |                              |
G1=fc00::7:0:0:0:1; T1=40,000}
G2=fc00::6:0:0:0:1; T2=32,000}
G2=fc00::6:0:0:0:1; T2=43,200}


I=fd12:3456:7890:9:4:4:4:/128(v6)
                     |                       K1=fd12:3456:7890::/56(v6)
E=2001:db8:1:9:4:4:4:4/128(v6)


I=fd09:8765:4321:88:3:3:3:3/128(v6)
                     |
                     |        ||     /\      K2=fd09:8765:4321::/56(v6)
E=2001:db8:2:2288:3:3:3:3/128(v6)

                 MAPPING RULES: {Rn=Dn.Cn; Pn=Kn; x; Gn}
              with e=i=128, Cn=::/e-x-dn, Pn=Kn, x= 72:
G1=fd12:3456:7890::1}
G2=fd09:8765:4321::1}



x1=68; G1=fd12:3456:7890::1}, and in site-2{R2=2001:db8:2:2200:/56;
P2=fd09:8765:4321::/56(v6); x2=72; G2=fd09:8765:4321::1}.

eDST = 2001:db8:2:2288:3:3:3:3 which matches, the customer exterior
G1=fd12:3456:7890::1} and {R2=2001:db8:2:2200:/56; P1=fd12:3456:
E1=2001:660:7301:3040/60(v6) <- IPv6 public prefix
E2=192.108.119.26.4/40(v4)   <- 240 ports on a public IPv4 address
                |                           (15/16*2^(48-40))
E1=2001:660:7301:3042:/64(v6)  <- IPv6 public prefix
E2=192.108.119.26.4.32/44(v4)  <- 15 ports on a public IPv4 address
          |               |              (15/16*2^(48-44))
