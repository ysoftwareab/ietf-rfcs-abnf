<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IP Flow Information eXport (IPFIX) Testing</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IP Flow Information eXport (IPFIX) Testing">
<meta name="keywords" content="RFC, Request for Comments, I-D, Internet-Draft, IPFIX, IP Flow Information Export, Test Specification">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IPFIX Working Group</td><td class="header">C. Schmoll</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Fraunhofer FOKUS</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">P. Aitken</td></tr>
<tr><td class="header">Expires: April 19, 2008</td><td class="header">B. Claise</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">October 17, 2007</td></tr>
</table></td></tr></table>
<h1><br />IP Flow Information eXport (IPFIX) Testing<br />draft-ietf-ipfix-testing-02.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on April 19, 2008.</p>

<h3>Abstract</h3>

<p>
                This document presents a list of tests that implementers of IP
                Flow Information Export (IPFIX) compliant Exporting Processes
                and Collecting Processes should perform on their IPFIX
                Exporting Process and/or Collecting Process.  This document has
                been created to help implementers test the functionality of
                their IPFIX Exporting Process and/or Collecting Process.  The
                goal of these tests is to ensure that all important functions
                are covered by tests and thereby to gain a level of confidence
                in the Exporting Process and Collecting Process that allows the
                implementer to perform interoperability or plug tests with
                other IPFIX Exporting Processes and Collecting Processes.
            
</p>
<h3>Conventions used in this document</h3>

<p>
                The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
                "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
                and "OPTIONAL" in this document are to be interpreted as
                described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
            
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Motivation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Document Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
IPFIX Documents Overview<br />
<a href="#anchor5">2.</a>&nbsp;
Terminology<br />
<a href="#anchor6">3.</a>&nbsp;
Test Specifications<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#connectivity">3.1.</a>&nbsp;
Exporting Process / Collecting Process connectivity
	    tests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.1.1.</a>&nbsp;
Connectivity tests between Exporting Process
                and Collecting Process<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.2.</a>&nbsp;
Template and Data Record tests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">3.2.1.</a>&nbsp;
Transmission of Template with fixed
                size Information Elements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">3.2.2.</a>&nbsp;
Transmission of Template with
                variable length Information Elements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">3.2.3.</a>&nbsp;
Set Padding<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.2.4.</a>&nbsp;
Record Padding<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.2.5.</a>&nbsp;
Template Withdrawal Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">3.3.</a>&nbsp;
Information Element tests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">3.3.1.</a>&nbsp;
Enterprise-specific Information Elements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">3.3.2.</a>&nbsp;
Reduced Size Encoding of Information Elements<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">3.3.3.</a>&nbsp;
Multiple instances of the same Information
                Element in one Template<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor22">3.4.</a>&nbsp;
Options Template tests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">3.4.1.</a>&nbsp;
Using any Information Elements as Scope<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">3.4.2.</a>&nbsp;
Using multiple Scopes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">3.4.3.</a>&nbsp;
Metering Process Statistics Option
                Template<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">3.4.4.</a>&nbsp;
Metering Process Reliability Statistics
                Option Template<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor27">3.4.5.</a>&nbsp;
Exporting Process Reliability Statistics
                Option Template<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">3.4.6.</a>&nbsp;
Flow Keys Option Template<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">3.5.</a>&nbsp;
Stress/Load tests<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">3.5.1.</a>&nbsp;
Large number of Records for one Template<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">3.5.2.</a>&nbsp;
Excessive rate of incoming Data Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">3.5.3.</a>&nbsp;
Large Templates<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">3.5.4.</a>&nbsp;
Many new Templates within Data Template timeout
                interval<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor34">3.5.5.</a>&nbsp;
Multiple Exporting Processes exporting to one
                Collecting Process<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor35">3.5.6.</a>&nbsp;
Export from one Exporting Process to multiple
                Collecting Processes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor36">3.6.</a>&nbsp;
Error handling<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor37">3.6.1.</a>&nbsp;
Temporary network disconnect<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor38">3.6.2.</a>&nbsp;
Exporting Process termination and restart
                during data transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor39">3.6.3.</a>&nbsp;
Collecting Process termination and restart
                during data transmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor40">3.6.4.</a>&nbsp;
Incorrect Template Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor41">3.6.5.</a>&nbsp;
Incorrect Data Record<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">3.6.6.</a>&nbsp;
Export of non-matching Template and Data
                Records<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">3.6.7.</a>&nbsp;
Incorrect Set IDs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">3.6.8.</a>&nbsp;
Re-using Template IDs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tls-connectivity">3.7.</a>&nbsp;
TLS connectivity and policy selection<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tls-setup">3.7.1.</a>&nbsp;
TLS test setup<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tls-tcp-connectivity">3.7.2.</a>&nbsp;
TLS over TCP connectivity test<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tls-udp-connectivity">3.7.3.</a>&nbsp;
DTLS over UDP connectivity test<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#tls-sctp-connectivity">3.7.4.</a>&nbsp;
DTLS over PR-SCTP connectivity test<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor54">3.7.5.</a>&nbsp;
TLS bidirectional authentication policy test<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor55">3.7.6.</a>&nbsp;
Exporting Process Identity Mismatch TLS Policy
                test<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor56">3.7.7.</a>&nbsp;
Collecting Process Identity Mismatch TLS Policy
                test<br />
<a href="#anchor57">4.</a>&nbsp;
Security considerations<br />
<a href="#anchor58">5.</a>&nbsp;
IANA considerations<br />
<a href="#anchor59">6.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative references<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative references<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
                The IPFIX protocol has been developed for the purpose
                of exporting IP Flow information from devices such as
                routers or measurement stations to mediation,
                accounting, and network management systems. It is
                intended for the purposes of QoS and traffic
                measurement, attack and intrusion detection reporting,
                accounting, billing and Internet research.
            
</p>
<p>
                The IPFIX architecture
                <a class='info' href='#I-D.ietf-ipfix-architecture'>[I&#8209;D.ietf&#8209;ipfix&#8209;architecture]<span> (</span><span class='info'>Sadasivan, G., &ldquo;Architecture for IP Flow Information Export,&rdquo; September&nbsp;2006.</span><span>)</span></a> defines the
                different components that are involved in the data export
                process. For a testable IPFIX software toolkit one needs at
                least one IPFIX Exporting Process and one IPFIX Collecting
                Process.  The Exporting Process communicates information
                regarding Flows from the Metering Process to the Collecting
                Process via SCTP, TCP, or UDP transports. The Collecting
                Process  may then e.g., store the Data Record into a database
                or transfer it directly to an application for further
                processing.
            
</p>
<p>
                An implementation of these IPFIX components in
                software, firmware, or hardware needs to be tested
                thoroughly in order to check its robustness and the
                conformity to the IPFIX documents it is based on. This
                document specifies tests that should be run in order
                to check the IPFIX Exporting Process and Collecting Process and
                to gain a high confidence in the conformity, robustness, and
                correct behavior of such implementation.
            
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Motivation</h3>

<p>
                    The main driving force for preparing this document is the
                    observation that protocols for data exchange often fail to
                    work properly when implementations from different companies
                    or organizations are in use together. This happens even
                    more often when testing binary protocols. In many cases
                    this even holds true when tests had previously been
                    performed successfully using an Exporting Process and
                    Collecting Process from a single implementer. The tests
                    listed here can form a valuable common basis for
                    implementers involved in interoperability testing when all
                    of them use these tests to check their own Exporting
                    Process and Collecting Process implementation first.
                
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Document Scope</h3>

<p>
                    This document lists tests intended to be performed between
                    an implementation of an IPFIX Exporting Process and an
                    IPFIX Collecting Process. For some tests multiple instances
                    of each of those components (Observation Points, Metering
                    Process, Exporting Process, Collecting Process) are
                    involved. The tests range from basic transport connectivity
                    to export of Template and associated Data Records, high
                    load on the Collecting Process, and error condition
                    situations.
                
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
IPFIX Documents Overview</h3>

<p>
                    The IPFIX protocol <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>
                    provides network administrators with access to IP Flow
                    information.  The architecture for the export of measured
                    IP Flow information out of an IPFIX Exporting Process to a
                    Collecting Process is defined in <a class='info' href='#I-D.ietf-ipfix-architecture'>[I&#8209;D.ietf&#8209;ipfix&#8209;architecture]<span> (</span><span class='info'>Sadasivan, G., &ldquo;Architecture for IP Flow Information Export,&rdquo; September&nbsp;2006.</span><span>)</span></a>, per the
                    requirements defined in <a class='info' href='#RFC3917'>[RFC3917]<span> (</span><span class='info'>Quittek, J., Zseby, T., Claise, B., and S. Zander, &ldquo;Requirements for IP Flow Information Export (IPFIX),&rdquo; October&nbsp;2004.</span><span>)</span></a>.  <a class='info' href='#I-D.ietf-ipfix-architecture'>[I&#8209;D.ietf&#8209;ipfix&#8209;architecture]<span> (</span><span class='info'>Sadasivan, G., &ldquo;Architecture for IP Flow Information Export,&rdquo; September&nbsp;2006.</span><span>)</span></a> specifies how IPFIX
                    data records and Templates are carried via a
                    congestion-aware transport protocol from IPFIX Exporting
                    Processes to IPFIX Collecting Process.  IPFIX has a formal
                    description of IPFIX Information Elements, their name, type
                    and additional semantic information, as specified in <a class='info' href='#I-D.ietf-ipfix-info'>[I&#8209;D.ietf&#8209;ipfix&#8209;info]<span> (</span><span class='info'>Quittek, J., &ldquo;Information Model for IP Flow Information Export,&rdquo; February&nbsp;2007.</span><span>)</span></a>.  Finally <a class='info' href='#I-D.ietf-ipfix-as'>[I&#8209;D.ietf&#8209;ipfix&#8209;as]<span> (</span><span class='info'>Zseby, T., &ldquo;IPFIX Applicability,&rdquo; July&nbsp;2007.</span><span>)</span></a> describes what type of
                    applications can use the IPFIX protocol and how they can
                    use the information provided.  It furthermore shows how the
                    IPFIX framework relates to other architectures and
                    frameworks.
                
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>
                The terminology used in this document is fully aligned
                with the terminology defined in
                <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a> which is reproduced
                here for reference.
            
</p>
<p>
                </p>
<blockquote class="text"><dl>
<dt>Observation Point</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        An Observation Point is a location in the network
                        where IP packets can be observed.  Examples
                        include: a line to which a probe is attached, a
                        shared medium, such as an Ethernet-based LAN, a
                        single port of a router, or a set of interfaces
                        (physical or logical) of a router.
                    
</dd>
<dt></dt>
<dd>
                        Note that every Observation Point is associated
                        with an Observation Domain (defined below), and
                        that one Observation Point may be a superset of
                        several other Observation Points.  For example one
                        Observation Point can be an entire line card.  That
                        would be the superset of the individual Observation
                        Points at the line card's interfaces.
                    
</dd>
<dt>Observation Domain</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        An Observation Domain is the largest set of
                        Observation Points for which Flow information can
                        be aggregated by a Metering Process.  For example,
                        a router line card may be an Observation Domain if
                        it is composed of several interfaces, each of which
                        is an Observation Point. In the IPFIX Message it
                        generates, the Observation Domain includes its
                        Observation Domain ID, which is unique per
                        Exporting Process.  That way, the Collecting
                        Process can identify the specific Observation
                        Domain from the Exporter that sends the IPFIX
                        Messages.  Every Observation Point is associated
                        with an Observation Domain.
                    
</dd>
<dt></dt>
<dd>
                       It is RECOMMENDED that Observation Domain IDs are
                       also unique per IPFIX Device.
                    
</dd>
<dt>IP Traffic Flow or Flow</dt>
<dd>
</dd>
<dt></dt>
<dd>
                       There are several definitions of the term 'flow'
                       being used by the Internet community.  Within the
                       context of IPFIX we use the following definition:
                    
</dd>
<dt></dt>
<dd>
                       A Flow is defined as a set of IP packets passing an
                       Observation Point in the network during a certain
                       time interval.  All packets belonging to a
                       particular Flow have a set of common properties.
                       Each property is defined as the result of applying a
                       function to the values of:

                        
<ol class="text">
<li>
                                one or more packet header fields (e.g.
                                destination IP address), transport
                                header fields (e.g.  destination port
                                number), or application header
                                fields (e.g. RTP header fields <a class='info' href='#RFC3550'>[RFC3550]<span> (</span><span class='info'>Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;RTP: A Transport Protocol for Real-Time Applications,&rdquo; July&nbsp;2003.</span><span>)</span></a>.)
                            
</li>
<li>
                                one or more characteristics of the packet
                                itself (e.g. number of MPLS labels, etc...)
                            
</li>
<li>
                                one or more of fields derived from packet
                                treatment (e.g. next hop IP address, the
                                output interface, etc...)
                            
</li>
</ol>
                    
</dd>
<dt></dt>
<dd>
                        A packet is defined to belong to a Flow if it
                        completely satisfies all the defined properties of
                        the Flow.
                    
</dd>
<dt></dt>
<dd>
                        This definition covers the range from a Flow
                        containing all packets observed at a network
                        interface to a Flow consisting of just a single
                        packet between two applications.  It includes
                        packets selected by a sampling mechanism.
                    
</dd>
<dt>Flow Key</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        Each of the fields which

                        
<ol class="text">
<li>
                               Belong to the packet header (e.g.
                               destination IP address)
                            
</li>
<li>
                               Are a property of the packet itself (e.g.
                               packet length)
                            
</li>
<li>
                               Are derived from packet treatment (e.g. AS
                               number)
                            
</li>
</ol>

                        and which are used to define a Flow are termed Flow
                        Keys.
                    
</dd>
<dt>Flow Record</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        A Flow Record contains information about a specific
                        Flow that was observed at an Observation Point.  A
                        Flow Record contains measured properties of the
                        Flow (e.g. the total number of bytes for all the
                        Flow's packets) and usually characteristic
                        properties of the Flow (e.g. source IP address).
                    
</dd>
<dt>Metering Process</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        The Metering Process generates Flow Records.
                        Inputs to the process are packet headers and
                        characteristics observed at an Observation Point,
                        and packet treatment at the Observation Point (for
                        example the selected output interface).
                    
</dd>
<dt></dt>
<dd>
                        The Metering Process consists of a set of functions
                        that includes packet header capturing,
                        timestamping, sampling, classifying, and
                        maintaining Flow Records.
                    
</dd>
<dt></dt>
<dd>
                        The maintenance of Flow Records may include
                        creating new records, updating existing ones,
                        computing Flow statistics, deriving further Flow
                        properties, detecting Flow expiration, passing Flow
                        Records to the Exporting Process, and deleting Flow
                        Records.
                    
</dd>
<dt>Exporting Process</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        The Exporting Process sends Flow Records to one or
                        more Collecting Processes.  The Flow Records are
                        generated by one or more Metering Processes.
                    
</dd>
<dt>Exporter</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        A device which hosts one or more Exporting
                        Processes is termed an Exporter.
                    
</dd>
<dt>IPFIX Device</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        An IPFIX Device hosts at least one Exporting
                        Process.  It may host further Exporting processes
                        and arbitrary numbers of Observation Points and
                        Metering Process.
                    
</dd>
<dt>Collecting Process</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        A Collecting Process receives Flow Records from one
                        or more Exporting Processes.  The Collecting
                        Process might process or store received Flow
                        Records, but such actions are out of scope for this
                        document.
                    
</dd>
<dt>Collector</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        A device which hosts one or more Collecting
                        Processes is termed a Collector.
                    
</dd>
<dt>Template</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        Template is a ordered sequence of {type, length}
                        pairs, used to completely specify the structure and
                        semantics of a particular set of information that
                        needs to be communicated from an IPFIX Device to a
                        Collector.  Each Template is uniquely identifiable
                        by means of a Template ID.
                    
</dd>
<dt>IPFIX Message</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        An IPFIX Message is a message originating at the
                        Exporting Process that carries the IPFIX records of
                        this Exporting Process and whose destination is a
                        Collecting Process.  An IPFIX Message is
                        encapsulated at the transport layer.
                    
</dd>
<dt>Message Header</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        The Message Header is the first part of an IPFIX
                        Message, which provides basic information about the
                        message such as the IPFIX version, length of the
                        message, message sequence number, etc.
                    
</dd>
<dt>Template Record</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        A Template Record defines the structure and
                        interpretation of fields in a Data Record.
                    
</dd>
<dt>Data Record</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        A Data Record is a record that contains values of
                        the parameters corresponding to a Template Record.
                    
</dd>
<dt>Options Template Record</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        An Options Template Record is a Template Record
                        that defines the structure and interpretation of
                        fields in a Data Record, including defining how to
                        scope the applicability of the Data Record.
                    
</dd>
<dt>Set</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        Set is a generic term for a collection of records
                        that have a similar structure.  In an IPFIX
                        Message, one or more Sets follow the Message
                        Header.
                    
</dd>
<dt></dt>
<dd>
                        There are three different types of Sets: Template
                        Set, Options Template Set, and Data Set.
                    
</dd>
<dt>Template Set</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        A Template Set is a collection of one or more
                        Template Records that have been grouped together in
                        an IPFIX Message.
                    
</dd>
<dt>Options Template Set</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        An Options Template Set is a collection of one or
                        more Options Template Records that have been
                        grouped together in an IPFIX Message.
                    
</dd>
<dt>Data Set</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        A Data Set is one or more Data Records, of the same
                        type, that are grouped together in an IPFIX
                        Message.  Each Data Record is previously defined by
                        a Template Record or an Options Template Record.
                    
</dd>
<dt>Information Element</dt>
<dd>
</dd>
<dt></dt>
<dd>
			An Information Element is a protocol and encoding
			independent description of an attribute which may
			appear in an IPFIX Record.  The IPFIX information model
			<a class='info' href='#I-D.ietf-ipfix-info'>[I&#8209;D.ietf&#8209;ipfix&#8209;info]<span> (</span><span class='info'>Quittek, J., &ldquo;Information Model for IP Flow Information Export,&rdquo; February&nbsp;2007.</span><span>)</span></a> defines the base
			set of Information Elements for IPFIX.  The type
			associated with an Information Element indicates
			constraints on what it may contain and also determines
			the valid encoding mechanisms for use in IPFIX.
                    
</dd>
<dt>Transport Session</dt>
<dd>
</dd>
<dt></dt>
<dd>
                        In SCTP, the transport session is known as the SCTP
                        association, which is uniquely identified by the
                        SCTP endpoints <a class='info' href='#RFC2960'>[RFC2960]<span> (</span><span class='info'>Stewart, R., Xie, Q., Morneault, K., Sharp, C., Schwarzbauer, H., Taylor, T., Rytina, I., Kalla, M., Zhang, L., and V. Paxson, &ldquo;Stream Control Transmission Protocol,&rdquo; October&nbsp;2000.</span><span>)</span></a>; in TCP,
                        the transport session is known as the TCP
                        connection, which is uniquely identified by the
                        combination of IP addresses and TCP ports used; In
                        UDP, the transport session is known as the UDP
                        session, which is uniquely identified by the
                        combination of IP addresses and UDP ports used.
                    
</dd>
</dl></blockquote><p>
            
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Test Specifications</h3>

<p>
                The tests described in this section MAY be performed using
                an IPFIX Exporting Process on one host and an IPFIX Collecting
                Process on a different host.  The configuration of the
                Observation Point, Metering Process, Exporting Process, and
                Collection Process SHOULD be recorded for every test along with
                the test results.
            
</p>
<p>
                All tests described in this section MUST be successfully
                executed for an IPFIX architecture to be compliant with this
                document.
            
</p>
<a name="connectivity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Exporting Process / Collecting Process connectivity
	    tests</h3>

<p>
                    This section lists the basic tests that MUST succeed as a
                    precondition for the more complex tests defined in later
                    sections of this document.
                
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Connectivity tests between Exporting Process
                and Collecting Process</h3>

<p>
                        The tester MUST set one Exporting Process and one
                        Collecting Process, MUST configure the Exporting
                        Process to export at least one Template Set and
                        associated Data Records to the Collecting Process, and
                        MUST cause the Exporting Process to initiate the
                        export.
                    
</p>
<p>
                        The tester MUST ensure that an SCTP association (or TCP
                        connection) is established.
                    
</p>
<p>
                        The tester MUST ensure that the Transport Session
                        parameters (IP addresses and ports) are correct.
                    
</p>
<p>
                        The tester MUST ensure that the Data Records are
                        actually exported. The transmitted data might be
                        observed on-line with an appropriate tool such as
                        Wireshark (www.wireshark.org).
                    
</p>
<p>
                        The tester MUST record which combinations of IPv4 and
                        IPv6 transports, and UDP, SCTP, and TCP transmission
                        protocols are supported, and MUST perform the test for
                        all the supported combinations.
                    
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Template and Data Record tests</h3>

<p>
                    This section lists tests for checking the correct
                    transmission of IPFIX Template Sets and associated Data
                    Sets.
                
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
Transmission of Template with fixed
                size Information Elements</h3>

<p>
                        The tester MUST create a Template with a few fixed-size
                        Information Elements, and cause the Template and
                        associated Data Records to be exported over all
                        applicable combinations of transports and protocols in
                        <a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST ensure that the Template and associated
                        Data Records were correctly received and decoded by the
                        Collecting Process.
                    
</p>
<p>
                        The tester MUST use various Information Elements in the
                        Template so that each data type specified in
                        <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>
                        (octet, unsigned16, unsigned32 ...)
                        is used in at least one test.
                    
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
Transmission of Template with
                variable length Information Elements</h3>

<p>
                        The tester MUST create a Template with a mixture of
                        fixed-sized and variable length Information Elements,
                        and cause the Template and associated Data Records to
                        be exported over all applicable combinations of
                        transports and protocols in
			<a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST ensure that the Template contains:
                        </p>
<ul class="text">
<li>
                                a single variable length Information Element
                            
</li>
<li>
                                a single variable length Information Element
                                followed by a fixed length Information Element
                            
</li>
<li>
                                a fixed length Information Element followed by
                                a variable length Information Element
                            
</li>
<li>
                                multiple variable length Information Elements
                            
</li>
</ul><p>
                    
</p>
<p>
                        The tester MUST ensure that the Template and associated
                        Data Records were correctly received and decoded by the
                        Collecting Process.
                    
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.3"></a><h3>3.2.3.&nbsp;
Set Padding</h3>

<p>
                        Section 3.3.1 of
                        <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>
                        specifies IPFIX Set alignment using padding.
                    
</p>
<p>
                        The tester MUST create two Data Sets with padding
                        in between consisting of zero valued octets, as shown
                        in <a class='info' href='#zero-padding'>Figure&nbsp;1</a>, MUST cause them to be
                        exported to the Collecting Process, and MUST ensure
                        that both Data Sets and all the Data Records were
                        correctly received and decoded by the Collecting
                        Process.
                    
</p><br /><hr class="insert" />
<a name="zero-padding"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+--------------------------------------------------+
| Set Header #1                                    |
+--------------------------------------------------+
| Data Record                                      |
+--------------------------------------------------+
| Data Record                                      |
+--------------------------------------------------+
   ...
+--------------------------------------------------+
| Data Record                                      |
+--------------------------------------------------+
| Padding with 0 valued octets                     |
+--------------------------------------------------+
| Set Header #2                                    |
+--------------------------------------------------+
| Data Record                                      |
+--------------------------------------------------+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.4"></a><h3>3.2.4.&nbsp;
Record Padding</h3>

<p>
                        The tester MUST create a Template that contains the
                        padding Information Element (i.e. paddingOctets), and
                        cause the Template and associated Data Records to be
                        exported over all applicable combinations of transports
                        and protocols in <a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST repeat the test with various padding
                        sizes, including padding to boundaries other than 4 or
                        8 octets.
                    
</p>
<p>
                        The tester MUST ensure the Collecting Process correctly
                        interprets case where the Data Records are so short
                        that the padding is equal to or longer than the length
                        of the record, so the padding might otherwise be
                        interpreted as another record (e.g. 1 bytes TOS plus 3
                        bytes of padding).
                        <a class='info' href='#paddingTemplate'>Figure&nbsp;2</a> depicts such a
                        Template, while <a class='info' href='#paddingDataRecord'>Figure&nbsp;3</a>
                        depicts a Data Record conforming to that Template.
                    
</p><br /><hr class="insert" />
<a name="paddingTemplate"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Set ID = 2            |      Length = 16 octets       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Template ID 256         |       Field Count = 2         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|  ipDiffServCodePoint = 195  |       Field Length = 1        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|      paddingOctets = 210    |       Field Length = 3        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
<br /><hr class="insert" />
<a name="paddingDataRecord"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Set ID = 256         |          Length = 64          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       1        |                       0                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                        The tester MUST test fixed-size padding (e.g. 12 bytes
                        of data plus 2 bytes of padding) and variable length
                        padding (e.g. export a string and a variable number of
                        padding bytes afterwards to align the next Information
                        Element to a 4 byte boundary).
                    
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.5"></a><h3>3.2.5.&nbsp;
Template Withdrawal Message</h3>

<p>
			IPFIX Template management and Template Withdrawal are
			defined in chapter 8 of <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
		    
</p>
<a name="TWM"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.5.1"></a><h3>3.2.5.1.&nbsp;
Withdrawal of a previously sent Template</h3>

<p>
			    The tester MUST create an IPFIX Template and cause
			    that Template to be exported to an IPFIX Collector
			    over a reliable transport.
			
</p>
<p>
			    The tester MUST ensure that the Template was
			    correctly received and decoded by the Collecting
			    Process.
			
</p>
<p>
			    The tester MUST cause the Exporting Process to send
			    an IPFIX Template Withdrawal Message to the
			    Collector in respect of the Template. The Template
			    Withdrawal Message must be sent over the same
			    Transport Session as the Template.
			
</p>
<p>
			    The tester MUST ensure that the Template Withdrawal
			    Message was correctly received and decoded by the
			    Collecting Process, and that the previously sent
			    Template was discarded by the Collecting Process.
			
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.5.2"></a><h3>3.2.5.2.&nbsp;
Withdrawal of a previously withdrawn Template</h3>

<p>
			    The tester MUST create, export and withdraw an
			    IPFIX Template as described in <a class='info' href='#TWM'>Section&nbsp;3.2.5.1<span> (</span><span class='info'>Withdrawal of a previously sent Template</span><span>)</span></a>.
			
</p>
<p>
			    The tester MUST cause the Exporting Process to send
			    a second IPFIX Template Withdrawal Message to the
			    Collector in respect of the same Template.
			    The Template Withdrawal Message must be sent over
			    the same Transport Session as the Template.
			
</p>
<p>
			    The tester MUST ensure that the Collecting Process
			    discards the IPFIX Message and shuts down the SCTP
			    association or closes the TCP connection.  The tester
			    MUST check that the Collecting Process logged the
			    error.
			
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.5.3"></a><h3>3.2.5.3.&nbsp;
Withdrawal of a previously unsent Template</h3>

<p>
			    The tester MUST cause the Exporting Process to send
			    an IPFIX Template Withdrawal Message to the
			    Collector in respect of a Template which has not
			    yet been exported.  The Template Withdrawal Message
			    must be sent over a reliable transport.
			
</p>
<p>
			    The tester MUST ensure that the Collecting Process
			    discards the IPFIX Message and shuts down the SCTP
			    association or closes the TCP connection.  The tester
			    MUST check that the Collecting Process logged the
			    error.
			
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.5.4"></a><h3>3.2.5.4.&nbsp;
Withdrawing all Data Templates</h3>

<p>
			    The tester MUST create several IPFIX Templates and
			    cause them to be exported to an IPFIX Collector
			    over a reliable transport.
			
</p>
<p>
			    The tester MUST ensure that the Templates were
			    correctly received and decoded by the Collecting
			    Process.
			
</p>
<p>
			    The tester MUST cause the Exporting Process to send
			    an IPFIX All Data Templates Withdrawal Message to the
			    Collector over the same Transport Session as the Templates.
			
</p>
<p>
			    The tester MUST ensure that the All Data Templates
			    Withdrawal Message was correctly received and
			    decoded by the Collecting Process, and that all the
			    previously sent Templates were discarded by the
			    Collecting Process.
			
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.5.5"></a><h3>3.2.5.5.&nbsp;
Withdrawing all Option Templates</h3>

<p>
			    The tester MUST create several IPFIX Option Templates and
			    cause them to be exported to an IPFIX Collector
			    over a reliable transport.
			
</p>
<p>
			    The tester MUST ensure that the Option Templates were
			    correctly received and decoded by the Collecting
			    Process.
			
</p>
<p>
			    The tester MUST cause the Exporting Process to send
			    an IPFIX All Option Templates Withdrawal Message to the
			    Collector over the same Transport Session as the Templates.
			
</p>
<p>
			    The tester MUST ensure that the All Option Templates
			    Withdrawal Message was correctly received and
			    decoded by the Collecting Process, and that all the
			    previously sent Option Templates were discarded by the
			    Collecting Process.
			
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Information Element tests</h3>

<p>
                    This section lists the tests that cover the use of
                    Information Elements.
                
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.1"></a><h3>3.3.1.&nbsp;
Enterprise-specific Information Elements</h3>

<p>
                        The tester MUST cause the export of a Template and
                        associated Data Record that makes use of
                        Enterprise-specific Information Elements as defined in
                        <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST ensure that the Template and associated
                        Data Record are correctly received and decoded by the
                        Collecting Process, and that Information Elements that
                        are unknown to the Collecting Process are not silently
                        discarded.
                    
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.2"></a><h3>3.3.2.&nbsp;
Reduced Size Encoding of Information Elements</h3>

<p>
                        The tester MUST cause the export of a Template and
                        associated Data Record containing Information Elements
                        using reduced-size encoding as defined in section 6.2
                        of <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST ensure that in the case of Information
                        Elements transmitted using Reduced Size Encoding, the
                        Collecting Process is aware of the real size of each
                        Information Element as defined in
                        <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>,
                        and not only the length used for its transmission.
                    
</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3.3"></a><h3>3.3.3.&nbsp;
Multiple instances of the same Information
                Element in one Template</h3>

<p>
                        The tester MUST cause the export of a Template and
                        associated Data Record containing containing multiple
                        instances of the same Information Element, either
                        consecutively or with other Information Elements in
                        between.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process is
                        able to parse the IPFIX Message, and stores all values
                        received for all the Information Elements that appeared
                        multiple times in the Template definition.
                    
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Options Template tests</h3>

<p>
                    This section lists the tests that cover the correct
                    transfer of IPFIX Options Templates.
                
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.1"></a><h3>3.4.1.&nbsp;
Using any Information Elements as Scope</h3>

<p>
                        Options Templates contain scope fields that give the
                        context of the reported Information Elements in the
                        corresponding Data Records. Scope fields are an
                        Information Elements specified in
			<a class='info' href='#I-D.ietf-ipfix-info'>[I&#8209;D.ietf&#8209;ipfix&#8209;info]<span> (</span><span class='info'>Quittek, J., &ldquo;Information Model for IP Flow Information Export,&rdquo; February&nbsp;2007.</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST cause the export of
                        Options Template Records containing various different
                        Information Elements of each data type specified in
                        <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>
                        (octet, unsigned16, unsigned32 ...) in their
                        scope fields, and MUST export a Data Record using
                        each Template.
                    
</p>
<p>
                        The tester MUST ensure that the Templates and the
                        associated Data Records are correctly received and
                        decoded by the Collecting Process.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        accepts Information Elements in the scope field
                        other than IPFIX Information Elements which have been
                        recorded by IANA.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        accepts an Enterprise specific Information Element in
                        the scope field.
                    
</p>
<p>
                        The Scope Field Count MUST NOT be zero.  The tester MUST
                        cause the export of an Options Template Record
                        containing a Scope Field Count of zero.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        shuts down the SCTP association and discards the IPFIX
                        Message.  The tester MUST check that the Collecting
                        Process logged the error.
                    
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.2"></a><h3>3.4.2.&nbsp;
Using multiple Scopes</h3>

<p>
                        <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a> specifies:
                        "Multiple scope fields MAY be present in the Options
                        Template Record, in which case, the composite scope is
                        the combination of the scopes.  If the order of the
                        scope fields in the Options Template Record is
                        relevant, the order of the scope fields MUST be used."
                    
</p>
<p>
                        The tester MUST cause the export of an Options Template
                        Record containing multiple scope fields, and a Data
                        Record conforming to that Template.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        reports the Information Elements in the same order as
                        they were specified in the Options Template Record.
                    
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.3"></a><h3>3.4.3.&nbsp;
Metering Process Statistics Option
                Template</h3>

<p>
                        The tester MUST create a Metering Process Statistics
                        Option Templates as defined in section 4.1 of <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>, and MUST cause the
                        Option Template and an associated Data Record to be
                        exported.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        correctly receives and decodes the Option Template and
                        associated Data Record.
                    
</p>
<p>
                        The tester MUST also check that the optional
                        meteringProcessId Scope Field is supported by the
                        Collecting Process implementation.
                    
</p>
<p>
                        If several Metering Processes are available on the
                        Exporter Observation Domain,
                        the tester MUST create a Metering Process
                        Statistics Option Template containing multiple scopes
                        and an associated Data Record, MUST cause the Option
                        Template and associated Data Record to be exported, and
                        MUST ensure that the Collecting Process correctly
                        receives and decodes the Option Template and associated
                        Data Record.
                    
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.4"></a><h3>3.4.4.&nbsp;
Metering Process Reliability Statistics
                Option Template</h3>

<p>
                        The tester MUST create a Metering Process Reliability
                        Statistics Option Template as defined in section 4.2 of
                        <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>, and MUST
                        cause the Option Template and an associated Data Record
                        to be exported.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        correctly receives and decodes the Option Template and
                        associated Data Record.
                    
</p>
<p>
                        The tester MUST also check that the optional
                        meteringProcessId Scope Field is supported by the
                        Collecting Process implementation.
                    
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.5"></a><h3>3.4.5.&nbsp;
Exporting Process Reliability Statistics
                Option Template</h3>

<p>
                        The tester MUST create an Exporting Process Reliability
                        Statistics Option Template as defined in section 4.3 of
                        <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>,  and MUST
                        cause the Option Template and an associated Data Record
                        to be exported.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        correctly receives and decodes the Option Template and
                        associated Data Record.
                    
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4.6"></a><h3>3.4.6.&nbsp;
Flow Keys Option Template</h3>

<p>
                        The tester MUST create a Flow Keys Option Template, as
                        defined in section 4.4 of <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>, where the
                        templateId refers to an existing Template, and MUST
                        cause the Option Template and an associated Data Record
                        to be exported.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        correctly receives and decodes the Option Template and
                        associated Data Record, and that the Collecting
                        Process associates the Flow Keys with the right Data
                        Record Information Elements.
                    
</p>
<p>
                        The tester MUST create another Flow Keys Data Record
                        to be exported where the associated templateId has
                        insufficient fields to satisfy the flowKeyIndicator.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        discards the IPFIX Message and shuts down the SCTP
                        association or closes the TCP connection.  The tester
                        MUST check that the Collecting Process logged the
                        error.
                    
</p>
<p>
                        The tester MUST create another Flow Keys Option
                        Template, where the templateId refers to a non-existing
                        Template, and MUST cause the Option Template and an
                        associated Data Record to be exported.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        shuts down the SCTP association and discards the IPFIX
                        Message.  The tester MUST check that the
                        Collecting Process logged the error.
                    
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5"></a><h3>3.5.&nbsp;
Stress/Load tests</h3>

<p>
                    Stress tests are used to check correct behavior and
                    robustness of an IPFIX Collecting Process implementation
                    when a number of Data Records arrive very quickly. This is
                    especially important when IPFIX over UDP is used, since in
                    that case a slow Collecting Process cannot block the IPFIX
                    Exporting Processes from exporting, since UDP is not
                    congestion aware.
                
</p>
<p>
                    The tests may be dependent upon the hardware and transports
                    technology in use. Therefore the tests may need to be
                    scaled up or down to meet the needs of the particular
                    implementation. However, the implementer MUST ensure that
                    the implementation is stable under excessive traffic
                    conditions, for whatever definition of "excessive" applies
                    at their intended installation.
                
</p>
<p>
                    The implementer MUST ensure the correct operation of the
                    Exporting Process and/or Collecting Process when the
                    Collecting Process is incapable of processing records at
                    the rate that they are received.
                
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.1"></a><h3>3.5.1.&nbsp;
Large number of Records for one Template</h3>

<p>
                        The tester MUST export many Data Records to the
                        Collecting Process, all conforming to the same
                        Template.
                    
</p>
<p>
                        Depending on what that the Collecting Process does
                        (save to file, store to database, analyze the data) the
                        Collecting Process may use up a lot of memory.
                    
</p>
<p>
                        The tester MUST ensure that if the Collecting Process
                        runs out of memory, it shuts down the specific SCTP
                        association or closes the TCP connection but remains
                        available to receive data on other open Transport
                        Sessions and stays available for future Transport
                        Sessions.
                    
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.2"></a><h3>3.5.2.&nbsp;
Excessive rate of incoming Data Records</h3>

<p>
                        The tester MUST cause Data Records to be exported to
                        the Collecting Process with an increasing export rate.
                    
</p>
<p>
                        For TCP or SCTP in reliable mode, the tester MUST
                        ensure that export stalls the Exporting Process once
                        the Collecting Process becomes fully loaded.
                    
</p>
<p>
                        For UDP export, the tester MUST ensure that the
                        Collecting Process drops records as it becomes
                        overloaded, and MUST check that the Collecting
                        Process logs a warning.
                    
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.3"></a><h3>3.5.3.&nbsp;
Large Templates</h3>

<p>
                        The tester MUST create Templates with the maximum
                        possible number of Information Elements, and cause
                        these to be exported to the Collecting Process.
                     
</p>
<p>
                        The total length field in the IP header is 16 bits,
                        allowing a length up to 65535 octets.  20 octets are
                        required for a minimal IPv4 header, 16 octets for the
                        IPFIX header, 4 octets for the Set header and 4 octets
                        for the Template header, so the Template definition may
                        be up to (65535 - 20 - 16 - 4 - 4) = 65491 octets long.
                        The minimum IPFIX Information Element specification
                        requires 4 octets: two for the Information Element ID
                        and two for the field length.  Therefore, the maximum
                        number of IPFIX Information Elements in a single
                        Template is 65491 / 4 = 16372.  With this many
                        Information Elements, the Template will be 65488 octets
                        long while the entire packet will be 65532 octets long.
                     
</p>
<p>
                        The tester MUST create Data Records conforming to this
                        Template, and cause them to be exported.  Note that,
                        for the implementation, the associated Data Records
                        might be smaller or larger than the Template Records
                        depending on the length of the Information Elements
                        defined by the Template and on the presence of
                        variable length Information Elements.
                     
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        correctly receives and decodes the Template and
                        associated Data Records.
                    
</p>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.4"></a><h3>3.5.4.&nbsp;
Many new Templates within Data Template timeout
                interval</h3>

<p>
                        The tester MUST create a large number of different
                        Templates and cause them to be exported to the
                        Collecting Process to stress test the Collecting
                        Process's memory consumption.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        gracefully discards Templates if it's running out of
                        memory resources, and MUST check that warnings are
                        logged.
                    
</p>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.5"></a><h3>3.5.5.&nbsp;
Multiple Exporting Processes exporting to one
                Collecting Process</h3>

<p>
                        The tester MUST configure multiple Exporting Processes
                        to export Templates and associated Data Records to the
                        same Collecting Process at the same time.
                    
</p>
<p>
                        The tester MUST ensure that all the Templates and
                        associated Data Records are correctly received and
                        decoded at the Collecting Process, and that no
                        Exporting Process stalls or disconnects completely
                        unless the Collecting Process runs out of memory.
                    
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.5.6"></a><h3>3.5.6.&nbsp;
Export from one Exporting Process to multiple
                Collecting Processes</h3>

<p>
                        If the Exporting Process supports multiple simultaneous
                        export destinations, the tester MUST configure the
                        Exporting Process to export Data Records in parallel to
                        different Collecting Processes.
                    
</p>
<p>
                        The tester MUST configure the use of a mixture of
                        simple and complex Templates and ensure they are all
                        correctly received and decoded by all the Collecting
                        Processes.
                    
</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6"></a><h3>3.6.&nbsp;
Error handling</h3>

<p>
                    This section lists and describes a number of problems that  
                    might occur in either the network or data transmission or
                    related to wrong information encoding, and which the IPFIX
                    Exporting Process and Collecting Process must be capable of
                    handling in a graceful way. It is intended to test the
                    robustness and fault tolerance of the IPFIX Processes.
                
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.1"></a><h3>3.6.1.&nbsp;
Temporary network disconnect</h3>

<p>
                        Due to network failures (either physical or logical,
                        e.g.  defective routing) the connectivity between an
                        IPFIX Exporting Process and Collecting Process might be
                        disrupted. The IPFIX Exporting Process and Collecting
                        Process must be able to handle such events in a
                        deterministic and graceful way if they should occur
                        during an IPFIX export.  When connection oriented
                        transmission protocols (TCP/SCTP) are in use, such a
                        failure may or may not be signaled to the Exporting
                        Process and Collecting Process by the operating system
                        depending on the type of network adapter, driver
                        software and operating system in use.  The effect might
                        be the direct signaling of an error when IP packet
                        read/write system functions are invoked (signaling
                        connection reset by peer) or there might be an
                        OS-dependent connection timeout.
                    
</p>
<p>
                        The IPFIX Exporting Process and Collecting Process
                        behavior MUST be checked upon such interruptions of
                        data transmission.
                    
</p>
<p>
                        The tester MUST configure continuous export over all
                        applicable combinations of transports and protocols in
                        <a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a> in turn.
                    
</p>
<p>
                        For SCTP-based associations and TCP-based connections,
                        the tester MUST create a short disconnect between the
                        Exporting Process and the Collecting Process (e.g. by
                        momentarily interrupting the network connection) and
                        MUST ensure that export continues after the connection
                        is repaired.  The tester MUST then create a longer
                        disconnection between the Exporting Process and
                        Collecting Process, and MUST ensure that export
                        continues after the connection is repaired.
                    
</p>
<p>
                        For UDP-based data export there is no noticeable
                        connection loss, but data received with non-consecutive
                        sequence numbers indicates data loss.  The tester MUST
                        create a short disconnect between the Exporting Process
                        and Collecting Process, and MUST ensure that this is
                        recognized and reported by the Collecting Process per
                        section 3.1 of <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
                    
</p>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.2"></a><h3>3.6.2.&nbsp;
Exporting Process termination and restart
                during data transmission</h3>

<p>
                        An IPFIX Collecting Process might be confronted with a
                        faulty Exporting Process implementation that suddenly
                        crashes, dropping any open connections. The Exporting
                        Process may be restarted again soon after the crash.
                    
</p>
<p>
                        Such an event will only be visible to the Collecting
                        Process when the IPFIX Messages (Templates and
                        associated Data Records) are carried over TCP or SCTP.
                        For export via UDP no such test is available due to the
                        connection-less nature of the transport.
                    
</p>
<p>
                        The tester MUST configure continuous export over all
                        applicable combinations of SCTP and TCP transports and
                        protocols in <a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a> in turn.
                        For each combination, the tester MUST establish export,
                        then kill the active Exporting Process.
                    
</p>
<p>
                        The tester MUST ensure that the associated Collecting
                        Process shuts down SCTP associations and closes TCP
                        connections associated with that export after a
                        suitable timeout period.
                    
</p>
<p>
                        The tester MUST Ensure that the Collecting Process
                        discards the Template(s) received on the killed
                        transport session.
                    
</p>
<p>
                        The tester MUST restart the Exporting Process again,
                        and MUST ensure that the Exporting Process exports the
                        Templates again.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        receives and accepts both Templates and associated Data
                        Records from the new Exporting Process running
                        at the same source host.
                    
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.3"></a><h3>3.6.3.&nbsp;
Collecting Process termination and restart
                during data transmission</h3>

<p>
                        An IPFIX Exporting Process might be confronted with a
                        faulty Collecting Process implementation that suddenly
                        crashes, dropping any open Transport Sessions. The
                        Collecting Process may be restarted again soon after
                        the crash.
                    
</p>
<p>
                        The tester MUST set up an Exporting Process and
                        Collecting Process and cause IPFIX Templates and
                        associated Data Records to be exported over all
                        applicable combinations of SCTP and TCP transports and
                        protocols in <a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a> in turn.
                        Via UDP the restart of the Collecting Process will be
                        invisible to the Exporting Process and have no effect.
                    
</p>
<p>
                        The tester MUST terminate the Collecting Process while
                        the export is in progress, and MUST ensure that the
                        Exporting Process shuts down SCTP associations and
                        closes TCP connections associated with that Collecting
                        Process.
                    
</p>
<p>
                        The tester MUST restart the Collecting Process and
                        ensure that the Exporting Process connects to the
                        Collecting Process again and that it exports the IPFIX
                        Templates again.
                    
</p>
<p>
                        The tester MUST ensure that the new Collecting Process
                        correctly receives and decodes the IPFIX Data Records
                        again.
                    
</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.4"></a><h3>3.6.4.&nbsp;
Incorrect Template Records</h3>

<p>
                        IPFIX Template Records contain a message length field,
                        an overall field count and a scope field count. The
                        field count is the number of all fields in the Template
                        Record, including the scope fields if present.
                        Recall from section 3.4.2.1 of
                        <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>
                        that the scope field count may not be zero.
                    
</p>
<p>
                        These tests verify the Collecting Process's operation
                        when it receives a Template Record with an invalid
                        message length.
                    
</p>
<p>
                        Consider the example Template Record shown in
                        <a class='info' href='#invalid-template'>Figure&nbsp;4</a>.  This Template
                        record is missing one Information Element ID and one
                        Information Element length field. There is insufficient
                        data in the set for the specified set length, and the
                        overall record is four octets too short for the
                        specified total length.  Therefore the Template must be
                        dropped by the IPFIX Collecting Process, and the SCTP
                        association must be shut down or TCP connection closed.
                    
</p><br /><hr class="insert" />
<a name="invalid-template"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Version = 10          |       Total Length = 32       |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                  Export Time = 1155202151                     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |               Sequence Number = 0x12345678                    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |           Observation Domain ID = 0x33334444                  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |          Set ID = 2           |        Set Length = 12        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |       Template ID = 257       |        Field Count = 2        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |0| Info Element Identifier = 8 |     Field Length = 4          |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                        The tester MUST create and cause the Exporting Process
                        to export the following IPFIX Templates, and MUST
                        ensure the correct Collecting Process behaviour for
                        each of the transports and protocols in
                        <a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a>.

                        </p>
<ul class="text">
<li>
                              For SCTP transport, ensure that the Collecting
                              Process discards the IPFIX Message and shuts down
                              the SCTP association, and check that it logs the
                              error.
                          
</li>
<li>
                              For TCP transport, ensure that the Collecting
                              Process discards the IPFIX Message, closes the
                              TCP connection, and check that it logs the error.
                          
</li>
<li>
                              For UDP transport, ensure that the Collecting
                              Process discards the IPFIX Message, and check
                              that it logs the error.
                          
</li>
</ul><p>
                    
</p>
<p>
                        (a) The tester MUST create the IPFIX Template shown in
                        <a class='info' href='#invalid-template'>Figure&nbsp;4</a> and cause the
                        Exporting Process to export it.
                        The tester MUST ensure that the Collecting Process's
                        behaviour is as specified above for each transport type.
                    
</p>
<p>
                        (b) Consider the IPFIX Template shown in <a class='info' href='#invalid-template'>Figure&nbsp;4</a>, modified with total length
                        = 28.  In this case the IPFIX Message has to be
                        rejected because field count = 2 and there is no second
                        Information Element record present in the Set.  The
                        available data is exhausted after reading the first
                        Information Element record.
                    
</p>
<p>
                        The tester MUST create the modified Template and cause
                        the Exporting Process to export it.  The tester MUST
                        ensure that the Collecting Process's behaviour is as
                        specified above for each transport type.
                    
</p>
<p>
                        (c) Consider the IPFIX Template shown in <a class='info' href='#invalid-template'>Figure&nbsp;4</a>, modified with total length
                        = 26.  In this case the IPFIX Message has to be
                        rejected because the IPFIX Message length is too short.
                        After the first Information Element the IPFIX Message
                        data is exhausted according to the total length
                        information.
                    
</p>
<p>
                        The tester MUST create the modified Template and cause
                        the Exporting Process to export it.  The tester MUST
                        ensure that the Collecting Process's behaviour is as
                        specified above for each transport type.
                    
</p>
<p>
                        (d) Consider the IPFIX Template shown in <a class='info' href='#invalid-template'>Figure&nbsp;4</a>, modified with field count
                        = 1.  In this case the IPFIX Message must be rejected
                        because total length is too large and does not match
                        the amount of data available.
                    
</p>
<p>
                        The tester MUST create the modified Template and cause
                        the Exporting Process to export it.  The tester MUST
                        ensure that the Collecting Process's behaviour is as
                        specified above for each transport type.
                    
</p>
<p>
                        Finally when the IPFIX Template shown in <a class='info' href='#invalid-template'>Figure&nbsp;4</a> is extended with the data
                        shown in <a class='info' href='#make-template-valid'>Figure&nbsp;5</a>, it
                        becomes a correct IPFIX Template.
                    
</p><br /><hr class="insert" />
<a name="make-template-valid"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |0| Info Element Identifier = 12|        Field Length = 4       |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                        The tester MUST create the modified Template and cause
                        the Exporting Process to export it.  The tester MUST
                        ensure that the Template is accepted by the Collecting
                        Process for each transport type.
                    
</p>
<p>
                        The example Template record shown in <a class='info' href='#invalid-scope-template'>Figure&nbsp;6</a> must be dropped
                        because the scope field count = 0.
                    
</p><br /><hr class="insert" />
<a name="invalid-scope-template"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  0                   1                   2                   3
  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |         Version = 10          |       Total Length = 30       |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |                  Export Time = 1155202151                     |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |               Sequence Number = 0x12345678                    |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |           Observation Domain ID = 0x33334444                  |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |           Set ID = 3          |        Set Length = 14        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |       Template ID = 257       |       Field Count = 1         |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |     Scope Field Count = 0     |0| Info Element Identifier = 8 |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
 |       Field Length = 4        |
 +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                        The tester MUST create the Template shown in <a class='info' href='#invalid-scope-template'>Figure&nbsp;6</a> and cause the
                        Exporting Process to export it.  The tester MUST ensure
                        that the IPFIX Message is discarded by the Collecting
                        Process for each transport type, and MUST check that
                        the Collecting Process logs an error.  The tester MUST
                        ensure that the Collecting Process also shuts down the
                        SCTP association or closes the TCP connection.
                    
</p>
<p>
                        The tester MUST create an IPFIX Options Template where
                        the field count is less than the scope field count, and
                        cause the Exporting Process to export it. Use the above
                        IPFIX Options Template with scope field count = 2.  The
                        tester MUST ensure that the Template is discarded by
                        the Collecting Process for each transport type, and
                        MUST check that the Collecting Process logs an error.
                        The tester MUST ensure that the Collecting Process
                        shuts down the SCTP association or closes the TCP
                        connection.
                    
</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.5"></a><h3>3.6.5.&nbsp;
Incorrect Data Record</h3>

<p>
                        The tester MUST create the following invalid Data
                        Records and cause them to be exported to the Collecting
                        Process over all applicable combinations of transports
                        and protocols in <a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a>.
                    
</p>
<p>
                        </p>
<ul class="text">
<li>
                                IPFIX Message too short.
                            
</li>
<li>
                                Illegal use of reduced size encoding/
                            
</li>
<li>
                                Invalid length specification in case of
                                variable length Information Elements.
                            
</li>
</ul><p>
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        discards the IPFIX Message and shuts down the SCTP
                        association or closes the TCP connection.
                    
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.6"></a><h3>3.6.6.&nbsp;
Export of non-matching Template and Data
                Records</h3>

<p>
                        The tester MUST create Templates and associated Data
                        Records that fail to conform to those Templates in the
                        following ways:
                    
</p>
<p>
                        </p>
<ul class="text">
<li>
                                too few Information Elements in Data Record
                            
</li>
<li>
                                too many Information Elements in Data Record
                            
</li>
</ul><p>
                    
</p>
<p>
                        The tester MUST cause the Templates and associated
                        Data Records to be exported to the Collecting Process
                        over all applicable combinations of transports and
                        protocols in <a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        discards the IPFIX Message and shuts down the SCTP
                        association or closes the TCP connection.
                    
</p>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.7"></a><h3>3.6.7.&nbsp;
Incorrect Set IDs</h3>

<p>
                        The tester MUST create Template sets, Option Template
                        sets, and associated Data sets with an incorrect Set
                        ID, and cause these to be exported to the Collecting
                        Process over all applicable combinations of transports
                        and protocols in <a class='info' href='#connectivity'>Section&nbsp;3.1<span> (</span><span class='info'>Exporting Process / Collecting Process connectivity 	    tests</span><span>)</span></a>.
                    
</p>
<p>
                        Per <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a>
                        only the Set ID values 2 and 3 denote valid sets.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        discards the IPFIX Message and shuts down the SCTP
                        association or closes the TCP connection.
                    
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8"></a><h3>3.6.8.&nbsp;
Re-using Template IDs</h3>

<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8.1"></a><h3>3.6.8.1.&nbsp;
Re-using the same Template ID inside the
		    Template expiry time</h3>

<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8.1.1"></a><h3>3.6.8.1.1.&nbsp;
Using SCTP transport.</h3>

<p>
				The tester MUST create an IPFIX Template
				and cause it to be exported to a Collecting
				Process over SCTP transport.
			    
</p>
<p>
				The tester MUST cause the same Template to
				be exported to the same Collecting Process
				again, and MUST ensure that the Collecting
				Process discards the IPFIX Message and
				shuts down the SCTP association.
			    
</p>
<p>
				The tester MUST create and export another
				IPFIX Template to a Collecting Process over
				SCTP transport.
			    
</p>
<p>
				The tester MUST modify the Template
				contents while retaining the same Template
				ID.
			    
</p>
<p>
				The tester MUST cause the modified Template
				to be exported to the Collecting Process,
				and MUST ensure that the Collecting Process
				discards the IPFIX Message and shuts down
				the SCTP association.
			    
</p>
<p>
				The tester MUST check that an error was
				logged.
			    
</p>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8.1.2"></a><h3>3.6.8.1.2.&nbsp;
Using TCP transport.</h3>

<p>
				The tester MUST create an IPFIX Template
				and cause it to be exported to a Collecting
				Process over TCP transport.
			    
</p>
<p>
				The tester MUST cause the same Template to
				be exported to the same Collecting Process
				again, and MUST ensure that the Collecting
				Process resets the TCP connection and
				discards the IPFIX Message.
			    
</p>
<p>
				The tester MUST create and export another
				IPFIX Template to a Collecting Process over
				TCP transport.
			    
</p>
<p>
				The tester MUST modify the Template
				contents while retaining the same Template
				ID.
			    
</p>
<p>
				The tester MUST cause the modified Template
				to be exported to the Collecting Process,
				and MUST ensure that the Collecting Process
				resets the TCP connection and discards the
				IPFIX Message.
			    
</p>
<p>
				The tester MUST check that an error was
				logged.
			    
</p>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8.1.3"></a><h3>3.6.8.1.3.&nbsp;
Using UDP transport.</h3>

<p>
				The tester MUST create an IPFIX Template
				and cause it to be exported to a Collecting
				Process over UDP transport.
			    
</p>
<p>
				Before the Template times out on the
				Collecting Process, the tester MUST cause
				the same Template to be exported again and
				MUST ensure that the Collecting Process
				accepts the Template.
			    
</p>
<p>
				The tester MUST create a different Template
				with the same ID and MUST cause this to be
				exported to the Collecting Process before
				the original Template times out.
			    
</p>
<p>
				The tester MUST ensure that the Collecting
				Process does not reject the new Template,
				and MUST check that an error is logged.
			    
</p>
<a name="anchor49"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8.2"></a><h3>3.6.8.2.&nbsp;
Re-using the same Template ID after the
		    Template expiry time</h3>

<a name="anchor50"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8.2.1"></a><h3>3.6.8.2.1.&nbsp;
Using SCTP transport.</h3>

<p>
				The tester MUST create an IPFIX Template
				and cause it to be exported to a Collecting
				Process over SCTP transport.
			    
</p>
<p>
				The tester MUST ensure that the Template was
				correctly received and decoded by
				the Collecting Process.
			    
</p>
<p>
				The tester MUST cause a Template Withdrawal
				Message for the Template to be sent to the
				Collecting Process, and MUST ensure that
				the Template has been removed from the
				Collecting Process.
			    
</p>
<p>
				The tester MUST create Data Records
				conforming to the Template and cause them
				to be exported to the Collecting Process.
			    
</p>
<p>
				The tester MUST ensure that the Collecting
				Process discards the Data Records.
			    
</p>
<p>
				The tester MUST check that the
				Collecting Process logs a warning.
			    
</p>
<p>
				The tester MUST cause the Template to be
				exported again to the same Collecting
				Process over SCTP transport.
			    
</p>
<p>
				The tester MUST ensure that the Template was
				correctly received and decoded by
				the Collecting Process.
			    
</p>
<a name="anchor51"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8.2.2"></a><h3>3.6.8.2.2.&nbsp;
Using TCP transport.</h3>

<p>
				The tester MUST create an IPFIX Template
				and cause it to be exported to a Collecting
				Process over TCP transport.
			    
</p>
<p>
				The tester MUST ensure that the Template was
				correctly received and decoded by
				the Collecting Process.
			    
</p>
<p>
				The tester MUST cause a Template Withdrawal
				Message for the Template to be sent to the
				Collecting Process, and MUST ensure that
				the Template has been removed from the
				Collecting Process.
			    
</p>
<p>
				The tester MUST create Data Records
				conforming to the Template and cause them
				to be exported to the Collecting Process.
			    
</p>
<p>
				The tester MUST ensure that the Collecting
				Process discards the Data Records.
			    
</p>
<p>
				The tester MUST check that the
				Collecting Process logs a warning.
			    
</p>
<p>
				The tester MUST cause the Template to be
				exported again to the same Collecting
				Process over TCP transport.
			    
</p>
<p>
				The tester MUST ensure that the Template was
				correctly received and decoded by
				the Collecting Process.
			    
</p>
<a name="anchor52"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8.2.3"></a><h3>3.6.8.2.3.&nbsp;
Using UDP transport.</h3>

<p>
				The tester MUST create an IPFIX Template
				and cause it to be exported to a Collecting
				Process over UDP transport.
			    
</p>
<p>
				The tester MUST ensure that the Template was
				correctly received and decoded by
				the Collecting Process.
			    
</p>
<p>
				The tester MUST allow the received Template
				to expire on the Collecting Process.
			    
</p>
<p>
				The tester MUST create Data Records
				conforming to the Template and cause them
				to be exported to the Collecting Process.
			    
</p>
<p>
				The tester MUST ensure that the Collecting
				Process discards the Data Records.
			    
</p>
<p>
				The tester MUST check that the
				Collecting Process logs a warning.
			    
</p>
<p>
				The tester MUST cause the Template to be
				exported again to the same Collecting
				Process over UDP transport.
			    
</p>
<p>
				The tester MUST ensure that the Template was
				correctly received and decoded by
				the Collecting Process.
			    
</p>
<a name="anchor53"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.6.8.3"></a><h3>3.6.8.3.&nbsp;
Re-exporting an existing Template ID without
		    withdrawal</h3>

<p>
			     <a class='info' href='#I-D.ietf-ipfix-protocol'>[I&#8209;D.ietf&#8209;ipfix&#8209;protocol]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information,&rdquo; September&nbsp;2007.</span><span>)</span></a> states in
			     section 8 that a Template must not be sent more than
			     once during the lifetime of an SCTP association.
			
</p>
<p>
			     The tester MUST create an IPFIX Template and cause it
			     to be exported to the Collecting Process multiple
			     times over an SCTP association.
			
</p>
<p>
			     The tester MUST ensure that the Collecting Process
			     discards the IPFIX Message containing the duplicate
			     Templates and shuts down the SCTP association. The
			     tester MUST check that the Collecting Process logs a
			     warning.
			
</p>
<a name="tls-connectivity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7"></a><h3>3.7.&nbsp;
TLS connectivity and policy selection</h3>

<p>
                    This section lists tests that verify
                    connectivity over TLS and DTLS, and proper
                    selection of TLS policies as specified in the
                    IPFIX Protocol. It specifically does NOT purport
                    to test the security of IPFIX Message transport
                    over TLS or DTLS, as evaluating the security of a
                    transport session is really a test of the TLS or
                    DTLS implementation over which a given IPFIX
                    implementation runs, and as such is out of scope
                    for this document.
                
</p>
<a name="tls-setup"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7.1"></a><h3>3.7.1.&nbsp;
TLS test setup</h3>

<p>
                        Setting up for TLS connectivity and policy
                        testing requires the creation of appropriate
                        X.509 certificates and private keys for a test
                        environment, and the configuration of a DNS
                        server to answer with consistent information
                        for the hosts used in the test.
                    
</p>
<p>
                        The tester MUST configure the following certificates:

                        </p>
<blockquote class="text">
<p>
                                1. A Certificate Authority (CA) certificate and
                                associated private key for signing the
                                following certificates.
                            
</p>
<p>
                                2. One certificate and associated private key,
                                with a CN (Common Name) or subjectAltName
                                extension of type dNSName containing the fully
                                qualified domain name of the host, signed by
                                the CA certificate in 1, for each IPFIX
                                Exporting Process in the test.
                            
</p>
<p>
                                3. One certificate and associated private key,
                                with a CN (common name) or subjectAltName
                                extension of type dNSName containing the fully
                                qualified domain name of the host, signed by
                                the CA certificate in 1, for each IPFIX
                                Collecting Process in the test.
                            
</p>
</blockquote><p>
                    
</p>
<p>
                        The tester MUST configure consistent forward (A, AAAA)
                        and reverse (PTR) DNS records for each host in the test
                        on a DNS server used by the hosts for name resolution.
                    
</p>
<p>
                        The tester MUST ensure that the Exporting Process and
                        Collecting Process are on different hosts.
                    
</p>
<a name="tls-tcp-connectivity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7.2"></a><h3>3.7.2.&nbsp;
TLS over TCP connectivity test</h3>

<p>
                        The tester MUST set up certificates and DNS as in
                        <a class='info' href='#tls-setup'>Section&nbsp;3.7.1<span> (</span><span class='info'>TLS test setup</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST configure one Exporting Process and one
                        Collecting Process with their appropriate certificates
                        to transfer IPFIX Messages over TLS over TCP.
                    
</p>
<p>
                        The tester MUST create an IPFIX Template and associated
                        Data Record, and cause them to be exported over the TCP
                        connection.
                    
</p>
<p>
                        The tester MUST ensure that a TCP connection and a TLS
                        connection were established, MUST ensure that data was
                        exchanged, and MUST ensure that the data received at
                        the Collecting Process is correct.
                    
</p>
<a name="tls-udp-connectivity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7.3"></a><h3>3.7.3.&nbsp;
DTLS over UDP connectivity test</h3>

<p>
                        The tester MUST set up certificates and DNS as in
                        <a class='info' href='#tls-setup'>Section&nbsp;3.7.1<span> (</span><span class='info'>TLS test setup</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST configure one Exporting Process and one
                        Collecting Process with their appropriate certificates
                        to transfer IPFIX Messages over DTLS over UDP.
                    
</p>
<p>
                        The tester MUST create an IPFIX Template and associated
                        Data Record, and cause them to be exported over the UDP
                        connection.
                    
</p>
<p>
                        The tester MUST ensure that UDP packets were sent and a
                        DTLS connection was established, MUST ensure that data
                        was exchanged, and MUST ensure that the data received
                        at the Collecting Process is correct.
                    
</p>
<a name="tls-sctp-connectivity"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7.4"></a><h3>3.7.4.&nbsp;
DTLS over PR-SCTP connectivity test</h3>

<p>
                        The tester MUST set up certificates and DNS as in
                        <a class='info' href='#tls-setup'>Section&nbsp;3.7.1<span> (</span><span class='info'>TLS test setup</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST configure one Exporting Process and one
                        Collecting Process with their appropriate certificates
                        to transfer IPFIX Messages over DTLS over PR-SCTP.
                    
</p>
<p>
                        The tester MUST create an IPFIX Template and associated
                        Data Record, and cause them to be exported over the
                        SCTP association.
                    
</p>
<p>
                        The tester MUST ensure that an SCTP association and a
                        DTLS connection were established, MUST ensure that data
                        was exchanged, and MUST ensure that the data received
                        at the Collecting Process is correct.
                    
</p>
<a name="anchor54"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7.5"></a><h3>3.7.5.&nbsp;
TLS bidirectional authentication policy test</h3>

<p>
                        This is an optional test for Collecting
                        Processes only; it requires the modification
                        of an Exporting Process to NOT present a
                        certificate.
                    
</p>
<p>
                        The tester MUST modify an Exporting Process to NOT
                        present a certificate.
                    
</p>
<p>
                        The tester MUST perform the connectivity tests in
                        <a class='info' href='#tls-tcp-connectivity'>Section&nbsp;3.7.2<span> (</span><span class='info'>TLS over TCP connectivity test</span><span>)</span></a>,
                        <a class='info' href='#tls-udp-connectivity'>Section&nbsp;3.7.3<span> (</span><span class='info'>DTLS over UDP connectivity test</span><span>)</span></a>, and
                        <a class='info' href='#tls-sctp-connectivity'>Section&nbsp;3.7.4<span> (</span><span class='info'>DTLS over PR-SCTP connectivity test</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        rejects the TLS or DTLS connection establishment.
                    
</p>
<a name="anchor55"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7.6"></a><h3>3.7.6.&nbsp;
Exporting Process Identity Mismatch TLS Policy
                test</h3>

<p>
                        The tester MUST set up certificates and DNS as in
                        <a class='info' href='#tls-setup'>Section&nbsp;3.7.1<span> (</span><span class='info'>TLS test setup</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST use a certificate for the Exporting
                        Process that does NOT match the fully qualified domain
                        name of the host on which the Exporting Process runs.
                    
</p>
<p>
                        The tester MUST Perform the connectivity tests in
                        <a class='info' href='#tls-tcp-connectivity'>Section&nbsp;3.7.2<span> (</span><span class='info'>TLS over TCP connectivity test</span><span>)</span></a>,
                        <a class='info' href='#tls-udp-connectivity'>Section&nbsp;3.7.3<span> (</span><span class='info'>DTLS over UDP connectivity test</span><span>)</span></a>, and
                        <a class='info' href='#tls-sctp-connectivity'>Section&nbsp;3.7.4<span> (</span><span class='info'>DTLS over PR-SCTP connectivity test</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST ensure that the Collecting Process
                        rejects the TLS or DTLS connection establishment.
                    
</p>
<a name="anchor56"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.7.7"></a><h3>3.7.7.&nbsp;
Collecting Process Identity Mismatch TLS Policy
                test</h3>

<p>
                        The tester MUST set up certificates and DNS as in <a class='info' href='#tls-setup'>Section&nbsp;3.7.1<span> (</span><span class='info'>TLS test setup</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST use a certificate for the Collecting
                        Process that does NOT match the fully qualified domain
                        name of the host on which the Collecting Process runs.
                    
</p>
<p>
                        The tester MUST perform the connectivity tests in
                        <a class='info' href='#tls-tcp-connectivity'>Section&nbsp;3.7.2<span> (</span><span class='info'>TLS over TCP connectivity test</span><span>)</span></a>,
                        <a class='info' href='#tls-udp-connectivity'>Section&nbsp;3.7.3<span> (</span><span class='info'>DTLS over UDP connectivity test</span><span>)</span></a>, and
                        <a class='info' href='#tls-sctp-connectivity'>Section&nbsp;3.7.4<span> (</span><span class='info'>DTLS over PR-SCTP connectivity test</span><span>)</span></a>.
                    
</p>
<p>
                        The tester MUST ensure that the Exporting Process
                        rejects the TLS or DTLS connection establishment.
                    
</p>
<a name="anchor57"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security considerations</h3>

<p>
                This memo raises no security issues.
            
</p>
<a name="anchor58"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA considerations</h3>

<p>
                This memo raises no IANA considerations.
            
</p>
<a name="anchor59"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p>
                The authors wish to thank Brian Trammell for contributing the
                initial text for <a class='info' href='#tls-connectivity'>Section&nbsp;3.7<span> (</span><span class='info'>TLS connectivity and policy selection</span><span>)</span></a>.
            
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-architecture">[I-D.ietf-ipfix-architecture]</a></td>
<td class="author-text">Sadasivan, G., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-architecture-12.txt">Architecture for IP Flow Information Export</a>,&rdquo; draft-ietf-ipfix-architecture-12 (work in progress), September&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-architecture-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-as">[I-D.ietf-ipfix-as]</a></td>
<td class="author-text">Zseby, T., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-as-12.txt">IPFIX Applicability</a>,&rdquo; draft-ietf-ipfix-as-12 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-as-12.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-info">[I-D.ietf-ipfix-info]</a></td>
<td class="author-text">Quittek, J., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-info-15.txt">Information Model for IP Flow Information Export</a>,&rdquo; draft-ietf-ipfix-info-15 (work in progress), February&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-info-15.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-protocol">[I-D.ietf-ipfix-protocol]</a></td>
<td class="author-text">Claise, B., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-protocol-26.txt">Specification of the IPFIX Protocol for the Exchange of IP Traffic Flow  Information</a>,&rdquo; draft-ietf-ipfix-protocol-26 (work in progress), September&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-protocol-26.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3917">[RFC3917]</a></td>
<td class="author-text">Quittek, J., Zseby, T., Claise, B., and S. Zander, &ldquo;<a href="http://tools.ietf.org/html/rfc3917">Requirements for IP Flow Information Export (IPFIX)</a>,&rdquo; RFC&nbsp;3917, October&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3917.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative references</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2960">[RFC2960]</a></td>
<td class="author-text">Stewart, R., Xie, Q., Morneault, K., Sharp, C., Schwarzbauer, H., Taylor, T., Rytina, I., Kalla, M., Zhang, L., and V. Paxson, &ldquo;<a href="http://tools.ietf.org/html/rfc2960">Stream Control Transmission Protocol</a>,&rdquo; RFC&nbsp;2960, October&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2960.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3550">[RFC3550]</a></td>
<td class="author-text">Schulzrinne, H., Casner, S., Frederick, R., and V. Jacobson, &ldquo;<a href="http://tools.ietf.org/html/rfc3550">RTP: A Transport Protocol for Real-Time Applications</a>,&rdquo; STD&nbsp;64, RFC&nbsp;3550, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3550.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc3550.ps">PS</a>, <a href="http://www.rfc-editor.org/rfc/rfc3550.pdf">PDF</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Carsten Schmoll</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fraunhofer FOKUS</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kaiserin-Augusta-Allee 31</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Berlin  D-10589</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 30 3463 7136</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:carsten.schmoll@fokus.fraunhofer.de">carsten.schmoll@fokus.fraunhofer.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.fokus.fraunhofer.de">http://www.fokus.fraunhofer.de</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Paul Aitken</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">96 Commercial Quay</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Edinburgh  EH6 6LX</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Scotland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+44 131 561 3616</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:paitken@cisco.com">paitken@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.cisco.com">http://www.cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Benoit Claise</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">De Kleetlaan 6a b1</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1831 Diegem</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Belgium</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+32 2 704 5622</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:bclaise@cisco.com">bclaise@cisco.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.cisco.com">http://www.cisco.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
