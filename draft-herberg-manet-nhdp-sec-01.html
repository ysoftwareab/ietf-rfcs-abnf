<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Cryptographical Signatures in NHDP</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Applicability Statement">
<link href="#rfc.section.4" rel="Chapter" title="4 Protocol Overview and Functioning">
<link href="#rfc.section.5" rel="Chapter" title="5 Transmitting a Message in NHDP">
<link href="#rfc.section.6" rel="Chapter" title="6 Signing a Message">
<link href="#rfc.section.7" rel="Chapter" title="7 Processing a Message">
<link href="#rfc.section.8" rel="Chapter" title="8 Validating a Timestamp">
<link href="#rfc.section.9" rel="Chapter" title="9 Validating a Signature">
<link href="#rfc.section.10" rel="Chapter" title="10 Parameters and Constants">
<link href="#rfc.section.11" rel="Chapter" title="11 Preconditions">
<link href="#rfc.section.12" rel="Chapter" title="12 Summary of NHDP Interaction">
<link href="#rfc.section.13" rel="Chapter" title="13 Security Threats Alleviation Analysis">
<link href="#rfc.section.13.1" rel="Chapter" title="13.1 Jamming">
<link href="#rfc.section.13.2" rel="Chapter" title="13.2 Identity Spoofing">
<link href="#rfc.section.13.3" rel="Chapter" title="13.3 Link Spoofing">
<link href="#rfc.section.13.4" rel="Chapter" title="13.4 Replay Attack">
<link href="#rfc.section.14" rel="Chapter" title="14 IANA Considerations">
<link href="#rfc.section.15" rel="Chapter" title="15 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="16 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="This document specifies an extension to the Neighbor Discovery Protocol (NHDP) which uses cryptographic signatures in HELLO messages to encounter a selection of security threats to NHDP." />
  <meta name="description" content="This document specifies an extension to the Neighbor Discovery Protocol (NHDP) which uses cryptographic signatures in HELLO messages to encounter a selection of security threats to NHDP." />
  <meta name="keywords" content="MANET, Draft" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Mobile Ad hoc Networking (MANET)</td>
<td class="right">U. Herberg</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">T. Clausen</td>
</tr>
<tr>
<td class="left">Intended status: Experimental Protocol</td>
<td class="right">LIX, Ecole Polytechnique</td>
</tr>
<tr>
<td class="left">Expires: September 30, 2011</td>
<td class="right">March 29, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Cryptographical Signatures in NHDP<br />
  <span class="filename">draft-herberg-manet-nhdp-sec-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>This document specifies an extension to the Neighbor Discovery Protocol (NHDP) which uses cryptographic signatures in HELLO messages to encounter a selection of security threats to NHDP.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 30, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Applicability Statement</a>
</li>
<li>4.   <a href="#rfc.section.4">Protocol Overview and Functioning</a>
</li>
<li>5.   <a href="#rfc.section.5">Transmitting a Message in NHDP</a>
</li>
<li>6.   <a href="#rfc.section.6">Signing a Message</a>
</li>
<li>7.   <a href="#rfc.section.7">Processing a Message</a>
</li>
<li>8.   <a href="#rfc.section.8">Validating a Timestamp</a>
</li>
<li>9.   <a href="#rfc.section.9">Validating a Signature</a>
</li>
<li>10.   <a href="#rfc.section.10">Parameters and Constants</a>
</li>
<li>11.   <a href="#rfc.section.11">Preconditions</a>
</li>
<li>12.   <a href="#rfc.section.12">Summary of NHDP Interaction</a>
</li>
<li>13.   <a href="#rfc.section.13">Security Threats Alleviation Analysis</a>
</li>
<li>13.1.   <a href="#rfc.section.13.1">Jamming</a>
</li>
<li>13.2.   <a href="#rfc.section.13.2">Identity Spoofing</a>
</li>
<li>13.3.   <a href="#rfc.section.13.3">Link Spoofing</a>
</li>
<li>13.4.   <a href="#rfc.section.13.4">Replay Attack</a>
</li>
<li>14.   <a href="#rfc.section.14">IANA Considerations</a>
</li>
<li>15.   <a href="#rfc.section.15">Security Considerations</a>
</li>
<li>16.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">This document describes how to use cryptographic signatures for countering a selection of the security threats analyzed in <a href="#NHDP-sec-threats">[NHDP-sec-threats]</a>. It specifies the use of such signatures for validating the identity of the originator of a HELLO message, the validity of the content (i.e. links being advertised) of a HELLO message, and the message integrity. The protection so offered against the threats in <a href="#NHDP-sec-threats">[NHDP-sec-threats]</a> is evaluated.</p>
<p id="rfc.section.1.p.2">This document specifies TLVs for carrying cryptographic signatures in HELLO messages using <a href="#RFC5444">[RFC5444]</a>, and specifies extensions (as enabled by <a href="#NHDP">[NHDP]</a>) to the HELLO message processing in <a href="#NHDP">[NHDP]</a>.</p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<p id="rfc.section.2.p.2">Additionally, this document uses the terminology of <a href="#RFC5444">[RFC5444]</a>,  <a href="#packetbb-sec">[packetbb-sec]</a>, <a href="#NHDP">[NHDP]</a> and <a href="#NHDP-sec-threats">[NHDP-sec-threats]</a>.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Applicability Statement</h1>
<p></p>

<ul>
<li>
<a href="#NHDP">[NHDP]</a> enables extensions to recognize additional reasons for rejecting a message as malformed, and mentions security as an explicit example.</li>
<li>This document, therefore, elaborates on how this in details can be done, providing a framework for signing and validating messages in NHDP.</li>
<li>Note that there is no "no one-size-fits-all", therefore this document uses the containers for carrying signatures and registries for cryptographic code-points as specified in <a href="#packetbb-sec">[packetbb-sec]</a>. The specification should therefore be generally be applicable where cryptographic signatures are thought an appropriate security solution. Note that the the choice of the cryptographic algorithm are to be made for each given deployment, and that the choice of such is out of scope for this document.</li>
<li>This document does not specify how to distribute cryptographic keys, shared secrets, parameters for signature algorithms, etc.</li>
<li>Note also that this document assumes that a router which is able to sign messages correctly (e.g. having valid cryptographic keys), is considered trusted. This document does not handle compromised routers with valid keys (e.g. a router that is compromised by a computer virus).</li>
</ul>

<p> Therefore: </p>

<ul><li>This document is generally applicable when <a href="#NHDP">[NHDP]</a> is used, and uses the <a href="#RFC5444">[RFC5444]</a> extension specified in <a href="#packetbb-sec">[packetbb-sec]</a>.</li></ul>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Protocol Overview and Functioning</h1>
<p id="rfc.section.4.p.1">The framework presented in this document provides two functionalities: </p>

<ul>
<li>Signing a HELLO message, and</li>
<li>Checking whether a signed incoming HELLO message is valid.</li>
</ul>

<p> When a router running NHDP is about to transmit a HELLO message on an interface, this extension: </p>

<ul>
<li>Specifies to calculate a digital signature of the message, and</li>
<li>Specifies how to add that signature to a message for transmission, by way of a SIGNATURE TLV.</li>
</ul>

<p> The framework allows to add several signatures with different hash and cryptographic functions.</p>
<p><a href="#NHDP">[NHDP]</a> allows to reject incoming HELLO messages prior to processing by NHDP for reasons such as invalid signatures. This extension specifies that for each SIGNATURE TLV in the Message TLV Block of that incoming message, the value of that TLV (i.e. the contained signature) is verified.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Transmitting a Message in NHDP</h1>
<p id="rfc.section.5.p.1">HELLO messages are generated as specified in <a href="#NHDP">[NHDP]</a>. In addition, each HELLO message MUST set the &lt;msg-orig-addr&gt; as well as the &lt;msg-seq-num&gt; field as specified in <a href="#RFC5444">[RFC5444]</a>. Before transmission of a message, it is signed as described in <a href="#sign">Section 6</a>.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> <a href="#sign" id="sign">Signing a Message</a>
</h1>
<p id="rfc.section.6.p.1">This section specifies how to sign a message. Note that a message may be signed several times using different signature algorithms. The following constraints MUST be respected when signing a message: </p>

<ul>
<li>The originator address of the message MUST be included. </li>
<li>The sequence number of the message MUST be included.</li>
</ul>

<p> Optionally: </p>

<ul><li>A TIMESTAMP TLV (as defined in <a href="#packetbb-sec">[packetbb-sec]</a>) MAY be added to the message if no such TLV is already included in the message TLV block of that message. The value of the TIMESTAMP TLV is the current POSIX timestamp (32-bit) of the router, and the type extension is 1 (one).</li></ul>

<p> For each signature algorithm that is used to sign the message: </p>

<ol>
<li>All TLVs of type SIGNATURE are temporarily removed from the message and stored in temporary variables. The message size is recalculated accordingly, i.e. to the size of the message without the SIGNATURE TLVs.</li>
<li>The signature value is calculated over the whole message (as resulting after step 1) according to the chosen signature algorithm.</li>
<li>A TLV of type SIGNATURE is added in the message TLV block. The TLV value is set to the signature calculated in step 2 as well as the chosen hash and cryptographic algorithms.</li>
<li>All other SIGNATURE TLVs that have been temporary removed, are restored.</li>
<li>The message size is recalculated.</li>
</ol>

<p> </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Processing a Message</h1>
<p id="rfc.section.7.p.1">NHDP specifies that </p>

<dl>
<dt></dt>
<dd style="margin-left: 8">"On receiving a HELLO message, a router MUST first check if the message is invalid for processing by this router"</dd>
</dl>

<p> and gives a number of conditions that will lead to a rejection of the HELLO message if any of these conditions is true. The extension to NHDP, specified in this document, adds the following conditions for rejecting a message: </p>

<ul>
<li>The message does not include the &lt;msg-orig-addr&gt; or the &lt;msg-seq-num&gt; field.</li>
<li>The message contains more than one TIMESTAMP TLV.</li>
<li>Any signature of the message is invalid as specified in <a href="#validate">Section 9</a>.</li>
<li>The timestamp of the message is invalid as specified in <a href="#validate_timestamp">Section 8</a>.</li>
</ul>

<p> </p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#validate_timestamp" id="validate_timestamp">Validating a Timestamp</a>
</h1>
<p id="rfc.section.8.p.1">This section specifies how to validate a message timestamp.  </p>

<ol><li>If the message includes a TIMESTAMP Message TLV, and the value of the TIMESTAMP TLV differs from the current POSIX time of more than MAX_TIMESTAMP_DIFF, the message MUST be discarded.</li></ol>

<p> </p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> <a href="#validate" id="validate">Validating a Signature</a>
</h1>
<p id="rfc.section.9.p.1">This section specifies how to validate a message signature.  </p>

<ol>
<li>For all SIGNATURE Message TLVs: <ol style="list-style-type: lower-alpha">
<li>If the hash function and the cryptographic function defined in that TLV are known to the router: goto step 2.</li>
<li>Otherwise goto step 1</li>
</ol>
<p> </p>
</li>
<li>If no signature algorithm has been recognized in step 1, the message MUST be discarded.</li>
<li>All SIGNATURE TLVs are removed from the message, and the message size is recalculated.</li>
<li>The signature is recalculated using the same hash function and cryptographic function as indicated in the TLV, and compared with the signature from the SIGNATURE TLV that has been removed in step 3.</li>
<li>If the verification fails, the message MUST be discarded.</li>
<li>Otherwise: <ol style="list-style-type: lower-alpha">
<li>All SIGNATURE TLVs are restored.</li>
<li>The message size is restored.</li>
</ol>
<p> </p>
</li>
<li>The message can now be processed according to <a href="#NHDP">[NHDP]</a>.</li>
</ol>

<p> </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Parameters and Constants</h1>
<p id="rfc.section.10.p.1">This document specifies the following parameters and constants: </p>

<ul><li>MAX_TIMESTAMP_DIFF - The maximum age a message that is to be validated may have. If the current POSIX time of the router validating the message minus the timestamp indicated in the TIMESTAMP TLV of the message is greater than MAX_TIMESTAMP_DIFF, the message will be discarded.</li></ul>

<p> The following constraints apply to these parameters: </p>

<ul><li>MAX_TIMESTAMP_DIFF &gt; 0</li></ul>

<p> </p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> Preconditions</h1>
<p id="rfc.section.11.p.1">Before a router is able to sign or validate messages, it must initially parameterize some security settings. In particular, it MUST acquire the cryptographic key(s) and any parameters of the cryptographic algorithm from all other routers that are to participate in the network. This document does not specify how a router acquires the cryptographic keys and parameters used in the MANET.  </p>
<h1 id="rfc.section.12">
<a href="#rfc.section.12">12.</a> Summary of NHDP Interaction</h1>
<p id="rfc.section.12.p.1">When the security mechanism as specified in this document is used, the following MUST be observed: </p>

<ul>
<li>NHDP must generate HELLO messages as usual.</li>
<li>NHDP MUST allow this security mechanism access to the HELLO message after its generation and prior to transmission, in order that a SIGNATURE TLV can be generated and inserted, as allowed by Section 16 in <a href="#NHDP">[NHDP]</a>.</li>
<li>Any other NHDP extension which adds information to a HELLO message and which wishes this added information to be included when calculating the cryptographic signature MUST do so prior to the HELLO message being handed off for signature generation.</li>
<li>An incoming HELLO message MUST be processed according to this specification prior to processing by <a href="#NHDP">[NHDP]</a> as allowed in Section 16 in <a href="#NHDP">[NHDP]</a>.</li>
<li>Any other NHDP extension, which has added information to a HELLO message and which wishes that the HELLO message is rejected if a cryptographic signature is not valid, MUST likewise process the HELLO message only after its processing according to this specification.</li>
</ul>

<p> </p>
<h1 id="rfc.section.13">
<a href="#rfc.section.13">13.</a> Security Threats Alleviation Analysis</h1>
<p id="rfc.section.13.p.1">This section analyzes which of the security threats that are detailed in <a href="#NHDP-sec-threats">[NHDP-sec-threats]</a> are alleviated by the framework presented in this document.</p>
<h1 id="rfc.section.13.1">
<a href="#rfc.section.13.1">13.1.</a> Jamming</h1>
<p id="rfc.section.13.1.p.1">Since jamming is a physical layer issue, it cannot be alleviated by protocols on the routing layer. This framework does not counteract jamming attacks, therefore.</p>
<h1 id="rfc.section.13.2">
<a href="#rfc.section.13.2">13.2.</a> <a href="#identity_spoofing" id="identity_spoofing">Identity Spoofing</a>
</h1>
<p id="rfc.section.13.2.p.1">As only routers possessing valid cryptographic keys are able to correctly sig  HELLO messages, identity spoofing is counteracted. If a router does not have access to valid keys or does not sign messages at all, it is not able to create HELLOs that are processed by neighbor routers. Such wrongly signed or unsigned messages are rejected by receiving routers as described in <a href="#validate">Section 9</a>.</p>
<h1 id="rfc.section.13.3">
<a href="#rfc.section.13.3">13.3.</a> Link Spoofing</h1>
<p id="rfc.section.13.3.p.1">Link spoofing is counteracted by the framework specified in this document, with the same argument as in <a href="#identity_spoofing">Section 13.2</a>. A router without access to valid cryptographic keys cannot sign the message correctly, and therefore the message will be rejected by any receiving routers. Hence, all links postulated by an attacker are ignored.</p>
<h1 id="rfc.section.13.4">
<a href="#rfc.section.13.4">13.4.</a> Replay Attack</h1>
<p id="rfc.section.13.4.p.1">Replay attacks are only counteracted if TIMESTAMP TLVs are included in HELLO messages. This is optional, and depends on synchronized clocks of all routers in the MANET. An attacker which records messages to replay them later can only do so in the time interval between the timestamp that is contained in the TIMESTAMP TLV and MAX_TIMESTAMP_DIFF seconds later. As an attacker cannot modify the content of the TIMESTAMP TLV (since it does not possess the valid cryptographic keys), it cannot replay messages after this time interval. Within this time interval, however, it is still possible to replay attacks.</p>
<h1 id="rfc.section.14">
<a href="#rfc.section.14">14.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<p id="rfc.section.14.p.1">This document has no actions for IANA.</p>
<h1 id="rfc.section.15">
<a href="#rfc.section.15">15.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.15.p.1">This document specifies a protocol extension to NHDP which allows to alleviate some of the security threats of NHDP analyzed in <a href="#NHDP-sec-threats">[NHDP-sec-threats]</a>.</p>
<p id="rfc.section.15.p.2">If no synchronized clocks are available in the MANET, replay attacks cannot be counteracted by this framework.</p>
<p id="rfc.section.15.p.3">This framework does not avoid or detect security attacks by routers possessing the cryptographic keys that is used to sign messages.</p>
<p id="rfc.section.15.p.4">This specification depends on the quality of the used signature algorithm and provides as such the same security considerations as the hash function and the cipher algorithm.</p>
<p id="rfc.section.15.p.5">This specification relies on an out-of-band protocol to distribute keys and parameters. The security considerations of that protocol apply.</p>
<p id="rfc.section.15.p.6">This specification does not provide a key revocation mechanism.</p>
<h1 id="rfc.references">
<a href="#rfc.references">16.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="packetbb-sec">[packetbb-sec]</b></td>
<td class="top">
<a title="LIX, Ecole Polytechnique">Herberg, U</a> and <a title="LIX, Ecole Polytechnique">T Clausen</a>, "<a>MANET Cryptographical Signature TLV Definition</a>", work in progress draft-ietf-manet-packetbb-sec-03.txt, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="NHDP">[NHDP]</b></td>
<td class="top">
<a title="LIX, Ecole Polytechnique">Clausen, T.</a>, <a title="BAE Systems ATC">Dearlove, C.</a> and <a title="Naval Research Laboratory">J. Dean</a>, "<a href="http://tools.ietf.org/html/rfc6130">Mobile Ad Hoc Network (MANET) Neighborhood Discovery Protocol (NHDP)</a>", RFC 6130, March 2011.</td>
</tr>
<tr>
<td class="reference"><b id="NHDP-sec-threats">[NHDP-sec-threats]</b></td>
<td class="top">
<a title="Ecole Polytechnique, France">Herberg, U.</a> and <a title="Ecole Polytechnique, France">T.H. Clausen</a>, "<a>Security Threats for NHDP</a>", work in progress draft-herberg-manet-nhdp-sec-threats-00.txt, November 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5444">[RFC5444]</b></td>
<td class="top">
<a title="Ecole Polytechnique, France">Clausen, T.H.</a>, <a title="BAE Systems Advanced Technology Centre, UK">Dearlove, C.M.</a>, <a title="Naval Research Laboratory, USA">Dean, J.W.</a> and <a title="INRIA Rocquencourt">C. Adjih</a>, "<a href="http://tools.ietf.org/html/rfc5444">Generalized MANET Packet/Message Format</a>", RFC 5444, February 2009.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Ulrich Herberg</span> 
	  <span class="n hidden">
		<span class="family-name">Herberg</span>
	  </span>
	</span>
	<span class="org vcardline">LIX, Ecole Polytechnique</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">91128 Palaiseau Cedex</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:ulrich@herberg.name">ulrich@herberg.name</a></span>

<span class="vcardline">URI: <a href="http://www.herberg.name/">http://www.herberg.name/</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Thomas Heide Clausen</span> 
	  <span class="n hidden">
		<span class="family-name">Clausen</span>
	  </span>
	</span>
	<span class="org vcardline">LIX, Ecole Polytechnique</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality">91128 Palaiseau Cedex</span>,  
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">France</span>
	</span>
	<span class="vcardline">Phone: +33 6 6058 9349</span>

<span class="vcardline">EMail: <a href="mailto:T.Clausen@computer.org">T.Clausen@computer.org</a></span>

<span class="vcardline">URI: <a href="http://www.thomasclausen.org/">http://www.thomasclausen.org/</a></span>

  </address>
</div>

</body>
</html>