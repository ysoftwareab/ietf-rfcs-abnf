<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Cryptographical Signatures in NHDP</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Cryptographical Signatures in NHDP">
<meta name="keywords" content="MANET, Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Mobile Ad hoc Networking (MANET)</td><td class="header">U. Herberg</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">T. Clausen</td></tr>
<tr><td class="header">Intended status: Experimental</td><td class="header">LIX, Ecole Polytechnique</td></tr>
<tr><td class="header">Expires: May 16, 2010</td><td class="header">November 12, 2009</td></tr>
</table></td></tr></table>
<h1><br />Cryptographical Signatures in NHDP<br />draft-herberg-manet-nhdp-sec-00</h1>

<h3>Abstract</h3>

<p>This document specifies an extension to the Neighbor Discovery Protocol (NHDP) which uses cryptographic signatures in HELLO messages to encounter a selection of security threats to NHDP.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 16, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
Applicability Statement<br />
<a href="#anchor4">4.</a>&nbsp;
Protocol Overview and Functioning<br />
<a href="#anchor5">5.</a>&nbsp;
Transmitting a message in NHDP<br />
<a href="#sign">6.</a>&nbsp;
Signing a Message<br />
<a href="#anchor6">7.</a>&nbsp;
Processing a Message in NHDP<br />
<a href="#validate_timestamp">8.</a>&nbsp;
Validating a Timestamp <br />
<a href="#validate">9.</a>&nbsp;
Validating a Signature<br />
<a href="#anchor7">10.</a>&nbsp;
Parameters and Constants<br />
<a href="#anchor8">11.</a>&nbsp;
Preconditions<br />
<a href="#anchor9">12.</a>&nbsp;
Summary of NHDP Interaction<br />
<a href="#anchor10">13.</a>&nbsp;
Security Threats Alleviation Analysis<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">13.1.</a>&nbsp;
Jamming<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#identity_spoofing">13.2.</a>&nbsp;
Identity Spoofing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">13.3.</a>&nbsp;
Link Spoofing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">13.4.</a>&nbsp;
Replay Attack<br />
<a href="#IANA">14.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">15.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">16.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document describes how to use cryptographic signatures for countering a selection of the security threats analyzed in <a class='info' href='#NHDP-sec-threats'>[NHDP&#8209;sec&#8209;threats]<span> (</span><span class='info'>Herberg, U. and T. Clausen, &ldquo;Security Threats for NHDP,&rdquo; November&nbsp;2009.</span><span>)</span></a>. It specifies the use of such signatures for validating the identity of the originator of a HELLO message, the validity of the content (i.e. links being advertised) of a HELLO message, and the message integrity. The protection so offered against the threats in <a class='info' href='#NHDP-sec-threats'>[NHDP&#8209;sec&#8209;threats]<span> (</span><span class='info'>Herberg, U. and T. Clausen, &ldquo;Security Threats for NHDP,&rdquo; November&nbsp;2009.</span><span>)</span></a> is evaluated.
</p>
<p>This document specifies TLVs for carrying cryptographic signatures in HELLO messages using <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>, and specifies extensions (as enabled by <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a>) to the HELLO message processing in <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<p>Additionally, this document uses the terminology of <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>,  <a class='info' href='#packetbb-sec'>[packetbb&#8209;sec]<span> (</span><span class='info'>Herberg, U. and T. Clausen, &ldquo;MANET Cryptographical Signature TLV Definition,&rdquo; July&nbsp;2009.</span><span>)</span></a>, <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a> and <a class='info' href='#NHDP-sec-threats'>[NHDP&#8209;sec&#8209;threats]<span> (</span><span class='info'>Herberg, U. and T. Clausen, &ldquo;Security Threats for NHDP,&rdquo; November&nbsp;2009.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Applicability Statement</h3>

<p>
				</p>
<ul class="text">
<li><a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a> enables extensions to recognize additional reasons for rejecting a message as malformed, and mentions security as an explicit example.
</li>
<li>This document, therefore, elaborates on how this in details can be done, providing a framework for signing and validating messages in NHDP.
</li>
<li>Note that there is no "no one-size-fits-all", therefore this document uses the containers for carrying signatures and registries for cryptographic code-points as specified in <a class='info' href='#packetbb-sec'>[packetbb&#8209;sec]<span> (</span><span class='info'>Herberg, U. and T. Clausen, &ldquo;MANET Cryptographical Signature TLV Definition,&rdquo; July&nbsp;2009.</span><span>)</span></a>. The specification should therefore be generally be applicable where cryptographic signatures are thought an appropriate security  solution. Note that the the choice of the cryptographic algorithm are to be made for each given deployment and that the choice of such is out of scope for this document.
</li>
<li>This document does not specify how to distribute cryptographic keys, shared secrets, parameters for signature algorithms, etc.
</li>
<li>Note also that this document assumes that a router which is able to sign messages correctly (e.g. having a valid cryptographic key), is considered trusted. This document does not handle compromised routers with a valid key (e.g. a router that is compromised by a computer virus).
</li>
</ul><p>
				Therefore:
				</p>
<ul class="text">
<li>This document is generally applicable when <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a> is used, and uses the <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a> extension specified in <a class='info' href='#packetbb-sec'>[packetbb&#8209;sec]<span> (</span><span class='info'>Herberg, U. and T. Clausen, &ldquo;MANET Cryptographical Signature TLV Definition,&rdquo; July&nbsp;2009.</span><span>)</span></a>.
</li>
</ul><p>
			
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol Overview and Functioning</h3>

<p>The framework presented in this document provides two functionalities:
      		</p>
<ul class="text">
<li>Signing a HELLO message
</li>
<li>Checking whether a signed incoming HELLO message is valid
</li>
</ul><p>
      		
      		When NHDP is about to transmit a HELLO message on an interface, this extension:
      		
      		</p>
<ul class="text">
<li>specifies to calculate a digital signature of the message, and
</li>
<li>specifies how to add that signature to a message for transmission, by way of a SIGNATURE TLV/
</li>
</ul><p>
      		The framework allows to add several signatures with different hash and cryptographic functions.
</p>
<p><a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a> allows to reject incoming HELLO messages prior to processing by NHDP for reasons such as invalid signatures. This extension specifies that for each SIGNATURE TLV in the Message TLV Block of that incoming message, the value of that TLV (i.e. the contained signature) is verified.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Transmitting a message in NHDP</h3>

<p>HELLO messages are generated as specified in <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a>. In addition, each HELLO message MUST set the &lt;msg-orig-addr&gt; as well as the &lt;msg-seq-num&gt; field as specified in <a class='info' href='#RFC5444'>[RFC5444]<span> (</span><span class='info'>Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;Generalized MANET Packet/Message Format,&rdquo; February&nbsp;2009.</span><span>)</span></a>. Before transmission of a message, it is signed as described in <a class='info' href='#sign'>Section&nbsp;6<span> (</span><span class='info'>Signing a Message</span><span>)</span></a>.
        	
</p>
<a name="sign"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Signing a Message</h3>

<p>This section specifies how to sign a message. Note that a message may be signed several times using different signature algorithms. The following constraints MUST be respected when signing a message:
      		</p>
<ul class="text">
<li>The originator address of the message MUST be included. 
</li>
<li>The sequence number of the message MUST be included.
</li>
</ul><p>
      
      		Optionally:
			</p>
<ul class="text">
<li>A TIMESTAMP TLV (as defined in <a class='info' href='#packetbb-sec'>[packetbb&#8209;sec]<span> (</span><span class='info'>Herberg, U. and T. Clausen, &ldquo;MANET Cryptographical Signature TLV Definition,&rdquo; July&nbsp;2009.</span><span>)</span></a>) MAY be added to the message if no such TLV is already included in the message TLV block of that message. The value of the TIMESTAMP TLV is the current POSIX timestamp (32-bit) of the router, and the type extension is 1 (one).
</li>
</ul><p>

      		For each signature algorithm that is used to sign the message:
        	</p>
<ol class="text">
<li>All TLVs of type SIGNATURE are temporarily removed from the message and stored in temporary variables. The message size is recalculated accordingly, i.e. to the size of the message without the SIGNATURE TLVs.
</li>
<li>The signature value is calculated over the whole message (as resulting after step 1) according to the chosen signature algorithm.
</li>
<li>A TLV of type SIGNATURE is added in the message TLV block. The TLV value is set to the signature calculated in step 2 as well as the chosen hash and cryptographic algorithms.
</li>
<li>All other SIGNATURE TLVs that have been temporary removed, are restored.
</li>
<li>The message size is recalculated.
</li>
</ol><p>
      		
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Processing a Message in NHDP</h3>

<p>NHDP specifies that 
      			</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>"On receiving a HELLO message, a router MUST first check if the message is invalid for processing by this router"
</dd>
</dl></blockquote><p>
   			and gives a number of conditions that will lead to a rejection of the HELLO message if any of these conditions is true. The extension specified in this document adds the following conditions for rejecting a message:
     		</p>
<ul class="text">
<li>The message does not include the &lt;msg-orig-addr&gt; or the &lt;msg-seq-num&gt; field.
</li>
<li>The message contains more than one TIMESTAMP TLV.
</li>
<li>Any signature of the message is invalid as specified in <a class='info' href='#validate'>Section&nbsp;9<span> (</span><span class='info'>Validating a Signature</span><span>)</span></a>.
</li>
<li>The timestamp of the message is invalid as specified in <a class='info' href='#validate_timestamp'>Section&nbsp;8<span> (</span><span class='info'>Validating a Timestamp </span><span>)</span></a>.
</li>
</ul><p>
      		
</p>
<a name="validate_timestamp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Validating a Timestamp </h3>

<p>This section specifies how to validate a message timestamp.
       		</p>
<ol class="text">
<li>If the message includes a TIMESTAMP Message TLV, and the value of the TIMESTAMP TLV differs from the current POSIX time of more than MAX_TIMESTAMP_DIFF, the message MUST be discarded.
</li>
</ol><p>  
      		
</p>
<a name="validate"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Validating a Signature</h3>

<p>This section specifies how to validate a message signature.
       		</p>
<ol class="text">
<li>For all SIGNATURE Message TLVs:
           			
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>If the hash function and the cryptographic function defined in that are known to the router: goto step 2.
</dd>
<dt>B.</dt>
<dd>Otherwise goto step 1
</dd>
</dl></blockquote>
          		
</li>
<li>If no signature algorithm has been recognized in step 1, the message MUST be discarded.
</li>
<li>All SIGNATURE TLVs are removed from the message, and the message size is recalculated.
</li>
<li>The signature is recalculated using the same hash function and cryptographic function as indicated in the TLV, and compared with the signature from the SIGNATURE TLV that has been removed in step 3.
</li>
<li>If the verification fails, the message MUST be discarded.
</li>
<li>Otherwise:
            		
<blockquote class="text"><dl>
<dt>A.</dt>
<dd>Restore all SIGNATURE TLVs.
</dd>
<dt>B.</dt>
<dd>Restore the message size.
</dd>
</dl></blockquote>
          		
</li>
<li>The message can now be processed according to <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</li>
</ol><p>  
      		
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Parameters and Constants</h3>

<p>This document specifies the following parameters and constants:
			</p>
<ul class="text">
<li>MAX_TIMESTAMP_DIFF - The maximum age a message that is to be validated may have. If the current POSIX time of the router validating the message minus the timestamp indicated in the TIMESTAMP TLV of the message is greater than MAX_TIMESTAMP_DIFF, the message will be discarded.
</li>
</ul><p>
			
			The following constraints apply to these parameters:
			</p>
<ul class="text">
<li>MAX_TIMESTAMP_DIFF &gt; 0
</li>
</ul><p>
			
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Preconditions</h3>

<p>Before a router is able to sign or validate messages, it must initially parameterize some security settings. In particular, it MUST acquire the cryptographic key(s) and any parameters of the cryptographic algorithm from all other routers that are to participate in the network.  This document does not specify how a router acquires the cryptographic keys and parameters used in the MANET. 
        	
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
Summary of NHDP Interaction</h3>

<p>When the security mechanisms as specified in this document is used, the following MUST be observed:
			</p>
<ul class="text">
<li>NHDP must generate HELLO messages as usual.
</li>
<li>NHDP MUST allow this security mechanism access to the HELLO message after its generation and prior to transmission, in order that a SIGNATURE TLV can be generated and inserted, as allowed by Section 16 in <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</li>
<li>Any other NHDP extension which adds information to a HELLO message and which wishes this added information to be included when calculating the cryptographic signature MUST do so prior to the HELLO message being handed off for signature generation.
</li>
<li>An incoming HELLO message MUST be processed according to this specification prior to processing by <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a> as allowed in Section 16 in <a class='info' href='#NHDP'>[NHDP]<span> (</span><span class='info'>Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</li>
<li>Any other NHDP extension, which has added information to a HELLO message and which wishes that the HELLO message is rejected if a cryptographic signature is not valid, MUST likewise process the HELLO message only after its processing according to this specification.
</li>
</ul><p>
			
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13"></a><h3>13.&nbsp;
Security Threats Alleviation Analysis</h3>

<p>This section analyzes which of the security threats that are detailed in <a class='info' href='#NHDP-sec-threats'>[NHDP&#8209;sec&#8209;threats]<span> (</span><span class='info'>Herberg, U. and T. Clausen, &ldquo;Security Threats for NHDP,&rdquo; November&nbsp;2009.</span><span>)</span></a> are alleviated by the framework presented in this document.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.1"></a><h3>13.1.&nbsp;
Jamming</h3>

<p>Since jamming is a physical layer issue, it cannot be alleviated by protocols on the routing layer. This framework does not counteract jamming attacks, therefore.
</p>
<a name="identity_spoofing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.2"></a><h3>13.2.&nbsp;
Identity Spoofing</h3>

<p>As only routers possessing a valid cryptographic keys are able to sign correctly HELLO messages, identity spoofing is counteracted. If a router does not have access to a valid key or does not sign messages at all, it is not able to create HELLOs that are processed by neighbor routers. Such wrongly signed or unsigned messages are rejected by receiving routers as described in <a class='info' href='#validate'>Section&nbsp;9<span> (</span><span class='info'>Validating a Signature</span><span>)</span></a>.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.3"></a><h3>13.3.&nbsp;
Link Spoofing</h3>

<p>Link spoofing is counteracted by the framework specified in this draft, with the same argument as in <a class='info' href='#identity_spoofing'>Section&nbsp;13.2<span> (</span><span class='info'>Identity Spoofing</span><span>)</span></a>. A router without access to a valid cryptographic key cannot sign the message correctly, and therefore the message will be rejected by any receiving routers. Hence, all links postulated by an attacker are ignored.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.13.4"></a><h3>13.4.&nbsp;
Replay Attack</h3>

<p>Replay attacks are only counteracted if TIMESTAMP TLVs are included in HELLO messages. This is optional, and depends on synchronized clocks of all routers in the MANET. An attacker which records messages to replay them later can only do so in the time interval between the timestamp that is contained in the TIMESTAMP TLV and MAX_TIMESTAMP_DIFF seconds later. As an attacker cannot modify the content if the TIMESTAMP TLV (since it does not possess the valid cryptographic key), it cannot replay messages after this time interval. Within this time interval, however, it is still possible to replay attacks.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.14"></a><h3>14.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.15"></a><h3>15.&nbsp;
Security Considerations</h3>

<p>This document specifies a protocol extension to NHDP which allows to alleviate some of the security threats of NHDP analyzed in <a class='info' href='#NHDP-sec-threats'>[NHDP&#8209;sec&#8209;threats]<span> (</span><span class='info'>Herberg, U. and T. Clausen, &ldquo;Security Threats for NHDP,&rdquo; November&nbsp;2009.</span><span>)</span></a>.
</p>
<p>If no synchronized clocks are available in the MANET, replay attacks cannot be counteracted by this framework.
</p>
<p>This framework does not avoid or detect security attacks by routers possessing the cryptographic key that is used to sign messages.
</p>
<p>This specification depends on the quality of the used signature algorithm and provides as such the same security considerations as the hash function and the cipher algorithm.
</p>
<p>This specification relies on an out-of-band protocol to distribute keys and parameters. The security considerations of that protocol apply.
</p>
<p>This specification does not provide a key revocation mechanism.
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>16.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="NHDP">[NHDP]</a></td>
<td class="author-text">Clausen, T., Dean, J., and C. Dearlove, &ldquo;MANET Neighborhood Discovery Protocol (NHDP),&rdquo; work in progress&nbsp;draft-ietf-manet-nhdp-11.txt, October&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="NHDP-sec-threats">[NHDP-sec-threats]</a></td>
<td class="author-text">Herberg, U. and T. Clausen, &ldquo;Security Threats for NHDP,&rdquo; work in progress&nbsp;draft-herberg-manet-nhdp-sec-threats-00.txt, November&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="ftp://ftp.isi.edu/in-notes/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5444">[RFC5444]</a></td>
<td class="author-text">Clausen, T., Dearlove, C., Dean, J., and C. Adjih, &ldquo;<a href="http://tools.ietf.org/html/rfc5444">Generalized MANET Packet/Message Format</a>,&rdquo; RFC&nbsp;5444, February&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="packetbb-sec">[packetbb-sec]</a></td>
<td class="author-text">Herberg, U. and T. Clausen, &ldquo;MANET Cryptographical Signature TLV Definition,&rdquo; work in progress&nbsp;draft-herberg-manet-packetbb-sec-02.txt, July&nbsp;2009.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ulrich Herberg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">LIX, Ecole Polytechnique</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">91128 Palaiseau Cedex, </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ulrich@herberg.name">ulrich@herberg.name</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.herberg.name/">http://www.herberg.name/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Thomas Heide Clausen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">LIX, Ecole Polytechnique</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">91128 Palaiseau Cedex, </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">France</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+33 6 6058 9349</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:T.Clausen@computer.org">T.Clausen@computer.org</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.thomasclausen.org/">http://www.thomasclausen.org/</a></td></tr>
</table>
</body></html>
