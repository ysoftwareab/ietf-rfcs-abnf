



Netconf                                                       B. Lengyel
Internet-Draft                                                  Ericsson
Intended status: Standards Track                               B. Claise
Expires: April 22, 2019                              Cisco Systems, Inc.
                                                        October 19, 2018


                 YANG Based Instance Data Files Format
               draft-lengyel-netmod-yang-instance-data-05

Abstract

   There is a need to document data defined in YANG models without the
   need to fetch it from a live YANG server.  Data is often needed
   already in design time or needed by groups that do not have a live
   running YANG server available.  This document specifies a standard
   file format for YANG Based Instance data, that is data that could be
   stored in a datastore and whose syntax and semantics is defined by
   YANG models.  Most important use cases foreseen include documenting
   server capabilities, factory-default settings, or vendor provided
   default configurations.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 22, 2019.

Copyright Notice

   Copyright (c) 2018 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents



Lengyel & Claise         Expires April 22, 2019                 [Page 1]

Internet-Draft          YANG Based Instance Data            October 2018


   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   2
   2.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
     2.1.  Use Cases . . . . . . . . . . . . . . . . . . . . . . . .   3
       2.1.1.  Use Case 1: Early Documentation of Server Capabilites   3
       2.1.2.  Use Case 2: Preloading Data . . . . . . . . . . . . .   4
       2.1.3.  Use Case 3: Dcoumenting Factory Default Settings  . .   4
   3.  Instance Data File Format . . . . . . . . . . . . . . . . . .   5
   4.  Data Life cycle . . . . . . . . . . . . . . . . . . . . . . .   8
   5.  Delivery of Instance Data . . . . . . . . . . . . . . . . . .   9
   6.  YANG Model  . . . . . . . . . . . . . . . . . . . . . . . . .   9
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .  11
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  11
   9.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  11
     9.1.  Normative References  . . . . . . . . . . . . . . . . . .  11
     9.2.  Informative References  . . . . . . . . . . . . . . . . .  11
   Appendix A.  Open Issues  . . . . . . . . . . . . . . . . . . . .  12
   Appendix B.  Changes between revisions  . . . . . . . . . . . . .  13
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  14

1.  Terminology

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
   "OPTIONAL" in this document are to be interpreted as described in BCP
   14 RFC 2119 [RFC2119] RFC 8174 [RFC8174] when, and only when, they
   appear in all capitals, as shown here.

   Design time: A time during which a YANG model and the implementation
   behind it is created.  Sometimes in other documents this period is
   divided into design and implementation time.

   Instance Data Set: A named set of data items that can be used as
   instance data in a YANG data tree.

   Instance Data File: A file containing an instance data set formatted
   according to the rules described in this document.

   Target YANG Module: A YANG module for which the instance data set
   contains instance data, like ietf-yang-library in the examples.




Lengyel & Claise         Expires April 22, 2019                 [Page 2]

Internet-Draft          YANG Based Instance Data            October 2018


2.  Introduction

   There is a need to provide instance data defined in YANG models
   without the need to fetch it from a live YANG server.  Data is often
   needed already in design time before the YANG server is implemented
   or needed by groups that do not have a live running YANG server
   available.  To facilitate this off-line delivery of data this
   document specifies a standard file format for YANG Based Instance
   data, that is data that could be stored in a datastore and whose
   syntax and semantics is defined by YANG models.

2.1.  Use Cases

   We present a number of use cases were Yang based instance data is
   needed.

2.1.1.  Use Case 1: Early Documentation of Server Capabilites

   A YANG server has a number of server-capabilities that are defined in
   YANG modules and can be retrieved from the server using protocols
   like NETCONF or RESTCONF.  YANG server capabilities include

   o  data defined in ietf-yang-library: YANG modules, submodules,
      features, deviations, schema-mounts, datastores supported
      ([I-D.ietf-netconf-rfc7895bis])

   o  alarms supported ([I-D.ietf-ccamp-alarm-module])

   o  data nodes, subtrees that support or do not support on-change
      notifications ([I-D.ietf-netconf-yang-push])

   o  netconf-capabilities in ietf-netconf-monitoring

   While it is good practice to allow a client to query these
   capabilites from the live YANG server, that is often not enough.

   Often when a network node is released an associated NMS (network
   management system) is also released with it.  The NMS depends on the
   capabilities of the YANG server.  During NMS implementation
   information about server capabilities is needed.  If the information
   is not available early in some off-line document, but only as
   instance data from the live network node, the NMS implementation will
   be delayed, because it has to wait for the network node to be ready.
   Also assuming that all NMS implementors will have a correctly
   configured network node available to retrieve data from, is a very
   expensive proposition.  (An NMS may handle dozens of node types.)





Lengyel & Claise         Expires April 22, 2019                 [Page 3]

Internet-Draft          YANG Based Instance Data            October 2018


   Network operators often build their own home-grown NMS systems that
   needs to be integrated with a vendor's network node.  The operator
   needs to know the network node's server capabilities in order to do
   this.  Moreover the network operator's decision to buy a vendor's
   product may even be influenced by the network node's OAM feature set
   documented as the Yang server's capabilites.

   Beside NMS implementors, system integrators and many others also need
   the same information early.  Examples could be model driven testing,
   generating documentation, etc.

   Most server-capabilities are relatively stable and change only during
   upgrade or due to licensing or addition or removal of HW.  They are
   usually defined by a vendor in design time, before the product is
   released.  It feasible and advantageous to define/document them early
   e.g. in a Yang Based Instance Data File.

   It is anticipated that a separate IETF document will define in detail
   how and which set of server capabilites should be documented.

2.1.2.  Use Case 2: Preloading Data

   There are parts of the configuration that must be fully configurable
   by the operator, however for which often a simple default
   configuration will be sufficient.

   One example is access control groups/roles and related rules.  While
   a sophisticated operator may define dozens of different groups often
   a basic (read-only operator, read-write system administrator,
   security-administrator) triplet will be enough.  Vendors will often
   provide such default configuration data to make device configuration
   easier for an operator.

   Defining Access control data is a complex task.  To help the device
   vendor pre-defines a set of default groups (/nacm:nacm/groups) and
   rules for these groups to access specific parts of common models
   (/nacm:nacm/rule-list/rule).

   YANG Based Instance data files are used to document and/or preload
   the default configurationp.

2.1.3.  Use Case 3: Dcoumenting Factory Default Settings

   Nearly every YANG server has a factory default configuration.  If the
   system is really badly misconfigured or if the current configuration
   is to be abandoned the system can be reset to this default.





Lengyel & Claise         Expires April 22, 2019                 [Page 4]

Internet-Draft          YANG Based Instance Data            October 2018


   In Netconf the <delete-config> operation can already be used to do
   this for the startup configuration.  There are ongoing efforts to
   introduce a new, more generic reset operation for the same purpose
   [I-D.wu-netconf-restconf-factory-restore]

   The operator currently has no way to know what the default
   configuration actually contains.  YANG Based Instance data can be
   used to document the factory default configuration.

3.  Instance Data File Format

   Two standard formats to represent YANG Based Instance Data are
   specified based on the XML and JSON encoding.  The XML format is
   based on [RFC7950] while the JSON format is based on [RFC7951].
   Later as other YANG encodings (e.g.  CBOR) are defined further
   Instance Data formats may be specified.

   For both formats data is placed in a top level auxiliary container
   named "instance-data-set".  The purpose of the container, which is
   not part of the real data itself, is to carry meta-data for the
   complete instance-data-set.

   The XML format SHALL follow the format returned for a NETCONF GET
   operation.  The <data> anydata (which is not part of the real data
   itself) SHALL contain all data that would be inside the <data>
   wrapper element of a reply to the <get> operation.  XML attributes
   SHOULD NOT be present, however if a SW receiving a YANG Based
   Instance data file encounters XML attributes unknown to it, it MUST
   ignore them, allowing them to be used later for other purposes.

   The JSON format SHALL follow the format of the reply returmed for a
   RESTCONF GET request directed at the datastore resource:
   {+restconf}/data.  ETags and Timestamps SHOULD NOT be included, but
   if present SHOULD be ignored.

   A YANG Based Instance data file MUST contain a single instance data
   set.  Instance data MUST conform to the corresponding target YANG
   Modules and follow the XML/JSON encoding rules as defined in
   [RFC7950] and [RFC7951] and use UTF-8 character encoding.  A single
   instance data set MAY contain data for any number of target YANG
   modules, if needed it MAY carry the complete configuraton and state
   data set for a YANG server.  Default values SHOULD NOT but MAY be
   included.  Config=true and config=false data MAY be mixed in the
   instance data file.  Instance data files MAY contain partial data
   sets.  This means mandatory, min-elements or require-instance=true
   constrains MAY be violated.

   The name of the file SHOULD be of the form:



Lengyel & Claise         Expires April 22, 2019                 [Page 5]

Internet-Draft          YANG Based Instance Data            October 2018


      instance-data-set-name ['@' revision-date] ( '.yid' )

      E.g. acme-router-modules@2018-01-25.yid

   The revision date is optional.  It SHOULD NOT be used if the file is
   stored in a version control system (e.g. git) because the change of
   file names will break the connection between the different revisions
   of the file.

   Meta data, information about the data set itself SHALL be included in
   the instance data set.  This data will be children of the top level
   instance-data-set container as defined in the ietf-instance-data YANG
   module.  Meta data SHALL include:

   o  Name of the instance data set

   Meta data SHOULD include:

   o  Revision date of the instance data set

   o  Description of the instance data set.  The description SHOULD
      contain information whether and how the data can change during the
      lifetime of the YANG server.




























Lengyel & Claise         Expires April 22, 2019                 [Page 6]

Internet-Draft          YANG Based Instance Data            October 2018


<?xml version="1.0" encoding="UTF-8"?>
<instance-data-set xmlns=
    "urn:ietf:params:xml:ns:yang:ietf-yang-instance-data">
  <name>acme-router-modules</name>
  <revision>2108-01-25</revision>
  <description>Defines the minimal set of modules that any acme-router
       will contain. These modules will always be present.</description>
  <contact>info@acme.com</contact>
  <data>
    <yang-library xmlns="urn:ietf:params:xml:ns:yang:ietf-yang-library">
      <module-set>
        <name>basic</name>
        <module>
          <name>ietf-system</>
          <revision>2014-08-06</revision>
          <!-- description "A later revision may be used."; -->
          <namespace>urn:ietf:params:xml:ns:yang:ietf-system</namespace>
          <feature>authentication</feature>
          <feature>radius-authentication</feature>
        </module>
      </module-set>
    </yang-library>
  </data>
</instance-data-set>

                 Figure 1: XML Instance Data File example

























Lengyel & Claise         Expires April 22, 2019                 [Page 7]

Internet-Draft          YANG Based Instance Data            October 2018


   {
     "ietf-yang-instance-data:instance-data-set": {
       "name": "acme-router-modules",
       "revision": "2108-01-25",
       "contact": "info@acme.com",
       "description":
         "Defines the set of modules that an acme-router will contain.",
       "data": {
         "ietf-yang-library:yang-library": {
           "module-set": [
             "name": "basic",
             "module": [
               {
                 "name": "ietf-system",
                 "revision": "2014-08-06",
                 "namespace": "urn:ietf:params:xml:ns:yang:ietf-system",
                 "feature": ["authentication", "radius-authentication"]
               }
             }
           ]
         ]
       }
     }
   }

                 Figure 2: JSON Instance Data File example

4.  Data Life cycle

   Data defined or documented in YANG Based Instance Data Sets may be
   used for preloading a YANG server with this data, but the server may
   populate the data without using the actual file in which case the
   Instance Data File is only used as documentation.

   While such data will usually not change, data documented by Instance
   Data sets MAY be changed by the YANG server itself or by management
   operations.  It is out of scope for this document to specify a method
   to prevent this.  Whether such data changes and if so, when and how,
   SHOULD be described either in the instance data file description
   statement or in some other implementation specific manner.

   YANG Based Instance data is a snap-shot of information at a specific
   point of time.  If the data changes afterwards this is not
   represented in the instance data set anymore, the valid values can be
   retrieved in run-time via Netconf/Restconf






Lengyel & Claise         Expires April 22, 2019                 [Page 8]

Internet-Draft          YANG Based Instance Data            October 2018


   Notifications about the change of data documented by Instance Data
   Sets may be supplied by e.g. the Yang-Push mechanism, but it is out
   of scope for this document.

5.  Delivery of Instance Data

   Instance data files SHOULD be available without the need for a live
   YANG server e.g.  via download from the vendor's website, or any
   other way together with other product documentation.

6.  YANG Model

   <CODE BEGINS> file "ietf-yang-instance-data.yang"

  module ietf-yang-instance-data {
    yang-version 1.1;
    namespace
      "urn:ietf:params:xml:ns:yang:ietf-yang-instance-data";
    prefix yid ;

    import ietf-yang-data-ext { prefix yd; }

    import ietf-datastores { prefix ds; }

    organization  "IETF NETMOD Working Group";
    contact
     "WG Web:   <https://datatracker.ietf.org/wg/netmodf/>
      WG List:  <mailto:netmod@ietf.org>

      Author:  Balazs Lengyel
         <mailto:balazs.lengyel@ericsson.com>";

    description "The module defines the structure and content of YANG
         Instance Data Sets.";

    revision 2018-06-30 {
      description  "Initial revision.";
      reference "RFC XXXX: YANG Based Instance Data";
    }

    yd:yang-data instance-data-format {
      container instance-data-set {
        description "Auxiliary container to carry meta-data for
          the complete instance data set.";

        leaf name {
          type string;
          mandatory true;



Lengyel & Claise         Expires April 22, 2019                 [Page 9]

Internet-Draft          YANG Based Instance Data            October 2018


          description "Name of a YANG Based Instance data set.";
        }

        leaf description { type string; }

        leaf contact {
          type string;
          description "Contains the same information the contact
              statement carries for a YANG module.";
        }

        leaf organization {
          type string;
          description "Contains the same information the
              organization statement carries for a YANG module.";
        }

        leaf datastore {
          type ds:datastore-ref;
          description  "The identity of the datastore for which
            the instance data is documented for config=true data nodes.
            The leaf MAY be absent in which case the running dtastore or
            if thats not writable, the candidate datastore is implied.

            For config=false data nodes always the operational
            data store is implied.";
        }

        list revision {
          key date;
          description "An instance-data-set SHOULD have at least
              one revision entry.  For every published
              editorial change, a new one SHOULD be added in front
              of the revisions sequence so that all revisions are
              in reverse chronological order.";

          leaf date {
            type string {
              pattern '\d{4}-\d{2}-\d{2}';
            }
            description "Specifies the data the revision
                was last modified. Formated as YYYY-MM-DD";
          }

          leaf description { type  string; }
        }

        anydata data {



Lengyel & Claise         Expires April 22, 2019                [Page 10]

Internet-Draft          YANG Based Instance Data            October 2018


          mandatory true;
          description "Contains the real instance data.
              The data MUST conform to the relevant YANG Modules.";
        }
      }
    }
  }

   <CODE ENDS>

7.  Security Considerations

   Depending on the nature of the instance data, instance data files MAY
   need to be handled in a secure way.  The same type of handling should
   be applied, that would be needed for the result of a <get> operation
   returning the same data.

8.  IANA Considerations

   To be completed, all the usual requests for a new YANG module

9.  References

9.1.  Normative References

   [I-D.ietf-netmod-yang-data-ext]
              Bierman, A., Bjorklund, M., and K. Watsen, "YANG Data
              Extensions", draft-ietf-netmod-yang-data-ext-01 (work in
              progress), March 2018.

   [RFC7950]  Bjorklund, M., Ed., "The YANG 1.1 Data Modeling Language",
              RFC 7950, DOI 10.17487/RFC7950, August 2016,
              <https://www.rfc-editor.org/info/rfc7950>.

   [RFC7951]  Lhotka, L., "JSON Encoding of Data Modeled with YANG",
              RFC 7951, DOI 10.17487/RFC7951, August 2016,
              <https://www.rfc-editor.org/info/rfc7951>.

9.2.  Informative References

   [I-D.ietf-ccamp-alarm-module]
              Vallin, S. and M. Bjorklund, "YANG Alarm Module", draft-
              ietf-ccamp-alarm-module-04 (work in progress), October
              2018.







Lengyel & Claise         Expires April 22, 2019                [Page 11]

Internet-Draft          YANG Based Instance Data            October 2018


   [I-D.ietf-netconf-rfc7895bis]
              Bierman, A., Bjorklund, M., Schoenwaelder, J., Watsen, K.,
              and R. Wilton, "YANG Library", draft-ietf-netconf-
              rfc7895bis-07 (work in progress), October 2018.

   [I-D.ietf-netconf-yang-push]
              Clemm, A., Voit, E., Prieto, A., Tripathy, A., Nilsen-
              Nygaard, E., Bierman, A., and B. Lengyel, "YANG Datastore
              Subscription", draft-ietf-netconf-yang-push-19 (work in
              progress), September 2018.

   [I-D.wu-netconf-restconf-factory-restore]
              Wu, Q., Lengyel, B., and Y. Niu, "Factory default
              Setting", draft-wu-netconf-restconf-factory-restore-03
              (work in progress), October 2018.

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC8174]  Leiba, B., "Ambiguity of Uppercase vs Lowercase in RFC
              2119 Key Words", BCP 14, RFC 8174, DOI 10.17487/RFC8174,
              May 2017, <https://www.rfc-editor.org/info/rfc8174>.

Appendix A.  Open Issues

   o  If we define metadata per target module, a list of target YAM
      could be included in the metadata.  This depends on what
      additional metadata we will include.

   o  How do we know for which version of the target Yang Module is a
      data set valid?  Proposal: One possibility would be to just
      indicate for which module version(s) was the data set last
      updated.  This would be a hint about compatibility, but nothing
      more.  Maybe we should wait till the YANG versioning work is
      complete/stable.  Identifying just one version is way to strict,
      so something enforcing that shall not be used.

   o  Should we document what YANG features does the instance data set
      implicitly require?  Proposal: that is already a use case,
      documenting data from the YANG library.

   o  Augmenting metadata must be possible.  As of now it looks like
      yang-data-ext will solve that.  If not, define instance data as
      regular YANG instead of yd:yang-data.





Lengyel & Claise         Expires April 22, 2019                [Page 12]

Internet-Draft          YANG Based Instance Data            October 2018


Appendix B.  Changes between revisions

   v04 - v05

   o  Changed title and introduction to clarify that this draft is only
      about the file format and documenting server capabilities is just
      a use case.

   o  Added reference to draft-wu-netconf-restconf-factory-restore

   o  Added new open issues.

   v03 - v04

   o  Updated changelog for v02-v03

   v02 - v03

   o  Updated the document according to comments received at IETF102

   o  Added parameter to specify datastore

   o  Rearranged chapters

   o  Added new use case: Documenting Factory Default Settings

   o  Added "Target YANG Module" to terminology

   o  Clarified that instance data is a snapshot valid at the time of
      creation, so it does not contain any later changes.

   o  Removed topics from Open Issues according to comments received at
      IETF102

   v01 - v02

   o  The recommendation to document server capabilities was changed to
      be just the primary use-case.  (Merged chapter 4 into the use case
      chapter.)

   o  Stated that RFC7950/7951 encoding must be followed which also
      defines (dis)allowed whitespace rules.

   o  Added UTF-8 encoding as it is not specified in t950 for instance
      data

   o  added XML declaration




Lengyel & Claise         Expires April 22, 2019                [Page 13]

Internet-Draft          YANG Based Instance Data            October 2018


   v00 - v01

   o  Redefined using yang-data-ext

   o  Moved meta data into ordinary leafs/leaf-lists

Authors' Addresses

   Balazs Lengyel
   Ericsson
   Magyar Tudosok korutja 11
   1117 Budapest
   Hungary

   Phone: +36-70-330-7909
   Email: balazs.lengyel@ericsson.com


   Benoit Claise
   Cisco Systems, Inc.
   De Kleetlaan 6a b1
   1831 Diegem
   Belgium

   Phone: +32 2 704 5622
   Email: bclaise@cisco.com

























Lengyel & Claise         Expires April 22, 2019                [Page 14]
