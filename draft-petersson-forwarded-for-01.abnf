Forwarded-v = 1#kv-v

kv-v = OWS kv *( OWS ";" OWS kv ) OWS
kv   = for-kv | by-kv | proto-kv | host-kv |
               ext-kv | private-kv

for-kv     = "for=" node
by-kv      = "by="  node
proto-kv   = "proto=" ( "http" | "https" )
host-kv    = "host=" host

for=198.51.100.17;by=203.0.113.60;proto=http;host=example.com"
nodename = IPv4address | IP-literal |
                   "unknown" | "hidden" | obfnode

node            = nodename [ ":" node-port ]

node-port       = port | obfport
port            = 1*5DIGIT
obfport         = 1*(ALPHA | DIGIT)

IPv6address = "[" addr6 "]"
addr6 = hexpart [ ":" IPv4address ]
IPv4address = 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT "." 1*3DIGIT

hexpart = hexseq | hexseq "::" [ hexseq ] | "::" [ hexseq ]
hexseq  = hex4 *( ":" hex4)
hex4    = 1*4HEXDIG

obfnode         = "_" 1*( ALPHA | DIGIT )


Forwarded-v = 1#kv-v

kv-v = OWS kv *( OWS ";" OWS kv ) OWS
kv   = for-kv | by-kv | proto-kv | host-kv | ext-kv | private-kv

for-kv     = "for=" node
by-kv      = "by="  node
proto-kv   = "proto=" ( "http" | "https" )
host-kv    = "host=" host
ext-kv     =  extension "=" ext-value
private-kv = "x-" extension "=" ext-value

node = nodename [ ":" node-port ]
nodename = IPv4address | IP-literal |
         "unknown" | "hidden" | obfnode
obfnode = "_" 1*( ALPHA | DIGIT )
node-port = port | obfport
port = 1*5DIGIT
obfport = 1*( ALPHA | DIGIT )
extension = 1*( ALPHA | DIGIT | "-" )
ext-value = <any OCTET except CTLs, but including SP>


