<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Light Weighted EVPN</title>
<meta content="Yubao Wang" name="author">
<meta content="Ran Chen" name="author">
<meta content="
       When PBB EVPN   is used in Segment Routing networks,
   it is complicated to make use of the SID list to carry a function that is aiming for C-MACs.
       
       In  , End.DX2 function is defined, 
   this function can be used in EVPN VPLS. When it is used in EVPN VPLS, the data-plane learning defined in End.DT2U function
   can also be activated for End.DX2 function. On the basis of such End.DX2 function, 
   SRv6 EVPN can meet all the requirements per   and bring us some other benefits.
   Such SRv6 EVPN is called light-weighted SRv6 EVPN, and it will be more simpler than PBB EVPN over SRv6.
       
       It is easy for the light-weighted SRv6 EVPN to carry a SID that is aiming for customer ethernet packets,
   because there will be no other ethernet header between the SID list and the customer ethernet header. 
   These SIDs may be user-defined functions for the customer ethernet headers.   
       
    " name="description">
<meta content="xml2rfc 3.4.0" name="generator">
<meta content="EVPN, C-MAC, Overload, Reduction, PBB" name="keyword">
<meta content="draft-wang-bess-evpn-cmac-overload-reduction-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.4.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.1
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.25.0
    setuptools 40.6.2
    six 1.15.0
-->
<link href="/tmp/draft-wang-bess-evpn-cmac-overload-reduction-03-oly7lsz0.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">EVPN-lite</td>
<td class="right">December 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Wang &amp; Chen</td>
<td class="center">Expires 19 June 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">BESS WG</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-12-16" class="published">16 December 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-06-19">19 June 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">Y. Wang</div>
<div class="org">ZTE Corporation</div>
</div>
<div class="author">
      <div class="author-name">R. Chen</div>
<div class="org">ZTE Corporation</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Light Weighted EVPN</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">When PBB EVPN <span>[<a href="#RFC7623" class="xref">RFC7623</a>]</span> is used in Segment Routing networks,
   it is complicated to make use of the SID list to carry a function that is aiming for C-MACs.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">In <span>[<a href="#I-D.ietf-spring-srv6-network-programming" class="xref">I-D.ietf-spring-srv6-network-programming</a>]</span>, End.DX2 function is defined, 
   this function can be used in EVPN VPLS. When it is used in EVPN VPLS, the data-plane learning defined in End.DT2U function
   can also be activated for End.DX2 function. On the basis of such End.DX2 function, 
   SRv6 EVPN can meet all the requirements per <span>[<a href="#RFC7623" class="xref">RFC7623</a>]</span> and bring us some other benefits.
   Such SRv6 EVPN is called light-weighted SRv6 EVPN, and it will be more simpler than PBB EVPN over SRv6.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">It is easy for the light-weighted SRv6 EVPN to carry a SID that is aiming for customer ethernet packets,
   because there will be no other ethernet header between the SID list and the customer ethernet header. 
   These SIDs may be user-defined functions for the customer ethernet headers.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 19 June 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-background" class="xref">Background</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-overview" class="xref">Overview</a><a href="#section-toc.1-1.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.1.2.3">
                <p id="section-toc.1-1.1.2.3.1" class="keepWithNext"><a href="#section-1.3" class="xref">1.3</a>.  <a href="#name-terminology" class="xref">Terminology</a><a href="#section-toc.1-1.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-requirements" class="xref">Requirements</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-no-c-mac-awareness-in-the-b" class="xref">No C-MAC Awareness in the Backbone</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-evpn-irb-support" class="xref">EVPN IRB Support</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-unified-encapsulation-per-s" class="xref">Unified Encapsulation per Scenario</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-esi-features-remain-support" class="xref">ESI Features Remain Supported</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.5">
                <p id="section-toc.1-1.2.2.5.1"><a href="#section-2.5" class="xref">2.5</a>.  <a href="#name-flexible-multi-homing-remai" class="xref">Flexible Multi-homing Remains Supported</a><a href="#section-toc.1-1.2.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.6">
                <p id="section-toc.1-1.2.2.6.1"><a href="#section-2.6" class="xref">2.6</a>.  <a href="#name-c-mac-address-learning-and-" class="xref">C-MAC Address Learning and Confinement</a><a href="#section-toc.1-1.2.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.7">
                <p id="section-toc.1-1.2.2.7.1"><a href="#section-2.7" class="xref">2.7</a>.  <a href="#name-no-c-mac-flushing-for-all-a" class="xref">No C-MAC Flushing for All-Active ESes</a><a href="#section-toc.1-1.2.2.7.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.8">
                <p id="section-toc.1-1.2.2.8.1"><a href="#section-2.8" class="xref">2.8</a>.  <a href="#name-independent-c-mac-flushing-" class="xref">Independent C-MAC Flushing for Single-Active ESes</a><a href="#section-toc.1-1.2.2.8.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.9">
                <p id="section-toc.1-1.2.2.9.1"><a href="#section-2.9" class="xref">2.9</a>.  <a href="#name-independent-convergency-per" class="xref">Independent Convergency per &lt;ESI, EVI&gt;</a><a href="#section-toc.1-1.2.2.9.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.10">
                <p id="section-toc.1-1.2.2.10.1"><a href="#section-2.10" class="xref">2.10</a>. <a href="#name-route-aggregation-and-defau" class="xref">Route Aggregation and Default Route in Backbone</a><a href="#section-toc.1-1.2.2.10.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.11">
                <p id="section-toc.1-1.2.2.11.1"><a href="#section-2.11" class="xref">2.11</a>. <a href="#name-arp-suppression" class="xref">ARP Suppression</a><a href="#section-toc.1-1.2.2.11.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.12">
                <p id="section-toc.1-1.2.2.12.1"><a href="#section-2.12" class="xref">2.12</a>. <a href="#name-esi-indicator-aggregation" class="xref">ESI Indicator Aggregation</a><a href="#section-toc.1-1.2.2.12.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.13">
                <p id="section-toc.1-1.2.2.13.1"><a href="#section-2.13" class="xref">2.13</a>. <a href="#name-unequal-load-balance" class="xref">Unequal load-balance</a><a href="#section-toc.1-1.2.2.13.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.14">
                <p id="section-toc.1-1.2.2.14.1"><a href="#section-2.14" class="xref">2.14</a>. <a href="#name-ac-aware-service-interface" class="xref">AC-aware Service Interface</a><a href="#section-toc.1-1.2.2.14.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.2.2.15">
                <p id="section-toc.1-1.2.2.15.1"><a href="#section-2.15" class="xref">2.15</a>. <a href="#name-esi-agnostical-core-routers" class="xref">ESI-agnostical Core-Routers</a><a href="#section-toc.1-1.2.2.15.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-light-weighted-evpn-overvie" class="xref">Light-Weighted EVPN Overview</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-use-case" class="xref">Use Case</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-packet-walkthrough" class="xref">Packet Walkthrough</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-light-weighted-srv6-evpn" class="xref">Light-Weighted SRv6 EVPN</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-srv6-solution-overview" class="xref">SRv6 Solution Overview</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="xref">4.1.1</a>.  <a href="#name-aggregatable-enddx2-sid-and" class="xref">Aggregatable End.DX2 SID and End.DX2AGG SID</a><a href="#section-toc.1-1.4.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="xref">4.1.2</a>.  <a href="#name-the-advertisement-of-esi-ip" class="xref">The Advertisement of ESI-IPs</a><a href="#section-toc.1-1.4.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-srv6-specific-evpn-lite-pro" class="xref">SRv6-specific EVPN-lite Procedures</a><a href="#section-toc.1-1.4.2.2.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-enddx2agg-function-and-arga" class="xref">End.DX2AGG Function and Arg.ACI</a><a href="#section-toc.1-1.4.2.2.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-advanced-considerations" class="xref">Advanced Considerations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-esi-indicator-advertisement" class="xref">ESI Indicator Advertisement Optimization</a><a href="#section-toc.1-1.5.2.1.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-advertise-esi-sids-in-under" class="xref">Advertise ESI SIDs in Underlay Network</a><a href="#section-toc.1-1.5.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-advertise-esi-sids-for-over" class="xref">Advertise ESI SIDs for Overlay Network</a><a href="#section-toc.1-1.5.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-advertise-ac-sids-for-overl" class="xref">Advertise AC SIDs for Overlay Network</a><a href="#section-toc.1-1.5.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-unequal-lb-advertisement" class="xref">Unequal LB Advertisement</a><a href="#section-toc.1-1.5.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3">
                <p id="section-toc.1-1.5.2.3.1"><a href="#section-5.3" class="xref">5.3</a>.  <a href="#name-evpn-egress-protection" class="xref">EVPN Egress Protection</a><a href="#section-toc.1-1.5.2.3.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.1">
                    <p id="section-toc.1-1.5.2.3.2.1.1"><a href="#section-5.3.1" class="xref">5.3.1</a>.  <a href="#name-evpn-egress-node-protection" class="xref">EVPN Egress Node Protection</a><a href="#section-toc.1-1.5.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.3.2.2">
                    <p id="section-toc.1-1.5.2.3.2.2.1"><a href="#section-5.3.2" class="xref">5.3.2</a>.  <a href="#name-evpn-egress-link-protection" class="xref">EVPN Egress Link Protection</a><a href="#section-toc.1-1.5.2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.4">
                <p id="section-toc.1-1.5.2.4.1"><a href="#section-5.4" class="xref">5.4</a>.  <a href="#name-c-mac-flush-notification-pr" class="xref">C-MAC Flush Notification Procedure</a><a href="#section-toc.1-1.5.2.4.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.5">
                <p id="section-toc.1-1.5.2.5.1"><a href="#section-5.5" class="xref">5.5</a>.  <a href="#name-e-tree-support-consideratio" class="xref">E-Tree Support Considerations</a><a href="#section-toc.1-1.5.2.5.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.6">
                <p id="section-toc.1-1.5.2.6.1"><a href="#section-5.6" class="xref">5.6</a>.  <a href="#name-evpn-irb-support-considerat" class="xref">EVPN IRB Support Considerations</a><a href="#section-toc.1-1.5.2.6.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.5.2.7">
                <p id="section-toc.1-1.5.2.7.1"><a href="#section-5.7" class="xref">5.7</a>.  <a href="#name-use-ac-sid-in-mac-ip-advert" class="xref">Use AC SID in MAC/IP Advertisement Routes</a><a href="#section-toc.1-1.5.2.7.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-light-weighted-mpls-evpn" class="xref">Light-Weighted MPLS EVPN</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-mpls-solution-overview" class="xref">MPLS Solution Overview</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-mpls-specific-evpn-lite-pro" class="xref">MPLS-specific EVPN-lite Procedures</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-hierarchical-vpls-in-evpn-l" class="xref">Hierarchical VPLS in EVPN-lite</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-comparison-with-other-solut" class="xref">Comparison with Other Solutions</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-detailed-comparisons-with-p" class="xref">Detailed Comparisons with PBB EVPN over SRv6</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-detailed-comparisons-with-a" class="xref">Detailed Comparisons with Anycast Node SID</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty toc compact">
<li class="ulEmpty toc compact" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-enddx2agg-sid" class="xref">End.DX2AGG SID</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty toc compact" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-global-unique-esi-label-in-" class="xref">Global Unique ESI-label in EAD per ES Route</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty toc compact" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.13.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="sect-1">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<div id="sect-1.1">
<section id="section-1.1">
        <h3 id="name-background">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-background" class="section-name selfRef">Background</a>
        </h3>
<p id="section-1.1-1">When there are too many customer-MACs (C-MACs), 
   the RRs and/or ASBRs will be overloaded by the RT-2 routes for these MACs according to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.
   This issue can be simply solved by making the remote C-MAC entries learnt 
   via data-plane MAC learning (like what PBB VPLS have done since <span>[<a href="#RFC7041" class="xref">RFC7041</a>]</span>) rather than received from RT-2 routes.
   This simplified solution will works as well as PBB VPLS.
   But this simplified solution will lose many important features which is based on the ESI concept. 
   Because the ingress-ESI can't be learnt via data-plane MAC learning at the egress PE.
   So when the data packets is forwarded following these MAC entries, they can't benefit from the EAD/EVI routes as per RFC7432.
   So the All-Active Redundancy mode for ES can't be supported.
   This make the simplified solution can't work as well as PBB EVPN (<span>[<a href="#RFC7623" class="xref">RFC7623</a>]</span>).<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">This document proposes some new extensions to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span> to achieve all-active mode ES redundancy on TPEs 
   and reduce the C-MAC loads for RRs and ASBRs at the same time.
   The new solution will work even more better than PBB EVPN under the help of these extensions, 
   especially when there is no deployment of MPLS dataplane.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Furthermore, it naturally brings the benefits of high scalability,
   faster network convergence, and reduced operational complexity, and we call it light-weighted EVPNs because of these advantages.<a href="#section-1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-1.2">
<section id="section-1.2">
        <h3 id="name-overview">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
        </h3>
<p id="section-1.2-1">In <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, the C-MACs is advertised via RT-2 route.
   This behavior is inheritted by <span>[<a href="#RFC8365" class="xref">RFC8365</a>]</span> and <span>[<a href="#I-D.ietf-bess-srv6-services" class="xref">I-D.ietf-bess-srv6-services</a>]</span>.  
   but in order to solve the C-MAC overload problem for RRs and ASBRs,
   we have to return to a PBB-like dataplane C-MAC learning procedures.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.2-2">We discuss all the requirements for a light-weighted EVPN solution which pushes no C-MAC entries into the backbone network in <a href="#sect-Requirements" class="xref">Section 2</a>.
   Note that some of these requirements is not supported well by PBB EVPN.<a href="#section-1.2-2" class="pilcrow">¶</a></p>
<p id="section-1.2-3">In this document, the light-weighted EVPN solutions are also called as EVPN-lite for short.
   A total of four EVPN-lite solutions are proposed since <span>[<a href="#Revision-01" class="xref">Revision-01</a>]</span>.  
   These solutions are VXLAN over EVPN IP-VRF, light-weighted VXLAN EVPN, light-weighted MPLS EVPN, light-weighted SRv6 EVPN.  
   But this revision focuses its attention on the SRv6 EVPNs and SR-MPLS EVPN.<a href="#section-1.2-3" class="pilcrow">¶</a></p>
<p id="section-1.2-4">In order to compare these five solutions with <span>[<a href="#RFC7348" class="xref">RFC7348</a>]</span> and <span>[<a href="#RFC7623" class="xref">RFC7623</a>]</span> whose C-MAC entries are also not pushed into the backbone network,
   two terms are introduced in this document, because the comparisons need to be done in unified terminology. 
   One term is "Global ESI Indicator (GEI)", which is called as B-MAC in PBB EVPN.
   The other term is "EVI's Global Dicreminator (EGD)", which is called as I-SID in PBB EVPN.<a href="#section-1.2-4" class="pilcrow">¶</a></p>
<p id="section-1.2-5">Note that the EVI here corresponds to the I-Component of <span>[<a href="#RFC7623" class="xref">RFC7623</a>]</span>, not the B-Component. 
   In fact, there will be no typical B-components in some of the above seven solutions.<a href="#section-1.2-5" class="pilcrow">¶</a></p>
<p id="section-1.2-6">Note that the GEI and EGD in different EVPN-lite solutions are very different.
   The details will be described in <a href="#sect-Solutions" class="xref">Section 4</a>.<a href="#section-1.2-6" class="pilcrow">¶</a></p>
<p id="section-1.2-7">On the basis of GEI concept, then we define two route-types for EVPN-lite:
   The first route type is GEI/ES route, which is called as RT-2 route in PBB EVPN.
   The second route type is GEI/EVI route, which is called as EAD/EVI roue in <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.<a href="#section-1.2-7" class="pilcrow">¶</a></p>
<p id="section-1.2-8">The details of these terms are described in <a href="#sect-Terms" class="xref">Section 1.3</a>.<a href="#section-1.2-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-Terms">
<section id="section-1.3">
        <h3 id="name-terminology">
<a href="#section-1.3" class="section-number selfRef">1.3. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.3-1">
   Most of the terminology used in this documents comes from <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>
   and <span>[<a href="#I-D.ietf-bess-srv6-services" class="xref">I-D.ietf-bess-srv6-services</a>]</span> except for the following:<a href="#section-1.3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1.3-2.1">
 Light-weighted EVPN: The EVPN solution with high scalability and reduced operational complexity.<a href="#section-1.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.2">
 EVPN-lite: The Light-weighted EVPN is also called EVPN-lite for short.<a href="#section-1.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.3">
   C-MAC: Customer MAC, it is the same as the C-MAC of PBB EVPN.<a href="#section-1.3-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.4">
   ISID: a broadcast domain identifier in PBB I-Component.<a href="#section-1.3-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.5">
   LDV: Local Discreminating Value. It is similar to the Local Discreminating Value of type 3 ESI.<a href="#section-1.3-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.6">
   GDV: Global Discreminating Value. An identifier with global uniqueness.<a href="#section-1.3-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.7">
   EGD: EVI-GDV, an EVI's Global Discreminator, it is a GDV for an EVI instance.
   A EGD is used to idenfify an EVPN Instance (EVI) in data plane.
   The EGD is a Global Discreminating Value (GDV) of that EVI, so it is also the abbreviation of EVI-GDV.
   e.g. The EGD of <span>[<a href="#RFC7348" class="xref">RFC7348</a>]</span> is a global VNI.<a href="#section-1.3-2.7" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.8">
   ESI Indicator: A Global ID for an ESI. Note that different PE may assign different ESI-indicator for the same ESI, espacially when the ES redundancy mode is single-active.
   e.g. The ESI indicator of <span>[<a href="#RFC7623" class="xref">RFC7623</a>]</span> is B-MAC.<a href="#section-1.3-2.8" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.9">
   GEI: Global ESI Indicator. It is the same as the "ESI Indicator" except for the emphasization to its global uniqueness.
   A GEI is used in data plane to identify an ESI, because it have global uniqueness across the service domain of a corresponding EVPN Instance (EVI). 
   But an ESI may have a few GEIs, each for a TPE, espacially in the single-active mode of ES redundancy.
   And in E-Tree scenarios, an ESI may have two GEIs on the same PE, one for Root ACs, one for Leaf ACs. 
   e.g. The GEIs for an ESI of <span>[<a href="#RFC8317" class="xref">RFC8317</a>]</span> is two B-MACs, one for root ACs, one for Leaf ACs.<a href="#section-1.3-2.9" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.10">
   GEI/ES: The EVPN route which is used to advertise the relation between ESI and its GEI. 
   Note that the GEI/ES route is advertised per ESI basis on a specified PE. In PBB EVPN, the GEI/ES route is the MAC Advertisement Route.
   Note that different solutions may have different GEI/ES routes.
   Note that a GEI/ES don't have to be an EAD/ES route.<a href="#section-1.3-2.10" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.11">
   EAD/EVI: An Ethernet A-D route per EVI.<a href="#section-1.3-2.11" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.12">
   GEI/EVI: The EVPN route which is used to advertise the relation between &lt;ESI/GEI, EVI&gt; and its EVPN label and MPLS nexthops.
   Note that in PBB EVPN, such route is not used. 
   Note that different solutions may have different GEI/EVI routes.
   Note that a GEI/EVI don't have to be an EAD/EVI route.<a href="#section-1.3-2.12" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.13">
   ARG.ACI: The argument part of a SID of the End.DX2AGG function is called as ARG.ACI, because the value of that argument will be a AC-ID.<a href="#section-1.3-2.13" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.14">
   RT-2: MAC/IP Advertise Route.<a href="#section-1.3-2.14" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.15">
   MAC Entry: An entry in the EVPN MAC table in data-plane.<a href="#section-1.3-2.15" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.16">
   ESI SID: An SRv6 SID whose function type is End.DX2AGG. 
   Note that when the ESI is all-active mode, the ESI SID is the same on all PEs of that ES, according to <a href="#sect-SRv6-CP" class="xref">Section 4.1</a>.
   In such case, the ESI SID can be called as ES anycast SID too.<a href="#section-1.3-2.16" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.17">
   ESI IP: An End.DX2AGG SID with its Argument part being set to zero.<a href="#section-1.3-2.17" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.18">
   VXLAN EVPN: EVPN per <span>[<a href="#RFC8365" class="xref">RFC8365</a>]</span>.<a href="#section-1.3-2.18" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.19">
   EVPN VXLAN: A broadcast domain per <span>[<a href="#RFC7348" class="xref">RFC7348</a>]</span>, but use IMET routes of <span>[<a href="#RFC8365" class="xref">RFC8365</a>]</span> to construct VXLAN tunnels.
   Note that an EVPN VXLAN will not use EAD/EVI routes or MAC/IP Advertisement Routes.<a href="#section-1.3-2.19" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.20">
   SPE - Stitching PE, the PEs to do label swapping operation for the EVPN labels. It is similar to the SPE of MS-PWs.<a href="#section-1.3-2.20" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.21">
   TPE - Target PE, the PEs to do EVPN forwarding for the overlay network.<a href="#section-1.3-2.21" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.22">
   PLR - A router at the point of local repair in the underlay network.  In egress node protection,
      it is the penultimate hop router on an anycast tunnel.<a href="#section-1.3-2.22" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.23">
   Anycast ECMP SID - An anycast SID that is load-balanced by the underlay network.<a href="#section-1.3-2.23" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-1.3-2.24">
   Anycast FRR SID - An anycast SID that is fast-rerouted by the underlay network.<a href="#section-1.3-2.24" class="pilcrow">¶</a>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sect-Requirements">
<section id="section-2">
      <h2 id="name-requirements">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements" class="section-name selfRef">Requirements</a>
      </h2>
<p id="section-2-1">EVPN C-MAC Reduction should be provided together with the following requirements:<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="sect-no-CMAC">
<section id="section-2.1">
        <h3 id="name-no-c-mac-awareness-in-the-b">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-no-c-mac-awareness-in-the-b" class="section-name selfRef">No C-MAC Awareness in the Backbone</a>
        </h3>
<p id="section-2.1-1">In typical operation, an EVPN PE sends a BGP MAC Advertisement route
   per C-MAC address.  In certain applications, this poses scalability
   challenges, as is the case in data center interconnect (DCI)
   scenarios where the number of virtual machines (VMs), and hence the
   number of C-MAC addresses, can be in the millions.
   This is called as C-MAC overload of DC Backbone.   In such
   scenarios, it is required to reduce the number of BGP MAC
   Advertisement routes by relying on a 'EVPN-lite' scheme, as
   is provided by ESI and its equivalents (e.g. Pseudo B-MAC, ESI IP).<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-IRB-Support">
<section id="section-2.2">
        <h3 id="name-evpn-irb-support">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-evpn-irb-support" class="section-name selfRef">EVPN IRB Support</a>
        </h3>
<p id="section-2.2-1">The PBB-VPLS/PBB-EVPN is not friendly to IRB usecase because of its complicated Protocol Stack,
   so it is used just in pure L2VPN usecase up to now in the industry.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">The solution should provide efficient forwarding performance in EVPN IRB use cases.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-unify-encap">
<section id="section-2.3">
        <h3 id="name-unified-encapsulation-per-s">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-unified-encapsulation-per-s" class="section-name selfRef">Unified Encapsulation per Scenario</a>
        </h3>
<p id="section-2.3-1">PBB EVPN, especially the MPLS encapsulation of its B-VPLS, is typically not used in DC Scenario.
   So we bring PBB and MPLS encapsulation to DC Backbone just due to the C-MAC overload problem.
   EVPN IRB is widely deplyed in DC scenarios, but PBB EVPN is not friendly for EVPN IRB use cases.
   So we have to use different solutions in EVPN IRB and C-MAC reduction use cases.
   We believe that if we choose VXLAN/Geneve data-plane, we will prefer to use the same data-plane in all use cases, e.g. EVPN IRB, C-MAC reduction.
   So it is necessary to make NVO3/MPLS/SRv6 EVPN to support <a href="#sect-no-CMAC" class="xref">Section 2.1</a> in order to provider a unified solution for data center and other secenarios.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-ESI-retained">
<section id="section-2.4">
        <h3 id="name-esi-features-remain-support">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-esi-features-remain-support" class="section-name selfRef">ESI Features Remain Supported</a>
        </h3>
<p id="section-2.4-1">Two redundancy modes are defined in <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>.
   They are All-Active mode and Single-Active mode.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
<p id="section-2.4-2">In All-active mode, the C-MAC movement among the different adjacent PE nodes of the same ESI should not be considered as C-MAC mobility.
   In Single-Active mode, such movements can be considered as C-MAC mobility.<a href="#section-2.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-flexible-mhd">
<section id="section-2.5">
        <h3 id="name-flexible-multi-homing-remai">
<a href="#section-2.5" class="section-number selfRef">2.5. </a><a href="#name-flexible-multi-homing-remai" class="section-name selfRef">Flexible Multi-homing Remains Supported</a>
        </h3>
<p id="section-2.5-1">Flexible multi-homing means that different ES instances can have different adjacent-PEs.
   We call all the adjacent-PEs of the same ES instances as that ES's location-set in this document.
   Flexible multi-homing means that different ES can have different location-set.<a href="#section-2.5-1" class="pilcrow">¶</a></p>
<p id="section-2.5-2">For example, ES1's location-set is {PE1}, ES2's location-set is {PE2, PE3}, 
   ES3's location-set is {PE1, PE3}, and ES4's location-set is {PE2,PE4}.<a href="#section-2.5-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-learn-confine">
<section id="section-2.6">
        <h3 id="name-c-mac-address-learning-and-">
<a href="#section-2.6" class="section-number selfRef">2.6. </a><a href="#name-c-mac-address-learning-and-" class="section-name selfRef">C-MAC Address Learning and Confinement</a>
        </h3>
<p id="section-2.6-1">In EVPN, all the PE nodes participating in the same EVPN instance are
   exposed to all the C-MAC addresses learnt by any one of these PE
   nodes because a C-MAC learnt by one of the PE nodes is advertised in
   BGP to other PE nodes in that EVPN instance.  This is the case even
   if some of the PE nodes for that EVPN instance are not involved in
   forwarding traffic to, or from, these C-MAC addresses.  Even if an
   implementation does not install hardware forwarding entries for C-MAC
   addresses that are not part of active traffic flows on that PE, the
   device memory is still consumed by keeping record of the C-MAC
   addresses in the routing information base (RIB) table.  In network
   applications with millions of C-MAC addresses, this introduces a non-
   trivial waste of PE resources.  As such, it is required to confine
   the scope of visibility of C-MAC addresses to only those PE nodes
   that are actively involved in forwarding traffic to, or from, these
   addresses.<a href="#section-2.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-no-flush-AA">
<section id="section-2.7">
        <h3 id="name-no-c-mac-flushing-for-all-a">
<a href="#section-2.7" class="section-number selfRef">2.7. </a><a href="#name-no-c-mac-flushing-for-all-a" class="section-name selfRef">No C-MAC Flushing for All-Active ESes</a>
        </h3>
<p id="section-2.7-1">Just as in [RFC7432], it is required to avoid C-MAC address flushing
   upon link, port, or node failure for remote All-Active multihomed segments.<a href="#section-2.7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-independent-flush-SA">
<section id="section-2.8">
        <h3 id="name-independent-c-mac-flushing-">
<a href="#section-2.8" class="section-number selfRef">2.8. </a><a href="#name-independent-c-mac-flushing-" class="section-name selfRef">Independent C-MAC Flushing for Single-Active ESes</a>
        </h3>
<p id="section-2.8-1">Just as in [RFC7432], upon single-active ESI's link or port failure, the C-MACs of other single-active ESes from the same PE
   will not be flushed.<a href="#section-2.8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-ESI_EVI_Cnvg">
<section id="section-2.9">
        <h3 id="name-independent-convergency-per">
<a href="#section-2.9" class="section-number selfRef">2.9. </a><a href="#name-independent-convergency-per" class="section-name selfRef">Independent Convergency per &lt;ESI, EVI&gt;</a>
        </h3>
<p id="section-2.9-1">When the physical port of an All-Active ES works well, but a single Ethernet Tag ID (ETI) of that ES fails, 
   The traffic to that ETI of that ES will be re-routed to other adjacent PE of the same ES,
   but the traffic to other ETIs of the same ES will not be affected.<a href="#section-2.9-1" class="pilcrow">¶</a></p>
<p id="section-2.9-2">Note that when AC (ES link) fails but PE node still works well, there
   should not be steady bypassing traffic either.  The steady bypassing
   problem is discussed in <span>[<a href="#I-D.wang-bess-evpn-egress-protection" class="xref">I-D.wang-bess-evpn-egress-protection</a>]</span>.<a href="#section-2.9-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-Route-AGG">
<section id="section-2.10">
        <h3 id="name-route-aggregation-and-defau">
<a href="#section-2.10" class="section-number selfRef">2.10. </a><a href="#name-route-aggregation-and-defau" class="section-name selfRef">Route Aggregation and Default Route in Backbone</a>
        </h3>
<p id="section-2.10-1">The routes per ESIs can be aggregated in Backbone network.
   Even the default route should be supported when the B-Component is an EVPN IP-VRF (e.g. in VXLAN over IP-VRF solutions).<a href="#section-2.10-1" class="pilcrow">¶</a></p>
<p id="section-2.10-2">In SRv6 EVPN, different sub-interfaces of the same ESI can have different ESI-indicators in order to achieve <a href="#sect-ESI_EVI_Cnvg" class="xref">Independent Convergency per &lt;ESI, EVI&gt;</a>.
   But only the common prefix of them should be advertised (both in underlay network and in overlay network) before any of the sub-interfaces fails.<a href="#section-2.10-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-ARP-Suppression">
<section id="section-2.11">
        <h3 id="name-arp-suppression">
<a href="#section-2.11" class="section-number selfRef">2.11. </a><a href="#name-arp-suppression" class="section-name selfRef">ARP Suppression</a>
        </h3>
<p id="section-2.11-1">The ARP suppression requires &lt;IP,MAC&gt; entries to be steadily held on all TPEs, 
   So it conflicts with <a href="#sect-learn-confine" class="xref">Section 2.6</a>.
   But if the C-MAC confinement requirements is not so important in some scenarios,
   The ARP Suppression can be activated. This is an option.<a href="#section-2.11-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-GEI-Agg">
<section id="section-2.12">
        <h3 id="name-esi-indicator-aggregation">
<a href="#section-2.12" class="section-number selfRef">2.12. </a><a href="#name-esi-indicator-aggregation" class="section-name selfRef">ESI Indicator Aggregation</a>
        </h3>
<p id="section-2.12-1">There are obvious difference between "ESI Route Aggregation" and "ESI Indicator Aggregation". 
   The "ESI Route Aggregation" is that some ESI Indicators are advertised by underlay protocols in a aggregatated manner,
   but different ESIs still have different ESI-Indicators.
   The "ESI Indicator Aggregation" is that different ESIs use the same ESI-Indicator.<a href="#section-2.12-1" class="pilcrow">¶</a></p>
<p id="section-2.12-2">Note that the "ESI Route Aggregation" is recommanded as long as it is possible, 
   but the "ESI Indicator Aggregation" can only be used under certain restraints.<a href="#section-2.12-2" class="pilcrow">¶</a></p>
<p id="section-2.12-3">When two ESes are attached to the same redundancy group of PEs, they can share the same ESI indicator.
   But this will bring out some issues too.
   One of these issues is that they may be attached to different groups of PEs in the future.
   Another issue is that when only one of the ESes fails, the ESI indicator can't be withdrawn by that PE,
   so the steady bypass of that ES arises immediately after its failture on that PE. 
   If these issues are not so important in some scenarios,
   The ESI-Indicator Aggregation may be activated. This is an option.<a href="#section-2.12-3" class="pilcrow">¶</a></p>
<p id="section-2.12-4">Note that when ESI Indicator Aggregation is activated, the local-bias ES split-horizon procedures or its variations (like what <span>[<a href="#I-D.eastlake-bess-evpn-vxlan-bypass-vtep" class="xref">I-D.eastlake-bess-evpn-vxlan-bypass-vtep</a>]</span> does) should be used.<a href="#section-2.12-4" class="pilcrow">¶</a></p>
<p id="section-2.12-5">Note that ESI Indicator Aggregation works well with single-active ESIs (see <a href="#sect-srv6-proc" class="xref">Section 4.2</a>), its steadby bypassing problem will arise with all-active ESIs only.<a href="#section-2.12-5" class="pilcrow">¶</a></p>
<p id="section-2.12-6">Note that the sub-interfaces of an ESI may be assigned with different ESI-indicators, and these ESI-indicators can be aggregated into a common prefix,
   this common prefix is assigned with the ESI. In such case, only the common prefix should be advertised before any of the sub-interfaces fails.
   But this is not considered as "ESI Indicator Aggregation", this is "ESI Route Aggregation".<a href="#section-2.12-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-uneq-LB">
<section id="section-2.13">
        <h3 id="name-unequal-load-balance">
<a href="#section-2.13" class="section-number selfRef">2.13. </a><a href="#name-unequal-load-balance" class="section-name selfRef">Unequal load-balance</a>
        </h3>
<p id="section-2.13-1">The light-weighted EVPNs should support the unequal load-balance defined in <span>[<a href="#I-D.ietf-bess-evpn-unequal-lb" class="xref">I-D.ietf-bess-evpn-unequal-lb</a>]</span>.<a href="#section-2.13-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-AC-aware">
<section id="section-2.14">
        <h3 id="name-ac-aware-service-interface">
<a href="#section-2.14" class="section-number selfRef">2.14. </a><a href="#name-ac-aware-service-interface" class="section-name selfRef">AC-aware Service Interface</a>
        </h3>
<p id="section-2.14-1">In AC-aware bundling service interface, the ESes may make its two VLANs to be attached to the same broadcast domain.
   These two VLANs may be assigned to the same sub-interface, or to different sub-interfaces.<a href="#section-2.14-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-CR-agnostic">
<section id="section-2.15">
        <h3 id="name-esi-agnostical-core-routers">
<a href="#section-2.15" class="section-number selfRef">2.15. </a><a href="#name-esi-agnostical-core-routers" class="section-name selfRef">ESI-agnostical Core-Routers</a>
        </h3>
<p id="section-2.15-1">We should not make the core-routers aware of any per-EVI routing information of an ESI.
   Because they are just underlay nodes.<a href="#section-2.15-1" class="pilcrow">¶</a></p>
<p id="section-2.15-2">The core-routers may not aware of any per-ES routing infomation of the ESIes too.
   In such case, the anycast ESI SID should be hiden into the SRH, and it is the inner SID for the Node SID of the egress PE.<a href="#section-2.15-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-Common-Req">
<section id="section-3">
      <h2 id="name-light-weighted-evpn-overvie">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-light-weighted-evpn-overvie" class="section-name selfRef">Light-Weighted EVPN Overview</a>
      </h2>
<div id="sect-use-case">
<section id="section-3.1">
        <h3 id="name-use-case">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-use-case" class="section-name selfRef">Use Case</a>
        </h3>
<p id="section-3.1-1">
   We assign a Global Discreminator EGD1 to an EVI instance EVI1, the EGD1 is a number consists of N bits. 
   We assign an ESI-indicator GEI1 to ESI1 on PE1, and we assign an ESI-indicator GEI2 to ESI1 on PE2.
   We call the relationship between ESI1 and its two ESI-indicators as ESI1_GEI1 and ESI1_GEI2 respectively.
   The EGD and GEIs MUST have global uniqueness in EVI1's service domain.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<span id="name-evpn-mac-reduction-usecase"></span><div id="mac-reduction-case">
<figure id="figure-1">
          <div class="artwork art-text alignCenter" id="section-3.1-2.1">
<pre>
                                 +----------+
                   PE1           |          |
              +-------------+    |          |
              | ESI1_GEI1   |    |          |         PE3
             /|             |----|          |   +-------------+
            / |             |    | IP/MPLS  |   |             |
       LAG /  +-------------+    | Backbone |   |   ESI2_GEI3 |---CE2
   CE1=====                      |   with   |   |             |
           \  +-------------+    |   EVPN   |---|             |
            \ |             |    |   RRs    |   +-------------+
             \|             |----|   and    |
              | ESI1_GEI2   |    |   SPEs   |
              +-------------+    |          |
                   PE2           |          |
                                 +----------+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-evpn-mac-reduction-usecase" class="selfRef">EVPN MAC Reduction Usecase</a>
          </figcaption></figure>
</div>
<p id="section-3.1-3">
   We use IMET routes to build a broadcast-list. The broadcast-list is used to forward BUM traffics.
   The data-plane MAC learning for BUM traffics produces the first batch of C-MAC entries.
   The subsequent C-MAC entries can be learnt from Unicast traffics and/or BUM traffics.
   It is clear that we don't use MAC/IP routes to advertise C-MAC entries as usual, that is for fear that the RRs and/or SPEs are overloaded by these C-MACs.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-same-proc">
<section id="section-3.2">
        <h3 id="name-packet-walkthrough">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-packet-walkthrough" class="section-name selfRef">Packet Walkthrough</a>
        </h3>
<span class="break"></span><dl class="olPercent" id="section-3.2-1">
<dt>#1</dt>
<dd id="section-3.2-1.1" style="margin-left: 1.5em">
<div id="Proc-ARP-Request">[PE1 forward ARP Request to PE2/PE3]<a href="#Proc-ARP-Request" class="pilcrow">¶</a>
</div>
        </dd>
<dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.2-2.1">
            <p id="section-3.2-2.1.1">
   When CE1 requests CE2's ARP, PE1 will receive the ARP Request BUM1 from a AC (say AC1) of ESI1.
   PE1 will forward the ARP Request following the broadcast-list of AC1's EVI instance(say EVI1).
   The broadcast-list is constructed by IMET routes from PE2/PE3.<a href="#section-3.2-2.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2-2.1.2">
   PE1 will forward the ARP Request to PE2/PE3. The ARP Request is encapsulated with GEI1 and EVI1_GDV1.
   The inner SMAC of the ARP request is M1 which is CE1's MAC address.<a href="#section-3.2-2.1.2" class="pilcrow">¶</a></p>
</li>
        </ul>
<span class="break"></span><dl class="olPercent" id="section-3.2-3">
<dt>#2</dt>
<dd id="section-3.2-3.1">
<div id="Proc-MAC-Learn">[PE2/PE3's Dataplane MAC Learning]<a href="#Proc-MAC-Learn" class="pilcrow">¶</a>
</div>
        </dd>
<dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.2-4.1">
            <p id="section-3.2-4.1.1">
   When PE2/PE3 receives the ARP Request packet BUM1, they do dataplane MAC learning independently.
   They will learn that M1 is behind GEI1.<a href="#section-3.2-4.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2-4.1.2">
   Note that when PE2 learns that M1 is behind GEI1, it will assume that M1 is behind the local AC whose ESI-indicator is GEI1 too.
   The local AC may have more higher priority than the remote one.<a href="#section-3.2-4.1.2" class="pilcrow">¶</a></p>
<p id="section-3.2-4.1.3">
   After the dataplane MAC learning, the ARP request packet BUM1 is broadcasted to the local ACs, behind one of which is CE2.<a href="#section-3.2-4.1.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<span class="break"></span><dl class="olPercent" id="section-3.2-5">
<dt>#3</dt>
<dd id="section-3.2-5.1">
<div id="Proc-Discard-ARP-Req">[PE2 Discard ARP Request to CE1]<a href="#Proc-Discard-ARP-Req" class="pilcrow">¶</a>
</div>
        </dd>
<dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.2-6.1">
            <p id="section-3.2-6.1.1">
   On receiving BUM1 from PE1, PE2 use the ingress GEI information in BUM1 to determine its ingress ESI ESI1,
   When ESI1 is all-active mode and PE2 is about to forward the ARP request to CE1,
   PE2 will find that the ESI for the outgoing AC is also ESI1, so PE2 discards it for ESI loop-free considerations.<a href="#section-3.2-6.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2-6.1.2">Note that before that ARP Request packet is discarded, its source-MAC can be learnt, especially in "AC-aware bundling service interface".
   The MAC entry is learnt against the GEI, but it will consider the local sub-interface on that ES as its outgoing interface,
   in order to avoid unknown-unicast flooding.<a href="#section-3.2-6.1.2" class="pilcrow">¶</a></p>
<p id="section-3.2-6.1.3">Note that in "AC-aware bundling service interface", the AC-ID along with that GEI can help the MAC entry to be installed for the correct outgoing interface. 
   Such MAC entry is called as the synced MAC entry.<a href="#section-3.2-6.1.3" class="pilcrow">¶</a></p>
<p id="section-3.2-6.1.4">
   When ESI1 is single-active mode, the outgoing AC may be in blocking state, otherwise its corresponding sub-interface on CE1 will take charge of packet-drop behavior instead.
   So alghough the ESI for the outgoing AC is not the same as ESI1, no loop will arise in the Ethernet Segment.<a href="#section-3.2-6.1.4" class="pilcrow">¶</a></p>
</li>
        </ul>
<span class="break"></span><dl class="olPercent" id="section-3.2-7">
<dt>#4</dt>
<dd id="section-3.2-7.1">
<div id="Proc-ARP-Replay-to-PEs">[PE3 Forward ARP Replay to PE1/PE2]<a href="#Proc-ARP-Replay-to-PEs" class="pilcrow">¶</a>
</div>
        </dd>
<dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.2-8.1">
            <p id="section-3.2-8.1.1">
   When CE2 replies to CE1 for the ARP request, 
   PE3 will forward the ARP reply U1 according to the MAC entry M1 learnt previously as above.<a href="#section-3.2-8.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2-8.1.2">
   PE3 will forward the ARP reply U1 to PE1 or PE2 according to ESI1's RT-1 per EVI routes and RT-1 per ES routes:<a href="#section-3.2-8.1.2" class="pilcrow">¶</a></p>
<p id="section-3.2-8.1.3">
   When ESI1 is all-active mode, GEI1 may be the same as GEI2, in such case, we call both of them GEI21 instead. 
   The traffics to M1 will be load-balanced between PE1 and PE2.
   Because that GEI21 is advertised by both PE1 and PE2l.<a href="#section-3.2-8.1.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<span class="break"></span><dl class="olPercent" id="section-3.2-9">
<dt>#5</dt>
<dd id="section-3.2-9.1">
<div id="Proc-ARP-Replay-to-CE1">[PE1 Forward ARP Replay to CE1]<a href="#Proc-ARP-Replay-to-CE1" class="pilcrow">¶</a>
</div>
        </dd>
<dd class="break"></dd>
</dl>
<ul class="normal">
<li class="normal" id="section-3.2-10.1">
            <p id="section-3.2-10.1.1">
   Whe PE1 received the ARP reply packet U1 from PE3, 
   PE1 first match the packet to the its EVI instance EVI1 by U1's EGD information.
   And PE1 will not discard it because the egress ESI is not the same as the ingress ESI which is determined by U1's GEI information.<a href="#section-3.2-10.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="sect-Solutions">
<section id="section-4">
      <h2 id="name-light-weighted-srv6-evpn">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-light-weighted-srv6-evpn" class="section-name selfRef">Light-Weighted SRv6 EVPN</a>
      </h2>
<div id="sect-SRv6-CP">
<section id="section-4.1">
        <h3 id="name-srv6-solution-overview">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-srv6-solution-overview" class="section-name selfRef">SRv6 Solution Overview</a>
        </h3>
<div id="sect-End.DX2AGG">
<section id="section-4.1.1">
          <h4 id="name-aggregatable-enddx2-sid-and">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-aggregatable-enddx2-sid-and" class="section-name selfRef">Aggregatable End.DX2 SID and End.DX2AGG SID</a>
          </h4>
<p id="section-4.1.1-1">When an Ethernet Segment ES1 is attached to an EVI, the attachment-circuit AC1 for that &lt;ESI,EVI&gt; is assigned with an End.DX2 SID.
   Different ACs of the same ESI are assigned with different End.DX2 SIDs, we call them AC SIDs in this document. 
   But these different End.DX2 SIDs must be able to be aggregated into the same prefix, and this prefix are called as ESI Indicator in light-weighted SRv6 EVPNs.
   The format of aggregatable End.DX2 SIDs is illustrated in the following figure:<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<span id="name-enddx2-sid-formart-for-aggr"></span><div id="AC-sid">
<figure id="figure-2">
            <div class="artwork art-text alignCenter" id="section-4.1.1-2.1">
<pre>

    |&lt;---  ESI-Indicator(128-N bits) ----&gt;|&lt;----     N bits     ---&gt;|
    +------------+------------+-----------+-------------------------+
    |    Block   |   Node     | ESI.LDV   |          AC-ID          |
    +------------+------------+-----------+-------------------------+
    |&lt;------ Locator --------&gt;|&lt;------------- Function ------------&gt;|

</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-enddx2-sid-formart-for-aggr" class="selfRef">End.DX2 SID Formart for Aggregation</a>
            </figcaption></figure>
</div>
<p id="section-4.1.1-3">Note that the ESI.LDV field is the Local Discreminator Value (LDV) of the ESI (especially the type 3/4/5 ESI).
   The AC-ID field is the  of the EVI of that End.DX2 SID.
   The ESI.LDV field and the EGD field are integrated into the End.DX2 SID's Function part.<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
<p id="section-4.1.1-4">Note that in "AC-aware bundling service interface" the AC-ID field MUST be the same as the Attachment Circuit ID of <span>[<a href="#I-D.sajassi-bess-evpn-ac-aware-bundling" class="xref">I-D.sajassi-bess-evpn-ac-aware-bundling</a>]</span>.
   But in other service interfaces the AC-ID field can also be the EGD of that AC's EVPN instance.
   Note that the EGD has a global meaning like a global VNI or an PBB I-SID, 
   while the AC-ID part for an ordinary aggregatable End.DX2 SID typically is only a VLAN-ID on that ES.<a href="#section-4.1.1-4" class="pilcrow">¶</a></p>
<p id="section-4.1.1-5">But we can consider the prefix aggregated from these End.DX2 SIDs as a new SRv6 function called End.DX2AGG SID,
   The format of the End.DX2AGG SID is illustrated in the following figure:<a href="#section-4.1.1-5" class="pilcrow">¶</a></p>
<span id="name-enddx2agg-sid-format"></span><div id="esi-sid">
<figure id="figure-3">
            <div class="artwork art-text alignCenter" id="section-4.1.1-6.1">
<pre>

    |&lt;------ Locator --------&gt;|&lt;- FUNC --&gt;|&lt;------ ARG.ACI --------&gt;|
    +------------+------------+-----------+-------------------------+
    |    Block   |   Node     | ESI.LDV   |         AC-ID           |
    +------------+------------+-----------+-------------------------+

</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-enddx2agg-sid-format" class="selfRef">End.DX2AGG SID Format</a>
            </figcaption></figure>
</div>
<p id="section-4.1.1-7">Note that whether these SIDs are considered as lots of End.DX2 SIDs or are considered as a single End.DX2AGG SID with different arguments,
   it is just a local matter of their PE node's independent choice, other PEs of the same EVI won't be aware of the difference of these two implementations.<a href="#section-4.1.1-7" class="pilcrow">¶</a></p>
<p id="section-4.1.1-8">
   A SID with the End.DX2AGG function is called as an "ESI SID" in this document.
   The ESI's GEI is the locator and fuction part of its corresponding ESI SID.
   The argument part of the ESI SID is the AC-ID for the corresponding AC.
   The AC-ID plus the ESI.LDV works like the function part of an End.DX2 SID.
   The argument part of an ESI SID is called as ARG.ACI in this document, where the AC is the abbreviation of AC-ID.<a href="#section-4.1.1-8" class="pilcrow">¶</a></p>
<p id="section-4.1.1-9">
   Note that an SRv6 ESI-indicator is an 128 bits ESI SID with a zero argument, it is also called as ESI-IP.
   An ESI-SID may have a non-zero argument part, but the ESI-IPs always have zero argument part.<a href="#section-4.1.1-9" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-ESI-IP-Adv">
<section id="section-4.1.2">
          <h4 id="name-the-advertisement-of-esi-ip">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-the-advertisement-of-esi-ip" class="section-name selfRef">The Advertisement of ESI-IPs</a>
          </h4>
<p id="section-4.1.2-1">
   The SRv6 SID in IMET route is an End.DT2M SID with a zero argument length. 
   The GEI1 and GEI2 are ESI-IPs of End.DX2AGG SID that is defined in <a href="#esi-sid" class="xref">Figure 3</a>.
   We can use IGP protocols to advertise GEI1 and GEI2 to PE3 respectively in SRv6 underlay.
   So we don't have to use EAD/ES route or EAD/EVI route in SRv6 EVPN in this section.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">Note that if ESI1 is single-active mode, GEI1 is different from GEI2, but if ESI1 is all-active mode, GEI1 is the same as GEI2.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">Note that when PE1 node fails and the ESI is all active, the PLR node will do underlay anycast FRR switching for GEI1(=GEI2).
   This will bring out fast network convergency.<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
<p id="section-4.1.2-4">Note that when the PE-CE link of GEI1 fails, the IGP route of GEI1 will be withdrawn, 
   So there will be no steady bypassing for that ES, but a temporary bypassing can be performed to further improve the convergency.<a href="#section-4.1.2-4" class="pilcrow">¶</a></p>
<p id="section-4.1.2-5">The detailed comparisons between light-weighted SRv6 EVPN and PBB EVPN over SRv6 is described in <a href="#sect-comparisons" class="xref">Section 7</a>.<a href="#section-4.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-srv6-proc">
<section id="section-4.2">
        <h3 id="name-srv6-specific-evpn-lite-pro">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-srv6-specific-evpn-lite-pro" class="section-name selfRef">SRv6-specific EVPN-lite Procedures</a>
        </h3>
<span class="break"></span><dl class="olPercent" id="section-4.2-1">   
   <dt>[6A]</dt>
<dd id="section-4.2-1.1">
            <p id="section-4.2-1.1.1">In Step <a href="#Proc-ARP-Request" class="xref">#1</a>, PE1 will forward the ARP Request to PE2/PE3 with the following SRv6 BE encapsulation:
   It's underlay Source IP is the End.DX2AGG SID on PE1 for ESI1; It's underlay Destination IP is the End.DT2M SID on PE2/PE3.    
   The locator and function part of the End.DX2AGG SID is GEI1. The Argument part of the End.DX2AGG SID is 0.<a href="#section-4.2-1.1.1" class="pilcrow">¶</a></p>
<p id="section-4.2-1.1.2">Note that the underlay SIP will be the End.DT2U SID (because they don't need an ESI SID) for the single-homed ingress ACs. 
   The multi-homed ingress ACs with single-active behavior may not be assigned with an dedicated ESI-indicator either.
   In such situations, the underlay SIP can be the End.DT2U SID too. Note that in such situations, 
   the ESI indicator of all single-active ESIs for the same EVI are aggregated into the same IPv6 address.<a href="#section-4.2-1.1.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>[6B]</dt>
<dd id="section-4.2-1.2">
            <p id="section-4.2-1.2.1">In Step <a href="#Proc-Discard-ARP-Req" class="xref">#3</a>, 
   PE2 can compare the ingress-GEI of BUM1 and the GEI of outgoing AC directly, no GEI-to-ESI lookup needed.<a href="#section-4.2-1.2.1" class="pilcrow">¶</a></p>
<p id="section-4.2-1.2.2">Note that PE2 can decapsulate the packet following the End.DX2 function or following the End.DX2AGG function.
   It is just a local matter.<a href="#section-4.2-1.2.2" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>[6C]</dt>
<dd id="section-4.2-1.3">
            <p id="section-4.2-1.3.1">In Step <a href="#Proc-ARP-Replay-to-PEs" class="xref">#4</a>, PE3 will forward the ARP reply to PE1 with the following SRv6 BE encapsulation:
   It's underlay Source IP is the End.DX2AGG SID on PE3 for ESI2; It's underlay Destination IP is the End.DX2AGG SID on PE1 for ESI1 according to the MAC entry M1. 
   The ARG.ACI for the End.DX2AGG SID in DIP is the EGD configured on PE3. Note that the EGD for the same EVI is configured with the same value on PE1/PE2/PE3.<a href="#section-4.2-1.3.1" class="pilcrow">¶</a></p>
<p id="section-4.2-1.3.2">When ESI1 is all-active mode, GEI1 will be the same as GEI2, so we call both of them GEI21 instead. 
   The traffics to M1 will be load-balanced between PE1 and PE2 by the underlay network on PE3.
   Because GEI21 is advertised by both PE1 and PE2 in the underlay IGP protocol.<a href="#section-4.2-1.3.2" class="pilcrow">¶</a></p>
<p id="section-4.2-1.3.3">Note that if the DIP is the anycast node SID of PE1 and PE2, when the PE-CE link of ESI1 fails, 
   the traffic will be steadily bypassed untill that link recovers again.<a href="#section-4.2-1.3.3" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>[6D]</dt>
<dd id="section-4.2-1.4">
            <p id="section-4.2-1.4.1">In Step <a href="#Proc-ARP-Replay-to-CE1" class="xref">#5</a>, Whe PE1 received the SRv6 encapsulated ARP reply packet from PE3, 
   PE1 first match the packet to the End.DX2AGG SID of ESI1 by DIP, then match the packet to the EVI instance EVI1 by ARG.ACI.<a href="#section-4.2-1.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
<div id="sect-srv6-esi-func">
<section id="section-4.2.1">
          <h4 id="name-enddx2agg-function-and-arga">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-enddx2agg-function-and-arga" class="section-name selfRef">End.DX2AGG Function and Arg.ACI</a>
          </h4>
<p id="section-4.2.1-1">The "Endpoint with decapsulation and ESI-specific L2 table forwarding"
   behavior (End.DX2AGG for short) is a variant of the End.DX2 behavior.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">Two of the applications of the End.DX2AGG behavior are the EVPN VPLS [RFC7432]
   and the EVPN ETREE [RFC8317]use-cases.<a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-3">Any SID instance of this behavior is associated with an ESI E.
   The behavior also takes an argument: "Arg.ACI".  This argument
   provides a local mapping to an outgoing interface OIF,.
   The OIF corresponds to &lt;ESI E, EVI V&gt;, and the EVI V's bridge table is L2 Table T .<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">The End.DX2AGG SID MUST be the last segment in a SR Policy.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-5">
   When N receives a packet whose IPv6 DA is S and S is a local End.DX2AGG
   SID, the processing is identical to the End.DX2 behavior except for
   the Upper-layer header processing which is as follows:<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-4.2.1-6">
<pre>
   S01. If (Upper-Layer Header type == 143(Ethernet) ) {
   S02.    Remove the outer IPv6 Header with all its extension headers.
   S03.    Learn the exposed MAC Source Address in L2 Table T.
   S04.    Find out the OIF, and forward the Ethernet frame to the OIF.
   S05. } Else {
   S06.    Process as per Section 4.1.1
               of [I-D.ietf-spring-srv6-network-programming].
   S07. }
</pre><a href="#section-4.2.1-6" class="pilcrow">¶</a>
</div>
<p id="section-4.2.1-7">Note that the EVI V is determined by the End.DX2AGG SID's ESI-IP and ARG.ACI argument.<a href="#section-4.2.1-7" class="pilcrow">¶</a></p>
<p id="section-4.2.1-8">Note that the MAC learning should not be applied unless the EVI V is an E-LAN service.<a href="#section-4.2.1-8" class="pilcrow">¶</a></p>
<p id="section-4.2.1-9">Note that the OIF may be found out using the MAC-entries in L2 Table T, when the EVI V is an E-LAN service and the AC-aware bundling service interface is used.<a href="#section-4.2.1-9" class="pilcrow">¶</a></p>
<p id="section-4.2.1-10">Note that we can use the ARG.ACI to find out the the OIF on that ES, then the EVI V will be found out.<a href="#section-4.2.1-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="sect-other-consider">
<section id="section-5">
      <h2 id="name-advanced-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-advanced-considerations" class="section-name selfRef">Advanced Considerations</a>
      </h2>
<div id="sect-GEI-Adv-Optm">
<section id="section-5.1">
        <h3 id="name-esi-indicator-advertisement">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-esi-indicator-advertisement" class="section-name selfRef">ESI Indicator Advertisement Optimization</a>
        </h3>
<div id="sect-Underlay-Adv">
<section id="section-5.1.1">
          <h4 id="name-advertise-esi-sids-in-under">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-advertise-esi-sids-in-under" class="section-name selfRef">Advertise ESI SIDs in Underlay Network</a>
          </h4>
<p id="section-5.1.1-1">
   The End.DX2AGG SIDs can be advertised as an IP prefix in underlay IGP protocols.
   Although it is the aggregation of many AC SIDs, the ESI SIDs may still be too many for the underlay network.
   And the core routers who are service-agnostic have to install these prefixes.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
<p id="section-5.1.1-2">In order to solve these problems, the ESI SIDs can be advertised via EVPN routes in the overlay network.<a href="#section-5.1.1-2" class="pilcrow">¶</a></p>
<p id="section-5.1.1-3">Note that when the URPF (Unicast Reverse Path Forwarding) is enabled and the ESI SIDs are encapsulated as Source IPs,
   The ESI SIDs should be advertised in underlay network, even if the ESI SIDs won't be encapsulated as destination IPs.
   Otherwise the source ESI SID should be hiden into the SRH too.<a href="#section-5.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-Overlay-Adv">
<section id="section-5.1.2">
          <h4 id="name-advertise-esi-sids-for-over">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-advertise-esi-sids-for-over" class="section-name selfRef">Advertise ESI SIDs for Overlay Network</a>
          </h4>
<p id="section-5.1.2-1">
   When we use EVPN routes to advertise ESI SIDs among the PEs for the overlay network,
   These routes will not be imported by the core routers.
   In such case, when the ESI SIDs are used as destination IP addresses, they should be hiden behind the node SID of the corresponding egress PE router.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
<p id="section-5.1.2-2">Note that the association between an ESI SID and its corresponding Node SID is also advertised by such EVPN routes.<a href="#section-5.1.2-2" class="pilcrow">¶</a></p>
<p id="section-5.1.2-3">
   We can use EAD/ES route (or EAD/EVI route) to advertise Global ESI Indicator (GEI) (and EGD), these EAD routes is called as GEI/ES or GEI/EVI route in this document.
   When the GEI/EVI route is used to advertise GEI, the End.DX2AGG SID is advertised in its SRv6 L2 Service TLV, not in its nexthop.
   The EGD may be carried in the ARG.ACI field of the End.DX2AGG SID, or it can also be determined from its EVI-RTs.<a href="#section-5.1.2-3" class="pilcrow">¶</a></p>
<p id="section-5.1.2-4">
   Either GEI/EVI routes (or GEI/ES) routes will be advertised/imported for Global Routing Table (GRT), so their Route-Targets (RT) will be configured with GRT.
   Because there isn't a dedicated B-component like PBB VPLS and PBB EVPN.
   Note that the GEI/EVI routes can be installed as /128 routes and the ARG.ACI part can be set to the actual EGD of the corresponding EVI.
   In such case, when a C-MAC is learnt over an End.DX2AGG SID (as IPv6 SA) in the data-plane, the ARG.ACI field of that SID should be set to the EVI's EGD when the C-MAC entry is installed.<a href="#section-5.1.2-4" class="pilcrow">¶</a></p>
<p id="section-5.1.2-5">
   Although GEIs is imported to GRT, they are awared only on PE nodes, the transit nodes in underlay network won't be aware of GEIs (they can aware the common prefix of these GEIs) in order to reduce the FIB consumption.
   We can use the argument length in the SRv6 SID Structure Sub-Sub-TLV to check whether the EGD is too big for the End.DX2AGG SID, 
   So we can avoid the destruction to the function part of the End.DX2AGG and we can use flexible EGD length.<a href="#section-5.1.2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-AC-SID-Adv">
<section id="section-5.1.3">
          <h4 id="name-advertise-ac-sids-for-overl">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-advertise-ac-sids-for-overl" class="section-name selfRef">Advertise AC SIDs for Overlay Network</a>
          </h4>
<p id="section-5.1.3-1">
   In order to solve the problem described in <a href="#sect-ESI_EVI_Cnvg" class="xref">Section 2.9</a>,
   we may have to advertise AC SIDs.
   But the amount of AC SIDs may be hundreds of times larger than ESI SIDs.
   It is necessary for the light-weighted SRv6 EVPNs to reduce the advertisement of AC SIDs.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
<p id="section-5.1.3-2">The AC SID of a specified &lt;ESI,EVI&gt; will not be advertised by its PEs, until these PEs know that the &lt;ESI,EVI&gt; fails on at least one of them.<a href="#section-5.1.3-2" class="pilcrow">¶</a></p>
<p id="section-5.1.3-3">Note that the AC SID for that &lt;ESI,EVI&gt; can be used as the source IP of the SRv6 encapsulation before that AC SID is advertised via EVPN routes.
   Because that when a MAC is learnt over that AC SID, the packet for that MAC can also be forwarded according to the IP Prefix of the corresponding ESI SID due to the longest match procedures of IP lookup.<a href="#section-5.1.3-3" class="pilcrow">¶</a></p>
<p id="section-5.1.3-4">The detailed AC-SID advertisement will be added in the future versions.<a href="#section-5.1.3-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-UELB-Adv">
<section id="section-5.2">
        <h3 id="name-unequal-lb-advertisement">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-unequal-lb-advertisement" class="section-name selfRef">Unequal LB Advertisement</a>
        </h3>
<p id="section-5.2-1">
   When the ESI SIDs are advertised by EVPN routes for the overlay network according to <a href="#sect-Overlay-Adv" class="xref">Section 5.1.2</a>, 
   we can advertise the EVPN Link Bandwidth extended community (see <span>[<a href="#I-D.ietf-bess-evpn-unequal-lb" class="xref">I-D.ietf-bess-evpn-unequal-lb</a>]</span>) or something else along with the ESI SIDs using such EVPN routes.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">Note that these extra information (which are advertised along with the EVPN routes) are awared by the PEs only.
   The underlay network don't have to be aware of it.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">Note that when the EVPN Link Bandwidth extended community is advertised along with the ESI SID,
   The nexthop of the GEI/ES route should not be set to the anycast ECMP Node SID of the advertising PE (egress-PE).
   On receiving such GEI/ES route, the ingress PE may push this GEI/ES route's nexthop onto the End.DX2AGG/End.DX2 SID when constructing the SID stack, if unequal-LB is required.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-Egress-Protect">
<section id="section-5.3">
        <h3 id="name-evpn-egress-protection">
<a href="#section-5.3" class="section-number selfRef">5.3. </a><a href="#name-evpn-egress-protection" class="section-name selfRef">EVPN Egress Protection</a>
        </h3>
<div id="sect-EENP">
<section id="section-5.3.1">
          <h4 id="name-evpn-egress-node-protection">
<a href="#section-5.3.1" class="section-number selfRef">5.3.1. </a><a href="#name-evpn-egress-node-protection" class="section-name selfRef">EVPN Egress Node Protection</a>
          </h4>
<p id="section-5.3.1-1">There are two methods to achieve EVPN egress node protection:<a href="#section-5.3.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-5.3.1-2.1">
              <p id="section-5.3.1-2.1.1">The first method: Both the ESI SID and the AC SID are anycast SID, and they are hiden behind the corresponding egress Node SID according to <a href="#sect-Overlay-Adv" class="xref">Section 5.1.2</a>.
   So when the egress node fails, the PLR can do "midpoint protection" for that node SID, 
   as a result of that, the destination IP will be rewritten to the ESI SID behind that node SID.<a href="#section-5.3.1-2.1.1" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2.1.2">Note that the ESI SID is an anycast SID, so it will be re-routed by the underlay network after that failure.<a href="#section-5.3.1-2.1.2" class="pilcrow">¶</a></p>
<p id="section-5.3.1-2.1.3">Note that this method requires no special extensions. So it will be suitable for more SRv6 devices than mirror SID.<a href="#section-5.3.1-2.1.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-5.3.1-2.2">
              <p id="section-5.3.1-2.2.1">The second method: the egress protection procedures per <span>[<a href="#I-D.wang-bess-evpn-egress-protection" class="xref">I-D.wang-bess-evpn-egress-protection</a>]</span> (which uses an anycast FRR Node SID to achieve underlay anycast FRR protection)
   can be applied to the GEI/ES route's nexthop, in order to apply underlay anycast FRR protection.<a href="#section-5.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-5.3.1-3">Note that the PLR don't have unequal load-balance information,
   So neither of these two methods will meet the unequal load-balance requirements after that failure.
   But it will be the best result unless the unequal load-balance information can be advertised via IGP.<a href="#section-5.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-EELP">
<section id="section-5.3.2">
          <h4 id="name-evpn-egress-link-protection">
<a href="#section-5.3.2" class="section-number selfRef">5.3.2. </a><a href="#name-evpn-egress-link-protection" class="section-name selfRef">EVPN Egress Link Protection</a>
          </h4>
<p id="section-5.3.2-1">The details will be added in the future versions, but the procedures about the synced MAC entry of [<a href="#Proc-Discard-ARP-Req" class="xref">Section 3.2, Paragraph 5, Item 1</a>] will be helpful.<a href="#section-5.3.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-5">
<section id="section-5.4">
        <h3 id="name-c-mac-flush-notification-pr">
<a href="#section-5.4" class="section-number selfRef">5.4. </a><a href="#name-c-mac-flush-notification-pr" class="section-name selfRef">C-MAC Flush Notification Procedure</a>
        </h3>
<p id="section-5.4-1">
   The withdraw of GEI Advertisement can be used as C-MAC flush notification 
   like what have been done by <span>[<a href="#RFC8317" class="xref">RFC8317</a>]</span> and <span>[<a href="#I-D.ietf-bess-pbb-evpn-isid-cmacflush" class="xref">I-D.ietf-bess-pbb-evpn-isid-cmacflush</a>]</span>.<a href="#section-5.4-1" class="pilcrow">¶</a></p>
<p id="section-5.4-2">
   Note that even if the GEI/EVI routes of <a href="#sect-GEI-Adv-Optm" class="xref">Section 5.1</a> are not advertised, 
   the withdraw of those GEI/EVI route can still be used as a C-MAC flush notification of their &lt;ESI,EVI&gt;.<a href="#section-5.4-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-6">
<section id="section-5.5">
        <h3 id="name-e-tree-support-consideratio">
<a href="#section-5.5" class="section-number selfRef">5.5. </a><a href="#name-e-tree-support-consideratio" class="section-name selfRef">E-Tree Support Considerations</a>
        </h3>
<p id="section-5.5-1">
   E-tree Supprot extensions is similar to <span>[<a href="#RFC8317" class="xref">RFC8317</a>]</span> section 5 except for the following notable differences:
   The leaf B-MACs are replaced by leaf GEIs, the root B-MACs are replaced by root GEIs.
   the PBB encapsulation is replaced by other encapsulations, the B-component is replaced by an IP-VRF or the underlay GRT.
   The B-MAC Advertisement Route is replaced by GEI/EVI route or ESI/IP Route.<a href="#section-5.5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-7">
<section id="section-5.6">
        <h3 id="name-evpn-irb-support-considerat">
<a href="#section-5.6" class="section-number selfRef">5.6. </a><a href="#name-evpn-irb-support-considerat" class="section-name selfRef">EVPN IRB Support Considerations</a>
        </h3>
<p id="section-5.6-1">The dataplane in this draft is no more complex than typical SRv6 EVPN.
   So it will work as efficient as we should expect in SRv6 EVPN IRB usecase.<a href="#section-5.6-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-8">
<section id="section-5.7">
        <h3 id="name-use-ac-sid-in-mac-ip-advert">
<a href="#section-5.7" class="section-number selfRef">5.7. </a><a href="#name-use-ac-sid-in-mac-ip-advert" class="section-name selfRef">Use AC SID in MAC/IP Advertisement Routes</a>
        </h3>
<p id="section-5.7-1">But the AC SID can be used in MAC/IP advertisement route, even if C-MAC overload is not a real threat.
   By doing this, the data-plane can be unified among these usecases.<a href="#section-5.7-1" class="pilcrow">¶</a></p>
<p id="section-5.7-2">Note that the AC SID is also a typical End.DX2 SID too.<a href="#section-5.7-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-mpls-solution">
<section id="section-6">
      <h2 id="name-light-weighted-mpls-evpn">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-light-weighted-mpls-evpn" class="section-name selfRef">Light-Weighted MPLS EVPN</a>
      </h2>
<div id="sect-MPLS-CP">
<section id="section-6.1">
        <h3 id="name-mpls-solution-overview">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-mpls-solution-overview" class="section-name selfRef">MPLS Solution Overview</a>
        </h3>
<p id="section-6.1-1">In MPLS EVPN control plane, we use a 24 bits unsigned number as the EGD of EVI1, and it has global uniqueness in EVI1's service domain.
   In data plane, we use QinQ tags to carry the EGD.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
   We use a Global Unique Label (GUL) to identify an ESI in EVI1's service domain. So the ESI-GUL is also its Global ESI Indicator.
   The ESI-GULs are avertised through RT-1 per ES routes, and they are considered to be an ESI-label by these routes.
   The label in RT-3 route's PMSI-Tunnel Attribute (PTA-Label) whose tunnel type is ingress replication is called as Ingress Replication Multicast Label (IRML) in this document.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">We use the following encapsulation in MPLS-based EVPN-lite:<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<span id="name-mpls-encapsulation-for-evpn"></span><div id="Fig-MPLS-Encap">
<figure id="figure-4">
          <div class="artwork art-text alignCenter" id="section-6.1-4.1">
<pre>
     Format #1                    Format #2
+-----------------------+     +----------------------------+
| PSN Labels            |     | PSN Labels                 |
+-----------------------+     +----------------------------+
| IRML (EVI1)           |     | Destination-ESI GUL (ESI1) |
+-----------------------+     +----------------------------+
| Source-ESI GUL (ESI1) |     | Source-ESI GUL (ESI2)      |
+-----------------------+     +----------------------------+
| Ethernet Header       |     | Ethernet Header (EVI1)     |
+-----------------------+     +----------------------------+
| Ethernet Payload      |     | Ethernet Payload           |
+-----------------------+     +----------------------------+
| Ethernet FCS          |     | Ethernet FCS               |
+-----------------------+     +----------------------------+
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-mpls-encapsulation-for-evpn" class="selfRef">MPLS Encapsulation for EVPN-lite</a>
          </figcaption></figure>
</div>
<p id="section-6.1-5">Note that the GUL can be a single Label Stack Entry (LSE), in such case, it should be allocated in DCB label space.
   Given that the ESIs and vESIs may be too many to be allocated in DCB in certain scenarios, 
   so the GUL should be allocated in a few context-specific label spaces, 
   each identified by a Context Label Space ID (CLS-ID) per <span>[<a href="#I-D.ietf-bess-mvpn-evpn-aggregation-label" class="xref">I-D.ietf-bess-mvpn-evpn-aggregation-label</a>]</span> in such case.
   In such case, the ESI-GUL is the entirety of ESI-label and its Context Label Space ID (CLS-ID), so it means two LSEs in the Label Stack at that time.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<p id="section-6.1-6">Note that the ESI GULs are assigned by a center authority, which may be a DC controller or an administrator.<a href="#section-6.1-6" class="pilcrow">¶</a></p>
<p id="section-6.1-7">Note that the ESI-label (ESI-GUL) should be pushed onto the Label Stack whether the packet is BUM or not. 
   The ESI-GUL can't identify the EVPN Instance EVI1, so we have to use the EGD in the inner ethernet header of "Format #2" to find EVI1 out.<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<p id="section-6.1-8">Note that the GUL concept is very different with the "upstream-assigned label (UAL)" concept. 
   Because that when a SPE receives a GUL from a remote PE, the GUL is considered as an outgoing-label to that remote PE, 
   and although the GUL is also considered as a incoming-label of the current SPE, and the label operation for the GUL will be a "swap", to be precise, 
   The SPE will swap it to itself and then push the MPLS Label Stack to that advertising PE.
   When the same GUL is received from different remote PEs, MPLS ECMP or FRR procedures will be applied.<a href="#section-6.1-8" class="pilcrow">¶</a></p>
<p id="section-6.1-9">So when the GUL is two LSEs in the label stack, 
   we can say that the Context-specific Label Space (CLS) of the ESI-label (inside the GUL) takes the role of B-MAC of PBB EVPN,
   and the CLS-ID label inside the GUL takes the role of the B-VPLS label of PBB EVPN.
   So no B-VPLS instances will be found here.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<p id="section-6.1-10">Note that the GEI/ES route of MPLS-based EVPN-lite is the RT-1 per ES route.<a href="#section-6.1-10" class="pilcrow">¶</a></p>
<p id="section-6.1-11">Note that the light-weighted MPLS EVPN solutions can be used whether or not the SR-MPLS LSPs are used in the underlay network.<a href="#section-6.1-11" class="pilcrow">¶</a></p>
<p id="section-6.1-12">The conceptual comparisons between light-weighted MPLS EVPN and (Pseudo-) PBB EVPN is illustrated in <span>[<a href="#Revision-01" class="xref">Revision-01</a>]</span>.<a href="#section-6.1-12" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-MPLS-proc">
<section id="section-6.2">
        <h3 id="name-mpls-specific-evpn-lite-pro">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-mpls-specific-evpn-lite-pro" class="section-name selfRef">MPLS-specific EVPN-lite Procedures</a>
        </h3>
<p id="section-6.2-1">According to <span>[<a href="#RFC7432" class="xref">RFC7432</a>]</span>, When the IMET route's PTA's tunnel type is ingress replication, the ESI-label is considered to be downstream-assigned too.
   Because that nothing of RT-1 per ES route will indicate whether the ESI-label is upstream-assigned or not.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Alghough ESI-GUL can be a single LSE or two LSEs in the Label Stack, we assume that it is a single LSE by default in this section, it is for simplification purpose.<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="olPercent" id="section-6.2-3">   
   <dt>[M1]</dt>
<dd id="section-6.2-3.1">
            <p id="section-6.2-3.1.1">In Step <a href="#Proc-ARP-Request" class="xref">#1</a>, 
   "Format #1" of <a href="#Fig-MPLS-Encap" class="xref">Figure 4</a> will be used.<a href="#section-6.2-3.1.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.1.2">Although the Ingress Replication Multicat Label (IRML) of "Format #1" can identify EVI1 by itself, 
   we suppose that the ethernet header of it should also carry EGD as what <a href="#Step4" class="xref">[M4]</a> does.<a href="#section-6.2-3.1.2" class="pilcrow">¶</a></p>
<p id="section-6.2-3.1.3">
   Note that there isn't a B-VPLS here, so the IRML identifies the EVI1 itself.
   The EVI1 here equals I-VPLS of PBB EVPN.<a href="#section-6.2-3.1.3" class="pilcrow">¶</a></p>
<p id="section-6.2-3.1.4">Note that when that ARP Request packet comes from a SHD (single-homed device), the ESI of its AC will be null.
   The Source-ESI GUL in "Format #1" will be replaced with a MPLS label identifying the ingress TPE.
   When we assume that the underlay network is a SR-MPLS network, that TPE-identifying label can be the node SID label of that ingress TPE.
   This method follows <span>[<a href="#I-D.wang-bess-evpn-context-label-02" class="xref">I-D.wang-bess-evpn-context-label-02</a>]</span>,
   and the context of the TPE-identifying label is identified by the EVI1's IRML of "Format #1".<a href="#section-6.2-3.1.4" class="pilcrow">¶</a></p>
<p id="section-6.2-3.1.5">Note that the TPE-identifying label typically will do nothing to the all-active ESes, they are used just for the single-homed ESes.
   But when <a href="#sect-GEI-Agg" class="xref">Section 2.12</a> is activated, and all ESIs share the same ESI indicator, an anycast TPE-identifying label in the DCB can be used as that ESI indicator.<a href="#section-6.2-3.1.5" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>[M2]</dt>
<dd id="section-6.2-3.2">
            <p id="section-6.2-3.2.1">In Step <a href="#Proc-MAC-Learn" class="xref">#2</a>,
   "Format #1" of <a href="#Fig-MPLS-Encap" class="xref">Figure 4</a> will be received. 
   PE3 knows the packet is for EVI1 with the help of the IRML label.    
   Then PE3 can learn the relation between the ingress-GEI (ingress-ESI GUL) and S-MAC of BUM1 directly, no GEI to ESI lookup needed.<a href="#section-6.2-3.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>[M3]</dt>
<dd id="section-6.2-3.3">
            <p id="section-6.2-3.3.1">In Step <a href="#Proc-Discard-ARP-Req" class="xref">#3</a>, 
   PE2 can compare the ingress-GEI (ingress-ESI GUL) of BUM1 and the egress-GEI (ESI-GUL of outgoing AC) directly, no GEI to ESI lookup needed.<a href="#section-6.2-3.3.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt>[M4]</dt>
<dd id="section-6.2-3.4">
<div id="Step4">
            <p id="section-6.2-3.4.1">In Step <a href="#Proc-ARP-Replay-to-PEs" class="xref">#4</a>, 
   "Format #2" of <a href="#Fig-MPLS-Encap" class="xref">Figure 4</a> will be used.
   The source-ESI GUL, from which the corresponding MAC entry M1 is previously learnt, will be encapsulated as the destination-ESI GUL directly.
   No GEI to ESI lookup needed only if we don't care the requirements of <a href="#sect-ESI_EVI_Cnvg" class="xref">Section 2.9</a>.  
   Otherwise we should refer the corresponding RT-1 per EVI routes of ESI1 to forward the packet. 
   These RT-1 per EVI routes are advertised for EVI1, so the Ethernet Tag ID (ETI) of these routes don't have to be the EGD.<a href="#section-6.2-3.4.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.4.2">Note that when ESI1 is single-active mode, ESI-GUL of ESI1 will be different on PE1 and PE2.
   But the MAC entry M1 will use the newest one only, the swithover between them is called as MAC-move.<a href="#section-6.2-3.4.2" class="pilcrow">¶</a></p>
</div>
          </dd>
<dd class="break"></dd>
<dt>[M5]</dt>
<dd id="section-6.2-3.5">
            <p id="section-6.2-3.5.1">In Step <a href="#Proc-ARP-Replay-to-CE1" class="xref">#5</a>, Whe PE1 received the ARP reply packet from PE3, 
   PE1 first match the packet to ESI1 by Destination-ESI GUL, then match the packet to the EVI instance EVI1 by the QinQ tags of Ethernet header.<a href="#section-6.2-3.5.1" class="pilcrow">¶</a></p>
<p id="section-6.2-3.5.2">Note that we suppose that the original tags from ingress AC will be processed following the Raw mode per <span>[<a href="#RFC4448" class="xref">RFC4448</a>]</span>.
   Although the tagged mode can be used technically. Note that the original tags (if they are kept in the packet) will be the inner tags of the EGD.<a href="#section-6.2-3.5.2" class="pilcrow">¶</a></p>
<p id="section-6.2-3.5.3">Note that when RT-1 per EVI route are used, as specified in <a href="#Step4" class="xref">[M4]</a>.
   There is no need to carry EGD in unicast data-packets too.<a href="#section-6.2-3.5.3" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="sect-BCB">
<section id="section-6.3">
        <h3 id="name-hierarchical-vpls-in-evpn-l">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-hierarchical-vpls-in-evpn-l" class="section-name selfRef">Hierarchical VPLS in EVPN-lite</a>
        </h3>
<p id="section-6.3-1">
   In hierachical topology (as illustrated in the following figure), the PEs are separated into two groups, the Target PEs (TPEs) and the Superstratum PEs (SPEs).<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<span id="name-evpn-lite-h-vpls"></span><div id="h-vpls">
<figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-6.3-2.1">
<pre>

    ___TPE5___        SPE3       ___TPE4_____
   /AC5       \      /   \      /            \AC4
CE3            \    /     \    /              &gt;=====CE2
   \___         \  /       \  /          ____/AC2
    ___TPE3----SPE1-------SPE2-------TPE2
   /AC3          /                       \
CE1             /                         \
   \____TPE1___/                           \___CE6
    AC1

</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-evpn-lite-h-vpls" class="selfRef">EVPN-lite H-VPLS</a>
          </figcaption></figure>
</div>
<p id="section-6.3-3">The TPEs works like the IB-BEB-PE in PBB VPLS, the SPE works like the BCB-PE in PBB VPLS.
   The BCB-PEs in PBB VPLS do BUM replication based on the PBB header.
   There are no PBB hearder in EVPN-lite solutions, but the SPEs won't learn the C-MACs, which is the same as BCB-PEs in PBB VPLS.
   The forwarding behaviors of these EVPN-lite solutions are very different from each other:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.3-4.1">
            <p id="section-6.3-4.1.1">In SRv6-based EVPN-lite, the SPEs are typically pure underlay nodes, they don't have to aware of the EVIs.<a href="#section-6.3-4.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-6.3-4.2">
            <p id="section-6.3-4.2.1">The SPEs in MPLS-based EVPN-lite don't have to aware of the BUM packets,
   because that, for IMET routes, they work like the ASBRs in inter-AS option B.
   In such case, the TPEs do ingress-replication for all other TPEs by themselves.<a href="#section-6.3-4.2.1" class="pilcrow">¶</a></p>
<p id="section-6.3-4.2.2">The SPEs in MPLS-based EVPN-lite may terminate the IMET routes that were received from their TPEs.
   These IMET routes are imported into an corresponding BD, but may not be passed through other SPEs, so as not to cause duplicated BUM packets.
   In such case, take SPE1 for example, there are two split-horizon-groups, one group is TPE1/TPE3/TPE5, another split-horizon-group is SPE1/SPE2. 
   The BUM packets are replicated between different split-horizon-groups.
   In such case, the TPEs do ingress-replication for its directly connected TPEs and SPEs, not for the indirectly connected TPEs and SPEs.
   But the unicast packet will not be forwarded by that BD on the SPEs.
   The unicast packets will be label-swapped in the context-specific label-space for the corresponding GULs.<a href="#section-6.3-4.2.2" class="pilcrow">¶</a></p>
<p id="section-6.3-4.2.3">Note that the BCB-PE in PBB VPLS is typically supported in the industry, 
   But it seems that the BCB-PE in PBB EVPN is typically not supported in the industry up to now.
   Because the BCB-PE function can be replaced in MPLS EVPN by a label-swapping operation which is like the inter-AS option B scenarios.<a href="#section-6.3-4.2.3" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-6.3-5">Note that the BUM packets here are defined based on the destination C-MAC addresses.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-comparisons">
<section id="section-7">
      <h2 id="name-comparison-with-other-solut">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-comparison-with-other-solut" class="section-name selfRef">Comparison with Other Solutions</a>
      </h2>
<p id="section-7-1">We briefly compared light-weighted SRv6 EVPN with PBB-VPLS, PBB-EVPN and VXLAN solutions in <span>[<a href="#Revision-01" class="xref">Revision-01</a>]</span>,
 further brief comparisions with VTEP Group (and its transplantation in SRv6 network) were described in <span>[<a href="#Revision-02" class="xref">Revision-02</a>]</span>.
 So we just add the detailed comparisons between EVPN-lite SRv6 and PBB EVPN over SRv6 in this revision.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="sect-PBB-EVPN">
<section id="section-7.1">
        <h3 id="name-detailed-comparisons-with-p">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-detailed-comparisons-with-p" class="section-name selfRef">Detailed Comparisons with PBB EVPN over SRv6</a>
        </h3>
<p id="section-7.1-1">I think the "PBB EVPN over SRv6 underlay" solution will be complex, 
if we address too much things. 
I have some examples in the following:<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.1-2.1">
            <p id="section-7.1-2.1.1">The upper-layer header for SRv6 is the PBB-header for B-MACs, not the ethernet header for C-MACs,
so the SID list (SR-Path or network programming Instructions) in the SRH can't be constructed for the sake of the I-Component. 
For example, when a SRv6 SID for MAC-guarding (or something else, just an example) present in the SRH for PBB EVPN SRv6, I think it means BMAC-guarding, no C-MAC guarding.<a href="#section-7.1-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.2">
            <p id="section-7.1-2.2.1">The B-MACs for the all-active ESIs can't be aggregated, but the SRv6 SIDs for ESIs can be aggregated.
    The underlay can advertise the aggregated prefixes only, so the burden of the underlay network may not be increased too much.
    When the underlay routes is aggregated, the C-MACs can also be learnt against /128 source-IP,
    it is the advantage of a light-weighted SRv6 EVPN, which can't be gained from a PBB header.<a href="#section-7.1-2.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.3">
            <p id="section-7.1-2.3.1">The B-MACs are for overlay protection (the real overlay is the I-VPLS, but the B-VPLS is also an overlay network from the viewpoint of the SRv6 network).
    But the SRv6 SIDs for ESIs will  be for underlay protection, it works like the egress protection.
    They are two different types of solutions.<a href="#section-7.1-2.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-7.1-2.4">
            <p id="section-7.1-2.4.1">Although PBB EVPN can be transplanted into SRv6 networks along with the PBB header, It seems to be more complicated to me.
Take the EVPN IRB usecases for example, that requires seven sequences of header processing, like (SRv6/B-MAC/C-MAC)(Inner-IP)(C-MAC/B-MAC/SRv6), during the overlay L3 forwarding.
I think it will be horrible enough for some ASICs to implement it.
When the processing is simplified as (SRv6/C-MAC)(Inner-IP)(C-MAC/SRv6), it sounds like a step forward, not backward, IMHO.
We can achieve this goal easily inside the EVPN framework, only if the data-plane learning can still be considered as an option after PBB EVPN.<a href="#section-7.1-2.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-7.1-3">Fortunately, SRv6 is just too young to have a transplantation of PBB EVPN.
So it will waste nothing for the SRv6 nodes to give up the PBB header whom is never used by these SRv6 nodes.
Note that the SRv6 functions (End.DT2U and End.DT2M) for L2VPNs have source-IP-based data-plane learning for a long time already.<a href="#section-7.1-3" class="pilcrow">¶</a></p>
<p id="section-7.1-4">In EVPN IRB usecase, <span>[<a href="#I-D.ietf-bess-evpn-irb-extended-mobility" class="xref">I-D.ietf-bess-evpn-irb-extended-mobility</a>]</span> defines some optional extensions to support some specific IRB usecases.
In these specific IRB usecases, the &lt;MAC,IP&gt; bindings will change across VM-moves.
These extensions can't be applied to PBB EVPNs, they can't be applied to light-weighted EVPNs either.
This will not prevent PBB EVPNs and light-weighted EVPNs from supporting typical IRB use-cases.<a href="#section-7.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-Node-SID">
<section id="section-7.2">
        <h3 id="name-detailed-comparisons-with-a">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-detailed-comparisons-with-a" class="section-name selfRef">Detailed Comparisons with Anycast Node SID</a>
        </h3>
<p id="section-7.2-1">The "Anycast Node SID" solution here is the transplantation of Anycast-VTEP-IP solution in SRv6 data-plane, where the Anycast Node SID is the equivalent of the Anycast VTEP IP address.
 Note that SRv6 Anycast Node SID is the ultimate aggregation of ESI indicators. The detailed comparisons will be added in the future visions.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-9">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">
   Security considerations will be added in future versions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="sect-10">
<section id="section-9">
      <h2 id="name-iana-considerations">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="sect-iana-1">
<section id="section-9.1">
        <h3 id="name-enddx2agg-sid">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-enddx2agg-sid" class="section-name selfRef">End.DX2AGG SID</a>
        </h3>
<p id="section-9.1-1">
   IANA is requested to allocate a new code points for the new SRv6
   Endpoint Behaviors defined in this document.<a href="#section-9.1-1" class="pilcrow">¶</a></p>
<span id="name-enddx2agg"></span><div id="iana-End.DX2AGG">
<figure id="figure-6">
          <div class="artwork art-text alignCenter" id="section-9.1-2.1">
<pre>

+------+-------------+---------------+
| Type | Description | Reference     |
+------+-------------+---------------+
| TBD1 | End.DX2AGG    | This Document |
+------+-------------+---------------+

</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-enddx2agg" class="selfRef">End.DX2AGG</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="sect-iana-2">
<section id="section-9.2">
        <h3 id="name-global-unique-esi-label-in-">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-global-unique-esi-label-in-" class="section-name selfRef">Global Unique ESI-label in EAD per ES Route</a>
        </h3>
<p id="section-9.2-1">
   When we use Global Unique ESI-label in EAD per ES route, especially in ingress-replication use case,
   It should be explicitly indicated in the EAD per ES route.
   The details will be added in future versions.<a href="#section-9.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="sect-acknowledge">
<section id="section-10">
      <h2 id="name-acknowledgements">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-10-1">The authors would like to thank the following for their comments and
    review of this document:<a href="#section-10-1" class="pilcrow">¶</a></p>
<p id="section-10-2">Ye Shu.<a href="#section-10-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-11">
      <h2 id="name-normative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="I-D.ietf-bess-evpn-unequal-lb">[I-D.ietf-bess-evpn-unequal-lb]</dt>
      <dd>
<span class="refAuthor">Malhotra, N.</span><span class="refAuthor">, Sajassi, A.</span><span class="refAuthor">, Rabadan, J.</span><span class="refAuthor">, Drake, J.</span><span class="refAuthor">, Lingala, A.</span><span class="refAuthor">, and S. Thoria</span>, <span class="refTitle">"Weighted Multi-Path Procedures for EVPN All-Active Multi-Homing"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-unequal-lb-07</span>, <time datetime="2020-10-14" class="refDate">14 October 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-bess-evpn-unequal-lb-07">https://tools.ietf.org/html/draft-ietf-bess-evpn-unequal-lb-07</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-mvpn-evpn-aggregation-label">[I-D.ietf-bess-mvpn-evpn-aggregation-label]</dt>
      <dd>
<span class="refAuthor">Zhang, Z.</span><span class="refAuthor">, Rosen, E.</span><span class="refAuthor">, Lin, W.</span><span class="refAuthor">, Li, Z.</span><span class="refAuthor">, and I. Wijnands</span>, <span class="refTitle">"MVPN/EVPN Tunnel Aggregation with Common Labels"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-mvpn-evpn-aggregation-label-04</span>, <time datetime="2020-11-15" class="refDate">15 November 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-bess-mvpn-evpn-aggregation-label-04">https://tools.ietf.org/html/draft-ietf-bess-mvpn-evpn-aggregation-label-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-srv6-services">[I-D.ietf-bess-srv6-services]</dt>
      <dd>
<span class="refAuthor">Dawra, G.</span><span class="refAuthor">, Filsfils, C.</span><span class="refAuthor">, Talaulikar, K.</span><span class="refAuthor">, Raszuk, R.</span><span class="refAuthor">, Decraene, B.</span><span class="refAuthor">, Zhuang, S.</span><span class="refAuthor">, and J. Rabadan</span>, <span class="refTitle">"SRv6 BGP based Overlay services"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-srv6-services-05</span>, <time datetime="2020-11-02" class="refDate">2 November 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-bess-srv6-services-05">https://tools.ietf.org/html/draft-ietf-bess-srv6-services-05</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-spring-srv6-network-programming">[I-D.ietf-spring-srv6-network-programming]</dt>
      <dd>
<span class="refAuthor">Filsfils, C.</span><span class="refAuthor">, Camarillo, P.</span><span class="refAuthor">, Leddy, J.</span><span class="refAuthor">, Voyer, D.</span><span class="refAuthor">, Matsushima, S.</span><span class="refAuthor">, and Z. Li</span>, <span class="refTitle">"SRv6 Network Programming"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-spring-srv6-network-programming-27</span>, <time datetime="2020-12-10" class="refDate">10 December 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-spring-srv6-network-programming-27">https://tools.ietf.org/html/draft-ietf-spring-srv6-network-programming-27</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.sajassi-bess-evpn-ac-aware-bundling">[I-D.sajassi-bess-evpn-ac-aware-bundling]</dt>
      <dd>
<span class="refAuthor">Sajassi, A.</span><span class="refAuthor">, Mishra, M.</span><span class="refAuthor">, Thoria, S.</span><span class="refAuthor">, Brissette, P.</span><span class="refAuthor">, Rabadan, J.</span><span class="refAuthor">, and J. Drake</span>, <span class="refTitle">"AC-Aware Bundling Service Interface in EVPN"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-sajassi-bess-evpn-ac-aware-bundling-02</span>, <time datetime="2020-08-18" class="refDate">18 August 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-sajassi-bess-evpn-ac-aware-bundling-02">https://tools.ietf.org/html/draft-sajassi-bess-evpn-ac-aware-bundling-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4448">[RFC4448]</dt>
      <dd>
<span class="refAuthor">Martini, L., Ed.</span><span class="refAuthor">, Rosen, E.</span><span class="refAuthor">, El-Aawar, N.</span><span class="refAuthor">, and G. Heron</span>, <span class="refTitle">"Encapsulation Methods for Transport of Ethernet over MPLS Networks"</span>, <span class="seriesInfo">RFC 4448</span>, <span class="seriesInfo">DOI 10.17487/RFC4448</span>, <time datetime="2006-04" class="refDate">April 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4448">https://www.rfc-editor.org/info/rfc4448</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7348">[RFC7348]</dt>
      <dd>
<span class="refAuthor">Mahalingam, M.</span><span class="refAuthor">, Dutt, D.</span><span class="refAuthor">, Duda, K.</span><span class="refAuthor">, Agarwal, P.</span><span class="refAuthor">, Kreeger, L.</span><span class="refAuthor">, Sridhar, T.</span><span class="refAuthor">, Bursell, M.</span><span class="refAuthor">, and C. Wright</span>, <span class="refTitle">"Virtual eXtensible Local Area Network (VXLAN): A Framework for Overlaying Virtualized Layer 2 Networks over Layer 3 Networks"</span>, <span class="seriesInfo">RFC 7348</span>, <span class="seriesInfo">DOI 10.17487/RFC7348</span>, <time datetime="2014-08" class="refDate">August 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7348">https://www.rfc-editor.org/info/rfc7348</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7432">[RFC7432]</dt>
      <dd>
<span class="refAuthor">Sajassi, A., Ed.</span><span class="refAuthor">, Aggarwal, R.</span><span class="refAuthor">, Bitar, N.</span><span class="refAuthor">, Isaac, A.</span><span class="refAuthor">, Uttaro, J.</span><span class="refAuthor">, Drake, J.</span><span class="refAuthor">, and W. Henderickx</span>, <span class="refTitle">"BGP MPLS-Based Ethernet VPN"</span>, <span class="seriesInfo">RFC 7432</span>, <span class="seriesInfo">DOI 10.17487/RFC7432</span>, <time datetime="2015-02" class="refDate">February 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7432">https://www.rfc-editor.org/info/rfc7432</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7623">[RFC7623]</dt>
      <dd>
<span class="refAuthor">Sajassi, A., Ed.</span><span class="refAuthor">, Salam, S.</span><span class="refAuthor">, Bitar, N.</span><span class="refAuthor">, Isaac, A.</span><span class="refAuthor">, and W. Henderickx</span>, <span class="refTitle">"Provider Backbone Bridging Combined with Ethernet VPN (PBB-EVPN)"</span>, <span class="seriesInfo">RFC 7623</span>, <span class="seriesInfo">DOI 10.17487/RFC7623</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7623">https://www.rfc-editor.org/info/rfc7623</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8317">[RFC8317]</dt>
      <dd>
<span class="refAuthor">Sajassi, A., Ed.</span><span class="refAuthor">, Salam, S.</span><span class="refAuthor">, Drake, J.</span><span class="refAuthor">, Uttaro, J.</span><span class="refAuthor">, Boutros, S.</span><span class="refAuthor">, and J. Rabadan</span>, <span class="refTitle">"Ethernet-Tree (E-Tree) Support in Ethernet VPN (EVPN) and Provider Backbone Bridging EVPN (PBB-EVPN)"</span>, <span class="seriesInfo">RFC 8317</span>, <span class="seriesInfo">DOI 10.17487/RFC8317</span>, <time datetime="2018-01" class="refDate">January 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8317">https://www.rfc-editor.org/info/rfc8317</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8365">[RFC8365]</dt>
    <dd>
<span class="refAuthor">Sajassi, A., Ed.</span><span class="refAuthor">, Drake, J., Ed.</span><span class="refAuthor">, Bitar, N.</span><span class="refAuthor">, Shekhar, R.</span><span class="refAuthor">, Uttaro, J.</span><span class="refAuthor">, and W. Henderickx</span>, <span class="refTitle">"A Network Virtualization Overlay Solution Using Ethernet VPN (EVPN)"</span>, <span class="seriesInfo">RFC 8365</span>, <span class="seriesInfo">DOI 10.17487/RFC8365</span>, <time datetime="2018-03" class="refDate">March 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8365">https://www.rfc-editor.org/info/rfc8365</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-12">
      <h2 id="name-informative-references">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="I-D.eastlake-bess-evpn-vxlan-bypass-vtep">[I-D.eastlake-bess-evpn-vxlan-bypass-vtep]</dt>
      <dd>
<span class="refAuthor">Eastlake, D.</span><span class="refAuthor">, Li, Z.</span><span class="refAuthor">, and S. Zhuang</span>, <span class="refTitle">"EVPN VXLAN Bypass VTEP"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-eastlake-bess-evpn-vxlan-bypass-vtep-06</span>, <time datetime="2020-10-19" class="refDate">19 October 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-eastlake-bess-evpn-vxlan-bypass-vtep-06">https://tools.ietf.org/html/draft-eastlake-bess-evpn-vxlan-bypass-vtep-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-evpn-irb-extended-mobility">[I-D.ietf-bess-evpn-irb-extended-mobility]</dt>
      <dd>
<span class="refAuthor">Malhotra, N.</span><span class="refAuthor">, Sajassi, A.</span><span class="refAuthor">, Pattekar, A.</span><span class="refAuthor">, Lingala, A.</span><span class="refAuthor">, Rabadan, J.</span><span class="refAuthor">, and J. Drake</span>, <span class="refTitle">"Extended Mobility Procedures for EVPN-IRB"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-evpn-irb-extended-mobility-04</span>, <time datetime="2020-10-27" class="refDate">27 October 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-bess-evpn-irb-extended-mobility-04">https://tools.ietf.org/html/draft-ietf-bess-evpn-irb-extended-mobility-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bess-pbb-evpn-isid-cmacflush">[I-D.ietf-bess-pbb-evpn-isid-cmacflush]</dt>
      <dd>
<span class="refAuthor">Rabadan, J.</span><span class="refAuthor">, Sathappan, S.</span><span class="refAuthor">, Nagaraj, K.</span><span class="refAuthor">, Miyake, M.</span><span class="refAuthor">, and T. Matsuda</span>, <span class="refTitle">"PBB-EVPN ISID-based CMAC-Flush"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bess-pbb-evpn-isid-cmacflush-01</span>, <time datetime="2020-10-30" class="refDate">30 October 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-ietf-bess-pbb-evpn-isid-cmacflush-01">https://tools.ietf.org/html/draft-ietf-bess-pbb-evpn-isid-cmacflush-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.wang-bess-evpn-context-label-02">[I-D.wang-bess-evpn-context-label-02]</dt>
      <dd>
<span class="refAuthor">Wang, Y.</span>, <span class="refTitle">"'SR-MPLS signalling for CSL-based Context VC' in I-D.wang-bess-evpn-context-label-02"</span>, <time datetime="2020-06-10" class="refDate">10 June 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-wang-bess-evpn-context-label-02#section-4.2">https://tools.ietf.org/html/draft-wang-bess-evpn-context-label-02#section-4.2</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.wang-bess-evpn-egress-protection">[I-D.wang-bess-evpn-egress-protection]</dt>
      <dd>
<span class="refAuthor">Wang, Y.</span><span class="refAuthor"> and R. Chen</span>, <span class="refTitle">"EVPN Egress Protection"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-wang-bess-evpn-egress-protection-04</span>, <time datetime="2020-10-29" class="refDate">29 October 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-wang-bess-evpn-egress-protection-04">https://tools.ietf.org/html/draft-wang-bess-evpn-egress-protection-04</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Revision-01">[Revision-01]</dt>
      <dd>
<span class="refTitle">"Revision-01 of this draft"</span>, <time datetime="2020-07-01" class="refDate">1 July 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-wang-bess-evpn-cmac-overload-reduction-01">https://tools.ietf.org/html/draft-wang-bess-evpn-cmac-overload-reduction-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Revision-02">[Revision-02]</dt>
      <dd>
<span class="refTitle">"Revision-02 of this draft"</span>, <time datetime="2020-11-14" class="refDate">14 November 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-wang-bess-evpn-cmac-overload-reduction-02">https://tools.ietf.org/html/draft-wang-bess-evpn-cmac-overload-reduction-02</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7041">[RFC7041]</dt>
    <dd>
<span class="refAuthor">Balus, F., Ed.</span><span class="refAuthor">, Sajassi, A., Ed.</span><span class="refAuthor">, and N. Bitar, Ed.</span>, <span class="refTitle">"Extensions to the Virtual Private LAN Service (VPLS) Provider Edge (PE) Model for Provider Backbone Bridging"</span>, <span class="seriesInfo">RFC 7041</span>, <span class="seriesInfo">DOI 10.17487/RFC7041</span>, <time datetime="2013-11" class="refDate">November 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7041">https://www.rfc-editor.org/info/rfc7041</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="section-appendix.a">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yubao Wang</span></div>
<div dir="auto" class="left"><span class="org">ZTE Corporation</span></div>
<div dir="auto" class="left"><span class="street-address">No.68 of Zijinghua Road, Yuhuatai Distinct</span></div>
<div dir="auto" class="left"><span class="locality">Nanjing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:wang.yubao2@zte.com.cn" class="email">wang.yubao2@zte.com.cn</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ran Chen</span></div>
<div dir="auto" class="left"><span class="org">ZTE Corporation</span></div>
<div dir="auto" class="left"><span class="street-address">No. 50 Software Ave, Yuhuatai Distinct</span></div>
<div dir="auto" class="left"><span class="locality">Nanjing</span></div>
<div dir="auto" class="left"><span class="country-name">China</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:chen.ran@zte.com.cn" class="email">chen.ran@zte.com.cn</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
