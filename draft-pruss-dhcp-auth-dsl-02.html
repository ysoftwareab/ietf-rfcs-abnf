<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Authentication Extensions for the
    Dynamic Host Configuration Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Authentication Extensions for the
    Dynamic Host Configuration Protocol">
<meta name="keywords" content="DHCP, EAP, PPP, CHAP, Authentication, Draft">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Dynamic Host Configuration WG</td><td class="header">R. Pruss</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Cisco Systems</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">G. Zorn</td></tr>
<tr><td class="header">Expires: May 22, 2008</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">R. Maglione</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Telecom Italia</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Y. Li</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Huawei Technologies</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 19, 2007</td></tr>
</table></td></tr></table>
<h1><br />Authentication Extensions for the
    Dynamic Host Configuration Protocol<br />draft-pruss-dhcp-auth-dsl-02</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 22, 2008.</p>

<h3>Abstract</h3>

<p>This document defines Dynamic Host Configuration Protocol (DHCP)
      extensions that provide for end-user authentication prior to
      configuration of the host. The primary applicability is within a Digital
      Subscriber Line (DSL) Broadband network environment in order to enable a
      smooth migration from the Point to Point Protocol (PPP).
</p>
<h3>Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#Intro">1.</a>&nbsp;
Introduction<br />
<a href="#Problem">2.</a>&nbsp;
Problem Statement<br />
<a href="#Architecture">3.</a>&nbsp;
Network Architecture and Terminology<br />
<a href="#Applicability">4.</a>&nbsp;
Applicability Statement<br />
<a href="#Protocol">5.</a>&nbsp;
Protocol Operation Alternatives<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Protocol-Existing">5.1.</a>&nbsp;
Protocol Operation with Existing Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Protocol-New">5.2.</a>&nbsp;
Protocol Operation with DHCPEAP MessageType<br />
<a href="#DHCP-Options">6.</a>&nbsp;
DHCP Options<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#DHCP-Auth-Proto">6.1.</a>&nbsp;
DHCP Authentication Protocol Option<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#CHAP-Auth-Data">6.2.</a>&nbsp;
CHAP Authentication Data Option<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Chllng-Rsp">6.2.1.</a>&nbsp;
Challenge and Response<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#Succ-fail">6.2.2.</a>&nbsp;
Success and Failure<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#EAP-Auth-Data">6.3.</a>&nbsp;
EAP-Message Option<br />
<a href="#Compatibility">7.</a>&nbsp;
Compatibility Considerations<br />
<a href="#Security">8.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">8.1.</a>&nbsp;
On Mutual Authentication<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">8.2.</a>&nbsp;
Message Authentication <br />
<a href="#IANA">9.</a>&nbsp;
IANA Considerations<br />
<a href="#New-Messages">10.</a>&nbsp;
Message for EAP operation<br />
<a href="#Acknowledgements">11.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">12.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">12.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">12.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="Intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document defines DHCP Options and procedures that allow for at
      least a Challenge-Handshake Authentication Protocol (CHAP)-based
      authentication exchange to occur in DHCP in order to enable smooth
      migration from Point-to-Point Protocol (PPP)<a class='info' href='#RFC1661'>[RFC1661]<span> (</span><span class='info'>Simpson, W., &ldquo;The Point-to-Point Protocol (PPP),&rdquo; July&nbsp;1994.</span><span>)</span></a> sessions to IP sessions in a DSL Broadband
      network environment. Primary goals are integration of authentication in
      such a way that it will operate seamlessly with existing RADIUS-based
      Authentication, Authorization and Accounting (AAA) infrastructure and
      Asynchronous Transfer Mode (ATM) or Ethernet based DSL Networks. As
      such, only the termination points of PPP in the DSL network are
      affected, both of which are devices that would logically need to be
      updated in any transition from PPP to IP sessions.
</p>
<p>It should be noted that <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> defines a
      mechanism that provides authentication of individual DHCP messages.
      While this mechanism does provide a method of authentication for a DHCP
      Client based on a shared secret, it does not do so in a manner that can
      be seamlessly integrated with existing RADIUS-based AAA infrastructure
      built around PPP CHAP authentication models.
</p>
<a name="Problem"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Problem Statement</h3>

<p>Digital Subscriber Line (DSL) broadband service providers are
      witnessing a shift in the "last-mile" aggregation technologies and
      protocols which have traditionally been relied upon. Two primary
      transitions are from ATM to Ethernet in the access network, and from the
      PPP for multi-protocol framing and dynamic endpoint configuration to
      direct encapsulation of IP and DHCP for dynamic endpoint configuration
      for some devices. The term used by the DSL Forum for the network state
      associated with an authorized subscriber (that is using DHCP and IP
      rather than PPP) is "IP session" <a class='info' href='#WT-146'>[WT&#8209;146]<span> (</span><span class='info'>DSL Forum, &ldquo;Internet Protocol (IP) Sessions,&rdquo; April&nbsp;2007.</span><span>)</span></a>. While
      these trends can be readily witnessed, neither are occurring overnight.
      In addition, they are not necessarily implemented in lock-step. Thus,
      one may find ATM-based and Ethernet-based access networks running a
      combination of PPP sessions and IP sessions at any given time,
      particularly during transition periods. These coexistences will even
      occur for the same service subscriber.
</p>
<p>Removing PPP, Point-to-Point Protocol over ATM (PPPoA) <a class='info' href='#RFC2364'>[RFC2364]<span> (</span><span class='info'>Gross, G., Kaycee, M., Lin, A., Malis, A., and J. Stephens, &ldquo;PPP Over AAL5,&rdquo; July&nbsp;1998.</span><span>)</span></a>, and Point-to-Point Protocol over Ethernet
      (PPPoE) <a class='info' href='#RFC2516'>[RFC2516]<span> (</span><span class='info'>Mamakos, L., Lidl, K., Evarts, J., Carrel, D., Simone, D., and R. Wheeler, &ldquo;A Method for Transmitting PPP Over Ethernet (PPPoE),&rdquo; February&nbsp;1999.</span><span>)</span></a> from the subscriber access
      network is relatively straightforward in that most of the properties
      that DSL providers are interested in going forward are already present
      in DHCP and IP sessions. Luckily, there are some capabilities of PPP
      which the market does not continue to demand. For example, the Dynamic
      configuration in PPP for IPX or NETBEUI, for example, is no longer of
      concern. Neither are the multi-link bonding capabilities of PPP <a class='info' href='#RFC1990'>[RFC1990]<span> (</span><span class='info'>Sklower, K., Lloyd, B., McGregor, G., Carr, D., and T. Coradetti, &ldquo;The PPP Multilink Protocol (MP),&rdquo; August&nbsp;1996.</span><span>)</span></a> commonly used on separate ISDN B-channels, and
      the myriad of other features that PPP developed as the "dial-based"
      access protocol of choice for framing, authentication, and dynamic
      configuration for IP and other network layer protocols. Missing from IP
      sessions and DHCP <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a>, however, are
      isomorphic methods for user authentication and session liveness probing
      (sometimes referred to as a session "keepalive"). For the latter,
      existence of a client using a given IP address can be detected by a
      number of means, including Address Resolution Protocol (ARP) <a class='info' href='#RFC1433'>[RFC1433]<span> (</span><span class='info'>Garrett, J., Hagan, J., and J. Wong, &ldquo;Directed ARP,&rdquo; March&nbsp;1993.</span><span>)</span></a>, ICMP Echo/Echo Response <a class='info' href='#RFC0792'>[RFC0792]<span> (</span><span class='info'>Postel, J., &ldquo;Internet Control Message Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a>, or Bidirectional Forwarding Detection (BFD)
      <a class='info' href='#I-D.ietf-bfd-base'>[I&#8209;D.ietf&#8209;bfd&#8209;base]<span> (</span><span class='info'>Katz, D. and D. Ward, &ldquo;Bidirectional Forwarding Detection,&rdquo; January&nbsp;2010.</span><span>)</span></a>. This leaves authentication as
      an open issue needing resolution. Specifically, authentication based on
      a username and secret password must be covered. This is something that
      in PPP always occurs before dynamic configuration of an IP address and
      associated parameters.
</p>
<p>While most DSL deployments utilize a username and password to
      authenticate a subscriber and authorize access today, this is not the
      only method for authentication that has been adopted when moving to DHCP
      and IP sessions. "Option 82" <a class='info' href='#RFC3046'>[RFC3046]<span> (</span><span class='info'>Patrick, M., &ldquo;DHCP Relay Agent Information Option,&rdquo; January&nbsp;2001.</span><span>)</span></a> is commonly
      used with DHCP as a credential to authenticate a given subscriber line
      and authorize service. In this model, the DSL Access Node, which always
      sits between the DHCP Client and Server, snoops DHCP messages as they
      pass, and inserts pre-configured information for a given line (e.g., an
      ATM VPI/VCI, Ethernet VLAN, or other tag). That information, while
      provided in clear text, traverses what is considered a physically
      secured portion of the access network and is used to determine
      (typically via a request to an AAA server) whether the DHCP exchange can
      continue. This fits quite well with current DSL network architecture, as
      long as the subscriber line itself is all that needs be authorized.
      However, in some service models it is still necessary for the subscriber
      to provide credentials directly.
</p>
<p>From the perspective of the Network Access Server (NAS) where the
      DHCP Server resides, the extensions defined in this document are
      analogous to the commonly available "Option 82" method. The primary
      difference between using Option 82 line configuration and a username and
      password is that the authentication credentials are provided by the
      subscriber rather than inserted by intervening network equipment.
      Providing credentials from the subscriber rather than intervening
      network equipment is particularly important for cases where subscriber
      line information is unavailable, untrusted, or due to the terms of the
      service changing at any time. Further, different devices in the home may
      have different policies and require different credentials. Migration
      scenarios where PPPoE and DHCP operate on the same network for a period
      of time lend well to models which utilize identical authentication and
      authorization credentials across the different data plane
      encapsulations.
</p>
<a name="Architecture"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Network Architecture and Terminology</h3>

<p>The DSL Forum defines its ATM-based network architecture in <a class='info' href='#TR-059'>[TR&#8209;059]<span> (</span><span class='info'>DSL Forum, &ldquo;DSL Evolution - Architecture Requirements for the Support of           QoS-Enabled IP Services,&rdquo; September&nbsp;2003.</span><span>)</span></a> and Ethernet-based network architecture in <a class='info' href='#TR-101'>[TR&#8209;101]<span> (</span><span class='info'>DSL Forum, &ldquo;Migration to Ethernet Based DSL Aggregation,&rdquo; April&nbsp;2006.</span><span>)</span></a>. The extensions for DHCP defined in this
      document are designed to work identically on Ethernet or ATM
      architectures. The diagram in <a class='info' href='#Fig1'>Figure&nbsp;1<span> (</span><span class='info'>DSL Network Architecture</span><span>)</span></a> and following
      terminology will be used throughout: <br /><hr class="insert" />
<a name="Fig1"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
                             +-----------+  +------------+
                             |   DHCP    |  | AAA/RADIUS |
                             |  Server   |  |   Server   |
                             +-----------+  +------------+
                                     |            |
                                     |            |
 Sub.     +-----+   +--------+       |         +-----+   +----------+
 Home  ---| HGW |---|        |       +---------|     |   |          |
Network   +-----+   | Access |                 |     |   |          |
                    |  Node  |--/Aggregation\--| NAS |---| Internet |
 Sub.     +-----+   |        |--\  Network  /--|     |   |          |
 Home  ---| HGW |---|        |                 |     |   |          |
Network   +-----+   +--------+                 +-----+   +----------+
             |                                     |
             |----------DSL Access Network --------|</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: DSL Network Architecture&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 
<ul class="text">
<li>Access Node (AN): Network device, usually located at a service
          provider central office or street cabinet, that terminates Access
          Loop connections from Subscribers. In case the Access Loop is a
          Digital Subscriber Line (DSL), this is often referred to as a DSL
          Access Multiplexer (DSLAM). The AN may support one or more Access
          Loop technologies and allow them to inter-work with a common
          aggregation network technology.
</li>
<li>Network Access Server (NAS): Network device that aggregates
          multiplexed Subscriber traffic from a number of Access Nodes. The
          NAS plays a central role in per-subscriber policy enforcement and
          QoS. Often referred to as a Broadband Network Gateway (BNG) or
          Broadband Remote Access Server (BRAS). A detailed definition of the
          NAS is given in <a class='info' href='#RFC2881'>[RFC2881]<span> (</span><span class='info'>Mitton, D. and M. Beadles, &ldquo;Network Access Server Requirements Next Generation (NASREQNG) NAS Model,&rdquo; July&nbsp;2000.</span><span>)</span></a>.
</li>
<li>The Home Gateway (HGW) connects the different Customer Premises
          Equipment (CPE) to the Access Node and the access network. In case
          of DSL, the HGW is a DSL Network Termination (NT) that could either
          operate as a layer 2 bridge or as a layer 3 router. In the latter
          case, such a device is also referred to as a Routing Gateway
          (RG).
</li>
<li>Referring to the DSL network architecture depicted in <a class='info' href='#Fig1'>Figure&nbsp;1<span> (</span><span class='info'>DSL Network Architecture</span><span>)</span></a>, PPP (via PPPoA <a class='info' href='#RFC2364'>[RFC2364]<span> (</span><span class='info'>Gross, G., Kaycee, M., Lin, A., Malis, A., and J. Stephens, &ldquo;PPP Over AAL5,&rdquo; July&nbsp;1998.</span><span>)</span></a>
          or PPPoE <a class='info' href='#RFC2516'>[RFC2516]<span> (</span><span class='info'>Mamakos, L., Lidl, K., Evarts, J., Carrel, D., Simone, D., and R. Wheeler, &ldquo;A Method for Transmitting PPP Over Ethernet (PPPoE),&rdquo; February&nbsp;1999.</span><span>)</span></a>) operates over the DSL
          Access Network between the NAS and a device behind the HGW, or
          between the NAS and the HGW itself. The DHCP Client resides either
          on a home network device or the HGW, and the DHCP Server protocol
          state machine may reside fully on the NAS. The NAS obtains
          per-subscriber client configuration information either locally,
          relayed from a DHCP server or from the AAA infrastructure (which
          itself may consult external DHCP servers if necessary) after
          authentication is successfully completed.
</li>
</ul>

<a name="Applicability"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Applicability Statement</h3>

<p>The primary target for this extension is for DSL service provider
      networks where PPP is being phased out to be replaced by native IP and
      DHCP, or where new devices are being added which will not utilize PPP.
      Very specific assumptions have been made with respect to the security
      model, operational methods, and integration requirements for existing
      AAA mechanisms during the design. It is understood that this mechanism
      may not be generally applicable in this form for all network
      environments where DHCP is deployed, though perhaps elements of it may
      be used to develop a more generic approach while still meeting the
      specific requirements set out by the DSL network architecture. For
      example, it is conceivable that EAP <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> could
      be carried in order to provide a more extensible and secure set of
      authentication methods.
</p>
<a name="Protocol"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Protocol Operation Alternatives</h3>

<p>In this draft two alternatives for the protocol operation are offered
      for consideration. The first in the section <a class='info' href='#Protocol-Existing'>Protocol Operation with Existing
      Messages<span> (</span><span class='info'>Protocol Operation with Existing Messages</span><span>)</span></a>, uses the existing message set, with small liberties
      taken on behavior. It has the downside that reverse authentication and
      other authentication protocols like EAP are not possible in the
      constraints. The second in the section <a class='info' href='#Protocol-New'>Protocol Operation with New Messages<span> (</span><span class='info'>Protocol Operation with DHCPEAP MessageType</span><span>)</span></a>,
      extends the existing message set and should be read coupled with the
      section on <a class='info' href='#New-Messages'>Messages for
      operation choice with new messages<span> (</span><span class='info'>Message for EAP operation</span><span>)</span></a>. This alternative has the
      downside of requiring a new message type.
</p>
<p>Both of these alternatives use new DHCP options, they both use <a class='info' href='#DHCP-Auth-Proto'>DHCP Authentication Protocol Option<span> (</span><span class='info'>DHCP Authentication Protocol Option</span><span>)</span></a> from the client in the
      DHCPDISCOVER to specify which authentication the client supports.
</p>
<p>Additionally alternative 1 uses <a class='info' href='#CHAP-Auth-Data'>CHAP Authentication Data Option<span> (</span><span class='info'>CHAP Authentication Data Option</span><span>)</span></a> to carry CHAP challenge and response
      data.
</p>
<p>Alternative 2 uses <a class='info' href='#EAP-Auth-Data'>EAP-Message Option<span> (</span><span class='info'>EAP-Message Option</span><span>)</span></a> to carry EAP messages.
</p>
<a name="Protocol-Existing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Protocol Operation with Existing Messages</h3>

<p>In order to integrate with RADIUS CHAP, it is necessary to send a
        CHAP Challenge to the DHCP Client, hash that Challenge along with an
        Identifier (ID), Name, and Secret, and return the result in a CHAP
        Response to the NAS. The NAS, in turn, must send the CHAP Name, ID,
        Challenge and Response to the RADIUS server to verify the credentials.
        The Secret is never sent in the clear, and is known only to the AAA
        server and DHCP Client. The Client's configuration information (IP
        address, etc) is typically returned in a successful response from the
        AAA server, which is used to construct the DHCP OFFER. A typical
        message flow for the NAS allocating address or AAA server allocating
        address proceeds as shown in <a class='info' href='#Fig2'>Figure&nbsp;2<span> (</span><span class='info'>Message Flow for CHAP and NAS as server</span><span>)</span></a>: <br /><hr class="insert" />
<a name="Fig2"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
    (HGW)                (NAS)                   (AAA)
 DHCP Client          DHCP Server/            RADIUS Server
                      AAA Client

DHCPDISCOVER -------&gt;
(w/DHCP-auth-proto chap)

             &lt;------- DHCPOFFER
                      (w/CHAP Challenge, Name)

DHCPREQUEST -------&gt;
(w/CHAP Response, Name, ID)

                      RADIUS Access-Request -------&gt;
                      (w/CHAP Name, ID, Challenge,
                       Response)

                                            &lt;-------- RADIUS
                                               Access-Accept
                                              (Access-Reject
                                             if unsuccessful)

             &lt;------- DHCPACK
                      (w/yiaddr)

or
            &lt;------- DHCPNAK
                     (w/CHAP Failure if unsuccessful)

</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Message Flow for CHAP and NAS as server&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 It is necessary to "restart" the state machine via the
        DHCPNAK with CHAP Failure option if the Access-Reject is received.

<p>The message flow with the NAS as a relay proceeds as shown in <a class='info' href='#Fig3'>Figure&nbsp;3<span> (</span><span class='info'>Message Flow for CHAP and NAS as relay</span><span>)</span></a>: <br /><hr class="insert" />
<a name="Fig3"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
    (HGW)                (NAS)                (AAA)           (DHCP)
 DHCP Client           AAA Client        RADIUS Server   DHCP Server


DHCPDISCOVER -------&gt;
(w/DHCP-auth-proto chap)

                      DHCPDISCOVER ------------------------------&gt;
                      (w/DHCP-auth-proto chap)

                           &lt;------------------------------ DHCPOFFER

             &lt;------- DHCPOFFER
                      (w/CHAP Challenge, Name)

DHCPREQUEST -------&gt;
(w/CHAP Response, Name, ID)

                      RADIUS Access-Request -------&gt;
                      (w/CHAP Name, ID, Challenge,
                       Response)

                                            &lt;-------- RADIUS
                                               Access-Accept
                                              (Access-Reject
                                             if unsuccessful)
                      DHCPREQUEST ------------------------------&gt;
                      (w/RADIUS attributes suboption)

             &lt;------- DHCPACK
                      (w/yiaddr)

or
             &lt;------- DHCPNAK
                      (w/CHAP Failure if unsuccessful)

</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: Message Flow for CHAP and NAS as relay&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
When the DHCP relay agent receives a DHCP message from the
        client, it MAY append a DHCP Relay Agent Information option containing
        the RADIUS Attributes suboption, along with any other suboptions it is
        configured to supply. The RADIUS Attributes suboption is defined in
        <a class='info' href='#RFC4014'>[RFC4014]<span> (</span><span class='info'>Droms, R. and J. Schnizlein, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option,&rdquo; February&nbsp;2005.</span><span>)</span></a>

<p>Note that the configuration information like IP address is not in
        the DHCPOFFER but only in the DHCPACK.
</p>
<p>This alternative uses two new DHCP options:</p>
<ul class="text">
<li><a class='info' href='#DHCP-Auth-Proto'>DHCP Authentication Protocol Option<span> (</span><span class='info'>DHCP Authentication Protocol Option</span><span>)</span></a> in the
            DHCPDISCOVER to specify the type of authentication exchange.
</li>
<li><a class='info' href='#CHAP-Auth-Data'>CHAP Authentication Data Option<span> (</span><span class='info'>CHAP Authentication Data Option</span><span>)</span></a> to carry
            the CHAP Challenge and Response in the DHCPOFFER and DHCPREQUEST
            respectively.
</li>
</ul>

<a name="Protocol-New"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Protocol Operation with DHCPEAP MessageType</h3>

<p>It is desirable that user/node authentication occurs before the
        assignment of an IP address and, further, that the assignment of the
        address depend upon details of the successful authentication. DHCP
        <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> is widely used as an address assignment
        method (among other things); EAP <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> has
        been widely adapted for authentication purposes, especially in those
        types of networks where DHCP is also used. It seems to make some
        sense, then, to combine the two in order to provide both strong
        authentication and authenticated address assignment in an efficient
        manner.
</p>
<p>This alternative has the advantage that it supports authentication
        methods other than CHAP and allows mutual authentication. A new DHCP
        message, DHCPEAP is used to support the new EAP phase which occurs
        before a DHCPOFFER is sent by the Server.
</p>
<p>This message is used to integrate authentication methods supported
        by EAP, including CHAP and any other "in the clear" password
        mechanisms (for example, to support One-Time-Password mechanisms), or
        to carry other EAP methods. EAP is widely used in other environments,
        outside of DSL Broadband, including 802.11 "Wi-Fi" access networks but
        could be used in future DSL Broadband deployments.
</p>
<p>The message following this exchange is a DHCP Offer, sent unchanged
        by the Server. A typical message flow proceeds as shown in <a class='info' href='#Fig4'>Figure&nbsp;4<span> (</span><span class='info'>Message Flow with DHCPEAP message</span><span>)</span></a>: <br /><hr class="insert" />
<a name="Fig4"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
    (HGW)                (NAS)                   (AAA)
 DHCP Client          DHCP Server/            RADIUS Server

DHCPDISCOVER -------&gt;
(w/DHCP-auth-proto EAP)

             &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)

                                            &lt;-------- RADIUS
                                Access-Accept (w/EAP Message)
                               (Access-Reject (w/EAP Message)
                                             if unsuccessful)

           (DHCP messages continue normally from
           this point forward if successful)

             &lt;------- DHCPOFFER (w/EAP Success Message)
                      (w/yiaddr)

DHCPREQUEST  -------&gt;

             &lt;------- DHCPACK</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: Message Flow with DHCPEAP message&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
The retransmittion is handled by EAP as per Section 4.1 in
        <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>.

<p>The message exchange presented in the figure offers simple one-way
        user authentication, e.g. the Server verifies the credentials of the
        HGW Client. The client indicates the ability to have an EAP exchange
        and the NAS (which take the EAP authenticator role) initiates the
        first EAP request to the DHCP Client (which takes the EAP supplicant
        role). Although the transport is unidirectional with EAP requests
        always coming from the NAS a method, the messages can be repeated
        until the EAP method completes, this allows a method like EAP-TLS in
        <a class='info' href='#RFC2716'>[RFC2716]<span> (</span><span class='info'>Aboba, B. and D. Simon, &ldquo;PPP EAP TLS Authentication Protocol,&rdquo; October&nbsp;1999.</span><span>)</span></a> which can provide mutual
        authentication.
</p>
<p>The identity hint information from <a class='info' href='#RFC4284'>[RFC4284]<span> (</span><span class='info'>Adrangi, F., Lortz, V., Bari, F., and P. Eronen, &ldquo;Identity Selection Hints for the Extensible Authentication Protocol (EAP),&rdquo; January&nbsp;2006.</span><span>)</span></a>
        may be sent inside an EAP-Request/Identity before the authentication
        conversation begins. This allows replacement of PPPoE scenarios where
        PPPoE server responds with a PPPoE Active Discovery Offer (PADO)
        packet that advertises a list of available services.
</p>
<p>The message following this exchange is a DHCP Offer, sent unchanged
        by the Server. A typical message flow proceeds as shown in <a class='info' href='#Fig5'>Figure&nbsp;5<span> (</span><span class='info'>Message Flow with new message and a DHCP relay</span><span>)</span></a>: <br /><hr class="insert" />
<a name="Fig5"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
    (HGW)                (NAS)                (AAA)           (DHCP)
 DHCP Client           AAA Client        RADIUS Server   DHCP Server
                      AAA Client

DHCPDISCOVER -------&gt;
(w/DHCP-auth-proto EAP)

             &lt;------- DHCPEAP
                      (w/EAP Message)

DHCPEAP -------&gt;
(w/EAP Message)

                      RADIUS Access-Request -------&gt;
                      (w/EAP Message)

                                            &lt;-------- RADIUS
                                Access-Accept (w/EAP Message)
                               (Access-Reject (w/EAP Message)
                                             if unsuccessful)

           (DHCP messages continue normally from
           this point forward if successful)
                      DHCPDISCOVER ------------------------------&gt;
                      (w/RADIUS attributes suboption)

                           &lt;----------------------------- DHCPOFFER

             &lt;------- DHCPOFFER (w/EAP Success Message)
                      (w/yiaddr)

DHCPREQUEST  -------&gt;

             &lt;------- DHCPACK</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: Message Flow with new message and a DHCP relay&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
The DHCP relay agent receives a DHCP message from the
        client, it MAY append a DHCP Relay Agent Information option containing
        the RADIUS Attributes suboption, along with any other suboptions it is
        configured to supply. The RADIUS Attributes suboption is defined in
        <a class='info' href='#RFC4014'>[RFC4014]<span> (</span><span class='info'>Droms, R. and J. Schnizlein, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option,&rdquo; February&nbsp;2005.</span><span>)</span></a>

<p>This alternative uses two DHCP options:</p>
<ul class="text">
<li><a class='info' href='#DHCP-Auth-Proto'>DHCP Authentication Protocol Option<span> (</span><span class='info'>DHCP Authentication Protocol Option</span><span>)</span></a> in the
            DHCPDISCOVER to specify the type of authentication exchange.
</li>
<li><a class='info' href='#EAP-Auth-Data'>EAP-Message Option<span> (</span><span class='info'>EAP-Message Option</span><span>)</span></a> to carry
            the EAP data in the DHCPEAP message.
</li>
</ul>

<a name="DHCP-Options"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
DHCP Options</h3>

<p>Three new DHCP Options are defined in this section. The first <a class='info' href='#DHCP-Auth-Proto'>DHCP Authentication Protocol Option<span> (</span><span class='info'>DHCP Authentication Protocol Option</span><span>)</span></a> is originated from the
      client in the DHCPDISCOVER to specify which authentication the client
      supports.
</p>
<p><a class='info' href='#CHAP-Auth-Data'>CHAP Authentication Data Option<span> (</span><span class='info'>CHAP Authentication Data Option</span><span>)</span></a> to carry CHAP
      challenge and response data. This is modelled strictly on PPP CHAP <a class='info' href='#RFC1994'>[RFC1994]<span> (</span><span class='info'>Simpson, W., &ldquo;PPP Challenge Handshake Authentication Protocol (CHAP),&rdquo; August&nbsp;1996.</span><span>)</span></a> with text lifted liberally from its
      specification.
</p>
<p><a class='info' href='#Protocol-New'>Protocol Operation with DHCPEAP MessageType<span> (</span><span class='info'>Protocol Operation with DHCPEAP MessageType</span><span>)</span></a> uses <a class='info' href='#EAP-Auth-Data'>EAP-Message Option<span> (</span><span class='info'>EAP-Message Option</span><span>)</span></a> to carry EAP messages.
</p>
<a name="DHCP-Auth-Proto"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
DHCP Authentication Protocol Option</h3>

<p>The following diagram defines the format of the DHCPAUTH-Protocol
        option, which is sent from the DHCP Client to the DHCP Server to
        indicate the authentication algorithm the client prefers. This option
        MUST be sent in the DHCPDISCOVER if the Client supports DHCP
        Authentication. <br /><hr class="insert" />
<a name="Fig6"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   DHCP Code   |    Length     |     Authentication-Protocol   |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Algorithm   |
+-+-+-+-+-+-+-+-+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: DHCP Authentication Protocol Option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 
<blockquote class="text">
<p>DHCP Code: TBA-1 (DHCPAUTH-Protocol)
</p>
<p>Length: 3
</p>
<p>Authentication-Protocol </p>
<blockquote class="text">
<p>C223 (HEX) for Challenge-Handshake Authentication
                Protocol.
</p>
<p>C227 (HEX) for Extensible Authentication Protocol (EAP)
</p>
</blockquote>

<p>Algorithm </p>
<blockquote class="text">
<p>The Algorithm field is one octet and indicates the
                authentication method to be used with CHAP.
</p>
<p>5 CHAP with MD5
</p>
</blockquote>

</blockquote>

<a name="CHAP-Auth-Data"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
CHAP Authentication Data Option</h3>

<p>This option is used between the Client and DHCP Server to exchange
        CHAP authentication Data in OFFER, REQUEST and NAK messages. This is
        used in <a class='info' href='#Protocol-Existing'>Section&nbsp;5.1<span> (</span><span class='info'>Protocol Operation with Existing Messages</span><span>)</span></a>.<br /><hr class="insert" />
<a name="Fig7"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   DHCP Code   |  Length     |  CHAP Code   |   Identifier     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Data ....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;7: CHAP Authentication Data Option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 
<blockquote class="text">
<p>DHCP Code: TBA-2 (DHCPAUTH-Data)
</p>
<p>CHAP Code </p>
<blockquote class="text">
<p>The Code field is one octet and identifies the type of CHAP
                option and format of data that follow. CHAP Codes are assigned
                as follows:
</p>
<p>1 Challenge
</p>
<p>2 Response
</p>
<p>3 Success
</p>
<p>4 Failure
</p>
</blockquote>

<p>Identifier </p>
<blockquote class="text">
<p>The Identifier field is one octet and aids in matching
                challenges, responses and replies.
</p>
</blockquote>

<p>Length </p>
<blockquote class="text">
<p>The Length field is one octet and indicates the length of
                the Data plus 2 (the length of CHAP Code plus Identifier).
</p>
</blockquote>

<p>Data </p>
<blockquote class="text">
<p>The Data field is zero or more octets. The format of the
                Data field is determined by the CHAP Code field.
</p>
</blockquote>

</blockquote>

<a name="Chllng-Rsp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.1"></a><h3>6.2.1.&nbsp;
Challenge and Response</h3>

<p>A summary of the Challenge and Response packet format is shown
          below. The DHCP Code and Length are described above and repeated
          here only for reference. <br /><hr class="insert" />
<a name="Fig8"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   DHCP Code   |  Length     |  CHAP Code   |   Identifier     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Value-Size   |  Value ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Name ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;8: Challenge and Response&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 
<blockquote class="text">
<p>CHAP Code </p>
<blockquote class="text">
<p>1 for Challenge;
</p>
<p>2 for Response.
</p>
</blockquote>

<p>Identifier </p>
<blockquote class="text">
<p>The Identifier field is one octet. The Identifier field
                  MUST be changed each time a Challenge is sent.
</p>
<p>The Response Identifier MUST be copied from the
                  Identifier field of the Challenge which caused the
                  Response.
</p>
</blockquote>

<p>Value-Size </p>
<blockquote class="text">
<p>This field is one octet and indicates the length of the
                  Value field.
</p>
</blockquote>

<p>Value </p>
<blockquote class="text">
<p>The Value field is one or more octets.
</p>
<p>The Challenge Value is a variable stream of octets. The
                  importance of the uniqueness of the Challenge Value and its
                  relationship to the secret is described above. The Challenge
                  Value MUST be changed each time a Challenge is sent. The
                  length of the Challenge Value depends upon the method used
                  to generate the octets, and is independent of the hash
                  algorithm used.
</p>
<p>The Response Value is the one-way hash calculated over a
                  stream of octets consisting of the Identifier, followed by
                  (concatenated with) the "secret", followed by (concatenated
                  with) the Challenge Value. The length of the Response Value
                  depends upon the hash algorithm used.
</p>
</blockquote>

<p>Name </p>
<blockquote class="text">
<p>The Name field is one or more octets representing the
                  identification of the system transmitting the packet. There
                  are no limitations on the content of this field. For
                  example, it MAY contain ASCII character strings or globally
                  unique identifiers in ASN.1 syntax. The Name should not be
                  NUL or CR/LF terminated. The size is determined from the
                  Length and Value-Size fields.
</p>
</blockquote>

</blockquote>

<a name="Succ-fail"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2.2"></a><h3>6.2.2.&nbsp;
Success and Failure</h3>

<p>If Authentication is successful, the DHCP Server SHOULD transmit
          the subsequent DHCPACK including a DHCPAUTH-Data Option with the
          CHAP Code set to 3 (Success) and the configuration Options.
</p>
<p>If Authentication is unsuccessful, the DHCP Server SHOULD
          transmit a DHCPNAK including a DHCPAUTH-Data Option with the CHAP
          Code set to 4 (Failure).
</p>
<p>A summary of the Success and Failure packet format is shown
          below. The DHCP Code and Length are described above and repeated
          here only for reference. <br /><hr class="insert" />
<a name="Fig9"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   DHCP Code   |  Length     |  CHAP Code   |   Identifier     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Message....
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;9: Success and Failure&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 
<blockquote class="text">
<p>Code </p>
<blockquote class="text">
<p>3 for Success;
</p>
<p>4 for Failure.
</p>
</blockquote>

<p>Identifier </p>
<blockquote class="text">
<p>The Identifier field is one octet and aids in matching
                  requests and replies. The Identifier field MUST be copied
                  from the Identifier field of the Response which caused this
                  reply.
</p>
</blockquote>

</blockquote>

<a name="EAP-Auth-Data"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
EAP-Message Option</h3>

<p>The format of the EAP-Message option used in <a class='info' href='#Protocol-New'>Protocol Operation with DHCPEAP MessageType<span> (</span><span class='info'>Protocol Operation with DHCPEAP MessageType</span><span>)</span></a> is as follows:<br /><hr class="insert" />
<a name="Fig10"></a>

<p style='text-align: center'>
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   DHCP Code   |  Length     |  m...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

</pre></div>
<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;10: EAP-Message Option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />
 The maximum size of a DHCP option is 255 octets. While in
        some cases (e.g., EAP MD5-Challenge <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a>) a
        complete EAP message may fit in a single DHCP option, in general this
        is not the case. If an EAP message is too large to fit into a single
        DHCP option, the method defined in <a class='info' href='#RFC3396'>[RFC3396]<span> (</span><span class='info'>Lemon, T. and S. Cheshire, &ldquo;Encoding Long Options in the Dynamic Host Configuration Protocol (DHCPv4),&rdquo; November&nbsp;2002.</span><span>)</span></a> MUST
        be used to split the EAP message into separate options for
        transmission. Similarly, EAP assumes a minimum MTU of 1020 octets
        while the minimum DHCP packet size is 576 octets, including 312 octets
        reserved for options. A DHCP client including the EAP-Message option
        SHOULD also include the 'maximum DHCP message size' option <a class='info' href='#RFC2132'>[RFC2132]<span> (</span><span class='info'>Alexander, S. and R. Droms, &ldquo;DHCP Options and BOOTP Vendor Extensions,&rdquo; March&nbsp;1997.</span><span>)</span></a> to set a suitable DHCP message size.

<p>If a DHCP message is received containing more than one EAP-Message
        option, the method defined in <a class='info' href='#RFC3396'>[RFC3396]<span> (</span><span class='info'>Lemon, T. and S. Cheshire, &ldquo;Encoding Long Options in the Dynamic Host Configuration Protocol (DHCPv4),&rdquo; November&nbsp;2002.</span><span>)</span></a> MUST be
        used to reassemble the separate options into the original EAP message.
        A DHCP server receiving an EAP message MAY forward it via a AAA
        protocol (such as RADIUS <a class='info' href='#RFC2865'>[RFC2865]<span> (</span><span class='info'>Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;Remote Authentication Dial In User Service (RADIUS),&rdquo; June&nbsp;2000.</span><span>)</span></a> <a class='info' href='#RFC3579'>[RFC3579]<span> (</span><span class='info'>Aboba, B. and P. Calhoun, &ldquo;RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP),&rdquo; September&nbsp;2003.</span><span>)</span></a> or Diameter <a class='info' href='#RFC3588'>[RFC3588]<span> (</span><span class='info'>Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;Diameter Base Protocol,&rdquo; September&nbsp;2003.</span><span>)</span></a>]
        <a class='info' href='#RFC4072'>[RFC4072]<span> (</span><span class='info'>Eronen, P., Hiller, T., and G. Zorn, &ldquo;Diameter Extensible Authentication Protocol (EAP) Application,&rdquo; August&nbsp;2005.</span><span>)</span></a>).
</p>
<a name="Compatibility"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Compatibility Considerations</h3>

<p>This section is aimed at describing interoperability scenarios
      involving HGW and NAS with or without DHCP Authentication mechanism
      support in order to analyze compatibility issues that could be faced
      between newer and older products during the introduction of the DHCP
      Authentication functionally in current implemented network
      environments.
</p>
<p>Scenario 1: Both HGW and NAS do not support DHCP Authentication
</p>
<p>In this case the authentication process does not start, thus
      traditional DHCP message flow applies.
</p>
<p>Scenario 2: HGW does not support DHCP Authentication and NAS supports
      DHCP Authentication
</p>
<p>In this case the DHCP client does not start DHCP Authentication
      transaction, NAS MAY decide to respond to HGW without using DHCP
      Authentication, falling back to traditional DHCP message flow and
      assigning different network resources.
</p>
<p>Scenario 3: HGW supports the DHCP Authentication and NAS does not
      support DHCP Authentication.
</p>
<p>In this case the DHCP client inserts in the DHCPDISCOVER message sent
      to NAS, the DHCP Authentication Protocol Option described in the draft
      in order to communicate the NAS that it is able to perform
      authentication and for indicating the authentication algorithm preferred
      by the client. NAS on receiving a DHCPDISCOVER with unknown option
      silently discards unknown message. Alternatively NAS MAY ignore the
      unknown option, but still process the message and then reply to the DHCP
      client with traditional response. The HGW, that has upgraded software,
      realizes that the NAS does not support DHCP Authentication and can
      reverts back to normal DHCP message flow.
</p>
<p>Scenario 4 Both HGW and NAS support DHCP Authentication
</p>
<p>In this case DHCP client inserts in the DHCPDISCOVER message sent to
      NAS, the DHCP Authentication Protocol Option in order to communicate the
      NAS that it is able to perform authentication and for indicating the
      authentication algorithm preferred by the client, NAS replies according
      to the message flow described in this draft.
</p>
<p>The following table summarizes the behavior in the 4 described
      scenarios:
</p><br /><hr class="insert" />
<a name="Table"></a>

<p style='text-align: center'>
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">DHCP Auth support on HGW</th><th align="left">DHCP Auth support on NAS</th><th align="left">Result</th></tr>
<tr>
<td align="left">without support</td>
<td align="left">without support</td>
<td align="left">No Authentication</td>
</tr>
<tr>
<td align="left">without support</td>
<td align="left">with support</td>
<td align="left">Client does not start auth, thus no authentication transaction</td>
</tr>
<tr>
<td align="left">with support</td>
<td align="left">without support</td>
<td align="left">NAS silently discards unknown message/option</td>
</tr>
<tr>
<td align="left">with support</td>
<td align="left">with support</td>
<td align="left">Draft works as outlined</td>
</tr>
</table>
<br clear="all" />

<p style='text-align: center'>
</p><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Compatibility Scenarios&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.1"></a><h3>8.1.&nbsp;
On Mutual Authentication</h3>

<p>The DHCP authentication mechanism described is optimal in catering
        to a unilateral authentication of the client by the NAS, with the
        authentication based on a one-way hash algorithm used in CHAP. In
        general, it claims to be no better than the existing security offered
        by PPPoE <a class='info' href='#RFC2516'>[RFC2516]<span> (</span><span class='info'>Mamakos, L., Lidl, K., Evarts, J., Carrel, D., Simone, D., and R. Wheeler, &ldquo;A Method for Transmitting PPP Over Ethernet (PPPoE),&rdquo; February&nbsp;1999.</span><span>)</span></a>. Given the assumption that the
        DSL Aggregation Network is trusted, and that direct Layer 2
        subscriber-subscriber communication is restricted to only occur via
        the NAS. The CHAP alternative makes no attempt at protecting from "man
        in the middle" attacks. However, unlike with PPP, IP DHCP packets
        including DHCPAUTH messages may be freely routed across multiple IP
        hops. It is thus conceivable that a remote rogue user may try to
        exploit known hash weaknesses to derive the secret key of another user
        through the use of a brute force attack. To keep the relative security
        equivalent in threat to today's PPPoE environment, the DHCPAUTH
        traffic must be constrained by the access network. The simplest
        mechanism for doing this is by blocking any DHCP traffic from
        traversing the NAS. In common DSL deployments the access-node provides
        protection against direct communication between HGW at Layer 2 as well
        as IP/MAC address spoofing based on snooped DHCP messages sent to the
        HGW client from the NAS.
</p>
<p>The vast majority of PPPoE and PPPoA wire-line deployments utilize
        one-way authentication. The mechanism defined in <a class='info' href='#Protocol-Existing'>Protocol Operation with Existing Messages<span> (</span><span class='info'>Protocol Operation with Existing Messages</span><span>)</span></a> is strictly one-way. Mutual
        authentication is possible with the mechanism in <a class='info' href='#Protocol-New'>Protocol Operation with DHCPEAP MessageType<span> (</span><span class='info'>Protocol Operation with DHCPEAP MessageType</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8.2"></a><h3>8.2.&nbsp;
Message Authentication </h3>

<p>RFC 3118 provides a mechanism to cryptographically protect DHCP
        messages using a key, K, shared between a DHCP client and Server,
        however no mechanism is defined to manage these keys. Authentication
        exchanges based on EAP have been built into authentication portions of
        network access protocols such as PPP, 802.1X, PANA, IKEv2, and now
        DHCP. EAP methods may provide for the derivation of shared key
        material, the MSK and the EMSK, on the EAP peer and EAP server. This
        dynamic key generation enables <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a>
        protection and allows modes of operation where messages are protected
        from DHCP client to DHCP relay which previously would be difficult to
        manage.
</p>
<p>A seperate draft by Joe Saloway and Ric Pruss describes how to
        derive the key, K, from the EMSK resulting from an EAP exchange and it
        looks at how this mechnasim interacts with the DHCP authentication or
        any EAP authentication prior to DHCP.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
IANA Considerations</h3>

<p>This specification requires three values to be assigned by IANA.
</p>
<p>Two are "BOOTP Vendor Extensions and DHCP Options" </p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>TBA-1:</dt>
<dd>(DHCPAUTH-Protocol)
</dd>
<dt>TBA-2:</dt>
<dd>(DHCPAUTH-Data)
</dd>
</dl></blockquote>

</blockquote><p>One is a DHCP Message Type 53 Values - per [RFC2132], for
      DHCPEAP message type.
</p>
<a name="New-Messages"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Message for EAP operation</h3>

<p>The DHCPEAP messages follow the format for DHCP messages defined in
      <a class='info' href='#RFC2131'>RFC 2131<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2131]. This new message is identified
      by the presence of a DHCP Message Type option, which encodes DHCPEAP
      message type. Other fields in the DHCP message header, such as siaddr
      and fname, are left unused.
</p>
<p>The authentication data in a DHCPAUTH message is carried in a
      EAP-Messsage option <a class='info' href='#EAP-Auth-Data'>EAP-Message Option<span> (</span><span class='info'>EAP-Message Option</span><span>)</span></a>.
</p>
<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
Acknowledgements</h3>

<p>Many thanks to Carlos Pignataro for help editing this document.
</p>
<p>Thanks to Wojciech Dec, Eric Voit, Mark Townsley and Ralph Droms for
      help with this document.
</p>
<p>Thanks to Amy Zhao for her draft on DHCP Authentication and helping
      with laying the ground for this document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.12"></a><h3>12.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1994">[RFC1994]</a></td>
<td class="author-text"><a href="mailto:wsimpson@GreenDragon.com">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1994">PPP Challenge Handshake Authentication Protocol (CHAP)</a>,&rdquo; RFC&nbsp;1994, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1994.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>12.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-bfd-base">[I-D.ietf-bfd-base]</a></td>
<td class="author-text">Katz, D. and D. Ward, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-base-11.txt">Bidirectional Forwarding Detection</a>,&rdquo; draft-ietf-bfd-base-11 (work in progress), January&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-bfd-base-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0792">[RFC0792]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc792">Internet Control Message Protocol</a>,&rdquo; STD&nbsp;5, RFC&nbsp;792, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc792.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1433">[RFC1433]</a></td>
<td class="author-text"><a href="mailto:jwg@garage.att.com">Garrett, J.</a>, <a href="mailto:Hagan@UPENN.EDU">Hagan, J.</a>, and <a href="mailto:jwong@garage.att.com">J. Wong</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1433">Directed ARP</a>,&rdquo; RFC&nbsp;1433, March&nbsp;1993 (<a href="http://www.rfc-editor.org/rfc/rfc1433.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1661">[RFC1661]</a></td>
<td class="author-text"><a href="mailto:Bill.Simpson@um.cc.umich.edu">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1661">The Point-to-Point Protocol (PPP)</a>,&rdquo; STD&nbsp;51, RFC&nbsp;1661, July&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1661.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1990">[RFC1990]</a></td>
<td class="author-text"><a href="mailto:sklower@CS.Berkeley.EDU">Sklower, K.</a>, <a href="mailto:brian@lloyd.com">Lloyd, B.</a>, <a href="mailto:glenn@lloyd.com">McGregor, G.</a>, <a href="mailto:dcarr@Newbridge.COM">Carr, D.</a>, and <a href="mailto:70761.1664@compuserve.com">T. Coradetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1990">The PPP Multilink Protocol (MP)</a>,&rdquo; RFC&nbsp;1990, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1990.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2131">[RFC2131]</a></td>
<td class="author-text"><a href="mailto:droms@bucknell.edu">Droms, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>,&rdquo; RFC&nbsp;2131, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2131.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2131.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2131.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2132">[RFC2132]</a></td>
<td class="author-text"><a href="mailto:sca@engr.sgi.com">Alexander, S.</a> and <a href="mailto:droms@bucknell.edu">R. Droms</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2132">DHCP Options and BOOTP Vendor Extensions</a>,&rdquo; RFC&nbsp;2132, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2132.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2132.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2132.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2364">[RFC2364]</a></td>
<td class="author-text"><a href="mailto:gmgross@lucent.com">Gross, G.</a>, <a href="mailto:mjk@nj.paradyne.com">Kaycee, M.</a>, <a href="mailto:alin@shastanets.com">Lin, A.</a>, <a href="mailto:malis@ascend.com">Malis, A.</a>, and <a href="mailto:john@cayman.com">J. Stephens</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2364">PPP Over AAL5</a>,&rdquo; RFC&nbsp;2364, July&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2364.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2364.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2364.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2516">[RFC2516]</a></td>
<td class="author-text"><a href="mailto:louie@uu.net">Mamakos, L.</a>, <a href="mailto:lidl@uu.net">Lidl, K.</a>, <a href="mailto:jde@uu.net">Evarts, J.</a>, <a href="mailto:carrel@RedBack.net">Carrel, D.</a>, <a href="mailto:dan@RedBack.net">Simone, D.</a>, and <a href="mailto:ross@routerware.com">R. Wheeler</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2516">A Method for Transmitting PPP Over Ethernet (PPPoE)</a>,&rdquo; RFC&nbsp;2516, February&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2516.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2716">[RFC2716]</a></td>
<td class="author-text"><a href="mailto:bernarda@microsoft.com">Aboba, B.</a> and <a href="mailto:dansimon@microsoft.com">D. Simon</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2716">PPP EAP TLS Authentication Protocol</a>,&rdquo; RFC&nbsp;2716, October&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2716.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2865">[RFC2865]</a></td>
<td class="author-text">Rigney, C., Willens, S., Rubens, A., and W. Simpson, &ldquo;<a href="http://tools.ietf.org/html/rfc2865">Remote Authentication Dial In User Service (RADIUS)</a>,&rdquo; RFC&nbsp;2865, June&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2865.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2881">[RFC2881]</a></td>
<td class="author-text">Mitton, D. and M. Beadles, &ldquo;<a href="http://tools.ietf.org/html/rfc2881">Network Access Server Requirements Next Generation (NASREQNG) NAS Model</a>,&rdquo; RFC&nbsp;2881, July&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2881.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3046">[RFC3046]</a></td>
<td class="author-text">Patrick, M., &ldquo;<a href="http://tools.ietf.org/html/rfc3046">DHCP Relay Agent Information Option</a>,&rdquo; RFC&nbsp;3046, January&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3046.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3118">[RFC3118]</a></td>
<td class="author-text">Droms, R. and W. Arbaugh, &ldquo;<a href="http://tools.ietf.org/html/rfc3118">Authentication for DHCP Messages</a>,&rdquo; RFC&nbsp;3118, June&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3118.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3396">[RFC3396]</a></td>
<td class="author-text">Lemon, T. and S. Cheshire, &ldquo;<a href="http://tools.ietf.org/html/rfc3396">Encoding Long Options in the Dynamic Host Configuration Protocol (DHCPv4)</a>,&rdquo; RFC&nbsp;3396, November&nbsp;2002 (<a href="http://www.rfc-editor.org/rfc/rfc3396.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3579">[RFC3579]</a></td>
<td class="author-text">Aboba, B. and P. Calhoun, &ldquo;<a href="http://tools.ietf.org/html/rfc3579">RADIUS (Remote Authentication Dial In User Service) Support For Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3579, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3579.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3588">[RFC3588]</a></td>
<td class="author-text">Calhoun, P., Loughney, J., Guttman, E., Zorn, G., and J. Arkko, &ldquo;<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>,&rdquo; RFC&nbsp;3588, September&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3588.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4014">[RFC4014]</a></td>
<td class="author-text">Droms, R. and J. Schnizlein, &ldquo;<a href="http://tools.ietf.org/html/rfc4014">Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option</a>,&rdquo; RFC&nbsp;4014, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4014.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4072">[RFC4072]</a></td>
<td class="author-text">Eronen, P., Hiller, T., and G. Zorn, &ldquo;<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>,&rdquo; RFC&nbsp;4072, August&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4072.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4284">[RFC4284]</a></td>
<td class="author-text">Adrangi, F., Lortz, V., Bari, F., and P. Eronen, &ldquo;<a href="http://tools.ietf.org/html/rfc4284">Identity Selection Hints for the Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;4284, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4284.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="TR-059">[TR-059]</a></td>
<td class="author-text">DSL Forum, &ldquo;<a href="http://www.dslforum.org/techwork/tr/TR-059.pdf">DSL Evolution - Architecture Requirements for the Support of
          QoS-Enabled IP Services</a>,&rdquo; TR&nbsp;059, September&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="TR-101">[TR-101]</a></td>
<td class="author-text">DSL Forum, &ldquo;<a href="http://www.dslforum.org/techwork/tr/TR-101.pdf">Migration to Ethernet Based DSL Aggregation</a>,&rdquo; TR&nbsp;101, April&nbsp;2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="WT-146">[WT-146]</a></td>
<td class="author-text">DSL Forum, &ldquo;<a href="http://www.dslforum.org/techwork/tworkinprogress.shtml">Internet Protocol (IP) Sessions</a>,&rdquo; WT&nbsp;146 (work in progress), April&nbsp;2007.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Richard Pruss</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cisco Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">80 Albert Street</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Brisbane, Queensland  4000</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Australia</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+61 7 3238 8228</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text">+61 7 3211 3889</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ric@cisco.com">ric@cisco.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Glenn Zorn</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:glenzorn@comcast.net">glenzorn@comcast.net</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Roberta Maglione</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Telecom Italia</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Via G. Reiss Romoli 274</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Torino,   10148</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Italy</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+39 0112285007</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:roberta.maglione@telecomitalia.it">roberta.maglione@telecomitalia.it</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href=""></a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Li Yizhou</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">No. 91 Baixia Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nanjing,   210001</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86-25-84565471</td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:liyizhou@huawei.com">liyizhou@huawei.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href=""></a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
