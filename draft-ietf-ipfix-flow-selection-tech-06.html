<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Flow Selection Techniques</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Scope">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Difference between Flow Selection and Packet Selection">
<link href="#rfc.section.4" rel="Chapter" title="4 Flow selection as Function in the IPFIX Architecture">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Flow selection in the Metering Process before Aggregation">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Flow selection in the Metering Process after Aggregation">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Flow selection during the Exporting Process">
<link href="#rfc.section.4.4" rel="Chapter" title="4.4 Flow selection as a function of the IPFIX Mediator">
<link href="#rfc.section.5" rel="Chapter" title="5 Flow Selection Techniques">
<link href="#rfc.section.5.1" rel="Chapter" title="5.1 Flow Filtering">
<link href="#rfc.section.5.1.1" rel="Chapter" title="5.1.1 Property Match Filtering">
<link href="#rfc.section.5.1.2" rel="Chapter" title="5.1.2 Hash-based Flow Filtering">
<link href="#rfc.section.5.1.3" rel="Chapter" title="5.1.3 Flow State Dependent Flow Filtering">
<link href="#rfc.section.5.2" rel="Chapter" title="5.2 Flow Sampling">
<link href="#rfc.section.5.2.1" rel="Chapter" title="5.2.1 Systematic Sampling">
<link href="#rfc.section.5.2.2" rel="Chapter" title="5.2.2 Random Sampling">
<link href="#rfc.section.5.3" rel="Chapter" title="5.3 Flow-state Dependent Packet Selection">
<link href="#rfc.section.6" rel="Chapter" title="6 Information Model for Configuration of Flow Selection Techniques">
<link href="#rfc.section.6.1" rel="Chapter" title="6.1 Description of Flow Filtering Techniques">
<link href="#rfc.section.6.2" rel="Chapter" title="6.2 Description of Flow Sampling Techniques">
<link href="#rfc.section.6.3" rel="Chapter" title="6.3 Description of Flow State Dependent Packet Selection">
<link href="#rfc.section.7" rel="Chapter" title="7 Information Model for Flow Selection Reporting">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 fsFlowRecordTotalCount">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 fsFlowRecordSelectedCount">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 fsCurrentFlowEntries">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 fsMaxFlowEntries">
<link href="#rfc.section.7.5" rel="Chapter" title="7.5 fsFlowEntryTotalCount">
<link href="#rfc.section.7.6" rel="Chapter" title="7.6 fsFlowEntrySelectedCount">
<link href="#rfc.section.7.7" rel="Chapter" title="7.7 fsPacketTotalCount">
<link href="#rfc.section.7.8" rel="Chapter" title="7.8 fsFlowEntrySelectedCount">
<link href="#rfc.section.7.9" rel="Chapter" title="7.9 fsOctetTotalCount">
<link href="#rfc.section.7.10" rel="Chapter" title="7.10 fsOctetSelectedCount">
<link href="#rfc.section.8" rel="Chapter" title="8 IANA Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Security Considerations">
<link href="#rfc.references" rel="Chapter" title="10 References">
<link href="#rfc.references.1" rel="Chapter" title="10.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="10.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="Flow selection is the process of selecting a subset of flows from all flows observed at an observation point. Flow selection reduces the effort of post-processing flow data and transferring flow records.  This document describes motivations for flow selection and presents flow selection techniques. It provides an information model for configuring flow selection techniques and discusses what information about a flow selection process should be exported." />
  <meta name="description" content="Flow selection is the process of selecting a subset of flows from all flows observed at an observation point. Flow selection reduces the effort of post-processing flow data and transferring flow records.  This document describes motivations for flow selection and presents flow selection techniques. It provides an information model for configuring flow selection techniques and discusses what information about a flow selection process should be exported." />
  <meta name="keywords" content="" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Internet Engineering Task Force</td>
<td class="right">S. D'Antonio</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">CINI Consortium/University of Napoli "Parthenope"</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">T. Zseby</td>
</tr>
<tr>
<td class="left">Expires: November 24, 2011</td>
<td class="right">Fraunhofer Institute FOKUS</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">C. Henke</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Technische Universitat Berlin</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">L. Peluso</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">University of Napoli</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">May 23, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Flow Selection Techniques<br />
  <span class="filename">draft-ietf-ipfix-flow-selection-tech-06.txt</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>Flow selection is the process of selecting a subset of flows from all flows observed at an observation point. Flow selection reduces the effort of post-processing flow data and transferring flow records.  This document describes motivations for flow selection and presents flow selection techniques. It provides an information model for configuring flow selection techniques and discusses what information about a flow selection process should be exported.</p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">RFC 2119</a> <cite title="NONE">[RFC2119]</cite>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on November 24, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>
<p>This document may contain material from IETF Documents or IETF Contributions published or made publicly available before November 10, 2008.  The person(s) controlling the copyright in some of this material may not have granted the IETF Trust the right to allow modifications of such material outside the IETF Standards Process. Without obtaining an adequate license from the person(s) controlling the copyright in such materials, this document may not be modified outside the IETF Standards Process, and derivative works of it may not be created outside the IETF Standards Process, except to format it for publication as an RFC or to translate it into languages other than English.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Scope</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Difference between Flow Selection and Packet Selection</a>
</li>
<li>4.   <a href="#rfc.section.4">Flow selection as Function in the IPFIX Architecture</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Flow selection in the Metering Process before Aggregation</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Flow selection in the Metering Process after Aggregation</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Flow selection during the Exporting Process</a>
</li>
<li>4.4.   <a href="#rfc.section.4.4">Flow selection as a function of the IPFIX Mediator</a>
</li>
<li>5.   <a href="#rfc.section.5">Flow Selection Techniques</a>
</li>
<li>5.1.   <a href="#rfc.section.5.1">Flow Filtering</a>
</li>
<li>5.1.1.   <a href="#rfc.section.5.1.1">Property Match Filtering</a>
</li>
<li>5.1.2.   <a href="#rfc.section.5.1.2">Hash-based Flow Filtering</a>
</li>
<li>5.1.3.   <a href="#rfc.section.5.1.3">Flow State Dependent Flow Filtering</a>
</li>
<li>5.2.   <a href="#rfc.section.5.2">Flow Sampling</a>
</li>
<li>5.2.1.   <a href="#rfc.section.5.2.1">Systematic Sampling</a>
</li>
<li>5.2.2.   <a href="#rfc.section.5.2.2">Random Sampling</a>
</li>
<li>5.3.   <a href="#rfc.section.5.3">Flow-state Dependent Packet Selection</a>
</li>
<li>6.   <a href="#rfc.section.6">Information Model for Configuration of Flow Selection Techniques</a>
</li>
<li>6.1.   <a href="#rfc.section.6.1">Description of Flow Filtering Techniques</a>
</li>
<li>6.2.   <a href="#rfc.section.6.2">Description of Flow Sampling Techniques</a>
</li>
<li>6.3.   <a href="#rfc.section.6.3">Description of Flow State Dependent Packet Selection</a>
</li>
<li>7.   <a href="#rfc.section.7">Information Model for Flow Selection Reporting</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">fsFlowRecordTotalCount</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">fsFlowRecordSelectedCount</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">fsCurrentFlowEntries</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">fsMaxFlowEntries</a>
</li>
<li>7.5.   <a href="#rfc.section.7.5">fsFlowEntryTotalCount</a>
</li>
<li>7.6.   <a href="#rfc.section.7.6">fsFlowEntrySelectedCount</a>
</li>
<li>7.7.   <a href="#rfc.section.7.7">fsPacketTotalCount</a>
</li>
<li>7.8.   <a href="#rfc.section.7.8">fsFlowEntrySelectedCount</a>
</li>
<li>7.9.   <a href="#rfc.section.7.9">fsOctetTotalCount</a>
</li>
<li>7.10.   <a href="#rfc.section.7.10">fsOctetSelectedCount</a>
</li>
<li>8.   <a href="#rfc.section.8">IANA Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Security Considerations</a>
</li>
<li>10.   <a href="#rfc.references">References</a>
</li>
<li>10.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>10.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Scope</h1>
<p id="rfc.section.1.p.1">This document describes flow selection techniques for traffic measurements. A flow is defined as a set of packets with common properties as described in <a href="#RFC5101">[RFC5101]</a>.  Flow selection can be done to limit the resource demands for capturing, storing, exporting and post-processing of flow records. It also can be used to select a particular set of flows that are of interest to a specific application. This document provides a cathegorization of flow selection techniques and describes configuration and reporting parameters for them. In order to be compliant with this document, at least one of proposed flow selection schemes MUST be implemented. That means that the configuration parameters as well as the reporting information elements for this particular scheme MUST be supported.  </p>
<p id="rfc.section.1.p.2">This document also addresses configuration and reporting parameters for flow-state dependent packet selection as described in <a href="#RFC5475">[RFC5475]</a>, although the technique is categorized as packet selection. The reason is, thta flow-state dependent packet selection techniques often aim at the reduction of resources for flow capturing and flow processing. Furthermore, they were only briefly discussed in <a href="#RFC5475">[RFC5475]</a>. Therefore we included configuration and reporting considerations for such techniques in this document.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">This document is consistent with the terminology introduced in <a href="#RFC5101">[RFC5101]</a>, <a href="#RFC5470">[RFC5470]</a>, <a href="#RFC5475">[RFC5475]</a> and <a href="#RFC3917">[RFC3917]</a>.  As in <a href="#RFC5101">[RFC5101]</a> and <a href="#RFC5476">[RFC5476]</a>, the first letter of each IPFIX-specific and PSAMP-specific term is capitalized along with the flow selection specific terms defined here.</p>
<p id="rfc.section.2.p.2">* Classification </p>
<p></p>

<ul class="empty"><li>Classification is a process in which packets are mapped to specific flow records based on packet properties.  These properties make up the flow key (e.g. header information, packet content, AS number).  In case a flow record for a specific flow key already exists the flow record is updated, otherwise a new flow record is created.  </li></ul>
<p id="rfc.section.2.p.4">* Flow Selection Process</p>
<p></p>

<ul class="empty"><li>A Flow Selection Process takes classified packets, flow cache entries or flow records as its input and selects a subset of that set as its output. A Flow Selection Process MAY run on several instances within the IPFIX architecture. A Flow Selection Process MAY be part of an IPFIX metering process, exporting process or as an Intermediate Selection Process running on an IPFIX Mediator.</li></ul>
<p id="rfc.section.2.p.6">* Flow Selection State</p>
<p></p>

<ul class="empty"><li>A Flow Selection Process SHOULD maintain state information for use by the Flow Selector. At a given time, the Flow Selection State may depend on flows and packets observed at and before that time, as well as other variables. Examples include:<dl>
<dt>  (i)</dt>
<dd style="margin-left: 8">sequence number of packets and accounted flow records;</dd>
<dt>  (ii)</dt>
<dd style="margin-left: 8">number of selected flows;</dd>
<dt>  (iii)</dt>
<dd style="margin-left: 8">number of observed flows;</dd>
<dt>  (iv)</dt>
<dd style="margin-left: 8">current flow cache occupancy;</dd>
<dt>  (v)</dt>
<dd style="margin-left: 8">flow specific counters, lower und upper bounds</dd>
<dt>  (vi)</dt>
<dd style="margin-left: 8">flow selection timeout intervals</dd>
</dl>
</li></ul>
<p id="rfc.section.2.p.8">* Flow Selector</p>
<p></p>

<ul class="empty"><li>A Flow Selector defines the action of a Flow Selection Process on a single flow of its input. The Flow Selector can make use of the following information in order to establish whether a flow has to be selected or not:<dl>
<dt>  (i)</dt>
<dd style="margin-left: 8">the content of the flow record;</dd>
<dt>  (ii)</dt>
<dd style="margin-left: 8">any state information related to the metering or exporting process;</dd>
<dt>  (iii)</dt>
<dd style="margin-left: 8">any Flow Selection State that may be maintained by the Flow Selection Process.</dd>
</dl>
</li></ul>
<p id="rfc.section.2.p.10">* Complete Flow </p>
<p></p>

<ul class="empty"><li>A Complete Flow consists of all packets within the flow time-Out interval that enter the Flow Selection Process and belong to the same flow as defined by the flow definition. For this definition only packets are considered that arrive at the Flow Selection Process. That means, packets that are not observed at the Flow Selection Process because of prior packet selection or packet loss are not considered as belonging to the Complete Flow. </li></ul>
<p id="rfc.section.2.p.12">* Flow Filtering</p>
<p></p>

<ul class="empty"><li>Flow Filtering selects flows based on a deterministic function on the flow record content, flow state, external properties (e.g. ingress interface) or external events (e.g violated Access Control List). If the relevant parts of the flow record content can be already observed at packet level (e.g. flow keys from packet header fields) Flow Filtering can be performed at packet level by property match packet filtering as described in <a href="#RFC5475">[RFC5475]</a>.</li></ul>
<p id="rfc.section.2.p.14">* Flow Sampling</p>
<p></p>

<ul class="empty"><li>Flow Sampling selects flows based on flow record sequence or arrival times (e.g. position in flow cache, arrival time at exporter or mediator). The selection can be systematic (e.g. every n-th record) or based on a random functions (e.g. select each record with probability p, or randomly select n out of N records). </li></ul>
<p id="rfc.section.2.p.16">* Aggregation Process</p>
<p></p>

<ul class="empty"><li>In the IPFIX metering process the aggregation process aggregates packet data into flow data and forms the flow cache entries or flow records. After the aggregation step only the aggregated flow information is available. Information about individual packets is lost.  </li></ul>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Difference between Flow Selection and Packet Selection</h1>
<p id="rfc.section.3.p.1">Flow selection differs from packet selection described in <a href="#RFC5475">[RFC5475]</a>. Packet selection techniques consider packets as basic element and the parent population consists of all packets observed at an observation point. In contrast to this the basic elements in flow selection are the flows. The parent population consists of all observed flows and the selection process operates on the flows. The major characteristics of flow selection are the following: </p>
<p></p>

<dl>
<dt>- </dt>
<dd style="margin-left: 8">Flow selection takes flows as basic elements. For packet selection, packets are considered as basic elements.</dd>
<dt>- </dt>
<dd style="margin-left: 8">Flow selection can only take place after classification, because the classification rules determine to which flow a packet belongs. Packet selection can be applied before or after classification.</dd>
<dt>- </dt>
<dd style="margin-left: 8">Flow selection operates on complete flows. That means that after the flow selection process either all packets of the flow are kept or all packets of the flow are discarded. All packets of the flow here means all packets that enter the flow selection process. That means that if the flow selection is preceded by a packet selection process the complete flow consists only of the packets that where not discarded during the packet selection.</dd>
</dl>

<p> </p>
<p id="rfc.section.3.p.3">There are some techniques that are difficult to unambiguously categorize into one of the categories. We here give some guidance how to categorize such techniques: </p>

<dl>
<dt>- </dt>
<dd style="margin-left: 8">Techniques that can be considered as both, packet and flow selection: Some packet selection techniques result in the selection of whole flows and therefore can be considered as packet or as flow selection at the same time. An example is property match filtering of all packets to a specific destination address. If flows are defined based on destination addresses, such a packet selection also results in a flow selection and can be considered as packet or flow selection.</dd>
<dt>- </dt>
<dd style="margin-left: 8">Flow-state dependent packet selection (as described in <a href="#RFC5475">[RFC5475]</a>): There exist techniques that select packets based on the flow state, e.g. based on the number of already observed packets belonging to the flow. Examples of these techniques from the literature are  "Sample and Hold" <a href="#EsVa01">[EsVa01]</a> "Fast Filtered Sampling" <a href="#MSZC10">[MSZC10]</a> or the "Sticky Sampling" algorithm presented in <a href="#MaMo02">[MaMo02]</a>. Such techniques can be used to influence which flows are captured (e.g.  increase the selection of packets belonging to large flows) and reduce the number of flows that need to be stored in the flow cache. Nevertheless, such techniques do not necessarily select Complete Flows, because it is not ensured that all packets of a selected flow are captured. Therefore flow-state dependent packet selection methods that do not ensure that either all or no packets of a flow are selected strictly speaking have to be considered as packet selection technique and not as flow selection.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Flow selection as Function in the IPFIX Architecture</h1>
<div id="#rfc.figure.1"></div>
<div id="#flowselection"></div>
<pre>                 
                    Packet(s) coming in to Observation Point(s)
                      |                                     |
                      v                                     v
     +----------------+---------------------------+   +-----+-------+
     |          Metering Process                  |   |             |
     |                                            |   |             |
     |   packet header capturing                  |   |             |
     |        |                                   |...| Metering    |
     |   timestamping                             |   | Process N   |
     |        |                                   |   |             |
     |   packet selection                         |   |             |
     |        |                                   |   |             |
     |   classification                           |   |             |
     |        |                                   |   |             |
     |   flow state dependent packet selection    |   |             |
     |        |                                   |   |             |
     |   flow selection before aggregation (*)    |   |             |
     |        |                                   |   |             |
     |   aggregation                              |   |             |
     |        |                                   |   |             |
     |   flow selection after aggregation (*)     |   |             |
     +--------|-----------------------------------+   +-----|-------+
         Flow Records                                   Flow Records
              |                                             |
              +----------------------+----------------------+
                                     |
              +----------------------|-----------------+
              | Exporting Process    |                 |
              |                      v                 |
              |        flow selection before export(*) |        
              |                      |                 |
              |                      v                 |
              |                 flow export            |
              +----------------------+-----------------+
                                     |  IPFIX (Flow Records)
                                     v
           +-------------------------|-----------------------+
           |  IPFIX Mediator         |                       |
           |                         v                       |
           |               Collecting Process(es)            |
           |                         |                       |
           |      Intermediate Flow Selection Process (*)    |
           |                         |                       |
           |               Exporting Process(es)             |
           +-------------------------|-----------------------+
                                     v
                                   IPFIX 
                    
      (*) indicates where flow selection can take place.</pre>
<p><a href="#flowselection">Figure 1</a> shows the IPFIX reference model as defined in <a href="#RFC5470">[RFC5470]</a>, and extends it by introducing the functional components where flow selection can take place. </p>

<ol>
<li>during Metering Process before aggregation</li>
<li>during Metering Process after aggregation;</li>
<li>during Exporting Process</li>
<li>in an Intermediate Selection Process on a Mediator</li>
</ol>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Flow selection in the Metering Process before Aggregation</h1>
<p id="rfc.section.4.1.p.1">In the aggregation process the packet information is used to update the flow entries in the flow cache. Flow selection that is applied before aggregation equals a packet selection process. The flow still consists of individual packets. Those are then selected based on the classification information, i.e. based on the flow they belong to. Flow selection before aggregation can be based on the fields of the flow key (also on a hash value over these fields), but not based on characteristics that are only available after aggregation (e.g. flow size, flow duration). Flow selection before aggregation is applied to reduce resources for all succeeding processes (aggregation, exporting process) or select specific flows of interest in case such flow characteristics are already observable at packet level (e.g. flows to specific IPs).  In contrast, flow state dependent packet selection is a packet selection method, because it does not necessarily select Complete Flows. Flow selection before aggregation and flow state dependent packet selection can be applied in arbitrary order.  </p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Flow selection in the Metering Process after Aggregation</h1>
<p id="rfc.section.4.2.p.1">Flow selection after aggregation is usually applied to reduce the flows to those that are of interest to a particular application and to unload flow export and flow postprocessing. Since the flow cache entries are already generated by the aggregation process flow selection after aggregation can also depend on flow characteristics that are only visible after the aggregation of packets, such as flow size and flow duration. </p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Flow selection during the Exporting Process</h1>
<p id="rfc.section.4.3.p.1">The Exporting Process may implement policies for exporting only a subset of the flow records which have been stored in the system memory. Flow selection in the exporting process may select only the subset of flow records which are of interest to the users application, or select only as many flow records than can be handled by the available resources ( e.g. limited flow cache size and export link capacity).  </p>
<h1 id="rfc.section.4.4">
<a href="#rfc.section.4.4">4.4.</a> Flow selection as a function of the IPFIX Mediator</h1>
<p id="rfc.section.4.4.p.1">As shown in <a href="#flowselection">Figure 1</a>, flow selection can be performed as an intermediate process within an IPFIX Mediator <a href="#RFC6183">[RFC6183]</a>.  The Intermediate Selection Process takes a flow record stream as its input and retrieves a record stream.  The Intermediate Selection Process can again apply a flow selection technique to obtain flows of interest for the application. Further the Intermediate Selection Process can base its selection decision on the correlation of data from different observation points, e.g by only selecting flows that were at least recorded on two observation points.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Flow Selection Techniques</h1>
<p id="rfc.section.5.p.1">A flow selection technique selects either all packets or none of a flow, otherwise the technique has to be considered as packet selection. We distinguish between Flow Filtering and Flow Sampling.  </p>
<h1 id="rfc.section.5.1">
<a href="#rfc.section.5.1">5.1.</a> Flow Filtering</h1>
<p id="rfc.section.5.1.p.1">Flow Filtering is a deterministic function on the IPFIX flow record content. In case that the relevant flow characteristics are already observable at packet level (e.g. flow keys) Flow Filtering can be applied before aggregation at packet level.  </p>
<h1 id="rfc.section.5.1.1">
<a href="#rfc.section.5.1.1">5.1.1.</a> Property Match Filtering</h1>
<p id="rfc.section.5.1.1.p.1">Flow Filtering can be done similarly to Property Match Filtering for packet selection described in <a href="#RFC5475">[RFC5475]</a>.  The difference is that, instead of packet fields, flow record fields are here used to derive the selection decision. Property Match Filtering is typically used to select a specific subset of the flows that are of interest to a particular application (e.g. all flows to a specific destination, all large flows, etc.). Properties on which the filtering is based can be for example flow keys, the flow size in bytes, the number of packets in the flow, the observation time of the first or last packet, or the maximum packet length. The selection criteria can be a specific value or an interval. Property match filtering can be applied before aggregation in case the properties are already observable at the packet level (e.g. flow key fields).  </p>
<p id="rfc.section.5.1.1.p.2">There are content based Property Match filtering techniques that require a compution on the current flow cache. An example is the selection of the k largest flows or a percentage of flows with the longest livetime. This type of Property Match Filtering is also used in flow selection techniques that react on external events (e.g. resource constraint). For example in case the flow cache is full, the flow cache entry with the lowest flow volume per current flow live time is deleted.  </p>
<h1 id="rfc.section.5.1.2">
<a href="#rfc.section.5.1.2">5.1.2.</a> Hash-based Flow Filtering</h1>
<p id="rfc.section.5.1.2.p.1">Hash-based Flow Filtering uses a Hash Function h to map the flow key c onto a Hash Range R.  A flow is selected if the hash value h(c) is within the Hash Selection Range S, which is a subset of R. Hash-based Flow Filtering can be used to emulate a random sampling process but still enable the correlation between selected flow subset at different observation points. Hash-based Flow Filtering is similar to Hash-based Packet Selection, and in fact is identical when Hash-based Packet Selection uses the flow key that define the flow as the Hash Input.  Nevertheless there MAY be the incentive to apply Hash-based Flow Selection not on the packet level before aggregation, for example when the size of the Selection Range and therefore the sampling probability is dependent on the number of observed flows.  </p>
<h1 id="rfc.section.5.1.3">
<a href="#rfc.section.5.1.3">5.1.3.</a> Flow State Dependent Flow Filtering</h1>
<p id="rfc.section.5.1.3.p.1">Flow state dependent filtering does not base the selection decision on fields of the current flow record content but on the flow state which may be kept additionally for each of the flows. External processes may update counters, bounds and timers for each of the flow records and the flow selection process utilises this information for the selection decision. A review of flow state dependent filtering techniques that aim at the selection of the most frequent items by keeping additional flow state information can be found in <a href="#CoHa08">[CoHa08]</a>. Flow state dependent flow filtering can only be applied after aggregation, when a packet has been assigned to a flow cache. The selection process then decides based upon the flow state for each flow if it is kept in the flow cache or not.  Two flow dependent flow filtering techniques are here described: </p>
<p id="rfc.section.5.1.3.p.2">The Frequent Algorithm <a href="#KaPS03">[KaPS03]</a> is a technique that aims at the selection of all flows that at least exceed a 1/k fraction of the observed packet stream. The algorithm has only a flow cache of size k-1 and each flow in the cache has an additional counter. The counter is incremented each time a packet belonging to the flow in the flow cache is observed. In case the observed packet does not belong to any flow all counters are decremented and if any of the flow counters have a value of zero the flow is replaced with the new flow. </p>
<p id="rfc.section.5.1.3.p.3">Lossy Counting is a selection technique that identifies all flows whose packet count exceeds a certain percentage of the whole observed packet stream (e.g. 5% of all packets) with a certain estimation error e. Lossy Counting seperates the observed packet stream in windows of size N=1/e, where N is an amount of consecutive packets. For each observed flow an additional counter will be held in the flow state. The counter is incremented each time a packet belonging to the flow is observed and all counters are decremented at the end of each window and all flows with a counter of zero will be removed from the flow cache. </p>
<h1 id="rfc.section.5.2">
<a href="#rfc.section.5.2">5.2.</a> Flow Sampling</h1>
<p id="rfc.section.5.2.p.1">Flow sampling operates on flow record sequence or arrival times. It can use a systematic or a random functions for the selection process. Flow sampling usually aims at the selection of a representative subset of all flows in order to estimate characteristics of the whole set (e.g. mean flow size in the network).  </p>
<h1 id="rfc.section.5.2.1">
<a href="#rfc.section.5.2.1">5.2.1.</a> Systematic Sampling</h1>
<p id="rfc.section.5.2.1.p.1">Systematic sampling is a deterministic selection function. Systematic sampling may be a periodic selection of the k-th flow record which arrives at the exporting or mediator process. Systematic Sampling can also be applied before aggregation. An example would be to use an additional data structure that saves the flow keys of the not selected flows. Then one can create a flow cache entry for the k-th observed packet that has yet no flow cache entry and is not within the data structure containing the not selected flows.  </p>
<p id="rfc.section.5.2.1.p.2">Systematic sampling can also be time-based. Systematic Sampling is applied by only creating flows that are observed between time-based start and stop triggers. The time interval may be applied at packet level or after aggregation level, e.g. by selecting every k seconds a flow arriving at the export process.  </p>
<h1 id="rfc.section.5.2.2">
<a href="#rfc.section.5.2.2">5.2.2.</a> Random Sampling</h1>
<p id="rfc.section.5.2.2.p.1">Random flow sampling is based on a random process which requires the calculation of random numbers. One can differentiate between n-out-N and probabilistic sampling.  The sampling probability of individual flows records MAY be adjusted according to the flow record content or external events like the available export resources.  Non-uniform random sampling approaches can be applied similar to the ones defined in <a href="#RFC5475">[RFC5475]</a>. An example would be to prefer large volume flows over small volume flows. Random flow sampling can also be applied before aggregation when additional flow state about non selected flows is kept.  </p>
<h1 id="rfc.section.5.3">
<a href="#rfc.section.5.3">5.3.</a> Flow-state Dependent Packet Selection</h1>
<p id="rfc.section.5.3.p.1">As explained above Flow-state Dependent Packet Selection is not a Flow Selection Technique but a packet selection. Nevertheless we will describe configuration and reporting parameters for this technique in this document. An example is the the "Sample and Hold" algorithm <a href="#EsVa01">[EsVa01]</a> that tries to prefer large volume flows in the selection. When a packet arrives it is selected when already a flow cache entry for this packet exists. In case there is no flow cache entry, the packet is selected by a certain probability that is dependent on the packet size.  </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Information Model for Configuration of Flow Selection Techniques</h1>
<p id="rfc.section.6.p.1">This section describes the configuration parameters of the flow selection techniques presented above. It provides the basis of an information model to be adopted in order to configure the flow selection process within an IPFIX device.  The following table gives an overview of the defined selection techniques, where they can be applied and what are their input parameters. Dependent on where the flow selection techniques are applied different input parameters can be configured. </p>
<p id="rfc.section.6.p.2">Overview of Flow Selection Techniques:</p>
<div id="#rfc.table.1"></div>
<table cellpadding="3" cellspacing="0" class="tt full left">
<thead><tr>
<th class="left">Location</th>
<th class="left">Selection Method</th>
<th class="left">Selection Input</th>
</tr></thead>
<tbody>
<tr>
<td class="left">before aggregation </td>
<td class="left">Flow State Dependent Packet Selection</td>
<td class="left">packet sampling probabilities, flow state, packet properties</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Property Match Flow Filtering</td>
<td class="left">flow key fields, filter function</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Hash-Based Flow Filtering</td>
<td class="left">selection range, hash function, flow key</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Time-based Systematic Flow Sampling</td>
<td class="left">flow position (derived from arrival time of packets), flow state</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Sequence-based Systematic Flow Sampling</td>
<td class="left">flow position (derived from packet position), flow state</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Random Flow Sampling</td>
<td class="left">random number generator or list and packet position, flow state</td>
</tr>
<tr>
<td class="left">after aggregation</td>
<td class="left">Property Match Flow Filtering</td>
<td class="left">flow record content, filter function</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Hash-Based Flow Filtering</td>
<td class="left">selection range, hash function, hash input (flow keys and other flow properties)</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Flow State Dependent Flow Selection</td>
<td class="left">flow state parameters </td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Time-based Systematic Flow Sampling</td>
<td class="left">flow arrival time, flow state</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Sequence-based Systematic Flow Sampling</td>
<td class="left">flow position, flow state</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Random Flow Sampling</td>
<td class="left">random number generator or list and flow position, flow state</td>
</tr>
<tr>
<td class="left">during Exporting Process or in the Mediator</td>
<td class="left">Property Match Flow Filtering</td>
<td class="left">flow record content, filter function</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Hash-Based Flow Filtering</td>
<td class="left">selection range, hash function, flow key</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Time-based Systematic Flow Sampling</td>
<td class="left">flow record arrival time</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Sequence-based Systematic Flow Sampling</td>
<td class="left">flow record position</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Random Flow Sampling</td>
<td class="left">random number generator or list and flow position</td>
</tr>
<tr>
<td class="left"></td>
<td class="left">Flow State Dependent Flow Selection</td>
<td class="left">flow state parameters </td>
</tr>
</tbody>
</table>
<p id="rfc.section.6.p.3">A flow selection configuration consists of FS_SELECTOR_ID, FS_TYPE, FS_SELECTOR PARAMETERS.</p>
<p id="rfc.section.6.p.4">FS_SELECTOR ID: Unique ID for the flow sampler </p>
<p id="rfc.section.6.p.5">FS_TYPE: Defines which algorithm is used. </p>
<p id="rfc.section.6.p.6">FS_SELECTOR_PARAMETERS: Defines the input parameter for the flow selection methods</p>
<h1 id="rfc.section.6.1">
<a href="#rfc.section.6.1">6.1.</a> Description of Flow Filtering Techniques</h1>
<p id="rfc.section.6.1.p.1">In this section, we define what elements are needed to describe the most common Flow Filtering techniques. </p>
<div id="#rfc.table.2"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">FS_SELECTOR_ID</th>
<th class="left">FS_TYPE</th>
</tr></thead>
<tbody>
<tr>
<td class="left">1</td>
<td class="left">fs_property_matching</td>
</tr>
<tr>
<td class="left">2</td>
<td class="left">fs_hashing</td>
</tr>
<tr>
<td class="left">3</td>
<td class="left">fs_flow_state_dependent_flow_selection </td>
</tr>
</tbody>
</table>
<p id="rfc.section.6.1.p.2">FS_SELECTOR_PARAMETERS:      </p>
<p id="rfc.section.6.1.p.3">case fs_property_matching: </p>

<dl>
<dt>- </dt>
<dd style="margin-left: 4">Information Element (from <a href="#RFC5102">[RFC5102]</a>) </dd>
<dt>- </dt>
<dd style="margin-left: 4">Value or Value Interval</dd>
</dl>
<p id="rfc.section.6.1.p.4">case fs_hashing: </p>

<dl>
<dt>- </dt>
<dd style="margin-left: 4">Hash Domain (input bits from packet) - can be specified for IPv4 or IPv6 or both </dd>
<dt>- </dt>
<dd style="margin-left: 4">Hash Function Name</dd>
<dt>- </dt>
<dd style="margin-left: 4">Hash Selection Range </dd>
<dt>- </dt>
<dd style="margin-left: 4">optional parameters (e.g. random seed) </dd>
</dl>
<p id="rfc.section.6.1.p.5">case fs_flow_state_dependent_flow_selection: </p>

<dl>
<dt>- </dt>
<dd style="margin-left: 4">accuracy paramter </dd>
<dt>- </dt>
<dd style="margin-left: 4">frequency threshold (in per cent of observed packets)</dd>
</dl>
<p id="rfc.section.6.1.p.6">The above list of parameters for flow dependent flow selection techniques is suitable for the presented Frequent Item and Lossy Counting Algorithm. Nevertheless there exist a variety of techniques with very specific parameters which are not defined here. </p>
<h1 id="rfc.section.6.2">
<a href="#rfc.section.6.2">6.2.</a> Description of Flow Sampling Techniques</h1>
<p id="rfc.section.6.2.p.1">In this section, we define what elements are needed to describe the most common Flow Sampling techniques. </p>
<div id="#rfc.table.3"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">FS_SELECTOR_ID</th>
<th class="left">FS_TYPE</th>
</tr></thead>
<tbody>
<tr>
<td class="left">5</td>
<td class="left">fs_systematic_count-based</td>
</tr>
<tr>
<td class="left">5</td>
<td class="left">fs_systematic_time-based</td>
</tr>
<tr>
<td class="left">6</td>
<td class="left">fs_n-out-of-N </td>
</tr>
<tr>
<td class="left">7</td>
<td class="left">fs_probabilistic</td>
</tr>
</tbody>
</table>
<p id="rfc.section.6.2.p.2">FS_SELECTOR_PARAMETERS:      </p>
<p id="rfc.section.6.2.p.3">case systematic count-based: </p>

<dl>
<dt>- </dt>
<dd style="margin-left: 4">Interval length (number of new observed flows) </dd>
<dt>- </dt>
<dd style="margin-left: 4">Spacing (number of new observed flows) </dd>
</dl>

<p> </p>
<p id="rfc.section.6.2.p.4">case fs_systematic_time-based: </p>

<dl>
<dt>- </dt>
<dd style="margin-left: 4">Interval length (in usec) </dd>
<dt>- </dt>
<dd style="margin-left: 4">Spacing (in usec) </dd>
</dl>

<p>    </p>
<p id="rfc.section.6.2.p.5">case fs_random n-out-of-N: </p>

<dl>
<dt>- </dt>
<dd style="margin-left: 4">Population Size N </dd>
<dt>- </dt>
<dd style="margin-left: 4">Sample size n </dd>
</dl>

<p> </p>
<p id="rfc.section.6.2.p.6">case fs_probabilistic: </p>

<dl>
<dt>- </dt>
<dd style="margin-left: 4">Sampling probability p </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6.3">
<a href="#rfc.section.6.3">6.3.</a> Description of Flow State Dependent Packet Selection</h1>
<p id="rfc.section.6.3.p.1">The configuration of flow dependent packet selection has not been described in <a href="#RFC5475">[RFC5475]</a> therefore the paramaters are defined here: </p>
<p id="rfc.section.6.3.p.2">SELECTOR_TYPE: flow_dependent_packet_selection </p>
<p id="rfc.section.6.3.p.3">SELECTOR_PARAMETERS: </p>

<dl>
<dt>- </dt>
<dd style="margin-left: 4">packet selection probability per possible flow state interval </dd>
<dt>- </dt>
<dd style="margin-left: 4">additional parameters (e.g. packet properties as in <a href="#EsVa01">[EsVa01]</a>)</dd>
</dl>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> Information Model for Flow Selection Reporting</h1>
<p id="rfc.section.7.p.1">In this section we describe Information Elements (IEs) that SHOULD be exported by a flow selection process in order to support the interpretation of measurement results from flow measurements where only some flows are selected. The information is mainly used to report how many packets and flows have been observed in total and how many of them where selected. This helps for instance to calculate the attained sampling fraction, which is an important parameter to provide an accuracy statement.  The IEs can provide reporting information about flow records, flow cache entries, packets or bytes. The reported metrics are number of total and the number of selected elements. From this the number of dropped elements can be derived. All counters are delta counters and SHOULD be exported and reset when a new measurement interval starts. Additional IEs may be useful for future flow selection techniques. Those can be defined additionally if needed.  </p>
<p id="rfc.section.7.p.2">List of additional Flow Selection information elements:</p>
<div id="#rfc.table.4"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">ID</th>
<th class="left">Name</th>
</tr></thead>
<tbody>
<tr>
<td class="left">TBD1</td>
<td class="left">fsFlowRecordTotalCount</td>
</tr>
<tr>
<td class="left">TBD2</td>
<td class="left">fsFlowRecordSelectedCount</td>
</tr>
<tr>
<td class="left">TBD3</td>
<td class="left">fsCurrentFlowEntries</td>
</tr>
<tr>
<td class="left">TBD4</td>
<td class="left">fsMaxFlowEntries</td>
</tr>
<tr>
<td class="left">TBD5</td>
<td class="left">fsFlowEntryTotalCount</td>
</tr>
<tr>
<td class="left">TBD6</td>
<td class="left">fsFlowEntrySelectedCount</td>
</tr>
<tr>
<td class="left">TBD7</td>
<td class="left">fsPacketTotalCount</td>
</tr>
<tr>
<td class="left">TBD8</td>
<td class="left">fsPacketSelectedCount</td>
</tr>
<tr>
<td class="left">TBD9</td>
<td class="left">fsOctetTotalCount</td>
</tr>
<tr>
<td class="left">TBD10</td>
<td class="left">fsOctetSelectedCount</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> fsFlowRecordTotalCount</h1>
<p id="rfc.section.7.1.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the current number of all Flow Records that form the parent population as input to the Flow Selection Process.  </li></ul>
<p id="rfc.section.7.1.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.1.p.3">ElementId: TBD1</p>
<p id="rfc.section.7.1.p.4">Status: Proposed</p>
<p id="rfc.section.7.1.p.5">Units: Flow Records</p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> fsFlowRecordSelectedCount</h1>
<p id="rfc.section.7.2.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the current number Flow Records that were selected during the Flow Selection Process.  </li></ul>
<p id="rfc.section.7.2.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.2.p.3">ElementId: TBD2</p>
<p id="rfc.section.7.2.p.4">Status: Proposed</p>
<p id="rfc.section.7.2.p.5">Units: Flow Records</p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> fsCurrentFlowEntries</h1>
<p id="rfc.section.7.3.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the current number of flow entries in the flow cache.  </li></ul>
<p id="rfc.section.7.3.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.3.p.3">ElementId: TBD3</p>
<p id="rfc.section.7.3.p.4">Status: Proposed</p>
<p id="rfc.section.7.3.p.5">Units: Flow Entries</p>
<h1 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> fsMaxFlowEntries</h1>
<p id="rfc.section.7.4.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the maximum number of flow entries in the flow cache.  </li></ul>
<p id="rfc.section.7.4.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.4.p.3">ElementId: TBD4</p>
<p id="rfc.section.7.4.p.4">Status: Proposed</p>
<p id="rfc.section.7.4.p.5">Units: Flow Entries</p>
<h1 id="rfc.section.7.5">
<a href="#rfc.section.7.5">7.5.</a> fsFlowEntryTotalCount</h1>
<p id="rfc.section.7.5.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the current number of all Flow Entries that form the parent population as input to the Flow Selection Process.  </li></ul>
<p id="rfc.section.7.5.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.5.p.3">ElementId: TBD5</p>
<p id="rfc.section.7.5.p.4">Status: Proposed</p>
<p id="rfc.section.7.5.p.5">Units: Flow Entries</p>
<h1 id="rfc.section.7.6">
<a href="#rfc.section.7.6">7.6.</a> fsFlowEntrySelectedCount</h1>
<p id="rfc.section.7.6.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the current number Flow entries that were selected during the Flow Selection Process.  </li></ul>
<p id="rfc.section.7.6.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.6.p.3">ElementId: TBD6</p>
<p id="rfc.section.7.6.p.4">Status: Proposed</p>
<p id="rfc.section.7.6.p.5">Units: Flow Entries</p>
<h1 id="rfc.section.7.7">
<a href="#rfc.section.7.7">7.7.</a> fsPacketTotalCount</h1>
<p id="rfc.section.7.7.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the current number of packets in all flows that form the parent population as input to the Flow Selection Process.  </li></ul>
<p id="rfc.section.7.7.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.7.p.3">ElementId: TBD7</p>
<p id="rfc.section.7.7.p.4">Status: Proposed</p>
<p id="rfc.section.7.7.p.5">Units: Packets</p>
<h1 id="rfc.section.7.8">
<a href="#rfc.section.7.8">7.8.</a> fsFlowEntrySelectedCount</h1>
<p id="rfc.section.7.8.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the current number packets in all flows that were selected during the Flow Selection Process.  </li></ul>
<p id="rfc.section.7.8.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.8.p.3">ElementId: TBD8</p>
<p id="rfc.section.7.8.p.4">Status: Proposed</p>
<p id="rfc.section.7.8.p.5">Units: Packets</p>
<h1 id="rfc.section.7.9">
<a href="#rfc.section.7.9">7.9.</a> fsOctetTotalCount</h1>
<p id="rfc.section.7.9.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the current number of all bytes in all flows that form the parent population as input to the Flow Selection Process.  </li></ul>
<p id="rfc.section.7.9.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.9.p.3">ElementId: TBD9</p>
<p id="rfc.section.7.9.p.4">Status: Proposed</p>
<p id="rfc.section.7.9.p.5">Units: Bytes</p>
<h1 id="rfc.section.7.10">
<a href="#rfc.section.7.10">7.10.</a> fsOctetSelectedCount</h1>
<p id="rfc.section.7.10.p.1">Description:</p>

<ul class="empty"><li>This Information Element specifies the current number of bytes in all flows that were selected during the Flow Selection Process.  </li></ul>
<p id="rfc.section.7.10.p.2">Abstract Data Type: unsigned64</p>
<p id="rfc.section.7.10.p.3">ElementId: TBD10</p>
<p id="rfc.section.7.10.p.4">Status: Proposed</p>
<p id="rfc.section.7.10.p.5">Units: Bytes</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> IANA Considerations</h1>
<p id="rfc.section.8.p.1">This document introduces several new information elements as an extension to the IPFIX information model. Values TBD1-TBD10 in this document should be replaced with the assigned numbers by IANA.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Security Considerations</h1>
<p id="rfc.section.9.p.1">In this section security issues concerning an IPFIX device performing flow selection are pointed out.  In case the flow selection function is activated an IPFIX device might be exposed to security threats.  Since flow selection implies analysing flow packets, associating them to a specific traffic flow and selecting flow records, a malicious user who was able to gain control of an IPFIX device might access both packet and flow data, thus violating their confidentiality.</p>
<p id="rfc.section.9.p.2">Furthermore, the intruder might be attracted by the possibility of altering the flow selection process by modifying the criteria used to select flow records.  In this case, the IPFIX device would export flow data which are different from the ones that the Collector expects to receive.</p>
<p id="rfc.section.9.p.3">It is apparent that these security threats can be mitigated by authenticating entities that interact with the IPFIX device and keeping information for flow selection configuration confidential.</p>
<h1 id="rfc.references">
<a href="#rfc.references">10.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">10.1.</a> Normative References</h1>
<table><tbody><tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr></tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">10.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="DuLT01a">[DuLT01a]</b></td>
<td class="top">
<a>Duffield, N.G.</a>, <a>Lund, C.</a> and <a>M. Thorup</a>, "<a>Charging from Sampled Network Usage</a>", ACM Internet Measurement Workshop IMW 2001, San Francisco, USA, November 2001.</td>
</tr>
<tr>
<td class="reference"><b id="DuLT01b">[DuLT01b]</b></td>
<td class="top">
<a>Duffield, N.G.</a>, <a>Lund, C.</a> and <a>M. Thorup</a>, "<a>Properties and Prediction of Flow Statistics from Sampled Packet Streams</a>", ACM SIGCOMM Internet Measurement Workshop 2002, November 2002.</td>
</tr>
<tr>
<td class="reference"><b id="Moli03">[Moli03]</b></td>
<td class="top">
<a>Molina, M.</a>, "<a>A scalable and efficient methodology for flow monitoring in the Internet</a>", International Teletraffic Congress (ITC-18), Berlin, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="CoHa08">[CoHa08]</b></td>
<td class="top">
<a>Cormode, G.</a> and <a>M. Hadjieleftheriou</a>, "<a>Finding frequent items in data streams</a>", Journal, Proceedings of the Very Large DataBase Endowment VLDB Endowment, Volume 1 Issue 2, August 2008, August 2008.</td>
</tr>
<tr>
<td class="reference"><b id="KaPS03">[KaPS03]</b></td>
<td class="top">
<a>Karp, R.</a>, <a>Papadimitriou, C.</a> and <a>S. S. Shenker</a>, "<a>A simple algorithm for finding frequent elements in sets and bags.</a>", ACM Transactions on Database Systems, Volume 28, 51-55, 2003, March 2003.</td>
</tr>
<tr>
<td class="reference"><b id="MaMo02">[MaMo02]</b></td>
<td class="top">
<a>Manku, G.S.</a> and <a>R. Motwani</a>, "<a>Approximate Frequency Counts over Data Streams</a>", Proceedings of the Internation Conference on Very large DataBases (VLDB) pages 346--357, 2002, Hong Kong, China, 2002.</td>
</tr>
<tr>
<td class="reference"><b id="MSZC10">[MSZC10]</b></td>
<td class="top">
<a>Mai, J.</a>, <a>Sridharan, A.</a>, <a>Zang, H.</a> and <a>C.-N. Chuah</a>, "<a>Fast Filtered Sampling</a>", Computer Networks Volume 54, Issue 11, Pages 1885-1898, ISSN 1389-1286, January 2010.</td>
</tr>
<tr>
<td class="reference"><b id="EsVa01">[EsVa01]</b></td>
<td class="top">
<a>Estan, C.</a> and <a>G, Varghese</a>, "<a>New Directions in Traffic Measurement and Accounting: Focusing on the Elephants, Ignoring the Mice</a>", ACM SIGCOMM Internet Measurement Workshop 2001, San Francisco (CA), November 2001.</td>
</tr>
<tr>
<td class="reference"><b id="KuXW04">[KuXW04]</b></td>
<td class="top">
<a>Kumar, K.</a>, <a>Xu, J.</a>, <a>Wang, J.</a>, <a>Spatschek, O.</a> and <a>L. Li</a>, "<a>Space-code bloom filter for efficient per-flow traffic measurement</a>", INFOCOM 2004 Twenty-third AnnualJoint Conference of the IEEE Computer and Communications Societies, March 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3917">[RFC3917]</b></td>
<td class="top">
<a>Quittek, J.</a>, <a>Zseby, T.</a>, <a>Claise, B.</a> and <a>S. Zander</a>, "<a href="http://tools.ietf.org/html/rfc3917">Requirements for IP Flow Information Export (IPFIX)</a>", RFC 3917, October 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5101">[RFC5101]</b></td>
<td class="top">
<a>Claise, B.</a>, "<a href="http://tools.ietf.org/html/rfc5101">Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information</a>", RFC 5101, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5102">[RFC5102]</b></td>
<td class="top">
<a>Quittek, J.</a>, <a>Bryant, S.</a>, <a>Claise, B.</a>, <a>Aitken, P.</a> and <a>J. Meyer</a>, "<a href="http://tools.ietf.org/html/rfc5102">Information Model for IP Flow Information Export</a>", RFC 5102, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5470">[RFC5470]</b></td>
<td class="top">
<a>Sadasivan, G.</a>, <a>Brownlee, N.</a>, <a>Claise, B.</a> and <a>J. Quittek</a>, "<a href="http://tools.ietf.org/html/rfc5470">Architecture for IP Flow Information Export</a>", RFC 5470, March 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5475">[RFC5475]</b></td>
<td class="top">
<a>Zseby, T.</a>, <a>Molina, M.</a>, <a>Duffield, N.</a>, <a>Niccolini, S.</a> and <a>F. Raspall</a>, "<a href="http://tools.ietf.org/html/rfc5475">Sampling and Filtering Techniques for IP Packet Selection</a>", RFC 5475, March 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5476">[RFC5476]</b></td>
<td class="top">
<a>Claise, B.</a>, <a>Johnson, A.</a> and <a>J. Quittek</a>, "<a href="http://tools.ietf.org/html/rfc5476">Packet Sampling (PSAMP) Protocol Specifications</a>", RFC 5476, March 2009.</td>
</tr>
<tr>
<td class="reference"><b id="RFC6183">[RFC6183]</b></td>
<td class="top">
<a>Kobayashi, A.</a>, <a>Claise, B.</a>, <a>Muenz, G.</a> and <a>K. Ishibashi</a>, "<a href="http://tools.ietf.org/html/rfc6183">IP Flow Information Export (IPFIX) Mediation: Framework</a>", RFC 6183, April 2011.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Salvatore D'Antonio</span> 
	  <span class="n hidden">
		<span class="family-name">D'Antonio</span>
	  </span>
	</span>
	<span class="org vcardline">CINI Consortium/University of Napoli "Parthenope"</span>
	<span class="adr">
	  <span>Monte S.Angelo, Via Cinthia</span>

	  <span class="vcardline">
		<span class="locality">Napoli</span>,  
		<span class="region"></span>
		<span class="code">80126</span>
	  </span>
	  <span class="country-name vcardline">Italy</span>
	</span>
	<span class="vcardline">Phone: +39 081 679944</span>

<span class="vcardline">EMail: <a href="mailto:salvatore.dantonio@parthenope.it">salvatore.dantonio@parthenope.it</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Tanja Zseby</span> 
	  <span class="n hidden">
		<span class="family-name">Zseby</span>
	  </span>
	</span>
	<span class="org vcardline">Fraunhofer Institute FOKUS</span>
	<span class="adr">
	  <span>Kaiserin-Augusta-Allee 31</span>

	  <span class="vcardline">
		<span class="locality">Berlin</span>,  
		<span class="region"></span>
		<span class="code">10589</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49 30 3463 7153</span>

<span class="vcardline">EMail: <a href="mailto:tanja.zseby@fokus.fraunhofer.de">tanja.zseby@fokus.fraunhofer.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Christian Henke</span> 
	  <span class="n hidden">
		<span class="family-name">Henke</span>
	  </span>
	</span>
	<span class="org vcardline">Technische Universitat Berlin</span>
	<span class="adr">
	  <span>Stra&#223;e des 17. Juni 135</span>

	  <span class="vcardline">
		<span class="locality">Berlin</span>,  
		<span class="region"></span>
		<span class="code">10623</span>
	  </span>
	  <span class="country-name vcardline">Germany</span>
	</span>
	<span class="vcardline">Phone: +49 30 3463 7366</span>

<span class="vcardline">EMail: <a href="mailto:c.henke@tu-berlin.de">c.henke@tu-berlin.de</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Lorenzo Peluso</span> 
	  <span class="n hidden">
		<span class="family-name">Peluso</span>
	  </span>
	</span>
	<span class="org vcardline">University of Napoli</span>
	<span class="adr">
	  <span>Via Claudio 21</span>

	  <span class="vcardline">
		<span class="locality">Napoli</span>,  
		<span class="region"></span>
		<span class="code">80125</span>
	  </span>
	  <span class="country-name vcardline">Italy</span>
	</span>
	<span class="vcardline">Phone: +39 081 7683821</span>

<span class="vcardline">EMail: <a href="mailto:lorenzo.peluso@unina.it">lorenzo.peluso@unina.it</a></span>

  </address>
</div>

</body>
</html>