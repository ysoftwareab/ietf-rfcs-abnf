<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Overview of Email DNSBL Best Practise</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.1.1" rel="Chapter" title="1.1 DNS-Based Reputation Systems">
<link href="#rfc.section.1.2" rel="Chapter" title="1.2 Guidance for DNSBL Users">
<link href="#rfc.section.1.3" rel="Chapter" title="1.3 Requirements Language">
<link href="#rfc.section.1.4" rel="Chapter" title="1.4 Background">
<link href="#rfc.section.2" rel="Chapter" title="2 DNSBL Policies">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Transparency">
<link href="#rfc.section.2.1.1" rel="Chapter" title="2.1.1 Listing/Delisting Criteria SHOULD Be Easily Available">
<link href="#rfc.section.2.1.2" rel="Chapter" title="2.1.2 Audit Trail SHOULD be Maintained">
<link href="#rfc.section.2.1.3" rel="Chapter" title="2.1.3 The Scope and Aggressiveness of Listings MUST be Disclosed.">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Listings and Removals">
<link href="#rfc.section.2.2.1" rel="Chapter" title="2.2.1 Listings SHOULD Be Temporary">
<link href="#rfc.section.2.2.2" rel="Chapter" title="2.2.2 A Direct Non-Public Way to Request Removal SHOULD Be Available">
<link href="#rfc.section.2.2.3" rel="Chapter" title="2.2.3 Response SHOULD Be Prompt">
<link href="#rfc.section.2.2.4" rel="Chapter" title="2.2.4 SHOULD Have Similar Criteria for Listing and Delisting">
<link href="#rfc.section.2.2.5" rel="Chapter" title="2.2.5 Conflict of Interest">
<link href="#rfc.section.3" rel="Chapter" title="3 Operational Issues">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 DNSBL Query Root Domain Name SHOULD be a Subdomain">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 DNSBLs SHOULD be Adequately Provisioned">
<link href="#rfc.section.3.3" rel="Chapter" title="3.3 DNSBLs SHOULD Provide Operational Flags">
<link href="#rfc.section.3.4" rel="Chapter" title="3.4 Shutdowns MUST Be Done Gracefully">
<link href="#rfc.section.3.5" rel="Chapter" title="3.5 Listing of Special and Reserved IP Addresses MUST be Disclosed">
<link href="#rfc.section.3.6" rel="Chapter" title="3.6 Considerations for DNSBLs Listing Insecure Hosts">
<link href="#rfc.section.3.6.1" rel="Chapter" title="3.6.1 MUST NOT Scan Without Provocation">
<link href="#rfc.section.3.6.2" rel="Chapter" title="3.6.2 Re-scan Periods SHOULD be Reasonable">
<link href="#rfc.section.3.6.3" rel="Chapter" title="3.6.3 Scans MUST NOT be Destructive">
<link href="#rfc.section.3.7" rel="Chapter" title="3.7 Removals SHOULD Be Possible in Absence of the DNSBL Operator">
<link href="#rfc.section.3.8" rel="Chapter" title="3.8 Protect Against Misconfiguration/Outages">
<link href="#rfc.section.3.9" rel="Chapter" title="3.9 Error Handling">
<link href="#rfc.section.4" rel="Chapter" title="4 Security Considerations">
<link href="#rfc.section.5" rel="Chapter" title="5 IANA Considerations">
<link href="#rfc.references" rel="Chapter" title="6 References">
<link href="#rfc.references.1" rel="Chapter" title="6.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="6.2 Informative References">
<link href="#rfc.appendix.Appendix%20A" rel="Chapter" title="Appendix A Acknowledgements">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The rise of spam and other anti-social behavior on the Internet has led to the creation of shared DNS-based lists ("DNSBLs") of IP addresses or domain names intended to help guide email filtering.  This memo summarizes guidelines of accepted best practise for the management of public DNSBLs by their operators as well as for the proper use of such lists by mail server administrators (DNSBL users), and it provides useful background for both parties.  It is not intended to advise on the utility or efficacy of particular DNSBLs or the DNSBL concept in general, nor to assist end users with questions about spam." />
  <meta name="description" content="The rise of spam and other anti-social behavior on the Internet has led to the creation of shared DNS-based lists ("DNSBLs") of IP addresses or domain names intended to help guide email filtering.  This memo summarizes guidelines of accepted best practise for the management of public DNSBLs by their operators as well as for the proper use of such lists by mail server administrators (DNSBL users), and it provides useful background for both parties.  It is not intended to advise on the utility or efficacy of particular DNSBLs or the DNSBL concept in general, nor to assist end users with questions about spam." />
  <meta name="keywords" content="DNSBL policy" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Anti-Spam Research Group - IRTF</td>
<td class="right">C.R. Lewis</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Nortel Networks</td>
</tr>
<tr>
<td class="left">Intended status: Informational</td>
<td class="right">M. Sergeant</td>
</tr>
<tr>
<td class="left">Expires: January 27, 2012</td>
<td class="right">Symantec Corporation</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">July 26, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Overview of Email DNSBL Best Practise<br />
  <span class="filename">draft-irtf-asrg-bcp-blacklists-10</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The rise of spam and other anti-social behavior on the Internet has led to the creation of shared DNS-based lists ("DNSBLs") of IP addresses or domain names intended to help guide email filtering.  This memo summarizes guidelines of accepted best practise for the management of public DNSBLs by their operators as well as for the proper use of such lists by mail server administrators (DNSBL users), and it provides useful background for both parties.  It is not intended to advise on the utility or efficacy of particular DNSBLs or the DNSBL concept in general, nor to assist end users with questions about spam.</p>
<p>This document is a product of the Anti-Spam Research Group and represents the consensus of that group.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on January 27, 2012.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>1.1.   <a href="#rfc.section.1.1">DNS-Based Reputation Systems</a>
</li>
<li>1.2.   <a href="#rfc.section.1.2">Guidance for DNSBL Users</a>
</li>
<li>1.3.   <a href="#rfc.section.1.3">Requirements Language</a>
</li>
<li>1.4.   <a href="#rfc.section.1.4">Background</a>
</li>
<li>2.   <a href="#rfc.section.2">DNSBL Policies</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Transparency</a>
</li>
<li>2.1.1.   <a href="#rfc.section.2.1.1">Listing/Delisting Criteria SHOULD Be Easily Available</a>
</li>
<li>2.1.2.   <a href="#rfc.section.2.1.2">Audit Trail SHOULD be Maintained</a>
</li>
<li>2.1.3.   <a href="#rfc.section.2.1.3">The Scope and Aggressiveness of Listings MUST be Disclosed.</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Listings and Removals</a>
</li>
<li>2.2.1.   <a href="#rfc.section.2.2.1">Listings SHOULD Be Temporary</a>
</li>
<li>2.2.2.   <a href="#rfc.section.2.2.2">A Direct Non-Public Way to Request Removal SHOULD Be Available</a>
</li>
<li>2.2.3.   <a href="#rfc.section.2.2.3">Response SHOULD Be Prompt</a>
</li>
<li>2.2.4.   <a href="#rfc.section.2.2.4">SHOULD Have Similar Criteria for Listing and Delisting</a>
</li>
<li>2.2.5.   <a href="#rfc.section.2.2.5">Conflict of Interest</a>
</li>
<li>3.   <a href="#rfc.section.3">Operational Issues</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">DNSBL Query Root Domain Name SHOULD be a Subdomain</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">DNSBLs SHOULD be Adequately Provisioned</a>
</li>
<li>3.3.   <a href="#rfc.section.3.3">DNSBLs SHOULD Provide Operational Flags</a>
</li>
<li>3.4.   <a href="#rfc.section.3.4">Shutdowns MUST Be Done Gracefully</a>
</li>
<li>3.5.   <a href="#rfc.section.3.5">Listing of Special and Reserved IP Addresses MUST be Disclosed</a>
</li>
<li>3.6.   <a href="#rfc.section.3.6">Considerations for DNSBLs Listing Insecure Hosts</a>
</li>
<li>3.6.1.   <a href="#rfc.section.3.6.1">MUST NOT Scan Without Provocation</a>
</li>
<li>3.6.2.   <a href="#rfc.section.3.6.2">Re-scan Periods SHOULD be Reasonable</a>
</li>
<li>3.6.3.   <a href="#rfc.section.3.6.3">Scans MUST NOT be Destructive</a>
</li>
<li>3.7.   <a href="#rfc.section.3.7">Removals SHOULD Be Possible in Absence of the DNSBL Operator</a>
</li>
<li>3.8.   <a href="#rfc.section.3.8">Protect Against Misconfiguration/Outages</a>
</li>
<li>3.9.   <a href="#rfc.section.3.9">Error Handling</a>
</li>
<li>4.   <a href="#rfc.section.4">Security Considerations</a>
</li>
<li>5.   <a href="#rfc.section.5">IANA Considerations</a>
</li>
<li>6.   <a href="#rfc.references">References</a>
</li>
<li>6.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>6.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li>Appendix A.   <a href="#rfc.appendix.Appendix%20A">Acknowledgements</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<h1 id="rfc.section.1.1">
<a href="#rfc.section.1.1">1.1.</a> DNS-Based Reputation Systems</h1>
<p id="rfc.section.1.1.p.1">Due to the rising amount of spam and other forms of network abuse on the Internet, many community members and companies began to create, publish and maintain DNS-based reputation systems (DNS-Based Lists) of IP addresses or domain names and make reputation suggestions or assertions about email sourced from these IP addresses or domain names.</p>
<p id="rfc.section.1.1.p.2">The first DNS-based Lists were almost exclusively intended to be used (by email administrators) as lists of abusive IP addresses to block, however the DNS publication method has proven to be so robust, popular and simple to use, that it has been extended for use in many different ways, far beyond the imaginings of the designers of DNS or DNS-based blocking IP lists.  For example, today, the same basic DNS-based listing technology is commonly used for:</p>
<p></p>

<dl>
<dt>DNSWL</dt>
<dd style="margin-left: 8">listings of well-behaving email source IP/domain addresses (whitelist).</dd>
<dt>RHSBL</dt>
<dd style="margin-left: 8">listings of well/ill behaving email source domain names (often applied against the domain name part (RHS = Right Hand Side) of the originating email address or DNS PTR (reverse IP) lookups)</dd>
<dt>URIBL</dt>
<dd style="margin-left: 8">listings of well/ill behaving web link domain names or host names used in email</dd>
</dl>

<p> </p>
<p id="rfc.section.1.1.p.4">Further, the DNSBL user using the list doesn't have to use a listing as a pass/fail binary decision, it can use a listing as one factor in email filters that make decisions based on scoring multiple factors together.</p>
<p id="rfc.section.1.1.p.5">The DNS-based list technology has even been extended to purely informational purposes.  For example, there are implementations that return results based on what geographic region an IP/domain is putatively allocated in, implementations that translate an IP/domain address into an ASN number and/or allocation block, implementations that indicate whether the queried domain name is registered through a given Domain registrar, implementations that return aggregate numeric reputation for an IP address or domain name from another system's email system, and so on.  The possibilities are virtually endless.</p>
<p id="rfc.section.1.1.p.6">As well, DNS-based listing technology has also been used in areas other than email filtering, such as IRC, web access control, and transaction verification.</p>
<p id="rfc.section.1.1.p.7">As the terminology in this area has never been well formalized, often overlaps, and lacks precision, this document has been written to use the term "DNSBL" to refer to DNS-based lists generally, not just DNS-based block (or black) lists.  This document is not applicable to some DNSBLs in some areas (mentioned as appropriate) but it is the authors' belief that most of the practises are applicable to almost all DNSBLs.</p>
<p id="rfc.section.1.1.p.8">DNSBLs may be either public or private.  A public DNSBL makes its data available to any party seeking information about data on the list, while a private DNSBL is used solely by an organization for its own use and the data is not made available publicly.  There are also commercial DNSBLs, available for a fee.  Furthermore, some are free yet require a fee for higher numbers of queries or certain classes of DNSBL users.  </p>
<p id="rfc.section.1.1.p.9">The first publicly available DNSBL using the Domain Name System (DNS) for distributing reputation data about email senders emerged in 1997, shortly after spam became a problem for network operators and email administrators.  This pioneer DNSBL focused on identifying known spam sources situated at static (unchanging) IP/domain addresses.  Due to the broad adoption of this DNSBL, it had a major impact on static spam sources.  Consequently, abusers found other methods for distributing their spam, such as relaying messages through unsecured email servers or flawed formmail scripts on web pages.  Additional DNSBLs were developed by others in order to address these changing tactics, and today more than 700 public DNSBLs are known to be in operation.</p>
<p id="rfc.section.1.1.p.10">These DNSBLs vary widely in purpose for which the list was intended, the method the list uses to achieve the purpose, the integrity of those overseeing the method, and the stability of the technology used to create and distribute the data.  Listing criteria can sometimes be quite controversial, therefore this document deliberately does not discuss the rightness or wrongness of any criteria.   We assert that DNSBL operators are free to choose whatever listing criteria they wish, as long as those criteria are clearly and accurately communicated.  It is the responsibility of the DNSBL user to ensure that the listing criteria and other aspects of a DNSBL meets their needs.</p>
<p id="rfc.section.1.1.p.11">This document is intended to provide guidance to DNSBL operators so that they may be able to identify what features users would be interested in seeing as part of a high-quality, well-managed DNSBL, for example, a clear listing and delisting policy to which the DNSBL operator adheres strictly.  This document is intended to be normative rather than prescriptive: it seeks to characterize the features of a well-managed DNSBL rather than setting out rules for how DNSBLs should be operated.</p>
<p id="rfc.section.1.1.p.12">This document is not intended as a protocol specification of DNSBL queries.  (See <a href="#RFC5782">[RFC5782]</a>.)</p>
<p id="rfc.section.1.1.p.13">The DNS has been the most popular distribution method for DNSBLs due to its ubiquity and its good scaling and performance characteristics.  It is also common to make private arrangements to distribute DNSBL data in bulk to high volume users, typically by <a href="#RSYNC">rsync</a> <cite title="NONE">[RSYNC]</cite>, <a href="#RSYNCTHESIS">[RSYNCTHESIS]</a>.  The data is the same in either case, the recommendations in this document apply regardless of distribution method, other than the ones in <a href="#limited">Section 3.1</a> and <a href="#provisioning">Section 3.2</a> that specifically refer to DNS distribution.</p>
<h1 id="rfc.section.1.2">
<a href="#rfc.section.1.2">1.2.</a> Guidance for DNSBL Users</h1>
<p id="rfc.section.1.2.p.1">When choosing to adopt a DNSBL, a DNSBL user SHOULD keep the following questions in mind:</p>
<p></p>

<ol>
<li>What is the intended use of the list?</li>
<li>Does the list have a web site?</li>
<li>Are the list's policies stated on the web site?</li>
<li>Are the policies stated clearly and understandably?</li>
<li>Does the web site function properly, e.g., hyperlinks?</li>
<li>Are web pages for removal requirements accessible and working properly?</li>
<li>How long has the list been in operation?</li>
<li>What are the demographics and quantity of the list's user base? In other words, do other sites like my own use this DNSBL?</li>
<li>Are comparative evaluations of the list available? Note: all such evaluations depend on the mail mix used as well as local policy.  DNSBL users SHOULD consider trial periods and/or ongoing local monitoring of DNSBL suitability.</li>
<li>What do your peers or members of the Internet community say about the list?  DNSBLs can sometimes be quite controversial and sometimes considerable misinformation is spread.  Ensure that the opinions are knowledgeable, and reflect similar goals to yours.</li>
<li>Does the DNSBL have a mailing list for announcing changes, outages etc?</li>
</ol>

<p> </p>
<p id="rfc.section.1.2.p.3">DNSBLs can, and have, ceased operation without notice.  DNSBL users SHOULD periodically check the correct operation of the DNSBL, and cease using DNSBLs that are working incorrectly.  See <a href="#updown">Section 3.3</a></p>
<p id="rfc.section.1.2.p.4">The DNSBL user MUST ensure that they understand the intended use of the DNSBL.  For example, some IP address-based DNSBLs are appropriate only for assessment of the peer IP address of the machine connecting to the DNSBL user's mail server, and not other IP addresses appearing in an email (such as header Received lines or web links), or IRC connections etc.  While a DNSBL user may choose to ignore the intent of the DNSBL, they SHOULD implement any variance in compliance with the DNSBL usage instructions.</p>
<p id="rfc.section.1.2.p.5">For example, one of the requirements of some DNSBLs is that if the DNSBL is used contrary to the usage instructions, then the DNSBL user should not identify the DNSBL being used.  Furthermore, it is the DNSBL user's responsibility to mitigate the effect of the listing locally.</p>
<p id="rfc.section.1.2.p.6">It is the responsibility of the system administrators who adopt one or more DNSBLs to evaluate, understand, and make a determination of which DNSBLs are appropriate for the sites they administer.  If you are going to allow a third party's information to guide your filtering decision-making process, you MUST understand the policies and practises of those third parties because responsibility for filter decisions remains ultimately with you, the postmaster.  </p>
<p id="rfc.section.1.2.p.7">A DNSBL without DNSBL users does not block (or otherwise impair) email or any other Internet service.  A DNSBL user voluntarily uses the DNSBL data to guide their decisions, and the DNSBL user therefore MUST assume responsibility for dealing with the consequences.</p>
<p id="rfc.section.1.2.p.8">DNSBL operators are expressing an opinion through the publication of a DNSBL.  However, it is through abiding by the guidelines set forth in this BCP that the operators of a DNSBL may gain the trust of their users.</p>
<p id="rfc.section.1.2.p.9">These guidelines address only public DNSBLs and do not apply to private access DNSBLs, however, implementers and users of private access DNSBLs may wish to use these guidelines as a starting point of things to consider.</p>
<h1 id="rfc.section.1.3">
<a href="#rfc.section.1.3">1.3.</a> Requirements Language</h1>
<p id="rfc.section.1.3.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.section.1.4">
<a href="#rfc.section.1.4">1.4.</a> Background</h1>
<p id="rfc.section.1.4.p.1">The Anti Spam Research Group (ASRG) was chartered to address the spam problem. The ASRG charter includes:</p>
<p id="rfc.section.1.4.p.2">"codification of best current practises in spam management"</p>
<p id="rfc.section.1.4.p.3">This note falls within that category by listing guidelines for management of public DNSBLs.</p>
<p></p>

<dl>
<dt>NOTE:</dt>
<dd style="margin-left: 8">This document is a product of the Anti-Spam Research Group (ASRG) of the IRTF. As per section 3 of <a href="#RFC2014">[RFC2014]</a> IRTF groups do not require consensus to publish documents.  Therefore readers should be aware that this document does not necessarily represent the consensus of the entire ASRG.</dd>
<dt>NOTE:</dt>
<dd style="margin-left: 8">This document is intended to evolve, based on comments from the Anti-Spam Research Group (ASRG) mailing list. It is certain that the current draft is incomplete and entirely possible that it is inaccurate. Hence, comments are eagerly sought, preferably in the form of suggested text changes, and preferably on the ASRG mailing list, at &lt;asrg@ietf.org&gt;.</dd>
</dl>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> DNSBL Policies</h1>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Transparency</h1>
<p id="rfc.section.2.1.p.1">A DNSBL SHOULD carefully describe the criteria that are the cause for adding, and the criteria for removing an entry from the list.  Such listing and delisting criteria SHOULD be presented in a clear and readable manner easily accessible to the public on the DNSBL's web site. A DNSBL MUST abide by its stated listing and delisting criteria.  Entries that do not meet the published criteria MUST NOT be added to the DNSBL.</p>
<p id="rfc.section.2.1.p.2">In other words, be direct and honest and clear about the listing criteria, and make certain that only entries meeting the published criteria are added to the list.  For example, some DNSBL operators have been known to include "spite listings" in the lists they administer -- listings of IP addresses or domain names associated with someone who has insulted them, rather than actually violating technical criteria for inclusion in the list.  There is nothing inherently wrong with this practise so long as it is clearly disclosed - and thus becomes part of the published criteria.  For example, a DNSBL described as only listing open relays MUST NOT include IP addresses for any other reason.  This transparency principle does not require DNSBL operators to disclose the precise algorithms and data involved in a listing, but rather the intent behind choosing those algorithms and data.</p>
<p id="rfc.section.2.1.p.3">Furthermore, the DNSBL documentation SHOULD be clear on the intended use of the DNSBL - whether it be intended for peer addresses of email, IRC, etc.</p>
<p id="rfc.section.2.1.p.4">Availability of documentation concerning a DNSBL SHOULD NOT be dependent on the continued operation of DNS for DNSBL queries.  </p>
<p id="rfc.section.2.1.p.5">In other words, if the DNSBL documentation is at "http://dnsbl.example.com", the documentation for the web site should not become unavailable if the DNSBL query name servers are not available (or shut down).  See <a href="#limited">Section 3.1</a>.</p>
<h1 id="rfc.section.2.1.1">
<a href="#rfc.section.2.1.1">2.1.1.</a> <a href="#listing_criteria" id="listing_criteria">Listing/Delisting Criteria SHOULD Be Easily Available</a>
</h1>
<p id="rfc.section.2.1.1.p.1">Listing and delisting criteria for DNSBLs SHOULD be easily available and SHOULD be located in a place clearly marked in its own section of the web site affiliated with the DNSBL.</p>
<p id="rfc.section.2.1.1.p.2">DNSBLs often publish their listing criteria along with additional technical information about using the DNSBL. This additional technical information can confuse end users, so a separate page, section or query function on its own SHOULD be dedicated to detailing why a specific entry appears in the DNSBL.</p>
<h1 id="rfc.section.2.1.2">
<a href="#rfc.section.2.1.2">2.1.2.</a> Audit Trail SHOULD be Maintained</h1>
<p id="rfc.section.2.1.2.p.1">A DNSBL SHOULD maintain an audit trail for all listings and it is RECOMMENDED that it is made publicly available in an easy to find location, preferably on the DNSBL's web site.  Please note that making an audit trail data public does not entail revealing all information in the DNSBL operator's possession relating to the listing; e.g., a DNSBL operator MAY make the audit trail data selectively accessible in such a way as to not disclose information that might assist spammers, such as the location or identity of a spam trap.</p>
<h1 id="rfc.section.2.1.3">
<a href="#rfc.section.2.1.3">2.1.3.</a> The Scope and Aggressiveness of Listings MUST be Disclosed.</h1>
<p id="rfc.section.2.1.3.p.1">Some DNSBLs have adopted policies of listing entries that are broader in scope than they have evidence of being involved in abuse.  Similarly, some DNSBLs list entries that are "mixed", in that the entry may be behaving in a manner that is both abusive and non-abusive.  This is inherent to the techniques that many DNSBLs use.</p>
<p id="rfc.section.2.1.3.p.2">Examples: Some DNSBLs will list IP address ranges if there is reason to believe that abusive behavior seen from a few IP addresses within the range is (or will be) reflected in the rest of the range.  Some DNSBLs utilize scoring to list IP addresses, IP ranges or domain names that have abusive behavior above some threshold - often meaning that some of the email corresponding to the listing is not abusive.  Even an entry demonstrably infected with email spam or virus emitting malware may emit non-abusive email.</p>
<p id="rfc.section.2.1.3.p.3">Inevitably, some of these listings may impact non-abusive email.  This has resulted in some labeling of such practises by the emotionally loaded term "collateral damage".  No filtering technique is perfect, and an occasional mistake is inevitable no matter what is used, DNSBLs or otherwise.</p>
<p id="rfc.section.2.1.3.p.4">There is nothing wrong with this practise, because mail server administrators may wish to implement such policies or use them in combination with other techniques (such as scoring).  However, a diligent administrator needs information about these policies in order to make an informed decision as to the risk and benefit of using any particularly DNSBL, and in many cases guide them in how to use it for results best reflecting the DNSBL user's requirements.</p>
<p id="rfc.section.2.1.3.p.5">Therefore, DNSBL listing policies MUST include statements as to the scope and aggressiveness of listings, and include, as appropriate, whether the DNSBL operator intends the listings to be used in scoring or other techniques.</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Listings and Removals</h1>
<h1 id="rfc.section.2.2.1">
<a href="#rfc.section.2.2.1">2.2.1.</a> <a href="#temporary" id="temporary">Listings SHOULD Be Temporary</a>
</h1>
<p id="rfc.section.2.2.1.p.1">In many cases, listings can exist for long periods of time past the conditions leading to the listing's creation, and/or the listed entity has putatively changed ownership.</p>
<p id="rfc.section.2.2.1.p.2">Generally speaking, listings SHOULD be considered temporary, and should expire on their own at some point in the future unless reasons for listing still exist.</p>
<p id="rfc.section.2.2.1.p.3">Expiration intervals SHOULD be chosen to be reasonable for the type of listing.  For example:</p>
<p></p>

<ol>
<li>It does not make sense to remove entries from DNSBLs where the existence of an entry does not have a direct meaning, that is, DNSBLs that return information in addition to just existence/non-existence.  For example: entries in DNSBLs that return geographic or assignment information on where the IP address or domain name is located or owned, or DNSBLs that return flow statistics from the DNSBL operator that are intended for the DNSBL user to interpret, need not ever be removed, just kept reasonably current.</li>
<li>DNSBLs based on relatively static information, such as block assignment or domain names of demonstrably bad actors MAY have very long expiration intervals or be removed only upon request after verification that the removal criteria have been met.</li>
<li>Automated DNSBLs with highly effective detection and fast listing mechanisms can benefit from very short expiration intervals.  Many of the things that these DNSBLs look for are of relatively short duration, and even if they do expire, a resumption of the behavior will be caught quickly by the DNSBL's detection mechanisms and relisted.  By utilizing a short expiration interval, after reassignment/problem correction, the listing will automatically expire in short order without manual intervention.</li>
<li>Manually created DNSBL entries SHOULD be periodically reviewed in some manner.</li>
</ol>

<p> </p>
<p id="rfc.section.2.2.1.p.5">It is RECOMMENDED that DNSBL operators publish in general terms their expiration policy, even if it's only "delist on request" or no expiration is performed.  In information-only lists, a method for users requesting corrections to the information (if appropriate) SHOULD be published.  Abusers may be able to "game" policy that is too explicit; on the other hand, many DNSBL users wish to have an idea of how "current" the DNSBL is.  It is the authors' experience that some automated DNSBLs have increasingly higher error rates as the "last detection date" gets older.  </p>
<p id="rfc.section.2.2.1.p.6">Note that listings being temporary does not mean that some listings will not remain after the initial time out period. If the DNSBL operator determines that the conditions triggering listing still exist, then the timer for determining time outs can be renewed.</p>
<h1 id="rfc.section.2.2.2">
<a href="#rfc.section.2.2.2">2.2.2.</a> A Direct Non-Public Way to Request Removal SHOULD Be Available</h1>
<p id="rfc.section.2.2.2.p.1">Discussions about whether a DNSBL should remove an entry MAY include activity in a public forum.  Methods for processing removal requests through private, direct exchanges, such as person-to-person email or a combination of web page requests and email responses, SHOULD be available.  As a minimum, the DNSBL SHOULD have a web page that has a removal request function (separate from the page describing listing criteria as per <a href="#listing_criteria">Section 2.1.1</a>).  The DNSBL SHOULD also make available an email address to handle issues other than blocking issues.</p>
<p id="rfc.section.2.2.2.p.2">The DNSBL operator MUST NOT use the list in question in such a way that removal requests would be blocked, and, moreover, SHOULD make mailboxes available in order to allow affected users to submit their requests.  In some cases it is impractical not to filter email to accounts due to the amount of spam those mailboxes receive.  If filtering should be necessary in such circumstances, filtering methods with as low false positive rate as practical SHOULD be chosen.</p>
<p id="rfc.section.2.2.2.p.3">DNSBL operators SHOULD be prepared to provide alternate means of contact in case of system failure due to DDoS (Distributed Denial of Service attack) or other reasons.  </p>
<h1 id="rfc.section.2.2.3">
<a href="#rfc.section.2.2.3">2.2.3.</a> Response SHOULD Be Prompt</h1>
<p id="rfc.section.2.2.3.p.1">A response to removal requests or queries about a listing SHOULD be prompt.  A DNSBL operator SHOULD respond within two days and MUST respond within 7 days, unless the DNSBL operator has deemed that further discussion of the issue will not result in meeting the conditions for removal, and notifies the requestor of that decision.</p>
<p id="rfc.section.2.2.3.p.2">Consequent removals (if the conditions for removal are met) should be similarly prompt.</p>
<p id="rfc.section.2.2.3.p.3">A DNSBL MAY impose restrictions on who (e.g. network operator's representative or domain name owner) may make valid removal requests.  However, in many DNSBLs this is inadvisable because it requires impractical amounts of effort and is hence NOT RECOMMENDED in most cases.</p>
<p id="rfc.section.2.2.3.p.4">Many DNSBLs (especially those with highly effective detection and fast listing mechanisms) greatly benefit from a "no questions asked" removal policy.</p>
<p id="rfc.section.2.2.3.p.5">Although this approach allows people to submit a request and have any listed IP address/domain name removed immediately, it does not prevent the DNSBL operator from re-listing the IP address/domain name at a later time.</p>
<p id="rfc.section.2.2.3.p.6">Many DNSBLs can effectively use a "no questions asked" removal policy because by their very nature they will redetect or relist problems almost immediately.  They can mitigate more organized attempts to "game" the system by elementary checking and rate-limiting procedures, increasing lockout periods, rescans etc.  Furthermore, a few IP addresses more or less usually do not make a significant difference in the overall effectiveness of a DNSBL.  Moreover, a "no questions asked" removal policy provides the huge benefit of a swift reaction to incorrect listings.</p>
<p id="rfc.section.2.2.3.p.7">As an example, one popular DNSBL uses a "no questions asked" removal policy, but does perform rate-limiting and malicious removal detection and mitigation.</p>
<p id="rfc.section.2.2.3.p.8">Another important consideration supporting a "no questions asked" self-removal policy is that it forestalls many conflicts between DNSBL operators and organizations whose IP addresses/domain names have been listed.  Such a policy may be an effective measure to prevent small issues from becoming big problems.</p>
<h1 id="rfc.section.2.2.4">
<a href="#rfc.section.2.2.4">2.2.4.</a> SHOULD Have Similar Criteria for Listing and Delisting</h1>
<p id="rfc.section.2.2.4.p.1">The criteria for being removed from a DNSBL SHOULD bear a reasonable relationship to the factors that were the cause of the addition to the DNSBL.  If a listed entity fulfills all published requirements for removal from a DNSBL, then the DNSBL operator SHOULD NOT impose any additional obstacles to remove a given entry from the DNSBL.  There SHOULD NOT be any extra rules for de-listing other than the ones listed in the published listing criteria.</p>
<h1 id="rfc.section.2.2.5">
<a href="#rfc.section.2.2.5">2.2.5.</a> Conflict of Interest</h1>
<p id="rfc.section.2.2.5.p.1">Some DNSBLs used for blocking/negative reputation have had a practise of requiring fees or donations to charities from the listee for delisting.  </p>
<p id="rfc.section.2.2.5.p.2">It is generally considered entirely appropriate for a DNSBL to charge for access to it by its users - the definition of a commercial DNSBL.  </p>
<p id="rfc.section.2.2.5.p.3">However, the practise of requiring a listee to pay for delisting from a negative connotation DNSBL steers perilously close to notions of extortion, blackmail or a "protection racket". Even when such accusations are entirely unjustified the practise causes uproar and damage to the DNSBL's reputation, if not the entire DNSBL mechanism as a whole.  </p>
<p id="rfc.section.2.2.5.p.4">Therefore, negative-connotation DNSBLs MUST not charge fees or require donations for delisting or "faster handling", and it is RECOMMENDED that such DNSBLs that do charge fees or require donations not be used.  </p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Operational Issues</h1>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> <a href="#limited" id="limited">DNSBL Query Root Domain Name SHOULD be a Subdomain</a>
</h1>
<p id="rfc.section.3.1.p.1">By virtue of using domain names, a DNSBL is a hierarchy with a root anchored in the global Internet.  The DNSBL "query root" SHOULD be below the registered domain name, so that the DNSBL information is not conflated with domain name housekeeping information (e.g., name server or MX records) for the domain name.  By using this approach, DNSBL queries would take the form of "&lt;query&gt;.dnsbl.example.com" rather than "&lt;query&gt;.example.com".  Further, this sub-tree should have its own name servers.  Thus, the DNSBL query root has its own zone file containing the DNSBL information, and the registered domain name has its own name servers containing the information (MX records etc.) for the domain name.  This approach facilitates clear delineation of function as well as orderly DNSBL shutdown because the DNSBL name server records can be specified separately from the domain name's principal name servers.</p>
<p id="rfc.section.3.1.p.2">Many DNSBLs support more than one logical zone (DNSBL entries with different meanings) that DNSBL users may wish to treat differently (or even ignore).  It is RECOMMENDED that, even if there is a single DNSBL zone with entry type distinguished by return code, that separate subdomain names (of the query root) consist only of the corresponding entries.  For example, entry types "A" and "B" might return 127.0.0.2 and 127.0.0.3 from the consolidated zone (eg: dnsbl.example.com), but there should also be zones typeA.dnsbl.example.com and typeB.dnsbl.example.com that contain their respective types only.  See also <a href="#updown">Section 3.3</a>.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> <a href="#provisioning" id="provisioning">DNSBLs SHOULD be Adequately Provisioned</a>
</h1>
<p id="rfc.section.3.2.p.1">The DNSBL SHOULD have sufficient name server capacity to handle the expected loading, and have sufficient redundancy to handle normal outages.</p>
<p id="rfc.section.3.2.p.2">Name servers SHOULD provide appropriate glue records, possibly in different TLDs to protect against single-TLD issues.</p>
<p id="rfc.section.3.2.p.3">If the DNSBL offers zone transfers (in addition to or instead of standard DNSBL query mechanisms), it SHOULD be sufficiently provisioned to handle the expected loading.</p>
<p id="rfc.section.3.2.p.4">Note that some DNSBLs have been subject to distributed denial of service attacks. Provisioning SHOULD take the likelihood of this into account, and include plans for dealing with it.</p>
<h1 id="rfc.section.3.3">
<a href="#rfc.section.3.3">3.3.</a> <a href="#updown" id="updown">DNSBLs SHOULD Provide Operational Flags</a>
</h1>
<p id="rfc.section.3.3.p.1">Most IP address-based DNSBLs follow a convention of query entries for IP addresses in 127.0.0.0/8 (127.0.0.0-127.255.255.255) to provide on line indication of whether the DNSBL is operational.  Many, if not most, DNSBLs arrange to have a query of 127.0.0.2 return an A record (usually 127.0.0.2) indicating that the IP address is listed.  This appears to be a de facto standard indicating that the DNSBL is operating correctly.  See <a href="#RFC5782">[RFC5782]</a> for more details on DNSBL test entries.</p>
<p id="rfc.section.3.3.p.2">If this indicator is missing (query of 127.0.0.2 returns NXDOMAIN), the DNSBL should be considered non-functional.</p>
<p id="rfc.section.3.3.p.3">There does not appear to be a de facto standard for test entries within domain name-based DNSBLs.  A number use the same 127.0.0.2 query test mechanism as IP address-based DNSBLs, and others use a variety of domain name-based test entries.  Due to the way many domain name-based DNSBLs are used (eg: hostname parts of URIs in email bodies), using anything likely to appear in a legitimate email message is a bad idea (eg: http://example.com), especially considering that some email readers will transform bare IP addresses or domain names appearing in the body of an email into links.  So, even 127.0.0.2 may be problematic.  But a common testing method is desirable.</p>
<p id="rfc.section.3.3.p.4">In the absence of new emerging standards, it is RECOMMENDED that domain name-based DNSBLs use a test entry of "test".  Test is chosen because it is a reserved top-level-domain.  </p>
<p id="rfc.section.3.3.p.5">Note: In <a href="#down">Section 3.4</a> it is noted that some DNSBLs have shut down in such a way to list all of the Internet.  Further, in <a href="#reserved">Section 3.5</a>, DNSBL operators MUST NOT list 127.0.0.1.  Therefore, a positive listing for 127.0.0.1 SHOULD indicate that the DNSBL has started listing the world and is non-functional. Similarly, a domain-based DNSBL SHOULD NOT ever list the reserved domain INVALID, and a positive listing for INVALID SHOULD indicate that the DNSBL is non-functional.</p>
<p id="rfc.section.3.3.p.6">Other results, such as 127.0.0.3, may have different meanings.  This operational flag usage and meaning SHOULD be published on the DNSBL's web site, and the DNSBL user SHOULD periodically test the DNSBL.</p>
<p id="rfc.section.3.3.p.7">Some mail systems are unable to differentiate between these various results or flags, however, so a public DNSBL SHOULD NOT include opposing or widely different meanings -- such as 127.0.0.23 for "sends good mail" and 127.0.0.99 for "sends bad mail" -- within the same DNS zone.  </p>
<h1 id="rfc.section.3.4">
<a href="#rfc.section.3.4">3.4.</a> <a href="#down" id="down">Shutdowns MUST Be Done Gracefully</a>
</h1>
<p id="rfc.section.3.4.p.1">A number of DNSBLs have shut down operations in such a way as to list the entire Internet, sometimes without warning.  These were usually done this way to force DNSBL users (mail administrators) to adjust their DNSBL client configurations to omit the now inoperative DNSBL and to shed the DNS query load from the registered domain name servers for the DNSBL.  Popular DNSBLs are used by tens of thousands of sites, yet, the correct operation of the DNSBLs are not well monitored by their users.  The DNSBL query clients are often not compliant with DNSBL query conventions (e.g.: will treat any A record returned as being "listed", instead of specific 127/8 A record returns) hence shutdowns (or even ordinary domain name expiration) can be quite destructive to all email flow if not done properly.</p>
<p id="rfc.section.3.4.p.2">The DNSBL operator MUST issue impending shutdown warnings (on the DNSBL web site, appropriate mailing lists, newsgroups, vendor newsletters etc), and indicate that the DNSBL is inoperative using the signaling given in <a href="#updown">Section 3.3</a>.</p>
<p id="rfc.section.3.4.p.3">Only after these warnings have been issued for a significant period of time (RECOMMENDED: one or more months), should the DNSBL operator finally shutdown the DNSBL.</p>
<p id="rfc.section.3.4.p.4">The shutdown procedure should have the following properties: </p>

<ol>
<li>MUST NOT list the entire Internet</li>
<li>SHOULD shed the DNSBL query load from the DNSBL name servers, permitting the registered domain name to continue being usable.</li>
<li>SHOULD, perhaps through increased delays, indicate to the Mail administrator that the DNSBL is no longer functional.</li>
<li>Name server or query lookups MUST NOT be aimed at third parties unrelated to DNSBL operation.  Such behavior is similar to inflicting a DDOS attack.</li>
<li>The base domain name SHOULD be registered indefinitely, so as to ensure that the domain name doesn't represent a "booby trap" for future owners, and/or provide a means by which a new owner could maliciously list the entire Internet.</li>
</ol>
<p id="rfc.section.3.4.p.5">One way of satisfying the points 1-4 above is to change the DNS name servers for the DNSBL to point at "TEST-NET" addresses (see <a href="#RFC3330">[RFC3330]</a>). The below suggested <a href="#BIND">[BIND]</a> declarations will cause a DNSBL query to query non-existent name servers in TEST-NET addresses, which will result in a significant delay (usually more delay as the number of non-existent TEST-NET name servers is increased, but not return any A records except in very unusual circumstances.</p>
<div id="#rfc.figure.1"></div>
<p>BIND-equivalent DNS declarations for DNSBL shutdown.  </p>
<pre>
dnsbl.example.com.  604800  IN  NS  u1.example.com.
u1.example.com.     604800  IN  A   192.0.2.1

dnsbl.example.com.  604800  IN  NS  u2.example.com.
u2.example.com.     604800  IN  A   192.0.2.2

dnsbl.example.com.  604800  IN  NS  u3.example.com.
u3.example.com.     604800  IN  A   192.0.2.3

... [as many NS/A record pairs as you like]
             </pre>
<p>This example assumes that the DNSBL is named "dnsbl.example.com".  Replace "example.com" and "dnsbl.example.com" as appropriate for the DNSBL.</p>
<p></p>

<dl>
<dt>NOTE:</dt>
<dd style="margin-left: 8">Of course, the above shutdown procedure cannot be implemented if <a href="#limited">Section 3.1</a> is not followed.</dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.5">
<a href="#rfc.section.3.5">3.5.</a> <a href="#reserved" id="reserved">Listing of Special and Reserved IP Addresses MUST be Disclosed</a>
</h1>
<p id="rfc.section.3.5.p.1">The DNSBL MAY list loopback, <a href="#RFC1918">[RFC1918]</a>, LINK-LOCAL class <a href="#RFC3927">[RFC3927]</a>, class D/E, and any other permanently reserved or special-use IP addresses <a href="#RFC3330">[RFC3330]</a> (and <a href="#RFC5156">[RFC5156]</a> for IPv6), <a href="#RFC5156">[RFC5156]</a>.  Such use MUST be disclosed in the documentation related to the DNSBL.</p>
<p id="rfc.section.3.5.p.2">As additional insurance against listings of space that should not be listed through testing or other unforeseen events, DNSBL operators SHOULD consider implementing facilities to prevent them.  At least one popular automated DNSBL has implemented permanent exclusions for such addresses.</p>
<p id="rfc.section.3.5.p.3">A functioning DNSBL MUST NOT list 127.0.0.1.  There are a number of mail server implementations that do not cope with this well, and many will use a positive response for 127.0.0.1 as an indication that the DNSBL is shut down and listing the entire Internet.</p>
<h1 id="rfc.section.3.6">
<a href="#rfc.section.3.6">3.6.</a> Considerations for DNSBLs Listing Insecure Hosts</h1>
<p id="rfc.section.3.6.p.1">Some DNSBLs list IP addresses of hosts that are insecure in various ways (e.g. open relays, open proxies).  The following recommendations for such DNSBLs may not be relevant to other types of DNSBLs.</p>
<p id="rfc.section.3.6.p.2">The practise of scanning for vulnerabilities can represent a risk in some jurisdictions.  The following recommendations for such DNSBLs MAY help alleviate this risk.</p>
<h1 id="rfc.section.3.6.1">
<a href="#rfc.section.3.6.1">3.6.1.</a> MUST NOT Scan Without Provocation</h1>
<p id="rfc.section.3.6.1.p.1">DNSBLs MUST NOT automatically probe for insecure hosts without provocation. There is little agreement in the community as to whether or not such activity should be allowed, so this BCP errs on the side of caution.</p>
<p id="rfc.section.3.6.1.p.2">Therefore, scanning MUST be targeted, rather than broad-based, where a given scan is motivated by a specific reason to have concern about the address being scanned.  Examples of such reasons include delivery of an email, delivery to a spam trap address, receipt of a user complaint, or periodic testing of an address that is already listed.</p>
<h1 id="rfc.section.3.6.2">
<a href="#rfc.section.3.6.2">3.6.2.</a> Re-scan Periods SHOULD be Reasonable</h1>
<p id="rfc.section.3.6.2.p.1">If the DNSBL operator re-scans a host in order to determine whether the listing SHOULD time out or not, the re-scan period SHOULD be reasonable.  Automated scanning SHOULD NOT occur more often than once every 24 hours.</p>
<p id="rfc.section.3.6.2.p.2">It is RECOMMENDED that automated re-scanning should cease within a reasonable period of the vulnerability no longer existing, and targeting conditions no longer being met.</p>
<h1 id="rfc.section.3.6.3">
<a href="#rfc.section.3.6.3">3.6.3.</a> Scans MUST NOT be Destructive</h1>
<p id="rfc.section.3.6.3.p.1">In the past, some scanning mechanisms have proven to adversely impact the scanned host, sometimes in severe fashion.  Scanning methodologies MUST NOT negatively impact the scanned host.</p>
<h1 id="rfc.section.3.7">
<a href="#rfc.section.3.7">3.7.</a> Removals SHOULD Be Possible in Absence of the DNSBL Operator</h1>
<p id="rfc.section.3.7.p.1">If removals cannot be automated (e.g., via robot re-testing or self-removal) then the DNSBL SHOULD have multiple administrators so that a removal request can be processed if the principal list administrator is on vacation or otherwise unavailable.</p>
<h1 id="rfc.section.3.8">
<a href="#rfc.section.3.8">3.8.</a> Protect Against Misconfiguration/Outages</h1>
<p id="rfc.section.3.8.p.1">It is not altogether uncommon for DNSBL users to configure their systems improperly for DNSBL queries.  The consequences of an error can range from undue (or even damaging) load on the DNSBL servers, to accidentally blocking all incoming email.</p>
<p id="rfc.section.3.8.p.2">DNSBL users MUST test their initial DNSBL configurations to ensure that they're working correctly, and SHOULD periodically recheck the status of the DNSBLs they use and adjust their configuration as necessary.</p>
<p id="rfc.section.3.8.p.3">Common types of misconfigurations include:</p>
<p></p>

<ol>
<li>Using wrong (sub-)zones for querying (e.g. 4.3.2.1.example.com or 4.3.2.1.dnsbl.exmple.cm instead of 4.3.2.1.dnsbl.example.com).</li>
<li>Downloading a local mirror of the data, but failing to set up the local name server infrastructure appropriately, and thus continuing to query the public name servers.</li>
<li>Downloading a local mirror of the data, but misconfiguring the local name server infrastructure to query a locally invented zone name (4.3.2.1.dnsbl.local) at the public name servers.</li>
<li>Misconfiguring local name servers to not do meaningful caching, thus heavily increasing load on the public name servers.</li>
<li>Using the DNSBL query root domain name as the name server for queries.</li>
<li>Using the DNSBL incorrectly; e.g. Some DNSBLs are suitable only for certain types of filtering.  Improper use may result in excessive incorrect filtering.</li>
</ol>

<p> </p>
<p id="rfc.section.3.8.p.5">While in many cases, it can be difficult to detect such situations, to protect against such misconfiguration it is RECOMMENDED that DNSBL operators make design decisions to mitigate the impact of such mistakes, and make efforts to contact administrative contacts to remedy the situation where appropriate.  But the DNSBL operator SHOULD also prepare to take appropriate steps to protect the operational infrastructure (e.g., have the ability to block abusive users from causing further damage).</p>
<p id="rfc.section.3.8.p.6">Appropriate use of the DNSBL (e.g. email, not IRC, not against authenticated local users) SHOULD be documented on the web site.</p>
<h1 id="rfc.section.3.9">
<a href="#rfc.section.3.9">3.9.</a> Error Handling</h1>
<p id="rfc.section.3.9.p.1">From time to time, DNSBLs have encountered operational data integrity or data collection problems that have resulted in improper listings.  For example: data corruption, erroneous restoration of since-resolved listings, or grossly misfiring detection heuristics.  This has often results in great consternation over what appear to be nonsensical listings or listings for previously resolved issues.  </p>
<p id="rfc.section.3.9.p.2">Many DNSBLs have implemented policies and procedures whereby such situations result in the purging of even slightly doubtful entries, disconnection of untrustworthy components until the entries' validity or correct operation of the component can be verified or corrected, as well as provide notification of the issue on the DNSBL's web pages.  </p>
<p id="rfc.section.3.9.p.3">As an example, one popular DNSBL has a demonstrated track record of disabling faulty data collection mechanisms, purging all listings generated by the faulty mechanism, and publishing a brief description of the problem and course of remediation.  </p>
<p id="rfc.section.3.9.p.4">Therefore, DNSBLs SHOULD have policies and procedures in place to treat operational problems conservatively, be prepared to mass purge dubious entries, prevent future erroneous entries, and notify their users by the DNSBL's web page.  </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Security Considerations</h1>
<p id="rfc.section.4.p.1">Any system manager that uses DNSBLs is entrusting part of his or her server management to the parties that run the lists.  A DNSBL manager that decided to list 0/0 (which has actually happened) could cause every server that uses the DNSBL to reject all mail.  Conversely, if a DNSBL manager removes all of the entries (which has also happened), systems that depend on the DNSBL will find that their filtering doesn't work as they want it to.</p>
<p id="rfc.section.4.p.2">If a registered domain name used for a DNSBL is allowed to lapse, or the DNSBL user spells the DNSBL domain name incorrectly, the system manager's server management is now subject to an entirely different party than was intended.  Further, even if there is no malicious intent, some DNSBL query clients will interpret any A record being returned as being listed.  DNSBL users SHOULD be prepared to periodically test the DNSBLs they use for correct operation.</p>
<p id="rfc.section.4.p.3">Like all DNS-based mechanisms, DNSBLs are subject to various threats outlined in <a href="#RFC3833">[RFC3833]</a>.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> IANA Considerations</h1>
<p id="rfc.section.5.p.1">This document has no actions for IANA. [This section may be removed before publishing as an RFC.]</p>
<h1 id="rfc.references">
<a href="#rfc.references">6.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">6.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC1918">[RFC1918]</b></td>
<td class="top">
<a href="mailto:yakov@cisco.com" title="Cisco systems">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com" title="Chrysler Corporation">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net" title="RIPE Network Coordination Centre">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net" title="RIPE Network Coordination Centre">Groot, G.</a> and <a href="mailto:lear@sgi.com" title="Silicon Graphics, Inc.">E. Lear</a>, "<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>", BCP 5, RFC 1918, February 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2014">[RFC2014]</b></td>
<td class="top">
<a href="mailto:weinrib@intel.com" title="Intel Corporation, MS JF2-74">Weinrib, A.</a> and <a href="mailto:postel@isi.edu" title="USC - ISI, Suite 1001">J. Postel</a>, "<a href="http://tools.ietf.org/html/rfc2014">IRTF Research Group Guidelines and Procedures</a>", BCP 8, RFC 2014, October 1996.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3927">[RFC3927]</b></td>
<td class="top">
<a>Cheshire, S.</a>, <a>Aboba, B.</a> and <a>E. Guttman</a>, "<a href="http://tools.ietf.org/html/rfc3927">Dynamic Configuration of IPv4 Link-Local Addresses</a>", RFC 3927, May 2005.</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">6.2.</a> Informative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RSYNCTHESIS">[RSYNCTHESIS]</b></td>
<td class="top">
<a title="The Australian National University">Tridgell, A</a>, "<a>Efficient Algorithms for Sorting and Synchronization</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="RSYNC">[RSYNC]</b></td>
<td class="top">
<a>Tridgell, A</a>, "<a>rsync</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="RFC5782">[RFC5782]</b></td>
<td class="top">
<a>Levine, J.</a>, "<a href="http://tools.ietf.org/html/rfc5782">DNS Blacklists and Whitelists</a>", RFC 5782, February 2010.</td>
</tr>
<tr>
<td class="reference"><b id="BIND">[BIND]</b></td>
<td class="top">
<a>Internet Systems Corporation</a>, "<a>ISC BIND</a>", .</td>
</tr>
<tr>
<td class="reference"><b id="RFC3330">[RFC3330]</b></td>
<td class="top">
<a>IANA</a>, "<a href="http://tools.ietf.org/html/rfc3330">Special-Use IPv4 Addresses</a>", RFC 3330, September 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3833">[RFC3833]</b></td>
<td class="top">
<a>Atkins, D.</a> and <a>R. Austein</a>, "<a href="http://tools.ietf.org/html/rfc3833">Threat Analysis of the Domain Name System (DNS)</a>", RFC 3833, August 2004.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5156">[RFC5156]</b></td>
<td class="top">
<a>Blanchet, M.</a>, "<a href="http://tools.ietf.org/html/rfc5156">Special-Use IPv6 Addresses</a>", RFC 5156, April 2008.</td>
</tr>
</tbody></table>
<h1 id="rfc.appendix.Appendix A">
<a href="#rfc.appendix.Appendix%20A">Appendix A.</a> <a href="#app-additional" id="app-additional">Acknowledgements</a>
</h1>
<p id="rfc.section.Appendix A.p.1">We would like to thank John R. Levine, Alan Murphy and Dave Crocker for their insightful comments.</p>
<p id="rfc.section.Appendix A.p.2">We would also like to thank Yakov Shafranovich and Nick Nicholas for editing previous versions of this document.</p>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Chris Lewis</span> 
	  <span class="n hidden">
		<span class="family-name">Lewis</span>
	  </span>
	</span>
	<span class="org vcardline">Nortel Networks</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:clewisbcp@cauce.org">clewisbcp@cauce.org</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Matt Sergeant</span> 
	  <span class="n hidden">
		<span class="family-name">Sergeant</span>
	  </span>
	</span>
	<span class="org vcardline">Symantec Corporation</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:matt_sergeant@symantec.com">matt_sergeant@symantec.com</a></span>

  </address>
</div>

</body>
</html>