Internet Engineering Task Force                          
Internet-Draft                                            

                                 Shiva Raman Pandey
                Sasken Communication Technologies Ltd.
                                 Bangalore, India

Expires - Jan 2003
                                July 2002


           Extending Mobile IPv4 for Multi-mode Terminals
            <draft-shiva-mobileip-multimode-terminals-v4-00.txt>


Status of this memo

This document is an Internet-Draft and is in full conformance with
all provisions of Section 10 of RFC 2026.

Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups. Note that other
groups may also distribute working documents as Internet-Drafts.

Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any
time. It is inappropriate to use Internet-Drafts as reference
material or cite them other than as "work in progress".

The list of current Internet-Drafts can be accessed at
http://www.ietf.org/ietf/lid-abstracts.txt

The list of Internet-Draft Shadow Directories can be accessed at
http://www.ietf.org/shadow.html


Abstract

Mobile IP[1] has emerged as a preferred solution for the macro mobility
problem. In this draft, we discuss a possible extension to the existing
Mobile IPv4 for multi-mode wireless terminals.  This extension is based
on [2] and has several advantages, including lesser packet delay,
reduced traffic load on the home agent and lesser packet loss during
handoff. In addition. This also allows the mobile node to take full
advantage of Layer-2 specific features provided by the network. The
proposal in this draft is in its initial stage and needs to be further
studied.

Acknowledgements

The author would like to thank Ravindra B Keskar, Manoj Dixit and Umesh
MN for their valuable review comments.




Shiva Raman Pandey                                            [Page 1]
Internet Draft Extending Mobile IPv4 for Multi-mode Terminals July 2002


Table of Contents

1. Introduction
    1.1 Protocol Requirements
    1.2 Goal
    1.3 Assumptions
    1.4 New Architectural Entities
2. Terminology
3. The proposed protocol 
   3.1 Overview
   3.2 An Example Scenario of the protocol
4. New Signalling Messages
   4.1 THA Registration Request Message
   4.2 THA Table update message
5. Summary
6. References
7. Author's Address

1. Introduction

In Mobile IP [1] there are three main entities : Home Agent(HA),
Foreign Agent(FA) and Mobile Node(MN). Whenever the MN enters into a
new network, it obtains a care-of-address and registers it with its HA.
The HA tunnels all datagrams meant for MN to its care-of-address and
the packets are de-capsulated at the receiving end of the tunnel.
Mobile IP uses UDP port 434 for signalling.

In this draft we consider the MN to be a multi-mode terminal that has
multiple network cards to access to several Layer 2 technologies. The
MN is also assumed to have ability to encapsulate and decapsulate IP
packets. 

The proposed solution discusses the concept of creating multiple
Temporary Home Agents(THA) to make Mobile IP more suitable for
multi-mode terminals. 

The MN registers itself with a Temporary Home Agent(THA)when it moves
into a new Layer-2 technology network. This THA has a disabled entry
for the MN. This entry is enabled once the MN moves out of this network
. This enabled entry tells the THA to forward all the packets meant for
the MN to MN's new IP address. 

1.1. Protocol Requirements

This protocol must provide a shorter path to the packets belonging to
sessions initiated in any of the previously visited new technology
networks.

This protocol must reduce the load of the permanent Home Agent.




Shiva Raman Pandey                                            [Page 2]
Internet Draft Extending Mobile IPv4 for Multi-mode Terminals July 2002

A mobile node must be able to communicate with other nodes that do not
implement these mobility functions.  No protocol enhancements are 
required in hosts or routers that are not acting as any of the new
architectural entities introduced in Section 1.4 or standard Mobile IP
entities.

1.2. Goals

The goal of this protocol is to improve the efficiency of the Mobile IP
[1] in heterogeneous L2 technology networks. It reduces the time taken
by the packet to reach the MN. If reverse tunneling is used theprotocol
reduces the time delay in the reverse direction also. This protocol 
reduces the traffic load on permanent HA. It also reduces the packet
loss during the handoffs and allows the mobile node to take full
advantage of Layer-2 specific features provided by the network.


1.3. Assumptions

A multi-mode mobile node must be having two or more network interface
cards. It must have access to the other networks to which it is
entering. The MN must be able to encapsulate and decapsulate IP
packets. Security and other policies between the home and the visited
networks are not considered in this draft.

1.4. New Architectural Entities

This protocol introduces the following one functional entity:

Temporary Home Agent (THA)

A router on a mobile node's visited network, which tunnels datagrams 
for delivery to the mobile node when it has left this network and is 
moved into a network with different Layer-2 technology.

THA Table

This is a table maintained by mobile node which contains the entries of
all THAs that have entry of the MN enabled.

2.  Terminology

The keywords "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in
this document are to be interpreted as described in RFC 2119 [3].

Other than these keywords, the draft uses the following terms 
frequently :

Mobile Node:

Mobile Node in the context of this draft refers to a multi-mode mobile
node with the ability to encapsulate and decapsulate packets.

Shiva Raman Pandey                                            [Page 3]
Internet Draft Extending Mobile IPv4 for Multi-mode Terminals July 2002


Primary Network Card:

One of the network cards of the MN will act as the Primary Network Card. 
It will be the preferred network card always. This card will have a 
permanent home agent associated with it.

Primary Home Address:

The IP address of the primary network card is called Primary Home 
Address.

Primary Home Network:

The home network of the primary network card is called Primary Home 
Address. The primary home network stores several information such as
user profiles, billing information, AAA related information etc.

Temporary Home Address:

The IP address assigned to any non-primary network card is called the
Temporary Home Address.

Permanent Home Agent (PHA)

The home agent in the primary home network to which the MN belongs is
called the Permanent Home Agent. In this draft the terms Permanent Home
Agent and Home Agent are used interchangeably.

Temporary Home Agent (THA) 

A router on a mobile node's visited network, which tunnels datagrams
for delivery to the mobile node when it has left this network and is
moved into a network with a different Layer-2 technology. 

3. The Proposed protocol

3.1 Overview

In this protocol when an MN leaves its PHA and enter a visited network 
with a different Layer-2 technology, it gets a new IP address from the
L2 server. The exact mechanism by which the new IP address is given is
Layer-2 dependent and is beyond the scope of this draft. The MN sends a
THA registration request to the THA server. The MN registers with the
THA with the mode disabled. Note that the registration with THA is
different from Mobile IP registration. The THA registration request
contains the IP address of the PHA as well as the IP address of all the
THAs in the THA table. 






Shiva Raman Pandey                                            [Page 4]
Internet Draft Extending Mobile IPv4 for Multi-mode Terminals July 2002

The THA consequently sends the Mobile IP registration requests to the
PHA and all the THAs in the registration request. The Mobile IP
registration request keeps the new Temporary Home Address of the MN as
its care-of-address. All the sessions that are carried over from its
primary home network are tunneled to the MN by PHA. Whenever the MN
gets a packet with the source address as its PHA or any THA in its THA
Table, it decapsulates the packet before passing it to the upper layers
. The MN encapsulates the outgoing packets of this session with the
same source address. The MN uses it new Temporary Home Address for any
new session it initiates. Any corresponding node that wants to initiate
a new session with the MN, uses the new temporary home address. 

When this MN leaves this visited network and enters another one,this
THA is signaled to enable its entry. The MN adds a new entry of the
enabled THA into its THA Table. A timer is started and initialised to
zero within the THA and the MN. Every time the THA receives a packet
to/from the MN, it resets the timer to zero. Once the timer reaches a
threshold value the entry for the MN is deleted from the THA. Similarly
every time the MN sends or receives a packet to/from the THA, it resets
the timer to zero. Once the timer reaches a threshold value the entry
for the THA is deleted from the THA Table. 

If both current and previous networks have the same Layer-2
technologies, then normal Mobile IP is used by considering the previous
network as home and the new network as foreign. 

3.1 An Example Scenario of the protocol

Suppose we have four wireless networks as follows:
Network                   Wireless Technology
N1                         W1
N2                         W2
N3                         W2
N4                         W3

The MN has 3 network cards C1, C2, C3. Network N1 is its primary home
network. 

step 1) The MN boots up in the N1 with IP address IP1. It doesn't need
any Mobile IP support in its home network. It initiates a session S1 
using its address IP1. The network N1 has permanent home agent PHA.

Step 2) The MN moves to the network N2. The MN gets the a IP address
IP2 using its network card C2. The MN sends a THA registration request
to the temporary home agent THA1. THA1 registers the MN with its entry
marked as disabled. THA1 sends the Mobile IP registration request to
the PHA with IP2 as care-of-address. The MN initiates a new session S2
using its IP address IP2. 

The packets belonging to session S1 are tunneled by PHA to IP2. The 
MN decapsulates the packets that it receives with PHA as source address
before passing it to upper layers. The MN encapsulates the packets
belonging to session S1 with IP1 as outer address.

Shiva Raman Pandey                                            [Page 5]
Internet Draft Extending Mobile IPv4 for Multi-mode Terminals July 2002


Step 3) The MN moves to network N3. Either MN or network N2 senses the
movement of MN out of network N2. The MN's entry in the THA1 is enabled
and the corresponding status is updated in the THA Table of the MN. A
timer Tmn1 is started in the THA1 as well as in the MN and is reset to
zero with each incoming or outgoing packet via THA1. Once the Tmn1
reaches a threshold Tth, the entry of MN is deleted from the THA1 and 
entry of THA1 is deleted from the THA Table of the MN.

Step 4) In the network N3, MN get a care-of-address from the FA and
registers it with the THA1. Normal Mobile IP is used in this case. All
the new sessions are initiated using the IP address IP2. PHA tunnels
the packets belonging to the session S1 to the IP address IP2.

Step 5) The MN moves to the network N4. The MN gets the new IP address
IP3 using its network card C3. The MN sends a THA registration request
to the temporary home agent THA2. THA2 registers the MN with its entry
marked as disabled. THA2 sends the Mobile IP registration request to
the PHA and THA1 with IP3 as care-of-address. 

The MN initiates a new session S3 using its IP address IP3. The packets
belonging to session S1 are tunneled by PHA to IP3. The packets
belonging to session S2 are tunneled by THA1 to IP3.

Step 6) The timer Tmn1 reaches its threshold. MN's entry gets deleted
from THA1. Corresponding entry from THA Table also gets deleted.

Step 7) The MN moves to network N1. Either MN or network N4 senses the
movement of MN out of network N4. The MN's entry in the THA2 is enabled
. Its status is updated in the THA Table of the MN. The PHA knows that
the MN is back in the home network, so it stops tunneling the packets.
Another timer Tmn2 is started in the THA2 as well as in the MN and is
reset to zero with each incoming or outgoing packet via THA2. Once the 
Tmn2 reaches a threshold Tth, the entry of MN is deleted from the THA2
and the entry of THA2 is deleted from the THA Table.

Step 8) The timer at THA2 reaches its threshold. The MN's entry gets
deleted from THA2. Corresponding entry from the THA Table of the MN
also gets deleted.

4. New Signalling Messages

The following new signalling message is required by this protocol other
than the basic Mobile IP[1] messages.

THA Registration Request Message

Acknowledgement of this messages can be sent as a separate message or
can be piggy-backed with an existing message





Shiva Raman Pandey                                            [Page 6]
Internet Draft Extending Mobile IPv4 for Multi-mode Terminals July 2002


4.1 THA Registration Request Message

This message is sent to the Temporary Home Agent from the MN.
This message requests the THA to do the following  
A) Register the MN with the THA if the entry is already not there.
C) Set the mode of MN's entry in the THA (default is disabled)
D) Send the Mobile IP registration request message to the PHA and
all the THAs given in the THA registration request.

When the MN leaves the network, the same message is used to enable the
MN's entry in the THA.

5. Summary

The suggested protocol helps the mobile node and the network to shorten
the path of the packets belonging to the sessions initiated in the
visited network. It also reduces the traffic load of the primary home
agent. Moreover it enables the mobile nodes to take the advantages of
the L2 specific features of the visited network. These advantages stem
from the fact that the new THA and previous THA will be closer to each
other as compared to the new THA and the PHA. Therefore updating the
previous THA will take lesser time and it will reduce the packet loss 
during the handoff.

The draft is in its preliminary stage and has a lot of open issues.
The specific signalling message formats will be discussed in the
upcoming versions of this draft.

6. References

1. Perkins, IP Mobility Support for IPv4, RFC 3220
2. Junbiao et.al, 3GPP TSG SA WG2, S2-021699 Dual home mobility
     management mechanism in a 3G/WLAN interworking environment
3. Bradner, S., "Key words for use in RFCs to Indicate Requirement
         Levels", BCP 14, RFC 2119 

7. Author's Addresses

Please send your comments to shiva@sasken.com

Shiva Raman Pandey,
Sasken Communication Technologies Ltd
#139/25, Amar Jyoti Layout, Ring Road,
Domlur P.O, Bangalore 560071, India
Phone:+91 80 535 5501 Ext 3296
Fax: +91 80 535 1133:
Email: shiva@sasken.com


Shiva Raman Pandey        Expires - Jan 2003              [Page 7]
