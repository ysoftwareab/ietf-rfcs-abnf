<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IKEv2 Extensions to Support Robust Header Compression over IPsec (ROHCoIPsec)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IKEv2 Extensions to Support Robust Header Compression over IPsec (ROHCoIPsec)">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">E. Ertekin</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">C. Christou</td></tr>
<tr><td class="header">Expires: June 7, 2010</td><td class="header">R. Jasani</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Booz Allen Hamilton</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">T. Kivinen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Safenet, Inc.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">C. Bormann</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Universitaet Bremen TZI</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">December 04, 2009</td></tr>
</table></td></tr></table>
<h1><br />IKEv2 Extensions to Support Robust Header Compression over IPsec (ROHCoIPsec)<br />draft-ietf-rohc-ikev2-extensions-hcoipsec-10</h1>

<h3>Abstract</h3>

<p>In order to integrate Robust Header Compression (ROHC) with IPsec, a mechanism is needed to signal ROHC channel parameters between end-points.  Internet Key Exchange (IKE) is a mechanism which can be leveraged to exchange these parameters.  This document specifies extensions to IKEv2 that will allow ROHC and its associated channel parameters to be signaled for IPsec security associations (SAs).
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on June 7, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<p>
This document may contain material from IETF Documents or IETF
Contributions published or made publicly available before November
10, 2008.  The person(s) controlling the copyright in some of this
material may not have granted the IETF Trust the right to allow
modifications of such material outside the IETF Standards Process.
Without obtaining an adequate license from the person(s) controlling
the copyright in such materials, this document may not be modified
outside the IETF Standards Process, and derivative works of it may
not be created outside the IETF Standards Process, except to format
it for publication as an RFC or to translate it into languages other
than English.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Terminology<br />
<a href="#anchor3">3.</a>&nbsp;
ROHC Channel Initialization for ROHCoIPsec<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
ROHC_SUPPORTED Notify Message<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.1.</a>&nbsp;
ROHC Attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.1.2.</a>&nbsp;
ROHC Attribute Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.2.</a>&nbsp;
ROHC Channel Parameters that are Implicitly Set<br />
<a href="#anchor8">4.</a>&nbsp;
Security Considerations<br />
<a href="#anchor9">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor10">6.</a>&nbsp;
Acknowledgments<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>Increased packet header overhead due to IPsec [IPSEC] can result in the inefficient utilization of bandwidth.  Coupling ROHC [ROHC] with IPsec offers an efficient way to transfer protected IP traffic.
</p>
<p>ROHCoIPsec [ROHCOIPSEC] requires configuration parameters to be initialized at the compressor and decompressor.  Current specifications for hop-by-hop ROHC negotiate these parameters through a link-layer protocol such as Point-to-Point Protocol (PPP) (i.e. ROHC over PPP [ROHC-PPP]). Since key exchange protocols (e.g.  IKEv2 [IKEV2]) can be used to dynamically establish parameters between IPsec peers, this document defines extensions to IKEv2 to signal ROHC parameters for ROHCoIPsec.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC 2119 [BRA97].
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
ROHC Channel Initialization for ROHCoIPsec</h3>

<p>The following subsections define extensions to IKEv2 which enables an initiator and a responder to signal parameters required to establish a ROHC channel for a ROHCoIPsec session.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
ROHC_SUPPORTED Notify Message</h3>

<p>ROHC channel parameters MUST be signaled at either the establishment or rekeying of a Child SA.  Specifically, a new Notify message type is used during the IKE_AUTH and CREATE_CHILD_SA exchanges to convey these parameters.  
</p>
<p>The Notify payload sent by the initiator MUST contain the channel parameters for the ROHC session.  These parameters indicate the capabilities of the ROHC decompressor at the initiator.  Upon receipt of the initiator's request, the responder will either ignore the payload (if it doesn't support ROHC or the proposed parameters) or respond with a Notify payload that contains its own ROHC channel parameters.
</p>
<p>Note that only one Notify payload is used to convey ROHC parameters.  If multiple Notify payloads containing ROHC parameters are received, all but the first such Notify payload MUST be dropped.   If the initiator does not receive a Notify Payload with the responder's ROHC channel parameters, ROHC MUST NOT be enabled on the Child SA. 
</p>
<p>A new Notify Message Type value, denoted ROHC_SUPPORTED, indicates that the Notify payload is conveying ROHC channel parameters (Section 4).
</p>
<p>The Notify Payload (defined in RFC 4306 [IKEV2]) is illustrated in Figure 1.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

                        1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   ! Next Payload  !C!  RESERVED   !         Payload Length        !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !  Protocol ID  !   SPI Size    !      Notify Message Type      !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !                                                               !
   ~                Security Parameter Index (SPI)                 ~
   !                                                               !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   !                                                               !
   ~                       Notification Data                       ~
   !                                                               !
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                      Figure 1. Notify Payload format.
</pre></div>
<p>
<p>
</p>

<p>The fields of the Notify Payload are set as follows:
</p>
<p>Next Payload (1 octet)
			 </p>
<blockquote class="text">
<p>
			 Identifier for the payload type of the next payload in the message.  Further details can be found in RFC 4306 [IKEV2].
</p>
</blockquote>

<p>Critical (1 bit)
				</p>
<blockquote class="text">
<p>
				Since all IKEv2 implementations support the Notify Payload, this value MUST be set to zero.
</p>
</blockquote>

<p>Payload Length (2 octets)
				</p>
<blockquote class="text">
<p>
				As defined in RFC 4306 [IKEV2], this field indicates the length of the current payload, including the generic payload header.
</p>
</blockquote>

<p>Protocol ID (1 octet)
				</p>
<blockquote class="text">
<p>
				Since this Notification message is used during the creation of a Child SA, this field MUST be set to zero.
</p>
</blockquote>

<p>SPI Size (1 octet)
				</p>
<blockquote class="text">
<p>
				This value MUST be set to zero, since no SPI is applicable (ROHC parameters are set at SA creation, thus the SPI has not been defined).
</p>
</blockquote>

<p>Notify Message Type (2 octets)
				</p>
<blockquote class="text">
<p>
				This field MUST be set to ROHC_SUPPORTED.
</p>
</blockquote>

<p>Security Parameter Index (SPI)
				</p>
<blockquote class="text">
<p>
				Since the SPI Size field is 0, this field MUST NOT be transmitted.
</p>
</blockquote>

<p>Notification Data (variable)
				</p>
<blockquote class="text">
<p>
				This field MUST contain at least three ROHC Attributes (Section 3.1.1).
</p>
</blockquote>

<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
ROHC Attributes</h3>

<p>The ROHC_SUPPORTED Notify message is used to signal channel parameters between ROHCoIPsec compressor and decompressor.  The message contains a list of "ROHC Attributes" which contain the parameters required for the ROHCoIPsec session.
</p>
<p>The format for signaling ROHC Attributes takes a similar format to the Transform Attributes described in Section 3.3.5 of RFC 4306[IKEV2].  The ROHC Attribute is shown in Figure 2.
</p>
<p>
			          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
                           1                   2                   3
       0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      !A!     ROHC Attribute Type     !  AF=0  ROHC Attribute Length  !
      !F!                             !  AF=1  ROHC Attribute Value   !
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
      !                   AF=0  ROHC Attribute Value                  !
      !                   AF=1  Not Transmitted                       !
      +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

                Figure 2.  Format of the ROHC Attribute.

</pre></div><p>

<p style='text-align: center'>
</p>

				

<ul class="text">
<li>Attribute Format (AF) (1 bit) - If the AF bit is a zero (0), then the ROHC Attribute is expressed in a Type/Length/Value format.  If the AF bit is a one (1), then the ROHC attribute is expressed in a Type/Value (TV) format.
</li>
<li>ROHC Attribute Type (15 bits) - Unique identifier for each type of ROHC attribute (Section 3.1.2).
</li>
<li>ROHC Attribute Length (2 octets) - Length (in octets) of the Attribute Value.  When the AF bit is a one (1), the ROHC Attribute Value is 2 octets and the ROHC Attribute Length field is not present.
</li>
<li>ROHC Attribute Value (variable length) - Value of the ROHC Attribute associated with the ROHC Attribute Type.  If the AF bit is a zero (0), this field's length is defined by the ROHC Attribute Length field.  If the AF bit is a one (1), the length of the ROHC Attribute Value is 2 octets.
</li>
</ul>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
ROHC Attribute Types</h3>

<p>This section describes five ROHC Attribute Types: MAX_CID, ROHC_PROFILE, ROHC_INTEG, ROHC_ICV_LEN, and MRRU.  The value allocated for each ROHC Attribute Type is specified in Section 4.
</p>
<p>MAX_CID (Maximum Context Identifier, AF = 1)
					</p>
<blockquote class="text">
<p>The MAX_CID attribute is a mandatory attribute.  Exactly one MAX_CID attribute MUST be sent.  The MAX_CID field indicates the maximum value of a context Identifier supported by the ROHCoIPsec decompressor.  This attribute value is two octets in length.  The range of values for MAX_CID MUST be at least 0 and at most 16383 (the value 0 implies having one context).  The recipient of the MAX_CID Attribute MUST only use up to MAX_CID context identifiers for compression.
</p>
</blockquote><p>
					
<p></p>
<blockquote class="text">
<p>Note that the MAX_CID parameter is a one-way notification (i.e., the sender of the attribute indicates what it can handle to the other end); therefore, different values for MAX_CID may be announced in each direction.
</p>
</blockquote>


				

<p>ROHC_PROFILE (ROHC Profile, AF = 1)
                        		</p>
<blockquote class="text">
<p>The ROHC_PROFILE attribute is a mandatory attribute.  Each ROHC_PROFILE attribute has a fixed length of 4 octets, and its attribute value is a two-octet long ROHC Profile Identifier [ROHCPROF].  There MUST be at least one ROHC_PROFILE attribute included in the ROHC_SUPPORTED Notify Message.  If multiple ROHC_PROFILE attributes are sent, the order is arbitrary.  The recipient of a ROHC_PROFILE attribute(s) MUST only use the profile(s) proposed for compression.
</p>
</blockquote><p>
				        
<p></p>
<blockquote class="text">
<p>Several common profiles are defined in RFC 3095 [ROHCV1] and 5225 [ROHCV2].  Note, however, that two versions of the same profile MUST NOT be signaled.  For example, if a ROHCoIPsec decompressor supports both ROHCv1 UDP (0x0002) and ROHCv2 UDP (0x0102), both profiles MUST NOT be signaled.  This restriction is needed, as packets compressed by ROHC express only the 8 least significant bits of the profile identifier; since the 8 least significant bits for corresponding profiles in ROHCv1 and ROHCv2 are identical, the decompressor is not capable of determining the ROHC version that was used to compress the packet.
</p>
</blockquote>

                                        
<p></p>
<blockquote class="text">
<p>Note that the ROHC_PROFILE attribute is a one-way notification; therefore, different values for ROHC_PROFILE may be announced in each direction.
</p>
</blockquote>

                        

<p>ROHC_INTEG (Integrity Algorithm for Verification of Decompressed Headers, AF = 1)
                   	    		</p>
<blockquote class="text">
<p>The ROHC_INTEG attribute is a mandatory attribute.  There MUST be at least one ROHC_INTEG attribute contained within the ROHC_SUPPORTED Notify message.  The attribute value contains the identifier of an integrity algorithm that is used to ensure the integrity of the decompressed packets (i.e. ensure that the decompressed packet headers are identical to the original packet headers prior to compression). 
</p>
</blockquote>

<p></p>
<blockquote class="text">
<p>Authentication algorithms that MUST be supported are specified in the "Authentication Algorithms" table in section 3.1.1 ("ESP Encryption and Authentication Algorithms") of RFC 4835 [CRYPTO-ALG] (or its successor).  
</p>
<p>The integrity algorithm is represented by a two octet value that corresponds to the value listed in the IKEv2 Parameters registry [IKEV2-PARA] "For Transform Type 3 (Integrity Algorithm)" section.  Upon receipt of the ROHC_INTEG attribute(s), the responder MUST select exactly one of the proposed algorithms; the chosen value is sent back in the ROHC_SUPPORTED Notify message returned by the responder to the initiator.  The selected integrity algorithm MUST be used in both directions.  If the responder does not accept any of the algorithms proposed by the initiator, ROHC MUST NOT be enabled on the SA.
</p>
</blockquote><p>
				    
<p></p>
<blockquote class="text">
<p>It is noted that:
									</p>
<ol class="text">
<li>The keys (one for each direction) for this Integrity Algorithm are derived from the IKEv2 KEYMAT (see [IKEV2], Section 2.17).  For the purposes of this key derivation, ROHC is considered to be an IPsec protocol.  When a ROHC-enabled CHILD_SA is rekeyed, the key associated with this integrity algorithm is rekeyed as well.
</li>
<li>A ROHCoIPsec initiator MAY signal a value of zero (0x0000) in a ROHC_INTEG attribute.  This corresponds to "NONE" in the Integrity Algorithm Transform ID registry.  The ROHCoIPsec responder MAY select this value by responding to the initiator with a ROHC_INTEG attribute of zero (0x0000).  In this scenario, no integrity algorithm is applied in either direction.
</li>
<li>The ROHC_INTEG attribute is a parameter that is negotiated between two ends.  In other words, the initiator indicates what it supports; the responder selects one of the ROHC_INTEG values proposed, and sends the selected value to the initiator.
</li>
</ol>
								

</blockquote>

				

<p>ROHC_ICV_LEN (Integrity Algorithm Length, AF = 1)
					</p>
<blockquote class="text">
<p>The ROHC_ICV_LEN attribute is an optional attribute.  There MAY be zero or one ROHC_ICV_LEN attribute contained within the ROHC_SUPPORTED Notify message.  The attribute specifies the number of Integrity Check Value (ICV) octets the sender expects to receive on incoming ROHC packets.  The ICV of the negotiated ROHC_INTEG algorithms MUST be truncated to ROHC_ICV_LEN bytes by taking the first ROHC_ICV_LEN bytes of the output. Both the initiator and responder announce a single value for their own ICV length.  The recipient of the ROHC_ICV_LEN attribute MUST truncate the ICV to the length contained in the message.  If the value of the ROHC_ICV_LEN attribute is zero, then an ICV MUST NOT be sent.  If no ROHC_ICV_LEN attribute is sent at all or the ROHC_ICV_LEN is larger than the length of the ICV of selected algorithm, then the full ICV length as specified by the ROHC_INTEG algorithm MUST be sent.
</p>
</blockquote><p>
					
<p></p>
<blockquote class="text">
<p>Note that the ROHC_ICV_LEN attribute is a one-way notification; therefore, different values for ROHC_ICV_LEN may be announced in each direction.
</p>
</blockquote>

                        

<p>MRRU (Maximum Reconstructed Reception Unit, AF = 1)
					</p>
<blockquote class="text">
<p>The MRRU attribute is an optional attribute.  There MAY be zero or one MRRU attribute contained within the ROHC_SUPPORTED Notify message.  The attribute value is two octets in length.  The attribute specifies the size of the largest reconstructed unit in octets that the ROHCoIPsec decompressor is expected to reassemble from ROHC segments (see Section 5.2.5 of [ROHCV1]).  This size includes the CRC, and the ROHC ICV.   If MRRU is 0 or if no MRRU attribute is sent, segment headers MUST NOT be transmitted on the ROHCoIPsec channel.
</p>
</blockquote><p>
					
<p></p>
<blockquote class="text">
<p>Note that the MRRU attribute is a one-way notification; therefore, different values for MRRU may be announced in each direction.
</p>
</blockquote>

			      

<p>If an unknown ROHC Attribute Type Value is received, it MUST be silently ignored. 
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
ROHC Channel Parameters that are Implicitly Set</h3>

<p>The following ROHC channel parameters MUST NOT be signaled:
			</p>
<ul class="text">
<li>LARGE_CIDS: This value is implicitly determined by the value of MAX_CID (e.g. if MAX_CID is &lt;= 15, LARGE_CIDS is assumed to be 0).
</li>
<li>FEEDBACK_FOR: When a pair of SAs are created (one in each direction), the ROHC channel parameter FEEDBACK_FOR MUST be set implicitly to the other SA of the pair (i.e. the SA pointing in the reverse direction).
</li>
</ul>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>The ability to negotiate the length of the ROHC ICV may introduce vulnerabilities to the ROHCoIPsec protocol.  Specifically, the capability to signal a short ICV length may result in scenarios where erroneous packets are forwarded into the protected domain.  This security consideration is documented in further detail in Section 6.1.4 of [ROHCOIPSEC] and Section 5 of [IPSEC-ROHC].
</p>
<p>This security consideration can be mitigated by using longer ICVs, but this comes at the cost of additional overhead, which reduces the overall benefits offered by ROHCoIPsec.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>This document defines a new Notify Message (Status Type).  Therefore, IANA is requested to allocate one value from the IKEv2 Notify Message registry to indicate ROHC_SUPPORTED.  Note that, since this Notify Message is a Status Type, values ranging from 0 to 16383 must not be allocated for ROHC_SUPPORTED.
</p>
<p>In addition, IANA is requested to create a new "ROHC Attribute Types" registry in the IKEv2 Parameters Registry [IKEV2-PARA].  Within the "ROHC Attribute Types" registry, this document allocates the following values:
</p>
<p></p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>Registry:
Value        ROHC Attribute Type                        Format Reference
-----------  --------------------------------------     ------ ---------
0            RESERVED                                          [rfcThis]
1            Maximum Context Identifier (MAX_CID)        TV    [rfcThis]
2            ROHC Profile (ROHC_PROFILE)                 TV    [rfcThis]
3            ROHC Integrity Algorithm (ROHC_INTEG)       TV    [rfcThis]
4            ROHC ICV Length in bytes (ROHC_ICV_LEN)     TV    [rfcThis]
5            Maximum Reconstructed Reception Unit (MRRU) TV    [rfcThis]
6-16383      Unassigned                                        [rfcThis]
16384-32767  Private use                                       [rfcThis]
</pre></div><p>

<p style='text-align: center'>
</p>

<p>Following the policies outlined in [IANA-CONSIDERATIONS], the IANA policy for assigning new values for the ROHC Attribute Types registry shall be Designated Expert.
</p>
<p>For registration requests, the responsible IESG area director will appoint the Designated Expert during the IETF last call.  The intention is that any allocation will be accompanied by a published RFC.  The Designated expert will post a request to both the rohc and ipsec mailing lists (or a successor designated by the Area Director) for comment and review.  Before expiration of the IETF last call, the Designated Expert will either approve or deny the registration request and publish a notice of the decision to both mailing lists (or their successors), as well as informing IANA.  A denial notice must be justified by an explanation.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgments</h3>

<p>The authors would like to thank Mr. Sean O'Keeffe, Mr. James Kohler, and Ms. Linda Noone of the Department of Defense, as well as Mr. Rich Espy of OPnet for their contributions and support in the development of this document.  
</p>
<p>The authors would also like to thank Mr. Yoav Nir, and Mr. Robert A Stangarone Jr.: both served as committed document reviewers for this specification.
</p>
<p>In addition, the authors would like to thank the following for their numerous reviews and comments to this document:
</p>
<p></p>
<ul class="text">
<li>Mr. Magnus Westerlund
</li>
<li>Dr. Stephen Kent
</li>
<li>Mr. Lars-Erik Jonsson
</li>
<li>Mr. Pasi Eronen
</li>
<li>Dr. Jonah Pezeshki
</li>
<li>Mr. Carl Knutsson
</li>
<li>Dr. Joseph Touch
</li>
</ul>

<p>Finally, the authors would also like to thank Mr. Tom Conkle, Ms. Michele Casey, and Mr. Etzel Brower.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="IPSEC">[IPSEC]</a></td>
<td class="author-text">Kent, S. and K. Seo, &ldquo;<a href="http://tools.ietf.org/html/rfc4301">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;4301, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="ROHC">[ROHC]</a></td>
<td class="author-text">Jonsson, L-E., Pelletier, G., and K. Sandlund, &ldquo;<a href="http://tools.ietf.org/html/rfc4995">The RObust Header Compression (ROHC) Framework</a>,&rdquo; RFC&nbsp;4995, July&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="IKEV2">[IKEV2]</a></td>
<td class="author-text">Kaufman, C., &ldquo;<a href="http://tools.ietf.org/html/rfc4306">Internet Key Exchange (IKEv2) Protocol</a>,&rdquo; RFC&nbsp;4306, December&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="BRA97">[BRA97]</a></td>
<td class="author-text">Bradner, S., &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; RFC&nbsp;2119, March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="ROHCV1">[ROHCV1]</a></td>
<td class="author-text">Bormann, C., Burmeister, C., Degermark, M., Fukushima, H., Hannu, H., Jonsson, L., Hakenberg, R., Koren, T., Le, K., Liu, Z., Martensson, A., Miyazaki, A., Svanbro, K., Wiebke, T., Yoshimura, T., and H. Zheng, &ldquo;<a href="http://tools.ietf.org/html/rfc3095">RObust Header Compression (ROHC): Framework and four profiles: RTP, UDP, ESP, and uncompressed</a>,&rdquo; RFC&nbsp;3095, July&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="ROHCV2">[ROHCV2]</a></td>
<td class="author-text">Pelletier, G. and K. Sandlund, &ldquo;<a href="http://tools.ietf.org/html/rfc5225">RObust Header Compression Version 2 (ROHCv2): Profiles for RTP, UDP, IP, ESP and UDP Lite</a>,&rdquo; RFC&nbsp;5225, April&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="IPSEC-ROHC">[IPSEC-ROHC]</a></td>
<td class="author-text">Ertekin, E., Christou, C., and C. Bormann, &ldquo;IPsec Extensions to Support ROHCoIPsec,&rdquo; work in progress&nbsp;, December&nbsp;2009.</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="ROHCOIPSEC">[ROHCOIPSEC]</a></td>
<td class="author-text">Ertekin, E., Jasani, R., Christou, C., and C. Bormann, &ldquo;Integration of Header Compression over IPsec Security Associations,&rdquo; work in progress&nbsp;, December&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="ROHC-PPP">[ROHC-PPP]</a></td>
<td class="author-text">Bormann, C., &ldquo;<a href="http://tools.ietf.org/html/rfc3241">Robust Header Compression (ROHC) over PPP</a>,&rdquo; RFC&nbsp;3241, April&nbsp;2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="ROHCPROF">[ROHCPROF]</a></td>
<td class="author-text">&ldquo;RObust Header Compression (ROHC) Profile Identifiers,&rdquo; www.iana.org/assignments/rohc-pro-ids&nbsp;, May&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="CRYPTO-ALG">[CRYPTO-ALG]</a></td>
<td class="author-text">Manral, V., &ldquo;<a href="http://tools.ietf.org/html/rfc4835">Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)</a>,&rdquo; RFC&nbsp;4835, April&nbsp;2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="IKEV2-PARA">[IKEV2-PARA]</a></td>
<td class="author-text">IANA, &ldquo;IKEv2 Parameters, http://www.iana.org/assignments/ikev2-parameters,&rdquo; November&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="IANA-CONSIDERATIONS">[IANA-CONSIDERATIONS]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; RFC&nbsp;5226, October&nbsp;1998.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Emre Ertekin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Booz Allen Hamilton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">5220 Pacific Concourse Drive, Suite 200</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Los Angeles, CA  90045</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ertekin_emre@bah.com">ertekin_emre@bah.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Chris Christou</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Booz Allen Hamilton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">13200 Woodland Park Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Herndon, VA  20171</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:christou_chris@bah.com">christou_chris@bah.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Rohan Jasani</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Booz Allen Hamilton</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">13200 Woodland Park Dr.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Herndon, VA  20171</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ro@breakcheck.com">ro@breakcheck.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tero Kivinen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Safenet, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Fredrikinkatu 47</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">HELSINKI</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">FI</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:kivinen@iki.fi">kivinen@iki.fi</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Carsten Bormann</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Universitaet Bremen TZI</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Postfach 330440</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bremen  D-28334</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:cabo@tzi.org">cabo@tzi.org</a></td></tr>
</table>
</body></html>
