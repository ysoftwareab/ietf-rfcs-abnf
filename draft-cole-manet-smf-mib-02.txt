


Internet Engineering Task Force                                  R. Cole
Internet-Draft                                  Johns Hopkins University
Intended status: Standards Track                               J. Macker
Expires: September 1, 2009                                    B. Adamson
                                               Naval Research Laboratory
                                                              S. Harnedy
                                                     Booz Allen Hamilton
                                                       February 28, 2009


    Definition of Managed Objects for the Manet Simplified Multicast
                      Framework Relay Set Process
                      draft-cole-manet-smf-mib-02

Status of This Memo

   This Internet-Draft is submitted to IETF in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on September 1, 2009.

Copyright Notice

   Copyright (c) 2009 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.



Cole, et al.            Expires September 1, 2009               [Page 1]

Internet-Draft                 The SMF MIB                 February 2009


Abstract

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in the Internet community.
   In particular, it describes objects for configuring aspects of the
   Simplified Multicast Forwarding (SMF) process.  The SMF MIB also
   reports state information, performance metrics, and notifications.
   In addition to configuration, this additional state and performance
   information is useful to management stations troubleshooting
   multicast forwarding problems.

Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  The Internet-Standard Management Framework . . . . . . . . . .  3
   3.  Conventions  . . . . . . . . . . . . . . . . . . . . . . . . .  3
   4.  Overview . . . . . . . . . . . . . . . . . . . . . . . . . . .  3
     4.1.  SMF Management Model . . . . . . . . . . . . . . . . . . .  4
     4.2.  Terms  . . . . . . . . . . . . . . . . . . . . . . . . . .  5
   5.  Structure of the MIB Module  . . . . . . . . . . . . . . . . .  6
     5.1.  Textual Conventions  . . . . . . . . . . . . . . . . . . .  6
     5.2.  The Capabilities Group . . . . . . . . . . . . . . . . . .  6
     5.3.  The Configuration Group  . . . . . . . . . . . . . . . . .  7
     5.4.  The State Group  . . . . . . . . . . . . . . . . . . . . .  7
     5.5.  The Performance Group  . . . . . . . . . . . . . . . . . .  7
     5.6.  The Reports Group  . . . . . . . . . . . . . . . . . . . .  8
     5.7.  The Notifications Group  . . . . . . . . . . . . . . . . .  8
   6.  Relationship to Other MIB Modules  . . . . . . . . . . . . . .  8
     6.1.  Relationship to the SNMPv2-MIB . . . . . . . . . . . . . .  9
     6.2.  Relationship to the IF-MIB . . . . . . . . . . . . . . . .  9
     6.3.  MIB modules required for IMPORTS . . . . . . . . . . . . .  9
   7.  Definitions  . . . . . . . . . . . . . . . . . . . . . . . . .  9
   8.  Security Considerations  . . . . . . . . . . . . . . . . . . . 51
   9.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . . 53
   10. Contributors . . . . . . . . . . . . . . . . . . . . . . . . . 54
   11. Acknowledgements . . . . . . . . . . . . . . . . . . . . . . . 54
   12. References . . . . . . . . . . . . . . . . . . . . . . . . . . 54
     12.1. Normative References . . . . . . . . . . . . . . . . . . . 54
     12.2. Informative References . . . . . . . . . . . . . . . . . . 55
   Appendix A.  Change Log  . . . . . . . . . . . . . . . . . . . . . 55
   Appendix B.  Open Issues . . . . . . . . . . . . . . . . . . . . . 55
   Appendix C.    . . . . . . . . . . . . . . . . . . . . . . . . . . 56









Cole, et al.            Expires September 1, 2009               [Page 2]

Internet-Draft                 The SMF MIB                 February 2009


1.  Introduction

   This memo defines a portion of the Management Information Base (MIB)
   for use with network management protocols in the Internet community.
   In particular, it describes objects for configuring aspects of a
   process implementing Simplified Multicast Forwarding (SMF)
   [I-D.ietf-manet-smf].  SMF provides multicast duplicate packet
   detection (DPD) and supports algorithms for constructing an estimate
   of a mobile ad hoc network (MANET) Minimum Connected Dominating Set
   (MCDS) for efficient multicast forwarding.  The SMF MIB also reports
   state information, performance metrics, and notifications.  In
   addition to configuration, this additional state and performance
   information is useful to management stations troubleshooting
   multicast forwarding problems.

2.  The Internet-Standard Management Framework

   For a detailed overview of the documents that describe the current
   Internet-Standard Management Framework, please refer to section 7 of
   RFC 3410 [RFC3410].

   Managed objects are accessed via a virtual information store, termed
   the Management Information Base or MIB.  MIB objects are generally
   accessed through the Simple Network Management Protocol (SNMP).
   Objects in the MIB are defined using the mechanisms defined in the
   Structure of Management Information (SMI).  This memo specifies a MIB
   module that is compliant to the SMIv2, which is described in STD 58,
   RFC 2578 [RFC2578], STD 58, RFC 2579 [RFC2579] and STD 58, RFC 2580
   [RFC2580].

3.  Conventions

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

4.  Overview

   SMF provides methods for implementing DPD-based multicast forwarding
   with the optional use of CDS-based relay sets.  The MCDS is the
   smallest set of MANET nodes (comprising a connected cluster) which
   cover all the nodes in the cluster with their transmissions.  As the
   density of the MANET nodes increase, the fraction of nodes required
   in an MCDS decreases.  Using the MCDS as a multicast forwarding set
   then becomes an efficient multicast mechanism for MANETs.

   Various algorithms for the construction of estimates of the MCDS
   exist.  The Simplified Multicast Framework [I-D.ietf-manet-smf]



Cole, et al.            Expires September 1, 2009               [Page 3]

Internet-Draft                 The SMF MIB                 February 2009


   describes some of these.  It further defines various operational
   modes for a node which is participating in the collective creation of
   the MCDS estimates.  These modes depend upon the set of related MANET
   routing and discovery protocols and mechanisms in operation in the
   specific MANET node.

   A SMF routers' MIB contains SMF process configuration parameters
   (e.g. specific CDS algorithm), state information (e.g., current
   membership in the CDS), performance counters (e.g., packet counters),
   and notifications.

4.1.  SMF Management Model

   This section describes the management model for the SMF node process.

   Figure 1 (reproduced from Figure 4 of [I-D.ietf-manet-smf]) shows the
   relationship between the SMF Relay Set selection algorithm and the
   related algorithms, processes and protocols running in the MANET
   nodes.  The Relay Set Selection Algorithm (RSSA) can rely upon
   topology information gotten from the MANET Neighborhood Discovery
   Protocol (NHDP), from the specific MANET routing protocol running on
   the node, or from Layer 2 information passed up to the higher layer
   protocol processes.




























Cole, et al.            Expires September 1, 2009               [Page 4]

Internet-Draft                 The SMF MIB                 February 2009


                       Possible L2 Trigger/Information
                                      |
                                      |
    ______________              ______|_____         __________________
   |    MANET     |            |            |       |                  |
   | Neighborhood |            | Relay Set  |       | Other Heuristics |
   |  Discovery   |------------| Selection  |-------| (Preference,etc) |
   |   Protocol   | neighbor   | Algorithm  |       |                  |
   |______________|   info     |____________|       |__________________|
          \                              /
           \                            /
    neighbor\                          / Dynamic Relay
      info*  \      ____________      /    Set Status
              \    |    SMF     |    / (State, {neighbor info})
               `---| Relay Set  |---'
                   |   State    |
                ---|____________|
               /
              /
    ______________
   |  Coexistent  |
   |    MANET     |
   |   Unicast    |
   |   Process    |
   |______________|


Figure 1: SMF Relay Set Control Options

4.2.  Terms

   The following definitions apply throughout this document:

   o  Configuration Objects - switches, tables, objects which are
      initialized to default settings or set through the management
      interface defined by this MIB.

   o  Tunable Configuration Objects - objects whose values affect timing
      or attempt bounds on the SMF RS process.

   o  State Objects - automatically generated values which define the
      current operating state of the SMF RS process in the router.

   o  Performance Objects - automatically generated values which help an
      administrator or automated tool to assess the performance of the
      CDS multicast process on the router and the overall multicasting
      performance within the MANET routing domain.




Cole, et al.            Expires September 1, 2009               [Page 5]

Internet-Draft                 The SMF MIB                 February 2009


5.  Structure of the MIB Module

   This section presents the structure of the SMF MIB module.  The
   objects are arranged into the following groups:

   o  smfMIBNotifications - defines the notifications associated with
      the SMF MIB.

   o  smfMIBObjects - defines the objects forming the basis for the SMF
      MIB.  These objects are divided up by function into the following
      groups:

   o

      *  Capabilities Group - This group contains the SMF objects that
         the device uses to advertise its local capabilities with
         respect to, e.g., the supported RSSAs.

      *  Configuration Group - This group contains the SMF objects that
         configure specific options that determine the overall operation
         of the SMF RSSA and the resulting multicast performance.

      *  State Group - Contains information describing the current state
         of the SMF RSSA process such as the Neighbor Table.

      *  Performance Group - Contains objects which help to characterize
         the performance of the SMF RSSA process, typically statistics
         counters.

      *  Reports Group - Contains objects which allow the device to
         develop and locally store performance related reports.  The
         management application can then pull these locally stored
         reports when it wishes.

   o  smfMIBConformance - defines minimal and full conformance of
      implementations to this SMF MIB.

5.1.  Textual Conventions

   The textual conventions used in the SMF MIB are as follows.  The
   RowStatus textual convention is imported from RFC 2579 [RFC2579].

5.2.  The Capabilities Group

   The SMF device supports a set of capabilities.  The list of
   capabilities which the device can advertise are:





Cole, et al.            Expires September 1, 2009               [Page 6]

Internet-Draft                 The SMF MIB                 February 2009


   o  Operational Mode - topology information from NHDP, CDS-aware
      unicast routing or Cross-layer from Layer 2

   o  SMF RSSA - the specific RSSA operational on the device

5.3.  The Configuration Group

   The SMF device is configured with a set of controls.  The list of
   configuration controls for the SMF device follow.

   o  Operational Mode - topology information from NHDP, CDS-aware
      unicast routing or Cross-layer from Layer 2

   o  SMF RSSA - the specific RSSA operational on the device

   o  Duplicate Packet detection for IPv4 - Identification-based or
      Hash-based DPD

   o  Duplicate Packet detection for IPv6 - Identification-based or
      Hash-based DPD

   o  NHDP RSSA Message TLV - if NHDP mode is selected, then is the RSSA
      Message TLV included in the NHDP exchanges.  (Question: Is this
      and the following two TLVs optional and are they included as a
      group or independently of one another?)

   o  NHDP RSSA Address Block TLV - if NHDP mode is selected, then is
      the RSSA Address Block TLV included in the NHDP exchanges.

   o  Router Priority TLV - if NHDP mode is selected, then is the Router
      Priority TLV included in the NHDP exchanges.

5.4.  The State Group

   The State Subtree reports current state information.

   o  Node RSS State - is the node currently in or out of the Relay Set.

   o  Neighbors Table - a table containing current neighbors and their
      operational RSSA.

5.5.  The Performance Group

   The Performance subtree reports primarily counters that relate to SMF
   RSSA performance.  The SMF performance counters consists of per node
   and per interface objects: (Note: Need to have a discussion of the
   important and measurable events related to SMF RSSA multicast
   performance.)  (Note: Do we need to break these out by type, i.e., v4



Cole, et al.            Expires September 1, 2009               [Page 7]

Internet-Draft                 The SMF MIB                 February 2009


   versus v6?)

   o  Total multicast packets received -

   o  Total multicast packets forwarded -

   o  Total duplicate multicast packets detected -

   o  Per interface statistics table with the following entries:

   o

      *  Multicast packets received

      *  Multicast packets forwarded

      *  Duplicate multicast packets detected

5.6.  The Reports Group

   The SMF device supports a a capability to generate and store locally
   a set of performance reports.  The objects to control the generation
   of these reports and to identify the information contained within
   these reports are contained within this group.  These objects
   include:

   o  Report Control Objects - which specify the storage requirements,
      the time and duration and the authorship of the reports.

   o  Report Objects - which identify the information, i.e., metrics,
      contained within these reports.  Currently, these objects
      represent a sub-set of the objects found within the Performance
      Group discussed above.

5.7.  The Notifications Group

   The Notifications Subtree contains the list of notifications
   supported within the SMF-MIB and their intended purpose or utility.
   This group is currently empty.

6.  Relationship to Other MIB Modules

   [TODO]: The text of this section specifies the relationship of the
   MIB modules contained in this document to other standards,
   particularly to standards containing other MIB modules.  Definitions
   imported from other MIB modules and other MIB modules that SHOULD be
   implemented in conjunction with the MIB module contained within this
   document are identified in this section.



Cole, et al.            Expires September 1, 2009               [Page 8]

Internet-Draft                 The SMF MIB                 February 2009


6.1.  Relationship to the SNMPv2-MIB

   The 'system' group in the SNMPv2-MIB [RFC3418] is defined as being
   mandatory for all systems, and the objects apply to the entity as a
   whole.  The 'system' group provides identification of the management
   entity and certain other system-wide data.  The SMF-MIB does not
   duplicate those objects.

6.2.  Relationship to the IF-MIB

   [TODO] This section is included as an example; If the MIB module is
   not an adjunct of the Interface MIB, then this section should be
   removed.

6.3.  MIB modules required for IMPORTS

   [TODO]: Citations are not permitted within a MIB module, but any
   module mentioned in an IMPORTS clause or document mentioned in a
   REFERENCE clause is a Normative reference, and must be cited
   someplace within the narrative sections.  If there are imported items
   in the MIB module, such as Textual Conventions, that are not already
   cited, they can be cited in text here.  Since relationships to other
   MIB modules should be described in the narrative text, this section
   is typically used to cite modules from which Textual Conventions are
   imported.

   The following SMF-MIB module IMPORTS objects from SNMPv2-SMI
   [RFC2578], SNMPv2-TC [RFC2579], SNMPv2-CONF [RFC2580], and IF-MIB
   [RFC2863]

7.  Definitions



   MANET-SMF-MIB DEFINITIONS ::= BEGIN

   IMPORTS

      ZeroBasedCounter32
         FROM RMON2-MIB                           -- [RFC2021]

      MODULE-IDENTITY, OBJECT-TYPE, NOTIFICATION-TYPE,
      Counter32, Unsigned32, Integer32, mib-2
         FROM SNMPv2-SMI                          -- [RFC2578]

      TEXTUAL-CONVENTION, RowStatus, TruthValue,
      TimeStamp, StorageType
         FROM SNMPv2-TC                           -- [RFC2579]



Cole, et al.            Expires September 1, 2009               [Page 9]

Internet-Draft                 The SMF MIB                 February 2009


      MODULE-COMPLIANCE, OBJECT-GROUP,
      NOTIFICATION-GROUP
         FROM SNMPv2-CONF                         -- [RFC2580]

      OwnerString
         FROM RMON-MIB                            -- [RFC2819]

      InterfaceIndexOrZero
         FROM IF-MIB                              -- [RFC2863]

      SnmpAdminString
         FROM SNMP-FRAMEWORK-MIB                  -- [RFC3411]

      InetAddress, InetAddressType,
      InetAddressPrefixLength
         FROM INET-ADDRESS-MIB                    -- [RFC4001]
      ;

   manetSmfMIB MODULE-IDENTITY
      LAST-UPDATED "200902271300Z"  -- February 27, 2009
      ORGANIZATION "IETF MANET Working Group"
      CONTACT-INFO
         "WG E-Mail: manet@ietf.org

          WG Chairs: ian.chakeres@gmail.com
                     jmacker@nrl.navy.mil


          Editors:   Robert G. Cole
                     Johns Hopkins University
                     Applied Physics Lab and
                     Department of Computer Science
                     11000 Johns Hopkins Road
                     Room 02-257
                     Laurel, MD 22014
                     USA
                     +1 443 778-6951
                     robert.cole@jhuapl.edu

                     Joseph Macker
                     Naval Research Laboratory
                     Washington, D.C. 20375
                     USA
                     macker@itd.nrl.navy.mil

                     Brian Adamson
                     Naval Research Laboratory
                     Washington, D.C. 20375



Cole, et al.            Expires September 1, 2009              [Page 10]

Internet-Draft                 The SMF MIB                 February 2009


                     USA
                     adamson@itd.nrl.navy.mil

                     Sean Harnedy
                     Booz Allen Hamilton
                     333 City Boulevard West
                     Orange, CA 92868
                     USA
                     +1 714 938-3898
                     harnedy_sean@bah.com"

      DESCRIPTION
         "This MIB module contains managed object definitions for
          the Manet SMF RSSA process defined in: Macker, J.(ed.),
          Simplified Multicast Forwarding draft-ietf-manet-smf-08,
          November 03, 2008.

          Copyright (C) The IETF Trust (2008). This version
          of this MIB module is part of RFC xxxx; see the RFC
          itself for full legal notices."

        -- Revision History
        REVISION    "200902271300Z"   -- February 27, 2009
        DESCRIPTION
           "Updated draft of this MIB module published as
            draft-cole-manet-smf-mib-02.txt. Fairly extensive
            revisions and additions to this MIB were made
            in this version. Specifically, the following
            changes were made in development of this version:
               - added a Capabilities Group within the Objects
                 Group to allow the device to report supported
                 capabilities, e.g., RSSAs supported.
               - added administrative status objects for device
                 and interfaces
               - added multicast address forwarding tables, both
                 for configured (within Configuration Group) and
                 discovered (within the State Group).
               - added additional Performance counters related
                 to DPD functions.
               - Split up the performance counters into IPv4
                 and IPv6, for both global and per interface
                 statistics.
               - Split out the reports capability into a seperate
                 Reports Group under the Objects Group.
           "
        REVISION    "200811031300Z"   -- November 03, 2008
        DESCRIPTION
           "Updated draft of this MIB module published as



Cole, et al.            Expires September 1, 2009              [Page 11]

Internet-Draft                 The SMF MIB                 February 2009


            draft-cole-manet-smf-mib-01.txt. Added gateway filter
            table and reports capabilities following rmon."
        REVISION    "200807071200Z"   -- July 07, 2008
        DESCRIPTION
           "Initial draft of this MIB module published as
            draft-cole-manet-smf-mib-00.txt."
        -- RFC-Editor assigns XXXX
        ::= { mib-2 998 }   -- to be assigned by IANA



   --
   -- TEXTUAL CONVENTIONs
   --

   Status ::= TEXTUAL-CONVENTION
       STATUS       current
       DESCRIPTION
          "An indication of the operability of a DYMO
          function or feature.  For example, the status
          of an interface: 'enabled' indicates that
          it is willing to communicate with other DYMO routers,
          and 'disabled' indicates that it is not."
       SYNTAX  INTEGER {
                        enabled (1),
                        disabled (2)
               }

   SmfOpModeID ::= TEXTUAL-CONVENTION
       DISPLAY-HINT "d"
       STATUS       current
       DESCRIPTION
           "An index that identifies through reference to a specific
            SMF operations mode ...
           "
       SYNTAX      Unsigned32 (1..2147483647)

   SmfRssaID ::= TEXTUAL-CONVENTION
       STATUS       current
       DESCRIPTION
           "An index that identifies through reference to a specific
            RSSA algorithms ...
           "
       SYNTAX      INTEGER {
                           cF(1),
                           sMPR(2),
                           eCDS(3),
                           mprCDS(4)



Cole, et al.            Expires September 1, 2009              [Page 12]

Internet-Draft                 The SMF MIB                 February 2009


                           -- future(5-127)
                           -- noStdAction(128-239)
                           -- experimental(240-255)
                   }



   --
   -- Top-Level Object Identifier Assignments
   --

   smfMIBNotifications OBJECT IDENTIFIER ::= { manetSmfMIB 0 }
   smfMIBObjects       OBJECT IDENTIFIER ::= { manetSmfMIB 1 }
   smfMIBConformance   OBJECT IDENTIFIER ::= { manetSmfMIB 2 }



   --
   -- smfMIBObjects Assignments:
   --      smfCapabilitiesGroup  - 1
   --      smfConfigurationGroup - 2
   --      smfStateGroup         - 3
   --      smfPerformanceGroup   - 4
   --      smfReportsGroup       - 5
   --

   --
   -- smfCapabilitiesGroup
   --
   --    This group contains the SMF objects that identify specific
   --    capabilities within this device related to SMF functions.
   --

   smfCapabilitiesGroup  OBJECT IDENTIFIER ::= { smfMIBObjects 1 }

  --
   -- SMF Operational Mode Capabilities Table
   --

   smfOpModeCapabilitiesTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF SmfOpModeCapabilitiesEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "The smfOpModeCapabilitiesTable contains ...
           "
       ::= { smfCapabilitiesGroup 1 }




Cole, et al.            Expires September 1, 2009              [Page 13]

Internet-Draft                 The SMF MIB                 February 2009


   smfOpModeCapabilitiesEntry OBJECT-TYPE
       SYNTAX      SmfOpModeCapabilitiesEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "Information about a particular operational
            mode.
           "
       INDEX   { smfOpModeCapabilitiesID }
       ::= { smfOpModeCapabilitiesTable 1 }

   SmfOpModeCapabilitiesEntry ::= SEQUENCE {
         smfOpModeCapabilitiesID              SmfOpModeID,
         smfOpModeCapabilitiesName            SnmpAdminString,
         smfOpModeCapabilitiesReference       SnmpAdminString
   }

   smfOpModeCapabilitiesID     OBJECT-TYPE
       SYNTAX      SmfOpModeID
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "The index for this entry.  This object identifies
            the particular operational mode for this device.
           "
       ::= { smfOpModeCapabilitiesEntry 1 }

   smfOpModeCapabilitiesName OBJECT-TYPE
       SYNTAX      SnmpAdminString
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The textual name of this operational
            mode.
           "
       ::= { smfOpModeCapabilitiesEntry 2 }

   smfOpModeCapabilitiesReference OBJECT-TYPE
       SYNTAX      SnmpAdminString
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "This object contains a reference to the document that
            defines this operational mode.
           "
       ::= { smfOpModeCapabilitiesEntry 3 }





Cole, et al.            Expires September 1, 2009              [Page 14]

Internet-Draft                 The SMF MIB                 February 2009


   --
   -- SMF RSSA Capabilities Table
   --

   smfRssaCapabilitiesTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF SmfRssaCapabilitiesEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "The smfRssaCapabilitiesTable contains ...
           "
       ::= { smfCapabilitiesGroup 2 }

   smfRssaCapabilitiesEntry OBJECT-TYPE
       SYNTAX      SmfRssaCapabilitiesEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "Information about a particular algorithm."
       INDEX   { smfRssaCapabilitiesID }
       ::= { smfRssaCapabilitiesTable 1 }

   SmfRssaCapabilitiesEntry ::= SEQUENCE {
         smfRssaCapabilitiesID              SmfRssaID,
         smfRssaCapabilitiesName            SnmpAdminString,
         smfRssaCapabilitiesReference       SnmpAdminString
   }

   smfRssaCapabilitiesID     OBJECT-TYPE
       SYNTAX      SmfRssaID
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "The index for this entry.  This object identifies
            the particular algorithm in this MIB module."
       ::= { smfRssaCapabilitiesEntry 1 }

   smfRssaCapabilitiesName OBJECT-TYPE
       SYNTAX      SnmpAdminString
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The textual name of this algorithm.
           "
       ::= { smfRssaCapabilitiesEntry 2 }

   smfRssaCapabilitiesReference OBJECT-TYPE
       SYNTAX      SnmpAdminString



Cole, et al.            Expires September 1, 2009              [Page 15]

Internet-Draft                 The SMF MIB                 February 2009


       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "This object contains a reference to the document that
            defines this algorithm.
           "
       ::= { smfRssaCapabilitiesEntry 3 }





   --
   -- smfConfigurationGroup
   --
   --    This group contains the SMF objects that configure specific
   --    options that determine the overall performance and operation
   --    of the multicast forwarding process for the router device
   --    and its interfaces.
   --

   smfConfigurationGroup  OBJECT IDENTIFIER ::= { smfMIBObjects 2 }

   smfAdminStatus  OBJECT-TYPE
      SYNTAX      Status
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The configured status of the SMF process
          on this device.  Enabled(1) means that
          SMF is configured to run on this device.
          Disabled(2) mean that the SMF process
          is configured off."
   ::= { smfConfigurationGroup 1 }


    smfConfiguredOpMode  OBJECT-TYPE
       SYNTAX      INTEGER {
                          withNHDP(1),
                          cdsAwareRouting(2),
                          crossLayer(3),
                          other(4)
                          }
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The SMF RSS node operational mode.




Cole, et al.            Expires September 1, 2009              [Page 16]

Internet-Draft                 The SMF MIB                 February 2009


          The value withNHDP(1) indicates ...
          The value cdsAwareRouting(2) indicates ...
          The value crossLayer(3) indicates... ."
   ::= { smfConfigurationGroup 2 }


   smfConfiguredRssa  OBJECT-TYPE
      SYNTAX      SmfRssaID
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The SMF RSS currently operational algorithm.

          The value cf(1) indicates ...

          The value experimental(240-255) indicates... ."
   ::= { smfConfigurationGroup 3 }

   smfRssaMember  OBJECT-TYPE
      SYNTAX      INTEGER {
                          potential(1),
                          always(2),
                          never(3)
                          }
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The RSSA downselects a set of forwarders for
          multicast forwarding.  Sometimes it is useful
          to force an agent to be included or excluded
          from the resulting RSS.  This object is a
          switch to allow for this behavior.

          The value potential(1) allows the selected
          RSSA to determine if this agent is included
          or excluded from the RSS.

          The value always(1) forces the selected
          RSSA include this agent in the RSS.

          The value never(3) forces the selected
          RSSA to exclude this agent from the RSS."
   ::= { smfConfigurationGroup 4 }

   smfIpv4Dpd  OBJECT-TYPE
      SYNTAX      INTEGER {
                          identificationBased(1),
                          hashBased(2)



Cole, et al.            Expires September 1, 2009              [Page 17]

Internet-Draft                 The SMF MIB                 February 2009


                          }
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The current method for IPv4 duplicate packet
          detection.
          The value identificationBased(1)
          indicates...

          The value 'hashBased(2) indicates... ."
   ::= { smfConfigurationGroup 5 }

   smfIpv6Dpd  OBJECT-TYPE
      SYNTAX      INTEGER {
                          identificationBased(1),
                          hashBased(2)
                          }
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The current method for IPv6 duplicate packet
          detection.
          The value identificationBased(1)
          indicates...

          The value 'hashBased(2) indicates... ."
   ::= { smfConfigurationGroup 6 }

   smfMaxPktLifetime  OBJECT-TYPE
      SYNTAX      Integer32 (0..65535)
      UNITS       "Seconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The estimate of the network packet
          traversal time.
         "
      DEFVAL { 60 }
   ::= { smfConfigurationGroup 7 }

   smfDpdMaxMemorySize  OBJECT-TYPE
      SYNTAX      Integer32 (0..65535)
      UNITS       "Kilo-Bytes"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The locally reserved memory for storage
          of cached DPD records for both IPv4 and



Cole, et al.            Expires September 1, 2009              [Page 18]

Internet-Draft                 The SMF MIB                 February 2009


          IPv6 methods.
         "
      DEFVAL { 1024 }
   ::= { smfConfigurationGroup 8 }

   smfDpdEntryMaxLifetime  OBJECT-TYPE
      SYNTAX      Integer32 (0..65525)
      UNITS       "Seconds"
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "The maximum lifetime of a cached DPD
          record in the local device storage.
         "
      DEFVAL { 600 }
   ::= { smfConfigurationGroup 9 }


   --
   -- Configuration of messages to be included in
   -- NHDP message exchanges in support of SMF
   -- operations.
   --

   smfNhdpRssaMesgTLVIncluded  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "Indicates whether the associated NHDP messages
          include the RSSA Message TLV, or not.  This
          is an optional SMF operational setting.
          The value true(1) indicates that this TLV is
          included; the value false(2) indicates that it
          is not included."
   ::= { smfConfigurationGroup 10 }

   smfNhdpRssaAddrBlockTLVIncluded  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "Indicates whether the associated NHDP messages
          include the RSSA Address Block TLV, or not.
          This is an optional SMF operational setting.
          The value true(1) indicates that this TLV is
          included; the value false(2) indicates that it
          is not included."



Cole, et al.            Expires September 1, 2009              [Page 19]

Internet-Draft                 The SMF MIB                 February 2009


   ::= { smfConfigurationGroup 11 }

   smfNhdpRouterPriorityTLVIncluded  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-write
      STATUS      current
      DESCRIPTION
         "Indicates whether the associated NHDP messages
          include the RSSA Router Priority TLV, or not.
          This is an optional SMF operational setting.
          The value true(1) indicates that this TLV is
          included; the value false(2) indicates that it
          is not included."
     ::= { smfConfigurationGroup 12 }


   --
   -- Table identifying configured multicast addresses to be forwarded.
   --

   smfConfiguredAddrForwardingTable  OBJECT-TYPE
      SYNTAX     SEQUENCE OF SmfConfiguredAddrForwardingEntry
      MAX-ACCESS not-accessible
      STATUS     current
      DESCRIPTION
         "The (conceptual) table containing information on multicast
          addresses which are to be forwarded by the SMF process.

          Entries in this table are configured.  As well, addresses
          to be forwarded by the SMF device can be dynamically discovered
          by other means.  The corresponding state table,
          smfDiscoveredAddrForwardingTable contains
          these additional, dynamically discovered address for
          forwarding.

          Each row is associated with a range of multicast addresses,
          and ranges for different rows must be disjoint.
         "
   ::= { smfConfigurationGroup 13 }

   smfConfiguredAddrForwardingEntry OBJECT-TYPE
      SYNTAX     SmfConfiguredAddrForwardingEntry
      MAX-ACCESS not-accessible
      STATUS     current
      DESCRIPTION
         "An entry (conceptual row) containing the information on a
          particular multicast scope."
      INDEX { smfConfiguredAddrForwardingAddrType,



Cole, et al.            Expires September 1, 2009              [Page 20]

Internet-Draft                 The SMF MIB                 February 2009


              smfConfiguredAddrForwardingFirstAddr }
      ::= { smfConfiguredAddrForwardingTable 1 }

   SmfConfiguredAddrForwardingEntry ::= SEQUENCE {
      smfConfiguredAddrForwardingAddrType      InetAddressType,
      smfConfiguredAddrForwardingFirstAddr     InetAddress,
      smfConfiguredAddrForwardingLastAddr      InetAddress,
      smfConfiguredAddrForwardingStatus        RowStatus
   }

   smfConfiguredAddrForwardingAddrType OBJECT-TYPE
      SYNTAX     InetAddressType
      MAX-ACCESS not-accessible
      STATUS     current
      DESCRIPTION
         "The type of the addresses in the multicast forwarding
          range.  Legal values correspond to the subset of
          address families for which multicast address allocation
          is supported."
   ::= { smfConfiguredAddrForwardingEntry 1 }

   smfConfiguredAddrForwardingFirstAddr OBJECT-TYPE
      SYNTAX     InetAddress (SIZE(0..20))
      MAX-ACCESS not-accessible
      STATUS     current
      DESCRIPTION
         "The first address in the multicast scope range.  The type
          of this address is determined by the value of the
          smfConfiguredAddrForwardingAddrType object."
   ::= { smfConfiguredAddrForwardingEntry 2 }

   smfConfiguredAddrForwardingLastAddr OBJECT-TYPE
      SYNTAX     InetAddress (SIZE(0..20))
      MAX-ACCESS read-create
      STATUS     current
      DESCRIPTION
         "The last address in the multicast scope range.
          The type of this address is determined by the
          value of the smfConfiguredAddrForwardingAddrType
          object."
   ::= { smfConfiguredAddrForwardingEntry 3 }

   smfConfiguredAddrForwardingStatus OBJECT-TYPE
      SYNTAX     RowStatus
      MAX-ACCESS read-create
      STATUS     current
      DESCRIPTION
         "The status of this row, by which new entries may be



Cole, et al.            Expires September 1, 2009              [Page 21]

Internet-Draft                 The SMF MIB                 February 2009


          created, or old entries deleted from this table.  If write
          access is supported, the other writable objects in this
          table may be modified even while the status is `active'."
   ::= { smfConfiguredAddrForwardingEntry 4 }



   --
   -- SMF Interfaces Configuration Table
   --

   smfInterfaceTable  OBJECT-TYPE
      SYNTAX      SEQUENCE OF SmfInterfaceEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The SMF Interface Table describes the SMF
          interfaces that are participating in the
          SMF packet forwarding process. The ifIndex is
          from the interfaces group defined in the
          Interfaces Group MIB.
          "
      REFERENCE
         "RFC 2863 - The Interfaces Group MIB, McCloghrie,
          K., and F. Kastenholtz, June 2000."
   ::= { smfConfigurationGroup 14 }

   smfInterfaceEntry OBJECT-TYPE
      SYNTAX      SmfInterfaceEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The SMF interface entry describes one SMF
          interface as indexed by its ifIndex."
      INDEX { smfIfIndex }
   ::= { smfInterfaceTable 1 }

   SmfInterfaceEntry ::=
      SEQUENCE {
         smfIfIndex        InterfaceIndexOrZero,
         smfIfAdminStatus  Status,
         smfIfRowStatus    RowStatus
         }

   smfIfIndex  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  not-accessible
      STATUS      current



Cole, et al.            Expires September 1, 2009              [Page 22]

Internet-Draft                 The SMF MIB                 February 2009


      DESCRIPTION
         "The ifIndex for this SMF interface."
      ::= { smfInterfaceEntry 1 }

   smfIfAdminStatus OBJECT-TYPE
      SYNTAX      Status
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
          "The SMF interface's administrative status.
          The value 'enabled' denotes that the interface
          is running the SMF forwarding process.
          The value 'disabled' denotes that the interface is
          external to the SMF forwarding process.
          "
      ::= { smfInterfaceEntry 2 }

   smfIfRowStatus  OBJECT-TYPE
      SYNTAX      RowStatus
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "This object permits management of the table
          by facilitating actions such as row creation,
          construction, and destruction. The value of
          this object has no effect on whether other
          objects in this conceptual row can be
          modified."
   ::= { smfInterfaceEntry 3 }



   --
   -- SMF Gateway Filter Table
   -- (Note:  Not sure at this point what to do with this
   -- table.  Most likely want to move to a seperate MIB.)
   --

   smfGatewayFilterTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF SmfGatewayFilterEntry
      MAX-ACCESS   not-accessible
      STATUS       obsolete
      DESCRIPTION
         "The SMF Gateway can be configured to filter
          multicast packets into and outof the SMF
          MANET domain.  This table defines the filter
          rules which define packet matching and
          related actions.  The rules are in order ..."



Cole, et al.            Expires September 1, 2009              [Page 23]

Internet-Draft                 The SMF MIB                 February 2009


      REFERENCE
         "The SMF draft."
   ::= { smfConfigurationGroup 15 }

   smfGatewayFilterEntry  OBJECT-TYPE
      SYNTAX      SmfGatewayFilterEntry
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "A single entry in the smfGatewayFilterTable."
      REFERENCE
         "The SMF draft."
      INDEX { smfGatewayFilterIndex }
   ::= { smfGatewayFilterTable 1 }

   SmfGatewayFilterEntry ::=
      SEQUENCE {
         smfGatewayFilterIndex             InterfaceIndexOrZero,
         smfGatewayFilterIf                InterfaceIndexOrZero,
         smfGatewayFilterIfDirection       INTEGER,
         smfGatewayFilterRuleRank          Integer32,
         smfGatewayFilterDestAddrType      InetAddressType,
         smfGatewayFilterDestAddr          InetAddress,
         smfGatewayFilterDestAddrPrefixLen InetAddressPrefixLength,
         smfGatewayFilterSrcAddrType       InetAddressType,
         smfGatewayFilterSrcAddr           InetAddress,
         smfGatewayFilterSrcAddrPrefixLen  InetAddressPrefixLength,
         smfGatewayFilterProtocolNumber    Integer32,
         smfGatewayFilterDestPortNumber    Integer32,
         smfGatewayFilterAction            INTEGER,
         smfGatewayFilterRowStatus         RowStatus
         }

   smfGatewayFilterIndex  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The Index for this filter rule.
         "
   ::= { smfGatewayFilterEntry 1 }

   smfGatewayFilterIf  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The ifIndex for this node interface



Cole, et al.            Expires September 1, 2009              [Page 24]

Internet-Draft                 The SMF MIB                 February 2009


          that is filtering this rule."
   ::= { smfGatewayFilterEntry 2 }

   smfGatewayFilterIfDirection  OBJECT-TYPE
      SYNTAX      INTEGER {
                           in(1),
                           out(2)
                  }
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The ifIndex direction for this interface
          filtering rule."
   ::= { smfGatewayFilterEntry 3 }

   smfGatewayFilterRuleRank  OBJECT-TYPE
      SYNTAX      Integer32 (1..65535)
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The rank of the rule specified in
          this entry.  This rank is specified by
          the management application.  The rules applied
          on this device are rank ordered by this
          rank, from smallest (applied first) to
          largest (applied last).  The rule ranks do not
          have to be contiguous, but they must be unique.
          When a management application changes this rank
          and the new rank is identical to the rank of another
          entry, then that entry's rank and all other entries
          with a rank greater than this rank must be incremented
          by one.
         "
      REFERENCE
         "The SMF draft."
   ::= { smfGatewayFilterEntry 4 }

   smfGatewayFilterDestAddrType  OBJECT-TYPE
      SYNTAX      InetAddressType
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The type of the DestAddr, as defined
          in the InetAddress MIB [RFC 4001]."
      REFERENCE
         "The SMF draft."
   ::= { smfGatewayFilterEntry 5 }




Cole, et al.            Expires September 1, 2009              [Page 25]

Internet-Draft                 The SMF MIB                 February 2009


   smfGatewayFilterDestAddr  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The destination IP address of this rule. The type
          of this address is determined by the value of the
          smfGatewayFilterDestAddrType object."
      REFERENCE
         "The SMF draft."
   ::= { smfGatewayFilterEntry 6 }

   smfGatewayFilterDestAddrPrefixLen  OBJECT-TYPE
      SYNTAX      InetAddressPrefixLength
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "Indicates the number of leading one bits that form the
          mask to be logical-ANDed with the destination address
          before being compared to the value in the
          smfGatewayFilterDestAddr field."
      REFERENCE
         "The SMF draft."
   ::= { smfGatewayFilterEntry 7 }

   smfGatewayFilterSrcAddrType  OBJECT-TYPE
      SYNTAX      InetAddressType
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The type of the SrcAddr, as defined
          in the InetAddress MIB [RFC 4001]."
      REFERENCE
         "The SMF draft."
   ::= { smfGatewayFilterEntry 8 }

   smfGatewayFilterSrcAddr  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The source IP address of this rule. The type
          of this address is determined by the value of the
          smfGatewayFilterSrcAddrType object."
      REFERENCE
         "The SMF draft."
   ::= { smfGatewayFilterEntry 9 }




Cole, et al.            Expires September 1, 2009              [Page 26]

Internet-Draft                 The SMF MIB                 February 2009


   smfGatewayFilterSrcAddrPrefixLen  OBJECT-TYPE
      SYNTAX      InetAddressPrefixLength
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "Indicates the number of leading one bits that form the
          mask to be logical-ANDed with the destination address
          before being compared to the value in the
          smfGatewayFilterSrcAddr field."
      REFERENCE
         "The SMF draft."
   ::= { smfGatewayFilterEntry 10 }

   -- Note: check out the necessary range for protocol
   -- and port numbers.
   smfGatewayFilterProtocolNumber  OBJECT-TYPE
      SYNTAX      Integer32(0..65535)
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The Protocol Number defined in RFC 5237."
   ::= { smfGatewayFilterEntry 11 }


   smfGatewayFilterDestPortNumber  OBJECT-TYPE
      SYNTAX      Integer32(0..65535)
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The destination Port Number defined in
          RFC XXXX."
   ::= { smfGatewayFilterEntry 12 }

   smfGatewayFilterAction  OBJECT-TYPE
      SYNTAX      INTEGER {
                           drop(1),
                           pass(2),
                           other(3)
                 }
      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "The action to be taken if the rule is
          matched."
   ::= { smfGatewayFilterEntry 13 }

   smfGatewayFilterRowStatus  OBJECT-TYPE
      SYNTAX      RowStatus



Cole, et al.            Expires September 1, 2009              [Page 27]

Internet-Draft                 The SMF MIB                 February 2009


      MAX-ACCESS  read-create
      STATUS      current
      DESCRIPTION
         "This object permits management of the table
          by facilitating actions such as row creation,
          construction, and destruction. The value of
          this object has no effect on whether other
          objects in this conceptual row can be
          modified."
   ::= { smfGatewayFilterEntry 14 }



   --
   -- smfStateGroup
   --
   --    Contains information describing the current state of the SMF
   --    process such as the current inclusion in the RS or not.
   --

   smfStateGroup  OBJECT IDENTIFIER ::= { smfMIBObjects 3 }

   smfNodeRsStatusIncluded  OBJECT-TYPE
      SYNTAX      TruthValue
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The current status of the SMF node in the context of
          the MANETs relay set. A value of true(1) indicates
          that the node is currently part of the MANET Relay
          Set. A value of false(2) indicates that the node
          is currently not part of the MANET Relay Set."
   ::= { smfStateGroup 1 }

   smfDpdMemoryOverflow  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "The number of times that the memory for caching
          records for DPD overran and records had to be flushed.
          The number of records to be flushed upon a buffer
          overflow is an implementation specific decision.
         "
   ::= { smfStateGroup 2 }






Cole, et al.            Expires September 1, 2009              [Page 28]

Internet-Draft                 The SMF MIB                 February 2009


   --
   -- Dynamically Discovered Multicast Addr Table
   --

   smfDiscoveredAddrForwardingTable  OBJECT-TYPE
      SYNTAX     SEQUENCE OF SmfDiscoveredAddrForwardingEntry
      MAX-ACCESS not-accessible
      STATUS     current
      DESCRIPTION
         "The (conceptual) table containing information on multicast
          addresses which are to be forwarded by the SMF process.

          Entries in this table are configured.  As well, addresses
          to be forwarded by the SMF device can be dynamically discovered
          by other means.  The corresponding state table,
          smfDiscoveredAddrForwardingTable contains
          these additional, dynamically discovered address for
          forwarding.

          Each row is associated with a range of multicast addresses,
          and ranges for different rows must be disjoint.
         "
   ::= { smfStateGroup 3 }

   smfDiscoveredAddrForwardingEntry OBJECT-TYPE
      SYNTAX     SmfDiscoveredAddrForwardingEntry
      MAX-ACCESS not-accessible
      STATUS     current
      DESCRIPTION
         "An entry (conceptual row) containing the information on a
          particular multicast scope."
      INDEX { smfDiscoveredAddrForwardingAddrType,
              smfDiscoveredAddrForwardingFirstAddr }
      ::= { smfDiscoveredAddrForwardingTable 1 }

   SmfDiscoveredAddrForwardingEntry ::= SEQUENCE {
      smfDiscoveredAddrForwardingAddrType   InetAddressType,
      smfDiscoveredAddrForwardingFirstAddr  InetAddress,
      smfDiscoveredAddrForwardingLastAddr   InetAddress,
      smfDiscoveredAddrForwardingStatus     RowStatus
   }

   smfDiscoveredAddrForwardingAddrType OBJECT-TYPE
      SYNTAX     InetAddressType
      MAX-ACCESS not-accessible
      STATUS     current
      DESCRIPTION
         "The type of the addresses in the multicast forwarding



Cole, et al.            Expires September 1, 2009              [Page 29]

Internet-Draft                 The SMF MIB                 February 2009


          range.  Legal values correspond to the subset of
          address families for which multicast address allocation
          is supported."
   ::= { smfDiscoveredAddrForwardingEntry 1 }

   smfDiscoveredAddrForwardingFirstAddr OBJECT-TYPE
      SYNTAX     InetAddress (SIZE(0..20))
      MAX-ACCESS not-accessible
      STATUS     current
      DESCRIPTION
         "The first address in the multicast scope range.  The type
          of this address is determined by the value of the
          smfConfiguredAddrForwardingAddrType object."
   ::= { smfDiscoveredAddrForwardingEntry 2 }

   smfDiscoveredAddrForwardingLastAddr OBJECT-TYPE
      SYNTAX     InetAddress (SIZE(0..20))
      MAX-ACCESS read-create
      STATUS     current
      DESCRIPTION
         "The last address in the multicast scope range.
          The type of this address is determined by the
          value of the smfConfiguredAddrForwardingAddrType
          object."
   ::= { smfDiscoveredAddrForwardingEntry 3 }

   smfDiscoveredAddrForwardingStatus OBJECT-TYPE
      SYNTAX     RowStatus
      MAX-ACCESS read-create
      STATUS     current
      DESCRIPTION
         "The status of this row, by which new entries may be
          created, or old entries deleted from this table.  If write
          access is supported, the other writable objects in this
          table may be modified even while the status is `active'."
   ::= { smfDiscoveredAddrForwardingEntry 4 }



   --
   -- SMF Neighbor Table
   --

   smfNeighborTable  OBJECT-TYPE
      SYNTAX       SEQUENCE OF SmfNeighborEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION



Cole, et al.            Expires September 1, 2009              [Page 30]

Internet-Draft                 The SMF MIB                 February 2009


         "The SMF NeighborTable describes the
          current neighbor nodes, their address
          and SMF RSSA and the interface on which
          they can be reached."
      REFERENCE
         "Simplified Multicast Forwarding for MANET
          (SMF), Macker, J., February 2008.
          Section 7: SMF Neighborhood Discovery
          Requirements."
   ::= { smfStateGroup 4 }

   smfNeighborEntry  OBJECT-TYPE
      SYNTAX       SmfNeighborEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
         "The SMF Neighbor Table contains the
          set of one-hop neighbors, the interface
          they are reachable on and the SMF RSSA
          they are currently running."
      INDEX { smfNeighborIpAddrType,
              smfNeighborIpAddr,
              smfNeighborPrefixLen }
   ::= { smfNeighborTable 1 }

   SmfNeighborEntry ::=
      SEQUENCE {
         smfNeighborIpAddrType        InetAddressType,
         smfNeighborIpAddr            InetAddress,
         smfNeighborPrefixLen         InetAddressPrefixLength,
         smfNeighborRSSA              SmfRssaID,
         smfNeighborNextHopInterface  InterfaceIndexOrZero
         }

   smfNeighborIpAddrType  OBJECT-TYPE
      SYNTAX      InetAddressType
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The neighbor IP address type."
   ::= { smfNeighborEntry 1 }

   smfNeighborIpAddr  OBJECT-TYPE
      SYNTAX      InetAddress
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The neighbor Inet IPv4 or IPv6 address."



Cole, et al.            Expires September 1, 2009              [Page 31]

Internet-Draft                 The SMF MIB                 February 2009


   ::= { smfNeighborEntry 2 }

   smfNeighborPrefixLen  OBJECT-TYPE
      SYNTAX      InetAddressPrefixLength
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The prefix length. This is a decimal value that
          indicates the number of contiguous, higher-order
          bits of the address that make up the network
          portion of the address."
   ::= { smfNeighborEntry 3 }

   smfNeighborRSSA  OBJECT-TYPE
      SYNTAX       SmfRssaID
      MAX-ACCESS   read-only
      STATUS       current
      DESCRIPTION
         "The current RSSA running on the neighbor.
          The list is identical to that described
          above for the smfRssa object."
   ::= { smfNeighborEntry 4 }

   smfNeighborNextHopInterface OBJECT-TYPE
      SYNTAX       InterfaceIndexOrZero
      MAX-ACCESS   read-only
      STATUS       current
      DESCRIPTION
         "The interface ifIndex over which the
          neighbor is reachable in one-hop."
   ::= { smfNeighborEntry 5 }




   --
   -- SMF Performance Group
   --
   --    Contains objects which help to characterize the
   --    performance of the SMF RSSA process, such as statistics
   --    counters. There are two types of SMF RSSA statistics:
   --    global counters and per interface counters.
   --

   smfPerformanceGroup  OBJECT IDENTIFIER ::= { smfMIBObjects 4 }

   smfGlobalPerfGroup  OBJECT IDENTIFIER ::= { smfPerformanceGroup 1 }




Cole, et al.            Expires September 1, 2009              [Page 32]

Internet-Draft                 The SMF MIB                 February 2009


   --
   -- IPv4 packet counters
   --

   smfIpv4MultiPktsRecvTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of
          multicast IPv4 packets received by the
          device."
   ::= { smfGlobalPerfGroup 1 }

   smfIpv4MultiPktsForwardedTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of
          multicast IPv4 packets forwarded by the
          device."
   ::= { smfGlobalPerfGroup 2 }

   smfIpv4DuplMultiPktsDetectedTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of duplicate
          multicast IPv4 packets detected by the
          device."
   ::= { smfGlobalPerfGroup 3 }

   smfIpv4DroppedMultiPktsTTLExceededTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of dropped
          multicast IPv4 packets by the
          device due to TTL exceeded."
   ::= { smfGlobalPerfGroup 4 }

   smfIpv4TTLLargerThanPreviousTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current



Cole, et al.            Expires September 1, 2009              [Page 33]

Internet-Draft                 The SMF MIB                 February 2009


      DESCRIPTION
         "A counter of the total number of IPv4 packets
          recieved which have a TTL larger than that
          of a previously recived identical packet.
         "
   ::= { smfGlobalPerfGroup 5 }

   --
   -- IPv6 packet counters
   --

   smfIpv6MultiPktsRecvTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of
          multicast IPv6 packets received by the
          device."
   ::= { smfGlobalPerfGroup 6 }

   smfIpv6MultiPktsForwardedTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of
          multicast IPv6 packets forwarded by the
          device."
   ::= { smfGlobalPerfGroup 7 }

   smfIpv6DuplMultiPktsDetectedTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of duplicate
          multicast IPv6 packets detected by the
          device."
   ::= { smfGlobalPerfGroup 8 }

   smfIpv6DroppedMultiPktsTTLExceededTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of dropped
          multicast IPv6 packets by the



Cole, et al.            Expires September 1, 2009              [Page 34]

Internet-Draft                 The SMF MIB                 February 2009


          device due to TTL exceeded."
   ::= { smfGlobalPerfGroup 9 }

   smfIpv6TTLLargerThanPreviousTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of IPv6 packets
          recieved which have a TTL larger than that
          of a previously recived identical packet.
         "
   ::= { smfGlobalPerfGroup 10 }

   smfIpv6HAVAssistsReqdTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of IPv6 packets
          recieved which required the HAV assist for DPD.
         "
   ::= { smfGlobalPerfGroup 11 }

   smfIpv6DpdHeaderInsertionsTotal  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of IPv6 packets
          recieved which the device inserted the
          DPD header option.
         "
   ::= { smfGlobalPerfGroup 12 }


   --
   -- Per SMF Interface Performance Table
   --

   smfInterfacePerfGroup OBJECT IDENTIFIER ::= { smfPerformanceGroup 2 }

   smfIpv4InterfacePerfTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF SmfIpv4InterfacePerfEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
         "The SMF Interface Performance Table



Cole, et al.            Expires September 1, 2009              [Page 35]

Internet-Draft                 The SMF MIB                 February 2009


          describes the SMF statistics per
          interface."
   ::= { smfInterfacePerfGroup 1 }

   smfIpv4InterfacePerfEntry OBJECT-TYPE
      SYNTAX       SmfIpv4InterfacePerfEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
         "The SMF Interface Performance entry
          describes the statistics for a particular
          node interface."
      INDEX { smfIpv4IfPerfIfIndex }
   ::= { smfIpv4InterfacePerfTable 1 }

   SmfIpv4InterfacePerfEntry ::=
      SEQUENCE {
         smfIpv4IfPerfIfIndex                    InterfaceIndexOrZero,
         smfIpv4MultiPktsRecvPerIf               Counter32,
         smfIpv4MultiPktsForwardedPerIf          Counter32,
         smfIpv4DuplMultiPktsDetectedPerIf       Counter32,
         smfIpv4DroppedMultiPktsTTLExceededPerIf Counter32,
         smfIpv4TTLLargerThanPreviousPerIf       Counter32
         }

   smfIpv4IfPerfIfIndex  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The ifIndex for this node interface
          that is collecting this set of
          performance management statistics."
   ::= { smfIpv4InterfacePerfEntry 1 }

   smfIpv4MultiPktsRecvPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the number of
          multicast IP packets received by the
          device on this interface."
   ::= { smfIpv4InterfacePerfEntry 2 }

   smfIpv4MultiPktsForwardedPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only



Cole, et al.            Expires September 1, 2009              [Page 36]

Internet-Draft                 The SMF MIB                 February 2009


      STATUS      current
      DESCRIPTION
         "A counter of the number of
          multicast IP packets forwarded by the
          device on this interface."
   ::= { smfIpv4InterfacePerfEntry 3 }

   smfIpv4DuplMultiPktsDetectedPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the number of duplicate
          multicast IP packets detected by the
          device on this interface."
   ::= { smfIpv4InterfacePerfEntry 4 }

   smfIpv4DroppedMultiPktsTTLExceededPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of dropped
          multicast IPv4 packets by the
          device due to TTL exceeded."
   ::= { smfIpv4InterfacePerfEntry 5 }

   smfIpv4TTLLargerThanPreviousPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of IPv4 packets
          recieved which have a TTL larger than that
          of a previously recived identical packet.
         "
   ::= { smfIpv4InterfacePerfEntry 6 }


   smfIpv6InterfacePerfTable OBJECT-TYPE
      SYNTAX       SEQUENCE OF SmfIpv6InterfacePerfEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
         "The SMF Interface Performance Table
          describes the SMF statistics per
          interface."
   ::= { smfInterfacePerfGroup 2 }



Cole, et al.            Expires September 1, 2009              [Page 37]

Internet-Draft                 The SMF MIB                 February 2009


   smfIpv6InterfacePerfEntry OBJECT-TYPE
      SYNTAX       SmfIpv6InterfacePerfEntry
      MAX-ACCESS   not-accessible
      STATUS       current
      DESCRIPTION
         "The SMF Interface Performance entry
          describes the statistics for a particular
          node interface."
      INDEX { smfIpv6IfPerfIfIndex }
   ::= { smfIpv6InterfacePerfTable 1 }

   SmfIpv6InterfacePerfEntry ::=
      SEQUENCE {
         smfIpv6IfPerfIfIndex                     InterfaceIndexOrZero,
         smfIpv6MultiPktsRecvPerIf                Counter32,
         smfIpv6MultiPktsForwardedPerIf           Counter32,
         smfIpv6DuplMultiPktsDetectedPerIf        Counter32,
         smfIpv6DroppedMultiPktsTTLExceededPerIf  Counter32,
         smfIpv6TTLLargerThanPreviousPerIf        Counter32,
         smfIpv6HAVAssistsReqdPerIf               Counter32,
         smfIpv6DpdHeaderInsertionsPerIf          Counter32
         }

   smfIpv6IfPerfIfIndex  OBJECT-TYPE
      SYNTAX      InterfaceIndexOrZero
      MAX-ACCESS  not-accessible
      STATUS      current
      DESCRIPTION
         "The ifIndex for this node interface
          that is collecting this set of
          performance management statistics.

          For packets generated locally at
          this node, performance counters
          are assigned to the loopback
          interface.
         "
   ::= { smfIpv6InterfacePerfEntry 1 }

   smfIpv6MultiPktsRecvPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the number of
          multicast IP packets received by the
          device on this interface."
   ::= { smfIpv6InterfacePerfEntry 2 }



Cole, et al.            Expires September 1, 2009              [Page 38]

Internet-Draft                 The SMF MIB                 February 2009


   smfIpv6MultiPktsForwardedPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the number of
          multicast IP packets forwarded by the
          device on this interface."
   ::= { smfIpv6InterfacePerfEntry 3 }

   smfIpv6DuplMultiPktsDetectedPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the number of duplicate
          multicast IP packets detected by the
          device on this interface."
   ::= { smfIpv6InterfacePerfEntry 4 }

   smfIpv6DroppedMultiPktsTTLExceededPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the number of dropped
          multicast IP packets by the
          device on this interface due to TTL
          exceeded."
   ::= { smfIpv6InterfacePerfEntry 5 }

   smfIpv6TTLLargerThanPreviousPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of IPv6 packets
          recieved which have a TTL larger than that
          of a previously recived identical packet.
         "
   ::= { smfIpv6InterfacePerfEntry 6 }

   smfIpv6HAVAssistsReqdPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of IPv6 packets



Cole, et al.            Expires September 1, 2009              [Page 39]

Internet-Draft                 The SMF MIB                 February 2009


          recieved which required the HAV assist for DPD.
         "
   ::= { smfIpv6InterfacePerfEntry 7 }

   smfIpv6DpdHeaderInsertionsPerIf  OBJECT-TYPE
      SYNTAX      Counter32
      MAX-ACCESS  read-only
      STATUS      current
      DESCRIPTION
         "A counter of the total number of IPv6 packets
          recieved which the device inserted the
          DPD header option.
         "
   ::= { smfIpv6InterfacePerfEntry 8 }

   --
   -- Reports Control
   --     This and the following tables are modeled
   --     after the report control and collection
   --     capabilities found in RMON II, RFC XXXX

   --
   -- Note: Starting down this road only for general performance
   -- measures first.  If desireable, then will add reports for
   -- IF specific measurements.
   --

   smfReportsGroup  OBJECT IDENTIFIER ::= { smfMIBObjects 5 }

   smfGenReportCntrlTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF SmfGenReportCntrlEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "The smfGenReportCntrlTable is the controlling entry
           that manages the population of studies in the
           Report for selected time intervals.

           Note that this is not like the typical RMON
           controlTable and dataTable in which each entry creates
           its own data table.  Each entry in this table enables the
           creation of multiple data tables on a study basis.  For each
           interval, the study is updated in place, and the current
           data content of the table becomes invalid.

           The control table entries are persistent across
           system reboots."
       ::= { smfReportsGroup 1 }



Cole, et al.            Expires September 1, 2009              [Page 40]

Internet-Draft                 The SMF MIB                 February 2009


   smfGenReportCntrlEntry OBJECT-TYPE
       SYNTAX      SmfGenReportCntrlEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "A conceptual row in the smfGenReportCntrlTable.

           An example of the indexing of this entry is
           smfGenReportCntrInterval.1"
       INDEX { smfGenReportCntrlIndex }
       ::= { smfGenReportCntrlTable 1 }

   SmfGenReportCntrlEntry ::= SEQUENCE {
       smfGenReportCntrlIndex               Unsigned32,
       smfGenReportCntrlInterval            Unsigned32,
       smfGenReportCntrlReqSize             Unsigned32,
       smfGenReportCntrlGrantedSize         Unsigned32,
       smfGenReportCntrlReqReports          Unsigned32,
       smfGenReportCntrlGrantedReports      Unsigned32,
       smfGenReportCntrlStartTime           TimeStamp,
       smfGenReportCntrlReportNumber        Unsigned32,
       smfGenReportCntrlInsertsDenied       Counter32,
       smfGenReportCntrlOwner               OwnerString,
       smfGenReportCntrlStorageType         StorageType,
       smfGenReportCntrlStatus              RowStatus
   }

   smfGenReportCntrlIndex OBJECT-TYPE
       SYNTAX      Unsigned32 (1..65535)
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "An index that uniquely identifies an entry in the
           smfGenReportCntrlTable.  Each such entry defines a unique
           report whose results are placed in the smfGenReportTable on
           behalf of this smfGenReportCntrlEntry."
       ::= { smfGenReportCntrlEntry 1 }


   smfGenReportCntrlInterval OBJECT-TYPE
       SYNTAX      Unsigned32
       UNITS       "Seconds"
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
          "The interval in seconds over which data is accumulated before
           being aggregated into a report in the smfGenReportTable.
           All reports with the same smfGenReportCntrlIndex will be



Cole, et al.            Expires September 1, 2009              [Page 41]

Internet-Draft                 The SMF MIB                 February 2009


           based on the same interval.

           This object may not be modified if the associated
           smfGenReportCntrlStatus object is equal to active(1)."
       DEFVAL { 3600 }
       ::= { smfGenReportCntrlEntry 2 }

   smfGenReportCntrlReqSize OBJECT-TYPE
       SYNTAX      Unsigned32
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The maximum number of Client and Server combination
           entries requested for this report.

           When this object is created or modified, the probe
           should set smfGenReportCntrlGrantedSize as closely to this
           object as is possible for the particular probe
           implementation and available resources.

           It is important to note that this value is the number of
           requested entries in the smfGenReportTable only.

           This object may not be modified if the associated
           smfGenReportCntrlStatus object is equal to active(1)."
       ::= { smfGenReportCntrlEntry 3 }

   smfGenReportCntrlGrantedSize OBJECT-TYPE
       SYNTAX      Unsigned32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The maximum number of performance entries in this report.

           When the associated smfGenReportCntrlReqSize object is
           created or modified, the probe should set this
           object as closely to the requested value as is
           possible for the particular implementation and
           available resources.  The probe must not lower this
           value except as a result of a set to the associated
           smfGenReportCntrlReqSize object.

           It is an implementation-specific matter as to whether
           zero-valued entries are available."
       ::= { smfGenReportCntrlEntry 4 }

   smfGenReportCntrlReqReports OBJECT-TYPE
       SYNTAX      Unsigned32 (1..65535)



Cole, et al.            Expires September 1, 2009              [Page 42]

Internet-Draft                 The SMF MIB                 February 2009


       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The number of saved reports requested to be allocated on
           behalf of this entry.

           This object may not be modified if the associated
           smfGenReportCntrlStatus object is equal to active(1)."
       ::= { smfGenReportCntrlEntry 5 }

   smfGenReportCntrlGrantedReports OBJECT-TYPE
       SYNTAX      Unsigned32 (0..65535)
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The number of saved reports the agent has allocated based
           on the requested amount in smfGenReportCntrlReqReports.
           Because each report can have many entries, the total number
           of entries allocated will be this number multiplied by the
           value of smfGenReportCntrlGrantedSize, or by 1 if that
           object doesn't exist.

           When the associated smfGenReportCntrlReqReports object is
           created or modified, the agent should set this object as
           closely to the requested value as is possible for the
           particular implementation and available resources.  When
           considering available resources, the agent must consider its
           ability to allocate this many reports, each with the number
           of entries represented by smfGenReportCntrlGrantedSize, or
           by 1 if that object doesn't exist.

           Note that although the storage required for each report may
           fluctuate due to changing conditions, the agent must continue
           to have storage available to satisfy the full report size for
           all reports, when necessary.  Further, the agent must not
           lower this value except as a result of a set to the
           associated smfGenReportCntrlReqSize object."
       ::= { smfGenReportCntrlEntry 6 }

   smfGenReportCntrlStartTime OBJECT-TYPE
       SYNTAX      TimeStamp
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The value of sysUpTime when the system began processing the
           report in progress.  Note that the report in progress is not
           available.




Cole, et al.            Expires September 1, 2009              [Page 43]

Internet-Draft                 The SMF MIB                 February 2009


           This object may be used by the management station to figure
           out the start time for all previous reports saved for this
           smfGenReportCntrlEntry, as reports are started at fixed
           intervals."
       ::= { smfGenReportCntrlEntry 7 }

   smfGenReportCntrlReportNumber OBJECT-TYPE
       SYNTAX      Unsigned32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The number of the report in progress.  When an
           smfGenReportCntrlEntry is activated, the first report will
           be numbered zero."
       ::= { smfGenReportCntrlEntry 8 }

   smfGenReportCntrlInsertsDenied OBJECT-TYPE
       SYNTAX      Counter32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The number of attempts to add an entry to reports for
           this SmfGenReportCntrlEntry that failed because the number
           of entries would have exceeded smfGenReportCntrlGrantedSize.

           This number is valuable in determining if enough entries have
           been allocated for reports in light of fluctuating network
           usage.  Note that an entry that is denied will often be
           attempted again, so this number will not predict the exact
           number of additional entries needed, but it can be used to
           understand the relative magnitude of the problem.

           Also note that there is no ordering specified for the entries
           in the report; thus, there are no rules for which entries
           will be omitted when not enough entries are available.  As a
           consequence, the agent is not required to delete 'least
           valuable' entries first."
       ::= { smfGenReportCntrlEntry 9 }

   smfGenReportCntrlOwner OBJECT-TYPE
       SYNTAX      OwnerString
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The entity that configured this entry and is
           therefore using the resources assigned to it.

           This object may not be modified if the associated



Cole, et al.            Expires September 1, 2009              [Page 44]

Internet-Draft                 The SMF MIB                 February 2009


           smfGenReportCntrlStatus object is equal to active(1)."
       ::= { smfGenReportCntrlEntry 10 }

   smfGenReportCntrlStorageType OBJECT-TYPE
       SYNTAX      StorageType
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The storage type of this smfGenReportCntrlEntry.  If the
           value of this object is 'permanent', no objects in this row
           need to be writable."
       ::= { smfGenReportCntrlEntry 11 }

   smfGenReportCntrlStatus OBJECT-TYPE
       SYNTAX      RowStatus
       MAX-ACCESS  read-create
       STATUS      current
       DESCRIPTION
           "The status of this performance control entry.

           An entry may not exist in the active state unless each
           object in the entry has an appropriate value.

           Once this object is set to active(1), no objects in the
           smfGenReportCntrlTable can be changed.

           If this object is not equal to active(1), all associated
           entries in the smfGenReportTable shall be deleted."
       ::= { smfGenReportCntrlEntry 12 }


   --
   -- Reports
   -- (Note: This represents a rather conservative list
   --  of objects for inclusion within offline report
   --  generation.  As discussions evolve, more objects
   --  may be added to the below set.
   --
   --  Also, it is typical to use this construct to define
   --  objects representing statistical information and not
   --  counter associated information.  We need to define a set
   --  of statistical objects for these remote reports and
   --  replace this place-holder set prior to finalizing this MIB.)
   --

   smfGenReportTable OBJECT-TYPE
       SYNTAX      SEQUENCE OF SmfGenReportEntry
       MAX-ACCESS  not-accessible



Cole, et al.            Expires September 1, 2009              [Page 45]

Internet-Draft                 The SMF MIB                 February 2009


       STATUS      current
       DESCRIPTION
           "This table contains
           studies for each of the control table entries in
           smfGenReportCntrlTable.  These studies are
           provided based on the selections and parameters
           found for the entry in the
           smfGenReportCntrlTable.

           The performance counter are the same as those
           specified in the smfPerformanceGroup."
       ::= { smfReportsGroup 2 }

   smfGenReportEntry OBJECT-TYPE
       SYNTAX      SmfGenReportEntry
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "A conceptual row in the smfGenReportTable.

           The smfGenReportCntrlIndex value in the index identifies the
           smfGenReportCntrlEntry on whose behalf this entry was
           created.

           The smfGenReportIndex value in the index identifies which
           report (in the series of reports) this entry is a part of.

           An example of the indexing of this entry is
           smfGenReportMultiPktsForwarded.3.15"
       INDEX { smfGenReportCntrlIndex,
               smfGenReportIndex
             }
       ::= { smfGenReportTable 1 }

   SmfGenReportEntry ::= SEQUENCE {
       smfGenReportIndex                              Unsigned32,
       smfGenReportIpv4MultiPktsRecvTot               ZeroBasedCounter32,
       smfGenReportIpv4MultiPktsForwardedTot          ZeroBasedCounter32,
       smfGenReportIpv4DuplMultiPktsDetectedTot       ZeroBasedCounter32,
       smfGenReportIpv4DroppedMultiPktsTTLExceededTot ZeroBasedCounter32
   }

   smfGenReportIndex  OBJECT-TYPE
       SYNTAX      Unsigned32 (1..2147483647)
       MAX-ACCESS  not-accessible
       STATUS      current
       DESCRIPTION
           "The value of smfGenReportCntrlNumber for the report to



Cole, et al.            Expires September 1, 2009              [Page 46]

Internet-Draft                 The SMF MIB                 February 2009


           which this entry belongs."
       ::= { smfGenReportEntry 1 }

   smfGenReportIpv4MultiPktsRecvTot  OBJECT-TYPE
       SYNTAX      ZeroBasedCounter32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The count of the total number of ...."
       ::= { smfGenReportEntry 2 }

   smfGenReportIpv4MultiPktsForwardedTot  OBJECT-TYPE
       SYNTAX      ZeroBasedCounter32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The count of the total number of ...."
       ::= { smfGenReportEntry 3 }

   smfGenReportIpv4DuplMultiPktsDetectedTot  OBJECT-TYPE
       SYNTAX      ZeroBasedCounter32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The count of the total number of ...."
       ::= { smfGenReportEntry 4 }

   smfGenReportIpv4DroppedMultiPktsTTLExceededTot  OBJECT-TYPE
       SYNTAX      ZeroBasedCounter32
       MAX-ACCESS  read-only
       STATUS      current
       DESCRIPTION
           "The count of the total number of ...."
       ::= { smfGenReportEntry 5 }


   --
   -- Notifications
   --

   -- Note:  What notifications do we want for this MIB?



   --
   -- Compliance Statements
   --




Cole, et al.            Expires September 1, 2009              [Page 47]

Internet-Draft                 The SMF MIB                 February 2009


   -- Note: need to update the Compliance section once the mib
   --       objects stablize.


   smfCompliances  OBJECT IDENTIFIER ::= { smfMIBConformance 1 }
   smfMIBGroups    OBJECT IDENTIFIER ::= { smfMIBConformance 2 }

   smfBasicCompliance  MODULE-COMPLIANCE
      STATUS current
      DESCRIPTION "The basic implementation requirements for
                   managed network entities that implement
                   the SMF RSSA process."
      MODULE  -- this module
      MANDATORY-GROUPS { smfCapabObjectsGroup,
                         smfConfigObjectsGroup }
   ::= { smfCompliances 1 }

   smfFullCompliance MODULE-COMPLIANCE
      STATUS current
      DESCRIPTION "The full implementation requirements for
                   managed network entities that implement
                   the SMF RSSA process."
      MODULE  -- this module
      MANDATORY-GROUPS { smfCapabObjectsGroup,
                         smfConfigObjectsGroup,
                         smfStateObjectsGroup,
                         smfPerfObjectsGroup,
                         smfRepObjectsGroup }
   ::= { smfCompliances 2 }

   --
   -- Units of Conformance
   --

   smfCapabObjectsGroup OBJECT-GROUP
      OBJECTS {
              smfOpModeCapabilitiesName,
              smfOpModeCapabilitiesReference,

              smfRssaCapabilitiesName,
              smfRssaCapabilitiesReference
      }
      STATUS  current
      DESCRIPTION
         "Set of SMF configuration objects implemented
          in this module."
   ::= { smfMIBGroups 1 }




Cole, et al.            Expires September 1, 2009              [Page 48]

Internet-Draft                 The SMF MIB                 February 2009


   smfConfigObjectsGroup OBJECT-GROUP
      OBJECTS {
              smfAdminStatus,
              smfConfiguredOpMode,
              smfConfiguredRssa,
              smfRssaMember,
              smfIpv4Dpd,
              smfIpv6Dpd,
              smfMaxPktLifetime,
              smfDpdMaxMemorySize,
              smfDpdEntryMaxLifetime,
              smfNhdpRssaMesgTLVIncluded,
              smfNhdpRssaAddrBlockTLVIncluded,
              smfNhdpRouterPriorityTLVIncluded,

              smfConfiguredAddrForwardingLastAddr,
              smfConfiguredAddrForwardingStatus,

              smfIfAdminStatus,
              smfIfRowStatus,

              smfGatewayFilterIf,
              smfGatewayFilterIfDirection,
              smfGatewayFilterRuleRank,
              smfGatewayFilterDestAddrType,
              smfGatewayFilterDestAddr,
              smfGatewayFilterDestAddrPrefixLen,
              smfGatewayFilterSrcAddrType,
              smfGatewayFilterSrcAddr,
              smfGatewayFilterSrcAddrPrefixLen,
              smfGatewayFilterProtocolNumber,
              smfGatewayFilterDestPortNumber,
              smfGatewayFilterAction,
              smfGatewayFilterRowStatus
      }
      STATUS  current
      DESCRIPTION
         "Set of SMF configuration objects implemented
          in this module."
   ::= { smfMIBGroups 2 }

   smfStateObjectsGroup  OBJECT-GROUP
      OBJECTS {
              smfNodeRsStatusIncluded,
              smfDpdMemoryOverflow,

              smfDiscoveredAddrForwardingLastAddr,
              smfDiscoveredAddrForwardingStatus,



Cole, et al.            Expires September 1, 2009              [Page 49]

Internet-Draft                 The SMF MIB                 February 2009


              smfNeighborRSSA,
              smfNeighborNextHopInterface
      }
      STATUS  current
      DESCRIPTION
         "Set of SMF state objects implemented
          in this module."
   ::= { smfMIBGroups 3 }

   smfPerfObjectsGroup  OBJECT-GROUP
      OBJECTS {
              smfIpv4MultiPktsRecvTotal,
              smfIpv4MultiPktsForwardedTotal,
              smfIpv4DuplMultiPktsDetectedTotal,
              smfIpv4DroppedMultiPktsTTLExceededTotal,
              smfIpv4TTLLargerThanPreviousTotal,

              smfIpv6MultiPktsRecvTotal,
              smfIpv6MultiPktsForwardedTotal,
              smfIpv6DuplMultiPktsDetectedTotal,
              smfIpv6DroppedMultiPktsTTLExceededTotal,
              smfIpv6TTLLargerThanPreviousTotal,
              smfIpv6HAVAssistsReqdTotal,
              smfIpv6DpdHeaderInsertionsTotal,

              smfIpv4MultiPktsRecvPerIf,
              smfIpv4MultiPktsForwardedPerIf,
              smfIpv4DuplMultiPktsDetectedPerIf,
              smfIpv4DroppedMultiPktsTTLExceededPerIf,
              smfIpv4TTLLargerThanPreviousPerIf,

              smfIpv6MultiPktsRecvPerIf,
              smfIpv6MultiPktsForwardedPerIf,
              smfIpv6DuplMultiPktsDetectedPerIf,
              smfIpv6DroppedMultiPktsTTLExceededPerIf,
              smfIpv6TTLLargerThanPreviousPerIf,
              smfIpv6HAVAssistsReqdPerIf,
              smfIpv6DpdHeaderInsertionsPerIf
      }
      STATUS  current
      DESCRIPTION
         "Set of SMF performance objects implemented
          in this module by total and per interface."
   ::= { smfMIBGroups 4 }

   smfRepObjectsGroup  OBJECT-GROUP
      OBJECTS {
              smfGenReportCntrlInterval,



Cole, et al.            Expires September 1, 2009              [Page 50]

Internet-Draft                 The SMF MIB                 February 2009


              smfGenReportCntrlReqSize,
              smfGenReportCntrlGrantedSize,
              smfGenReportCntrlReqReports,
              smfGenReportCntrlGrantedReports,
              smfGenReportCntrlStartTime,
              smfGenReportCntrlReportNumber,
              smfGenReportCntrlInsertsDenied,
              smfGenReportCntrlOwner,
              smfGenReportCntrlStorageType,
              smfGenReportCntrlStatus,

              smfGenReportIpv4MultiPktsRecvTot,
              smfGenReportIpv4MultiPktsForwardedTot,
              smfGenReportIpv4DuplMultiPktsDetectedTot,
              smfGenReportIpv4DroppedMultiPktsTTLExceededTot
      }
      STATUS  current
      DESCRIPTION
         "Set of SMF reports objects implemented
          in this module."
   ::= { smfMIBGroups 5 }


   END


8.  Security Considerations

   [TODO] Each specification that defines one or more MIB modules MUST
   contain a section that discusses security considerations relevant to
   those modules.  This section MUST be patterned after the latest
   approved template (available at
   http://www.ops.ietf.org/mib-security.html).  Remember that the
   objective is not to blindly copy text from the template, but rather
   to think and evaluate the risks/vulnerabilities and then state/
   document the result of this evaluation.

   [TODO] if you have any read-write and/or read-create objects, please
   include the following boilerplate paragraph.

   There are a number of management objects defined in this MIB module
   with a MAX-ACCESS clause of read-write and/or read-create.  Such
   objects may be considered sensitive or vulnerable in some network
   environments.  The support for SET operations in a non-secure
   environment without proper protection can have a negative effect on
   network operations.  These are the tables and objects and their
   sensitivity/vulnerability:




Cole, et al.            Expires September 1, 2009              [Page 51]

Internet-Draft                 The SMF MIB                 February 2009


   o  [TODO] writable MIB objects that could be especially disruptive if
      abused MUST be explicitly listed by name and the associated
      security risks MUST be spelled out; RFC 2669 has a very good
      example.

   o  [TODO] list the writable tables and objects and state why they are
      sensitive.

   [TODO] else if there are no read-write objects in your MIB module,
   use the following boilerplate paragraph.

   There are no management objects defined in this MIB module that have
   a MAX-ACCESS clause of read-write and/or read-create.  So, if this
   MIB module is implemented correctly, then there is no risk that an
   intruder can alter or create any management objects of this MIB
   module via direct SNMP SET operations.

   [TODO] if you have any sensitive readable objects, please include the
   following boilerplate paragraph.

   Some of the readable objects in this MIB module (i.e., objects with a
   MAX-ACCESS other than not-accessible) may be considered sensitive or
   vulnerable in some network environments.  It is thus important to
   control even GET and/or NOTIFY access to these objects and possibly
   to even encrypt the values of these objects when sending them over
   the network via SNMP.  These are the tables and objects and their
   sensitivity/vulnerability:

   o  [TODO] you must explicitly list by name any readable objects that
      are sensitive or vulnerable and the associated security risks MUST
      be spelled out (for instance, if they might reveal customer
      information or violate personal privacy laws such as those of the
      European Union if exposed to unauthorized parties)

   o  [TODO] list the tables and objects and state why they are
      sensitive.

   [TODO] discuss what security the protocol used to carry the
   information should have.  The following three boilerplate paragraphs
   should not be changed without very good reason.  Changes will almost
   certainly require justification during IESG review.

   SNMP versions prior to SNMPv3 did not include adequate security.
   Even if the network itself is secure (for example by using IPSec),
   even then, there is no control as to who on the secure network is
   allowed to access and GET/SET (read/change/create/delete) the objects
   in this MIB module.




Cole, et al.            Expires September 1, 2009              [Page 52]

Internet-Draft                 The SMF MIB                 February 2009


   It is RECOMMENDED that implementers consider the security features as
   provided by the SNMPv3 framework (see [RFC3410], section 8),
   including full support for the SNMPv3 cryptographic mechanisms (for
   authentication and privacy).

   Further, deployment of SNMP versions prior to SNMPv3 is NOT
   RECOMMENDED.  Instead, it is RECOMMENDED to deploy SNMPv3 and to
   enable cryptographic security.  It is then a customer/operator
   responsibility to ensure that the SNMP entity giving access to an
   instance of this MIB module is properly configured to give access to
   the objects only to those principals (users) that have legitimate
   rights to indeed GET or SET (change/create/delete) them.

9.  IANA Considerations

   [TODO] In order to comply with IESG policy as set forth in
   http://www.ietf.org/ID-Checklist.html, every Internet-Draft that is
   submitted to the IESG for publication MUST contain an IANA
   Considerations section.  The requirements for this section vary
   depending what actions are required of the IANA. see RFC4181 section
   3.5 for more information on writing an IANA clause for a MIB module
   document.

   [TODO] select an option and provide the necessary details.

   Option #1:


        The MIB module in this document uses the following IANA-assigned
        OBJECT IDENTIFIER values recorded in the SMI Numbers registry:

        Descriptor        OBJECT IDENTIFIER value
        ----------        -----------------------

        sampleMIB  { mib-2 XXX }

   Option #2:

   Editor's Note (to be removed prior to publication): the IANA is
   requested to assign a value for "XXX" under the 'mib-2' subtree and
   to record the assignment in the SMI Numbers registry.  When the
   assignment has been made, the RFC Editor is asked to replace "XXX"
   (here and in the MIB module) with the assigned value and to remove
   this note.

   Note well: prior to official assignment by the IANA, a draft document
   MUST use placeholders (such as "XXX" above) rather than actual
   numbers.  See RFC4181 Section 4.5 for an example of how this is done



Cole, et al.            Expires September 1, 2009              [Page 53]

Internet-Draft                 The SMF MIB                 February 2009


   in a draft MIB module.

   Option #3:

   This memo includes no request to IANA.

10.  Contributors

   This MIB document uses the template authored by D. Harrington which
   is based on contributions from the MIB Doctors, especially Juergen
   Schoenwaelder, Dave Perkins, C.M.Heard and Randy Presuhn.

11.  Acknowledgements

12.  References

12.1.  Normative References

   [RFC2863]             McCloghrie, K. and F. Kastenholz, "The
                         Interfaces Group MIB", RFC 2863, June 2000.

   [RFC3418]             Presuhn, R., "Management Information Base (MIB)
                         for the Simple Network Management Protocol
                         (SNMP)", STD 62, RFC 3418, December 2002.

   [RFC2119]             Bradner, S., "Key words for use in RFCs to
                         Indicate Requirement Levels", BCP 14, RFC 2119,
                         March 1997.

   [RFC2578]             McCloghrie, K., Ed., Perkins, D., Ed., and J.
                         Schoenwaelder, Ed., "Structure of Management
                         Information Version 2 (SMIv2)", STD 58,
                         RFC 2578, April 1999.

   [RFC2579]             McCloghrie, K., Ed., Perkins, D., Ed., and J.
                         Schoenwaelder, Ed., "Textual Conventions for
                         SMIv2", STD 58, RFC 2579, April 1999.

   [RFC2580]             McCloghrie, K., Perkins, D., and J.
                         Schoenwaelder, "Conformance Statements for
                         SMIv2", STD 58, RFC 2580, April 1999.

   [I-D.ietf-manet-smf]  Macker, J. and S. Team, "Simplified Multicast
                         Forwarding for MANET", draft-ietf-manet-smf-08
                         (work in progress), November 2008.






Cole, et al.            Expires September 1, 2009              [Page 54]

Internet-Draft                 The SMF MIB                 February 2009


12.2.  Informative References

   [RFC3410]             Case, J., Mundy, R., Partain, D., and B.
                         Stewart, "Introduction and Applicability
                         Statements for Internet-Standard Management
                         Framework", RFC 3410, December 2002.

Appendix A.  Change Log

   Not applicable to draft 00

   1.

Appendix B.  Open Issues

   This section contains the set of open issues related to the
   development and design of the SMF-MIB.  This section will not be
   present in the final version of the MIB and will be removed once all
   the open issues have been resolved.

   1.   Clarify handling of the NHDP TLV message inclusions?

   2.   Can we develop a capabilities table for the supported RSSA
        algorithms?  And, if so, can each supported RSSA have a
        different set of configuration parameters?

   3.   Is the Gateway Filter table appropriate for this MIB or should
        it be handled in a separate MIB worked elsewhere?  How should
        this table be indexed and how should it represent the ordering
        of the rules (or chains)?  Should this be greatly simplified?
        How do we handle null values in the rules?

   4.   Is it useful to track the effectiveness of the coverage of the
        current RSSA?  Is it possible to track this?

   5.   Complete notification group.

   6.   Complete conformance group.

   7.   Work on the relationship to other MIBs, IF-MIB, NHDP-MIB.

   8.   Update the text of the document to reflect the final state of
        the MIB.

   9.   Identify all objects requiring non-volatile storage in their
        DESCRIPTION clauses.





Cole, et al.            Expires September 1, 2009              [Page 55]

Internet-Draft                 The SMF MIB                 February 2009


   10.  Incorporate parameter relationship conditions into their
        DESCRIPTION clauses.

   11.  Complete the security analysis and section.

   12.  Cleanup all the [TODOs] from the MIB template.

Appendix C.


   ***************************************************************
   * Note to the RFC Editor (to be removed prior to publication) *
   *                                                             *
   * 1) The reference to RFCXXXX within the DESCRIPTION clauses  *
   * of the MIB module point to this draft and are to be         *
   * assigned by the RFC Editor.                                 *
   *                                                             *
   * 2) The reference to RFCXXX2 throughout this document point  *
   * to the current draft-ietf-manet-smf-xx.txt.  This           *
   * need to be replaced with the XXX RFC number.                *
   *                                                             *
   ***************************************************************

Authors' Addresses

   Robert G. Cole
   Johns Hopkins University
   11100 Johns Hopkins Road, Room 257
   Laurel, Maryland  21073
   USA

   Phone: +1 443 778 6951
   EMail: robert.cole@jhuapl.edu
   URI:   http://www.cs.jhu.edu/~rgcole/


   Joseph Macker
   Naval Research Laboratory
   Washington, D.C.  20375
   USA

   EMail: macker@itd.nrl.navy.mil









Cole, et al.            Expires September 1, 2009              [Page 56]

Internet-Draft                 The SMF MIB                 February 2009


   Brian Adamson
   Naval Research Laboratory
   Washington, D.C.  20375
   USA

   EMail: adamson@itd.nrl.navy.mil


   Sean Harnedy
   Booz Allen Hamilton
   333 City Boulevard West
   Orange, CA  92868
   USA

   EMail: harnedy_sean@bah.com




































Cole, et al.            Expires September 1, 2009              [Page 57]

