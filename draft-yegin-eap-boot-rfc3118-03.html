<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Bootstrapping RFC3118 Delayed DHCP Authentication
            Using EAP-based Network Access Authentication</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Bootstrapping RFC3118 Delayed DHCP Authentication
            Using EAP-based Network Access Authentication">
<meta name="keywords" content="bootstrapping rfc3118 security, DHCP Authentication using EAP">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Dynamic Host Configuration</td><td class="header">H. Tschofenig</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Nokia Siemens Networks</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">A. Yegin</td></tr>
<tr><td class="header">Expires: January 15, 2009</td><td class="header">Samsung</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">D. Forsberg</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Nokia</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 14, 2008</td></tr>
</table></td></tr></table>
<h1><br />Bootstrapping RFC3118 Delayed DHCP Authentication
            Using EAP-based Network Access Authentication<br />draft-yegin-eap-boot-rfc3118-03.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 15, 2009.</p>

<h3>Abstract</h3>

<p>The DHCP authentication extension (RFC 3118) cannot be widely deployed due to lack of
                a key agreement protocol. This document outlines how EAP-based network access
                authentication mechanisms can be used to establish bootstrap keying material that
                can be used to subsequently use RFC 3118 security. 
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
Introduction<br />
<a href="#terminology">2.</a>&nbsp;
Terminology<br />
<a href="#Overview">3.</a>&nbsp;
Overview and Building Blocks <br />
<a href="#building">4.</a>&nbsp;
Buliding DHCP SA<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#e802">4.1.</a>&nbsp;
802.1X<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ppp">4.2.</a>&nbsp;
PPP<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#pana">4.3.</a>&nbsp;
PANA<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#computing">4.4.</a>&nbsp;
Computing DHCP SA<br />
<a href="#delivering">5.</a>&nbsp;
Delivering DHCP SA<br />
<a href="#using">6.</a>&nbsp;
Using DHCP SA<br />
<a href="#security-considerations">7.</a>&nbsp;
Security Considerations<br />
<a href="#iana-considerations">8.</a>&nbsp;
IANA Considerations<br />
<a href="#open">9.</a>&nbsp;
Open Issues<br />
<a href="#acks">10.</a>&nbsp;
Acknowledegments<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>The Extensible Authentication Protocol (EAP) <a class='info' href='#RFC3748'>[RFC3748]<span> (</span><span class='info'>Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;Extensible Authentication Protocol (EAP),&rdquo; June&nbsp;2004.</span><span>)</span></a> provides a
                network access authentication framework by carrying authentication process between
                the hosts and the access networks. The combination of EAP with a AAA architecture
                allows authentication and authorization of a roaming user to an access network. A
                successful authentication between a client and the network produces a dynamically
                created trust relation between the two. Almost all EAP methods (e.g., EAP-TLS,
                EAP-SIM) are capable of generating cryptographic keys between the EAP peer and the
                EAP server. Using key transport via the AAA infrastructure the EAP server makes the
                EAP-provided keying material available to the Authenticator (e.g., Network Access
                Server; NAS) after a successful authentication attempt. These keys are commonly used
                in conjunction with per-packet security mechanisms (e.g., link-layer ciphering).
                This procedure is described in <a class='info' href='#I-D.ietf-eap-keying'>[I&#8209;D.ietf&#8209;eap&#8209;keying]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a>.
</p>
<p>DHCP <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> is a protocol which provides a host with configuration
                parameters. The base DHCP does not include any security mechanism, hence it is
                vulnerable to a number of security threats. The security considerations section of
                RFC 2131 <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a> identifies it as "quite insecure" and lists
                various security threats.
</p>
<p>RFC 3118 <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> is the DHCP authentication protocol that defines
                how to authenticate various DHCP messages. It does not support roaming clients and
                assumes out-of-band or manual key establishment. These limitations have been
                inhibiting widespread deployment of this security mechanism as noted in a DHCPv4
                threat analysis <a class='info' href='#I-D.ietf-dhc-v4-threat-analysis'>[I&#8209;D.ietf&#8209;dhc&#8209;v4&#8209;threat&#8209;analysis]<span> (</span><span class='info'>Hibbs, R., &ldquo;Dynamic Host Configuration Protocol for IPv4 (DHCPv4) Threat Analysis,&rdquo; June&nbsp;2006.</span><span>)</span></a>. 
</p>
<p>It is possible to use the authentication and key exchange procedure executed during
                the network access authentication to bootstrap a security association for DHCP. The
                access authentication procedure can be utilized to dynamically provide the keying
                material to RFC 3118 based security protection for DHCP. This document defines how
                to use the EAP-based access authentication procedure to bootstrap RFC 3118 security. 
</p>
<p>The general framework of the mechanism described in this I-D can be outlined as
                follows: </p>
<ol class="text">
<li> The client gains network access by utilizing an EAP method that generates
                        session keys. As part of the network access process, the client and the
                        authentication agent (NAS) communicate their intention to create a DHCP
                        security association and exchange the required parameters (e.g., nonce, key
                        ID, etc.) The required information exchange is handled by the EAP
                        lower-layer which also carries EAP.
</li>
<li>Although the newly generated DHCP SA is already available to the DHCP client,
                        in case the NAS (acting as a DHCP relay) and the DHCP server are not
                        co-located, the SA parameters need to be communicated to the DHCP server.
                        This requires a protocol exchange, which can be piggybacked with the DHCP signaling.
</li>
<li>The DHCP signaling that immediately follows the network access authentication
                        process utilizes RFC 3118 to secure the protocol exchange. Both the client
                        and the server rely on the DHCP SA to compute and verify the authentication codes.
</li>
</ol><p>
            
</p>
<p>This framework requires extensions to the EAP lower-layers (PPP <a class='info' href='#RFC1661'>[RFC1661]<span> (</span><span class='info'>Simpson, W., &ldquo;The Point-to-Point Protocol (PPP),&rdquo; July&nbsp;1994.</span><span>)</span></a>, IEEE 802.1X , PANA <a class='info' href='#RFC5191'>[RFC5191]<span> (</span><span class='info'>Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;Protocol for Carrying Authentication for Network Access (PANA),&rdquo; May&nbsp;2008.</span><span>)</span></a>) to carry
                the supplemental parameters required for the generation of the DHCP SA. Another
                extension is required to carry the DHCP SA parameters from a DHCP relay to a DHCP
                server. RFC 3118 can be used without any modifications or extensions. 
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>In this document, the key words "MAY", "MUST, "MUST NOT", OPTIONAL","RECOMMENDED
                "SHOULD", and "SHOULD NOT", are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>This document uses the following terms:
</p>
<p>
                </p>
<blockquote class="text"><dl>
<dt>DHCP Security Association:</dt>
<dd>
                        <br />
To secure DHCP messages a number of parameters
                        including the key that is shared between the client (DHCP client) and the
                        DHCP server have to be established. These parameters are collectively
                        referred to as DHCP security association (or in short DHCP SA).<br />
<br />
 DHCP SA can be considered as a group security association.
                        The DHCP SA parameters are provided to the DHCP server as soon as the client
                        chooses the server to carry out DHCP. The same DHCP SA can be used by any
                        one of the DHCP servers that are available to the client. 
</dd>
<dt>DHCP Key:</dt>
<dd>
                        <br />
 This term refers to the fresh and unique session
                        key dynamically established between the DHCP client and the DHCP server.
                        This key is used to protect DHCP messages as described in <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a>. 
</dd>
</dl></blockquote><p>
            
</p>
<a name="Overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Overview and Building Blocks </h3>

<p> The bootstrapping mechanism requires protocol interaction between the client host
                (which acts as a DHCP client), the NAS and the DHCP server. A security association
                will be established between the DHCP server and the DHCP client to protect the DHCP
                messages. 
</p>
<p>A DHCP SA is generated based on the EAP method derived key after a successful EAP
                method protocol run. Both the client and the NAS should agree on the generation of a
                DHCP SA after the EAP SA is created. This involves a handshake between the two and
                exchange of additional parameters (such as nonce, key ID, etc.). These additional
                information needs to be carried over the EAP lower-layer that also carries the EAP
                payloads. 
</p>
<p>The DHCP SA is ultimately needed by the DHCP client and the DHCP server. On the
                network side, the DHCP SA information needs to be transferred from the NAS (where it
                is generated) to the DHCP server (where it will be used). On the client host side,
                it is transferred from the network access authentication client to the DHCP client. 
</p>
<p>NAS is always located one IP hop away from the client. If the DHCP server is on the
                same link, it can be co-located with the NAS. When the NAS and the DHCP server are
                co-located, an internal mechanism, such as an API, is sufficient for transferring
                the SA information. If the DHCP server is multiple hops away from the DHCP client,
                then there must be a DHCP relay on the same link as the client. In that case, the
                NAS should be co-located with the DHCP relay
</p>
<p>
                <a class='info' href='#RFC4014'>[RFC4014]<span> (</span><span class='info'>Droms, R. and J. Schnizlein, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option,&rdquo; February&nbsp;2005.</span><span>)</span></a> enables transmission of AAA-related RADIUS attributes from
                a DHCP relay to a DHCP server in the form of relay agent information options. DHCP
                SA is generated at the end of the AAA process, and therefore it can be provided to
                the DHCP server in a sub-option carried along with other AAA-related information.
                Confidentiality, replay, and integrity protection of this exchange MUST be provided.
                    <a class='info' href='#I-D.ietf-dhc-relay-agent-ipsec'>[I&#8209;D.ietf&#8209;dhc&#8209;relay&#8209;agent&#8209;ipsec]<span> (</span><span class='info'>Droms, R., &ldquo;Authentication of DHCP Relay Agent Options Using IPsec,&rdquo; May&nbsp;2005.</span><span>)</span></a> proposes IPsec protection of the
                DHCP messages exchanged between the DHCP relay and the DHCP server. DHCP objects
                (protected with IPsec) can therefore be used to communicate the necessary
                parameters. 
</p>
<p> Two different deployment scenarios are illustrated in <a class='info' href='#protocols'>Figure&nbsp;1<span> (</span><span class='info'>Protocols and end points. </span><span>)</span></a>. 
</p><br /><hr class="insert" />
<a name="protocols"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
+---------+              +------------------+
|EAP Peer/|              |EAP Authenticator/|
|  DHCP   |&lt;============&gt;|   DHCP server    |
| client  | EAP and DHCP |                  |
+---------+              +------------------+
Client Host                       NAS


+---------+              +------------------+          +-----------+
|EAP Peer/|              |EAP Authenticator/|          |           |
|  DHCP   |&lt;============&gt;|   DHCP relay     |&lt;========&gt;|DHCP server|
| client  | EAP and DHCP |                  |   DHCP   |           |
+---------+              +------------------+          +-----------+
Client Host                       NAS
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Protocols and end points. &nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>When the DHCP SA information is received by the DHCP server and client, it can be
                used along with RFC 3118 to protect DHCP messages against various security threats.
                This draft provides the guidelines regarding how the RFC 3118 protocol fields should
                be filled in based on the DHCP SA. 
</p>
<a name="building"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Buliding DHCP SA</h3>

<p>DHCP SA is created at the end of the EAP-based access authentication process. This
                section describes extensions to the EAP lower-layers for exchanging the additional
                information, and the process of generating the DHCP SA.
</p>
<a name="e802"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
802.1X</h3>

<p>This work needs to be done in the IEEE and hence this section is intentionally left blank.
</p>
<a name="ppp"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
PPP</h3>

<p> A new IPCP configuration option is defined in order to bootstrap DHCP SA between
                    the PPP peers. Each end of the link must separately request this option for
                    mutual establishment of DHCP SA. Only one side sending the option will not
                    produce any state.
</p>
<p> The detailed DHCP-SA Configuration Option is presented below.
</p><br /><hr class="insert" />
<a name="dhcp"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |     Type      |    Length     |             Reserved          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           Secret ID                           |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                         Nonce Data                            ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: DHCP SA Configuration Option&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> Type </p>
<ul class="text">
<li> TBD 
</li>
</ul><p>
                
</p>
<p>Length </p>
<ul class="text">
<li> &gt;=24 
</li>
</ul><p>
                
</p>
<p>Reserved </p>
<ul class="text">
<li> A 16-bit value reserved for future use. It MUST be initialized to zero
                            by the sender, and ignored by the receiver. 
</li>
</ul><p>
                
</p>
<p>Secret ID </p>
<ul class="text">
<li> 32 bit value that identifies the DHCP Key produced as a result of the
                            bootstrapping process. This value is determined by the NAS and sent to
                            the client. The NAS determines this value by randomly picking a number
                            from the available secret ID pool. If the client does not request
                            DHCP-SA configuration option, this value is returned to the available
                            identifiers pool. Otherwise, it is allocated to the client until the
                            DHCP SA expires. The client MUST set this field to all 0s in its own
                            request. 
</li>
</ul><p>
                
</p>
<p> Nonce Data (variable length) </p>
<ul class="text">
<li> Contains the random data generated by the transmitting entity. This
                            field contains the Nonce_client value when the option is sent by client,
                            and the Nonce_NAS value when the option is sent by NAS. Nonce value MUST
                            be randomly chosen and MUST be at least 128 bits in size. Nonce values
                            MUST NOT be reused. 
</li>
</ul><p>
                
</p>
<a name="pana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
PANA</h3>

<p>A new PANA AVP is defined in order to bootstrap DHCP SA. The DHCP-AVP is included
                    in the PANA-Bind-Request message if PAA (NAS) is offering DHCP SA bootstrapping
                    service. If the PaC wants to proceed with creating DHCP SA at the end of the
                    PANA authentication, it MUST include DHCP-AVP in its PANA-Bind-Answer message. 
</p>
<p> Absence of this AVP in the PANA-Bind-Request message sent by the PAA indicates
                    unavailability of this additional service. In that case, PaC MUST NOT include
                    DHCP-AVP in its response, and PAA MUST ignore received DHCP-AVP. When this AVP
                    is received by the PaC, it may or may not include the AVP in its response
                    depending on its desire to create a DHCP SA. A DHCP SA can be created as soon as
                    each entity has received and sent one DHCP-AVP. 
</p>
<p> The detailed DHCP-AVP format is presented below:
</p><br /><hr class="insert" />
<a name="dhcp-avp"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
       0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                           AVP Code                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |   AVP Flags   |                  AVP Length                   |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                            Secret ID                          |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   ~                            Nonce Data                         ~
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;3: DHCP AVP Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p> AVP Code </p>
<ul class="text">
<li> TBD 
</li>
</ul><p>
                
</p>
<p>AVP Flags </p>
<ul class="text">
<li> The AVP Flags field is eight bits. The following bits are assigned:
                                <br /><hr class="insert" />
<a name="dhcp-avp-flag"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0 1 2 3 4 5 6 7
     +-+-+-+-+-+-+-+-+
     |V M r r r r r r|
     +-+-+-+-+-+-+-+-+
</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;4: DHCP AVP Flags&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

                        
</li>
</ul><p>
                
</p>
<p>M(andatory) </p>
<ul class="text">
<li> The 'M' Bit, known as the Mandatory bit, indicates whether support of
                            the AVP is required. This bit is not set in DHCP-AVP. 
</li>
</ul><p>
                
</p>
<p>V(endor) </p>
<ul class="text">
<li> The 'V' bit, known as the Vendor-Specific bit, indicates whether the
                            optional Vendor-Id field is present in the AVP header. This bit is not
                            set in DHCP-AVP. 
</li>
</ul><p>
                
</p>
<p>r(eserved) </p>
<ul class="text">
<li> These flag bits are reserved for future use, and MUST be set to zero,
                            and ignored by the receiver. 
</li>
</ul><p>
                
</p>
<p>AVP Length </p>
<ul class="text">
<li>The AVP Length field is three octets, and indicates the number of octets
                            in this AVP including the AVP Code, AVP Length, AVP Flags, and AVP data. 
</li>
</ul><p>
                
</p>
<p>Secret ID </p>
<ul class="text">
<li>A 32-bit value that identifies the DHCP Key produced as a result of the
                            bootstrapping process. This value is determined by the PAA and sent to
                            the PaC. The PAA determines this value by randomly picking a number from
                            the available secret ID pool. If PaC's response does not contain
                            DHCP-AVP then this value is returned to the available identifiers pool.
                            Otherwise, it is allocated to the PaC until the DHCP SA expires. The PaC
                            MUST set this field to all 0s in its response. 
</li>
</ul><p>
                
</p>
<p>Nonce Data (variable length) </p>
<ul class="text">
<li>Contains the random data generated by the transmitting entity. This field
                            contains the Nonce_client value when the AVP is sent by PaC, and the
                            Nonce_NAS value when the AVP is sent by PAA. Nonce value MUST be
                            randomly chosen and MUST be at least 128 bits in size. Nonce values MUST
                            NOT be reused. 
</li>
</ul><p>
                
</p>
<a name="computing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Computing DHCP SA</h3>

<p>The key derivation procedure is reused from IKE <a class='info' href='#RFC2409'>[RFC2409]<span> (</span><span class='info'>Harkins, D. and D. Carrel, &ldquo;The Internet Key Exchange (IKE),&rdquo; November&nbsp;1998.</span><span>)</span></a>. The
                    character '|' denotes concatenation.
</p>
<p> DHCP Key = HMAC-SHA1(MSK, const | Secret ID | Nonce_client | Nonce_NAS)
</p>
<p>The values have the following meaning:</p>
<blockquote class="text"><dl>
<dt>MSK:</dt>
<dd>
                            <br />
 A key derived by the EAP peer and EAP
                            (authentication) server at
                            the end of the successful network access AAA. <br />
<br />

                        
</dd>
<dt>const:</dt>
<dd>
                            <br />
 This is a string constant. The value of the
                            const parameter is set to "EAP RFC 3118 Bootstrapping". <br />
<br />

                        
</dd>
<dt>Secret ID:</dt>
<dd>
                            <br />
The unique identifier of the DHCP key as carried
                            by the EAP lower-layer protocol extension. <br />
<br />

                        
</dd>
<dt>Nonce Client:</dt>
<dd>
                            <br />
 This random number is provided by the client
                            and carried by the EAP lower-layer protocol extension. <br />
<br />

                        
</dd>
<dt>Nonce NAS:</dt>
<dd>
                            <br />
 This random number is provided by the NAS and
                            carried by the EAP lower-layer protocol. <br />
<br />

                        
</dd>
<dt>DHCP Key:</dt>
<dd>
                            <br />
This session key is 128-bit in length and used
                            as the session key for securing DHCP messages. Figure 1 of [EAP-Key]
                            refers to this derived key as a Transient Session Key (TSK). 
</dd>
</dl></blockquote><p>
                
</p>
<p>The lifetime of the DHCP security association has to be limited to prevent the
                    DHCP server from storing state information indefinitely. The lifetime of the
                    DHCP SA SHOULD be set equal to the lifetime of the network access service. The
                    client host, NAS, and the DHCP server SHOULD be (directly or indirectly) aware
                    of this lifetime at the end of a network access AAA.
</p>
<p>The PaC can at any time trigger a new bootstrapping protocol run to establish a
                    new security association with the DHCP server. The IP address lease time SHOULD
                    be limited by the DHCP SA lifetime
</p>
<a name="delivering"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Delivering DHCP SA</h3>

<p> When the NAS and the DHCP server are not co-located, the DHCP SA information is
                carried from the NAS (DHCP relay) to the DHCP server in a DHCP relay agent info
                option. This sub-option can be included along with the RADIUS attributes sub-option
                that is carried after the network access authentication.
</p>
<p>The format of the DHCP SA sub-option is: <br /><hr class="insert" />
<a name="dhcp-suboption"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0                   1                   2                   3
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1

   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |  SubOpt Code  |    Length     |          Reserved             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Secret ID                            |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                                                               |
   +                                                               +
   |                                                               |
   +                          DHCP Key                             +
   |                                                               |
   +                                                               +
   |                                                               |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |                          Lifetime                             |
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;5: DHCP SA Suboption&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

            
</p>
<p>
                </p>
<blockquote class="text"><dl>
<dt>subopt code:</dt>
<dd>
                        <br />
 TBD <br />
<br />

                    
</dd>
<dt>Length:</dt>
<dd>
                        <br />
 This value is set to 26.<br />
<br />

                    
</dd>
<dt>Reserved:</dt>
<dd>
                        <br />
 A 16-bit value reserved for future use. It MUST be
                        initialized to zero by the sender, and ignored by the receiver. <br />
<br />

                    
</dd>
<dt>Secret ID:</dt>
<dd>
                        <br />
 This is the 32-bit value assigned by the NAS and
                        used to identify the DHCP key. <br />
<br />

                    
</dd>
<dt>DHCP Key:</dt>
<dd>
                        <br />
 128-bit DHCP key computed by the NAS is carried in
                        this field.<br />
<br />

                    
</dd>
<dt>Lifetime:</dt>
<dd>
                        <br />
The lifetime of the DHCP SA. This Unsigned32 value
                        contains the number of seconds remaining before the DHCP SA is considered
                            expired.<br />
<br />

                    
</dd>
</dl></blockquote><p>
            
</p>
<a name="using"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Using DHCP SA</h3>

<p>Once the DHCP SA is in place, it is used along with RFC 3118 to secure the DHCP
                protocol exchange.
</p>
<p>RFC 3118 <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> defines two security protocols with a newly defined
                authentication option: </p>
<ul class="text">
<li>Configuration token 
</li>
<li>Delayed authentication 
</li>
</ul><p>
            
</p>
<p>The generic format of the authentication option is defined in Section 2 of RFC 3118
                    <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> and contains the following fields: </p>
<ul class="text">
<li>Code 
</li>
<li>Delayed authentication 
</li>
</ul><p>
            
</p>
<p>The value for the Code field of this authentication option is 90. 
</p>
<p>
                </p>
<ul class="text">
<li>Length 
</li>
</ul><p>
            
</p>
<p>The Length field indicates the length of the authentication option payload. 
</p>
<p>
                </p>
<ul class="text">
<li>Protocol 
</li>
</ul><p>
            
</p>
<p>RFC 3118 <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> defines two values for the Protocol field - zero
                and one. A value of zero indicates the usage of the configuration token
                authentication option. 
</p>
<p>As described in Section 4 of RFC 3118 <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> the configuration
                token only provides weak entity authentication. Hence its usage is not recommended.
                This authentication option will not be considered for the purpose of bootstrapping. 
</p>
<p>A value of one in the Protocol field in the authentication option indicates the
                delayed authentication. The usage of this option is subsequently assumed in this
                document. 
</p>
<p>Since the value for this field is known in advance it does not need to be negotiated
                between the DHCP client and DHCP server. 
</p>
<p>
                </p>
<ul class="text">
<li> Algorithm 
</li>
</ul><p>
            
</p>
<p>RFC 3118 <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> only defines the usage of HMAC-MD5 (value 1 in the
                Algorithm field). This document assumes that HMAC-MD5 is used to protect DHCP
                messages. 
</p>
<p>Since the value for this field is known in advance it does not need to be negotiated.
                [Editor's Note: Based on crypto agility requirements it seems reasonable to consider future algorithm support as well.] 
</p>
<p>
                </p>
<ul class="text">
<li> Replay Detection Method (RDM) 
</li>
</ul><p>
            
</p>
<p>The value of zero for the RDM name space is assigned to use a monotonically
                increasing value. 
</p>
<p>Since the value for this field is known in advance it does not need to be negotiated. 
</p>
<p>
                </p>
<ul class="text">
<li> Replay Detection
</li>
</ul><p>
            
</p>
<p>This field contains the value that is used for replay protection. This value MUST be
                monotonically increasing according to the provided replay detection method. An
                initial value must, however, be set. In case of bootstrapping with EAP an initial
                value of zero is used. The length of 64 bits (and a start-value of zero) ensures
                that a sequence number rollover is very unlikely to occur.
</p>
<p>Since the value for this field is known in advance it does not need to be negotiated. 
</p>
<p>
                </p>
<ul class="text">
<li> Authentication Information
</li>
</ul><p>
            
</p>
<p>The content of this field depends on the type of message where the authentication
                option is used. Section 5.2 of RFC 3118 <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> does not provide
                content for the DHCPDISCOVER and the DHCPINFORM message. Hence for these messages no
                additional considerations need to be specified in this document. 
</p>
<p>Since the value for this field is known in advance it does not need to be negotiated. 
</p>
<p> For a DHCPOFFER, DHCPREQUEST or DHCPACK message the content of the Authentication
                Information field is given as: </p>
<ul class="text">
<li>Secret ID (32 bits) 
</li>
<li>HMAC-MD5 (128 bits)
</li>
</ul><p>
            
</p>
<p>The Secret ID is chosen by the NAS to prevent collisions. [NOTE: If there are
                multiple NASes per DHCP server, this identifier space might need to be
                pre-partitioned among the NASes.]
</p>
<p>HMAC-MD5 is the output of the key message digest computation. Note that not all
                fields of the DHCP message are protected as described in RFC 3118 <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a>. 
</p>
<a name="security-considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>This document describes a mechanism for dynamically establishing a security
                association to protect DHCP signaling messages. 
</p>
<p>If the NAS and the DHCP server are co-located then the session keys and the security
                parameters are transferred locally (via an API call). Some security protocols
                already exercise similar methodology to separate functionality.
</p>
<p>If the NAS and the DHCP server are not co-located then there is some similarity to
                the requirements and issues discussed with the EAP Keying Framework (see <a class='info' href='#I-D.ietf-eap-keying'>[I&#8209;D.ietf&#8209;eap&#8209;keying]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a>). The DHCP key is a Transient Session Key (TEK) from
                    <a class='info' href='#I-D.ietf-eap-keying'>[I&#8209;D.ietf&#8209;eap&#8209;keying]<span> (</span><span class='info'>Aboba, B., Simon, D., and P. Eronen, &ldquo;Extensible Authentication Protocol (EAP) Key Management Framework,&rdquo; November&nbsp;2007.</span><span>)</span></a>. The key is generated by both the DHCP
                client and the DHCP relay, and transported from the DHCP relay to the DHCP server.
                The DHCP protocol exchange between the DHCP client and DHCP server is protected
                using this key.
</p><br /><hr class="insert" />
<a name="keying"></a>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
 EAP peer (DHCP client) +-----------------------+ DHCP server
                        /\                     /
                       /  \ Protocol: EAP     /
                      /    \ lower-layer;    /
                     /      \ Auth: Mutual; /
                    /        \ Unique key: /
Protocol: EAP;     /          \ DHCP key  /
Auth: Mutual;     /            \         / Protocol: DHCP, or API;
Unique keys:MSK, /              \       / Auth: Mutual;
 EMSK           /                \     / Unique key: DHCP key
               /                  \   /
              /                    \ /
Auth. server +----------------------+  Authenticator
                   Protocol: AAA;     (NAS, DHCP relay)
                   Auth: Mutual;
                   Unique key:
                    AAA session key

</pre></div><table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;6: Keying Architecture&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
                <a class='info' href='#keying'>Figure&nbsp;6<span> (</span><span class='info'>Keying Architecture</span><span>)</span></a> describes the participating entities and the protocols
                executed among them. It must be ensured that the derived session key between the
                DHCP client and the DHCP server is fresh and unique.
</p>
<p> The key transport mechanism, which is used to carry the session key between the NAS
                and DHCP server, must provide the following functionality: </p>
<ul class="text">
<li> Confidentiality protection 
</li>
<li> Replay protection
</li>
<li> Integrity protection 
</li>
</ul><p>
            
</p>
<p>Furthermore, it is necessary that the two parties (DHCP server and the NAS) authorize
                the establishment of the DHCP security association. 
</p>
<p>Below we provide a list of security properties of the suggested mechanism: </p>
<blockquote class="text"><dl>
<dt>Algorithm independence:</dt>
<dd>
                        <br />
 This proposal bootstraps a DHCP security
                        association for RFC 3118 where only a single integrity algorithm (namely
                        HMAC-MD5) is proposed which is mandatory to implement.
</dd>
<dt>Establish strong, fresh session keys (maintain algorithm independence):</dt>
<dd>
                        <br />
This scheme relies on EAP methods to provide strong
                        and fresh session keys for each initial authentication and key exchange
                        protocol run. Furthermore the key derivation function provided in <a class='info' href='#computing'>Section&nbsp;4.4<span> (</span><span class='info'>Computing DHCP SA</span><span>)</span></a> contains random numbers provided by the client and the
                        NAS which additionally add randomness to the generated key.
</dd>
<dt>Replay protection:</dt>
<dd>
                        <br />
Replay protection is provided at different places.
                        The EAP method executed between the EAP peer and the EAP server MUST provide
                        a replay protection mechanism. Additionally random numbers and the secret ID
                        are included in the key derivation procedure which aim to provide a fresh
                        and unique session key between the DHCP client and the DHCP server.
                        Furthermore, the key transport mechanism between the NAS and the DHCP server
                        must also provide replay protection (in addition to confidentiality
                        protection). Finally, the security mechanisms provided in RFC 3118, for
                        which this draft bootstraps the security association, also provides replay
                        protection. 
</dd>
<dt>Authenticate all parties:</dt>
<dd>
                        <br />
Authentication between the EAP peer and the EAP
                        server is based on the used EAP method. After a successful authentication
                        and protocol run, the host and the NAS in the network provide MSK
                        confirmation either based on the 4-way handshake in IEEE 802.11i or based on
                        the protected PANA exchange. DHCP key confirmation between the DHCP client
                        and server is provided with the first protected DHCP message exchange. 
</dd>
<dt>Perform authorization:</dt>
<dd>
                        <br />
Authorization for network access is provided during
                        the EAP exchange. The authorization procedure for DHCP bootstrapping is
                        executed by the NAS before this service is offered to the client. The NAS
                        might choose not to include DHCP-AVP or DHCP SA Configuration Option during
                        network access authorization based on the authorization policies. 
</dd>
<dt>Maintain confidentiality of session keys:</dt>
<dd>
                        <br />
The DHCP session keys are only known to the intended
                        parties (i.e., to the DHCP client, relay, and server). The EAP protocol
                        itself does not transport keys. The exchanged random numbers which are
                        incorporated into the key derivation function do not need to be kept
                        confidential. DHCP relay agent information MUST be protected using <a class='info' href='#RFC4014'>[RFC4014]<span> (</span><span class='info'>Droms, R. and J. Schnizlein, &ldquo;Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option,&rdquo; February&nbsp;2005.</span><span>)</span></a> with non-null IPsec encryption. 
</dd>
<dt>Confirm selection of 'best' cipher-suite:</dt>
<dd>
                        <br />
This proposal does not provide confidentiality
                        protection of DHCP signaling messages. Only a single algorithm is offered
                        for integrity protection. Hence no algorithm negotiation and therefore no
                        confirmation of the selection occur. 
</dd>
<dt>Uniquely name session keys:</dt>
<dd>
                        <br />
The DHCP SA is uniquely identified using a Secret ID
                        (described in <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Droms, R. and W. Arbaugh, &ldquo;Authentication for DHCP Messages,&rdquo; June&nbsp;2001.</span><span>)</span></a> and reused in this document). 
</dd>
<dt>Compromised NAS and DHCP server:</dt>
<dd>
                        <br />
A compromised NAS may leak the DHCP session key and
                        the EAP derived session key (e.g., MSK). It will furthermore allow
                        corruption of the DHCP protocol executed between the hosts and the DHCP
                        server since NAS either acts as a DHCP relay or a DHCP server. A compromised
                        NAS may also allow creation of further DHCP SAs or other known attacks on
                        the DHCP protocol (e.g., address depletion). A compromised NAS will not be
                        able to modify, replay, inject DHCP messages which use security associations
                        established without the EAP-based bootstrapping mechanism (e.g., manually
                        configured DHCP SAs). On the other hand, a compromised DHCP server may only
                        leak the DHCP key information. MSK will not be compromised in this case. 
</dd>
<dt>Bind key to appropriate context:</dt>
<dd>
                        <br />
The key derivation function described in Section 4.4
                        includes parameters (such as the secret ID and a constant) which prevents
                        reuse of the established session key for other purposes. 
</dd>
</dl></blockquote><p>
            
</p>
<a name="iana-considerations"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>[Editor's Note: A future version of this draft will provide IANA considerations.]
</p>
<a name="open"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Open Issues</h3>

<p>This document describes a bootstrapping procedure for DHCPv4. The same procedure
                could be applied for DHCPv6 but is not described in this document.
</p>
<a name="acks"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledegments</h3>

<p> We would like to thank Yoshihiro Ohba and Mohan Parthasarathy for their feedback to
                this document. Additionally, we would to thank Ralph Droms, Allison Mankin and Barr
                Hibbs for their support to continue this work.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1661">[RFC1661]</a></td>
<td class="author-text"><a href="mailto:Bill.Simpson@um.cc.umich.edu">Simpson, W.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1661">The Point-to-Point Protocol (PPP)</a>,&rdquo; STD&nbsp;51, RFC&nbsp;1661, July&nbsp;1994 (<a href="http://www.rfc-editor.org/rfc/rfc1661.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2131">[RFC2131]</a></td>
<td class="author-text"><a href="mailto:droms@bucknell.edu">Droms, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2131">Dynamic Host Configuration Protocol</a>,&rdquo; RFC&nbsp;2131, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2131.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2131.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2131.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3118">[RFC3118]</a></td>
<td class="author-text">Droms, R. and W. Arbaugh, &ldquo;<a href="http://tools.ietf.org/html/rfc3118">Authentication for DHCP Messages</a>,&rdquo; RFC&nbsp;3118, June&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc3118.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3748">[RFC3748]</a></td>
<td class="author-text">Aboba, B., Blunk, L., Vollbrecht, J., Carlson, J., and H. Levkowetz, &ldquo;<a href="http://tools.ietf.org/html/rfc3748">Extensible Authentication Protocol (EAP)</a>,&rdquo; RFC&nbsp;3748, June&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3748.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4014">[RFC4014]</a></td>
<td class="author-text">Droms, R. and J. Schnizlein, &ldquo;<a href="http://tools.ietf.org/html/rfc4014">Remote Authentication Dial-In User Service (RADIUS) Attributes Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Information Option</a>,&rdquo; RFC&nbsp;4014, February&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4014.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dhc-relay-agent-ipsec">[I-D.ietf-dhc-relay-agent-ipsec]</a></td>
<td class="author-text">Droms, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dhc-relay-agent-ipsec-02.txt">Authentication of DHCP Relay Agent Options Using IPsec</a>,&rdquo; draft-ietf-dhc-relay-agent-ipsec-02 (work in progress), May&nbsp;2005 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dhc-relay-agent-ipsec-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-dhc-v4-threat-analysis">[I-D.ietf-dhc-v4-threat-analysis]</a></td>
<td class="author-text">Hibbs, R., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-dhc-v4-threat-analysis-03.txt">Dynamic Host Configuration Protocol for IPv4 (DHCPv4) Threat Analysis</a>,&rdquo; draft-ietf-dhc-v4-threat-analysis-03 (work in progress), June&nbsp;2006 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-dhc-v4-threat-analysis-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-eap-keying">[I-D.ietf-eap-keying]</a></td>
<td class="author-text">Aboba, B., Simon, D., and P. Eronen, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-eap-keying-22.txt">Extensible Authentication Protocol (EAP) Key Management Framework</a>,&rdquo; draft-ietf-eap-keying-22 (work in progress), November&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-eap-keying-22.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2409">[RFC2409]</a></td>
<td class="author-text"><a href="mailto:dharkins@cisco.com">Harkins, D.</a> and <a href="mailto:carrel@ipsec.org">D. Carrel</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2409">The Internet Key Exchange (IKE)</a>,&rdquo; RFC&nbsp;2409, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2409.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2409.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2409.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5191">[RFC5191]</a></td>
<td class="author-text">Forsberg, D., Ohba, Y., Patil, B., Tschofenig, H., and A. Yegin, &ldquo;<a href="http://tools.ietf.org/html/rfc5191">Protocol for Carrying Authentication for Network Access (PANA)</a>,&rdquo; RFC&nbsp;5191, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5191.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Hannes Tschofenig</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Siemens Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Linnoitustie 6</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Espoo  02600</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 (50) 4871445</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:Hannes.Tschofenig@gmx.net">Hannes.Tschofenig@gmx.net</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www.tschofenig.priv.at">http://www.tschofenig.priv.at</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alper E. Yegin</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Samsung</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Istanbul,   </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Turkey</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:a.yegin@partner.samsung.com">a.yegin@partner.samsung.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dan Forsberg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nokia Research Center</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P.O. Box 407</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">FIN-00045</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Finland</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+358 50 4839470</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dan.forsberg@nokia.com">dan.forsberg@nokia.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
