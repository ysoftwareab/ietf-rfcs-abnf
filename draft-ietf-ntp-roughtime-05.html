<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Roughtime</title>
<meta content="Aanchal Malhotra" name="author">
<meta content="Adam Langley" name="author">
<meta content="Watson Ladd" name="author">
<meta content="Marcus Dansarie" name="author">
<meta content="
       
        This document specifies Roughtime - a protocol that aims to achieve
        rough time synchronization while detecting servers that provide
        inaccurate time and providing cryptographic proof of their malfeasance.
       
    " name="description">
<meta content="xml2rfc 3.8.0" name="generator">
<meta content="roughtime" name="keyword">
<meta content="time synchronization" name="keyword">
<meta content="draft-ietf-ntp-roughtime-05" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.8.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.4.1
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.25.1
    setuptools 56.2.0
    six 1.16.0
-->
<link href="/tmp/draft-ietf-ntp-roughtime-v3-ly_9msa8.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Roughtime</td>
<td class="right">May 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Malhotra, et al.</td>
<td class="center">Expires 21 November 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Internet Engineering Task Force</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-ntp-roughtime-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-05-20" class="published">20 May 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-11-21">21 November 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">A. Malhotra</div>
<div class="org">Boston University</div>
</div>
<div class="author">
      <div class="author-name">A. Langley</div>
<div class="org">Google</div>
</div>
<div class="author">
      <div class="author-name">W. Ladd</div>
<div class="org">Cloudflare</div>
</div>
<div class="author">
      <div class="author-name">M. Dansarie</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Roughtime</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
        This document specifies Roughtime - a protocol that aims to achieve
        rough time synchronization while detecting servers that provide
        inaccurate time and providing cryptographic proof of their malfeasance.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 21 November 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-protocol-overview" class="xref">Protocol Overview</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-the-guarantee" class="xref">The Guarantee</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-message-format" class="xref">Message Format</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-data-types" class="xref">Data Types</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1.2.1">
                    <p id="section-toc.1-1.5.2.1.2.1.1"><a href="#section-5.1.1" class="xref">5.1.1</a>.  <a href="#name-int32" class="xref">int32</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1.2.2">
                    <p id="section-toc.1-1.5.2.1.2.2.1"><a href="#section-5.1.2" class="xref">5.1.2</a>.  <a href="#name-uint32" class="xref">uint32</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1.2.3">
                    <p id="section-toc.1-1.5.2.1.2.3.1"><a href="#section-5.1.3" class="xref">5.1.3</a>.  <a href="#name-uint64" class="xref">uint64</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1.2.4">
                    <p id="section-toc.1-1.5.2.1.2.4.1"><a href="#section-5.1.4" class="xref">5.1.4</a>.  <a href="#name-tag" class="xref">Tag</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.1.2.5">
                    <p id="section-toc.1-1.5.2.1.2.5.1"><a href="#section-5.1.5" class="xref">5.1.5</a>.  <a href="#name-timestamp" class="xref">Timestamp</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-header" class="xref">Header</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-protocol-details" class="xref">Protocol Details</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-requests" class="xref">Requests</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1.2.1">
                    <p id="section-toc.1-1.6.2.1.2.1.1"><a href="#section-6.1.1" class="xref">6.1.1</a>.  <a href="#name-ver" class="xref">VER</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.1.2.2">
                    <p id="section-toc.1-1.6.2.1.2.2.1"><a href="#section-6.1.2" class="xref">6.1.2</a>.  <a href="#name-nonc" class="xref">NONC</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-responses" class="xref">Responses</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2.2.1">
                    <p id="section-toc.1-1.6.2.2.2.1.1"><a href="#section-6.2.1" class="xref">6.2.1</a>.  <a href="#name-sig" class="xref">SIG</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2.2.2">
                    <p id="section-toc.1-1.6.2.2.2.2.1"><a href="#section-6.2.2" class="xref">6.2.2</a>.  <a href="#name-ver-2" class="xref">VER</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2.2.3">
                    <p id="section-toc.1-1.6.2.2.2.3.1"><a href="#section-6.2.3" class="xref">6.2.3</a>.  <a href="#name-nonc-2" class="xref">NONC</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2.2.4">
                    <p id="section-toc.1-1.6.2.2.2.4.1"><a href="#section-6.2.4" class="xref">6.2.4</a>.  <a href="#name-path" class="xref">PATH</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2.2.5">
                    <p id="section-toc.1-1.6.2.2.2.5.1"><a href="#section-6.2.5" class="xref">6.2.5</a>.  <a href="#name-srep" class="xref">SREP</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2.2.6">
                    <p id="section-toc.1-1.6.2.2.2.6.1"><a href="#section-6.2.6" class="xref">6.2.6</a>.  <a href="#name-cert" class="xref">CERT</a></p>
</li>
                  <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.2.2.7">
                    <p id="section-toc.1-1.6.2.2.2.7.1"><a href="#section-6.2.7" class="xref">6.2.7</a>.  <a href="#name-indx" class="xref">INDX</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-the-merkle-tree" class="xref">The Merkle Tree</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.6.2.3.2.1">
                    <p id="section-toc.1-1.6.2.3.2.1.1"><a href="#section-6.3.1" class="xref">6.3.1</a>.  <a href="#name-root-value-validity-check-a" class="xref">Root Value Validity Check Algorithm</a></p>
</li>
                </ul>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-validity-of-response" class="xref">Validity of Response</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-integration-into-ntp" class="xref">Integration Into NTP</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-grease" class="xref">Grease</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-roughtime-servers" class="xref">Roughtime Servers</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.11.2.1">
                <p id="section-toc.1-1.11.2.1.1"><a href="#section-11.1" class="xref">11.1</a>.  <a href="#name-service-name-and-transport-" class="xref">Service Name and Transport Protocol Port Number Registry</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.11.2.2">
                <p id="section-toc.1-1.11.2.2.1"><a href="#section-11.2" class="xref">11.2</a>.  <a href="#name-roughtime-version-registry" class="xref">Roughtime Version Registry</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.11.2.3">
                <p id="section-toc.1-1.11.2.3.1"><a href="#section-11.3" class="xref">11.3</a>.  <a href="#name-roughtime-tag-registry" class="xref">Roughtime Tag Registry</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#section-12" class="xref">12</a>. <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.13">
            <p id="section-toc.1-1.13.1"><a href="#section-13" class="xref">13</a>. <a href="#name-privacy-considerations" class="xref">Privacy Considerations</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.14">
            <p id="section-toc.1-1.14.1"><a href="#section-14" class="xref">14</a>. <a href="#name-references" class="xref">References</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.14.2.1">
                <p id="section-toc.1-1.14.2.1.1"><a href="#section-14.1" class="xref">14.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.14.2.2">
                <p id="section-toc.1-1.14.2.2.1"><a href="#section-14.2" class="xref">14.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.15">
            <p id="section-toc.1-1.15.1"><a href="#section-appendix.a" class="xref">Appendix A</a>.  <a href="#name-terms-and-abbreviations" class="xref">Terms and Abbreviations</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.16">
            <p id="section-toc.1-1.16.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
        Time synchronization is essential to Internet security as many security
        protocols and other applications require synchronization
        <span>[<a href="#RFC7384" class="xref">RFC7384</a>]</span> <span>[<a href="#MCBG" class="xref">MCBG</a>]</span>. Unfortunately widely
        deployed protocols such as the Network Time Protocol (NTP)
        <span>[<a href="#RFC5905" class="xref">RFC5905</a>]</span> lack essential security features, and even
        newer protocols like Network Time Security (NTS)
        <span>[<a href="#RFC8915" class="xref">RFC8915</a>]</span> lack mechanisms to ensure that the servers
        behave correctly. Authenticating time servers prevents network
        adversaries from modifying time packets, but an authenticated time
        server still has full control over the contents of the time packet and
        may transmit incorrect time. The Roughtime protocol provides
        cryptographic proof of malfeasance, enabling clients to detect and prove
        to a third party a server's attempts to influence the time a client
        computes.<a href="#section-1-1" class="pilcrow">¶</a></p>
<span id="name-security-properties-of-curr"></span><div id="existing_approaches">
<table class="center" id="table-1">
        <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-security-properties-of-curr" class="selfRef">Security Properties of current protocols.</a>
        </caption>
<tbody>
          <tr>
            <th class="text-left" rowspan="1" colspan="1">Protocol</th>
            <th class="text-left" rowspan="1" colspan="1">Authenticated Server</th>
            <th class="text-left" rowspan="1" colspan="1">Server Malfeasance Evidence</th>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NTP, Chronos</td>
            <td class="text-left" rowspan="1" colspan="1">N</td>
            <td class="text-left" rowspan="1" colspan="1">N</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NTP-MAC</td>
            <td class="text-left" rowspan="1" colspan="1">Y*</td>
            <td class="text-left" rowspan="1" colspan="1">N</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NTP-Autokey</td>
            <td class="text-left" rowspan="1" colspan="1">Y**</td>
            <td class="text-left" rowspan="1" colspan="1">N</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">NTS</td>
            <td class="text-left" rowspan="1" colspan="1">Y</td>
            <td class="text-left" rowspan="1" colspan="1">N</td>
          </tr>
          <tr>
            <td class="text-left" rowspan="1" colspan="1">Roughtime</td>
            <td class="text-left" rowspan="1" colspan="1">Y</td>
            <td class="text-left" rowspan="1" colspan="1">Y</td>
          </tr>
        </tbody>
      </table>
</div>
<p id="section-1-3">
        Y* For security issues with symmetric-key based NTP-MAC authentication,
        please refer to <span><a href="#RFC8573" class="xref">RFC 8573</a> [<a href="#RFC8573" class="xref">RFC8573</a>]</span>.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
        Y** For security issues with Autokey Public Key Authentication, refer to
        <span>[<a href="#Autokey" class="xref">Autokey</a>]</span>.<a href="#section-1-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-1-5.1">
            If a server's timestamps do not fit into the time context
            of other servers' responses, then a Roughtime client can
            cryptographically prove this misbehavior to third
            parties. This helps detect dishonest or malfunctioning
            servers.<a href="#section-1-5.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.2">
            A Roughtime client can roughly detect (with no absolute
            guarantee) a delay attack <span>[<a href="#DelayAttacks" class="xref">DelayAttacks</a>]</span>
            but can not cryptographically prove this to a third
            party. However such attacks expand the round trip time
            between request and response.<a href="#section-1-5.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.3">
            Note that delay attacks cannot be detected/stopped by any protocol.
            Delay attacks can not, however, undermine the security guarantees
            provided by Roughtime.<a href="#section-1-5.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-1-5.4">
            Although delay attacks cannot be prevented, they can be
            limited to a predetermined upper bound. This can be done
            by defining a maximal tolerable Round Trip Time (RTT)
            value, MAX-RTT, that a Roughtime client is willing to
            accept. A Roughtime client can measure the RTT of every
            request-response handshake and compare it to MAX-RTT. If
            the RTT exceeds MAX-RTT, the corresponding measurement is
            discarded.  When this approach is used, the maximal time
            error that can be caused by a delay attack is
            MAX-RTT/2. It should be noted that this approach assumes
            that the nature of the system is known to the client,
            including reasonable upper bounds on the RTT value.<a href="#section-1-5.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
<section id="section-2">
      <h2 id="name-requirements-language">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
      </h2>
<p id="section-2-1">
        The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
        "OPTIONAL" in this document are to be interpreted as described in
        BCP 14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>
        <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when, they appear in all
        capitals, as shown here.<a href="#section-2-1" class="pilcrow">¶</a></p>
</section>
<div id="protocol-overview">
<section id="section-3">
      <h2 id="name-protocol-overview">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-protocol-overview" class="section-name selfRef">Protocol Overview</a>
      </h2>
<p id="section-3-1">
        Roughtime is a protocol for rough time synchronization that
        enables clients to provide cryptographic proof of server
        malfeasance. It does so by having responses from servers
        include a signature over a value derived from a nonce in the
        client request. This provides cryptographic proof that the
        timestamp was issued after the server received the client's
        request. The derived value included in the server's response
        is the root of a Merkle tree which includes the hash of the
        client's nonce as the value of one of its leaf nodes. This
        enables the server to amortize the relatively costly signing
        operation over a number of client requests.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
        Single server mode: At its most basic level, Roughtime is a one round
        protocol in which a completely fresh client requests the current time
        and the server sends a signed response. The response includes a
        timestamp and a radius used to indicate the server's certainty about the
        reported time. For example, a radius of 1,000,000 microseconds means the
        server is absolutely confident that the true time is within one second
        of the reported time.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
        The server proves freshness of its response as follows. The client's
        request contains a nonce which the server incorporates into its signed
        response. The client can verify the server's signatures and - provided
        that the nonce has sufficient entropy - this proves that the signed
        response could only have been generated after the nonce.<a href="#section-3-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-4">
      <h2 id="name-the-guarantee">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-the-guarantee" class="section-name selfRef">The Guarantee</a>
      </h2>
<p id="section-4-1">
        A Roughtime server guarantees that a response to a query sent
        at t<sub>1</sub>, received at t<sub>2</sub>, and with timestamp
        t<sub>3</sub> has been created between the transmission of the query and
        its reception. If t<sub>3</sub> is not within that interval, a server
        inconsistency may be detected and used to impeach the server. The
        propagation of such a guarantee and its use of type synchronization is
        discussed in <a href="#ntp-integration" class="xref">Section 7</a>. No delay attacker may
        affect this: they may only expand the interval between t<sub>1</sub> and
        t<sub>2</sub>, or of course stop the measurement in the first place.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5">
      <h2 id="name-message-format">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-message-format" class="section-name selfRef">Message Format</a>
      </h2>
<p id="section-5-1">
        Roughtime messages are maps consisting of one or more (tag, value)
        pairs. They start with a header, which contains the number of pairs, the
        tags, and value offsets. The header is followed by a message values
        section which contains the values associated with the tags in the
        header. Messages MUST be formatted according to
        <a href="#fig-roughtime-message" class="xref">Figure 1</a> as described in the following
        sections.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
        Messages MAY be recursive, i.e. the value of a tag can itself be a
        Roughtime message.<a href="#section-5-2" class="pilcrow">¶</a></p>
<span id="name-roughtime-message-format"></span><div id="fig-roughtime-message">
<figure id="figure-1">
        <div class="artwork art-text alignLeft" id="section-5-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Number of pairs (uint32)                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                     N-1 offsets (uint32)                      .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                        N tags (uint32)                        .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                            Values                             .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-roughtime-message-format" class="selfRef">Roughtime Message Format</a>
        </figcaption></figure>
</div>
<div id="format">
<section id="section-5.1">
        <h3 id="name-data-types">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-data-types" class="section-name selfRef">Data Types</a>
        </h3>
<section id="section-5.1.1">
          <h4 id="name-int32">
<a href="#section-5.1.1" class="section-number selfRef">5.1.1. </a><a href="#name-int32" class="section-name selfRef">int32</a>
          </h4>
<p id="section-5.1.1-1">
            An int32 is a 32 bit signed integer. It is serialized least
            significant byte first in sign-magnitude representation with the
            sign bit in the most significant bit. The negative zero value
            (0x80000000) MUST NOT be used and any message with it is
            syntactically invalid and MUST be ignored.<a href="#section-5.1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.2">
          <h4 id="name-uint32">
<a href="#section-5.1.2" class="section-number selfRef">5.1.2. </a><a href="#name-uint32" class="section-name selfRef">uint32</a>
          </h4>
<p id="section-5.1.2-1">
            A uint32 is a 32 bit unsigned integer. It is serialized with the
            least significant byte first.<a href="#section-5.1.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-5.1.3">
          <h4 id="name-uint64">
<a href="#section-5.1.3" class="section-number selfRef">5.1.3. </a><a href="#name-uint64" class="section-name selfRef">uint64</a>
          </h4>
<p id="section-5.1.3-1">
            A uint64 is a 64 bit unsigned integer. It is serialized with the
            least significant byte first.<a href="#section-5.1.3-1" class="pilcrow">¶</a></p>
</section>
<div id="tag">
<section id="section-5.1.4">
          <h4 id="name-tag">
<a href="#section-5.1.4" class="section-number selfRef">5.1.4. </a><a href="#name-tag" class="section-name selfRef">Tag</a>
          </h4>
<p id="section-5.1.4-1">
            Tags are used to identify values in Roughtime messages. A tag is a
            uint32 but may also be listed in this document as a sequence of up
            to four ASCII characters <span>[<a href="#RFC0020" class="xref">RFC0020</a>]</span>. ASCII strings
            shorter than four characters can be unambiguously converted to tags
            by padding them with zero bytes. For example, the ASCII string
            "NONC" would correspond to the tag 0x434e4f4e and "PAD" would
            correspond to 0x00444150. Note that when encoded into a message the
            ASCII values will be in the corresponding order.<a href="#section-5.1.4-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-5.1.5">
          <h4 id="name-timestamp">
<a href="#section-5.1.5" class="section-number selfRef">5.1.5. </a><a href="#name-timestamp" class="section-name selfRef">Timestamp</a>
          </h4>
<p id="section-5.1.5-1">
            A timestamp is a uint64 interpreted in the following way. The most
            significant 3 bytes contain the integer part of a Modified Julian
            Date (MJD). The least significant 5 bytes is a count of the number
            of microseconds since midnight on that day.<a href="#section-5.1.5-1" class="pilcrow">¶</a></p>
<p id="section-5.1.5-2">
            The MJD is the number of UTC days since 17 November 1858
            <span>[<a href="#ITU-R_TF.457-2" class="xref">ITU-R_TF.457-2</a>]</span>. It is useful to note that 1 January
            1970 is 40,587 days after 17 November 1858.<a href="#section-5.1.5-2" class="pilcrow">¶</a></p>
<p id="section-5.1.5-3">
            Note that, unlike NTP, this representation does not use the full
            number of bits in the fractional part and that days with leap
            seconds will have more or fewer than the nominal 86,400,000,000
            microseconds.<a href="#section-5.1.5-3" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<section id="section-5.2">
        <h3 id="name-header">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-header" class="section-name selfRef">Header</a>
        </h3>
<p id="section-5.2-1">
          All Roughtime messages start with a header. The first four bytes of
          the header is the uint32 number of tags N, and hence of (tag, value)
          pairs. The following 4*(N-1) bytes are offsets, each a uint32. The
          last 4*N bytes in the header are tags.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<p id="section-5.2-2">
          Offsets refer to the positions of the values in the message values
          section. All offsets MUST be multiples of four and placed in
          increasing order. The first post-header byte is at offset 0. The
          offset array is considered to have a not explicitly encoded value of 0
          as its zeroth entry. The value associated with the ith tag begins at
          offset[i] and ends at offset[i+1]-1, with the exception of the last
          value which ends at the end of the message. Values may have zero
          length.<a href="#section-5.2-2" class="pilcrow">¶</a></p>
<p id="section-5.2-3">
          Tags MUST be listed in the same order as the offsets of their values
          and MUST also be sorted in ascending order by numeric value. A tag
          MUST NOT appear more than once in a header.<a href="#section-5.2-3" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-6">
      <h2 id="name-protocol-details">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-protocol-details" class="section-name selfRef">Protocol Details</a>
      </h2>
<p id="section-6-1">
        As described in <a href="#protocol-overview" class="xref">Section 3</a>, clients
        initiate time synchronization by sending requests containing
        a nonce to servers who send signed time responses in
        return. Roughtime packets can be sent between clients and
        servers either as UDP datagrams or via TCP streams. Servers
        SHOULD support the UDP transport mode, while TCP transport is
        OPTIONAL.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
        A Roughtime packet MUST be formatted according to
        <a href="#fig-roughtime-packet-format" class="xref">Figure 2</a> and as described here.
        The first field is a uint64 with the value 0x4d49544847554f52
        ("ROUGHTIM" in ASCII). The second field is a uint32 and contains the
        length of the third field. The third and last field contains a
        Roughtime message as specified in <a href="#format" class="xref">Section 5.1</a>.<a href="#section-6-2" class="pilcrow">¶</a></p>
<span id="name-roughtime-packet-format"></span><div id="fig-roughtime-packet-format">
<figure id="figure-2">
        <div class="artwork art-text alignLeft" id="section-6-3.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                  0x4d49544847554f52 (uint64)                  |
|                        ("ROUGHTIM")                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    Message length (uint32)                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
.                                                               .
.                      Roughtime message                        .
.                                                               .
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-roughtime-packet-format" class="selfRef">Roughtime Packet Format</a>
        </figcaption></figure>
</div>
<p id="section-6-4">
        Roughtime request and response packets MUST be transmitted in a single
        datagram when the UDP transport mode is used. Setting the packet's don't
        fragment bit <span>[<a href="#RFC0791" class="xref">RFC0791</a>]</span> is OPTIONAL in IPv4 networks.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">
        Multiple requests and responses can be exchanged over an established TCP
        connection. Clients MAY send multiple requests at once and servers MAY
        send responses out of order. The connection SHOULD be closed by the
        client when it has no more requests to send and has received all
        expected responses. Either side SHOULD close the connection in response
        to synchronization, format, implementation-defined timeouts, or other
        errors.<a href="#section-6-5" class="pilcrow">¶</a></p>
<p id="section-6-6">
        All requests and responses MUST contain the VER tag. It contains a list
        of one or more uint32 version numbers. The version of Roughtime
        specified by this memo has version number 1.<a href="#section-6-6" class="pilcrow">¶</a></p>
<p id="section-6-7">
        NOTE TO RFC EDITOR: remove this paragraph before publication. For
        testing drafts of this memo, a version number of 0x80000000 plus the
        draft number is used.<a href="#section-6-7" class="pilcrow">¶</a></p>
<section id="section-6.1">
        <h3 id="name-requests">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-requests" class="section-name selfRef">Requests</a>
        </h3>
<p id="section-6.1-1">
          A request MUST contain the tags VER and NONC. Tags other than NONC and
          VER SHOULD be ignored by the server. A future version of this protocol
          may mandate additional tags in the message and asign them semantic
          meaning.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
          The size of the request message SHOULD be at least 1024 bytes when
          the UDP transport mode is used. To attain this size the PAD tag
          SHOULD be added to the message. Its value SHOULD be all zeros.
          Responding to requests shorter than 1024 bytes is OPTIONAL and
          servers MUST NOT send responses larger than the requests they are
          replying to.<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<section id="section-6.1.1">
          <h4 id="name-ver">
<a href="#section-6.1.1" class="section-number selfRef">6.1.1. </a><a href="#name-ver" class="section-name selfRef">VER</a>
          </h4>
<p id="section-6.1.1-1">
            In a request, the VER tag contains a list of versions. The VER tag
            MUST include at least one Roughtime version supported by the client.
            The client MUST ensure that the version numbers and tags included in
            the request are not incompatible with each other or the packet
            contents.<a href="#section-6.1.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.1.2">
          <h4 id="name-nonc">
<a href="#section-6.1.2" class="section-number selfRef">6.1.2. </a><a href="#name-nonc" class="section-name selfRef">NONC</a>
          </h4>
<p id="section-6.1.2-1">
            The value of the NONC tag is a 32 byte nonce. It SHOULD be generated
            in a manner indistinguishable from random. BCP 106 contains
            specific guidelines regarding this <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span>.<a href="#section-6.1.2-1" class="pilcrow">¶</a></p>
</section>
</section>
<section id="section-6.2">
        <h3 id="name-responses">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-responses" class="section-name selfRef">Responses</a>
        </h3>
<p id="section-6.2-1">
          A response MUST contain the tags SIG, VER, NONC, PATH, SREP, CERT, and
          INDX.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<section id="section-6.2.1">
          <h4 id="name-sig">
<a href="#section-6.2.1" class="section-number selfRef">6.2.1. </a><a href="#name-sig" class="section-name selfRef">SIG</a>
          </h4>
<p id="section-6.2.1-1">
            In general, a SIG tag value is a 64 byte Ed25519 signature
            <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> over a concatenation of a signature context
            ASCII string and the entire value of a tag. All context strings
            MUST include a terminating zero byte.<a href="#section-6.2.1-1" class="pilcrow">¶</a></p>
<p id="section-6.2.1-2">
            The SIG tag in the root of a response MUST be a signature over the
            SREP value using the public key contained in CERT. The context
            string MUST be "RoughTime v1 response signature".<a href="#section-6.2.1-2" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2.2">
          <h4 id="name-ver-2">
<a href="#section-6.2.2" class="section-number selfRef">6.2.2. </a><a href="#name-ver-2" class="section-name selfRef">VER</a>
          </h4>
<p id="section-6.2.2-1">
            In a response, the VER tag MUST contain a single version number. It
            SHOULD be one of the version numbers supplied by the client in its
            request. The server MUST ensure that the version number corresponds
            with the rest of the packet contents.<a href="#section-6.2.2-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2.3">
          <h4 id="name-nonc-2">
<a href="#section-6.2.3" class="section-number selfRef">6.2.3. </a><a href="#name-nonc-2" class="section-name selfRef">NONC</a>
          </h4>
<p id="section-6.2.3-1">
            The NONC tag MUST contain the nonce of the message being responded
            to.<a href="#section-6.2.3-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2.4">
          <h4 id="name-path">
<a href="#section-6.2.4" class="section-number selfRef">6.2.4. </a><a href="#name-path" class="section-name selfRef">PATH</a>
          </h4>
<p id="section-6.2.4-1">
            The PATH tag value MUST be a multiple of 32 bytes long and
            represent a path of 32 byte hash values in the Merkle tree used to
            generate the ROOT value as described in
            <a href="#merkle-tree" class="xref">Section 6.3</a>. In the case where a response is
            prepared for a single request and the Merkle tree contains only the
            root node, the size of PATH MUST be zero.<a href="#section-6.2.4-1" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2.5">
          <h4 id="name-srep">
<a href="#section-6.2.5" class="section-number selfRef">6.2.5. </a><a href="#name-srep" class="section-name selfRef">SREP</a>
          </h4>
<p id="section-6.2.5-1">
            The SREP tag contains a time response. Its value MUST be a
            Roughtime message with the tags ROOT, MIDP, and RADI. The server MAY
            include any of the tags DUT1, DTAI, and LEAP in the contents of the
            SREP tag.<a href="#section-6.2.5-1" class="pilcrow">¶</a></p>
<p id="section-6.2.5-2">
            The ROOT tag MUST contain a 32 byte value of a Merkle tree root as
            described in <a href="#merkle-tree" class="xref">Section 6.3</a>.<a href="#section-6.2.5-2" class="pilcrow">¶</a></p>
<p id="section-6.2.5-3">
            The MIDP tag value MUST be timestamp of the moment of processing.<a href="#section-6.2.5-3" class="pilcrow">¶</a></p>
<p id="section-6.2.5-4">
            The RADI tag value MUST be a uint32 representing the server's
            estimate of the accuracy of MIDP in microseconds. Servers MUST
            ensure that the true time is within (MIDP-RADI, MIDP+RADI) at the
            time they transmit the response message.<a href="#section-6.2.5-4" class="pilcrow">¶</a></p>
<p id="section-6.2.5-5">
            The DUT1 tag value MUST be an int32 indicating the predicted
            difference between UT1 and UTC (UT1 - UTC) in milliseconds as given
            by the International Earth Rotation and Reference Systems Service
            (IERS).<a href="#section-6.2.5-5" class="pilcrow">¶</a></p>
<p id="section-6.2.5-6">
            The DTAI tag value MUST be an int32 indicating the current
            difference between International Atomic Time (TAI) and UTC
            (TAI - UTC) in milliseconds as published in the International Bureau
            of Weights and Measures' (BIPM) Circular T.<a href="#section-6.2.5-6" class="pilcrow">¶</a></p>
<p id="section-6.2.5-7">
            The LEAP tag MUST contain zero or more int32 values, each
            representing a past or future leap second event. Positive values
            represent the addition of a second and negative values represent the
            removal of a second. The absolute value represents the MJD of the
            day that begins immediately after the leap second event.<a href="#section-6.2.5-7" class="pilcrow">¶</a></p>
<p id="section-6.2.5-8">
           By way of illustration, there was a leap second 31 December 2016
           23:59:60. This event would be represented by the tag with numeric
           value 57754. The positive sign represents that there was an
           additional second inserted, the numeric value indicates 1 January
           2017, the following day that began at midnight after the addition.<a href="#section-6.2.5-8" class="pilcrow">¶</a></p>
<p id="section-6.2.5-9">
           The leap second events MUST be sorted in reverse chronological order
           and the first item MUST be the last (past or future) leap second
           event that the server knows about. A LEAP tag with zero int32 values
           indicates that the server does not hold any updated leap second
           information.<a href="#section-6.2.5-9" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2.6">
          <h4 id="name-cert">
<a href="#section-6.2.6" class="section-number selfRef">6.2.6. </a><a href="#name-cert" class="section-name selfRef">CERT</a>
          </h4>
<p id="section-6.2.6-1">
            The CERT tag contains a public-key certificate signed with the
            server's long-term key. Its value is a Roughtime message with the
            tags DELE and SIG, where SIG is a signature over the DELE value. The
            context string used to generate SIG MUST be "RoughTime v1 delegation
            signature--".<a href="#section-6.2.6-1" class="pilcrow">¶</a></p>
<p id="section-6.2.6-2">
            The DELE tag contains a delegated public-key certificate used by the
            server to sign the SREP tag. Its value is a Roughtime message with
            the tags MINT, MAXT, and PUBK. The purpose of the DELE tag is to
            enable separation of a long-term public key from keys on devices
            exposed to the public Internet.<a href="#section-6.2.6-2" class="pilcrow">¶</a></p>
<p id="section-6.2.6-3">
            The MINT tag is the minimum timestamp for which the key in PUBK is
            trusted to sign responses. MIDP MUST be more than or equal to MINT for
            a response to be considered valid.<a href="#section-6.2.6-3" class="pilcrow">¶</a></p>
<p id="section-6.2.6-4">
            The MAXT tag is the maximum timestamp for which the key in PUBK is
            trusted to sign responses. MIDP MUST be less than or equal to MAXT for
            a response to be considered valid.<a href="#section-6.2.6-4" class="pilcrow">¶</a></p>
<p id="section-6.2.6-5">
            The PUBK tag contains a temporary 32 byte Ed25519 public key which is
            used to sign the SREP tag.<a href="#section-6.2.6-5" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2.7">
          <h4 id="name-indx">
<a href="#section-6.2.7" class="section-number selfRef">6.2.7. </a><a href="#name-indx" class="section-name selfRef">INDX</a>
          </h4>
<p id="section-6.2.7-1">
            The INDX tag value is a uint32 determining the position of NONC in the
            Merkle tree used to generate the ROOT value as described in
            <a href="#merkle-tree" class="xref">Section 6.3</a>.<a href="#section-6.2.7-1" class="pilcrow">¶</a></p>
</section>
</section>
<div id="merkle-tree">
<section id="section-6.3">
        <h3 id="name-the-merkle-tree">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-the-merkle-tree" class="section-name selfRef">The Merkle Tree</a>
        </h3>
<p id="section-6.3-1">
          A Merkle tree is a binary tree where the value of each non-leaf node
          is a hash value derived from its two children. The root of the tree is
          thus dependent on all leaf nodes.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">
          In Roughtime, each leaf node in the Merkle tree represents the nonce
          in one request. Leaf nodes are indexed left to right, beginning with
          zero.<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<p id="section-6.3-3">
          The values of all nodes are calculated from the leaf nodes and up
          towards the root node using the first 32 bytes of the output of the
          SHA-512 hash algorithm <span>[<a href="#SHS" class="xref">SHS</a>]</span>. For leaf nodes, the
          byte 0x00 is prepended to the nonce before applying the hash function.
          For all other nodes, the byte 0x01 is concatenated with first the left
          and then the right child node value before applying the hash function.<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<p id="section-6.3-4">
          The value of the Merkle tree's root node is included in the ROOT tag
          of the response.<a href="#section-6.3-4" class="pilcrow">¶</a></p>
<p id="section-6.3-5">
          The index of a request's nonce node is included in the INDX tag of the
          response.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<p id="section-6.3-6">
          The values of all sibling nodes in the path between a
          request's nonce node and the root node is stored in the PATH
          tag so that the client can reconstruct and validate the
          value in the ROOT tag using its nonce. These values are each
          32 bytes and are stored one after the other with no
          additional padding or structure.  The order in which they
          are stored is described in <a href="#root-check" class="xref">Section 6.3.1</a><a href="#section-6.3-6" class="pilcrow">¶</a></p>
<div id="root-check">
<section id="section-6.3.1">
          <h4 id="name-root-value-validity-check-a">
<a href="#section-6.3.1" class="section-number selfRef">6.3.1. </a><a href="#name-root-value-validity-check-a" class="section-name selfRef">Root Value Validity Check Algorithm</a>
          </h4>
<p id="section-6.3.1-1">
            We describe how to compute the hash of the Merkel tree from the
            values in the tags PATH, INDX, and NONC. Our algorithm maintains a
            current hash value.  The bits of INDX are ordered from least to most
            significant in this algorithm.<a href="#section-6.3.1-1" class="pilcrow">¶</a></p>
<p id="section-6.3.1-2"> At initialization hash is set to H(0x00 || nonce).<a href="#section-6.3.1-2" class="pilcrow">¶</a></p>
<p id="section-6.3.1-3"> If no more entries remain in PATH the current hash
             is the hash of the Merkel tree.
            All remaining bits of INDX must be zero.<a href="#section-6.3.1-3" class="pilcrow">¶</a></p>
<p id="section-6.3.1-4"> Otherwise let node be the next 32 bytes in PATH. If the
            current bit in INDX is 0 then hash = H(0x01 || node || hash),
          else hash = H(0x01 || hash || node).<a href="#section-6.3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<section id="section-6.4">
        <h3 id="name-validity-of-response">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-validity-of-response" class="section-name selfRef">Validity of Response</a>
        </h3>
<p id="section-6.4-1">
          A client MUST check the following properties when it receives a
          response. We assume the long-term server public key is known to the
          client through other means.<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.4-2.1">
              The signature in CERT was made with the long-term key of the
              server.<a href="#section-6.4-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-2.2">
              The DELE timestamps and the MIDP value are consistent.<a href="#section-6.4-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-2.3">
              The INDX and PATH values prove NONC was included in the Merkle
              tree with value ROOT using the algorithm in
              <a href="#root-check" class="xref">Section 6.3.1</a>.<a href="#section-6.4-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.4-2.4">
              The signature of SREP in SIG validates with the public key in
              DELE.<a href="#section-6.4-2.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.4-3">

          A response that passes these checks is said to be valid. Validity of a
          response does not prove the time is correct, but merely that the
          server signed it, and thus promises that it began to compute the
          signature at a time in the interval (MIDP-RADI, MIDP+RADI).<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
</section>
<div id="ntp-integration">
<section id="section-7">
      <h2 id="name-integration-into-ntp">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-integration-into-ntp" class="section-name selfRef">Integration Into NTP</a>
      </h2>
<p id="section-7-1">
        We assume that there is a bound PHI on the frequency error in the clock
        on the machine. Given a measurement taken at a local time t, we know the
        true time is in (t-delta-sigma, t-delta+sigma). After d seconds have
        elapsed we know the true time is within (t-delta-sigma-d*PHI,
        t-delta+sigma+d*PHI). A simple and effective way to mix with NTP or PTP
        discipline of the clock is to trim the observed intervals in NTP to fit
        entirely within this window or reject measurements that fall to far
        outside. This assumes time has not been stepped.  If the NTP process
        decides to step the time, it MUST use Roughtime to ensure the new
        truetime estimate that will be stepped to is consistent with the true
        time.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2">
        Should this window become too large, another Roughtime measurement is
        called for. The definition of "too large" is implementation defined.<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">
        Implementations MAY use other, more sophisticated means of adjusting the
        clock respecting Roughtime information. Other applications such as X.509
        verification may wish to<a href="#section-7-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-grease">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-grease" class="section-name selfRef">Grease</a>
      </h2>
<p id="section-8-1">
        Servers MAY send back a fraction of responses that are syntactically
        invalid or contain invalid signatures as well as incorrect times.
        Clients MUST properly reject such responses. Servers MUST NOT send back
        responses with incorrect times and valid signatures. Either signature
        MAY be invalid for this application.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
<section id="section-9">
      <h2 id="name-roughtime-servers">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-roughtime-servers" class="section-name selfRef">Roughtime Servers</a>
      </h2>
<p id="section-9-1">
        NOTE TO RFC EDITOR: remove this section before publication.<a href="#section-9-1" class="pilcrow">¶</a></p>
<p id="section-9-2">
        The below list contains a list of servers with their public keys in
        Base64 format. These servers may implement older versions of this
        specification.<a href="#section-9-2" class="pilcrow">¶</a></p>
<div class="artwork art-text alignLeft" id="section-9-3">
<pre>
address:       roughtime.cloudflare.com
port:          2002
long-term key: gD63hSj3ScS+wuOeGrubXlq35N1c5Lby/S+T7MNTjxo=

address:       roughtime.int08h.com
port:          2002
long-term key: AW5uAoTSTDfG5NfY1bTh08GUnOqlRb+HVhbJ3ODJvsE=

address:       roughtime.sandbox.google.com
port:          2002
long-term key: etPaaIxcBMY1oUeGpwvPMCJMwlRVNxv51KK/tktoJTQ=

address:       roughtime.se
port:          2002
long-term key: S3AzfZJ5CjSdkJ21ZJGbxqdYP/SoE8fXKY0+aicsehI=
</pre><a href="#section-9-3" class="pilcrow">¶</a>
</div>
</section>
<div id="Acknowledgements">
<section id="section-10">
      <h2 id="name-acknowledgements">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-10-1">
         Thomas Peterson corrected multiple nits. Peter Loethberg,
         Tal Mizrahi, Ragnar Sundblad, Kristof Teichel, and the other members of
         the NTP working group contributed comments and suggestions.<a href="#section-10-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-11">
      <h2 id="name-iana-considerations">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<section id="section-11.1">
        <h3 id="name-service-name-and-transport-">
<a href="#section-11.1" class="section-number selfRef">11.1. </a><a href="#name-service-name-and-transport-" class="section-name selfRef">Service Name and Transport Protocol Port Number Registry</a>
        </h3>
<p id="section-11.1-1">
          IANA is requested to allocate the following entry in the
          <span><a href="#RFC6335" class="xref">Service Name and Transport Protocol
          Port Number Registry</a> [<a href="#RFC6335" class="xref">RFC6335</a>]</span>:<a href="#section-11.1-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.1-2.1">Service Name: Roughtime<a href="#section-11.1-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.1-2.2">Transport Protocol: tcp,udp<a href="#section-11.1-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.1-2.3">Assignee: IESG &lt;iesg@ietf.org&gt;<a href="#section-11.1-2.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.1-2.4">Contact: IETF Chair &lt;chair@ietf.org&gt;<a href="#section-11.1-2.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.1-2.5">Description: Roughtime time synchronization<a href="#section-11.1-2.5" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.1-2.6">Reference: [[this memo]]<a href="#section-11.1-2.6" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.1-2.7">Port Number: [[TBD1]], selected by IANA from the User Port
              range<a href="#section-11.1-2.7" class="pilcrow">¶</a>
</li>
        </ul>
</section>
<section id="section-11.2">
        <h3 id="name-roughtime-version-registry">
<a href="#section-11.2" class="section-number selfRef">11.2. </a><a href="#name-roughtime-version-registry" class="section-name selfRef">Roughtime Version Registry</a>
        </h3>
<p id="section-11.2-1">
          IANA is requested to create a new registry entitled "Roughtime
          Version Registry". Entries shall have the following fields:<a href="#section-11.2-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.2-2.1">Version ID (REQUIRED): a 32-bit unsigned integer<a href="#section-11.2-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.2-2.2">Version name (REQUIRED): A short text string naming the version
              being identified.<a href="#section-11.2-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.2-2.3">Reference (REQUIRED): A reference to a relevant specification
              document.<a href="#section-11.2-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.2-3">
          The policy for allocation of new entries SHOULD be: IETF Review.<a href="#section-11.2-3" class="pilcrow">¶</a></p>
<p id="section-11.2-4">
          The initial contents of this registry shall be as follows:<a href="#section-11.2-4" class="pilcrow">¶</a></p>
<span id="name-roughtime-version-assignmen"></span><table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-roughtime-version-assignmen" class="selfRef">Roughtime version assignments.</a>
          </caption>
<tbody>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Version ID</th>
              <th class="text-left" rowspan="1" colspan="1">Version name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x0</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x1</td>
              <td class="text-left" rowspan="1" colspan="1">Roughtime version 1</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x2-0x7fffffff</td>
              <td class="text-left" rowspan="1" colspan="1">Unassigned</td>
              <td class="text-left" rowspan="1" colspan="1"></td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x80000000-0xffffffff</td>
              <td class="text-left" rowspan="1" colspan="1">Reserved for Private or Experimental use</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
          </tbody>
        </table>
</section>
<section id="section-11.3">
        <h3 id="name-roughtime-tag-registry">
<a href="#section-11.3" class="section-number selfRef">11.3. </a><a href="#name-roughtime-tag-registry" class="section-name selfRef">Roughtime Tag Registry</a>
        </h3>
<p id="section-11.3-1">
          IANA is requested to create a new registry entitled
          "Roughtime Tag Registry". Entries SHALL have
          the following fields:<a href="#section-11.3-1" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-11.3-2.1">
              Tag (REQUIRED): A 32-bit unsigned integer in hexadecimal format.<a href="#section-11.3-2.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.3-2.2">
              ASCII Representation (OPTIONAL): The ASCII representation of the
              tag in accordance with <a href="#tag" class="xref">Section 5.1.4</a> of this memo, if
              applicable.<a href="#section-11.3-2.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-11.3-2.3">
              Reference (REQUIRED): A reference to a relevant specification
              document.<a href="#section-11.3-2.3" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-11.3-3">
          The policy for allocation of new entries in this registry
          SHOULD be: Specification Required.<a href="#section-11.3-3" class="pilcrow">¶</a></p>
<p id="section-11.3-4">
          The initial contents of this registry SHALL be as follows:<a href="#section-11.3-4" class="pilcrow">¶</a></p>
<span id="name-roughtime-tags"></span><table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-roughtime-tags" class="selfRef">Roughtime tags.</a>
          </caption>
<tbody>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Tag</th>
              <th class="text-left" rowspan="1" colspan="1">ASCII Representation</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00444150</td>
              <td class="text-left" rowspan="1" colspan="1">PAD</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00474953</td>
              <td class="text-left" rowspan="1" colspan="1">SIG</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x00524556</td>
              <td class="text-left" rowspan="1" colspan="1">VER</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x31545544</td>
              <td class="text-left" rowspan="1" colspan="1">DUT1</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x434e4f4e</td>
              <td class="text-left" rowspan="1" colspan="1">NONC</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x454c4544</td>
              <td class="text-left" rowspan="1" colspan="1">DELE</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x48544150</td>
              <td class="text-left" rowspan="1" colspan="1">PATH</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x49415444</td>
              <td class="text-left" rowspan="1" colspan="1">DTAI</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x49444152</td>
              <td class="text-left" rowspan="1" colspan="1">RADI</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x4b425550</td>
              <td class="text-left" rowspan="1" colspan="1">PUBK</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x5041454c</td>
              <td class="text-left" rowspan="1" colspan="1">LEAP</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x5044494d</td>
              <td class="text-left" rowspan="1" colspan="1">MIDP</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x50455253</td>
              <td class="text-left" rowspan="1" colspan="1">SREP</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x544e494d</td>
              <td class="text-left" rowspan="1" colspan="1">MINT</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x544f4f52</td>
              <td class="text-left" rowspan="1" colspan="1">ROOT</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x54524543</td>
              <td class="text-left" rowspan="1" colspan="1">CERT</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x5458414d</td>
              <td class="text-left" rowspan="1" colspan="1">MAXT</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0x58444e49</td>
              <td class="text-left" rowspan="1" colspan="1">INDX</td>
              <td class="text-left" rowspan="1" colspan="1">[[this memo]]</td>
            </tr>
          </tbody>
        </table>
</section>
</section>
</div>
<section id="section-12">
      <h2 id="name-security-considerations">
<a href="#section-12" class="section-number selfRef">12. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-12-1">
        Since the only supported signature scheme, Ed25519, is not quantum
        resistant, the Roughtime version described in this memo will not survive
        the advent of quantum computers.<a href="#section-12-1" class="pilcrow">¶</a></p>
<p id="section-12-2">
        Maintaining a list of trusted servers and adjudicating violations of the
        rules by servers is not discussed in this document and is essential for
        security. Roughtime clients MUST regularly update their view of which
        servers are trustworthy in order to benefit from the detection of
        misbehavior.<a href="#section-12-2" class="pilcrow">¶</a></p>
<p id="section-12-3">
        Validating timestamps made on different dates requires knowledge of leap
        seconds in order to calculate time intervals correctly.<a href="#section-12-3" class="pilcrow">¶</a></p>
<p id="section-12-4">
        Servers carry out a significant amount of computation in response to
        clients, and thus may experience vulnerability to denial of service
        attacks.<a href="#section-12-4" class="pilcrow">¶</a></p>
<p id="section-12-5">
        This protocol does not provide any confidentiality. Given the nature of
        timestamps such impact is minor.<a href="#section-12-5" class="pilcrow">¶</a></p>
<p id="section-12-6">
        The compromise of a PUBK's private
        key, even past MAXT, is a problem as the private key can be used to sign
        invalid times that are in the range MINT to MAXT, and thus violate the
        good behavior guarantee of the server.<a href="#section-12-6" class="pilcrow">¶</a></p>
<p id="section-12-7">
        Servers MUST NOT send response packets larger than the request packets
        sent by clients, in order to prevent amplification attacks.<a href="#section-12-7" class="pilcrow">¶</a></p>
</section>
<section id="section-13">
      <h2 id="name-privacy-considerations">
<a href="#section-13" class="section-number selfRef">13. </a><a href="#name-privacy-considerations" class="section-name selfRef">Privacy Considerations</a>
      </h2>
<p id="section-13-1">
        This protocol is designed to obscure all client identifiers. Servers
        necessarily have persistent long-term identities essential to enforcing
        correct behavior.<a href="#section-13-1" class="pilcrow">¶</a></p>
<p id="section-13-2">
        Generating nonces in a nonrandom manner can cause leaks of private data
        or enable tracking of clients as they move between networks.<a href="#section-13-2" class="pilcrow">¶</a></p>
</section>
<section id="section-14">
      <h2 id="name-references">
<a href="#section-14" class="section-number selfRef">14. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-14.1">
        <h3 id="name-normative-references">
<a href="#section-14.1" class="section-number selfRef">14.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="ITU-R_TF.457-2">[ITU-R_TF.457-2]</dt>
        <dd>
<span class="refAuthor">ITU-R</span>, <span class="refTitle">"Use of the Modified Julian Date by the Standard-Frequency and Time-Signal Services"</span>, <span class="seriesInfo">ITU-R Recommendation TF.457-2</span>, <time datetime="1997-10" class="refDate">October 1997</time>. </dd>
<dd class="break"></dd>
<dt id="ITU-R_TF.460-6">[ITU-R_TF.460-6]</dt>
        <dd>
<span class="refAuthor">ITU-R</span>, <span class="refTitle">"Standard-Frequency and Time-Signal Emissions"</span>, <span class="seriesInfo">ITU-R Recommendation TF.460-6</span>, <time datetime="2002-02" class="refDate">February 2002</time>. </dd>
<dd class="break"></dd>
<dt id="RFC0020">[RFC0020]</dt>
        <dd>
<span class="refAuthor">Cerf, V.</span>, <span class="refTitle">"ASCII format for network interchange"</span>, <span class="seriesInfo">STD 80</span>, <span class="seriesInfo">RFC 20</span>, <span class="seriesInfo">DOI 10.17487/RFC0020</span>, <time datetime="1969-10" class="refDate">October 1969</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc20">https://www.rfc-editor.org/info/rfc20</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6335">[RFC6335]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Eggert, L.</span>, <span class="refAuthor">Touch, J.</span>, <span class="refAuthor">Westerlund, M.</span>, and <span class="refAuthor">S. Cheshire</span>, <span class="refTitle">"Internet Assigned Numbers Authority (IANA) Procedures for the Management of the Service Name and Transport Protocol Port Number Registry"</span>, <span class="seriesInfo">BCP 165</span>, <span class="seriesInfo">RFC 6335</span>, <span class="seriesInfo">DOI 10.17487/RFC6335</span>, <time datetime="2011-08" class="refDate">August 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6335">https://www.rfc-editor.org/info/rfc6335</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8032">https://www.rfc-editor.org/info/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8259">[RFC8259]</dt>
        <dd>
<span class="refAuthor">Bray, T., Ed.</span>, <span class="refTitle">"The JavaScript Object Notation (JSON) Data Interchange Format"</span>, <span class="seriesInfo">STD 90</span>, <span class="seriesInfo">RFC 8259</span>, <span class="seriesInfo">DOI 10.17487/RFC8259</span>, <time datetime="2017-12" class="refDate">December 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8259">https://www.rfc-editor.org/info/rfc8259</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="SHS">[SHS]</dt>
      <dd>
<span class="refAuthor">National Institute of Standards and Technology</span>, <span class="refTitle">"Secure Hash Standard"</span>, <span class="seriesInfo">DOI 10.6028/NIST.FIPS.180-4</span>, <span class="seriesInfo">FIPS 180-4</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://doi.org/10.6028/NIST.FIPS.180-4">https://doi.org/10.6028/NIST.FIPS.180-4</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-14.2">
        <h3 id="name-informative-references">
<a href="#section-14.2" class="section-number selfRef">14.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="Autokey">[Autokey]</dt>
        <dd>
<span class="refAuthor">Rottger, S.</span>, <span class="refTitle">"Analysis of the NTP Autokey Procedures"</span>, <time datetime="2012" class="refDate">2012</time>, <span>&lt;<a href="https://zero-entropy.de/autokey_analysis.pdf">https://zero-entropy.de/autokey_analysis.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="DelayAttacks">[DelayAttacks]</dt>
        <dd>
<span class="refAuthor">Mizrahi, T.</span>, <span class="refTitle">"A Game Theoretic Analysis of Delay Attacks Against Time Synchronization Protocols"</span>, <span class="seriesInfo">DOI 10.1109/ISPCS.2012.6336612</span>, <time datetime="2012" class="refDate">2012</time>, <span>&lt;<a href="https://ieeexplore.ieee.org/document/6336612">https://ieeexplore.ieee.org/document/6336612</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="MCBG">[MCBG]</dt>
        <dd>
<span class="refAuthor">Malhotra, A.</span>, <span class="refAuthor">Cohen, I.</span>, <span class="refAuthor">Brakke, E.</span>, and <span class="refAuthor">S. Goldberg</span>, <span class="refTitle">"Attacking the Network Time Protocol"</span>, <time datetime="2015" class="refDate">2015</time>, <span>&lt;<a href="https://eprint.iacr.org/2015/1020">https://eprint.iacr.org/2015/1020</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0768">[RFC0768]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"User Datagram Protocol"</span>, <span class="seriesInfo">STD 6</span>, <span class="seriesInfo">RFC 768</span>, <span class="seriesInfo">DOI 10.17487/RFC0768</span>, <time datetime="1980-08" class="refDate">August 1980</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc768">https://www.rfc-editor.org/info/rfc768</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0791">[RFC0791]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Internet Protocol"</span>, <span class="seriesInfo">STD 5</span>, <span class="seriesInfo">RFC 791</span>, <span class="seriesInfo">DOI 10.17487/RFC0791</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc791">https://www.rfc-editor.org/info/rfc791</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC0793">[RFC0793]</dt>
        <dd>
<span class="refAuthor">Postel, J.</span>, <span class="refTitle">"Transmission Control Protocol"</span>, <span class="seriesInfo">STD 7</span>, <span class="seriesInfo">RFC 793</span>, <span class="seriesInfo">DOI 10.17487/RFC0793</span>, <time datetime="1981-09" class="refDate">September 1981</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc793">https://www.rfc-editor.org/info/rfc793</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
        <dd>
<span class="refAuthor">Eastlake 3rd, D.</span>, <span class="refAuthor">Schiller, J.</span>, and <span class="refAuthor">S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4086">https://www.rfc-editor.org/info/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5905">[RFC5905]</dt>
        <dd>
<span class="refAuthor">Mills, D.</span>, <span class="refAuthor">Martin, J., Ed.</span>, <span class="refAuthor">Burbank, J.</span>, and <span class="refAuthor">W. Kasch</span>, <span class="refTitle">"Network Time Protocol Version 4: Protocol and Algorithms Specification"</span>, <span class="seriesInfo">RFC 5905</span>, <span class="seriesInfo">DOI 10.17487/RFC5905</span>, <time datetime="2010-06" class="refDate">June 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5905">https://www.rfc-editor.org/info/rfc5905</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7384">[RFC7384]</dt>
        <dd>
<span class="refAuthor">Mizrahi, T.</span>, <span class="refTitle">"Security Requirements of Time Protocols in Packet Switched Networks"</span>, <span class="seriesInfo">RFC 7384</span>, <span class="seriesInfo">DOI 10.17487/RFC7384</span>, <time datetime="2014-10" class="refDate">October 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7384">https://www.rfc-editor.org/info/rfc7384</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8573">[RFC8573]</dt>
        <dd>
<span class="refAuthor">Malhotra, A.</span> and <span class="refAuthor">S. Goldberg</span>, <span class="refTitle">"Message Authentication Code for the Network Time Protocol"</span>, <span class="seriesInfo">RFC 8573</span>, <span class="seriesInfo">DOI 10.17487/RFC8573</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8573">https://www.rfc-editor.org/info/rfc8573</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8915">[RFC8915]</dt>
      <dd>
<span class="refAuthor">Franke, D.</span>, <span class="refAuthor">Sibold, D.</span>, <span class="refAuthor">Teichel, K.</span>, <span class="refAuthor">Dansarie, M.</span>, and <span class="refAuthor">R. Sundblad</span>, <span class="refTitle">"Network Time Security for the Network Time Protocol"</span>, <span class="seriesInfo">RFC 8915</span>, <span class="seriesInfo">DOI 10.17487/RFC8915</span>, <time datetime="2020-09" class="refDate">September 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8915">https://www.rfc-editor.org/info/rfc8915</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<section id="section-appendix.a">
      <h2 id="name-terms-and-abbreviations">
<a href="#section-appendix.a" class="section-number selfRef">Appendix A. </a><a href="#name-terms-and-abbreviations" class="section-name selfRef">Terms and Abbreviations</a>
      </h2>
<span class="break"></span><dl class="dlParallel" id="section-appendix.a-1">
        <dt id="section-appendix.a-1.1">ASCII </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.2">American Standard Code for Information
              Interchange<a href="#section-appendix.a-1.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.3">IANA  </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.4">Internet Assigned Numbers Authority<a href="#section-appendix.a-1.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.5">JSON  </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.6">
          <span><a href="#RFC8259" class="xref">JavaScript Object
              Notation</a> [<a href="#RFC8259" class="xref">RFC8259</a>]</span><a href="#section-appendix.a-1.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.7">MJD   </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.8">Modified Julian Date<a href="#section-appendix.a-1.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.9">NTP   </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.10">
          <span><a href="#RFC5905" class="xref">Network Time Protocol</a> [<a href="#RFC5905" class="xref">RFC5905</a>]</span><a href="#section-appendix.a-1.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.11">NTS   </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.12">
          <span><a href="#RFC8915" class="xref">Network Time Security</a> [<a href="#RFC8915" class="xref">RFC8915</a>]</span><a href="#section-appendix.a-1.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.13">TAI   </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.14">
          <span><a href="#ITU-R_TF.460-6" class="xref">International
              Atomic Time (Temps Atomique International)</a> [<a href="#ITU-R_TF.460-6" class="xref">ITU-R_TF.460-6</a>]</span><a href="#section-appendix.a-1.14" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.15">TCP   </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.16">
          <span><a href="#RFC0793" class="xref">Transmission Control
              Protocol</a> [<a href="#RFC0793" class="xref">RFC0793</a>]</span><a href="#section-appendix.a-1.16" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.17">UDP   </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.18">
          <span><a href="#RFC0768" class="xref">User Datagram Protocol</a> [<a href="#RFC0768" class="xref">RFC0768</a>]</span><a href="#section-appendix.a-1.18" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.19">UT    </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.20">
          <span><a href="#ITU-R_TF.460-6" class="xref">Universal Time</a> [<a href="#ITU-R_TF.460-6" class="xref">ITU-R_TF.460-6</a>]</span><a href="#section-appendix.a-1.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="section-appendix.a-1.21">UTC   </dt>
        <dd style="margin-left: 1.5em" id="section-appendix.a-1.22">
          <span><a href="#ITU-R_TF.460-6" class="xref">Coordinated
              Universal Time</a> [<a href="#ITU-R_TF.460-6" class="xref">ITU-R_TF.460-6</a>]</span><a href="#section-appendix.a-1.22" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aanchal Malhotra</span></div>
<div dir="auto" class="left"><span class="org">Boston University</span></div>
<div dir="auto" class="left"><span class="street-address">111 Cummington Mall</span></div>
<div dir="auto" class="left">
<span class="locality">Boston</span>, <span class="region">MA</span> <span class="postal-code">02215</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:aanchal4@bu.edu" class="email">aanchal4@bu.edu</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Adam Langley</span></div>
<div dir="auto" class="left"><span class="org">Google</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:agl@google.com" class="email">agl@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Watson Ladd</span></div>
<div dir="auto" class="left"><span class="org">Cloudflare</span></div>
<div dir="auto" class="left"><span class="street-address">101 Townsend St</span></div>
<div dir="auto" class="left">
<span class="locality">San Francisco</span>, <span class="region">CA</span> <span class="postal-code">94107</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:watsonbladd@gmail.com" class="email">watsonbladd@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marcus Dansarie</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marcus@dansarie.se" class="email">marcus@dansarie.se</a>
</div>
<div class="url">
<span>URI:</span>
<a href="https://orcid.org/0000-0001-9246-0263" class="url">https://orcid.org/0000-0001-9246-0263</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
