<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>IP Flow Information Export (IPFIX) Information Elements Extension for Forwarding Exceptions</title>
<meta content="Venkata Naga Chaitanya Munukutla" name="author">
<meta content="Shivam Vaid" name="author">
<meta content="Aditya Mahale" name="author">
<meta content="Devang Patel" name="author">
<meta content="
       
      This draft proposes couple of new Forwarding exceptions related Information
      Elements (IEs) and Templates for the IP Flow Information Export (IPFIX)
      protocol. These new Information Elements and Exception Template can be
      used to export information about any forwarding errors in a network.
      This essential information is adequate to correlate packet drops to any
      control plane entity and map it to an impacted service.
      Once exceptions are correlated to a particular entity, an action
      can be assigned to mitigate such problems essentially enabling
      self-driving networks.
       
    " name="description">
<meta content="xml2rfc 3.9.1" name="generator">
<meta content="Forwarding" name="keyword">
<meta content="exception" name="keyword">
<meta content="draft-mvmd-opsawg-ipfix-fwd-exceptions-03" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.9.1
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.1
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.6.3
    pycountry 20.7.3
    pyflakes 2.3.1
    PyYAML 5.4.1
    requests 2.26.0
    setuptools 57.4.0
    six 1.16.0
-->
<link href="/tmp/draft-mvmd-opsawg-ipfix-fwd-exceptions-03-4xq_nfy_.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">IPFIX for FWD Exceptions</td>
<td class="right">August 2021</td>
</tr></thead>
<tfoot><tr>
<td class="left">Munukutla, et al.</td>
<td class="center">Expires 9 February 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">IP Flow Information Export</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-mvmd-opsawg-ipfix-fwd-exceptions-03</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2021-08-08" class="published">8 August 2021</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-02-09">9 February 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Munukutla</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
<div class="author">
      <div class="author-name">S. Vaid</div>
<div class="org">Juniper Networks, Inc.</div>
</div>
<div class="author">
      <div class="author-name">A. Mahale</div>
<div class="org">Google, Inc.</div>
</div>
<div class="author">
      <div class="author-name">D. Patel</div>
<div class="org">Google, Inc.</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">IP Flow Information Export (IPFIX) Information Elements Extension for Forwarding Exceptions</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
      This draft proposes couple of new Forwarding exceptions related Information
      Elements (IEs) and Templates for the IP Flow Information Export (IPFIX)
      protocol. These new Information Elements and Exception Template can be
      used to export information about any forwarding errors in a network.
      This essential information is adequate to correlate packet drops to any
      control plane entity and map it to an impacted service.
      Once exceptions are correlated to a particular entity, an action
      can be assigned to mitigate such problems essentially enabling
      self-driving networks.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 9 February 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2021 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulBare compact ulEmpty toc">
<li class="ulBare compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.1.2.2">
                <p id="section-toc.1-1.1.2.2.1" class="keepWithNext"><a href="#section-1.2" class="xref">1.2</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a></p>
</li>
            </ul>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-scope" class="xref">Scope</a></p>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-information-elements" class="xref">Information Elements</a></p>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-new-information-elements" class="xref">New Information Elements</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-proposed-new-information-el" class="xref">Proposed New Information Elements</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-definition-of-exceptions" class="xref">Definition of Exceptions</a></p>
<ul class="ulBare compact ulEmpty toc">
<li class="ulBare compact ulEmpty toc" id="section-toc.1-1.4.2.2.2.1">
                    <p id="section-toc.1-1.4.2.2.2.1.1"><a href="#section-4.2.1" class="xref">4.2.1</a>.  <a href="#name-forwardingexceptioncode" class="xref">forwardingExceptionCode</a></p>
</li>
                  <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.4.2.2.2.2">
                    <p id="section-toc.1-1.4.2.2.2.2.1"><a href="#section-4.2.2" class="xref">4.2.2</a>.  <a href="#name-forwardingnexthopid" class="xref">forwardingNexthopId</a></p>
</li>
                  <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.4.2.2.2.3">
                    <p id="section-toc.1-1.4.2.2.2.3.1"><a href="#section-4.2.3" class="xref">4.2.3</a>.  <a href="#name-forwardinglookuptype" class="xref">forwardingLookupType</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-exception-templates" class="xref">Exception Templates</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.5.2.1">
                <p id="section-toc.1-1.5.2.1.1"><a href="#section-5.1" class="xref">5.1</a>.  <a href="#name-ipfix-exception-template-1-" class="xref">IPFIX Exception Template 1 for Forwarding Exceptions</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.5.2.2">
                <p id="section-toc.1-1.5.2.2.1"><a href="#section-5.2" class="xref">5.2</a>.  <a href="#name-ipfix-exception-template-2-" class="xref">IPFIX Exception Template 2 for Forwarding Exceptions</a></p>
</li>
            </ul>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-information-elements-3" class="xref">Information Elements</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-forwarding-exception-codes" class="xref">Forwarding Exception Codes</a></p>
</li>
            </ul>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-contributors" class="xref">Contributors</a></p>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact ulBare ulEmpty toc">
<li class="compact ulBare ulEmpty toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact ulBare ulEmpty toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="ulBare compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
      All networks are susceptible to traffic drops due to a number of factors.
      Traffic drops can go unnoticed unless they are service impacting.
      In a multi-layered network architecture, it is tedious manual work to
      localize and root cause traffic blackholing issues.
      Transient drops are even harder to detect. Existing methodologies
      that rely on periodically monitoring interfaces on several hosts
      in a network does not guarantee timely detection, and are not
      scalable for large networks.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
      In order to eliminate this tedious monitoring work-flow, objective is to
      simplify localization and build correlation of dropped packets to particular entity.
      The network entity shall identify the dropped packets by monitoring dropped 
      counters or doing a deep packet inspection of the packet discarded by the 
      forwarding ASIC. The implementation of the method used to detect the drop 
      is outside the scope of this document. Dropped packets will be sampled 
      in the forwarding-path and sent to a host or software queue along with 
      type of exception, in/out interface information and other relevant meta data. 
      This will be a push model where the node encountering the error will emit 
      the information about dropped packets and associated meta-data. 
      Techniques for IP Packet Selection <span>[<a href="#RFC5475" class="xref">RFC5475</a>]</span> describes Sampling 
      and Filtering techniques for IP packet selection either using 
      Systematic Sampling or Random Sampling.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">
      The IPFIX Protocol Specification <span>[<a href="#RFC7011" class="xref">RFC7011</a>]</span> defines a generic exchange
      mechanism for collecting flow information. It supports source-triggered
      export of information via the push model approach.
      The IPFIX Information Model <span>[<a href="#IANA-IPFIX" class="xref">IANA-IPFIX</a>]</span> defines a list of 
      standard Information Elements (IEs) which can be carried by the IPFIX protocol.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">
      This document focuses on telemetry information for dropped packet exceptions,
      and proposes an extension to IPFIX message format for collecting
      sampled exceptions. Some of the IPFIX Information Elements (IEs)
      already exist, some will be defined along with corresponding formats.
      It is also possible to achieve sampling of the dropped packets by using 
      sampling methods like SFLOW but details of other sampling methods are 
      outside the scope of this document.<a href="#section-1-4" class="pilcrow">¶</a></p>
<div id="termi">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">
       IPFIX-specific terminology (e.g.  Information Element, Template,
       Template Record, Options Template Record, Template Set, Collector,
       Exporter, Data Record) used in this document is defined in Section 2
       of <span>[<a href="#RFC7011" class="xref">RFC7011</a>]</span>.  As in <span>[<a href="#RFC7011" class="xref">RFC7011</a>]</span> these
       IPFIX-specific terms have the first letter of a word capitalized.

       This document also makes use of the same terminology and definitions
       as Section 2 of <span>[<a href="#RFC5470" class="xref">RFC5470</a>]</span>.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-1.2">
        <h3 id="name-requirements-language">
<a href="#section-1.2" class="section-number selfRef">1.2. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-1.2-1">
        The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED", "MAY", and
        "OPTIONAL" in this document are to be interpreted as described in BCP
        14 <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="xref">RFC8174</a>]</span> when, and only when,
        they appear in all capitals, as shown here.<a href="#section-1.2-1" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="scope">
<section id="section-2">
      <h2 id="name-scope">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-scope" class="section-name selfRef">Scope</a>
      </h2>
<p id="section-2-1">
      This document specifies the information model used for reporting 
      packet-based forwarding exceptions. <span>[<a href="#RFC7011" class="xref">RFC7011</a>]</span> provides guidance on
      the choices of the transport protocols used for IPFIX and their effects.
      Encoded IPFIX exception packets need to be reliably transported to the 
      collector. The choice of the actual transport protocol 
      is beyond the scope of this document.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
      This document assumes that all devices reporting exceptions will use 
      existing IPFIX framework/module to send encoded packets to the collector.
      This would mean that the network device will specify the template that 
      it is going to use for each of the events. The templates can be of 
      varying length, and there could be multiple templates that a network 
      device could use to encode the exceptions.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">
      The implementation details of the collector application are beyond the 
      scope of this document.<a href="#section-2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="ie">
<section id="section-3">
      <h2 id="name-information-elements">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-information-elements" class="section-name selfRef">Information Elements</a>
      </h2>
<p id="section-3-1">
       The Exception template could contain a subset of the IEs shown in Table 1,
       depending upon the exception reported.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">
       Whenever packet drop happens inside forwarding plane, following information 
       is key to understanding the issue: reason for packet drop, flow which 
       encountered the drop (packet content), additional meta-data
       e.g. flow direction (ingress/egress), nexthop index, input interface, output interface, 
       etc. on which this packet was flowing.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">
       The following table includes all the existing IEs that a device reporting
       IPFIX Exceptions using various Exception Templates would typically need. 
       The formats of IEs and IPFIX IDs are listed in the table below.<a href="#section-3-3" class="pilcrow">¶</a></p>
<span id="name-information-elements-2"></span><figure id="figure-1">
        <div class="artwork art-text alignCenter" id="section-3-4.1">
<pre>
+-------------------------------+--------+-------+--------------+
| Field Name                    |  Size  |  IANA | Description  |
|                               | (bits) | IPFIX |              |
|                               |        |   ID  |              |
+-------------------------------+--------+-------+--------------+
| flowDirection                 |   8    |  61   | The direction|
|                               |        |       | of the Flow  |
|                               |        |       | observed at  |
|                               |        |       | Observation  |
|                               |        |       | point.       |
|                               |        |       |              |
| ingressInterface              |   32   |  10   | Index of IP  |
|                               |        |       | interface    |
|                               |        |       | where packets|
|                               |        |       | of this flow |
|                               |        |       | are being    |
|                               |        |       | received.    |
|                               |        |       |              |
| egressInterface               |   32   |  14   | Index of IP  |
|                               |        |       | interface    |
|                               |        |       | where packets|
|                               |        |       | of this flow |
|                               |        |       | are being    |
|                               |        |       | sent.        |
|                               |        |       |              |
| dataLinkFrameSize             |   16   |  312  | Specified    |
|                               |        |       | length of    |
|                               |        |       | data link    |
|                               |        |       | frame.       |
|                               |        |       |              |
| dataLinkFrameSection          |  65535 |  315  | Carries n    |
|                               |        |       | octets from  |
|                               |        |       | data link    |
|                               |        |       | frame of     |
|                               |        |       | selected     |
|                               |        |       | frame.       |
|                               |        |       |              |
| commonPropertiesID            |   64   |  137  | Identifier of|
|                               |        |       | a set of     |
|                               |        |       | common       |
|                               |        |       | properties   |
|                               |        |       | that is      |
|                               |        |       | unique per   |
|                               |        |       | observation  |
|                               |        |       | domain.      |
+-------------------------------+--------+-------+--------------+
        Table 1: Forwarding Exception Information Elements
</pre>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-information-elements-2" class="selfRef">Information Elements</a>
        </figcaption></figure>
</section>
</div>
<div id="newie">
<section id="section-4">
      <h2 id="name-new-information-elements">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-new-information-elements" class="section-name selfRef">New Information Elements</a>
      </h2>
<div id="propo">
<section id="section-4.1">
        <h3 id="name-proposed-new-information-el">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-proposed-new-information-el" class="section-name selfRef">Proposed New Information Elements</a>
        </h3>
<p id="section-4.1-1">
         The proposed new IEs that a device reporting Exceptions using Exception template 
         would need are listed in Table 2 below.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<span id="name-new-information-elements-2"></span><figure id="figure-2">
          <div class="artwork art-text alignCenter" id="section-4.1-2.1">
<pre>
+---------------------------+---------------------+-----------------+
| Field Name                | Abstract Data Type  | Description     |
|                           |                     |                 |
+---------------------------+---------------------+-----------------+
| forwardingExceptionCode   | unsigned32          | Unique code for |
|                           |                     | every exception |
|                           |                     |                 |
| forwardingNextHopID       | unsigned64          | Forwarding NH - |
|                           |                     | index associated|
|                           |                     | with packet that|
|                           |                     | encountered     |
|                           |                     | this exception  |
|                           |                     |                 |
| forwardingLookupType      | unsigned8           | Last Lookup     |
|                           |                     | type performed  |
|                           |                     | on the packet in|
|                           |                     | in ingress path.|
|                           |                     | For instance,   |
|                           |                     | IPV4, IPV6,     |
|                           |                     | Bridge, MPLS,   |
|                           |                     | Unknown etc.    |
+---------------------------+---------------------+-----------------+
            Table 2: New Information Elements
</pre>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-new-information-elements-2" class="selfRef">New Information Elements</a>
          </figcaption></figure>
<p id="section-4.1-3">
        The Information Elements defined in Table 2 are proposed to be
        incorporated into the IANA IPFIX Information Elements registry
        <span>[<a href="#IANA-IPFIX" class="xref">IANA-IPFIX</a>]</span><a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-4.2">
        <h3 id="name-definition-of-exceptions">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-definition-of-exceptions" class="section-name selfRef">Definition of Exceptions</a>
        </h3>
<p id="section-4.2-1">
      Every network will encounter issues like packet loss, from time to time. 
      Some of the causes for such a loss of traffic or a block in transmission of data packets include 
      overloaded system conditions, misconfiguration, profiles and policies that restrict the bandwidth 
      or priority of traffic, network outages, or disruption with physical cable faults. Packet loss 
      could also happen because of incorrect stitching of the forwarding path or a mismatch between 
      control plane and data plane state. Exception code entails the reason/error code due to 
      which this packet has been dropped.<a href="#section-4.2-1" class="pilcrow">¶</a></p>
<section id="section-4.2.1">
          <h4 id="name-forwardingexceptioncode">
<a href="#section-4.2.1" class="section-number selfRef">4.2.1. </a><a href="#name-forwardingexceptioncode" class="section-name selfRef">forwardingExceptionCode</a>
          </h4>
<p id="section-4.2.1-1">
        forwardingExceptionCode will be defined in "IPFIX Information Elements" registry.
        This list can be expanded in the future as necessary. The data record will have 
        corresponding exception code value to indicate forwarding error that caused the 
        traffic drop.<a href="#section-4.2.1-1" class="pilcrow">¶</a></p>
<p id="section-4.2.1-2">
        An implementation may choose to encode device internal exception 
        codes as forwardingExceptionCode. In such scenarios, Enterprise Bit MUST be set 
        to 1 and corresponding Enterprise Number MUST be present as described in 
        <span>[<a href="#RFC7011" class="xref">RFC7011</a>]</span><a href="#section-4.2.1-2" class="pilcrow">¶</a></p>
<p id="section-4.2.1-3">
        There is an existing IE 89 - forwardingStatus <span>[<a href="#IANA-IPFIX" class="xref">IANA-IPFIX</a>]</span>
        but it allows a very limited number of exceptions to be reported from the system (6-bit reason code). 
        The exception codes also need to be standardized for use. Different forwarding ASICs would have different 
        pipelines and hence discard reasons (which could be very specific to that pipeline) cannot be generalized. 
        Hence it makes sense to have a standalone IE for reporting exception which not only provides support to 
        report larger number of exceptions but also provides freedom for reporting application specific 
        exceptions using the enterprise bit.<a href="#section-4.2.1-3" class="pilcrow">¶</a></p>
<p id="section-4.2.1-4">
        forwardingExceptionCode will also describe status of the flow with first two bits.
        An implementation may choose to export forwardingExceptionCode instead of IE89 - forwardingStatus.<a href="#section-4.2.1-4" class="pilcrow">¶</a></p>
<p id="section-4.2.1-5">
        A list of commonly used forwarding Exception codes will be identified and listed as part of
        Table 3 below.<a href="#section-4.2.1-5" class="pilcrow">¶</a></p>
<span id="name-table-3-exception-codes"></span><figure id="figure-3">
            <div class="artwork art-text alignCenter" id="section-4.2.1-6.1">
<pre>
+----------------+--------------------------------------------------+
| Forwarding     |           Reason                                 |
| Exception Code |                                                  |
+----------------+--------------------------------------------------+
|       1        | FIREWALL_DISCARD                                 |
|       2        | TTL_EXPIRY                                       |
|       3        | DISCARD_ROUTE                                    |
|       4        | BAD_IPV4_CHECKSUM                                |
|       5        | REJECT_ROUTE                                     |
|       6        | BAD_IPV4_HEADER (Version incorrect or IHL &lt; 5)|
|       7        | BAD_IPV6_HEADER (Version incorrect)              |
|       8        | BAD_IPV4_HEADER_LENGTH (V4 frame is too short)   |
|       9        | BAD_IPV6_HEADER_LENGTH                           |
|       10       | BAD_IPV6_OPTIONS_PACKET(too many option headers) |
|       ..       | ..                                               |
+----------------+--------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-table-3-exception-codes" class="selfRef">Table 3: Exception Codes</a>
            </figcaption></figure>
</section>
<section id="section-4.2.2">
          <h4 id="name-forwardingnexthopid">
<a href="#section-4.2.2" class="section-number selfRef">4.2.2. </a><a href="#name-forwardingnexthopid" class="section-name selfRef">forwardingNexthopId</a>
          </h4>
<p id="section-4.2.2-1">
        In terms of a network device, next hop is the gateway to which packet should be forwarded 
        corresponding to the path to final destination. A given router doesn't need to store the 
        entire forwarding path information for a destination. As long as it can identify the next hop 
        to be used for forwarding to a destination, the end to end forwarding can happen. This helps 
        reduce size of forwarding table. The nexthop index uniquely identifies the egress path a packet 
        would take to reach the destination. This could include information about the outgoing 
        interface, layer 2 address to be used, forwarding features configured for the packet path etc.<a href="#section-4.2.2-1" class="pilcrow">¶</a></p>
<p id="section-4.2.2-2">
        For instance, consider we have a L3VPN topology like below<a href="#section-4.2.2-2" class="pilcrow">¶</a></p>
<span id="name-figure-1-mpls-vpn-network"></span><figure id="figure-4">
            <div class="artwork art-text alignCenter" id="section-4.2.2-3.1">
<pre>
            CE1 -------- PE1 ----- MPLS Network ----- PE2 ------- CE2
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-figure-1-mpls-vpn-network" class="selfRef">Figure 1: MPLS VPN Network</a>
            </figcaption></figure>
<p id="section-4.2.2-4">
        Figure 1 above illustrates an example where reporting of exception can provide an insight into 
        the error scenario.
        CE1 and CE2 communicate with each other over an MPLS VPN network. The labels are typically 
        advertised using protocols like RSVP or LDP. When a packet is received from core network on PE1, 
        a lookup on MPLS label results in packet getting forwarded towards CE1. 
        The entries in MPLS table are populated by corresponding protocol. If label entries don't get 
        populated in the MPLS table due to a probable glitch in the protocol configuration or some software
        inconsistency, the packets traversing on that LSP tunnel path shall get discarded on PE1.<a href="#section-4.2.2-4" class="pilcrow">¶</a></p>
<p id="section-4.2.2-5">
        In case of route lookups, that result in hierarchical forwarding chains, the mis-programming 
        may manifest at different levels of the forwarding structure. The forwarding lookup may fail on any 
        level of the hierarchy in the forwarding chain. It is expected that software at least report the nexthop 
        where the lookup terminates. Its desirable for software to report the top level nexthop in the chain.<a href="#section-4.2.2-5" class="pilcrow">¶</a></p>
<p id="section-4.2.2-6">
        Using the mechanism described in this RFC, it will be possible to capture such packets and report 
        them in IPFIX format with corresponding exception set (eg. DISCARD_ROUTE) along with relevant packet 
        bytes and meta-data. This can help the operator/software to immediately understand root cause of the 
        problem and take appropriate action.<a href="#section-4.2.2-6" class="pilcrow">¶</a></p>
<p id="section-4.2.2-7">
        An implementation may choose to report linecard number, linecard type, forwarding ASIC type and 
        forwarding ASIC number on which an exception occurs, but mechanism to export these fields is 
        out of the scope of this document.<a href="#section-4.2.2-7" class="pilcrow">¶</a></p>
</section>
<section id="section-4.2.3">
          <h4 id="name-forwardinglookuptype">
<a href="#section-4.2.3" class="section-number selfRef">4.2.3. </a><a href="#name-forwardinglookuptype" class="section-name selfRef">forwardingLookupType</a>
          </h4>
<p id="section-4.2.3-1">
        A packet might undergo multiple lookups in forwarding chain. Lookup may fail on any level of the hierarchy 
        When an exception is reported in such cases, type of last lookup performed on the packet may help in 
        identifying the erroneous level in the hierarchy.<a href="#section-4.2.3-1" class="pilcrow">¶</a></p>
<p id="section-4.2.3-2">
        For instance, a Firewall Discard may happen for Layer2 or Layer3 packet. All such packets may be treated 
        as FIREWALL_DISCARD for generic exception reporting purposes. However, exact place of error in the
        pipeline (IPV4, IPV6, MPLS etc.) may help with easily correlating the exception.<a href="#section-4.2.3-2" class="pilcrow">¶</a></p>
</section>
</section>
</section>
</div>
<div id="exception_temp">
<section id="section-5">
      <h2 id="name-exception-templates">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-exception-templates" class="section-name selfRef">Exception Templates</a>
      </h2>
<p id="section-5-1">
      This section presents a list of templates for reporting exceptions using newly proposed IEs
      in addition to few existing Information Elements (IEs).<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">
      Templates listed below are sample templates to demonstrate the utility of newly introduced 
      Information Elements in conjuction with existing Information Elements to report meaningful 
      data to the collector. A specific implementation may add or remove Information Elements from 
      below templates based on their reporting requirements.<a href="#section-5-2" class="pilcrow">¶</a></p>
<div id="extemp1">
<section id="section-5.1">
        <h3 id="name-ipfix-exception-template-1-">
<a href="#section-5.1" class="section-number selfRef">5.1. </a><a href="#name-ipfix-exception-template-1-" class="section-name selfRef">IPFIX Exception Template 1 for Forwarding Exceptions</a>
        </h3>
<p id="section-5.1-1">
        Exception Template defined in Figure 1 demonstrates a sample set of data to export 
        forwarding Exceptions.<a href="#section-5.1-1" class="pilcrow">¶</a></p>
<span id="name-ipfix-exception-template-fo"></span><figure id="figure-5">
          <div class="artwork art-text alignCenter" id="section-5.1-2.1">
<pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Set ID = 2                |      Length = N octets        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Template ID = 256           |       Field Count = N         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|   forwardingExceptionCode       |       Field Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|   forwardingNextHopId           |       Field Length = 8        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|   forwardingLookupType          |       Field Length = 1        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|      flowDirection              |       Field Length = 1        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|     ingressInterface            |       Field Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|     egressInterface             |       Field Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|     dataLinkFrameSize           |       Field Length = 2        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|    dataLinkFrameSection         |       Field Length = 65535    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Padding (opt)                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-ipfix-exception-template-fo" class="selfRef">IPFIX Exception Template for Forwarding Exceptions</a>
          </figcaption></figure>
</section>
</div>
<div id="extemp2">
<section id="section-5.2">
        <h3 id="name-ipfix-exception-template-2-">
<a href="#section-5.2" class="section-number selfRef">5.2. </a><a href="#name-ipfix-exception-template-2-" class="section-name selfRef">IPFIX Exception Template 2 for Forwarding Exceptions</a>
        </h3>
<p id="section-5.2-1">
        Alternatively, Exception Template defined in Figure 2 is a sample template to export
        forwarding exceptions. This template demonstrates the use of Information Element 137
        to represent following fields: forwardingExceptionCode, forwardingNexthopId,
        ingressInterface, underlyingIngressInterface and egressInterface.<a href="#section-5.2-1" class="pilcrow">¶</a></p>
<span id="name-ipfix-exception-template-2-f"></span><figure id="figure-6">
          <div class="artwork art-text alignCenter" id="section-5.2-2.1">
<pre>
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|         Set ID = 2                |      Length = N octets        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       Template ID = 256           |       Field Count = N         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|     commonPropertiesId1         |       Field Length = 4        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|      flowDirection              |       Field Length = 1        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|   forwardingLookupType          |       Field Length = 1        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|     commonPropertiesId2         |       Field Length = 8        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|     commonPropertiesId3         |       Field Length = 8        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|     commonPropertiesId4         |       Field Length = 8        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|     commonPropertiesId5         |       Field Length = 8        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|     dataLinkFrameSize           |       Field Length = 2        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|0|    dataLinkFrameSection         |       Field Length = 65535    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Padding (opt)                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-6" class="selfRef">Figure 6</a>:
<a href="#name-ipfix-exception-template-2-f" class="selfRef">IPFIX Exception Template 2 for Forwarding Exceptions</a>
          </figcaption></figure>
</section>
</div>
</section>
</div>
<div id="IANA">
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-information-elements-3">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-information-elements-3" class="section-name selfRef">Information Elements</a>
        </h3>
<p id="section-6.1-1">
      IANA manages the IPFIX Information Elements registry at
      <span>[<a href="#IANA-IPFIX" class="xref">IANA-IPFIX</a>]</span>. This document introduces two new IPFIX Information Elements.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">
        Name: forwardingExceptionCode
        
        ElementID: TBD
        
        Description: Exception code is an identifier uniquely describing cause of irregularity or
                     traffic drop on a device.
        
        Abstract Data Type: unsigned32
        
        Data Type Semantics: identifier<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<p id="section-6.1-3">
        Name: forwardingNexthopId
        
        ElementID: TBD
        
        Description: Nexthop ID is a unique identifier for a Nexthop on a device.
        
        Abstract Data Type: unsigned64
        
        Data Type Semantics: identifier<a href="#section-6.1-3" class="pilcrow">¶</a></p>
<p id="section-6.1-4">
        Name: forwardingLookupType
        
        ElementID: TBD
        
        Description: Represents the last lookup performed on the packet in 
                     forwarding path.                     
        
        Abstract Data Type: unsigned8
        
        Data Type Semantics: identifier<a href="#section-6.1-4" class="pilcrow">¶</a></p>
</section>
<section id="section-6.2">
        <h3 id="name-forwarding-exception-codes">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-forwarding-exception-codes" class="section-name selfRef">Forwarding Exception Codes</a>
        </h3>
<p id="section-6.2-1">
        This document requests addition of a new registry for Forwarding Exception Codes.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<span id="name-table-3-exception-codes-2"></span><figure id="figure-7">
          <div class="artwork art-text alignCenter" id="section-6.2-2.1">
<pre>
+----------------+--------------------------------------------------+
| Forwarding     |           Reason                                 |
| Exception Code |                                                  |
+----------------+--------------------------------------------------+
|       1        | FIREWALL_DISCARD                                 |
|       2        | TTL_EXPIRY                                       |
|       3        | DISCARD_ROUTE                                    |
|       4        | BAD_IPV4_CHECKSUM                                |
|       5        | REJECT_ROUTE                                     |
|       6        | BAD_IPV4_HEADER (Version incorrect or IHL &lt; 5)|
|       7        | BAD_IPV6_HEADER (Version incorrect)              |
|       8        | BAD_IPV4_HEADER_LENGTH (V4 frame is too short)   |
|       9        | BAD_IPV6_HEADER_LENGTH                           |
|       10       | BAD_IPV6_OPTIONS_PACKET(too many option headers) |
|       ..       | ..                                               |
+----------------+--------------------------------------------------+
</pre>
</div>
<figcaption><a href="#figure-7" class="selfRef">Figure 7</a>:
<a href="#name-table-3-exception-codes-2" class="selfRef">Table 3: Exception Codes</a>
          </figcaption></figure>
<p id="section-6.2-3">
      All assignments in this registry are to be performed via Expert Review.<a href="#section-6.2-3" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="sec-con">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">
      Security Considerations listed in detail for IPFIX in <span>[<a href="#RFC7011" class="xref">RFC7011</a>]</span> apply to 
      this document as well. As described in <span>[<a href="#RFC7011" class="xref">RFC7011</a>]</span>, the IPFIX messages 
      exchanged between network device and collector MUST be protected to
      provide confidentiality, integrity, and authenticity.
      Without those characteristics, the messages are subject to various
      kinds of attacks.  These attacks are described in great detail in
      <span>[<a href="#RFC7011" class="xref">RFC7011</a>]</span>.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-8">
      <h2 id="name-contributors">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-contributors" class="section-name selfRef">Contributors</a>
      </h2>
<div class="artwork art-text alignLeft" id="section-8-1">
<pre>
  Manikandan Musuvathi Poornachary
  Juniper Networks, Inc.
  Electra Exora Business Park~Marathahalli-Sarjapur Outer Ring Road,
  Bangalore, KA - 560103
  India
  Email: mpoornachary@juniper.net
</pre><a href="#section-8-1" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-8-2">
<pre>
  Vishnu Pavan Beeram
  Juniper Networks, Inc.
  1133 Innovation Way
  Sunnyvale, CA  94089
  USA
  Email: vbeeram@juniper.net
</pre><a href="#section-8-2" class="pilcrow">¶</a>
</div>
<div class="artwork art-text alignLeft" id="section-8-3">
<pre>
  Raveendra Torvi
  Juniper Networks, Inc.
  10 Technology Park Dr
  Westford, MA  01886
  USA
  Email: rtorvi@juniper.net
</pre><a href="#section-8-3" class="pilcrow">¶</a>
</div>
</section>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5475">[RFC5475]</dt>
        <dd>
<span class="refAuthor">Zseby, T.</span>, <span class="refAuthor">Molina, M.</span>, <span class="refAuthor">Duffield, N.</span>, <span class="refAuthor">Niccolini, S.</span>, and <span class="refAuthor">F. Raspall</span>, <span class="refTitle">"Sampling and Filtering Techniques for IP Packet Selection"</span>, <span class="seriesInfo">RFC 5475</span>, <span class="seriesInfo">DOI 10.17487/RFC5475</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5475">https://www.rfc-editor.org/info/rfc5475</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7011">[RFC7011]</dt>
        <dd>
<span class="refAuthor">Claise, B., Ed.</span>, <span class="refAuthor">Trammell, B., Ed.</span>, and <span class="refAuthor">P. Aitken</span>, <span class="refTitle">"Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of Flow Information"</span>, <span class="seriesInfo">STD 77</span>, <span class="seriesInfo">RFC 7011</span>, <span class="seriesInfo">DOI 10.17487/RFC7011</span>, <time datetime="2013-09" class="refDate">September 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7011">https://www.rfc-editor.org/info/rfc7011</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
      <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8174">https://www.rfc-editor.org/info/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="IANA-IPFIX">[IANA-IPFIX]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"IP Flow Information Export (IPFIX) Entities"</span>, <span>&lt;<a href="https://www.iana.org/assignments/ipfix">https://www.iana.org/assignments/ipfix</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5470">[RFC5470]</dt>
      <dd>
<span class="refAuthor">Sadasivan, G.</span>, <span class="refAuthor">Brownlee, N.</span>, <span class="refAuthor">Claise, B.</span>, and <span class="refAuthor">J. Quittek</span>, <span class="refTitle">"Architecture for IP Flow Information Export"</span>, <span class="seriesInfo">RFC 5470</span>, <span class="seriesInfo">DOI 10.17487/RFC5470</span>, <time datetime="2009-03" class="refDate">March 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5470">https://www.rfc-editor.org/info/rfc5470</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Venkata Naga Chaitanya Munukutla</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">10 Technology Park Dr</span></div>
<div dir="auto" class="left">
<span class="locality">Westford</span>, <span class="region">MA</span> <span class="postal-code">01886</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:vmunuku@juniper.net" class="email">vmunuku@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shivam Vaid</span></div>
<div dir="auto" class="left"><span class="org">Juniper Networks, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">Electra, Exora Business Park- Marathahalli-Sarjapur Outer Ring Road</span></div>
<div dir="auto" class="left">
<span class="locality">Bangalore</span> <span class="postal-code">560103</span>
</div>
<div dir="auto" class="left"><span class="region">Karnataka</span></div>
<div dir="auto" class="left"><span class="country-name">India</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shivamv@juniper.net" class="email">shivamv@juniper.net</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Aditya Mahale</span></div>
<div dir="auto" class="left"><span class="org">Google, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div dir="auto" class="left">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:amahale@google.com" class="email">amahale@google.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Devang Patel</span></div>
<div dir="auto" class="left"><span class="org">Google, Inc.</span></div>
<div dir="auto" class="left"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div dir="auto" class="left">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:pateldevang@google.com" class="email">pateldevang@google.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
