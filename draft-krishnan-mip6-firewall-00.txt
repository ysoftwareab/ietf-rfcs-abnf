


Network Working Group                                        S. Krishnan
Internet-Draft                                                  Ericsson
Intended status: Informational                             June 28, 2007
Expires: December 30, 2007


                   Firewall Recommendations for MIPv6
                    draft-krishnan-mip6-firewall-00

Status of this Memo

   By submitting this Internet-Draft, each author represents that any
   applicable patent or other IPR claims of which he or she is aware
   have been or will be disclosed, and any of which he or she becomes
   aware will be disclosed, in accordance with Section 6 of BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on December 30, 2007.

Copyright Notice

   Copyright (C) The IETF Trust (2007).














Krishnan                Expires December 30, 2007               [Page 1]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


Abstract

   This document presents some recommendations for firewall
   administrators to help them configure their firewalls in a way that
   allows Mobile IPv6 signaling and data messags to pass through.  This
   document assumes that the firewalls in question include some kind of
   stateful packet filtering capability.

Table of Contents

   1.  Requirements notation  . . . . . . . . . . . . . . . . . . . .  3
   2.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  4
   3.  Home Agent behind a firewall . . . . . . . . . . . . . . . . .  5
     3.1.  Signaling between the MN and the HA  . . . . . . . . . . .  5
     3.2.  Route optimization signaling between MN and CN through
           HA . . . . . . . . . . . . . . . . . . . . . . . . . . . .  5
     3.3.  IKEv2 signaling between MN and HA for establishing SAs . .  6
     3.4.  Data traffic from and to MN passing through the HA . . . .  6
   4.  Contributors . . . . . . . . . . . . . . . . . . . . . . . . .  7
   5.  Security Considerations  . . . . . . . . . . . . . . . . . . .  8
   6.  Normative References . . . . . . . . . . . . . . . . . . . . .  9
   Author's Address . . . . . . . . . . . . . . . . . . . . . . . . . 10
   Intellectual Property and Copyright Statements . . . . . . . . . . 11































Krishnan                Expires December 30, 2007               [Page 2]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


1.  Requirements notation

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in [RFC2119].














































Krishnan                Expires December 30, 2007               [Page 3]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


2.  Introduction

   Network elements such as firewalls are an integral aspect of a
   majority of IP networks today, given the state of security in the
   Internet, threats, and vulnerabilities to data networks.  MIPv6
   [RFC3775] defines mobility support for IPv6 nodes.  Since firewalls
   are not aware of MIPv6 protocol details, they will probably interfere
   with the smooth operation of the protocol.  The problems caused by
   firewalls to Mobile IPv6 are documented in [RFC4487]

   This document presents some recommendations for firewall
   administrators to help them configure their firewalls in a way that
   allows Mobile IPv6 signaling and data messags to pass through.  This
   document assumes that the firewalls in question include some kind of
   stateful packet filtering capability.




































Krishnan                Expires December 30, 2007               [Page 4]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


3.  Home Agent behind a firewall

   This section presents the recommendations for configuring a firewall
   that is protects a home agent.  For each type of traffic that needs
   to pass through this firewall, recommendations are presented on how
   to identify that traffic.  The following types of traffic are
   considered

   o  Signaling between the MN and the HA

   o  Route optimization signaling between MN and CN through HA

   o  IKEv2 signaling between MN and HA for establishing SAs

   o  Data traffic from and to MN passing through the HA

3.1.  Signaling between the MN and the HA

   The signaling between the MN and HA is protected using IPSec ESP.
   These messages are encrypted and hence are not inspectable by
   firewalls.  So the firewall either has to either permit all these
   messages or discard all of them.  But if these messages are
   discarded, Mobile IPv6 as specified today will cease to work.  In
   order to permit these messages through, the firewall has to detect
   the messages using the following pattern.

     Destination Address: Address of HA
     IP payload protocol number: 50 (ESP)

   This pattern will allow the BU messages from MNs to HA and BA
   messages from the HA to the MNs to pass through.  It will also allow
   the HoTI and HoT messages (related to route optimization) between the
   MN and the HA to pass through.

3.2.  Route optimization signaling between MN and CN through HA

   Route Optimization allows direct communication of data packets
   between the MN and a CN without tunneling it back through the HA.  In
   order for route optimization to work, part of the initial signaling
   has to pass through the HA.  The following pattern will allow these
   messages to pass through.

     Destination Address: HoA of MN
     Mobility Header Type: 3

   This pattern allows the HoT message from the CN to the MN's HoA to
   pass through the firewall.  The HoTI message from the MN to the CN
   through the HA usually passes through the firewall without any



Krishnan                Expires December 30, 2007               [Page 5]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


   problems.  Hence no specific pattern is recommended.

3.3.  IKEv2 signaling between MN and HA for establishing SAs

   The MN and HA exchange IKEv2 signaling in order to establish the
   security associations.  The security associations so established will
   later be used for securing the mobility signaling messages.  Hence
   these messages need to be permitted to pass through the firewalls.
   The following pattern will detect these messages.

     Destination Address: Address of HA
     Transport Protocol: UDP
     Destination UDP Port: 500


3.4.  Data traffic from and to MN passing through the HA

   If a CN tries to initiate traffic to an MN, a stateful firewall would
   prevent these connection requests to pass through as there is no
   established state on the firewall.  Since MNs do not usually provide
   services, this is not usually a problem.  But if this is necessary to
   do, the pattern to look for is

     Destination Address: MN HoA

   Allowing this traffic might allow any kind of traffic, including
   malicious traffic, to pass through unfiltered to the MN.  This might
   cause a Denial of Service at the MN.























Krishnan                Expires December 30, 2007               [Page 6]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


4.  Contributors

   This document is one of the deliverables of the MIPv6 firewall
   design.  The following members of the team were involved in the
   creation of this document.

   Hannes Tschofenig Hannes.Tschofenig@gmx.net

   Gabor Bajko Gabor.Bajko@nokia.com

   Suresh Krishnan suresh.krishnan@ericsson.com

   Hesham Soliman solimanhs@gmail.com

   Yaron Sheffer yaronf@checkpoint.com

   Qiu Ying qiuying@i2r.a-star.edu.sg

   Ram Vishnu vishnu@motorola.com

   Niklas Steinleitner steinleitner@cs.uni-goettingen.de

   Vijay Devarapalli vijay.devarapalli@AzaireNet.com




























Krishnan                Expires December 30, 2007               [Page 7]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


5.  Security Considerations

   This document specifies recommendations for firewall administrators
   to allow Mobile IPv6 traffic to pass through unhindered.  Since some
   of this traffic is encrypted it is not possible for firewalls to
   discern whether it is safe or not.  This document recommends a
   liberal setting so that all legitimate traffic can pass.  This means
   that some malicious traffic may be permitted by these rules.  These
   rules may allow the initiation of Denial of Service attacks against
   Mobile IPv6 capable nodes such as a home agent.









































Krishnan                Expires December 30, 2007               [Page 8]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


6.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC3775]  Johnson, D., Perkins, C., and J. Arkko, "Mobility Support
              in IPv6", RFC 3775, June 2004.

   [RFC4487]  Le, F., Faccin, S., Patil, B., and H. Tschofenig, "Mobile
              IPv6 and Firewalls: Problem Statement", RFC 4487,
              May 2006.








































Krishnan                Expires December 30, 2007               [Page 9]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


Author's Address

   Suresh Krishnan
   Ericsson
   8400 Decarie Blvd.
   Town of Mount Royal, QC
   Canada

   Phone: +1 514 345 7900 x42871
   Email: suresh.krishnan@ericsson.com









































Krishnan                Expires December 30, 2007              [Page 10]

Internet-Draft             MIPv6 Firewall BCP                  June 2007


Full Copyright Statement

   Copyright (C) The IETF Trust (2007).

   This document is subject to the rights, licenses and restrictions
   contained in BCP 78, and except as set forth therein, the authors
   retain all their rights.

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST AND
   THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS
   OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
   THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Intellectual Property

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Acknowledgment

   Funding for the RFC Editor function is provided by the IETF
   Administrative Support Activity (IASA).





Krishnan                Expires December 30, 2007              [Page 11]

