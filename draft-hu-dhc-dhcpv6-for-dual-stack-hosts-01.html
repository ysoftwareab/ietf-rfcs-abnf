<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>DHCPV6 for dual-stack hosts</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Conventions used in this document">
<link href="#rfc.section.2.1" rel="Chapter" title="2.1 Abbreviations">
<link href="#rfc.section.2.2" rel="Chapter" title="2.2 Definitions and Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Scenario and Network architecture">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 Get all ip settings using dhcpv6 protocol">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Get ipv4 settings via protocol translation">
<link href="#rfc.section.4" rel="Chapter" title="4 Host's implementation and behavior">
<link href="#rfc.section.4.1" rel="Chapter" title="4.1 Tyep 1 dual stack host">
<link href="#rfc.section.4.2" rel="Chapter" title="4.2 Tyep 2 dual stack host">
<link href="#rfc.section.4.3" rel="Chapter" title="4.3 Tyep 3 dual stack host">
<link href="#rfc.section.5" rel="Chapter" title="5 Server's implementation and behavior">
<link href="#rfc.section.6" rel="Chapter" title="6 Network's behavior">
<link href="#rfc.section.7" rel="Chapter" title="7 General Considerations and protocol translation">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 New DHCPv6 Options for IPv4 Parameters">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 Protocol translation">
<link href="#rfc.section.8" rel="Chapter" title="8 Other Considerations">
<link href="#rfc.section.8.1" rel="Chapter" title="8.1 Options for location identifing">
<link href="#rfc.section.9" rel="Chapter" title="9 IANA Considerations">
<link href="#rfc.section.10" rel="Chapter" title="10 Security Considerations">
<link href="#rfc.section.11" rel="Chapter" title="11 Acknowledgement">
<link href="#rfc.references" rel="Chapter" title="12 References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="A dual-stack host may wish to obtain IPv4 and/or IPv6 configuration settings via the Dynamic Host Configuration Protocol (DHCP).Network operators deploy seperate DHCPv4 servers and DHCPv6 servers,hosts get IPv4 parameters via DHCPv4 servers and IPv6 parameters via DHCPv6 servers. This document describes a solution,there is only a single intergrated DHCPv6 server deployed in the ISP network,hosts obtain both IPv4 and IPv6 configuration settings from this server." />
  <meta name="description" content="A dual-stack host may wish to obtain IPv4 and/or IPv6 configuration settings via the Dynamic Host Configuration Protocol (DHCP).Network operators deploy seperate DHCPv4 servers and DHCPv6 servers,hosts get IPv4 parameters via DHCPv4 servers and IPv6 parameters via DHCPv6 servers. This document describes a solution,there is only a single intergrated DHCPv6 server deployed in the ISP network,hosts obtain both IPv4 and IPv6 configuration settings from this server." />
  <meta name="keywords" content="Request for Comments, RFC, Internet Draft, I-D" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">DHC Working Group</td>
<td class="right">Y. Hu</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">ZTE Corporation</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Aug 11, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">DHCPV6 for dual-stack hosts<br />
  <span class="filename">draft-hu-dhc-dhcpv6-for-dual-stack-hosts-01</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>A dual-stack host may wish to obtain IPv4 and/or IPv6 configuration settings via the Dynamic Host Configuration Protocol (DHCP).Network operators deploy seperate DHCPv4 servers and DHCPv6 servers,hosts get IPv4 parameters via DHCPv4 servers and IPv6 parameters via DHCPv6 servers. This document describes a solution,there is only a single intergrated DHCPv6 server deployed in the ISP network,hosts obtain both IPv4 and IPv6 configuration settings from this server.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Conventions used in this document</a>
</li>
<li>2.1.   <a href="#rfc.section.2.1">Abbreviations</a>
</li>
<li>2.2.   <a href="#rfc.section.2.2">Definitions and Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Scenario and Network architecture</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">Get all ip settings using dhcpv6 protocol</a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Get ipv4 settings via protocol translation</a>
</li>
<li>4.   <a href="#rfc.section.4">Host's implementation and behavior</a>
</li>
<li>4.1.   <a href="#rfc.section.4.1">Tyep 1 dual stack host</a>
</li>
<li>4.2.   <a href="#rfc.section.4.2">Tyep 2 dual stack host</a>
</li>
<li>4.3.   <a href="#rfc.section.4.3">Tyep 3 dual stack host</a>
</li>
<li>5.   <a href="#rfc.section.5">Server's implementation and behavior</a>
</li>
<li>6.   <a href="#rfc.section.6">Network's behavior</a>
</li>
<li>7.   <a href="#rfc.section.7">General Considerations and protocol translation</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">New DHCPv6 Options for IPv4 Parameters</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">Protocol translation</a>
</li>
<li>8.   <a href="#rfc.section.8">Other Considerations</a>
</li>
<li>8.1.   <a href="#rfc.section.8.1">Options for location identifing</a>
</li>
<li>9.   <a href="#rfc.section.9">IANA Considerations</a>
</li>
<li>10.   <a href="#rfc.section.10">Security Considerations</a>
</li>
<li>11.   <a href="#rfc.section.11">Acknowledgement</a>
</li>
<li>12.   <a href="#rfc.references">References</a>
</li>
<li><a href="#rfc.authors">Author's Address</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">RFC4477 describes issues identified with dual IP version DHCP interactions and also promotes potential solutions to solve these issues.There are mainly two solutions:1/ seperate DHCP servers for IPv6 and IPv4; 2/ a single DHCPv6 server for both IPv6 and IPv4. The second solution may be to modify DHCPv6 to be able to return IPv4 information.This solution is hinted in the DHCPv6 specification<a href="#RFC3315">[RFC3315]</a>:"If there is sufficient interest and demand,integration can be specified in a document that extends DHCPv6 to carry IPv4 addresses and configuration information." This solution may allow DHCP for IPv4 to be completely replaced by DHCPv6 with additional IPv4 information options, for dual-stack nodes.</p>
<p id="rfc.section.1.p.2">This solution would avoid redundancy and simplify management for servers. But as RFC4477 described,there are also a number of potential problems with this approach,the most important problem is:the IPv4 only nodes would not have any DHCP service available to them,DHCPv4 servers need to be configured anyway to support IPv4-only hosts.This problem also exists for the dual-stack hosts which can't obtain IPv4 information using DHCPv6,because the DHCPv6 client software on these hosts has not been modified and updated.</p>
<p id="rfc.section.1.p.3">This document will develop the solution in details,deploying single DHCPv6 sever which can serve for both IPv6/IPv4 hosts or dual-stack hosts. The considered aspect of the solution include: host's implementation and behave/sever's implementation and behave/network's behave.</p>
<p id="rfc.section.1.p.4">In this document, we focus on the specific solution for operating DHCP in a mixed (typically dual-stack) IPv4 and IPv6 environment within a single administrative domain.</p>
<p id="rfc.section.1.p.5">The Chair said that they had discussed this solution years ago,but pretty much rejected it because it would add a lot of complexity and the functionality is only useful during the transitional period when hosts are running dual-stack. But the transitional period will last a very long time,maybe ten or more years. So&#163;&#172;we should consider this solution again.</p>
<p id="rfc.section.1.p.6">Actully,DHCPv6 is better designed than DHCPv4,it has many good machnism that DHCPv4 hasn't.For example, the Relay Agent Encapsulation Machnism discussed in draft-ietf-dhc-dhcpv4-relay-encapsulation-01. </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Conventions used in this document</h1>
<p id="rfc.section.2.p.1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in RFC2119.</p>
<h1 id="rfc.section.2.1">
<a href="#rfc.section.2.1">2.1.</a> Abbreviations</h1>
<p id="rfc.section.2.1.p.1">DHCP:   Dynamic Host Configuration Protocol</p>
<p id="rfc.section.2.1.p.2">DHCPv4: Dynamic Host Configuration Protocol for IPv4</p>
<p id="rfc.section.2.1.p.3">DHCPv6: Dynamic Host Configuration Protocol for IPv6</p>
<p id="rfc.section.2.1.p.4">CPE:    Customer Premises Equipment</p>
<p id="rfc.section.2.1.p.5">BRAS:   Broadband Remote Access Server</p>
<h1 id="rfc.section.2.2">
<a href="#rfc.section.2.2">2.2.</a> Definitions and Terminology</h1>
<p></p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> Scenario and Network architecture</h1>
<p id="rfc.section.3.p.1">This section will describe two typical scenarioes.</p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> Get all ip settings using dhcpv6 protocol</h1>
<div id="#rfc.figure.1"></div>
<div id="#Figure 1"></div>
<pre>
    
             +------+------+
             |    DHCPv6   |  A single DHCPv6 Server which maintains both 
             |    Server   |  IPv4 and IPv6 setting for endusers(hosts).
             +------+--/\--+       
           _________|__||_______
          /            ||       \
         |  ISP Core Network     |
          \____________||_______/
                    |  ||
                    |  ||
             +------+--\/--+
             |  BRAS(PE)   |  A BRAS or Provider Edge Router.
             |             |  User management/DHCPv6 relay agent
             +------+--/\--+
                    |  ||   
           _________|__\/_____
          /                   \
         |   Access Network    |
          \____________/\_____/
                    |  ||
                    |  ||
             +------+--\/--+  
             |     CPE     |  
             +------+--/\--+     /Dual-stack host obtain IPv4/IPv6 settings
                    |  || ------| by sending a DHCPv6 request msg,and         
               _____|__\/__     | would receive a DHCPv6 reply msg 
              | dual-stack |    | containing the parameters 
              |    host    |     \which are requested.
              |____________|
  
    
  </pre>
<p id="rfc.section.3.1.p.1">In the isp network, a DHCPv6 server would be deployed to config both IPv4 and IPv6 parameters for hosts. Dual-stack host can certainly obtain IPv6 settings using DHCPv6 protocol.If it wish to obtain IPv4 settings,it send a DHCPv6 request message containning the new options designed for IPv4,and the server also return a DHCPv6 reply message containing the parameters which are requested.</p>
<p id="rfc.section.3.1.p.2">In this scenario,the dhcpv6 client software must be modified and updated to support that.</p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Get ipv4 settings via protocol translation</h1>
<div id="#rfc.figure.2"></div>
<div id="#Figure 2"></div>
<pre>
    
             +------+------+
             |    DHCPv6   |  A single DHCPv6 Server which maintains both 
             |    Server   |  IPv4 and IPv6 setting for endusers(hosts).
             +------+--/\--+  Can only process DHCPv6 messages.     
           _________|__||_______
          /            ||       \
         |  ISP Core Network     |
          \____________||_______/
                    |  ||
                    |  ||                     /
             +------+--\/--+    ________     |The DHCPv4 msg send by host should be
             |  BRAS(PE)   |            |    |translated to DHCPv6 msg and send to
             |             |            |    |Server.  
             +------+--/\--+            |    |Also,the DHCPv6 msg replied by Server
                    |  ||               |----|should be translated to DHCPv4 msg and
           _________|__\/_____          |    |returned to host.
          /                   \         |    | 
         |   Access Network    |        |    |The point to do translation may be 
          \____________/\_____/         |    |CPE,Access Node or BRAS.In this figure,
                    |  ||               |     \the msg be translated in CPE.
                    |  ||               |
             +------+--\/--+    ________|
             |     CPE     |  
             +------+--/ \-+       / Dual-stack host can not send a DHCPv6   
                    |  ||| -------|  request msg to obtain IPv4 settings.        
               _____|__\ /_       |  It is the old type,can only send and 
              | dual-stack |       \ receive DHCPv4 msgs to config IPv4 parameters
              |    host    |
              |____________|

    
  </pre>
<p id="rfc.section.3.2.p.1">In this scenario,the DHCPv6 client software on the host has not been modified and updated,the hosts can only send and receive DHCPv4 messages to config IPv4 parameters. But the server is DHCPv6 only,can only process DHCPv6 messages,so the DHCPv4 message send by host should be translated to DHCPv6 message in somewhere and then send to server.Also, the DHCPv6 message replied by Server should be translated to DHCPv4 message and then returned to host. The translation point may be CPE,Access Node or BRAS.</p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Host's implementation and behavior</h1>
<p id="rfc.section.4.p.1">There would be 3 types of dual stack hosts:</p>
<p id="rfc.section.4.p.2">Type 1:old type dual stack, having DHCPv4 client and DHCPv6 client,the DHCPv6 client was not modified.</p>
<p id="rfc.section.4.p.3">Type 2:new type dual stack, having DHCPv4 client and DHCPv6 client,the DHCPv6 client has been modified and updated.</p>
<p id="rfc.section.4.p.4">Type 3:DHCPv6 only client.</p>
<h1 id="rfc.section.4.1">
<a href="#rfc.section.4.1">4.1.</a> Tyep 1 dual stack host</h1>
<div id="#rfc.figure.3"></div>
<div id="#Figure 3"></div>
<pre>
    
             +------+------+  +------+------+
             |    DHCPv6   |  |    DHCPv4   |
             |    Client   |  |    Client   |
             +------+------+  +------+------+     
                    |                |
             +------+------+  +------+------+
             |    IPv6     |  |    IPv4     |
             |    Stack    |  |    Stack    |
             +------+------+  +------+------+
                    |                |
             +------+----------------+------+  
             |          Link Layer          |  
             +------+----------------+------+       
  
    
  </pre>
<p id="rfc.section.4.1.p.1">Hosts of this type have not modified the DHCPv6 client software,so they can not obtain IPv4 settings using DHCPv6 protocol&#163;&#172;they can only use DHCPv4 protocol to get IPv4 parameters.</p>
<h1 id="rfc.section.4.2">
<a href="#rfc.section.4.2">4.2.</a> Tyep 2 dual stack host</h1>
<div id="#rfc.figure.4"></div>
<div id="#Figure 4"></div>
<pre>
    
             +---------+-----------+  +----+---+
             |       DHCPv6        |  | DHCPv4 |
             |       Client        |  | Client |
             +-----+------------+--+  +----+---+     
                   +            +          +
             +-----+-------+  +-+----------+---+
             |    IPv6     |  |       IPv4     |
             |    Stack    |  |       Stack    |
             +------+------+  +-------+--------+
                    |                 |
             +------+-----------------+--------+  
             |           Link Layer            |  
             +------+-----------------+--------+       
  
    
  </pre>
<p id="rfc.section.4.2.p.1">Hosts of type 2 can certainly get IPv4/IPv6 settings using DHCPv4/DHCPv6 client,they can also use DHCPv6 client to get IPv4 settings.</p>
<h1 id="rfc.section.4.3">
<a href="#rfc.section.4.3">4.3.</a> Tyep 3 dual stack host</h1>
<div id="#rfc.figure.5"></div>
<div id="#Figure 5"></div>
<pre>
    
             +------+----------------+------+
             |            DHCPv6            |
             |            Client            |
             +------+----------------+------+     
                    |                |
             +------+------+  +------+------+
             |    IPv6     |  |    IPv4     |
             |    Stack    |  |    Stack    |
             +------+------+  +------+------+
                    |                |
             +------+----------------+------+  
             |          Link Layer          |  
             +------+----------------+------+       
  
    
  </pre>
<p id="rfc.section.4.3.p.1">Hosts of type 3 have only DHCPv6 client, they obtain both IPv6 settings and IPv4 settings using the DHCPv6 only client.But this type is the future type, we will mainly disscuss the type 1 and type 2.</p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Server's implementation and behavior</h1>
<div id="#rfc.figure.6"></div>
<div id="#Figure 6"></div>
<pre>
    
             +---------------+  +----------------+
             | IPv6 settings |  | IPv4 settings  |               
             |  -----------  |  |  ------------  |
             | |IPv6 prefix| |  | |IPv4 Address| |
             |  -----------  |  |  ------------  |
             |  -----------  |  |  -----------   |
             | |    DNS    | |  | |    DNS    |  |
             |  -----------  |  |  -----------   |
             |     ...       |  |       ...      |
             |               |  |                |
             +------+--------+  +--------+-------+     
                    |                    |
                    |                    |
             +-----------------------------------+
             |  --------------   --------------  |
             | |IPv6 Related  | | IPv4 Related | |
             | |   Strategy   | |   Strategy   | |
             |  --------------   --------------  |
             |       Strategy Management         |
             +-----------------------------------+
                    |                    |
             +------+--------------------+-------+  
             | GENERAL DHCPv6 MESSAGE PROCESS    |
             |                                   |
             +------+--------------------+-------+       
  
    
  </pre>
<p id="rfc.section.5.p.1">The servers are DHCPv6 only,they can only process DHCPv6 messages,so a general DHCPv6 message process modual must be implemented.</p>
<p id="rfc.section.5.p.2">The servers must maintain both ipv6 and ipv4 settings for hosts,these settings may be:IPv6 prefixs which would be designated or allocated,IPv4 address pool,information about DNS, and so on.</p>
<p id="rfc.section.5.p.3">A Strategy Management Modual should be implemented to decide how to designate or allocate IP settings for hosts.There would be seperate strategy for IPv6 or IPv4,and also common strategy for both IPv6 and IPv4.</p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Network's behavior</h1>
<p id="rfc.section.6.p.1">If an ISP has deployed a DHCPv6 server in it's network,which would serve for dual stack hosts,and the hosts can be divided into Type 1 and Type 2.</p>
<p id="rfc.section.6.p.2">Hosts of Type 1 would send DHCPv6 messages to request IPv6 parameters and send DHCPv4 messages to request IPv4 parameters,if the CPE in home network can't translate the DHCPv4 messages to DHCPv6 ones,the messages must be translated in the ISP network, may be in Access Node or BRAS.</p>
<p id="rfc.section.6.p.3">Consider a host of Type 2,how dose it know to request IPv4 settings using DHCPv4 or DHCPv6? There are two possible solutions:1/the strategy been manually configured in host; 2/a mechanism for the ISP network to notify the host,like the mechanism using the M bit and O bit in RA message(RFC2461 section4.2).</p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> General Considerations and protocol translation</h1>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> New DHCPv6 Options for IPv4 Parameters</h1>
<p id="rfc.section.7.1.p.1">In RFC3315 and other RFCs related to DHCPv6,many options have been defined to carry IPv6 information and parameters,	but there are no DHCPv6 options been defined to carry IPv4 settings,so new DHCPv6 options need be defined to carry IPv4 information such as IPv4 address.</p>
<p id="rfc.section.7.1.p.2">The new options will be defined in other document.</p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> Protocol translation</h1>
<p id="rfc.section.7.2.p.1">In Figure 2, the protocol translation was executed in CPE, in this section,we will disccuss the scenario where BRAS do the protocol translation.</p>
<div id="#rfc.figure.7"></div>
<div id="#Figure 7"></div>
<pre>
    
             +------+------+
             |    DHCPv6   |   
             |    Server   |  
             +------+--/\--+       
           _________|__||_______
          /            ||       \
         |  ISP Core Network     |
          \____________||_______/
                    |  ||
                    |  ||------DHCPv6 message                    
             +------+--\/--+         
             |  BRAS(PE)   |            
             |             |  ------Protocol translation           
             +------+--/ \-+            
                    |  |||------DHCPv4 message              
           _________|__\ /____          
          /                   \        
         |   Access Network    |         
          \____________/ \____/         
                    |  |||------DHCPv4 message              
                    |  |||               
             +------+--\ /-+    
             |     CPE     |  
             +------+--/ \-+       
                    |  |||------DHCPv4 message        
               _____|__\ /_       
              | dual-stack |      
              |    host    |      
              |____________|
    
  </pre>
<p id="rfc.section.7.2.p.2">The DHCPv4 messages send by hosts arrive at the BRAS device,then BRAS translates the DHCPv4 messages to DHCPv6 correspondent ones and send to the DHCPv6 server. </p>
<p id="rfc.section.7.2.p.3">The translation can also be executed in Access Node.</p>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> Other Considerations</h1>
<h1 id="rfc.section.8.1">
<a href="#rfc.section.8.1">8.1.</a> Options for location identifing</h1>
<p id="rfc.section.8.1.p.1">There are DHCP options defined to identify the remote connection of the circuit or used as a host identifier;these options are defined seperately for DHCPv6 and DHCPv4.For example:RFC3046 defined DHCPv4 option 82(Relay Agent Imformation Option) and 2 suboptions(Agent Circuit ID Sub-option/Agent Remote ID Sub-option),RFC3993 defined a sub-option of option82(Subscriber-ID Suboption),while RFC4649 defined DHCPv6 option 37(Relay Agent Remote-ID Option) and RFC4580 defined DHCPv6 option 38(Relay Agent Subscriber-ID Option).</p>
<p id="rfc.section.8.1.p.2">These options are added by the DHCP relay agent and may be processed by DHCP server.When the DHCP protocol translation be executed, these options should be processed carefully.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> IANA Considerations</h1>
<p id="rfc.section.9.p.1">TBD.</p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Security Considerations</h1>
<p id="rfc.section.10.p.1">TBD.</p>
<h1 id="rfc.section.11">
<a href="#rfc.section.11">11.</a> Acknowledgement</h1>
<p id="rfc.section.11.p.1">Thanks for the authors of RFC4477.</p>
<h1 id="rfc.references">
<a href="#rfc.references">12.</a> References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC3046">[RFC3046]</b></td>
<td class="top">
<a>Patrick, M.</a>, "<a href="http://tools.ietf.org/html/rfc3046">DHCP Relay Agent Information Option</a>", RFC 3046, January 2001.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3315">[RFC3315]</b></td>
<td class="top">
<a>Droms, R.</a>, <a>Bound, J.</a>, <a>Volz, B.</a>, <a>Lemon, T.</a>, <a>Perkins, C.</a> and <a>M. Carney</a>, "<a href="http://tools.ietf.org/html/rfc3315">Dynamic Host Configuration Protocol for IPv6 (DHCPv6)</a>", RFC 3315, July 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3993">[RFC3993]</b></td>
<td class="top">
<a>Johnson, R.</a>, <a>Palaniappan, T.</a> and <a>M. Stapp</a>, "<a href="http://tools.ietf.org/html/rfc3993">Subscriber-ID Suboption for the Dynamic Host Configuration Protocol (DHCP) Relay Agent Option</a>", RFC 3993, March 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4477">[RFC4477]</b></td>
<td class="top">
<a>Chown, T.</a>, <a>Venaas, S.</a> and <a>C. Strauf</a>, "<a href="http://tools.ietf.org/html/rfc4477">Dynamic Host Configuration Protocol (DHCP): IPv4 and IPv6 Dual-Stack Issues</a>", RFC 4477, May 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4649">[RFC4649]</b></td>
<td class="top">
<a>Volz, B.</a>, "<a href="http://tools.ietf.org/html/rfc4649">Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Relay Agent Remote-ID Option</a>", RFC 4649, August 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4580">[RFC4580]</b></td>
<td class="top">
<a>Volz, B.</a>, "<a href="http://tools.ietf.org/html/rfc4580">Dynamic Host Configuration Protocol for IPv6 (DHCPv6) Relay Agent Subscriber-ID Option</a>", RFC 4580, June 2006.</td>
</tr>
</tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Author's Address</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Yuxing Hu</span> 
	  <span class="n hidden">
		<span class="family-name">Hu</span>
	  </span>
	</span>
	<span class="org vcardline">ZTE Corporation</span>
	<span class="adr">
	  <span>4F,RD Building 2,Zijinghua Road</span>

	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region">Yuhuatai District,Nanjing 210012</span> 
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline">P.R.China</span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:hu.yuxing@zte.com.cn">hu.yuxing@zte.com.cn</a></span>

  </address>
</div>

</body>
</html>