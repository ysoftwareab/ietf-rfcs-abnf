<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Application Listener Discovery (ALD) for IPv6</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Application Listener Discovery (ALD) for IPv6">
<meta name="keywords" content="ALD, ICMP, IPv6">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">IP Version 6</td><td class="header">j h. woodyatt</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Apple</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">December 21, 2007</td></tr>
<tr><td class="header">Expires: June 23, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Application Listener Discovery (ALD) for IPv6<br />draft-woodyatt-ald-02</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on June 23, 2008.</p>

<h3>Abstract</h3>

<p>This document specifies the protocol used by IPv6 nodes comprising
	  stateful packet filters to discover the transport addresses of listening
	  applications (that is, application endpoints for which incoming traffic
	  may be administratively prohibited).
</p>
<p>Comments are solicited and should be sent to the author and the V6OPS
	  Residential CPE Design Team mailing list at
	  &lt;v6ops-residential-cpe-design-team@external.cisco.com&gt;.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#introduction">1.</a>&nbsp;
INTRODUCTION<br />
<a href="#terminology">2.</a>&nbsp;
TERMINOLOGY<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor1">2.1.</a>&nbsp;
Requirements Language<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">2.2.</a>&nbsp;
Special Terms and Abbreviations<br />
<a href="#overview">3.</a>&nbsp;
PROTOCOL OVERVIEW<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.</a>&nbsp;
Firewall Discovery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.2.</a>&nbsp;
Listener Discovery<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.3.</a>&nbsp;
Firewall Reset Detection<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.4.</a>&nbsp;
Application Programming Interface<br />
<a href="#options">4.</a>&nbsp;
OPTION FORMATS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ra_option">4.1.</a>&nbsp;
Firewall Discovery Router Advertisement Option<br />
<a href="#messages">5.</a>&nbsp;
MESSAGE FORMATS<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fw_solicit">5.1.</a>&nbsp;
Firewall Solicitation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#fw_advertise">5.2.</a>&nbsp;
Firewall Advertisement<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#l_addrspec">5.3.</a>&nbsp;
Listener Address Specifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.3.1.</a>&nbsp;
All Protocols Listener Address Specifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.3.2.</a>&nbsp;
All Specific Protocol Listener Address Specifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.3.3.</a>&nbsp;
Encapsulating Security Payload Listener Address
		  Specifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.3.4.</a>&nbsp;
TCP Listener Address Specifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.3.5.</a>&nbsp;
UDP Listener Address Specifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.3.6.</a>&nbsp;
SCTP Listener Address Specifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.3.7.</a>&nbsp;
DCCP Listener Address Specifier<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#l_ntf">5.4.</a>&nbsp;
Listener Notification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#l_ack">5.5.</a>&nbsp;
Listener Acknowledgment<br />
<a href="#api">6.</a>&nbsp;
APPLICATION PROGRAMMING INTERFACE<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">6.1.</a>&nbsp;
Normal Behavior of IPv6 Sockets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">6.2.</a>&nbsp;
Extensions to BSD Socket Interface<br />
<a href="#IANA">7.</a>&nbsp;
IANA CONSIDERATIONS<br />
<a href="#Security">8.</a>&nbsp;
SECURITY CONSIDERATIONS<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#changelog">Appendix&nbsp;A.</a>&nbsp;
Change Log<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">A.1.</a>&nbsp;
draft-woodyatt-ald-01 to draft-woodyatt-ald-02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">A.2.</a>&nbsp;
draft-woodyatt-ald-00 to draft-woodyatt-ald-01<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="introduction"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
INTRODUCTION</h3>

<p>In "Local Network Protection for IPv6" <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a>, IETF
	  recommends 'simple security' capabilities for residential and small
	  office gateways that prohibit, by default, all inbound traffic except
	  those packets returning as part of locally initiated outbound flows.  It
	  further recommends "an easy interface which allows users to create
	  inbound 'pinholes' for specific purposes such as online gaming."
</p>
<p>In existing IPv4 gateways, where Network Address Translation (NAT) is
	  commonly used for IPv4 network protection and firewalling, management
	  applications typically provide an interface for manual configuration of
	  pinholes.  However, this method is unacceptably difficult for many
	  non-technical Internet users, so most products in the market today also
	  implement one or more automatic methods for creating pinholes.
</p>
<p>These methods include:
	    </p>
<ul class="text">
<li>"NAT Port Mapping Protocol" <a class='info' href='#NAT-PMP'>[NAT&#8209;PMP]<span> (</span><span class='info'>Cheshire, S., Krochmal, M., and K. Sekar, &ldquo;NAT Port Mapping Protocol (NAT-PMP),&rdquo; November&nbsp;2001.</span><span>)</span></a>
</li>
<li>"Internet Gateway Device (IGD)" standardized device control
		  protocol of Universal Plug And Play <a class='info' href='#UPnP-IGD'>[UPnP&#8209;IGD]<span> (</span><span class='info'>UPnP Forum, &ldquo;Universal Plug and Play Internet Gateway Device Standardized 		  Gateway Device Protocol,&rdquo; September&nbsp;2006.</span><span>)</span></a>
</li>
</ul><p>
	  
</p>
<p>The basic mechanism of these protocols is that applications notify the
	  firewall of their expectation to receive inbound flows, and pinholes are
	  opened accordingly.  In the IPv4/NAT case, these protocols are also used
	  for automatic creation of network address translator state in addition to
	  packet filter state.  In the IPv6 case, no network address translation is
	  necessary, but packet filters still contain state and pinholes must still
	  be created accordingly.
</p>
<p>At present, no similar protocol exists for automatically notifying
	  firewalls of the pinholes required by IPv6 endpoint applications.  This
	  document defines a method for making such notifications.
</p>
<p>(NOTE: It is expected that this section will be revised once the
	  concept presented in this document is well socialized in the Internet
	  engineering and operations community.)
</p>
<a name="terminology"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
TERMINOLOGY</h3>

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in
		<a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>Paragraphs that begin with "EXPERIMENTAL:" describe how this
		protocol may be implemented using numbers assigned by IANA for
		experimental usage.  Prior to publication of this document as a
		Request For Comments, the RFC Editor is directed to delete all
		paragraphs that begin with this tag and all references to
		<a class='info' href='#RFC4727'>"Experimental Values in IPv4, IPv6, ICMPv4,
		ICMPv6, UDP, and TCP Headers"<span> (</span><span class='info'>Fenner, B., &ldquo;Experimental Values In IPv4, IPv6, ICMPv4, ICMPv6, UDP, and TCP Headers,&rdquo; November&nbsp;2006.</span><span>)</span></a> [RFC4727].
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Special Terms and Abbreviations</h3>

<p></p>
<blockquote class="text"><dl>
<dt>firewall:</dt>
<dd>A node with the capability of
		  administratively prohibiting the flow of packets between a protected
		  "interior" region of the Internet and an "exterior" region.
</dd>
<dt>flow initiation:</dt>
<dd>The start of communications between
		  two or more nodes in an application protocol, e.g. the TCP SYN
		  packets that comprise the start of a telnet session, the UDP packets
		  that start an NTP exchange, the first IPsec ESP packet for a new
		  security parameter index (SPI), et cetera.
</dd>
</dl></blockquote>

<a name="overview"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
PROTOCOL OVERVIEW</h3>

<p>This protocol solves a set of problems related to the interaction
	  between applications awaiting reception of transport flow initiations
	  (listeners) and IPv6 nodes comprising packet filtering network policy
	  enforcement points (firewalls).
</p>
<p>From the perspective of any given IPv6 node, the region of the
	  Internet between itself and a given firewall is the 'interior' domain
	  of that firewall.  All other regions of the Internet are the 'exterior'
	  from the perspective of the node.  The ALD protocol is concerned
	  only with the problems associated with listeners on nodes reachable only
	  on the interior interfaces of firewalls in receiving transport flow
	  initiations from nodes reachable only on exterior interfaces.
</p>
<p>The ALD protocol defines methods for solving each of the following
	  problems:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Listener Discovery:</dt>
<dd>How firewalls discover the transport
		protocols and addresses of applications awaiting reception of flow
		initiations.
</dd>
<dt>Firewall Discovery:</dt>
<dd>How nodes discover what firewalls to
		notify that applications are awaiting reception of transport flow
		initiations.
</dd>
<dt>Firewall Reset Detection:</dt>
<dd>How nodes discover that
		firewalls have been reset and now require nodes to restart their
		listener discovery functions.
</dd>
<dt>Application Programming Interface:</dt>
<dd>Extensions to the IPv6
		API are defined to permit applications to be selective about how their
		transport endpoints are subjects of listener notification.
</dd>
</dl></blockquote>

<p>When nodes join network segments where one or more global scope
	  address prefixes are advertised, they use a Firewall Discovery method
	  to build or learn a list of firewalls to notify that applications are
	  listening at specific unicast addresses.  They send Firewall Solicitation
	  messages to a specified destination address, which may be a multicast
	  destination, and receive directed Firewall Advertisement messages in
	  response.
</p>
<p>Nodes send Listener Notification messages to firewalls to inform them
	  of their expectations in receiving flow initiations.  These messages are
	  sent for each listener endpoint address in use, with retransmits as
	  necessary.  Firewalls send Listener Acknowledgment messages to squelch
	  further retransmits.
</p>
<p>It's important to recognize the notifications are not requests. 
	  Firewalls are under no obligation to change their behavior in response to
	  receiving application listener notifications.  Nodes are provided with no
	  assurance that inbound flow initiations are or are not prohibited at
	  firewalls in the network, whether advertised with ALD or not.
</p>
<p>Every ALD message sent by a firewall includes a measurement of the
	  elapsed time since their state was last reset.  This is so nodes may
	  recognize when it may be necessary to resend all its listener
	  notifications.  Firewalls periodically send announcements, but in general
	  not at a frequency high enough that nodes may rely on the absence of them
	  to detect the failure of a firewall.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Firewall Discovery</h3>

<p>For the purposes of application listener discovery, firewalls have
		an "interior" subject to the policy requiring listeners to notify them,
		and an "exterior" corresponding to the region of the Internet from
		which flow initiations are subject to administrative prohibitions.
</p>
<p>Nodes transmit Firewall Solicitation messages and receive Firewall
		Advertisement messages in acknowledgment.  Firewall Advertisement
		messages inform nodes of firewalls that may prohibit flow initiations
		from exterior sources to the node.
</p>
<p>A new neighbor discovery option is defined for use in Router
		Advertisements to specify the destination address and hop limit that
		nodes are expected to use when sending Firewall Solitation messages.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Listener Discovery</h3>

<p>Nodes send Listener Notification messages to firewalls according to
		their policy requirements.  These notifications inform firewalls of
		which nodes, protocols, and transport addresses are expecting to
		receive inbound flow initiations.  Firewalls send Listener
		Acknowledgment messages in response to inform listeners how much time
		the application can expect receive flow initiations.
</p>
<p>Nodes may notify firewalls that they expect to receive all inbound
		traffic, regardless of protocol or transport address.  Alternatively,
		they can send notifications for narrower constraints on what to pass
		through to listening nodes.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Firewall Reset Detection</h3>

<p>Firewalls periodically multicast Firewall Advertisement messages on
		their "interior" interfaces.  Immediately after the state in a firewall
		resets, the transmit interval for these advertisements are very short,
		rapidly increasing thereafter.
</p>
<p>Nodes receive Firewall Advertisements directly and compare the
		Elapsed Time Since Reset (ETSR) against the last value received in any
		previous message.  Computing their own conservative estimates of the
		expected elapsed time, nodes are able to recognize when retransmitting
		their listener notifications might be necessary.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
Application Programming Interface</h3>

<p>Applications need not be written with specific awareness of listener
		discovery.  Operating systems are implemented with default parameters
		suitable for all but the rarest of exceptions.
</p>
<p>For example, nodes only inform firewalls about TCP sockets when they
		require transport address level notification and the node sets a TCP
		socket into the LISTENING state.  Furthermore, the timing limits on
		notifications vary between temporary privacy addresses and permanently
		assigned addresses, i.e. a TCP socket bound to a temporary address will
		have a short binding time in the firewall compared to a TCP socket that
		binds to a permanent address.
</p>
<p>Some extensions to the application programming interface are defined
		for those few applications that need them.  These extensions allow
		applications to disable listener notification or override timing
		parameters on a case by case basis.
</p>
<a name="options"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
OPTION FORMATS</h3>

<p>The need for nodes to proceed with firewall discovery is signaled by
	  the presence of a Firewall Discovery option sent in Router Advertisement
	  messages.
</p>
<a name="ra_option"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Firewall Discovery Router Advertisement Option</h3>

<p>In Router Advertisements without the "other stateful
		configuration" flag set, the Firewall Discovery Option informs
		nodes of the destination address and hop limit for sending
		Firewall Solicitation messages.
</p>
<p style='text-align: center'>Firewall Discovery Option
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |    Length     |   Hop Limit   |               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               +
|                                                               |
+                                                               +
|                            Reserved                           |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                       Destination Address                     +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Type:</dt>
<dd>TBD
</dd>
<dt>Length:</dt>
<dd>4
</dd>
<dt>Hop Limit:</dt>
<dd>The hop limit
			nodes use to send Firewall Solicit messages.
</dd>
<dt>Reserved:</dt>
<dd>This field is unused.  It MUST be
			initialized to zero by the sender and MUST be ignored by the
			receiver.
</dd>
<dt>Destination Address:</dt>
<dd>The
			destination address for nodes to use when sending Firewall
			Solicit messages.
</dd>
</dl></blockquote>

<p>Routers MUST NOT send Router Advertisements containing the
		Firewall Discovery option if the "other stateful configuration"
		flag is set.  Likewise, nodes MUST NOT process the Firewall
		Discovery Option unless the "other stateful configuration" flag is
		set in the Router Advertisement that contains it.
</p>
<p>Routers MUST NOT send Router Advertisements with more than one
		Firewall Discovery Option present.  If nodes receive such Router
		Advertisements, then nodes MUST NOT process any of the Firewall
		Discovery Options.
</p>
<p>Nodes that process Firewall Discovery Options in Router
		Advertisements MUST NOT send any Firewall Solicitation messages
		from any addresses in the advertised prefixes except to the
		specified destination address, and with the specified hop
		limit.
</p>
<p>Nodes receiving Router Advertisements with the "other stateful
		configuration" flags not set, and without a Firewall Discovery
		Option present, MAY send Firewall Solicitation messages from the
		advertised prefixes to any address and with any hop limit.
</p>
<p>EXPERIMENTAL: The type value 253 is defined in section 5.1.3 of
		<a class='info' href='#RFC4727'>"Experimental Values in IPv4, IPv6, ICMPv4,
		ICMPv6, UDP, and TCP Headers"<span> (</span><span class='info'>Fenner, B., &ldquo;Experimental Values In IPv4, IPv6, ICMPv4, ICMPv6, UDP, and TCP Headers,&rdquo; November&nbsp;2006.</span><span>)</span></a> [RFC4727] for use with experimental
		protocols.  Operation of ALD in experimental mode requires the
		four octet code 0x6161706c be inserted between the Length and
		Hop Limit fields, and the size of the Reserved field to be reduced
		by four octets to keep the destination address aligned.
		Experimental Firewall Discovery Options, i.e. those described in
		this paragraph, MUST NOT be processed unless the type value is 253
		and the four octet code is present in the required position.
</p>
<a name="messages"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
MESSAGE FORMATS</h3>

<p>ALD is a sub-protocol of ICMPv6, that is, ALD message types are a
	  subset of the set of ICMPv6 messages, and ALD messages are all identified
	  in IPv6 packets by a preceding Next Header value of 58.  ALD messages
	  all have the same Type value, [TBD, assigned by IANA], and their
	  function is differentiated by the Code value.
</p>
<p>This document defines the formats for ALD messages with the following
	  Code values:
</p><br /><hr class="insert" />
<a name="msg_codes"></a>

<p style='text-align: center'>ALD Message Codes
</p><table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">Code</th><th align="left">Description</th><th align="left">Reference</th></tr>
<tr>
<td align="left">1</td>
<td align="left">Firewall Solicitation</td>
<td align="left"><a class='info' href='#fw_solicit'>Section&nbsp;5.1<span> (</span><span class='info'>Firewall Solicitation</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">2</td>
<td align="left">Firewall Advertisement</td>
<td align="left"><a class='info' href='#fw_advertise'>Section&nbsp;5.2<span> (</span><span class='info'>Firewall Advertisement</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">3</td>
<td align="left">Listener Notification</td>
<td align="left"><a class='info' href='#l_ntf'>Section&nbsp;5.4<span> (</span><span class='info'>Listener Notification</span><span>)</span></a></td>
</tr>
<tr>
<td align="left">4</td>
<td align="left">Listener Acknowledgment</td>
<td align="left"><a class='info' href='#l_ack'>Section&nbsp;5.5<span> (</span><span class='info'>Listener Acknowledgment</span><span>)</span></a></td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>All other Code values are reserved for future use.  Nodes MUST NOT
	  send messages containing them.
</p>
<p>Firewalls MUST NOT prohibit the flow of ALD messages from their
	  exterior to their interior.
</p>
<a name="fw_solicit"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Firewall Solicitation</h3>

<p>Nodes send Firewall Solicitation messages to request firewalls to
		respond with directed Firewall Advertisement messages.  They are sent
		periodically to the destination addresses specified in any Firewall
		Discovery Options received in Router Advertisements for networks they
		join.
</p>
<p style='text-align: center'>Firewall Solicitation
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |     Code      |           Checksum            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Type:</dt>
<dd>TBD.  Assigned by IANA to ALD messages.
</dd>
<dt>Code:</dt>
<dd>1.
</dd>
<dt>Checksum:</dt>
<dd>ICMPv6 checksum.
</dd>
</dl></blockquote>

<p>EXPERIMENTAL: Nodes operating in experimental mode MAY send the
		Experimental Firewall Solicitation message, i.e. the same message
		except with type value 100 as defined in <a class='info' href='#RFC4443'>"Internet Control Message Protocol (ICMPv6)"<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a> [RFC4443] for use in
		experimental protocols, and the four octet code 0x6161706c appended
		after the checksum.  Nodes MUST NOT send Experimental Firewall
		Solicitation messages to destination addresses received in the regular
		Firewall Discovery Option.
</p>
<a name="fw_advertise"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Firewall Advertisement</h3>

<p>Firewalls send Firewall Advertisement messages to notify listeners
		reachable on their interior interfaces that inbound flow initiations
		to a specific prefix are subject to policy enforcement.
</p>
<p style='text-align: center'>Firewalls Advertisement
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |     Code      |           Checksum            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Elapsed Time Since Reset                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                           Reserved              +-+-+-+-+-+-+-+
|                                                 |     IPL     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
+                                                               +
|                                                               |
+                        Interior Prefix                        +
|                                                               |
+                                                               +
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Type:</dt>
<dd>TBD.  Assigned by IANA to ALD messages.
</dd>
<dt>Code:</dt>
<dd>2.
</dd>
<dt>Checksum:</dt>
<dd>ICMPv6 checksum.
</dd>
<dt>Elapsed Time Since Reset:</dt>
<dd>
		  Number of elapsed seconds since the firewall state was last
		  reset.
</dd>
<dt>IPL:</dt>
<dd>The length of the interior prefix.  Values less
		  than 48 are reserved.  Senders MUST NOT use them, and receivers MUST
		  NOT process any messages that contain them.  (Note: the width of this
		  field is seven bits.)
</dd>
<dt>Reserved:</dt>
<dd>This field is unused.
		  It MUST be initialized to zero by the sender and MUST be ignored by
		  the receiver.
</dd>
<dt>Interior Prefix:</dt>
<dd>The IPv6
		  address prefix on the interior subject to the firewall policy.
</dd>
</dl></blockquote>

<p>Starting when a firewall begins operating on the interior prefix
		from its reset state, it MUST periodically send Firewall Advertisement
		messages on all its interfaces where the interior prefix is reachable
		using a Hop Limit of 255 to the organizational scope All Nodes
		multicast address, FF08::1.  The time interval between multicast
		transmissions MAY be of any duration.  The recommended period is every
		two seconds for the first ten seconds after the state is reset,
		followed by a doubling of the interval for every transmission
		thereafter until the interval reaches a maximum of one hour.
</p>
<p>EXPERIMENTAL: Firewalls operating in experimental mode MAY send
		Experimental Firewall Advertisement messages, i.e. the same message
		except with type value 100 as defined in <a class='info' href='#RFC4443'>"Internet Control Message Protocol (ICMPv6)"<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a> [RFC4443] for use in
		experimental protocols and the four octet code 0x6161706c inserted
		between the Checksum and Elapsed Time Since Reset fields.  These are
		sent to the organizational scope "any private experiment" multicast
		destination address, i.e. FF08::114, instead of the All Nodes address. 
		Nodes MUST NOT send Experimental Firewall Advertisement messages to any
		other multicast destination.
</p>
<a name="l_addrspec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Listener Address Specifier</h3>

<p>Listener Notification and Listener Acknowledgment messages (see
		below) each contain Listener Address Specifier elements.  These are
		structured data that describe the transport layer component of a
		listener address that firewalls are expected to filter, e.g. TCP and
		UDP ports, etc.  As a general rule, this protocol number is expected
		to match the upper-layer-protocol of the outer-most IPv6 header
		(including all its extension headers).  See <a class='info' href='#RFC2460'>"Internet Protocol, Version 6"<span> (</span><span class='info'>Deering, S. and R. Hinden, &ldquo;Internet Protocol, Version 6 (IPv6) Specification,&rdquo; December&nbsp;1998.</span><span>)</span></a> [RFC2460] for details.
</p>
<p>The first octet of any Listener Address Specifier is an Internet
		protocol number, which serves as the type discriminator for a variant
		subtype of Listener Address Specifier elements.
</p>
<p>Nodes MUST NOT send Listener Address Specifiers with protocol
		numbers assigned for identifying IPv6 extension headers.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.1"></a><h3>5.3.1.&nbsp;
All Protocols Listener Address Specifier</h3>

<p>Nodes notify firewalls that inbound flow	initiations are
			expected by sending a Listener Notification message with the All
			Protocols Listener Address Specifier.  This is a single octet with
			all zero bits, followed by a reserved field of three octets.
</p>
<p style='text-align: center'>All Protocols Listener Address Specifier
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      00       |                   Reserved                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Reserved:</dt>
<dd>This field is
			  unused.  It MUST be initialized to zero by the sender and MUST be
			  ignored by the receiver.
</dd>
</dl></blockquote>

<p>Note: the value of zero is used here for specifying all
			protocols, even though it is used in IPv6 for specifying hop-by-hop
			options.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.2"></a><h3>5.3.2.&nbsp;
All Specific Protocol Listener Address Specifier</h3>

<p>Nodes notify firewalls that all inbound flow initiations for a
			specific upper-layer protocol are expected by sending a Listener
			Notification message with an All Specific Protocol Listener Address
			Specifier.  This is a single octet with the protocol number,
			followed by three octets of zeroes.
</p>
<p style='text-align: center'>All Specific Protocol Listener Address
				Specifier
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Protocol   |                     000000                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Protocol:</dt>
<dd>The upper-layer
			  protocol number.
</dd>
</dl></blockquote>

<p>Nodes MUST NOT send All Specific Protocol Listener Address
			Specifier elements with protocol numbers reserved for IPv6 header
			extensions in the Protocol field.
</p>
<p>Nodes MUST NOT send All Specific Protocol Listener Address
			Specifier elements with 255 in the Protocol field.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.3"></a><h3>5.3.3.&nbsp;
Encapsulating Security Payload Listener Address
		  Specifier</h3>

<p>Nodes notify firewalls of that inbound <a class='info' href='#RFC4303'>IP
			Encapsulating Security Payload (ESP) flows<span> (</span><span class='info'>Kent, S., &ldquo;IP Encapsulating Security Payload (ESP),&rdquo; December&nbsp;2005.</span><span>)</span></a> [RFC4303] are expected by
			sending a Listener Notification message with the Encapsulating
			Security Payload Listener Address Specifier.  This is a single
			octet with the ESP protocol number in it, followed by a reserved
			field of three octets.
</p>
<p style='text-align: center'>Encapsulating Security Payload Listener Address
				Specifier
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      50       |                   Reserved                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                              SPI                              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Reserved:</dt>
<dd>This field is
			  unused.  It MUST be initialized to zero by the sender and MUST be
			  ignored by the receiver.
</dd>
<dt>SPI:</dt>
<dd>Security Parameter Index for inbound flow.
</dd>
</dl></blockquote>

<p>An ESP Listener Address Specifier with a value of all zero
			octets in the SPI field is equivalent to the All Specific Protocol
			Listener Address Specifier with the ESP protocol number in the
			Protocol field.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.4"></a><h3>5.3.4.&nbsp;
TCP Listener Address Specifier</h3>

<p>Nodes notify firewalls that inbound <a class='info' href='#RFC0793'>Transmission Control Protocol (TCP) connections<span> (</span><span class='info'>Postel, J., &ldquo;Transmission Control Protocol,&rdquo; September&nbsp;1981.</span><span>)</span></a> [RFC0793] are expected
			by sending a Listener Notification message with the TCP Listener
			Address Specifier.  This is a single octet with the TCP protocol
			number in it, followed by a reserved octet, followed by the TCP
			port number for the application endpoint.
</p>
<p style='text-align: center'>TCP Listener Address Specifier
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|       6       |    Reserved   |        TCP Port Number        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Reserved:</dt>
<dd>This field is
			  unused.  It MUST be initialized to zero by the sender and MUST be
			  ignored by the receiver.
</dd>
<dt>TCP Port Number:</dt>
<dd>The TCP
			  port for the application endpoint.
</dd>
</dl></blockquote>

<p>A value of zero in the TCP Port Number field indicates all TCP
			flows.  This is identical to the All Specific Protocol Listener
			Address Specifier for TCP.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.5"></a><h3>5.3.5.&nbsp;
UDP Listener Address Specifier</h3>

<p>Nodes notify firewalls that inbound <a class='info' href='#RFC0768'>User Datagram Protocol (UDP) flow initiations<span> (</span><span class='info'>Postel, J., &ldquo;User Datagram Protocol,&rdquo; August&nbsp;1980.</span><span>)</span></a> [RFC0768] are expected
			by sending a Listener Notification message with the UDP Listener
			Address Specifier.  This is a single octet with the UDP protocol
			number in it, followed by a reserved octet, followed by the UDP
			port number for the application endpoint.
</p>
<p style='text-align: center'>UDP Listener Address Specifier
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      17       |    Reserved   |        UDP Port Number        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Reserved:</dt>
<dd>This field is
			  unused.  It MUST be initialized to zero by the sender and MUST be
			  ignored by the receiver.
</dd>
<dt>UDP Port Number:</dt>
<dd>The UDP
			  port for the application endpoint.
</dd>
</dl></blockquote>

<p>A value of zero in the UDP Port Number field indicates all UDP
			flows.  This is identical to the All Specific Protocol Listener
			Address Specifier for UDP.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.6"></a><h3>5.3.6.&nbsp;
SCTP Listener Address Specifier</h3>

<p>Nodes notify firewalls that inbound <a class='info' href='#RFC4960'>Stream Control Transport Protocol (SCTP) flow initiations<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a> [RFC4960]
			are expected by sending a Listener Notification message with the
			SCTP Listener Address Specifier.  This is a single octet with the
			SCTP protocol number in it, followed by a reserved octet, followed
			by the SCTP port number for the application endpoint.
</p>
<p style='text-align: center'>SCTP Listener Address Specifier
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      132      |    Reserved   |       SCTP Port Number        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Reserved:</dt>
<dd>This field is
			  unused.  It MUST be initialized to zero by the sender and MUST be
			  ignored by the receiver.
</dd>
<dt>UDP Port Number:</dt>
<dd>The SCTP
			  port for the application endpoint.
</dd>
</dl></blockquote>

<p>A value of zero in the SCTP Port Number field indicates all SCTP
			flows.  This is identical to the All Specific Protocol Listener
			Address Specifier for SCTP.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3.7"></a><h3>5.3.7.&nbsp;
DCCP Listener Address Specifier</h3>

<p>Nodes notify firewalls that inbound <a class='info' href='#RFC4340'>Datagram Congestion Control Protocol (DCCP) flow initiations<span> (</span><span class='info'>Kohler, E., Handley, M., and S. Floyd, &ldquo;Datagram Congestion Control Protocol (DCCP),&rdquo; March&nbsp;2006.</span><span>)</span></a> [RFC4340]
			are expected by sending a Listener Notification message with the
			DCCP Listener Address Specifier.  This is a single octet with the
			DCCP protocol number in it, followed by a reserved octet, followed
			by the DCCP port number for the application endpoint.
</p>
<p style='text-align: center'>DCCP Listener Address Specifier
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      33       |    Reserved   |       DCCP Port Number        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Reserved:</dt>
<dd>This field is
			  unused.  It MUST be initialized to zero by the sender and MUST be
			  ignored by the receiver.
</dd>
<dt>UDP Port Number:</dt>
<dd>The DCCP
			  port for the application endpoint.
</dd>
</dl></blockquote>

<p>A value of zero in the DCCP Port Number field indicates all DCCP
			flows.  This is identical to the All Specific Protocol Listener
			Address Specifier for DCCP.
</p>
<a name="l_ntf"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
Listener Notification</h3>

<p>When a node expects to receive inbound flows from the exterior of
		a firewall, it MAY send a Listener Notification message to signal that
		inbound flow initiations should not be prohibited.
</p>
<p style='text-align: center'>Listener Notification
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |     Code      |           Checksum            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Expected Duration                       |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Listener Address Specifier
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ...
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Type:</dt>
<dd>TBD.  Assigned by IANA to ALD messages.
</dd>
<dt>Code:</dt>
<dd>3.
</dd>
<dt>Checksum:</dt>
<dd>ICMPv6 checksum.
</dd>
<dt>Expected Duration:</dt>
<dd>The
		  number of seconds the application expects to be listening.
</dd>
<dt>Listener Address Specifier:</dt>
<dd>
		  Describes the transport address of the application listener.  See
		  <a class='info' href='#l_addrspec'>Section&nbsp;5.3<span> (</span><span class='info'>Listener Address Specifier</span><span>)</span></a>.
</dd>
</dl></blockquote>

<p>Nodes MUST NOT send Listener Notification messages on any network to
		any destinations other than the unicast source addresses from which they
		receive Firewall Advertisement messages after joining the network.
</p>
<p>EXPERIMENTAL: Nodes operating in experimental mode MAY send the
		Experimental Listener Notification message, i.e. the same message
		except with type value 100 as defined in <a class='info' href='#RFC4443'>"Internet Control Message Protocol (ICMPv6)"<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a> [RFC4443] for use in
		experimental protocols and the four octet code 0x6161706c inserted
		between the Checksum and Expected Time Interval fields.  Nodes MUST NOT
		send Experimental Listener Notification messages to destination
		addresses after receiving any regular Firewall Advertisement messages
		from the same source address.
</p>
<a name="l_ack"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
Listener Acknowledgment</h3>

<p>Firewalls send Listener Acknowledgment messages in response to
		receiving Listener Solication messages from nodes.
</p>
<p style='text-align: center'>Listener Acknowledgment
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     Type      |     Code      |           Checksum            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Elapsed Time Since Reset                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                     Acknowledged Duration                     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   Listener Address Specifier
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+ ...
</pre></div>
<p></p>
<blockquote class="text"><dl>
<dt>Type:</dt>
<dd>TBD.  Assigned by IANA to ALD messages.
</dd>
<dt>Code:</dt>
<dd>4.
</dd>
<dt>Checksum:</dt>
<dd>ICMPv6 checksum.
</dd>
<dt>Elapsed Time Since Reset:</dt>
<dd>
		  Number of elapsed seconds since the firewall state was last reset.
</dd>
<dt>Acknowledged Duration:</dt>
<dd>The
		  number of seconds the firewall acknowledges the node will be
		  listening.
</dd>
<dt>Listener Address Specifier:</dt>
<dd>
		  Describes the transport address of the application listener.  See
		  <a class='info' href='#l_addrspec'>Section&nbsp;5.3<span> (</span><span class='info'>Listener Address Specifier</span><span>)</span></a>.
</dd>
</dl></blockquote>

<p>Firewalls MUST NOT transmit Listener Acknowledgment messages except
		in response to received Listener Notification messages.
</p>
<p>Firewalls MUST NOT transmit Listener Acknowledgment messages with
		an Acknowledged Duration greater than the Expected Duration in the
		corresponding Listener Notification message.
</p>
<p>After receiving a Listener Acknowledgment message, nodes MUST NOT
		transmit Listener Notification messages with a non-zero Requested
		Lifetime and the same Listener Address Specifier unless the Requested
		Lifetime is less than seven eighths (87.5%) of the Granted Lifetime
		value.
</p>
<p>EXPERIMENTAL: Firewalls operating in experimental mode MAY respond
		to Experimental Listener Notification messages with the Experimental
		Listener Acknowledgment message, i.e. the same message except with
		type value 100 as defined in <a class='info' href='#RFC4443'>"Internet Control
		Message Protocol (ICMPv6)"<span> (</span><span class='info'>Conta, A., Deering, S., and M. Gupta, &ldquo;Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification,&rdquo; March&nbsp;2006.</span><span>)</span></a> [RFC4443] for use in experimental protocols and
		the four octet code 0x6161706c inserted between the Checksum and
		Elapsed Time Since Reset fields.
</p>
<a name="api"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
APPLICATION PROGRAMMING INTERFACE</h3>

<p>[ This section needs to be expanded to discuss how ALD functions are
	  related to the operation of the conventional socket layer interface, i.e.
	  how Listener Notifications are emitted when TCP sockets are put into and
	  taken out of the LISTENING states, etc.  Additional socket options for
	  advanced usage may also be necessary here.  Specific description of
	  behavior for sockets in O_NONBLOCK mode should be defined. ]
</p>
<p>Existing programming interfaces, e.g. the widely used BSD sockets API,
	  are sufficient for most applications.  When TCP endpoints bound to global
	  addresses transition into the LISTENING state, firewalls can be notified
	  automatically with Listener Notification messages.  Similar methods can
	  be used for all other transport protocols.
</p>
<p>Some applications require finer control over whether and how to notify
	  firewalls of their listeners.  This document recommends extensions to
	  system configuration, interface control messages and socket options to
	  meet their needs.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Normal Behavior of IPv6 Sockets</h3>

<p>Applications using the BSD <tt>listen(2)</tt>
		function to place a TCP socket into the LISTENING state MAY be blocked
		while ALD notifies the appropriate firewalls.  If the socket descriptor
		is opened with <tt>O_NONBLOCK</tt> or is otherwise
		marked as non-blocking, then <tt>listen(2)</tt> MAY
		return <tt>EINPROGRESS</tt> to indicate that ALD has
		not yet received Listener Acknowledgment messages from all appropriate
		firewalls.  It MAY be possible to <tt>select(2)</tt>
		for completion by checking the socket for writing.
</p>
<p>Applications using the BSD <tt>bind(2)</tt>
		function with UDP sockets MAY be blocked while ALD notifies the
		appropriate firewalls.  If the socket descriptor is opened with
		<tt>O_NONBLOCK</tt> or is otherwise marked as
		non-blocking, then <tt>bind(2)</tt> MAY return
		<tt>EINPROGRESS</tt> to indicate that ALD has not
		yet received Listener Acknowledgment messages from all appropriate
		firewalls.  It MAY be possible to <tt>select(2)</tt>
		for completion by checking the socket for writing.
</p>
<p>Implementations of SCTP and DCCP are expected to implement similar
		methods of plumbing up ALD operations to the application layer.
</p>
<p>If an application binds to specific interface addresses, then
		Listener Notification messages MAY be sent only to those firewalls
		with matching interior prefixes.
</p>
<p>If a node receives a Listener Acknowledgment with an address
		specification that indicates the firewall has already discovered the
		application listener, then transmitting a Listener Notification MAY be
		skipped.  If no ALD messages are necessary, then the application MUST
		receive the same service from the <tt>bind(2)</tt>
		and <tt>listen(2)</tt> system functions as when
		ALD is not operating.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Extensions to BSD Socket Interface</h3>

<p>A new system configuration variable of boolean type,
		<tt>net.inet6.icmp6.ald_enabled</tt>, MAY be
		available on nodes to control whether ALD is enabled.  The recommended
		default value is TRUE.
</p>
<p>A new interface flag, <tt>IFF_NOALD</tt> MAY be
		available for disabling ALD on a per-interface basis.  The recommended
		default if for the flag not to be set.  The
		<tt>ifconfig(8)</tt> utility MAY provide the "-ald"
		parameter for controlling this option.
</p>
<p>A new socket option of boolean type,
		<tt>IPV6_ALD_ENABLED</tt> MAY be used to control
		whether ALD is to be used on a per-socket basis.  The default value for
		is recommended to be TRUE unless
		<tt>net.inet6.icmp6.ald_enabled</tt> is FALSE or the
		socket has already been bound to an interface address for which the
		interface has the <tt>IFF_NOALD</tt> flag set.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA CONSIDERATIONS</h3>

<p>This memo includes several requests to IANA, which need to be gathered
	  into this section accordingly.
</p>
<p>All drafts are required to have an IANA considerations section (see
      <a class='info' href='#I-D.narten-iana-considerations-rfc2434bis'>the update of
      RFC 2434<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; March&nbsp;2008.</span><span>)</span></a> [I&#8209;D.narten&#8209;iana&#8209;considerations&#8209;rfc2434bis] for a guide). If the draft does not require IANA to do
      anything, the section contains an explicit statement that this is the
      case (as above). If there are no requirements for IANA, the section will
      be removed during conversion into an RFC by the RFC Editor.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
SECURITY CONSIDERATIONS</h3>

<p>The author has not yet given sufficient consideration to security for
	  writing an adequate security considerations section.  Some readers have
	  expressed concerns about spoofing.  The author thinks protecting unicast
	  ALD messages with IPsec Authenticated Header is the appropriate method
	  for addressing such issues.  An argument might be entertained for
	  protecting the privacy of Listener Notification and Acknowledgment
	  messages, and the author likewise believes IPsec Encapsulating Security
	  Payload is the appropriate method for that.  Key exchange for such
	  security mechanisms should be specified by this document if IETF
	  consensus regards addressing these considerations as essential.
</p>
<p>All drafts are required to have a security considerations section.
      See <a class='info' href='#RFC3552'>"Guidelines for Writing RFC Text on Security
	  Considerations"<span> (</span><span class='info'>Rescorla, E. and B. Korver, &ldquo;Guidelines for Writing RFC Text on Security Considerations,&rdquo; July&nbsp;2003.</span><span>)</span></a> [RFC3552] for a guide.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0768">[RFC0768]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc768">User Datagram Protocol</a>,&rdquo; STD&nbsp;6, RFC&nbsp;768, August&nbsp;1980 (<a href="http://www.rfc-editor.org/rfc/rfc768.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0793">[RFC0793]</a></td>
<td class="author-text">Postel, J., &ldquo;<a href="http://tools.ietf.org/html/rfc793">Transmission Control Protocol</a>,&rdquo; STD&nbsp;7, RFC&nbsp;793, September&nbsp;1981 (<a href="http://www.rfc-editor.org/rfc/rfc793.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2460">[RFC2460]</a></td>
<td class="author-text"><a href="mailto:deering@cisco.com">Deering, S.</a> and <a href="mailto:hinden@iprg.nokia.com">R. Hinden</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2460">Internet Protocol, Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;2460, December&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2460.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2460.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2460.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4303">[RFC4303]</a></td>
<td class="author-text">Kent, S., &ldquo;<a href="http://tools.ietf.org/html/rfc4303">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;4303, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4303.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4340">[RFC4340]</a></td>
<td class="author-text">Kohler, E., Handley, M., and S. Floyd, &ldquo;<a href="http://tools.ietf.org/html/rfc4340">Datagram Congestion Control Protocol (DCCP)</a>,&rdquo; RFC&nbsp;4340, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4340.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4443">[RFC4443]</a></td>
<td class="author-text">Conta, A., Deering, S., and M. Gupta, &ldquo;<a href="http://tools.ietf.org/html/rfc4443">Internet Control Message Protocol (ICMPv6) for the Internet Protocol Version 6 (IPv6) Specification</a>,&rdquo; RFC&nbsp;4443, March&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4443.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4727">[RFC4727]</a></td>
<td class="author-text">Fenner, B., &ldquo;<a href="http://tools.ietf.org/html/rfc4727">Experimental Values In IPv4, IPv6, ICMPv4, ICMPv6, UDP, and TCP Headers</a>,&rdquo; RFC&nbsp;4727, November&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4727.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4960">[RFC4960]</a></td>
<td class="author-text">Stewart, R., &ldquo;<a href="http://tools.ietf.org/html/rfc4960">Stream Control Transmission Protocol</a>,&rdquo; RFC&nbsp;4960, September&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4960.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.narten-iana-considerations-rfc2434bis">[I-D.narten-iana-considerations-rfc2434bis]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-narten-iana-considerations-rfc2434bis-09.txt">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; draft-narten-iana-considerations-rfc2434bis-09 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-narten-iana-considerations-rfc2434bis-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NAT-PMP">[NAT-PMP]</a></td>
<td class="author-text">Cheshire, S., Krochmal, M., and K. Sekar, &ldquo;<a href="http://tools.ietf.org/html/draft-cheshire-nat-pmp">NAT Port Mapping Protocol (NAT-PMP)</a>,&rdquo; November&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3552">[RFC3552]</a></td>
<td class="author-text">Rescorla, E. and B. Korver, &ldquo;<a href="http://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>,&rdquo; BCP&nbsp;72, RFC&nbsp;3552, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3552.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4864">[RFC4864]</a></td>
<td class="author-text">Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;<a href="http://tools.ietf.org/html/rfc4864">Local Network Protection for IPv6</a>,&rdquo; RFC&nbsp;4864, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4864.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="UPnP-IGD">[UPnP-IGD]</a></td>
<td class="author-text">UPnP Forum, &ldquo;<a href="http://www.upnp.org/standardizeddcps/igd.asp">Universal Plug and Play Internet Gateway Device Standardized
		  Gateway Device Protocol</a>,&rdquo; September&nbsp;2006.</td></tr>
</table>

<a name="changelog"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Change Log</h3>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
draft-woodyatt-ald-01 to draft-woodyatt-ald-02</h3>

<p></p>
<ul class="text">
<li>Fixed spelling errors.
</li>
<li>Local Network Protection is now <a class='info' href='#RFC4864'>[RFC4864]<span> (</span><span class='info'>Van de Velde, G., Hain, T., Droms, R., Carpenter, B., and E. Klein, &ldquo;Local Network Protection for IPv6,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
<li>Fix some bugs related to <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> compliance.
</li>
<li>SCTP is now <a class='info' href='#RFC4960'>[RFC4960]<span> (</span><span class='info'>Stewart, R., &ldquo;Stream Control Transmission Protocol,&rdquo; September&nbsp;2007.</span><span>)</span></a>.
</li>
</ul>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
draft-woodyatt-ald-00 to draft-woodyatt-ald-01</h3>

<p></p>
<ul class="text">
<li>Added geeky cross-references for TCP and UDP.
</li>
<li>Simplified description of ICMPv6 checksum field descriptions.
</li>
<li>Changed the All Protocols Listener Address Specifier to use zero
		  instead of 41, so that IPv6-in-IPv6 is eligible for specification.
</li>
<li>Added the SPI field to the ESP Listener Address Specifier.
</li>
<li>Added a note about zero UDP and TCP port numbers in the associated
		  Listener Address Specifiers.
</li>
<li>Added Listener Address Specifiers for SCTP and DCCP.
</li>
<li>Added the All Specific Protocol Listener Address Specifier element
		  and changed the associated requirements language to allow nodes to
		  send them, and to explicitly disallow protocol numbers corresponding
		  to IPv6 header extensions and the reserved protocol number.
</li>
</ul>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">james woodyatt</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Apple Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1 Infinite Loop</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, CA  95014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:jhw@apple.com">jhw@apple.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
