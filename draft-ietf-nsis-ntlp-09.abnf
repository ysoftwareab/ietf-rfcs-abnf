NNNNNNNNNNNNNN = 'Normal' datagram mode messages
QQQQQQQQQQQQQQ = Datagram mode messages which
                             are Queries or likewise encapsulated
xxxxxxxxxxxxxx = connection mode messages
RAO = Router Alert Option

GIST-Message = GIST-Query / GIST-Response /
                      GIST-Confirm / GIST-Data /
                      GIST-Error / GIST-MA-Hello

GIST-Query = Common-Header
                    Message-Routing-Information
                    Session-Identification
                    Network-Layer-Information
                    Query-Cookie
                    [ Stack-Proposal Stack-Configuration-Data ]
                    [ NSLP-Data ]

GIST-Response = Common-Header
                       Message-Routing-Information
                       Session-Identification
                       [ Network-Layer-Information ]
                       Query-Cookie
                       [ Responder-Cookie
                         [ Stack-Proposal Stack-Configuration-Data ] ]
                       [ NSLP-Data ]

GIST-Confirm = Common-Header
                      Message-Routing-Information
                      Session-Identification
                      Network-Layer-Information
                      [ Responder-Cookie
                        [ Stack-Proposal
                          [ Stack-Configuration-Data ] ] ]
                      [ NSLP-Data ]

GIST-Data = Common-Header
                   Message-Routing-Information
                   Session-Identification
                   [ Network-Layer-Information ]
                   NSLP-Data
GIST-Error = Common-Header
                    [ Network-Layer-Information ]
                    GIST-Error-Data

GIST-MA-Hello = Common-Header

Message-Routing-Information = message-routing-method
                                     method-specific-information

Network-Layer-Information = peer-identity
                                   interface-address
                                   RS-validity-time
                                   IP-TTL

Stack-Proposal = 1*stack-profile
stack-profile = 1*protocol-layer

Stack-Configuration-Data = MA-Hold-Time
                                  0*MA-protocol-options

GIST-Error-Data = error-class error-code error-subcode
                         common-header
                         [ Message-Routing-Information-content ]
                         [ Session-Identification-content ]
                         0*additional-information
                         [ comment ]

MRI = network-layer-version
             source-address prefix-length
             destination-address prefix-length
             IP-protocol
             diffserv-codepoint
             [ flow-label ]
             [ ipsec-SPI / L4-ports]

MRI = network-layer-version
             source-address
             destination-address

R-Cookie = liveness data + hash (locally known secret,
                                        Q-Node NLI, MRI, NSLPID,
                                        reception interface,
                                        liveness data)

Type           = the GIST message type (Query, Response, etc.)
AB=00 ("Mandatory"): If the object is not understood, the entire
      message containing it MUST be rejected with an "Object Type Error"
      message (Appendix A.4.4.9) with subcode 1 ("Unrecognised Object").

AB=01 ("Ignore"): If the object is not understood, it MUST be deleted
      and the rest of the message processed as usual.

AB=10 ("Forward"): If the object is not understood, it MUST be
      retained unchanged in any message forwarded as a result of message
      processing, but not stored locally.

PI-Length = the byte length of the Peer-Identity field
               (note that the Peer-Identity field itself is padded
               to a whole number of words)
IP-TTL    = initial or reported IP-TTL
IP-Ver    = the IP version for the Interface-Address field

Prof-Count = The number of profiles in the proposal. MUST be > 0.

MA-Hold-Time = the time for which the messaging association will
                  be held open without traffic or a hello message.
                  Given in milliseconds.
MPO-Count  = the number of MA-protocol-options fields present
                (these contain their own length information)

MA-Protocol-ID = Protocol identifier as described in
Profile  = Tag indicating which profile from the accompanying
              Stack-Proposal object this applies to. Profiles
              are numbered from 1 upwards; the special value 0
              indicates 'applies to all profiles'.
Length    = the byte length of MA-protocol-options field
               that follows. This will be zero-padded
               up to the next word boundary.
MRI-Length = the word length of the included MRI payload
Type-Count = the number of GIST payloads translated by the
                NAT; the Type numbers are included as a list
                (padded with 2 null bytes if necessary)
NAT-Count  = the number of NATs traversed by the message, and the
                number of opaque payloads at the end of the object

