<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Cryptographic Algorithms, Use, &amp;
    Implementation Requirments for TCP Authentication Option</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Cryptographic Algorithms, Use, &amp;
    Implementation Requirments for TCP Authentication Option">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">TCPM</td><td class="header">G. Lebovitz</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Juniper</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">March 03, 2009</td></tr>
<tr><td class="header">Expires: September 4, 2009</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />Cryptographic Algorithms, Use, &amp;
    Implementation Requirments for TCP Authentication Option<br />draft-lebovitz-ietf-tcpm-tcp-ao-crypto-00</h1>

<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 4, 2009.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents in effect on the date of
publication of this document (http://trustee.ietf.org/license-info).
Please review these documents carefully, as they describe your
rights and restrictions with respect to this document.</p>

<h3>Abstract</h3>

<p>The TCP Authentication Option, TCP-AO, relies on security algorithms
      to provide authentication between two end-points. There are many such
      algorithms available, and two TCP-AO systems cannot interoperate unless
      they are using the same algorithm(s). This document specifies the
      algorithms and attributes that can be used in TCP-AO manual key mode. It
      also defines a UI labels framework that will be used across
      implementations to aid administrators in quickly achieving successful
      TCP-AO connections, something that will become far more important once a
      key management protocol (KMP) is defined for TCP-AO.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#Requirements">2.</a>&nbsp;
Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ReqLanguage">2.1.</a>&nbsp;
Requirements Language<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">2.2.</a>&nbsp;
Algorithm Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ReqFuture">2.3.</a>&nbsp;
Requirements for Future MAC Algorithms<br />
<a href="#Algos">3.</a>&nbsp;
Algorithms Specified<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#KDFs">3.1.</a>&nbsp;
Key Derivation Functions (KDFs)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.1.</a>&nbsp;
The Use of KDF_HMAC_SHA1<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.2.</a>&nbsp;
The Use of KDF_AES_128_CMAC<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#MACs">3.2.</a>&nbsp;
MAC Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HMAC-SHA-1-96">3.2.1.</a>&nbsp;
The Use of HMAC-SHA-1-96<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AES-128-CMAC-96">3.2.2.</a>&nbsp;
The Use of AES-128-CMAC-96<br />
<a href="#anchor5">4.</a>&nbsp;
UI Labels<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.1.</a>&nbsp;
Label &quot;Option-A&quot;<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.2.</a>&nbsp;
Label &quot;Option-B&quot;<br />
<a href="#ChangeHistory">5.</a>&nbsp;
Change History (RFC Editor: Delete before publishing)<br />
<a href="#ToAddress">6.</a>&nbsp;
Needs Work in Next Draft (RFC Editor: Delete Before Publishing)<br />
<a href="#Security">7.</a>&nbsp;
Security Considerations<br />
<a href="#anchor8">8.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor9">9.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">10.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">10.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">10.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document is a companion to TCP-AO <a class='info' href='#I-D.ietf-tcpm-tcp-auth-opt'>[TCP-AO]<span> (</span><span class='info'>Touch, J., Mankin, A., and R. Bonica, &ldquo;The TCP Authentication Option,&rdquo; March&nbsp;2010.</span><span>)</span></a> [I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;auth&#8209;opt]. Like most security
      protocols, TCP-AO allows users to chose which cryptographic algorithm(s)
      they want to use to meet their security needs.
</p>
<p>TCP-AO provides cryptographic authentication and message integrity
      verification between to end-points. In order to accomplish this
      function, one employs message authentication codes (MACs). There are
      various ways to create MACs. The use of hashed-based MACs (HMAC) in
      Internet protocols is defined in [2104]. The use of cipher-based MACs
      (CMAC) in Internet protocols is defined in <a class='info' href='#RFC4493'>[RFC4493]<span> (</span><span class='info'>Song, JH., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The AES-CMAC Algorithm,&rdquo; June&nbsp;2006.</span><span>)</span></a>.
</p>
<p>This RFC discusses the requirements for implementations to support
      two MACs used in TCP-AO, both now and in the future, and includes the
      rationale behind the present and future requirements. The document then
      defines the use of those two MACs with TCP-AO. The document then
      discusses "UI Labels" in implementations, why they have been found to be
      so important to deployment success in other security protocols, and
      specifies "UI Labels" for TCP-AO. (Note: these labels are fairly
      unimportant now, but will become far more important once a key
      management protocol, or KMP, is defined for use with TCP-AO).
</p>
<p>
</p>
<a name="Requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Requirements</h3>

<p>
</p>
<a name="ReqLanguage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>We define some additional terms here:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>SHOULD+ :</dt>
<dd>This term means the same as SHOULD.
                However, it is likely that an algorithm marked as SHOULD+ will
                be promoted at some future time to be a MUST.
</dd>
<dt>SHOULD- :</dt>
<dd>This term means the same as SHOULD.
                However, it is likely that an algorithm marked as SHOULD- will
                be deprecated to a MAY or worse in a future version of this
                document.
</dd>
<dt>MUST- :</dt>
<dd>This term means the same as MUST.
                However, we expect that at some point in the future this
                algorithm will no longer be a MUST.
</dd>
</dl></blockquote>

</blockquote>

<p>
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Algorithm Requirements</h3>

<p>In this the first RFC specifying cryptography for TCP-AO, we
        specify one MAC algorithm as a MUST- and the other as a SHOULD+.
</p>
<p>This table lists authentication algorithms for the TCP-AO
        protocol.
</p>
<p>
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Requirement</dt>
<dd>Authentication Algorithm
</dd>
<dt>------------</dt>
<dd>------------------------
</dd>
<dt>MUST-</dt>
<dd>HMAC-SHA-1-96 <a class='info' href='#RFC2404'>[RFC2404]<span> (</span><span class='info'>Madson, C. and R. Glenn, &ldquo;The Use of HMAC-SHA-1-96 within ESP and AH,&rdquo; November&nbsp;1998.</span><span>)</span></a>
</dd>
<dt>SHOULD+</dt>
<dd>AES-128-CMAC-96 <a class='info' href='#RFC4493'>[RFC4493]<span> (</span><span class='info'>Song, JH., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The AES-CMAC Algorithm,&rdquo; June&nbsp;2006.</span><span>)</span></a>(1)
</dd>
<dt></dt>
<dd>
</dd>
<dt>Requirement</dt>
<dd>Key Derivation Function (KDF)
</dd>
<dt>-------------</dt>
<dd>------------------------
</dd>
<dt>MUST-</dt>
<dd>KDF_HMAC_SHA1
</dd>
<dt>SHOULD+</dt>
<dd>KDF_AES_128_CMAC
</dd>
</dl></blockquote>

</blockquote>

<p>
</p>
<p>Notes: (1) The security issues driving the migration from SHA-1 to
        SHA-256 for digital signatures <a class='info' href='#HMAC-ATTACK'>[HMAC-ATTACK]<span> (</span><span class='info'>, &ldquo;On the Security of HMAC and NMAC Based           on HAVAL, MD4, MD5, SHA-0 and SHA-1&quot;,&rdquo; 2006.</span><span>)</span></a> [HMAC&#8209;ATTACK]do not immediately render
        SHA-1 weak for this application of SHA-1 in HMAC mode. The security
        strength of SHA-1 HMACs should be sufficient for the foreseeable
        future, especially given that the tags are truncated to 96 bits.
        However, while it's clear that the attacks aren't practical on SHA-1,
        these types of analysis are mounting and could potentially pose a
        concern for HMAC forgery if they were significantly improved, over
        time. In anticipation of SHA-1's growing less dependable over time,
        but given its wide deployment and current strength, it is a "MUST-"
        for TCP-AO today, and the only mandatory-to-implement MAC. AES-128
        CMAC is considered to be far stronger, but may not yet have very wide
        implementation, it is therefore a SHOULD+.
</p>
<a name="ReqFuture"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Requirements for Future MAC Algorithms</h3>

<p>Since this document provides cryptographic agility, it is also
        important to establish requirements for future MAC algorithms. The
        TCPM WG should restrict any future MAC algorithms for this
        specification to ones that can protect at least 2**48 messages with a
        probability that a collision will occur of less than one in a
        billion.
</p>
<p>[Reviewers: Are there other requirements we want to place in
        here?]
</p>
<a name="Algos"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Algorithms Specified</h3>

<p>TCP-AO refers to this document saying that the MAC mechanism employed
      for a connection is listed in the TSAD entry, and is chosen from a list
      of MACs both named and described in this document.
</p>
<p>TCP-AO requires two classes of cryptographic algorithms:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>(1)</dt>
<dd>Key Derivation Functions (KDFs) which name a
              pseudorandom function (PRF) and use a Master_Key and some
              connection-specific Input with that PRF to produce Conn_Keys,
              the keys suitable for authenticating and integrity checking
              individual TCP segments.
</dd>
<dt>(2)</dt>
<dd>Message Authentication Code (MAC) algorithms
              which take a key and a message and produce an authentication tag
              which can be used to verify the integrity of the message. In
              TCP-AO, these algorithms are always used in pairs. Each MAC
              algorithm MUST specify the KDF to be used with that MAC
              algorithm. However, a KDF MAY be used with more than one MAC
              algorithm.
</dd>
</dl></blockquote>

</blockquote>

<p>
</p>
<p>In TCP-AO, these algorithms are always used in pairs. Each MAC
      algorithm MUST specify the KDF to be used with that MAC algorithm.
      However, a KDF MAY be used with more than one MAC algorithm.
</p>
<a name="KDFs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Key Derivation Functions (KDFs)</h3>

<p>
</p>
<p>TCP-AO's Conn_Keys are derived using KDFs. The KDFs used in TCP-AO
        manual have the following interface:
</p>
<p></p>
<blockquote class="text">
<p>PRF(Master_Key, Input, Output_Length)
</p>
</blockquote>

<p>where:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- PRF:</dt>
<dd>the specific pseudorandom function that
                is the basic building block used in constructing the given
                KDF
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Master_Key:</dt>
<dd>The Master_Key as will be stored
                into the associated TCP-AO TSAD entry. In TPC-AO's manual key
                mode, this is a shared key that both sides enter via some user
                interface into their respective configurations. The Master_Key
                is the seed for the PRF. We assume that, in manual key mode,
                this is a human readable pre-shared key (PSK), thus we assume
                that it is of variable length, and we also assume it is in no
                way random.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Input:</dt>
<dd>the input data for the PRF, in
                conformance with <a class='info' href='#NIST-SP800-108'>[NIST&#8209;SP800&#8209;108]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Key Derivation Using           Pseudorandom Functions,&rdquo; April&nbsp;2008.</span><span>)</span></a>, is a
                concatonation of:
</dd>
</dl></blockquote>

<p></p>
<blockquote class="text">
<p>( i || Label || 0x00 || Context || Output_Length)
</p>
</blockquote>

<p></p>
<blockquote class="text">
<p>Where
</p>
<p></p>
<blockquote class="text"><dl>
<dt>- &quot;||&quot;:</dt>
<dd>Represents a concatonation
                    operation, between two values X || Y.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- i:</dt>
<dd>A counter, a binary string that is an
                    input to each iteration of a PRF in counter mode and
                    (optionally) in feedback mode. This will depend on the
                    specific size of the Output_Length desired for an given
                    MAC.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Label:</dt>
<dd>A binary string that clearly
                    identifies the purpose of this KDF's derived keying
                    material. For TCP-AO we use the ASCII string "TCP-AO".
                    While this may seem like overkill in this specification
                    since TCP-AO only describes one call to the KDF, it is
                    included in order to comply with FIPS 140
                    certifications.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- 0x00:</dt>
<dd>Eight zero bits, or 0 represented in
                    byte form
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Context :</dt>
<dd>A binary string containing
                    information related to the specific connection for this
                    derived keying material. In TCP-AO, this is the
                    Conn_Block, as defined in <a class='info' href='#I-D.ietf-tcpm-tcp-auth-opt'>[I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;auth&#8209;opt]<span> (</span><span class='info'>Touch, J., Mankin, A., and R. Bonica, &ldquo;The TCP Authentication Option,&rdquo; March&nbsp;2010.</span><span>)</span></a>, Section
                    X]
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Output_Length:</dt>
<dd>The length in bits of the
                    key that the KDF will produce. This length must be the
                    size required for the MAC algorithm that will use the PRF
                    result as a seed.
</dd>
</dl></blockquote>

</blockquote>

</blockquote>

<p>
</p>
<p>When invoked, a KDF runs a certain PRF, using the Master_Key as the
        seed, and Input as the message input and produces a result of
        Output_Length bits. This result may then be used as a cryptographic
        key for any algorithm which takes an Output_Length length key as its
        seed. A KDF MAY specify a maximum Output_Length parameter.
</p>
<p>This document defines two KDFs:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>*  KDF_HMAC_SHA1</dt>
<dd>based on PRF-HMAC-SHA1 <a class='info' href='#RFC2404'>[RFC2404]<span> (</span><span class='info'>Madson, C. and R. Glenn, &ldquo;The Use of HMAC-SHA-1-96 within ESP and AH,&rdquo; November&nbsp;1998.</span><span>)</span></a>
</dd>
<dt>*  KDF_AES_128_CMAC</dt>
<dd>based on AES-CMAC-PRF-128
                <a class='info' href='#RFC4615'>[RFC4615]<span> (</span><span class='info'>Song, J., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The Advanced Encryption Standard-Cipher-based Message Authentication Code-Pseudo-Random Function-128 (AES-CMAC-PRF-128) Algorithm for the Internet Key Exchange Protocol (IKE),&rdquo; August&nbsp;2006.</span><span>)</span></a>
</dd>
</dl></blockquote>

<p>
</p>
</blockquote>

<p>
</p>
<p>Other KDFs may be defined in future revisions of this document, and
        SHOULD follow this same format as described above.
</p>
<p>
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
The Use of KDF_HMAC_SHA1</h3>

<p>For:
</p>
<p></p>
<blockquote class="text">
<p>PRF(Master_Key, Input, Output_Length)
</p>
</blockquote>

<p>
</p>
<p>KDF_HMAC_SHA1 for TCP-AO has the following values:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- PRF:</dt>
<dd>HMAC-SHA1 <a class='info' href='#RFC2404'>[RFC2404]<span> (</span><span class='info'>Madson, C. and R. Glenn, &ldquo;The Use of HMAC-SHA-1-96 within ESP and AH,&rdquo; November&nbsp;1998.</span><span>)</span></a>
</dd>
<dt>- Master_Key: </dt>
<dd>As provided in the TSAD
</dd>
<dt>- Input:</dt>
<dd>
</dd>
</dl></blockquote>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- i:</dt>
<dd>"0"
</dd>
<dt>- Label:</dt>
<dd>"TCP-AO"
</dd>
<dt>- Context:</dt>
<dd>Conn_Block
</dd>
<dt>- Output_Length</dt>
<dd>160
</dd>
</dl></blockquote>

</blockquote>
<blockquote class="text"><dl>
<dt>- Result:</dt>
<dd>Conn_Key
</dd>
</dl></blockquote>

</blockquote><p>The result is computed by performing HMAC-SHA1(Master_Key,
          Input) and then taking the first (high order) Output_Length, 160
          here, bits. This result is the TCP-AO Conn_Key. The Conn_Key is then
          used as the seed for the MAC function on each segment of the
          connection.
</p>
<p>
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.2"></a><h3>3.1.2.&nbsp;
The Use of KDF_AES_128_CMAC</h3>

<p>For:
</p>
<p></p>
<blockquote class="text">
<p>PRF(Master_Key, Input, Output_Length)
</p>
</blockquote>

<p>
</p>
<p>KDF_AES_128_CMAC for TCP-AO has the following values:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- PRF:</dt>
<dd>AES-CMAC-PRF-128 <a class='info' href='#RFC4615'>[RFC4615]<span> (</span><span class='info'>Song, J., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The Advanced Encryption Standard-Cipher-based Message Authentication Code-Pseudo-Random Function-128 (AES-CMAC-PRF-128) Algorithm for the Internet Key Exchange Protocol (IKE),&rdquo; August&nbsp;2006.</span><span>)</span></a>
</dd>
<dt>- Master_Key: </dt>
<dd>As provided in the TSAD
</dd>
<dt>- Input:</dt>
<dd>
</dd>
</dl></blockquote>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- i:</dt>
<dd>"0"
</dd>
<dt>- Label:</dt>
<dd>"TCP-AO"
</dd>
<dt>- Context:</dt>
<dd>Conn_Block
</dd>
<dt>- Output_Length</dt>
<dd>128
</dd>
</dl></blockquote>

</blockquote>
<blockquote class="text"><dl>
<dt>- Result:</dt>
<dd>Conn_Key
</dd>
</dl></blockquote>

</blockquote><p>The result is computed by performing
          AES-CMAC-PRF-128(Master_Key, Input) and then taking the first (high
          order) Output_Length, 128, bits. This result is the TCP-AO Conn_Key.
          The Conn_Key is then used as the seed for the MAC function on each
          segment of the connection.
</p>
<p>Since the Master_Key in the TCP-AO manual key mode is a
          pre-shared key (PSK) passed in an out of band mecahnism between two
          devices, and often between two organizations, it is assumed to be of
          variable length. Therefore it may not have 16 octets / 128 bits, as
          is required as an input length to AES-128. We could mandate that
          implementations force administrators to input only keys of such
          length, and with sufficient randomness, but this places undue burdon
          on the deployers. Instead, to make things easier on the deployers,
          we use the AES-CMAC-PRF-128 mechanism represented in <a class='info' href='#RFC4615'>[RFC4615]<span> (</span><span class='info'>Song, J., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The Advanced Encryption Standard-Cipher-based Message Authentication Code-Pseudo-Random Function-128 (AES-CMAC-PRF-128) Algorithm for the Internet Key Exchange Protocol (IKE),&rdquo; August&nbsp;2006.</span><span>)</span></a>, Sect 3, with a minor change: we never use
          the raw Master_Key (MK) alone if K := MK. Instead, we always assume
          MK is variable length, and we always use both the 0^128, the MK, and
          the MKlen arguments, even when K := MK. Therefore this KDF is always
          a 2 step function, as follows (borrowing the format from <a class='info' href='#RFC4615'>[RFC4615]<span> (</span><span class='info'>Song, J., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The Advanced Encryption Standard-Cipher-based Message Authentication Code-Pseudo-Random Function-128 (AES-CMAC-PRF-128) Algorithm for the Internet Key Exchange Protocol (IKE),&rdquo; August&nbsp;2006.</span><span>)</span></a>):
</p>
<p><br /><hr class="insert" />
<a name="Figure1"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>   +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   +                        KDF-AES-128-CMAC                           +
   +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   +                                                                   +
   + Input  : MK (Variable-length Master_Key)                          +
   +        : I (Input, i.e., the input data of the PRF)               +
   +        : MKlen (length of MK in octets)                           +
   +        : len (length of I in octets)                              +
   + Output : PRV (128-bit Pseudo-Random Variable)                     +
   +                                                                   +
   +-------------------------------------------------------------------+
   + Variable: K (128-bit key for AES-CMAC)                            +
   +                                                                   +
   + Step 1.     K := AES-CMAC(0^128, MK, MKlen);                      +
   + Step 2.   PRV := AES-CMAC(K, I, len);                             +
   +           return PRV;                                             +
   +                                                                   +
   +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: The AES-CMAC-PRF-128 Algorithm for TCP-AO&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<p></p>
<blockquote class="text">
<p>o In Step 1, the 128-bit key, K, for AES-CMAC is derived by
              applying the AES-CMAC algorithm using the 128-bit all-zero
              string as the key and MK as the input message.
</p>
<p>
</p>
<p>o In Step 2, we apply the AES-CMAC algorithm again, this time
              using K as the key and I as the input message. The output of
              this algorithm returns PRV, 128 bits suitable for the seed, the
              Conn_Key, in the AES-CMAC operation over the segment.
</p>
</blockquote>

<p>
</p>
<a name="MACs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
MAC Algorithms</h3>

<p>
</p>
<p>MACs for TCP-AO have the following interface:
</p>
<p></p>
<blockquote class="text">
<p>MAC (Conn_Key(KDF), Message, Truncation)
</p>
</blockquote>

<p>where:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- MAC-algo:</dt>
<dd>MAC Algorithm used
</dd>
<dt>- Conn_Key:</dt>
<dd>Variable; Result of KDF.
</dd>
</dl></blockquote>

<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- KDF:</dt>
<dd>Name of the TCP-AO KDF used
</dd>
</dl></blockquote>

</blockquote>

<p></p>
<blockquote class="text"><dl>
<dt>- Key_Length:</dt>
<dd>Length in bits required for the
                Conn_Key used in this MAC
</dd>
<dt>- Truncation:</dt>
<dd>Length in bits to which the final
                MAC result is truncated before being placed into TCP-AO
                header
</dd>
</dl></blockquote>

<p>
</p>
</blockquote><p>This document specifies two MAC algorithm options for
        generating the MAC for TCP-AO's option header:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>*  HMAC-SHA-1-961</dt>
<dd>based on <a class='info' href='#RFC2404'>[RFC2404]<span> (</span><span class='info'>Madson, C. and R. Glenn, &ldquo;The Use of HMAC-SHA-1-96 within ESP and AH,&rdquo; November&nbsp;1998.</span><span>)</span></a>
</dd>
<dt></dt>
<dd>
</dd>
<dt>*  AES-128-CMAC-96</dt>
<dd>based on <a class='info' href='#RFC4493'>[RFC4493]<span> (</span><span class='info'>Song, JH., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The AES-CMAC Algorithm,&rdquo; June&nbsp;2006.</span><span>)</span></a>
</dd>
</dl></blockquote>

<p>
</p>
</blockquote><p>Both provide a high level of security and efficiency. The
        AES-128-CMAC-96 is potentially more efficient, particularly in
        hardware, but HMAC-SHA-1-96 is more widely used in Internet protocols
        and in most cases could be supported with little or no additional code
        in today's deployed software and devices.
</p>
<p>An important aspect to note about these algorithms' definitions for
        use in TCP-AO is the fact that the MAC outputs are truncated to 96
        bits. AES-128-CMAC-96 produces a 128 bit MAC, and HMAC SHA-1 produces
        a 160 bit result. The MAC output are then truncated to 96 bits to
        provide a reasonable tradeoff between security and message size, for
        fitting into the TCP-AO header.
</p>
<p>
</p>
<p>
</p>
<a name="HMAC-SHA-1-96"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
The Use of HMAC-SHA-1-96</h3>

<p>By definition, HMAC [RFC2104] requires a cryptographic hash
          function. SHA1 will be that has function used for authenticating and
          providing integrity validation on TCP segments with HMAC.
</p>
<p>For:
</p>
<p></p>
<blockquote class="text">
<p>MAC (Conn_Key(KDF), Message, Truncation)
</p>
<p>
</p>
</blockquote>

<p>HMAC-SHA-1-96 for TCP-AO has the following values:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- MAC-algo:</dt>
<dd>MAC Algorithm used
</dd>
<dt>- Conn_Key:</dt>
<dd>Variable; Result of KDF.
</dd>
</dl></blockquote>

<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- KDF:</dt>
<dd>KDF_HMAC_SHA1
</dd>
</dl></blockquote>

</blockquote>

<p></p>
<blockquote class="text"><dl>
<dt>- Key_Length:</dt>
<dd>160 bits
</dd>
<dt>- Truncation:</dt>
<dd>96 bits
</dd>
<dt></dt>
<dd>
</dd>
</dl></blockquote>

</blockquote>

<a name="AES-128-CMAC-96"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
The Use of AES-128-CMAC-96</h3>

<p>In the context of TCP-AO, when we say "AES-128-CMAC-96" we
          actually define a usage of AES-128 as a cipher-based MAC according
          to <a class='info' href='#NIST-SP800-38B'>[NIST&#8209;SP800&#8209;38B]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of           Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a>.
</p>
<p>For:
</p>
<p></p>
<blockquote class="text">
<p>MAC (Conn_Key(KDF), Message, Truncation)
</p>
</blockquote>

<p>AES-128-CMAC-96 for TCP-AO has the following values:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- MAC-algo:</dt>
<dd>AES-128-CMAC-96 <a class='info' href='#RFC4493'>[RFC4493]<span> (</span><span class='info'>Song, JH., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The AES-CMAC Algorithm,&rdquo; June&nbsp;2006.</span><span>)</span></a>
</dd>
<dt>- Conn_Key:</dt>
<dd>Variable; Result of KDF.
</dd>
</dl></blockquote>

<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- KDF:</dt>
<dd>KDF_AES_128_CMAC
</dd>
</dl></blockquote>

</blockquote>

<p></p>
<blockquote class="text"><dl>
<dt>- Key_Length:</dt>
<dd>128 bits
</dd>
<dt>- Truncation:</dt>
<dd>96 bits
</dd>
</dl></blockquote>

</blockquote><p>According to <a class='info' href='#RFC4493'>[RFC4493]<span> (</span><span class='info'>Song, JH., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The AES-CMAC Algorithm,&rdquo; June&nbsp;2006.</span><span>)</span></a>, by default,
          "the length of the output of AES-128-CMAC is 128 bits. It is
          possible to truncate the MAC. The result of the truncation is then
          taken in most significant bits first order. The MAC length must be
          specified before the communication starts, and it must not be
          changed during the lifetime of the key." Therefore, we explicitly
          specify the employed MAC length for TCP-AO to be 96 bits.
</p>
<p>
</p>
<p>
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
UI Labels</h3>

<p>[Note to reviewers: We may want to move this section out to a
      separate doc, or scrap it altogether. I already had it in here when I
      brought it up on the design team call, where it was decided to do it in
      another helper-doc in an ops wg. I didn't have time to yank it before
      the -00 deadline. Let me know what you think of it. I'd like to keep it
      in to make it easy for a future when we have a KMP and need to define
      suites, but I'm more than willing to shelve it until later. Pls
      advise.]
</p>
<p>Implementation experience with other security protocols employing
      cryptography (e.g. IPsec [4303] &amp; TLS [5246]) in manual key mode,
      and with key management protocols (KMPs), has shown that there are so
      many choices for typical system administrators to make that it is
      difficult to achieve interoperability without careful pre-agreement.
      Accordingly, there should be a small number of named cryptographic
      algorithms that cover typical security policies. These algorithms may be
      presented in the administrative interface of the TCP-AO systems
      according to their labels presented here. These will be called "UI
      labels" ("user interface labels"). These labels are optional and do not
      prevent implementers from allowing individual selection of these or
      other security algorithms. These labels should not be considered
      extensions to TCP-AO, or any future KMP that may be used with TCP-AO,
      but instead administrative methods for describing sets of
      configurations.
</p>
<p>Specifically, the transform substructure in TCP-AO (and any future
      KMP) must be used to give the value for each specified option regardless
      of whether or not UI labels are used.
</p>
<p>Implementations that use UI labels SHOULD also provide a management
      interface for specifying values for individual cryptographic options.
      That is, it is unlikely that UI labels are a complete solution for
      matching the security policies of all TCP-AO users, and therefore an
      interface that gives a more complete set of options and technical names
      should be used as well.
</p>
<p>TCP-AO implementations that use these UI labels SHOULD use the labels
      listed here. TCP-AO implementations SHOULD NOT use names different than
      those listed here for the algorithms and uses that are described, and
      MUST NOT use the names listed here for algorithms that do not match
      these values. These requirements are necessary for interoperability.
</p>
<p>Additional labels can be defined by RFCs, or by updating this RFC.
      The strings used to identify UI labels are registered by IANA.
</p>
<p>
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Label &quot;Option-A&quot;</h3>

<p>This label matches the commonly deployed, non-deprecated (i.e.
        non-MD5) security used in devices today.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Protocol:</dt>
<dd>TCP Authentication Option, TCP-AO
            [TCP-AO]
</dd>
<dt>Authentication &amp; Integrity Algorithm:</dt>
<dd>HMAC-SHA-1-96
</dd>
</dl></blockquote><p>where HMAC-SHA-1-96 is defined in Section<a class='info' href='#HMAC-SHA-1-96'>Section&nbsp;3.2.1<span> (</span><span class='info'>The Use of HMAC-SHA-1-96</span><span>)</span></a>. <em></em>
</p>
<p>Moving to a new key by use of the [New_KeyID] field advertisement
        MUST be supported by both parties in this label.
</p>
<p>This label SHOULD be the default provided in the UI. This directive
        should stand only until the "Option-B" label becomes widely deployed.
        Once devices capable of "Option-B" are widely deployed, this document
        should be updated to indicate "Option-B" as the default.
</p>
<p>
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Label &quot;Option-B&quot;</h3>

<p>This label matches the next up and coming, stronger MAC.
</p>
<p></p>
<blockquote class="text"><dl>
<dt>Protocol:</dt>
<dd>TCP Authentication Option, TCP-AO
            [TCP-AO]
</dd>
<dt>Authentication &amp; Integrity Algorithm:</dt>
<dd>AES-128-CMAC-96
</dd>
</dl></blockquote>

<p>where AES-128-CMAC-96 is defined in the Section <a class='info' href='#AES-128-CMAC-96'>Section&nbsp;3.2.2<span> (</span><span class='info'>The Use of AES-128-CMAC-96</span><span>)</span></a>.
</p>
<p>Moving to a new key by use of the [New_KeyID] field advertisement
        MUST be supported by both parties in this label.
</p>
<p>This label SHOULD be the second choice provided in the UI. This
        directive should stand only until the "Option-B" label becomes widely
        deployed. Once devices capable of "Option-B" are widely deployed, this
        document should be updated to indicate "Option-B" as the default.
</p>
<a name="ChangeHistory"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Change History (RFC Editor: Delete before publishing)</h3>

<p>[NOTE TO RFC EDITOR: this section for use during I-D stage only.
      Please remove before publishing as RFC.]
</p>
<p>-00 - original submission
</p>
<p>-01- not yet done (place holder)
</p>
<p></p>
<ul class="text">
<li>adds new stuff.
</li>
</ul>

<p>
</p>
<a name="ToAddress"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Needs Work in Next Draft (RFC Editor: Delete Before Publishing)</h3>

<p>[NOTE TO RFC EDITOR: this section for use during I-D stage only.
      Please remove before publishing as RFC.]
</p>
<p>List of stuff that still needs work</p>
<ul class="text">
<li>fix the iana registry section. Need registry entries for the KDFs
          and all the other values?
</li>
<li>
</li>
</ul>

<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>This document inherits all of the security considerations of the
      TCP-AO, the AES-CMAC, and the HMAC-SHA-1 documents.
</p>
<p>The security of cryptographic-based systems depends on both the
      strength of the cryptographic algorithms chosen and the strength of the
      keys used with those algorithms. The security also depends on the
      engineering of the protocol used by the system to ensure that there are
      no non-cryptographic ways to bypass the security of the overall
      system.
</p>
<p>Care should also be taken to ensure that the selected key is
      unpredictable, avoiding any keys known to be weak for the algorithm in
      use. [RFC4086] contains helpful information on both key generation
      techniques and cryptographic randomness.
</p>
<p>Note that in the composition of KDF_AES_128_CMAC, the PRF needs a 128
      bit / 16 byte key as the seed. However, for convenience to the
      administrators/deployers, we did not want to force them to enter a 16
      byte Master_Key. So we specified the sub-key routine that could handle a
      variable length Master_Key, one that might be less than 16 bytes. This
      does NOT mean that administrators are safe to use weak keys.
      Administrators are encouraged to follow [RFC4086] as listed above. We
      simply attempted to "put a fence around stupidity", in as much as
      possible.
</p>
<p>This document concerns itself with the selection of cryptographic
      algorithms for the use of TCP-AO, The algorithms identified in this
      document as "MUST implement" or "SHOULD implement" are not known to be
      broken at the current time, and cryptographic research so far leads us
      to believe that they will likely remain secure into the foreseeable
      future. Some of the algorithms may be found in the future to have
      properties significantly weaker than those that were believed at the
      time this document was produced. Expect that new revisions of this
      document will be issued from time to time. Be sure to search for more
      recent versions of this document before implementing.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>
</p>
<p>IANA has created and will maintain a registry called, "Cryptographic
      Labels for TCP-AO". The registry consists of a text string and an RFC
      number that lists the associated transform(s). New entries can be added
      to the registry only after RFC publication and approval by an expert
      designated by the IESG.
</p>
<p>The initial values for the new registry are:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Identifier</dt>
<dd>Defined In
</dd>
<dt>-----------------</dt>
<dd>-------------------------
</dd>
<dt>Option-A</dt>
<dd>[this document as an RFC]
</dd>
<dt>Option-B</dt>
<dd>[this document as an RFC]
</dd>
</dl></blockquote>

</blockquote>

<p>
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Acknowledgements</h3>

<p>Paul Hoffman, from whose [RFC 4308] I largely followed, and sometimes
      copied, to quickly create a very similar document for TCP-AO.
</p>
<p>Tim Polk, whose email summarizing SAAG's guidance to TCPM on the two
      hash algorithms for TCP-AO is largely cut and pasted into various
      sections of this document.
</p>
<p>Jeff Schiller, Donald Eastlake and the IPsec WG, whose <a class='info' href='#RFC4307'>[RFC4307]<span> (</span><span class='info'>Schiller, J., &ldquo;Cryptographic Algorithms for Use in the Internet Key Exchange Version 2 (IKEv2),&rdquo; December&nbsp;2005.</span><span>)</span></a> &amp; [4305] text comprised most of the
      Requirements [LINK] section of this document.
</p>
<p>(In other words, I was truly only an editor of others' text in
      creating this document.)
</p>
<p>Eric "EKR" Rescorla and Brian Weis, who brought to clarity the issues
      with the inputs to PRFs for the KDFs, and was of great assistance in how
      to structure the text, as well as the correct cryptographic
      decisions.
</p>
<p>
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>10.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="HMAC-ATTACK">[HMAC-ATTACK]</a></td>
<td class="author-text">&ldquo;<a href="http://eprint.iacr.org/2006/187  http://www.springerlink.com/content/00w4v62651001303">On the Security of HMAC and NMAC Based
          on HAVAL, MD4, MD5, SHA-0 and SHA-1"</a>,&rdquo; 2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tcpm-tcp-auth-opt">[I-D.ietf-tcpm-tcp-auth-opt]</a></td>
<td class="author-text">Touch, J., Mankin, A., and R. Bonica, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-auth-opt-11.txt">The TCP Authentication Option</a>,&rdquo; draft-ietf-tcpm-tcp-auth-opt-11 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-auth-opt-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.narten-iana-considerations-rfc2434bis">[I-D.narten-iana-considerations-rfc2434bis]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-narten-iana-considerations-rfc2434bis-09.txt">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; draft-narten-iana-considerations-rfc2434bis-09 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-narten-iana-considerations-rfc2434bis-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST-SP800-108">[NIST-SP800-108]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Recommendation for Key Derivation Using
          Pseudorandom Functions,&rdquo; SP&nbsp;800-108, April&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST-SP800-38B">[NIST-SP800-38B]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of
          Operation: The CMAC Mode for Authentication,&rdquo; SP&nbsp;800-38B, May&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2401">[RFC2401]</a></td>
<td class="author-text"><a href="mailto:kent@bbn.com">Kent, S.</a> and <a href="mailto:rja@corp.home.net">R. Atkinson</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2401">Security Architecture for the Internet Protocol</a>,&rdquo; RFC&nbsp;2401, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2401.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2401.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2401.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2404">[RFC2404]</a></td>
<td class="author-text"><a href="mailto:cmadson@cisco.com">Madson, C.</a> and <a href="mailto:rob.glenn@nist.gov">R. Glenn</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2404">The Use of HMAC-SHA-1-96 within ESP and AH</a>,&rdquo; RFC&nbsp;2404, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2404.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2404.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2404.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2406">[RFC2406]</a></td>
<td class="author-text"><a href="mailto:kent@bbn.com">Kent, S.</a> and <a href="mailto:rja@corp.home.net">R. Atkinson</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2406">IP Encapsulating Security Payload (ESP)</a>,&rdquo; RFC&nbsp;2406, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2406.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2406.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2406.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4307">[RFC4307]</a></td>
<td class="author-text">Schiller, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4307">Cryptographic Algorithms for Use in the Internet Key Exchange Version 2 (IKEv2)</a>,&rdquo; RFC&nbsp;4307, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4307.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4308">[RFC4308]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc4308">Cryptographic Suites for IPsec</a>,&rdquo; RFC&nbsp;4308, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4308.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4493">[RFC4493]</a></td>
<td class="author-text">Song, JH., Poovendran, R., Lee, J., and T. Iwata, &ldquo;<a href="http://tools.ietf.org/html/rfc4493">The AES-CMAC Algorithm</a>,&rdquo; RFC&nbsp;4493, June&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4493.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4615">[RFC4615]</a></td>
<td class="author-text">Song, J., Poovendran, R., Lee, J., and T. Iwata, &ldquo;<a href="http://tools.ietf.org/html/rfc4615">The Advanced Encryption Standard-Cipher-based Message Authentication Code-Pseudo-Random Function-128 (AES-CMAC-PRF-128) Algorithm for the Internet Key Exchange Protocol (IKE)</a>,&rdquo; RFC&nbsp;4615, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4615.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gregory Lebovitz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1194 North Mathilda Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089-1206</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gregory.ietf@gmail.com">gregory.ietf@gmail.com</a></td></tr>
</table>
</body></html>
