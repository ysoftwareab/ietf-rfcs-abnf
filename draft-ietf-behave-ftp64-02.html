<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>IPv6-to-IPv4 translation FTP considerations</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="IPv6-to-IPv4 translation FTP considerations">
<meta name="keywords" content="Internet-Draft, FTP, SIIT, NAT64">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Behavior Engineering for Hindrance</td><td class="header">I. van Beijnum</td></tr>
<tr><td class="header">Avoidance</td><td class="header">IMDEA Networks</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">May 14, 2010</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">&nbsp;</td></tr>
<tr><td class="header">Expires: November 15, 2010</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />IPv6-to-IPv4 translation FTP considerations<br />draft-ietf-behave-ftp64-02</h1>

<h3>Abstract</h3>

<p>
The File Transfer Protocol has a very long history, and despite the fact that today, other options exist to perform file transfers, FTP is still in common use. As such, it is important that in the situation where some client computers are IPv6-only while many servers are still IPv4-only and IPv6-to-IPv4 translators are used to bridge that gap, FTP is made to work through these translators as best it can.
			
</p>
<p>
FTP has an active and a passive mode, both as original commands that are IPv4-specific, and as extended, IP version agnostic commands. The only FTP mode that works without changes through an IPv6-to-IPv4 translator is extended passive. However, many existing FTP servers do not support this mode, and some clients do not ask for it. This document describes server, client and middlebox (if any) behavior that minimizes this problem.
			
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on November 15, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#intro">1.</a>&nbsp;
Introduction<br />
<a href="#anchor1">2.</a>&nbsp;
Notational Conventions<br />
<a href="#anchor2">3.</a>&nbsp;
Terminology<br />
<a href="#anchor3">4.</a>&nbsp;
ALG functionality<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#controlchanneltranslation">4.1.</a>&nbsp;
Control channel translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#epsv2pasv">4.2.</a>&nbsp;
EPSV to PASV translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.3.</a>&nbsp;
EPRT to PORT translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.3.1.</a>&nbsp;
Stateless EPRT translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">4.3.2.</a>&nbsp;
Stateful EPRT translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.4.</a>&nbsp;
Default port 20 translation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.5.</a>&nbsp;
Both PORT and PASV<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.6.</a>&nbsp;
Default behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#algs">4.7.</a>&nbsp;
The ALGS command<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.8.</a>&nbsp;
Timeouts and translating to NOOP<br />
<a href="#anchor11">5.</a>&nbsp;
Client recommendations<br />
<a href="#implrec">6.</a>&nbsp;
Server recommendations<br />
<a href="#anchor12">7.</a>&nbsp;
IANA considerations<br />
<a href="#anchor13">8.</a>&nbsp;
Security considerations<br />
<a href="#anchor14">9.</a>&nbsp;
Contributors<br />
<a href="#anchor15">10.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">11.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">11.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">11.2.</a>&nbsp;
Informative References<br />
<a href="#anchor18">Appendix&nbsp;A.</a>&nbsp;
Document and discussion information<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
</p>
<br clear="all" />

<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
<a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> specifies two modes of operation for FTP: active mode, in which the server connects back to the client and passive mode, where the server opens a port for the client to connect to. Without additional action, active mode with a client-supplied port does not work through NATs or firewalls. With active mode, the PORT command has an IPv4 address as its argument, and in passive mode, the server responds to the PASV command with an IPv4 address. This makes both the passive and active modes as originally specified in <a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> incompatible with IPv6. These issues were solved in <a class='info' href='#RFC2428'>[RFC2428]<span> (</span><span class='info'>Allman, M., Ostermann, S., and C. Metz, &ldquo;FTP Extensions for IPv6 and NATs,&rdquo; September&nbsp;1998.</span><span>)</span></a>, which introduces the EPSV (extended passive) command, where the server only responds with a port number, and the EPRT (extended port) command, which allows the client to supply either an IPv4 or an IPv6 address (and a port) to the server.
			
</p>
<p>
A survey done in April of 2009 of 25 randomly picked and/or well-known FTP sites reachable over IPv4 showed that only 12 of them supported EPSV over IPv4. Additionally, only 2 of those 12 indicated that they supported EPSV in response to the FEAT command introduced in <a class='info' href='#RFC2389'>[RFC2389]<span> (</span><span class='info'>Hethmon, P. and R. Elz, &ldquo;Feature negotiation mechanism for the File Transfer Protocol,&rdquo; August&nbsp;1998.</span><span>)</span></a> that asks the server to list its supported features. One supported EPSV but not FEAT. In 5 cases, issuing the EPSV command to the server led to a significant delay, in 3 cases followed by a control channel reset. All 25 servers were able to successfully complete a transfer in traditional passive PASV mode as required by <a class='info' href='#RFC1123'>[RFC1123]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Application and Support,&rdquo; October&nbsp;1989.</span><span>)</span></a>. More tests showed that the use of an address family argument with the EPSV command is widely mis- or unimplemented in servers. The additional tests with more servers showed that approximately 65% of FTP servers support EPSV successfully and around 96% support PASV successfully. Clients were not extensively tested, but previous experience from the author suggests that most clients support PASV, with the notable exception of the command line client included with Windows, which only supports active mode. This FTP client uses the original PORT command when running over IPv4 and EPRT when running over IPv6.
			
</p>
<p>
Considering the above, this document describes the following recommendations:
			
</p>
<p>
</p>
<blockquote class="text">
<p>Servers:
</p>
<ul class="text">
<li>Allow EPSV (even for IPv4-only servers)
</li>
<li>Use a predictable address in the response to the PASV command
</li>
</ul>


<p>Clients:
</p>
<ul class="text">
<li>Use EPSV over IPv6 rather than EPRT
</li>
<li>Fall back to PASV if EPSV fails (even over IPv6)
</li>
<li>Do not use certain modes and options that trigger server bugs
</li>
</ul>


</blockquote><p>

</p>
<p>
Additionally, the document standardizes behavior for application layer gateway functionality to provide connectivity between unupdated servers and/or clients.
Clients that want to engage in more complex behavior, such as server-to-server transfers, may make an FTP ALG go into transparent mode by issuing an AUTH command as explained in <a class='info' href='#controlchanneltranslation'>Section&nbsp;4.1<span> (</span><span class='info'>Control channel translation</span><span>)</span></a>.
			
</p>
<p>
The recommendations and specifications in this document apply to all forms of IPv6-to-IPv4 translation, including stateless translation such as <a class='info' href='#RFC2765'>[RFC2765]<span> (</span><span class='info'>Nordmark, E., &ldquo;Stateless IP/ICMP Translation Algorithm (SIIT),&rdquo; February&nbsp;2000.</span><span>)</span></a> or <a class='info' href='#I-D.ietf-behave-v6v4-xlate'>[I&#8209;D.ietf&#8209;behave&#8209;v6v4&#8209;xlate]<span> (</span><span class='info'>Li, X., Bao, C., and F. Baker, &ldquo;IP/ICMP Translation Algorithm,&rdquo; December&nbsp;2009.</span><span>)</span></a> as well as stateful translation such as <a class='info' href='#I-D.ietf-behave-v6v4-xlate-stateful'>[I&#8209;D.ietf&#8209;behave&#8209;v6v4&#8209;xlate&#8209;stateful]<span> (</span><span class='info'>Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers,&rdquo; March&nbsp;2010.</span><span>)</span></a>.
			
</p>
<p>
The FTP protocol allows for complex interactions, such as the situation where a client connects to two servers and directs the servers to exchange data between them. No attempt is made to address these other than through making ALGs transparent after an AUTH command.
			
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Notational Conventions</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
      "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
      document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Terminology</h3>

<p>
Within the context of this document, the words "client" and "server" refer to FTP client and server implementations, respectively. An FTP server is understood to be an implementation of the FTP protocol running on a server system with a stable address, waiting for clients to connect and issue commands and start data transfers. Clients interact with servers using the FTP protocol, and store (upload files) to or retrieve (download files) from one or more servers, either interactively under control of a user, or as an unattended background process. Most operating systems provide a web browser that implements a basic FTP client, as well as a command line client. Third-party FTP clients are also widely available.
			
</p>
<p>
Other terminology is derived from the documents listed in the reference section. Note that this document cannot be fully understood on its own; it depends on background and terminology outlined in the references.
			
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
ALG functionality</h3>

<p>
Many within the IETF community argue that an IP version mismatch between FTP clients and FTP servers is better
solved by changing clients and servers rather than
using a translator.
As such, it is recommended to update FTP clients and servers as required for IPv6-to-IPv4 translation support where possible, to allow proper operation of the FTP protocol without the need for ALGs.
			
</p>
<p>
On the other hand, network operators often have little influence over the FTP clients their customers run, let alone the FTP servers used throughout the Internet. For those operators, deploying an ALG may be the only way to provide a satisfactory customer experience. So, even though not the preferred solution, this document standardizes the functionality of such an ALG in order to promote consistent behavior between ALGs in an effort to minimize their harmful effects.
			
</p>
<p>
Operators are encouraged to only deploy an FTP ALG for IPv6-to-IPv4 translation when the FTP ALG is clearly needed. In the presence of the ALG, EPSV commands that could be handled directly by conforming servers are translated into PASV commands, introducing unnecessary complexity and reducing robustness. As such a "set and forget" policy on ALGs is not recommended.
			
</p>
<p>
Note that the translation of EPSV through all translators and EPRT through a stateless translator is relatively simple and translation of EPRT through a stateful translator relatively difficult because a translation mapping must be set up. This needs to happen before the EPRT command can be translated into a PORT command and passed on to the server. As such, an ALG used with a stateful translator MUST support EPSV and MAY support EPRT. However, an ALG used with a stateless translator SHOULD also support EPRT.
			
</p>
<p>
The ALG functionality is described as a function separate from the IPv6-to-IPv4 translation function. However, in the case of EPRT translation, the ALG and translator functions need to be tightly coupled, so in EPRT translation is supported, it is assumed that the ALG and IPv6-to-IPv4 translation functions are integrated within a single device.
			
</p>
<a name="controlchanneltranslation"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Control channel translation</h3>

<p>
The IPv6-to-IPv4 FTP ALG intercepts all TCP sessions towards IPv4 port 21 destinations. The FTP ALG implements the Telnet protocol (<a class='info' href='#RFC0854'>[RFC0854]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;Telnet Protocol Specification,&rdquo; May&nbsp;1983.</span><span>)</span></a>) used for control channel interactions to the degree necessary to interpret commands and responses and re-issue those commands and responses, modifying them as outlined below. Telnet option negotiation attempts by either the client or the server, except for those allowed by <a class='info' href='#RFC1123'>[RFC1123]<span> (</span><span class='info'>Braden, R., &ldquo;Requirements for Internet Hosts - Application and Support,&rdquo; October&nbsp;1989.</span><span>)</span></a>, MUST be rejected by the FTP ALG without relaying those attempts. This avoids the situation where the client and the server negotiate Telnet options unknown to the FTP ALG.
			
</p>
<p>
There are two ways to implement the control channel ALG:
			
</p>
<ol class="text">
<li>
The ALG terminates the IPv6 TCP session, sets up a new IPv4 TCP session towards the IPv4 FTP server, and relays commands and responses back and forth between the two sessions.
			
</li>
<li>
Packets that are part of the control channel are translated individually.
			
</li>
</ol>
<p>
In the second case, an implementation MUST have the ability to track and update TCP sequence numbers when translating packets and break up packets into smaller packets after translation, as the control channel translation could modify the length of the payload portion of the packets in question. Also, FTP commands/responses or Telnet negotiations could straddle packet boundaries, so in order to be able to perform the ALG function, it can prove necessary to reconstitute Telnet negotiations and FTP commands and responses from multiple packets.
			
</p>
<p>
If the client issues the AUTH command the client is attempting to negotiate <a class='info' href='#RFC2228'>[RFC2228]<span> (</span><span class='info'>Horowitz, M., &ldquo;FTP Security Extensions,&rdquo; October&nbsp;1997.</span><span>)</span></a> security mechanisms which are likely to be incompatible with the FTP ALG function. In this situation, the FTP ALG MUST switch to transparently forwarding all data on the control channel in both directions until the end of the control channel session. This requirement applies regardless of the response from the server. In other words, it is the fact that the client attempts the AUTH negotiation that requires the ALG to become transparent, whether or not the attempt is successful. The transparency requirement applies to the commands and responses flowing between the client and the server. It is possible that commands or responses that were sent through the ALG before the AUTH command was issued were changed in length so TCP sequence numbers in packets entering the ALG and packets exiting the ALG no longer match. In transparent mode, the ALG MUST continue to adjust sequence numbers if it was doing so before entering transparent mode as the result of the AUTH command. The ALGS command (<a class='info' href='#algs'>Section&nbsp;4.7<span> (</span><span class='info'>The ALGS command</span><span>)</span></a>) MAY have a similar effect as the AUTH command, depending on the argument used.
			
</p>
<p>
There have been FTP ALGs for the purpose of making active FTP work through IPv4 NATs for a long time. Another type of ALG would be one that imposes restrictions required by security policies. Multiple ALGs can be implemented as a single entity. If such a multi-purpose ALG forbids the use of the AUTH command for policy reasons, the side effect of making the ALG stop performing the translations described here, as well as other possible interventions related to IPv6-to-IPv4 translation, MUST be retained even if the ALG responds to the AUTH command with an error and does not propagate the command to the server. Implementers are further advised that unlike hosts behind an IPv4 NAT, IPv6 hosts using an IPv6-to-IPv4 translator will normally have the ability to execute FTP over IPv6 without interference from the IPv6-to-IPv4 translator or the ALG, so an IPv6-to-IPv4 translation FTP ALG is not the best place to implement security policies.
			
</p>
<a name="epsv2pasv"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
EPSV to PASV translation</h3>

<p>
Although many IPv4 FTP servers support the EPSV command, some servers react adversely to this command, and there is no reliable way to detect in advance that this will happen. As such, an FTP ALG MUST translate all occurrences of the EPSV command issued by the client to the PASV command, and reformat a 227 response as a corresponding 229 response. However, an ALG MAY forego EPSV to PASV translation if it has positive knowledge, either trough administrative configuration or learned dynamically, that EPSV will be successful without translation to PASV.
			
</p>
<p>
For instance, if the client issues EPSV (or EPSV 2 to indicate IPv6 as the network protocol), this is translated to the PASV command. If the server with address 192.0.2.31 then responds with:
			
</p>
<blockquote class="text">
<p>
227 Entering Passive Mode (192,0,2,31,237,19)
			
</p>
</blockquote>
<p>
The FTP ALG reformats this as:
			
</p>
<blockquote class="text">
<p>
229 Entering Extended Passive Mode (|||60691|)
			
</p>
</blockquote>
<p>
The ALG SHOULD ignore the IPv4 address in the server's 227 response. This is the behavior that is exhibited by most clients and is needed to work with servers that include <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a> addresses in their 227 responses. However, if the 227 response contains an IPv4 address that does not match the destination of the control channel, the FTP ALG MAY send the following response to the client instead of the 229 response:
			
</p>
<blockquote class="text">
<p>
425 Can't open data connection.
			
</p>
</blockquote>
<p>
It is important that the response is in the 4xx range to indicate a temporary condition.
			
</p>
<p>
If the client issues an EPSV command with a numeric argument other than 2, the ALG MUST NOT pass the command on to the server, but rather respond with a 522 error.
			
</p>
<p>
If the client issues EPSV ALL, the FTP ALG MUST NOT pass this command to the server, but respond with:
			
</p>
<blockquote class="text">
<p>
504 Command not implemented for that parameter.
			
</p>
</blockquote>
<p>
This avoids the situation where an FTP server reacts adversely to receiving a PASV command after the client indicated that it will only use EPSV during this session.
			
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
EPRT to PORT translation</h3>

<p>
Should the IPv6 client issue an EPRT command, the FTP ALG MAY translate this EPRT command to a PORT command. The translation is different depending on whether the translator is a stateless one-to-one translator or a stateful one-to-many translator.
			
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.1"></a><h3>4.3.1.&nbsp;
Stateless EPRT translation</h3>

<p>
If the address specified in the EPRT command is the client's IPv6 address, then the FTP ALG reformats the EPRT command into a PORT command with the IPv4 address that maps to the client's IPv6 address. The port number must be preserved for compatibility with stateless translators. For instance, if the client with IPv6 address 2001:db8:2::31 issues EPRT the EPRT command:
			
</p>
<blockquote class="text">
<p>
EPRT |2|2001:db8:2::31|5282|
			
</p>
</blockquote>
<p>
Assuming the IPv4 address that goes with 2001:db8:2::31 is 192.0.2.31, the FTP ALG reformats this as:
			
</p>
<blockquote class="text">
<p>
PORT 192,0,2,31,20,162
			
</p>
</blockquote>
<p>
If the address specified in the EPRT command is an IPv4 address or an IPv6 address that is not the client's IPv6 address, the ALG's response is undefined. It may pass along the command unchanged, respond with an error, or attempt to perform an appropriate translation.
			
</p>
<p>
If the address specified in the EPRT command is an IPv4 address or an IPv6 address that is the client's IPv6 address, but there is no IPv4 address that maps to the client's IPv6 address, the ALG responds as follows:
			
</p>
<blockquote class="text">
<p>
425 Can't open data connection.
			
</p>
</blockquote>
<p>
It is important that the response is in the 4xx range to indicate a temporary condition.
			
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3.2"></a><h3>4.3.2.&nbsp;
Stateful EPRT translation</h3>

<p>
If the address in the EPRT command is the IPv6 address of the control channel client's address, the stateful translator selects an unused port number in combination with the IPv4 address used for the control channel towards the FTP server, and sets up a mapping from that transport address to the one specified by the client in the EPRT command. The PORT command with the IPv4 address and port used on the IPv4 side of the mapping is only issued towards the server once the mapping is created. Initially, the mapping is such that either any transport address or the FTP server's IPv4 address with any port number is accepted as a source, but once the three-way handshake is complete, the mapping SHOULD be narrowed to only match the negotiated TCP session.
			
</p>
<p>
If the address in the EPRT command is not the client's IPv6 address, the ALG's response is undefined.
			
</p>
<p>
If the client with IPv6 address 2001:db8:2::31 issues the EPRT command:
			
</p>
<blockquote class="text">
<p>
EPRT |2|2001:db8:2::31|5282|
			
</p>
</blockquote>
<p>
And the stateful translator uses the address 192.0.2.31 on its IPv4 interface, a mapping with destination address 192.0.2.31 and destination port 60192 towards 2001:db8:2::31 port 5282 might be created, after which the FTP ALG reformats the EPRT command as:
			
</p>
<blockquote class="text">
<p>
PORT 192,0,2,31,235,32
			
</p>
</blockquote>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.4"></a><h3>4.4.&nbsp;
Default port 20 translation</h3>

<p>
If the client does not issue an EPSV/PASV or EPRT/PORT command prior to initiating a file transfer, it is invoking the default active FTP behavior where the server sets up a TCP session towards the client. In this situation, the source port number is the default FTP data port (port 20) and the destination port is the port the client uses as the source port in the control channel session.
			
</p>
<p>
In the case of a stateless translator, this does not pose any problems. In the case of a stateful translator, the translator SHOULD accept incoming connection requests from the server on the IPv4 side if the transport addresses match that of an existing FTP control channel session, with the exception that the control channel session uses port 21 and the new session port 20. In this case, a mapping is set up towards the same transport address on the IPv6 side that is used for the matching FTP control channel session.
			
</p>
<p>
Note that if multiple clients are using the IPv6-to-IPv4 to communicate with the same FTP server, and for each client the IPv6-to-IPv4 translator uses the same source address on its IPv4 side, incoming FTP data channel sessions cannot be correlated to the intended IPv6 host unambiguously. In such cases, the IPv6-to-IPv4 translator SHOULD refuse the connection establishment attempt by returning a TCP reset packet. An ALG/translator MAY monitor the progress of FTP control channels and only attempt to perform a mapping when an FTP client has started a file transfer without issuing the EPSV, PASV, EPRT or PORT commands.
			
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.5"></a><h3>4.5.&nbsp;
Both PORT and PASV</h3>

<p>
<a class='info' href='#RFC0959'>[RFC0959]<span> (</span><span class='info'>Postel, J. and J. Reynolds, &ldquo;File Transfer Protocol,&rdquo; October&nbsp;1985.</span><span>)</span></a> allows a client to issue both PORT and PASV to use non-default ports on both sides of the connection. However, this is incompatible with the notion that with PASV, the data connection is made from the client to the server, while PORT reaffirms the default behavior where the server connects to the client. As such, the behavior of an ALG is undefined when a client issues both PASV and PORT.
			
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.6"></a><h3>4.6.&nbsp;
Default behavior</h3>

<p>
Whenever the client issues a command which the ALG is not set up to translate, either because the command is not mentioned above, the command is not part of any FTP specification, the ALG functionality is disabled administratively or otherwise for the command in question, or translation does not apply for any other reason, the command MUST be passed on to the server without modification, and the server response MUST be passed on to the client without any modification. For example, if the client issues the PASV command, this command is passed on to the server transparently.
			
</p>
<a name="algs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.7"></a><h3>4.7.&nbsp;
The ALGS command</h3>

<p>
ALGs SHOULD support the new ALGS (ALG status) command that allows clients to query and set ALG status. Note that this command MUST NOT be implemented in FTP servers. If the ALGS command is invoked without arguments, the ALG SHOULD answer with a status code that indicates whether EPSV is translated to PASV and/or EPRT is translated to PORT. There are four possible responses:
			
</p>
<blockquote class="text"><dl>
<dt>216 NONE</dt>
<dd>Neither EPSV nor EPRT translation is performed.
</dd>
<dt>216 EPSV</dt>
<dd>EPSV is translated to PASV, no EPRT translation is performed.
</dd>
<dt>216 EPRT</dt>
<dd>EPRT is translated to PORT, no EPSV translation is performed.
</dd>
<dt>216 BOTH</dt>
<dd>EPSV is translated to PASV, EPRT is translated to PORT.
</dd>
</dl></blockquote>
<p>
The four letter translation type MAY be followed by a space and additional descriptive text until end-of-line. If the ALGS command is not implemented, a 502 response SHOULD be returned.
			
</p>
<p>
A client can also use the ALGS command to request certain translation behavior from the ALG. There are four possible arguments to the ALGS command:
			
</p>
<blockquote class="text"><dl>
<dt>ALGS NONE</dt>
<dd>The ALG is requested to perform neither EPSV nor EPRT translation.
</dd>
<dt>ALGS EPSV</dt>
<dd>The ALG is requested to perform EPSV to PASV translation, but not EPRT translation.
</dd>
<dt>ALGS EPRT</dt>
<dd>The ALG is requested to perform EPRT to PORT translation, but not EPSV translation.
</dd>
<dt>ALGS BOTH</dt>
<dd>The ALG is requested to perform both EPSV to PASV and EPRT to PORT translation.
</dd>
</dl></blockquote>
<p>
The ALG SHOULD set the requested translation mode where possible. If EPSV translation is supported and PORT translation is not, EPRT becomes the equivalent of NONE and BOTH the equivalent of EPSV. After changing the translation modes where possible, the ALG returns a 216 response indicating the now current ALG status as described above. This status can be different from the one requested by the client.
			
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.8"></a><h3>4.8.&nbsp;
Timeouts and translating to NOOP</h3>

<p>
Wherever possible, control channels should not time out while there is an active data channel. A timeout of at least 30 seconds is recommended for data channel mappings created by the FTP ALG that are waiting for initial packets.
			
</p>
<p>
Whenever a command from the client is not propagated to the server, the FTP ALG instead issues a NOOP command in order to keep the keepalive state between the client and the server synchronized. The response to the NOOP command MUST NOT be relayed back to the client. An implementation MAY wait for the server to return the 200 response to the NOOP and translate that 200 response into the response the ALG is required to return to the client. This way, the ALG never has to create new packets to send to the client, but it can limit itself to modifying packets transmitted by the server.
If the server responds with something other than 200 to the NOOP command, the ALG MUST tear down the control channel session and log an error.
			
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Client recommendations</h3>

<p>
All FTP clients are encouraged to support EPSV when communicating over IPv6 and always attempt to use EPSV mode unless explicitly configured to use EPRT.
			
</p>
<p>
It is highly recommended that FTP clients react by retrying with PASV when the EPSV command fails, either because of an error response by the server (40x, 42x, 50x and 52x responses), because the data connection could not be created or because the control channel session was terminated. 

When after attempting to initiate EPSV and/or EPRT modes unsuccessfully and a client retries with PASV, the server will respond to the PASV command with an IPv4 address that the client is supposed to use to connect to for the data connection. Even if the client has IPv4 reachability, it is better to ignore the server-supplied address and set up a data connection towards the IPv6 address of the server that is used for the control channel session. However, in this case the port number used for the data connection is taken from the 227 response to the PASV command as usual.
			
</p>
<p>
If a client falls back to PASV after attempting EPSV/EPRT unsuccessfully, a client could cache the name or address of the FTP server and issue PASV rather than EPSV in future sessions. In that case, the cache entry might be cleared if sufficient time has passed that the server may have been updated. The suggested time for removal of a server from this case is 7 days, 1 day when the server indicates EPSV support in its FEAT response where it previously did not.
			
</p>
<p>
There is always a risk that an error was the result of a condition unrelated to IPv6-to-IPv4 translation. However, retrying with a PASV request has little potential for harm, so unless the error is clearly unrelated, retrying with PASV is the appropriate reaction.
			
</p>
<p>
The main rationale for ignoring the IPv4 address in the 227 response, even if the client has IPv4 connectivity, most servers will only allow a data connection from the same client address as seen in the control channel connection, see <a class='info' href='#Bernstein'>[Bernstein]<span> (</span><span class='info'>Bernstein, D., &ldquo;PASV security and PORT security,&rdquo; 2000.</span><span>)</span></a>. Using IPv6 for the control channel and IPv4 for the data channel means that the source address will almost certainly be different in both cases, making it unlikely that the data connection can be established successfully. Also, IPv4 reachability towards the server-supplied address may or may not exist, while IPv6 reachability has been established by virtue of the control channel connection.
			
</p>
<p>
Clients do best to refrain from using any arguments with the EPSV command. "EPSV 2" to request IPv6 will fail across an IPv6-to-IPv4 translator. Also, this command is often not handled properly by IPv6 servers. "EPSV ALL" indicates that the client will use EPSV for all transfers, but an ALG could translate EPSV commands to PASV commands, conflicting with the earlier "EPSV ALL", so the control channel session cannot be continued successfully.
			
</p>
<a name="implrec"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Server recommendations</h3>

<p>
As EPSV works through IPv6-to-IPv4 translation transparently without additional effort on the part of the client, the server or an application layer gateway, it is highly recommended that all servers implement EPSV.

</p>
<p>
<a class='info' href='#RFC2428'>[RFC2428]<span> (</span><span class='info'>Allman, M., Ostermann, S., and C. Metz, &ldquo;FTP Extensions for IPv6 and NATs,&rdquo; September&nbsp;1998.</span><span>)</span></a> suggests that the EPSV mode is useful both for clients with IPv6 connectivity and for clients operating behind a NAT device. Hence, it is common for IPv6-capable clients to use EPSV even when communicating over IPv4. If a server does not implement EPSV and responds with a 501 or 502 error, the client simply retries with PASV. This works well with both servers that have working EPSV and servers that do not implement EPSV. However, there is a class of servers that does implement EPSV, but is unable to use EPSV mode because the data connection cannot be established successfully. This is very likely the result of a middlebox monitoring the control channel interactions, and creating firewall or translation state according to the information 227 response after a PASV command. With the EPSV command, there is a 229 response and no 227 response, so if the server supports EPSV but the middlebox does not, the result is that the data connection cannot be established and the data transfer fails.

</p>
<p>
To avoid this, it is highly recommended that server implementers include a configuration setting that makes it possible to disable EPSV and EPRT support and respond with a 502 (command not implemented) error instead. Server operators can thus disable EPSV support in servers located behind PASV-only middleboxes so clients that issue EPSV can fall back to PASV gracefully rather than time out.

</p>
<p>
The test performed by Dan Wing showed that existing implementations tend to present the address used for the server side of the control channel connection in the 227 response to a PASV command. Clients following the recommendations in this document depend on this behavior and it allows ALGs to translate a 227 PASV response to a 229 EPSV response without loss of information; as such it is highly recommended that servers continue to implement this limitation. Later tests showed that some servers list <a class='info' href='#RFC1918'>[RFC1918]<span> (</span><span class='info'>Rekhter, Y., Moskowitz, R., Karrenberg, D., Groot, G., and E. Lear, &ldquo;Address Allocation for Private Internets,&rdquo; February&nbsp;1996.</span><span>)</span></a> addresses in their 227 responses. Many of these servers were known to reside behind NAT devices. In these cases, ignoring the address in the 227 response is the desired behavior.
			
</p>
<p>
Many servers that support the FEAT command do not list EPSV and EPRT as a supported feature in the response to the FEAT command. It is recommended that EPSV and EPRT capability is included in the FEAT response, unless EPSV and/or EPRT are administratively disabled as outlined above.
			
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA considerations</h3>

<p>
None.
			
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security considerations</h3>

<p>
In the majority of cases, FTP is used without further security mechanisms. This allows an attacker with passive interception capabilities to obtain the login credentials, and an attacker that can modify packets to change the data transferred. However, FTP can be used with TLS in order to solve these issues. IPv6-to-IPv4 translation and the FTP ALG do not impact the security issues in the former case nor the use of TLS in the latter case. However, if FTP is used with TLS or another authentication mechanism, the ALG function is not performed so only passive transfers from a server that implements EPSV or a client that supports PASV will succeed.
			
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
Contributors</h3>

<p>
Dan Wing, Kentaro Ebisawa, Remi Denis-Courmont,
Mayuresh Bakshi, Sarat Kamisetty, Reinaldo Penno, Alun Jones, Dave Thaler,
Mohammed Boucadair, Mikael Abrahamsson, Dapeng Liu and Michael Liu
contributed ideas and comments.
Dan Wing ran experiments with a large number of FTP servers that were very
illuminating; many of the choices underlying this document are based on
his results. This document adopts several design
decisions from <a class='info' href='#I-D.liu-behave-ftp64'>[I&#8209;D.liu&#8209;behave&#8209;ftp64]<span> (</span><span class='info'>Liu, D. and Z. Cao, &ldquo;IPv6 IPv4 translation FTP considerations,&rdquo; August&nbsp;2009.</span><span>)</span></a>.

</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.10"></a><h3>10.&nbsp;
Acknowledgements</h3>

<p>
Iljitsch van Beijnum is partly funded by Trilogy, a research project supported by the European Commission under its Seventh Framework Program.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.11"></a><h3>11.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC0854">[RFC0854]</a></td>
<td class="author-text">Postel, J. and J. Reynolds, &ldquo;<a href="http://tools.ietf.org/html/rfc854">Telnet Protocol Specification</a>,&rdquo; STD&nbsp;8, RFC&nbsp;854, May&nbsp;1983 (<a href="http://www.rfc-editor.org/rfc/rfc854.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC0959">[RFC0959]</a></td>
<td class="author-text">Postel, J. and J. Reynolds, &ldquo;<a href="http://tools.ietf.org/html/rfc959">File Transfer Protocol</a>,&rdquo; STD&nbsp;9, RFC&nbsp;959, October&nbsp;1985 (<a href="http://www.rfc-editor.org/rfc/rfc959.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1123">[RFC1123]</a></td>
<td class="author-text"><a href="mailto:Braden@ISI.EDU">Braden, R.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1123">Requirements for Internet Hosts - Application and Support</a>,&rdquo; STD&nbsp;3, RFC&nbsp;1123, October&nbsp;1989 (<a href="http://www.rfc-editor.org/rfc/rfc1123.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2389">[RFC2389]</a></td>
<td class="author-text"><a href="mailto:phethmon@hethmon.com">Hethmon, P.</a> and <a href="mailto:kre@munnari.OZ.AU">R. Elz</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2389">Feature negotiation mechanism for the File Transfer Protocol</a>,&rdquo; RFC&nbsp;2389, August&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2389.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2389.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2389.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2228">[RFC2228]</a></td>
<td class="author-text"><a href="mailto:marc@cygnus.com">Horowitz, M.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2228">FTP Security Extensions</a>,&rdquo; RFC&nbsp;2228, October&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2228.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2228.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2228.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2428">[RFC2428]</a></td>
<td class="author-text"><a href="mailto:mallman@lerc.nasa.gov">Allman, M.</a>, <a href="mailto:ostermann@cs.ohiou.edu">Ostermann, S.</a>, and <a href="mailto:cmetz@inner.net">C. Metz</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2428">FTP Extensions for IPv6 and NATs</a>,&rdquo; RFC&nbsp;2428, September&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2428.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2428.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2428.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>11.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1918">[RFC1918]</a></td>
<td class="author-text"><a href="mailto:yakov@cisco.com">Rekhter, Y.</a>, <a href="mailto:rgm3@is.chrysler.com">Moskowitz, R.</a>, <a href="mailto:Daniel.Karrenberg@ripe.net">Karrenberg, D.</a>, <a href="mailto:GeertJan.deGroot@ripe.net">Groot, G.</a>, and <a href="mailto:lear@sgi.com">E. Lear</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1918">Address Allocation for Private Internets</a>,&rdquo; BCP&nbsp;5, RFC&nbsp;1918, February&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1918.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2765">[RFC2765]</a></td>
<td class="author-text"><a href="mailto:nordmark@sun.com">Nordmark, E.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2765">Stateless IP/ICMP Translation Algorithm (SIIT)</a>,&rdquo; RFC&nbsp;2765, February&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2765.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-behave-v6v4-xlate-stateful">[I-D.ietf-behave-v6v4-xlate-stateful]</a></td>
<td class="author-text">Bagnulo, M., Matthews, P., and I. Beijnum, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-v6v4-xlate-stateful-11.txt">Stateful NAT64: Network Address and Protocol Translation from IPv6 Clients to IPv4 Servers</a>,&rdquo; draft-ietf-behave-v6v4-xlate-stateful-11 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-v6v4-xlate-stateful-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-behave-v6v4-xlate">[I-D.ietf-behave-v6v4-xlate]</a></td>
<td class="author-text">Li, X., Bao, C., and F. Baker, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-v6v4-xlate-05.txt">IP/ICMP Translation Algorithm</a>,&rdquo; draft-ietf-behave-v6v4-xlate-05 (work in progress), December&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-behave-v6v4-xlate-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.liu-behave-ftp64">[I-D.liu-behave-ftp64]</a></td>
<td class="author-text">Liu, D. and Z. Cao, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-liu-behave-ftp64-03.txt">IPv6 IPv4 translation FTP considerations</a>,&rdquo; draft-liu-behave-ftp64-03 (work in progress), August&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-liu-behave-ftp64-03.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="Bernstein">[Bernstein]</a></td>
<td class="author-text">Bernstein, D., &ldquo;<a href="http://cr.yp.to/ftp/security.html">PASV security and PORT security</a>,&rdquo; 2000.</td></tr>
</table>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Document and discussion information</h3>

<p>
Please direct questions and
comments to the BEHAVE mailinglist.
The latest version of this document will always be
available at http://www.muada.com/drafts/.

</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Iljitsch van Beijnum</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">IMDEA Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Avda. del Mar Mediterraneo, 22</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Leganes, Madrid  28918</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Spain</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:iljitsch@muada.com">iljitsch@muada.com</a></td></tr>
</table>
</body></html>
