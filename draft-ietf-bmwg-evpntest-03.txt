



Internet Engineering Task Force                            S. Jacob, Ed.
Internet-Draft                                           K. Tiruveedhula
Intended status: Standards Track                        Juniper Networks
Expires: February 22, 2020                               August 21, 2019


             Benchmarking Methodology for EVPN and PBB-EVPN
                      draft-ietf-bmwg-evpntest-03

Abstract

   This document defines methodologies for benchmarking EVPN and PBB-
   EVPN performance.  EVPN is defined in RFC 7432, and is being deployed
   in Service Provider networks.  Specifically this document defines the
   methodologies for benchmarking EVPN/PBB-EVPN convergence, data plane
   performance, and control plane performance.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at https://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on February 22, 2020.

Copyright Notice

   Copyright (c) 2019 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (https://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.



Jacob & Tiruveedhula    Expires February 22, 2020               [Page 1]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   2
     1.1.  Requirements Language . . . . . . . . . . . . . . . . . .   3
     1.2.  Terminologies . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Test Topology . . . . . . . . . . . . . . . . . . . . . . . .   3
   3.  Test Cases for EVPN  Benchmarking . . . . . . . . . . . . . .   6
     3.1.  Local MAC Learning  . . . . . . . . . . . . . . . . . . .   6
     3.2.  Remote MAC Learning . . . . . . . . . . . . . . . . . . .   7
     3.3.  MAC Flush due to local link failure and Relearning  . . .   7
     3.4.  MAC Flush due to remote link failure. . . . . . . . . . .   8
     3.5.  MAC Aging . . . . . . . . . . . . . . . . . . . . . . . .   8
     3.6.  Remote Mac Aging  . . . . . . . . . . . . . . . . . . . .   9
     3.7.  Local and Remote MAC Learning . . . . . . . . . . . . . .   9
     3.8.  High Availability.  . . . . . . . . . . . . . . . . . . .  10
     3.9.  ARP/ND Scale  . . . . . . . . . . . . . . . . . . . . . .  11
     3.10. Scaling of Services . . . . . . . . . . . . . . . . . . .  11
     3.11. Scale Convergence . . . . . . . . . . . . . . . . . . . .  12
     3.12. SOAK Test.  . . . . . . . . . . . . . . . . . . . . . . .  12
   4.  Test Cases for PBB-EVPN  Benchmarking . . . . . . . . . . . .  13
     4.1.  Local MAC Learning  . . . . . . . . . . . . . . . . . . .  13
     4.2.  Remote Mac Learning . . . . . . . . . . . . . . . . . . .  13
     4.3.  MAC Flush due to link failure . . . . . . . . . . . . . .  14
     4.4.  MAC Flush due to remote Failure . . . . . . . . . . . . .  14
     4.5.  MAC aging . . . . . . . . . . . . . . . . . . . . . . . .  15
     4.6.  Remote MAC Aging. . . . . . . . . . . . . . . . . . . . .  16
     4.7.  Local and Remote MAC Learning . . . . . . . . . . . . . .  16
     4.8.  High Availability . . . . . . . . . . . . . . . . . . . .  17
     4.9.  Scale . . . . . . . . . . . . . . . . . . . . . . . . . .  17
     4.10. Scale Convergence . . . . . . . . . . . . . . . . . . . .  18
     4.11. Soak Test . . . . . . . . . . . . . . . . . . . . . . . .  18
   5.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  19
   6.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  19
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .  19
   8.  References  . . . . . . . . . . . . . . . . . . . . . . . . .  19
     8.1.  Normative References  . . . . . . . . . . . . . . . . . .  19
     8.2.  Informative References  . . . . . . . . . . . . . . . . .  20
   Appendix A.  Appendix . . . . . . . . . . . . . . . . . . . . . .  20
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  20

1.  Introduction

   EVPN is defined in RFC 7432, and describes BGP MPLS- based Ethernet
   VPNs (EVPN).  PBB-EVPN is defined in RFC 7623, discusses how Ethernet
   Provider backbone Bridging can be combined with EVPNs to provide a
   new/combined solution.  This draft defines methodologies that can be
   used to benchmark both RFC 7432 and RFC 7623 solutions.  Further,
   this draft provides methodologies for benchmarking the performance of



Jacob & Tiruveedhula    Expires February 22, 2020               [Page 2]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   EVPN data and control planes, MAC learning, MAC flushing, MAC ageing,
   convergence, high availability, and scale.

1.1.  Requirements Language

   The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
   "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
   document are to be interpreted as described in RFC 2119 [RFC2119].

1.2.  Terminologies

   MHPE Multi homed Provide Edge router.

   RR Route Reflector.

   P Provider Router.

   CE Customer Router/Devices/Switch.

   MHPE2 Multi homed Provider Edge router 2.

   MHPE1 Multi homed Provider Edge router 1.

   SHPE3 Single homed Provider Edge Router 3.

   AA EVPN Terminologies AA All-Active.

   SA EVPN Terminologies SA Single-Active.

   RT Router Tester.

   Sub Interface Each physical Interfaces is subdivided in to Logical
   units.

   EVI EVPN Instances which will be running on sub interface or physical
   port of the provider Edge routers.

   DF Designated Forwarder.

   ESI Ethernet Segment Identifier.

2.  Test Topology

   EVPN/PBB-EVPN Services running on SHPE3, MHPE1 and MHPE2 in Single
   Active Mode:






Jacob & Tiruveedhula    Expires February 22, 2020               [Page 3]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


         | [Traffic Generator ] Router Tester traffic sender/receiver of layer 2 traffic with multiple vlan.
+----------+
|          |
|  SHPE3   |
|          |
+----------+
    |
    |Core link
+----------+
|          |
|  RR      |
|          | Route Reflector/Core router
+----------+-------------|
   |                     |
   |     Core links      |
+----------+       +-----------+
|          |       |    MHPE2  |
|   DUT    |       |           |
|  MHPE1   |       |           |
+----------+       +-----------+
     |    PE-CE link    |
+----------+------------
|          |
|  CE      |
|  layer2  |
|bridge    |
+----------+------------ [Traffic Generator](Router Tester sender/reciever of layer 2 traffic with multiple vlan)


Topology 1



                                Test Setup

                                 Figure 1















Jacob & Tiruveedhula    Expires February 22, 2020               [Page 4]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


+-----------------+---------------------+---------------------+---------------------+----------------------+-----------------------+
|                 |                     |                     |                     |                      |                       |
|                 |                     |                     |                     |                      |                       |
|                 |                     |                     |                     |                      |                       |
|                 |                     |                     |                     |                      |                       |
| Mode            |                     |                     |                     |Receiver              |                       |
|                 |  Test               |Traffic Direction    |Sender               |                      |                       |
|                 |                     |                     |                     |                      |                       |
|                 |                     |                     |                     |                      |                       |
|                 |                     |                     |                     |                      |                       |
+----------------------------------------------------------------------------------------------------------------------------------+
|                 |                     |                     |                     |                      |                       |
|                 |                     |                     |                     |      SHPE3           |                       |
|Single Active    |  Local Mac          |                     |CE                   |                      |Layer 2 traffic        |
|                 | Learning            | Uni                 |                     |                      |                       |
|                 |                     |                     |                     |                      | multiple MAC          |
|                 |                     |                     |                     |                      |                       |
+-----------------------------------------------------------------------------------------------------------------------------------+
|                 |                     |                     |                     |                      |                       |
|Single Active    | Remote MAC          |                     |                     |         CE           |Layer 2 traffic        |
|                 | Learning            | uni                 | SHPE3               |                      |                       |
|                 |                     |                     |                     |                      |multiple MAC           |
|                 |                     |                     |                     |                      |                      ++
+----------------------------------------------------------------------------------------------------------------------------------+
|                 |                     |                     |                     |                      |                       |
|Single Active    | Scale Convergence   |   Bi                |                     |  CE/SHPE3            |                       |
|                 |                     |                     |   CE/SHPE3          |                      |Layer 2 traffic        |
|                 | Local& Remote       |                     |                     |                      |multiple mac& vlans    |
|                 | Learning            |                     |                     |                      |                       |
+-----------------+---------------------+---------------------+--------------------------------------------+-----------------------+
                                                                                    |
                                                                                   ++




              Table showing Traffic pattern for various test

                                 Figure 2

   Test Setup Configurations:

   There are five routers in the Test setup.  SHPE3, RR/P, MHPE1 and
   MHPE2 emulating a service provider network.  CE is a customer device
   connected to MHPE1 and MHPE2, it is configured with bridge domains in
   multiple vlans.  The router tester is connected to CE and SHPE3.The
   MHPE1 acts as DUT.The RT will be used as sender and receiver of
   traffic.The measurement will be taken in DUT.



Jacob & Tiruveedhula    Expires February 22, 2020               [Page 5]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   All routers except CE is configured with OSPF/IS-IS,LDP,MPLS,BGP with
   EVPN address family.

   All routers except CE must have IBGP configured with RR acting as
   route reflector.

   MHPE1,MHPE2,SHPE3 must be configured with "N" EVPN/PBB-EVPN instances
   depends up on the cases.

   MHPE1 and MHEPE2 must be configured with ESI per vlan or ESI on IFD.

   MHPE1 and MHEPE2 are running Single Active mode of EVPN.

   CE is acting as bridge configured with vlans that is configured on
   MHPE1,MHPE2,SHPE3.

   Depends up on the test traffic will be flowing uni directional or bi
   directional depends on the test performed.

   The above configuration will be serving as the base configuration for
   all test cases.

3.  Test Cases for EVPN Benchmarking

3.1.  Local MAC Learning

   Objective:

   To Record the time taken to learn the MAC address locally in DUT.

   Topology : Topology 1

   Procedure:

   The data plane MAC learning can be measured using the parameters
   defined in RFC 2889 section 5.8.  Send "X" unicast frames from CE to
   MHPE1(DUT) working in SA mode with "X" different source and
   destination address from RT.  The DUT must learn these "X" macs in
   data plane.

   Measurement :

   Measure the time taken to learn "X" MACs in DUT evpn mac table.  The
   data plane measurement is taken by considering DUT as black box the
   range of X MAC is known from RT and the same must be learned in DUT,
   the time taken to learn "X" macs is measured.





Jacob & Tiruveedhula    Expires February 22, 2020               [Page 6]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   Repeat these test and plot the data.  The test is repeated for "N"
   times and the values are collected.  The mac learning time is
   calculated by averaging the values obtained from "N" samples.

   Mac learning in sec = (T1+T2+..Tn/N)

3.2.  Remote MAC Learning

   Objective:

   To Record the time taken to learn the remote macs.

   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to SHPE3 from RT.  SHPE3
   will advertise these locally learned macs to MHPE1 and MHPE2 via
   control plane.Measure the time taken to learn these X MACs from
   remote peer in DUT EVPN MAC address table.The DUT and MHPE2 are
   running SA mode.

   Measurement :

   Measure the time taken by the DUT to learn the "X" MACs in the data
   plane.Repeat these test and plot the data.The test is repeated for
   "N" times and the values are collected.The mac learning time is
   calculated by averaging the values obtained from "N" samples.

   Mac learning in sec = (T1+T2+..Tn/N)

3.3.  MAC Flush due to local link failure and Relearning

   Objective:

   To record the time taken to flush the mac learned locally and the
   time taken to relearn the same amount of macs.

   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to DUT from CE using traffic
   generator.  Wait till the MHPE1 learns all X MAC address.  Then fail
   the MHPE1 CE link and measure the time taken to flush these X MACs
   from the EVPN MAC table.  Bring up the link which was made Down(the



Jacob & Tiruveedhula    Expires February 22, 2020               [Page 7]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   link between MHPE1 and CE).Measure time taken to relearn it.  The DUT
   and MHPE2 are running SA mode.

   Measurement :

   Measure the time taken for flushing these X MAC address.  Measure the
   time taken to relearn the X MACs in DUT.  Repeat these test and plot
   the data.  The test is repeated for "N" times and the values are
   collected.  The flush and the relearning time is calculated by
   averaging the values obtained by "N" samples.

   Flush time for X Macs in sec = (T1+T2+..Tn/N)

   Relearning time for X macs in sec = (T1+T2+..Tn/N)

3.4.  MAC Flush due to remote link failure.

   Objective:

   To record the time taken to flush the remote mac learned in DUT
   during remote link failure.

   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to DUT from SHPE3 using
   traffic generator.  Bring down the link between SHPE3 and traffic
   generator.  Then measure the time taken to flush the DUT EVPN MAC
   table.  The DUT and MHPE2 are running SA mode.

   Measurement :

   Measure the time taken to flush X remote MACs from EVPN MAC table of
   DUT.  Repeat these test and plot the data.  The test is repeated for
   "N" times and the values are collected.  The flush rate is calculated
   averaging the values obtained by "N" samples.

   Flush time for X Macs in sec = (T1+T2+..Tn/N)

3.5.  MAC Aging

   Objective:

   To measure the mac aging time.

   Topology : Topology 1



Jacob & Tiruveedhula    Expires February 22, 2020               [Page 8]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   Procedure:


   Send X frames with X different SA and DA to DUT from CE using traffic
   generator.  Wait till X MAC address are learned.  Then stop the
   traffic.  Record the time taken to flush X MACS from DUT EVPN MAC
   table due to aging.  The DUT and MHPE2 are running SA mode

   Measurement :

   Measure the time taken to flush X MAC address due to aging.  Repeat
   these test and plot the data.  The test is repeated for "N" times and
   the values are collected.  The aging is calculated averaging the
   values obtained by "N" samples.

   Aging time for X Macs in sec = (T1+T2+..Tn/N)

3.6.  Remote Mac Aging

   Objective:

   To measure the remote mac aging time.

   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to DUT from SHPE3 using
   traffic generator.  Stop the traffic at remote PE SHPE3.Due to MAC
   aging SHPE3 will withdraw its routes from DUT and MHPE2.  Measure the
   time taken to remove these MACs from DUT EVPN MAC table.  DUT and
   MHPE2 are running in SA mode

   Measurement :

   Measure the time taken to flush X remote MACs learned in DUT EVPN MAC
   table due to aging.  Repeat these test and plot the data.  The test
   is repeated for "N" times and the values are collected.  The aging is
   calculated by averaging the values obtained by "N" samples.

   Aging time for X Macs in sec = (T1+T2+..Tn/N)

3.7.  Local and Remote MAC Learning

   Objective:

   To record the time taken to learn both local and remote macs.



Jacob & Tiruveedhula    Expires February 22, 2020               [Page 9]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to DUT from SHPE3 using
   traffic generator.  Send X frames with different SA and DA from
   traffic generator connected to CE.  The SA and DA of flows must be
   complimentary to have unicast flows.  Measure the time taken by the
   DUT to learn 2X in EVPN MAC.  DUT and MHPE2 are running in SA mode.

   Measurement :

   Measure the time taken to learn 2X MAC address in DUT EVPN MAC table.
   Repeat these test and plot the data.  The test is repeated for "N"
   times and the values are collected.  The mac learning time is
   calculated by averaging the values obtained by "N" samples.

   Time to learn 2X Macs in sec = (T1+T2+..Tn/N)

3.8.  High Availability.

   Objective:

   To record traffic loss during routing engine fail over.

   Topology : Topology 1

   Procedure:


   Send X frames from CE to DUT from traffic generator withX different
   SA and DA.  Send X frames from traffic generator to SHPE3 with X
   different SA and DA so that 2X MAC address will be learned in DUT.
   There is a bi directional traffic flow with X pps in each direction.
   Then do a routing engine fail-over.

   Measurement :

   There should be 0 traffic loss which is the ideal case, No change in
   the DF role.  DUT should not withdraw any routes.Repeat the test "N"
   times and plot the data.The packet loss is calculated by averaging
   the values obtained from "N" samples.

   Packet loss in sec = (T1+T2+..Tn/N)






Jacob & Tiruveedhula    Expires February 22, 2020              [Page 10]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


3.9.  ARP/ND Scale

   These tests are conducted to Record the scaling parameter of ARP/ND
   of the DUT.

   Objective:

   To Record the ARP/ND scale of the DUT.

   Topology : Topology 1

   Procedure:


   Send X arp/icmpv6 request from RT to DUT with different sender ip/
   ipv6 address to the same target gateway ip address.  Measure whether
   X MAC+IPv4 address/MAC+IPv6 address of the hosts are learned in DUT.

   Measurement :

   The DUT must learn X MAC+IPV4/MAC+IPv6 and it must advertise the X
   MAC+IPV4/MAC+IPV6 to the remote router.

3.10.  Scaling of Services

   Objective:

   To measure the scale limit of DUT for EVPN.This is to measure the
   performance of DUT in scaling to "X" EVPN instances.

   Topology : Topology 1

   Procedure:


   The DUT,MHPE2 and SHPE3 are scaled to "N" EVI.Clear BGP neighbors of
   the DUT.  Once adjacency is established in the DUT.  Measure the
   routes received from MHPE2 and SHPE3 for "N" EVI in the DUT.

   Measurement :

   There should not be any loss of route types 1,2,3 and 4 in DUT.  DUT
   must relearn all type 1,2,3 and 4 from remote routers.  The DUT must
   be subjected to various values of N to find the optimal scale limit







Jacob & Tiruveedhula    Expires February 22, 2020              [Page 11]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


3.11.  Scale Convergence

   Objective:

   To measure the convergence time of DUT when the DUT is scaled with
   EVPN instance along with traffic.

   Topology : Topology 1

   Procedure:


   Scale N EVIs in DUT,SHPE3 and MHPE2.Send F frames to DUT from CE
   using traffic generator with X different SA and DA for N EVI's.  Send
   F frames from traffic generator to SHPE3 with X different SA and DA.
   There will be 2X number of MAC address will be learned in DUT EVPN
   MAC table.  There is a bi directional traffic flow with F pps in each
   direction.  Then clear the BGP neighbors in the DUT.  Once the
   adjacency is restored in DUT.  Measure the time taken to learn 2X MAC
   address in DUT MAC table.

   Measurement :

   The DUT must learn 2X MAC address.  Measure the time taken to learn
   2X MAC in DUT.  Repeat these test and plot the data.The test is
   repeated for "N" times and the values are collected.The convergence
   time is calculated by averaging the values obtained by "N" samples.

   Convergence time in sec = (T1+T2+..Tn/N)

3.12.  SOAK Test.

   Objective:

   This test is carried out to measure the stability of the DUT in a
   scaled environment with traffic over a period of time "T'".  In each
   interval "t1" the DUT CPU usage, memory usage are measured.  The DUT
   is checked for any crashes during this time period.

   Topology : Topology 1

   Procedure:


   Scale N EVI's in DUT,SHPE3 and MHPE2.Send F frames to DUT from CE
   using traffic generator with different X SA and DA for N EVI's.  Send
   F frames from traffic generator to SHPE3 with X different SA and DA.
   There will be 2X number of MAC address will be learned in DUT EVPN



Jacob & Tiruveedhula    Expires February 22, 2020              [Page 12]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   MAC table.  There is a bi directional traffic flow with F pps in each
   direction.  The DUT must run with traffic for 24 hours, every hour
   check for memory leak, CPU usage and crash.

   Measurement :

   Take the hourly reading of CPU, process memory.  There should not be
   any leak, crashes, CPU spikes.

4.  Test Cases for PBB-EVPN Benchmarking

4.1.  Local MAC Learning

   Objective:

   To Record the time taken to learn the MAC address locally.

   Topology : Topology 1

   Procedure:


   Send "X" unicast frames from CE to MHPE1(DUT) working in SA mode with
   "X" different source and destination address from RT.  The DUT must
   learn "X" macs in data plane.

   Measurement :

   Measure the time taken by the DUT to learn the "X" MACs in the data
   plane.  The data plane measurement is taken by considering DUT as
   black box the range of "X" MAC is known from RT and the same must be
   learned in DUT, the time taken to learn "X" MAC is measured.  Repeat
   these test and plot the data.  The test is repeated for "N" times and
   the values are collected.  The mac learning time is calculated by
   averaging the values obtained from "N" samples.

   Mac learning in sec = (T1+T2+..Tn/N)

4.2.  Remote Mac Learning

   Objective:

   To Record the time taken to learn the remote macs.

   Topology : Topology 1

   Procedure:




Jacob & Tiruveedhula    Expires February 22, 2020              [Page 13]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   Send X frames with X different SA and DA to SHPE3 from RT.These macs
   will be flooded to MHPE1 and MHPE2 by SHPE3.The DUT and MHPE2 are
   running SA mode.

   Measurement :

   Measure the time taken to learn X mac address in DUT mac table.
   Repeat these test and plot the data.The test is repeated for "N"
   times and the values are collected.The mac learning time is
   calculated by averaging the values obtained by "N" samples.

   Mac learning in sec = (T1+T2+..Tn/N)

4.3.  MAC Flush due to link failure

   Objective:

   To record the time taken to flush the mac learned locally and the
   time taken to relearn the same amount of macs.

   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to DUT from CE using traffic
   generator.  Wait till the MHPE1 learn all X MAC address.  Then fail
   the MHPE1 CE link and measure the time taken to flush these X MACs
   from the PBB-EVPN MAC table.  Then bring up the link.  Measure the
   time taken to relearn X MACS.  The DUT and MHPE2 are running SA mode.

   Measurement :

   Measure the time taken for flushing these X MAC address.  Measure the
   time taken to relearn the X MACs in DUT.  Repeat these test and plot
   the data.  The test is repeated for "N" times and the values are
   collected.  The flush and the relearning time is calculated by
   averaging the values obtained by "N" samples.

   Flush time for X Macs in sec = (T1+T2+..Tn/N)

   Relearning time for X macs in sec = (T1+T2+..Tn/N)

4.4.  MAC Flush due to remote Failure

   Objective:





Jacob & Tiruveedhula    Expires February 22, 2020              [Page 14]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   To record the time taken to flush the remote mac learned in DUT
   during remote link failure.

   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to DUT from SHPE3 using
   traffic generator.  Bring down the link between SHPE3 and traffic
   generator.  Then measure the time taken to flush the DUT PBB-EVPN MAC
   address table.  The remote MACs will be learned by Data plane, but
   the B-MAC will be learned by control plane.  The DUT and MHPE2 are
   running SA mode.

   Measurement :

   Measure the time taken to flush X remote MACs from PBB-EVPN MAC table
   of DUT.  Repeat these test and plot the data.  The test is repeated
   for "N" times and the values are collected.  The flush rate is
   calculated by averaging the values obtained by "N" samples.

   Flush time for X Macs in sec = (T1+T2+..Tn/N)

4.5.  MAC aging

   Objective:

   To measure the mac aging time.

   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to DUT from CE using traffic
   generator.  Wait till X MAC address are learned in DUT PBB- EVPN MAC
   table.  Then stop the traffic.  Record the time taken to flush X MAC
   entries due to aging.  The DUT and MHPE2 running in SA mode

   Measurement :

   Measure the time taken to flush X MAC address due to aging.  Repeat
   these test and plot the data.  The test is repeated for "N" times and
   the values are collected.  The aging is calculated by averaging the
   values obtained by "N" samples.

   Aging time for X Macs in sec = (T1+T2+..Tn/N)



Jacob & Tiruveedhula    Expires February 22, 2020              [Page 15]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


4.6.  Remote MAC Aging.

   Objective:

   To measure the remote mac aging time.

   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to DUT from SHPE3 using
   traffic generator.  Stop the traffic at remote PE(SHPE3).Measure the
   time taken to remove these remote MACs from DUT PBB-EVPN MAC table.
   The DUT and MHPE2 are running in SA mode.

   Measurement :

   Measure the time taken to flush the X remote MACs from DUT PBB-EVPN
   MAC table due to aging Repeat these test and plot the data.  The test
   is repeated for "N" times and the values are collected.  The aging is
   calculated by averaging the values obtained by "N" samples.

   Aging time for X Macs in sec = (T1+T2+..Tn/N)

4.7.  Local and Remote MAC Learning

   Objective:

   To record the time taken to learn both local and remote macs.

   Topology : Topology 1

   Procedure:


   Send X frames with X different SA and DA to DUT from SHPE3 using
   traffic generator.  Send X frames with different SA and DA from
   traffic generator connected to CE.  The SA and DA of flows must be
   complimentary to have unicast flows.  Measure the time taken by the
   DUT to learn 2X in MAC table.  DUT and MHPE2 are running in SA mode.

   Measurement :

   Measure the time taken to learn 2X MAC address table in DUT PBB-EVPN
   MAC table.  Repeat these test and plot the data.  The test is
   repeated for "N" times and the values are collected.  The mac




Jacob & Tiruveedhula    Expires February 22, 2020              [Page 16]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   learning time is calculated by averaging the values obtained by "N"
   samples.

   Time to learn 2X Macs in sec = (T1+T2+..Tn/N)

4.8.  High Availability

   Objective:

   To record traffic loss during routing engine failover.

   Topology : Topology 1

   Procedure:


   Send X frames to DUT with X different SA and DA from CE using the
   traffic generator.  Send X frames from traffic generator to SHPE3
   with X different SA and DA so that 2X MAC address will be Learned in
   DUT.  There is a bi directional traffic flow with X pps in each
   direction.  Then do a routing engine fail-over.

   Measurement :

   There should be 0 traffic loss which is the ideal case, No change in
   the DF role.  DUT should not withdraw any routes.Repeat the test "N"
   times and plot the data.The packet loss is calculated by averaging
   the values obtained from "N" samples.

   Packet loss in sec = (T1+T2+..Tn/N)

4.9.  Scale

   Objective:

   To measure the scale limit of DUT for PBB-EVPN.

   Topology : Topology 1

   Procedure:


   The DUT,MHPE2 and SHPE3 are scaled to "N" PBB-EVPN instances.  Clear
   BGP neighbors in the DUT Once adjacency is established in DUT, check
   routes received from SHPE3 and MHPE2.

   Measurement :




Jacob & Tiruveedhula    Expires February 22, 2020              [Page 17]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   There should not be any loss of route types 2,3 and 4 in DUT.  The
   DUT must relearn all type 2,3 and 4 routes from remote routers.  The
   DUT must be subjected to various values of N to find the optimal
   scale limit.

4.10.  Scale Convergence

   Objective:

   To measure the convergence time of DUT when the DUT is scaled with
   EVPN instance along with traffic.

   Topology : Topology 1

   Procedure:


   Scale N PBB-EVIs in DUT,SHPE3 and MHPE2.Send F frames to DUT from CE
   using traffic generator with X different SA and DA for N PBB-EVI's.
   Send F frames from traffic generator to SHPE3 with X different SA and
   DA.  There will be 2X number of MAC address will be learned in DUT
   PBB-EVPN MAC table.  There is a bi directional traffic flow with F
   pps in each direction.  Then clear the BGP neighbors in the DUT.
   Once the adjacency is restored in DUT.  Measure the time taken to
   learn 2X MAC address in DUT MAC table.

   Measurement :

   The DUT must learn 2X MAC address.  Measure the time taken to learn
   2X MAC in DUT.  Repeat these test and plot the data.The test is
   repeated for "N" times and the values are collected.The convergence
   time is calculated by averaging the values obtained by "N" samples.

   Convergence time in sec = (T1+T2+..Tn/N)

4.11.  Soak Test

   Objective:

   To measure the stability of the DUT in a scaled environment with
   traffic.

   Topology : Topology 1

   Procedure:






Jacob & Tiruveedhula    Expires February 22, 2020              [Page 18]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


   Scale N PBB-EVI's in DUT,SHPE3 and MHPE2.Send F frames to DUT from CE
   using traffic generator with X different SA and DA for N EVI's.  Send
   F frames from traffic generator to SHPE3 with X different SA and DA.
   There will be 2X number of MAC address will be learned in DUT PBB-
   EVPN MAC table.  There is a bi directional traffic flow with F pps in
   Each direction.  The DUT must run with traffic for 24 hours, every
   hour check the memory leak, crashes.

   Measurement :

   Take the hourly reading of CPU process, memory usages.  There should
   not be any memory leak, crashes,CPU spikes.

5.  Acknowledgements

   We would like to thank Fioccola Giuseppe of Telecom Italia reviewing
   our draft and commenting it.  We would like to thank Sarah Banks for
   guiding and mentoring us.

6.  IANA Considerations

   This memo includes no request to IANA.

7.  Security Considerations

   There is no additional consideration from RFC 6192.

8.  References

8.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119,
              DOI 10.17487/RFC2119, March 1997,
              <https://www.rfc-editor.org/info/rfc2119>.

   [RFC2544]  Bradner, S. and J. McQuaid, "Benchmarking Methodology for
              Network Interconnect Devices", RFC 2544,
              DOI 10.17487/RFC2544, March 1999,
              <https://www.rfc-editor.org/info/rfc2544>.

   [RFC2899]  Ginoza, S., "Request for Comments Summary RFC Numbers
              2800-2899", RFC 2899, DOI 10.17487/RFC2899, May 2001,
              <https://www.rfc-editor.org/info/rfc2899>.







Jacob & Tiruveedhula    Expires February 22, 2020              [Page 19]

Internet-Draft        EVPN Benchmarking Methodology          August 2019


8.2.  Informative References

   [RFC7432]  Sajassi, A., Ed., Aggarwal, R., Bitar, N., Isaac, A.,
              Uttaro, J., Drake, J., and W. Henderickx, "BGP MPLS-Based
              Ethernet VPN", RFC 7432, DOI 10.17487/RFC7432, February
              2015, <https://www.rfc-editor.org/info/rfc7432>.

   [RFC7623]  Sajassi, A., Ed., Salam, S., Bitar, N., Isaac, A., and W.
              Henderickx, "Provider Backbone Bridging Combined with
              Ethernet VPN (PBB-EVPN)", RFC 7623, DOI 10.17487/RFC7623,
              September 2015, <https://www.rfc-editor.org/info/rfc7623>.

Appendix A.  Appendix

Authors' Addresses

   Sudhin Jacob (editor)
   Juniper Networks
   Bangalore
   India

   Phone: +91 8061212543
   Email: sjacob@juniper.net


   Kishore Tiruveedhula
   Juniper Networks
   10 Technology Park Dr
   Westford, MA  01886
   USA

   Phone: +1 9785898861
   Email: kishoret@juniper.net


















Jacob & Tiruveedhula    Expires February 22, 2020              [Page 20]
