<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DHCP Authentication
    Analysis</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DHCP Authentication
    Analysis">
<meta name="keywords" content="DHCP authentication, DHCPv4 Authentication, DHCPv6
    Authentication">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">dhc</td><td class="header">J. Brzozowski</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Comcast Cable Communications</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">T. Lemon</td></tr>
<tr><td class="header">Expires: May 15, 2010</td><td class="header">Nominum</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">G. Hollan</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Telus</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">November 11, 2009</td></tr>
</table></td></tr></table>
<h1><br />DHCP Authentication
    Analysis<br />draft-jjmb-dhc-eap-auth-analysis-00</h1>

<h3>Abstract</h3>

<p>This document analyzes and technically evaluate the techniques
      proposed to support end-user authentication using extensions to
      DHCP.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on May 15, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2009 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Requirements Language<br />
<a href="#anchor3">2.</a>&nbsp;
Terminology<br />
<a href="#anchor4">3.</a>&nbsp;
Message and Option Definition<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.</a>&nbsp;
Message Type Overloading<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.2.</a>&nbsp;
Differences in Message and Option Names<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">3.3.</a>&nbsp;
Message and Option Sizing<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">3.4.</a>&nbsp;
RADIUS Message Requirements<br />
<a href="#anchor9">4.</a>&nbsp;
Protocol behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.1.</a>&nbsp;
DHCP Clients<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">4.1.1.</a>&nbsp;
Packet Size<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">4.1.2.</a>&nbsp;
Standalone Client Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">4.1.3.</a>&nbsp;
Handling of non-EAP responses<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">4.1.4.</a>&nbsp;
Protocol State Machine is Only in Client<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.1.5.</a>&nbsp;
Transaction IDs<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">4.1.6.</a>&nbsp;
Retransmission<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">4.2.</a>&nbsp;
DHCP Servers<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">4.3.</a>&nbsp;
DHCP Relay Agents<br />
<a href="#anchor19">5.</a>&nbsp;
Compatibility<br />
<a href="#Acknowledgements">6.</a>&nbsp;
Acknowledgements<br />
<a href="#IANA">7.</a>&nbsp;
IANA Considerations<br />
<a href="#Security">8.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document provides an independent analysis of the proposal to
      support end-user authentication using extension to DHCP. While the
      current proposal largley focuses on Broadband Digital Subscriber Line
      scenarions the adhoc team that has been assembled will evaulate the
      proposal generally from a DHCP point of view. This analysis will also
      cite architectural and best practice considerations for the authors to
      consider as part of this work.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>RFC 2119<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a> [RFC2119].
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Terminology</h3>

<p>The following terms and acronyms are used in this document:</p>
<ul class="text">
<li>DHCPv4 - "Dynamic Host Configuration Protocol" <a class='info' href='#RFC2131'>[RFC2131]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a>
</li>
<li>DHCPv6 - "Dynamic Host Configuration Protocol for IPv6" <a class='info' href='#RFC3315'>[RFC3315]<span> (</span><span class='info'>Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</span><span>)</span></a>
</li>
<li>DHCP - DHCPv4 and/or DHCPv6
</li>
</ul>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Message and Option Definition</h3>

<p>In this section considerations pertaining to how the DHCPEAP messages
      have been defined in <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> are
      discussed. Recommendations as to how messages may be defined are also
      documented in this section.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Message Type Overloading</h3>

<p><a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> defines a DHCP
	single EAP message to support end-user DHCP-based
	authentication. However, the DHC working group has found that
	using the same DHCP message type for more than one leg of a
	packet exchange creates confusion, and we recommend instead
	that a different message type be used for each leg of the
	transaction.  In this case a four message model may better
	satisfy the requirements, similar, for example, to the
	DISCOVER/OFFER/REQUEST/ACK cycle in the standard DHCPv4
	bootstrapping exchange.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Differences in Message and Option Names</h3>

<p><a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a>
	mingles DHCPv4 and DHCPv6 message types.  This is not
	valid. DHCPv4 messages and options must be clearly defined and
	referenced to for IPv4.   DHCPv6 messages and options must be
	defined and referenced for IPv6.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Message and Option Sizing</h3>

<p><a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> introduces a
        DHCP Capability Vendor-specific Suboption for DHCPv4 and
        DHCPv6 which is specified to carry authentication
        information. This information is required to support the
        desired protocol behavior.  However, including this data in a
        DHCP greatly increases the size of the DHCP option
        payload. While <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a>
        specifies how large options are to be handled, this large
        option payload still has the potential to create problems;
        there is the potential for this option to squeeze out other
        DHCP options required for correct DHCP configuration
</p>
<p>Additionally, the authors of <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> should mention that
        in practice the Maximum Message Size option is rarely used by
        DHCP clients and as such we have no real operational
        experience that tells us what percentage of relay agents will
        fail in the face of DHCP packets larger than 576 bytes.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.4"></a><h3>3.4.&nbsp;
RADIUS Message Requirements</h3>

<p>Section 5.1 and 5.2 of <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> mention RADIUS
        attributes required to support this behavior.  These are not
        included as part of <a class='info' href='#RFC4014'>[RFC4014]<span> (</span><span class='info'>Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</span><span>)</span></a>. These
        messages still need to be specified.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Protocol behavior</h3>

<p><a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> requires that
      end-user DHCP-based authentication must be handled independently
      in the case where both IPv4 and IPv6 service are present. <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> is not clear as to how
      clients and servers handle conflicts where both IPv4 and IPv6
      are used simultaneously and further how conflicts are resolved
      when such scenarios arise. See the beginning of section 5 of
      <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a>.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
DHCP Clients</h3>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.1"></a><h3>4.1.1.&nbsp;
Packet Size</h3>

<p>Packet size for DHCP clients that support end-user DHCP-based
	  authentication remains a concern. DHCP clients MUST advertise their
	  ability to support larger packet sizes, however, this alone will not
	  ensure that intermediate elements like DHCP relay agents will support
	  the same or adversely impact exchanges between DHCP clients and
	  servers. DHCP clients in this case include but are not limited to
	  those include with operating systems and home networking
	  equipment.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.2"></a><h3>4.1.2.&nbsp;
Standalone Client Behavior</h3>

<p>The behavior for home gateway (HG) as defined in <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> has been
	  specified, however, specification of standalone client
	  behavior remains absent. In order for this proposal to be
	  complete it must be specified how standalone client are to
	  behave to support end-user authentication using DHCP.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.3"></a><h3>4.1.3.&nbsp;
Handling of non-EAP responses</h3>

<p>Section 5 of <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a>
	  also indicates that a client may receive one or more DHCP
	  OFFER/ADVERTISE messages some of which may or may not support
	  DHCP EAP authentication. It is unclear and unspecified how or
	  if the client is to wait for DHCP OFFER/ADVERTISE messages
	  that support EAP.  An EAP-capable client could accept a DHCP
	  OFFER/ADVERTISEMENT message where no support for EAP is in
	  present but subsequent DHCP OFFER/ADVERTISEMENT messages
	  do.
</p>
<p>This is further complicated in the case where the DHCP
	  client is not a home gateway, and may in fact be a portable
	  device such as a laptop computer.  When the DHCP/EAP capable
	  client is connected to a provider network supporting DHCP/EAP,
	  the client may wait for a DHCPEAP message from the server.
	  When the client is connected to some other network, where
	  DHCP/EAP is not supported, it may still wait for such a
	  message.  This would create a delay in the availability of the
	  network for the end user when not connecting to the provider
	  network.
</p>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.4"></a><h3>4.1.4.&nbsp;
Protocol State Machine is Only in Client</h3>

<p><a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> proposes
	  that if the relay agent or server decides to do DHCP/EAP, the
	  original DHCPDISCOVER message from the DHCP client will be
	  cached.  Once the EAP authentication has succeeded, the
	  DHCPDISCOVER will be forwarded to the server or, in the case
	  where the server does the EAP authentication, the server will
	  take the cached DHCPDISCOVER and send a DHCPOFFER in response
	  to it.
</p>
<p>However, this proposal ignores the fact that the DHCP
	  client, not the DHCP server, drives the DHCP protocol.  The
	  DHCP client determines when to send the DHCPDISCOVER, and the
	  DHCP server responds.  The DHCP client determines when to send
	  the DHCPREQUEST, and the DHCP server responds.  The DHCP
	  client determines when to renew, and so on.
</p>
<p>Hence, we strongly recommend that the proposed protocol be
	  changed so that, after a successful DHCP/EAP exchange, the
	  DHCP client restarts its state machine at the INIT state and
	  sends a new DHCPDISCOVER, with a new transaction ID.  This
	  eliminates three problems:
	  </p>
<blockquote class="text">
<p>- the need for the DHCP server or relay to cache the
	    DHCPDISCOVER
</p>
<p>- the problem of how to retransmit if the DHCP server
	    doesn't send a response to the DHCPDISCOVER cached and
	    eventually forwarded by the relay agent
</p>
<p>- the problem that the DHCP client state machine would have
	    to remember the xid in the original DHCPDISCOVER packet, even
	    though it's gone through several state transitions since the
	    DHCPDISCOVER was sent.
</p>
</blockquote><p>
	  
</p>
<p>Needless to say, the same suggestion applies for the DHCPv6
	  protocol, although the names of the packets are different and
	  DHCPv6 doesn't name the client's states.
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.5"></a><h3>4.1.5.&nbsp;
Transaction IDs</h3>

<p>The proposed protocol extension does not document the handling
	  of the DHCP client's transaction IDs during the processing of
	  EAP-specific messages.   We recommend that each EAP message sourced
	  by the client have a new transaction ID, which should then be
	  returned in the response from the server.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1.6"></a><h3>4.1.6.&nbsp;
Retransmission</h3>

<p>The proposed protocol extension does not talk about
	  retransmission in cases where no response is received during the
	  EAP portion of the protocol.   It must document this, or refer
	  to relevent text in the DHCPv4 and DHCPv6 protocol specs.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
DHCP Servers</h3>

<p>In the DHCP protocol, the state machine is in the client,
	not the server.  The server retains information about the
	client's IP address allocation, but from the perspective of
	the protocol, the DHCP server only sends messages in response
	to messages sent by the DHCP client.  So <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> places a new
	requirement on DHCP servers that they retain DHCPDISCOVER
	messages sent by clients during the EAP authentication
	process.   This problem would be solved by following the
	related recommendations in the earlier section on DHCP clients.
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
DHCP Relay Agents</h3>

<p><a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> does not say whether
	or not the relay agent should append a relay agent information option
	to EAP-specific messages.   We think that a non-EAP-aware relay agent
	would have to do so, but the draft should talk about this issue.
</p>
<p><a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> proposes a
        mode in which the DHCP relay agent implements the EAP protocol
        itself, rather than relying on the DHCP server to do so.  In
        order to do this, the relay agent, which in the normal DHCP
        protocol is completely stateless, must now retain state
        regarding the progress of the DHCP protocol. There are two
        different ways in which this protocol extension adds state to
        the relay agent:
	</p>
<blockquote class="text">
<p>- The relay agent must retain the initial DHCPDISCOVER packet
	  sent by the client.
</p>
<p>- Once the EAP authentication has succeeded, the relay
	  agent must remember that the authentication has succeeded,
	  so that if the DHCP client must retransmit its DHCPDISCOVER,
	  the relay agent does not attempt to redo the entire EAP
	  authentication process.  This state must be retained for the
	  entire duration of the DHCP protocol from that point on, so
	  that the initial four-way handshake can complete, and so
	  that any subsequent renewals, rebinds, and INIT-REBOOT
	  renewals can complete.  In order to avoid caching this state
	  forever, the relay agent would have to retain lease timing
	  information so that it could time out cached information as
	  the leases associated with that information expire.
</p>
</blockquote>

<p>For this reason, we strongly recommend that the authors
	abandon the idea of implementing this protocol extension in
	the relay agent.  Also, please note that this is true for the
	DHCPv6 exchange as well as the DHCPv4 exchange; we only
	document the DHCPv4 exchange for brevity.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Compatibility</h3>

<p>The compatibility of clients, servers, and relay agents that
      implement this behavior with legacy clients, servers, and relay agents
      MUST be explicitly documented. The behavior of the remaining elements
      that do not support this behavior while others do MUST be considered,
      specifically, how will legacy element handle the presence of the
      corresponding DHCP options when present. Consider the following
      scenarios for example:</p>
<ol class="text">
<li>DHCP client support for authentication
</li>
<li>DHCP relay agent support for authentication
</li>
<li>DHCP server support for authentication
</li>
<li>DHCP client, server, and relay agent support for
          authentication
</li>
</ol>

<a name="Acknowledgements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p>Thanks to Alper Yegin, Ric Pruss, Glen Zorn, and Alan DeKok for the
      review and feedback.
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This memo includes no request to IANA.
</p>
<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Security Considerations</h3>

<p>The current version of <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a>
      indicates that <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Alexander, S. and R. Droms, &ldquo;DHCP Options and BOOTP Vendor Extensions,&rdquo; March&nbsp;1997.</span><span>)</span></a> likely cannot be
      seamlessly integrated with existing RADIUS-based AAA infrastructure used
      in Broadband DSL environments. <a class='info' href='#I-D.pruss-dhcp-auth-dsl'>[I&#8209;D.pruss&#8209;dhcp&#8209;auth&#8209;dsl]<span> (</span><span class='info'>Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration           Protocol,&rdquo; May&nbsp;2008.</span><span>)</span></a> must elaborate on how DHCP EAP
      can be secured if not by leveraging <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Alexander, S. and R. Droms, &ldquo;DHCP Options and BOOTP Vendor Extensions,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
      While the use cases for that extension are hard to evaluate, so it seems
      that this draft is neutral toward other DHCP security mechanisms, with
      one small caveat: since it increases the DHCP message size, it is
      competing for space in the DHCP packet with other authentication
      options. However, existing <a class='info' href='#RFC3118'>[RFC3118]<span> (</span><span class='info'>Alexander, S. and R. Droms, &ldquo;DHCP Options and BOOTP Vendor Extensions,&rdquo; March&nbsp;1997.</span><span>)</span></a> authentication
      schemes use relatively short signatures and keys, so in practice this is
      probably not a serious concern.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.narten-iana-considerations-rfc2434bis">[I-D.narten-iana-considerations-rfc2434bis]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-narten-iana-considerations-rfc2434bis-09.txt">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; draft-narten-iana-considerations-rfc2434bis-09 (work in progress), March&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-narten-iana-considerations-rfc2434bis-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.pruss-dhcp-auth-dsl">[I-D.pruss-dhcp-auth-dsl]</a></td>
<td class="author-text">Pruss, R., Zorn, G., Maglione, R., and Y. Li, &ldquo;Authentication Extensions for the Dynamic Host Configuration
          Protocol,&rdquo; May&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2131">[RFC2131]</a></td>
<td class="author-text">Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2132">[RFC2132]</a></td>
<td class="author-text">Alexander, S. and R. Droms, &ldquo;DHCP Options and BOOTP Vendor Extensions,&rdquo; March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3118">[RFC3118]</a></td>
<td class="author-text">Alexander, S. and R. Droms, &ldquo;DHCP Options and BOOTP Vendor Extensions,&rdquo; March&nbsp;1997.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3315">[RFC3315]</a></td>
<td class="author-text">Droms, R., Bound, J., Volz, B., Lemon, T., Perkins, C., and M. Carney, &ldquo;Dynamic Host Configuration Protocol for IPv6 (DHCPv6),&rdquo; July&nbsp;2003.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3552">[RFC3552]</a></td>
<td class="author-text">Rescorla, E. and B. Korver, &ldquo;<a href="http://tools.ietf.org/html/rfc3552">Guidelines for Writing RFC Text on Security Considerations</a>,&rdquo; BCP&nbsp;72, RFC&nbsp;3552, July&nbsp;2003 (<a href="http://www.rfc-editor.org/rfc/rfc3552.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4014">[RFC4014]</a></td>
<td class="author-text">Droms, R., &ldquo;Dynamic Host Configuration Protocol,&rdquo; March&nbsp;1997.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">John Jason Brzozowski</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Comcast Cable Communications</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1360 Goshen Parkway</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">West Chester, PA  19473</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1-609-377-6594</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:john_brzozowski@cable.comcast.com">john_brzozowski@cable.comcast.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ted Lemon</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Nominum</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mellon@nominum.com">mellon@nominum.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Geoffrey Holan</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Telus</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Canada</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:geoffrey.holan@telus.com">geoffrey.holan@telus.com</a></td></tr>
</table>
</body></html>
