<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" 
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html lang="en" xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head profile="http://www.w3.org/2006/03/hcard%20http://dublincore.org/documents/2008/08/04/dc-html/">
  <meta http-equiv="Content-Type" content="text/html; charset=us-ascii" />

  <title>Diameter S-NAPTR Usage</title>

  <style type="text/css" title="Xml2Rfc (sans serif)">
  /*<![CDATA[*/
	  a {
	  text-decoration: none;
	  }
	  a.smpl {
	  color: black;
	  }
	  a:hover {
	  text-decoration: underline;
	  }
	  a:active {
	  text-decoration: underline;
	  }
	  address {
	  margin-top: 1em;
	  margin-left: 2em;
	  font-style: normal;
	  }
	  body {
	  color: black;
	  font-family: verdana, helvetica, arial, sans-serif;
	  font-size: 10pt;
	  
	  }
	  cite {
	  font-style: normal;
	  }
	  dd {
	  margin-right: 2em;
	  }
	  dl {
	  margin-left: 2em;
	  }
	
	  ul.empty {
	  list-style-type: none;
	  }
	  ul.empty li {
	  margin-top: .5em;
	  }
	  dl p {
	  margin-left: 0em;
	  }
	  dt {
	  margin-top: .5em;
	  }
	  h1 {
	  font-size: 14pt;
	  line-height: 21pt;
	  page-break-after: avoid;
	  }
	  h1.np {
	  page-break-before: always;
	  }
	  h1 a {
	  color: #333333;
	  }
	  h2 {
	  font-size: 12pt;
	  line-height: 15pt;
	  page-break-after: avoid;
	  }
	  h3, h4, h5, h6 {
	  font-size: 10pt;
	  page-break-after: avoid;
	  }
	  h2 a, h3 a, h4 a, h5 a, h6 a {
	  color: black;
	  }
	  img {
	  margin-left: 3em;
	  }
	  li {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  ol p {
	  margin-left: 0em;
	  }
	  p {
	  margin-left: 2em;
	  margin-right: 2em;
	  }
	  pre {
	  margin-left: 3em;
	  background-color: lightyellow;
	  padding: .25em;
	  }
	  pre.text2 {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f0f0f0;
	  width: 69em;
	  }
	  pre.inline {
	  background-color: white;
	  padding: 0em;
	  }
	  pre.text {
	  border-style: dotted;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  width: 69em;
	  }
	  pre.drawing {
	  border-style: solid;
	  border-width: 1px;
	  background-color: #f8f8f8;
	  padding: 2em;
	  }
	  table {
	  margin-left: 2em;
	  }
	  table.tt {
	  vertical-align: top;
	  }
	  table.full {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.headers {
	  border-style: outset;
	  border-width: 1px;
	  }
	  table.tt td {
	  vertical-align: top;
	  }
	  table.full td {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.tt th {
	  vertical-align: top;
	  }
	  table.full th {
	  border-style: inset;
	  border-width: 1px;
	  }
	  table.headers th {
	  border-style: none none inset none;
	  border-width: 1px;
	  }
	  table.left {
	  margin-right: auto;
	  }
	  table.right {
	  margin-left: auto;
	  }
	  table.center {
	  margin-left: auto;
	  margin-right: auto;
	  }
	  caption {
	  caption-side: bottom;
	  font-weight: bold;
	  font-size: 9pt;
	  margin-top: .5em;
	  }
	
	  table.header {
	  border-spacing: 1px;
	  width: 95%;
	  font-size: 10pt;
	  color: white;
	  }
	  td.top {
	  vertical-align: top;
	  }
	  td.topnowrap {
	  vertical-align: top;
	  white-space: nowrap; 
	  }
	  table.header td {
	  background-color: gray;
	  width: 50%;
	  }
	  table.header a {
	  color: white;
	  }
	  td.reference {
	  vertical-align: top;
	  white-space: nowrap;
	  padding-right: 1em;
	  }
	  thead {
	  display:table-header-group;
	  }
	  ul.toc, ul.toc ul {
	  list-style: none;
	  margin-left: 1.5em;
	  margin-right: 0em;
	  padding-left: 0em;
	  }
	  ul.toc li {
	  line-height: 150%;
	  font-weight: bold;
	  font-size: 10pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  ul.toc li li {
	  line-height: normal;
	  font-weight: normal;
	  font-size: 9pt;
	  margin-left: 0em;
	  margin-right: 0em;
	  }
	  li.excluded {
	  font-size: 0pt;
	  }
	  ul p {
	  margin-left: 0em;
	  }
	
	  .comment {
	  background-color: yellow;
	  }
	  .center {
	  text-align: center;
	  }
	  .error {
	  color: red;
	  font-style: italic;
	  font-weight: bold;
	  }
	  .figure {
	  font-weight: bold;
	  text-align: center;
	  font-size: 9pt;
	  }
	  .filename {
	  color: #333333;
	  font-weight: bold;
	  font-size: 12pt;
	  line-height: 21pt;
	  text-align: center;
	  }
	  .fn {
	  font-weight: bold;
	  }
	  .hidden {
	  display: none;
	  }
	  .left {
	  text-align: left;
	  }
	  .right {
	  text-align: right;
	  }
	  .title {
	  color: #990000;
	  font-size: 18pt;
	  line-height: 18pt;
	  font-weight: bold;
	  text-align: center;
	  margin-top: 36pt;
	  }
	  .vcardline {
	  display: block;
	  }
	  .warning {
	  font-size: 14pt;
	  background-color: yellow;
	  }
	
	
	  @media print {
	  .noprint {
		display: none;
	  }
	
	  a {
		color: black;
		text-decoration: none;
	  }
	
	  table.header {
		width: 90%;
	  }
	
	  td.header {
		width: 50%;
		color: black;
		background-color: white;
		vertical-align: top;
		font-size: 12pt;
	  }
	
	  ul.toc a::after {
		content: leader('.') target-counter(attr(href), page);
	  }
	
	  ul.ind li li a {
		content: target-counter(attr(href), page);
	  }
	
	  .print2col {
		column-count: 2;
		-moz-column-count: 2;
		column-fill: auto;
	  }
	  }
	
	  @page {
	  @top-left {
		   content: "Internet-Draft"; 
	  } 
	  @top-right {
		   content: "December 2010"; 
	  } 
	  @top-center {
		   content: "Abbreviated Title";3
	  } 
	  @bottom-left {
		   content: "Doe"; 
	  } 
	  @bottom-center {
		   content: "Expires June 2011"; 
	  } 
	  @bottom-right {
		   content: "[Page " counter(page) "]"; 
	  } 
	  }
	
	  @page:first { 
		@top-left {
		  content: normal;
		}
		@top-right {
		  content: normal;
		}
		@top-center {
		  content: normal;
		}
	  }
  /*]]>*/
  </style>

  <link href="#rfc.toc" rel="Contents">
<link href="#rfc.section.1" rel="Chapter" title="1 Introduction">
<link href="#rfc.section.2" rel="Chapter" title="2 Terminology">
<link href="#rfc.section.3" rel="Chapter" title="3 Extended NAPTR Service Field Format">
<link href="#rfc.section.3.1" rel="Chapter" title="3.1 IETF Standard Track Diameter Applications ">
<link href="#rfc.section.3.2" rel="Chapter" title="3.2 Vendor-specific Diameter Applications">
<link href="#rfc.section.4" rel="Chapter" title="4 Backwards Compatibility">
<link href="#rfc.section.5" rel="Chapter" title="5 Extended NAPTR-based Diameter Peer Discovery">
<link href="#rfc.section.6" rel="Chapter" title="6 Usage Guidelines">
<link href="#rfc.section.7" rel="Chapter" title="7 IANA Considerations">
<link href="#rfc.section.7.1" rel="Chapter" title="7.1 IETF Diameter Application Service Tags">
<link href="#rfc.section.7.2" rel="Chapter" title="7.2 3GPP Diameter Application Service Tags">
<link href="#rfc.section.7.3" rel="Chapter" title="7.3 WiMAX Forum Diameter Application Service Tags">
<link href="#rfc.section.7.4" rel="Chapter" title="7.4 Vendor-Specific Diameter Application Service Tags">
<link href="#rfc.section.7.5" rel="Chapter" title="7.5 Diameter Application Protocol Tags">
<link href="#rfc.section.8" rel="Chapter" title="8 Security Considerations">
<link href="#rfc.section.9" rel="Chapter" title="9 Acknowledgments">
<link href="#rfc.section.10" rel="Chapter" title="10 Editor's Notes">
<link href="#rfc.references" rel="Chapter" title="11 References">
<link href="#rfc.references.1" rel="Chapter" title="11.1 Normative References">
<link href="#rfc.references.2" rel="Chapter" title="11.2 Informative References">
<link href="#rfc.authors" rel="Chapter">


  <meta name="generator" content=
  "http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.539, 2011-01-02 17:13:00, XSLT vendor: SAXON 6.5.5 from Michael Kay http://saxon.sf.net/" />
  <link rel="schema.dct" href="http://purl.org/dc/terms/" />
  <meta name="dct.creator" content="Doe, J." />
  <meta name="dct.identifier" content="urn:ietf:id:draft-sample-input-00" />
  <meta name="dct.issued" scheme="ISO8601" content="2010-12" />
  
  <meta name="dct.abstract" content="The Diameter base protocol specifies mechanisms whereby a given realm may advertise Diameter nodes and the supported transport protocol.  However, these mechanisms do not reveal the Diameter applications that each node supports. A peer outside the realm would have to perform a Diameter capability exchange with every node until it discovers one that supports the required application. This document updates  " />
  <meta name="description" content="The Diameter base protocol specifies mechanisms whereby a given realm may advertise Diameter nodes and the supported transport protocol.  However, these mechanisms do not reveal the Diameter applications that each node supports. A peer outside the realm would have to perform a Diameter capability exchange with every node until it discovers one that supports the required application. This document updates  " />
  <meta name="keywords" content="NAPTR, Diameter, Services Field, Peer Discovery" />

</head>

<body>

  <table class="header">
    <tbody>
    
    	<tr>
<td class="left">Diameter Maintenance and Extensions (DIME)</td>
<td class="right">M. Jones</td>
</tr>
<tr>
<td class="left">Internet-Draft</td>
<td class="right">Bridgewater Systems</td>
</tr>
<tr>
<td class="left">Updates: 3588 (if approved)</td>
<td class="right">J. Korhonen</td>
</tr>
<tr>
<td class="left">Intended status: Standards Track</td>
<td class="right">Nokia Siemens Networks</td>
</tr>
<tr>
<td class="left">Expires: September 08, 2011</td>
<td class="right">L. Morand</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">Orange Labs</td>
</tr>
<tr>
<td class="left"></td>
<td class="right">March 07, 2011</td>
</tr>

    	
    </tbody>
  </table>

  <p class="title">Diameter S-NAPTR Usage<br />
  <span class="filename">draft-ietf-dime-extended-naptr-06</span></p>
  
  <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
<p>The Diameter base protocol specifies mechanisms whereby a given realm may advertise Diameter nodes and the supported transport protocol.  However, these mechanisms do not reveal the Diameter applications that each node supports. A peer outside the realm would have to perform a Diameter capability exchange with every node until it discovers one that supports the required application. This document updates  <a href="#RFC3588">[RFC3588]</a> and describes an improvement using an extended format for the Straightforward-NAPTR (S-NAPTR) Application Service Tag that allows for discovery of the supported applications without doing Diameter capability exchange beforehand.</p>
<h1><a>Requirements Language</a></h1>
<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a href="#RFC2119">[RFC2119]</a>.</p>
<h1 id="rfc.status"><a href="#rfc.status">Status of this Memo</a></h1>
<p>This Internet-Draft is submitted in full conformance with the provisions of BCP 78 and BCP 79.</p>
<p>Internet-Drafts are working documents of the Internet Engineering Task Force (IETF).  Note that other groups may also distribute working documents as Internet-Drafts.  The list of current Internet- Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>Internet-Drafts are draft documents valid for a maximum of six months and may be updated, replaced, or obsoleted by other documents at any time.  It is inappropriate to use Internet-Drafts as reference material or to cite them other than as "work in progress."</p>
<p>This Internet-Draft will expire on September 08, 2011.</p>
<h1 id="rfc.copyrightnotice"><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
<p>Copyright (c) 2011 IETF Trust and the persons identified as the document authors.  All rights reserved.</p>
<p>This document is subject to BCP 78 and the IETF Trust's Legal Provisions Relating to IETF Documents (http://trustee.ietf.org/license-info) in effect on the date of publication of this document.  Please review these documents carefully, as they describe your rights and restrictions with respect to this document.  Code Components extracted from this document must include Simplified BSD License text as described in Section 4.e of the Trust Legal Provisions and are provided without warranty as described in the Simplified BSD License.</p>

  
  <hr class="noprint" />
  <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
  <ul class="toc">

  	<li>1.   <a href="#rfc.section.1">Introduction</a>
</li>
<li>2.   <a href="#rfc.section.2">Terminology</a>
</li>
<li>3.   <a href="#rfc.section.3">Extended NAPTR Service Field Format</a>
</li>
<li>3.1.   <a href="#rfc.section.3.1">IETF Standard Track Diameter Applications </a>
</li>
<li>3.2.   <a href="#rfc.section.3.2">Vendor-specific Diameter Applications</a>
</li>
<li>4.   <a href="#rfc.section.4">Backwards Compatibility</a>
</li>
<li>5.   <a href="#rfc.section.5">Extended NAPTR-based Diameter Peer Discovery</a>
</li>
<li>6.   <a href="#rfc.section.6">Usage Guidelines</a>
</li>
<li>7.   <a href="#rfc.section.7">IANA Considerations</a>
</li>
<li>7.1.   <a href="#rfc.section.7.1">IETF Diameter Application Service Tags</a>
</li>
<li>7.2.   <a href="#rfc.section.7.2">3GPP Diameter Application Service Tags</a>
</li>
<li>7.3.   <a href="#rfc.section.7.3">WiMAX Forum Diameter Application Service Tags</a>
</li>
<li>7.4.   <a href="#rfc.section.7.4">Vendor-Specific Diameter Application Service Tags</a>
</li>
<li>7.5.   <a href="#rfc.section.7.5">Diameter Application Protocol Tags</a>
</li>
<li>8.   <a href="#rfc.section.8">Security Considerations</a>
</li>
<li>9.   <a href="#rfc.section.9">Acknowledgments</a>
</li>
<li>10.   <a href="#rfc.section.10">Editor's Notes</a>
</li>
<li>11.   <a href="#rfc.references">References</a>
</li>
<li>11.1.   <a href="#rfc.references.1">Normative References</a>
</li>
<li>11.2.   <a href="#rfc.references.2">Informative References</a>
</li>
<li><a href="#rfc.authors">Authors' Addresses</a>
</li>


  </ul>

  <h1 id="rfc.section.1">
<a href="#rfc.section.1">1.</a> Introduction</h1>
<p id="rfc.section.1.p.1">The Diameter base protocol <a href="#RFC3588">[RFC3588]</a> specifies three mechanisms for the Diameter peer discovery. One of these involves the Diameter implementation performing a NAPTR query <a href="#RFC3403">[RFC3403]</a> for a server in a particular realm.  These NAPTR records provide a mapping from a domain, to the SRV record <a href="#RFC2782">[RFC2782]</a> or A/AAAA record <a href="#RFC1035">[RFC1035]</a><a href="#RFC3596">[RFC3596]</a> for contacting a server with the specific transport protocol in the NAPTR services field. </p>
<p id="rfc.section.1.p.2">The extended NAPTR usage for Diameter peer discovery defined by this document is based on the Straightforward-NAPTR (S-NAPTR) Dynamic Delegation Discovery System (DDDS) Application defined in <a href="#RFC3958">[RFC3958]</a>. This document updates the Diameter peer discovery procedure described in Section 11.6 of <a href="#RFC3588">[RFC3588]</a> and defines S-NAPTR Application Service and Application Protocol Tag values that permit the discovery of Diameter peers that support a specific Diameter application and transport protocol.  </p>
<h1 id="rfc.section.2">
<a href="#rfc.section.2">2.</a> Terminology</h1>
<p id="rfc.section.2.p.1">The Diameter base protocol specification (Section 1.4 of <a href="#RFC3588">[RFC3588]</a>) and the Straightforward-NAPTR (S-NAPTR) DDDS application (section 2.1 in <a href="#RFC3958">[RFC3958]</a>) define the terminology used in this document.</p>
<h1 id="rfc.section.3">
<a href="#rfc.section.3">3.</a> <a href="#snaptr-format" id="snaptr-format">Extended NAPTR Service Field Format</a>
</h1>
<div id="#rfc.figure.1"></div>
<pre>
    service-parms = [ [app-service] *(":" app-protocol)]
    app-service   = experimental-service  / iana-registered-service
    app-protocol  = experimental-protocol / iana-registered-protocol
    experimental-service      = "x-" 1*30ALPHANUMSYM
    experimental-protocol     = "x-" 1*30ALPHANUMSYM
    iana-registered-service   = ALPHA *31ALPHANUMSYM
    iana-registered-protocol  = ALPHA *31ALPHANUMSYM
    ALPHA         =  %x41-5A / %x61-7A   ; A-Z / a-z
    DIGIT         =  %x30-39 ; 0-9
    SYM           =  %x2B / %x2D / %x2E  ; "+" / "-" / "."
    ALPHANUMSYM   =  ALPHA / DIGIT / SYM
    ; The app-service and app-protocol tags are limited to 32
    ; characters and must start with an alphabetic character.
    ; The service-parms are considered case-insensitive.
  </pre>
<p id="rfc.section.3.p.1">The NAPTR Service Field format defined by the S-NAPTR DDDS application in <a href="#RFC3958">[RFC3958]</a> follows this Augmented Backus-Naur Form (ABNF, <a href="#RFC5234">[RFC5234]</a>): </p>
<div id="#rfc.figure.2"></div>
<pre>
    iana-registered-service = aaa-service / ALPHA *31ALPHANUMSYM
    aaa-service             = "aaa+ap" appln-id
    appln-id                = DIGIT *DIGIT
                              ; Application identifier expressed as a
                              ; decimal integer.
  </pre>
<p id="rfc.section.3.p.2">This specification refines the "iana-registered-service" tag definition for the discovery of Diameter agents supporting a specific Diameter application as defined below.  </p>
<div id="#rfc.figure.3"></div>
<pre>
    iana-registered-protocol = aaa-protocol / ALPHA *31ALPHANUMSYM
    aaa-protocol             = "diameter." aaa-transport
    aaa-transport            = "tcp" / "sctp" / "tls.tcp"
  </pre>
<p id="rfc.section.3.p.3">This specification also refines the "iana-registered-protocol" tag definition for the discovery of Diameter agents supporting a specific Diameter transport protocol as defined below.  </p>
<p id="rfc.section.3.p.4">The maximum length of the NAPTR service field is 256 octets including one octet length field (see Section 4.1 of RFC 3403 and Section 3.3 of <a href="#RFC1035">[RFC1035]</a>).  </p>
<h1 id="rfc.section.3.1">
<a href="#rfc.section.3.1">3.1.</a> IETF Standard Track Diameter Applications </h1>
<p id="rfc.section.3.1.p.1">A Diameter agent MUST be capable of using the extended S-NAPTR Application Service Tag for dynamic discovery of a Diameter agent supporting Standard Track applications. Therefore, every IETF Standard Track Diameter application MUST be associated with a "aaa-service" tag formatted as defined in this specification and allocated in accordance with the IANA policy (see <a href="#IANA">Section 7</a>).  </p>
<p id="rfc.section.3.1.p.2">For example, a NAPTR service field value of: </p>
<p></p>

<dl>
<dt>'aaa+ap6:diameter.sctp'</dt>
<dd style="margin-left: 8">
<br><br> Means that the Diameter node in the SRV or A/AAAA record supports the Diameter Session Initiation Protocol (SIP) Application ('6') and SCTP as the transport protocol.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.3.2">
<a href="#rfc.section.3.2">3.2.</a> Vendor-specific Diameter Applications</h1>
<p id="rfc.section.3.2.p.1">S-NAPTR Application Service and Application Protocol Tag values can also be used to discover Diameter peers that support a vendor-specific Diameter application. In this case, the vendor-specific Diameter application MUST be associated with a "aaa-service" tag formatted as defined in this specification and allocated in accordance with the IANA policy (see <a href="#IANA">Section 7</a>).  </p>
<p id="rfc.section.3.2.p.2">For example, a NAPTR service field value of: </p>
<p></p>

<dl>
<dt>'aaa+ap16777251:diameter.sctp'</dt>
<dd style="margin-left: 8">
<br><br> Means that the Diameter node in the SRV or A/AAAA record supports the Diameter 3GPP S6a Application ('16777251') and SCTP as the transport protocol.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.4">
<a href="#rfc.section.4">4.</a> Backwards Compatibility</h1>
<p id="rfc.section.4.p.1">DNS administrators SHOULD also provision legacy RFC 3588 style NAPTR records <a href="#RFC2915">[RFC2915]</a> in order to guarantee backwards compatibility with legacy RFC 3588 compliant Diameter peers. If the DNS administrator provisions both extended S-NAPTR records as defined in this specification and legacy RFC 3588 NAPTR records, then the extended S-NAPTR records MUST have higher priority (e.g. lower order and/or preference values) than legacy NAPTR records.  </p>
<h1 id="rfc.section.5">
<a href="#rfc.section.5">5.</a> Extended NAPTR-based Diameter Peer Discovery</h1>
<p id="rfc.section.5.p.1">The Diameter Peer Discovery principles are described in Section 5.2 of <a href="#RFC3588">[RFC3588]</a>.  This specification updates the NAPTR query procedure in the Diameter peer discovery mechanism by allowing the querying node to determine which applications are supported by resolved Diameter peers.  </p>
<p id="rfc.section.5.p.2">The extended format NAPTR records provide a mapping from a domain to the SRV record or A/AAAA record for contacting a server supporting a specific transport protocol and Diameter application.  The resource record will contain an empty regular expression and a replacement value, which is the SRV record or the A/AAAA record for that particular transport protocol.</p>
<p id="rfc.section.5.p.3">The assumption for this mechanism to work is that the DNS administrator of the queried domain has first provisioned the DNS with extended format NAPTR entries. The steps below replace the NAPTR query procedure steps in Section 5.2 of <a href="#RFC3588">[RFC3588]</a>.  </p>
<p></p>

<dl>
<dt>a.</dt>
<dd style="margin-left: 8">The Diameter implementation performs a NAPTR query for a server in a particular realm. The Diameter implementation has to know in advance which realm to look for a Diameter agent in and which Application Identifier it is interested in. For example, the realm could be deduced from the NAI in the User-Name AVP or extracted from the Destination-Realm AVP.  </dd>
<dt>b.</dt>
<dd style="margin-left: 8">If the returned NAPTR service fields contain entries formatted as "aaa+apX:Y" where "X" indicates the Application Identifier and "Y" indicates the supported transport protocol(s), the target realm supports the extended format for NAPTR-based Diameter peer discovery defined in this document.  <dl>
<dt></dt>
<dd style="margin-left: 8">If "X" contains the required Application Identifier and "Y" matches a supported transport protocol, the Diameter implementation resolves the "replacement" field entry to a target host using the lookup method appropriate for the "flags" field.  </dd>
<dt></dt>
<dd style="margin-left: 8">If "X" does not contain the required Application Identifier or "Y" does not match a supported transport protocol, the Diameter implementation abandons the peer discovery.  </dd>
</dl>
<p> </p>
</dd>
<dt>c.</dt>
<dd style="margin-left: 8">If the returned NAPTR service fields contain entries formatted as "aaa:X" where "X" indicates the supported transport protocol(s), the target realm supports Diameter but does not support the extended format for NAPTR-based Diameter peer discovery defined in this document.  <dl>
<dt></dt>
<dd style="margin-left: 8">If "X" matches a supported transport protocol, the Diameter implementation resolves the "replacement" field entry to a target host using the lookup method appropriate for the "flags" field.  </dd>
<dt></dt>
<dd style="margin-left: 8">If "X" does not match a supported transport protocol, the Diameter implementation abandons the peer discovery.  </dd>
</dl>
<p> </p>
</dd>
<dt>d.</dt>
<dd style="margin-left: 8">If the target realm does not support NAPTR-based Diameter peer discovery, the client proceeds with the next peer discovery mechanism described in Section 5.2 of <a href="#RFC3588">[RFC3588]</a>.  </dd>
</dl>

<p> </p>
<h1 id="rfc.section.6">
<a href="#rfc.section.6">6.</a> Usage Guidelines</h1>
<p id="rfc.section.6.p.1">Diameter is a peer to peer protocol whereas most of the applications that extend the base protocol behave like client/server applications. The role of the peer is not advertised in the NAPTR tags and not even communicated during Diameter capability negotiation (CER/CEA). For this reason, NAPTR-based Diameter peer discovery for an application defining client/server roles should only be used by a client to discover servers.  </p>
<h1 id="rfc.section.7">
<a href="#rfc.section.7">7.</a> <a href="#IANA" id="IANA">IANA Considerations</a>
</h1>
<h1 id="rfc.section.7.1">
<a href="#rfc.section.7.1">7.1.</a> <a href="#ietf-apps" id="ietf-apps">IETF Diameter Application Service Tags</a>
</h1>
<p id="rfc.section.7.1.p.1">IANA is requested to reserve a value of "aaa" for Diameter in the S-NAPTR Application Service Tag registry created by <a href="#RFC3958">[RFC3958]</a>. IANA is also requested to reserve the following S-NAPTR Application Service Tags for existing IETF Diameter applications in the same registry.</p>
<div id="#rfc.table.1"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Tag</th>
<th class="left">Diameter Application</th>
</tr></thead>
<tbody>
<tr>
<td class="left">aaa+ap1</td>
<td class="left">NASREQ <a href="#RFC3588">[RFC3588]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap2</td>
<td class="left">Mobile IPv4 <a href="#RFC4004">[RFC4004]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap3</td>
<td class="left">Base Accounting <a href="#RFC3588">[RFC3588]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap4</td>
<td class="left">Credit Control <a href="#RFC4006">[RFC4006]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap5</td>
<td class="left">EAP <a href="#RFC4072">[RFC4072]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap6</td>
<td class="left">SIP <a href="#RFC4740">[RFC4740]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap7</td>
<td class="left">Mobile IPv6 IKE <a href="#RFC5778">[RFC5778]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap8</td>
<td class="left">Mobile IPv6 Auth <a href="#RFC5778">[RFC5778]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap9</td>
<td class="left">QoS <a href="#RFC5866">[RFC5866]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap4294967295</td>
<td class="left">Relay <a href="#RFC3588">[RFC3588]</a>
</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.1.p.2">Future IETF Diameter applications MUST reserve the S-NAPTR Application Service Tag corresponding to the allocated Diameter Application ID as defined in <a href="#snaptr-format">Section 3</a>.</p>
<h1 id="rfc.section.7.2">
<a href="#rfc.section.7.2">7.2.</a> <a href="#3gpp-apps" id="3gpp-apps">3GPP Diameter Application Service Tags</a>
</h1>
<p id="rfc.section.7.2.p.1">IANA is requested to reserve the following S-NAPTR Application Service Tags for existing 3GPP Diameter applications in the S-NAPTR Application Service Tag registry created by <a href="#RFC3958">[RFC3958]</a>. </p>
<div id="#rfc.table.2"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Tag</th>
<th class="left">Diameter Application</th>
</tr></thead>
<tbody>
<tr>
<td class="left">aaa+ap16777250</td>
<td class="left">3GPP STa <a href="#TS29.273">[TS29.273]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777251</td>
<td class="left">3GPP S6a <a href="#TS29.272">[TS29.272]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777264</td>
<td class="left">3GPP SWm <a href="#TS29.273">[TS29.273]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777267</td>
<td class="left">3GPP S9 <a href="#TS29.215">[TS29.215]</a>
</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.2.p.2">Future 3GPP Diameter applications can reserve entries in the S-NAPTR Application Service Tag registry created by <a href="#RFC3958">[RFC3958]</a> which correspond to the allocated Diameter Application IDs as defined in <a href="#snaptr-format">Section 3</a>.  </p>
<h1 id="rfc.section.7.3">
<a href="#rfc.section.7.3">7.3.</a> <a href="#wimax-apps" id="wimax-apps">WiMAX Forum Diameter Application Service Tags</a>
</h1>
<p id="rfc.section.7.3.p.1">IANA is requested to reserve the following S-NAPTR Application Service Tags for existing WiMAX Forum Diameter applications in the S-NAPTR Application Service Tag registry created by <a href="#RFC3958">[RFC3958]</a>.</p>
<div id="#rfc.table.3"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Tag</th>
<th class="left">Diameter Application</th>
</tr></thead>
<tbody>
<tr>
<td class="left">aaa+ap16777281</td>
<td class="left">WiMAX Network Access Authentication and Authorization Diameter Application (WNAAADA) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777282</td>
<td class="left">WiMAX Network Accounting Diameter Application (WNADA) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777283</td>
<td class="left">WiMAX MIP4 Diameter Application (WM4DA) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777284</td>
<td class="left">WiMAX MIP6 Diameter Application (WM6DA) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777285</td>
<td class="left">WiMAX DHCP Diameter Application (WDDA) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777286</td>
<td class="left">WiMAX Location Authentication Authorization Diameter Application (WLAADA) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777287</td>
<td class="left">WiMAX Policy and Charging Control R3 Policies Diameter Application (WiMAX PCC-R3-P) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777288</td>
<td class="left">WiMAX Policy and Charging Control R3 Offline Charging Diameter Application (WiMAX PCC-R3-OFC) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777289</td>
<td class="left">WiMAX Policy and Charging Control R3 Offline Charging Prime Diameter Application (WiMAX PCC-R3-OFC-PRIME) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
<tr>
<td class="left">aaa+ap16777290</td>
<td class="left">WiMAX Policy and Charging Control R3 Online Charging Diameter Application (WiMAX PCC-R3-OC) <a href="#WiMAX">[WiMAX]</a>
</td>
</tr>
</tbody>
</table>
<p id="rfc.section.7.3.p.2">Future WiMAX Forum Diameter applications can reserve entries in the S-NAPTR Application Service Tag registry created by <a href="#RFC3958">[RFC3958]</a> which correspond to the allocated Diameter Application IDs as defined in <a href="#snaptr-format">Section 3</a>.  </p>
<h1 id="rfc.section.7.4">
<a href="#rfc.section.7.4">7.4.</a> <a href="#vendor-apps" id="vendor-apps">Vendor-Specific Diameter Application Service Tags</a>
</h1>
<p id="rfc.section.7.4.p.1">Vendor-Specific Diameter Application IDs are allocated by IANA according to the "First Come First Served" policy and do not require an IETF specification.  However, the S-NAPTR Application Service Tag registry created by <a href="#RFC3958">[RFC3958]</a> defines a registration policy of "Specification Required" with a further stipulation that the "specification" is an RFC (of any category). If a Vendor-Specific Diameter Application requires the functionality defined in this document, an RFC of any category MUST be published which reserves the S-NAPTR Application Service Tag corresponding to the Vendor-Specific Diameter Application ID as defined in <a href="#snaptr-format">Section 3</a>.</p>
<h1 id="rfc.section.7.5">
<a href="#rfc.section.7.5">7.5.</a> <a href="#proto-tags" id="proto-tags">Diameter Application Protocol Tags</a>
</h1>
<p id="rfc.section.7.5.p.1">IANA is requested to reserve the following S-NAPTR Application Protocol Tags for the Diameter transport protocols in the S-NAPTR Application Protocol Tag registry created by [RFC3958].</p>
<div id="#rfc.table.4"></div>
<table cellpadding="3" cellspacing="0" class="tt full center">
<thead><tr>
<th class="left">Tag</th>
<th class="left">Protocol</th>
</tr></thead>
<tbody>
<tr>
<td class="left">diameter.tcp</td>
<td class="left">TCP</td>
</tr>
<tr>
<td class="left">diameter.sctp</td>
<td class="left">SCTP</td>
</tr>
<tr>
<td class="left">diameter.tls.tcp</td>
<td class="left">TLS/TCP</td>
</tr>
</tbody>
</table>
<h1 id="rfc.section.8">
<a href="#rfc.section.8">8.</a> <a href="#Security" id="Security">Security Considerations</a>
</h1>
<p id="rfc.section.8.p.1">This document specifies an enhancement to RFC 3588 Diameter base protocol defined NAPTR service field format and also modifications to the NAPTR processing logic defined. The enhancements and modifications are based on the S-NAPTR, which is actually a simplification of the NAPTR, and therefore the same security considerations described in RFC 3588 are applicable to this document. No further extensions are required beyond the security mechanisms offered by RFC 3588.  However, a malicious host doing S-NAPTR queries learns applications supported by Diameter agents in a certain realm faster, which might help the malicious host to scan potential targets for an attack more efficiently when some applications have known vulnerabilities.</p>
<h1 id="rfc.section.9">
<a href="#rfc.section.9">9.</a> Acknowledgments</h1>
<p id="rfc.section.9.p.1">We would like to thank Glen Zorn, Avi Lior, Itsuma Tanaka, Lionel Morand and Sebastien Decugis for their comprehensive review comments.  </p>
<h1 id="rfc.section.10">
<a href="#rfc.section.10">10.</a> Editor's Notes</h1>
<p id="rfc.section.10.p.1">This section to be removed prior to publication.</p>
<p id="rfc.section.10.p.2">This draft updates sections of RFC3588 that are also being updated by RFC3588bis. At the time this draft was started, it was uncertain whether RFC3588bis would be published first. The authors of this draft decided to proceed optimistically assuming this draft would be published first with the understanding that minor updates are required if this is not the case.  </p>
<p id="rfc.section.10.p.3">The application-neutral aspects of Diameter S-NAPTR usage (e.g "aaa:diameter.sctp") were also contributed to RFC3588bis to ensure that it would be functionally complete if it got published first and this draft would come along later to add the application-specific S-NAPTR entries (e.g."aaa+ap5:diameter.sctp").  </p>
<p id="rfc.section.10.p.4">Depending on the publication order, the S-NAPTR Application Service Tag registry value of "aaa" and the S-NAPTR Application Protocol Tags values ("diameter.tcp"/"diameter.sctp"/"diameter.tls.tcp") will need to be removed either from this draft or RFC3588bis.  </p>
<h1 id="rfc.references">
<a href="#rfc.references">11.</a> References</h1>
<h1 id="rfc.references.1">
<a href="#rfc.references.1">11.1.</a> Normative References</h1>
<table><tbody>
<tr>
<td class="reference"><b id="RFC2119">[RFC2119]</b></td>
<td class="top">
<a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, "<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>", BCP 14, RFC 2119, March 1997.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3403">[RFC3403]</b></td>
<td class="top">
<a>Mealling, M.</a>, "<a href="http://tools.ietf.org/html/rfc3403">Dynamic Delegation Discovery System (DDDS) Part Three: The Domain Name System (DNS) Database</a>", RFC 3403, October 2002.</td>
</tr>
<tr>
<td class="reference"><b id="RFC1035">[RFC1035]</b></td>
<td class="top">
<a title="USC/ISI">Mockapetris, P.</a>, "<a href="http://tools.ietf.org/html/rfc1035">Domain names - implementation and specification</a>", STD 13, RFC 1035, November 1987.</td>
</tr>
<tr>
<td class="reference"><b id="RFC2782">[RFC2782]</b></td>
<td class="top">
<a href="mailto:arnt@troll.no" title="Troll Tech">Gulbrandsen, A.</a>, <a title="Internet Software Consortium">Vixie, P.</a> and <a href="mailto:levone@microsoft.com" title="Microsoft Corporation">L. Esibov</a>, "<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>", RFC 2782, February 2000.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3958">[RFC3958]</b></td>
<td class="top">
<a>Daigle, L.</a> and <a>A. Newton</a>, "<a href="http://tools.ietf.org/html/rfc3958">Domain-Based Application Service Location Using SRV RRs and the Dynamic Delegation Discovery Service (DDDS)</a>", RFC 3958, January 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3588">[RFC3588]</b></td>
<td class="top">
<a>Calhoun, P.</a>, <a>Loughney, J.</a>, <a>Guttman, E.</a>, <a>Zorn, G.</a> and <a>J. Arkko</a>, "<a href="http://tools.ietf.org/html/rfc3588">Diameter Base Protocol</a>", RFC 3588, September 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4004">[RFC4004]</b></td>
<td class="top">
<a>Calhoun, P.</a>, <a>Johansson, T.</a>, <a>Perkins, C.</a>, <a>Hiller, T.</a> and <a>P. McCann</a>, "<a href="http://tools.ietf.org/html/rfc4004">Diameter Mobile IPv4 Application</a>", RFC 4004, August 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4006">[RFC4006]</b></td>
<td class="top">
<a>Hakala, H.</a>, <a>Mattila, L.</a>, <a>Koskinen, J-P.</a>, <a>Stura, M.</a> and <a>J. Loughney</a>, "<a href="http://tools.ietf.org/html/rfc4006">Diameter Credit-Control Application</a>", RFC 4006, August 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4072">[RFC4072]</b></td>
<td class="top">
<a>Eronen, P.</a>, <a>Hiller, T.</a> and <a>G. Zorn</a>, "<a href="http://tools.ietf.org/html/rfc4072">Diameter Extensible Authentication Protocol (EAP) Application</a>", RFC 4072, August 2005.</td>
</tr>
<tr>
<td class="reference"><b id="RFC4740">[RFC4740]</b></td>
<td class="top">
<a>Garcia-Martin, M.</a>, <a>Belinchon, M.</a>, <a>Pallares-Lopez, M.</a>, <a>Canales-Valenzuela, C.</a> and <a>K. Tammi</a>, "<a href="http://tools.ietf.org/html/rfc4740">Diameter Session Initiation Protocol (SIP) Application</a>", RFC 4740, November 2006.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5778">[RFC5778]</b></td>
<td class="top">
<a>Korhonen, J.</a>, <a>Tschofenig, H.</a>, <a>Bournelle, J.</a>, <a>Giaretta, G.</a> and <a>M. Nakhjiri</a>, "<a href="http://tools.ietf.org/html/rfc5778">Diameter Mobile IPv6: Support for Home Agent to Diameter Server Interaction</a>", RFC 5778, February 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5866">[RFC5866]</b></td>
<td class="top">
<a>Sun, D.</a>, <a>McCann, P.</a>, <a>Tschofenig, H.</a>, <a>Tsou, T.</a>, <a>Doria, A.</a> and <a>G. Zorn</a>, "<a href="http://tools.ietf.org/html/rfc5866">Diameter Quality-of-Service Application</a>", RFC 5866, May 2010.</td>
</tr>
<tr>
<td class="reference"><b id="RFC3596">[RFC3596]</b></td>
<td class="top">
<a>Thomson, S.</a>, <a>Huitema, C.</a>, <a>Ksinant, V.</a> and <a>M. Souissi</a>, "<a href="http://tools.ietf.org/html/rfc3596">DNS Extensions to Support IP Version 6</a>", RFC 3596, October 2003.</td>
</tr>
<tr>
<td class="reference"><b id="RFC5234">[RFC5234]</b></td>
<td class="top">
<a>Crocker, D.</a> and <a>P. Overell</a>, "<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>", STD 68, RFC 5234, January 2008.</td>
</tr>
<tr>
<td class="reference"><b id="TS29.272">[TS29.272]</b></td>
<td class="top">
<a>3rd Generation Partnership Project</a>, "<a>3GPP TS 29.272; Technical Specification Group Core Network and Terminals; Evolved Packet System; Mobility Management Entity (MME) and Serving GPRS Support Node (SGSN) Related Interfaces Based on Diameter Protocol (Release 8) </a>",  http://www.3gpp.org/ftp/Specs/html-info/29272.htm, .</td>
</tr>
<tr>
<td class="reference"><b id="TS29.273">[TS29.273]</b></td>
<td class="top">
<a>3rd Generation Partnership Project</a>, "<a>3GPP TS 29.273; Technical Specification Group Core Network and Terminals; Evolved Packet System; 3GPP EPS AAA interfaces (Release 8) </a>",  http://www.3gpp.org/ftp/Specs/html-info/29273.htm, .</td>
</tr>
<tr>
<td class="reference"><b id="TS29.215">[TS29.215]</b></td>
<td class="top">
<a>3rd Generation Partnership Project</a>, "<a>3GPP TS 29.215; Technical Specification Group Core Network and Terminals; Policy and Charging Control (PCC) over S9 reference point; Stage 3 (Release 8) </a>",  http://www.3gpp.org/ftp/Specs/html-info/29215.htm, .</td>
</tr>
<tr>
<td class="reference"><b id="WiMAX">[WiMAX]</b></td>
<td class="top">
<a>WiMAX Forum</a>, "<a>WiMAX Release 1.5</a>",  http://www.wimaxforum.org/resources/documents/technical/T33, .</td>
</tr>
</tbody></table>
<h1 id="rfc.references.2">
<a href="#rfc.references.2">11.2.</a> Informative References</h1>
<table><tbody><tr>
<td class="reference"><b id="RFC2915">[RFC2915]</b></td>
<td class="top">
<a>Mealling, M.</a> and <a>R. Daniel</a>, "<a href="http://tools.ietf.org/html/rfc2915">The Naming Authority Pointer (NAPTR) DNS Resource Record</a>", RFC 2915, September 2000.</td>
</tr></tbody></table>
<h1 id="rfc.authors"><a href="#rfc.authors">Authors' Addresses</a></h1>
<div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Mark Jones</span> 
	  <span class="n hidden">
		<span class="family-name">Jones</span>
	  </span>
	</span>
	<span class="org vcardline">Bridgewater Systems</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:mark@azu.ca">mark@azu.ca</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Jouni Korhonen</span> 
	  <span class="n hidden">
		<span class="family-name">Korhonen</span>
	  </span>
	</span>
	<span class="org vcardline">Nokia Siemens Networks</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:jouni.nospam@gmail.com">jouni.nospam@gmail.com</a></span>

  </address>
</div><div class="avoidbreak">
  <address class="vcard">
	<span class="vcardline">
	  <span class="fn">Lionel Morand</span> 
	  <span class="n hidden">
		<span class="family-name">Morand</span>
	  </span>
	</span>
	<span class="org vcardline">Orange Labs</span>
	<span class="adr">
	  
	  <span class="vcardline">
		<span class="locality"></span> 
		<span class="region"></span>
		<span class="code"></span>
	  </span>
	  <span class="country-name vcardline"></span>
	</span>
	<span class="vcardline">EMail: <a href="mailto:lionel.morand@orange-ftgroup.com">lionel.morand@orange-ftgroup.com</a></span>

  </address>
</div>

</body>
</html>