<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>HTTP Authentication with SASL</title>
<meta content="Rick van Rein" name="author">
<meta content="
       Most application-level protocols standardise their authentication
 exchanges under the SASL framework.  HTTP has taken another course, and
 often ends up replicating the work to allow individual mechanisms.
 This specification adopts full SASL authentication into HTTP. 
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="draft-vanrein-httpauth-sasl-05" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-vanrein-httpauth-sasl-05-tzzs11bq.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">HTTP SASL</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Van Rein</td>
<td class="center">Expires 1 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-vanrein-httpauth-sasl-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-01-28" class="published">28 January 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-01">1 August 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">R. Van Rein</div>
<div class="org">ARPA2.net</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">HTTP Authentication with SASL</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Most application-level protocols standardise their authentication
 exchanges under the SASL framework.  HTTP has taken another course, and
 often ends up replicating the work to allow individual mechanisms.
 This specification adopts full SASL authentication into HTTP.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 1 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-embedding-sasl-in-http" class="xref">Embedding SASL in HTTP</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-http-request-and-response-m" class="xref">HTTP Request and Response Messages</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1" class="keepWithNext"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-authentication-field-defini" class="xref">Authentication Field Definitions</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-caching-authentication-resu" class="xref">Caching Authentication Results</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-server-side-user-name" class="xref">Server-Side User Name</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-authentication-session-exam" class="xref">Authentication Session Example</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-A" class="xref">Appendix A</a>.  <a href="#name-http-server-environment-var" class="xref">HTTP Server Environment Variables</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-B" class="xref">Appendix B</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-C" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">HTTP has historically followed its own path for client authentication,
while many other end-user protocols standardised on SASL;
examples of SASL protocols include SMTP, IMAP, POP, XMPP, LDAP, AMQP and MQTT.
This specification introduces SASL to HTTP, so it may share in
past and future work done for SASL in general.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">Among the work that could be shared is backend authentication integration,
which is possible due to protocol-independent SASL exchanges for any given
method, making it easy to take them out of one protocol and inserting them
into another.  Although HTTP has adopted several SASL-compatible authentication
methods, it uses various notations and so it still needs method-specific
support at the HTTP level to translate them to a SASL backend.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">In front-ends, a similar situation has arisen.  The varying syntaxes
for authentication methods have made it difficult to rely on support in
most or all HTTP clients.  When such clients could externalise their
SASL handling to generic software such as a SASL library, then any extension
to a library automatically spills over into the HTTP sphere.  It is common
for developers of web clients to also produce email clients, so a shared
code base (and credential store) is not difficult to imagine.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Sharing of authentication mechanisms is beneficial in both directions.
HTTP benefits by being able to use anything from
strong password mechanisms <span>[<a href="#RFC5802" class="xref">RFC5802</a>]</span> without explicit
support <span>[<a href="#RFC7804" class="xref">RFC7804</a>]</span> in applications,
up to GS2 mechanisms <span>[<a href="#RFC5801" class="xref">RFC5801</a>]</span>
with channel binding <span>[<a href="#RFC5056" class="xref">RFC5056</a>]</span> <span>[<a href="#RFC5554" class="xref">RFC5554</a>]</span>
to TLS <span>[<a href="#RFC5929" class="xref">RFC5929</a>]</span>
based on pinning either the certificate for the TLS server or even a
unique part of the individual TLS connection; for instance Kerberos5
<span>[<a href="#RFC4120" class="xref">RFC4120</a>]</span>
currently uses Negotiate authentication <span>[<a href="#RFC4559" class="xref">RFC4559</a>]</span> which is not
as secure as GS2-KRB5-PLUS over SASL.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">SASL also benefits; had it been the norm for HTTP,
then the work to pass SAML over it <span>[<a href="#RFC6595" class="xref">RFC6595</a>]</span> would
probably have been done immediately.  In fact, HTTP can still benefit from
receiving standardised SAML20 inquiries over SASL, because it resolves the
need for configuration of initiation paths and practices.  Also, it removes
authentication data from URIs, where they are not ideally placed.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">In terms of security for HTTP applications, it appears beneficial to
have very good authentication capabilities in the layers below the
application; this is specifically true for applications developed in
HTML and JavaScript, which tend to load code from various places,
including code that is not always in the end user's interest; since it
already is a concern what identity information passes through these
applications, it is not advisable to use credentials in those
places.  The HTTP layer is in a better position to take control over these
assets, at the protocol levels of HTTP and TLS, and conceal credentials
and possibly also identity from applications running on top.  Inasfar
as tokens are needed, they can be derived from session keys using
generally accepted key derivation schemes, but the session keys can
be isolated from dynamic layers above HTTP.<a href="#section-1-6" class="pilcrow">¶</a></p>
</section>
</div>
<div id="spec">
<section id="section-2">
      <h2 id="name-embedding-sasl-in-http">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-embedding-sasl-in-http" class="section-name selfRef">Embedding SASL in HTTP</a>
      </h2>
<p id="section-2-1">This specification integrates the SASL framework <span>[<a href="#RFC4422" class="xref">RFC4422</a>]</span>
into mainstream HTTP <span>[<a href="#RFC7231" class="xref">RFC7231</a>]</span>, <span>[<a href="#RFC7232" class="xref">RFC7232</a>]</span>.
The SASL Authentication scheme follows the general structure for
HTTP Authentication <span>[<a href="#RFC7235" class="xref">RFC7235</a>]</span>.  It uses the WWW-Authenticate
and Proxy-Authenticate headers in responses from web servers and web
proxies, respectively, and correspondingly the Authorization and
Proxy-Authorization request header to answer to requests.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The SASL service name for the following embedding of SASL is HTTP;
contrary to most other service names, it is spelled in uppercase,
in line with what has become general practice in Kerberos and GSSAPI.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">Since SASL prescribes channel binding to occur relative to TLS instead
of to the application protocol, we can add that when the HTTPS transport
is used.    Whether channel binding is used SHOULD remain a
configuration choice in HTTP software, as it might interfere with
intentional HTTPS proxying.  Unintended proxying on the other hand,
might lead to tapping of credentials under certain SASL mechanisms,
and it may be considered helpful to prevent such situations by
requiring channel binding for those situations.  HTTP in general allows
a user session to hop between connections, and browsers are likely to do
this; to support this, the support of tls-server-end-point channel
binding [Section 4 of <span>[<a href="#RFC5929" class="xref">RFC5929</a>]</span>] is RECOMMENDED.
Specific HTTP clients may exercise more control over connections
to achieve stronger security; for those use cases, tls-unique
channel binding [Section 3 of <span>[<a href="#RFC5929" class="xref">RFC5929</a>]</span>] is RECOMMENDED.
Generic web servers SHOULD support both forms of channel binding.<a href="#section-2-3" class="pilcrow">¶</a></p>
<div id="reqresp">
<section id="section-2.1">
        <h3 id="name-http-request-and-response-m">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-http-request-and-response-m" class="section-name selfRef">HTTP Request and Response Messages</a>
        </h3>
<p id="section-2.1-1">This section defines a few names for HTTP request and response
messages, to be used in the remainder of this specification.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Initial Responses are HTTP responses that normally set a status code 401 or 407,
and that are sent when the HTTP server decides to initiate an authentication
exchange.  In addition, the server MAY send Initial Responses in other
responses, to indicate to the client that it MAY try again to
achieve better results [Section 4.1 of <span>[<a href="#RFC7235" class="xref">RFC7235</a>]</span>].<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Initial Requests are those HTTP requests that a client sends to initiate
a fresh SASL authentication.  The identity SHOULD be selected by the user
independently from the URI; prior settings MAY however be remembered by a
client for the combination of resource authority (scheme, host and possibly
a separately communicated resource user name) with the server-sent realm
string.  The server can support a mixture of client identities for various
roles or access levels through variation of realm strings.  There is no
current practice of server-side resource names in HTTP, but the generic
URI schema presents this logic and it is easy to imagine an HTTP User header
that a client could support.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Intermediate Responses are HTTP responses to SASL authentication,
with a status code set to 401 or 407.
Intermediate Requests are those HTTP requests that a client sends to
continue a SASL authentication after an Intermediate Response.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">Positive Responses set a 200 status code to depict success.  Information
in this response is provided in an Authentication-Info or
Proxy-Authentication-Info header
<span>[<a href="#RFC7615" class="xref">RFC7615</a>]</span> instead of the headers
used in Initial Responses and Intermediate Responses <span>[<a href="#RFC7235" class="xref">RFC7235</a>]</span>.
Proper interpretation of a Positive Response requires client state
indicating that SASL authentication was used, or else the optional fields are
not completely reliable information sources; cryptographic markers in the
c2c field MAY be used to overcome this in a manner that defies abuse by
rogue servers.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">Negative Responses also set a 401 or 407 status code and will often
return the client to an earlier state that it recognises as one it has
tried before.  These responses should therefore offer authentication to
start again.  In contrast to the Initial Response, there is now a c2c
field that helps the client evaluate the request.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">The following fields, defined in upcoming sections, MUST and MAY be present
in HTTP authentication exchanges for SASL:<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-2.1-8">
<pre>
Request or Response   | MUST have fields | MAY have fields
----------------------+------------------+-----------------
Initial Response      | s2s,mech         |     realm
Initial Request       |     mech         | c2s,realm,s2s
Intermediate Response | s2s              | s2c
Intermediate Request  | s2s              | c2s
Positive Response     |                  | s2s
Negative Response     | s2s,mech         |     realm
</pre><a href="#section-2.1-8" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="sasldata">
<section id="section-2.2">
        <h3 id="name-authentication-field-defini">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-authentication-field-defini" class="section-name selfRef">Authentication Field Definitions</a>
        </h3>
<p id="section-2.2-1">Data for SASL is transported in the following fields:<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-2">
          <dt id="section-2.2-2.1">c2s</dt>
          <dd style="margin-left: 3.0em" id="section-2.2-2.2">
 holds SASL token data from client to server.
 This field is transmitted with base64 encoding.
 The field is absent when the SASL client sends no token.<a href="#section-2.2-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.3">s2c</dt>
          <dd style="margin-left: 3.0em" id="section-2.2-2.4">
 holds SASL token data from server to client.
 This field is transmitted with base64 encoding.
 The field is absent when the SASL server sends no token.<a href="#section-2.2-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-2.5">s2s</dt>
          <dd style="margin-left: 3.0em" id="section-2.2-2.6">
 holds opaque server data which the client MUST reflect in
 Intermediate Requests and, when responding to an
 Initial Response, in the Initial Request.
 This is a necessity for a stateless HTTP Authentication framework
 [Section 5.1.2 of <span>[<a href="#RFC7235" class="xref">RFC7235</a>]</span>].  It MAY be used
 in a Positive Response to pass a cacheable <a href="#cache" class="xref">Section 2.3</a>
 authentication token in a future Initial Request.<a href="#section-2.2-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-2.2-3">The following fields support SASL within the HTTP Authentication Framework:<a href="#section-2.2-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-2.2-4">
          <dt id="section-2.2-4.1">realm</dt>
          <dd style="margin-left: 3.0em" id="section-2.2-4.2">
 optionally names a scope of authorisation under the combination
 of scheme, server host name and possibly a HTTP user to implement
 the semantics of the generic URI username for resource selection.
 The realm does not necessarily match a domain name, which is used
 elsewhere as a realm notation.<a href="#section-2.2-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-2.2-4.3">mech</dt>
          <dd style="margin-left: 3.0em" id="section-2.2-4.4">
 In an Initial Response, the field is filled with a
 space-separated list of SASL mechanism names;
 In an Initial Request, the client chooses one SASL mechanism
 name.<a href="#section-2.2-4.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="cache">
<section id="section-2.3">
        <h3 id="name-caching-authentication-resu">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-caching-authentication-resu" class="section-name selfRef">Caching Authentication Results</a>
        </h3>
<p id="section-2.3-1">When an HTTP server sends a Positive Response, it MAY include
an "s2s" field.  If it does this, then it should be prepared to accept
the field value for authentication in an Initial Request.  However,
credentials can expire or fall in disgrace for other reasons, so
the server MAY still choose to reject the provided field.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3-2">When an HTTP client receives a Positive Response with an
"s2s" field, it MAY memorise the fields for future reuse in an
Initial Request, either with or without preceding Initial Response
from the server.  The HTTP client MUST use the realm as part of the
decision which cached result to use, but it MAY extrapolate the
results from one resource retrieval in an attempt to authenticate
another.<a href="#section-2.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3-3">When cached fields result in a Negative Response then the
HTTP client SHOULD remove the failing cache entry, and it SHOULD
try again by going through a full SASL authentication cycle.
The stateless nature of HTTP authentication is helpful in the
sense that a new Initial Request can be sent to an older
Initial Response.<a href="#section-2.3-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="user">
<section id="section-3">
      <h2 id="name-server-side-user-name">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-server-side-user-name" class="section-name selfRef">Server-Side User Name</a>
      </h2>
<p id="section-3-1">HTTP does not define a mechanism to specifically select the
user as an authoritative resource name space on the server.  Local
syntax conventions exist, but lack universally reliable semantics.
Basic authentication has been used to this effect, but this
conflates the client identity with the server-side name space,
which is not necessarily the same.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">To allow HTTP servers to zoom in on user-specific information,
the User header is hereby introduced.  Its syntax matches the
userinfo part of a URI, up to but excluding any colons in it:<a href="#section-3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-3-3">
<pre>
User = *( unreserved / pct-encoded / sub-delims )
</pre><a href="#section-3-3" class="pilcrow">¶</a>
</div>
<p id="section-3-4">
The value of the header MUST be percent-decoded before the
server can use it to identify a local user.<a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">The User header MAY be sent by clients, and HTTP servers
MAY ignore it for any reason, including local user identities
that do not comply to a more restrictive local user name
syntax.<a href="#section-3-5" class="pilcrow">¶</a></p>
<p id="section-3-6">When an HTTP server makes use of the User header, it MUST
include a Vary header in its response, with either a single "*"
in it or the name "User".  This informs caches that the response
must be considered specific to the User header value in the
matching request.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">The User header may be used with or without any form of
authentication.  When used with authentication, the value of
the percent-decoded header is considered part of the authority
component of the resource, and therefore of the naming scope
for the realm.  Clients can use this refined notion of realm
to select an authentication identity; when the value is known
early enough, this may even help to select an X.509 client
certificate.  Note that the User header might be used together
with the aforementioned practice of Basic authentication, but
it can also replace it with an even simpler mechanism to
free up the authentication exchange for HTTP SASL.<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">The distinction of a client-side user from a server-side
user can benefit the use of credential schemes that are not
tied to the HTTP server.  A specific example of this is the
current work on realm crossover with GS2-SXOVER-PLUS.  The
use of such a mechanism may offload security concerns from
the application layer.<a href="#section-3-8" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-4">
      <h2 id="name-authentication-session-exam">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-authentication-session-exam" class="section-name selfRef">Authentication Session Example</a>
      </h2>
<p id="section-4-1">This section is non-normative.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">When an HTTP server receives a request for a protected page, it will send an Initial Response to ask for authentication with a special status code 401; for proxy access that would be 407, and header names change accordingly.  Stripped down to the bare essentials, the server sends (this section adds whitespace for clarity)<a href="#section-4-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-3">
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: SASL
    realm="members only"
    mech="SCRAM-SHA-256 SCRAM-SHA-256-PLUS
          SCRAM-SHA-1 SCRAM-SHA-1-PLUS
          GS2-KRB5-PLUS GS2-KRB5",
    s2s="[xxxxx]"
</pre><a href="#section-4-3" class="pilcrow">¶</a>
</div>
<p id="section-4-4">
The server offers SCRAM-* and GS2-KRB5 mechanisms.  The variants with -PLUS provide additional channel binding, to ensure that authentication is specific to the current HTTPS connection, thus avoiding replay of the session across connections.  Clients aware of HTTP connections may use connection-specific channel binding (tls-unique) while those that abstract from the connections must resort to weaker name-based channel binding (tls-server-end-point).<a href="#section-4-4" class="pilcrow">¶</a></p>
<p id="section-4-5">The server might have additionally offered the ANONYMOUS mechanism to allow the client to select "guest mode" access; the interaction would continue as authenticated, but presumably with limited access to HTTP resources and continued WWW-Authenticate headers to continue to offer authentication to improve resource information content.  The server might have offered EXTERNAL to allow the client to incorporate a TLS credential for authentication and possibly change to an authorization identity.  The server might have offered GS2-SXOVER-PLUS if it is willing to connect to the client's home realm over Diameter, and thereby support realm crossover of SASL credentials.<a href="#section-4-5" class="pilcrow">¶</a></p>
<p id="section-4-6">The client initiates the SCRAM-SHA-256-PLUS mechanism, and to that end sends an Initial Request (this section shows square brackets around text that is transmitted with base64-encoding)<a href="#section-4-6" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-7">
<pre>
Authorization: SASL
    realm="members only"
    mech="SCRAM-SHA-256-PLUS",
    c2s="[n,,n=user,r=rOprNGfwEbeRWgbNEkqO]",
    s2s="[xxxxx]"
</pre><a href="#section-4-7" class="pilcrow">¶</a>
</div>
<p id="section-4-8">
This mechanism is initiated by the client, hence the inclusion of the c2s token in the Initial Request.  The contents of this field are specific to the selected mechanism, so SCRAM-SHA-256-PLUS in this case.<a href="#section-4-8" class="pilcrow">¶</a></p>
<p id="section-4-9">The SCRAM mechanism implementation is now initiated with the c2s token, and the server produces a followup challenge in a s2c token.  To be able to validate future client messages against server-side state, it includes such state in an s2s token.  This token is presumably protected from abuse with a signature and/or encryption, and it would likely identify the selected mechanism to validate during later rounds.  The server packs all this in an Intermediate Response<a href="#section-4-9" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-10">
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authentication: SASL
    s2c="[r=rOprNGfwEbeRWgbNEkqO%hvYDpWUa2RaTCAfuxF
          Ilj)hNlF$k0,s=W22ZaJ0SNY7soEsUEjb6gQ==,
          i=4096]"
    s2s="[yyyyy]"
</pre><a href="#section-4-10" class="pilcrow">¶</a>
</div>
<p id="section-4-11">Given that all server state is contained in this message, the client is free at any time to give up authentication and perhaps try another method.  Normally however, it would proceed with the ongoing transaction.<a href="#section-4-11" class="pilcrow">¶</a></p>
<p id="section-4-12">The SCRAM mechanism continues with another round.  The client engages in the prescribed cryptographic computations and packs an Intermediate Request along with updated state in the new c2s token<a href="#section-4-12" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-13">
<pre>
Authorization: SASL
    c2s="[c=biws,r=rOprNGfwEbeRWgbNEkqO%hvYDpWUa2RaTCAfuxFIlj)hN
         lF$k0,p=dHzbZapWIk4jUhN+Ute9ytag9zjfMHgsqmmiz7AndVQ=]"
    s2s="[yyyyy]"
</pre><a href="#section-4-13" class="pilcrow">¶</a>
</div>
<p id="section-4-14">When the client has performed authentication properly, as determined by a server-side check of the c2s response token with the prior state in the s2s token, it can send a Positive Response along with the requested resource<a href="#section-4-14" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-15">
<pre>
HTTP/1.1 200 OK
WWW-Authentication: SASL
    s2c="[v=6rriTRBi23WpRR/wtup+mMhUZUn/dB5nLTJRsjl95G4=]"
    s2s="[zzzzz]"
</pre><a href="#section-4-15" class="pilcrow">¶</a>
</div>
<p id="section-4-16">The s2s token in a Positive Response is an optional extension.  It is presented by the server to allow the client to speed up authentication in future requests.  The client may send it whenever the server asks for the same realm string under the same scheme and authority; the client may make proactive assumpions about the realm string for new requests.  Authentication must never be reused in another context than bound by channel binding.  When used, the client immediate sends an Intermediate Response holding<a href="#section-4-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-4-17">
<pre>
Authorization: SASL
    realm="members only"
    s2s="[zzzzz]"
</pre><a href="#section-4-17" class="pilcrow">¶</a>
</div>
<p id="section-4-18">The server always has an option to refuse repeated authentication and forcing the client into a new authentication round.  One reason for this could be that a session timed out.  Another might be that the client is trying to use a credential outside a scope set by channel binding.<a href="#section-4-18" class="pilcrow">¶</a></p>
</section>
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">It is not generally safe for SASL mechanisms to
exchange c2s and s2c messages over unprotected transports.  Furthermore,
the SASL exchange may be at risk of tampering when the sequence of
HTTP messages is not secured to form one stream.  This means that a
secure transport layer must be used, like TLS.  The termination of such
a secure layer MUST also terminate any ongoing SASL handshakes.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The s2s field MUST be protected against tampering by rogue
peers, and such
protection also protects against tampering by rogue intermediates when
using an unprotected transport.  In addition, but dependent on the
mechanism used, the s2s field may also
need encryption to conceal their data from peers and intermediates.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">SASL EXTERNAL can be a very efficient mechanism to combine with a
secure transport layer if that includes authentication.  This may be the case
for TLS, especially when client-side authentication is deployed.
Mechanisms other than EXTERNAL should take into account that a relation
may exist between identities negotiated in the protective layer and the
SASL exchange over HTTP.  For example, a login account may be exchanged
for an alias or group identity.<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Channel binding is available in some SASL mechanisms.  When used with
HTTP SASL over TLS, it binds to the TLS channel.
When doing so, it is vital that either there be no renegotiation of the
TLS handshake, or both secure renegotiation
<span>[<a href="#RFC5746" class="xref">RFC5746</a>]</span> and the extended master secret
<span>[<a href="#RFC7627" class="xref">RFC7627</a>]</span> are used.<a href="#section-5-4" class="pilcrow">¶</a></p>
<p id="section-5-5">The User header field as defined herein is orthogonal to issues of
authentication and authorisation, and adds no security concerns.<a href="#section-5-5" class="pilcrow">¶</a></p>
</section>
<section id="section-6">
      <h2 id="name-iana-considerations">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-6-1">This specification extends the "Hypertext Transfer Protocol (HTTP)
Authentication Scheme Registry" with an "Authentication Scheme Name"
SASL, referencing this specification.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">This specification defines an additional entry in the registry
"Generic Security Service Application Program Interface (GSSAPI)/Kerberos/Simple Authentication and Security Layer (SASL) Service Names"
namely:<a href="#section-6-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-3">
<pre>
Service Name: HTTP
Usage:        Web authentication using the SASL framework
Reference:    TBD:this specification
</pre><a href="#section-6-3" class="pilcrow">¶</a>
</div>
<p id="section-6-4">
The capitalisation of the service name has historic origins and is now the
preferred spelling for reasons of compatibility.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">Please add the following entry to the Message Headers registry:<a href="#section-6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6-6">
<pre>
Header Field Name   Template   Protocol   Status    Reference
------------------  ---------  ---------  -------   ----------
User                           http       TBD       TBD:THIS_SPEC
</pre><a href="#section-6-6" class="pilcrow">¶</a>
</div>
</section>
<section id="section-7">
      <h2 id="name-references">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-7.1">
        <h3 id="name-normative-references">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC4120">[RFC4120]</dt>
        <dd>
<span class="refAuthor">Neuman, C.</span>, <span class="refAuthor">Yu, T.</span>, <span class="refAuthor">Hartman, S.</span>, and <span class="refAuthor">K. Raeburn</span>, <span class="refTitle">"The Kerberos Network Authentication Service (V5)"</span>, <span class="seriesInfo">RFC 4120</span>, <span class="seriesInfo">DOI 10.17487/RFC4120</span>, <time datetime="2005-07" class="refDate">July 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4120">https://www.rfc-editor.org/info/rfc4120</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4559">[RFC4559]</dt>
        <dd>
<span class="refAuthor">Jaganathan, K.</span>, <span class="refAuthor">Zhu, L.</span>, and <span class="refAuthor">J. Brezak</span>, <span class="refTitle">"SPNEGO-based Kerberos and NTLM HTTP Authentication in Microsoft Windows"</span>, <span class="seriesInfo">RFC 4559</span>, <span class="seriesInfo">DOI 10.17487/RFC4559</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4559">https://www.rfc-editor.org/info/rfc4559</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4422">[RFC4422]</dt>
        <dd>
<span class="refAuthor">Melnikov, A., Ed.</span> and <span class="refAuthor">K. Zeilenga, Ed.</span>, <span class="refTitle">"Simple Authentication and Security Layer (SASL)"</span>, <span class="seriesInfo">RFC 4422</span>, <span class="seriesInfo">DOI 10.17487/RFC4422</span>, <time datetime="2006-06" class="refDate">June 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4422">https://www.rfc-editor.org/info/rfc4422</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5056">[RFC5056]</dt>
        <dd>
<span class="refAuthor">Williams, N.</span>, <span class="refTitle">"On the Use of Channel Bindings to Secure Channels"</span>, <span class="seriesInfo">RFC 5056</span>, <span class="seriesInfo">DOI 10.17487/RFC5056</span>, <time datetime="2007-11" class="refDate">November 2007</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5056">https://www.rfc-editor.org/info/rfc5056</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5554">[RFC5554]</dt>
        <dd>
<span class="refAuthor">Williams, N.</span>, <span class="refTitle">"Clarifications and Extensions to the Generic Security Service Application Program Interface (GSS-API) for the Use of Channel Bindings"</span>, <span class="seriesInfo">RFC 5554</span>, <span class="seriesInfo">DOI 10.17487/RFC5554</span>, <time datetime="2009-05" class="refDate">May 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5554">https://www.rfc-editor.org/info/rfc5554</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5746">[RFC5746]</dt>
        <dd>
<span class="refAuthor">Rescorla, E.</span>, <span class="refAuthor">Ray, M.</span>, <span class="refAuthor">Dispensa, S.</span>, and <span class="refAuthor">N. Oskov</span>, <span class="refTitle">"Transport Layer Security (TLS) Renegotiation Indication Extension"</span>, <span class="seriesInfo">RFC 5746</span>, <span class="seriesInfo">DOI 10.17487/RFC5746</span>, <time datetime="2010-02" class="refDate">February 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5746">https://www.rfc-editor.org/info/rfc5746</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5801">[RFC5801]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span> and <span class="refAuthor">N. Williams</span>, <span class="refTitle">"Using Generic Security Service Application Program Interface (GSS-API) Mechanisms in Simple Authentication and Security Layer (SASL): The GS2 Mechanism Family"</span>, <span class="seriesInfo">RFC 5801</span>, <span class="seriesInfo">DOI 10.17487/RFC5801</span>, <time datetime="2010-07" class="refDate">July 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5801">https://www.rfc-editor.org/info/rfc5801</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5929">[RFC5929]</dt>
        <dd>
<span class="refAuthor">Altman, J.</span>, <span class="refAuthor">Williams, N.</span>, and <span class="refAuthor">L. Zhu</span>, <span class="refTitle">"Channel Bindings for TLS"</span>, <span class="seriesInfo">RFC 5929</span>, <span class="seriesInfo">DOI 10.17487/RFC5929</span>, <time datetime="2010-07" class="refDate">July 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5929">https://www.rfc-editor.org/info/rfc5929</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6595">[RFC6595]</dt>
        <dd>
<span class="refAuthor">Wierenga, K.</span>, <span class="refAuthor">Lear, E.</span>, and <span class="refAuthor">S. Josefsson</span>, <span class="refTitle">"A Simple Authentication and Security Layer (SASL) and GSS-API Mechanism for the Security Assertion Markup Language (SAML)"</span>, <span class="seriesInfo">RFC 6595</span>, <span class="seriesInfo">DOI 10.17487/RFC6595</span>, <time datetime="2012-04" class="refDate">April 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6595">https://www.rfc-editor.org/info/rfc6595</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7231">[RFC7231]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Semantics and Content"</span>, <span class="seriesInfo">RFC 7231</span>, <span class="seriesInfo">DOI 10.17487/RFC7231</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7231">https://www.rfc-editor.org/info/rfc7231</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7232">[RFC7232]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Conditional Requests"</span>, <span class="seriesInfo">RFC 7232</span>, <span class="seriesInfo">DOI 10.17487/RFC7232</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7232">https://www.rfc-editor.org/info/rfc7232</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7235">[RFC7235]</dt>
        <dd>
<span class="refAuthor">Fielding, R., Ed.</span> and <span class="refAuthor">J. Reschke, Ed.</span>, <span class="refTitle">"Hypertext Transfer Protocol (HTTP/1.1): Authentication"</span>, <span class="seriesInfo">RFC 7235</span>, <span class="seriesInfo">DOI 10.17487/RFC7235</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7235">https://www.rfc-editor.org/info/rfc7235</a>&gt;</span>. </dd>
<dd class="break"></dd><dt id="RFC7615">[RFC7615]</dt>
        <dd>
<span class="refAuthor">Reschke, J.</span>, <span class="refTitle">"HTTP Authentication-Info and Proxy-Authentication-Info Response Header Fields"</span>, <span class="seriesInfo">RFC 7615</span>, <span class="seriesInfo">DOI 10.17487/RFC7615</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7615">https://www.rfc-editor.org/info/rfc7615</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7627">[RFC7627]</dt>
        <dd>
<span class="refAuthor">Bhargavan, K., Ed.</span>, <span class="refAuthor">Delignat-Lavaud, A.</span>, <span class="refAuthor">Pironti, A.</span>, <span class="refAuthor">Langley, A.</span>, and <span class="refAuthor">M. Ray</span>, <span class="refTitle">"Transport Layer Security (TLS) Session Hash and Extended Master Secret Extension"</span>, <span class="seriesInfo">RFC 7627</span>, <span class="seriesInfo">DOI 10.17487/RFC7627</span>, <time datetime="2015-09" class="refDate">September 2015</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7627">https://www.rfc-editor.org/info/rfc7627</a>&gt;</span>. </dd>
<dd class="break"></dd></dl>
</section>
<section id="section-7.2">
        <h3 id="name-informative-references">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="RFC5802">[RFC5802]</dt>
        <dd>
<span class="refAuthor">Newman, C.</span>, <span class="refAuthor">Menon-Sen, A.</span>, <span class="refAuthor">Melnikov, A.</span>, and <span class="refAuthor">N. Williams</span>, <span class="refTitle">"Salted Challenge Response Authentication Mechanism (SCRAM) SASL and GSS-API Mechanisms"</span>, <span class="seriesInfo">RFC 5802</span>, <span class="seriesInfo">DOI 10.17487/RFC5802</span>, <time datetime="2010-07" class="refDate">July 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5802">https://www.rfc-editor.org/info/rfc5802</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7804">[RFC7804]</dt>
        <dd>
<span class="refAuthor">Melnikov, A.</span>, <span class="refTitle">"Salted Challenge Response HTTP Authentication Mechanism"</span>, <span class="seriesInfo">RFC 7804</span>, <span class="seriesInfo">DOI 10.17487/RFC7804</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7804">https://www.rfc-editor.org/info/rfc7804</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.vanrein-dnstxt-krb1">[I-D.vanrein-dnstxt-krb1]</dt>
      <dd>
<span class="refAuthor">Rein, R.</span>, <span class="refTitle">"Declaring Kerberos Realm Names in DNS (_kerberos TXT)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-vanrein-dnstxt-krb1-09</span>, <time datetime="2016-10-24" class="refDate">24 October 2016</time>, <span>&lt;<a href="http://www.ietf.org/internet-drafts/draft-vanrein-dnstxt-krb1-09.txt">http://www.ietf.org/internet-drafts/draft-vanrein-dnstxt-krb1-09.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="envvars">
<section id="appendix-A">
      <h2 id="name-http-server-environment-var">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-http-server-environment-var" class="section-name selfRef">HTTP Server Environment Variables</a>
      </h2>
<p id="appendix-A-1">We define a number of variables that SHOULD be passed
from an HTTP SASL stack (and from User header processing)
to applications run on top of it.  The intention of
defining these is to obtain maximum interoperability between
these layers of software.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">The following variables MUST NOT be available until
SASL authentication is successful; it would be available
when the server could send a 200 OK response:<a href="#appendix-A-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="appendix-A-3">
        <dt id="appendix-A-3.1">SASL_SECURE</dt>
        <dd style="margin-left: 3.0em" id="appendix-A-3.2"> is only "yes" (without the
    quotes) when a client is authenticated
    to the current resource.  It never has
    another value; it is simply undefined when not
    secured by SASL.<a href="#appendix-A-3.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="appendix-A-3.3">SASL_REALM</dt>
        <dd style="margin-left: 3.0em" id="appendix-A-3.4"> is the realm for which the secure
    exchange succeeded.  A realm is not always used,
    because sites only need it when there are more than
    one in the same name space.  When undefined in the
    SASL flow, this variable will not be set.<a href="#appendix-A-3.4" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="appendix-A-3.5">REMOTE_USER</dt>
        <dd style="margin-left: 3.0em" id="appendix-A-3.6"> is the client identity as confirmed through
    SASL authentication.  Its content is formatted like
    an email address, and includes a domain name.  That
    domain need not be related to the web server; it is
    possible for a web server to welcome foreign clients.<a href="#appendix-A-3.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="appendix-A-3.7">SASL_MECH</dt>
        <dd style="margin-left: 3.0em" id="appendix-A-3.8"> indicates the mechanism used, and
    is one of the standardised SASL mechanism names.
    It may be used to detect the level of security.<a href="#appendix-A-3.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="appendix-A-3.9">SASL_S2S</dt>
        <dd style="margin-left: 3.0em" id="appendix-A-3.10"> holds the accepted s2s field, and
    could be used as a random session identifier.  It
    would normally be encrypted information.<a href="#appendix-A-3.10" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
<dt id="appendix-A-3.11">SASL_S2S_</dt>
        <dd style="margin-left: 3.0em" id="appendix-A-3.12"> is a prefix for extra information that
    the server may extract from the s2s field in
    the HTTP SASL protocol flow.  This depends on the
    authentication stack used in the web server.<a href="#appendix-A-3.12" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
<p id="appendix-A-4">The following variable SHOULD be available while processing
a request with a User header with locally acceptable syntax:<a href="#appendix-A-4" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="appendix-A-5">
        <dt id="appendix-A-5.1">LOCAL_USER</dt>
        <dd style="margin-left: 3.0em" id="appendix-A-5.2">gives the HTTP User header value
 after syntax checking and percent-decoding.  If used at all,
 it MUST be treated as a resource name space selector.
 This header does not describe the authenticated client identity,
 which is usually passed in a variable REMOTE_USER.<a href="#appendix-A-5.2" class="pilcrow">¶</a>
</dd>
      <dd class="break"></dd>
</dl>
</section>
</div>
<div id="ack">
<section id="appendix-B">
      <h2 id="name-acknowledgements">
<a href="#appendix-B" class="section-number selfRef">Appendix B. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-B-1">Thanks to Henri Manson for making the first implementation
of this specification and for feedback on the header formats.
The specification also benefited from input by Daniel Stenberg.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rick van Rein</span></div>
<div dir="auto" class="left"><span class="org">ARPA2.net</span></div>
<div dir="auto" class="left"><span class="street-address">Haarlebrink 5</span></div>
<div dir="auto" class="left"><span class="locality">Enschede</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rick@openfortress.nl" class="email">rick@openfortress.nl</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
