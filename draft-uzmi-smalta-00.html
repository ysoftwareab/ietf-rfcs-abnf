<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>FIB Aggregation with SMALTA</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="FIB Aggregation with SMALTA">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">Z. Uzmi</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">A. Tariq</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">LUMS</td></tr>
<tr><td class="header">Expires: January 6, 2011</td><td class="header">P. Francis</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">MPI-SWS</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 05, 2010</td></tr>
</table></td></tr></table>
<h1><br />FIB Aggregation with SMALTA<br />draft-uzmi-smalta-00.txt</h1>

<h3>Abstract</h3>

<p> 
Concerns about the growth of the global routing table has led to
proposals for short-term FIB-reduction and long-term RIB-reduction
solutions.  The simplest type of FIB-reduction solution is "FIB aggregation",
whereby individual routers locally reduce the FIB size without any 
changes to external operation.  The draft
<a class='info' href='#I-D.zhang-fibaggregation'>[I&#8209;D.zhang&#8209;fibaggregation]<span> (</span><span class='info'>Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;FIB Aggregation,&rdquo; October&nbsp;2009.</span><span>)</span></a>
describes and analyzes several FIB aggregation schemes.
This current draft describes and analyzes another point in the design
space, called SMALTA.
Compared to the approaches in <a class='info' href='#I-D.zhang-fibaggregation'>[I&#8209;D.zhang&#8209;fibaggregation]<span> (</span><span class='info'>Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;FIB Aggregation,&rdquo; October&nbsp;2009.</span><span>)</span></a>, SMALTA 
provides better aggregation and does not introduce non-routable entries
in the FIB, but is also more complex.

</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on January 6, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Requirements notation<br />
<a href="#anchor3">3.</a>&nbsp;
Design of SMALTA<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">3.1.</a>&nbsp;
Example 1:  Simple SMALTA One-Shot Aggregation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.2.</a>&nbsp;
Example 2: SMALTA Update Algorithm for BGP WITHDRAW<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.3.</a>&nbsp;
Example 2: SMALTA Update Algorithm for BGP ANNOUNCE<br />
<a href="#sec-analysis">4.</a>&nbsp;
Analysis<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#subsec-one-shot">4.1.</a>&nbsp;
SMALTA One Shot Aggregation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#subsec-update-processing">4.2.</a>&nbsp;
Update Processing in SMALTA<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">4.3.</a>&nbsp;
Updates and Aggregated Table Size<br />
<a href="#sec-iana">5.</a>&nbsp;
IANA Considerations<br />
<a href="#sec-consider">6.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> 
FIB Aggregation is an approach to shrinking the size of a
router's FIB without requiring any changes to the external
behavior of the router.  While FIB Aggregation per se
is not a new idea, interest
has recently increased alongside the growing concern over global
routing table growth.  
FIB Aggregation represents a short-term but simple fix that can
extend the lifetime of existing routers as well as reduce FIB
size requirements for routers in the future.
The draft 
<a class='info' href='#I-D.zhang-fibaggregation'>[I&#8209;D.zhang&#8209;fibaggregation]<span> (</span><span class='info'>Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;FIB Aggregation,&rdquo; October&nbsp;2009.</span><span>)</span></a>
provides a very good
overview of the problem space, and so is not repeated here.
<a class='info' href='#I-D.zhang-fibaggregation'>[I&#8209;D.zhang&#8209;fibaggregation]<span> (</span><span class='info'>Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;FIB Aggregation,&rdquo; October&nbsp;2009.</span><span>)</span></a>
also describes four FIB Aggregation algorithms, called
Level 1 through Level 4, each 
adding complexity but providing better aggregation over its predecessor.

</p>
<p>
These 4 levels all have the characteristic that they require a
complete crawl through the FIB to produce full aggregation.
They can also be incrementally updated to respond to changes
in routes, but these incremental updates don't maintain full
aggregation.
The third and fourth levels have the characteristic that they introduce
non-routable space into the routing table.  In other words, packets
destined for prefixes that are not in the RIB, and would therefore
otherwise be dropped, may nevertheless be forwarded towards the
destination.

</p>
<p>
This draft introduces another FIB aggregation algorithm,
SMALTA, that can be viewed as a 5th level in that it
is yet more complex, and provides still better aggregation.
Like the first four levels, SMALTA's incremental updates cause
the FIB to deviate from its fully aggregated state and, therefore,
also requires a periodic re-compute of the full FIB.
Unlike the third and fourth levels, SMALTA introduces no non-routable
space into the FIB.  It is semantically identical to the non-aggregated
FIB.

</p>
<p>
In a nutshell, what distinguishes SMALTA from the first four
levels is the following.  In the first four levels, aggregation is
always done either by assigning a nexthop to an ancestor prefix, or by removing
nexthop(s) of descendent prefix(es).  
In other words, if there is a prefix in the pre-aggregated
tree, it will either remain unchanged or will be aggregated with a less specific
prefix in the aggregated tree. SMALTA provides additional reduction in the FIB by 
allowing prefixes to be de-aggregated i.e. to be split into one or more
specific prefixes.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
            "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
            and "OPTIONAL" in this document are to be interpreted as
	    described in 
	    <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
    
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Design of SMALTA</h3>

<p>
SMALTA is composed of two algorithms: the one-shot aggregation and an incremental update algorithm.
The implementations of these algorithms assume a binary tree structure, but is not limited to this
and can be easily applied to other data structures. Furthermore, similar to the example set in
<a class='info' href='#I-D.zhang-fibaggregation'>[I&#8209;D.zhang&#8209;fibaggregation]<span> (</span><span class='info'>Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;FIB Aggregation,&rdquo; October&nbsp;2009.</span><span>)</span></a>, the one-shot aggregation and update algorithms in SMALTA 
do not introduce any new data
structure in the RIB or the FIB, using the existing structures that stores these tables.

</p>
<p>
SMALTA one-shot aggregation algorithm takes the current snapshot of the RIB and
produces an aggregated version of it. This aggregated table is downloaded to the
FIB, as a monolithic download, during router startup or after a BGP hard reset.
This algorithm can also be invoked at any time
to improve the amount of aggregation,
for example (i) at regular intervals to ensure that the number of entries in the
forwarding table remains small, (ii) when the FIB size exceeds a threshold, or
(iii) on-demand when there occurs a significant routing change such as addition
or deletion of a physical interface, changes to the IGP metrics or a BGP session
restart.

</p>
<p>
	The update algorithm incrementally incorporates any subsequent BGP updates 
	(withdraw or announce) into
the aggregated table. Any resulting change in the aggregated table is then
reflected in the FIB through an on-demand RIB to FIB download.
The update algorithm is efficient for single updates, but slightly
degrades the aggregated state of the table.
The update algorithm is invoked whenever there is a change in the primary
route of a prefix in the RIB. When that happens, SMALTA computes the necessary 
changes to the prefixes in the aggregated table.
Note that some changes to the aggregated table result in no required
changes to the FIB, and others may require multiple changes to the FIB.
<a class='info' href='#sec-analysis'>Section&nbsp;4<span> (</span><span class='info'>Analysis</span><span>)</span></a> gives results of measurements
showing the average and worst-case number of FIB changes per BGP update.
	
</p>
<p>
	In the following sections, we provide examples that give the basic
	idea of how the SMALTA algorithms work.  
	Complete details are available in a technical report <a class='info' href='#TR.Uzmi-SMALTA'>[TR.Uzmi&#8209;SMALTA]<span> (</span><span class='info'>Uzmi, Z., Jawad, S., Tariq, A., and P. Francis, &ldquo;Prefix Aggregation with SMALTA,&rdquo; July&nbsp;2010.</span><span>)</span></a>

</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Example 1:  Simple SMALTA One-Shot Aggregation</h3>

<p>
Figure 1A represents an original (non-aggregated)
table with four prefixes, using the convention introduced in 
<a class='info' href='#I-D.zhang-fibaggregation'>[I&#8209;D.zhang&#8209;fibaggregation]<span> (</span><span class='info'>Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;FIB Aggregation,&rdquo; October&nbsp;2009.</span><span>)</span></a>.

</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


               (C)              (C)
              /                /
             /                /
            ()               (A)
           /  \             /
          /    \           /
         (B)   (A)        ()
        /                   \
       /                     \
      (A)                    (B)

      ORIGINAL TABLE     ONE-SHOT AGGREGATED TABLE

        FIGURE 1A           FIGURE 1B

</pre></div><p>



Note that none of the Level 1 through Level 4 
algorithms can further aggregate 
this table. By contrast, SMALTA would aggregate this table
as shown in figure 1B.

</p>
<p>
With SMALTA,
the prefix with next hop B in the original table is de-aggregated in the 
  aggregated table. This de-aggregation 
  creates an opportunity for the prefixes with next hop A to be aggregated. 
  The resulting aggregated
  table is semantically equivalent to the original table.

</p>
<p>
SMALTA's one-shot aggregation is derived from ORTC
<a class='info' href='#Paper.Draves-ORTC'>[Paper.Draves&#8209;ORTC]<span> (</span><span class='info'>Draves, R. and J. Doe, &ldquo;Optimal Routing Table Constructor,&rdquo; July&nbsp;1999.</span><span>)</span></a>. 
Like its precursor, one-shot runs three passes over a tree data
structure:

<p></p>
<ol class="text">
<li>
A normalization pass in which the
prefixes are expanded such that every node in the binary tree has two or no
children,

</li>
<li>
A post-order traversal up the tree, wherein
each node is assigned a set of next hops, and

</li>
<li>
A pass where the algorithm assigns next hops to prefix nodes in
the tree starting from the root and traversing through to the leaves, removing
any unnecessary leaves.

</li>
</ol>


Unlike ORTC, SMALTA one-shot is not provably optimal, though it is
very close to optimal.  This is because SMALTA places some minor
constraints on the ORTC algorithm in order to allow the aggregated
table and the original non-aggregated table to
be implemented as a single data structure.


<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Example 2: SMALTA Update Algorithm for BGP WITHDRAW</h3>

<p>	 
	 To incorporate a withdraw for a prefix P1, the ownership of the IP space originally covered by P1
should be given up in favor of the next hop of its immediate ancestor prefix P in the original table. This is simply achieved by setting nexthop of P1 equal to that of P in
the aggregated table. Next we restore all nearest descendent prefixes of P1 if their nexthop does not 
match the new nexthop of P1. Finally, we reclaim the
space covered by the deaggregates of P1 by setting their nexthops equal to that of P.
	 
</p>
<p>	
Figure 2A shows the non-aggregated table before the withdraw, and
indicates to which prefix the withdraw occurs.
Figure 2B shows the non-aggregated table after the withdraw.
Figure 2C shows the aggregated table that would result from applying
the one-shot algorithm to the non-aggregated table of Figure 2A.
Note that as a result of one-shot, there is in fact no nexthop in
the entry to which the withdraw is being applied.
Figure 2D shows the aggregated table after applying the update
to the table of Figure 2C, using SMALTA update algorithm.
	
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

               (C)                   (C)
              /                     /
             /                     /
            ()                    ()
           /  \                  /  \
          /    \                /    \
         (B)   (A)             (B)   (A)
        /
       /
      (A) &lt;--- Withdraw

      WITHDRAW IN           RESULT OF WITHDRAW
      ORIGINAL TABLE        ON ORIGINAL TABLE

      FIGURE 2A              FIGURE 2B

</pre></div><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>



                         (C)                    (C)
                        /                      /
                       /                      /
                      (A)                    ()
                     /                      /  \
                    /                      /    \
                   ()                     ()    (A)
                  /  \                   /  \
                 /    \                 /    \
   Withdraw --&gt; ()     (B)             (B)   (B)

  WITHDRAW IN AGGREGATED TABLE       RESULT OF WITHDRAW
                                     ON AGGREGATED TABLE

	FIGURE 2C                       FIGURE 2D


</pre></div>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.3"></a><h3>3.3.&nbsp;
Example 2: SMALTA Update Algorithm for BGP ANNOUNCE</h3>

<p>
In order to incorporate an announce for a prefix P1, the IP address space of P1 should be assigned the
nexthop of P1 if that next hop does not match the next hop of P, the immediate ancestor of P1. Next,
all nearest descendent prefixes of P1 that have a nexthop that differs from the announced nexthop are restored. Finally, the deaggregate prefixes of P
that are specifics of P1 have their nexthops set to that of P1.
	
</p>
<p>
Figures 3A and 3C give the non-aggregated and aggregated tables
respectively before the announce, and show to which prefix the
announce takes place (corresponding to Figures 2A and 2C).
Figure 3B shows the non-aggregated table after the BGP update, and
Figure 3D shows the aggregated table after the SMALTA update algorithm
is applied.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


          (C)                          (C)
          /                            /
         /                            /
        ()                           ()
       /  \                         /  \
      /    \                       /    \
     (B)   (A)                    (B)   (A)
    /  \                         /  \
   /    \                       /    \
  (A)   ()  &lt;-- ANNOUNCE Q     (A)   (Q)

  ANNOUNCE IN                  RESULT OF ANNOUNCE
  ORIGINAL TABLE               ON ORIGINAL TABLE

  FIGURE 3A                    FIGURE 3B



</pre></div><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>


           (C)                         (C)
          /                           /
         /                           /
        (A)                         (A)
       /                           /
      /                           /
     ()                          ()
       \                           \
        \                           \
        (B) &lt;-- ANNOUNCE Q          (Q)

    ANNOUNCE IN                 RESULT OF ANNOUNCE
    AGGREGATED TABLE            ON AGGREGATED TABLE

     FIGURE 3C                  FIGURE 3D



</pre></div>
<a name="sec-analysis"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Analysis</h3>

<a name="subsec-one-shot"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
SMALTA One Shot Aggregation</h3>

<p>
The extent of aggregation achieved by the SMALTA one-shot aggregation algorithm
is given in Table 1. This table also lists the number of entries in the 
aggregated table, obtained after applying Level 1 and Level 2 aggregation from 
<a class='info' href='#I-D.zhang-fibaggregation'>[I&#8209;D.zhang&#8209;fibaggregation]<span> (</span><span class='info'>Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;FIB Aggregation,&rdquo; October&nbsp;2009.</span><span>)</span></a>. Level 3 and Level 4 aggregation
results are not provided because these levels create extra routable space and 
hence can not be fairly compared with the SMALTA one-shot aggregation algorithm 
which does not create any extra routable space. 
(The authors have also produced a version of SMALTA that does create
extra routable space, and provides substantially more aggregation than 
the version here.  This algorithm may be described in a future version.)

</p>
<p>
It can be seen from Table 1 that SMALTA one-shot algorithm consistently provides 
better aggregation as compared to that provided by Level 1 and Level 2 algorithms.

</p>
<p>

In Table 1:


</p>
<p> #(OT) = Number of entries in the original table
</p>
<p> #(AT one-shot) = Number of entries in aggregated table after applying SMALTA one-shot algorithm. (% of #(OT) is also shown)
</p>
<p>#Level 1 Aggregation = Number of entries in FIB after applying Level 1 Aggregation

	      								  <a class='info' href='#I-D.zhang-fibaggregation'>[I&#8209;D.zhang&#8209;fibaggregation]<span> (</span><span class='info'>Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;FIB Aggregation,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p>
<p>#Level 2 Aggregation = Number of entries in FIB after applying Level 2 Aggregation  

	      								<a class='info' href='#I-D.zhang-fibaggregation'>[I&#8209;D.zhang&#8209;fibaggregation]<span> (</span><span class='info'>Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;FIB Aggregation,&rdquo; October&nbsp;2009.</span><span>)</span></a>.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   +=======+========+==========+=============+==============+
   | Year  |#(OT)   | #(AT)    | #Level 1    | #Level 2     |
   |       |        |(one-shot)| Aggregation | Aggregation  |
   +-------+--------+----------+-------------+--------------+
   | 2004  | 160818 | 54340    | 103565      |  69572       |
   |	   |	    | (33.7%)  | (64.39%)    |  (43.2%)     |
   +-------+--------+----------+-------------+--------------+
   | 2005  | 176474 | 55801    | 109169      |  73169       |
   |	   |        | (31.6%)  | (61.86%)    |  (41.4%)     |
   +-------+--------+----------+-------------+--------------+
   | 2006  | 203082 | 75356    | 139763      |  96993       |
   |	   |	    | (37.1%)  | (68.8%)     |  (47.7%)     |
   +-------+--------+----------+-------------+--------------+
   | 2007  | 240162 | 83282    | 161147      |  110065      |
   |	   |	    | (34.6%)  | (67.0%)     |  (45.8%)     |
   +-------+--------+----------+-------------+--------------+
   | 2008  | 269532 | 84170    | 178676      |  117139      |
   |       |	    | (31.2%)  | (66.2%)     |  (43.4%)     |
   +=======+========+==========+=============+==============+

TABLE 1: FIB Aggregation with SMALTA one-shot and comparison with
         Level 1 and Level 2 aggregation.

</pre></div>
<a name="subsec-update-processing"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Update Processing in SMALTA</h3>

<p>
A single BGP update may change the primary route for a single prefix. This may,
in turn, change the next hop for multiple prefixes (or for no prefix) in the 
aggregated table. Table 2 shows the number of prefixes in the aggregated table whose
next hop is modified (either changed or removed) as a result of a single 
change in the primary route of a prefix. These modified entries are then added 
or deleted from the aggregated FIB through RIB to FIB download. As indicated in
Table 2, the average number of such modified entries remains small
over various years.

</p>
<p>
It may be noted that when aggregation is not used, a change in the primary route
of a prefix is translated to precisely one RIB to FIB download. Thus, on average,
the number of RIB to FIB downloads in SMALTA are comparable to the number of RIB
to FIB downloads when no aggregation is used.

</p>
<p>
The table also shows the maximum number of entries modified in the aggregated 
table as a result of a single change in primary route for a prefix. This worst 
case usually occurs when a BGP update arrives for very short prefixes (/8 in 
most cases). This is expected because shorter prefixes
represent a larger IP address space, with the possibility that a larger number
of more specific prefixes will fall within that space.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   +======+========+==============+===============+=================+
   | Year | No. of | Avg #entries | Max. #entries | Prefix for Max. |
   |      | updates| modified     | modified      | modified        |
   +------+--------+--------------+---------------+-----------------+
   | 2004 | 86904  | 1.0494       | 300           |  /8             |
   +------+--------+--------------+---------------+-----------------+
   | 2005 | 140920 | 1.0962       | 157           |  /8             |
   +------+--------+--------------+---------------+-----------------+
   | 2006 | 121651 | 0.9660       | 499           |  /8             |
   +------+--------+--------------+---------------+-----------------+
   | 2007 | 246634 | 1.3141       | 376           |  /11            |
   +------+--------+--------------+---------------+-----------------+
   | 2008 | 240802 | 0.4031       | 64            |  /8             |
   +======+========+==============+===============+=================+

TABLE 2: Number of entries modified when directly incorporating updates
	 into aggregated table

</pre></div>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Updates and Aggregated Table Size</h3>

<p>
SMALTA one-shot aggregation is performed only infrequently. In between two episodes
of one-shot aggregation, any BGP updates are incorporated using the SMALTA 
update algorithm. When incorporating the BGP updates incrementally,
it is important to track how the size of the aggregated table changes. Ideally,
we would want to keep the FIB in its fully aggregated state (what would have 
resulted from one-shot aggregation).

</p>
<p>We used the routeviews tables from 2004 to 2008, one table from each year,
and applied a corresponding update trace to the aggregated table using SMALTA 
update algorithm. The resulting number of entries (in the aggregated table),
as a percentage of the number of un-aggregated entries, are shown in Table 3.

</p>
<p>
Table 3 also indicates the number of entries in the aggregated table if SMALTA
one-shot algorithm is applied after incorporating the updates in the original
un-aggregated table.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>

   +======+========+========================+=========================+
   | Year | No. of | #entries in aggregated | #entries in aggregated  |
   |      | updates| table (SMALTA update)  | table (SMALTA one-shot) |
   |      |        |  (% of unaggregated)   |  (% of unaggregated)    |
   +------+--------+------------------------+-------------------------+
   | 2004 | 86904  | 35.50                  | 34.38                   |
   +------+--------+------------------------+-------------------------+
   | 2005 | 140920 | 36.69                  | 33.08                   |
   +------+--------+------------------------+-------------------------+
   | 2006 | 121651 | 45.51                  | 39.9                    |
   +------+--------+------------------------+-------------------------+
   | 2007 | 246634 | 60.18                  | 40.25                   |
   +------+--------+------------------------+--------------------------
   | 2008 | 240802 | 32.99                  | 31.72                   |
   +======+========+========================+=========================+

TABLE 3: Number of Entries in the aggregated table after applying
	 updates using (i) SMALTA one-shot, and (ii) SMALTA update

</pre></div>
<a name="sec-iana"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
There are no IANA considerations.

</p>
<a name="sec-consider"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>
Because SMALTA does not change the external behavior of a router,
there are no security considerations.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.zhang-fibaggregation">[I-D.zhang-fibaggregation]</a></td>
<td class="author-text">Zhang, B., Wang, L., Zhao, X., Liu, Y., and L. Zhang, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-zhang-fibaggregation-02.txt">FIB Aggregation</a>,&rdquo; draft-zhang-fibaggregation-02 (work in progress), October&nbsp;2009 (<a href="http://www.ietf.org/internet-drafts/draft-zhang-fibaggregation-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="Paper.Draves-ORTC">[Paper.Draves-ORTC]</a></td>
<td class="author-text">Draves, R. and J. Doe, &ldquo;Optimal Routing Table Constructor,&rdquo; INFOCOM&nbsp;1999, July&nbsp;1999.</td></tr>
<tr><td class="author-text" valign="top"><a name="TR.Uzmi-SMALTA">[TR.Uzmi-SMALTA]</a></td>
<td class="author-text">Uzmi, Z., Jawad, S., Tariq, A., and P. Francis, &ldquo;Prefix Aggregation with SMALTA,&rdquo; Technical Report&nbsp;URL http://www.mpi-sws.org/~zartash/TR-MPI-SMALTA.pdf, July&nbsp;2010.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Zartash Uzmi</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lahore University of Management Sciences</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">LUMS, D.H.A.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lahore  54792</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Pakistan</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+92 42 35608202</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:zartash@gmail.com">zartash@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ahsan Tariq</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lahore University of Management Sciences</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">LUMS, D.H.A.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Lahore  54792</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Pakistan</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+92 42 35608000</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ahsan.tariq11@gmail.com">ahsan.tariq11@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Paul Francis</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Max Planck Institute for Software Systems</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gottlieb-Daimler-Strasse</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Kaiserslautern  67633</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 631 930 39600</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:francis@mpi-sws.org">francis@mpi-sws.org</a></td></tr>
</table>
</body></html>
