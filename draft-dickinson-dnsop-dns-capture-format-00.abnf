File = [
    file-type-id  : tstr,          ; "DNS-STAT"
    file-preamble : FilePreamble,
    file-blocks   : [* Block],
FilePreamble = {
format-version  => uint,
format-version = 0
configuration  = 1
generator-id   = 2
host-id        = 3

Configuration = {
    ? query-timeout    => uint,
    ? skew-timeout     => uint,
    ? snaplen          => uint,
    ? promisc          => uint,
    ? interfaces       => [* tstr],
    ? vlan-ids         => [* uint],
    ? filter           => tstr,
    ? query-options    => uint,    ; See below
    ? response-options => uint,
    ? accept-rr-types  => [* tstr],
    ? ignore-rr-types  => [* tstr],
query-timeout    = 0
skew-timeout     = 1
snaplen          = 2
promisc          = 3
interfaces       = 4
vlan-ids         = 5
filter           = 6
query-options    = 7
response-options = 8
accept-rr-types  = 9;
ignore-rr-types  = 10;


Block = {
preamble             => BlockPreamble,
tables               => BlockTables,
queries              => [* QueryResponse],
address-event-counts => [* AddressEventCount],
preamble             = 0
statistics           = 1
tables               = 2
queries              = 3
address-event-counts = 4

BlockPreamble = {
start-time => Timeval
start-time = 1

Timeval = [
    seconds      : uint,
    microseconds : uint,
BlockStatistics = {
    ? total-packets        => uint,
    ? total-pairs          => uint,
    ? unmatched_queries    => uint,
    ? unmatched_responses  => uint,
    ? malformed-packets    => uint,
    ? non-dns-packets      => uint,
    ? out-of-order-packets => uint,
    ? missing-pairs        => uint,
    ? missing-packets      => uint,
    ? missing-non-dns      => uint,
total-packets        = 0
total-pairs          = 1
unmatched_queries    = 2
unmatched_responses  = 3
malformed-packets    = 4
non-dns-packets      = 5
out-of-order-packets = 6
missing-pairs        = 7
missing-packets      = 8
missing-non-dns      = 9
BlockTables = {
ip-address => [* bstr],
classtype  => [* ClassType],
name-rdata => [* bstr],            ; Holds both Name RDATA and RDATA
query_sig  => [* QuerySignature]
ip-address = 0
classtype  = 1
name-rdata = 2
query_sig  = 3
qlist      = 4
qrr        = 5
rrlist     = 6
rr         = 7

QueryResponse = {
time-useconds         => int,        ; Time offset from start of block
client-address-index  => uint,
client-port           => uint,
transaction-id        => uint,
query-signature-index => uint,
time-useconds         = 0
client-address-index  = 1
client-port           = 2
transaction-id        = 3
query-signature-index = 4
client-hoplimit       = 5
delay-useconds        = 6
query-name-index      = 7
response-size         = 8
query-extended        = 9
response-extended     = 10

ClassType = {
type  => uint,
class => uint,
type  = 0
class = 1

QuerySignature = {
server-address-index    => uint,
server-port             => uint,
transport-flags         => uint,
qr-sig-flags            => uint,
qr-dns-flags            => uint,
server-address-index  = 0
server-port           = 1
transport-flags       = 2
qr-sig-flags          = 3
query-opcode          = 4
qr-dns-flags          = 5
query-rcode           = 6
query-classtype-index = 7
query-qd-count        = 8
query-an-count        = 9
query-ar-count        = 10
query-ns-count        = 11
edns-version          = 12
udp-buf-size          = 13
opt-rdata-index       = 14
response-rcode        = 15

QuestionList = [
    * uint,                           ; Index of Question
Question = {                          ; Second and subsequent questions
name-index      => uint,          ; Index to a name in the name-rdata table
classtype-index => uint,
name-index      = 0
classtype-index = 1

RRList = [
    * uint,                           ; Index of RR
RR = {
name-index      => uint,          ; Index to a name in the name-rdata table
classtype-index => uint,
ttl             => uint,
rdata-index     => uint,          ; Index to RDATA in the name-rdata table
ttl         = 2
rdata-index = 3

QueryResponseExtended = {
    ? question-index   => uint,       ; Index of QuestionList
    ? answer-index     => uint,       ; Index of RRList
    ? authority-index  => uint,
    ? additional-index => uint,
question-index   = 0
answer-index     = 1
authority-index  = 2
additional-index = 3

AddressEventCount = {
ae-type          => &AddressEventType,
ae-address-index => uint,
ae-count         => uint,
ae-type          = 0
ae-code          = 1
ae-address-index = 2
ae-count         = 3

AddressEventType = (
    tcp-reset: 0,
    icmp-time-exceeded     : 1,
    icmp-dest-unreachable  : 2,
    icmpv6-time-exceeded   : 3,
    icmpv6-dest-unreachable: 4,
    icmpv6-packet-too-big  : 5,
