server_random = ServerHello.random
client_random = ClientHello.random
Ephemeral = ephemeral     ## ephemeral_method = secret_provided
Ephemeral = ephemeral     ## ephemeral_method = secret_provided
tag=last_exchange        -------->
freshness = sha256
ephemeral_method = secret_generated
handshake = handshake (x25519)
certificate = finger_print
secret_request = h_s, h_c, a_s, and a_c
sig_algo = ed25519
                                      SInitCertVerifyResponse
tag=last_exchange
group = x25519,
key_exchange = public_key
signature = sig
freshness = sha256
ephemeral_method = secret_provided
group = x25519
shared_secret = shared_secret
handshake = handshake
certificate = finger_print
secret_request = h_s, h_c, a_s, and a_c
sig_algo = ed25519
                                      SInitCertVerifyResponse
                                        tag.last_exchange=True
                                        secret_list
signature = sig
session_id = session_id_tls_server    -------->
freshness = sha256
ephemeral_method = secret_generated
handshake = handshake (x25519)
certificate = finger_print
secret_request = h_s, h_c, a_s, a_c
sig_algo = ed25519
                                      SInitCertVerifyResponse
                                        tag.last_exchange=False
session_id = session_id_cs
group = x25519,
key_exchange = public_key
signature = sig
session_id = session_id_cs
handshake = client Finished
certificate_type = empty
session_id = session_id_tls_server
session_id = session_id_tls_server
freshness = sha256
selected_identity = 0
handshake = ClientHello
secret_request = b
                                      SInitEarlySecretResponse
session_id = session_id_cs
session_id = session_id_cs
ephemeral_method = secret_generated
handshake = ServerHello(x25519) ... EncryptedExtensions
secret_request = h_c, h_s, a_c, a_s ------->
                                    SHandAndAppResponse
                                      tag.last_exchange = True
session_id = session_id_tls_server
group = x25519,
key_exchange = public_key
session_id = session_id_tls_client
freshness = sha256
ephemeral_method = secret_generated
handshake = ClientHello(x25519, x488, ... )
c_psk_id_list = []
secret_request = []    ------>
                                   CInitClientHello
session_id=session_id_cs
group = x25519,
key_exchange = public_key
ephemeral_method = secret_generated
group = x488,
key_exchange = public_key
secret_list=[]
session_id=session_id_cs
ephemeral_method = no_secret
handshake = ServerHello, {EncryptedExtensions}...,{Finished}.
secret_request = h_c, h_s, a_c, a_s ------->
                                   CHandAndAppSecretResponse
                                     tag
last_message=False
cert_request=False
session_id=session_id_tls_clt
ephemeral_list = []
secret_request = h_s, h_c, a_s, and a_c

session_id=session_id_cs
ticket_list = [NewSessionTicket]
                   ---------------->
                                      RegisterTicketsResponse
last_message=False
session_id=session_id_tls_clt
session_id = session_id_tls_client
freshness = sha256
ephemeral_method = no_secret
handshake = ClientHello without PreSharedKeyExtension
c_psk_id_list = [nst_id]
secret_request = [b]    ------>
                                      CInitClientHello
session_id=session_id_cs
ephemeral_list = []
secret_list=[binder_key]

session_id=session_id_cs
ephemeral_method = secret_provided
handshake = ServerHello, {EncryptedExtensions}...,{Finished}.
secret_request = h_c, h_s, a_c, a_s ------->
                                   CHandAndAppSecretResponse
                                     tag
last_message=False
cert_request=False
session_id=session_id_tls_clt
ephemeral_list = []
secret_request = h_s, h_c, a_s, and a_c

session_id=session_id_cs
ephemeral_method = secret_provided
handshake = ServerHello, {EncryptedExtensions}...,{Finished}.
secret_request = h_c, h_s, a_c, a_s ------->
                                   CHandAndAppSecretResponse
                                     tag
last_message=False
cert_request=True
session_id=session_id_tls_clt
ephemeral_list = []
secret_request = h_s, h_c, a_s, and a_c
certificate_type = finger_print
sig_algo = ed25519
freshness = sha256
ephemeral_method = secret_provided
group = x25519
shared_secret = shared_secret
handshake = hanshake
certificate_type = finger_print
sig_algo = ed25519
                                      CInitCertVerifyResponse
                                        tag.last_exchange=True
signature = sig
session_id = session_id_tls_client
freshness = sha256
ephemeral_method = secret_provided
handshake = ClientHello ... client Finished CertificateRequest
certificate_type = finger_print
session_id = session_id_cs
session_id = session_id_tls_client
handshake = CertificateRequest
certificate_type = finger_print
session_id = session_id_cs
