
Network Working Group                                   Carlos Pignataro
Internet-Draft                                          W. Mark Townsley
Category: Standards Track                                  cisco Systems
Expiration Date: April 2005
                                                            October 2004

                        HDLC Frames over L2TPv3

                  draft-ietf-l2tpext-pwe3-hdlc-04.txt


Status of this Memo

   By submitting this Internet-Draft, I certify that any applicable
   patent or other IPR claims of which I am aware have been disclosed,
   and any of which I become aware will be disclosed, in accordance with
   RFC 3668.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as
   Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress".

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt .

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html .

Copyright Notice

   Copyright (C) The Internet Society (2004). All Rights Reserved.

Abstract

   The Layer 2 Tunneling Protocol, Version 3, (L2TPv3) defines a
   protocol for tunneling a variety of data link protocols over IP
   networks.  This document describes the specifics of how to tunnel
   High-Level Data Link Control (HDLC) frames over L2TPv3.







Pignataro, et al.           Standards Track                     [Page 1]





INTERNET DRAFT          HDLC Frames over L2TPv3             October 2004


   Contents

   Status of this Memo..........................................    1

   1. Introduction..............................................    2
      1.1 Abbreviations.........................................    3

   2. Control Connection Establishment..........................    3

   3. HDLC Link Status Notification and Session Establishment...    3
      3.1 L2TPv3 Session Establishment..........................    3
      3.2 L2TPv3 Session Teardown...............................    5
      3.3 L2TPv3 Session Maintenance............................    5
      3.4 Use of Circuit Status AVP for HDLC....................    6

   4. Encapsulation.............................................    6
      4.1 Data Packet Encapsulation.............................    6
      4.2 Data Packet Sequencing................................    7
      4.3 MTU Considerations....................................    7

   5. Security Considerations...................................    7

   6. IANA Considerations.......................................    7
      6.1 Pseudowire Type.......................................    7
      6.2 Result Code AVP Values................................    8

   7. Acknowledgments...........................................    8

   8. References................................................    8
      8.1 Normative References..................................    8
      8.2 Informative References................................    8

   9. Authors' Addresses........................................    8

Specification of Requirements

   In this document, several words are used to signify the requirements
   of the specification.  These words are often capitalized.  The key
   words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD",
   "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document
   are to be interpreted as described in [RFC2119].


1. Introduction

   [L2TPv3] defines a base protocol for Layer 2 Tunneling over IP
   networks. This document defines the specifics necessary for tunneling
   HDLC Frames over L2TPv3. Such emulated circuits are referred to as



Pignataro, et al.           Standards Track                     [Page 2]





INTERNET DRAFT          HDLC Frames over L2TPv3             October 2004


   HDLC Pseudowires (HDLCPWs).

   Protocol specifics defined in this document for L2TPv3 HDLCPWs
   include those necessary for simple point to point (e.g., between two
   L2TPv3 nodes) frame encapsulation, and simple interface up and
   interface down notifications.

   The reader is expected to be very familiar with the terminology and
   protocol constructs defined in [L2TPv3].

1.1 Abbreviations

   HDLC    High-Level Data Link Control
   HDLCPW  HDLC Pseudo-Wire
   LAC     L2TP Access Concentrator (See [L2TPv3])
   LCCE    L2TP Control Connection Endpoint (See [L2TPv3])
   PW      Pseudo-Wire

2. Control Connection Establishment

   In order to tunnel an HDLC link over IP using L2TPv3, an L2TPv3
   Control Connection MUST first be established as described in
   [L2TPv3]. The L2TPv3 SCCRQ Control Message and corresponding SCCRP
   Control Message MUST include the HDLC PW Type of 0x0006 (See IANA
   Considerations Section), in the Pseudo Wire Capabilities List as
   defined in 5.4.3 of [L2TPv3]. This identifies the control connection
   as able to establish L2TP sessions to support HDLC Pseudo-Wires
   (HDLCPWs).

   An LCCE MUST be able to uniquely identify itself in the SCCRQ and
   SCCRP messages via a globally unique value. By default, this is
   advertised via the structured Router ID AVP [L2TPv3], though the
   unstructured Hostname AVP [L2TPv3] MAY be used to identify LCCEs as
   well.

3. HDLC Link Status Notification and Session Establishment

   This section specifies how the status of an HDLC interface is
   reported between two LCCEs, and the associated L2TP session creation
   and deletion that occurs.

3.1 L2TPv3 Session Establishment

   Associating an HDLC serial interface with a PW and its transition to
   "Ready" or "Up" results in the establishment of an L2TP session via
   the standard three-way handshake described in Section 3.4.1 of
   [L2TPv3]. For purposes of this discussion, the action of locally
   associating an interface running HDLC with a PW by local



Pignataro, et al.           Standards Track                     [Page 3]





INTERNET DRAFT          HDLC Frames over L2TPv3             October 2004


   configuration or otherwise is referred to as "provisioning" the HDLC
   interface. The transition of the interface to "ready" or "up" will be
   referred to as the interface becoming ACTIVE. The transition of the
   interface to "not-ready" or "down" will be referred to as the
   interfacing becoming INACTIVE.

   An LCCE MAY initiate the session immediately upon association with an
   HDLC interface, or wait until the interface becomes ACTIVE before
   attempting to establish an L2TP session. Waiting until the interface
   transitions to ACTIVE may be preferred as it delays allocation of
   resources until absolutely necessary.

   The Pseudowire Type AVP defined in Section 5.4.4 of [L2TPv3],
   Attribute Type 68, MUST be present in the ICRQ messages and MUST
   include the HDLC PW Type of 0x0006 for HDLCPWs.

   The Circuit Status AVP (see Section 3.4) MUST be present in the ICRQ,
   ICRP messages and MAY be present in the SLI message for HDLCPWs.

   Following is an example of the L2TP messages exchanged for an HDLCPW
   which is initiated after an HDLC interface is provisioned and becomes
   ACTIVE.

         LCCE (LAC) A                     LCCE (LAC) B
      ------------------               ------------------
      HDLC Interface Provisioned
                                       HDLC Interface Provisioned
      HDLC Interface ACTIVE

                   ICRQ (status = 0x03) ---->

                                       HDLC Interface ACTIVE

                   <---- ICRP (status = 0x03)

      L2TP session established,
      OK to send data into tunnel

                   ICCN ----->
                                    L2TP session established,
                                    OK to send data into tunnel

   In the example above, an ICRQ is sent after the interface is
   provisioned and becomes ACTIVE. The Circuit Status AVP indicates that
   this link is ACTIVE and New (0x03). The Remote End ID AVP [L2TPv3]
   MUST be present in the ICRQ in order to identify the HDLC link
   (together with the identity of the LCCE itself as defined in Section
   2) to associate the L2TP session with. The Remote End ID AVP defined



Pignataro, et al.           Standards Track                     [Page 4]





INTERNET DRAFT          HDLC Frames over L2TPv3             October 2004


   in [L2TPv3] is of opaque form and variable length, though one MUST at
   a minimum support use of an unstructured four-octet value that is
   known to both LCCEs (either by direct configuration, or some other
   means). The exact method of how this value is configured, retrieved,
   discovered, or otherwise determined at each LCCE is outside the scope
   of this document.

   As with the ICRQ, the ICRP is sent only after the associated HDLC
   interface transitions to ACTIVE as well. If LCCE B had not been
   provisioned for the interface identified in the ICRQ, a CDN would
   have been immediately returned indicating that the associated link
   was not provisioned or available at this LCCE.  LCCE A should then
   exhibit a periodic retry mechanism. The period and maximum number of
   retries MUST be configurable.

   An Implementation MAY send an ICRQ or ICRP before an HDLC interface
   is ACTIVE, as long as the Circuit Status AVP reflects that the link
   is INACTIVE and an SLI is sent when the HDLC interface becomes ACTIVE
   (see Section 3.3).

   The ICCN is the final stage in the session establishment, confirming
   the receipt of the ICRP with acceptable parameters to allow
   bidirectional traffic.

3.2 L2TPv3 Session Teardown

   In the event a link is removed (unprovisioned) at either LCCE, the
   associated L2TP session MUST be torn down via the CDN message defined
   in Section 3.4.3 of [L2TPv3].

   General Result Codes regarding L2TP session establishment are defined
   in [L2TPv3]. Additional HDLC result codes are defined as follows:

      RC-TBD-1 - HDLC Link was deleted permanently (no longer
                 provisioned)
      RC-TBD-2 - HDLC Link has been INACTIVE for an extended period of
                 time

3.3 L2TPv3 Session Maintenance

   HDLC PW over L2TP makes use of the Set Link Info (SLI) control
   message defined in [L2TPv3] to signal HDLC link status notifications
   between PEs.  The SLI message is a single message that is sent over
   the L2TP control channel, signaling the interface state change.

   The SLI message MUST be sent any time there is a status change of any
   values identified in the Circuit Status AVP. The only exception to
   this are the initial ICRQ, ICRP and CDN messages which establish and



Pignataro, et al.           Standards Track                     [Page 5]





INTERNET DRAFT          HDLC Frames over L2TPv3             October 2004


   teardown the L2TP session itself.  The SLI message may be sent from
   either PE at any time after the first ICRQ is sent (and perhaps
   before an ICRP is received, requiring the peer to perform a reverse
   Session ID lookup).

   All sessions established by a given control connection utilize the
   L2TP Hello facility defined in Section 4.4 of [L2TPv3] for session
   keepalive. This gives all sessions basic dead peer and path detection
   between PEs.

3.4 Use of Circuit Status AVP for HDLC

   HDLC reports Circuit Status with the Circuit Status AVP defined in
   [L2TPv3], Attribute Type 71. For reference, this AVP is shown below:

    0                   1
    0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
   |           Reserved        |N|A|
   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

   The Value is a 16 bit mask with the two least significant bits
   defined and the remaining bits reserved for future use. Reserved bits
   MUST be set to 0 when sending, and ignored upon receipt.

   The N (New) bit SHOULD be set to one (1) if the Circuit Status
   indication is for a new HDLC circuit, zero (0) otherwise.

   The A (Active) bit indicates whether the HDLC interface is ACTIVE (1)
   or INACTIVE (0).

4. Encapsulation

4.1 Data Packet Encapsulation

   HDLC PWs use the default encapsulations defined in [L2TPv3] for
   demultiplexing, sequencing, and flags. The HDLC PW Type over L2TP is
   intended to operate in an "interface to interface" or "port to port"
   fashion, passing all HDLC data and control PDUs over the PW. The HDLC
   PDU is stripped of flags and trailing FCS, bit/byte unstuffing is
   performed, and the remaining data, including the address, control and
   protocol fields, transported over the PW.

   Since all packets are passed in a largely transparent manner over the
   HDLC PW, any protocol which has HDLC-like framing may utilize the
   HDLC PW mode, including PPP, Frame-Relay, X.25, etc. Exceptions
   include cases where direct access to the HDLC interface is required,
   or modes which operate on the flags, FCS, or bit/byte unstuffing that



Pignataro, et al.           Standards Track                     [Page 6]





INTERNET DRAFT          HDLC Frames over L2TPv3             October 2004


   is performed before sending the HDLC PDU over the PW. An example of
   this is PPP ACCM negotiation.

4.2 Data Packet Sequencing

   Data Packet Sequencing MAY be enabled for HDLC PWs. The sequencing
   mechanisms described in Section 4.6.1 of [L2TPv3] MUST be used for
   signaling sequencing support. HDLC PW over L2TP MUST request the
   presence of the L2TPv3 Default L2-Specific Sublayer defined in
   Section 4.6 of [L2TPv3] when sequencing is enabled, and MAY request
   its presence at all times.

4.3 MTU Considerations

   With L2TPv3 as the tunneling protocol, the packet resulted from the
   encapsulation is N bytes longer than HDLC frame without the flags or
   FCS. The value of N depends on the following fields:

      L2TP Session Header:
         Flags, Ver, Res - 4 octets (L2TPv3 over UDP only)
         Session ID      - 4 octets
         Cookie Size     - 0, 4 or 8 octets
      L2-Specific Sublayer - 0 or 4 octets (i.e., using sequencing)

   Hence the range for N in octets is:

      N = 4-16,  L2TPv3 data messages are over IP;
      N = 16-28, L2TPv3 data messages are over UDP;
      (N does not include the IP header).

   The MTU and fragmentation implications resulting from this are
   discussed in Section 4.1.4 of [L2TPv3].

5. Security Considerations

   HDLC over L2TPv3 is subject to the security considerations defined in
   [L2TPv3]. There are no additional considerations specific to carrying
   HDLC that are not present carrying other data link types.

6. IANA Considerations

6.1 Pseudowire Type

   The signaling mechanisms defined in this document rely upon the
   allocation of an HDLC Pseudowire Type (see Pseudo Wire Capabilities
   List as defined in 5.4.3 of [L2TPv3] and L2TPv3 Pseudowire Types in
   10.6 of [L2TPv3]) by the IANA (number space already created as part
   of publication of [L2TPv3]):



Pignataro, et al.           Standards Track                     [Page 7]





INTERNET DRAFT          HDLC Frames over L2TPv3             October 2004


      L2TPv3 Pseudowire Types
      -----------------------

      0x0006 - HDLC Pseudowire Type

6.2 Result Code AVP Values

   Two new L2TP Result Codes for CDN appear in section 3.2 which need
   assignment by IANA as described in section 2.3 of [BCP0068].

      Result Code AVP (Attribute Type 1) Values
      -----------------------------------------

      RC-TBD-1 - HDLC Link was deleted permanently (no longer
                 provisioned)
      RC-TBD-2 - HDLC Link has been INACTIVE for an extended period of
                 time

7. Acknowledgments

   Thanks to Sudhir Rustogi and George Wilkie for valuable input.  Maria
   Alice Dos Santos provided helpful review and comment.

8. References

8.1 Normative References

      [L2TPv3]   J. Lau, M. Townsley, I. Goyret, "Layer Two Tunneling
                 Protocol (Version 3)", work in progress,
                 draft-ietf-l2tpext-l2tp-base-14.txt, June 2004.

      [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
                 Requirement Levels", BCP 14, RFC 2119, March 1997.

8.2 Informative References

      [BCP0068] Townsley, W., Layer Two Tunneling Protocol (L2TP)
                Internet Assigned Numbers Authority (IANA)
                Considerations Update", RFC3438, BCP0068, December 2002


9. Authors' Addresses

   Carlos Pignataro
   cisco Systems
   7025 Kit Creek Road
   PO Box 14987
   Research Triangle Park, NC 27709



Pignataro, et al.           Standards Track                     [Page 8]





INTERNET DRAFT          HDLC Frames over L2TPv3             October 2004


   cpignata@cisco.com

   W. Mark Townsley
   cisco Systems
   7025 Kit Creek Road
   PO Box 14987
   Research Triangle Park, NC 27709
   mark@townsley.net


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.

Disclaimer of Validity

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.

Copyright Statement

   Copyright (C) The Internet Society (2004). This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and



Pignataro, et al.           Standards Track                     [Page 9]





INTERNET DRAFT          HDLC Frames over L2TPv3             October 2004


   except as set forth therein, the authors retain all their rights.

Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.













































Pignataro, et al.           Standards Track                    [Page 10]

