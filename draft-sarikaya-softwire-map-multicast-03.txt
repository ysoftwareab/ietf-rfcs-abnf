



Network Working Group                                        B. Sarikaya
Internet-Draft                                                Huawei USA
Intended status: Standards Track                                   H. Ji
Expires: April 2, 2015                                     China Telecom
                                                      September 29, 2014


  Multicast Support for Mapping of Address and Port Protocol and Light
                             Weight 4over6
                draft-sarikaya-softwire-map-multicast-03

Abstract

   This memo specifies multicast component for MAP-E and Light Weight
   4over6 so that IPv4 hosts can receive multicast data from IPv4
   servers over an IPv6 network.  Two types of solutions are developed,
   encapsulation and translation.  In the encapsulation solution for
   MAP-E and lw4o6, IGMP Proxy at the MAP-E Customer Edge router/lwB4
   uses IPv4-in-IPv6 tunnel to exchange IGMP messages to establish
   multicast state at MAP-E Border Relay/lwAFTR so that MAP-E Border
   Relay/lwAFTR can tunnel IPv4 multicast data to IPv4 hosts.  In the
   Translation Multicast solution for MAP-T, 4rd and lw4o6, IGMP
   messages are translated into MLD messages and sent to the network in
   IPv6.  MAP-T/4rd Border Relay/lwAFTR does the reverse translation and
   joins IPv4 multicast group for the hosts.  Border Relay/lwAFTR as
   multicast router receives IPv4 multicast data and translates the
   packet into IPv6 multicast data and sends downstream on the multicast
   tree.  Member CEs/lwB4s receive multicast data, translate it back to
   IPv4 and transmit to the hosts.

Status of This Memo

   This Internet-Draft is submitted in full conformance with the
   provisions of BCP 78 and BCP 79.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF).  Note that other groups may also distribute
   working documents as Internet-Drafts.  The list of current Internet-
   Drafts is at http://datatracker.ietf.org/drafts/current/.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   This Internet-Draft will expire on April 2, 2015.





Sarikaya & Ji             Expires April 2, 2015                 [Page 1]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


Copyright Notice

   Copyright (c) 2014 IETF Trust and the persons identified as the
   document authors.  All rights reserved.

   This document is subject to BCP 78 and the IETF Trust's Legal
   Provisions Relating to IETF Documents
   (http://trustee.ietf.org/license-info) in effect on the date of
   publication of this document.  Please review these documents
   carefully, as they describe your rights and restrictions with respect
   to this document.  Code Components extracted from this document must
   include Simplified BSD License text as described in Section 4.e of
   the Trust Legal Provisions and are provided without warranty as
   described in the Simplified BSD License.

Table of Contents

   1.  Introduction  . . . . . . . . . . . . . . . . . . . . . . . .   3
   2.  Terminology . . . . . . . . . . . . . . . . . . . . . . . . .   4
   3.  Architecture  . . . . . . . . . . . . . . . . . . . . . . . .   4
     3.1.  Encapsulation Multicast Architecture  . . . . . . . . . .   5
     3.2.  MAP-T and 4rd Translation Architecture  . . . . . . . . .   7
   4.  MAP-E Encapsulation Multicast Operation . . . . . . . . . . .   9
     4.1.  Encapsulation Interface Considerations  . . . . . . . . .  11
     4.2.  Avalanche Problem Considerations  . . . . . . . . . . . .  12
   5.  lw4over6 Encapsulation Multicast Operation  . . . . . . . . .  12
     5.1.  Tunnel Interface Considerations . . . . . . . . . . . . .  14
     5.2.  Dealing with Avalanche Problem  . . . . . . . . . . . . .  15
     5.3.  Multicast Support for Host-Based Architecture . . . . . .  15
   6.  MAP-T and 4rd Translation Multicast Operation . . . . . . . .  15
     6.1.  Address Translation . . . . . . . . . . . . . . . . . . .  16
     6.2.  Protocol Translation  . . . . . . . . . . . . . . . . . .  17
     6.3.  Learning Multicast  Prefixes for IPv4-embedded IPv6
           Multicast Addresses . . . . . . . . . . . . . . . . . . .  18
     6.4.  Supporting IPv4 Multicast at CE Router and lwB4 . . . . .  19
   7.  Security Considerations . . . . . . . . . . . . . . . . . . .  20
   8.  IANA Considerations . . . . . . . . . . . . . . . . . . . . .  20
   9.  Acknowledgements  . . . . . . . . . . . . . . . . . . . . . .  20
   10. References  . . . . . . . . . . . . . . . . . . . . . . . . .  20
     10.1.  Normative References . . . . . . . . . . . . . . . . . .  20
     10.2.  Informative references . . . . . . . . . . . . . . . . .  23
   Appendix A.  Group Membership Message Translation Details . . . .  23
   Authors' Addresses  . . . . . . . . . . . . . . . . . . . . . . .  24








Sarikaya & Ji             Expires April 2, 2015                 [Page 2]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


1.  Introduction

   With IPv4 address depletion on the horizon, many techniques are being
   standardized for IPv6 migration including Mapping of Address and Port
   (MAP) - Encapsulation, - Translation and 4rd [I-D.ietf-softwire-map],
   [I-D.ietf-softwire-map-t], [I-D.ietf-softwire-4rd].  MAP/4rd enables
   IPv4 hosts to communicate with external hosts using IPv6 only ISP
   network.  MAP/4rd Customer Edge (CE) device's LAN side is dual stack
   and WAN side is IPv6 only.  CE tunnels/translates IPv4 packets
   received from the LAN side to 4rd Border Relays (BR).  BRs have
   anycast IPv6 addresses and receive encapsulated/translated packets
   from CEs over a virtual interface.  MAP/4rd operation is stateless.
   Packets are received/ sent independent of each other and no state
   needs to be maintained except for NAT44 operation on IPv4 packets
   received from the user.

   Light Weight 4 Over 6 (lw4o6) is a variant of Dual Stack Lite where
   carrier grade NAT is moved from AFTR to B4 element, i.e.  NAPT is
   done locally at each B4 called light weight B4 or lwB4.  Unicast
   lw4o6 takes user IPv4 packets from the local LAN and lwB4 does a NAPT
   and then tunnels the packets in an IPv4-in-IPv6 tunnel to lwAFTR
   which decapsulates the packet and then sends it to IPv4 network.
   Incoming packets follow reverse route and are encapsulated at lwAFTR
   and sent to lwB4 which decapsulates and after NAPT operation
   transmits to the destination.

   It should be noted that there is no depletion problem for IPv4
   address space allocated for any source multicast and source specific
   multicast [RFC3171].  This document is not motivated by the depletion
   of IPv4 multicast addresses.

   MAP-E, MAP-T, 4rd and lw4o6 are unicast only.  They do not support
   multicast.  In this document we specify how multicast from home IPv4
   users can be supported in MAP-E (as well as MAP-T and 4rd) and lw4o6.

   In case of MAP-E and lw4o6 tunneling multicast solution we integrate
   the multicast solution into the MAP-E/lw4o6 tunnel resulting in a
   multicast tunneling protocol.  Multicast tunneling protocol has the
   advantage of not requiring multicast enabled IPv6 network between CE
   routers/lwB4s and MAP-E BRs/lwAFTRs.  Similar tunneling is used in
   mobility protocols like Mobile IP [RFC6275] and Proxy Mobile IP
   [RFC6224].

   In case IPv6 network is multicast enabled, MAP-T/4rd can provide
   multicast service to the hosts using MAP-T/4rd Multicast Translation
   based solution.  A Multicast Translator can be used that receives
   IPv4 multicast group management messages in IGMP and generates
   corresponding IPv6 group management messages in MLD and sends them to



Sarikaya & Ji             Expires April 2, 2015                 [Page 3]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   IPv6 network towards MAP-T/4rd Border Relay.  We use
   [I-D.ietf-softwire-map-t] or [I-D.ietf-softwire-4rd] for sending IPv4
   multicast data in IPv6 to the CE routers.  At MAP-T/4rd CE router
   another translator is needed to translate IPv6 multicast data into
   IPv4 multicast data.

   It should be noted that if IPv6 network is multicast enabled the
   translation multicast solution presented in Section 6 can also be
   used for MAP-E.

   In this document we address MAP-E (and MAP-T/4rd) and lw4o6 multicast
   problem and propose two architectures: Multicast Tunneling and
   Multicast Translation based solutions.  Section 2 is on terminology,
   Section 3 is on architecture, Section 4 and Section 5 are on
   multicast tunneling protocol Section 6 is on multicast translation
   protocol, and Section 7 states security considerations.

2.  Terminology

   This document uses the terminology defined in
   [I-D.ietf-softwire-map], [I-D.ietf-softwire-lw4over6],
   [I-D.ietf-softwire-map-t], [I-D.ietf-softwire-4rd], [RFC3810] and
   [RFC3376].

3.  Architecture

   In MAP-E, MAP-T and 4rd, there are hosts (possibly IPv4/ IPv6 dual
   stack) served by MAP-E, MAP-T and 4rd Customer Edge device.  CE is
   dual stack facing the hosts and IPv6 only facing the network or WAN
   side.  MAP-E, MAP-T and 4rd CE may be local IPv4 Network Address and
   Port Translation (NAPT) box [RFC3022] by assigning private IPv4
   addresses to the hosts.  MAP-E, MAP-T and 4rd CEs in the same domain
   may use shared public IPv4 addresses on their WAN side and if they do
   they should avoid ports outside of the allocated port set for NAPT
   operation.  At the boundary of the network there is MAP-E, MAP-T and
   4rd Border Relay.  BR receives IPv4 packets tunneled in IPv6 from CE
   and decapsulates them and sends them out to IPv4 network.

   Unicast MAP-E, MAP-T and 4rd are stateless except for the local NAPT
   at the CE.  Each IPv4 packet sent by CE treated separately and
   different packets from the same CE may go to different BRs or CEs.
   CE encapsulates IPv4 packet in IPv6 with destination address set to
   BR address (usually anycast IPv6 address).  BR receives the
   encapsulated packet and decapsulates and send it to IPv4 network.
   CEs are configured with Rule IPv4 Prefixes, Rule IPv6 Prefixes and
   with an BR IPv6 anycast address.  BR receives IPv4 packets addressed
   to this ISP and from the destination address it extracts the
   destination host's IPv4 address and uses this address as destination



Sarikaya & Ji             Expires April 2, 2015                 [Page 4]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   address and encapsulates the IPv4 packet in IPv6 and sends it to
   IPv6-only network.

   Unicast Lightweight 4over6 (lw4o6) is a variation of Dual-Stack Lite
   (DS-Lite) [RFC6333] which moves carrier-grade IPv4-IPv4 NAT from the
   Address Family Transition Router (AFTR) element to the Basic Bridging
   BroadBand (B4) element [I-D.ietf-softwire-lw4over6].  The resulting
   elements are called lwAFTR and lwB4 with NAPT, respectively.  Lw4o6
   also adopts some features from MAP-E.  A+P scheme of public IPv4
   address sharing is used by lwB4's in assigning WAN side IPv4 public
   addresses with a distinct port set.  As in MAP-E, encapsulation of
   IPv4 packets in IPv6 and decapsulation is according to [RFC2473].

3.1.  Encapsulation Multicast Architecture

   Encapsulation variant of MAP called MAP-E network lends itself easily
   to the Multicast Tunneling architecture.  Dual stack hosts are
   connected to the Customer Edge router and it is multicast enabled.
   It is assumed that IPv6 only network is unicast only network and that
   IPv6 multicast is not enabled or IPv6 multicast is partially enabled,
   e.g. the access network is not enabled for IPv6 multicast.  At the
   boundary of the network MAP-E Border Relay is connected to the native
   multicast backbone infrastructure.

   We place IGMP Proxy at the CE router.  CE router serves all the
   connected hosts.  For multicast traffic, CE Router uses MAP-E
   tunneling interface with MAP-E BR to send/receive IGMP messages using
   IPv4-in-IPv6 tunnel [RFC2473].

   MAP-E BR is IGMP Router towards the CEs and it could be IGMP Router
   or PIM router upstream.  A given relay and all CEs connected to it
   can be considered to be on a separate logical link.  On this link,
   gateways and relay communicate using IPv4-in-IPv6 tunneling to
   transmit and receive multicast control messages for membership
   management and multicast data from the relay to the gateways.

   All the elements of MAP-E multicast support system with tunneling are
   shown in Figure 1.













Sarikaya & Ji             Expires April 2, 2015                 [Page 5]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


        Dual Stack Hosts                                               IPv4
               +----+                                                 Network
               | H1 |                   IPv6
               +----+      +-------+    only       +--------------+      +
               +----+      |  CE   |    network    |      BR      |
               | H2 |   ---| IGMP  |---         -- |IGMP  | IGMP  |     IPv6
               +----+      | Proxy |               |Router|  PIM  |    Network
               +----+      +-------+               +--------------+
               | H3 |
               +----+



            Figure 1: Architecture of MAP-E Multicast Tunneling

   For lw4o6 multicast support with tunneling, the architecture shown in
   Figure 2 will be used.

   lwB4 is IGMP Proxy serving multicast receivers in IPv4 LAN.  As such,
   lw4o6 B4 supporting multicast MUST conform IGMP Proxying protocol
   described in [RFC4605].  lwB4 uses lw4o6 tunneling interface with
   lwAFTR to send/receive IGMP messages using IPv4-in-IPv6 tunnel
   [RFC2473].  Due to the presence of NAPT at the lw4o6, lwB4 MUST
   conform to IP multicast requirements stated in [RFC5135].

   lwAFTR is IGMP Router towards the l4B4s and it could be IGMP Router
   or PIM router upstream.  A given relay and all lwB4s connected to it
   can be considered to be on a separate logical link.  On this link,
   lwB4 and lwAFTR communicate using IPv4-in-IPv6 tunneling to transmit
   and receive multicast control messages for membership management and
   multicast data from lwAFTR to the lwB4s.

                                                                  IPv4
      +-------+ IPv4                                             Network
      |       |Multicast
      |       |      +-------+               +--------------+      +
      |       |      |  lwB4 | IPv4-in-IPv6  |   lwAFTR     |
      |  IPv4 |----->| IGMP  |-------------->|IGMP  | IGMP  |     IPv6
      |  LAN  |<-----| Proxy |<--------------|Router|  PIM  |    Network
      |       |      +-------+               +--------------+
      |       |
      +-------+



            Figure 2: Architecture of lw4o6 Multicast Tunneling





Sarikaya & Ji             Expires April 2, 2015                 [Page 6]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


3.2.  MAP-T and 4rd Translation Architecture

   In case IPv6 only network is multicast enabled, translation multicast
   architecture can be used.  CE implements IGMP Proxy function
   [RFC4605] towards the LAN side and MLD Proxy on its WAN interface.
   IPv4 hosts send their join requests (IGMP Membership Report messages)
   to CE.  CE as a MLD proxy sends aggregated MLD Report messages
   upstream towards BR.  CE replies MLD membership query messages with
   MLD membership report messages based on IGMP membership state in the
   IGMP/MLD proxy.

   BR is MLD querier on its WAN side.  On its interface to IPv4 network
   BR may either have IGMP client or PIM.  PIM being able to support
   both IPv4 and IPv6 multicast should be preferred.  BR receives MLD
   join requests, extracts IPv4 multicast group address and then joins
   the group upstream, possibly by issuing a PIM join message.

   IPv4 multicast data received by the BR as a leaf node in IPv4
   multicast distribution tree is translated into IPv6 multicast data by
   the translator using [I-D.ietf-softwire-map-t],
   [I-D.ietf-softwire-4rd] and then sent downstream to the IPv6 part of
   the multicast tree to all downstream routers that are members.  IPv6
   data packet eventually gets to the CE.  At the CE, a reverse
   [I-D.ietf-softwire-map-t], [I-D.ietf-softwire-4rd] operation takes
   place by the translator and then IPv4 multicast data packet is sent
   to the member hosts on the LAN interface.  [I-D.ietf-softwire-map-t],
   [I-D.ietf-softwire-4rd] are modified to handle multicast addresses.

   In order to support SSM, IGMPv3 MUST be supported by the host, CE and
   BR.  For ASM, BR MUST be the Rendezvous Point (RP).

   MAP-T and 4rd Translation Multicast solution uses the multicast 46
   translator in not one but two places in the architecture: at the CE
   router and at the Border Relay.  IPv4 multicast data received at 4rd
   BR goes through a [I-D.ietf-softwire-4rd] header-mapping into IPv6
   multicast data at the BR and another [I-D.ietf-softwire-4rd] header-
   mapping back to IPv4 multicast data at the CE router.  Encapsulation
   variant of [I-D.ietf-softwire-4rd] is not used.  In case of MAP-T,
   IPv4 data packet is translated using v4 to v6 header translation
   using multicast addresses instead of the mapping algorithm used in
   [I-D.ietf-softwire-map-t].

   All the elements of MAP-T and 4rd translation-based multicast support
   system are shown in Figure 3.







Sarikaya & Ji             Expires April 2, 2015                 [Page 7]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


  Dual Stack Hosts                                                 IPv4
   +----+                                                        Network
   | H1 |      +----------+          IPv6       +-------------+
   |    |      |    CE    |                     |     BR      |
   +----+      |Translator|          only       | Translator  |
               |MAP-T/4rd |                     |  MAP-T/4rd  |
   +----+      |          |          network    |        |IGMP|     +
   | H2 |   ---|IGMP-MLD  |---------         -- |MLD     | or |    IPv6
   +----+      |    Proxy |                     |Querier |PIM |   Network
   +----+      +----------+                     +-------------+
   | H3 |
   +----+

       Figure 3: Architecture of MAP-T and 4rd Translation Multicast

   In case IPv6 only network is multicast enabled, translation multicast
   architecture can also be used for lw4o6 multicast. lwB4 implements
   IGMP Proxy function [RFC4605] towards the LAN side and MLD Proxy on
   its WAN interface.  IPv4 hosts send their join requests (IGMP
   Membership Report messages) to lwB4.  lwB4 as a MLD proxy sends
   aggregated MLD Report messages upstream towards lwAFTR.  lwB4 replies
   MLD membership query messages with MLD membership report messages
   based on IGMP membership state in the IGMP/MLD proxy.

   lwAFTR is MLD querier on its WAN side.  On its interface to IPv4
   network lwAFTR may either have IGMP client or PIM.  PIM being able to
   support both IPv4 and IPv6 multicast should be preferred. lwAFTR
   receives MLD join requests, extracts IPv4 multicast group address and
   then joins the group upstream, possibly by issuing a PIM join
   message.

   For multicast data, [I-D.ietf-softwire-dslite-multicast] uses
   encapsulation of IPv4 multicast data in IPv6 multicast data packet
   but in this document we use translation.  IPv4 multicast data
   received by the lwAFTR as a leaf node in IPv4 multicast distribution
   tree is translated into IPv6 multicast data by the translator and
   then sent downstream to the IPv6 part of the multicast tree to all
   downstream routers that are members.  IPv6 data packet eventually
   gets to the lwB4.  At the lwB4, a reverse translation operation takes
   place by the translator and then IPv4 multicast data packet is sent
   to the member hosts on the LAN interface.  The translation algorithm
   in [I-D.ietf-softwire-map-t], [I-D.ietf-softwire-4rd] are modified to
   handle multicast addresses.

   In order to support SSM, IGMPv3 MUST be supported by the host, lwB4
   and lwAFTR.  For ASM, lwAFTR MUST be the Rendezvous Point (RP).





Sarikaya & Ji             Expires April 2, 2015                 [Page 8]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   MAP-T and 4rd Translation Multicast solution uses the multicast 46
   translator in not one but two places in the architecture: at the lwB4
   router and at the lwAFTR.  IPv4 data packet is translated using v4 to
   v6 header translation using multicast addresses instead of the
   mapping algorithm used in [I-D.ietf-softwire-map-t].

   All the elements of lw4o6 translation-based multicast support system
   are shown in Figure 4.

                                                                  IPv4
      +-------+ IPv4                                             Network
      |       |Multicast
      |       |      +--------------+      +--------------+      +
      |       |      |  lwB4   NAPT |IPv6  |   lwAFTR     |
      |  IPv4 |----->| IGMP    MLD  |----->|IGMP  | IGMP  |     IPv6
      |  LAN  |<-----| Proxy  Proxy |------|Router|  PIM  |    Network
      |       |      +--------------+      +--------------+
      |       |
      +-------+



           Figure 4: Architecture of lw4o6 Multicast Translation

4.  MAP-E Encapsulation Multicast Operation

   When a host (H1, H2 or H3 in Figure 1) wants to join an IPv4
   multicast group G or (S,G), it sends an IGMP report (IGMPv3 report
   for a source-specific group) to CE router.

   CE encapsulates IGMP report messages in IPv6 and sends it over the
   tunnel to BR in anycast.  CE router uses BR's anycast address this CE
   router is configured with.  After CE receives unicast address of BR,
   it sends all subsequent IGMP messages for G or (S,G) in unicast.

   BR (topologically closest to this CE router) receives the message,
   decapsulates it and then lets IGMP router to process it.  On the
   upstream, an IGMP Join message is sent to subscribe group G or (S,G)
   or a PIMv4 Join message is sent if PIM is supported.  BR establishes
   membership state for group G or (S,G).  BR sends all related IGMP
   messages to this CE in unicast using IPv4-in-IPv6 tunneling.

   CE now has BR's unicast address which it uses to send all IGMP
   packets for group G for any source multicast or (S,G) for source
   specific multicast.  If CE receives multiple join messages for the
   same group G, CE sends an aggregated join message to BR.





Sarikaya & Ji             Expires April 2, 2015                 [Page 9]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   If CE receives another join message for a different group G', (S',G')
   CE encapsulates it and sends it in anycast to the BR.  This enables
   the use of multiple BRs that may be deployed as anchor points and
   makes downstream multicast data delivery more efficient.

   A CE is required to assist in IGMP signaling and data forwarding
   between the hosts that it serves and the corresponding BRs that are
   handling the multicast group G or (S,G).  CE must have IGMP Proxy for
   each upstream tunnel interface that has been established with the BR.
   The CE decides on the mapping of downstream links to a proxy instance
   connected to an upstream link to a BR based on the unicast source
   IPv6 address in the packets received from BR.  Because of this BRs
   MUST use the unicast source IPv6 address in packets sent to CEs.
   Encapsulation at the CE is according to [RFC2473] with an IPv4
   payload carrying IGMP messages.

   On the reception of IGMP reports from the hosts, the CE must identify
   the corresponding proxy instance from the incoming interface and
   perform regular IGMP proxy operations of inserting, updating or
   removing multicast forwarding state on the incoming interface and
   will merge state updates into the IGMP proxy membership database.  It
   will then send an aggregated Report via the upstream tunnel to the BR
   when the membership database changes.

   On the reception of IGMP queries, the CE proxy instance will answer
   the Queries on behalf of all active downstream receivers maintained
   in its membership database.  Queries sent by the BR do not force the
   CE to trigger corresponding messages immediately towards hosts.

   BR acts as the default multicast querier for the corresponding CE.
   It implements the function of the designated multicast router or a
   further IGMP proxy.  After BR receives IGMP Join message it adds the
   tunnel to the CE in its outgoing interface list for the group (G) or
   the source, group (S,G) that the host wants to join.  BR establishes
   group-/source-specific multicast forwarding states at its
   corresponding downstream tunnel interfaces.  Afterwards, BR
   maintains/removes these group-/source-specific multicast forwarding
   states.  BR treats its tunnel interfaces as multicast-enabled
   downstream links, serving zero to many listening nodes.  BR will send
   a join message upstream towards the source of the multicast group to
   build a multicast tree in the native multicast infrastructure and
   becomes a leaf node in the multicast tree.

   BR will send any group management messages (IGMP Report or Query
   messages) downstream to specific CEs on the tunnel interface by
   encapsulating these IGMP messages in IPv6 using [RFC2473].





Sarikaya & Ji             Expires April 2, 2015                [Page 10]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   As for multicast data, the data packets from the source received at
   the BR will be replicated to all interfaces in it's outgoing
   interface list as well as the tunnel outgoing interface for all
   member CEs.  BR sends multicast data in IPv4-in-IPv6 tunnel to the CE
   with the data packet encapsulated.  Encapsulation is according to
   [RFC2473] with an IPv4 payload.

   CE receives Multicast Data message over the tunnel interface
   associated with the tunnel to BR.  After decapsulation, multicast
   traffic arriving at the CE on an upstream interface will be forwarded
   according to the group-specific or source-specific forwarding states
   as acquired for each downstream interface within the IGMP proxy
   instance.

4.1.  Encapsulation Interface Considerations

   Legacy IPv4 in IPv6 tunneling is performed as in [RFC2473].  Packets
   upstream from CE carry only IGMP signaling messages and they are not
   expected to be subject to fragmentation.  However packets downstream,
   i.e. multicast data to CE may be subject to fragmentation.

   Source and destination addresses of IGMP messages in IPv4-in-IPv6
   softwire from CE is as follows:

   Source address of IPv6 header is CE IPv6 address, e.g.
   2001:db8:0:1::1, destination address is BR anycast address, possibly
   shared of the MAP domain.

   Source address of IGMP messages is CE's IPv4 interface address, e.g.
   192.0.0.2, destination address is the all-systems multicast address
   of 224.0.0.1 for IGMP Query, all IGMPv3-capable multicast routers of
   224.0.0.22 for IGMPv3 Report, the multicast group specified in the
   Group Address field of the Report for IGMPv1 or IGMPv2 Report.

   Source and destination addresses of IGMP messages in IPv4-in-IPv6
   softwire from BR is as follows:

   Source address of IPv6 header is BR's unicast IPv6 address, e.g.
   2001:db8:0:2::1, destination address is CE IPv6 address, e.g.
   2001:db8:0:1::1.

   Source address of IGMP messages is CE's IPv4 interface address, e.g.
   192.0.2.1, destination address is the all-systems multicast address
   of 224.0.0.1 for IGMP Query, all IGMPv3-capable multicast routers of
   224.0.0.22 for IGMPv3 Report, the multicast group specified in the
   Group Address field of the Report for IGMPv1 or IGMPv2 Report.





Sarikaya & Ji             Expires April 2, 2015                [Page 11]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   Source and destination addresses of multicast data messages in IPv4-
   in-IPv6 softwire is as follows:

   Source address of IPv6 header is BR IPv6 unicast address, e.g.
   2001:db8:0:2::1, destination address is CE IPv6 address, e.g.
   2001:db8:0:1::1.

   Source address of IPv4 multicast data is unicast IPv4 address of the
   multicast source, e.g. the content provider, destination address is
   IPv4 multicast group address.

   BR decapsulates datagrams carrying IGMP messages from CE's and then
   IGMP/PIM router processing takes over.  Network Address Translation
   (NAT) is not applied on IGMP messages.

4.2.  Avalanche Problem Considerations

   In Section 4 BR replicates the data packets from the source received
   to all outgoing interfaces for all member CEs.  This replication
   (often called avalanche problem) can be very costly if there are very
   large number of downstream member CEs such as in IPTV application.
   Note that the avalanche problem is faced by all multicast solutions
   that use tunneling to bypass non-multicast enabled access network.

   In multicast MAP-E, one approach that can be used is to deploy MAP-E
   BRs close to the user.  BRs colocated at the access network gateway
   such as at the Border Network Gateway (BNG) could reduce the packet
   duplication bottleneck considerably.

   In multicast MAP-E, another approach is to exploit multiple BRs that
   can be deployed in the network.  MAP-E CE can use BR anycast address
   when sending an encapsulated upstream IGMP join request and then use
   the unicast source address of this BR in subsequent IGMP messages.

5.  lw4over6 Encapsulation Multicast Operation

   The hosts will send their subscription requests for IPv4 multicast
   groups upstream to the default router, i.e. lwB4 Element.  After
   subscribing to the group, the host can receive multicast data from
   the lwB4.  The host implements IGMP protocol's host part.

   In order to support SSM, IGMPv3 MUST be supported by the host, l4B4
   and lwAFTR.

   lwB4 Element is IGMP Proxy.  After receiving the first IGMP Report
   message requesting subscription to an IPv4 multicast group, lwB4
   establishes a tunnel interface with a lwAFTR.  The tunnel is IPv6
   based but it will carry IPv4 traffic, IGMP messages back and forth



Sarikaya & Ji             Expires April 2, 2015                [Page 12]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   and IPv4 multicast data messages downstream.  lwB4 does not have to
   keep more than one tunnel interfaces, a single interface is
   sufficient.  IGMP Proxy at the lwB4 does not have to have more than
   one proxy instances, a single instance is sufficient.

   lwB4 is regular IGMP proxy and it keeps IGMP proxy membership
   database. lwB4 inserts multicast forwarding state on the incoming
   interface, and merges state updates into the IGMP proxy membership
   database.  lwB4 updates or removes elements from the database as
   required. lwB4 will then send an aggregated Report via the upstream
   tunnel to the lwAFTR when the membership database changes.

   lwB4 answers IGMP queries from lwAFTR based on the membership
   database. lwB4's downstream link follows the traditional multipoint
   channel forwarding and does not pose any specific problems.

   lwB4 receives IPv4 multicast data from the lwAFTR tunneled over the
   tunnel interface. lwB4 decapsulates the packet and then forwards it
   downstream.  Each member host receives the data packet based on Layer
   2 multicast interface.  No packet duplication is necessary.

   lwAFTR acts as the as the default multicast querier for all lwB4s
   that have established an IPv6 tunnel with it.  In order to keep a
   consistent multicast state between a lwB4 and lwAFTR, once a lwB4 is
   connected it will stay connected until the state becomes empty.
   After that point, the lwB4 may continue to use the tunnel for IPv4
   unicast traffic.

   According to aggregated IGMP reports received from a lwB4, lwAFTR
   establishes group/source-specific multicast forwarding states at its
   corresponding downstream tunnel interfaces.  After that, lwAFTR
   maintains or removes the state as required by the aggregated reports
   received from lwB4.

   At the upstream interface, lwAFTR procures for aggregated multicast
   membership maintenance.  Based on the multicast-transparent
   operations of the lwB4s, the lwAFTR treats its tunnel interfaces as
   multicast enabled downstream links, serving zero to many listening
   nodes.

   Multicast traffic arriving at the lwAFTR is transparently forwarded
   according to its multicast forwarding information base.  Multicast
   data is first replicated and then forwarded in IPv4-in-IPv6 tunnel
   from lwAFTR to the corresponding lwB4s.







Sarikaya & Ji             Expires April 2, 2015                [Page 13]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


5.1.  Tunnel Interface Considerations

   Legacy IPv4 in IPv6 tunneling is performed as in [RFC2473] and
   [RFC4213].  Considerations specified in [RFC6333] apply.  Packets
   upstream from lwB4 carry only IGMP signaling messages and they are
   not expected to fragmentation.  However packets downstream, i.e.
   multicast data to B4 may be subject to fragmentation.

   Source and destination addresses of IGMP messages in IPv4-in-IPv6
   softwire from lwB4 is as follows:

   Source address of IPv6 header is lwB4 IPv6 address, e.g.
   2001:db8:0:1::1, destination address is lwAFTR address, e.g.
   2001:db8:0:2::1.

   Source address of IGMP messages is lwB4's IPv4 interface address,
   e.g. 192.0.0.2, destination address is the all-systems multicast
   address of 224.0.0.1 for IGMP Query, all IGMPv3-capable multicast
   routers of 224.0.0.22 for IGMPv3 Report, the multicast group
   specified in the Group Address field of the Report for IGMPv1 or
   IGMPv2 Report.

   Source and destination addresses of IGMP messages in IPv4-in-IPv6
   softwire from lwAFTR is as follows:

   Source address of IPv6 header is lwAFTR address, e.g.
   2001:db8:0:2::1, destination address is B4 IPv6 address, e.g.
   2001:db8:0:1::1.

   Source address of IGMP messages is lwAFTR's IPv4 interface address,
   e.g. 192.0.2.1, destination address is the all-systems multicast
   address of 224.0.0.1 for IGMP Query, all IGMPv3-capable multicast
   routers of 224.0.0.22 for IGMPv3 Report, the multicast group
   specified in the Group Address field of the Report for IGMPv1 or
   IGMPv2 Report.

   Source and destination addresses of multicast data messages in IPv4-
   in-IPv6 softwire is as follows:

   Source address of IPv6 header is lwAFTR address, e.g.
   2001:db8:0:2::1, destination address is lwB4 IPv6 address, e.g.
   2001:db8:0:1::1.

   Source address of IPv4 multicast data is unicast IPv4 address of the
   multicast source, e.g. the content provider, destination address is
   IPv4 multicast group address.





Sarikaya & Ji             Expires April 2, 2015                [Page 14]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   lwAFTR decapsulates datagrams carrying IGMP messages from lwB4's and
   then IGMP router processing takes over.  Network Address Translation
   (NAT) is not applied on IGMP messages.

5.2.  Dealing with Avalanche Problem

   When multicast datagrams are received at the lwAFTR, lwAFTR consults
   its memebership database and duplicates the packets for each member
   lwB4 interface and then these datagrams are forwarded in IPv4-in-IPv6
   softwire downstream.  This may cause an avalanche of downstream
   packets if the number of member lwB4's is high.

   Avalanche problem can be eased by network partitioning. lwAFTR can be
   deployed closer to the users.  For example in broadband networks,
   lwAFTR can be deployed at the Broadband Network Gateway (BNG) nodes.

5.3.  Multicast Support for Host-Based Architecture

   In this section we specify multicast support for Host-Based DS-Lite
   architecture described in [I-D.ietf-softwire-lw4over6].

   The host accesses the service provider network directly with an IPv6
   global address.  Host sends its IPv4 datagrams in IPv6 using an IPv4-
   in-IPv6 softwire tunnel to an lwAFTR, i.e. it implements lwB4.
   Source address of all IPv4 datagrams is the pre-configured well-known
   IPv4 non-routable address.

   For multicast, there are two choices: the host could implement host
   side of IGMP protocol or for mobile router type of hosts, the host
   implements IGMP proxy.

   Host encapsulates IGMP messages and sends them to lwAFTR. lwAFTR does
   not perform IPv4-IPv4 NAT translations on IGMP datagrams instead they
   are processed by IGMP router at the lwAFTR.

   Multicast data received from lwAFTR for a multicast group that the
   host has subscribed is decapsulated by the host, if the host is IGMP
   client, it processes the data.  If the host is IGMP proxy, it
   consults multicast state for the group and forwards the data
   downstream so that the members can receive the data.

6.  MAP-T and 4rd Translation Multicast Operation

   In this section we specify how the host can subscribe and receive
   IPv4 multicast data from IPv4 content providers based on the
   architecture defined in Figure 3 in two parts: address translation
   and protocol translation.  Translation details are given in
   Appendix A.



Sarikaya & Ji             Expires April 2, 2015                [Page 15]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


6.1.  Address Translation

   IPv4-only host, H1 will join IPv4 multicast group by sending IGMP
   Membership Report message upstream towards the IGMP Proxy in
   Figure 3.  MLD Proxy first creates a synthesized IPv6 address of IPv4
   multicast group address using IPv4-embedded IPv6 multicast address
   format [I-D.ietf-mboned-64-multicast-address-format].  ASM_MPREFIX64
   for any source multicast groups and SSM_MPREFIX64 for source specific
   multicast groups are used.  Both are /96 prefixes.

   SSM_MPREFIX64 is set to ff3x:0:8000::/96, with 'x' set to any valid
   scope.  ASM_MPREFIX64 values are formed as shown in Figure 5.  Flag
   field 1 (ff1) field is defined in [RFC7371] bits M bit MUST BE set to
   1. "scop" field is defined in [RFC3956].  Flag field 2 (ff2) is a set
   of 4 flags rrrM where r bits MUST be set to zero.  M bit is set to 1
   to indicate that a multicast IPv4 address is embedded in the low-
   order 32 bits of the multicast IPv6 address. "sub-group-id" field
   MUST follow the recommendations specified in [RFC3306] if unicast-
   based prefix is used or the recommendations specified in [RFC3956] if
   embedded-RP is used.  The default value is all zeros.

     |   8    |  4 |  4 |  4 |             76               |    32    |
     +--------+----+----+----+------------------------------+----------+
     |11111111|ff1 |scop|ff2 |         sub-group-id         |v4 address|
     +--------+----+----+----+-----------------------------------------+

                     Figure 5: ASM_MPREFIX64 Formation

   Each translator in the upstream BR is assigned a unique ASM_MPREFIX64
   prefix.  CE (MLD Proxy in CE) can learn this value by means out of
   scope with this document.  With this, CE can easily create an IPv6
   multicast address from the IPv4 group address a.b.c.d that the host
   wants to join.

   Source-Specific Multicast (SSM) can also be supported similar to the
   Any Source Multicast (ASM) described above.  In case of SSM, IPv4
   multicast addresses use 232.0.0.0/8 prefix.  IPv6 SSM_MPREFIX64 is
   set to FF3x:0:8000::/96 where 'x' is any valid scope.

   Since SSM translation requires a unique address for each IPv4
   multicast source, an IPv6 unicast prefix must be configured to the
   translator in the upstream BR to represent IPv4 sources.  This prefix
   is prepended to IPv4 source addresses in translated packets.

   The join message from the host for the group ASM_MPREFIX64:a.b.c.d or
   SSM_MPREFIX64:a.b.c.d or an aggregate join message will be received
   by MLD querier at the BR.  BR as multicast anchor checks the group
   address and recognizes ASM_MPREFIX64 or SSM_MPREFIX64 prefix.  It



Sarikaya & Ji             Expires April 2, 2015                [Page 16]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   next checks the last 32 bits is an IPv4 multicast address in range
   224/8 - 239/8.  If all checks succeed, IGMPv4 Client joins a.b.c.d
   using IGMP on its IPv4 interface.

   Joining IPv4 groups can also be done using PIM since PIM supports
   both IPv4 and IPv6.  The advantage of using PIM is that there is no
   need to enable IGMP support in neighboring IPv4 routers.  The
   advantage of using IGMP is that IGMP is a simpler protocol and it is
   supported by a wider range of routers.  The use of PIM or IGMP is
   left as an implementation choice.

   Address translation described above for MAP-T applies to lw4over6
   multicast translation where the entities involved are lwB4 replaces
   Customer Edge device and lwAFTR replaces BR Figure 4.

6.2.  Protocol Translation

   The hosts will send their subscription requests for IPv4 multicast
   groups upstream to the default router, i.e.  Costumer Edge device.
   After subscribing the group, the host can receive multicast data from
   the CE.  The host implements IGMP protocol's host part.

   Customer Edge device is IGMP Proxy facing the LAN interface.  After
   receiving the first IGMP Report message requesting subscription to an
   IPv4 multicast group, a.b.c.d, MLD Proxy in the CE's WAN interface
   synthesizes an IPv6 multicast group address corresponding to a.b.c.d
   and sends an MLD Report message upstream to join the group.

   When MAP-T or 4rd BR receives IPv4 multicast data for an IPv4 group
   a.b.c.d it [I-D.ietf-softwire-4rd] translates/encapsulates IPv4
   packet into IPv6 multicast packet and sends it to IPv6 synthesized
   address corresponding to a.b.c.d using ASM_MPREFIX64 or
   SSM_MPREFIX64.  The header mapping described in
   [I-D.ietf-softwire-4rd] Section 4.2 (using Table 1) is used except
   for mapping the source and destination addresses.  In this document
   we use the multicast address translation described in Section 6.1 and
   propose it as a complementary enhancement to the translation
   algorithm in [I-D.ietf-softwire-4rd].

   The IP/ICMP translation translates IPv4 packets into IPv6 using
   minimum MTU size of 1280 bytes (Section 4.3 in
   [I-D.ietf-softwire-4rd]) but this can be changed for multicast.  Path
   MTU discovery for multicast is possible in IPv6 so 4rd BR can perform
   path MTU discovery for each ASM group and use these values instead of
   1280.  For SSM, a different MTU value MUST be kept for each SSM
   channel.  Because of this 8 bytes added by IPv6 fragment header in
   each data packet can be tolerated.




Sarikaya & Ji             Expires April 2, 2015                [Page 17]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   Since multicast address translation does not preserve checksum
   neutrality, [I-D.ietf-softwire-4rd] translator/encapsulator at 4rd BR
   must however modify the UDP checksum to replace the IPv4 addresses
   with the IPv6 source and destination addresses in the pseudo-header
   which consists of source address, destination address, protocol and
   UDP length fields before calculating the new checksum.

   IPv6 multicast data must be translated back to IPv4 at the 4rd CE
   (e.g. using Table 2 in Section 4.3 of [I-D.ietf-softwire-4rd]).  Such
   a task is much simpler than the translation at 4rd BR because IPv6
   header is much simpler than IPv4 header and IPv4 link on the LAN side
   of 4rd CE is a local link.  The packet is sent on the local link to
   IPv4 group address a.b.c.d for IPv6 group address of
   ASM_MPREFIX64:a.b.c.d or SSM_MPREFIX64:a.b.c.d.

   In case an IPv4 multicast source sends multicast data with the don't
   fragment (DF) flag set to 1, [I-D.ietf-softwire-4rd] header mapping
   sets the D bit in IPv6 fragment header before sending the packet
   downstream as in Fig. 3 in Section 4.3 of [I-D.ietf-softwire-4rd].
   This feature of [I-D.ietf-softwire-4rd] preserves the semantics of DF
   flag at the BR and CE.

   Because MAP-T/4rd is stateless, Multicast MAP-T/4rd should stay
   faithful to this as much as possible.  Border Relay acts as the
   default multicast querier for all CEs that have established multicast
   communication with it.  In order to keep a consistent multicast state
   between a CE and BR, CE MUST use the same IPv6 multicast prefixes
   (ASM_MPREFIX64/SSM_REFIX64) until the state becomes empty.  After
   that point, the CE may obtain different values for these prefixes,
   effectively changing to a different 4rd BR.

   Protocol translation described above for MAP-T applies to lw4over6
   multicast translation where the entities involved are lwB4 replaces
   Customer Edge device and lwAFTR replaces BR Figure 4.

6.3.  Learning Multicast Prefixes for IPv4-embedded IPv6 Multicast
      Addresses

   CE can be pre-configured with Multicast Prefix64 of ASM_MPREFIX64 and
   SSM_MPREFIX64 that are supported in their network.  However
   automating this process is also desired.

   A new router advertisement option, a Multicast ASM Translation Prefix
   option, can be defined for this purpose.  The option contains IPv6
   ASM multicast translation prefix, ASM_MPREFIX64.  A new router
   advertisement option, a Multicast SSM Translation Prefix option, can
   be defined for this purpose.  The option contains IPv6 SSM multicast
   prefix translation prefix SSM_MPREFIX64.



Sarikaya & Ji             Expires April 2, 2015                [Page 18]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   After the host gets the multicast prefixes, when an application in
   the host wishes to join an IPv4 multicast group the host MUST use
   ASM_MPREFIX64 or SSM_MPREFIX64 and then obtain the synthesized IPv6
   group address before sending MLD join message.

   Source-specific multicast (SSM) group membership message payloads in
   IGMPv3 and MLDv2 contain address literals and their translation
   requires another multicast translation prefix option.  IPv4 source
   addresses in IGMPv3 Membership Report message are unicast addresses
   of IPv4 sources and they have to be translated into unicast IPv6
   source addresses in MLDv2 Membership Report message.  A new router
   advertisement option, a Multicast Translation Unicast Prefix option
   can be defined for this purpose.  The option contains IPv6 unicast
   Network-Specific Prefix U_PREFIX64.  The host can be configured by
   its default router using router advertisements containing the
   prefixes [I-D.sarikaya-softwire-6man-raoptions]. 64:ff9b::/96 is the
   global value called well-known prefix that is assigned to U_PREFIX64
   [RFC6052].  Organization specific values called Network-Specific
   Prefixes can also be used.  Since multicast is potentially inter-
   domain, the use of well-known prefix for U_PREFIX64 is recommended.
   DHCP servers can also configure hosts with ASM_MPREFIX64,
   SSM_MPREFIX64 and U_PREFIX64 as in
   [I-D.ietf-softwire-multicast-prefix-option].

   Note that U_PREFIX64 is also used in multicast data packet address
   translation.  Source-specific multicast source address in multicast
   data packets coming from SSM sources MUST be translated using
   U_PREFIX64.

6.4.  Supporting IPv4 Multicast at CE Router and lwB4

   When MAP-E CE router is a NAT or NAPT box assigning private IPv4
   addresses to the hosts, IP Multicast requirements for a Network
   Address Translator (NAT) and a Network Address Port Translator (NAPT)
   stated in [RFC5135] apply to IGMP messages and IPv4 multicast data
   packets.  The same applies to lwB4s in lw4over6.

   On receiving multicast data packets, lwB4 or CE router MUST NOT
   modify destination IP address or destination port of the packets.
   Multicast UDP datagrams MUST be forwarded to the local LAN towards
   the host that is a member of this group.

   IGMP membership reports received at lwB4 or CE router may be sent
   upstream individually for any source multicast but for source
   specific multicast, e.g.  IGMPv3, membership reports MUST be sent
   after IGMP aggregation.





Sarikaya & Ji             Expires April 2, 2015                [Page 19]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


7.  Security Considerations

   4rd Encapsulation Multicast control and data message security can be
   provided by the security architecture, mechanisms, and services
   described in [RFC4301], [RFC4302] and [RFC4303].  4rd Translation
   Multicast control and data message security are as described in
   [RFC4607] for source specific multicast.

8.  IANA Considerations

   TBD.

9.  Acknowledgements

   TBD.

10.  References

10.1.  Normative References

   [RFC2119]  Bradner, S., "Key words for use in RFCs to Indicate
              Requirement Levels", BCP 14, RFC 2119, March 1997.

   [RFC2629]  Rose, M., "Writing I-Ds and RFCs using XML", RFC 2629,
              June 1999.

   [RFC1112]  Deering, S., "Host extensions for IP multicasting", STD 5,
              RFC 1112, August 1989.

   [RFC2113]  Katz, D., "IP Router Alert Option", RFC 2113, February
              1997.

   [RFC2711]  Partridge, C. and A. Jackson, "IPv6 Router Alert Option",
              RFC 2711, October 1999.

   [RFC3171]  Albanna, Z., Almeroth, K., Meyer, D., and M. Schipper,
              "IANA Guidelines for IPv4 Multicast Address Assignments",
              RFC 3171, August 2001.

   [RFC4605]  Fenner, B., He, H., Haberman, B., and H. Sandick,
              "Internet Group Management Protocol (IGMP) / Multicast
              Listener Discovery (MLD)-Based Multicast Forwarding
              ("IGMP/MLD Proxying")", RFC 4605, August 2006.

   [RFC4607]  Holbrook, H. and B. Cain, "Source-Specific Multicast for
              IP", RFC 4607, August 2006.





Sarikaya & Ji             Expires April 2, 2015                [Page 20]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   [RFC3307]  Haberman, B., "Allocation Guidelines for IPv6 Multicast
              Addresses", RFC 3307, August 2002.

   [RFC2491]  Armitage, G., Schulter, P., Jork, M., and G. Harter, "IPv6
              over Non-Broadcast Multiple Access (NBMA) networks", RFC
              2491, January 1999.

   [RFC2473]  Conta, A. and S. Deering, "Generic Packet Tunneling in
              IPv6 Specification", RFC 2473, December 1998.

   [RFC2765]  Nordmark, E., "Stateless IP/ICMP Translation Algorithm
              (SIIT)", RFC 2765, February 2000.

   [RFC3022]  Srisuresh, P. and K. Egevang, "Traditional IP Network
              Address Translator (Traditional NAT)", RFC 3022, January
              2001.

   [RFC3810]  Vida, R. and L. Costa, "Multicast Listener Discovery
              Version 2 (MLDv2) for IPv6", RFC 3810, June 2004.

   [RFC3376]  Cain, B., Deering, S., Kouvelas, I., Fenner, B., and A.
              Thyagarajan, "Internet Group Management Protocol, Version
              3", RFC 3376, October 2002.

   [RFC4213]  Nordmark, E. and R. Gilligan, "Basic Transition Mechanisms
              for IPv6 Hosts and Routers", RFC 4213, October 2005.

   [RFC4301]  Kent, S. and K. Seo, "Security Architecture for the
              Internet Protocol", RFC 4301, December 2005.

   [RFC4302]  Kent, S., "IP Authentication Header", RFC 4302, December
              2005.

   [RFC4303]  Kent, S., "IP Encapsulating Security Payload (ESP)", RFC
              4303, December 2005.

   [RFC5135]  Wing, D. and T. Eckert, "IP Multicast Requirements for a
              Network Address Translator (NAT) and a Network Address
              Port Translator (NAPT)", BCP 135, RFC 5135, February 2008.

   [RFC6145]  Li, X., Bao, C., and F. Baker, "IP/ICMP Translation
              Algorithm", RFC 6145, April 2011.

   [RFC6052]  Bao, C., Huitema, C., Bagnulo, M., Boucadair, M., and X.
              Li, "IPv6 Addressing of IPv4/IPv6 Translators", RFC 6052,
              October 2010.





Sarikaya & Ji             Expires April 2, 2015                [Page 21]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   [RFC6224]  Schmidt, T., Waehlisch, M., and S. Krishnan, "Base
              Deployment for Multicast Listener Support in Proxy Mobile
              IPv6 (PMIPv6) Domains", RFC 6224, April 2011.

   [RFC6333]  Durand, A., Droms, R., Woodyatt, J., and Y. Lee, "Dual-
              Stack Lite Broadband Deployments Following IPv4
              Exhaustion", RFC 6333, August 2011.

   [RFC6275]  Perkins, C., Johnson, D., and J. Arkko, "Mobility Support
              in IPv6", RFC 6275, July 2011.

   [RFC7371]  Boucadair, M. and S. Venaas, "Updates to the IPv6
              Multicast Addressing Architecture", RFC 7371, September
              2014.

   [I-D.ietf-softwire-map]
              Troan, O., Dec, W., Li, X., Bao, C., Matsushima, S.,
              Murakami, T., and T. Taylor, "Mapping of Address and Port
              with Encapsulation (MAP)", draft-ietf-softwire-map-10
              (work in progress), January 2014.

   [I-D.ietf-softwire-lw4over6]
              Cui, Y., Qiong, Q., Boucadair, M., Tsou, T., Lee, Y., and
              I. Farrer, "Lightweight 4over6: An Extension to the DS-
              Lite Architecture", draft-ietf-softwire-lw4over6-10 (work
              in progress), June 2014.

   [I-D.ietf-softwire-map-t]
              Li, X., Bao, C., Dec, W., Troan, O., Matsushima, S., and
              T. Murakami, "Mapping of Address and Port using
              Translation (MAP-T)", draft-ietf-softwire-map-t-05 (work
              in progress), February 2014.

   [I-D.ietf-softwire-4rd]
              Despres, R., Jiang, S., Penno, R., Lee, Y., Chen, G., and
              M. Chen, "IPv4 Residual Deployment via IPv6 - a Stateless
              Solution (4rd)", draft-ietf-softwire-4rd-08 (work in
              progress), April 2014.

   [I-D.ietf-mboned-64-multicast-address-format]
              Boucadair, M., Qin, J., Lee, Y., Venaas, S., Li, X., and
              M. Xu, "IPv6 Multicast Address With Embedded IPv4
              Multicast Address", draft-ietf-mboned-64-multicast-
              address-format-06 (work in progress), September 2014.







Sarikaya & Ji             Expires April 2, 2015                [Page 22]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   [I-D.ietf-softwire-multicast-prefix-option]
              Boucadair, M., Qin, J., Tsou, T., and X. Deng, "DHCPv6
              Option for IPv4-Embedded Multicast and Unicast IPv6
              Prefixes", draft-ietf-softwire-multicast-prefix-option-07
              (work in progress), September 2014.

10.2.  Informative references

   [RFC3306]  Haberman, B. and D. Thaler, "Unicast-Prefix-based IPv6
              Multicast Addresses", RFC 3306, August 2002.

   [RFC3956]  Savola, P. and B. Haberman, "Embedding the Rendezvous
              Point (RP) Address in an IPv6 Multicast Address", RFC
              3956, November 2004.

   [RFC4291]  Hinden, R. and S. Deering, "IP Version 6 Addressing
              Architecture", RFC 4291, February 2006.

   [I-D.ietf-softwire-dslite-multicast]
              Qin, J., Boucadair, M., Jacquenet, C., Lee, Y., and Q.
              Wang, "Delivery of IPv4 Multicast Services to IPv4 Clients
              over an IPv6 Multicast Network", draft-ietf-softwire-
              dslite-multicast-08 (work in progress), September 2014.

   [I-D.sarikaya-softwire-6man-raoptions]
              Sarikaya, B., "IPv6 RA Options for Translation Multicast
              Prefixes", draft-sarikaya-softwire-6man-raoptions-01 (work
              in progress), February 2013.

   [I-D.perreault-mboned-igmp-mld-translation]
              Perreault, S. and T. Tsou, "Internet Group Management
              Protocol (IGMP) / Multicast Listener Discovery (MLD)-Based
              Multicast Translation ("IGMP/MLD Translation")", draft-
              perreault-mboned-igmp-mld-translation-01 (work in
              progress), April 2012.

Appendix A.  Group Membership Message Translation Details

   IGMP Report messages (IGMP type number 0x12 and 0x16, in IGMPv1 and
   IGMPv2 and 0x22 in IGMPv3) are translated into MLD Report messages
   (MLDv1 ICMPv6 type number 0x83 and MLDv2 type number 0x8f).  IGMP
   Query message (IGMP type number 0x11) is translated into MLD Query
   message (ICMPv6 type number 0x82)
   [I-D.perreault-mboned-igmp-mld-translation].

   Destination address in ASM, i.e.  IGMPv1, IGMPv2 and MLDv1, is the
   multicast group address so the destination address in IGMP message is




Sarikaya & Ji             Expires April 2, 2015                [Page 23]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   translated into the destination address in MLD message using
   [I-D.ietf-mboned-64-multicast-address-format].

   Destination address in SSM, i.e.  IGMPv3 and MLDv2 is translated as
   follows: it could be all nodes on link, which has the value of
   224.0.0.1 (IGMPv3) and ff02::1 (MLDv2), all routers on link, which
   has the value of 224.0.0.2 (IGMPv3) and ff02::2 (MLDv2), all IGMP/
   MLD-capable routers on link, which has the value of 224.0.0.22
   (IGMPv3) and ff02::16 (MLDv2).

   Source address of MLD message that CE sends is set to link-local IPv6
   address of CE's WAN side interface.  Source address of MLD message
   that BR sends is set to link-local IPv6 address of BR's downstream
   interface.

   Multicast Address or Group Address field in IGMP message payloads is
   translated using [I-D.ietf-mboned-64-multicast-address-format] as
   described above into the corresponding field in MLD message.

   Source Address in IGMPv3 message payloads is translated using
   U_PREFIX64, the IPv6 unicast prefix to be used by SSM source.
   [RFC6052] defines in Section 2.3 the address translation algorithm of
   embedding an IPv4 source address and obtaining an IPv6 source address
   using a network specific prefix like U_PREFIX64.  At the BR on its
   upstream interface or at the CE on its LAN interface, IPv4 addresses
   are extracted from the IPv4-embedded IPv6 addresses.

   Maximum Response Time (MRT) field in IGMPv2 and IGMPv3 queries are
   translated into Maximum Response Delay (MRD) in MLDv1 and MLDv2
   queries, respectively.  In the corresponding MLD message, MRD is set
   to 100 times the value of MRT.  At the BR on its upstream interface
   or at the CE on its LAN interface, MRT value is obtained by dividing
   MRD into 100 and rounding it to the nearest integer.

   IGMP messages are sent with a Router Alert IPv4 option [RFC2113].
   The translated MLD message are sent with a Router Alert option in a
   Hop-By-Hop IPv6 extension header [RFC2711].  In both cases, 2-octet
   value is set to 0.

Authors' Addresses

   Behcet Sarikaya
   Huawei USA
   5340 Legacy Dr. Building 175
   Plano, TX  75024

   Email: sarikaya@ieee.org




Sarikaya & Ji             Expires April 2, 2015                [Page 24]

Internet-Draft  Multicast Support for MAP-E and Lw4over6  September 2014


   Hui Ji
   China Telecom
   NO19.North Street
   Beijing, Chaoyangmen,Dongcheng District
   P.R. China

   Email: jihui@chinatelecom.com.cn












































Sarikaya & Ji             Expires April 2, 2015                [Page 25]
