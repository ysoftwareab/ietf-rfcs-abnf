<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Routing Control Plane Security
    Capabilities</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Routing Control Plane Security
    Capabilities">
<meta name="keywords" content="RFC, Request for Comments, I-D, Internet-Draft, XML, Extensible Markup Language">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">OPSEC Working Group</td><td class="header">Y. Zhao</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">F. Miao</td></tr>
<tr><td class="header">Intended status: BCP</td><td class="header">Huawei Technologies</td></tr>
<tr><td class="header">Expires: December 17, 2007</td><td class="header">R. Callon</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Juniper Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">June 15, 2007</td></tr>
</table></td></tr></table>
<h1><br />Routing Control Plane Security
    Capabilities<br />draft-ietf-opsec-routing-capabilities-03.txt</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 17, 2007.</p>

<h3>Abstract</h3>

<p>The document lists the security capabilities needed for the routing
      control plane of an IP infrastructure to support the practices defined
      in Operational Security Current Practices. In particular this includes
      capabilities for route filtering, for authentication of routing protocol
      packets, and for ensuring resource availability for control
      functions.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">1.1.</a>&nbsp;
Threat model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">1.2.</a>&nbsp;
Format and Definition of Capabilities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">1.3.</a>&nbsp;
Packet Filtering versus Route Filtering<br />
<a href="#anchor5">2.</a>&nbsp;
Route Filtering Capabilities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.1.</a>&nbsp;
General Route Filtering Capabilities<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.1.1.</a>&nbsp;
Ability to Filter Inbound or Outbound Routes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.1.2.</a>&nbsp;
Ability to Filter Routes by Prefix<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.2.</a>&nbsp;
Route Filtering of Exterior Gateway Protocol<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.2.1.</a>&nbsp;
Ability to Filter Routes by Route Attributes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">2.2.2.</a>&nbsp;
Ability to Filter Routing Update by TTL<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">2.2.3.</a>&nbsp;
Ability to Limit the Number of Routes from a Peer<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">2.2.4.</a>&nbsp;
Ability to Limit the Length of Prefixes<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">2.2.5.</a>&nbsp;
Ability to Cooperate in Outbound Route Filtering<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">2.3.</a>&nbsp;
Route Filtering of Interior Gateway Protocols<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">2.3.1.</a>&nbsp;
Route Filtering Within an IGP Area<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">2.3.2.</a>&nbsp;
Route Filtering Between IGP Areas<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">2.4.</a>&nbsp;
Route Filtering during Redistribution<br />
<a href="#anchor19">3.</a>&nbsp;
Route Authentication Capabilities<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">3.1.</a>&nbsp;
Ability to configure an authentication mechanism<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">3.2.</a>&nbsp;
Ability to support authentication key chains<br />
<a href="#anchor22">4.</a>&nbsp;
Ability to Damp Route Flap<br />
<a href="#anchor23">5.</a>&nbsp;
Resource Availability for Router Control Functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">5.1.</a>&nbsp;
Ensure Resources for Management Functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">5.2.</a>&nbsp;
Ensure Resources for Routing Functions<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">5.3.</a>&nbsp;
Limit Resources used by IP Multicast<br />
<a href="#anchor27">6.</a>&nbsp;
Security Considerations<br />
<a href="#anchor28">7.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor29">8.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document is defined in the context of <a class='info' href='#RFC4778'>Operational Security Current Practices in Internet
      Service Provider Environments,<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a> [RFC4778].
</p>
<p>This document lists the security capabilities needed for the routing
      control plane of IP infrastructure to support the practices defined in
      <a class='info' href='#RFC4778'>[RFC4778]<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a>. In particular this
      includes capabilities for route filtering and for authentication of
      routing protocol packets.
</p>
<p>Note that this document lists capabilities that can reasonably be
      expected to be currently deployed in the context of existing standards.
      Extensions to existing protocol standards and development of new
      protocol standards are outside of the scope of this effort. The
      preferred capabilities needed for securing the routing infrastructure
      may evolve over time.
</p>
<p>There will be other capabilities which are needed to fully secure a
      router infrastructure. <a class='info' href='#RFC4778'>[RFC4778]<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a>
      defines the goals, motivation, scope, definitions, intended audience,
      threat model, potential attacks and give justifications for each of the
      practices.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.1"></a><h3>1.1.&nbsp;
Threat model</h3>

<p>The capabilities listed in this document are intended to aid in
        preventing or mitigating the threats outlined in <a class='info' href='#RFC4778'>[RFC4778]<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.2"></a><h3>1.2.&nbsp;
Format and Definition of Capabilities</h3>

<p>Each individual capability will be defined using the four elements,
        "Capability", "Supported Practices", "Current Implementations", and
        "Considerations". The Capability section describes a feature to be
        supported by the device. The Supported Practice section cites
        practices described in [RFC4778] that are supported by this
        capability. The Current Implementation section is intended to give
        examples of implementations of the capability, citing technology and
        standards current at the time of writing. It is expected that the
        choice of features to implement the capabilities will change over
        time. The Considerations section lists operational and resource
        constraints, limitations of current implementations, and
        trade-offs.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1.3"></a><h3>1.3.&nbsp;
Packet Filtering versus Route Filtering</h3>

<p>It is useful to make a distinction between Packet Filtering versus
        Route Filtering.
</p>
<p>The term "packet filter" is used to refer to the filter that a
        router applies to network layer packets passing through or destined to
        it. In general packet filters are based on contents of the network
        (IP) and transport (TCP, UDP) layers, and are mostly stateless, in the
        sense that whether or not a filter applies to a particular packet is a
        function of that packet (including the contents of IP and transport
        layer headers, size of packet, incoming interface, and similar
        characteristics), but does not depend upon the contents of other
        packets which might be part of the same stream (and thus which may
        also be forwarded by the same router). One common minor exception to
        the "stateless" nature of packet filters is that packets that match a
        particular filter may be counted and/or rate limited (the act of
        counting therefore represents a very simple "state" associated with
        the filter).
</p>
<p>Because of the simplicity and stateless nature of packet filters,
        they can typically be implemented with very high performance. It is
        not unusual for them to be implemented on line cards and to perform at
        or near full line rate. For this reason they are very useful to
        counter very high bandwidth attacks, such as large DDoS attacks.
</p>
<p>Packet filtering capabilities are outside of the scope of this
        document. A detailed description of packet filtering capabilities can
        be found in <a class='info' href='#I-D.ietf-opsec-filter-caps'>[I&#8209;D.ietf&#8209;opsec&#8209;filter&#8209;caps]<span> (</span><span class='info'>Morrow, C., &ldquo;Filtering and Rate Limiting Capabilities for IP Network Infrastructure,&rdquo; July&nbsp;2007.</span><span>)</span></a>.
</p>
<p>The Term "route filter" is used to refer to filters that routers
        apply to the content of routing protocol packets that they are either
        sending or receiving. Typically these therefore occur at the
        application layer (although which route filters are applied to a
        particular packet may be a function of network layer information, such
        as what interface the packet is received on, or the source address for
        the packet -- indicating the system that transmitted the packet).
</p>
<p>Route filters are typically implemented in some sort of processor.
        In many cases the total bandwidth which can be received by the
        processor is considerably less than the sum of the rate that packets
        may be received on all interfaces to a router. Therefore in general
        route filters cannot handle the same bandwidth as packet filters.
        Route filters are however very useful in that they can be applied to
        the contents of routing packets.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Route Filtering Capabilities</h3>

<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
General Route Filtering Capabilities</h3>

<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.1"></a><h3>2.1.1.&nbsp;
Ability to Filter Inbound or Outbound Routes</h3>

<p>Capability.</p>
<blockquote class="text">
<p>The device provides the ability to filter which routes may be
              received with <a class='info' href='#RFC4271'>[RFC4271]<span> (</span><span class='info'>Rekhter, Y., Li, T., and S. Hares, &ldquo;A Border Gateway Protocol 4 (BGP-4),&rdquo; January&nbsp;2006.</span><span>)</span></a>, as well as the
              ability to filter which routes are announced into each routing
              protocol.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>See section 2.4.2 of <a class='info' href='#RFC4778'>[RFC4778]<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a>.
</p>
<p>It is a beneficial practice to configure routing filters in
              both directions, which will counter potential misconfiguration
              in either peer. Also, incoming route filters will prevent a
              deliberate attacker from injecting invalid routing
              information.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>The unicast routing protocols used with IP can be classified
              into path vector routing protocols (such as BGP), distance
              vector protocols (such as <a class='info' href='#RFC2453'>[RFC2453]<span> (</span><span class='info'>Malkin, G., &ldquo;RIP Version 2,&rdquo; November&nbsp;1998.</span><span>)</span></a>) and
              link state protocols (such as <a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> and
              <a class='info' href='#RFC1195'>[RFC1195]<span> (</span><span class='info'>Callon, R., &ldquo;Use of OSI IS-IS for routing in TCP/IP and dual environments,&rdquo; December&nbsp;1990.</span><span>)</span></a>). Because of differences in the
              protocols, route filters will affect them in different ways.
</p>
<p>Take BGP for example, an implementation may check a received
              route against inbound filters to determine whether to install it
              into the overall route table or not. Also, it will restrict the
              routes which will go out to neighbors against outbound route
              filters.
</p>
<p>However, as to link state protocols, such as OSPF, a router
              maintains a topology database and exchanges link state
              information with neighbors. Since route filters do not influence
              the link state database, route filters will only affect which
              routes are advertised into the routing protocol. That is to say,
              only inbound route filters are effective on link state
              protocols.
</p>
<p>Most of the routing protocols support methods to configure
              route filters which permit or deny learning or advertising of
              specific routes.
</p>
</blockquote>

<p>Considerations.</p>
<blockquote class="text">
<p>None.
</p>
</blockquote>

<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1.2"></a><h3>2.1.2.&nbsp;
Ability to Filter Routes by Prefix</h3>

<p>Capability.</p>
<blockquote class="text">
<p>The device supports filtering routes based on prefix.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>See section 2.4.2 of <a class='info' href='#RFC4778'>[RFC4778]<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a>.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>The filter may include a list of specific prefixes to be
              accepted or rejected. The filter may alternately include a list
              of prefixes, such that more specific (longer) prefixes, which
              are included in the more inclusive (shorter) prefix, are
              accepted, rejected, or summarized into the shorter prefix.
</p>
</blockquote>

<p>Considerations.</p>
<blockquote class="text">
<p>Operators may wish to ignore advertisements for routes to
              specific addresses, such as private addresses, reserved
              addresses and multicast addresses, etc. The up-to-date
              allocation of IPv4 address space can be found in <a class='info' href='#IANA'>[IANA]<span> (</span><span class='info'>IANA, &ldquo;INTERNET PROTOCOL V4 ADDRESS SPACE,&rdquo; 2007.</span><span>)</span></a>.
</p>
</blockquote>

<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Route Filtering of Exterior Gateway Protocol</h3>

<p>An exterior gateway protocol is used to exchange external routing
        information between different autonomous systems. Since BGP is the
        most widely used protocol, this section mainly depicts special routing
        filter capabilities of BGP.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.1"></a><h3>2.2.1.&nbsp;
Ability to Filter Routes by Route Attributes</h3>

<p>Capability.</p>
<blockquote class="text">
<p>The device supports filtering routing updates by route
              attributes.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>See <a class='info' href='#RFC3013'>[RFC3013]<span> (</span><span class='info'>Killalea, T., &ldquo;Recommended Internet Service Provider Security Services and Procedures,&rdquo; November&nbsp;2000.</span><span>)</span></a> , section 3.2 of<a class='info' href='#RFC2196'>[RFC2196]<span> (</span><span class='info'>Fraser, B., &ldquo;Site Security Handbook,&rdquo; September&nbsp;1997.</span><span>)</span></a> and section 2.4.2 of <a class='info' href='#RFC4778'>[RFC4778]<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a>.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>In comparison with other routing protocols, BGP defines
              various path attributes to describe characteristics of routes.
              Besides filtering by specific prefixes, BGP also provides
              capability to use some path attributes to precisely filter
              routes to determine whether a route is accepted from or sent to
              a neighboring router.
</p>
<p>These filters may be based upon any combination of route
              attributes, such as: </p>
<ul class="text">
<li>Restrictions on the Content of AS_PATH. Restrictions on
                  the contents of the AS PATH are frequently used: for
                  example, the received AS_PATH may be checked to ensure the
                  sending AS is actually contained in the received
                  AS_PATH.
</li>
<li>Restrictions on Communities. Implementations could filter
                  received routes based on the set of communities <a class='info' href='#RFC1997'>[RFC1997]<span> (</span><span class='info'>Chandrasekeran, R., Traina, P., and T. Li, &ldquo;BGP Communities Attribute,&rdquo; August&nbsp;1996.</span><span>)</span></a> or extended communities <a class='info' href='#RFC4360'>[RFC4360]<span> (</span><span class='info'>Sangli, S., Tappan, D., and Y. Rekhter, &ldquo;BGP Extended Communities Attribute,&rdquo; February&nbsp;2006.</span><span>)</span></a>.
</li>
</ul>

</blockquote>

<p>Considerations.</p>
<blockquote class="text">
<p>None.
</p>
</blockquote>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.2"></a><h3>2.2.2.&nbsp;
Ability to Filter Routing Update by TTL</h3>

<p>Capability.</p>
<blockquote class="text">
<p>The device should provide a means to filter route packets
              based on the value of the TTL field in the IPv4 header or the
              Hop-Limit field in the IPv6 header.
</p>
<p>Note that <a class='info' href='#I-D.ietf-opsec-filter-caps'>[I&#8209;D.ietf&#8209;opsec&#8209;filter&#8209;caps]<span> (</span><span class='info'>Morrow, C., &ldquo;Filtering and Rate Limiting Capabilities for IP Network Infrastructure,&rdquo; July&nbsp;2007.</span><span>)</span></a>
              specifies:
</p>
<p>Capability.</p>
<blockquote class="text">
<p>The filtering mechanism supports filtering based on the
                  value(s) of any portion of the protocol headers for IP,
                  ICMP, UDP and TCP.
</p>
</blockquote>

<p>The ability to filter based on TTL is therefore a packet
              filtering capability which is already implicitly covered by the
              capabilities listed in Filtering Capabilities. Since this
              capability is particularly important for BGP, we felt that it is
              worth mentioning here.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>See <a class='info' href='#RFC4778'>[RFC4778]<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a> section 2.4.2 and <a class='info' href='#RFC3682'>[RFC3682]<span> (</span><span class='info'>Gill, V., Heasley, J., and D. Meyer, &ldquo;The Generalized TTL Security Mechanism (GTSM),&rdquo; February&nbsp;2004.</span><span>)</span></a>.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>Most current BGP implementations support this capability to
              protect BGP sessions.
</p>
</blockquote>

<p>Considerations.</p>
<blockquote class="text">
<p>There will be situations in which the distance to the
              neighboring router is more than one hop away. This for example
              is common for I-BGP.
</p>
</blockquote>

<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.3"></a><h3>2.2.3.&nbsp;
Ability to Limit the Number of Routes from a Peer</h3>

<p>Capability.</p>
<blockquote class="text">
<p>The device should provide a means to configure the maximum
              number of routes (prefixes) to accept from a peer.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>Both routing policy misconfiguration and a deliberate attack
              from a peer may cause too many routes to be sent to a peer which
              may exhaust the memory resources of the router, introduce
              routing instability into the overall routing table, or both.
              Therefore, operators may want to restrict the amount of routes
              received from a particular peer router through a maximum prefix
              limitation approach.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>Most BGP implementations support this capability. If too many
              routes are sent, then the router may reset the BGP session or
              may reject excess routes. In either case the device may log the
              failure event (at a minimum), or shut down the BGP session.
</p>
</blockquote>

<p>Considerations.</p>
<blockquote class="text">
<p>Operators must be cognizant of the need to allow for valid
              swings in routing announcements between themselves, and as such
              should always set the max-prefix limit to some agreed upon
              number plus a sane amount for overhead to allow for these
              necessary announcement swings. Individual implementations
              amongst ISPs are unique, and depending on equipment supplier(s)
              different implementation options are available. Most equipment
              vendors offer implementation options ranging from just logging
              excessive prefixes being received to automatically shutting down
              the session. If the option of reestablishing a session after
              some pre-configured idle timeout has been reached is available,
              it should be understood that automatically reestablishing the
              session may continuously introduce instability into the overall
              routing table if a policy misconfiguration on the adjacent
              neighbor is causing the condition. If a serious misconfiguration
              on a peering neighbor has occurred then automatically shutting
              down the session and leaving it shut down until being manually
              cleared is perhaps best and allows for operator intervention to
              correct as needed.
</p>
</blockquote>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.4"></a><h3>2.2.4.&nbsp;
Ability to Limit the Length of Prefixes</h3>

<p>Capability.</p>
<blockquote class="text">
<p>The device has the capability to allow filtering of route
              updates by prefix length.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>Some large ISPs declare in their peer BGP policies that they
              will not accept the announcements whose prefix length is longer
              than a specific threshold.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>Most BGP implementations support this capability.
</p>
</blockquote>

<p>Considerations.</p>
<blockquote class="text">
<p>None.
</p>
</blockquote>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2.5"></a><h3>2.2.5.&nbsp;
Ability to Cooperate in Outbound Route Filtering</h3>

<p>Capability.</p>
<blockquote class="text">
<p>A device provides the capability to allow operators to
              configure whether Outbound Route Filtering/ORF defined in <a class='info' href='#I-D.ietf-idr-route-filter'>[I&#8209;D.ietf&#8209;idr&#8209;route&#8209;filter]<span> (</span><span class='info'>Chen, E. and Y. Rekhter, &ldquo;Outbound Route Filtering Capability for BGP-4,&rdquo; June&nbsp;2008.</span><span>)</span></a> are accepted from or
              sent to other peer routers.
</p>
</blockquote>

<p>Supported Practices</p>
<blockquote class="text">
<p>"Outbound Route Filtering" defines a BGP mechanism to reduce
              the number of BGP updates between BGP peers. It will conserve
              the resource in both sides of peers, since the BGP speaker will
              not generate updates that will be filtered and the neighbor
              router will not process them as well. A router with limited
              resource may need this feature to prevent overfull routes from
              peers.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>ORF may be based on prefix, path attributes. Currently, most
              implementations support prefix-based ORF.
</p>
</blockquote>

<p>Considerations.</p>
<blockquote class="text">
<p>None.
</p>
</blockquote>

<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Route Filtering of Interior Gateway Protocols</h3>

<p>This section describes route filtering as it may be applied to OSPF
        and IS-IS when used as the interior gateway protocol (Internal Gateway
        Protocol or IGP) used within a routing domain.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.1"></a><h3>2.3.1.&nbsp;
Route Filtering Within an IGP Area</h3>

<p>A critical design principle of OSPF and IS-IS is that each router
          within an area has the same view of the topology, thereby allowing
          consistent routes to be computed by all routers within the area. For
          this reason, all properly authenticated (if applicable) routing
          topology advertisements (Link State Advertisements or LSAs in OSPF,
          or Link State Packets or LSPs in IS-IS) are flooded unchanged
          throughout the area. Route filtering within an OSPF or IS-IS area is
          therefore not appropriate.
</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3.2"></a><h3>2.3.2.&nbsp;
Route Filtering Between IGP Areas</h3>

<p>Capability.</p>
<blockquote class="text">
<p>The device provides the capability to allow the network
              operator to configure route filters which restrict which routes
              (i.e, address prefixes) are advertised into areas from outside
              of the area (i.e., from other OSPF or IS-IS areas).
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>See section 2.4.2 of <a class='info' href='#RFC4778'>[RFC4778]<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a>.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>Some OSPF/IS-IS implementations support this capability.
</p>
</blockquote>

<p>Considerations</p>
<blockquote class="text">
<p>If filters are used which restrict the passing of routes
              between IGP areas, then this may result in some addresses being
              unreachable from some other areas within the same routing
              domain.
</p>
<p>It is normal when passing routes into the backbone area (area
              0.0.0.0 in OSPF, or the level 2 backbone in IS-IS) for routes to
              be summarized, in the sense that multiple more specific (longer)
              address prefixes that are reachable in an area may be summarized
              into a smaller number of less specific (shorter) address
              prefixes. This provides important scaling improvements, but is
              generally not primarily intended to aid in security and is
              therefore outside of the scope of this document.
</p>
</blockquote>

<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Route Filtering during Redistribution</h3>

<p>Capability.</p>
<blockquote class="text">
<p>The device provides a means to filter routes when distributing
            them between routing protocols or between routing protocol
            processes running in the single device.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>Route redistribution bridges between different route domains
            and improves the flexibility of routing system. This allows for
            the transmission of reachable destinations learned in one protocol
            through another protocol. However, without careful consideration
            it may lead to looping or black holes as well.
</p>
<p>Filters are always needed when routes redistributing between
            IGP and EGP. For example, it is infeasible to inject all Internet
            routes from EGP to IGPs, since IGPs are not able to deal with such
            a large number of routes.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>Most implementations allow applying a filter based on a prefix
            list to control redistribution.
</p>
</blockquote>

<p>Considerations</p>
<blockquote class="text">
<p>None.
</p>
</blockquote>

<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Route Authentication Capabilities</h3>

<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Ability to configure an authentication mechanism</h3>

<p>Capabilities.</p>
<blockquote class="text">
<p>The device has one or more methods to allow an authentication
            mechanism to be configured for the routing protocol.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>See <a class='info' href='#RFC4778'>[RFC4778]<span> (</span><span class='info'>Kaeo, M., &ldquo;Operational Security Current Practices in Internet Service Provider Environments,&rdquo; January&nbsp;2007.</span><span>)</span></a> section 2.4.2.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p><a class='info' href='#RFC2385'>[RFC2385]<span> (</span><span class='info'>Heffernan, A., &ldquo;Protection of BGP Sessions via the TCP MD5 Signature Option,&rdquo; August&nbsp;1998.</span><span>)</span></a> is deployed widely in BGP. Other
            routing protocols, such as OSPF, adopt similar technology.
</p>
</blockquote>

<p>Consideration.</p>
<blockquote class="text">
<p>In most of current implementations, neither the authentication
            mechanism nor key can be negotiated. An operator has to configure
            it manually, which will affect scalability.
</p>
<p>As of this writing, MD5 is the only cryptographic hash function
            used in route authentication. However, recent research revealed
            weakness of MD5, which means stronger algorithms are
            necessary.
</p>
</blockquote>

<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Ability to support authentication key chains</h3>

<p>Capabilities.</p>
<blockquote class="text">
<p>The device provides a key chain mechanism to update
            authentication keys of routing protocols.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>Using a fixed authentication key is vulnerable to a compromise.
            A key chain is a series of keys which will be used in configured
            time intervals. A device can transit keys based on system time and
            configured key chain. In this way, it reduces possibility of
            leakage of an authentication key.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>This mechanism is implemented in most routing protocols.
            Different vendors provide this feature in different routing
            protocols, such as RIP, OSPF and BGP.
</p>
</blockquote>

<p>Consideration.</p>
<blockquote class="text">
<p>Since the rollover of the key is based on system time on
            different routers, it requires clock synchronization across the
            routers.
</p>
</blockquote>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Ability to Damp Route Flap</h3>

<p>Capability.</p>
<blockquote class="text">
<p>The device provides the capability to damp route flaps.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>The function to damp route flaps may enhance the stability of
          routing system and minimize the influence of flapping. It is useful
          to counter against some DoS attacks.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>BGP RFD (Route Flap Damping) of <a class='info' href='#RFC2439'>[RFC2439]<span> (</span><span class='info'>Villamizar, C., Chandra, R., and R. Govindan, &ldquo;BGP Route Flap Damping,&rdquo; November&nbsp;1998.</span><span>)</span></a>
          defines the primary mechanism in BGP to mitigate the influence
          caused by flapping. Most of current BGP implementations support this
          capability.
</p>
<p>Other routing protocols may be vulnerable to route flaps as well.
          Some vendors introduce SPF (shortest path first) algorithm timers in
          OSPF to control parameters, such as the amount of minimal time
          between consecutive SPF computations, which may be used to mitigate
          excessive resource exhaustion caused by link flaps.
</p>
</blockquote>

<p>Consideration.</p>
<blockquote class="text">
<p><a class='info' href='#MAO'>[MAO]<span> (</span><span class='info'>Mao, Z., Govindan, R., Varghese, G., and R. Katz, &ldquo;Route Flap Damping Exacerbates Internet Routing           Convergence,&rdquo; 2002.</span><span>)</span></a> described a flaw of current BGP RFD
          standard RFC2439, which shows that route flap damping could suppress
          relatively stable routes and affect routing convergence.
</p>
<p>Since, at the time of this writing, no vendors are known to have
          fixed this problem, <a class='info' href='#RIPE378'>[RIPE378]<span> (</span><span class='info'>RIPE, &ldquo;Recommendations on Route-flap Damping,&rdquo; May&nbsp;2006.</span><span>)</span></a> proposes that,
          with the current implementations of BGP flap damping, the
          application of flap damping in ISP networks is not recommended.
</p>
</blockquote>

<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Resource Availability for Router Control Functions</h3>

<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
Ensure Resources for Management Functions</h3>

<p>Capability.</p>
<blockquote class="text">
<p>This capability specifies that device implementations ensure
            that at least a certain minimum sufficient level of resources are
            available for management functions. This may include such
            resources as memory, processor cycle, data structure and/or
            bandwidth at ingress to the device, on egress from the device, for
            internal transmission and processing. This may include at least
            protocols used for configuration, monitoring, configuration
            backup, logging, time synchronization, authentication and
            authorization.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>Certain attacks (and normal operation) can cause resource
            saturation such as link congestion, memory exhaustion or CPU
            overload. In these cases it is important that resources be
            available for management functions in order to ensure that
            operators have the tools needed to recover from the attack.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>How this is implemented depend upon the details of the device.
            There are a variety of ways that this may be ensured such as
            prioritizing management functions in comparison with other
            functions performed by the device, providing separate queues for
            management traffic, use of operating systems or other methods that
            partition resources between processes or functions, and so on.
</p>
</blockquote>

<p>Consideration.</p>
<blockquote class="text">
<p>Imagine a service provider with 1,000,000 DSL subscribers, most
            of whom have no firewall protection. Imagine that a large portion
            of these subscribers machines were infected with a new worm that
            enabled them to be used in coordinated fashion as part of large
            denial of service attack that involved flooding. It is entirely
            possible that such an attack could in some cases cause processor
            saturation or other internal resource saturation on routers
            causing the routers to become unmanageable. A DoS attack against
            hosts could therefore become a DoS attack against the network.
</p>
<p>Guarantee of resources within an individual device is not a
            panacea. Control packets may not make it across a saturated link.
            This requirement simply says that the device should ensure
            resources for management functions within its scope of control
            (e.g., ingress, egress, internal transit, processing). To the
            extent that this is done across an entire network, the overall
            effect will be to ensure that the network remains manageable.
</p>
</blockquote>

<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
Ensure Resources for Routing Functions</h3>

<p>Capability.</p>
<blockquote class="text">
<p>This capability specifies that a device implementation ensures
            at least a certain minimum sufficient level of resources are
            available for routing protocol functions. This may include such
            resources as memory, processor cycle, data structure and bandwidth
            at ingress to the device, on egress from the device, for internal
            transmission, and processing. This may include at least protocols
            used for routing protocol operation, including resources used for
            routing HELLO packets for BGP, IS-IS, and OSPF.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>Certain attacks (and normal operation) can cause resource
            saturation such as link congestion, memory exhaustion or CPU
            overload. In these cases it is important that resources be
            available for the operation of routing protocols in order to
            ensure that the network continues to operate (for example, that
            routes can be computed in order to allow management traffic to be
            delivered). For many routing protocols the loss of HELLO packets
            can cause the protocol to drop adjacencies and/or to send out
            additional routing packets, potentially destabilizing the routing
            protocol and/or adding to whatever congestion may be causing the
            problem.
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>How this is implemented depend upon the details of the device.
            There are a variety of ways that this may be ensured such as
            prioritizing routing functions in comparison with other functions
            performed by the device, providing separate queues for routing
            traffic, use of operating systems or other methods that partition
            resources between processes or functions, and so on.
</p>
</blockquote>

<p>Consideration.</p>
<blockquote class="text">
<p>For example, if routing HELLO packets are not prioritized, then
            it is possible during DoS attacks or during severe network
            congestion for routing protocols to drop HELLO packets, causing
            routing adjacencies to be lost. This in turn can cause overall
            failure of a network. A DoS attack against hosts can therefore
            become a DoS attack against the network.
</p>
<p>Guaranteeing resources within routers is not a panacea. Routing
            packets may not make it across a saturated link (thus for example
            it may also be desirable to prioritize routing packets for
            transmission across link layer devices such as Ethernet switches).
            This requirement simply says that the device should prioritize
            routing functions within its scope of control (e.g., ingress,
            egress, internal transit, processing). To the extent that this is
            done across an entire network, the overall effect will be to
            ensure that the network continues to operate.
</p>
</blockquote>

<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
Limit Resources used by IP Multicast</h3>

<p>Capability.</p>
<blockquote class="text">
<p>This capability specifies that some mechanism(s) is provided to
            allow the control plane resources used by IP multicast, including
            processing and memory, to be limited to some level which is less
            than 100% of the total available processing and memory. In some
            cases the maximum limit of resources used by multicast may be
            configurable. Routers may also provide a mechanism(s) to allow the
            amount of link bandwidth consumed by IP multicast on any
            particular link to be limited to some level which is less than
            100% of total available bandwidth on that link.
</p>
</blockquote>

<p>Supported Practices.</p>
<blockquote class="text">
<p>IP multicast has characteristics which may potentially impact
            the availability of IP networks. In particular, IP multicast
            requires that routers perform control plane processing and
            maintain state in response to data plane traffic. Also, the use of
            multicast implies that a single packet input into the network can
            result in a large number of packets being delivered throughout the
            network. Also, it is possible in some situations for a multicast
            traffic to *both* enter a loop, and also be delivered to some
            destinations (implying that many copies of the same packet could
            be delivered).
</p>
</blockquote>

<p>Current Implementations.</p>
<blockquote class="text">
<p>None.
</p>
</blockquote>

<p>Consideration.</p>
<blockquote class="text">
<p>If the amount of resources used by multicast are not limited,
            then it is possible during an attack for multicast to consume
            potentially as much as 100% of available memory, processing, or
            bandwidth resources, thereby causing network problems.
</p>
</blockquote>

<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>Security is the subject matter of this entire document. This document
      lists device capabilities intended to improve the ability of the network
      to withstand security threats. Operational Security Current Practices
      defines the threat model and practices, and lists justifications for
      each practice.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
IANA Considerations</h3>

<p>This document has no actions for IANA.
</p>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
Acknowledgements</h3>

<p>The authors gratefully acknowledge the contributions of Ron Bonica,
      Ted Seely, Pat Cain, George Jones, and Russ White etc for their
      contributed texts, useful comments and suggestions.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1195">[RFC1195]</a></td>
<td class="author-text">Callon, R., &ldquo;<a href="http://tools.ietf.org/html/rfc1195">Use of OSI IS-IS for routing in TCP/IP and dual environments</a>,&rdquo; RFC&nbsp;1195, December&nbsp;1990 (<a href="http://www.rfc-editor.org/rfc/rfc1195.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc1195.ps">PS</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1997">[RFC1997]</a></td>
<td class="author-text"><a href="mailto:rchandra@cisco.com">Chandrasekeran, R.</a>, <a href="mailto:pst@cisco.com">Traina, P.</a>, and <a href="mailto:tli@skat.usc.edu">T. Li</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc1997">BGP Communities Attribute</a>,&rdquo; RFC&nbsp;1997, August&nbsp;1996 (<a href="http://www.rfc-editor.org/rfc/rfc1997.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2328">[RFC2328]</a></td>
<td class="author-text"><a href="mailto:jmoy@casc.com">Moy, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2328">OSPF Version 2</a>,&rdquo; STD&nbsp;54, RFC&nbsp;2328, April&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2328.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2328.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2328.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2385">[RFC2385]</a></td>
<td class="author-text"><a href="mailto:ahh@cisco.com">Heffernan, A.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2385">Protection of BGP Sessions via the TCP MD5 Signature Option</a>,&rdquo; RFC&nbsp;2385, August&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2385.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2385.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2385.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2439">[RFC2439]</a></td>
<td class="author-text"><a href="mailto:curtis@ans.net">Villamizar, C.</a>, <a href="mailto:rchandra@cisco.com">Chandra, R.</a>, and <a href="mailto:govindan@isi.edu">R. Govindan</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2439">BGP Route Flap Damping</a>,&rdquo; RFC&nbsp;2439, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2439.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2439.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2439.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2453">[RFC2453]</a></td>
<td class="author-text"><a href="mailto:gmalkin@baynetworks.com">Malkin, G.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2453">RIP Version 2</a>,&rdquo; STD&nbsp;56, RFC&nbsp;2453, November&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2453.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2453.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2453.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3013">[RFC3013]</a></td>
<td class="author-text">Killalea, T., &ldquo;<a href="http://tools.ietf.org/html/rfc3013">Recommended Internet Service Provider Security Services and Procedures</a>,&rdquo; BCP&nbsp;46, RFC&nbsp;3013, November&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc3013.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4271">[RFC4271]</a></td>
<td class="author-text">Rekhter, Y., Li, T., and S. Hares, &ldquo;<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>,&rdquo; RFC&nbsp;4271, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4271.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4360">[RFC4360]</a></td>
<td class="author-text">Sangli, S., Tappan, D., and Y. Rekhter, &ldquo;<a href="http://tools.ietf.org/html/rfc4360">BGP Extended Communities Attribute</a>,&rdquo; RFC&nbsp;4360, February&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4360.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2196">[RFC2196]</a></td>
<td class="author-text"><a href="mailto:byf@cert.org">Fraser, B.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2196">Site Security Handbook</a>,&rdquo; RFC&nbsp;2196, September&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2196.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC3682">[RFC3682]</a></td>
<td class="author-text">Gill, V., Heasley, J., and D. Meyer, &ldquo;<a href="http://tools.ietf.org/html/rfc3682">The Generalized TTL Security Mechanism (GTSM)</a>,&rdquo; RFC&nbsp;3682, February&nbsp;2004 (<a href="http://www.rfc-editor.org/rfc/rfc3682.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4778">[RFC4778]</a></td>
<td class="author-text">Kaeo, M., &ldquo;<a href="http://tools.ietf.org/html/rfc4778">Operational Security Current Practices in Internet Service Provider Environments</a>,&rdquo; RFC&nbsp;4778, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4778.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-opsec-filter-caps">[I-D.ietf-opsec-filter-caps]</a></td>
<td class="author-text">Morrow, C., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-opsec-filter-caps-09.txt">Filtering and Rate Limiting Capabilities for IP Network Infrastructure</a>,&rdquo; draft-ietf-opsec-filter-caps-09 (work in progress), July&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-opsec-filter-caps-09.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-idr-route-filter">[I-D.ietf-idr-route-filter]</a></td>
<td class="author-text">Chen, E. and Y. Rekhter, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-idr-route-filter-17.txt">Outbound Route Filtering Capability for BGP-4</a>,&rdquo; draft-ietf-idr-route-filter-17 (work in progress), June&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-idr-route-filter-17.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="IANA">[IANA]</a></td>
<td class="author-text">IANA, &ldquo;<a href="http://www.iana.org/assignments/ipv4-address-space">INTERNET PROTOCOL V4 ADDRESS SPACE</a>,&rdquo; http://www.iana.org/assignments/ipv4-address-space&nbsp;, 2007.</td></tr>
<tr><td class="author-text" valign="top"><a name="MAO">[MAO]</a></td>
<td class="author-text">Mao, Z., Govindan, R., Varghese, G., and R. Katz, &ldquo;<a href="http://www.sigcomm.org/sigcomm2002/papers/routedampening.html">Route Flap Damping Exacerbates Internet Routing
          Convergence</a>,&rdquo; Sigcomm&nbsp;, 2002.</td></tr>
<tr><td class="author-text" valign="top"><a name="RIPE378">[RIPE378]</a></td>
<td class="author-text">RIPE, &ldquo;<a href="http://www.ripe.net/ripe/docs/ripe-378.txt">Recommendations on Route-flap Damping</a>,&rdquo; RIPE&nbsp;, May&nbsp;2006.</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Zhao Ye</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">No. 3, Xinxi Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Shangdi Information Industry Base</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Haidian District, Beijing  100085</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P. R. China</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ye.zhao_ietf@hotmail.com">ye.zhao_ietf@hotmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Miao Fuyou</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">No. 3, Xinxi Rd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Shangdi Information Industry Base</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Haidian District, Beijing  100085</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">P. R. China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+86 10 8288 2008</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:miaofy@huawei.com">miaofy@huawei.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Ross W. Callon</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10 Technology Park Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Westford, MA  01886</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:rcallon@juniper.net">rcallon@juniper.net</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2007).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
