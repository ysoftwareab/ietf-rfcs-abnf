

Secure Shell Working Group                                  J. Galbraith
Internet-Draft                                          VanDyke Software
Expires: September 23, 2005                                 O. Saarenmaa
                                                                F-Secure
                                                          March 22, 2005


                      X.509 authentication in SSH2
                      draft-ietf-secsh-x509-00.txt

Status of this Memo

   This document is an Internet-Draft and is subject to all provisions
   of Section 3 of RFC 3667.  By submitting this Internet-Draft, each
   author represents that any applicable patent or other IPR claims of
   which he or she is aware have been or will be disclosed, and any of
   which he or she become aware will be disclosed, in accordance with
   RFC 3668.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as
   Internet-Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as "work in progress."

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt.

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.

   This Internet-Draft will expire on September 23, 2005.

Copyright Notice

   Copyright (C) The Internet Society (2005).

Abstract

   The X.509 extension specifies how X.509 keys and signatures are used
   within the SSH2 protocol.






Galbraith & Saarenmaa    Expires September 23, 2005             [Page 1]

Internet-Draft        X.509 authentication in SSH2            March 2005


Table of Contents

   1.  Introduction . . . . . . . . . . . . . . . . . . . . . . . . .  3
   2.  x509v3 keys  . . . . . . . . . . . . . . . . . . . . . . . . .  4
     2.1   x509v3-sign-rsa2 . . . . . . . . . . . . . . . . . . . . .  4
     2.2   x509v3-sign-dss2 . . . . . . . . . . . . . . . . . . . . .  4
     2.3   x509v3-sign  . . . . . . . . . . . . . . . . . . . . . . .  5
   3.  Implementation Considerations  . . . . . . . . . . . . . . . .  6
   4.  IANA Considerations  . . . . . . . . . . . . . . . . . . . . .  7
   5.  Security Considerations  . . . . . . . . . . . . . . . . . . .  8
   6.  References . . . . . . . . . . . . . . . . . . . . . . . . . .  9
     6.1   Normative References . . . . . . . . . . . . . . . . . . .  9
     6.2   Informative References . . . . . . . . . . . . . . . . . .  9
       Authors' Addresses . . . . . . . . . . . . . . . . . . . . . . 10
       Intellectual Property and Copyright Statements . . . . . . . . 11




































Galbraith & Saarenmaa    Expires September 23, 2005             [Page 2]

Internet-Draft        X.509 authentication in SSH2            March 2005


1.  Introduction

   The SSH protocol can use public keys for both host and user
   authentication.  However, particularly for host authentication, plain
   public keys lack a good method of verifying that the the key provided
   really does belong to the host asserting ownership.  X.509v3
   certificates can address this problem in environments where a PKI
   infrastructure is available.











































Galbraith & Saarenmaa    Expires September 23, 2005             [Page 3]

Internet-Draft        X.509 authentication in SSH2            March 2005


2.  x509v3 keys

   Key type names are of the form "x509v3-sign*".  Keys are encoded as
   follows:

       string           key-type-name
       string           DER encoded x.509v3 certificate data


2.1  x509v3-sign-rsa2

   Certificates that use the RSA public key algorithm SHOULD use the
   "x509v3-sign-rsa2" key-type-name.

   Signing and verifying using this key format, uses the certificate's
   private key, in exactly the same manner specified for "ssh-rsa"
   public keys in [I-D.ietf-secsh-transport].  That is to say, signing
   and verifying using this key format is performed according to the
   RSASSA-PKCS1-v1_5 scheme in [RFC3447] using the SHA-1 hash.

   The signature format for x509v3-sign-rsa2 certificates is the
   "ssh-rsa" signing format specified in [I-D.ietf-secsh-transport].
   This format is as follows:

       string    "ssh-rsa"
       string    rsa_signature_blob

   The value for 'rsa_signature_blob' is encoded as a string containing
   s (which is an integer, without lengths or padding, unsigned and in
   network byte order).

2.2  x509v3-sign-dss2

   Certificates that use the DSA public key algorithm SHOULD use the
   "x509v3-sign-dss2" key-type-name.

   Signing and verifying using this key format, uses the certificate's
   private key, in exactly the same manner specified for "ssh-dss"
   public keys in [I-D.ietf-secsh-transport].  That is to say, signing
   and verifying using this key format is done according to the Digital
   Signature Standard [FIPS-186-2] using the SHA-1 hash [FIPS-180-2].

   The signature format for x509v3-sign-rsa2 certificates is the
   "ssh-dss" signing format specified in [I-D.ietf-secsh-transport].
   This format is as follows:

       string    "ssh-dss"
       string    dss_signature_blob



Galbraith & Saarenmaa    Expires September 23, 2005             [Page 4]

Internet-Draft        X.509 authentication in SSH2            March 2005


   The value for 'dss_signature_blob' is encoded as a string containing
   r followed by s (which are 160-bit integers, without lengths or
   padding, unsigned and in network byte order).

2.3  x509v3-sign

   Certificates that use another algorithm other than the two specified
   above, MUST use the "x509v3-sign" key-type-name.

   Signing and verifying is done according to the specification
   associated with the public-key algorithm oid encoded in the
   certificate.

   The signature, and description of the signature algorithms is encoded
   as specificied in pkcs7 [PKCS.7.1993].  The signature MUST be
   detached (the signed data MUST NOT be includeded in the pkcs7 data.

   The pkcs7 data is encoded in the SSH protocol as follows:

       string    "pkcs7"
       string    DER encoded PKCS7 data






























Galbraith & Saarenmaa    Expires September 23, 2005             [Page 5]

Internet-Draft        X.509 authentication in SSH2            March 2005


3.  Implementation Considerations

   Implemenations SHOULD be careful when using x.509v3 certificates as
   hostkeys.  If the peer does not implement the required algorithms to
   validate both the x.509v3 certificate and all certificates in the
   chain, it MUST disconnect.  There is no way to renegotiate the key
   during key exchange.

   This is especially true when using the "x509v3-sign" key type, since
   in this case the peer has no knowledge whatsoever of required
   algorithms.








































Galbraith & Saarenmaa    Expires September 23, 2005             [Page 6]

Internet-Draft        X.509 authentication in SSH2            March 2005


4.  IANA Considerations

   This document reserves all key types beginning with "x509v3-sign" in
   the SSH publickey type registery.

   This document specifically adds "x509v3-sign-rsa2",
   "x509v3-sign-dss2", and "x509v3-sign" to the SSH publickey type
   registry.

   This document adds "x509v3-sign-rsa" and "x509v3-sign-dss" to the SSH
   publickey type registry as "poisoned" by historical use.








































Galbraith & Saarenmaa    Expires September 23, 2005             [Page 7]

Internet-Draft        X.509 authentication in SSH2            March 2005


5.  Security Considerations

   PKI is an extremely complex topic, and care MUST be taken by both
   implementors and deployers to understand the complex interactions
   involved.

   Implementations SHOULD carefully validate the certificate, including,
   but not limitted to, certificate expiration, certificate signature,
   certificate revokation lists, etc.

   For more information, implementors should refer to [ITU.X509.2000]
   and [RFC3820].







































Galbraith & Saarenmaa    Expires September 23, 2005             [Page 8]

Internet-Draft        X.509 authentication in SSH2            March 2005


6.  References

6.1  Normative References

   [I-D.ietf-secsh-transport]
              Lonvick, C., "SSH Transport Layer Protocol",
              Internet-Draft draft-ietf-secsh-transport-24, March 2005.

   [PKCS.7.1993]
              RSA Laboratories, "Cryptographic Message Syntax Standard.
              Version 1.5", PKCS 7, November 1993.

   [RFC3447]  Jonsson, J. and B. Kaliski, "Public-Key Cryptography
              Standards (PKCS) #1: RSA Cryptography Specifications
              Version 2.1", RFC 3447, February 2003.

   [RFC3820]  Tuecke, S., Welch, V., Engert, D., Pearlman, L. and M.
              Thompson, "Internet X.509 Public Key Infrastructure (PKI)
              Proxy Certificate Profile", RFC 3820, June 2004.

   [ITU.X509.2000]
              International Telecommunications Union, "Information
              technology - Open Systems Interconnection - The Directory:
              Public-key and attribute certificate frameworks",
              ITU-T Recommendation X.509, ISO Standard 9594-8, March
              2000.

   [FIPS-180-2]
              National Institute of Standards and Technology, "Secure
              Hash Standard (SHS)", Federal Information Processing
              Standards Publication 180-2, August 2002.

   [FIPS-186-2]
              National Institute of Standards and Technology, "Digital
              Signature Standard (DSS)", Federal Information Processing
              Standards Publication 186-2, January 2000.

6.2  Informative References













Galbraith & Saarenmaa    Expires September 23, 2005             [Page 9]

Internet-Draft        X.509 authentication in SSH2            March 2005


Authors' Addresses

   Joseph Galbraith
   VanDyke Software
   4848 Tramway Ridge Blvd
   Suite 101
   Albuquerque, NM  87111
   US

   Phone: +1 505 332 5700
   Email: galb-list@vandyke.com


   Oskari Saarenmaa
   F-Secure
   A Street Address
   A City, State or Region  A Postal Code
   FI

   Email: oskari.saarenmaa@f-secure.com































Galbraith & Saarenmaa    Expires September 23, 2005            [Page 10]

Internet-Draft        X.509 authentication in SSH2            March 2005


Intellectual Property Statement

   The IETF takes no position regarding the validity or scope of any
   Intellectual Property Rights or other rights that might be claimed to
   pertain to the implementation or use of the technology described in
   this document or the extent to which any license under such rights
   might or might not be available; nor does it represent that it has
   made any independent effort to identify any such rights.  Information
   on the procedures with respect to rights in RFC documents can be
   found in BCP 78 and BCP 79.

   Copies of IPR disclosures made to the IETF Secretariat and any
   assurances of licenses to be made available, or the result of an
   attempt made to obtain a general license or permission for the use of
   such proprietary rights by implementers or users of this
   specification can be obtained from the IETF on-line IPR repository at
   http://www.ietf.org/ipr.

   The IETF invites any interested party to bring to its attention any
   copyrights, patents or patent applications, or other proprietary
   rights that may cover technology that may be required to implement
   this standard.  Please address the information to the IETF at
   ietf-ipr@ietf.org.


Disclaimer of Validity

   This document and the information contained herein are provided on an
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED,
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.


Copyright Statement

   Copyright (C) The Internet Society (2005).  This document is subject
   to the rights, licenses and restrictions contained in BCP 78, and
   except as set forth therein, the authors retain all their rights.


Acknowledgment

   Funding for the RFC Editor function is currently provided by the
   Internet Society.




Galbraith & Saarenmaa    Expires September 23, 2005            [Page 11]


