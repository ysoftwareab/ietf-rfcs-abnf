

   TSVWG                                                      S. Dudley 
   Internet Draft                                                Nortel 
   Expires: January 2, 2006                                   July 2005 
                                                                        
    
        Simulation of RT-ECN based Admission Control and Preemption 
                   draft-dudley-rtecn-simulation-00.txt 
    
Status of this Memo 
    
   By submitting this Internet-Draft, each author represents that any 
   applicable patent or other IPR claims of which he or she is aware 
   have been or will be disclosed, and any of which he or she becomes 
   aware will be disclosed, in accordance with Section 6 of BCP 79. 
    
   Internet-Drafts are working documents of the Internet Engineering 
   Task Force (IETF), its areas, and its working groups.  Note that 
   other groups may also distribute working documents as Internet- 
   Drafts. 
    
   Internet-Drafts are draft documents valid for a maximum of six months 
   and may be updated, replaced, or obsoleted by other documents at any 
   time.  It is inappropriate to use Internet-Drafts as reference 
   material or to cite them other than as "work in progress." 
    
   The list of current Internet-Drafts can be accessed at 
   http://www.ietf.org/ietf/1id-abstracts.txt. 
    
   The list of Internet-Draft Shadow Directories can be accessed at 
   http://www.ietf.org/shadow.html. 
    
   This Internet-Draft will expire on January 12, 2006. 
    
Copyright Notice 
    
   Copyright (C) The Internet Society (2005). 
    
    
    
Abstract 
    
   This document summarizes simulation results obtained from studies of 
   a measurement based admission control and preemption scheme using 
   Real-Time ECN semantics for SIP voice session setup.  
    
    
Conventions used in this document 
    
   Some acronyms are used in this document for brevity and may refer to 
   general concepts.   
 
 
Dudley                Expires - January 2, 2006              [Page 1] 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   SAC    (Session Admission Control) may refer to either Admission 
           Control, Preemption or both as required by the text 
   TDM    (Time Division Multiplexing) refers to traditional Voice 
           Switching networks 
   ECN    (Explicit Congestion Notification) refers to either the 
           concept of explicit congestion notification or to the bit 
           field identified for use with Explicit Congestion Control 
           per RFC 3168. 
   RT     (Real Time) refers to either Real-Time services or 
           applications. 
    
Table of Contents 
    
   1. Introduction...................................................2 
      1.1 Motivation.................................................2 
      1.2 Approach...................................................3 
   2. Notes on Token Bucket Modifications............................5 
   3. Simulation Setup...............................................7 
   4. Qualitative Performance........................................8 
      4.1 Admission Control- Qualitative Analysis....................8 
      4.2 Preemption - Qualitative Analysis..........................9 
   5. Quantitative Performance......................................11 
      5.1 Admission Control - Quantitative Analysis.................12 
      5.2 Preemption - Quantitative Analysis........................14 
      5.3 Impact of Multiple Application Managers...................16 
   6. Conclusions...................................................18 
   Security Considerations..........................................19 
   References.......................................................19 
   Intellectual Property Statement........Error! Bookmark not defined. 
   Disclaimer of Validity.................Error! Bookmark not defined. 
   Copyright Statement..............................................20 
   Acknowledgments..................................................20 
   Author's Addresses...............................................20 
    
    
1.   Introduction 
    
   This report summarizes simulations carried out on measurement based 
   admission control and preemption based on Real-Time ECN semantics. 
    
1.1    Motivation 
    
   The investigation of admission control and preemption mechanisms is 
   part of an effort to look at ways of managing session bandwidth on IP 
   networks.  The need to manage bandwidth may come either from a need 
   to protect the network from traffic surges, re-route events, etc., or 
   it may come from a need to prioritize session traffic on links of 
   limited capacity.  Real-Time ECN semantics have the advantage of 
   taking action at the endpoints, rather than inside the network and so 
   can avoid the need to track flows within the network.  The general 
 
Dudley                  Expires - January 2006                [Page 2] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   approach also provides a wide latitude in choice of semantics that 
   can permit independent action by endpoints or application managers at 
   the edge of the network.  Simulations were carried out to take a more 
   detailed look at the capabilities, and issues, that would arise from 
   this approach.   
    
   One motivation for looking at admission control and preemption is the 
   need to provide preferential treatment to some sessions on the 
   network.  Examples of networks where multiple precedence levels exist 
   could include the U.S. Department of Defense DSN network which has 5 
   levels of precedence but could also include, under special 
   circumstances, the existing TDM voice network where some endpoints 
   are sometimes given special treatment.  For example, the current TDM 
   voice network, under periods of network stress or during emergency 
   conditions, provides preferential treatment for fire, medical and 
   emergency services endpoints.  Emergency services, such as the ones 
   listed above are deliberately wired to the switch in a way that 
   guarantees that they are the last to be dropped when load shedding is 
   needed, are the first to get service when a switch recovers from a 
   failure, and can get admitted to the network when all non emergency 
   callers are denied.  The transition from a TDM voice network to an 
   all VoIP network would currently involve losing these capabilities so 
   mechanisms which could provide an equivalent capability have value. 
    
1.2    Approach 
    
   The approach taken for Real-Time ECN is summarized below.  A more 
   detailed description of this approach can be found in “Congestion 
   Notification Process for Real-Time Traffic, draft-babiarz-tsvwg-
   rtecn-03”, Feb 2005i, and “RTP Payload Format for ECN Probing, draft-
   alexander-rtp-payload-for-ecn-probing”, May 2005ii.  The semantics of 
   the scheme are tailored for session based traffic such as is created 
   by SIP, and the simulations summarized here used SIP endpoints.   
    
   The basic notion of protecting the network is to ensure that the call 
   arrival rate never permanently swamps the call departure rate.  While 
   admission control affects the arrival rate, preemption affects 
   (increases) the departure rate.   
    
   Network devices meter traffic and, based on thresholds, signal their 
   level of congestion to the endpoints by setting bits in the ECN field 
   of RTP packets emitted by endpoints.  The endpoints react to that 
   signaling to either make independent admission control decisions, or 
   to notify an application manager that mediates the decision making 
   process for session preemption.  Decisions are made in a way that 
   guarantees that , traffic of lower precedence is denied or preempted 
   before traffic of higher precedence.   
    
   Admission control is based on having endpoints send small RTP packets 
   (probe packets) through the network during call setup.  Probe packets 
 
Dudley                  Expires - January 2006                [Page 3] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   use the same IP address and port number as the media packets which 
   would follow so the probing process was guaranteed to have the same 
   congestion conditions as the media which would follow.  The decision 
   to admit is made at the endpoint, based on rules coded into the 
   device. 
    
   The admission decision is based on session precedence and level of 
   congestion.  Two levels of congestion are defined.  Routine sessions 
   (i.e. the lowest precedence session and the most common kind of 
   session) call setup terminates with a network failure condition if 
   either Level 1 or Level 2 congestion is indicated on the link during 
   probing.  Higher precedence sessions terminate call setup if Level 2 
   congestion is detected and persists for at least 500 milliseconds.  
   If congestion clears before the 500 millisecond timer expires, the 
   session is admitted.  The 500 millisecond interval gives the network 
   some time to clear congestion via its preemption mechanisms.  There 
   is a trade-off in how long to wait for the network to clear before 
   making the final admission decision.  Since it is possible, even 
   though unlikely, that the congestion is caused entirely by high 
   precedence sessions, the session is denied at some point in time if 
   congestion does not clear. (i.e. The choice of a 500 millisecond 
   interval is somewhat arbitrary.) 
    
   Probing continues until the call is answered.  For routine calls, if 
   a Level 1 indication is received during that time, call setup 
   terminates with a network failure condition.  For high precedence 
   sessions, if a Level 2 indication is received during that time, it 
   follows the sequence of activities associated with preemption.  (i.e. 
   the high precedence session has already been granted admission to the 
   network and should only be removed when other sessions of the same 
   precedence are also being preempted.) 
    
   The preemption process begins with all of the endpoints whose traffic 
   traverses an affected link detecting Level 2 congestion.  If an 
   endpoint experiences congestion for a sufficiently long time, it 
   sends a NOTIFY message to an application manager that contains 
   contact information for both ends of the session.  The length of time 
   that it waits before sending a NOTIFY message is randomly selected 
   from within a range dependent on the precedence of the session.  Each 
   precedence level has a separate time range, separated by a minimum 
   length of time from other precedence ranges.  The deliberate 
   separation of notification intervals permits all sessions of a lower 
   precedence to have their notifications reach the application manager 
   before notifications coming from higher precedence sessions, thus 
   ensuring that all session of lower precedence will become targets of 
   preemption before sessions of higher precedence. 
    
   In the implementation used for these simulations, the first NOTIFY 
   results in the application manager preempting the session (i.e it 
   sends BYE messages to both endpoints) and then setting a timer (500 
 
Dudley                  Expires - January 2006                [Page 4] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   millisecond).  No other preemptions are attempted until the timer 
   expires.  During that interval, the application manager continues to 
   listen for congestion NOTIFY messages and builds a preemption list 
   from the messages.   
    
   The length of time that the application manager collects 
   notifications without between preemptions represents the expected 
   length of time it would take for the BYE message from the application 
   manager to reach endpoints, for them to stop sending media packets, 
   and for token buckets in the routers to decide whether the congestion 
   condition has changed.  For a large network, with longer transmission 
   delays, it may need to be longer than 500 milliseconds, and for a 
   small network it may be shorter. 
    
   If a single preemption is sufficient to bring the congested link back 
   below the threshold, all endpoints will begin receiving a new 
   congestion indication.  All endpoints that have sent a NOTIFY message 
   to the application manager send another NOTIFY message indicating 
   that congestion has cleared.  The application manager removes them 
   from the preemption list.   
    
   Approach Notes: 
   In selecting which network elements need to meter and mark the ECN 
   field, it was noted that not all links on a given network can be 
   congested.  Many, because of their relation to other links on the 
   network that always become congested first, can never become 
   congested.  The full benefits of the admission control and preemption 
   scheme can be realized by implementing the metering and marking 
   process on a subset of those routers. 
    
   Management of the admission control and preemption decision at the 
   edges allows multiple behavior systems to be established and co-
   exist.  The initial simulation work described here only looks at 
   voice sessions established using SIP.  Extension of this work to 
   include non-voice sessions (video conferencing) is underway.  Lessons 
   learned in this type of investigation will likely have merit in 
   looking at other kinds of session based traffic. 
    
    
2.   Notes on Token Bucket Modifications 
    
   For use in the metering process in the router, a token bucket 
   algorithm is common and has many benefits for use in this scenario.  
   It provides the benefit of ensuring that the average threshold rate 
   has been exceeded for a sufficient time to reliably declare that the 
   threshold has been exceeded.  When used with randomly arriving 
   packets it provides a very good random marking of a percentage of the 
   packets.  However, for non-randomly arriving packets, such as those 
   coming form Real-Time sources, the marking behavior is also non-

 
Dudley                  Expires - January 2006                [Page 5] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   random and cannot be guaranteed to mark fairly across sessions of 
   different precedence.   
    
   Part of the problem arises from the non-statistical nature of the 
   inter-packet arrival times in a real-time flow like voice.  Codecs 
   emit packets on a fixed interval to support the needs of a voice 
   application.  When two codecs are emitting packets at the same fixed 
   interval, the relative arrival time of the two packets is quite 
   likely to be the same from frame to frame.  This can cause a problem 
   with a system based on marking only when the bucket is empty.  If the 
   spacing between packets is large enough in one frame to cause the 
   bucket to fill slightly, and thus not mark the packet as experiencing 
   congestion, it is quite likely to be so in the frame that follows as 
   well.  This would mean that even though the average rate of all flows 
   exceeds the threshold, the particular flow that is lucky enough to 
   have a long interval between it and the previous packet will almost 
   always be marked as not experiencing congestion.  The more desirable 
   pattern is to start marking when a congestion condition is first 
   detected and then not stop marking until we are certain that the 
   condition has cleared. 
    
   The mechanism chosen to modify the token bucket involved creating a 
   two state marking process.  Starting from the un-congested condition, 
   no marking of packets is done.  When the token bucket is emptied for 
   the first time, marking of packets begins.  Marking of packets 
   continues until the token bucket fill level exceeds a defined 
   threshold.  At that time, the marking of packets stops, and the token 
   bucket reverts back to its original state.   
    
   The size of the token bucket, or alternatively its burst size, 
   determines how quickly the token bucket responds to changes in 
   throughput.  A small burst size responds quickly to changes, whereas 
   a large burst size requires a longer period of time to fill or empty.  
   In creating the two state device, it was noted during initial 
   simulations that if the burst size used for declaring the start of 
   marking and the burst size used for declaring the end of marking were 
   the same, that short burst sizes led to a risk of stopping the 
   marking process too early and large burst sizes led to the problem of 
   admitting more sessions before the endpoints start to receive 
   indication of congestion.   
    
   The solution to the issue was to make the burst size different for 
   detecting when to start marking than for detecting when to stop 
   marking.  A small burst size for detecting the start of marking and a 
   much larger burst size for detecting when to stop marking produced a 
   very stable system, capable of reacting quickly to rapid onset events 
   but yet not incorrectly declaring drops in throughput.  The mechanics 
   of how this was accomplished won’t be addressed in this report but 
   can be obtained by consulting with the author.   
    
 
Dudley                  Expires - January 2006                [Page 6] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
3.   Simulation Setup 
    
   The way that this simulation was undertaken was to take an existing 
   simulation program (OPNET Modeler) and to extend the behaviors of the 
   models available in it.  A router model was extended to be able to 
   meter traffic on its links and set ECN bits in packets traversing its 
   links.  A workstation model was extended to monitor ECN bits and to 
   simulate important elements of SIP message behaviors including: 
   INVITE, ACK, UPDATE, PRACK, CANCEL, BYE, and NOTIFY.  The INVITE and 
   non-INVITE Client and Server Transaction models as described in RFC 
   3261 and elements of the Pre-conditions model as described in RFC 
   3312 were also implemented.  The same workstation model was extended 
   in a different way to act as a Back to Back User Agent and as an 
   application manager to mediate preemption decisions.   
    
   The ECN metering process used by the router follows the 
   recommendations in “Congestion Notification Process for Real-Time 
   Traffic, draft-babiarz-tsvwg-rtecn-03”, Feb 2005.   
    
   The pre-conditions model as described in RFC 3312 was used as the 
   point of departure for the simulations.  However, it was not followed 
   exactly as described in RFC 3312 since the semantics there pertain to 
   RSVP.  At the point where RFC 3312 requires an indication of 
   permission to continue with call setup, the simulation triggers the 
   establishment of a flow of probe packets between the endpoints.  
   (More details about the probing process can be acquired from “RTP 
   Payload Format for ECN Probing, draft-alexander-rtp-payload-for-ecn-
   probing”, May 2005.)   
    
   ECN bit marking on the probe packets is used to detect the level of 
   congestion on the network, which is used by the endpoint to make the 
   decision to proceed or to terminate call setup i.e. to carry out 
   admission control.  After the call is established, the ECN markings 
   on RTP media packets are used to make preemption decisions. 
    
   The partition of functions was carried out as follows. 
   Who Meters Traffic        Selected Routers on the network 
   Detection of congestion:  metering of links using a modified token 
                             bucket algorithm.   
   Who is signaled:          SIP endpoints  
   How it is signaled:       ECN bits are set with values 0,1 or 2  
   What is signaled          Level 0 indicates no congestion, Level 1 
                             indicates a first level of congestion and 
                             Level 2 indicated a second level of 
                             congestion.  (No attempt was made to 
                             distinguish between ECN capable and not 
                             ECN capable flows or to mimic the exact 
                             bit patterns of RT-ECN) 


 
Dudley                  Expires - January 2006                [Page 7] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   Admit Action              Endpoints make the decision based on the 
                             precedence of their session as indicated 
                             in the Approach section 
   Preempt Action            Endpoints notify a Back to Back User Agent 
                             (B2BUA), which fills the role of the 
                             application manager described in the 
                             Approach section, if congestion still 
                             persists when an internal randomly 
                             selected timer expires .  The B2BUA 
                             maintains a preemption list and sends BYE 
                             messages to endpoints periodically (every 
                             500 milliseconds).   
    
    
4.   Qualitative Performance 
    
   Before examining the performance of the system from a numerical 
   perspective, it is instructive to have a look at some of the 
   qualitative response of the system 
    
4.1    Admission Control- Qualitative Analysis 
    
   The desired behavior of the admission control mechanisms is to deny 
   admission to routine or high precedence sessions whenever the 
   threshold for each is crossed on any link in the network, regardless 
   of where in the network this event occurs.  This was the observed 
   behavior of the simulation.  Getting the system to cross the second 
   threshold to test admission control of high precedence sessions, 
   however, proved to be difficult.  Even with very high call arrival 
   rates, the second level of congestion could only ever be reached if 
   the volume of high precedence traffic, by itself, was sufficient to 
   generate enough traffic to exceed the second threshold.   
    
   This is not to say that traffic levels never exceed the first 
   threshold.  There is some latency in the detection mechanism, both 
   coming from the token bucket filters, and from the latency of packet 
   traversal across the network that can allow more than one “extra” 
   call to be admitted above the Level 1 threshold.  The closer together 
   that calls arrive, i.e. the higher the instantaneous call arrival 
   rate, the more sessions can be admitted before the congestion 
   indication is acted on at the edges.  For routine calls, continuous 
   probing is very effective in reducing overshoot, even when call 
   arrival rates are very high.   
    
   After Level 1 ECN markings began to arrive at all endpoints, the 
   behavior of the system was to stop admitting routine calls.  As will 
   be seen in the Quantitative Performance section of this document, the 
   system was able to tolerate very high call arrival rates.  We have 
   not attempted to determine what call arrival rates are in line with a 
   mass calling event but the overall performance suggests that it is 
 
Dudley                  Expires - January 2006                [Page 8] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   likely possible to engineer for protection against any level of mass 
   calling event. 
    
   The desired behavior of the admission control mechanism is to be 
   insensitive to where in the network the congestion occurs, and to how 
   many congestion events are present in the network.  The results of 
   the simulation confirm this behavior.  Marking of Level 1 and Level 2 
   congestion states by routers in the network was established so that 
   an incoming packet marked at Level 2 congestion from a previous link 
   would not be re-marked to indicate a Level 1 congestion.  The 
   congestion indication received by the endpoint is always the worst 
   case congestion event anywhere in the network.   
    
4.2    Preemption - Qualitative Analysis 
    
   Since the preemption control point (Level 2 Congestion indication) is 
   higher than the Level 1 congestion point, the network is already 
   denying all routine sessions by the time that preemption is required.  
   At that point, the arrival rate of high precedence calls has to 
   exceed the departure rate of all calls in order to reach Level 2 
   congestion.  In the normal condition where high precedence calls are 
   a small percentage of total calls, that can be made highly unlikely 
   just by setting the Level 2 threshold far enough from the Level 1 
   threshold.  In the core of a network where this condition can be 
   reasonably expected to be true, preemption would only be necessary to 
   handle the case of traffic re-route after a link failure.  At the 
   edges of the network, it may be possible for a sudden surge to reach 
   a Level 2 congestion condition, and these are the cases that are 
   investigated in the Qualitative section that follows. 
    
   The desired behavior of the preemption process is to begin preempting 
   sessions when a specific threshold is reached in the network, to 
   remove only sessions that traverse the affected link, to always 
   remove sessions with a lower precedence before removing sessions of a 
   higher precedence and to stop removing sessions as soon as the 
   congestion level drops below the specified threshold.  The observed 
   results conform to all of the requirements except for the effects of 
   latency in the start and stop conditions. 
    
   The latency comes in part from the token bucket which must either 
   empty or fill a certain amount before beginning to change ECN 
   markings, and in part from the transmission delay on the network.  
   The overall result is that the performance of the system at high call 
   arrival rates in slightly different than at low call arrival rates.  
   The differences, however, are small as will be seen later..   
    
   For the Level 2 threshold, since the preemption control point (Level 
   2 threshold) is also the admission control point for high precedence 
   traffic, the latency leads to a condition where high precedence calls 
   can be admitted for a short time after the Level 2 threshold is 
 
Dudley                  Expires - January 2006                [Page 9] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   actually reached.  Continuous probing does not have a significant 
   impact on reducing the number of high precedence sessions admitted 
   after the threshold is crossed because the behavior for high 
   precedence sessions that receive a Level 2 congestion indication 
   during ringing is based on the strategy of waiting to see if other 
   routine sessions could be preempted to allow them to remain 
   connected. 
    
   The mediation of the preemption process through the application 
   manager resulted in a small increase in signaling load.  The increase 
   was kept small by to the randomization of the notification process.  
   This paced the delivery of NOTIFY messages.  Not only did this 
   prevent a sudden message surge but it also allowed the network to 
   clear itself from small amounts of congestion before most endpoints 
   needed to send a message. 
    
   The simulation involved both network architectures with a single 
   application manager managing the preemption process and architectures 
   with multiple independent application managers.  No coordination 
   between application managers was necessary to implement the 
   preemption process.  Results indicated that the network was protected 
   from oversubscription in all cases.  The only difference between 
   single application manager and multiple application managers occurred 
   at high call arrival rates where there was a small difference in the 
   number of sessions that were preempted for a single event.  Having 
   multiple application managers serving the same session, with one 
   application manager associated with one endpoint of the sessions and 
   a second application manager associated with the other endpoint, 
   appeared to have no adverse affects on the way that the preemption 
   mechanism worked.   
    



















 
Dudley                  Expires - January 2006               [Page 10] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
5.   Quantitative Performance 
    
   What follows is a summary of the results obtained through simulation.  
   The network used in this simulation was set up to accommodate both a 
   single application manager and multiple application managers.  The 
   diagram below illustrates the distances involved and the sites 
   selected.  At four of the sites (AK, WA, FL, DC) a bank of endpoints 
   was located.  The link chosen to be metered was the link between KS 
   and WA.  This selection is made not because we believe that the long 
   distance links are the ones likely to be congested.  We actually 
   believe that these are the least likely to be congested.  However, in 
   order to both get the long latencies and multiple spans of control on 
   a single link, it was simpler to use this link than any other. 
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      To view the chart please see pdf version of this memo  
     draft-dudley-rtecn-simulation-00.pdf 
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
   All of the links used in this simulation are Gigabit Ethernet links.  
   The decision to do this is based partly on being able to hold all 
   parameters as close as possible between simulations.  Overall delay 
   in the network is affected by both transmission delay, from the 
 
Dudley                  Expires - January 2006               [Page 11] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   distances involved, and serialization delay, from the time it takes 
   to send packets of a given size.  With all of the links being high 
   speed links, there is essentially no serialization delay.  The only 
   delay simulated is distance delay.   
    
   The thresholds for the link being metered were engineered to perform 
   admission control at about 8 calls per minute.  The surges applied to 
   the network were in the order of 240 calls per minute (4 calls per 
   second). Session Admission Control (SAC) illustrates admission 
   control or preemption cases, as noted. 
    
5.1    Admission Control - Quantitative Analysis 
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      To view the chart please see pdf version of this memo  
     draft-dudley-rtecn-simulation-00.pdf 
    
    
    
    
    
    
    
    
    
    
    
    
    
    
   Figure 1  Throughput Comparisons for 8 Calls per minute w/o SAC 10 
   Calls per Minute w/SAC 
    
   This chart illustrates the base functionality of the ECN based 
   Admission Control system.  The first run (purple trace) is performed 
   at 8 calls per minute without the Session Admission Control (SAC) 
   scheme (8cpm_noSAC).  The second run (blue trace) is performed at 10 
 
Dudley                  Expires - January 2006               [Page 12] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   calls per minute with the Admission Control point for Routine calls 
   (10cppm_SAC) at 1.755 Mbps (Ethernet Throughput) and the Preemption 
   threshold at 2.34 Mbps (Admit, Preempt).  The percentage of 
   precedence calls in this example is 1% for both runs.   
    
   The 10cpm_SAC run shows the traffic rising until it crosses the 
   admission control threshold.  At this point, new routine calls are 
   denied.  Since Precedence calls are such a small percentage of the 
   overall call mix, the throughput ceases to rise.  At some points, the 
   departure of calls from the system allow it to fall back below the 
   threshold for a while until a new routine call takes its place. 
    
     
    
    
    
    
    
    
    
    
    
    
    
    
      To view the chart please see pdf version of this memo  
     draft-dudley-rtecn-simulation-00.pdf 
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
   Figure 2  Throughput Comparisons for 240 Calls per minute w/o SAC 240 
   Calls per Minute w/SAC 
    
 
Dudley                  Expires - January 2006               [Page 13] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   This chart shows two runs at 240 Calls per minute.  One with SAC 
   (240cpm_SAC) and one without (240cpm_noSAC).  The Admission Control 
   threshold for Routine calls is 1.755 Mbps and the Preempt threshold 
   is 2.34 Mbps (Admit, Preempt).  Both runs are at 1% Precedence.   
    
   The network is configured to have a maximum of 800 calls connected.  
   The run without SAC demonstrates that the number of calls rises 
   continuously to reach that limit.  The run with SAC, however, is 
   limited at the Admission Control point.   
    
5.2    Preemption - Quantitative Analysis 
    
   In order to reach the 2nd level of congestion, it was necessary to 
   increase the arrival rate of high precedence traffic so that it 
   exceeds the second level threshold.  This was done by making 100% of 
   the traffic high precedence (called Precedence here).  This is not 
   the normal, or expected case, so it should be noted that the results 
   shown here do not represent any expected behavior is a real network.   
    
   The results shown here illustrate the behavior of the system if we 
   choose to drive it completely with higher precedence traffic.  It 
   doesn’t represent the expected behavior of the system but can be used 
   to illustrate the results of having a scenario where the admission 
   control point and the preemption point are at the same level.  i.e. 
   since high precedence traffic ignores the Level 1 threshold, and 
   these runs show only High Precedence traffic, the admission control 
   and preemption control points are the same. 
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      To view the chart please see pdf version of this memo  
     draft-dudley-rtecn-simulation-00.pdf 
    
    
    
    
    
    
 
Dudley                  Expires - January 2006               [Page 14] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
      To view the chart please see pdf version of this memo  
     draft-dudley-rtecn-simulation-00.pdf 
    
    
    
    
    
    
    
    
    
   Figure 3  Throughput Comparisons for Preemption at 10 cpm and 240 cpm 
    
   The two charts illustrate the preemption process in action to keep 
   the throughput (measured here in terms of numbers of sessions) at or 
   below the second level threshold point.  The chart at 10 calls per 
   minute (10 cpm) clearly show the impact of having two token bucket 
   burst sizes, one for making the decision to start marking, and one to 
   make the decision to stop marking.  The larger of the two burst sizes 
   is the decision to start marking so the excursions above the 
   threshold are larger than the excursions below the threshold.  The 
   second chart appears, at times, not to make it back to the threshold.  
   This is, in fact, an artifact of the charting process because the 
   shortest time visible on the chart is a 3 second window.  The maximum 
   value over the 3 second window was used as the reference point for 
   building the chart.  Because of the high call arrival rate, the link 
   throughput only stayed below the threshold momentarily. 
    
   A second item to note form the charts is that the excursions above 
   the threshold are higher for the 240 cpm case than for the 10 cpm 
   case.  This is a consequence of the latency in signaling the new 
   threshold level to the endpoints.  Of interest is the fact that even 
   though the second call arrival rate is more than an order of 
   magnitude higher than the first rate, the size of the excursions are 
 
Dudley                  Expires - January 2006               [Page 15] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   still small, indicating that the mechanism is quite robust to traffic 
   surges.  
    
5.3    Impact of Multiple Application Managers 
    
   In our simulations, the application manager was a Back to Back User 
   Agent (B2BUA) that was co-located with one of the SIP endpoints in 
   the single application manager cases, and with each of the endpoint 
   sites in the 4 application manager case..  The charts that follow 
   compare the two cases.  The reason for looking at the single 
   application manager and multiple application manager cases is to 
   examine whether the mechanism can scale to larger size networks. 
     
    
    
    
    
    
    
    
    
    
    
    
      To view the chart please see pdf version of this memo  
     draft-dudley-rtecn-simulation-00.pdf 
    
    
    
    
    
    
    
    
    
    
    
    
    
   Figure 4  Comparison of 1 and 4 B2BUA Networks at 10 Calls/Min, 1% 
   Precedence 
    
   The above chart illustrates the behavior of the single (1B_P01) and 
   four B2BUA (4B_P01) network cases when run at an arrival rate of 10 
   Calls/Minute.  At low call arrival rates, the performance of the 
   single application manager and multiple application manager cases is 
   identical.  The next chart looks at the higher call arrival rate of 
   240 calls/minute.  It should be noted that 240 calls/minute, with a 5 
   minute average hold time, would result in 1200 calls on a link.  
   Although this would not completely fill a Gigabit Ethernet link, it 
 
Dudley                  Expires - January 2006               [Page 16] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   is representative of the call levels that we might expect to see in a 
   very large network.  Remembering that the thresholds are set here not 
   for the case where we have engineered the link for 240 calls/minute 
   but where the link is engineered for 8 calls/minute. 
    
     
    
    
    
    
    
    
    
    
    
    
    
    
      To view the chart please see pdf version of this memo  
     draft-dudley-rtecn-simulation-00.pdf 
    
    
    
    
    
    
    
    
    
    
    
    
    
    
    
   Figure 5  Comparison of 1 and 4 B2BUA Networks at 240 Calls/Min, 1% 
   Precedence 
    
   In this case, the overall appearance of the plots are similar, with 
   one exception on the 4B2BUA case, which dips lower on one occasion 
   that the 1 B2BUA case.  Detailed analysis of the 4 B2BUA network 
   showed that each of the B2BUA is acting independently so although 
   each B2BUA is paced at 1 preemption per 500 milliseconds, the overall 
   result is that 4 preemptions will occur every 500 milliseconds if the 
   congestion event lasts long enough to incur multiple preemption 
   events. 
    
   In comparing this chart with the earlier chart illustrating the 10 
   call/minute scenario, we have kept the admission control and 
   preemption points identical and the average number of sessions is 
 
Dudley                  Expires - January 2006               [Page 17] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   slightly higher in this case.  Detailed analysis indicated that this 
   is caused partly by latency in the detection process.  With a higher 
   call arrival rate, a larger number of sessions might be admitted 
   between the time that the threshold is actually crossed at the 
   network router and that the router can react and new markings arrive 
   at the endpoints.   
    
6.   Conclusions 
    
   This summary of test results illustrated the behaviors of an 
   admission control and preemption scheme based on metering link 
   traffic at network devices and using the ECN field to signal 
   congestion information to the endpoints.  Taking action at the 
   endpoints was seen to be effective in limiting overall traffic 
   through the congested links.  Some of the accommodations in the 
   metering process and the endpoint behaviors that are required to make 
   this system work have been noted in this summary.  For admission 
   control, taking action at the endpoints themselves is very effective.  
   For preemption, the mediation of a application manager and deliberate 
   pacing of notifications to that server at the endpoints allows the 
   scheme to accommodate multiple levels of precedence.  Taking action 
   at the endpoints allows the scheme to operate without the requirement 
   to track flows at network devices.  The mechanics of the scheme 
   permit each endpoint to make independent admission control decisions.  
   The mechanics also permit independent preemption action to be taken 
   by multiple application managers so it is not necessary to track 
   congestion state of the entire network in a single application 
   manager either.   
    
   The range of behaviors possible with this general approach is quite 
   large.  This simulation only looked at voice sessions and one set of 
   behaviors that could be implemented for them.  Since action is taken 
   independently by each endpoint, it is feasible for a different set of 
   behaviors to be defined for different types of applications on the 
   same network.  These different sets of behaviors could co-exist 
   without harm to the network as long as they were based on the same 
   ECN semantics and they provided a reasonable guarantee of providing 
   admission control and preemption limits. 
    
   Work is currently underway to investigate the performance of RT-ECN 
   mechanism with video conferencing systems.  The variability of packet 
   size makes it feasible for natural variations in throughput to 
   occasionally reach a Level 2 threshold, which suggest that the 
   decision process in the endpoint for video traffic may need to be 
   slightly different than that needed for constant bit rate voice.   
    
    



 
Dudley                  Expires - January 2006               [Page 18] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
Security Considerations 
    
   The studies on which this summary is based did not consider security 
   impacts of implementing admission control and preemption schemes.  
    
    
References 
    
                     
   i Babiarz, J. et al, “Congestion Notification Process for Real-Time 
   Traffic, draft-babiarz-tsvwg-rtecn-03”, Feb 2005 
    
   ii Alexander, C., “RTP Payload Format for ECN Probing, draft-
   alexander-rtp-payload-for-ecn-probing”, May 2005 
    
    
    
    
   Intellectual Property Statement 
    
   The IETF takes no position regarding the validity or scope of any 
   Intellectual Property Rights or other rights that might be claimed to 
   pertain to the implementation or use of the technology described in 
   this document or the extent to which any license under such rights 
   might or might not be available; nor does it represent that it has 
   made any independent effort to identify any such rights.  Information 
   on the procedures with respect to rights in RFC documents can be 
   found in BCP 78 and BCP 79. 
    
   Copies of IPR disclosures made to the IETF Secretariat and any 
   assurances of licenses to be made available, or the result of an 
   attempt made to obtain a general license or permission for the use of 
   such proprietary rights by implementers or users of this 
   specification can be obtained from the IETF on-line IPR repository at 
   http://www.ietf.org/ipr. 
    
   The IETF invites any interested party to bring to its attention any 
   copyrights, patents or patent applications, or other proprietary 
   rights that may cover technology that may be required to implement 
   this standard.  Please address the information to the IETF at 
   ietf-ipr@ietf.org. 
    
    
   Disclaimer of Validity 
    
   This document and the information contained herein are provided on an 
   "AS IS" basis and THE CONTRIBUTOR, THE ORGANIZATION HE/SHE REPRESENTS 
   OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY AND THE INTERNET 
   ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES, EXPRESS OR IMPLIED, 

 
Dudley                  Expires - January 2006               [Page 19] 
 
         Simulation of RT-ECN based Admission Control and Preemption 
 
   INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF THE 
   INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED 
   WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE. 
    
    
Copyright Statement 
    
   Copyright (C) The Internet Society (2005).  This document is subject 
   to the rights, licenses and restrictions contained in BCP 78, and 
   except as set forth therein, the authors retain all their rights. 
    
    
Acknowledgments 
    
   Funding for the RFC Editor function is currently provided by the 
   Internet Society. 
    
    
Author's Addresses 
    
   Stephen Dudley 
   Nortel 
   4001 E. Chapel Hill Nelson Highway 
   P.O. Box 13010, ms 570-01-0V8 
   Research Triangle Park, NC 27709 
   Email: SMDudley@nortel.com 
     























 
Dudley                  Expires - January 2006               [Page 20] 
 
