<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Threshold Signatures in Elliptic Curves</title>
<meta content="Phillip Hallam-Baker" name="author">
<meta content="
       A Threshold signature scheme is described. The signatures created are computationally indistinguishable from those produced using the Ed25519 and Ed448 curves as specified in RFC8032 except in that they are non-deterministic. Threshold signatures are a form of digital signature whose creation requires two or more parties to interact but does not disclose the number or identities of the parties involved. 
       https://mailarchive.ietf.org/arch/browse/cfrg/ Discussion of this draft should take place on the CFRG mailing list (cfrg@irtf.org), which is archived at . 
    " name="description">
<meta content="xml2rfc 3.3.0" name="generator">
<meta content="Threshold Cryptography" name="keyword">
<meta content="Elliptic Curve" name="keyword">
<meta content="Threshold Signature" name="keyword">
<meta content="Digital Signature" name="keyword">
<meta content="draft-hallambaker-threshold-sigs-05" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.3.0
    Python 3.6.10
    appdirs 1.4.4
    ConfigArgParse 1.2.3
    google-i18n-address 2.4.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.2
    kitchen 1.2.6
    lxml 4.6.1
    pycountry 20.7.3
    pyflakes 2.2.0
    PyYAML 5.3.1
    requests 2.24.0
    setuptools 40.6.2
    six 1.15.0
-->
<link href="/tmp/draft-hallambaker-threshold-sigs-05-r88wm7tm.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Threshold Signatures in Elliptic Curves</td>
<td class="right">November 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Hallam-Baker</td>
<td class="center">Expires 6 May 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-hallambaker-threshold-sigs</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-11-02" class="published">2 November 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-05-06">6 May 2021</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">P. M. Hallam-Baker</div>
<div class="org">ThresholdSecrets.com</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Threshold Signatures in Elliptic Curves</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">A Threshold signature scheme is described. The signatures created are computationally indistinguishable from those produced using the Ed25519 and Ed448 curves as specified in RFC8032 except in that they are non-deterministic. Threshold signatures are a form of digital signature whose creation requires two or more parties to interact but does not disclose the number or identities of the parties involved.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2"><a href="http://whatever">https://mailarchive.ietf.org/arch/browse/cfrg/</a>Discussion of this draft should take place on the CFRG mailing list (cfrg@irtf.org), which is archived at .<a href="#section-abstract-2" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 6 May 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-applications" class="xref">Applications</a><a href="#section-toc.1-1.1.2.1.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.1.2.1.2.1">
                    <p id="section-toc.1-1.1.2.1.2.1.1" class="keepWithNext"><a href="#section-1.1.1" class="xref">1.1.1</a>.  <a href="#name-hsm-binding" class="xref">HSM Binding</a><a href="#section-toc.1-1.1.2.1.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.1.2.1.2.2">
                    <p id="section-toc.1-1.1.2.1.2.2.1" class="keepWithNext"><a href="#section-1.1.2" class="xref">1.1.2</a>.  <a href="#name-code-signing" class="xref">Code Signing</a><a href="#section-toc.1-1.1.2.1.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.1.2.1.2.3">
                    <p id="section-toc.1-1.1.2.1.2.3.1" class="keepWithNext"><a href="#section-1.1.3" class="xref">1.1.3</a>.  <a href="#name-signing-by-redundant-servic" class="xref">Signing by Redundant Services</a><a href="#section-toc.1-1.1.2.1.2.3.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-definitions" class="xref">Definitions</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-requirements-language" class="xref">Requirements Language</a><a href="#section-toc.1-1.2.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-defined-terms" class="xref">Defined Terms</a><a href="#section-toc.1-1.2.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-related-specifications" class="xref">Related Specifications</a><a href="#section-toc.1-1.2.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.2.2.4">
                <p id="section-toc.1-1.2.2.4.1"><a href="#section-2.4" class="xref">2.4</a>.  <a href="#name-implementation-status" class="xref">Implementation Status</a><a href="#section-toc.1-1.2.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-principles" class="xref">Principles</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-direct-shared-threshold-sig" class="xref">Direct shared threshold signature</a><a href="#section-toc.1-1.3.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-shamir-shared-threshold-sig" class="xref">Shamir shared threshold signature</a><a href="#section-toc.1-1.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-stateless-computation-of-fi" class="xref">Stateless computation of final share</a><a href="#section-toc.1-1.3.2.3.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="xref">3.3.1</a>.  <a href="#name-side-channel-resistance" class="xref">Side channel resistance</a><a href="#section-toc.1-1.3.2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-security-analysis" class="xref">Security Analysis</a><a href="#section-toc.1-1.3.2.4.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.3.2.4.2.1">
                    <p id="section-toc.1-1.3.2.4.2.1.1"><a href="#section-3.4.1" class="xref">3.4.1</a>.  <a href="#name-calculation-of-r-values" class="xref">Calculation of r values</a><a href="#section-toc.1-1.3.2.4.2.1.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.4.2.2">
                    <p id="section-toc.1-1.3.2.4.2.2.1"><a href="#section-3.4.2" class="xref">3.4.2</a>.  <a href="#name-replay-attack" class="xref">Replay Attack</a><a href="#section-toc.1-1.3.2.4.2.2.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.4.2.3">
                    <p id="section-toc.1-1.3.2.4.2.3.1"><a href="#section-3.4.3" class="xref">3.4.3</a>.  <a href="#name-malicious-contribution-atta" class="xref">Malicious Contribution Attack</a><a href="#section-toc.1-1.3.2.4.2.3.1" class="pilcrow">¶</a></p>
</li>
                  <li class="compact ulEmpty toc" id="section-toc.1-1.3.2.4.2.4">
                    <p id="section-toc.1-1.3.2.4.2.4.1"><a href="#section-3.4.4" class="xref">3.4.4</a>.  <a href="#name-rogue-key-attack" class="xref">Rogue Key Attack</a><a href="#section-toc.1-1.3.2.4.2.4.1" class="pilcrow">¶</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-ed2519-signature" class="xref">Ed2519 Signature</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-ed448-signature" class="xref">Ed448 Signature</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-test-vectors" class="xref">Test Vectors</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-direct-threshold-signature-" class="xref">Direct Threshold Signature Ed25519</a><a href="#section-toc.1-1.6.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-direct-threshold-signature-e" class="xref">Direct Threshold Signature Ed448</a><a href="#section-toc.1-1.6.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-shamir-threshold-signature-" class="xref">Shamir Threshold Signature Ed25519</a><a href="#section-toc.1-1.6.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-shamir-threshold-signature-e" class="xref">Shamir Threshold Signature Ed448</a><a href="#section-toc.1-1.6.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
<ul class="compact ulEmpty toc">
<li class="compact ulEmpty toc" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-rogue-key-attack-2" class="xref">Rogue Key attack</a><a href="#section-toc.1-1.7.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-disclosure-or-reuse-of-the-" class="xref">Disclosure or reuse of the value r</a><a href="#section-toc.1-1.7.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-resource-exhaustion-attack" class="xref">Resource exhaustion attack</a><a href="#section-toc.1-1.7.2.3.1" class="pilcrow">¶</a></p>
</li>
              <li class="compact ulEmpty toc" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-signature-uniqueness" class="xref">Signature Uniqueness</a><a href="#section-toc.1-1.7.2.4.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-10" class="xref">10</a>. <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="compact ulEmpty toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-11" class="xref">11</a>. <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="n-introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Threshold encryption and key generation provide compelling advantages over single private key approaches because splitting the private key permits the use of that key to be divided between two or more roles.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">All existing digital signatures allow the signer role to be divided between multiple parties by attaching multiple signatures to the signed document. This approach, known as multi-signatures, is distinguished from a threshold signature scheme in that the identity and roles of the individual signers is exposed. In a threshold signature scheme, the creation of a single signature requires the participation of multiple signers and the signature itself does not reveal the means by which it was constructed.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">Rather than considering multi-signatures or threshold signatures to be inherently superior, it is more useful to regard both as two points on a continuum of choices:<a href="#section-1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1-4">
        <dt id="section-1-4.1">Multi-signatures </dt>
        <dd style="margin-left: 1.5em" id="section-1-4.2">
          <p id="section-1-4.2.1">Multiple digital signatures on the same document. Multi-signatures are simple to create and provide the verifier with more information but require the acceptance criteria to be specified independently of the signature itself. This requires that the application logic or PKI provide some means of describing the criteria to be applied.<a href="#section-1-4.2.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-4.3">Multi-party key release</dt>
        <dd style="margin-left: 1.5em" id="section-1-4.4">
          <p id="section-1-4.4.1">A single signature created using a single private key stored in an encrypted form whose use requires participation of multiple key decryption shares.<a href="#section-1-4.4.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-4.5">Threshold signatures </dt>
        <dd style="margin-left: 1.5em" id="section-1-4.6">
          <p id="section-1-4.6.1">A single signature created using multiple signature key shares. Signature creation may be subject to complex criteria such as requiring an (n,t) quorum of signers but these criteria are fixed at the time the signature is created<a href="#section-1-4.6.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
<dt id="section-1-4.7">Aggregate Signatures </dt>
        <dd style="margin-left: 1.5em" id="section-1-4.8">
          <p id="section-1-4.8.1">A single signature created using multiple signature key shares such that validation of the aggregate signature serves to validate the participation of each of the individual signers.<a href="#section-1-4.8.1" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-1-5">This document builds on the approach described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span> to define a scheme that creates threshold signatures that are computationally indistinguishable from those produced according to the algorithm specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. The scheme does not support the creation of aggregate signatures.<a href="#section-1-5" class="pilcrow">¶</a></p>
<p id="section-1-6">The approach used is based on that developed in FROST <span>[<a href="#Komlo" class="xref">Komlo</a>]</span>. This document describes the signature scheme itself. The techniques used to generate keys are described separately in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>.<a href="#section-1-6" class="pilcrow">¶</a></p>
<p id="section-1-7">As in the base document, we first describe signature generation for the case that <em>n</em> = <em>t</em> using 'direct' coefficients, that is the secret scalar is the sum of the secret shares. We then show how the scheme is modified using Shamir secret sharing <span>[<a href="#Shamir79" class="xref">Shamir79</a>]</span> and Lagrange coefficients for the case that <em>n</em> &gt; <em>t</em>.<a href="#section-1-7" class="pilcrow">¶</a></p>
<div id="n-applications">
<section id="section-1.1">
        <h3 id="name-applications">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-applications" class="section-name selfRef">Applications</a>
        </h3>
<p id="section-1.1-1">Threshold signatures have application in any situation where it is desired to have finer grain control of signing operations without this control structure being visible to external applications. It is of particular interest in situations where legacy applications do not support multi-signatures.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<div id="n-hsm-binding">
<section id="section-1.1.1">
          <h4 id="name-hsm-binding">
<a href="#section-1.1.1" class="section-number selfRef">1.1.1. </a><a href="#name-hsm-binding" class="section-name selfRef">HSM Binding</a>
          </h4>
<p id="section-1.1.1-1">Hardware Security Modules (HSMs) prevent accidental disclosures of signature keys by binding private keys to a hardware device from which it cannot be extracted without substantial effort. This provides effective mitigation of the chief causes of key disclosure but requires the signer to rely on the trustworthiness of a device that represents a black box they have no means of auditing.<a href="#section-1.1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1.1-2">Threshold signatures allow the signer to take advantage of the key binding control provided by an HSM without trusting it. The HSM only contributes one of the key shares used to create the signature. The other is provided by the application code (or possibly an additional HSM).<a href="#section-1.1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-code-signing">
<section id="section-1.1.2">
          <h4 id="name-code-signing">
<a href="#section-1.1.2" class="section-number selfRef">1.1.2. </a><a href="#name-code-signing" class="section-name selfRef">Code Signing</a>
          </h4>
<p id="section-1.1.2-1">Code signing is an important security control used to enable rapid detection of malware by demonstrating the source of authorized code distributions but places a critical reliance on the security of the signer's private key. Inadvertent disclosure of code signing keys is commonplace as they are typically stored in a form that allows them to be used in automatic build processes. Popular source code repositories are regularly scanned by attackers seeking to discover private signature keys and passwords embedded in scripts.<a href="#section-1.1.2-1" class="pilcrow">¶</a></p>
<p id="section-1.1.2-2">Threshold signatures allow the code signing operation to be divided between a developer key and an HSM held locally or by a signature service. The threshold shares required to create the signature can be mapped onto the process roles and personnel responsible for authorizing code release. This last concern might be of particular advantage in open source projects where the concentration of control embodied in a single code signing key has proved to be difficult to reconcile with community principles.<a href="#section-1.1.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-signing-by-redundant-services">
<section id="section-1.1.3">
          <h4 id="name-signing-by-redundant-servic">
<a href="#section-1.1.3" class="section-number selfRef">1.1.3. </a><a href="#name-signing-by-redundant-servic" class="section-name selfRef">Signing by Redundant Services</a>
          </h4>
<p id="section-1.1.3-1">Redundancy is as desirable for trusted services as for any other service. But in the case that multiple hosts are tasked with compiling a data set and signing the result, there is a risk of different hosts obtaining a different view of the data set due to timing or other concerns. This presents the risk of the hosts signing inconsistent views of the data set.<a href="#section-1.1.3-1" class="pilcrow">¶</a></p>
<p id="section-1.1.3-2">Use of threshold signatures allows the criteria for agreeing on the data set to be signed to be mapped directly onto the requirement for creating a signature. So if there are three hosts and two must agree to create a signature, three signature shares are created and with a threshold of two.<a href="#section-1.1.3-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-definitions">
<section id="section-2">
      <h2 id="name-definitions">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-definitions" class="section-name selfRef">Definitions</a>
      </h2>
<p id="section-2-1">This section presents the related specifications and standard, the terms that are used as terms of art within the documents and the terms used as requirements language.<a href="#section-2-1" class="pilcrow">¶</a></p>
<div id="n-requirements-language">
<section id="section-2.1">
        <h3 id="name-requirements-language">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-requirements-language" class="section-name selfRef">Requirements Language</a>
        </h3>
<p id="section-2.1-1">The key words "<span class="bcp14">MUST</span>", "<span class="bcp14">MUST NOT</span>", "<span class="bcp14">REQUIRED</span>", "<span class="bcp14">SHALL</span>", "<span class="bcp14">SHALL NOT</span>", "<span class="bcp14">SHOULD</span>", "<span class="bcp14">SHOULD NOT</span>", "<span class="bcp14">RECOMMENDED</span>", "<span class="bcp14">MAY</span>", and "<span class="bcp14">OPTIONAL</span>" in this document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-defined-terms">
<section id="section-2.2">
        <h3 id="name-defined-terms">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-defined-terms" class="section-name selfRef">Defined Terms</a>
        </h3>
<p id="section-2.2-1">See  <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-related-specifications">
<section id="section-2.3">
        <h3 id="name-related-specifications">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-related-specifications" class="section-name selfRef">Related Specifications</a>
        </h3>
<p id="section-2.3-1">This document extends the approach described in  <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span> to support threshold signatures. The deterministic mechanism described in specification <span>[<a href="#draft-hallambaker-mesh-udf" class="xref">draft-hallambaker-mesh-udf</a>]</span> is used to generate the private keys used in the test vectors.<a href="#section-2.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-implementation-status">
<section id="section-2.4">
        <h3 id="name-implementation-status">
<a href="#section-2.4" class="section-number selfRef">2.4. </a><a href="#name-implementation-status" class="section-name selfRef">Implementation Status</a>
        </h3>
<p id="section-2.4-1">The implementation status of the reference code base is described in the companion document <span>[<a href="#draft-hallambaker-mesh-developer" class="xref">draft-hallambaker-mesh-developer</a>]</span>.<a href="#section-2.4-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-principles">
<section id="section-3">
      <h2 id="name-principles">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-principles" class="section-name selfRef">Principles</a>
      </h2>
<p id="section-3-1">The threshold signatures created according to the algorithms described in this document are compatible with but not identical to the signatures created according to the scheme described in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. In particular:<a href="#section-3-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-2.1">The signature verification algorithm is unchanged.<a href="#section-3-2.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.2">The unanimous threshold scheme produces values of <em>R</em> and <em>S</em> that are deterministic but different from the values that would be obtained by using the aggregate private key to sign the same document.<a href="#section-3-2.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.3">The deterministic quorate threshold scheme produces values of <em>R</em> and <em>S</em> that are deterministic for a given set of signers but will change for a different set of signers or if the aggregate private key was used to sign the same document.<a href="#section-3-2.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-2.4">?The non-deterministic quorate threshold scheme produces values of <em>R</em> and <em>S</em> that will be different each time the document is signed.<a href="#section-3-2.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-3">Recall that a digital signature as specified by <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> consists of a pair of values <em>S</em>, <em>R</em> calculated as follows:<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4"><em>R</em> = <em>r.B</em><a href="#section-3-4" class="pilcrow">¶</a></p>
<p id="section-3-5">S = <em>r</em> + <em>k.s</em> mod <em>L</em><a href="#section-3-5" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-6">
        <dt id="section-3-6.1">Where </dt>
        <dd style="margin-left: 1.5em" id="section-3-6.2">
          <p id="section-3-6.2.1"><em>B</em> is the base point of the elliptic curve.<a href="#section-3-6.2.1" class="pilcrow">¶</a></p>
<p id="section-3-6.2.2"><em>r</em> is an unique, unpredictable integer value such that 0  r  L<a href="#section-3-6.2.2" class="pilcrow">¶</a></p>
<p id="section-3-6.2.3"><em>k</em> is the result of applying a message digest function determined by the curve (Ed25519, Ed448) to a set of parameters known to the verifier which include the values <em>R</em>, <em>A</em> and PH(<em>M</em>).<a href="#section-3-6.2.3" class="pilcrow">¶</a></p>
<p id="section-3-6.2.4"><em>A</em> is the public key of the signer, <em>A</em> = <em>s.B</em><a href="#section-3-6.2.4" class="pilcrow">¶</a></p>
<p id="section-3-6.2.5">PH(<em>M</em>) is the prehash function of the message value.<a href="#section-3-6.2.5" class="pilcrow">¶</a></p>
<p id="section-3-6.2.6"><em>s</em> is the secret scalar value<a href="#section-3-6.2.6" class="pilcrow">¶</a></p>
<p id="section-3-6.2.7"><em>L</em> is the order of the elliptic curve group.<a href="#section-3-6.2.7" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-7">To verify the signature, the verifier checks that:<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8"><em>S.B</em> = <em>R</em> + <em>k.A</em><a href="#section-3-8" class="pilcrow">¶</a></p>
<p id="section-3-9">This equality must hold for a valid signature since:<a href="#section-3-9" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3-10">
        <dt id="section-3-10.1"><em>S.B </em></dt>
        <dd style="margin-left: 1.5em" id="section-3-10.2">
          <p id="section-3-10.2.1">= (<em>r</em> + <em>k.s</em>).<em>B</em><a href="#section-3-10.2.1" class="pilcrow">¶</a></p>
<p id="section-3-10.2.2">= <em>r.B</em> +<em>k</em>.(<em>s.B</em>)<a href="#section-3-10.2.2" class="pilcrow">¶</a></p>
<p id="section-3-10.2.3">= <em>R</em> + <em>k.A</em><a href="#section-3-10.2.3" class="pilcrow">¶</a></p>
</dd>
      <dd class="break"></dd>
</dl>
<p id="section-3-11">The value <em>r</em> plays a critical role in the signature scheme as it serves to prevent disclosure of the secret scalar. If the value <em>r</em> is known, <em>s</em> can be calculated as <em>s</em> = (<em>S-r</em>).<em>k</em><sup>-1</sup> mod <em>L</em>. It is therefore essential that the value <em>r</em> be unguessable.<a href="#section-3-11" class="pilcrow">¶</a></p>
<p id="section-3-12">Furthermore, if the same value of <em>r</em> is used to sign two different documents, this results two signatures with the same value <em>R</em> and different values of <em>k</em> and <em>S</em>. Thus<a href="#section-3-12" class="pilcrow">¶</a></p>
<p id="section-3-13"><em>S<sub>1</sub></em> = <em>r</em> + <em>k<sub>1</sub></em>.<em>s</em> mod <em>L</em><a href="#section-3-13" class="pilcrow">¶</a></p>
<p id="section-3-14">S<sub>2</sub> = <em>r</em> + <em>k<sub>2</sub>.s mod L</em><a href="#section-3-14" class="pilcrow">¶</a></p>
<p id="section-3-15">s = (<em>S<sub>1</sub></em> - <em>S<sub>2</sub></em>)(<em>k<sub>1</sub></em> - <em>k<sub>2</sub></em>)<sup>-1</sup> mod <em>L</em><a href="#section-3-15" class="pilcrow">¶</a></p>
<p id="section-3-16">The method of constructing <em>r</em> <span class="bcp14">MUST</span> ensure that it is unique and unguessable.<a href="#section-3-16" class="pilcrow">¶</a></p>
<div id="n-direct-shared-threshold-signature">
<section id="section-3.1">
        <h3 id="name-direct-shared-threshold-sig">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-direct-shared-threshold-sig" class="section-name selfRef">Direct shared threshold signature</a>
        </h3>
<p id="section-3.1-1">A threshold signature R, S is constructed by summing a set of signature contributions from two or more signers. For the case that the composite private key is the sum of the key shares (<em>n</em> = <em>t</em>), each signer <em>i</em> provides a contribution as follows:<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">A<sub>i</sub> = s<sub>i</sub>.B<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">R<sub>i</sub> = r<sub>i</sub>.B<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">S<sub>i</sub> = r<sub>i</sub> + k.s<sub>i</sub> mod L<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5">Where s<sub>i</sub> and r<sub>i</sub> are the secret scalar and unguessable value for the individual signer.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<p id="section-3.1-6">The contributions of signers {1, 2, ... n} are then combined as follows:<a href="#section-3.1-6" class="pilcrow">¶</a></p>
<p id="section-3.1-7">R = R<sub>1</sub> + R<sub>2</sub> + ... + R<sub>n</sub><a href="#section-3.1-7" class="pilcrow">¶</a></p>
<p id="section-3.1-8">S = S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub><a href="#section-3.1-8" class="pilcrow">¶</a></p>
<p id="section-3.1-9">A = s.B<a href="#section-3.1-9" class="pilcrow">¶</a></p>
<p id="section-3.1-10">Where s =  (s<sub>1</sub> + s<sub>2</sub> + ... + s<sub>n</sub>) mod L<a href="#section-3.1-10" class="pilcrow">¶</a></p>
<p id="section-3.1-11">The threshold signature is verified in the same manner as before:<a href="#section-3.1-11" class="pilcrow">¶</a></p>
<p id="section-3.1-12">S.B = R + k.A<a href="#section-3.1-12" class="pilcrow">¶</a></p>
<p id="section-3.1-13">Substituting for S.B we get:<a href="#section-3.1-13" class="pilcrow">¶</a></p>
<p id="section-3.1-14">= (S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub>).B<a href="#section-3.1-14" class="pilcrow">¶</a></p>
<p id="section-3.1-15">= S<sub>1</sub>.B + S<sub>2</sub>.B + ... + S<sub>n</sub>.B<a href="#section-3.1-15" class="pilcrow">¶</a></p>
<p id="section-3.1-16">= (r<sub>1</sub> + k.s<sub>1</sub>).B + (r<sub>2</sub> + k.s<sub>2</sub>).B + ... + (r<sub>n</sub> + k.s<sub>n</sub>).B<a href="#section-3.1-16" class="pilcrow">¶</a></p>
<p id="section-3.1-17">= (r<sub>1</sub>.B + k.s<sub>1</sub>.B) + (r<sub>2</sub>.B + k.s<sub>2</sub>.B) + ... + (r<sub>n</sub>.B + k.s<sub>n</sub>.B)<a href="#section-3.1-17" class="pilcrow">¶</a></p>
<p id="section-3.1-18">= (R1 + k.A1) + (R1 + k.A1) + ... + (Rn + k.An)<a href="#section-3.1-18" class="pilcrow">¶</a></p>
<p id="section-3.1-19">Substituting for R + k.A we get:<a href="#section-3.1-19" class="pilcrow">¶</a></p>
<p id="section-3.1-20">= R<sub>1</sub> + R<sub>2</sub> + ... + R<sub>n</sub> + k.(A<sub>1</sub> + A<sub>2</sub> + ... + A<sub>n</sub>)<a href="#section-3.1-20" class="pilcrow">¶</a></p>
<p id="section-3.1-21">= R<sub>1</sub> + R<sub>2</sub> + ... + R<sub>n</sub> + k.A<sub>1</sub> + k.A<sub>2</sub> + ... + k.A<sub>n</sub><a href="#section-3.1-21" class="pilcrow">¶</a></p>
<p id="section-3.1-22">= (R<sub>1</sub> + k.A<sub>1</sub>) + (R<sub>1</sub> + k.A<sub>1</sub>) + ... + (R<sub>n</sub> + k.A<sub>n</sub>)<a href="#section-3.1-22" class="pilcrow">¶</a></p>
<p id="section-3.1-23">As expected, the operation of threshold signature makes use of the same approach as threshold key generation and threshold decryption as described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>. As with threshold decryption it is not necessary for each key share holder to have a public key corresponding to their key share. All that is required is that the sum of the secret scalar values used in calculation of the signature modulo the group order be the value of the aggregate secret scalar corresponding to the aggregate secret key.<a href="#section-3.1-23" class="pilcrow">¶</a></p>
<p id="section-3.1-24">While verification of <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> signatures is unchanged, the use of threshold signatures requires a different approach to signing. In particular, the fact that the value k is bound to the value R means that the participants in the threshold signature scheme must agree on the value R before the value k can be calculated. Since k is required to calculate the signature contributions S<sub>i</sub> can be calculated, it is thus necessary to calculate the values R<sub>i</sub> and S<sub>i</sub> in separate phases. The process of using a threshold signature to sign a document thus has the following stages orchestrated by a dealer  as follows:<a href="#section-3.1-24" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal type-1" id="section-3.1-25">
<li id="section-3.1-25.1">The dealer determines the values F, C and PH(M) as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> and transmits them to the signers {1, 2, ... n}.<a href="#section-3.1-25.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-25.2">Each signer generates a random value r<sub>i</sub> such that 1  r<sub>i</sub>  L, calculates the value R<sub>i</sub> = r<sub>i</sub>.B and returns R to the dealer .<a href="#section-3.1-25.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-25.3">The dealer calculates the value R = R<sub>1</sub> + R<sub>2</sub> + ... + R<sub>n</sub> and transmits R and A to the signers {1, 2, ... n}.<a href="#section-3.1-25.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-25.4">Each signer uses the suppled data to determine the value k and hence S<sub>i</sub> = r<sub>i</sub> + k.s<sub>i</sub> mod L and transmits it to the dealer .<a href="#section-3.1-25.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.1-25.5">The dealer calculates the value S = S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub> and verifies that the resulting signature R, S verifies according to the mechanism specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span>. If the signature is correct, the dealer  publishes it. Otherwise, the dealer  <span class="bcp14">MAY</span> identify the signer(s) that provided incorrect contributions by verifying the values R<sub>i</sub> and S<sub>i</sub> for each.<a href="#section-3.1-25.5" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.1-26">For clarity, the dealer role is presented here as being implemented by a single party.<a href="#section-3.1-26" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-shamir-shared-threshold-signature">
<section id="section-3.2">
        <h3 id="name-shamir-shared-threshold-sig">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-shamir-shared-threshold-sig" class="section-name selfRef">Shamir shared threshold signature</a>
        </h3>
<p id="section-3.2-1">To construct a threshold signature using shares created using Shamir Secret Sharing, each private key value <em>s<sub>i</sub></em> is multiplied by the Lagrange coefficient <em>l<sub>i</sub></em> corresponding to the set of shares used to construct the signature:<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">A<sub>i</sub> = s<sub>i</sub>l<sub>i</sub>.B<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">R<sub>i</sub> = r<sub>i</sub>.B<a href="#section-3.2-3" class="pilcrow">¶</a></p>
<p id="section-3.2-4"><em>S<sub>i</sub> = ri + klisi mod L</em><a href="#section-3.2-4" class="pilcrow">¶</a></p>
<p id="section-3.2-5">It is convenient to combine the derivation of <em>S<sub>i</sub></em> for the additive and Shamir shared threshold signatures by introducing a key multiplier coefficient <em>c<sub>i</sub></em>:<a href="#section-3.2-5" class="pilcrow">¶</a></p>
<p id="section-3.2-6"><em>S<sub>i</sub> = ri + kcisi mod L</em><a href="#section-3.2-6" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-3.2-7">
          <dt id="section-3.2-7.1">Where</dt>
          <dd style="margin-left: 1.5em" id="section-3.2-7.2">
            <p id="section-3.2-7.2.1"><em>c<sub>i</sub></em> = 1 for the additive shared threshold signature<a href="#section-3.2-7.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2-7.2.2"><em>c<sub>i</sub></em> = <em>l<sub>i</sub></em> for the Shamir shared threshold signature<a href="#section-3.2-7.2.2" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="n-stateless-computation-of-final-share">
<section id="section-3.3">
        <h3 id="name-stateless-computation-of-fi">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-stateless-computation-of-fi" class="section-name selfRef">Stateless computation of final share</a>
        </h3>
<p id="section-3.3-1">One of the chief drawbacks to the algorithm described above is that it requires signers to perform two steps with state carried over from the first to the second to avoid reuse of the value <em>r<sub>i</sub></em>. This raises particular concern for implementations such as signature services or HSMs where maintaining state imposes a significant cost.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">Fortunately, it is possible to modify the algorithm so that the final signer does not need to maintain state between steps:<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal type-1" id="section-3.3-3">
<li id="section-3.3-3.1">All the signers except the final signer <em>F</em> generate their value <em>r<sub>i</sub></em> and submit the corresponding value <em>R<sub>i</sub></em> to the dealer<a href="#section-3.3-3.1" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.2">Dealer calculates the value <em>R</em> - <em>R<sub>F</sub></em> and sends it to the final signer together with the all the other parameters required to calculate <em>k</em> and the  final signer's key multiplier coefficient <em>c<sub>F</sub></em>.<a href="#section-3.3-3.2" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.3">The final signer generates its value <em>r<sub>F</sub></em><a href="#section-3.3-3.3" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.4">The final signer calculates the value <em>R<sub>F</sub></em> from which the values <em>R</em> and <em>k</em> can now be determined.<a href="#section-3.3-3.4" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.5">The final signer calculates its key share contribution <em>S<sub>F</sub> = rF + kcFsF mod L.</em><a href="#section-3.3-3.5" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.6">The final signer returns the values <em>S<sub>F</sub></em> and <em>R</em> to the dealer.<a href="#section-3.3-3.6" class="pilcrow">¶</a>
</li>
          <li id="section-3.3-3.7">The dealer reports the value R to the other signers and continues the signature process as before.<a href="#section-3.3-3.7" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-3.3-4">While this approach to stateless computation of the signature contributions is limited to the final share, this is sufficient to cover the overwhelming majority of real-world applications where <em>n</em> = <em>t</em> = 2.<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">Note that the final signer <span class="bcp14">MAY</span> calculate its value <em>r<sub>F</sub></em> deterministically provided that the parameters <em>R</em> - <em>R<sub>F</sub></em> and <em>c<sub>F</sub></em> are used in its determination. Other signers <span class="bcp14">MUST NOT</span> use a deterministic means of generating their value <em>r<sub>i</sub></em> since the information known to them at the time this parameter is generated is not sufficient to fix the value of <em>R</em>.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
<div id="n-side-channel-resistance">
<section id="section-3.3.1">
          <h4 id="name-side-channel-resistance">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-side-channel-resistance" class="section-name selfRef">Side channel resistance</a>
          </h4>
<p id="section-3.3.1-1">The use of Kocher side channel resistance as described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span> entails randomly splitting the private key into two shares and performing the private key operation separately on each share to avoid repeated operations using the same private key value at the cost of performing each operation twice.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2">This additional overhead <span class="bcp14">MAY</span> be eliminated when threshold approaches are used by applying blinding factors whose sum is zero to each of the threshold shares.<a href="#section-3.3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-3">For example, if generation of the threshold signature is divided between an application program A and an HSM B using the final share approach to avoid maintaining state in the HSM, we might generate a blinding factor thus:<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal type-1" id="section-3.3.1-4">
<li id="section-3.3.1-4.1">A generates a random nonce <em>n<sub>A</sub></em> and sends it to B with the other parameters required to generate the signature.<a href="#section-3.3.1-4.1" class="pilcrow">¶</a>
</li>
            <li id="section-3.3.1-4.2">B generates a random nonce <em>n<sub>B</sub></em><a href="#section-3.3.1-4.2" class="pilcrow">¶</a>
</li>
            <li id="section-3.3.1-4.3">B calculates the blinding factor <em>x</em> by calculating <em>H</em>(<em>n<sub>A, </sub>nB) where H is a strong cryptographic digest function and converting the result to an integer in the range 1  x  L.</em><a href="#section-3.3.1-4.3" class="pilcrow">¶</a>
</li>
            <li id="section-3.3.1-4.4">B calculates the signature parameters as before except that the threshold signature contribution is now <em>S<sub>B</sub> = rB + k(cBsB + x) mod L.</em><a href="#section-3.3.1-4.4" class="pilcrow">¶</a>
</li>
            <li id="section-3.3.1-4.5">B returns the nonce <em>n<sub>B</sub></em> to A with the other parameters.<a href="#section-3.3.1-4.5" class="pilcrow">¶</a>
</li>
            <li id="section-3.3.1-4.6">A calculates the blinding factor <em>x</em> using the same approach as B<a href="#section-3.3.1-4.6" class="pilcrow">¶</a>
</li>
            <li id="section-3.3.1-4.7">A calculates the signature parameters as before except that the threshold signature contribution is now <em>S<sub>A</sub> = rA + k(cAsA - x) mod L.</em><a href="#section-3.3.1-4.7" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-3.3.1-5">This approach <span class="bcp14">MAY</span> be extended to the case that <em>t</em> &gt; 2 by substituting a Key Derivation Function (e.g. <span>[<a href="#RFC5860" class="xref">RFC5860</a>]</span>) for the digest function.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-security-analysis">
<section id="section-3.4">
        <h3 id="name-security-analysis">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-security-analysis" class="section-name selfRef">Security Analysis</a>
        </h3>
<p id="section-3.4-1">We consider a successful breach of the threshold signature scheme to be any attack that allows the attacker to create a valid signature for any message without the participation of the required threshold of signers.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">Potential breaches include:<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-3.1">Disclosure of the signature key or signature key share.<a href="#section-3.4-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-3.2">Modification of signature data relating to message M to allow creation of a signature for message M'.<a href="#section-3.4-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-3.3">Ability of one of the signers to choose the value of the aggregate public key.<a href="#section-3.4-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-3.4-3.4">Access control attacks inducing a signer to create a signature contribution that was not properly authenticated or authorized.<a href="#section-3.4-3.4" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-3.4-4">We regard attacks on the access control channel to be out of scope for the threshold signature algorithm, though they are certainly a concern for any system in which a threshold signature algorithm is employed.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4-5">We do not consider the ability of a signer to cause creation of an invalid signature to represent a breach.<a href="#section-3.4-5" class="pilcrow">¶</a></p>
<div id="rvalue">
<section id="section-3.4.1">
          <h4 id="name-calculation-of-r-values">
<a href="#section-3.4.1" class="section-number selfRef">3.4.1. </a><a href="#name-calculation-of-r-values" class="section-name selfRef">Calculation of r values</a>
          </h4>
<p id="section-3.4.1-1">The method of constructing the values <em>r<sub>i</sub></em> <span class="bcp14">MUST</span> ensure that each is unique and unguessable both to external parties, the signers and the dealer. The deterministic method specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> cannot be applied to generation of the values r<sub>i</sub> as it allows the dealer to cause signers to reveal their key shares by requesting multiple signature contributions for the same message but with different values of <em>k</em>. In particular, requesting signature contributions for the same message:<a href="#section-3.4.1-1" class="pilcrow">¶</a></p>
<p id="section-3.4.1-2">With different Lagrange coefficients.<a href="#section-3.4.1-2" class="pilcrow">¶</a></p>
<p id="section-3.4.1-3">With a false value of <em>R</em><a href="#section-3.4.1-3" class="pilcrow">¶</a></p>
<p id="section-3.4.1-4">To avoid these attacks, the value r<sub>i</sub> is generated using a secure random number generator. This approach requires the signer to ensure that values are never reused requiring that the signing API maintain state between the first and second rounds of the algorithm.<a href="#section-3.4.1-4" class="pilcrow">¶</a></p>
<p id="section-3.4.1-5">While there are many approaches to deterministic generation of r<sub>i</sub> that appear to be sound, closer inspection has demonstrated these to be vulnerable to rogue key and rogue contribution attacks.<a href="#section-3.4.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-replay-attack">
<section id="section-3.4.2">
          <h4 id="name-replay-attack">
<a href="#section-3.4.2" class="section-number selfRef">3.4.2. </a><a href="#name-replay-attack" class="section-name selfRef">Replay Attack</a>
          </h4>
<p id="section-3.4.2-1">The most serious concern in the implementation of any Schnorr type signature scheme is the need to ensure that the value r<sub>i</sub> is never revealed to any other party and is never used to create signatures for two different values of k.s<sub>i</sub>.<a href="#section-3.4.2-1" class="pilcrow">¶</a></p>
<p id="section-3.4.2-2">Ensuring this does not occur imposes significant design constraints as creating a correct signature contribution requires that the signer use the same value of r<sub>i</sub> to construct its value or R<sub>i</sub> and S<sub>i</sub>.<a href="#section-3.4.2-2" class="pilcrow">¶</a></p>
<p id="section-3.4.2-3">For example, a HSM device may be required to perform multiple signature operations simultaneously. Since the storage capabilities of an HSM device are typically constrained, it is tempting to attempt to avoid the need to track the value of r<sub>i</sub> within the device itself using an appropriately authenticated and encrypted opaque state token. Such mechanisms provide the HSM with the value of r<sub>i</sub> but do not and cannot provide protection against a replay attack in which the same state token is presented with a request to sign different values of k.<a href="#section-3.4.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-malicious-contribution-attack">
<section id="section-3.4.3">
          <h4 id="name-malicious-contribution-atta">
<a href="#section-3.4.3" class="section-number selfRef">3.4.3. </a><a href="#name-malicious-contribution-atta" class="section-name selfRef">Malicious Contribution Attack</a>
          </h4>
<p id="section-3.4.3-1">In a malicious contribution attack, one or more parties present a signature contribution that does not meet the criteria R<sub>i</sub> = r<sub>i</sub>.B and S<sub>i</sub> = r<sub>i</sub> + ks<sub>i</sub>.<a href="#section-3.4.3-1" class="pilcrow">¶</a></p>
<p id="section-3.4.3-2">Such an attack is not considered to be a breach as it merely causes the signature process to fail.<a href="#section-3.4.3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="roguekey">
<section id="section-3.4.4">
          <h4 id="name-rogue-key-attack">
<a href="#section-3.4.4" class="section-number selfRef">3.4.4. </a><a href="#name-rogue-key-attack" class="section-name selfRef">Rogue Key Attack</a>
          </h4>
<p id="section-3.4.4-1">A threshold signature scheme that allows the participants to 'bring their own key' may be vulnerable to a rogue key attack in which a signer is able to select the value of the aggregate public signature key by selecting a malicious public signature key value.<a href="#section-3.4.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4.4-2">The scheme described in this document is a threshold signature scheme and does not support this feature. Consequently, this attack is not relevant. It is described here for illustrative purposes only.<a href="#section-3.4.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4.4-3">This particular attack only applies when the individual signers create their own signature shares. It is not a concern when the signature shares are created by splitting a master signature private key.<a href="#section-3.4.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4.4-4">Consider the case where the aggregate public key signature is calculated from the sum of public signature key share values presented by the signers:<a href="#section-3.4.4-4" class="pilcrow">¶</a></p>
<p id="section-3.4.4-5">A = A<sub>1</sub> + A<sub>2</sub> + ... + A<sub>n</sub><a href="#section-3.4.4-5" class="pilcrow">¶</a></p>
<p id="section-3.4.4-6">If the public key values are presented in turn, the last signer presenting their key share can force the selection of any value of A that they choose by selecting A<sub>n</sub> = A<sub>m</sub> -  (A<sub>1</sub> + A<sub>2</sub> + ... + A<sub>n-1</sub>)<a href="#section-3.4.4-6" class="pilcrow">¶</a></p>
<p id="section-3.4.4-7">The attacker can thus gain control of the aggregate signature key by choosing A<sub>m</sub> = s<sub>m</sub>.B where s<sub>m</sub> is a secret scalar known only to the attacker. But does so at the cost of not knowing the value s<sub>n</sub> and so the signer cannot participate in the signature protocol.<a href="#section-3.4.4-7" class="pilcrow">¶</a></p>
<p id="section-3.4.4-8">This attack allows the attacker and the attacker alone to create signatures which are validated under the aggregate signature key.<a href="#section-3.4.4-8" class="pilcrow">¶</a></p>
<p id="section-3.4.4-9">The attack is a consequence of the mistaken assumption that a signature created under the signature key A<sub>1</sub> + A<sub>2</sub> + ... + A<sub>n</sub> provides evidence of the individual participation of the corresponding key holders without separate validation of the aggregate key.<a href="#section-3.4.4-9" class="pilcrow">¶</a></p>
<p id="section-3.4.4-10">Enabling the use of threshold signature techniques by ad-hoc groups of signers using their existing signature keys as signature key shares presents serious technical challenges that are outside the scope of this specification.<a href="#section-3.4.4-10" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="n-ed2519-signature">
<section id="section-4">
      <h2 id="name-ed2519-signature">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-ed2519-signature" class="section-name selfRef">Ed2519 Signature</a>
      </h2>
<p id="section-4-1">The means by which threshold shares are created is described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The dealer selects the signers who are to construct the signature. Each signer then computes the value R<sub>i</sub>:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal type-1" id="section-4-3">
<li id="section-4-3.1">Randomly generate an integer r<sub>i</sub> such that 1  r<sub>i</sub>  L.<a href="#section-4-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-4-3.2">Compute the point R<sub>i</sub> = r<sub>i</sub>B.  For efficiency, do this by first reducing r<sub>i</sub> modulo L, the group order of B.  Let the string R<sub>i</sub> be the encoding of this point.<a href="#section-4-3.2" class="pilcrow">¶</a>
</li>
        <li id="section-4-3.3">Transmit the value R<sub>i</sub> to the dealer<a href="#section-4-3.3" class="pilcrow">¶</a>
</li>
        <li id="section-4-3.4">At some later point, the dealer <span class="bcp14">MAY</span> complete the signature by returning the values F, C, A and R as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> together with the key multiplier coefficient c<sub>i</sub>. The signers <span class="bcp14">MAY</span> then complete their signature contributions:<a href="#section-4-3.4" class="pilcrow">¶</a>
</li>
        <li id="section-4-3.5">Compute SHA512(dom2(F, C) || R || A || PH(M)), and interpret the 64-octet digest as a little-endian integer k.<a href="#section-4-3.5" class="pilcrow">¶</a>
</li>
        <li id="section-4-3.6">Compute S<sub>i</sub> = (r<sub>i</sub> + kc<sub>i</sub>s<sub>i</sub>) mod L.  For efficiency, again reduce k modulo L first.<a href="#section-4-3.6" class="pilcrow">¶</a>
</li>
        <li id="section-4-3.7">Return the values R<sub>i</sub>, S<sub>i</sub> to the dealer .<a href="#section-4-3.7" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-4-4">The dealer then completes the signature by:<a href="#section-4-4" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal type-1" id="section-4-5">
<li id="section-4-5.1">Computing the composite value S = S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub><a href="#section-4-5.1" class="pilcrow">¶</a>
</li>
        <li id="section-4-5.2">Verifying that the signature R, S is valid.<a href="#section-4-5.2" class="pilcrow">¶</a>
</li>
        <li id="section-4-5.3">Publishing the signature.<a href="#section-4-5.3" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="n-ed448-signature">
<section id="section-5">
      <h2 id="name-ed448-signature">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-ed448-signature" class="section-name selfRef">Ed448 Signature</a>
      </h2>
<p id="section-5-1">The means by which threshold shares are created is described in <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span>.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">The dealer selects the signers who are to construct the signature. Each signer then computes the value R<sub>i</sub>:<a href="#section-5-2" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal type-1" id="section-5-3">
<li id="section-5-3.1">Randomly generate an integer r<sub>i</sub> such that 1  r<sub>i</sub>  L.<a href="#section-5-3.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-3.2">Compute the point R<sub>i</sub> = r<sub>i</sub>B.  For efficiency, do this by first reducing r<sub>i</sub> modulo L, the group order of B.  Let the string R<sub>i</sub> be the encoding of this point.<a href="#section-5-3.2" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-4">Transmit the value R<sub>i</sub> to the dealer<a href="#section-5-4" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal type-1" id="section-5-5">
<li id="section-5-5.1">At some later point, the dealer <span class="bcp14">MAY</span> complete the signature by returning the values F, C, A and R as specified in <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> together with the key multiplier coefficient c<sub>i</sub>. The signers <span class="bcp14">MAY</span> then complete the signature contributions:<a href="#section-5-5.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-5.2">Compute SHAKE256(dom4(F, C) || R || A || PH(M), 114), and interpret the 114-octet digest as a little-endian integer k.<a href="#section-5-5.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-5.3">Compute S<sub>i</sub> = (r<sub>i</sub> + kc<sub>i</sub>s<sub>i</sub>) mod L.  For efficiency, again reduce k modulo L first.<a href="#section-5-5.3" class="pilcrow">¶</a>
</li>
        <li id="section-5-5.4">Return the values R<sub>i</sub>, S<sub>i</sub> to the dealer.<a href="#section-5-5.4" class="pilcrow">¶</a>
</li>
      </ol>
<p id="section-5-6">The dealer then completes the signature by:<a href="#section-5-6" class="pilcrow">¶</a></p>
<ol start="0" type="1" class="normal type-1" id="section-5-7">
<li id="section-5-7.1">Computing the composite value S = S<sub>1</sub> + S<sub>2</sub> + ... + S<sub>n</sub><a href="#section-5-7.1" class="pilcrow">¶</a>
</li>
        <li id="section-5-7.2">Verifying that the signature R, S is valid.<a href="#section-5-7.2" class="pilcrow">¶</a>
</li>
        <li id="section-5-7.3">Publishing the signature.<a href="#section-5-7.3" class="pilcrow">¶</a>
</li>
      </ol>
</section>
</div>
<div id="n-test-vectors">
<section id="section-6">
      <h2 id="name-test-vectors">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-test-vectors" class="section-name selfRef">Test Vectors</a>
      </h2>
<div id="n--direct-threshold-signature-ed25519-">
<section id="section-6.1">
        <h3 id="name-direct-threshold-signature-">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-direct-threshold-signature-" class="section-name selfRef">Direct Threshold Signature Ed25519</a>
        </h3>
<p id="section-6.1-1">The signers are Alice and Bob's Threshold Signature Service 'Bob'. Each creates a key pair:<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<div id="section-6.1-2">
<pre class="sourcecode">ED25519Alice's Key (ED25519)
    UDF:            ZAAA-GTSI-GXED-255X-XALI-CEXS-XKEY
    Scalar:         312191303806394376947696888962276115420485359001
        34467943432016761653342335248
    Encoded Private
  10 AE C0 C2  16 65 9B 4F  7C 9D DE 82  3E 49 7F D4
  9B 14 BB F8  2D 9F 0C 11  24 D7 15 E3  43 79 57 20
    X:              -13697699435406080999251131063344049965140553452
        752305353714819106646919347160064793506327635954342719144289
        2305566686088586980395284289746495530409889930
    Y:              278793875610616080844162800185864399625503938157
        569374174700414845758479331294424147393776831767266487579098
        7675375777043504113387553916769515911310193558
    Encoded Public
  45 16 53 7C  26 50 CF DA  F1 A4 DF 4C  45 DC 3D 95
  4E B6 8E EB  A6 5A 27 D6  CD 5B 43 C5  F4 06 53 ED
ED25519Bob's Key (ED25519)
    UDF:            ZAAA-GTSI-G2ED-255X-XBOB-XSXK-EY
    Scalar:         567212843891509414800308620158891720685508995620
        72140666211075925337851277632
    Encoded Private
  E5 CD 34 01  FD 8C 0E 27  81 4B 11 DD  12 68 50 A1
  4B 5A D5 E1  E1 41 D7 68  5F 51 ED B4  3A 84 58 5C
    X:              -13809282472298084436735987888897423507149580966
        952791761446670884044433963975178482398144657564565223270588
        5322459642470946347570575475534141406285323257
    Y:              263684226342871984706317411760423095947068088366
        393546798602378437432707482089806653755881399592963068751759
        9645362525866308283171284327931970404321458677
    Encoded Public
  F1 5F C0 78  F8 32 49 2C  D9 64 CC 2B  CF 90 5C 4F
  23 EA BB F8  38 99 C5 FE  F3 AA 67 BE  AB EC D2 5E</pre><a href="#section-6.1-2" class="pilcrow">¶</a>
</div>
<p id="section-6.1-3">The composite Signature Key A = A<sub>a</sub> + A<sub>b</sub><a href="#section-6.1-3" class="pilcrow">¶</a></p>
<div id="section-6.1-4">
<pre class="sourcecode">Aggregate Key = Alice + Bob ()
    UDF:            TBS
    Scalar:         109634784180323260712231215560085272031403914964
        7717337619681427565742601012
    Encoded Private
  34 33 AB 10  9A 09 A9 61  65 8B 3A EC  58 21 FB 2D
  0D 45 74 49  45 BA E2 CF  A8 98 C2 94  C9 82 6C 02
    X:              -83837675294300852842901121613445594296352372347
        711317409367737761568353629718805151940195325485285476438422
        923698718220652243749390297055882388709313280
    Y:              160553422944358144751060009820735322036903773802
        361117046457476895165059738086663330972263850675453249990301
        0398473811263196653225446124160025082144761534
    Encoded Public
  48 1A 27 66  06 AF 4E 3C  20 A4 02 CD  8A 13 46 99
  02 B7 75 F8  AC D4 7E 89  68 FB 68 EB  D8 EF 4A C7</pre><a href="#section-6.1-4" class="pilcrow">¶</a>
</div>
<p id="section-6.1-5">To sign the text "This is a test", Alice first generates her value r and multiplies it by the base point to obtain the value R<sub>a</sub>:<a href="#section-6.1-5" class="pilcrow">¶</a></p>
<div id="section-6.1-6">
<pre class="sourcecode">Alice:
    r_a:            304554767184319354570910632330847275245170925807
        471005852065308719163006873
R_a =
  4D D3 35 87  4D D2 A9 35  79 CF 33 11  4E 3C 4C 86
  A3 46 83 F8  77 2B 69 B9  BE 8A D0 03  5B 07 1B 3D</pre><a href="#section-6.1-6" class="pilcrow">¶</a>
</div>
<p id="section-6.1-7">Alice passes her value R<sub>A</sub> to Bob along with the other  parameters required to calculate i. Bob then calculates his value R<sub>A</sub> and multiplies it by the base point to obtain  the value R<sub>b</sub>:<a href="#section-6.1-7" class="pilcrow">¶</a></p>
<div id="section-6.1-8">
<pre class="sourcecode">Bob:
    r_b:            211453017009495036941255861540216441186480571963
        4308458833747992420728606380
R_b =
  9E 92 BB 50  CD DA 6A 97  70 83 54 82  4A C5 A2 5E
  CF 0C 53 65  19 55 74 E0  66 F7 49 0B  F1 9E 42 C1</pre><a href="#section-6.1-8" class="pilcrow">¶</a>
</div>
<p id="section-6.1-9">Bob can now calculate the composite value R = R<sub>a</sub> + R<sub>b</sub> and thus the value k.<a href="#section-6.1-9" class="pilcrow">¶</a></p>
<div id="section-6.1-10">
<pre class="sourcecode">R =
  6D 04 0A 15  D3 26 95 7E  60 4B 31 B9  40 03 34 24
  C1 E2 94 CE  4C 2D 67 AC  23 F9 09 EB  01 35 27 BC
    k:              141815370378674010309754096097287620917810351837
        8705827473796209228380712742</pre><a href="#section-6.1-10" class="pilcrow">¶</a>
</div>
<p id="section-6.1-11">Bob calculates his signature scalar contribution and returns the value to Alice:<a href="#section-6.1-11" class="pilcrow">¶</a></p>
<div id="section-6.1-12">
<pre class="sourcecode">Bob:
    S_b:            536363782415883723339410938370364298390876250983
        1717008575694722457748759583</pre><a href="#section-6.1-12" class="pilcrow">¶</a>
</div>
<p id="section-6.1-13">Alice can now calculate her signature scalar contribution and thus the signature  scalar S.<a href="#section-6.1-13" class="pilcrow">¶</a></p>
<div id="section-6.1-14">
<pre class="sourcecode">Alice:
    S_a:            268700124091647466934677864874812484315783329013
        4699034602004495702143596514
    S:              813633487743049688767701469408773586209479440586
        508437175748279874438105108</pre><a href="#section-6.1-14" class="pilcrow">¶</a>
</div>
<p id="section-6.1-15">Alice checks to see that the signature verifies:<a href="#section-6.1-15" class="pilcrow">¶</a></p>
<div id="section-6.1-16">
<pre class="sourcecode">S.B = R + kA =
    X:              303888032885010422619559054491601097433934565460
        00461769461185182044799973523
    Y:              242312166466765598632540958273647355363821360549
        75658447998613064394185428840</pre><a href="#section-6.1-16" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--direct-threshold-signature-ed448-">
<section id="section-6.2">
        <h3 id="name-direct-threshold-signature-e">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-direct-threshold-signature-e" class="section-name selfRef">Direct Threshold Signature Ed448</a>
        </h3>
<p id="section-6.2-1">The signers are Alice and Bob's Threshold Signature Service 'Bob'. Each creates a key pair:<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<div id="section-6.2-2">
<pre class="sourcecode">ED448Alice's Key (ED448)
    UDF:            ZAAA-ITSI-GXED-44XA-LICE-XSXK-EY
    Scalar:         672286477331130983513039743350616227864346753924
        962787860729757222511999618443513569403793186398096717924945
        854846544396984088344823264
    Encoded Private
  6F 85 B1 91  9A 37 06 A6  B2 15 79 AD  5B 69 16 6A
  5A CD C8 17  D4 14 1F 68  DA 97 C5 B4  44 79 CE EA
  3C 17 7B E1  29 44 70 DF  41 C8 98 38  1E 7C 9B 3B
  03 63 6F 85  E8 39 31 91
    X:              526046019655043632868470952286947529492283092344
        122476077151423645243648974512182548405702873560533846673262
        767064019365470830861106049
    Y:              145374550785380850812934424757986866673485237047
        938554544492694946608060986459495807055455048208713991919477
        720250115717234689256856152
    Encoded Public
  59 55 F4 7A  66 08 91 35  F8 15 63 F4  90 91 7F 38
  12 E3 49 22  51 F8 BC 4A  41 C9 44 59  5A 64 9B 40
  0B C5 7E 53  48 0F 32 12  90 32 69 38  47 28 94 BB
  99 D1 16 6F  2D D5 3D 4F  80
ED448Bob's Key (ED448)
    UDF:            ZAAA-ITSI-G2ED-44XB-OBXS-XKEY
    Scalar:         455052626698262385397736547727159423941520792904
        908612603542850909167215987713902322619933929404455741806848
        064294945283113799683261212
    Encoded Private
  CA 15 22 BD  F4 0F 9E 0A  EC A7 61 79  BE 9E E3 38
  BF 93 D3 5B  B3 E6 FC F0  A7 5B 7C F0  E7 B5 89 F6
  2E F6 D1 0E  72 49 4D DF  34 5E 2F 7C  9E 42 1D 85
  AB AB 30 BD  68 C6 3E 35
    X:              752024108200272710832187535557164455078689734595
        171189993383259892607253027500878543439908750525763880661232
        171322059854852522782265
    Y:              619329873102159676791326142073166790594683111409
        729383584199833441028484525583699421181422168190856074786324
        020492214873796495570056511
    Encoded Public
  76 2B FC F8  AC 96 79 DE  1C 72 07 65  DD 49 5B 28
  C7 04 CB A8  A5 96 3D D9  9E 23 FA 05  83 15 33 95
  85 82 F8 CF  A3 7A 2F 24  F8 EB D6 AE  20 0A 25 D0
  44 1A F9 C0  86 D7 87 B7  00</pre><a href="#section-6.2-2" class="pilcrow">¶</a>
</div>
<p id="section-6.2-3">The composite Signature Key A = A<sub>a</sub> + A<sub>b</sub><a href="#section-6.2-3" class="pilcrow">¶</a></p>
<div id="section-6.2-4">
<pre class="sourcecode">Aggregate Key = Alice + Bob ()
    UDF:            TBS
    Scalar:         370810175859830330867905792457688502754055057988
        943100420373093608031918369199015948491953656482966798700316
        64591515851455352870185802
    Encoded Private
  4A AB 7A BB  2D 95 72 75  B1 3A 1D 22  24 17 76 2D
  A1 D5 55 94  67 35 8C E7  A1 A0 ED 0C  E7 88 FF 9F
  6E 2F 70 80  89 F5 01 2A  C0 AD 4C 4E  7B 90 68 6C
  F4 53 BA 32  9B 70 0F 0D
    X:              583249553407699999284154112964835446252412293188
        857058051552519639906663406776316984154017062023869075790536
        30514579317017660114474427
    Y:              518040437562811181169413740718290938351269168888
        257124107164689245721852001077758864406412789756149699111633
        051823234569886260996269341
    Encoded Public
  34 70 8D 08  DE 63 0B A6  49 2A 33 D8  B7 15 A9 84
  A4 87 F6 B6  C7 4B 1C AE  5A 1F 7C 4B  12 70 FB CF
  5A A9 3C 20  31 BA 9A 53  A0 FE 2A 43  24 97 06 F8
  DA 40 0D 88  E3 D9 DE 2E  00</pre><a href="#section-6.2-4" class="pilcrow">¶</a>
</div>
<p id="section-6.2-5">To sign the text "This is a test", Alice first generates her value r and multiplies it by the base point to obtain the value R<sub>a</sub>:<a href="#section-6.2-5" class="pilcrow">¶</a></p>
<div id="section-6.2-6">
<pre class="sourcecode">Alice:
    r_a:            177274411620382331885613075298112943809338383162
        174753240420771790910425395072244220798681166866026098695507
        899343208324484682831848544
R_a =
  EC 4E A5 8E  BE 3E DC C4  AA DC 67 65  D9 0D B1 24
  82 97 7E 57  83 4C BC CA  D0 68 98 72  B8 1A F2 61
  E2 CC 2C AF  AE F3 A9 8A  16 DF F1 1E  91 EC E2 FC
  3C 09 DD 25  AB 6E 7D 02  00</pre><a href="#section-6.2-6" class="pilcrow">¶</a>
</div>
<p id="section-6.2-7">Alice passes her value R<sub>A</sub> to Bob along with the other  parameters required to calculate i. Bob then calculates his value R<sub>A</sub> and multiplies it by the base point to obtain  the value R<sub>b</sub>:<a href="#section-6.2-7" class="pilcrow">¶</a></p>
<div id="section-6.2-8">
<pre class="sourcecode">Bob:
    r_b:            914384096261894497392108217856312041404007433725
        737987383860198449871749775140845071471047786135423317371867
        85115509488719418941845277
R_b =
  7E 8C 1C B1  EA 5F 9E 58  F4 E1 4C AB  9D CF C9 4B
  42 8E 01 F4  B4 27 AA 74  D8 66 E8 5B  D5 8C 23 10
  31 A7 99 FC  69 3D 4A 81  56 9B 31 07  A4 7C 3B 83
  9D 79 6B 12  08 D0 2C CC  80</pre><a href="#section-6.2-8" class="pilcrow">¶</a>
</div>
<p id="section-6.2-9">Bob can now calculate the composite value R = R<sub>a</sub> + R<sub>b</sub> and thus the value k.<a href="#section-6.2-9" class="pilcrow">¶</a></p>
<div id="section-6.2-10">
<pre class="sourcecode">R =
  AE 82 1A 7D  A9 B6 35 7A  3E CF 58 95  9E 97 3A 45
  62 77 E5 DB  F6 B5 B7 5F  5A 27 A0 29  0A 4D D4 2C
  9F 39 97 BB  A3 55 DC C8  BF 02 C1 8F  CE 8E 92 D9
  97 38 19 6B  73 07 19 FE  00
    k:              120812996308912938173796275547209139305812356493
        218326541177300961108122972500434047109753132978603955927000
        049579948492518627324723657</pre><a href="#section-6.2-10" class="pilcrow">¶</a>
</div>
<p id="section-6.2-11">Bob calculates his signature scalar contribution and returns the value to Alice:<a href="#section-6.2-11" class="pilcrow">¶</a></p>
<div id="section-6.2-12">
<pre class="sourcecode">Bob:
    S_b:            131642872805495450312819108720996394951179966909
        422047047106195752645599694599197550402234644818088495417690
        338344590538474713569000455</pre><a href="#section-6.2-12" class="pilcrow">¶</a>
</div>
<p id="section-6.2-13">Alice can now calculate her signature scalar contribution and thus the signature  scalar S.<a href="#section-6.2-13" class="pilcrow">¶</a></p>
<div id="section-6.2-14">
<pre class="sourcecode">Alice:
    S_a:            135660088492295551401234992018778138767930165450
        263985669170229118586124164862063605687569508563259045492355
        878328728103423148386029682
    S:              855932802238892790767231487677734001306997921878
        565176459038750760857198979216754398940488616889715775997525
        07581656337124106095380358</pre><a href="#section-6.2-14" class="pilcrow">¶</a>
</div>
<p id="section-6.2-15">Alice checks to see that the signature verifies:<a href="#section-6.2-15" class="pilcrow">¶</a></p>
<div id="section-6.2-16">
<pre class="sourcecode">S.B = R + kA =
    X:              225696302738968030426017676274023389357161605713
        77841610835599611770420843463
    Y:              366869559370146495596698412318900310141515842791
        80057095036770676314039224332</pre><a href="#section-6.2-16" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--shamir-threshold-signature-ed25519-">
<section id="section-6.3">
        <h3 id="name-shamir-threshold-signature-">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-shamir-threshold-signature-" class="section-name selfRef">Shamir Threshold Signature Ed25519</a>
        </h3>
<p id="section-6.3-1">The administrator creates the composite key pair<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<div id="section-6.3-2">
<pre class="sourcecode">ED25519Aggregate Key (ED25519)
    UDF:            ZAAA-GTSI-GQED-255X-XAGG-REGA-TEXK-EY
    Scalar:         367238470592488326468789252109412889361910680229
        03089760692844779165588879504
    Encoded Private
  FE 48 94 1F  EB 3D 28 E1  61 81 E2 1E  E1 CF F2 1E
  1E 70 91 30  DF 98 9F 1C  34 EB BB 74  C5 C8 07 EB
    X:              143576564277195758046684172284175869008525477709
        640743490221115123376609940386394888392330104965579307772627
        313244177612005636942740116142030215202393600
    Y:              844838272625277895849027219595751726665225134917
        547580682441821283235675507225396641352769322822815561632929
        543097074319051436285787045255908364074589900
    Encoded Public
  DF E8 0A 2B  E9 6C 53 C0  AB 9B BC BC  39 95 9A 61
  9C 33 2E 22  24 A7 F7 F2  21 06 AC 6D  01 5D 0B E2</pre><a href="#section-6.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.3-3">Three key shares are required for Alice, Bob and Carol with a threshold of two.  The parameters of the Shamir Secret Sharing polynomial are:<a href="#section-6.3-3" class="pilcrow">¶</a></p>
<div id="section-6.3-4">
<pre class="sourcecode">a0 =    367238470592488326468789252109412889361910680229030897606928
            44779165588879504
a1 =    338318986010852412366041291642398977925879116179901190258252
            3043521639876163</pre><a href="#section-6.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.3-5">The key share values for the participants are<a href="#section-6.3-5" class="pilcrow">¶</a></p>
<div id="section-6.3-6">
<pre class="sourcecode">xa =    1
ya =    392200903269604570067340531215030751116427738780256363326561
            3131259957500722

xb =    2
yb =    681933154723076103606316655313030495659521902216679298461852
            36496143125896

xc =    3
yc =    345138317558083173402104458195529282882474335202067983242870
            8280017783002059</pre><a href="#section-6.3-6" class="pilcrow">¶</a>
</div>
<p id="section-6.3-7">Alice and Carol are selected to sign the message "This is another test"<a href="#section-6.3-7" class="pilcrow">¶</a></p>
<p id="section-6.3-8">The Lagrange coefficients are:<a href="#section-6.3-8" class="pilcrow">¶</a></p>
<div id="section-6.3-9">
<pre class="sourcecode">la =    361850278866613110698659328152149712042855817968995380300097
            5469142727125496
lc =    361850278866613110698659328152149712042855817968995380300097
            5469142727125494</pre><a href="#section-6.3-9" class="pilcrow">¶</a>
</div>
<p id="section-6.3-10">Alice and Carol select their values ra, rc<a href="#section-6.3-10" class="pilcrow">¶</a></p>
<div id="section-6.3-11">
<pre class="sourcecode">ra =    183324669043432475889177343290874841197580255869543278119963
            6861783584446189
Ra =
  54 9B F7 DF  F9 4E FA 95  DE D8 27 4E  0D AD A4 81
  4B D7 1F CA  21 B4 B2 7D  D6 06 4F 59  28 41 87 92

rc =    161475617387612449161820030097871350703159449773365674965881
            1083650872383824
Rc =
  95 25 84 AA  B3 F7 39 14  10 67 E8 45  21 68 67 76
  11 73 88 28  D6 50 71 0F  D4 21 67 12  98 CC 80 C7</pre><a href="#section-6.3-11" class="pilcrow">¶</a>
</div>
<p id="section-6.3-12">The composite value R = R<sub>a</sub> + R<sub>c</sub><a href="#section-6.3-12" class="pilcrow">¶</a></p>
<div id="section-6.3-13">
<pre class="sourcecode">R =
  22 B8 67 CA  63 65 00 7D  AD 85 96 83  FD 86 CB 92
  88 E7 E7 73  F9 3E 48 8D  AE 7E 43 E3  2D AC 5F 7F</pre><a href="#section-6.3-13" class="pilcrow">¶</a>
</div>
<p id="section-6.3-14">The value k is<a href="#section-6.3-14" class="pilcrow">¶</a></p>
<div id="section-6.3-15">
<pre class="sourcecode">k =     300461162806835024067835386157211645931753120888211250552921
            1847964183554048</pre><a href="#section-6.3-15" class="pilcrow">¶</a>
</div>
<p id="section-6.3-16">The values R and k (or the document to be signed) and the  Lagrange coefficients are passed to Alice and Carol who use them to  calculate their secret scalar values:<a href="#section-6.3-16" class="pilcrow">¶</a></p>
<div id="section-6.3-17">
<pre class="sourcecode">sa =    588301354904406855101010796822546126674641608170384544989841
            9696889936251083
sc =    189281120087571523997607099054385070601618650367961388678662
            1329133835624465</pre><a href="#section-6.3-17" class="pilcrow">¶</a>
</div>
<p id="section-6.3-18">The signature contributions can now be calulated:<a href="#section-6.3-18" class="pilcrow">¶</a></p>
<div id="section-6.3-19">
<pre class="sourcecode">Sa =    128238145780800590303153436041482532412837879827391619588852
            5270458485017264
Sc =    425392829290723185011341307483608802636424146029130066221513
            8481933637068796</pre><a href="#section-6.3-19" class="pilcrow">¶</a>
</div>
<p id="section-6.3-20">The dealer calculates the composite value S = S<sub>a</sub> + S<sub>b</sub><a href="#section-6.3-20" class="pilcrow">¶</a></p>
<div id="section-6.3-21">
<pre class="sourcecode">S =     553630975071523775314494743525091335049262025856521685810366
            3752392122086060</pre><a href="#section-6.3-21" class="pilcrow">¶</a>
</div>
<p id="section-6.3-22">The dealer checks to see that the signature verifies:<a href="#section-6.3-22" class="pilcrow">¶</a></p>
<div id="section-6.3-23">
<pre class="sourcecode">S.B = R + kA =
    X:              386656916198500913898974718482142916932478347228
        53747339220827400653000735042
    X:              272627300420736046999889168909581852465293124122
        69338237353604076047710443564</pre><a href="#section-6.3-23" class="pilcrow">¶</a>
</div>
</section>
</div>
<div id="n--shamir-threshold-signature-ed448-">
<section id="section-6.4">
        <h3 id="name-shamir-threshold-signature-e">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-shamir-threshold-signature-e" class="section-name selfRef">Shamir Threshold Signature Ed448</a>
        </h3>
<p id="section-6.4-1">The administrator creates the composite key pair<a href="#section-6.4-1" class="pilcrow">¶</a></p>
<div id="section-6.4-2">
<pre class="sourcecode">ED448Aggregate Key (ED448)
    UDF:            ZAAA-ITSI-GQED-44XA-GGRE-GATE-XKEY
    Scalar:         723088510822916843359337925516642493307623385482
        113107480846498794254549074097051759295396782499503452909258
        978468506553055366989547456
    Encoded Private
  59 DC 8A 5F  5E AF 8C FA  96 19 F8 EE  78 13 00 12
  33 0E 12 80  2D 25 E6 EF  E8 E2 56 B5  83 6A 0C CF
  DC 11 96 A5  A5 D1 39 AA  34 25 0B 52  ED 9F 38 92
  5D 9F 7B BC  B9 BC 86 45
    X:              600163199260212879671026282440221570752543874569
        276531213297382365938924845597497264583528185273760383031589
        25167107013312482098672476
    Y:              568007995844826855892481230051783440873263817862
        016100095069663100696528804467952219402043387612562057320585
        561865068046226655443122582
    Encoded Public
  ED C3 90 99  38 0B 8F CD  60 29 24 04  6C DE 52 33
  A2 07 3E 56  8D 27 B5 B9  21 60 CF E9  E7 9D D6 4A
  11 47 20 E6  9D FE 75 C7  04 14 70 18  B4 52 10 83
  D0 EC 98 BD  F5 E6 E3 D5  80</pre><a href="#section-6.4-2" class="pilcrow">¶</a>
</div>
<p id="section-6.4-3">Three key shares are required for Alice, Bob and Carol with a threshold of two.  The parameters of the Shamir Secret Sharing polynomial are:<a href="#section-6.4-3" class="pilcrow">¶</a></p>
<div id="section-6.4-4">
<pre class="sourcecode">a0 =    723088510822916843359337925516642493307623385482113107480846
            49879425454907409705175929539678249950345290925897846850
            6553055366989547456
a1 =    253947292459661473537056525563228503335644586909535883819036
            29593189848969312285942082195525418378983878506351793852
            012228645407360825</pre><a href="#section-6.4-4" class="pilcrow">¶</a>
</div>
<p id="section-6.4-5">The key share values for the participants are<a href="#section-6.4-5" class="pilcrow">¶</a></p>
<div id="section-6.4-6">
<pre class="sourcecode">xa =    1
ya =    216445157732761001637197701849608092875464834857486355812599
            29206860382197250994836594571141148378583546590493895709
            346188988958309165

xb =    2
yb =    470392450192422475174254227412836596211109421767022239631635
            58800050231166563280778676766666566757567425096845689561
            358417634365669990

xc =    3
yc =    724339742652083948711310752976065099546754008676558123450671
            88393240080135875566720758962191985136551303603197483413
            370646279773030815</pre><a href="#section-6.4-6" class="pilcrow">¶</a>
</div>
<p id="section-6.4-7">Alice and Carol are selected to sign the message "This is another test"<a href="#section-6.4-7" class="pilcrow">¶</a></p>
<p id="section-6.4-8">The Lagrange coefficients are:<a href="#section-6.4-8" class="pilcrow">¶</a></p>
<div id="section-6.4-9">
<pre class="sourcecode">la =    908548405369508613186654759860005667942051700859147575351862
            74897573001980769792858097877645846187981655146854545831
            152386877929824891
lc =    908548405369508613186654759860005667942051700859147575351862
            74897573001980769792858097877645846187981655146854545831
            152386877929824889</pre><a href="#section-6.4-9" class="pilcrow">¶</a>
</div>
<p id="section-6.4-10">Alice and Carol select their values ra, rc<a href="#section-6.4-10" class="pilcrow">¶</a></p>
<div id="section-6.4-11">
<pre class="sourcecode">ra =    597061760142011172791892795402895896258128262343360777519356
            25449868368724094466154383697912358541824000038036669052
            993742082445345445
Ra =
  35 E5 61 55  78 E7 27 24  55 2D C9 76  4B 49 2B 46
  16 E3 FA 97  2F 9A E6 47  1B 22 CD 2D  54 F5 1A 1C
  7A A7 67 B0  CE 65 84 05  39 33 0E A6  33 5E 67 BD
  58 CA ED 7E  F3 EE DD 59  00

rc =    134782448747121628062621888359149856538463227176060814858572
            40759552504564125328966600869858667833252205589918638910
            3286110005426517374
Rc =
  3C 7B 81 57  A9 C9 23 90  E2 1D 82 42  7B 0C D9 88
  E7 E5 98 81  DB 52 76 E3  77 67 E8 34  DC D7 DC 81
  20 B6 3A 6F  EC E8 0C D9  0E BC C5 5A  A0 E6 91 D5
  D9 14 0B 60  C2 A4 D0 A8  80</pre><a href="#section-6.4-11" class="pilcrow">¶</a>
</div>
<p id="section-6.4-12">The composite value R = R<sub>a</sub> + R<sub>c</sub><a href="#section-6.4-12" class="pilcrow">¶</a></p>
<div id="section-6.4-13">
<pre class="sourcecode">R =
  00 27 F8 F7  A7 39 F7 AE  B6 8F E4 0F  A8 4E 3A 71
  45 87 6A 1E  C4 C3 29 52  CC 8A C7 6C  36 47 4B A6
  04 F8 55 03  7B 49 86 87  E4 91 AB 73  E0 AF 3F 12
  AB 7F 09 2D  4E 06 4A 71  00</pre><a href="#section-6.4-13" class="pilcrow">¶</a>
</div>
<p id="section-6.4-14">The value k is<a href="#section-6.4-14" class="pilcrow">¶</a></p>
<div id="section-6.4-15">
<pre class="sourcecode">k =     111997156629233344141251678175691985810414419806912701822160
            03679477455027316936425566511876628316232490805931954430
            9467825781335347270</pre><a href="#section-6.4-15" class="pilcrow">¶</a>
</div>
<p id="section-6.4-16">The values R and k (or the document to be signed) and the  Lagrange coefficients are passed to Alice and Carol who use them to  calculate their secret scalar values:<a href="#section-6.4-16" class="pilcrow">¶</a></p>
<div id="section-6.4-17">
<pre class="sourcecode">sa =    123321614196865011564245131263441780725524895314537710907076
            16870786357527664628511298973435756875585697503259538939
            5171670361367288637
sc =    546378534043466638830999383371973118168674696520868513626526
            80700952961912832009497718396549853619706003345255804124
            467063738043309482</pre><a href="#section-6.4-17" class="pilcrow">¶</a>
</div>
<p id="section-6.4-18">The signature contributions can now be calulated:<a href="#section-6.4-18" class="pilcrow">¶</a></p>
<div id="section-6.4-19">
<pre class="sourcecode">Sa =    458780069801903308724659679047126206540023727016859370284301
            27448209487257982695731719827860225173821194895861101407
            212569594681924953
Sc =    401983114222685811776093088236307108408769238787937252473320
            58598217288865359359764076141664751937484813828720687591
            206436379246811336</pre><a href="#section-6.4-19" class="pilcrow">¶</a>
</div>
<p id="section-6.4-20">The dealer calculates the composite value S = S<sub>a</sub> + S<sub>b</sub><a href="#section-6.4-20" class="pilcrow">¶</a></p>
<div id="section-6.4-21">
<pre class="sourcecode">S =     860763184024589120500752767283433314948792965804796622757621
            86046426776123342055495795969524977111306008724581788998
            419005973928736289</pre><a href="#section-6.4-21" class="pilcrow">¶</a>
</div>
<p id="section-6.4-22">The dealer checks to see that the signature verifies:<a href="#section-6.4-22" class="pilcrow">¶</a></p>
<div id="section-6.4-23">
<pre class="sourcecode">S.B = R + kA =
    X:              565863868058207644748379075787643375969163605886
        69329263413068616160478393570
    X:              150478297775841135131577263700053908124463098444
        5517859016637728894764938481</pre><a href="#section-6.4-23" class="pilcrow">¶</a>
</div>
</section>
</div>
</section>
</div>
<div id="n-security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">All the security considerations of <span>[<a href="#RFC7748" class="xref">RFC7748</a>]</span>, <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> and <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span> apply and are hereby incorporated by reference.<a href="#section-7-1" class="pilcrow">¶</a></p>
<div id="n-rogue-key-attack">
<section id="section-7.1">
        <h3 id="name-rogue-key-attack-2">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-rogue-key-attack-2" class="section-name selfRef">Rogue Key attack</a>
        </h3>
<p id="section-7.1-1">The rogue key attack described in  <span>[<a href="#draft-hallambaker-threshold" class="xref">draft-hallambaker-threshold</a>]</span> is of particular concern to generation of threshold signatures.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.1-2">If <em>A</em> and <em>B</em> are public keys, the intrinsic degree of trust in the composite keypair <em>A</em> + <em>B</em> is that of the lesser of <em>A</em> and <em>B</em>.<a href="#section-7.1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-disclosure-or-reuse-of-the-value-r">
<section id="section-7.2">
        <h3 id="name-disclosure-or-reuse-of-the-">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-disclosure-or-reuse-of-the-" class="section-name selfRef">Disclosure or reuse of the value r</a>
        </h3>
<p id="section-7.2-1">As in any Schnorr signature scheme, compromise of the value <em>r</em> results in compromise of the private key. The base signature specification <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> describes a deterministic construction of <em>r</em> that ensures confidentiality and uniqueness for a given value of <em>k</em>.<a href="#section-7.2-1" class="pilcrow">¶</a></p>
<p id="section-7.2-2">As described above, this approach is not applicable to the generation of values of <em>r<sub>i</sub></em> to compute threshold signature contributions. Accordingly the requirements of <span>[<a href="#RFC4086" class="xref">RFC4086</a>]</span> regarding requirements for randomness <span class="bcp14">MUST</span> be observed.<a href="#section-7.2-2" class="pilcrow">¶</a></p>
<p id="section-7.2-3">Implementations <span class="bcp14">MUST NOT</span> use a deterministic generation of the value <em>r<sub>i</sub></em> for any threshold contribution except for calculating the final contribution when all the other parameters required to calculate <em>k</em> are known.<a href="#section-7.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-resource-exhaustion-attack">
<section id="section-7.3">
        <h3 id="name-resource-exhaustion-attack">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-resource-exhaustion-attack" class="section-name selfRef">Resource exhaustion attack</a>
        </h3>
<p id="section-7.3-1">Implementation of the general two stage signing algorithm requires that signers track generation and use of the values <em>r<sub>i</sub></em> to avoid reuse for different values of <em>R<sub>i</sub></em>. Implementations <span class="bcp14">MUST</span> ensure that exhaustion of this resource by one party does not cause other parties to be denied service.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-signature-uniqueness">
<section id="section-7.4">
        <h3 id="name-signature-uniqueness">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-signature-uniqueness" class="section-name selfRef">Signature Uniqueness</a>
        </h3>
<p id="section-7.4-1">Signatures generated in strict conformance with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> are guaranteed to be unique such that signing the same document with the same key will always result in the same signature value.<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<p id="section-7.4-2">The signature modes described in this document are computationally indistinguishable from those created in accordance with <span>[<a href="#RFC8032" class="xref">RFC8032</a>]</span> but are not unique.<a href="#section-7.4-2" class="pilcrow">¶</a></p>
<p id="section-7.4-3">Implementations <span class="bcp14">MUST</span> not use threshold signatures in applications where signature values are used in place of cryptographic digests as unique content identifiers.<a href="#section-7.4-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="n-iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document requires no IANA actions.<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="n-acknowledgements">
<section id="section-9">
      <h2 id="name-acknowledgements">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-9-1">[TBS]<a href="#section-9-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-10">
      <h2 id="name-normative-references">
<a href="#section-10" class="section-number selfRef">10. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
      </h2>
<dl class="references">
<dt id="draft-hallambaker-mesh-udf">[draft-hallambaker-mesh-udf]</dt>
      <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh 3.0 Part II: Uniform Data Fingerprint."</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-udf-10</span>, <time datetime="2020-07-27" class="refDate">27 July 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-udf-10">https://tools.ietf.org/html/draft-hallambaker-mesh-udf-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="draft-hallambaker-threshold">[draft-hallambaker-threshold]</dt>
      <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Threshold Modes in Elliptic Curves"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-threshold-03</span>, <time datetime="2020-09-03" class="refDate">3 September 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-threshold-03">https://tools.ietf.org/html/draft-hallambaker-threshold-03</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
      <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4086">[RFC4086]</dt>
      <dd>
<span class="refAuthor">Eastlake 3rd, D.</span><span class="refAuthor">, Schiller, J.</span><span class="refAuthor">, and S. Crocker</span>, <span class="refTitle">"Randomness Requirements for Security"</span>, <span class="seriesInfo">BCP 106</span>, <span class="seriesInfo">RFC 4086</span>, <span class="seriesInfo">DOI 10.17487/RFC4086</span>, <time datetime="2005-06" class="refDate">June 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc4086">https://www.rfc-editor.org/rfc/rfc4086</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7748">[RFC7748]</dt>
      <dd>
<span class="refAuthor">Langley, A.</span><span class="refAuthor">, Hamburg, M.</span><span class="refAuthor">, and S. Turner</span>, <span class="refTitle">"Elliptic Curves for Security"</span>, <span class="seriesInfo">RFC 7748</span>, <span class="seriesInfo">DOI 10.17487/RFC7748</span>, <time datetime="2016-01" class="refDate">January 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7748">https://www.rfc-editor.org/rfc/rfc7748</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8032">[RFC8032]</dt>
    <dd>
<span class="refAuthor">Josefsson, S.</span><span class="refAuthor"> and I. Liusvaara</span>, <span class="refTitle">"Edwards-Curve Digital Signature Algorithm (EdDSA)"</span>, <span class="seriesInfo">RFC 8032</span>, <span class="seriesInfo">DOI 10.17487/RFC8032</span>, <time datetime="2017-01" class="refDate">January 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8032">https://www.rfc-editor.org/rfc/rfc8032</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-11">
      <h2 id="name-informative-references">
<a href="#section-11" class="section-number selfRef">11. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
      </h2>
<dl class="references">
<dt id="draft-hallambaker-mesh-developer">[draft-hallambaker-mesh-developer]</dt>
      <dd>
<span class="refAuthor">Hallam-Baker, P.</span>, <span class="refTitle">"Mathematical Mesh: Reference Implementation"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-hallambaker-mesh-developer-10</span>, <time datetime="2020-07-27" class="refDate">27 July 2020</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-hallambaker-mesh-developer-10">https://tools.ietf.org/html/draft-hallambaker-mesh-developer-10</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Komlo">[Komlo]</dt>
      <dd>
<span class="refAuthor">Komlo, C.</span><span class="refAuthor"> and I. Goldberg</span>, <span class="refTitle">"FROST: Flexible Round-Optimized Schnorr Threshold Signatures"</span>, <time datetime="2020" class="refDate">2020</time>. </dd>
<dd class="break"></dd>
<dt id="RFC5860">[RFC5860]</dt>
      <dd>
<span class="refAuthor">Vigoureux, M.</span><span class="refAuthor">, Ward, D.</span><span class="refAuthor">, and M. Betts</span>, <span class="refTitle">"Requirements for Operations, Administration, and Maintenance (OAM) in MPLS Transport Networks"</span>, <span class="seriesInfo">RFC 5860</span>, <span class="seriesInfo">DOI 10.17487/RFC5860</span>, <time datetime="2010-05" class="refDate">May 2010</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5860">https://www.rfc-editor.org/rfc/rfc5860</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Shamir79">[Shamir79]</dt>
    <dd>
<span class="refAuthor">Shamir, A.</span>, <span class="refTitle">"How to share a secret."</span>, <time datetime="1979" class="refDate">1979</time>. </dd>
<dd class="break"></dd>
</dl>
</section>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
