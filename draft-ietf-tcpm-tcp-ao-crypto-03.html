<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Cryptographic Algorithms for TCP's
    Authentication Option, TCP-AO</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Cryptographic Algorithms for TCP's
    Authentication Option, TCP-AO">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">TCPM</td><td class="header">G. Lebovitz</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Juniper</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">E. Rescorla</td></tr>
<tr><td class="header">Expires: September 25, 2010</td><td class="header">RTFM</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 24, 2010</td></tr>
</table></td></tr></table>
<h1><br />Cryptographic Algorithms for TCP's
    Authentication Option, TCP-AO<br />draft-ietf-tcpm-tcp-ao-crypto-03</h1>

<h3>Abstract</h3>

<p>The TCP Authentication Option, TCP-AO, relies on security algorithms
      to provide authentication between two end-points. There are many such
      algorithms available, and two TCP-AO systems cannot interoperate unless
      they are using the same algorithms. This document specifies the
      algorithms and attributes that can be used in TCP-AO's current manual
      keying mechanism, and provides the interface for future MACs.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 25, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#Requirements">2.</a>&nbsp;
Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ReqLanguage">2.1.</a>&nbsp;
Requirements Language<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor2">2.2.</a>&nbsp;
Algorithm Requirements<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#ReqFuture">2.3.</a>&nbsp;
Requirements for Future MAC Algorithms<br />
<a href="#Algos">3.</a>&nbsp;
Algorithms Specified<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#KDFs">3.1.</a>&nbsp;
Key Derivation Functions (KDFs)<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">3.1.1.</a>&nbsp;
Concrete KDFs<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#MACs">3.2.</a>&nbsp;
MAC Algorithms<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#HMAC-SHA-1-96">3.2.1.</a>&nbsp;
The Use of HMAC-SHA-1-96<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#AES-128-CMAC-96">3.2.2.</a>&nbsp;
The Use of AES-128-CMAC-96<br />
<a href="#Security">4.</a>&nbsp;
Security Considerations<br />
<a href="#anchor7">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor8">6.</a>&nbsp;
Acknowledgements<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
Informative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>This document is a companion to <a class='info' href='#I-D.ietf-tcpm-tcp-auth-opt'>[I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;auth&#8209;opt]<span> (</span><span class='info'>Touch, J., Mankin, A., and R. Bonica, &ldquo;The TCP Authentication Option,&rdquo; March&nbsp;2010.</span><span>)</span></a>. Like most modern
      security protocols, TCP-AO allows users to chose which cryptographic
      algorithm(s) they want to use to meet their security needs.
</p>
<p>TCP-AO provides cryptographic authentication and message integrity
      verification between two end-points. In order to accomplish this
      function, message authentication codes (MACs) are used, which then rely
      on shared keys. There are various ways to create MACs. The use of
      hashed-based MACs (HMAC) is defined in <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a>.
      The use of cipher-based MACs (CMAC) is defined in <a class='info' href='#NIST-SP800-38B'>[NIST&#8209;SP800&#8209;38B]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of           Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a>.
</p>
<p>This RFC defines the general requirements for MACs used in TCP-AO,
      both for currently specified MACs and for any future specified MACs. It
      specifies two MAC algorithms required in all TCP-AO implementations. It
      also specifies two key derivation functions (KDFs) used to create the
      traffic keys used by the MACs. These KDFs are also required by all
      TCP-AO implementations.
</p>
<p>
</p>
<p>
</p>
<a name="Requirements"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Requirements</h3>

<p>
</p>
<a name="ReqLanguage"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Requirements Language</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
        "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
        document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>When used in lower case, these words convey their typical use in
        common language, and are not to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Algorithm Requirements</h3>

<p>This is the initial specification of required cryptography for
        TCP-AO, and indicates two MAC algorithms and two KDFs. All four
        components MUST be implemented in order for the implementation to be
        fully compliant with this RFC.
</p>
<p>The following table indicates the required MAC algorithms and KDFs
        for TCP-AO:
</p>
<p>
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>Requirement</dt>
<dd>Authentication Algorithm
</dd>
<dt>------------</dt>
<dd>------------------------
</dd>
<dt>MUST</dt>
<dd>HMAC-SHA-1-96 <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a><a class='info' href='#FIPS-180-3'>[FIPS&#8209;180&#8209;3]<span> (</span><span class='info'>FIPS Publication 180-3, &ldquo;Secured Hash Standard,&rdquo; October&nbsp;2008.</span><span>)</span></a>
</dd>
<dt>MUST</dt>
<dd>AES-128-CMAC-96 <a class='info' href='#NIST-SP800-38B'>[NIST&#8209;SP800&#8209;38B]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of           Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a><a class='info' href='#FIPS197'>[FIPS197]<span> (</span><span class='info'>FIPS Publications 197, &ldquo;Advanced Encryption Standard (AES),&rdquo; November&nbsp;2001.</span><span>)</span></a>
</dd>
<dt></dt>
<dd>
</dd>
<dt>Requirement</dt>
<dd>Key Derivation Function (KDF)
</dd>
<dt>-------------</dt>
<dd>------------------------
</dd>
<dt>MUST</dt>
<dd>KDF_HMAC_SHA1
</dd>
<dt>MUST</dt>
<dd>KDF_AES_128_CMAC
</dd>
</dl></blockquote>

</blockquote>

<p>
</p>
<p>For an explanation fo why two MAC algorthims were mandated, see the
        <a class='info' href='#Security'>Section&nbsp;4<span> (</span><span class='info'>Security Considerations</span><span>)</span></a> section.
</p>
<p>
</p>
<a name="ReqFuture"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Requirements for Future MAC Algorithms</h3>

<p>TCP-AO is intended to support cryptographic agility. As a result,
        this document includes recommendations in various places for future
        MAC and KDF algorithms when used for TCP-AO. For future MAC algorithms
        specifically, they SHOULD protect at least 2**48 messages with a
        collision probability of less than one in 10**9.
</p>
<a name="Algos"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Algorithms Specified</h3>

<p>TCP-AO requires two classes of cryptographic algorithms used on a
      particular connection, and refers to this document to define them
      both:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>(1)</dt>
<dd>Key Derivation Functions (KDFs) which name a
              pseudorandom function (PRF) and use a Master_Key and some
              connection-specific input with that PRF to produce Traffic_Keys,
              the keys suitable for authenticating and integrity checking
              individual TCP segments, as described in TCP-AO.
</dd>
<dt>(2)</dt>
<dd>Message Authentication Code (MAC) algorithms
              which take a key and a message and produce an authentication tag
              which can be used to verify the integrity and authenticity of
              those messages.
</dd>
</dl></blockquote>

</blockquote>

<p>
</p>
<p>In TCP-AO, these algorithms are always used in pairs. Each MAC
      algorithm MUST specify the KDF to be used with that MAC algorithm.
      However, a KDF MAY be used with more than one MAC algorithm.
</p>
<a name="KDFs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Key Derivation Functions (KDFs)</h3>

<p>
</p>
<p>TCP-AO's Traffic_Keys are derived using KDFs. The KDFs used in
        TCP-AO's current manual keying have the following interface:
</p>
<p></p>
<blockquote class="text">
<p>Traffic_Key = KDF_alg(Master_Key, Context, Output_Length)
</p>
</blockquote>

<p>where:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- KDF_alg:</dt>
<dd>the specific pseudorandom function
                (PRF) that is the basic building block used in constructing
                the given Traffic_Key.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Master_Key:</dt>
<dd>In TCP-AO's manual key mode, this
                is a key shared by both peers, entered via some interface to
                their respective configurations. The Master_Key is used as the
                seed for the KDF. We assume that this is a human-readable
                pre-shared key (PSK), thus we assume it is of variable length.
                Master_Keys SHOULD be random, but might not be (e.g., badly
                chosen by the user). For interoperability, the management
                interface by which the PSK is configured MUST accept ASCII
                strings, and SHOULD also allow for the configuration of any
                arbitrary binary string in hexadecimal form. Other
                configuration methods MAY be supported.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Context:</dt>
<dd>A binary string containing
                information related to the specific connection for this
                derived keying material, as defined in <a class='info' href='#I-D.ietf-tcpm-tcp-auth-opt'>[I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;auth&#8209;opt]<span> (</span><span class='info'>Touch, J., Mankin, A., and R. Bonica, &ldquo;The TCP Authentication Option,&rdquo; March&nbsp;2010.</span><span>)</span></a>, Section 7.2.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Output_Length:</dt>
<dd>The length in bits of the key
                that the KDF will produce. This length must be the size
                required for the MAC algorithm that will use the PRF result as
                a seed.
</dd>
</dl></blockquote>

</blockquote>

<p>
</p>
<p>When invoked, a KDF generates a string of length Output_Length bits
        based on Master_Key and context value. This result may then be used as
        a cryptographic key for any algorithm which takes an Output_Length
        length key. A KDF MAY specify a maximum Output_Length parameter.
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1"></a><h3>3.1.1.&nbsp;
Concrete KDFs</h3>

<p>This document defines two KDF algorithms, each paired with a
          corresponding PRF algorithm as explained below:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>*  KDF_HMAC_SHA1</dt>
<dd>based on PRF-HMAC-SHA1 <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a><a class='info' href='#FIPS-180-3'>[FIPS&#8209;180&#8209;3]<span> (</span><span class='info'>FIPS Publication 180-3, &ldquo;Secured Hash Standard,&rdquo; October&nbsp;2008.</span><span>)</span></a>
</dd>
<dt>*  KDF_AES_128_CMAC</dt>
<dd>based on AES-CMAC-PRF-128
                  <a class='info' href='#NIST-SP800-38B'>[NIST&#8209;SP800&#8209;38B]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of           Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a><a class='info' href='#FIPS197'>[FIPS197]<span> (</span><span class='info'>FIPS Publications 197, &ldquo;Advanced Encryption Standard (AES),&rdquo; November&nbsp;2001.</span><span>)</span></a>
</dd>
</dl></blockquote>

<p>
</p>
</blockquote><p>Both of these KDFs are based on the iteration mode KDFs
          specified in <a class='info' href='#NIST-SP800-108'>[NIST&#8209;SP800&#8209;108]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Key Derivation Using Pseudorandom Functions, NIST SP800-108,&rdquo; October&nbsp;2009.</span><span>)</span></a>. This means that
          they use an underlying pseudorandom function (PRF) with a
          fixed-length output, 128 bits in the case of the AES-CMAC, and 160
          bits in the case of HMAC-SHA1. The KDF generates an arbitrary number
          of output bits by operating the PRF in a "counter mode", where each
          invocation of the PRF uses a different input block differentiated by
          a block counter.
</p>
<p>Each input block is constructed as follows:
</p>
<p></p>
<blockquote class="text">
<p>( i || Label || Context || Output_Length )
</p>
</blockquote>

<p></p>
<blockquote class="text">
<p>Where
</p>
<p></p>
<blockquote class="text"><dl>
<dt>- &quot;||&quot;:</dt>
<dd>For any X || Y, "||"
                  represents a concatonation operation of the binary strings X
                  and Y.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- i:</dt>
<dd>A counter, a binary string that is an
                  input to each iteration of the PRF in counter mode. The
                  counter "i" is represented in a single octet. The number of
                  iterations will depend on the specific size of the
                  Output_Length desired for a given MAC. "i" always starts =
                  1.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Label:</dt>
<dd>A binary string that clearly
                  identifies the purpose of this KDF's derived keying
                  material. For TCP-AO we use the ASCII string "TCP-AO", where
                  the last character is the capital letter "O", not to be
                  confused with a zero. While this may seem like overkill in
                  this specification since TCP-AO only describes one call to
                  the KDF, it is included in order to comply with FIPS 140
                  certifications.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Context:</dt>
<dd>The context argument provided to
                  the KDF interface, as described above in <a class='info' href='#KDFs'>Section&nbsp;3.1<span> (</span><span class='info'>Key Derivation Functions (KDFs)</span><span>)</span></a> .
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Output_Length:</dt>
<dd>The length in bits of the key
                  that the KDF will produce. The Output_length is represented
                  within two octets. This length must be the size required for
                  the MAC algorithm that will use the PRF result as a
                  seed.
</dd>
</dl></blockquote>

</blockquote>

<p>The ouput of multiple PRF invocations is simply concatenated. For
          the Traffic_Key, values of multiple PRF invocations are concatenated
          and truncated as needed to create a Traffic_Key of the desired
          length. For instance, if one were using KDF_HMAC_SHA1, which uses a
          160-bit internal PRF to generate 320 bits of data, one would execute
          the PRF twice, once with i=1 and once with i=2. The result would be
          the entire output of the first invocation concatenated with the
          second invocation. E.g.,
</p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
  Traffic_Key =
          KDF_alg(Master_Key, 1 || Label || Context || Output_length) ||
          KDF_alg(Master_Key, 2 || Label || Context || Output_length)
</pre></div>
<p>
</p>
<p>If the number of bits required is not an exact multiple of the
          output size of the PRF, then the output of the final invocation of
          the PRF is truncated as necessary.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.1"></a><h3>3.1.1.1.&nbsp;
KDF_HMAC_SHA1</h3>

<p>For KDF_HMAC_SHA1:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>- PRF for KDF_alg:</dt>
<dd>HMAC-SHA1 <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a><a class='info' href='#FIPS-180-3'>[FIPS&#8209;180&#8209;3]<span> (</span><span class='info'>FIPS Publication 180-3, &ldquo;Secured Hash Standard,&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Use:</dt>
<dd>HMAC-SHA1(Key, Input).
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Key:</dt>
<dd>Master_Key, configured by user, and
                passed to the KDF.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Input: </dt>
<dd>( i || Label || Context ||
                Output_Length)
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Output_Length:</dt>
<dd>160 bits.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Result:</dt>
<dd>Traffic_Key, used in the MAC function
                by TCP-AO.
</dd>
</dl></blockquote>

<p>
</p>
<p>
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.2"></a><h3>3.1.1.2.&nbsp;
KDF_AES_128_CMAC</h3>

<p>For KDF_AES_128_CMAC:
</p>
<p>
</p>
<p></p>
<blockquote class="text"><dl>
<dt>- PRF for KDF_alg:</dt>
<dd>AES-CMAC-PRF-128 <a class='info' href='#NIST-SP800-38B'>[NIST&#8209;SP800&#8209;38B]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of           Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a><a class='info' href='#FIPS197'>[FIPS197]<span> (</span><span class='info'>FIPS Publications 197, &ldquo;Advanced Encryption Standard (AES),&rdquo; November&nbsp;2001.</span><span>)</span></a>.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Use:</dt>
<dd>AES-CMAC(Key, Input).
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Key:</dt>
<dd>Master_Key (see usage below)
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Input: </dt>
<dd>( i || Label || Context ||
                Output_Length)
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Output_Length:</dt>
<dd>128 bits.
</dd>
<dt></dt>
<dd>
</dd>
<dt>- Result:</dt>
<dd>Traffic_Key, used in the MAC function
                by TCP-AO
</dd>
</dl></blockquote>

<p>The Master_Key in TCP-AO's current manual keying mechanism is a
            shared secret, entered by an administrator. It is passed via an
            out-of-band mechanism between two devices, and often between two
            organizations. The shared secret does not have to be 16 octets,
            and the length may vary. However, AES_128_CMAC requires a key of
            exactly 16 octets (128 bits) in length. We could mandate that
            implementations force administrators to input Master_Keys of
            exactly 128 bit length when using AES_128_CMAC, and with
            sufficient randomness, but this places undue burden on the
            implementors and deployers. This specification RECOMMENDS that
            deployers use a randomly generated 128-bit string as the
            Master_Key, but acknowledges that deployers may not.
</p>
<p>To handle variable length Master_Keys we use the same mechanism
            as described in <a class='info' href='#RFC4615'>[RFC4615]<span> (</span><span class='info'>Song, J., Poovendran, R., Lee, J., and T. Iwata, &ldquo;The Advanced Encryption Standard-Cipher-based Message Authentication Code-Pseudo-Random Function-128 (AES-CMAC-PRF-128) Algorithm for the Internet Key Exchange Protocol (IKE),&rdquo; August&nbsp;2006.</span><span>)</span></a>, Sect 3. First we
            use AES_128_CMAC with a fixed key of all zeros as a "randomness
            extractor", while using the shared secret Master_Key, MK, as the
            message input, to produce a 128 bit key Derived_Master_Key (K).
            Second, we use the result as a key, and run AES-128_CMAC again,
            this time using the result K as the Key, and the true input block
            as the Input to yield the Traffic_Key (TK) used in the MAC over
            the message. The description follows:
</p>
<p><br /><hr class="insert" />
<a name="Figure1"></a>
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
   +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   +                        KDF-AES-128-CMAC                           +
   +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
   +                                                                   +
   + Input  : MK (Master_Key, the variable-length shared secret)       +
   +        : I (Input, i.e., the input data of the PRF)               +
   +        : MKlen (length of MK in octets)                           +
   +        : len (length of M in octets)                              +
   + Output : TK (Traffic_Key, 128-bit Pseudo-Random Variable)         +
   +                                                                   +
   +-------------------------------------------------------------------+
   + Variable: K (128-bit key for AES-CMAC)                            +
   +                                                                   +
   + Step 1.   If MKlen is equal to 16                                 +
   + Step 1a.  then                                                    +
   +               K := MK;                                            +
   + Step 1b.  else                                                    +
   +               K := AES-CMAC(0^128, MK, MKlen);                    +
   + Step 2.   TK := AES-CMAC(K, I, len);                              +
   +           return TK;                                              +
   +                                                                   +
   +++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

</p>
<p>In step 1, the 128-bit key, K, for AES-CMAC is derived as
            follows:
</p>
<p>o If the Master_Key, MK, provided by the administrator is
            exactly 128 bits, then we use it as-is.
</p>
<p>o If it is longer or shorter than 128 bits, then we derive the
            key K by applying the AES-CMAC algorithm using the 128-bit
            all-zero string as the key and MK as the input message. This step
            is described in step 1b.
</p>
<p>In step 2, we apply the AES-CMAC algorithm again, this time
            using K as the key and I as the input message.
</p>
<p>The output of this algorithm returns TK, the Traffic_Key, which
            is 128 bits suitable for use in the MAC function on each TCP
            segment of the connection.
</p>
<p>
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1.1.3"></a><h3>3.1.1.3.&nbsp;
Tips for User Interfaces regarding KDFs</h3>

<p>This section provides suggested representations for the KDFs in
            implementation user interfaces. Following these guidelines across
            common implementations will make interoperability easier and
            simpler for deployers.
</p>
<p>UIs SHOULD refer to the choice of KDF_HMAC_SHA1 as simply
            "SHA1".
</p>
<p>UIs SHOULD refer to the choice of KDF_AES_128_CMAC as simply
            "AES128".
</p>
<p>The initial IANA registry values will reflect these two
            entries.
</p>
<p>UIs SHOULD use KDF_HMAC_SHA1 as the default selection in TCP-AO
            settings. KDF_HMAC_SHA1 is preferred at this time because it has
            wide support, being present in most implementations in the
            marketplace.
</p>
<a name="MACs"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
MAC Algorithms</h3>

<p>
</p>
<p>Each MAC_alg defined for TCP-AO has three fixed elements as part of
        its definition:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>- KDF_Alg:</dt>
<dd>Name of the TCP-AO KDF algorithm used to
            generate the Traffic_Key
</dd>
<dt>- Key_Length:</dt>
<dd>Length in bits required for the
            Traffic_Key used in this MAC
</dd>
<dt>- MAC_Length:</dt>
<dd>The final length of the bits used in
            the TCP-AO MAC field. This value may be a truncation of the MAC
            function's original output length.
</dd>
</dl></blockquote>

<p>MACs computed for TCP-AO have the following interface:
</p>
<p></p>
<blockquote class="text">
<p>MAC = MAC_alg(Traffic_Key, Message)
</p>
</blockquote>

<p>where:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- MAC_alg:</dt>
<dd>MAC Algorithm used
</dd>
<dt>- Traffic_Key:</dt>
<dd>Variable; the result of KDF.
</dd>
<dt>-  Message</dt>
<dd>The message to be authenticated, as
                specified in <a class='info' href='#I-D.ietf-tcpm-tcp-auth-opt'>[I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;auth&#8209;opt]<span> (</span><span class='info'>Touch, J., Mankin, A., and R. Bonica, &ldquo;The TCP Authentication Option,&rdquo; March&nbsp;2010.</span><span>)</span></a>
                Section 7.1.
</dd>
</dl></blockquote>

</blockquote>

<p>
</p>
<p>This document specifies two MAC algorithm options for generating
        the MAC as used by TCP-AO:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>*  HMAC-SHA-1-96</dt>
<dd>based on <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a> and <a class='info' href='#FIPS-180-3'>[FIPS&#8209;180&#8209;3]<span> (</span><span class='info'>FIPS Publication 180-3, &ldquo;Secured Hash Standard,&rdquo; October&nbsp;2008.</span><span>)</span></a>.
</dd>
<dt></dt>
<dd>
</dd>
<dt>*  AES-128-CMAC-96</dt>
<dd>based on <a class='info' href='#NIST-SP800-38B'>[NIST&#8209;SP800&#8209;38B]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of           Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a><a class='info' href='#FIPS197'>[FIPS197]<span> (</span><span class='info'>FIPS Publications 197, &ldquo;Advanced Encryption Standard (AES),&rdquo; November&nbsp;2001.</span><span>)</span></a>
</dd>
</dl></blockquote>

<p>
</p>
</blockquote><p>Both provide a high level of security and efficiency. The
        AES-128-CMAC-96 is potentially more efficient, particularly in
        hardware, but HMAC-SHA-1-96 is more widely used in Internet protocols
        and in most cases could be supported with little or no additional code
        in today's deployed software and devices.
</p>
<p>An important aspect to note about these algorithms' definitions for
        use in TCP-AO is the fact that the MAC outputs are truncated to 96
        bits. AES-128-CMAC-96 produces a 128 bit MAC, and HMAC SHA-1 produces
        a 160 bit result. The MAC output are then truncated to 96 bits to
        provide a reasonable tradeoff between security and message size, for
        fitting into the TCP-AO option field.
</p>
<p>
</p>
<p>
</p>
<a name="HMAC-SHA-1-96"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.1"></a><h3>3.2.1.&nbsp;
The Use of HMAC-SHA-1-96</h3>

<p>By definition, HMAC <a class='info' href='#RFC2104'>[RFC2104]<span> (</span><span class='info'>Krawczyk, H., Bellare, M., and R. Canetti, &ldquo;HMAC: Keyed-Hashing for Message Authentication,&rdquo; February&nbsp;1997.</span><span>)</span></a> requires a
          cryptographic hash function. SHA1 will be that hash function used
          for authenticating and providing integrity validation on TCP
          segments with HMAC.
</p>
<p>
</p>
<p>The three fixed elements for HMAC-SHA-1-96 are:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>- KDF_Alg:</dt>
<dd>KDF_HMAC_SHA1.
</dd>
<dt>- Key_Length:</dt>
<dd>160 bits.
</dd>
<dt>- MAC_Length:</dt>
<dd>96 bits.
</dd>
</dl></blockquote>

<p>
</p>
<p>For:
</p>
<p></p>
<blockquote class="text">
<p>MAC = MAC_alg (Traffic_Key, Message)
</p>
<p>
</p>
</blockquote>

<p>HMAC-SHA-1-96 for TCP-AO has the following values:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- MAC_alg:</dt>
<dd>HMAC-SHA1
</dd>
<dt>- Traffic_Key:</dt>
<dd>Variable; the result of the
                  KDF.
</dd>
<dt>- Message:</dt>
<dd>The message to be authenticated, as
                  specified in <a class='info' href='#I-D.ietf-tcpm-tcp-auth-opt'>[I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;auth&#8209;opt]<span> (</span><span class='info'>Touch, J., Mankin, A., and R. Bonica, &ldquo;The TCP Authentication Option,&rdquo; March&nbsp;2010.</span><span>)</span></a> Section 7.1.
</dd>
</dl></blockquote>

<p>
</p>
<p>
</p>
</blockquote>

<p>
</p>
<p>
</p>
<a name="AES-128-CMAC-96"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2.2"></a><h3>3.2.2.&nbsp;
The Use of AES-128-CMAC-96</h3>

<p>In the context of TCP-AO, when we say "AES-128-CMAC-96" we
          actually define a usage of AES-128 as a cipher-based MAC according
          to <a class='info' href='#NIST-SP800-38B'>[NIST&#8209;SP800&#8209;38B]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of           Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a>.
</p>
<p>The three fixed elements for AES-128-CMAC-96 are:
</p>
<p></p>
<blockquote class="text"><dl>
<dt>- KDF_Alg:</dt>
<dd>KDF_AES_128_CMAC.
</dd>
<dt>- Key_Length:</dt>
<dd>128 bits.
</dd>
<dt>- MAC_Length:</dt>
<dd>96 bits.
</dd>
</dl></blockquote>

<p>
</p>
<p>For:
</p>
<p></p>
<blockquote class="text">
<p>MAC = MAC_alg (Traffic_Key, Message)
</p>
<p>
</p>
</blockquote>

<p>AES-128-CMAC-96 for TCP-AO has the following values:
</p>
<p></p>
<blockquote class="text">
<p></p>
<blockquote class="text"><dl>
<dt>- MAC_alg:</dt>
<dd>AES-128-CMAC-96 <a class='info' href='#NIST-SP800-38B'>[NIST&#8209;SP800&#8209;38B]<span> (</span><span class='info'>National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of           Operation: The CMAC Mode for Authentication,&rdquo; May&nbsp;2005.</span><span>)</span></a>
</dd>
<dt>- Traffic_Key:</dt>
<dd>Variable; the result of the
                  KDF.
</dd>
<dt>- Message:</dt>
<dd>The message to be authenticated, as
                  specified in <a class='info' href='#I-D.ietf-tcpm-tcp-auth-opt'>[I&#8209;D.ietf&#8209;tcpm&#8209;tcp&#8209;auth&#8209;opt]<span> (</span><span class='info'>Touch, J., Mankin, A., and R. Bonica, &ldquo;The TCP Authentication Option,&rdquo; March&nbsp;2010.</span><span>)</span></a> Section 7.1.
</dd>
<dt></dt>
<dd>
</dd>
<dt></dt>
<dd>
</dd>
</dl></blockquote>

</blockquote>

<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security Considerations</h3>

<p>This document inherits all of the security considerations of the
      TCP-AO, the AES-CMAC, and the HMAC-SHA-1 documents.
</p>
<p>The security of cryptography-based systems depends on both the
      strength of the cryptographic algorithms chosen and the strength of the
      keys used with those algorithms. The security also depends on the
      engineering of the protocol used by the system to ensure that there are
      no non-cryptographic ways to bypass the security of the overall
      system.
</p>
<p>Care should also be taken to ensure that the selected key is
      unpredictable, avoiding any keys known to be weak for the algorithm in
      use. <a class='info' href='#RFC4086'>[RFC4086]<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Requirements for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a> contains helpful information on both
      key generation techniques and cryptographic randomness.
</p>
<p>Note that in the composition of KDF_AES_128_CMAC, the PRF needs a 128
      bit / 16 byte key as the seed. However, for convenience to the
      administrators/deployers, we did not want to force them to enter a 16
      byte Master_Key. So we specified the sub-key routine that could handle a
      variable length Master_Key, one that might be less than 16 bytes. This
      does NOT mean that administrators are safe to use weak keys.
      Administrators are encouraged to follow <a class='info' href='#RFC4086'>[RFC4086]<span> (</span><span class='info'>Eastlake, D., Schiller, J., and S. Crocker, &ldquo;Randomness Requirements for Security,&rdquo; June&nbsp;2005.</span><span>)</span></a>
      as listed above. We simply attempted to "put a fence around
      foolishness", in as much as possible.
</p>
<p>This document concerns itself with the selection of cryptographic
      algorithms for the use of TCP-AO. The algorithms identified in this
      document as "MUST implement" are not known to be broken at the current
      time, and cryptographic research so far leads us to believe that they
      will likely remain secure into the foreseeable future. Some of the
      algorithms may be found in the future to have properties significantly
      weaker than those that were believed at the time this document was
      produced. Expect that new revisions of this document will be issued from
      time to time. Be sure to search for more recent versions of this
      document before implementing.
</p>
<p>NOTE EXPLAINING WHY TWO MAC ALGORITHMS WERE MANDATED:
</p>
<p>Two MAC algorithms and two corresponding KDFs are mandated as a
      result of discussion in the TCPM WG, and in consultation with the
      Security Area Directors. SHA-1 was selected because it is widely
      deployed and currently has sufficient strength and reasonable
      computational cost, so it is a "MUST" for TCP-AO today. The security
      strength of SHA-1 HMACs should be sufficient for the foreseeable future,
      especially given that the tags are truncated to 96 bits.
</p>
<p>Recently exposed vulnerabilities in other MACs (e.g., MD5 or HMAC
      MD5) aren't practical on SHA-1, but these types of analyses are mounting
      and could potentially pose a concern for HMAC forgery if they were
      significantly improved, over time. The security issues driving the
      migration from SHA-1 to SHA-256 for digital signatures <a class='info' href='#HMAC-ATTACK'>[HMAC&#8209;ATTACK]<span> (</span><span class='info'>, &ldquo;On the Security of HMAC and NMAC Based           on HAVAL, MD4, MD5, SHA-0 and SHA-1&quot;,&rdquo; 2006.</span><span>)</span></a> do not immediately render SHA-1 weak for
      this application of SHA-1 in HMAC mode.
</p>
<p>AES-128 CMAC is considered to be a stronger algorithm than SHA-1, but
      may not yet have very wide implementation. AES-128 CMAC is also a "MUST"
      to implement, in order to drive vendors toward its use, and to allow for
      another MAC option, if SHA-1 were to be compromised.
</p>
<p>
</p>
<p>
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
</p>
<p>Upon approval of this document, IANA will create the following
	registry at http://www.iana.org/assignments/TBD
</p>
<p>Registry Name: Cryptographic Algorithms for TCP-AO
	   Registration Procedure: RFC Publication after Expert Review
</p>
<p>Initial contents of this registry will be:
</p>
<p>
</p>
<p>Algorithm | Reference
</p>
<p>----------------|-----------
</p>
<p>SHA1 | [RFC-tcpm-tcp-ao-crypto]
</p>
<p>AES128  | [RFC-tcpm-tcp-ao-crypto]
</p>
<p>
</p>
<p>
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Acknowledgements</h3>

<p>Eric "EKR" Rescorla, who provided a ton of input and feedback,
      including a somewhat heavy re-write of section 3.1.x, earning him an
      author slot on the document.
</p>
<p>Paul Hoffman, from whose <a class='info' href='#RFC4308'>[RFC4308]<span> (</span><span class='info'>Hoffman, P., &ldquo;Cryptographic Suites for IPsec,&rdquo; December&nbsp;2005.</span><span>)</span></a> I sometimes
      copied, to quickly create a first draft here.
</p>
<p>Tim Polk, whose email summarizing SAAG's guidance to TCPM on the two
      hash algorithms for TCP-AO is largely cut and pasted into various
      sections of this document.
</p>
<p>Jeff Schiller, Donald Eastlake and the IPsec WG, whose <a class='info' href='#RFC4307'>[RFC4307]<span> (</span><span class='info'>Schiller, J., &ldquo;Cryptographic Algorithms for Use in the Internet Key Exchange Version 2 (IKEv2),&rdquo; December&nbsp;2005.</span><span>)</span></a> &amp; <a class='info' href='#RFC4835'>[RFC4835]<span> (</span><span class='info'>Manral, V., &ldquo;Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH),&rdquo; April&nbsp;2007.</span><span>)</span></a> text was
      consulted and sometimes used in the Requirements <a class='info' href='#Requirements'>Section&nbsp;2<span> (</span><span class='info'>Requirements</span><span>)</span></a> section of this document.
</p>
<p>(In other words, I was truly only an editor of others' text in
      creating this document.)
</p>
<p>Eric "EKR" Rescorla and Brian Weis, who brought to clarity the issues
      with the inputs to PRFs for the KDFs. EKR was also of great assistance
      in how to structure the text, as well as helping to guide good
      cryptographic decisions.
</p>
<p>The TCPM working group, who put up with all us crypto and routing
      folks DoS'ing their WG for 2 years, and who provided reviews of this
      document.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="FIPS-180-3">[FIPS-180-3]</a></td>
<td class="author-text">FIPS Publication 180-3, &ldquo;Secured Hash Standard,&rdquo; FIPS&nbsp;180-3, October&nbsp;2008.</td></tr>
<tr><td class="author-text" valign="top"><a name="FIPS197">[FIPS197]</a></td>
<td class="author-text">FIPS Publications 197, &ldquo;Advanced Encryption Standard (AES),&rdquo; FIPS&nbsp;197, November&nbsp;2001.</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-tcpm-tcp-auth-opt">[I-D.ietf-tcpm-tcp-auth-opt]</a></td>
<td class="author-text">Touch, J., Mankin, A., and R. Bonica, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-auth-opt-11.txt">The TCP Authentication Option</a>,&rdquo; draft-ietf-tcpm-tcp-auth-opt-11 (work in progress), March&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-tcpm-tcp-auth-opt-11.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST-SP800-108">[NIST-SP800-108]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Recommendation for Key Derivation Using Pseudorandom Functions, NIST SP800-108,&rdquo; SP&nbsp;800-108, October&nbsp;2009.</td></tr>
<tr><td class="author-text" valign="top"><a name="NIST-SP800-38B">[NIST-SP800-38B]</a></td>
<td class="author-text">National Institute of Standards and Technology, &ldquo;Recommendation for Block Cipher Modes of
          Operation: The CMAC Mode for Authentication,&rdquo; SP&nbsp;800-38B, May&nbsp;2005.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2104">[RFC2104]</a></td>
<td class="author-text"><a href="mailto:hugo@watson.ibm.com">Krawczyk, H.</a>, <a href="mailto:mihir@cs.ucsd.edu">Bellare, M.</a>, and <a href="mailto:canetti@watson.ibm.com">R. Canetti</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2104">HMAC: Keyed-Hashing for Message Authentication</a>,&rdquo; RFC&nbsp;2104, February&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2104.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="HMAC-ATTACK">[HMAC-ATTACK]</a></td>
<td class="author-text">&ldquo;<a href="http://eprint.iacr.org/2006/187  http://www.springerlink.com/content/00w4v62651001303">On the Security of HMAC and NMAC Based
          on HAVAL, MD4, MD5, SHA-0 and SHA-1"</a>,&rdquo; 2006.</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4086">[RFC4086]</a></td>
<td class="author-text">Eastlake, D., Schiller, J., and S. Crocker, &ldquo;<a href="http://tools.ietf.org/html/rfc4086">Randomness Requirements for Security</a>,&rdquo; BCP&nbsp;106, RFC&nbsp;4086, June&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4086.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4307">[RFC4307]</a></td>
<td class="author-text">Schiller, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4307">Cryptographic Algorithms for Use in the Internet Key Exchange Version 2 (IKEv2)</a>,&rdquo; RFC&nbsp;4307, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4307.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4308">[RFC4308]</a></td>
<td class="author-text">Hoffman, P., &ldquo;<a href="http://tools.ietf.org/html/rfc4308">Cryptographic Suites for IPsec</a>,&rdquo; RFC&nbsp;4308, December&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4308.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4615">[RFC4615]</a></td>
<td class="author-text">Song, J., Poovendran, R., Lee, J., and T. Iwata, &ldquo;<a href="http://tools.ietf.org/html/rfc4615">The Advanced Encryption Standard-Cipher-based Message Authentication Code-Pseudo-Random Function-128 (AES-CMAC-PRF-128) Algorithm for the Internet Key Exchange Protocol (IKE)</a>,&rdquo; RFC&nbsp;4615, August&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4615.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4835">[RFC4835]</a></td>
<td class="author-text">Manral, V., &ldquo;<a href="http://tools.ietf.org/html/rfc4835">Cryptographic Algorithm Implementation Requirements for Encapsulating Security Payload (ESP) and Authentication Header (AH)</a>,&rdquo; RFC&nbsp;4835, April&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4835.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gregory Lebovitz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Juniper Networks, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">1194 North Mathilda Ave.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sunnyvale, CA  94089-1206</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:gregory.ietf@gmail.com">gregory.ietf@gmail.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Eric Rescorla</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">RTFM, Inc.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">2064 Edgewood Drive</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Palo Alto, CA  94303</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">US</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">650-678-2350</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ekr@rtfm.com">ekr@rtfm.com</a></td></tr>
</table>
</body></html>
