<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>DKIM Author Domain Signing Practices (ADSP)</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="DKIM Author Domain Signing Practices (ADSP)">
<meta name="keywords" content="email, e-mail, rfc2822, rfc 2822, rfc822, rfc 822, rfc2821, rfc 2821, rfc821, rfc 821,
      rfc4871, rfc 4871, DKIM, domain keys, domainkeys, ADSP, ADSP, SSP, architecture, mta, user,
      delivery, smtp, submission, email, e-mail, smtp, Internet, mailfrom, mail from, author, return
      address, sender signing, signing practices, key domain, author key domain, author address,
      author domain">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">DKIM Working Group</td><td class="header">D. Otis</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Trend Micro, NSSG</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">June 26, 2008</td></tr>
<tr><td class="header">Expires: December 28, 2008</td><td class="header">&nbsp;</td></tr>
</table></td></tr></table>
<h1><br />DKIM Author Domain Signing Practices (ADSP)<br />draft-otis-dkim-adsp-04</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on December 28, 2008.</p>

<h3>Abstract</h3>

<p>DomainKeys Identified Mail (DKIM) as described in <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>, defines a
        domain-level authentication framework for email to permit verification of the source and
        contents of messages. This document specifies an adjunct mechanism to aid in assessing
        messages that lack valid DKIM signatures for domains used in the author's address. It
        defines a record that can advertise the extent to which a domain signs outgoing mail that is
        publicly exchanged on SMTP port 25, as described in <a class='info' href='#RFC2821'>[RFC2821]<span> (</span><span class='info'>Klensin, J., &ldquo;Simple Mail Transfer Protocol,&rdquo; April&nbsp;2001.</span><span>)</span></a>. Also, how
        other hosts can access those records.
</p>
<p>Advertisements, defined by this document, may also increase DKIM signature expectations for
        messages received by Mail User Agents (MUAs) or for messages which might have been exchanged
        over protocols other than SMTP. In some circumstances, author domains may wish to have
        accommodations for protocol failures or for mixed public protocol messaging not to be made.
</p>
<p>In addition, DKIM's identity parameters related to the author address are decisive only
        when a corresponding DKIM key local-part template precludes an author address. DKIM in
        conjunction with ADSP is to provide methods for detecting the spoofing of known domains, but
        not for making strong assertions about the identity of the message author.
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#anchor2">2.</a>&nbsp;
Language and Terminology<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Terms Imported from DKIM Signatures Specification<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">2.2.</a>&nbsp;
Valid Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">2.3.</a>&nbsp;
Valid Author Signature<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">2.4.</a>&nbsp;
Key Domain<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">2.5.</a>&nbsp;
Author Key Domain<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">2.6.</a>&nbsp;
Author Address<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">2.7.</a>&nbsp;
Author Domain<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">2.8.</a>&nbsp;
Author Domain Signing Practices<br />
<a href="#anchor11">3.</a>&nbsp;
Operation Overview<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">3.1.</a>&nbsp;
ADSP Discovery Results Usage<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">3.2.</a>&nbsp;
ADSP Discovery Results<br />
<a href="#anchor14">4.</a>&nbsp;
Detailed Description<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#dnsrep">4.1.</a>&nbsp;
DNS Representation<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">4.2.</a>&nbsp;
Publication of ADSP Records<br />
<a href="#anchor16">5.</a>&nbsp;
IANA Considerations<br />
<a href="#anchor17">6.</a>&nbsp;
Security Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">6.1.</a>&nbsp;
ADSP Threat Model<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">6.2.</a>&nbsp;
DNS Attacks<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#wildcards">6.3.</a>&nbsp;
DNS Wildcards<br />
<a href="#rfc.references1">7.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">7.1.</a>&nbsp;
References - Normative<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">7.2.</a>&nbsp;
References - Informative<br />
<a href="#anchor22">Appendix&nbsp;A.</a>&nbsp;
Usage Examples<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">A.1.</a>&nbsp;
Single Location Domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">A.2.</a>&nbsp;
Bulk Mailing Domains<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor25">A.3.</a>&nbsp;
Commonly Forged Transactional Messages<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor26">A.4.</a>&nbsp;
Third Party Senders<br />
<a href="#anchor27">Appendix&nbsp;B.</a>&nbsp;
Acknowledgements<br />
<a href="#anchor28">Appendix&nbsp;C.</a>&nbsp;
Update History<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">C.1.</a>&nbsp;
Changes to draft-otis-dkim-adsp-00<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">C.2.</a>&nbsp;
Changes to draft-otis-dkim-adsp-01<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">C.3.</a>&nbsp;
Changes to draft-otis-dkim-adsp-02<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">C.4.</a>&nbsp;
Changes to draft-otis-dkim-adsp-03<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Author's Address<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>DomainKeys Identified Mail (DKIM) defines a mechanism by which email messages can be
        cryptographically signed, permitting a Key Domain to claim responsibility for the
        introduction of a message. Receiving hosts can verify the signature by querying the Key
        Domain to retrieve the appropriate public key, and thereby confirming that a message has
        been attested to by a party in possession of the private key and in control of a portion of
        the Key Domain.
</p>
<p>However, the legacy of the Internet is such that not all messages will be signed or will
        retain a valid signature, and that absence of a valid signature on a message is not an
          <tt>a priori</tt> indication of forgery. In fact, during early phases
        of deployment, it is likely that most messages will remain unsigned. However, some domains
        might decide to sign all of their outgoing mail, for example, to better protect their brand
        name. It is desirable for such domains to be able to advertise that fact to other hosts.
        This is the premise of Author Domain Signing Practices (ADSP).
</p>
<p>Receiving hosts implementing this specification ensure greater safety by first inquiring
        into the validity of the SMTP domain before attempting a series of transactions related to
        DKIM validations. The transactions pertaining to this document determine Author Domain
        Signing Practices advertised by the Author Domains. This determination is called ADSP
        Discovery.
</p>
<p>The detailed requirements for Author Domain Signing Practices are given in <a class='info' href='#RFC5016'>[RFC5016]<span> (</span><span class='info'>Thomas, M., &ldquo;Requirements for a DomainKeys Identified Mail (DKIM) Signing Practices Protocol,&rdquo; October&nbsp;2007.</span><span>)</span></a>. This document refers extensively to <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> and
        assumes the reader is familiar with it.
</p>
<p>
        </p>
<blockquote class="text"><dl>
<dt>Requirements Notation:</dt>
<dd> The key words "MUST", "MUST NOT", "REQUIRED",
            "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in
            this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>
          
</dd>
</dl></blockquote><p>
      
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Language and Terminology</h3>

<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Terms Imported from DKIM Signatures Specification</h3>

<p>Some terminology used herein is derived directly from <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. In
          several cases, references in that document to Sender have been changed to Author here, to
          emphasize the relationship to the Author address(es) in the From: header field described
          in <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>.
</p>
<p>In addition, <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> requires that a valid signature having a
          restrictive local-part template, the key's <tt>g=</tt> tag and value,
          must match against an undefined <tt>signing address</tt>. The <tt>signing address</tt> could be understood to be the email address
          associated with the signature's <tt>on behalf of</tt> identity which
          would be the <tt>i=</tt> tag and value or its default, but the benefit
          of this check is limited since DKIM signatures are not normally displayed. This document
          seeks to clearly define the <tt>signing address</tt> used in
          conjunction with a restrictive key's local-part template as being the <tt>Author Address</tt>. Briefly, </p>
<ul class="text">
<li>The <tt>local-part</tt> is the part of an address preceding the
                <tt>@</tt> sign, as defined in <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a> and used
              in <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</li>
</ul>

<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Valid Signature</h3>

<p>A <tt>Valid Signature</tt> is any message signature which correctly
          verifies using procedures described in section 6.1 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.3"></a><h3>2.3.&nbsp;
Valid Author Signature</h3>

<p>A <tt>Valid Author Signature</tt> is any message signature which
          correctly verifies using procedures described in section 6.1 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>,
          and where the local-part template, the key <tt>g=</tt> tag and value,
          and the Key Domain, match against the Author Address.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.4"></a><h3>2.4.&nbsp;
Key Domain</h3>

<p>The <tt>Key Domain</tt> is the domain listed in the <tt>d=</tt> tag of a Valid Signature.
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.5"></a><h3>2.5.&nbsp;
Author Key Domain</h3>

<p>The <tt>Author Key Domain</tt> is the domain listed in the <tt>d=</tt> tag of a Valid Author Signature that is at or above the Author
          Domain. The Author Key Domain must match all of its domain components with that of the
          Author Domain. When a referenced Key contains a <tt>t=s</tt> tag and
          value, the Author Key Domain will contain the entire Author Domain for the signature to be
          valid.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.6"></a><h3>2.6.&nbsp;
Author Address</h3>

<p>An <tt>Author Address</tt> is an email address in the From header
          field of a message <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>. If the From header field contains multiple
          addresses, the message has multiple Author Addresses.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.7"></a><h3>2.7.&nbsp;
Author Domain</h3>

<p>An <tt>Author Domain</tt> is determined by the entire right-hand-side
          of the Author Address (the portion that is to the right of the <tt>@</tt>, excluding the <tt>@</tt> itself).
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.8"></a><h3>2.8.&nbsp;
Author Domain Signing Practices</h3>

<p><tt>Author Domain Signing Practices</tt> (or just <tt>practices</tt>) consist of a machine-readable record published at the <tt>_adsp.</tt> subdomain of the Author Domain. The ADSP record includes
          statements about outgoing mail practices for messages containing the Author Domain.
</p>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Operation Overview</h3>

<p>Domain owners can publish Author Domain Signing Practices via a distribution service, such
        as the Domain Name System; specific details related to the use of DNS are given in <a class='info' href='#dnsrep'>Section&nbsp;4.1<span> (</span><span class='info'>DNS Representation</span><span>)</span></a>.
</p>
<p>Hosts can obtain Author Domain Signing Practices of the domain(s) specified by the Author
        Domain as described in <a class='info' href='#checkproc'>Section&nbsp;4.2.2<span> (</span><span class='info'>Author Signing Practices Discovery Procedure</span><span>)</span></a>. If a message has multiple Author
        Addresses, ADSP Discovery SHOULD be performed independently. This standard will not cover
        the consolidation of combined ADSP Discovery results.
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
ADSP Discovery Results Usage</h3>

<p>A receiving host might obtain varying amounts of useful information through ADSP
          Discovery. Such as:</p>
<ul class="text">
<li>When a message has a Valid Author Signature, the ADSP Discovery result is of no
              benefit since the message is compliant with any possible ADSP assertion.
</li>
<li>When a message has a Valid Signature that is not also a Valid Author Signature, the
              ADSP Discovery result, in conjunction with the Key Domain of the Valid Signature, is
              directly relevant to message assessment.
</li>
<li>When a message is without a Valid Signature, the ADSP Discovery result at the Author
              Domain is directly relevant to message assessment.
</li>
</ul>

<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
ADSP Discovery Results</h3>

<p>Author Domain Signing Practices Discovery at an Author Domain provide four possible
            results:</p>
<ul class="text">
<li>Message contains an Author Domain that does not advertise practices.
</li>
<li>Message contains an Author Domain that advertises practices indicating they do not
              ensure messages are initially signed by an Author Key Domain.
</li>
<li>Message contains an Author Domain that advertises practices indicating they ensure
              messages are initially signed by an Author Key Domain.
</li>
<li>Message contains an Author Domain that advertises practices indicating they ensure
              messages are initially signed, and they recommend dismissing messages not signed by an
              Author Key Domain.
</li>
</ul>

<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Detailed Description</h3>

<a name="dnsrep"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
DNS Representation</h3>

<p>Author Signing Practices records are published using the DNS TXT resource record type.
            </p>
<blockquote class="text"><dl>
<dt>NON-NORMATIVE DISCUSSION [to be removed before publication]:</dt>
<dd> There has
              been considerable discussion on the DKIM WG mailing list regarding the relative
              advantages of TXT and a new resource record (RR) type. Read the archive for
            details.
</dd>
</dl></blockquote>

<p>The RDATA for ADSP resource records is textual in format, with specific syntax and
          semantics relating to their role in describing Author Domain Signing Practices. The <tt>Tag=Value List</tt> syntax described in section 3.2 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a> is to be used. Records not in compliance with that syntax or with the
          syntax of individual tags described in Section 4.3 MUST be ignored, although they MAY
          cause the logging of warning messages via an appropriate system logging mechanism. If the
          RDATA contains multiple character strings, the strings are to be logically concatenated
          with no delimiters placed between the strings.
</p>
<p>The ADSP record for an Author Domain is published at a <tt>_adsp.</tt>
          subdomain directly below the Author Domain; e.g., the ADSP record for <tt>example.com</tt> would be a TXT record that is published at <tt>_adsp.example.com</tt>. A domain MUST NOT publish more than one ADSP record; the
          semantics of an ADSP transaction returning multiple ADSP records for a single domain are
          undefined. (Note that <tt>example.com</tt> and <tt>mail.example.com</tt> are different domains.)
</p>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Publication of ADSP Records</h3>

<p>Author Domain Signing Practices are intended to apply to all mail containing the Author
          Domain. As a defensive strategy against subdomain spoofing, ADSP records can be placed at
          domains that might appear to support SMTP.
</p>
<p>Wildcards within a domain that is also publishing ADSP records will not pose a problem.
          This is discussed in more detail in <a class='info' href='#wildcards'>Section&nbsp;6.3<span> (</span><span class='info'>DNS Wildcards</span><span>)</span></a>.
</p>
<a name="syntax"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.1"></a><h3>4.2.1.&nbsp;
Record Syntax</h3>

<p>ADSP records use the "tag=value" syntax described in section 3.2 of <a class='info' href='#RFC4871'>[RFC4871]<span> (</span><span class='info'>Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;DomainKeys Identified Mail (DKIM) Signatures,&rdquo; May&nbsp;2007.</span><span>)</span></a>. Terms used to describe signing practices employ a metaphor of a
            door to avoid connotations that might differ from definitions given in this document.
</p>
<p>Tags used in ADSP records are described below. Unrecognized tags MUST be ignored. In
            the ABNF below, the WSP token is imported from <a class='info' href='#RFC2822'>[RFC2822]<span> (</span><span class='info'>Resnick, P., &ldquo;Internet Message Format,&rdquo; April&nbsp;2001.</span><span>)</span></a>. The ALPHA and
            DIGIT tokens are imported from <a class='info' href='#RFC5234'>[RFC5234]<span> (</span><span class='info'>Crocker, D. and P. Overell, &ldquo;Augmented BNF for Syntax Specifications: ABNF,&rdquo; January&nbsp;2008.</span><span>)</span></a>. <br />
<br />

            </p>
<blockquote class="text"><dl>
<dt>dkim=</dt>
<dd> practices (plain-text; REQUIRED). Possible values are as follows:
                  
<blockquote class="text"><dl>
<dt>OPEN</dt>
<dd> (Default) The Author Domain practice permits unsigned outbound
                    mail.
</dd>
<dt>CLOSED</dt>
<dd> The Author Domain practice always initially signs mail
                    containing the Author Domain by an Author Key Domain.
</dd>
<dt>LOCKED</dt>
<dd> The Author Domain practice always initially signs mail
                    containing the Author Domain by an Author Key Domain. Furthermore, when a
                    message is received without a Valid Author Signature, receiving hosts are
                    requested to dismiss such messages.
</dd>
</dl></blockquote>
                
<p>ABNF:
</p><div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
      adsp-dkim-tag = %x64.6b.69.6d *WSP "="
          *WSP ("OPEN" / "CLOSED" / "LOCKED")
</pre></div>
              
</dd>
</dl></blockquote>

<a name="checkproc"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2.2"></a><h3>4.2.2.&nbsp;
Author Signing Practices Discovery Procedure</h3>

<p>Hosts performing ADSP Discovery should first exclude SMTP clients with a demonstrated
            history of abuse. Also, the transactions needed for ADSP Discovery or DKIM signature
            validation should be subsequent to some confirmation that the Author Domain might
            support SMTP. In addition, hosts may consider some domains to be exempt, such as Top
            Level Domains (TLDs) listed in <a class='info' href='#RFC2606'>[RFC2606]<span> (</span><span class='info'>Eastlake, D. and A. Panitz, &ldquo;Reserved Top Level DNS Names,&rdquo; June&nbsp;1999.</span><span>)</span></a>, for example <tt>.invalid</tt>. <a class='info' href='#RFC2606'>[RFC2606]<span> (</span><span class='info'>Eastlake, D. and A. Panitz, &ldquo;Reserved Top Level DNS Names,&rdquo; June&nbsp;1999.</span><span>)</span></a> does not represent a comprehensive list of
            all possible exempted domains which might also include <tt>.local</tt>, therefore, appending to a list of exempted domains may be required.
</p>
<p>For the purposes of this section, a <tt>valid ADSP record</tt> is
            one that is both syntactically and semantically correct; in particular, it matches the
            ABNF for a <tt>tag-list</tt> and includes a defined <tt>dkim=</tt> tag.</p>
<blockquote class="text"><dl>
<dt></dt>
<dd><em>ADSP Discovery.</em> The host SHOULD query DNS for a TXT record
                corresponding to the Author Domain prefixed by <tt>_adsp.</tt>
                (note the trailing dot). The results returned by this operation would be the value
                of the <tt>dkim</tt> tag or the value of <tt>MISSING</tt> when none exist.<br />

</dd>
<dt>NON-NORMATIVE DISCUSSION:</dt>
<dd> Rather than placing ADSP records below the
                  <tt>_domainkey.</tt> prefix used by DKIM, <tt>_adsp.</tt> prefixed to the Author Domain reduces the number of DNS entities
                needed when ADSP records are desired at every address record. Delegation of a domain
                at or below <tt>_domainkey.</tt> and at <tt>_adsp.</tt> may be required when consolidating control of DNS entries related
                to DKIM.
</dd>
</dl></blockquote>

<p>When any of the DNS transactions involved in ADSP Discovery result in a temporary error
            condition, the algorithm terminates without returning a result; possible actions include
            queuing the message or returning an SMTP error indicating a temporary failure.
</p>
<p>
            </p>
<blockquote class="text"><dl>
<dt>NON-NORMATIVE NOTE:</dt>
<dd> Within a DNS transaction, as defined by <a class='info' href='#RFC1034'>[RFC1034]<span> (</span><span class='info'>Mockapetris, P., &ldquo;Domain names - concepts and facilities,&rdquo; November&nbsp;1987.</span><span>)</span></a> section 5.2.2 and <a class='info' href='#RFC4034'>[RFC4034]<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;Resource Records for the DNS Security Extensions,&rdquo; March&nbsp;2005.</span><span>)</span></a> section 3, when a
                CNAME is returned, the alias name is to be processed as if it were the initial name.
                  <a class='info' href='#RFC2181'>[RFC2181]<span> (</span><span class='info'>Elz, R. and R. Bush, &ldquo;Clarifications to the DNS Specification,&rdquo; July&nbsp;1997.</span><span>)</span></a> section 10.3 makes an exception for Exchange host names
                returned by MX records. An Exchange host name must not return a CNAME.
</dd>
</dl></blockquote><p>
          
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>ADSP introduces the <tt>_adsp</tt> name into currently unregistered name
        space. Although domain names beginning with an underscore will not collide with host names,
        service names for <a class='info' href='#RFC2782'>[RFC2782]<span> (</span><span class='info'>Gulbrandsen, A., Vixie, P., and L. Esibov, &ldquo;A DNS RR for specifying the location of services (DNS SRV),&rdquo; February&nbsp;2000.</span><span>)</span></a> SRV records and labels for TXT records, defined
        by other protocols, reference underscore prefixed names to designate specific use. </p>
<blockquote class="text"><dl>
<dt>INFORMATIVE NOTE [to be removed before publication]:</dt>
<dd> If at the time of
            publication no registry has been established or is planned for underscore prefixed
            names, this section may be removed.
</dd>
</dl></blockquote>

<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Security Considerations</h3>

<p>Security considerations in the Author Domain Signing Practices mostly relate to attempts on
        the part of malicious senders to represent themselves as sending messages from the Author
        Domain for whom they are not authorized to use in their message. This is often done in an
        attempt to defraud recipients of the message.
</p>
<p>DKIM keys with a restrictive local-part template in the <tt>g=</tt> tag
        and value are likely to be employed for untrusted systems that are beyond the direct control
        of the Author Key Domain. As a result, additional care should be taken when a restrictive
        local-part template does not match against the Author Address. Signatures, where a
        restrictive local-part key <tt>g=</tt> tag and value and the Key Domain
        do not match against the Author Addresses, should be considered invalid.
</p>
<p>Signatures with restrictive local-part keys where the signing address is not that of the
        Author Address will be deceptive when marked as valid. Recipients are often unaware of the
        signature's <tt>on behalf of</tt> identity that is not normally
        displayed. In addition, these keys are prone to theft since they are also likely to be used
        by less secure mobile users, for example.
</p>
<p>Signatures with DKIM keys lacking a restrictive local-part template are only safely added
        when the Author Key Domain is able to directly evaluate signed header fields and content.
        Recognition of directly controlled signing improves security in several ways:</p>
<blockquote class="text"><dl>
<dt></dt>
<dd>Discerns potentially deceptive signatures independent of ADSP Discovery.
</dd>
<dt></dt>
<dd>Permits the accurate indication of on whose behalf the signature was added, even when
            not on behalf of the Author Address.
</dd>
<dt></dt>
<dd>Permits the <tt>on behalf of</tt> identity to be derived from an
            account instead of being omitted when the Author Key Domain is unable or unwilling to
            affirm the identity of the Author Address.
</dd>
<dt></dt>
<dd>Permits the identity to track either the author or the account used. This ability can
            be useful to third-parties who are attempting to isolate bot-net 0wned systems. In
            response to a growing portion of the IP address space being blocked, bot-nets
            increasingly send their mail through a provider's outbound server after obtaining access
            to valid accounts.
</dd>
</dl></blockquote>

<p>Additional security considerations regarding Author Domain Signing Practices are found in
          <a class='info' href='#RFC4686'>the DKIM threat analysis<span> (</span><span class='info'>Fenton, J., &ldquo;Analysis of Threats Motivating DomainKeys Identified Mail (DKIM),&rdquo; September&nbsp;2006.</span><span>)</span></a> [RFC4686].
</p>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
ADSP Threat Model</h3>

<p>Email recipients often have a core set of Author Domains that they trust. Common examples
          include those of financial institutions with which they have an existing relationship and
          Internet web commerce sites with which they conduct business. DKIM validation and ADSP
          Discovery results will not provide any benefit unless receiving hosts either treat the
          messages differently during delivery, or provide some indicator to the end recipient. Such
          email annotation is out of scope for this document.
</p>
<p>Bad actors often seek to exploit the name-recognition of a trusted Author Domain. This
          might be done by just spoofing display-names, or by placing user local-parts above
          subdomains or cousin domains in the From: header field. This problem is made worse by
          popular MUAs that do not display actual email addresses. As a result, there is no
          empirical evidence showing to what extent unauthorized use of a domain name contributes to
          recipient deception, nor that its elimination will provide a significant effect.
          Nevertheless, the automated accrual of behavioural feedback that ignores invalid
          identifiers better ensures that systematic confidence is retained for trusted Author Key
          Domains.
</p>
<p>Training recipients to use automated folder placement could also help reduce deceptions
          that utilize domain look-alike and subdomain based tactics. In addition, automated
          recognition facilitates optimized processing by receiver-side message filtering engines
          that attempt to curb unauthorized uses of domain names, organizations' names, and their
          logos elsewhere within the message. These attacks and their mitigation are also outside
          the scope of this document.
</p>
<p>The ADSP Discovery algorithm performs one DNS transaction per Author Domain. Since this
          transaction, as well as the ones needed to validate the DKIM signature, are driven by
          domain names in email message headers of possibly fraudulent email, receiving hosts
          attempting ADSP Discovery and DKIM validation can become participants in traffic
          multiplication attacks.
</p>
<p>These attacks often target servers consolidating and distributing behavioral information
          about bad-actor activities. Such attacks may dramatically impact the cost of offering the
          protective service. As a result, a reduction in number of those offering consolidated
          behavioral information places the remaining providers in greater jeopardy of receiving a
          larger portion of the abuse.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
DNS Attacks</h3>

<p>An attack might be waged against DNS infrastructure in an attempt to disable services
          dependent upon DNS. Such attacks could be made worse when receiving hosts employ ADSP
          Discovery and DKIM validation. A goal to <tt>First, do no harm</tt> is
          increasingly difficult to achieve when confronting massive bot-nets. For this reason, SMTP
          should consider eventually making MX records mandatory for the acceptance of public
          exchanges. The ADSP Discovery process is not expected to impact the likelihood of an
          attacker being successful at poisoning local DNS resolvers. In addition, such DNS security
          issues are addressed by <a class='info' href='#RFC4033'>DNSSEC<span> (</span><span class='info'>Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;DNS Security Introduction and Requirements,&rdquo; March&nbsp;2005.</span><span>)</span></a> [RFC4033].
</p>
<p>Although a steady attack may not cause a denial of service, it can consume significant
          resources related to <tt>in the cloud</tt> consolidation and
          distribution of behavioral information. A typical strategy used by bad actors employing
          bot-nets is to rapidly transition from an active to a dormant state. The duration of
          activity experienced by an SMTP server is often brief, and is then followed by a fairly
          long dormant period. This tactic proves challenging for defensive strategies attempted by
          individual hosts. There is some evidence that there may be tens of millions of bot-net
          controlled systems in the active state, while hundreds of millions appear dormant to
          individual SMTP servers.
</p>
<p>Consolidating and distributing behavioral information offers receiving hosts a defensive
          tactic that can minimize the effectiveness of the blitzkrieg or fast-flux tactic.
          Unfortunately, often part of a bad-actor's strategy is to inundate behavioral repositories
          with virtual identifiers. For DKIM, the signature's identity, <tt>i=</tt> tag and value, and key selector, <tt>s=</tt> tag and value,
          can be synthesized since wildcard domain support is possible, unlike for the Key Domain
            <tt>d=</tt> tag and value, or the location of the ADSP record.
</p>
<p>Because ADSP operates within the framework of the legacy e-mail system, the default
          result in the absence of an ADSP record is for the Author Domain to be considered <tt>OPEN</tt> where not all messages are expected to be signed by a Author
          Key Domain. It is therefore important that the ADSP clients distinguish a DNS failure such
          as <tt>SERVFAIL</tt> from other DNS errors, so that appropriate actions
          can be taken.
</p>
<p>It is likely that DKIM's and ADSP's combined roles will be to prevent deception when used
          in conjunction with automated folder placement of domains considered trustworthy. To
          ensure message reception remains viable for crucial systems when DNS fails, the IP
          addresses of crucial SMTP clients should be white-listed. This will allow ADSP and DKIM to
          be selectively bypassed during such events.
</p>
<a name="wildcards"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.3"></a><h3>6.3.&nbsp;
DNS Wildcards</h3>

<p>With the exception of wildcard MX records, wildcards within a domain that also publish
          ADSP records do not pose a significant problem. Although referencing SMTP related records
          will not provide <tt>NXDOMAIN</tt> results when a domain contains a
          wildcard, SMTP discovery records, such as MX or A records, still offer evidence of SMTP
          support. Whether AAAA records, absent MX or A records, can be considered evidence of SMTP
          support has not withstood widespread use of AAAA only servers.<br />
<br />

</p>
<p>
          </p>
<blockquote class="text"><dl>
<dt>NON-NORMATIVE NOTE:</dt>
<dd> Complete ADSP coverage for all subdomains of a domain
              remains possible. However, ADSP records would need to be published at every subdomain
              containing A records, in addition to subdomains containing MX records. When SMTP
              adopts an MX record mandate for the acceptance of public exchanges, only then could
              ADSP records be limited to subdomains containing the MX records. This strategy would
              also shelter domains not publishing MX records from the additional transactions
              associated with any number of Author Addresses and DKIM signatures that might be
              generated per message.
</dd>
</dl></blockquote><p>
        
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.1.&nbsp;References - Normative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1034">[RFC1034]</a></td>
<td class="author-text">Mockapetris, P., &ldquo;<a href="http://tools.ietf.org/html/rfc1034">Domain names - concepts and facilities</a>,&rdquo; STD&nbsp;13, RFC&nbsp;1034, November&nbsp;1987 (<a href="http://www.rfc-editor.org/rfc/rfc1034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2181">[RFC2181]</a></td>
<td class="author-text"><a href="mailto:kre@munnari.OZ.AU">Elz, R.</a> and <a href="mailto:randy@psg.com">R. Bush</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2181">Clarifications to the DNS Specification</a>,&rdquo; RFC&nbsp;2181, July&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2181.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2181.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2181.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2606">[RFC2606]</a></td>
<td class="author-text"><a href="mailto:dee3@us.ibm.com">Eastlake, D.</a> and <a href="mailto:buglady@fuschia.net">A. Panitz</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2606">Reserved Top Level DNS Names</a>,&rdquo; BCP&nbsp;32, RFC&nbsp;2606, June&nbsp;1999 (<a href="http://www.rfc-editor.org/rfc/rfc2606.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2821">[RFC2821]</a></td>
<td class="author-text">Klensin, J., &ldquo;<a href="http://tools.ietf.org/html/rfc2821">Simple Mail Transfer Protocol</a>,&rdquo; RFC&nbsp;2821, April&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2821.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2822">[RFC2822]</a></td>
<td class="author-text">Resnick, P., &ldquo;<a href="http://tools.ietf.org/html/rfc2822">Internet Message Format</a>,&rdquo; RFC&nbsp;2822, April&nbsp;2001 (<a href="http://www.rfc-editor.org/rfc/rfc2822.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4033">[RFC4033]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4033">DNS Security Introduction and Requirements</a>,&rdquo; RFC&nbsp;4033, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4033.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4034">[RFC4034]</a></td>
<td class="author-text">Arends, R., Austein, R., Larson, M., Massey, D., and S. Rose, &ldquo;<a href="http://tools.ietf.org/html/rfc4034">Resource Records for the DNS Security Extensions</a>,&rdquo; RFC&nbsp;4034, March&nbsp;2005 (<a href="http://www.rfc-editor.org/rfc/rfc4034.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4686">[RFC4686]</a></td>
<td class="author-text">Fenton, J., &ldquo;<a href="http://tools.ietf.org/html/rfc4686">Analysis of Threats Motivating DomainKeys Identified Mail (DKIM)</a>,&rdquo; RFC&nbsp;4686, September&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4686.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4871">[RFC4871]</a></td>
<td class="author-text">Allman, E., Callas, J., Delany, M., Libbey, M., Fenton, J., and M. Thomas, &ldquo;<a href="http://tools.ietf.org/html/rfc4871">DomainKeys Identified Mail (DKIM) Signatures</a>,&rdquo; RFC&nbsp;4871, May&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4871.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5234">[RFC5234]</a></td>
<td class="author-text">Crocker, D. and P. Overell, &ldquo;<a href="http://tools.ietf.org/html/rfc5234">Augmented BNF for Syntax Specifications: ABNF</a>,&rdquo; STD&nbsp;68, RFC&nbsp;5234, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5234.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>7.2.&nbsp;References - Informative</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2782">[RFC2782]</a></td>
<td class="author-text"><a href="mailto:arnt@troll.no">Gulbrandsen, A.</a>, Vixie, P., and <a href="mailto:levone@microsoft.com">L. Esibov</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2782">A DNS RR for specifying the location of services (DNS SRV)</a>,&rdquo; RFC&nbsp;2782, February&nbsp;2000 (<a href="http://www.rfc-editor.org/rfc/rfc2782.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5016">[RFC5016]</a></td>
<td class="author-text">Thomas, M., &ldquo;<a href="http://tools.ietf.org/html/rfc5016">Requirements for a DomainKeys Identified Mail (DKIM) Signing Practices Protocol</a>,&rdquo; RFC&nbsp;5016, October&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc5016.txt">TXT</a>).</td></tr>
</table>

<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Usage Examples</h3>

<p>These examples are intended to illustrate typical uses of ADSP. They are not intended to be
        exhaustive, nor to apply to every domain's or mail system's individual situation.
</p>
<p>Administrators are advised to consider the ways that mail processing can modify messages in
        a manner that will invalidate existing DKIM signatures, such as mailing lists, courtesy
        forwarders, and other paths that could add or modify headers, or modify the message body. In
        that case, if these modifications invalidate DKIM signatures, receiving hosts will consider
        the mail not to have a Valid Author Signature, even though one was present when the mail was
        originally sent.
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Single Location Domains</h3>

<p>A common mail system configuration handles all of a domain's users' incoming and outgoing
          mail through a single MTA or group of MTAs. In that case, the MTA(s) can be configured to
          sign outgoing mail with an Author Signature.
</p>
<p>In this situation, it might be appropriate to publish a <tt>CLOSED</tt> ADSP record for the Author Domain, depending on whether users also send
          mail through other paths that do not apply an Author Key Domain signature. Such paths
          could include MTAs at hotels or hotspot networks used by travelling users, or web sites
          that provide <tt>mail an article</tt> features.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Bulk Mailing Domains</h3>

<p>Another common configuration uses a domain solely for bulk or broadcast mail, with no
          individual human users, again, typically sending all the mail through a single MTA or
          group of MTAs that can apply an Author Key Domain signature. In this case, before
          publishing a <tt>CLOSED</tt> ADSP record, the domain's management
          should be confident that all of its outgoing mail will be sent through signing MTAs.
          Because it lacks individual users, the domain is unlikely to participate in mailing lists,
          but could still send mail through other paths that might invalidate signatures.
</p>
<p>Domain owners often use specialist mailing providers to send their bulk mail. In that
          case, the mailing provider needs access to a suitable signing key in order to apply an
          Author Key Domain signature. One possible method would be for the Author Key Domain owner
          to exchange keys with the mailing provider. Another would be for the Author Key Domain to
          delegate a subdomain below the <tt>_domainkey.</tt> label to the
          mailing provider. For example, <tt>bigbank.example.com</tt> might
          delegate <tt>esp-00._domainkey.bigbank.example.com</tt> to such a
          provider. As a result, the provider could generate keys and DKIM DNS records itself and
          thereby provide Author Key Domain signatures.
</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.3"></a><h3>A.3.&nbsp;
Commonly Forged Transactional Messages</h3>

<p>In some cases, a domain might sign all its outgoing mail with an Author Key Domain
          signature, but prefer that receiving host systems dismiss mail without a valid Author Key
          Domain signature to avoid confusion with mail sent from fraudulent sources that are unable
          to apply an Author Key Domain signature. (This latter kind of mail is sometimes loosely
          called "forgeries".) In that case, it might be appropriate to publish a "LOCKED" ADSP
          record. Note that a domain SHOULD NOT publish a <tt>LOCKED</tt> ADSP
          record when it wishes to maximize the likelihood that its mail is delivered, since it
          could cause some fraction of the mail to become rejected or discarded.
</p>
<p>As a special case, if a domain sends no mail at all, it can safely publish a <tt>LOCKED</tt> ADSP record, since any mail with this Author Domain would be
          a forgery.
</p>
<a name="anchor26"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.4"></a><h3>A.4.&nbsp;
Third Party Senders</h3>

<p>Another common use case is for a third party to enter into an agreement whereby that
          third party will send bulk or other mail on behalf of a designated Author Domain, using
          that domain in the RFC2822 From: or other headers. Due to the many and varied complexities
          of such agreements, third party signing is not addressed in this specification.
</p>
<a name="anchor27"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.B"></a><h3>Appendix B.&nbsp;
Acknowledgements</h3>

<p>This document was based upon the draft-ietf-dkim-ssp-003. Dave Crocker, Frank Ellermann,
        and Charles Lindsey inputs were valuable. However, inclusion of their names should not be
        misconstrued as an endorsement of this draft. This draft is an individual submission
        intended to illustrate a comprehensive solution that might help foreclose protracted debate
        when there is otherwise general agreement.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C"></a><h3>Appendix C.&nbsp;
Update History</h3>

<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.1"></a><h3>C.1.&nbsp;
Changes to draft-otis-dkim-adsp-00</h3>

<p>
          </p>
<ul class="text">
<li>Conditioned Author Signing Practices Discovery Procedure SMTP verification step to be
              made only when an MX record had not been found.
</li>
</ul><p>
        
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.2"></a><h3>C.2.&nbsp;
Changes to draft-otis-dkim-adsp-01</h3>

<p>
          </p>
<ul class="text">
<li>Modified the Author Signing Practices Discovery Procedure to better conform with
              terms in RFC2821. In addition, a note now covers the issue of CNAMEs.
</li>
</ul><p>
        
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.3"></a><h3>C.3.&nbsp;
Changes to draft-otis-dkim-adsp-02</h3>

<p>
          </p>
<ul class="text">
<li>Modified the abstract to include the language recommended by Dave Crocker, clarified
              the relationship this document has with DKIM, SMTP and other protocols, and clarified
              the extent of DKIM identity parameter. The general language describing the intent was
              taken from the WG charter.
</li>
<li>Included non retention of a valid signature and offered an admonishment to first
              validate from domain in the introduction.
</li>
<li>Added a separate definition for Valid Author Signatures by including the requirement
              the local-part template must match against the author addresses.
</li>
<li>Made a few minor changes to the Author Key Domain definition.
</li>
<li>Included the phrase "related to the use of DNS" to the operation Overview as well as
              expanding upon the term ADSP Discovery in several places.
</li>
<li>Modified ADSP Usage to Discovery Results Usage. The information provided was
              reorganized from least to most useful.
</li>
<li>Modified the terms in ADSP Discovery Results to be consistent with advertised
              practices to align more closely with Dave Crocker's Abstract.
</li>
<li>The Record syntax now mentions the terms used are a metaphor for a door, and the
              terms modified to be in closer alignment with the abstract.
</li>
<li>The ADSP Discovery procedure now warns about unlimited application of this process,
              and suggests some domains may require exemption, and introduces the term MISSING when
              no ADSP record is discovered.
</li>
<li>The IANA considerations where shortened based upon the assumption a registry may not
              be established for underscore prefixed TXT records.
</li>
<li>Change the beginning of the security section to clarify the domain and not the author
              identity is assured by DKIM and ADSP.
</li>
<li>Changed the wording related to the key "g=" parameter to be more consistent
              throughout the document.
</li>
<li>Mention in the threat model annotation is required, but is out of scope.
</li>
<li>Modified the paragraph that describes exploitation of trust to be about the domain
              and not the author identity.
</li>
<li>Mention that the target of an attack is often directed to behavioral information
              services.
</li>
<li>Add paragraph describing the typical nature of bot-net behaviour, and how the DKIM
              "i=" represents a significant vulnerability for the accrual of behavioral information.
</li>
<li>Add a sentence to highlight benefits using automatic folder placement.
</li>
<li>Expanded the DNS wildcard section to generally describe what might be involved when
              validating the domain's support of SMTP.
</li>
</ul><p>
        
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.C.4"></a><h3>C.4.&nbsp;
Changes to draft-otis-dkim-adsp-03</h3>

<p>
          </p>
<ul class="text">
<li>Clarify the definition of signing address when used in conjunction with restrictive
              local-part templates by adding a paragraph to Section 2.1.
</li>
<li>Modified the list in Section 3.2 to include the case where the Author Domain has no
              ADSP record.
</li>
<li>Give examples in Section 4.2.2 regarding possibly exempt TLDs.
</li>
<li>Expand upon the recognition of direct versus indirect control of the DKIM signing
              process, and how this relates to the use of the "on behalf of" identity by adding two
              paragraphs to Section 6.
</li>
<li>Made several minor grammatical changes.
</li>
</ul><p>
        
</p>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Author's Address</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Douglas Otis</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Trend Micro, NSSG</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">10101 N. De Anza Blvd</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Cupertino, CA  95014</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">USA</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+1.408.257-1500</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:doug_otis@trendmicro.com">doug_otis@trendmicro.com</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
