GSMP Working Group                                     Kenneth Sundell
Internet-Draft                                         Nortel Networks
                                                            Avri Doria
Expiration Date: April 2000                                      Nokia

                                                      22 October, 1999

            Support for redundant switch controllers in GSMP
                  <draft-sundell-gsmp-redundancy-00.txt>


Status of this Memo

     This document is an Internet-Draft and is in full conformance with
     all provisions of Section 10 of RFC2026.

     Internet-Drafts are working documents of the Internet Engineering
     Task Force (IETF), its areas, and its working groups.  Note that
     other groups may also distribute working documents as Internet-
     Drafts.

     Internet-Drafts are draft documents valid for a maximum of six
     months and may be updated, replaced, or obsoleted by other
     documents at any time.  It is inappropriate to use Internet-
     Drafts as reference material or to cite them other than as "work
     in progress."

     The list of current Internet-Drafts can be accessed at:
     http://www.ietf.org/ietf/1id-abstracts.txt

     The list of Internet-Draft Shadow Directories can be accessed at:
     http://www.ietf.org/shadow.html.

     Distribution of this memo is unlimited.

     Copyright Notice

     Copyright (C) The Internet Society (1999).  All Rights Reserved.


Abstract

The General Switch Management Protocol (GSMP) is currently being updated
[3] from previous versions [1] [2]. There has been a desire to enhance
this new version (GSMPv3) with support for redundant controllers per
switch partition. This document proposes a way of adding such feature
into GSMP.



INTERNET-DRAFT   redundant switch controllers in GSMP    22.10.99



Sundell, Doria             Expires March 2000             [Page 2]

1.       Introduction

There has been a desire to enhance the GSMP protocol with support for
redundant controllers per switch partition, see requirements #2, #5, #6
and #55 in [4]. The intention is to allow switch controllers to control
a switch partition either in a master/standby fashion or as part of
multiple controllers providing load sharing for the same partition.  It
should be noted that allowing multiple controllers to control a single
switch partition places a burden on the controllers for co-ordination
among themselves.

This document proposes a new message type, the Event message, in order
to inform switch controllers when adjacencies come and go for a
particular partition. It also proposes modification of the general
Configuration Request and Response message (#64) to be able to
distribute and retrieve address information, e.g. the IP address of
other adjacencies to the same switch partition.


2.  Proposed Event message type

A new Event message is proposed in this document. The Event message is
sent when adjacencies come and go for a specific partition. When a new
adjacency, e.g. a new controller, has been established, the switch sends
an Event message to every controller established to that partition. The
Event message is also sent when synchronization is lost for a specific
entity, provided that this is not the last controller for that
partition.

2.1  Event message format (#85)
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   Version     | Message Type  |    Result     |     Code      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Partition ID  |            Transaction Identifier             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|         spare               |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                          Sender Name                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Code:          The number of existing adjacencies (adjacency count)

M:             Indicates, when set, that there are more adjacencies to
               announce




INTERNET-DRAFT   redundant switch controllers in GSMP      22.10.99



Sundell, Doria             Expires March 2000             [Page 3]

Sender Name:   The identity of a partition adjacency, e.g. MAC address,
               which is the same as the Sender Name in the adjacency
               messages


3.     Proposed changes to the System Configuration messages

3.1  Changes to the System Configuration Request message (# 64)

Currently all Configuration Request messages have the following form:


+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Version    | Message Type  |    Result     |     Code      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Partition ID  |            Transaction Identifier             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   MType       |                     x                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


The Switch Configuration Request message would be changed to:

 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Version    | Message Type  |    Result     |     Code      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Partition ID  |             Transaction Identifier            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|   MType       |                     x                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M| Address Type|    Length     |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                          Sender Name                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                        Sender Address                         ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


M:               Indicates, when set, that there are more addresses to
                 announce.  Always 0 in a request message.

SAType:          Sender Address Type




INTERNET-DRAFT   redundant switch controllers in GSMP      22.10.99



Sundell, Doria             Expires March 2000             [Page 4]

                   0:         Spare
                   1:         IPv4 address (4 bytes)
                   2:         IPv6 address (16 bytes)
                   3:         ATM address (20 bytes)
                   4-63:      Reserved
                   64-127:    Experimental

Length:            Indicates the length of the Sender Address

Sender Name:       The identity of the requesting controller, e.g. MAC
                   address, which is the same as Sender Name in the
                   adjacency messages

Sender Address: This field contains the address, e.g. IP address of the
                requesting controller.


3.2 
    Changes to the Switch Configuration Response Message (#64)

The general Switch Configuration Response Message currently has the
following form:


 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Version    | Message Type  |    Result     |     Code      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Partition ID  |            Transaction Identifier             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     MType     |     MType     |     MType     |     MType     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Firmware Version Number    |          Window Size          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Switch Type         |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                          Switch Name                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+











INTERNET-DRAFT   redundant switch controllers in GSMP      22.10.99



Sundell, Doria             Expires March 2000             [Page 5]








This document proposes the following changes:

0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Version    | Message Type  |    Result     |     Code      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Partition ID  |            Transaction Identifier             |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|     MType     |     MType     |     MType     |     MType     |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|    Firmware Version Number    |          Window Size          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|           Switch Type         |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                          Switch Name                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|M|   SAType    |    Length     |                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+                               +
|                          Sender Name                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
~                         Sender Address                        ~
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+


M:              Indicates, when set, that there are more addresses to
                announce

SAType:         Sender Address Type

                0:         Spare
                1:         IPv4 address (4 octets)
                2:         IPv6 address (16 octets)
                3:         ATM address (20 octets)
                4-63:      Reserved
                64-127:    Experimental

Length:         Indicates the length of the Sender Address




INTERNET-DRAFT   redundant switch controllers in GSMP      22.10.99



Sundell, Doria             Expires March 2000             [Page 6]

Sender Name:         The identity of the adjacency, e.g. MAC address of
                     controller, which is the same as in the Adjacency
                     messages

Sender Address: This field contains the address, e.g. IP address of the
                     adjacency (coupled with the Sender Name)



4.     Procedures

To keep track of state in a partition a "state machine" is suggested and
a number of "states" are proposed:

RAW:  a raw partition is partition that has either never been used,
       or one that has had its connection state re-initialized.

IDLE: a partition which already has connection state but which has no
       current controller adjacencies.

INIT: first adjacency initiating.

INCR: adjacency count incremented (new adjacency established) will cause
       an Event message

DECR: adjacency count decremented (adjacency leaves) will cause
       an Event message

RSET: last adjacency leaves (back to state IDLE)

4.1  Example

A switch partition has never been used and is regarded as a raw
partition. When the first controller (A) achieves adjacency, an
adjacency count will be initiated and (A) will get an Event about itself
(count=1). Since (A) sees a count of 1 it knows that it itself must be
that 1, it won't request an info list. When the next adjacency (B)
achieves adjacency, the adjacency count will be increased by 1 and both
(A) and (B) will receive an Event indicating count of 2. Since the count
is greater than 1, both (A) and (B) know there is someone new. Both (A)
and (B) are able to request further address information (e.g. IP
address) if desired by a configuration request message.

If (A) looses adjacency, the adjacency count will be decreased and an
Event message will be sent to (B) indicating count=1. If (B) leaves as
well, the partition state will change to idle.



INTERNET-DRAFT   redundant switch controllers in GSMP      22.10.99



Sundell, Doria             Expires March 2000             [Page 7]

5.       Partition Information MIB

A GSMP MIB object needs to be defined to include partition information.
This should be structured as a table, with each row including
information about a single controller within the partition.
Information to be included in each row should include at least:
controller name, controller address, connection type, and controller
connection label.


Authors' Contact

       Kenneth Sundell
       Nortel Networks
       St Eriksgatan 115 A, PO Box 6701
       113 85 Stockholm, Sweden
       phone: +46 8 5088-3538
       mobile +46 70 665-7838
       ksundell@nortelnetworks.com


       Avri Doria
       Nokia Telecommunications
       3 Burlington Woods Drive, Suite 250
       Burlington, MA 01803
       Phone: +1 781 359 5131
       Mobile: +1 617 678 9402
       avri.doria@nokia.com


      Comments on this document should be sent to the authors or to the
      working group mailing list at gsmp@psyton.com.


References

[1]  Newman, P., Edwards, W., Hinden, R., Hoffman, E, Ching Liaw, F.,
         Lyon, T. and Minshall, G., "Ipsilon's General Switch Management
         Protocol Specification," Version 1.1, RFC 1987, August 1996.

[2]  Newman, P., Edwards, W., Hinden, R., Hoffman, E., Ching Liaw,
         F., Lyon, T. and Minshall, G., "Ipsilon's General Switch
         Management Protocol Specification," Version 2.0, RFC 2397,
         March 1998.

[3]  GSMP Working Group, Tom Worster Editor, "General Switch
         Management Protocol V3", draft-ietf-gsmp-02.txt, October, 1999


INTERNET-DRAFT   redundant switch controllers in GSMP      22.10.99



Sundell, Doria             Expires March 2000             [Page 8]

[4]  MSF Switch Control WG, McEachern, J, "Service Control Interface
     Requirements Multiservice Switching Forum",
     draft-mceachern-gsmp-scireq-00.txt, June, 1999


This document expires on 22 April 2000.







































INTERNET-DRAFT   redundant switch controllers in GSMP      22.10.99



