AAA-Key = MSK

Out = KDF-X (Key, Label, Msg)
MMS-A = KDF-16 (Root-Secret-A, "MAKE Master Secret A", RAND_P|RAND_S)
TEK = KDF-32 (MMS-A, "Transient EAP Key", RAND_S | RAND_P)
TEK-Auth = TEK[0...15]
TEK-Cipher = TEK[16...31]

MMS-B = KDF-16 (Root-Secret-B, "MAKE Master Secret B", RAND_P|RAND_S)
Session-Key-Block=KDF-128(MMS-B, "Master Session Key", RAND_S|RAND_P)
MSK = Session-Key-Block[0...63]
EMSK = Session-Key-Block[64...127]

MIC_P = KDF-16 (TEK-Auth, "Peer MIC", RAND_S | RAND_P |
                              PEERID | SERVERID | <EAP-packet>),

MIC_S = KDF-16 (TEK-Auth, "Server MIC", RAND_P |RAND_S |
                              SERVERID | PEERID | <EAP-packet>).

