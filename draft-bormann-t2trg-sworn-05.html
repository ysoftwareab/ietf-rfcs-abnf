<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>SWORN: Secure Wake on Radio Nudging</title>
<meta content="Carsten Bormann" name="author">
<meta content="Yizhou Li" name="author">
<meta content='
       Normally off devices (RFC7228) would need to expend considerable energy
resources to be reachable at all times.  Instead, MAC layer mechanisms
are often employed that allow the last hop router of the device to "wake"
the device via radio when needed.  Activating these devices even for a
short time still
does expend energy and thus should be available to authorized
correspondents only.  Traditionally, this has been achieved by heavy
firewalling, allowing only authorized hosts to reach the device at
all.  This may be too inflexible for an Internet of Things. 
       The present report describes how to use a combination of currently
standardized technologies to securely effect this
authorization. 
       We also discuss how the general approach of the original SWORN
protocol can be extended to cover additional use cases and
implementation environments. 
    ' name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-bormann-t2trg-sworn-05" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 22.1.10
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/t2trg-sworn.v2v3-hu_mhdfz.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">SWORN: Secure Wake on Radio Nudging</td>
<td class="right">February 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Bormann &amp; Li</td>
<td class="center">Expires 11 August 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Network Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-bormann-t2trg-sworn-05</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-02-07" class="published">7 February 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-08-11">11 August 2022</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">C. Bormann</div>
<div class="org">Universität Bremen TZI</div>
</div>
<div class="author">
      <div class="author-name">Y. Li</div>
<div class="org">Huawei Technologies</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">SWORN: Secure Wake on Radio Nudging</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">Normally off devices (RFC7228) would need to expend considerable energy
resources to be reachable at all times.  Instead, MAC layer mechanisms
are often employed that allow the last hop router of the device to "wake"
the device via radio when needed.  Activating these devices even for a
short time still
does expend energy and thus should be available to authorized
correspondents only.  Traditionally, this has been achieved by heavy
firewalling, allowing only authorized hosts to reach the device at
all.  This may be too inflexible for an Internet of Things.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
<p id="section-abstract-2">The present report describes how to use a combination of currently
standardized technologies to securely effect this
authorization.<a href="#section-abstract-2" class="pilcrow">¶</a></p>
<p id="section-abstract-3">We also discuss how the general approach of the original SWORN
protocol can be extended to cover additional use cases and
implementation environments.<a href="#section-abstract-3" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-about-this-document">
<a href="#name-about-this-document" class="section-name selfRef">About This Document</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">
        Status information for this document may be found at <span><a href="https://datatracker.ietf.org/doc/draft-bormann-t2trg-sworn/">https://datatracker.ietf.org/doc/draft-bormann-t2trg-sworn/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">
        Discussion of this document takes place on the
        Thing-to-Thing (T2TRG) Research Group mailing list (<span><a href="mailto:t2trg@irtf.org">mailto:t2trg@irtf.org</a></span>),
        which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/t2trg/">https://mailarchive.ietf.org/arch/browse/t2trg/</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 11 August 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="xref">1.1</a>.  <a href="#name-terminology" class="xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1"><a href="#section-2" class="xref">2</a>.  <a href="#name-the-original-sworn-proposal" class="xref">The original SWORN proposal</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-assumptions-and-requirement" class="xref">Assumptions and Requirements</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.2">
                <p id="section-toc.1-1.2.2.2.1"><a href="#section-2.2" class="xref">2.2</a>.  <a href="#name-security-goals" class="xref">Security goals</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3">
                <p id="section-toc.1-1.2.2.3.1"><a href="#section-2.3" class="xref">2.3</a>.  <a href="#name-mechanism" class="xref">Mechanism</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.1">
                    <p id="section-toc.1-1.2.2.3.2.1.1"><a href="#section-2.3.1" class="xref">2.3.1</a>.  <a href="#name-wake-grant" class="xref">Wake-Grant</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.2">
                    <p id="section-toc.1-1.2.2.3.2.2.1"><a href="#section-2.3.2" class="xref">2.3.2</a>.  <a href="#name-wake-token" class="xref">Wake-Token</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.3.2.3">
                    <p id="section-toc.1-1.2.2.3.2.3.1"><a href="#section-2.3.3" class="xref">2.3.3</a>.  <a href="#name-finding-the-wake-token" class="xref">Finding the wake token</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-generalizing-sworn-towards-" class="xref">Generalizing SWORN towards Token-Based In-Network Authorization</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="xref">3.1</a>.  <a href="#name-position-of-router-r" class="xref">Position of router R</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="xref">3.2</a>.  <a href="#name-position-of-token-in-packet" class="xref">Position of Token in Packet</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="xref">3.3</a>.  <a href="#name-range-of-checking" class="xref">Range of Checking</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="xref">3.4</a>.  <a href="#name-information-attributes-to-b" class="xref">Information (attributes) to be used on the way</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5">
                <p id="section-toc.1-1.3.2.5.1"><a href="#section-3.5" class="xref">3.5</a>.  <a href="#name-example-arrangements" class="xref">Example arrangements</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.1">
                    <p id="section-toc.1-1.3.2.5.2.1.1"><a href="#section-3.5.1" class="xref">3.5.1</a>.  <a href="#name-multiple-independent-grants" class="xref">Multiple Independent Grants</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.5.2.2">
                    <p id="section-toc.1-1.3.2.5.2.2.1"><a href="#section-3.5.2" class="xref">3.5.2</a>.  <a href="#name-hierarchical-grants" class="xref">Hierarchical Grants</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-original-sworn-model" class="xref">Original SWORN model</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.2">
                <p id="section-toc.1-1.4.2.2.1"><a href="#section-4.2" class="xref">4.2</a>.  <a href="#name-generalized-model" class="xref">Generalized model</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#appendix-A" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#appendix-B" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">(See Abstract.)<a href="#section-1-1" class="pilcrow">¶</a></p>
<div id="terms">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The term "byte" is used in its now customary sense as a synonym for
"octet".<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">Messages defined in this document employ CBOR <span>[<a href="#RFC8949" class="xref">RFC8949</a>]</span> and are
described in CDDL <span>[<a href="#RFC8610" class="xref">RFC8610</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
<p id="section-1.1-3">Terms used in this draft:<a href="#section-1.1-3" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlParallel" id="section-1.1-4">
          <dt id="section-1.1-4.1">
C:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.1-4.2">
            <p id="section-1.1-4.2.1">Client, or Correspondent host.  The node that wants to effect "Wake
on Radio" on D by sending a message to D.<a href="#section-1.1-4.2.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-4.3">
D:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.1-4.4">
            <p id="section-1.1-4.4.1">Device.  This is typically battery operated and "Normally off"
<span>[<a href="#RFC7228" class="xref">RFC7228</a>]</span>.<a href="#section-1.1-4.4.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-4.5">
R:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.1-4.6">
            <p id="section-1.1-4.6.1">Router.  The router that is adjacent to D, sharing an energy-saving
link with D, and serving as a ("parent") router to D.<a href="#section-1.1-4.6.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-4.7">
MAC:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.1-4.8">
            <p id="section-1.1-4.8.1">Message Authentication Code (when discussing authentication mechanisms)<a href="#section-1.1-4.8.1" class="pilcrow">¶</a></p>
</dd>
          <dd class="break"></dd>
<dt id="section-1.1-4.9">
MAC:  </dt>
          <dd style="margin-left: 1.5em" id="section-1.1-4.10">
            <p id="section-1.1-4.10.1">Media Access Control (when discussing protocol layers)<a href="#section-1.1-4.10.1" class="pilcrow">¶</a></p>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
</section>
</div>
<div id="the-original-sworn-proposal">
<section id="section-2">
      <h2 id="name-the-original-sworn-proposal">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-the-original-sworn-proposal" class="section-name selfRef">The original SWORN proposal</a>
      </h2>
<div id="assumptions-and-requirements">
<section id="section-2.1">
        <h3 id="name-assumptions-and-requirement">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-assumptions-and-requirement" class="section-name selfRef">Assumptions and Requirements</a>
        </h3>
<p id="section-2.1-1">D is a normally off <span>[<a href="#RFC7228" class="xref">RFC7228</a>]</span> device, waking up very briefly to
communicate with its first hop router R.  R and D share a MAC layer
that allows R to keep D in extended wake periods.<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">R and D have a security association.  (This may have been created in
network onboarding, or be setup dynamically from the device-to-network
security association when D chose R as a parent router.)<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">D wants to authorize a client (or correspondent host) C to ask R to
initiate wake periods in D.<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Because of changes in the radio environment, D needs to be able to
change its parent router from R1 to R2 occasionally.  This should
not cause a need to notify all its clients; which parent router is
used by D is therefore opaque to its clients as usual in IP.<a href="#section-2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="security-goals">
<section id="section-2.2">
        <h3 id="name-security-goals">
<a href="#section-2.2" class="section-number selfRef">2.2. </a><a href="#name-security-goals" class="section-name selfRef">Security goals</a>
        </h3>
<p id="section-2.2-1">Since packets with wake tokens are kept in R for extended periods, the
limited size buffer provided in R for this is a resource that needs to
be protected to protect availability.<a href="#section-2.2-1" class="pilcrow">¶</a></p>
<p id="section-2.2-2">D uses up battery for a wake period, which would make it susceptible
to battery depletion attacks.  To protect availability, D should only
undergo wake periods that R has commanded based on previous
authorization by D.<a href="#section-2.2-2" class="pilcrow">¶</a></p>
<p id="section-2.2-3">There may be confidentiality requirements (e.g., for privacy); this is
not addressed in the present version of this report.<a href="#section-2.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="mechanism">
<section id="section-2.3">
        <h3 id="name-mechanism">
<a href="#section-2.3" class="section-number selfRef">2.3. </a><a href="#name-mechanism" class="section-name selfRef">Mechanism</a>
        </h3>
<span id="name-illustration-of-a-potential"></span><div id="fig-sworn-mech">
<figure id="figure-1">
          <div id="section-2.3-1.1">
            <div class="alignLeft art-svg artwork" id="section-2.3-1.1.1">
<svg xmlns="http://www.w3.org/2000/svg" class="diagram" version="1.1" height="265" width="504" viewBox="0 0 504.0 265.0">
                <g transform="translate(8,16)">
                  <path d="M 0,16 L 136,16" fill="none" stroke="black"></path>
                  <path d="M 352,16 L 488,16" fill="none" stroke="black"></path>
                  <path d="M 136,32 L 152,32" fill="none" stroke="black"></path>
                  <path d="M 136,48 L 200,48" fill="none" stroke="black"></path>
                  <path d="M 0,80 L 104,80" fill="none" stroke="black"></path>
                  <path d="M 104,80 L 136,80" fill="none" stroke="black"></path>
                  <path d="M 352,80 L 416,80" fill="none" stroke="black"></path>
                  <path d="M 416,80 L 456,80" fill="none" stroke="black"></path>
                  <path d="M 456,80 L 488,80" fill="none" stroke="black"></path>
                  <path d="M 0,160 L 24,160" fill="none" stroke="black"></path>
                  <path d="M 24,160 L 104,160" fill="none" stroke="black"></path>
                  <path d="M 104,160 L 136,160" fill="none" stroke="black"></path>
                  <path d="M 176,160 L 200,160" fill="none" stroke="black"></path>
                  <path d="M 200,160 L 240,160" fill="none" stroke="black"></path>
                  <path d="M 240,160 L 280,160" fill="none" stroke="black"></path>
                  <path d="M 280,160 L 312,160" fill="none" stroke="black"></path>
                  <path d="M 352,160 L 376,160" fill="none" stroke="black"></path>
                  <path d="M 376,160 L 416,160" fill="none" stroke="black"></path>
                  <path d="M 416,160 L 456,160" fill="none" stroke="black"></path>
                  <path d="M 456,160 L 488,160" fill="none" stroke="black"></path>
                  <path d="M 136,192 L 168,192" fill="none" stroke="black"></path>
                  <path d="M 312,192 L 344,192" fill="none" stroke="black"></path>
                  <path d="M 0,224 L 136,224" fill="none" stroke="black"></path>
                  <path d="M 176,224 L 312,224" fill="none" stroke="black"></path>
                  <path d="M 352,224 L 488,224" fill="none" stroke="black"></path>
                  <path d="M 340,56 L 352,56" fill="none" stroke="black"></path>
                  <path d="M 0,16 L 0,80" fill="none" stroke="black"></path>
                  <path d="M 0,160 L 0,224" fill="none" stroke="black"></path>
                  <path d="M 24,96 L 24,160" fill="none" stroke="black"></path>
                  <path d="M 104,80 L 104,144" fill="none" stroke="black"></path>
                  <path d="M 104,144 L 104,160" fill="none" stroke="black"></path>
                  <path d="M 136,16 L 136,32" fill="none" stroke="black"></path>
                  <path d="M 136,32 L 136,48" fill="none" stroke="black"></path>
                  <path d="M 136,48 L 136,80" fill="none" stroke="black"></path>
                  <path d="M 136,160 L 136,192" fill="none" stroke="black"></path>
                  <path d="M 136,192 L 136,224" fill="none" stroke="black"></path>
                  <path d="M 176,160 L 176,224" fill="none" stroke="black"></path>
                  <path d="M 240,128 L 240,160" fill="none" stroke="black"></path>
                  <path d="M 312,160 L 312,192" fill="none" stroke="black"></path>
                  <path d="M 312,192 L 312,224" fill="none" stroke="black"></path>
                  <path d="M 352,16 L 352,80" fill="none" stroke="black"></path>
                  <path d="M 352,160 L 352,224" fill="none" stroke="black"></path>
                  <path d="M 416,80 L 416,160" fill="none" stroke="black"></path>
                  <path d="M 488,16 L 488,48" fill="none" stroke="black"></path>
                  <path d="M 488,48 L 488,80" fill="none" stroke="black"></path>
                  <path d="M 488,160 L 488,192" fill="none" stroke="black"></path>
                  <path d="M 488,192 L 488,224" fill="none" stroke="black"></path>
                  <path d="M 200,48 L 240,128" fill="none" stroke="black"></path>
                  <path d="M 328,32 L 340,56" fill="none" stroke="black"></path>
                  <path d="M 24,88 L 24,96" fill="none" stroke="black"></path>
                  <polygon points="40.000000,96.000000 28.000000,90.400002 28.000000,101.599998" transform="rotate(270.000000, 24.000000, 96.000000)" fill="black"></polygon>
                  <path d="M 104,144 L 104,152" fill="none" stroke="black"></path>
                  <polygon points="120.000000,144.000000 108.000000,138.399994 108.000000,149.600006" transform="rotate(90.000000, 104.000000, 144.000000)" fill="black"></polygon>
                  <polygon points="176.000000,192.000000 164.000000,186.399994 164.000000,197.600006" transform="rotate(0.000000, 168.000000, 192.000000)" fill="black"></polygon>
                  <polygon points="352.000000,192.000000 340.000000,186.399994 340.000000,197.600006" transform="rotate(0.000000, 344.000000, 192.000000)" fill="black"></polygon>
                  <text text-anchor="middle" font-family="monospace" x="216" y="36" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="56" y="52" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="152" y="116" fill="black" font-size="1em">v</text>
                  <text text-anchor="middle" font-family="monospace" x="256" y="244" fill="black" font-size="1em">f</text>
                  <text text-anchor="middle" font-family="monospace" x="456" y="244" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="40" y="36" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="312" y="36" fill="black" font-size="1em">x</text>
                  <text text-anchor="middle" font-family="monospace" x="368" y="68" fill="black" font-size="1em">M</text>
                  <text text-anchor="middle" font-family="monospace" x="40" y="116" fill="black" font-size="1em">f</text>
                  <text text-anchor="middle" font-family="monospace" x="144" y="132" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="32" y="196" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="400" y="196" fill="black" font-size="1em">c</text>
                  <text text-anchor="middle" font-family="monospace" x="152" y="244" fill="black" font-size="1em">s</text>
                  <text text-anchor="middle" font-family="monospace" x="432" y="52" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="56" y="68" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="392" y="196" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="368" y="244" fill="black" font-size="1em">l</text>
                  <text text-anchor="middle" font-family="monospace" x="376" y="36" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="32" y="68" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="40" y="132" fill="black" font-size="1em">g</text>
                  <text text-anchor="middle" font-family="monospace" x="32" y="244" fill="black" font-size="1em">c</text>
                  <text text-anchor="middle" font-family="monospace" x="144" y="116" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="72" y="132" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="120" y="132" fill="black" font-size="1em">g</text>
                  <text text-anchor="middle" font-family="monospace" x="56" y="196" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="184" y="36" fill="black" font-size="1em">S</text>
                  <text text-anchor="middle" font-family="monospace" x="272" y="36" fill="black" font-size="1em">c</text>
                  <text text-anchor="middle" font-family="monospace" x="424" y="52" fill="black" font-size="1em">z</text>
                  <text text-anchor="middle" font-family="monospace" x="120" y="100" fill="black" font-size="1em">2</text>
                  <text text-anchor="middle" font-family="monospace" x="328" y="244" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="464" y="244" fill="black" font-size="1em">k</text>
                  <text text-anchor="middle" font-family="monospace" x="88" y="68" fill="black" font-size="1em">A</text>
                  <text text-anchor="middle" font-family="monospace" x="56" y="100" fill="black" font-size="1em">A</text>
                  <text text-anchor="middle" font-family="monospace" x="48" y="116" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="248" y="196" fill="black" font-size="1em">R</text>
                  <text text-anchor="middle" font-family="monospace" x="128" y="132" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="224" y="196" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="424" y="196" fill="black" font-size="1em">D</text>
                  <text text-anchor="middle" font-family="monospace" x="376" y="244" fill="black" font-size="1em">l</text>
                  <text text-anchor="middle" font-family="monospace" x="448" y="52" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="128" y="116" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="208" y="244" fill="black" font-size="1em">5</text>
                  <text text-anchor="middle" font-family="monospace" x="320" y="244" fill="black" font-size="1em">p</text>
                  <text text-anchor="middle" font-family="monospace" x="208" y="36" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="304" y="36" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="368" y="36" fill="black" font-size="1em">D</text>
                  <text text-anchor="middle" font-family="monospace" x="392" y="36" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="248" y="244" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="400" y="36" fill="black" font-size="1em">c</text>
                  <text text-anchor="middle" font-family="monospace" x="408" y="52" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="160" y="116" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="224" y="244" fill="black" font-size="1em">v</text>
                  <text text-anchor="middle" font-family="monospace" x="88" y="52" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="464" y="52" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="96" y="68" fill="black" font-size="1em">M</text>
                  <text text-anchor="middle" font-family="monospace" x="24" y="36" fill="black" font-size="1em">l</text>
                  <text text-anchor="middle" font-family="monospace" x="240" y="36" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="80" y="52" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="208" y="196" fill="black" font-size="1em">u</text>
                  <text text-anchor="middle" font-family="monospace" x="344" y="244" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="192" y="36" fill="black" font-size="1em">h</text>
                  <text text-anchor="middle" font-family="monospace" x="80" y="68" fill="black" font-size="1em">C</text>
                  <text text-anchor="middle" font-family="monospace" x="64" y="100" fill="black" font-size="1em">s</text>
                  <text text-anchor="middle" font-family="monospace" x="56" y="244" fill="black" font-size="1em">p</text>
                  <text text-anchor="middle" font-family="monospace" x="392" y="68" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="56" y="132" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="368" y="196" fill="black" font-size="1em">D</text>
                  <text text-anchor="middle" font-family="monospace" x="80" y="244" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="400" y="52" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="48" y="68" fill="black" font-size="1em">g</text>
                  <text text-anchor="middle" font-family="monospace" x="384" y="196" fill="black" font-size="1em">v</text>
                  <text text-anchor="middle" font-family="monospace" x="64" y="244" fill="black" font-size="1em">u</text>
                  <text text-anchor="middle" font-family="monospace" x="56" y="36" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="256" y="36" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="48" y="52" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="112" y="52" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="96" y="52" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="48" y="132" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="16" y="244" fill="black" font-size="1em">3</text>
                  <text text-anchor="middle" font-family="monospace" x="136" y="244" fill="black" font-size="1em">4</text>
                  <text text-anchor="middle" font-family="monospace" x="72" y="52" fill="black" font-size="1em">z</text>
                  <text text-anchor="middle" font-family="monospace" x="168" y="244" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="360" y="244" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="400" y="244" fill="black" font-size="1em">s</text>
                  <text text-anchor="middle" font-family="monospace" x="408" y="244" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="296" y="36" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="432" y="68" fill="black" font-size="1em">D</text>
                  <text text-anchor="middle" font-family="monospace" x="232" y="196" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="48" y="244" fill="black" font-size="1em">m</text>
                  <text text-anchor="middle" font-family="monospace" x="136" y="132" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="448" y="244" fill="black" font-size="1em">T</text>
                  <text text-anchor="middle" font-family="monospace" x="32" y="36" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="280" y="36" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="376" y="52" fill="black" font-size="1em">u</text>
                  <text text-anchor="middle" font-family="monospace" x="448" y="68" fill="black" font-size="1em">M</text>
                  <text text-anchor="middle" font-family="monospace" x="104" y="52" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="416" y="68" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="384" y="68" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="400" y="68" fill="black" font-size="1em">g</text>
                  <text text-anchor="middle" font-family="monospace" x="40" y="196" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="416" y="244" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="16" y="36" fill="black" font-size="1em">C</text>
                  <text text-anchor="middle" font-family="monospace" x="248" y="36" fill="black" font-size="1em">m</text>
                  <text text-anchor="middle" font-family="monospace" x="384" y="36" fill="black" font-size="1em">v</text>
                  <text text-anchor="middle" font-family="monospace" x="40" y="68" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="264" y="244" fill="black" font-size="1em">y</text>
                  <text text-anchor="middle" font-family="monospace" x="352" y="244" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="472" y="244" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="480" y="244" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="168" y="36" fill="black" font-size="1em">0</text>
                  <text text-anchor="middle" font-family="monospace" x="40" y="52" fill="black" font-size="1em">h</text>
                  <text text-anchor="middle" font-family="monospace" x="64" y="52" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="16" y="68" fill="black" font-size="1em">M</text>
                  <text text-anchor="middle" font-family="monospace" x="176" y="244" fill="black" font-size="1em">d</text>
                  <text text-anchor="middle" font-family="monospace" x="384" y="244" fill="black" font-size="1em">y</text>
                  <text text-anchor="middle" font-family="monospace" x="288" y="36" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="72" y="100" fill="black" font-size="1em">k</text>
                  <text text-anchor="middle" font-family="monospace" x="200" y="196" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="40" y="244" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="64" y="132" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="48" y="196" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="216" y="196" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="168" y="116" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="408" y="36" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="368" y="52" fill="black" font-size="1em">A</text>
                  <text text-anchor="middle" font-family="monospace" x="440" y="52" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="64" y="68" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="192" y="196" fill="black" font-size="1em">R</text>
                  <text text-anchor="middle" font-family="monospace" x="296" y="244" fill="black" font-size="1em">6</text>
                  <text text-anchor="middle" font-family="monospace" x="16" y="52" fill="black" font-size="1em">A</text>
                  <text text-anchor="middle" font-family="monospace" x="32" y="52" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="40" y="100" fill="black" font-size="1em">1</text>
                  <text text-anchor="middle" font-family="monospace" x="56" y="116" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="24" y="52" fill="black" font-size="1em">u</text>
                  <text text-anchor="middle" font-family="monospace" x="24" y="68" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="136" y="116" fill="black" font-size="1em">l</text>
                  <text text-anchor="middle" font-family="monospace" x="160" y="244" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="424" y="244" fill="black" font-size="1em">d</text>
                  <text text-anchor="middle" font-family="monospace" x="232" y="36" fill="black" font-size="1em">s</text>
                  <text text-anchor="middle" font-family="monospace" x="392" y="52" fill="black" font-size="1em">h</text>
                  <text text-anchor="middle" font-family="monospace" x="440" y="68" fill="black" font-size="1em">A</text>
                  <text text-anchor="middle" font-family="monospace" x="408" y="196" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="24" y="196" fill="black" font-size="1em">l</text>
                  <text text-anchor="middle" font-family="monospace" x="72" y="196" fill="black" font-size="1em">C</text>
                  <text text-anchor="middle" font-family="monospace" x="240" y="244" fill="black" font-size="1em">r</text>
                  <text text-anchor="middle" font-family="monospace" x="312" y="244" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="200" y="36" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="416" y="52" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="456" y="52" fill="black" font-size="1em">o</text>
                  <text text-anchor="middle" font-family="monospace" x="376" y="68" fill="black" font-size="1em">a</text>
                  <text text-anchor="middle" font-family="monospace" x="336" y="244" fill="black" font-size="1em">i</text>
                  <text text-anchor="middle" font-family="monospace" x="48" y="36" fill="black" font-size="1em">n</text>
                  <text text-anchor="middle" font-family="monospace" x="320" y="36" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="408" y="68" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="16" y="196" fill="black" font-size="1em">C</text>
                  <text text-anchor="middle" font-family="monospace" x="72" y="244" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="232" y="244" fill="black" font-size="1em">e</text>
                  <text text-anchor="middle" font-family="monospace" x="384" y="52" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="120" y="116" fill="black" font-size="1em">D</text>
                  <text text-anchor="middle" font-family="monospace" x="152" y="132" fill="black" font-size="1em">t</text>
                  <text text-anchor="middle" font-family="monospace" x="376" y="196" fill="black" font-size="1em">e</text>
                </g>
              </svg><a href="#section-2.3-1.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-illustration-of-a-potential" class="selfRef">Illustration of a potential setup with Authorization Managers</a>
          </figcaption></figure>
</div>
<div id="wake-grant">
<section id="section-2.3.1">
          <h4 id="name-wake-grant">
<a href="#section-2.3.1" class="section-number selfRef">2.3.1. </a><a href="#name-wake-grant" class="section-name selfRef">Wake-Grant</a>
          </h4>
<p id="section-2.3.1-1">A wake grant is a CWE <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span>, packaging a grant key, provided from D
or D's authorization manager to C.
(Possibly the grant key can be conveyed within a larger confidentiality
protected data structure or channel, such as a CWT <span>[<a href="#RFC8392" class="xref">RFC8392</a>]</span> employing
a <code>cnf</code> claim for the key <span>[<a href="#RFC8747" class="xref">RFC8747</a>]</span>.)<a href="#section-2.3.1-1" class="pilcrow">¶</a></p>
<p id="section-2.3.1-2">A wake grant may then be used by C for initiating (a possibly limited
number or total duration of) wake periods, employing Wake-Tokens.<a href="#section-2.3.1-2" class="pilcrow">¶</a></p>
<p id="section-2.3.1-3">Information about the wake grant is also made available to R, so it
knows the grant key and the parameters of the wake grant.  (Upon a
change of parent router, D will need to make that information
available to its new parent router as well.)<a href="#section-2.3.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="wake-token">
<section id="section-2.3.2">
          <h4 id="name-wake-token">
<a href="#section-2.3.2" class="section-number selfRef">2.3.2. </a><a href="#name-wake-token" class="section-name selfRef">Wake-Token</a>
          </h4>
<p id="section-2.3.2-1">A wake token is a CWS, in a COSE_MAC0 <span>[<a href="#RFC8152" class="xref">RFC8152</a>]</span> message built with the
Wake-Grant's key, containing a CBOR data item of the form:<a href="#section-2.3.2-1" class="pilcrow">¶</a></p>
<div id="section-2.3.2-2">
<pre class="lang-CDDL sourcecode">
[serial: uint, wake-period: duration]
</pre><a href="#section-2.3.2-2" class="pilcrow">¶</a>
</div>
<p id="section-2.3.2-3">The CWS is additionally marked by tagging it with a CBOR tag
1398230866 (a value that becomes visible in a packet dump as ASCII
"SWOR").<a href="#section-2.3.2-3" class="pilcrow">¶</a></p>
<p id="section-2.3.2-4">(Discussion: Should this be a CWE for confidentiality?)<a href="#section-2.3.2-4" class="pilcrow">¶</a></p>
<p id="section-2.3.2-5">The serial is used for replay detection, based on the usual window
mechanism.  Wake-Tokens for a fresh wake grant start out with serial
numbers at zero.<a href="#section-2.3.2-5" class="pilcrow">¶</a></p>
<p id="section-2.3.2-6">A Wake-Token instructs R to use MAC mechanisms to provide an extended
wake period to D the next time it wakes up.<a href="#section-2.3.2-6" class="pilcrow">¶</a></p>
<p id="section-2.3.2-7">The wake token is sent from C to D; R finds it by examining packets
that it would need to forward to D.<a href="#section-2.3.2-7" class="pilcrow">¶</a></p>
</section>
</div>
<div id="finding-the-wake-token">
<section id="section-2.3.3">
          <h4 id="name-finding-the-wake-token">
<a href="#section-2.3.3" class="section-number selfRef">2.3.3. </a><a href="#name-finding-the-wake-token" class="section-name selfRef">Finding the wake token</a>
          </h4>
<p id="section-2.3.3-1">As C is addressing D with the wake token, R needs to find it in
traffic purportedly for D.<a href="#section-2.3.3-1" class="pilcrow">¶</a></p>
<p id="section-2.3.3-2">As described in <span>[<a href="#I-D.bormann-intarea-alfi" class="xref">I-D.bormann-intarea-alfi</a>]</span>, this cannot be reasonably done with IP
options (which originally would have carried this kind of information
in the IP architecture).<a href="#section-2.3.3-2" class="pilcrow">¶</a></p>
<p id="section-2.3.3-3">Instead, R finds the wake token by deep packet inspection.
The wake token is found by a heuristic that may have false positives;
this is not a problem as the wake token is then verified by its MAC.<a href="#section-2.3.3-3" class="pilcrow">¶</a></p>
<p id="section-2.3.3-4">SWORN requests are carried in UDP packets that also may have a payload
function.  To this end, they are conveyed as CoAP messages <span>[<a href="#RFC7252" class="xref">RFC7252</a>]</span>.  The wake
token is carried in a CoAP option, Wake-Token.  R can find the option
by decoding the CoAP packet in the UDP payload or simply by scanning
for the 5-byte signature 0xda53574f52 created by the CBOR wake token tag.
Any potential wake token so found is then validated as a CWS.<a href="#section-2.3.3-4" class="pilcrow">¶</a></p>
<p id="section-2.3.3-5">This works well with <span>[<a href="#RFC8613" class="xref">RFC8613</a>]</span> as the CoAP security mechanism for
any payload function that this packet may have.  To be able to use
DTLS as well, we define a media type
"application/dtls-payload" that can be used in a CoAP POST request to
send a DTLS payload as payload of a CoAP message (in other words, the
CoAP POST request carries a Wake-Token and a Content-Format option).
(Any return packet can be similarly sent back in the POST response.)
(TODO: This media type has to define the port number juggling needed.)<a href="#section-2.3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="general">
<section id="section-3">
      <h2 id="name-generalizing-sworn-towards-">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-generalizing-sworn-towards-" class="section-name selfRef">Generalizing SWORN towards Token-Based In-Network Authorization</a>
      </h2>
<p id="section-3-1">The original SWORN protocol described so far was designed to solve a
specific use case in a specific implementation environment.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">We can open up the design space in a number of dimensions, which will
be discussed in the following subsections.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">The general idea of SWORN can be described as:<a href="#section-3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-4.1">giving a packet sender a way to send authenticating information with
the packet,<a href="#section-3-4.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-4.2">that is not intended for the recipient of the packet, but instead<a href="#section-3-4.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-4.3">to be checked at particular enforcement points on the way,<a href="#section-3-4.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-4.4">which are not necessarily known by the sender,<a href="#section-3-4.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-4.5">to derive authorization to forward.<a href="#section-3-4.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-5">Generalizing the terms used so far, we can identify the following
players and components:<a href="#section-3-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-6.1">Packets P that require authorization (more generally, the reliable
derivation of attributes) by entities on their way,<a href="#section-3-6.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-6.2">a sender (C) and a recipient (D), where the packets P go from C to D,<a href="#section-3-6.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-6.3">SWORN policy enforcement points (SPEPs) that are in the network in
places where the generalized SWORN authorization of and derivation
of attributes for the packets is performed; the ones that are active
for a packet P are called R, generalizing the
concept of the last-hop router R in the SWORN model,<a href="#section-3-6.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-6.4">the "grant" G that provides setup information for the SPEP (wake
grant in SWORN), and<a href="#section-3-6.4" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-6.5">the "token" T that is sent with a specific packet P to carry
information that will be checked by R/SPEP (wake token in SWORN).<a href="#section-3-6.5" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-3-7">This model can accommodate additional entities, "authorization
managers" (AM), that pair with C (CAM) and D (DAM) for purposes of
creating setup information and potentially distributing it among C and
D and to network elements that might play the role of R.
The distribution may be further facilitated by adding Router AMs
(RAM).<a href="#section-3-7" class="pilcrow">¶</a></p>
<p id="section-3-8">The roles of C and D can also be played by tunnel ingress/egress
points; this can enable the use of unmodified client and device
implementations (note that D, if a DAM is used, need not implement
anything special at all, but can of course benefit from information in
the token).<a href="#section-3-8" class="pilcrow">¶</a></p>
<div id="position-of-router-r">
<section id="section-3.1">
        <h3 id="name-position-of-router-r">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-position-of-router-r" class="section-name selfRef">Position of router R</a>
        </h3>
<p id="section-3.1-1">The original SWORN protocol is based on a 6LoWPAN-like environment
where a host (D) has a defined relationship (often including a MAC layer
security association) to the last-hop router(s) (R) supplying it with packets.
This enables D to provide R with information about wake grants in a
secure way, or to delegate this to its authorization manager.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">Within a limited domain <span>[<a href="#RFC8799" class="xref">RFC8799</a>]</span>, routers that act as SWORN policy enforcement
points (SPEPs) may be known by configuration.  Security associations
from D's authorization manager (DAM) to each such PEP may be set up
already, providing a way for DAM to broadcast policy information to
all such SPEPs.  This enables policy distribution without any
involvement from D.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<p id="section-3.1-3">Alternatively, C can have a security association with the SPEPs
(possibly indirectly through a client authorization manager CAM) and
can send special SWORN probe packets towards D that carry grant
information that the SPEPs on the way can extract and copy into their
local (soft?) state.<a href="#section-3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.1-4">A SPEP could also react to tokens it does not understand by asking
authorization managers for the applicable grant; this may be
facilitated by identifying information in a token such as a "key ID".
It remains a quality of implementation issue whether the packet can be
buffered while the relevant grant is obtained.
(On-demand retrieval of grants also adds an obvious attack vector.)<a href="#section-3.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="position-of-token-in-packet">
<section id="section-3.2">
        <h3 id="name-position-of-token-in-packet">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-position-of-token-in-packet" class="section-name selfRef">Position of Token in Packet</a>
        </h3>
<p id="section-3.2-1">The original SWORN protocol goes to some lengths to avoid the need for
C to influence properties below the application layer of the packets
it sends.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2-2">However, routers may be able to provide more efficient implementations
of SWORN when the token information is in a header.  So if C has a
platform API that could create/influence such a header, this could be
used instead.<a href="#section-3.2-2" class="pilcrow">¶</a></p>
<p id="section-3.2-3">While penultimate hop processing is in use in a number of
architectures (see, e.g., <span><a href="https://rfc-editor.org/rfc/rfc3031#section-3.16" class="relref">Section 3.16</a> of [<a href="#RFC3031" class="xref">RFC3031</a>]</span> or
<span>[<a href="#I-D.ietf-bier-php" class="xref">I-D.ietf-bier-php</a>]</span>), it is not currently part of the IPv6
architecture, so there is no obvious IPv6 header that could carry this information.<a href="#section-3.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="range-of-checking">
<section id="section-3.3">
        <h3 id="name-range-of-checking">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-range-of-checking" class="section-name selfRef">Range of Checking</a>
        </h3>
<p id="section-3.3-1">Tokens in the original SWORN protocol only check a serial number;
attackers might be able to extract such a token from a packet,
suppress the packet, and use the token in a different packet.
We call this form of attack "malicious reuse".
Replay protection cannot prevent this.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<p id="section-3.3-2">One way to reduce this attack vector is to make the grant very
specific to only a certain kind of packets, for instance by effectively
including an ACL (carrying, say, elements of the 5-tuple) with the grant.
(The grant could also include quantitative aspects, such as a rate
limit.)
The cryptographic makeup of the grant then must be such that a client
cannot modify the ACL during generation of a token from the grant.<a href="#section-3.3-2" class="pilcrow">¶</a></p>
<p id="section-3.3-3">Alternatively, some kinds of malicious reuse can be made harder to perform by
including more information in the signing input of the MAC checked for
a token.
If a wake grant is shared between multiple instances of D and C and
therefore can only have a weak ACL, including the source and
destination addresses (IP address and possibly port) in the signing
input for a specific token T prevents reuse of T for a different D/C pair.<a href="#section-3.3-3" class="pilcrow">¶</a></p>
<p id="section-3.3-4">Including the payload in the signing input (i.e., essentially
authenticating the entire packet) makes malicious reuse of tokens less
useful for an attacker as no new information can be injected by it,
but requires considerable processing power in the SPEP.
We assume that any authentication of the whole packet will most likely
be performed by its recipient D, based on a security association it
has with the sender C; R or any other SPEPs are not burdened with this
authentication.  (However, some authentication offload in a last-hop
router R may be desirable for a very constrained device D, at least if
R and D have a robust security association that can provide the
level of authentication needed.)<a href="#section-3.3-4" class="pilcrow">¶</a></p>
<p id="section-3.3-5">Most likely, a token should include some information about what is
included in the signing input.  (This information itself should then
also be included in the signing input.)
This coverage information could take the form of a bitmap, or of a set
of offset-length pairs.
If coverage information and covered information is in a form that can
be processed by a network processor, higher processing and forwarding
rates can be achieved.<a href="#section-3.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="information-attributes-to-be-used-on-the-way">
<section id="section-3.4">
        <h3 id="name-information-attributes-to-b">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-information-attributes-to-b" class="section-name selfRef">Information (attributes) to be used on the way</a>
        </h3>
<p id="section-3.4-1">The original SWORN protocol provides one attribute beyond the
authentication itself: a wake period to be used in the
MAC layer that connects R and D.
This can be generalized to other parameters that control routing and
forwarding, e.g., information that would be equivalent to a DSCP.<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<p id="section-3.4-2">An ambitious use case might be a path from a sender to a recipient
that crosses
multiple domains, where each domain boundary normally bleaches DSCP
information coming in from the previous domain.<a href="#section-3.4-2" class="pilcrow">¶</a></p>
<p id="section-3.4-3">The domain ingress router might check the SWORN information to be able to
apply a policy not to bleach, or to install DSCP information specific
to the domain it belongs to, or to operate on some DSCP-like information
outside the DSCP field.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">Note that the model used by this extended version of SWORN is based on
an assumption that it is in the interest of all players to cooperate
in achieving the objectives.  Security is used to ensure that only
actually authorized players can participate.  But, in general, the
assumed trust and incentive models work best within a limited domain
<span>[<a href="#RFC8799" class="xref">RFC8799</a>]</span>, which spans one or maybe two security domains only.<a href="#section-3.4-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="example-arrangements">
<section id="section-3.5">
        <h3 id="name-example-arrangements">
<a href="#section-3.5" class="section-number selfRef">3.5. </a><a href="#name-example-arrangements" class="section-name selfRef">Example arrangements</a>
        </h3>
<p id="section-3.5-1">This subsection discusses a number of example arrangements with more complex
relationships between the players.
Once the set of clients starts to scale, the issue of key setup
becomes significant.  In the best case, the SPEPs do not need to be
provisioned (set up) separately for each separate client authorization.<a href="#section-3.5-1" class="pilcrow">¶</a></p>
<p id="section-3.5-2">The arrangements presented here are based on symmetric cryptography, specifically
MACs (message authentication codes).
The MACs are based on grant keys <code>GK</code> shared between the origin or a
packet (or of a grant key, see below) and the enforcement point.
Several grant keys may need to be employed; they are differentiated in
the names of variables defined in this section by using suffixes such as
<code>_z</code> for authorization and <code>_n</code> for authentication, or <code>_1</code> and <code>_2</code>
for consecutive steps.<a href="#section-3.5-2" class="pilcrow">¶</a></p>
<p id="section-3.5-3">In these arrangements,
grant keys are managed by "authorization managers" (AM, compare <a href="#fig-sworn-mech" class="xref">Figure 1</a>); we
simplify the discussion by mentioning only the client authorization
manager (CAM), which actually may be in contact with other authorization
managers closer to the SPEPs.  Some grant keys are shared only between
CAM and the SPEPs, requiring the CAM to send a pre-computed MAC to the
client; some grant keys are shared between CAM, Client C, and the
SPEPs, allowing the client to compute MACs covering variable parts of
the packets.<a href="#section-3.5-3" class="pilcrow">¶</a></p>
<p id="section-3.5-4">The MACs of the example arrangements employ a mechanism to indicate
which parts of the packet go into the signing input for the MAC, the
<em>coverage area indication</em>, or <code>cai</code> for short, to be included in each
actual packet.
The realization for this could contain a bitmap with bits that enable
individual predefined fields (e.g., elements of the 5-tuple), plus
pointer/length information for the payload or other dynamic attributes
that need to be checked.
As discussed above, the coverage area indication itself should also go
into the signing input for the MAC.<a href="#section-3.5-4" class="pilcrow">¶</a></p>
<p id="section-3.5-5">The notation "fields(cai_x)" stands for the actual content of the fields in the
packet as enumerated by the coverage area indication cai_x.
If these fields are constant for the authorization conveyed by a grant
key (as is often required by an ACL), they can be included in the
derivation of the grant key; otherwise they are included in the
computation of the MAC keyed by the grant key.<a href="#section-3.5-5" class="pilcrow">¶</a></p>
<p id="section-3.5-6">Multiple MACs (based on a cai per MAC and separate GK) can be used
in each packet.
This can be realized by including all of these MACs in a packet
(possibly by simply XORing them), or by building one of the MACs into
the signing input of another MAC.<a href="#section-3.5-6" class="pilcrow">¶</a></p>
<p id="section-3.5-7">We make the simplifying assumption that the IP address of the client
can be used as a client ID; this is always available in the 5-tuple of
the packet and
can be included in a MAC via the coverage area indication.
We use Cx (C1, C2, ...) to discuss a specific client.<a href="#section-3.5-7" class="pilcrow">¶</a></p>
<p id="section-3.5-8">Based on these common mechanisms, we discuss two arrangements in the
rest of this section.  Other arrangements can be built; the
information in the grants should enable the indication of the exact
structure of the arrangement, enabling the AM to determine which
specific arrangement is in use.<a href="#section-3.5-8" class="pilcrow">¶</a></p>
<div id="mig">
<section id="section-3.5.1">
          <h4 id="name-multiple-independent-grants">
<a href="#section-3.5.1" class="section-number selfRef">3.5.1. </a><a href="#name-multiple-independent-grants" class="section-name selfRef">Multiple Independent Grants</a>
          </h4>
<p id="section-3.5.1-1">In this example arrangement, the AM generates two different kinds of
grants, GK_z for authorization checking over a range of clients, and
GK_n_x that focuses only on authenticating the packet as originating
from a specific client Cx.<a href="#section-3.5.1-1" class="pilcrow">¶</a></p>
<p id="section-3.5.1-2">The corresponding MACs are used as follows:
MAC_z contains information that the AM wants to define, i.e. AM sets
the values of these fields; therefore MAC_z can be pre-computed by the AM.
MAC_n also contains information that the AM wants Cx to define, i.e. AM
identifies the fields (sets cai) and lets Cx set the values of these fields.
(As an example, the wake_period of original SWORN would be in MAC_n.)<a href="#section-3.5.1-2" class="pilcrow">¶</a></p>
<p id="section-3.5.1-3">GK_z is not provided to the clients, instead the CAM provides the
client with a ready-made token complete with a MAC, called MAC_z,
based on the grant key.
This token indicates authorization for its coverage area (typically
elements of the 5-tuple, plus possibly some
more dynamic attributes).
It is pre-computed for each client Cx and conveyed to Cx from the CAM; as
there is no replay protection of the authorization, this token can be
used essentially as a bearer token, until dynamic attributes or keys
need to be updated (then a new authorization token needs to be sent
from CAM to each Cx that shall continue to communicate).<a href="#section-3.5.1-3" class="pilcrow">¶</a></p>
<p id="section-3.5.1-4">The SPEP also has GK_z and can check the tokens based on the
information in the packet
(and possibly cache e.g. MAC_z for the flow, if not pre-computed from a table
of client IDs).<a href="#section-3.5.1-4" class="pilcrow">¶</a></p>
<p id="section-3.5.1-5">This approach alone does not protect against replay attacks.
For this, we introduce GK_n_x in corresponding client grants, carrying a client-specific
authentication key.  Each GK_n_x is provided by the CAM to
both an individual Cx and (indirectly via GK_z) to the SPEPs.
The authentication key is used against a selected subset of the
five-tuple, the dynamic attributes, and the payload.
It effectively proves that the holder of this key, Cx, is the actual
originator of the packet.  It does not prove authorization of a
specific five-tuple plus attributes; this is
the job of the GK_z/MAC_z.<a href="#section-3.5.1-5" class="pilcrow">¶</a></p>
<p id="section-3.5.1-6">Each packet carries MAC_z based on the shared grant key (bearer token
supplied by CAM for a specific selection of elements from the 5-tuple,
proving that this communication with this selection of 5-tuple
elements is generally authorized.)
A typical selection from the 5-tuple would comprise the source
(client) and destination (device) IP addresses as well as the
destination port number and protocol; the source port number would
remain dynamic to be chosen by the client in this case.
(MAC_z could also cover further attributes relevant to the
authorization, such as an application-id or performance parameters
such as intended maximum bitrate and traffic priority; some of these
attributes could be included in the token, others could be derived
from policy and an attribute such as an application-id.)<a href="#section-3.5.1-6" class="pilcrow">¶</a></p>
<p id="section-3.5.1-7">We assume that the mechanisms discussed here need to provide source
authentication for the packets from Cx.
If a separate source authentication mechanism is available, GK_n_x and
MAC_n are not needed.
Otherwise, for authentication, each packet also carries MAC_n based
on GK_n_x, which proves the actual origin of the packet; the
authorization that applies to the packet needs to be checked via the
authorization token.
The coverage area of MAC_n is indicated by cai_n; this will
generally be a superset of cai_z and will include the source port
number as well, so this can be freely chosen by the client but is
still authenticated.<a href="#section-3.5.1-7" class="pilcrow">¶</a></p>
<p id="section-3.5.1-8">The payload may or may not be included into the signing input to
MAC_n (this is also indicated by cai_n).
If the payload is included, this ensures that an attacker can only
replay completely identical packets; in situations where this kind of
replay would not be a problem, no replay window mechanism needs to be
employed.<a href="#section-3.5.1-8" class="pilcrow">¶</a></p>
<p id="section-3.5.1-9">In summary (bracket notation <code>[..., ...]</code> stands for an array of values):<a href="#section-3.5.1-9" class="pilcrow">¶</a></p>
<p id="section-3.5.1-10">MAC_z = MAC([cai_z, fields(cai_z), attributes, cai_n, timestamp], GK_z)<a href="#section-3.5.1-10" class="pilcrow">¶</a></p>
<p id="section-3.5.1-11">MAC_n = MAC([serial, cai_n, fields(cai_n)], GK_n_x)<a href="#section-3.5.1-11" class="pilcrow">¶</a></p>
<p id="section-3.5.1-12">where the CAM provides to Cx:<a href="#section-3.5.1-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1-13.1">GK_n_x = KDF(["key for MAC_n", CxID, GK_z])<a href="#section-3.5.1-13.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.1-13.2">all other inputs to MAC_z except for timestamp<a href="#section-3.5.1-13.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.1-13.3">MAC_z<a href="#section-3.5.1-13.3" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.5.1-14">The actual information in the packet contains the token:<a href="#section-3.5.1-14" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-3.5.1-15">
            <dt id="section-3.5.1-15.1">
Token =  </dt>
            <dd style="margin-left: 1.5em" id="section-3.5.1-15.2">
              <span class="break"></span><dl class="dlNewline" id="section-3.5.1-15.2.1">
                <dt id="section-3.5.1-15.2.1.1">
[cai_z, cai_n, GK_z-kid, CxID, attributes_conveyed,      </dt>
                <dd style="margin-left: 1.5em" id="section-3.5.1-15.2.1.2">
                  <p id="section-3.5.1-15.2.1.2.1">(MAC_z xor MAC_n_x)]<a href="#section-3.5.1-15.2.1.2.1" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
</dl>
</dd>
          <dd class="break"></dd>
</dl>
<p id="section-3.5.1-16">The provisioning needed is limited to distributing grant keys GK_z for each
specific authorization (e.g., Device IP address/port number) plus
a base key GK_n_x to derive authentication keys for each client Cx.
These are connected by the common parts of the 5-tuple and a CxID.<a href="#section-3.5.1-16" class="pilcrow">¶</a></p>
<p id="section-3.5.1-17">The role of the different keys can be summarized as follows:<a href="#section-3.5.1-17" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.1-18.1">
              <p id="section-3.5.1-18.1.1">GK_z, known only by AM and the SPEPs, allows the AM to specify the
authorization information, which then can be checked by the SPEP
using MAC_z under the key GK_z.<a href="#section-3.5.1-18.1.1" class="pilcrow">¶</a></p>
<p id="section-3.5.1-18.1.2">
Since the AM can compute the MAC_z ahead of time, from the point of
view of the client MAC_z essentially serves as a bearer token,
which however is only useful for packets with the fields(cai_z)
that are being authorized by AM.<a href="#section-3.5.1-18.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.5.1-18.2">GK_n_x provides client x with a way to authenticate a wider
coverage, including values of the client's choice such as the source
port number or even the payload.
Here, client x needs to have the key so it can dynamically vary
these fields without needing to recur to AM.<a href="#section-3.5.1-18.2" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
<div id="hig">
<section id="section-3.5.2">
          <h4 id="name-hierarchical-grants">
<a href="#section-3.5.2" class="section-number selfRef">3.5.2. </a><a href="#name-hierarchical-grants" class="section-name selfRef">Hierarchical Grants</a>
          </h4>
<p id="section-3.5.2-1"><a href="#mig" class="xref">Section 3.5.1</a> requires distributing separate authentication grants for each
client Cx to each SPEP, which may however be orthogonal to the
specific authorizations granted.<a href="#section-3.5.2-1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-2">We cannot completely eliminate per-client "provisioning" as SPEP needs
to know about the authorization it needs to enforce.
However, by giving clients (e.g., C1/C2) more specific information
than SPEP, we can relieve SPEP from needing to know each of C1/C2
a priori, as follows:<a href="#section-3.5.2-2" class="pilcrow">¶</a></p>
<p id="section-3.5.2-3">Let GK0 be the <em>generic grant Key</em>, which is generated by CAM and told
to the SPEPs in a generic grant.
Clients never obtain GK0.<a href="#section-3.5.2-3" class="pilcrow">¶</a></p>
<p id="section-3.5.2-4">Let GKx be a <em>specific grant Key</em>, which is generated by CAM for each
Cx and told to Cx in a <em>specific grant</em>.
Client x only knows its own GKx, not that of other clients Cy.<a href="#section-3.5.2-4" class="pilcrow">¶</a></p>
<p id="section-3.5.2-5">For a complete exposition, we also introduce cai_1 and cai_2:<a href="#section-3.5.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2-6.1">Both cai_1 and fields(cai_1) are shared between CAM and SPEP in
a generic grant; fields(cai_1) are the constant parts of the
packets to be authorized (e.g., device IP address, device port number).<a href="#section-3.5.2-6.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-3.5.2-6.2">cai_2 is a superset of cai_1; it indicates the fields that need to be
checked by SPEP.  The generic grant provides cai_2, but not
fields(cai_2), as these can differ per packet and are chosen by Cx.<a href="#section-3.5.2-6.2" class="pilcrow">¶</a>
</li>
          </ul>
<p id="section-3.5.2-7">Ignoring nonces, serials, and key identifier/lifetime/rollover
mechanisms, the following computations can be done:<a href="#section-3.5.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.5.2-8.1">
              <p id="section-3.5.2-8.1.1">by CAM or SPEP (who both know GK0 and cai_1, i.e. generic
information about all packets covered by this grant):<a href="#section-3.5.2-8.1.1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-8.1.2">
Grant_x = [GK0-kid, cai_1, cai_2, fields(cai_1), GKx]<a href="#section-3.5.2-8.1.2" class="pilcrow">¶</a></p>
<p id="section-3.5.2-8.1.3">
where GKx = KDF([cai_1, cai_2, fields(cai_1), GK0])<a href="#section-3.5.2-8.1.3" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.5.2-8.2">
              <p id="section-3.5.2-8.2.1">by Cx based on its provisioned GKx and a specific packet, but also
by SPEP based on the GKx the SPEP can compute for Cx<a href="#section-3.5.2-8.2.1" class="pilcrow">¶</a></p>
<p id="section-3.5.2-8.2.2">
token = [GK0-kid, cai_1, cai_2,
         MAC([serial, cai_2, fields(cai_2)], GKx)]<a href="#section-3.5.2-8.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.5.2-9">(These computations do not explicitly mention a client ID, which is
implied by the source IP address included in <code>fields(cai_</code><em>n</em><code>)</code>.)<a href="#section-3.5.2-9" class="pilcrow">¶</a></p>
<p id="section-3.5.2-10">Note that the token can be verified by SPEP as it can compute GKx
from the secret key GK0 that is only shared between CAM and SPEP, as
long as it knows which GK0 to apply (e.g., using GK0-kid, which here
simply is copied into the token).
As they don't know GK0, the individual clients Cx cannot compute GKx -- they
need to obtain it from CAM as part of Grant_x, which also gives them
cai_1 and cai_2 -- containing the information
for Cx how to apply the GKx.
The token, computed from GKx, therefore authenticates Cx as the
holder of xGKx, and signifies the authorization of Cx to send a packet
with fields(cai_1) as indicated in GKx,
with the additional requirement on Cx that it also authenticates a
serial number (used for replay protection) and additional
fields(cai_2).<a href="#section-3.5.2-10" class="pilcrow">¶</a></p>
<p id="section-3.5.2-11">Since the token includes the relevant parts of the 5-tuple, and
cai_1 is part of the first MAC and therefore cannot be changed by
the Cxes, there is no need to apply any additional ACL beyond feeding
the <code>cai</code>-selected fields of the packet into the MAC.<a href="#section-3.5.2-11" class="pilcrow">¶</a></p>
<p id="section-3.5.2-12">So GK0 only needs to be provisioned once to the SPEPs for all Cxes;
each GKx is provisioned only to Cx.
An SPEP can compute GKx from cai_1, cai_2 (part of the token)
and fields(cai_1) (taken from the packet).
GKx is eminently cacheable, but in any case does <em>not</em> need
to be provisioned as it can be derived from GK0 and information that
is in the packet.<a href="#section-3.5.2-12" class="pilcrow">¶</a></p>
<p id="section-3.5.2-13">C1 and C2 have GK1 and GK2, respectively; the coverage area is easily
extended to include D1-address and D1-port etc., by setting the bits in
either cai_1 (if these are fixed for Cx) or cai_2 (if these
can be chosen by Cx).<a href="#section-3.5.2-13" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="iana-considerations">
<section id="section-4">
      <h2 id="name-iana-considerations">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<div id="original-sworn-model">
<section id="section-4.1">
        <h3 id="name-original-sworn-model">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-original-sworn-model" class="section-name selfRef">Original SWORN model</a>
        </h3>
<p id="section-4.1-1">Define CBOR Wake-Token Tag 1398230866 in <span>[<a href="#IANA.cbor-tags" class="xref">IANA.cbor-tags</a>]</span>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">Define CoAP option Wake-Token in the
<a href="https://www.iana.org/assignments/core-parameters#option-numbers" class="relref">CoAP Option Numbers</a> Registry
of <span>[<a href="#IANA.core-parameters" class="xref">IANA.core-parameters</a>]</span> (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-12.2" class="relref">Section 12.2</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>.
(The option is safe, no-cache-key, elective, repeatable, of type
opaque 0-255 bytes.)<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">Define media-type "application/dtls-payload", with an associated CoAP
Content-Format in the
<a href="https://www.iana.org/assignments/core-parameters#content-formats" class="relref">CoAP Content-Formats</a> Registry
of <span>[<a href="#IANA.core-parameters" class="xref">IANA.core-parameters</a>]</span> (<span><a href="https://rfc-editor.org/rfc/rfc7252#section-12.3" class="relref">Section 12.3</a> of [<a href="#RFC7252" class="xref">RFC7252</a>]</span>.<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="generalized-model">
<section id="section-4.2">
        <h3 id="name-generalized-model">
<a href="#section-4.2" class="section-number selfRef">4.2. </a><a href="#name-generalized-model" class="section-name selfRef">Generalized model</a>
        </h3>
<p id="section-4.2-1">TBD<a href="#section-4.2-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-5">
      <h2 id="name-security-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-5-1">The purpose of the security mechanisms described is primarily to
protect availability (obviously, any symmetric keys employed also need
to be confidentiality protected for the sake of the integrity of the
mechanism).
For the purposes of this kind of availability protection, occasional
false positives of the per-packet authorization mechanisms may be
acceptable, as long as they don't reach a threshold of probability of success that
is application dependent (say, success in one out of a million of
brute force attempts, equivalent to 20-bit security).
This may offer optimization opportunities that need further study.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">TBD<a href="#section-5-2" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6">
      <h2 id="name-references">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-6.1">
        <h3 id="name-normative-references">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="IANA.cbor-tags">[IANA.cbor-tags]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR) Tags"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cbor-tags">https://www.iana.org/assignments/cbor-tags</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="IANA.core-parameters">[IANA.core-parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/core-parameters">https://www.iana.org/assignments/core-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7252">https://www.rfc-editor.org/info/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8152">[RFC8152]</dt>
        <dd>
<span class="refAuthor">Schaad, J.</span>, <span class="refTitle">"CBOR Object Signing and Encryption (COSE)"</span>, <span class="seriesInfo">RFC 8152</span>, <span class="seriesInfo">DOI 10.17487/RFC8152</span>, <time datetime="2017-07" class="refDate">July 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8152">https://www.rfc-editor.org/info/rfc8152</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8392">https://www.rfc-editor.org/info/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8610">[RFC8610]</dt>
        <dd>
<span class="refAuthor">Birkholz, H.</span>, <span class="refAuthor">Vigano, C.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"Concise Data Definition Language (CDDL): A Notational Convention to Express Concise Binary Object Representation (CBOR) and JSON Data Structures"</span>, <span class="seriesInfo">RFC 8610</span>, <span class="seriesInfo">DOI 10.17487/RFC8610</span>, <time datetime="2019-06" class="refDate">June 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8610">https://www.rfc-editor.org/info/rfc8610</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8747">[RFC8747]</dt>
        <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Seitz, L.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"Proof-of-Possession Key Semantics for CBOR Web Tokens (CWTs)"</span>, <span class="seriesInfo">RFC 8747</span>, <span class="seriesInfo">DOI 10.17487/RFC8747</span>, <time datetime="2020-03" class="refDate">March 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8747">https://www.rfc-editor.org/info/rfc8747</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
      <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8949">https://www.rfc-editor.org/info/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-6.2">
        <h3 id="name-informative-references">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.bormann-intarea-alfi">[I-D.bormann-intarea-alfi]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"Adaptation Layer Fragmentation Indication"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-bormann-intarea-alfi-04</span>, <time datetime="2013-09-09" class="refDate">9 September 2013</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-bormann-intarea-alfi-04.txt">https://www.ietf.org/archive/id/draft-bormann-intarea-alfi-04.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-bier-php">[I-D.ietf-bier-php]</dt>
        <dd>
<span class="refAuthor">Zhang, Z.</span>, <span class="refTitle">"BIER Penultimate Hop Popping"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-bier-php-07</span>, <time datetime="2021-12-07" class="refDate">7 December 2021</time>, <span>&lt;<a href="https://www.ietf.org/archive/id/draft-ietf-bier-php-07.txt">https://www.ietf.org/archive/id/draft-ietf-bier-php-07.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC3031">[RFC3031]</dt>
        <dd>
<span class="refAuthor">Rosen, E.</span>, <span class="refAuthor">Viswanathan, A.</span>, and <span class="refAuthor">R. Callon</span>, <span class="refTitle">"Multiprotocol Label Switching Architecture"</span>, <span class="seriesInfo">RFC 3031</span>, <span class="seriesInfo">DOI 10.17487/RFC3031</span>, <time datetime="2001-01" class="refDate">January 2001</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc3031">https://www.rfc-editor.org/info/rfc3031</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7228">[RFC7228]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refAuthor">Ersue, M.</span>, and <span class="refAuthor">A. Keranen</span>, <span class="refTitle">"Terminology for Constrained-Node Networks"</span>, <span class="seriesInfo">RFC 7228</span>, <span class="seriesInfo">DOI 10.17487/RFC7228</span>, <time datetime="2014-05" class="refDate">May 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7228">https://www.rfc-editor.org/info/rfc7228</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8613">https://www.rfc-editor.org/info/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8799">[RFC8799]</dt>
      <dd>
<span class="refAuthor">Carpenter, B.</span> and <span class="refAuthor">B. Liu</span>, <span class="refTitle">"Limited Domains and Internet Protocols"</span>, <span class="seriesInfo">RFC 8799</span>, <span class="seriesInfo">DOI 10.17487/RFC8799</span>, <time datetime="2020-07" class="refDate">July 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8799">https://www.rfc-editor.org/info/rfc8799</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="acknowledgements">
<section id="appendix-A">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="appendix-A-1"><span class="contact-name"><span class="non-ascii">陈博</span> (<span class="ascii">Bo Chen</span>)</span> provided input for <a href="#general" class="xref">Section 3</a>.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<p id="appendix-A-2">TBD<a href="#appendix-A-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-B">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Carsten Bormann</span></div>
<div dir="auto" class="left"><span class="org">Universität Bremen TZI</span></div>
<div dir="auto" class="left"><span class="street-address">Postfach 330440</span></div>
<div dir="auto" class="left">
<span class="postal-code">D-28359</span> <span class="locality">Bremen</span>
</div>
<div dir="auto" class="left"><span class="country-name">Germany</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+49-421-218-63921" class="tel">+49-421-218-63921</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:cabo@tzi.org" class="email">cabo@tzi.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Yizhou Li</span></div>
<div dir="auto" class="left"><span class="org">Huawei Technologies</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:liyizhou@huawei.com" class="email">liyizhou@huawei.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
