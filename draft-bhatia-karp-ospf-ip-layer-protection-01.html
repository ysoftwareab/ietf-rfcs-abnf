<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Security Extension for OSPFv2 when using
    Manual Key Management</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Security Extension for OSPFv2 when using
    Manual Key Management">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 60em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 60em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 60em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">KARP Working Group</td><td class="header">M. Bhatia</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">Alcatel-Lucent</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">S. Hartman</td></tr>
<tr><td class="header">Expires: July 17, 2011</td><td class="header">Painless Security</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">D. Zhang</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Huawei Technologies co., LTD.</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">January 13, 2011</td></tr>
</table></td></tr></table>
<h1><br />Security Extension for OSPFv2 when using
    Manual Key Management<br />draft-bhatia-karp-ospf-ip-layer-protection-01</h1>

<h3>Abstract</h3>

<p> The current OSPFv2 cryptographic authentication mechanism as defined
             in the OSPF standards is vulnerable to both inter and intra replay attacks
             when its uses manual keying. Additionally, the
      existing cryptographic authentication schemes do not cover the IP header.
      This omission can be exploited  to carry out various types  of attacks. 
</p>
<p>This draft proposes an authentication scheme based on a 
      challenge-response mechanism that will protect OSPFv2 from both inter and intra 
     replay attacks when its using manual keys for securing its protocol packets.
     Later we also describe some changes in the cryptographic 
     hash computation so that we eliminate most attacks that result because
     of OSPFv2 not protecting the IP header.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted  in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF).  Note that other groups may also distribute
working documents as Internet-Drafts.  The list of current
Internet-Drafts is at http://datatracker.ietf.org/drafts/current/.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
This Internet-Draft will expire on July 17, 2011.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2011 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the Simplified BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<br />
<a href="#anchor2">2.</a>&nbsp;
A Challenge and Response Solution<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor3">2.1.</a>&nbsp;
Receiver Behavior<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#NONCE_TRIGGER">2.2.</a>&nbsp;
Nonce Triggers<br />
<br />
<a href="#anchor4">3.</a>&nbsp;
Packet Format<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">3.1.</a>&nbsp;
Extensions to the Protocol Header<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor6">3.2.</a>&nbsp;
Extension of Hello Packet<br />
<br />
<a href="#anchor7">4.</a>&nbsp;
Key Selection in Processing OSPF Packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">4.1.</a>&nbsp;
Key Selection in Sending Unicast OSPF Packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">4.2.</a>&nbsp;
Key Selection in Sending Multicast OSPF Packets<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">4.3.</a>&nbsp;
Key Selection on Receiving OSPF Packets <br />
<br />
<a href="#anchor11">5.</a>&nbsp;
Existing Cryptographic Authentication Mechanism<br />
<br />
<a href="#anchor12">6.</a>&nbsp;
Mechanism to secure the IP header<br />
<br />
<a href="#Security">7.</a>&nbsp;
Security Considerations<br />
<br />
<a href="#IANA">8.</a>&nbsp;
IANA Considerations<br />
<br />
<a href="#rfc.references1">9.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">9.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">9.2.</a>&nbsp;
Informative References<br />
<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
    "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
    document are to be interpreted as described in RFC2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<p>When used in lower case, these words convey their typical use in common
    language, and are not to be interpreted as described in RFC2119 <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p> The OSPFv2 cryptographic authentication mechanism
             as described in [<a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a>] uses per-packet
            sequence numbers to provide protection against replay attacks.

 The sequence numbers increase monotonically so that the
      attempts to replay the stale packets can be thwarted. The
      sequence number values are maintained as a
      part of adjacency states. Therefore, if an adjacency is broken down, the
      associated sequence numbers get re-initiated and the neighbors start all over again. 
      Additionally, the
      cryptographic authentication mechanism does not specify how to deal with
      the rollover of a sequence number when it reaches its maximum limit. These
      omissions can be taken advantage of by attackers to implement various
      replay attacks (<a class='info' href='#RFC6039'>[RFC6039]<span> (</span><span class='info'>Manral, V., Bhatia, M., Jaeggli, J., and R. White, &ldquo;Issues with Existing Cryptographic Protection Methods for Routing Protocols,&rdquo; October&nbsp;2010.</span><span>)</span></a>). In order to address these issues, 
      we propose a challenge/ response mechanism that introduces two additional random
      numbers to help routers generate distinguishable new states when the
      sequence numbers need to be re-initiated. Compared with the
      cryptographic authentication mechanism proposed in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>, the solution proposed does not impose any more
      security presumption.
</p>
<p>The cryptographic 
    authentication as described in <a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> and 
   later updated in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a> does not include the IP
   header.  This also can be exploited to launch several attacks as the source address 
  in the IP header is no longer protected. The OSPF specification,  in certain cases, requires the implementations to 
  look at the source address carried in the IP header to determine the neighbor the 
packet was recieved from. Changing the source address of a packet
   can thus, confuse the reciever which can be exploited to produce a number of denial of service attacks 
<a class='info' href='#RFC6039'>[RFC6039]<span> (</span><span class='info'>Manral, V., Bhatia, M., Jaeggli, J., and R. White, &ldquo;Issues with Existing Cryptographic Protection Methods for Routing Protocols,&rdquo; October&nbsp;2010.</span><span>)</span></a>.  If the packet is
   interpreted as coming from a different neighbor, the sequence number
   received from the neighbor may be updated.  This may disrupt
   communication with the legitimate neighbor.  Hello packets may be
   reflected to cause a neighbor to appear to have one-way
   communication.  Old Database descriptions may be reflected in cases
   where the per-packet sequence numbers are sufficiently divergent in
   order to disrupt an adjacency <a class='info' href='#I-D.hartman-ospf-analysis'>[I&#8209;D.hartman&#8209;ospf&#8209;analysis]<span> (</span><span class='info'>Hartman, S. and D. Zhang, &ldquo;Analysis of OSPF Security According to KARP Design Guide,&rdquo; December&nbsp;2010.</span><span>)</span></a>.
This is  referred to as the IP layer issue in <a class='info' href='#I-D.ietf-karp-threats-reqs'>[I&#8209;D.ietf&#8209;karp&#8209;threats&#8209;reqs]<span> (</span><span class='info'>Lebovitz, G., Bhatia, M., and R. White, &ldquo;The Threat Analysis and Requirements for Cryptographic Authentication of Routing Protocols' Transports,&rdquo; October&nbsp;2010.</span><span>)</span></a>.
   
</p>
<p>
	<a class='info' href='#RFC2328'>[RFC2328]<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> states that implementations MUST offer keyed MD5 
   authentication. It is likely that this will be deprecated in favor of  the stronger algorithms
   described in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a> in future deployments <a class='info' href='#I-D.ietf-opsec-igp-crypto-requirements'>[I&#8209;D.ietf&#8209;opsec&#8209;igp&#8209;crypto&#8209;requirements]<span> (</span><span class='info'>Bhatia, M. and V. Manral, &ldquo;Summary of Cryptographic Authentication Algorithm Implementation Requirements for Routing Protocols,&rdquo; October&nbsp;2010.</span><span>)</span></a>.

</p>
<p>
	This draft proposes a simple change in the cryptographic authentication 
	mechanism, as currently described in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>,
    to prevent such IP layer attacks.
  
</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
A Challenge and Response Solution</h3>

<p>In OSPFv2, a non-decreasing sequence member is associated with each
      OSPF packet sent from a router in order to prevent replay attacks.
      However, as illustrated in <a class='info' href='#I-D.hartman-ospf-analysis'>[I&#8209;D.hartman&#8209;ospf&#8209;analysis]<span> (</span><span class='info'>Hartman, S. and D. Zhang, &ldquo;Analysis of OSPF Security According to KARP Design Guide,&rdquo; December&nbsp;2010.</span><span>)</span></a> and
     <a class='info' href='#RFC6039'>[RFC6039]<span> (</span><span class='info'>Manral, V., Bhatia, M., Jaeggli, J., and R. White, &ldquo;Issues with Existing Cryptographic Protection Methods for Routing Protocols,&rdquo; October&nbsp;2010.</span><span>)</span></a>, 
      in the circumstances where automatic key management mechanisms are
      unavailable, any re-initiation of sequence numbers can potentially be
      taken advantage of to perform replay attacks. In this section, we
      introduce an extension of the OSPFv2 protocol, which uses
      challenge/response to benefit the verification of the freshness of OSPF
      packets when the sequence numbers of routers are re-initiated. This
      solution eliminates the reliance on automatic key management mechanisms.
      However, it is assumed that a traffic key is shared between two
      communicating routers so that an attacker can play antique packets but
      lacks the capability to modify packets without being detected.
</p>
<p>In this protocol, two random numbers (Session ID and Nonce) are
      introduced. The session ID is used to identify the session a packet is
      within and thus makes inter-session replay attacks difficult. The nonce
      is used to challenge the liveness of communicating routers so that
      states need not be maintained with routers that are not currently
      neighbors. In combination with the sequence number, the session ID can
      effectively resist intra-session replay attacks. When the sequence space
      is exhausted, a router simply chooses a new session ID.
</p>
<p>Figure 1 illustrates how two routers A and B, challenge each other's
      liveness when they are initially connected to a link. First, A selects
      a new session ID (X1) and a new nonce (N1), and sends them out within a
      hello packet (see step 1). Particularly, X1and N1 are encapsulated in
      the OSPF header of the packet. Similarly, B sends a hello packet with
      its new session ID (X2) and Nonce (N2) (step 2). Upon receiving the
      hello packet from B, A sends a hello packet with X1 and N1. In the
      neighbor field of the packet, the router ID of B, X2, and N2 is
      encapsulated (Step 3). Upon receiving the packet sent in step 3, B can
      ensure the freshness of the packet if the attached session ID and nonce
      values of both routers are correct.
</p>
<p>In the same way, after receiving the hello packet from A, B sends a
      hello packet with X2 and N2 in the OSPF header, and in the neighbor
      field of the packet, the router ID of A, X1, and N1 is listed to
      identify that A has been discovered. After receiving the packet, A can
      make sure the packet is fresh if the session IDs and the nonce of both
      routers contained in the packet are correct. After A and B discover each
      other, they start exchanging their database information (steps 5 and 6).
      During the exchange, every packet from Router A is associated with X1
      and N1, while every packet from Router B is associated with X2 and N2.
      Each of these packets also contains a sequence number as part of the
      cryptographic authentication option. The sequence number MUST increase
      for every packet sent.
</p>
<p>
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>     +---------------+                             +---------------+
     |    router A   |                             |   router B    |
     +---------------+                             +---------------+
     ---------------------------------------------------------------

     OSPF Hdr: Session ID = X1; Nonce = N1; OSPF HELLO: Neighbor = 0
 (1)  ------------------------------------&gt;

     OSPF Hdr: Session ID = X2; Nonce = N2; OSPF HELLO: Neighbor = 0
 (2)                           &lt;------------------------------------

     OSPF Hdr: Session ID = X1; Nonce = N1; OSPF HELLO: Neighbor = B;
     Session ID = X2; Nonce = N2
 (3) ------------------------------------&gt;

     OSPF Hdr: Session ID = X2; Nonce = N2; OSPF HELLO: Neighbor = A;
     Session ID = X1; Nonce = N1
 (4)                           &lt;------------------------------------

     OSPF Hdr: Session ID = X1; Nonce = N1; Normal OSPF DD packet
 (5) ------------------------------------&gt;

     OSPF Hdr: Session ID = X2; Nonce = N2 Normal OSPF DD packet
 (6)                           &lt;------------------------------------

                                       *
                                       *
                                       *

     OSPF Hdr: Session ID = X1; Nonce = N1; OSPF HELLO: Neighbor = B;
     Session ID = X2; Nonce = N2
 (7) ------------------------------------&gt;

Figure 1 Scenario: two Routers coming up on a LAN</pre></div>
<p>
</p>
<p>After A and B have generated a neighbor relationship, assume another
      router, C, is connected to the link. C finds the existence of A and
      intends to become a neighbor of A. The packets exchanged during this
      process are illustrated in Figure 2. Firstly, C selects a new session ID
      (X3) and a new nonce value (N3), and sends them out within a blank hello
      packet (see the second step of Figure 2). After receiving this packet, A
      sends out a hello packet with the information of C (router ID, X3, and
      N3) in the neighbor field. Because A is challenging the liveness of a
      new neighbor, A selects a new nonce N1' and encapsulates it in the OSPF
      header of the hello packet to challenge whether the packet sent in step
      2 is really from C. After receiving the packet from A, C can make sure
      the packet is valid since it consists of its current session ID and
      nonce (e.g., X3 and N3). Thus, C replies to A with a hello packet
      including the information of A (e.g., X1 and N1') in the neighbor field.
      After receiving this packet and checking the correctness of X1 and N1',
      A can ensure that the packet is fresh and C is currently online.
</p>
<p>
</p>
<p>
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>     +---------------+                             +---------------+
     |    router A   |                             |   router C    |
     +---------------+                             +---------------+
     --------------------------------------------------------------

     OSPF Hdr: Session ID = X1; Nonce = N1; OSPF HELLO: Neighbor = B;
     Session ID = X2; Nonce = N2
 (1)  ------------------------------------&gt;

     OSPF Hdr: Session ID = X3; Nonce = N3; OSPF HELLO: Neighbor = 0
 (2)                           &lt;------------------------------------

     OSPF Hdr: Session ID = X1; Nonce = N1'; OSPF HELLO: Neighbor = B;
     Session ID = X2; Nonce = N2; Neighbor = C;
     Session ID = X3; Nonce = N3
 (3) ------------------------------------&gt;

     OSPF Hdr: Session ID = X3; Nonce = N3; OSPF HELLO: Neighbor = A;
     Session ID = X1; Nonce = N1'
 (4)                            &lt;------------------------------------

     OSPF Hdr: Session ID = X1; Nonce = N1'; Normal OSPF DD packet
 (5) ------------------------------------&gt;

     OSPF Hdr: Session ID = X3; Nonce = N3 Normal OSPF DD packet
 (6)                            &lt;------------------------------------

                                       *
                                       *
                                       *

     OSPF Hdr: Session ID = X1; Nonce = N1'; OSPF HELLO: Neighbor = B;
     Session ID = X2; Nonce = N2; Neighbor = C;
     Session ID = X3; Nonce = N3
 (7) ------------------------------------&gt;

Figure 2. Scenario: another Router C comes up on that LAN

</pre></div><p>

      
</p>
<p>Figure 3 illustrates the scenario in which router A is rebooted.
      After the reboot, A lost its state and selects a new session ID (X4) and
      a new nonce value (N4). However, B still maintains the earlier session
      ID and nonce values of A (X1 and N1). In step 1, A sends a blank hello
      packet out with its new session ID and nonce value. After receiving the
      hello packet, B realizes that the session ID and the nonce value of A in
      the OSPF header are different from the ones maintained in its database.
      In order to distinguish a reboot from a replay of an old packet, B
      selects a new nonce value, N2', and transports it as well as its session
      ID (X2) in a hello packet to check whether the packet is from A. In the
      neighbor field of this packet, B continues listing A with the earlier
      session ID and nonce values (i.e., X1 and N1). Therefore, if an attacker
      attempts to send an antique packet to masquerade as A, A would update
      its database with the new nonce of B and send a hello packet with its
      existing Session ID and nonce values (X1 and N1). In step 3, B receives
      a new hello packet consisting of B's new nonce value from A. Since this
      packet lists B with the new nonce value in the neighbors field of the
      hello and since the nonce is new, this packet cannot be a replay. Now, B
      can safely assume that A has indeed restarted and can start using the
      new session ID and the nonce values sent by A in the neighbor field of
      its hellos.
</p>
<p>
        </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>     +---------------+                              +---------------+
     |    router A   |                              |   router B    |
     +---------------+                              +---------------+
     ---------------------------------------------------------------

     OSPF Hdr: Session ID = X4; Nonce = N4; OSPF HELLO: Neighbor = 0
 (1)  ------------------------------------&gt;

     OSPF Hdr: Session ID = X2; Nonce = N2'; OSPF HELLO: Neighbor = A;
     Session ID = X1; Nonce = N1
 (2)                            &lt;------------------------------------

     OSPF Hdr: Session ID = X4; Nonce = N4; OSPF HELLO: Neighbor = B;
     Session ID = X2; Nonce = N2'
 (3) ------------------------------------&gt;

     OSPF Hdr: Session ID = X2; Nonce = N2'; OSPF HELLO: Neighbor = A;
     Session ID = X4; Nonce = N4
 (4)                             &lt;------------------------------------

     OSPF Hdr: Session ID = X4; Nonce = N4; Normal OSPF DD packet
 (5) ------------------------------------&gt;

     OSPF Hdr: Session ID = X2; Nonce = N2' Normal OSPF DD packet
 (6)                             &lt;------------------------------------

                                       *
                                       *
                                       *

     OSPF Hdr: Session ID = X4; Nonce = N4; OSPF HELLO: Neighbor = B;
     Session ID = X2; Nonce = N2'
 (7) ------------------------------------&gt;

Figure 3. Scenario: Router A Reboot

</pre></div><p>

      
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.1"></a><h3>2.1.&nbsp;
Receiver Behavior</h3>

<p>This section describes how OSPF receivers will handle the reception
        of packets with the nonce and session ID.
</p>
<p>If a packet other than a hello is received with the new
        cryptographic authentication option, it must correspond to an existing
        neighbor relationship in at least the 2-way state. If the neighbor is
        not in 2-way state or greater, the packet is discarded. If the session
        ID does not match the session ID recorded with the neighbor, the
        packet is discarded. If the sequence number in the cryptographic
        authentication option is not strictly greater than the sequence number
        associated with the neighbor, then the packet is discarded. If the
        cryptographic verification of the checksum fails, the packet is
        discarded. Otherwise, the packet is accepted by the cryptographic
        authentication and the sequence number associated with the neighbor is
        updated to be the sequence number in the packet.
</p>
<p>If a hello is received for a neighbor that is not found or that has
        not reached 2-way state, the following steps are performed. If a
        neighbor structure exists for the neighbor and the session ID match
        that stored in the neighbor structure, then the packet is processed as
        follows. The sequence number is checked and MUST be strictly greater
        than the sequence number in the neighbor structure. The cryptographic
        authentication is verified. If this router is listed in the set of
        neighbors in the hello packet, the nonce and session ID MUST match
        this router's current nonce and session ID. If any of these checks
        fail, the packet is discarded. Otherwise the packet is accepted past
        cryptographic processing.
</p>
<p>By this point, the router has received a hello packet. Either no
        neighbor structure exists or the session ID has changed. Before
        permitting communication with this router, its liveness needs to be
        challenged. If a new neighbor has been added since the last nonce
        trigger, then a nonce trigger (see <a class='info' href='#NONCE_TRIGGER'>Section&nbsp;2.2<span> (</span><span class='info'>Nonce Triggers</span><span>)</span></a>is
        performed and the packet is discarded. If this router is listed in the
        list of neighbors, it MUST be listed with its current session ID and
        nonce otherwise the packet is discarded. If verification of the
        cryptographic checksum fails, the packet is discarded. Otherwise, the
        session ID, nonce and sequence number associated with the neighbor are
        updated from the packet and the packet is accepted by cryptographic
        authentication processing. If a neighbor structure is added, then
        nonce trigger state is updated to indicate that a neighbor has been
        added.
</p>
<a name="NONCE_TRIGGER"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2.2"></a><h3>2.2.&nbsp;
Nonce Triggers</h3>

<p>The router keeps track of whether a nonce trigger has happened
        since the last time a neighbor is added.
</p>
<p>In order to test liveness, a router updates its current nonce to a
        new value. As a side effect, all routers on the link will update the
        nonce of the router associated with this router. More importantly,
        though, the router we are testing liveness with will update the nonce
        in its hello entry for this router. That will allow this router to
        confirm that the session ID is correct and corresponds to current
        replay state.
</p>
<p>As part of a nonce trigger, the router updates its current nonce.
        If a hello has not been sent too recently, then a hello is sent with
        the new nonce. The nonce trigger state is updated to indicate that no
        new neighbors have been added since the last nonce trigger.
</p>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Packet Format</h3>

<p>In the challenge/ response solution, each OSPFv2 packet MUST consist of
      the current Session ID and the associated Nonce value. This section
      describes how this information is carried in the OSPFv2 packets.
</p>
<p>This document defines a new Auth Type 3 that will be used to indicate 
     that the new authentication mechanism is being used. Each
      router MUST indicate its current
      Session ID and Nonce values in all OSPFv2 packets This information can
      be carried as part of the Authentication fields in the OSPFv2 packet
      header (described in A.3.1 in RFC 2328) The first 32 bits would indicate
      the Session ID and the next 32, the current Nonce value The
      Authentication data remains unchanged and is carried as part of the IP
      payload. 
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.1"></a><h3>3.1.&nbsp;
Extensions to the Protocol Header</h3>

<p>As illustrated in Figure 4, two 32-bit fields, Session ID and
        Nonce, are appended directly after the AuthType field. Additionally,
        because this solution specifies a new authentication procedure, the
        AuthType field in each packet should be set as 3.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Version #   |       1       |         Packet length         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Router ID                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Area ID                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Checksum            |             AuthType          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Session ID                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Nonce                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Authentication                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Authentication                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+

Figure 4.Extensions to the Protocol Header</pre></div>
<p>
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3.2"></a><h3>3.2.&nbsp;
Extension of Hello Packet</h3>

<p>As with the illustration of Figure 5, in a hello packet, the
        information about a neighbor consists not only the ID of the neighbor
        but also its current session ID and nonce value. 
</p>
<p>
          </p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>        0                   1                   2                   3
        0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |   Version #   |       1       |         Packet length         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Router ID                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Area ID                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |           Checksum            |             AuType            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                        Session ID                             |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                            Nonce                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Authentication                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                       Authentication                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                              ...                              |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Neighbor 1                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                         Session ID  1                         |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Nonce  1                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                          Neighbor 2                           |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                         Session ID 2                          |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                           Nonce  2                            |
       +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
       |                              ...                              |

Figure 5.Extension of Protocol Packet</pre></div><p>


          
        
</p>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Key Selection in Processing OSPF Packets</h3>

<p>This section introduces how the proposed security solution looks up
      long lived keys from key tables <a class='info' href='#I-D.ietf-karp-crypto-key-table'>[I&#8209;D.ietf&#8209;karp&#8209;crypto&#8209;key&#8209;table]<span> (</span><span class='info'>Housley, R. and T. Polk, &ldquo;Database of Long-Lived Symmetric Cryptographic Keys,&rdquo; November&nbsp;2010.</span><span>)</span></a>. Generally, a proper key
      selected to process an OSPFv2 packet should satisfy the requirements
      listed as follows: </p>
<blockquote class="text">
<p>the key is in its valid period; and
</p>
<p>the key can be used for the desired security algorithm.
</p>
</blockquote><p>In the remainder of this section, other requirements that a
      selected key should particularly satisfy are depicted in different
      scenarios.
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
Key Selection in Sending Unicast OSPF Packets</h3>

<p>Assume that a router R1 tries to send a unicast OSPF packet from
        its interface I1 to the interface R2 of a remote router R2 using
        security protocol P via interface I at time T. Firstly consider the
        circumstances where R1 and R2 are not connected with a virtual link.
        R1 then needs to select a long long-lived symmetric key from its key
        table. Because the key should be shared by the by both R1 and R2 to
        protect the communication between I1 and I2, the key should satisfy
        the following requirements:</p>
<blockquote class="text">
<p>the Peer field includes the router ID of R2;
</p>
<p>the PeerKeyID field is not "unknown";
</p>
<p>the Interfaces field includes I1; and
</p>
<p>the Direction field is either "out" or "both".
</p>
</blockquote><p>When R1 and R2 are at the ends of a virtual link, the
        condition is a little more complex. Because the virtual link can be
        regarded as an unnumbered point-to-point network, the IP address of
        the interface actually used to send the packet (i.e., I1) is
        discovered during the routing table build process. Therefore, when the
        system operator deploys the keys to protect the virtual link, I1 has
        not been specified yet. Therefore, the key should be identified by the
        router IDs rather than by the interface originating the packet, and
        the third requirement introduced above should be changed to &ldquo;the
        Interface field includes the router ID&rdquo;.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
Key Selection in Sending Multicast OSPF Packets</h3>

<p>If a router R1 sends an OSPF packet from its interface I1 to a
        multicast address (e.g., AllSPFRouters, AllDRouters), it needs to
        select a key according to the following requirements:</p>
<blockquote class="text">
<p>the Peer field includes the multicast address;
</p>
<p>the PeerKeyID field is "group";
</p>
<p>the Interfaces field includes I1; and
</p>
<p>the Direction field is either "out" or "both".
</p>
</blockquote>

<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.3"></a><h3>4.3.&nbsp;
Key Selection on Receiving OSPF Packets </h3>

<p>When Cryptographic Authentication is employed, the ID of the
        adopted key is encapsulated within the authentication field of an OSPF
        packet header. Using this ID, it is relatively easy for a receiver to
        locate the key. The requirement is relatively simple:</p>
<blockquote class="text">
<p>the Peer field includes the router ID of the sender; and
</p>
<p>the PeerKeyID field includes the key ID obtained from the
            authentication field
</p>
</blockquote>

<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
Existing Cryptographic Authentication Mechanism</h3>

<p>
	The overall cryptographic authentication process defined in 
 <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a> remains unchanged.
To reduce the potential for confusion, this section
   minimises the repetition of text from RFC 5709 and is
   incorporated here by reference  <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>. 
</p>
<p>RFC 5709, Section 3.3, describes how the cryptographic authentication
   must be computed. It requires OSPFv2 packet's Authentication Trailer 
	 (which is the appendage described in RFC 2328, Section D.4.3, Page 233, items
       (6)(a) and (6)(d)) to be filled with the value Apad where Apad is a 
	hexadecimal constant value 0x878FE1F3 repeated (L/4) times, where L is the length
	of the hash being used and is measured in octets rather than bits.
   
</p>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
Mechanism to secure the IP header</h3>

<p>
	
	This document updates the definition of  Apad which is currently a constant defined in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>  to
    the source address thats carried in the IP header of the OSPFv2 protocol packet. Routers at the sending side 
    must initialize Apad to a value of the source address that would be used when sending out the OSPFv2 packet, repeated 
   L/4 times, where L is the length of the hash, measured in octets.

The basic idea is to incorporate the source address
   from the IP header in the cryptographic authentication computation so that
  any change there can be detected.
</p>
<p>

   At the recieving end implementations MUST initialize Apad as the source
  address that exists in the IP Header of the incoming OSPFv2 protocol packet, repeated L/4 times, instead 
  of the constant that's currently defined in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>.

 Besides changing the value of Apad this document does not introduce any other
 changes to the authentication mechanism described in <a class='info' href='#RFC5709'>[RFC5709]<span> (</span><span class='info'>Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;OSPFv2 HMAC-SHA Cryptographic Authentication,&rdquo; October&nbsp;2009.</span><span>)</span></a>.



 
<p> This would prevent all attacks where a rogue OSPF router changes
 the source address of  the protocol packet  and reflects it on some other
 interface as the authentication check would fail and all such packets would get
rejected.

</p>


<a name="Security"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p> This document attempts to fix the manual key management 
           procedure that currently exists within OSPFv2, as part of the
           Phase 1 of the KARP Working Group. This therefore, only considers
          manual key management mechanism to be used for OSPFv2. Any solution
          that takes advantage of the automatic key management mechanism is beyond
         the scope of this document.
       
</p>
<p>This document also provides a solution
           to prevent certain denial of service attacks that can be launched by changing
         the source address in the IP header of the OSPFv2 protocol packet. 
</p>
<a name="IANA"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
IANA Considerations</h3>

<p>This document requests a new Auth Type to be defined for OSPFv2. It 
          currently uses 3 to foster pre-standard deployments.
</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.9"></a><h3>9.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2328">[RFC2328]</a></td>
<td class="author-text"><a href="mailto:jmoy@casc.com">Moy, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2328">OSPF Version 2</a>,&rdquo; STD&nbsp;54, RFC&nbsp;2328, April&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2328.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2328.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2328.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5709">[RFC5709]</a></td>
<td class="author-text">Bhatia, M., Manral, V., Fanto, M., White, R., Barnes, M., Li, T., and R. Atkinson, &ldquo;<a href="http://tools.ietf.org/html/rfc5709">OSPFv2 HMAC-SHA Cryptographic Authentication</a>,&rdquo; RFC&nbsp;5709, October&nbsp;2009 (<a href="http://www.rfc-editor.org/rfc/rfc5709.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>9.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.hartman-ospf-analysis">[I-D.hartman-ospf-analysis]</a></td>
<td class="author-text">Hartman, S. and D. Zhang, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-hartman-ospf-analysis-02.txt">Analysis of OSPF Security According to KARP Design Guide</a>,&rdquo; draft-hartman-ospf-analysis-02 (work in progress), December&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-hartman-ospf-analysis-02.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-karp-crypto-key-table">[I-D.ietf-karp-crypto-key-table]</a></td>
<td class="author-text">Housley, R. and T. Polk, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-karp-crypto-key-table-00.txt">Database of Long-Lived Symmetric Cryptographic Keys</a>,&rdquo; draft-ietf-karp-crypto-key-table-00 (work in progress), November&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-karp-crypto-key-table-00.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-karp-threats-reqs">[I-D.ietf-karp-threats-reqs]</a></td>
<td class="author-text">Lebovitz, G., Bhatia, M., and R. White, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-karp-threats-reqs-01.txt">The Threat Analysis and Requirements for Cryptographic Authentication of Routing Protocols' Transports</a>,&rdquo; draft-ietf-karp-threats-reqs-01 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-karp-threats-reqs-01.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-opsec-igp-crypto-requirements">[I-D.ietf-opsec-igp-crypto-requirements]</a></td>
<td class="author-text">Bhatia, M. and V. Manral, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-opsec-igp-crypto-requirements-04.txt">Summary of Cryptographic Authentication Algorithm Implementation Requirements for Routing Protocols</a>,&rdquo; draft-ietf-opsec-igp-crypto-requirements-04 (work in progress), October&nbsp;2010 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-opsec-igp-crypto-requirements-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC6039">[RFC6039]</a></td>
<td class="author-text">Manral, V., Bhatia, M., Jaeggli, J., and R. White, &ldquo;<a href="http://tools.ietf.org/html/rfc6039">Issues with Existing Cryptographic Protection Methods for Routing Protocols</a>,&rdquo; RFC&nbsp;6039, October&nbsp;2010 (<a href="http://www.rfc-editor.org/rfc/rfc6039.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Manav Bhatia</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Alcatel-Lucent</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Bangalore,   </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">India</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:manav.bhatia@alcatel-lucent.com">manav.bhatia@alcatel-lucent.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sam Hartman</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Painless Security</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:hartmans@painless-security.com">hartmans@painless-security.com</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Dacheng Zhang</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Huawei Technologies co., LTD.</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Beijing,   </td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">China</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Fax:&nbsp;</td>
<td class="author-text"></td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:zhangdacheng@huawei.com">zhangdacheng@huawei.com</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href=""></a></td></tr>
</table>
</body></html>
