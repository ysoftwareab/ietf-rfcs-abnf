




Network Working Group                                         Enke Chen
Internet Draft                                         Redback Networks
Expiration Date: December 2002


           BGP Route Oscillation Reduction with Confederation

              draft-chen-confed-oscillation-reduce-00.txt


1. Status of this Memo

   This document is an Internet-Draft and is in full conformance with
   all provisions of Section 10 of RFC2026.

   Internet-Drafts are working documents of the Internet Engineering
   Task Force (IETF), its areas, and its working groups.  Note that
   other groups may also distribute working documents as Internet-
   Drafts.

   Internet-Drafts are draft documents valid for a maximum of six months
   and may be updated, replaced, or obsoleted by other documents at any
   time.  It is inappropriate to use Internet-Drafts as reference
   material or to cite them other than as ``work in progress.''

   The list of current Internet-Drafts can be accessed at
   http://www.ietf.org/ietf/1id-abstracts.txt

   The list of Internet-Draft Shadow Directories can be accessed at
   http://www.ietf.org/shadow.html.


2. Abstract

   This document proposes a simple revision to Confederation that allows
   a BGP speaker in a Confederation to send a route advertisement
   (instead of a route withdraw) in certain cases.  The availability of
   the routing information helps achieve stable route selection, and
   moves Confederation closer to IBGP full-mesh equivalence in terms of
   routing information. It has been shown that the proposed mechanism
   eliminates a number of persistent route oscillation cases involving
   Confederation.









Chen                                                            [Page 1]





Internet Draft draft-chen-confed-oscillation-reduce-00.txt     June 2002


3. Introduction

   As documented in [1], the routing information reduction by BGP
   Confederation [2] can result in persistent route oscillations with
   certain routing setup and network topologies.

   This document proposes a simple revision to Confederation that allows
   a BGP speaker in a Confederation to send a route advertisement
   (instead of a route withdraw) in certain cases.  The availability of
   the routing information helps achieve stable route selection, and
   moves Confederation closer to IBGP full-mesh equivalence in terms of
   routing information. It has been shown that the proposed mechanism
   eliminates a number of persistent route oscillation cases involving
   Confederation.

   The proposed mechanisms work within the current BGP protocol [4] that
   limits route advertisement to only one path per prefix. In addition,
   only the Confederation Sub-AS Border Routers need to be upgraded. One
   can upgrade one router at a time when required, and then immediately
   benefit from the route oscillation reduction or elimination.


4. Modification to Confederation

   Currently a BGP speaker in a Confederation [3] follows the basic BGP
   principle that only the best path is advertised to a BGP peer.
   Therefore when the overall best path for a speaker is from a peer in
   a neighboring AS of the same Confederation, none of the paths from
   peers in the same AS would be advertised by the speaker to a peer in
   a neighboring AS of the same Confederation, and be considered in
   route selection. Similarly when the overall best path for a speaker
   is from a peer in the same AS, none of paths from peers in a
   neighboring AS of the same Confederation would be advertised by the
   speaker to a peer in the same AS, and be considered in route
   selection.

   The following modification is proposed for Confederation:

      In addition to calculating the overall best path among all the
      received paths, a BGP speaker in a Confederation may also
      calculate a best path ("I-BEST") among all the paths received
      from peers within the same AS. It may also calculate a best
      path ("E-BEST") among all the paths received from peers in
      neighboring ASs of the same Confederation.

      When the I-BEST for a speaker exists, and the E-BEST is the
      overall best path for the speaker, the speaker may advertise
      the I-BEST to a peer in a neighboring AS of the Confederation.



Chen                                                            [Page 2]





Internet Draft draft-chen-confed-oscillation-reduce-00.txt     June 2002


      When the I-BEST becomes non-existence, or when it should no
      longer be advertised, a replacement path or route withdraw
      must be sent to a peer in a neighboring AS of the Confederation
      if an I-BEST was advertised to the peer previously.

      When the E-BEST for a speaker exists, and the I-BEST is the
      overall best path for the speaker, the speaker may advertise the
      E-BEST to a peer in the same AS of the Confederation. When the
      E-BEST becomes non-existence, or when it should no longer be
      advertised, a replacement path or route withdraw must be sent to
      a peer in the same AS if an E-BEST was advertised to the peer
      previously.

      It is noted that the advertisement of I-BEST (or E-BEST) is not
      useful and should not be sent when the overall best path wins
      over the I-BEST (or E-BEST) prior to (and including) the step
      of MED comparison in the route selection procedure [3, Sect. 9.1].

   This modification allows additional routing information to be
   advertised, and be available in route selection.


5. Remarks

   Depending on the routing setup and network topology, the resolution
   of a route oscillation case may require the advertisement of either
   I-BEST on a router (e.g., on Rd for the case of [1, Sect 4.2]), or E-
   BEST on a router (e.g., on Rc and Rd for the case of [1, Sect. 5.1]),
   or both I-BEST and E-BEST on different routers in a network. This
   should be controlled via configuration.

   The proposed mechanism alleviates to some degree, but does not
   resolve the concern of routing information reduction with
   Confederation.  Therefore the proposed mechanism may still not be
   adequate for certain persistent route oscillation cases in which the
   advertisement of multiple paths for a prefix (as proposed in [4]) may
   be required for their resolution.

   It should be noted that compared to the existing mechanism of
   Confederation, the proposed revision may cause memory usage in a
   network to increase due to the advertisement of additional routing
   information.









Chen                                                            [Page 3]





Internet Draft draft-chen-confed-oscillation-reduce-00.txt     June 2002


6. Intellectual Property Considerations

   Redback Networks, Inc. may seek patent protection on some of the
   technology described in this Internet Draft. If technology in this
   document is adopted as a standard, Redback Networks agrees to
   license, on reasonable and non-discriminatory terms, any patent
   rights it obtains covering such technology to the extent necessary to
   comply with the standard.


7. Security Considerations

   This document introduces no new security concerns to BGP or other
   specifications referenced in this document.


8. Acknowledgments

   The author would like to thank Naiming Shen and Jenny Yuan for their
   review and comments.


9. References

   [1]  McPherson, D., Gill, V., Walton, D., Retana, A., "BGP Persistent
        Route Oscillation Condition", Work in Progress (draft-ietf-idr-
        route-oscillation-01), February 2002.

   [2]  Traina, P., McPherson, D., Scudder, J.. "Autonomous System Con-
        federations for BGP", RFC 3065, February 2001.

   [3]  Rekhter, Y., and T. Li, "A Border Gateway Protocol 4 (BGP-4)",
        Work in Progress (draft-ietf-idr-bgp4-17), January 2002

   [4]  Walton, D., Cook, D., Retana, A., Scudder, J., "Advertisement of
        Multiple Paths in BGP", Work in Progress (draft-walton-bgp-add-
        paths-00), May 2002.














Chen                                                            [Page 4]





Internet Draft draft-chen-confed-oscillation-reduce-00.txt     June 2002


10. Author Information


   Enke Chen
   Redback Networks, Inc.
   350 Holger Way
   San Jose, CA 95134
   Email: enke@redback.com











































Chen                                                            [Page 5]


