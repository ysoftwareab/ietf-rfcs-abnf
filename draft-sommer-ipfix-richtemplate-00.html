<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>Rich Template Set Extension to the IPFIX Protocol</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="Rich Template Set Extension to the IPFIX Protocol">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">C. Sommer</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">F. Dressler</td></tr>
<tr><td class="header">Intended status: Informational</td><td class="header">Univ. Erlangen</td></tr>
<tr><td class="header">Expires: January 8, 2009</td><td class="header">G. Muenz</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Univ. Tuebingen</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">July 07, 2008</td></tr>
</table></td></tr></table>
<h1><br />Rich Template Set Extension to the IPFIX Protocol<br />&lt;draft-sommer-ipfix-richtemplate-00.txt&gt;</h1>

<h3>Status of this Memo</h3>
<p>
By submitting this Internet-Draft,
each author represents that any applicable patent or other IPR claims of which
he or she is aware have been or will be disclosed,
and any of which he or she becomes aware will be disclosed,
in accordance with Section&nbsp;6 of BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on January 8, 2009.</p>

<h3>Abstract</h3>

<p>
				This draft describes the Rich Template Set, a Template Set for the IPFIX Protocol, as well as its respective Template Records. One possible application domain for this new Set is the transport of IPFIX Flow Mediation selection criteria. In comparison to the use of Common Properties, the use of Rich Template Sets reduces the overhead of repeated transmissions and makes data transmissions more robust against failures.
			
</p><a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Introduction<br />
<a href="#ipfix-extension-dt">2.</a>&nbsp;
Rich Template<br />
<a href="#ipfix-extension-dt-examples">3.</a>&nbsp;
Use of the Rich Template in Flow Aggregation<br />
<a href="#anchor2">4.</a>&nbsp;
Security considerations<br />
<a href="#anchor3">5.</a>&nbsp;
IANA Considerations<br />
<a href="#rfc.references1">6.</a>&nbsp;
Normative References<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
<a href="#rfc.copyright">&#167;</a>&nbsp;
Intellectual Property and Copyright Statements<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Introduction</h3>

<p>
				IPFIX supports the concept of a Mediator, a device that receives, transforms, and exports data streams using IPFIX. A major requirement of flow mediation is the reduction of the volume of IPFIX traffic by discarding and aggregating received information.
				<a class='info' href='#I-D.dressler-ipfix-aggregation'>[I&#8209;D.dressler&#8209;ipfix&#8209;aggregation]<span> (</span><span class='info'>Dressler, F., Sommer, C., Muenz, G., and A. Kobayashi, &ldquo;IPFIX Flow Aggregation,&rdquo; July&nbsp;2008.</span><span>)</span></a> describes how pattern matching is used for flow aggregation. The draft also outlines how to select flows and subsequently communicate the selection criteria to an IPFIX Collector, using Common Properties of the resulting Compound Flows to describe these attributes.
				In order to avoid the overhead of the repeated transmissions of all Common Properties (or their identifiers) in all Flow Records, a new Template Set, the Rich Template Set, is introduced.
				This Template Set allows an Exporting Process to simultaneously declare and transmit Common Properties to a receiver.
			
</p>
<p>
				The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this document are to be interpreted as described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
				
			
</p>
<a name="ipfix-extension-dt"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Rich Template</h3>

<p>
				<br /><hr class="insert" />
<a name="RichTemplateSet"></a>
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Set ID = 4           |          Length               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                     Rich Template Record 1                    |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                              ...                              |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                     Rich Template Record N                    |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Padding (opt)                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;1: Rich Template Set Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				The basic format of a Rich Template Set is shown in <a class='info' href='#RichTemplateSet'>Figure&nbsp;1<span> (</span><span class='info'>Rich Template Set Format</span><span>)</span></a>. 
				It is the same as that of a Template Set defined in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>, except for a different Set ID.
			
</p>
<p>
				The format of individual Rich Template Records, however, differs from that of Template Records and is shown in <a class='info' href='#RichTemplate'>Figure&nbsp;2<span> (</span><span class='info'>Rich Template Record Format</span><span>)</span></a>.
				
			
</p>
<p>
				<br /><hr class="insert" />
<a name="RichTemplate"></a>
</p>
<div style='display: table; width: 0; margin-left: auto; margin-right: auto'><pre>
0                   1                   2                   3
0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Template ID (&gt; 255)          |  Field Count                  |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|  Data Count                   |  Common Properties ID         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                       Field 1 Specifier                       |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                              ...                              |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                       Field N Specifier                       |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                        Data 1 Specifier                       |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                              ...                              |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                        Data M Specifier                       |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                          Data 1 Value                         |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                              ...                              |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                                                               |
|                          Data M Value                         |
|                                                               |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Figure&nbsp;2: Rich Template Record Format&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

				
				The Rich Template Set field definitions are as follows:
				</p>
<blockquote class="text"><dl>
<dt>Set ID</dt>
<dd>
						
						Type of this Template Set. A Set ID value of 4 is proposed for the Rich Template Set.
					
</dd>
<dt>Length</dt>
<dd>
						
						Total length of this set in bytes, as defined in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
					
</dd>
<dt>Padding</dt>
<dd>
						
						OPTIONAL padding, as defined in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
					
</dd>
</dl></blockquote><p>
			
</p>
<p>
				The Rich Template Record field definitions are as follows:
				</p>
<blockquote class="text"><dl>
<dt>Template ID</dt>
<dd>
						
						Template ID of this Rich Template Record. As defined in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>, this value MUST be greater than 255. 
					
</dd>
<dt>Field Count</dt>
<dd>
						
						Number of regular fields that will be sent in subsequent Data Records using this Template, as defined in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a>.
					
</dd>
<dt>Data Count</dt>
<dd>
						
						Number of fixed-value fields that will be sent in this Template.
					
</dd>
<dt>Common Properties ID</dt>
<dd>
						
						Contains an identifier that can be referred to by commonPropertiesId Information Elements, as introduced in <a class='info' href='#I-D.ietf-ipfix-reducing-redundancy'>[I&#8209;D.ietf&#8209;ipfix&#8209;reducing&#8209;redundancy]<span> (</span><span class='info'>Boschi, E., &ldquo;Reducing Redundancy in IP Flow Information Export (IPFIX) and Packet  Sampling (PSAMP) Reports,&rdquo; May&nbsp;2007.</span><span>)</span></a>.
					
</dd>
<dt>Field N Specifier</dt>
<dd>
						
						Information Element identifier, Field length and an Enterprise Number (if applicable) of field N. Refer to <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> for more information on Field Specifiers.
					
</dd>
<dt>Data M Specifier</dt>
<dd>
						
						Same as "Field N Specifier", but used for Common Properties of all Data Records of this Template. Together with Data M Value, a similar encoding like TLV (type-length-value) is achieved.
					
</dd>
<dt>Data M Value</dt>
<dd>
						
						Bit representation of a Common Property as would be transmitted in a Data Record.
						
					
</dd>
</dl></blockquote><p>
			
</p>
<a name="ipfix-extension-dt-examples"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Use of the Rich Template in Flow Aggregation</h3>

<p>
				The Rich Template is well-suited for use in flow aggregation, as introduced in <a class='info' href='#I-D.dressler-ipfix-aggregation'>[I&#8209;D.dressler&#8209;ipfix&#8209;aggregation]<span> (</span><span class='info'>Dressler, F., Sommer, C., Muenz, G., and A. Kobayashi, &ldquo;IPFIX Flow Aggregation,&rdquo; July&nbsp;2008.</span><span>)</span></a>.
				<a class='info' href='#field-modifier-export'>Table&nbsp;1<span> (</span><span class='info'>Relation between field modifiers, Flow Records, and Rich Templates</span><span>)</span></a> illustrates the relationship between a flow aggregator's field modifiers and patterns on the one hand, and the resulting regular and fixed-value fields in the Rich Template on the other hand.
				It can be seen that the analyzer is able to deduce all instructions of the Aggregation Rule considering the structure of the Rich Template, except the combination "discard without pattern" that does not result in any field.
			
</p><br /><hr class="insert" />
<a name="field-modifier-export"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">field modifier</th><th align="left">pattern</th><th align="left">field in Flow Record</th><th align="left">fixed-value field in Rich Template</th></tr>
<tr>
<td align="left">discard</td>
<td align="left">no</td>
<td align="left">N/A</td>
<td align="left">N/A</td>
</tr>
<tr>
<td align="left">discard</td>
<td align="left">yes</td>
<td align="left">N/A</td>
<td align="left">yes, contains pattern</td>
</tr>
<tr>
<td align="left">keep</td>
<td align="left">no</td>
<td align="left">yes</td>
<td align="left">N/A</td>
</tr>
<tr>
<td align="left">keep</td>
<td align="left">yes</td>
<td align="left">yes, if pattern specifies a range of values</td>
<td align="left">yes, contains pattern</td>
</tr>
<tr>
<td align="left">mask</td>
<td align="left">no</td>
<td align="left">yes, IP network address</td>
<td align="left">N/A</td>
</tr>
<tr>
<td align="left">mask</td>
<td align="left">yes</td>
<td align="left">yes, IP network address</td>
<td align="left">yes, contains pattern</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 1: Relation between field modifiers, Flow Records, and Rich Templates&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
				Assume, for example, the concentrator was given the Aggregation Rule shown in <a class='info' href='#example-rule-1'>Table&nbsp;2<span> (</span><span class='info'>Example Rule</span><span>)</span></a>.
			
</p><br /><hr class="insert" />
<a name="example-rule-1"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left">
<tr><th align="left">IPFIX&nbsp;Field</th><th align="left">Filtering</th><th align="left">Aggregation</th></tr>
<tr>
<td align="left">sourceIPv4Address</td>
<td align="left">192.0.2.0/28</td>
<td align="left">discard</td>
</tr>
<tr>
<td align="left">destinatonTransportPort</td>
<td align="left">&nbsp;</td>
<td align="left">keep</td>
</tr>
<tr>
<td align="left">packetDeltaCount</td>
<td align="left">&nbsp;</td>
<td align="left">aggregate</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 2: Example Rule&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
				
				Based on the Aggregation Rule, the concentrator would now first send a corresponding Rich Template Record as shown in <a class='info' href='#RichTemplate.ex.dt'>Table&nbsp;3<span> (</span><span class='info'>Rich Template used</span><span>)</span></a>.
			
</p><br /><hr class="insert" />
<a name="RichTemplate.ex.dt"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Field</th><th align="left">Value</th></tr>
<tr>
<td align="left">Template ID</td>
<td align="left">10001</td>
</tr>
<tr>
<td align="left">Field Count</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">Data Count</td>
<td align="left">2</td>
</tr>
<tr>
<td align="left">Common Properties ID</td>
<td align="left">0</td>
</tr>
<tr>
<td align="left">Field 1 Type</td>
<td align="left">Destination Port</td>
</tr>
<tr>
<td align="left">Field 2 Type</td>
<td align="left">Packets</td>
</tr>
<tr>
<td align="left">Data 1 Type</td>
<td align="left">Source IP Prefix</td>
</tr>
<tr>
<td align="left">Data 2 Type</td>
<td align="left">Source IP Mask</td>
</tr>
<tr>
<td align="left">Data 1 Value</td>
<td align="left">192.0.2.0</td>
</tr>
<tr>
<td align="left">Data 2 Value</td>
<td align="left">28</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 3: Rich Template used&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
				Assume further that the concentrator receives the Flow Records shown in <a class='info' href='#RichTemplate.ex.in'>Table&nbsp;4<span> (</span><span class='info'>Incoming Flows</span><span>)</span></a>.
			
</p><br /><hr class="insert" />
<a name="RichTemplate.ex.in"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left"><col align="left"><col align="left"><col align="left">
<tr><th align="left">Source IP</th><th align="left">Source Port</th><th align="left">Destination IP</th><th align="left">Destination Port</th><th align="left">Packets</th></tr>
<tr>
<td align="left">192.0.2.1</td>
<td align="left">64235</td>
<td align="left">192.0.2.101</td>
<td align="left">80</td>
<td align="left">10</td>
</tr>
<tr>
<td align="left">192.0.2.2</td>
<td align="left">64236</td>
<td align="left">192.0.2.102</td>
<td align="left">110</td>
<td align="left">10</td>
</tr>
<tr>
<td align="left">192.0.2.3</td>
<td align="left">64237</td>
<td align="left">192.0.2.103</td>
<td align="left">80</td>
<td align="left">10</td>
</tr>
<tr>
<td align="left">192.0.2.101</td>
<td align="left">64238</td>
<td align="left">192.0.2.1</td>
<td align="left">80</td>
<td align="left">10</td>
</tr>
<tr>
<td align="left">192.0.2.102</td>
<td align="left">64239</td>
<td align="left">192.0.2.2</td>
<td align="left">80</td>
<td align="left">10</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 4: Incoming Flows&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<p>
				The concentrator would then export Data Records of this type, which contain the Compound Flows resulting from aggregation.
				Note that the Flows' Common Property, having a source IP address in 192.0.2.0/28, was already transmitted in the Rich Template Record and is thus not included in Data Records.
				
				The exported Data Records, shown in <a class='info' href='#RichTemplate.ex.agg'>Table&nbsp;5<span> (</span><span class='info'>Aggregated Flows</span><span>)</span></a>, only contain the aggregated packet counts and the destination port, the latter being the only discriminating Flow Key property.
			
</p><br /><hr class="insert" />
<a name="RichTemplate.ex.agg"></a>
<table class="full" align="center" border="0" cellpadding="2" cellspacing="2">
<col align="left"><col align="left">
<tr><th align="left">Destination Port</th><th align="left">Packets</th></tr>
<tr>
<td align="left">80</td>
<td align="left">20</td>
</tr>
<tr>
<td align="left">110</td>
<td align="left">10</td>
</tr>
</table>
<br clear="all" />
<table border="0" cellpadding="0" cellspacing="2" align="center"><tr><td align="center"><font face="monaco, MS Sans Serif" size="1"><b>&nbsp;Table 5: Aggregated Flows&nbsp;</b></font><br /></td></tr></table><hr class="insert" />

<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
Security considerations</h3>

<p>
				This document introduces a new IPFIX Template Set, a variation on the Template Set and data types introduced in <a class='info' href='#RFC5101'>[RFC5101]<span> (</span><span class='info'>Claise, B., &ldquo;Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information,&rdquo; January&nbsp;2008.</span><span>)</span></a> and <a class='info' href='#I-D.ietf-ipfix-reducing-redundancy'>[I&#8209;D.ietf&#8209;ipfix&#8209;reducing&#8209;redundancy]<span> (</span><span class='info'>Boschi, E., &ldquo;Reducing Redundancy in IP Flow Information Export (IPFIX) and Packet  Sampling (PSAMP) Reports,&rdquo; May&nbsp;2007.</span><span>)</span></a>. No additional security considerations apply.
			
</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
IANA Considerations</h3>

<p>
				Use of the Rich Template Set requires one new IPFIX Set ID to be assigned. 
			
</p>
<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>6.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="I-D.dressler-ipfix-aggregation">[I-D.dressler-ipfix-aggregation]</a></td>
<td class="author-text">Dressler, F., Sommer, C., Muenz, G., and A. Kobayashi, &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-dressler-ipfix-aggregation-05.txt">IPFIX Flow Aggregation</a>,&rdquo; draft-dressler-ipfix-aggregation-05 (work in progress), July&nbsp;2008 (<a href="http://www.ietf.org/internet-drafts/draft-dressler-ipfix-aggregation-05.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="I-D.ietf-ipfix-reducing-redundancy">[I-D.ietf-ipfix-reducing-redundancy]</a></td>
<td class="author-text">Boschi, E., &ldquo;<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-reducing-redundancy-04.txt">Reducing Redundancy in IP Flow Information Export (IPFIX) and Packet  Sampling (PSAMP) Reports</a>,&rdquo; draft-ietf-ipfix-reducing-redundancy-04 (work in progress), May&nbsp;2007 (<a href="http://www.ietf.org/internet-drafts/draft-ietf-ipfix-reducing-redundancy-04.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5101">[RFC5101]</a></td>
<td class="author-text">Claise, B., &ldquo;<a href="http://tools.ietf.org/html/rfc5101">Specification of the IP Flow Information Export (IPFIX) Protocol for the Exchange of IP Traffic Flow Information</a>,&rdquo; RFC&nbsp;5101, January&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5101.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Christoph Sommer</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Erlangen-Nuremberg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Martensstr. 3</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Erlangen  91058</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 9131 85-27993</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:christoph.sommer@informatik.uni-erlangen.de">christoph.sommer@informatik.uni-erlangen.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www7.informatik.uni-erlangen.de/~sommer/">http://www7.informatik.uni-erlangen.de/~sommer/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Falko Dressler</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Erlangen-Nuremberg</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Department of Computer Science 7</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Martensstr. 3</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Erlangen  91058</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 9131 85-27914</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:dressler@informatik.uni-erlangen.de">dressler@informatik.uni-erlangen.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://www7.informatik.uni-erlangen.de/">http://www7.informatik.uni-erlangen.de/</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Gerhard Muenz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">University of Tuebingen</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Computer Networks and Internet</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Sand 13</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Tuebingen  72076</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Germany</td></tr>
<tr><td class="author" align="right">Phone:&nbsp;</td>
<td class="author-text">+49 7071 29-70534</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:muenz@informatik.uni-tuebingen.de">muenz@informatik.uni-tuebingen.de</a></td></tr>
<tr><td class="author" align="right">URI:&nbsp;</td>
<td class="author-text"><a href="http://net.informatik.uni-tuebingen.de/">http://net.informatik.uni-tuebingen.de/</a></td></tr>
</table>
<a name="rfc.copyright"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Full Copyright Statement</h3>
<p class='copyright'>
Copyright &copy; The IETF Trust (2008).</p>
<p class='copyright'>
This document is subject to the rights,
licenses and restrictions contained in BCP&nbsp;78,
and except as set forth therein,
the authors retain all their rights.</p>
<p class='copyright'>
This document and the information contained herein are provided
on an &ldquo;AS IS&rdquo; basis and THE CONTRIBUTOR,
THE ORGANIZATION HE/SHE REPRESENTS
OR IS SPONSORED BY (IF ANY), THE INTERNET SOCIETY, THE IETF TRUST
AND THE INTERNET ENGINEERING TASK FORCE DISCLAIM ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT
THE USE OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY
IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
PURPOSE.</p>
<h3>Intellectual Property</h3>
<p class='copyright'>
The IETF takes no position regarding the validity or scope of any
Intellectual Property Rights or other rights that might be claimed
to pertain to the implementation or use of the technology
described in this document or the extent to which any license
under such rights might or might not be available; nor does it
represent that it has made any independent effort to identify any
such rights.
Information on the procedures with respect to
rights in RFC documents can be found in BCP&nbsp;78 and BCP&nbsp;79.</p>
<p class='copyright'>
Copies of IPR disclosures made to the IETF Secretariat and any
assurances of licenses to be made available,
or the result of an attempt made to obtain a general license or
permission for the use of such proprietary rights by implementers or
users of this specification can be obtained from the IETF on-line IPR
repository at <a href='http://www.ietf.org/ipr'>http://www.ietf.org/ipr</a>.</p>
<p class='copyright'>
The IETF invites any interested party to bring to its attention
any copyrights,
patents or patent applications,
or other
proprietary rights that may cover technology that may be required
to implement this standard.
Please address the information to the IETF at <a href='mailto:ietf-ipr@ietf.org'>ietf-ipr@ietf.org</a>.</p>
</body></html>
