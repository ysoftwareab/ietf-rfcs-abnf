<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Delegation Revalidation by DNS Resolvers</title>
<meta content="Shumon Huque" name="author">
<meta content="Paul Vixie" name="author">
<meta content="Ralph Dolmans" name="author">
<meta content="
       
 This document recommends improved DNS  
          resolver behavior with
 respect to the processing of Name Server (NS) resource record
 sets (RRset) during iterative resolution. When following a referral
 response from an authoritative server to a child zone, DNS resolvers
 should explicitly query the authoritative NS RRset at the apex of
 the child zone and cache this in preference to the NS RRset on the
 parent side of the zone cut. Resolvers should also periodically
 revalidate the child delegation by re-quering the parent zone at the
 expiration of the TTL of the parent side NS RRset.
       
    " name="description">
<meta content="xml2rfc 3.0.0" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="DNS" name="keyword">
<meta content="Resolver" name="keyword">
<meta content="Delegation" name="keyword">
<meta content="Revalidation" name="keyword">
<meta content="Authoritative" name="keyword">
<meta content="Name Server Record" name="keyword">
<meta content="NS" name="keyword">
<meta content="Parent" name="keyword">
<meta content="Child" name="keyword">
<meta content="Resource Record Set" name="keyword">
<meta content="draft-ietf-dnsop-ns-revalidation-00" name="ietf.draft">
<link href="/tmp/draft-ietf-dnsop-ns-revalidation-7apa1gc7.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: avoid-page;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">DNS Delegation Revalidation</td>
<td class="right">September 2020</td>
</tr></thead>
<tfoot><tr>
<td class="left">Huque, et al.</td>
<td class="center">Expires March 11, 2021</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Internet Engineering Task Force</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-dnsop-ns-revalidation-00</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2020-09-07" class="published">September 7, 2020</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2021-03-11">March 11, 2021</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">S. Huque</div>
<div class="org">Salesforce</div>
</div>
<div class="author">
      <div class="author-name">P. Vixie</div>
<div class="org">Farsight Security</div>
</div>
<div class="author">
      <div class="author-name">R. Dolmans</div>
<div class="org">NLnet Labs</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Delegation Revalidation by DNS Resolvers</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">
 This document recommends improved DNS <span>[<a href="#RFC1034" class="xref">RFC1034</a>]</span>
        <span>[<a href="#RFC1035" class="xref">RFC1035</a>]</span> resolver behavior with
 respect to the processing of Name Server (NS) resource record
 sets (RRset) during iterative resolution. When following a referral
 response from an authoritative server to a child zone, DNS resolvers
 should explicitly query the authoritative NS RRset at the apex of
 the child zone and cache this in preference to the NS RRset on the
 parent side of the zone cut. Resolvers should also periodically
 revalidate the child delegation by re-quering the parent zone at the
 expiration of the TTL of the parent side NS RRset.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on March 11, 2021.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2020 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Simplified BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Simplified BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a><a href="#section-toc.1-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-motivation" class="xref">Motivation</a><a href="#section-toc.1-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1" class="keepWithNext"><a href="#section-3" class="xref">3</a>.  <a href="#name-upgrading-ns-rrset-credibil" class="xref">Upgrading NS RRset Credibility</a><a href="#section-toc.1-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-delegation-revalidation" class="xref">Delegation Revalidation</a><a href="#section-toc.1-1.4.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="xref">4.1</a>.  <a href="#name-using-the-ds-record-ttl" class="xref">Using the DS Record TTL</a><a href="#section-toc.1-1.4.2.1.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-optimizations" class="xref">Optimizations</a><a href="#section-toc.1-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-re-delegations-and-delegati" class="xref">Re-delegations and Delegation Removals</a><a href="#section-toc.1-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a><a href="#section-toc.1-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a><a href="#section-toc.1-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="xref">9</a>.  <a href="#name-references" class="xref">References</a><a href="#section-toc.1-1.9.1" class="pilcrow">¶</a></p>
<ul class="ulEmpty compact toc">
<li class="ulEmpty compact toc" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="xref">9.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a><a href="#section-toc.1-1.9.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="ulEmpty compact toc" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="xref">9.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a><a href="#section-toc.1-1.9.2.2.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#section-appendix.a" class="xref"></a><a href="#name-acknowledgements" class="xref">Acknowledgements</a><a href="#section-toc.1-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="ulEmpty compact toc" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#section-appendix.b" class="xref"></a><a href="#name-authors-addresses" class="xref">Authors' Addresses</a><a href="#section-toc.1-1.11.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="intro">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">
        RFC EDITOR: PLEASE REMOVE THIS PARAGRAPH BEFORE PUBLISHING: The
        source for this draft is maintained in GitHub at:
        https://github.com/shuque/ns-revalidation<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">
 This document recommends improved DNS resolver behavior with
 respect to the processing of NS record sets during iterative
 resolution. The first recommendation is that resolvers, when
 following a referral response from an authoritative server to
 a child zone, should explicitly query the authoritative NS RRset
 at the apex of the child zone and cache this in preference to
 the NS RRset on the parent side of the zone cut. The second
 recommendation is to revalidate the delegation by re-quering
 the parent zone at the expiration of the TTL of the parent side
 NS RRset.<a href="#section-1-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="motivation">
<section id="section-2">
      <h2 id="name-motivation">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-motivation" class="section-name selfRef">Motivation</a>
      </h2>
<p id="section-2-1">
        There is wide variability in the behavior of deployed DNS resolvers
        today with respect to how they process delegation records. Some of
        them prefer the parent NS set, some prefer the child, and for others,
        what they preferentially cache depends on the dynamic state of
        queries and responses they have processed. This document aims to
        bring more commonality and predictability by standardizing the
        behavior in a way that comports with the DNS protocol.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">
 The delegation NS RRset at the bottom of the parent zone and the
 apex NS RRset in the child zone are unsynchronized in the DNS
 protocol. <span>[<a href="#RFC1034" class="xref">RFC1034</a>]</span> Section 4.2.2 says
 "The administrators of both zones should insure that the NS and
 glue RRs which mark both sides of the cut are consistent and remain
 so.". But for a variety of
 reasons they could not be. Officially, a child zone's apex NS RRset
 is authoritative and thus has a higher cache credibility than the
 parent's delegation NS RRset, which is non-authoritative glue
 (<span>[<a href="#RFC2181" class="xref">RFC2181</a>]</span>, Section 5.4.1. "Ranking
        data", and Section 6.1. "Zone authority"). Hence the
 NS RRset "below the zone cut" should immediately replace the parent's
 delegating NS RRset in cache when an iterative caching DNS resolver
 crosses a zone boundary. However, this can only happen if (1) the
 resolver receives the authoritative NS RRset in the Authority section
 of a response from the child zone, which is not mandatory, or (2) if
 the resolver explicitly issues an NS RRset query to the child zone as
 part of its iterative resolution algorithm. In the absence of this,
 it is possible for an iterative caching resolver to never learn the
 authoritative NS RRset for a zone, unless a downstream client of the
 resolver explicitly issues such an NS query, which is not something
 that normal enduser applications do, and thus cannot be relied upon
        to occur with any regularity.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">
 Increasingly, there is a trend towards minimizing unnecessary data
 in DNS responses. Several popular DNS implementations default to such
 a configuration (see "minimal-responses" in BIND and Unbound). So,
        they may never include the authoritative NS RRset in the Authority
        section of their responses.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4">
 A common reason that zone owners want to ensure that resolvers
 place the authoritative NS RRset preferentially in their cache is
 that the TTLs may differ between the parent and child side of the
 zone cut. Some DNS Top Level Domains (TLDs) only support long fixed
 TTLs in their delegation NS sets. In fact, the
        <span><a href="#RFC5731" class="xref">Extensible Provisioning
        Protocol (EPP)</a> [<a href="#RFC5731" class="xref">RFC5731</a>]</span>, that is often used by TLDs to configure
        delegation parameters has no provision to set the TTL. This inhibits
        a child zone owner's ability to make more rapid changes to their
        nameserver configuration using a shorter TTL, if resolvers have no
        systematic mechanism to observe and cache the child NS RRset.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5">
 A child zone's delegation still needs to be periodically
 revalidated at the parent to make sure that the parent zone
 has not legitimately re-delegated the zone to a different set
 of nameservers, or even removed the delegation. Otherwise, resolvers
        that refresh the TTL of a child NS RRset on subsequent queries or
        due to pre-fetching, may cling to those nameservers long after they
        have been re-delegated elsewhere. This leads to the second
        recommendation in this document, "Delegation Revalidation" - Resolvers
        should record the TTL of the parent's delegating NS RRset, and use it
        to trigger a revalidation action.<a href="#section-2-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="upgrade-ns">
<section id="section-3">
      <h2 id="name-upgrading-ns-rrset-credibil">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-upgrading-ns-rrset-credibil" class="section-name selfRef">Upgrading NS RRset Credibility</a>
      </h2>
<ul class="normal">
<li class="normal" id="section-3-1.1">
    When a delegation response is received during iteration, a
    validation query should be sent in parallel with the resolution of
    the triggering query, to the delegated nameservers for the newly
    discovered zone cut. Note that validating resolvers today,
    when following a secure referral, already need to dispatch a query
           to the delegated nameservers for the DNSKEY RRset, so this validation
           query could be sent in parallel with that DNSKEY query.<a href="#section-3-1.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-1.2">
    A validation query consists of a query for the child's apex NS
    RRset, sent to the newly discovered delegation's nameservers. Normal
    iterative logic applies to the processing of responses to validation
    queries, including storing the results in cache, trying the next
    server on SERVFAIL or timeout, and so on. Positive answers to this
    validation query will be cached with an authoritative data ranking.
    Successive queries directed to the same zone will be directed to the
    nameservers listed in the child's apex, due to the ranking of this
    answer. If the validation query fails, the parent NS RRset will remain
    the one with the highest ranking and will be used for successive
    queries.<a href="#section-3-1.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-1.3">
    Some resolvers may choose to delay the response to the triggering
           query until both the triggering query and the validation query have
           been answered. In practice, we expect many implementations may
           answer the triggering query in advance of the validation query for
           performance reasons. An additional reason is that there are number
           of nameservers in the field that (incorrectly) fail to answer explicit
           queries for NS records, and thus the revalidation logic may need to
           be applied lazily and opportunistically to deal with them.<a href="#section-3-1.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-3-1.4">
    If the resolver chooses to delay the response, and there are no
    nameserver names in common between the child's apex NS RRset and the
    parent's delegation NS RRset, then the responses received from
    forwarding the triggering query to the parent's delegated nameservers
    should be discarded after validation, and this query should be
    forwarded again to the child's apex nameservers.<a href="#section-3-1.4" class="pilcrow">¶</a>
</li>
      </ul>
</section>
</div>
<div id="revalidation">
<section id="section-4">
      <h2 id="name-delegation-revalidation">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-delegation-revalidation" class="section-name selfRef">Delegation Revalidation</a>
      </h2>
<p id="section-4-1">
        This documents proposes two mechanisms to perform delegation
 revalidation: an extensive and a simple mechanism. [TODO: should
        we keep just the simple mechanism?]<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">The extensive mechanism:<a href="#section-4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-3.1">
    The lowest TTL found in a parent zone's delegating NS RRset
    should be stored in the cache and used to trigger delegation
    revalidation as follows: Whenever a cached RRset is being considered
    for use in a response, the cache should be walked upward toward the
    root, looking for expired delegations. At the first expired
    delegation encountered while walking upward toward the root,
    revalidation should be triggered, putting the processing of dependent
    queries on hold until validation is complete.<a href="#section-4-3.1" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.2">
    To revalidate a delegation, the iterative caching DNS resolver
    will redo resolution of the triggering query at the closest
           enclosing zone cut above the revalidation point. If
           <span><a href="#RFC7816" class="xref">Query-name Minimization</a> [<a href="#RFC7816" class="xref">RFC7816</a>]</span> is being employed, this may not be the full name of the
           triggering query, but the query name with some number of left
           most labels excised as dictated by the qname minimization
           algorithm.  While
    searching for these nameservers, additional revalidations may occur,
    perhaps placing a chain of dependent queries on hold, unwinding in
    downward order as revalidations closer to the root must be complete
    before revalidations further from the root can begin.<a href="#section-4-3.2" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.3">
    If a delegation can be revalidated at the same node, then the
    old apex NS RRset should be deleted from cache and then the new
    delegating NS RRset should be stored in cache. The minimum TTL from
    the new delegating NS RRset should also be stored in cache to
    facilitate future revalidations. This order of operations ensures
    that the RRset credibility rules do not prevent the new delegating NS
    RRset from entering the cache. It is expected that the child's apex
    NS RRset will rapidly replace the parent's delegating NS RRset as
    soon as iteration restarts after the revalidation event.<a href="#section-4-3.3" class="pilcrow">¶</a>
</li>
        <li class="normal" id="section-4-3.4">
    If the new delegating NS RRset cannot be found (RCODE=NXDOMAIN)
    or if there is a new zone cut at some different level of the
    hierarchy (insertion or deletion of a delegation point above the
    revalidation point) or if the new RRset shares no nameserver names in
    common with the old one (indicating some kind of redelegation, which
    is rare) then the cache should be purged of all names and RRsets at
    or below the revalidation point. This facilitates redelegation or
    revocation of a zone by a parent zone administrator, and also
    conserves cache storage by deleting unreachable data.<a href="#section-4-3.4" class="pilcrow">¶</a>
</li>
      </ul>
<p id="section-4-4">

      The simple mechanism:<a href="#section-4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-4-5.1">
    Cap the time to cache the child NS RRset to the lower of child
           and parent NS RRset TTL. The normal iterative resolution algorithm
           will then cause delegation revalidation to naturally occur at the
           expiration of the capped child NS TTL, along with dispatching of
           the validation query to upgrade NS RRset credibility.<a href="#section-4-5.1" class="pilcrow">¶</a>
</li>
      </ul>
<div id="UsingDS">
<section id="section-4.1">
        <h3 id="name-using-the-ds-record-ttl">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-using-the-ds-record-ttl" class="section-name selfRef">Using the DS Record TTL</a>
        </h3>
<p id="section-4.1-1">
   If both parent and child zone are DNSSEC
          <span>[<a href="#RFC4033" class="xref">RFC4033</a>]</span>
          <span>[<a href="#RFC4034" class="xref">RFC4034</a>]</span>
          <span>[<a href="#RFC4035" class="xref">RFC4035</a>]</span> signed with a
   corresponding secure delegation between them, then expiration
   of the Delegation Signer (DS) record set will cause revalidation of
   the current child zone's DNSKEY set. According to RFC 4035, Section
   2.4, "The TTL of a DS RRSet SHOULD match the TTL of the delegating
   NS RRset", so this revalidation should be triggered on the same
   time scale, and thus responses from the stale child nameservers
   would no longer be trusted. However, delegation revalidation is
   still necessary to locate the current nameserver addresses to which
   subsequent DNS queries should be directed.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1-2">
          In practice, the DS
          TTL often differs from the delegating NS TTL. For example,
          currently the root zone and the COM and NET TLDs all set an
          NS RRset TTL of 2 days, while the DS RRset TTL is just 1 day.
          <span><a href="#rssac-003" class="xref">RSSAC-003</a> [<a href="#rssac-003" class="xref">rssac-003</a>]</span>
          makes the following observation:
          "In the root zone, delegating NS records have a 2 day TTL. However,
          the DS records have a 1 day TTL, against the advice of RFC 4035.
          This is not particularly surprising since a mistake with a DS record
          can deny resolution for all names under a TLD. Given the way that DS
          records are currently used in the root zone (e.g., usually matching
          just one TLD KSK) it is better for them to have a lower TTL in the
          event of an emergency change."<a href="#section-4.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1-3">
          If a secure delegation is present, resolvers may use the
          DS RRset's TTL as the revalidation interval in preference to
          to the delegating NS RRSet TTL. (Question: should this be the
          recommendation instead?; after all the DS is signed so its TTL cannot
          be spoofed.?)<a href="#section-4.1-3" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="optimize">
<section id="section-5">
      <h2 id="name-optimizations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-optimizations" class="section-name selfRef">Optimizations</a>
      </h2>
<p id="section-5-1">
        TODO: mention possible optimizations: record whether certain
        nameservers return the child NS set in their authoritative section
        responses and subsequently forego the extra child NS query for a
        period of time. Suggest that authoritative servers that do
        minimal responses return their NS sets in response to DNSKEY
        queries, and resolvers that see such behavior may also subsequently
        forego the extra child NS query (from Olafur G.).<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="redelegations">
<section id="section-6">
      <h2 id="name-re-delegations-and-delegati">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-re-delegations-and-delegati" class="section-name selfRef">Re-delegations and Delegation Removals</a>
      </h2>
<p id="section-6-1">
        TODO: mention in more detail what to do when resolvers observe
        redelegations or removal of delegations at the parent. A quick
        initial summary follows.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">
        If a delegation is removed (i.e. the parent returns NXDOMAIN),
        then cache contents should be treated as described in
        <span>[<a href="#RFC8020" class="xref">RFC8020</a>]</span> -- ideally the resolver's
        cache should be entirely pruned at the delegation point, or the
        cached contents below the delegation may be allowed to be used until
        they expire. Similar treatment of the cache should be followed if
        the child zone has been entirely re-delegated to a new set of
        nameservers. If only a subset of nameservers have been re-delegated,
        then no new cache cleanup action is needed.<a href="#section-6-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-7">
      <h2 id="name-iana-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-7-1">This document includes no request to IANA.<a href="#section-7-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Security">
<section id="section-8">
      <h2 id="name-security-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-8-1">
 <span><a href="#upgrade-ns" class="xref">Upgrading NS RRset Credibility</a> (<a href="#upgrade-ns" class="xref">Section 3</a>)</span>
 allows resolvers to cache and utilize the authoritative child
 apex NS RRset in preference to the non-authoriative parent NS
 RRset. However, it is important to implement the steps described in
        <span><a href="#revalidation" class="xref">Delegation Revalidation</a> (<a href="#revalidation" class="xref">Section 4</a>)</span> at
 the expiration of the parent's delegating TTL. Otherwise, the
 operator of a malicious child zone, originally delegated to, but
 subsequently delegated away from, can cause resolvers that refresh
 TTLs on subsequent NS set queries, or that pre-fetch NS queries, to
 never learn of the redelegated zone. This problem has been
 seen in the wild [include reference to Ghost Domains paper here].<a href="#section-8-1" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="RFC1034">[RFC1034]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - concepts and facilities"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1034</span>, <span class="seriesInfo">DOI 10.17487/RFC1034</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1034">https://www.rfc-editor.org/info/rfc1034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1035">[RFC1035]</dt>
        <dd>
<span class="refAuthor">Mockapetris, P.</span>, <span class="refTitle">"Domain names - implementation and specification"</span>, <span class="seriesInfo">STD 13</span>, <span class="seriesInfo">RFC 1035</span>, <span class="seriesInfo">DOI 10.17487/RFC1035</span>, <time datetime="1987-11" class="refDate">November 1987</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1035">https://www.rfc-editor.org/info/rfc1035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2181">[RFC2181]</dt>
        <dd>
<span class="refAuthor">Elz, R.</span><span class="refAuthor"> and R. Bush</span>, <span class="refTitle">"Clarifications to the DNS Specification"</span>, <span class="seriesInfo">RFC 2181</span>, <span class="seriesInfo">DOI 10.17487/RFC2181</span>, <time datetime="1997-07" class="refDate">July 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2181">https://www.rfc-editor.org/info/rfc2181</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7816">[RFC7816]</dt>
        <dd>
<span class="refAuthor">Bortzmeyer, S.</span>, <span class="refTitle">"DNS Query Name Minimisation to Improve Privacy"</span>, <span class="seriesInfo">RFC 7816</span>, <span class="seriesInfo">DOI 10.17487/RFC7816</span>, <time datetime="2016-03" class="refDate">March 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc7816">https://www.rfc-editor.org/info/rfc7816</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8020">[RFC8020]</dt>
      <dd>
<span class="refAuthor">Bortzmeyer, S.</span><span class="refAuthor"> and S. Huque</span>, <span class="refTitle">"NXDOMAIN: There Really Is Nothing Underneath"</span>, <span class="seriesInfo">RFC 8020</span>, <span class="seriesInfo">DOI 10.17487/RFC8020</span>, <time datetime="2016-11" class="refDate">November 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc8020">https://www.rfc-editor.org/info/rfc8020</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.vixie-dnsext-resimprove">[I-D.vixie-dnsext-resimprove]</dt>
        <dd>
<span class="refAuthor">Vixie, P.</span><span class="refAuthor">, Joffe, R.</span><span class="refAuthor">, and F. Neves</span>, <span class="refTitle">"Improvements to DNS Resolvers for Resiliency, Robustness, and Responsiveness"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-vixie-dnsext-resimprove-00</span>, <time datetime="2010-06-23" class="refDate">June 23, 2010</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-vixie-dnsext-resimprove-00">https://tools.ietf.org/html/draft-vixie-dnsext-resimprove-00</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.wijngaards-dnsext-resolver-side-mitigation">[I-D.wijngaards-dnsext-resolver-side-mitigation]</dt>
        <dd>
<span class="refAuthor">Wijngaards, W.</span>, <span class="refTitle">"Resolver side mitigations"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-wijngaards-dnsext-resolver-side-mitigation-01</span>, <time datetime="2009-02-24" class="refDate">February 24, 2009</time>, <span>&lt;<a href="https://tools.ietf.org/html/draft-wijngaards-dnsext-resolver-side-mitigation-01">https://tools.ietf.org/html/draft-wijngaards-dnsext-resolver-side-mitigation-01</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4033">[RFC4033]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"DNS Security Introduction and Requirements"</span>, <span class="seriesInfo">RFC 4033</span>, <span class="seriesInfo">DOI 10.17487/RFC4033</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4033">https://www.rfc-editor.org/info/rfc4033</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4034">[RFC4034]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"Resource Records for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4034</span>, <span class="seriesInfo">DOI 10.17487/RFC4034</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4034">https://www.rfc-editor.org/info/rfc4034</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4035">[RFC4035]</dt>
        <dd>
<span class="refAuthor">Arends, R.</span><span class="refAuthor">, Austein, R.</span><span class="refAuthor">, Larson, M.</span><span class="refAuthor">, Massey, D.</span><span class="refAuthor">, and S. Rose</span>, <span class="refTitle">"Protocol Modifications for the DNS Security Extensions"</span>, <span class="seriesInfo">RFC 4035</span>, <span class="seriesInfo">DOI 10.17487/RFC4035</span>, <time datetime="2005-03" class="refDate">March 2005</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4035">https://www.rfc-editor.org/info/rfc4035</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5731">[RFC5731]</dt>
        <dd>
<span class="refAuthor">Hollenbeck, S.</span>, <span class="refTitle">"Extensible Provisioning Protocol (EPP) Domain Name Mapping"</span>, <span class="seriesInfo">STD 69</span>, <span class="seriesInfo">RFC 5731</span>, <span class="seriesInfo">DOI 10.17487/RFC5731</span>, <time datetime="2009-08" class="refDate">August 2009</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc5731">https://www.rfc-editor.org/info/rfc5731</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="rssac-003">[rssac-003]</dt>
      <dd>
<span class="refAuthor">RSSAC_Caucus</span>, <span class="refTitle">"RSSAC003 Report on Root Zone TTLs"</span>, <time datetime="2015-08" class="refDate">August 2015</time>, <span>&lt;<a href="https://www.icann.org/en/system/files/files/rssac-003-root-zone-ttls-21aug15-en.pdf">https://www.icann.org/en/system/files/files/rssac-003-root-zone-ttls-21aug15-en.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="Acknowledgements">
<section id="section-appendix.a">
      <h2 id="name-acknowledgements">
<a href="#name-acknowledgements" class="section-name selfRef">Acknowledgements</a>
      </h2>
<p id="section-appendix.a-1">
        Wouter Wijngaards proposed explicitly obtaining authoritative child
        NS data in <span>[<a href="#I-D.wijngaards-dnsext-resolver-side-mitigation" class="xref">I-D.wijngaards-dnsext-resolver-side-mitigation</a>]</span>. This behavior has been implemented in the Unbound DNS resolver via the
        "harden-referral-path" option. The combination of child NS fetch and
        revalidating the child delegation was originally proposed
 in <span>[<a href="#I-D.vixie-dnsext-resimprove" class="xref">I-D.vixie-dnsext-resimprove</a>]</span>, by Vixie, Joffe,
 and Neves.<a href="#section-appendix.a-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="section-appendix.b">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Shumon Huque</span></div>
<div dir="auto" class="left"><span class="org">Salesforce</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:shuque@gmail.com" class="email">shuque@gmail.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Paul Vixie</span></div>
<div dir="auto" class="left"><span class="org">Farsight Security</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:paul@redbarn.org" class="email">paul@redbarn.org</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Ralph Dolmans</span></div>
<div dir="auto" class="left"><span class="org">NLnet Labs</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:ralph@nlnetlabs.nl" class="email">ralph@nlnetlabs.nl</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
