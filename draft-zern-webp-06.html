<!DOCTYPE html>
<html lang="en" class=" Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>WebP Image Format Media Type Registration</title>
<meta content="James Zern" name="author">
<meta content="
       This document provides the Media Type Registration for the subtype
     image/webp. 
    " name="description">
<meta content="xml2rfc 3.12.0" name="generator">
<meta content="VP8" name="keyword">
<meta content="WebP" name="keyword">
<meta content="draft-zern-webp-06" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.12.0
    Python 3.6.12
    appdirs 1.4.4
    ConfigArgParse 1.5.3
    google-i18n-address 2.5.0
    html5lib 1.1
    intervaltree 3.1.0
    Jinja2 2.11.3
    kitchen 1.2.6
    lxml 4.7.1
    pycountry 20.7.3
    pyflakes 2.4.0
    PyYAML 6.0
    requests 2.27.1
    setuptools 59.6.0
    six 1.16.0
    WeasyPrint 52.5
-->
<link href="/tmp/draft-zern-webp-06-thk_dxbq.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">/*

  NOTE: Changes at the bottom of this file overrides some earlier settings.

  Once the style has stabilized and has been adopted as an official RFC style,
  this can be consolidated so that style settings occur only in one place, but
  for now the contents of this file consists first of the initial CSS work as
  provided to the RFC Formatter (xml2rfc) work, followed by itemized and
  commented changes found necssary during the development of the v3
  formatters.

*/

/* fonts */
@import url('https://fonts.googleapis.com/css?family=Noto+Sans'); /* Sans-serif */
@import url('https://fonts.googleapis.com/css?family=Noto+Serif'); /* Serif (print) */
@import url('https://fonts.googleapis.com/css?family=Roboto+Mono'); /* Monospace */

@viewport {
  zoom: 1.0;
  width: extend-to-zoom;
}
@-ms-viewport {
  width: extend-to-zoom;
  zoom: 1.0;
}
/* general and mobile first */
html {
}
body {
  max-width: 90%;
  margin: 1.5em auto;
  color: #222;
  background-color: #fff;
  font-size: 14px;
  font-family: 'Noto Sans', Arial, Helvetica, sans-serif;
  line-height: 1.6;
  scroll-behavior: smooth;
}
.ears {
  display: none;
}

/* headings */
#title, h1, h2, h3, h4, h5, h6 {
  margin: 1em 0 0.5em;
  font-weight: bold;
  line-height: 1.3;
}
#title {
  clear: both;
  border-bottom: 1px solid #ddd;
  margin: 0 0 0.5em 0;
  padding: 1em 0 0.5em;
}
.author {
  padding-bottom: 4px;
}
h1 {
  font-size: 26px;
  margin: 1em 0;
}
h2 {
  font-size: 22px;
  margin-top: -20px;  /* provide offset for in-page anchors */
  padding-top: 33px;
}
h3 {
  font-size: 18px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h4 {
  font-size: 16px;
  margin-top: -36px;  /* provide offset for in-page anchors */
  padding-top: 42px;
}
h5, h6 {
  font-size: 14px;
}
#n-copyright-notice {
  border-bottom: 1px solid #ddd;
  padding-bottom: 1em;
  margin-bottom: 1em;
}
/* general structure */
p {
  padding: 0;
  margin: 0 0 1em 0;
  text-align: left;
}
div, span {
  position: relative;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignRight.art-text pre {
  padding: 0;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
.alignCenter.art-text {
  background-color: #f9f9f9;
  border: 1px solid #eee;
  border-radius: 3px;
  padding: 1em 1em 0;
  margin-bottom: 1.5em;
}
.alignCenter.art-text pre {
  padding: 0;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 1em 2em;
}
ol ol, ul ul, ol ul, ul ol {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
ul.ulBare, li.ulBare {
  margin-left: 0em !important;
}
ul.compact, .ulCompact,
ol.compact, .olCompact {
  line-height: 100%;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
}
dl > dt {
  float: left;
  margin-right: 1em;
}
/* 
dl.nohang > dt {
  float: none;
}
*/
dl > dd {
  margin-bottom: .8em;
  min-height: 1.3em;
}
dl.compact > dd, .dlCompact > dd {
  margin-bottom: 0em;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0em;
}

/* links */
a {
  text-decoration: none;
}
a[href] {
  color: #22e; /* Arlen: WCAG 2019 */
}
a[href]:hover {
  background-color: #f2f2f2;
}
figcaption a[href],
a[href].selfRef {
  color: #222;
}
/* XXX probably not this:
a.selfRef:hover {
  background-color: transparent;
  cursor: default;
} */

/* Figures */
tt, code, pre, code {
  background-color: #f9f9f9;
  font-family: 'Roboto Mono', monospace;
}
pre {
  border: 1px solid #eee;
  margin: 0;
  padding: 1em;
}
img {
  max-width: 100%;
}
figure {
  margin: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption {
  font-style: italic;
  margin: 0 0 1em 0;
}
@media screen {
  pre {
    overflow-x: auto;
    max-width: 100%;
    max-width: calc(100% - 22px);
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 1.2em 2em;
}
blockquote {
  background-color: #f9f9f9;
  color: #111; /* Arlen: WCAG 2019 */
  border: 1px solid #ddd;
  border-radius: 3px;
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
  border: 1px solid #eee;
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 0.5em 0.75em;
}
th {
  text-align: left;
  background-color: #e9e9e9;
}
tr:nth-child(2n+1) > td {
  background-color: #f5f5f5;
}
table caption {
  font-style: italic;
  margin: 0;
  padding: 0;
  text-align: left;
}
table p {
  /* XXX to avoid bottom margin on table row signifiers. If paragraphs should
     be allowed within tables more generally, it would be far better to select on a class. */
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  color: #666; /* Arlen: AHDJ 2019 */
  text-decoration: none;
  visibility: hidden;
  user-select: none;
  -ms-user-select: none;
  -o-user-select:none;
  -moz-user-select: none;
  -khtml-user-select: none;
  -webkit-user-select: none;
  -webkit-touch-callout: none;
}
@media screen {
  aside:hover > a.pilcrow,
  p:hover > a.pilcrow,
  blockquote:hover > a.pilcrow,
  div:hover > a.pilcrow,
  li:hover > a.pilcrow,
  pre:hover > a.pilcrow {
    visibility: visible;
  }
  a.pilcrow:hover {
    background-color: transparent;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid #eee;
}
.bcp14 {
  font-variant: small-caps;
}

.role {
  font-variant: all-small-caps;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: 0.9em;
}
#identifiers dt {
  width: 3em;
  clear: left;
}
#identifiers dd {
  float: left;
  margin-bottom: 0;
}
/* Fix PDF info block run off issue */
@media print {
  #identifiers dd {
    float: none;
  }
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #666; /* Arlen: WCAG 2019 */
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc  {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
nav.toc ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
nav.toc li {
  line-height: 1.3em;
  margin: 0.75em 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 7em;
}
.references dd {
  margin-left: 8em;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
.index ul {
  margin: 0 0 0 1em;
  padding: 0;
  list-style: none;
}
.index ul ul {
  margin: 0;
}
.index li {
  margin: 0;
  text-indent: -2em;
  padding-left: 2em;
  padding-bottom: 5px;
}
.indexIndex {
  margin: 0.5em 0 1em;
}
.index a {
  font-weight: 700;
}
/* make the index two-column on all but the smallest screens */
@media (min-width: 600px) {
  .index ul {
    -moz-column-count: 2;
    -moz-column-gap: 20px;
  }
  .index ul ul {
    -moz-column-count: 1;
    -moz-column-gap: 0;
  }
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}

address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  font-family: "Noto Sans",Arial,Helvetica,sans-serif;
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}

/* temporary notes */
.rfcEditorRemove::before {
  position: absolute;
  top: 0.2em;
  right: 0.2em;
  padding: 0.2em;
  content: "The RFC Editor will remove this note";
  color: #9e2a00; /* Arlen: WCAG 2019 */
  background-color: #ffd; /* Arlen: WCAG 2019 */
}
.rfcEditorRemove {
  position: relative;
  padding-top: 1.8em;
  background-color: #ffd; /* Arlen: WCAG 2019 */
  border-radius: 3px;
}
.cref {
  background-color: #ffd; /* Arlen: WCAG 2019 */
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 1023px) {
  body {
    padding-top: 2em;
  }
  #title {
    padding: 1em 0;
  }
  h1 {
    font-size: 24px;
  }
  h2 {
    font-size: 20px;
    margin-top: -18px;  /* provide offset for in-page anchors */
    padding-top: 38px;
  }
  #identifiers dd {
    max-width: 60%;
  }
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 0;
    margin: 0;
    background-color: inherit;
    border-bottom: 1px solid #ccc;
  }
  #toc h2 {
    margin: -1px 0 0 0;
    padding: 4px 0 4px 6px;
    padding-right: 1em;
    min-width: 190px;
    font-size: 1.1em;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 6px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    padding: 0.5em 1em 1em;
    overflow: auto;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 1024px) {
  body {
    max-width: 724px;
    margin: 42px auto;
    padding-left: 1.5em;
    padding-right: 29em;
  }
  #toc {
    position: fixed;
    top: 42px;
    right: 42px;
    width: 25%;
    margin: 0;
    padding: 0 1em;
    z-index: 1;
  }
  #toc h2 {
    border-top: none;
    border-bottom: 1px solid #ddd;
    font-size: 1em;
    font-weight: normal;
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 0;
    overflow: auto;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {

    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre {
    page-break-inside: avoid;
  }
  figure {
    overflow: scroll;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  h2+*, h3+*, h4+*, h5+*, h6+* {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
}

/* This is commented out here, as the string-set: doesn't
   pass W3C validation currently */
/*
.ears thead .left {
  string-set: ears-top-left content();
}

.ears thead .center {
  string-set: ears-top-center content();
}

.ears thead .right {
  string-set: ears-top-right content();
}

.ears tfoot .left {
  string-set: ears-bottom-left content();
}

.ears tfoot .center {
  string-set: ears-bottom-center content();
}

.ears tfoot .right {
  string-set: ears-bottom-right content();
}
*/

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
  /* The follwing is commented out here, but set appropriately by in code, as
     the content depends on the document */
  /*
  @top-left {
    content: 'Internet-Draft';
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-left {
    content: string(ears-top-left);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-center {
    content: string(ears-top-center);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @top-right {
    content: string(ears-top-right);
    vertical-align: bottom;
    border-bottom: solid 1px #ccc;
  }
  @bottom-left {
    content: string(ears-bottom-left);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-center {
    content: string(ears-bottom-center);
    vertical-align: top;
    border-top: solid 1px #ccc;
  }
  @bottom-right {
      content: '[Page ' counter(page) ']';
      vertical-align: top;
      border-top: solid 1px #ccc;
  }
  */

}

/* Changes introduced to fix issues found during implementation */
/* Make sure links are clickable even if overlapped by following H* */
a {
  z-index: 2;
}
/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}


/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Leave room in document info to show Internet-Draft on one line */
#identifiers dt {
  width: 8em;
}

/* Don't waste quite as much whitespace between label and value in doc info */
#identifiers dd {
  margin-left: 1em;
}

/* Give floating toc a background color (needed when it's a div inside section */
#toc {
  background-color: white;
}

/* Make the collapsed ToC header render white on gray also when it's a link */
@media screen and (max-width: 1023px) {
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
}

/* Give the bottom of the ToC some whitespace */
@media screen and (min-width: 1024px) {
  #toc {
    padding: 0 0 1em 1em;
  }
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* prevent monospace from becoming overly large */
tt, code, pre, code {
  font-size: 95%;
}

/* Fix the height/width aspect for ascii art*/
pre.sourcecode,
.art-text pre {
  line-height: 1.12;
}


/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin-right: 0.5em;
}

/* Fix the dl styling to match the RFC 7992 attributes */
dl > dt,
dl.dlParallel > dt {
  float: left;
  margin-right: 1em;
}
dl.dlNewline > dt {
  float: none;
}

/* Provide styling for table cell text alignment */
table td.text-left,
table th.text-left {
  text-align: left;
}
table td.text-center,
table th.text-center {
  text-align: center;
}
table td.text-right,
table th.text-right {
  text-align: right;
}

/* Make the alternative author contact informatio look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 30em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Provide table alignment support.  We can't use the alignX classes above
   since they do unwanted things with caption and other styling. */
table.right {
 margin-left: auto;
 margin-right: 0;
}
table.center {
 margin-left: auto;
 margin-right: auto;
}
table.left {
 margin-left: 0;
 margin-right: auto;
}

/* Give the table caption label the same styling as the figcaption */
caption a[href] {
  color: #222;
}

@media print {
  .toplink {
    display: none;
  }

  /* avoid overwriting the top border line with the ToC header */
  #toc {
    padding-top: 1px;
  }

  /* Avoid page breaks inside dl and author address entries */
  .vcard {
    page-break-inside: avoid;
  }

}
/* Tweak the bcp14 keyword presentation */
.bcp14 {
  font-variant: small-caps;
  font-weight: bold;
  font-size: 0.9em;
}
/* Tweak the invisible space above H* in order not to overlay links in text above */
 h2 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 31px;
 }
 h3 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
 h4 {
  margin-top: -18px;  /* provide offset for in-page anchors */
  padding-top: 24px;
 }
/* Float artwork pilcrow to the right */
@media screen {
  .artwork a.pilcrow {
    display: block;
    line-height: 0.7;
    margin-top: 0.15em;
  }
}
/* Make pilcrows on dd visible */
@media screen {
  dd:hover > a.pilcrow {
    visibility: visible;
  }
}
/* Make the placement of figcaption match that of a table's caption
   by removing the figure's added bottom margin */
.alignLeft.art-text,
.alignCenter.art-text,
.alignRight.art-text {
   margin-bottom: 0;
}
.alignLeft,
.alignCenter,
.alignRight {
  margin: 1em 0 0 0;
}
/* In print, the pilcrow won't show on hover, so prevent it from taking up space,
   possibly even requiring a new line */
@media print {
  a.pilcrow {
    display: none;
  }
}
/* Styling for the external metadata */
div#external-metadata {
  background-color: #eee;
  padding: 0.5em;
  margin-bottom: 0.5em;
  display: none;
}
div#internal-metadata {
  padding: 0.5em;                       /* to match the external-metadata padding */
}
/* Styling for title RFC Number */
h1#rfcnum {
  clear: both;
  margin: 0 0 -1em;
  padding: 1em 0 0 0;
}
/* Make .olPercent look the same as <ol><li> */
dl.olPercent > dd {
  margin-bottom: 0.25em;
  min-height: initial;
}
/* Give aside some styling to set it apart */
aside {
  border-left: 1px solid #ddd;
  margin: 1em 0 1em 2em;
  padding: 0.2em 2em;
}
aside > dl,
aside > ol,
aside > ul,
aside > table,
aside > p {
  margin-bottom: 0.5em;
}
/* Additional page break settings */
@media print {
  figcaption, table caption {
    page-break-before: avoid;
  }
}
/* Font size adjustments for print */
@media print {
  body  { font-size: 10pt;      line-height: normal; max-width: 96%; }
  h1    { font-size: 1.72em;    padding-top: 1.5em; } /* 1*1.2*1.2*1.2 */
  h2    { font-size: 1.44em;    padding-top: 1.5em; } /* 1*1.2*1.2 */
  h3    { font-size: 1.2em;     padding-top: 1.5em; } /* 1*1.2 */
  h4    { font-size: 1em;       padding-top: 1.5em; }
  h5, h6 { font-size: 1em;      margin: initial; padding: 0.5em 0 0.3em; }
}
/* Sourcecode margin in print, when there's no pilcrow */
@media print {
  .artwork,
  .sourcecode {
    margin-bottom: 1em;
  }
}
/* Avoid narrow tables forcing too narrow table captions, which may render badly */
table {
  min-width: 20em;
}
/* ol type a */
ol.type-a { list-style-type: lower-alpha; }
ol.type-A { list-style-type: upper-alpha; }
ol.type-i { list-style-type: lower-roman; }
ol.type-I { list-style-type: lower-roman; }
/* Apply the print table and row borders in general, on request from the RPC,
and increase the contrast between border and odd row background sligthtly */
table {
  border: 1px solid #ddd;
}
td {
  border-top: 1px solid #ddd;
}
tr:nth-child(2n+1) > td {
  background-color: #f8f8f8;
}
/* Use style rules to govern display of the TOC. */
@media screen and (max-width: 1023px) {
  #toc nav { display: none; }
  #toc.active nav { display: block; }
}
/* Add support for keepWithNext */
.keepWithNext {
  break-after: avoid-page;
  break-after: avoid-page;
}
/* Add support for keepWithPrevious */
.keepWithPrevious {
  break-before: avoid-page;
}
/* Change the approach to avoiding breaks inside artwork etc. */
figure, pre, table, .artwork, .sourcecode  {
  break-before: auto;
  break-after: auto;
}
/* Avoid breaks between <dt> and <dd> */
dl {
  break-before: auto;
  break-inside: auto;
}
dt {
  break-before: auto;
  break-after: avoid-page;
}
dd {
  break-before: avoid-page;
  break-after: auto;
  orphans: 3;
  widows: 3
}
span.break, dd.break {
  margin-bottom: 0;
  min-height: 0;
  break-before: auto;
  break-inside: auto;
  break-after: auto;
}
/* Undo break-before ToC */
@media print {
  #toc {
    break-before: auto;
  }
}
/* Text in compact lists should not get extra bottim margin space,
   since that would makes the list not compact */
ul.compact p, .ulCompact p,
ol.compact p, .olCompact p {
 margin: 0;
}
/* But the list as a whole needs the extra space at the end */
section ul.compact,
section .ulCompact,
section ol.compact,
section .olCompact {
  margin-bottom: 1em;                    /* same as p not within ul.compact etc. */
}
/* The tt and code background above interferes with for instance table cell
   backgrounds.  Changed to something a bit more selective. */
tt, code {
  background-color: transparent;
}
p tt, p code, li tt, li code {
  background-color: #f8f8f8;
}
/* Tweak the pre margin -- 0px doesn't come out well */
pre {
   margin-top: 0.5px;
}
/* Tweak the comact list text */
ul.compact, .ulCompact,
ol.compact, .olCompact,
dl.compact, .dlCompact {
  line-height: normal;
}
/* Don't add top margin for nested lists */
li > ul, li > ol, li > dl,
dd > ul, dd > ol, dd > dl,
dl > dd > dl {
  margin-top: initial;
}
/* Elements that should not be rendered on the same line as a <dt> */
/* This should match the element list in writer.text.TextWriter.render_dl() */
dd > div.artwork:first-child,
dd > aside:first-child,
dd > figure:first-child,
dd > ol:first-child,
dd > div:first-child > pre.sourcecode,
dd > table:first-child,
dd > ul:first-child {
  clear: left;
}
/* fix for weird browser behaviour when <dd/> is empty */
dt+dd:empty::before{
  content: "\00a0";
}
/* Make paragraph spacing inside <li> smaller than in body text, to fit better within the list */
li > p {
  margin-bottom: 0.5em
}
/* Don't let p margin spill out from inside list items */
li > p:last-of-type {
  margin-bottom: 0;
}
</style>
<link href="rfc-local.css" rel="stylesheet" type="text/css">
<script type="application/javascript">async function addMetadata(){try{const e=document.styleSheets[0].cssRules;for(let t=0;t<e.length;t++)if(/#identifiers/.exec(e[t].selectorText)){const a=e[t].cssText.replace("#identifiers","#external-updates");document.styleSheets[0].insertRule(a,document.styleSheets[0].cssRules.length)}}catch(e){console.log(e)}const e=document.getElementById("external-metadata");if(e)try{var t,a="",o=function(e){const t=document.getElementsByTagName("meta");for(let a=0;a<t.length;a++)if(t[a].getAttribute("name")===e)return t[a].getAttribute("content");return""}("rfc.number");if(o){t="https://www.rfc-editor.org/rfc/rfc"+o+".json";try{const e=await fetch(t);a=await e.json()}catch(e){t=document.URL.indexOf("html")>=0?document.URL.replace(/html$/,"json"):document.URL+".json";const o=await fetch(t);a=await o.json()}}if(!a)return;e.style.display="block";const s="",d="https://datatracker.ietf.org/doc",n="https://datatracker.ietf.org/ipr/search",c="https://www.rfc-editor.org/info",l=a.doc_id.toLowerCase(),i=a.doc_id.slice(0,3).toLowerCase(),f=a.doc_id.slice(3).replace(/^0+/,""),u={status:"Status",obsoletes:"Obsoletes",obsoleted_by:"Obsoleted By",updates:"Updates",updated_by:"Updated By",see_also:"See Also",errata_url:"Errata"};let h="<dl style='overflow:hidden' id='external-updates'>";["status","obsoletes","obsoleted_by","updates","updated_by","see_also","errata_url"].forEach(e=>{if("status"==e){a[e]=a[e].toLowerCase();var t=a[e].split(" "),o=t.length,w="",p=1;for(let e=0;e<o;e++)p<o?w=w+r(t[e])+" ":w+=r(t[e]),p++;a[e]=w}else if("obsoletes"==e||"obsoleted_by"==e||"updates"==e||"updated_by"==e){var g,m="",b=1;g=a[e].length;for(let t=0;t<g;t++)a[e][t]&&(a[e][t]=String(a[e][t]).toLowerCase(),m=b<g?m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>, ":m+"<a href='"+s+"/rfc/".concat(a[e][t])+"'>"+a[e][t].slice(3)+"</a>",b++);a[e]=m}else if("see_also"==e){var y,L="",C=1;y=a[e].length;for(let t=0;t<y;t++)if(a[e][t]){a[e][t]=String(a[e][t]);var _=a[e][t].slice(0,3),v=a[e][t].slice(3).replace(/^0+/,"");L=C<y?"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>, ":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>, ":"RFC"!=_?L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+_+" "+v+"</a>":L+"<a href='"+s+"/info/"+_.toLowerCase().concat(v.toLowerCase())+"'>"+v+"</a>",C++}a[e]=L}else if("errata_url"==e){var R="";R=a[e]?R+"<a href='"+a[e]+"'>Errata exist</a> | <a href='"+d+"/"+l+"'>Datatracker</a>| <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>":"<a href='"+d+"/"+l+"'>Datatracker</a> | <a href='"+n+"/?"+i+"="+f+"&submit="+i+"'>IPR</a> | <a href='"+c+"/"+l+"'>Info page</a>",a[e]=R}""!=a[e]?"Errata"==u[e]?h+=`<dt>More info:</dt><dd>${a[e]}</dd>`:h+=`<dt>${u[e]}:</dt><dd>${a[e]}</dd>`:"Errata"==u[e]&&(h+=`<dt>More info:</dt><dd>${a[e]}</dd>`)}),h+="</dl>",e.innerHTML=h}catch(e){console.log(e)}else console.log("Could not locate metadata <div> element");function r(e){return e.charAt(0).toUpperCase()+e.slice(1)}}window.removeEventListener("load",addMetadata),window.addEventListener("load",addMetadata);</script>
</head>
<body>
<script src="metadata.min.js"></script>
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">WebP Image Format Media Type Registratio</td>
<td class="right">January 2022</td>
</tr></thead>
<tfoot><tr>
<td class="left">Zern</td>
<td class="center">Expires 16 July 2022</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">Internet Engineering Task Force</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-zern-webp-06</dd>
<dt class="label-">:</dt>
<dd>draft-zern-webp-06</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2022-01-12" class="published">12 January 2022</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Informational</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2022-07-16">16 July 2022</time></dd>
<dt class="label-authors">Author:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">J. Zern</div>
<div class="org">Google LLC</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">WebP Image Format Media Type Registration</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">This document provides the Media Type Registration for the subtype
     image/webp.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 16 July 2022.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2022 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="xref">1</a>.  <a href="#name-introduction" class="xref">Introduction</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="xref">2</a>.  <a href="#name-the-image-webp-media-type" class="xref">The 'image/webp' Media Type</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2.2.1">
                <p id="section-toc.1-1.2.2.1.1" class="keepWithNext"><a href="#section-2.1" class="xref">2.1</a>.  <a href="#name-registration-details" class="xref">Registration Details</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="xref">3</a>.  <a href="#name-security-considerations" class="xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="xref">4</a>.  <a href="#name-interoperability-considerat" class="xref">Interoperability Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="xref">5</a>.  <a href="#name-iana-considerations" class="xref">IANA Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="xref">6</a>.  <a href="#name-webp-container-specificatio" class="xref">WebP Container Specification</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.1">
                <p id="section-toc.1-1.6.2.1.1"><a href="#section-6.1" class="xref">6.1</a>.  <a href="#name-introduction-2" class="xref">Introduction</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.2">
                <p id="section-toc.1-1.6.2.2.1"><a href="#section-6.2" class="xref">6.2</a>.  <a href="#name-terminology-basics" class="xref">Terminology &amp; Basics</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.3">
                <p id="section-toc.1-1.6.2.3.1"><a href="#section-6.3" class="xref">6.3</a>.  <a href="#name-riff-file-format" class="xref">RIFF File Format</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.4">
                <p id="section-toc.1-1.6.2.4.1"><a href="#section-6.4" class="xref">6.4</a>.  <a href="#name-webp-file-header" class="xref">WebP File Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.5">
                <p id="section-toc.1-1.6.2.5.1"><a href="#section-6.5" class="xref">6.5</a>.  <a href="#name-simple-file-format-lossy" class="xref">Simple File Format (Lossy)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.6">
                <p id="section-toc.1-1.6.2.6.1"><a href="#section-6.6" class="xref">6.6</a>.  <a href="#name-simple-file-format-lossless" class="xref">Simple File Format (Lossless)</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7">
                <p id="section-toc.1-1.6.2.7.1"><a href="#section-6.7" class="xref">6.7</a>.  <a href="#name-extended-file-format" class="xref">Extended File Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.1">
                    <p id="section-toc.1-1.6.2.7.2.1.1"><a href="#section-6.7.1" class="xref">6.7.1</a>.  <a href="#name-chunks" class="xref">Chunks</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.1.2.1">
                        <p id="section-toc.1-1.6.2.7.2.1.2.1.1"><a href="#section-6.7.1.1" class="xref">6.7.1.1</a>.  <a href="#name-animation" class="xref">Animation</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.1.2.2">
                        <p id="section-toc.1-1.6.2.7.2.1.2.2.1"><a href="#section-6.7.1.2" class="xref">6.7.1.2</a>.  <a href="#name-alpha" class="xref">Alpha</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.1.2.3">
                        <p id="section-toc.1-1.6.2.7.2.1.2.3.1"><a href="#section-6.7.1.3" class="xref">6.7.1.3</a>.  <a href="#name-bitstream-vp8-vp8l" class="xref">Bitstream (VP8/VP8L)</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.1.2.4">
                        <p id="section-toc.1-1.6.2.7.2.1.2.4.1"><a href="#section-6.7.1.4" class="xref">6.7.1.4</a>.  <a href="#name-color-profile" class="xref">Color profile</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.1.2.5">
                        <p id="section-toc.1-1.6.2.7.2.1.2.5.1"><a href="#section-6.7.1.5" class="xref">6.7.1.5</a>.  <a href="#name-metadata" class="xref">Metadata</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.1.2.6">
                        <p id="section-toc.1-1.6.2.7.2.1.2.6.1"><a href="#section-6.7.1.6" class="xref">6.7.1.6</a>.  <a href="#name-unknown-chunks" class="xref">Unknown Chunks</a></p>
</li>
                    </ul>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.2">
                    <p id="section-toc.1-1.6.2.7.2.2.1"><a href="#section-6.7.2" class="xref">6.7.2</a>.  <a href="#name-assembling-the-canvas-from-" class="xref">Assembling the Canvas from frames</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6.2.7.2.3">
                    <p id="section-toc.1-1.6.2.7.2.3.1"><a href="#section-6.7.3" class="xref">6.7.3</a>.  <a href="#name-example-file-layouts" class="xref">Example File Layouts</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="xref">7</a>.  <a href="#name-specification-for-webp-loss" class="xref">Specification for WebP Lossless Bitstream</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.1">
                <p id="section-toc.1-1.7.2.1.1"><a href="#section-7.1" class="xref">7.1</a>.  <a href="#name-abstract" class="xref">Abstract</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.2">
                <p id="section-toc.1-1.7.2.2.1"><a href="#section-7.2" class="xref">7.2</a>.  <a href="#name-nomenclature" class="xref">Nomenclature</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.3">
                <p id="section-toc.1-1.7.2.3.1"><a href="#section-7.3" class="xref">7.3</a>.  <a href="#name-introduction-3" class="xref">Introduction</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.4">
                <p id="section-toc.1-1.7.2.4.1"><a href="#section-7.4" class="xref">7.4</a>.  <a href="#name-riff-header" class="xref">RIFF Header</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5">
                <p id="section-toc.1-1.7.2.5.1"><a href="#section-7.5" class="xref">7.5</a>.  <a href="#name-transformations" class="xref">Transformations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.1">
                    <p id="section-toc.1-1.7.2.5.2.1.1"><a href="#section-7.5.1" class="xref">7.5.1</a>.  <a href="#name-predictor-transform" class="xref">Predictor Transform</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.2">
                    <p id="section-toc.1-1.7.2.5.2.2.1"><a href="#section-7.5.2" class="xref">7.5.2</a>.  <a href="#name-color-transform" class="xref">Color Transform</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.3">
                    <p id="section-toc.1-1.7.2.5.2.3.1"><a href="#section-7.5.3" class="xref">7.5.3</a>.  <a href="#name-subtract-green-transform" class="xref">Subtract Green Transform</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.5.2.4">
                    <p id="section-toc.1-1.7.2.5.2.4.1"><a href="#section-7.5.4" class="xref">7.5.4</a>.  <a href="#name-color-indexing-transform" class="xref">Color Indexing Transform</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6">
                <p id="section-toc.1-1.7.2.6.1"><a href="#section-7.6" class="xref">7.6</a>.  <a href="#name-image-data" class="xref">Image Data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.1">
                    <p id="section-toc.1-1.7.2.6.2.1.1"><a href="#section-7.6.1" class="xref">7.6.1</a>.  <a href="#name-roles-of-image-data" class="xref">Roles of Image Data</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.2">
                    <p id="section-toc.1-1.7.2.6.2.2.1"><a href="#section-7.6.2" class="xref">7.6.2</a>.  <a href="#name-encoding-of-image-data" class="xref">Encoding of Image data</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.2.2.1">
                        <p id="section-toc.1-1.7.2.6.2.2.2.1.1"><a href="#section-7.6.2.1" class="xref">7.6.2.1</a>.  <a href="#name-huffman-coded-literals" class="xref">Huffman Coded Literals</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.2.2.2">
                        <p id="section-toc.1-1.7.2.6.2.2.2.2.1"><a href="#section-7.6.2.2" class="xref">7.6.2.2</a>.  <a href="#name-lz77-backward-reference" class="xref">LZ77 Backward Reference</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.6.2.2.2.3">
                        <p id="section-toc.1-1.7.2.6.2.2.2.3.1"><a href="#section-7.6.2.3" class="xref">7.6.2.3</a>.  <a href="#name-color-cache-coding" class="xref">Color Cache Coding</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7">
                <p id="section-toc.1-1.7.2.7.1"><a href="#section-7.7" class="xref">7.7</a>.  <a href="#name-entropy-code" class="xref">Entropy Code</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7.2.1">
                    <p id="section-toc.1-1.7.2.7.2.1.1"><a href="#section-7.7.1" class="xref">7.7.1</a>.  <a href="#name-overview" class="xref">Overview</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7.2.2">
                    <p id="section-toc.1-1.7.2.7.2.2.1"><a href="#section-7.7.2" class="xref">7.7.2</a>.  <a href="#name-details" class="xref">Details</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7.2.2.2.1">
                        <p id="section-toc.1-1.7.2.7.2.2.2.1.1"><a href="#section-7.7.2.1" class="xref">7.7.2.1</a>.  <a href="#name-decoding-of-meta-huffman-co" class="xref">Decoding of Meta Huffman Codes</a></p>
</li>
                      <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.7.2.2.2.2">
                        <p id="section-toc.1-1.7.2.7.2.2.2.2.1"><a href="#section-7.7.2.2" class="xref">7.7.2.2</a>.  <a href="#name-decoding-entropy-coded-imag" class="xref">Decoding Entropy-coded Image Data</a></p>
</li>
                    </ul>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8">
                <p id="section-toc.1-1.7.2.8.1"><a href="#section-7.8" class="xref">7.8</a>.  <a href="#name-overall-structure-of-the-fo" class="xref">Overall Structure of the Format</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8.2.1">
                    <p id="section-toc.1-1.7.2.8.2.1.1"><a href="#section-7.8.1" class="xref">7.8.1</a>.  <a href="#name-basic-structure" class="xref">Basic Structure</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8.2.2">
                    <p id="section-toc.1-1.7.2.8.2.2.1"><a href="#section-7.8.2" class="xref">7.8.2</a>.  <a href="#name-structure-of-transforms" class="xref">Structure of Transforms</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7.2.8.2.3">
                    <p id="section-toc.1-1.7.2.8.2.3.1"><a href="#section-7.8.3" class="xref">7.8.3</a>.  <a href="#name-structure-of-the-image-data" class="xref">Structure of the Image Data</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="xref">8</a>.  <a href="#name-references" class="xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="xref">8.1</a>.  <a href="#name-normative-references" class="xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="xref">8.2</a>.  <a href="#name-informative-references" class="xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#appendix-A" class="xref"></a><a href="#name-authors-address" class="xref">Author's Address</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">This document provides references for the WebP image format and
       considerations for its use across platforms.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">WebP is a <span><a href="#riff-spec" class="xref">Resource Interchange File Format
       (RIFF)</a> [<a href="#riff-spec" class="xref">riff-spec</a>]</span> based image file format
       (<a href="#webp-container" class="xref">Section 6</a>) which supports lossless and lossy
       compression as well as alpha (transparency) and animation. It covers use
       cases similar to <span><a href="#jpeg-spec" class="xref">JPEG</a> [<a href="#jpeg-spec" class="xref">jpeg-spec</a>]</span>,
       <span><a href="#RFC2083" class="xref">PNG</a> [<a href="#RFC2083" class="xref">RFC2083</a>]</span> and the
       <span><a href="#gif-spec" class="xref">Graphics Interchange Format (GIF)</a> [<a href="#gif-spec" class="xref">gif-spec</a>]</span>.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">WebP consists of two compression algorithms used to reduce the size of
       image pixel data, including alpha (transparency) information. Lossy
       compression is achieved using VP8 intra-frame encoding <span>[<a href="#RFC6386" class="xref">RFC6386</a>]</span>. The <span><a href="#webp-lossless" class="xref">lossless
           algorithm</a> (<a href="#webp-lossless" class="xref">Section 7</a>)</span> stores and restores the pixel values exactly,
             including the color values for zero alpha pixels. The format uses
             subresolution images, recursively embedded into the format itself,
             for storing statistical data about the images, such as the used
             entropy codes, spatial predictors, color space conversion, and
             color table. <span><a href="#lz77" class="xref">LZ77</a> [<a href="#lz77" class="xref">lz77</a>]</span>, <span><a href="#huffman" class="xref">Huffman coding</a> [<a href="#huffman" class="xref">huffman</a>]</span>, and a color cache are
                 used for compression of the bulk data.<a href="#section-1-3" class="pilcrow">¶</a></p>
</section>
<div id="webp-media-type">
<section id="section-2">
      <h2 id="name-the-image-webp-media-type">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-the-image-webp-media-type" class="section-name selfRef">The 'image/webp' Media Type</a>
      </h2>
<p id="section-2-1">This section contains the media type registration details as per <span>[<a href="#RFC6838" class="xref">RFC6838</a>]</span>.<a href="#section-2-1" class="pilcrow">¶</a></p>
<section id="section-2.1">
        <h3 id="name-registration-details">
<a href="#section-2.1" class="section-number selfRef">2.1. </a><a href="#name-registration-details" class="section-name selfRef">Registration Details</a>
        </h3>
<p id="section-2.1-1">Type name: image<a href="#section-2.1-1" class="pilcrow">¶</a></p>
<p id="section-2.1-2">Subtype name: webp<a href="#section-2.1-2" class="pilcrow">¶</a></p>
<p id="section-2.1-3">Required parameters: N/A<a href="#section-2.1-3" class="pilcrow">¶</a></p>
<p id="section-2.1-4">Optional parameters: N/A<a href="#section-2.1-4" class="pilcrow">¶</a></p>
<p id="section-2.1-5">Encoding considerations: Binary. The <span><a href="#RFC4648" class="xref">Base64
         encoding</a> [<a href="#RFC4648" class="xref">RFC4648</a>]</span> should be used on transports that cannot accommodate
         binary data directly.<a href="#section-2.1-5" class="pilcrow">¶</a></p>
<p id="section-2.1-6">Security considerations: See <a href="#Security" class="xref">Section 3</a>.<a href="#section-2.1-6" class="pilcrow">¶</a></p>
<p id="section-2.1-7">Interoperability considerations: See <a href="#Interop" class="xref">Section 4</a>.<a href="#section-2.1-7" class="pilcrow">¶</a></p>
<p id="section-2.1-8">Published specification: <span>[<a href="#webp-riff-src" class="xref">webp-riff-src</a>]</span><a href="#section-2.1-8" class="pilcrow">¶</a></p>
<p id="section-2.1-9">Applications that use this media type: Applications that are used to
         display and process images, especially when smaller image file sizes
         are important.<a href="#section-2.1-9" class="pilcrow">¶</a></p>
<p id="section-2.1-10">Fragment identifier considerations: N/A<a href="#section-2.1-10" class="pilcrow">¶</a></p>
<p id="section-2.1-11">Additional information:<a href="#section-2.1-11" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-12.1">Deprecated alias names for this type: N/A<a href="#section-2.1-12.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-12.2">Magic number(s): The first 4 bytes are 0x52, 0x49, 0x46, 0x46
           ('RIFF'), followed by 4 bytes for the RIFF chunk size. The next 7
           bytes are 0x57, 0x45, 0x42, 0x50, 0x56, 0x50, 0x38 ('WEBPVP8').<a href="#section-2.1-12.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-12.3">File extension(s): webp<a href="#section-2.1-12.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-12.4">Apple Uniform Type Identifier: org.webmproject.webp conforms to
             public.image<a href="#section-2.1-12.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-12.5">Object Identifiers: N/A<a href="#section-2.1-12.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-13">Person &amp; email address to contact for further information:<a href="#section-2.1-13" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-14.1">Name: James Zern<a href="#section-2.1-14.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-14.2">Email: jzern@google.com<a href="#section-2.1-14.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-15">Intended usage: COMMON<a href="#section-2.1-15" class="pilcrow">¶</a></p>
<p id="section-2.1-16">Restrictions on usage: N/A<a href="#section-2.1-16" class="pilcrow">¶</a></p>
<p id="section-2.1-17">Author:<a href="#section-2.1-17" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-18.1">Name: James Zern<a href="#section-2.1-18.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-18.2">Email: jzern@google.com<a href="#section-2.1-18.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-19">Change controller:<a href="#section-2.1-19" class="pilcrow">¶</a></p>
<ul class="normal ulEmpty">
<li class="normal ulEmpty" id="section-2.1-20.1">Name: James Zern<a href="#section-2.1-20.1" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-20.2">Email: jzern@google.com<a href="#section-2.1-20.2" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-20.3">Name: Pascal Massimino<a href="#section-2.1-20.3" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-20.4">Email: pascal.massimino@gmail.com<a href="#section-2.1-20.4" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-20.5">Name: WebM Project<a href="#section-2.1-20.5" class="pilcrow">¶</a>
</li>
          <li class="normal ulEmpty" id="section-2.1-20.6">Email: webmaster@webmproject.org<a href="#section-2.1-20.6" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-2.1-21">Provisional registration? (standards tree only): N/A<a href="#section-2.1-21" class="pilcrow">¶</a></p>
</section>
</section>
</div>
<div id="Security">
<section id="section-3">
      <h2 id="name-security-considerations">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-3-1">Security risks are similar to other media content and may include
       integer overflows, out-of-bounds reads and writes to both heap and
       stack, uninitialized data usage, null pointer references, resource
       (disk, memory) exhaustion and extended resource usage (long running
       time) as part of the demuxing and decoding process. These may cause
       information leakage (memory layout and contents) or crashes and thereby
       denial of service to an application using the format <span>[<a href="#cve.mitre.org-libwebp" class="xref">cve.mitre.org-libwebp</a>]</span> <span>[<a href="#crbug-security" class="xref">crbug-security</a>]</span>.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">The format does not employ "active content", but does allow metadata
       (<span>[<a href="#XMP" class="xref">XMP</a>]</span>, <span>[<a href="#Exif" class="xref">Exif</a>]</span>) and custom chunks to be
       embedded in a file. Applications that interpret these chunks may be
       subject to security considerations for those formats.<a href="#section-3-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="Interop">
<section id="section-4">
      <h2 id="name-interoperability-considerat">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-interoperability-considerat" class="section-name selfRef">Interoperability Considerations</a>
      </h2>
<p id="section-4-1">The format is defined using little-endian byte ordering (see <span><a href="https://rfc-editor.org/rfc/rfc2781#section-3.1" class="relref">Section 3.1</a> of [<a href="#RFC2781" class="xref">RFC2781</a>]</span>), but demuxing and decoding are
       possible on platforms using a different ordering with the appropriate
       conversion.

       The container is RIFF-based and allows extension via user defined
       chunks, but nothing beyond the chunks defined by the container format
       (<a href="#webp-container" class="xref">Section 6</a>) are required for decoding of the image.
       These have been finalized, but were extended in the format's early
       stages so some older readers may not support lossless or animated image
       decoding.<a href="#section-4-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="IANA">
<section id="section-5">
      <h2 id="name-iana-considerations">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-5-1">IANA has updated the <span><a href="#IANA-Media-Types" class="xref">"Image Media
       Types" registry</a> [<a href="#IANA-Media-Types" class="xref">IANA-Media-Types</a>]</span> to include 'image/webp' as described in <a href="#webp-media-type" class="xref">Section 2</a>.<a href="#section-5-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="webp-container">
<section id="section-6">
      <h2 id="name-webp-container-specificatio">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-webp-container-specificatio" class="section-name selfRef">WebP Container Specification</a>
      </h2>
<p id="section-6-1">Note this section is based on the documentation in the <span><a href="#webp-riff-src" class="xref">libwebp source repository</a> [<a href="#webp-riff-src" class="xref">webp-riff-src</a>]</span> at the time
         of writing.<a href="#section-6-1" class="pilcrow">¶</a></p>
<section id="section-6.1">
        <h3 id="name-introduction-2">
<a href="#section-6.1" class="section-number selfRef">6.1. </a><a href="#name-introduction-2" class="section-name selfRef">Introduction</a>
        </h3>
<p id="section-6.1-1">WebP is an image format that uses either (i) the VP8 intra-frame
         encoding <span>[<a href="#RFC6386" class="xref">RFC6386</a>]</span> to compress image data in a lossy
           way, or (ii) the <span><a href="#webp-lossless" class="xref">WebP lossless
             encoding</a> (<a href="#webp-lossless" class="xref">Section 7</a>)</span>. These encoding schemes should make it more
               efficient than currently used formats. It is optimized for fast
               image transfer over the network (e.g., for websites). The WebP
               format has feature parity (color profile, metadata, animation
               etc) with other formats as well. This section describes the
               structure of a WebP file.<a href="#section-6.1-1" class="pilcrow">¶</a></p>
<p id="section-6.1-2">The WebP container (i.e., RIFF container for WebP) allows feature
         support over and above the basic use case of WebP (i.e., a file
         containing a single image encoded as a VP8 key frame). The WebP
         container provides additional support for:<a href="#section-6.1-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.1-3.1">
            <strong>Lossless compression.</strong> An image can be
             losslessly compressed, using the WebP Lossless Format.<a href="#section-6.1-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-3.2">
            <strong>Metadata.</strong> An image may have metadata stored in
             <span>[<a href="#Exif" class="xref">Exif</a>]</span> or <span>[<a href="#XMP" class="xref">XMP</a>]</span> formats.<a href="#section-6.1-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-3.3">
            <strong>Transparency.</strong> An image may have transparency,
             i.e., an alpha channel.<a href="#section-6.1-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-3.4">
            <strong>Color Profile.</strong> An image may have an embedded
             <span><a href="#ICC" class="xref">ICC profile</a> [<a href="#ICC" class="xref">ICC</a>]</span>.<a href="#section-6.1-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.1-3.5">
            <strong>Animation.</strong> An image may have multiple frames
             with pauses between them, making it an animation.<a href="#section-6.1-3.5" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.1-4">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL NOT",
         "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and "OPTIONAL" in this
         document are to be interpreted as described in <span>[<a href="#RFC2119" class="xref">RFC2119</a>]</span>.<a href="#section-6.1-4" class="pilcrow">¶</a></p>
<p id="section-6.1-5">Bit numbering in chunk diagrams starts at <code>0</code> for the most
         significant bit ('MSB 0') as described in <span>[<a href="#RFC1166" class="xref">RFC1166</a>]</span>.<a href="#section-6.1-5" class="pilcrow">¶</a></p>
</section>
<div id="terminology-amp-basics">
<section id="section-6.2">
        <h3 id="name-terminology-basics">
<a href="#section-6.2" class="section-number selfRef">6.2. </a><a href="#name-terminology-basics" class="section-name selfRef">Terminology &amp; Basics</a>
        </h3>
<p id="section-6.2-1">A WebP file contains either a still image (i.e., an encoded matrix of
         pixels) or an <span><a href="#animation" class="xref">animation</a> (<a href="#animation" class="xref">Section 6.7.1.1</a>)</span>. Optionally,
           it can also contain transparency information, color profile and
           metadata. In case we need to refer only to the matrix of pixels, we
           will call it the <em>canvas</em> of the image.<a href="#section-6.2-1" class="pilcrow">¶</a></p>
<p id="section-6.2-2">Below are additional terms used throughout this document:<a href="#section-6.2-2" class="pilcrow">¶</a></p>
<span class="break"></span><dl class="dlNewline" id="section-6.2-3">
          <dt id="section-6.2-3.1">Reader/Writer</dt>
          <dd style="margin-left: 4.0em" id="section-6.2-3.2">Code that reads WebP files is referred to as a <em>reader</em>,
           while code that writes them is referred to as a
         <em>writer</em>.<a href="#section-6.2-3.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.3">uint16</dt>
          <dd style="margin-left: 4.0em" id="section-6.2-3.4">A 16-bit, little-endian, unsigned integer.<a href="#section-6.2-3.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.5">uint24</dt>
          <dd style="margin-left: 4.0em" id="section-6.2-3.6">A 24-bit, little-endian, unsigned integer.<a href="#section-6.2-3.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.7">uint32</dt>
          <dd style="margin-left: 4.0em" id="section-6.2-3.8">A 32-bit, little-endian, unsigned integer.<a href="#section-6.2-3.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.9">FourCC</dt>
          <dd style="margin-left: 4.0em" id="section-6.2-3.10">A FourCC (four-character code) is a uint32 created by
           concatenating four ASCII characters in little-endian order.<a href="#section-6.2-3.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.2-3.11">1-based</dt>
          <dd style="margin-left: 4.0em" id="section-6.2-3.12">An unsigned integer field storing values offset by -1. e.g., Such
           a field would store value <em>25</em> as <em>24</em>.<a href="#section-6.2-3.12" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
</div>
<div id="riff-file-format">
<section id="section-6.3">
        <h3 id="name-riff-file-format">
<a href="#section-6.3" class="section-number selfRef">6.3. </a><a href="#name-riff-file-format" class="section-name selfRef">RIFF File Format</a>
        </h3>
<p id="section-6.3-1">The WebP file format is based on the <span><a href="#riff-spec" class="xref">RIFF</a> [<a href="#riff-spec" class="xref">riff-spec</a>]</span> (Resource Interchange File Format)
           document format.<a href="#section-6.3-1" class="pilcrow">¶</a></p>
<p id="section-6.3-2">The basic element of a RIFF file is a <em>chunk</em>. It consists
         of:<a href="#section-6.3-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-ascii-art art-text artwork" id="section-6.3-3">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Chunk FourCC                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          Chunk Size                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Chunk Payload                         |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.3-3" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.3-4">
          <dt id="section-6.3-4.1">Chunk FourCC: 32 bits</dt>
          <dd style="margin-left: 4.0em" id="section-6.3-4.2">ASCII four-character code used for chunk identification.<a href="#section-6.3-4.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.3">Chunk Size: 32 bits (<em>uint32</em>)</dt>
          <dd style="margin-left: 4.0em" id="section-6.3-4.4">The size of the chunk not including this field, the chunk
             identifier or padding.<a href="#section-6.3-4.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.5">Chunk Payload: <em>Chunk Size</em> bytes</dt>
          <dd style="margin-left: 4.0em" id="section-6.3-4.6">The data payload. If <em>Chunk Size</em> is odd, a single
             padding byte -- that SHOULD be <code>0</code> -- is added.<a href="#section-6.3-4.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.3-4.7">ChunkHeader('ABCD')</dt>
          <dd style="margin-left: 4.0em" id="section-6.3-4.8">This is used to describe the <em>FourCC</em> and <em>Chunk
             Size</em> header of individual chunks, where 'ABCD' is the FourCC
               for the chunk. This element's size is 8 bytes.<a href="#section-6.3-4.8" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.3-5"><strong>Note:</strong> RIFF has a convention that all-uppercase
           chunk FourCCs are standard chunks that apply to any RIFF file
           format, while FourCCs specific to a file format are all lowercase.
           WebP does not follow this convention.<a href="#section-6.3-5" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.4">
        <h3 id="name-webp-file-header">
<a href="#section-6.4" class="section-number selfRef">6.4. </a><a href="#name-webp-file-header" class="section-name selfRef">WebP File Header</a>
        </h3>
<div class="alignLeft art-text artwork" id="section-6.4-1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      'R'      |      'I'      |      'F'      |      'F'      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           File Size                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|      'W'      |      'E'      |      'B'      |      'P'      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.4-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.4-2">
          <dt id="section-6.4-2.1">'RIFF': 32 bits</dt>
          <dd style="margin-left: 4.0em" id="section-6.4-2.2">The ASCII characters 'R' 'I' 'F' 'F'.<a href="#section-6.4-2.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-2.3">File Size: 32 bits (<em>uint32</em>)</dt>
          <dd style="margin-left: 4.0em" id="section-6.4-2.4">The size of the file in bytes starting at offset 8. The maximum
           value of this field is 2^32 minus 10 bytes and thus the size of the
           whole file is at most 4GiB minus 2 bytes.<a href="#section-6.4-2.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.4-2.5">'WEBP': 32 bits</dt>
          <dd style="margin-left: 4.0em" id="section-6.4-2.6">The ASCII characters 'W' 'E' 'B' 'P'.<a href="#section-6.4-2.6" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.4-3">A WebP file MUST begin with a RIFF header with the FourCC 'WEBP'. The
         file size in the header is the total size of the chunks that follow
         plus <code>4</code> bytes for the 'WEBP' FourCC. The file SHOULD NOT
           contain anything after it. As the size of any chunk is even, the
           size given by the RIFF header is also even. The contents of
           individual chunks will be described in the following sections.<a href="#section-6.4-3" class="pilcrow">¶</a></p>
</section>
<div id="simple-file-format-lossy">
<section id="section-6.5">
        <h3 id="name-simple-file-format-lossy">
<a href="#section-6.5" class="section-number selfRef">6.5. </a><a href="#name-simple-file-format-lossy" class="section-name selfRef">Simple File Format (Lossy)</a>
        </h3>
<p id="section-6.5-1">This layout SHOULD be used if the image requires lossy encoding and
         does not require transparency or other advanced features provided by
         the extended format. Files with this layout are smaller and supported
         by older software.<a href="#section-6.5-1" class="pilcrow">¶</a></p>
<p id="section-6.5-2">Simple WebP (lossy) file format:<a href="#section-6.5-2" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5-3">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    WebP file header (12 bytes)                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          VP8 chunk                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.5-3" class="pilcrow">¶</a>
</div>
<p id="section-6.5-4">VP8 chunk:<a href="#section-6.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.5-5">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('VP8 ')                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           VP8 data                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.5-5" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.5-6">
          <dt id="section-6.5-6.1">VP8 data: <em>Chunk Size</em> bytes</dt>
          <dd style="margin-left: 4.0em" id="section-6.5-6.2">VP8 bitstream data.<a href="#section-6.5-6.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.5-7">The VP8 bitstream format specification is described by <span>[<a href="#RFC6386" class="xref">RFC6386</a>]</span>. Note that the VP8 frame header contains the VP8
        frame width and height. That is assumed to be the width and height of
        the canvas.<a href="#section-6.5-7" class="pilcrow">¶</a></p>
<p id="section-6.5-8">The VP8 specification describes how to decode the image into Y'CbCr
        format. To convert to RGB, <span><a href="#rec601" class="xref">Rec. 601</a> [<a href="#rec601" class="xref">rec601</a>]</span> SHOULD
          be used.<a href="#section-6.5-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="simple-file-format-lossless">
<section id="section-6.6">
        <h3 id="name-simple-file-format-lossless">
<a href="#section-6.6" class="section-number selfRef">6.6. </a><a href="#name-simple-file-format-lossless" class="section-name selfRef">Simple File Format (Lossless)</a>
        </h3>
<p id="section-6.6-1"><strong>Note:</strong> Older readers may not support files using the
         lossless format.<a href="#section-6.6-1" class="pilcrow">¶</a></p>
<p id="section-6.6-2">This layout SHOULD be used if the image requires lossless encoding
         (with an optional transparency channel) and does not require advanced
         features provided by the extended format.<a href="#section-6.6-2" class="pilcrow">¶</a></p>
<p id="section-6.6-3">Simple WebP (lossless) file format:<a href="#section-6.6-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.6-4">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                    WebP file header (12 bytes)                |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                          VP8L chunk                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.6-4" class="pilcrow">¶</a>
</div>
<p id="section-6.6-5">VP8L chunk:<a href="#section-6.6-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.6-6">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('VP8L')                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                           VP8L data                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.6-6" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.6-7">
          <dt id="section-6.6-7.1">VP8L data: <em>Chunk Size</em> bytes</dt>
          <dd style="margin-left: 4.0em" id="section-6.6-7.2">VP8L bitstream data.<a href="#section-6.6-7.2" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.6-8">The specification of the VP8L bitstream can be found in <a href="#webp-lossless" class="xref">Section 7</a>. Note that the VP8L header contains the
         VP8L image width and height. That is assumed to be the width and
         height of the canvas.<a href="#section-6.6-8" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.7">
        <h3 id="name-extended-file-format">
<a href="#section-6.7" class="section-number selfRef">6.7. </a><a href="#name-extended-file-format" class="section-name selfRef">Extended File Format</a>
        </h3>
<p id="section-6.7-1"><strong>Note:</strong> Older readers may not support files using the
         extended format.<a href="#section-6.7-1" class="pilcrow">¶</a></p>
<p id="section-6.7-2">An extended format file consists of:<a href="#section-6.7-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7-3.1">A 'VP8X' chunk with information about features used in the
           file.<a href="#section-6.7-3.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.7-3.2">An optional 'ICCP' chunk with color profile.<a href="#section-6.7-3.2" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.7-3.3">An optional 'ANIM' chunk with animation control data.<a href="#section-6.7-3.3" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.7-3.4">Image data.<a href="#section-6.7-3.4" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.7-3.5">An optional 'EXIF' chunk with Exif metadata.<a href="#section-6.7-3.5" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.7-3.6">An optional 'XMP ' chunk with XMP metadata.<a href="#section-6.7-3.6" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.7-3.7">An optional list of <span><a href="#unknown-chunks" class="xref">unknown
           chunks</a> (<a href="#unknown-chunks" class="xref">Section 6.7.1.6</a>)</span>.<a href="#section-6.7-3.7" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.7-4">For a <em>still image</em>, the <em>image data</em> consists of a
         single frame, which is made up of:<a href="#section-6.7-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7-5.1">An optional <span><a href="#alpha" class="xref">alpha subchunk</a> (<a href="#alpha" class="xref">Section 6.7.1.2</a>)</span>.<a href="#section-6.7-5.1" class="pilcrow">¶</a>
</li>
          <li class="normal" id="section-6.7-5.2">A <span><a href="#bitstream-vp8vp8l" class="xref">bitstream subchunk</a> (<a href="#bitstream-vp8vp8l" class="xref">Section 6.7.1.3</a>)</span>.<a href="#section-6.7-5.2" class="pilcrow">¶</a>
</li>
        </ul>
<p id="section-6.7-6">For an <em>animated image</em>, the <em>image data</em> consists of
         multiple frames. More details about frames can be found in <a href="#animation" class="xref">Section 6.7.1.1</a>.<a href="#section-6.7-6" class="pilcrow">¶</a></p>
<p id="section-6.7-7">All chunks SHOULD be placed in the same order as listed above. If a
         chunk appears in the wrong place, the file is invalid, but readers MAY
         parse the file, ignoring the chunks that come too late.<a href="#section-6.7-7" class="pilcrow">¶</a></p>
<p id="section-6.7-8"><strong>Rationale:</strong> Setting the order of chunks should allow
         quicker file parsing. For example, if an 'ALPH' chunk does not appear
         in its required position, a decoder can choose to stop searching for
         it. The rule of ignoring late chunks should make programs that need to
         do a full search give the same results as the ones stopping early.<a href="#section-6.7-8" class="pilcrow">¶</a></p>
<div id="extended_header">
<p id="section-6.7-9">Extended WebP file header:<a href="#section-6.7-9" class="pilcrow">¶</a></p>
</div>
<div class="alignLeft art-text artwork" id="section-6.7-10">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                   WebP file header (12 bytes)                 |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('VP8X')                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Rsv|I|L|E|X|A|R|                   Reserved                    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Canvas Width Minus One               |             ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...  Canvas Height Minus One    |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.7-10" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.7-11">
          <dt id="section-6.7-11.1">Reserved (Rsv): 2 bits</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.2">SHOULD be <code>0</code>.<a href="#section-6.7-11.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.7-11.3">ICC profile (I): 1 bit</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.4">Set if the file contains an ICC profile.<a href="#section-6.7-11.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.7-11.5">Alpha (L): 1 bit</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.6">Set if any of the frames of the image contain transparency
           information ("alpha").<a href="#section-6.7-11.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.7-11.7">Exif metadata (E): 1 bit</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.8">Set if the file contains Exif metadata.<a href="#section-6.7-11.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.7-11.9">XMP metadata (X): 1 bit</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.10">Set if the file contains XMP metadata.<a href="#section-6.7-11.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.7-11.11">Animation (A): 1 bit</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.12">Set if this is an animated image. Data in 'ANIM' and 'ANMF' chunks
           should be used to control the animation.<a href="#section-6.7-11.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.7-11.13">Reserved (R): 1 bit</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.14">SHOULD be <code>0</code>.<a href="#section-6.7-11.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.7-11.15">Reserved: 24 bits</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.16">SHOULD be <code>0</code>.<a href="#section-6.7-11.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.7-11.17">Canvas Width Minus One: 24 bits</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.18">
            <em>1-based</em> width of the canvas in pixels. The actual canvas
           width is <code>1 + Canvas Width Minus One</code><a href="#section-6.7-11.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-6.7-11.19">Canvas Height Minus One: 24 bits</dt>
          <dd style="margin-left: 4.0em" id="section-6.7-11.20">
            <em>1-based</em> height of the canvas in pixels. The actual canvas
           height is <code>1 + Canvas Height Minus One</code><a href="#section-6.7-11.20" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
<p id="section-6.7-12">The product of <em>Canvas Width</em> and <em>Canvas Height</em> MUST
         be at most <code>2^32 - 1</code>.<a href="#section-6.7-12" class="pilcrow">¶</a></p>
<p id="section-6.7-13">Future specifications MAY add more fields.<a href="#section-6.7-13" class="pilcrow">¶</a></p>
<section id="section-6.7.1">
          <h4 id="name-chunks">
<a href="#section-6.7.1" class="section-number selfRef">6.7.1. </a><a href="#name-chunks" class="section-name selfRef">Chunks</a>
          </h4>
<div id="animation">
<section id="section-6.7.1.1">
            <h5 id="name-animation">
<a href="#section-6.7.1.1" class="section-number selfRef">6.7.1.1. </a><a href="#name-animation" class="section-name selfRef">Animation</a>
            </h5>
<p id="section-6.7.1.1-1">An animation is controlled by ANIM and ANMF chunks.<a href="#section-6.7.1.1-1" class="pilcrow">¶</a></p>
<div id="anim_chunk">
<p id="section-6.7.1.1-2">ANIM Chunk:<a href="#section-6.7.1.1-2" class="pilcrow">¶</a></p>
</div>
<p id="section-6.7.1.1-3">For an animated image, this chunk contains the <em>global
             parameters</em> of the animation.<a href="#section-6.7.1.1-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7.1.1-4">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('ANIM')                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Background Color                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|          Loop Count           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.7.1.1-4" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.7.1.1-5">
              <dt id="section-6.7.1.1-5.1">Background Color: 32 bits (<em>uint32</em>)</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-5.2">
                <p id="section-6.7.1.1-5.2.1">The default background color of the canvas in [Blue, Green,
                 Red, Alpha] byte order. This color MAY be used to fill the
                 unused space on the canvas around the frames, as well as the
                 transparent pixels of the first frame. Background color is
                 also used when disposal method is <code>1</code>.<a href="#section-6.7.1.1-5.2.1" class="pilcrow">¶</a></p>
<p id="section-6.7.1.1-5.2.2"><strong>Note:</strong><a href="#section-6.7.1.1-5.2.2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.1-5.2.3.1">Background color MAY contain a transparency value (alpha),
                   even if the <em>Alpha</em> flag in <span><a href="#extended_header" class="xref">VP8X chunk</a> (<a href="#extended_header" class="xref">Section 6.7, Paragraph 9</a>)</span> is unset.<a href="#section-6.7.1.1-5.2.3.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.1-5.2.3.2">Viewer applications SHOULD treat the background color value
                   as a hint, and are not required to use it.<a href="#section-6.7.1.1-5.2.3.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.1-5.2.3.3">The canvas is cleared at the start of each loop. The
                   background color MAY be used to achieve this.<a href="#section-6.7.1.1-5.2.3.3" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.1-5.3">Loop Count: 16 bits (<em>uint16</em>)</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-5.4">The number of times to loop the animation. <code>0</code> means
               infinitely.<a href="#section-6.7.1.1-5.4" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-6.7.1.1-6">This chunk MUST appear if the <em>Animation</em> flag in the VP8X
             chunk is set. If the <em>Animation</em> flag is not set and this
               chunk is present, it SHOULD be ignored.<a href="#section-6.7.1.1-6" class="pilcrow">¶</a></p>
<p id="section-6.7.1.1-7">ANMF chunk:<a href="#section-6.7.1.1-7" class="pilcrow">¶</a></p>
<p id="section-6.7.1.1-8">For animated images, this chunk contains information about a
             <em>single</em> frame. If the <em>Animation flag</em> is not set,
               then this chunk SHOULD NOT be present.<a href="#section-6.7.1.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7.1.1-9">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('ANMF')                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Frame X                |             ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...          Frame Y            |   Frame Width Minus One     ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
...             |           Frame Height Minus One              |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                 Frame Duration                |  Reserved |B|D|
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                         Frame Data                            |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.7.1.1-9" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.7.1.1-10">
              <dt id="section-6.7.1.1-10.1">Frame X: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-10.2">The X coordinate of the upper left corner of the frame is
                <code>Frame X * 2</code><a href="#section-6.7.1.1-10.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.1-10.3">Frame Y: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-10.4">The Y coordinate of the upper left corner of the frame is
                 <code>Frame Y * 2</code><a href="#section-6.7.1.1-10.4" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.1-10.5">Frame Width Minus One: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-10.6">The <em>1-based</em> width of the frame. The frame width is
                 <code>1 + Frame Width Minus One</code><a href="#section-6.7.1.1-10.6" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.1-10.7">Frame Height Minus One: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-10.8">The <em>1-based</em> height of the frame. The frame height
                 is <code>1 + Frame Height Minus One</code><a href="#section-6.7.1.1-10.8" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.1-10.9">Frame Duration: 24 bits (<em>uint24</em>)</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-10.10">The time to wait before displaying the next frame, in 1
                 millisecond units. Note the interpretation of frame duration
                 of 0 (and often &lt;= 10) is implementation defined. Many
                 tools and browsers assign a minimum duration similar to
                 GIF.<a href="#section-6.7.1.1-10.10" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.1-10.11">Reserved: 6 bits</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-10.12">SHOULD be <code>0</code>.<a href="#section-6.7.1.1-10.12" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.1-10.13">Blending method (B): 1 bit</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-10.14">
                <p id="section-6.7.1.1-10.14.1">Indicates how transparent pixels of <em>the current
                 frame</em> are to be blended with corresponding pixels of the
                   previous canvas:<a href="#section-6.7.1.1-10.14.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.1-10.14.2.1">
                    <code>0</code>: Use alpha blending. After disposing of the
                     previous frame, render the current frame on the canvas
                     using <span><a href="#alpha-blending" class="xref">alpha-blending</a> (<a href="#alpha-blending" class="xref">Section 6.7.1.1, Paragraph 10, Item 16.4.2</a>)</span>.
                       If the current frame does not have an alpha channel,
                       assume alpha value of 255, effectively replacing the
                       rectangle.<a href="#section-6.7.1.1-10.14.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.1-10.14.2.2">
                    <code>1</code>: Do not blend. After disposing of the
                     previous frame, render the current frame on the canvas by
                     overwriting the rectangle covered by the current
                     frame.<a href="#section-6.7.1.1-10.14.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.1-10.15">Disposal method (D): 1 bit</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-10.16">
                <p id="section-6.7.1.1-10.16.1">Indicates how <em>the current frame</em> is to be treated
                 after it has been displayed (before rendering the next frame)
                 on the canvas:<a href="#section-6.7.1.1-10.16.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.1-10.16.2.1">
                    <code>0</code>: Do not dispose. Leave the canvas as is.<a href="#section-6.7.1.1-10.16.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.1-10.16.2.2">
                    <code>1</code>: Dispose to background color. Fill the
                     <em>rectangle</em> on the canvas covered by the <em>current
                     frame</em> with background color specified in the <span><a href="#anim_chunk" class="xref">ANIM chunk</a> (<a href="#anim_chunk" class="xref">Section 6.7.1.1, Paragraph 2</a>)</span>.<a href="#section-6.7.1.1-10.16.2.2" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-6.7.1.1-10.16.3"><strong>Notes:</strong><a href="#section-6.7.1.1-10.16.3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.1-10.16.4.1">The frame disposal only applies to the <em>frame
                     rectangle</em>, that is, the rectangle defined by
                     <em>Frame X</em>, <em>Frame Y</em>, <em>frame width</em>
                     and <em>frame height</em>. It may or may not cover the
                     whole canvas.<a href="#section-6.7.1.1-10.16.4.1" class="pilcrow">¶</a>
</li>
                  <li id="section-6.7.1.1-10.16.4.2" class="normal">
<div class="normal" id="alpha-blending">
                    <p id="section-6.7.1.1-10.16.4.2.1">Alpha-blending:<a href="#section-6.7.1.1-10.16.4.2.1" class="pilcrow">¶</a></p>
<p id="section-6.7.1.1-10.16.4.2.2">Given that each of the R, G, B and A channels is 8-bit,
                       and the RGB channels are <em>not premultiplied</em> by
                       alpha, the formula for blending 'dst' onto 'src' is:<a href="#section-6.7.1.1-10.16.4.2.2" class="pilcrow">¶</a></p>
<div id="section-6.7.1.1-10.16.4.2.3">
<pre class="sourcecode">
blend.A = src.A + dst.A * (1 - src.A / 255)
if blend.A = 0 then
  blend.RGB = 0
else
  blend.RGB = (src.RGB * src.A +
               dst.RGB * dst.A * (1 - src.A / 255)) / blend.A
</pre><a href="#section-6.7.1.1-10.16.4.2.3" class="pilcrow">¶</a>
</div>
</div>
                  </li>
<li class="normal" id="section-6.7.1.1-10.16.4.3">Alpha-blending SHOULD be done in linear color space, by
                     taking into account the <span><a href="#color-profile" class="xref">color
                       profile</a> (<a href="#color-profile" class="xref">Section 6.7.1.4</a>)</span> of the image. If the color profile is not
                         present, sRGB is to be assumed. (Note that sRGB also
                         needs to be linearized due to a gamma of ~2.2).<a href="#section-6.7.1.1-10.16.4.3" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.1-10.17">Frame Data: <em>Chunk Size</em> - <code>16</code> bytes</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.1-10.18">
                <p id="section-6.7.1.1-10.18.1">Consists of:<a href="#section-6.7.1.1-10.18.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.1-10.18.2.1">An optional <span><a href="#alpha" class="xref">alpha subchunk</a> (<a href="#alpha" class="xref">Section 6.7.1.2</a>)</span>
                       for the frame.<a href="#section-6.7.1.1-10.18.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.1-10.18.2.2">A <span><a href="#bitstream-vp8vp8l" class="xref">bitstream
                     subchunk</a> (<a href="#bitstream-vp8vp8l" class="xref">Section 6.7.1.3</a>)</span> for the frame.<a href="#section-6.7.1.1-10.18.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.1-10.18.2.3">An optional list of <span><a href="#unknown-chunks" class="xref">unknown chunks</a> (<a href="#unknown-chunks" class="xref">Section 6.7.1.6</a>)</span>.<a href="#section-6.7.1.1-10.18.2.3" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-6.7.1.1-11"><strong>Note:</strong> The 'ANMF' payload, <em>Frame Data</em>
               above, consists of individual <em>padded</em> chunks as
               described by the <span><a href="#riff-file-format" class="xref">RIFF file
               format</a> (<a href="#riff-file-format" class="xref">Section 6.3</a>)</span>.<a href="#section-6.7.1.1-11" class="pilcrow">¶</a></p>
</section>
</div>
<div id="alpha">
<section id="section-6.7.1.2">
            <h5 id="name-alpha">
<a href="#section-6.7.1.2" class="section-number selfRef">6.7.1.2. </a><a href="#name-alpha" class="section-name selfRef">Alpha</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-6.7.1.2-1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('ALPH')                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Rsv| P | F | C |     Alpha Bitstream...                        |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.7.1.2-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.7.1.2-2">
              <dt id="section-6.7.1.2-2.1">Reserved (Rsv): 2 bits</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.2-2.2">SHOULD be <code>0</code>.<a href="#section-6.7.1.2-2.2" class="pilcrow">¶</a>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.2-2.3">Pre-processing (P): 2 bits</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.2-2.4">
                <p id="section-6.7.1.2-2.4.1">These INFORMATIVE bits are used to signal the
               pre-processing that has been performed during compression. The
               decoder can use this information to e.g. dither the values or
               smooth the gradients prior to display.<a href="#section-6.7.1.2-2.4.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.2-2.4.2.1">
                    <code>0</code>: no pre-processing<a href="#section-6.7.1.2-2.4.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.4.2.2">
                    <code>1</code>: level reduction<a href="#section-6.7.1.2-2.4.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.2-2.5">Filtering method (F): 2 bits</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.2-2.6">
                <p id="section-6.7.1.2-2.6.1">The filtering method used:<a href="#section-6.7.1.2-2.6.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.2-2.6.2.1">
                    <code>0</code>: None.<a href="#section-6.7.1.2-2.6.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.2.2">
                    <code>1</code>: Horizontal filter.<a href="#section-6.7.1.2-2.6.2.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.2.3">
                    <code>2</code>: Vertical filter.<a href="#section-6.7.1.2-2.6.2.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.2.4">
                    <code>3</code>: Gradient filter.<a href="#section-6.7.1.2-2.6.2.4" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-6.7.1.2-2.6.3">For each pixel, filtering is performed using the following
                 calculations. Assume the alpha values surrounding the current
                 <code>X</code> position are labeled as:<a href="#section-6.7.1.2-2.6.3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7.1.2-2.6.4">
<pre>
 C | B |
---+---+
 A | X |
</pre><a href="#section-6.7.1.2-2.6.4" class="pilcrow">¶</a>
</div>
<p id="section-6.7.1.2-2.6.5">We seek to compute the alpha value at position X. First, a
                 prediction is made depending on the filtering method:<a href="#section-6.7.1.2-2.6.5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.2-2.6.6.1">Method <code>0</code>: predictor = 0<a href="#section-6.7.1.2-2.6.6.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.6.2">Method <code>1</code>: predictor = A<a href="#section-6.7.1.2-2.6.6.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.6.3">Method <code>2</code>: predictor = B<a href="#section-6.7.1.2-2.6.6.3" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.6.4">Method <code>3</code>: predictor = clip(A + B - C)<a href="#section-6.7.1.2-2.6.6.4" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-6.7.1.2-2.6.7">where <code>clip(v)</code> is equal to:<a href="#section-6.7.1.2-2.6.7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.2-2.6.8.1">0    if v &lt; 0<a href="#section-6.7.1.2-2.6.8.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.8.2">255  if v &gt; 255<a href="#section-6.7.1.2-2.6.8.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.8.3">v    otherwise<a href="#section-6.7.1.2-2.6.8.3" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-6.7.1.2-2.6.9">The final value is derived by adding the decompressed value
                 <code>X</code> to the predictor and using modulo-256 arithmetic to
                 wrap the [256-511] range into the [0-255] one:<a href="#section-6.7.1.2-2.6.9" class="pilcrow">¶</a></p>
<div id="section-6.7.1.2-2.6.10">
<pre class="sourcecode">
alpha = (predictor + X) % 256
</pre><a href="#section-6.7.1.2-2.6.10" class="pilcrow">¶</a>
</div>
<p id="section-6.7.1.2-2.6.11">There are special cases for left-most and top-most pixel
                 positions:<a href="#section-6.7.1.2-2.6.11" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.2-2.6.12.1">Top-left value at location (0,0) uses 0 as predictor
                   value. Otherwise,<a href="#section-6.7.1.2-2.6.12.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.12.2">For horizontal or gradient filtering methods, the
                   left-most pixels at location (0, y) are predicted using the
                   location (0, y-1) just above.<a href="#section-6.7.1.2-2.6.12.2" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.6.12.3">For vertical or gradient filtering methods, the top-most
                   pixels at location (x, 0) are predicted using the location
                   (x-1, 0) on the left.<a href="#section-6.7.1.2-2.6.12.3" class="pilcrow">¶</a>
</li>
                </ul>
<p id="section-6.7.1.2-2.6.13">Decoders are not required to use this information in any
                 specified way.<a href="#section-6.7.1.2-2.6.13" class="pilcrow">¶</a></p>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.2-2.7">Compression method (C): 2 bits</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.2-2.8">
                <p id="section-6.7.1.2-2.8.1">The compression method used:<a href="#section-6.7.1.2-2.8.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.2-2.8.2.1">
                    <code>0</code>: No compression.<a href="#section-6.7.1.2-2.8.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-6.7.1.2-2.8.2.2">
                    <code>1</code>: Compressed using the WebP lossless format.<a href="#section-6.7.1.2-2.8.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</dd>
              <dd class="break"></dd>
<dt id="section-6.7.1.2-2.9">Alpha bitstream: <em>Chunk Size</em> - <code>1</code> bytes</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.2-2.10">Encoded alpha bitstream.<a href="#section-6.7.1.2-2.10" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-6.7.1.2-3">This optional chunk contains encoded alpha data for this frame. A
             frame containing a 'VP8L' chunk SHOULD NOT contain this chunk.<a href="#section-6.7.1.2-3" class="pilcrow">¶</a></p>
<p id="section-6.7.1.2-4"><strong>Rationale:</strong> The transparency information is
             already part of the 'VP8L' chunk.<a href="#section-6.7.1.2-4" class="pilcrow">¶</a></p>
<p id="section-6.7.1.2-5">The alpha channel data is stored as uncompressed raw data
             (when compression method is '0') or compressed using the
             lossless format (when the compression method is '1').<a href="#section-6.7.1.2-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.2-6.1">Raw data: consists of a byte sequence of length width *
               height, containing all the 8-bit transparency values in scan
               order.<a href="#section-6.7.1.2-6.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.7.1.2-6.2">
                <p id="section-6.7.1.2-6.2.1">Lossless format compression: the byte sequence is a
               compressed image-stream (as described in <a href="#webp-lossless" class="xref">Section 7</a>) of implicit dimension width x
                 height. That is, this image-stream does NOT contain any
                 headers describing the image dimension.<a href="#section-6.7.1.2-6.2.1" class="pilcrow">¶</a></p>
<p id="section-6.7.1.2-6.2.2"><strong>Rationale:</strong> the dimension is already known from
               other sources, so storing it again would be redundant and
               error-prone.<a href="#section-6.7.1.2-6.2.2" class="pilcrow">¶</a></p>
<p id="section-6.7.1.2-6.2.3">Once the image-stream is decoded into ARGB color values,
               following the process described in the lossless format
               specification, the transparency information must be extracted
               from the *green* channel of the ARGB quadruplet.<a href="#section-6.7.1.2-6.2.3" class="pilcrow">¶</a></p>
<p id="section-6.7.1.2-6.2.4"><strong>Rationale:</strong> the green channel is allowed extra
               transformation steps in the specification -- unlike the other
               channels -- that can improve compression.<a href="#section-6.7.1.2-6.2.4" class="pilcrow">¶</a></p>
</li>
            </ul>
</section>
</div>
<div id="bitstream-vp8vp8l">
<section id="section-6.7.1.3">
            <h5 id="name-bitstream-vp8-vp8l">
<a href="#section-6.7.1.3" class="section-number selfRef">6.7.1.3. </a><a href="#name-bitstream-vp8-vp8l" class="section-name selfRef">Bitstream (VP8/VP8L)</a>
            </h5>
<p id="section-6.7.1.3-1">This chunk contains compressed bitstream data for a single
             frame.<a href="#section-6.7.1.3-1" class="pilcrow">¶</a></p>
<p id="section-6.7.1.3-2">A bitstream chunk may be either (i) a VP8 chunk, using "VP8 "
             (note the significant fourth-character space) as its tag
           <em>or</em> (ii) a VP8L chunk, using "VP8L" as its tag.<a href="#section-6.7.1.3-2" class="pilcrow">¶</a></p>
<p id="section-6.7.1.3-3">The formats of VP8 and VP8L chunks are as described in <a href="#simple-file-format-lossy" class="xref">Section 6.5</a> and <a href="#simple-file-format-lossless" class="xref">Section 6.6</a> respectively.<a href="#section-6.7.1.3-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="color-profile">
<section id="section-6.7.1.4">
            <h5 id="name-color-profile">
<a href="#section-6.7.1.4" class="section-number selfRef">6.7.1.4. </a><a href="#name-color-profile" class="section-name selfRef">Color profile</a>
            </h5>
<div class="alignLeft art-text artwork" id="section-6.7.1.4-1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('ICCP')                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                       Color Profile                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.7.1.4-1" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.7.1.4-2">
              <dt id="section-6.7.1.4-2.1">Color Profile: <em>Chunk Size</em> bytes</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.4-2.2">ICC profile.<a href="#section-6.7.1.4-2.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-6.7.1.4-3">This chunk MUST appear before the image data.<a href="#section-6.7.1.4-3" class="pilcrow">¶</a></p>
<p id="section-6.7.1.4-4">There SHOULD be at most one such chunk. If there are more such
             chunks, readers MAY ignore all except the first one. See the <span><a href="#ICC" class="xref">ICC Specification</a> [<a href="#ICC" class="xref">ICC</a>]</span> for details.<a href="#section-6.7.1.4-4" class="pilcrow">¶</a></p>
<p id="section-6.7.1.4-5">If this chunk is not present, sRGB SHOULD be assumed.<a href="#section-6.7.1.4-5" class="pilcrow">¶</a></p>
</section>
</div>
<section id="section-6.7.1.5">
            <h5 id="name-metadata">
<a href="#section-6.7.1.5" class="section-number selfRef">6.7.1.5. </a><a href="#name-metadata" class="section-name selfRef">Metadata</a>
            </h5>
<p id="section-6.7.1.5-1">Metadata can be stored in 'EXIF' or 'XMP ' chunks.<a href="#section-6.7.1.5-1" class="pilcrow">¶</a></p>
<p id="section-6.7.1.5-2">There SHOULD be at most one chunk of each type ('EXIF' and 'XMP
             '). If there are more such chunks, readers MAY ignore all except
             the first one. Also, a file may possibly contain both 'EXIF' and
             'XMP ' chunks.<a href="#section-6.7.1.5-2" class="pilcrow">¶</a></p>
<p id="section-6.7.1.5-3">The chunks are defined as follows:<a href="#section-6.7.1.5-3" class="pilcrow">¶</a></p>
<p id="section-6.7.1.5-4">EXIF chunk:<a href="#section-6.7.1.5-4" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7.1.5-5">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('EXIF')                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        Exif Metadata                          |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.7.1.5-5" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.7.1.5-6">
              <dt id="section-6.7.1.5-6.1">Exif Metadata: <em>Chunk Size</em> bytes</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.5-6.2">image metadata in <span>[<a href="#Exif" class="xref">Exif</a>]</span> format.<a href="#section-6.7.1.5-6.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-6.7.1.5-7">XMP chunk:<a href="#section-6.7.1.5-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7.1.5-8">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                      ChunkHeader('XMP ')                      |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|                        XMP Metadata                           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre><a href="#section-6.7.1.5-8" class="pilcrow">¶</a>
</div>
<span class="break"></span><dl class="dlNewline" id="section-6.7.1.5-9">
              <dt id="section-6.7.1.5-9.1">XMP Metadata: <em>Chunk Size</em> bytes</dt>
              <dd style="margin-left: 4.0em" id="section-6.7.1.5-9.2">image metadata in <span>[<a href="#XMP" class="xref">XMP</a>]</span> format.<a href="#section-6.7.1.5-9.2" class="pilcrow">¶</a>
</dd>
            <dd class="break"></dd>
</dl>
<p id="section-6.7.1.5-10">Additional guidance about handling metadata can be found in the
             Metadata Working Group's <span><a href="#mwg" class="xref">Guidelines for
               Handling Metadata</a> [<a href="#mwg" class="xref">mwg</a>]</span>.<a href="#section-6.7.1.5-10" class="pilcrow">¶</a></p>
</section>
<div id="unknown-chunks">
<section id="section-6.7.1.6">
            <h5 id="name-unknown-chunks">
<a href="#section-6.7.1.6" class="section-number selfRef">6.7.1.6. </a><a href="#name-unknown-chunks" class="section-name selfRef">Unknown Chunks</a>
            </h5>
<p id="section-6.7.1.6-1">A RIFF chunk (described in <a href="#terminology-amp-basics" class="xref">Section 6.2</a>.) whose <em>chunk tag</em> is
               different from any of the chunks described in this document, is
               considered an <em>unknown chunk</em>.<a href="#section-6.7.1.6-1" class="pilcrow">¶</a></p>
<p id="section-6.7.1.6-2"><strong>Rationale:</strong> Allowing unknown chunks gives a
             provision for future extension of the format, and also allows
             storage of any application-specific data.<a href="#section-6.7.1.6-2" class="pilcrow">¶</a></p>
<p id="section-6.7.1.6-3">A file MAY contain unknown chunks:<a href="#section-6.7.1.6-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6.7.1.6-4.1">At the end of the file as described in <a href="#extended_header" class="xref">Section 6.7, Paragraph 9</a>.<a href="#section-6.7.1.6-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-6.7.1.6-4.2">At the end of ANMF chunks as described in <a href="#animation" class="xref">Section 6.7.1.1</a>.<a href="#section-6.7.1.6-4.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-6.7.1.6-5">Readers SHOULD ignore these chunks. Writers SHOULD preserve them
             in their original order (unless they specifically intend to modify
             these chunks).<a href="#section-6.7.1.6-5" class="pilcrow">¶</a></p>
</section>
</div>
</section>
<section id="section-6.7.2">
          <h4 id="name-assembling-the-canvas-from-">
<a href="#section-6.7.2" class="section-number selfRef">6.7.2. </a><a href="#name-assembling-the-canvas-from-" class="section-name selfRef">Assembling the Canvas from frames</a>
          </h4>
<p id="section-6.7.2-1">Here we provide an overview of how a reader should assemble a
           canvas in the case of an animated image. The notation
           <em>VP8X.field</em> means the field in the 'VP8X' chunk with the same
           description.<a href="#section-6.7.2-1" class="pilcrow">¶</a></p>
<p id="section-6.7.2-2">Displaying an <em>animated image</em> canvas MUST be equivalent to
           the following pseudocode:<a href="#section-6.7.2-2" class="pilcrow">¶</a></p>
<div id="section-6.7.2-3">
<pre class="sourcecode">
assert VP8X.flags.hasAnimation
canvas &lt;- new image of size VP8X.canvasWidth x VP8X.canvasHeight with
          background color ANIM.background_color.
loop_count &lt;- ANIM.loopCount
dispose_method &lt;- ANIM.disposeMethod
if loop_count == 0:
    loop_count = inf
frame_params &lt;- nil
assert next chunk in image_data is ANMF
for loop = 0..loop_count - 1
    clear canvas to ANIM.background_color or application defined color
    until eof or non-ANMF chunk
        frame_params.frameX = Frame X
        frame_params.frameY = Frame Y
        frame_params.frameWidth = Frame Width Minus One + 1
        frame_params.frameHeight = Frame Height Minus One + 1
        frame_params.frameDuration = Frame Duration
        frame_right = frame_params.frameX + frame_params.frameWidth
        frame_bottom = frame_params.frameY + frame_params.frameHeight
        assert VP8X.canvasWidth &gt;= frame_right
        assert VP8X.canvasHeight &gt;= frame_bottom
        for subchunk in 'Frame Data':
            if subchunk.tag == "ALPH":
                assert alpha subchunks not found in 'Frame Data' earlier
                frame_params.alpha = alpha_data
            else if subchunk.tag == "VP8 " OR subchunk.tag == "VP8L":
                assert bitstream subchunks not found in 'Frame Data' earlier
                frame_params.bitstream = bitstream_data
        render frame with frame_params.alpha and frame_params.bitstream on
            canvas with top-left corner at (frame_params.frameX,
            frame_params.frameY), using dispose method dispose_method.
        canvas contains the decoded image.
        Show the contents of the canvas for frame_params.frameDuration * 1ms.
</pre><a href="#section-6.7.2-3" class="pilcrow">¶</a>
</div>
</section>
<section id="section-6.7.3">
          <h4 id="name-example-file-layouts">
<a href="#section-6.7.3" class="section-number selfRef">6.7.3. </a><a href="#name-example-file-layouts" class="section-name selfRef">Example File Layouts</a>
          </h4>
<p id="section-6.7.3-1">A lossy encoded image with alpha may look as follows:<a href="#section-6.7.3-1" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7.3-2">
<pre>
RIFF/WEBP
+- VP8X (descriptions of features used)
+- ALPH (alpha bitstream)
+- VP8 (bitstream)
</pre><a href="#section-6.7.3-2" class="pilcrow">¶</a>
</div>
<p id="section-6.7.3-3">A losslessly encoded image may look as follows:<a href="#section-6.7.3-3" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7.3-4">
<pre>
RIFF/WEBP
+- VP8X (descriptions of features used)
+- XYZW (unknown chunk)
+- VP8L (lossless bitstream)
</pre><a href="#section-6.7.3-4" class="pilcrow">¶</a>
</div>
<p id="section-6.7.3-5">A lossless image with ICC profile and XMP metadata may look as
             follows:<a href="#section-6.7.3-5" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7.3-6">
<pre>
RIFF/WEBP
+- VP8X (descriptions of features used)
+- ICCP (color profile)
+- VP8L (lossless bitstream)
+- XMP  (metadata)
</pre><a href="#section-6.7.3-6" class="pilcrow">¶</a>
</div>
<p id="section-6.7.3-7">An animated image with Exif metadata may look as follows:<a href="#section-6.7.3-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-text artwork" id="section-6.7.3-8">
<pre>
RIFF/WEBP
+- VP8X (descriptions of features used)
+- ANIM (global animation parameters)
+- ANMF (frame1 parameters + data)
+- ANMF (frame2 parameters + data)
+- ANMF (frame3 parameters + data)
+- ANMF (frame4 parameters + data)
+- EXIF (metadata)
</pre><a href="#section-6.7.3-8" class="pilcrow">¶</a>
</div>
</section>
</section>
</section>
</div>
<div id="webp-lossless">
<section id="section-7">
      <h2 id="name-specification-for-webp-loss">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-specification-for-webp-loss" class="section-name selfRef">Specification for WebP Lossless Bitstream</a>
      </h2>
<p id="section-7-1">Note this section is based on the documentation in the <span><a href="#webp-lossless-src" class="xref">libwebp source repository</a> [<a href="#webp-lossless-src" class="xref">webp-lossless-src</a>]</span> at the time
         of writing.<a href="#section-7-1" class="pilcrow">¶</a></p>
<section id="section-7.1">
        <h3 id="name-abstract">
<a href="#section-7.1" class="section-number selfRef">7.1. </a><a href="#name-abstract" class="section-name selfRef">Abstract</a>
        </h3>
<p id="section-7.1-1">WebP lossless is an image format for lossless compression of ARGB
         images. The lossless format stores and restores the pixel values
         exactly, including the color values for zero alpha pixels. The format
         uses subresolution images, recursively embedded into the format
         itself, for storing statistical data about the images, such as the
         used entropy codes, spatial predictors, color space conversion, and
         color table. LZ77, Huffman coding, and a color cache are used for
         compression of the bulk data. Decoding speeds faster than PNG have
         been demonstrated, as well as 25% denser compression than can be
         achieved using today's PNG format.<a href="#section-7.1-1" class="pilcrow">¶</a></p>
</section>
<section id="section-7.2">
        <h3 id="name-nomenclature">
<a href="#section-7.2" class="section-number selfRef">7.2. </a><a href="#name-nomenclature" class="section-name selfRef">Nomenclature</a>
        </h3>
<span class="break"></span><dl class="dlNewline" id="section-7.2-1">
          <dt id="section-7.2-1.1">ARGB</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.2">A pixel value consisting of alpha, red, green, and blue
           values.<a href="#section-7.2-1.2" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.3">ARGB image</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.4">A two-dimensional array containing ARGB pixels.<a href="#section-7.2-1.4" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.5">color cache</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.6">A small hash-addressed array to store recently used colors, to be
           able to recall them with shorter codes.<a href="#section-7.2-1.6" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.7">color indexing image</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.8">A one-dimensional image of colors that can be indexed using a
           small integer (up to 256 within WebP lossless).<a href="#section-7.2-1.8" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.9">color transform image</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.10">A two-dimensional subresolution image containing data about
           correlations of color components.<a href="#section-7.2-1.10" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.11">distance mapping</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.12">Changes LZ77 distances to have the smallest values for pixels in
           2D proximity.<a href="#section-7.2-1.12" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.13">entropy image</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.14">A two-dimensional subresolution image indicating which entropy
           coding should be used in a respective square in the image, i.e.,
           each pixel is a meta Huffman code.<a href="#section-7.2-1.14" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.15">Huffman code</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.16">A classic way to do entropy coding where a smaller number of bits
           are used for more frequent codes.<a href="#section-7.2-1.16" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.17">LZ77</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.18">Dictionary-based sliding window compression algorithm that either
           emits symbols or describes them as sequences of past symbols.<a href="#section-7.2-1.18" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.19">meta Huffman code</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.20">A small integer (up to 16 bits) that indexes an element in the
           meta Huffman table.<a href="#section-7.2-1.20" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.21">predictor image</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.22">A two-dimensional subresolution image indicating which spatial
           predictor is used for a particular square in the image.<a href="#section-7.2-1.22" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.23">prefix coding</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.24">A way to entropy code larger integers that codes a few bits of the
           integer using an entropy code and codifies the remaining bits raw.
           This allows for the descriptions of the entropy codes to remain
           relatively small even when the range of symbols is large.<a href="#section-7.2-1.24" class="pilcrow">¶</a>
</dd>
          <dd class="break"></dd>
<dt id="section-7.2-1.25">scan-line order</dt>
          <dd style="margin-left: 4.0em" id="section-7.2-1.26">A processing order of pixels, left-to-right, top-to-bottom,
           starting from the left-hand-top pixel, proceeding to the right. Once
           a row is completed, continue from the left-hand column of the next
           row.<a href="#section-7.2-1.26" class="pilcrow">¶</a>
</dd>
        <dd class="break"></dd>
</dl>
</section>
<section id="section-7.3">
        <h3 id="name-introduction-3">
<a href="#section-7.3" class="section-number selfRef">7.3. </a><a href="#name-introduction-3" class="section-name selfRef">Introduction</a>
        </h3>
<p id="section-7.3-1">This document describes the compressed data representation of a WebP
         lossless image. It is intended as a detailed reference for WebP
         lossless encoder and decoder implementation.<a href="#section-7.3-1" class="pilcrow">¶</a></p>
<p id="section-7.3-2">In this document, we extensively use C programming language syntax to
         describe the bitstream, and assume the existence of a function for
         reading bits, <code>ReadBits(n)</code>. The bytes are read in the natural
           order of the stream containing them, and bits of each byte are read
           in least-significant-bit-first order. When multiple bits are read at
           the same time, the integer is constructed from the original data in
           the original order. The most significant bits of the returned
           integer are also the most significant bits of the original data.
           Thus the statement<a href="#section-7.3-2" class="pilcrow">¶</a></p>
<div id="section-7.3-3">
<pre class="sourcecode">
b = ReadBits(2);
</pre><a href="#section-7.3-3" class="pilcrow">¶</a>
</div>
<p id="section-7.3-4">is equivalent with the two statements below:<a href="#section-7.3-4" class="pilcrow">¶</a></p>
<div id="section-7.3-5">
<pre class="sourcecode">
b = ReadBits(1);
b |= ReadBits(1) &lt;&lt; 1;
</pre><a href="#section-7.3-5" class="pilcrow">¶</a>
</div>
<p id="section-7.3-6">We assume that each color component (e.g. alpha, red, blue and
         green) is represented using an 8-bit byte. We define the corresponding
         type as uint8. A whole ARGB pixel is represented by a type called
         uint32, an unsigned integer consisting of 32 bits. In the code showing
         the behavior of the transformations, alpha value is codified in bits
         31..24, red in bits 23..16, green in bits 15..8 and blue in bits 7..0,
         but implementations of the format are free to use another
         representation internally.<a href="#section-7.3-6" class="pilcrow">¶</a></p>
<p id="section-7.3-7">Broadly, a WebP lossless image contains header data, transform
         information and actual image data. Headers contain width and height of
         the image. A WebP lossless image can go through four different types
         of transformation before being entropy encoded. The transform
         information in the bitstream contains the data required to apply the
         respective inverse transforms.<a href="#section-7.3-7" class="pilcrow">¶</a></p>
</section>
<section id="section-7.4">
        <h3 id="name-riff-header">
<a href="#section-7.4" class="section-number selfRef">7.4. </a><a href="#name-riff-header" class="section-name selfRef">RIFF Header</a>
        </h3>
<p id="section-7.4-1">The beginning of the header has the RIFF container. This consists of
         the following 21 bytes:<a href="#section-7.4-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.4-2">
         <li id="section-7.4-2.1">String "RIFF"<a href="#section-7.4-2.1" class="pilcrow">¶</a>
</li>
          <li id="section-7.4-2.2">A little-endian 32 bit value of the block length, the whole size
           of the block controlled by the RIFF header. Normally this equals the
           payload size (file size minus 8 bytes: 4 bytes for the 'RIFF'
           identifier and 4 bytes for storing the value itself).<a href="#section-7.4-2.2" class="pilcrow">¶</a>
</li>
          <li id="section-7.4-2.3">String "WEBP" (RIFF container name).<a href="#section-7.4-2.3" class="pilcrow">¶</a>
</li>
          <li id="section-7.4-2.4">String "VP8L" (chunk tag for lossless encoded image data).<a href="#section-7.4-2.4" class="pilcrow">¶</a>
</li>
          <li id="section-7.4-2.5">A little-endian 32-bit value of the number of bytes in the
           lossless stream.<a href="#section-7.4-2.5" class="pilcrow">¶</a>
</li>
          <li id="section-7.4-2.6">One byte signature 0x2f.<a href="#section-7.4-2.6" class="pilcrow">¶</a>
</li>
        </ol>
<p id="section-7.4-3">The first 28 bits of the bitstream specify the width and height of
         the image. Width and height are decoded as 14-bit integers as
         follows:<a href="#section-7.4-3" class="pilcrow">¶</a></p>
<div id="section-7.4-4">
<pre class="sourcecode">
int image_width = ReadBits(14) + 1;
int image_height = ReadBits(14) + 1;
</pre><a href="#section-7.4-4" class="pilcrow">¶</a>
</div>
<p id="section-7.4-5">The 14-bit dynamics for image size limit the maximum size of a WebP
         lossless image to 16384x16384 pixels.<a href="#section-7.4-5" class="pilcrow">¶</a></p>
<p id="section-7.4-6">The alpha_is_used bit is a hint only, and should not impact
         decoding. It should be set to 0 when all alpha values are 255 in the
         picture, and 1 otherwise.<a href="#section-7.4-6" class="pilcrow">¶</a></p>
<div id="section-7.4-7">
<pre class="sourcecode">
int alpha_is_used = ReadBits(1);
</pre><a href="#section-7.4-7" class="pilcrow">¶</a>
</div>
<p id="section-7.4-8">The version_number is a 3 bit code that must be set to 0. Any other
         value should be treated as an error.<a href="#section-7.4-8" class="pilcrow">¶</a></p>
<div id="section-7.4-9">
<pre class="sourcecode">
int version_number = ReadBits(3);
</pre><a href="#section-7.4-9" class="pilcrow">¶</a>
</div>
</section>
<section id="section-7.5">
        <h3 id="name-transformations">
<a href="#section-7.5" class="section-number selfRef">7.5. </a><a href="#name-transformations" class="section-name selfRef">Transformations</a>
        </h3>
<p id="section-7.5-1">Transformations are reversible manipulations of the image data that
         can reduce the remaining symbolic entropy by modeling spatial and
         color correlations. Transformations can make the final compression
         more dense.<a href="#section-7.5-1" class="pilcrow">¶</a></p>
<p id="section-7.5-2">An image can go through four types of transformation. A 1 bit
         indicates the presence of a transform. Each transform is allowed to be
         used only once. The transformations are used only for the main level
         ARGB image: the subresolution images have no transforms, not even the
         0 bit indicating the end-of-transforms.<a href="#section-7.5-2" class="pilcrow">¶</a></p>
<p id="section-7.5-3">Typically an encoder would use these transforms to reduce the Shannon
         entropy in the residual image. Also, the transform data can be decided
         based on entropy minimization.<a href="#section-7.5-3" class="pilcrow">¶</a></p>
<div id="section-7.5-4">
<pre class="sourcecode">
while (ReadBits(1)) {  // Transform present.
  // Decode transform type.
  enum TransformType transform_type = ReadBits(2);
  // Decode transform data.
  ...
}

// Decode actual image data.
</pre><a href="#section-7.5-4" class="pilcrow">¶</a>
</div>
<p id="section-7.5-5">If a transform is present then the next two bits specify the
         transform type. There are four types of transforms.<a href="#section-7.5-5" class="pilcrow">¶</a></p>
<div id="section-7.5-6">
<pre class="sourcecode">
enum TransformType {
  PREDICTOR_TRANSFORM             = 0,
  COLOR_TRANSFORM                 = 1,
  SUBTRACT_GREEN                  = 2,
  COLOR_INDEXING_TRANSFORM        = 3,
};
</pre><a href="#section-7.5-6" class="pilcrow">¶</a>
</div>
<p id="section-7.5-7">The transform type is followed by the transform data. Transform data
         contains the information required to apply the inverse transform and
         depends on the transform type. Next we describe the transform data for
         different types.<a href="#section-7.5-7" class="pilcrow">¶</a></p>
<div id="predictor-transform">
<section id="section-7.5.1">
          <h4 id="name-predictor-transform">
<a href="#section-7.5.1" class="section-number selfRef">7.5.1. </a><a href="#name-predictor-transform" class="section-name selfRef">Predictor Transform</a>
          </h4>
<p id="section-7.5.1-1">The predictor transform can be used to reduce entropy by exploiting
           the fact that neighboring pixels are often correlated. In the
           predictor transform, the current pixel value is predicted from the
           pixels already decoded (in scan-line order) and only the residual
           value (actual - predicted) is encoded. The <em>prediction mode</em>
           determines the type of prediction to use. We divide the image into
           squares and all the pixels in a square use same prediction mode.<a href="#section-7.5.1-1" class="pilcrow">¶</a></p>
<p id="section-7.5.1-2">The first 3 bits of prediction data define the block width and
           height in number of bits. The number of block columns,
           <code>block_xsize</code>, is used in indexing two-dimensionally.<a href="#section-7.5.1-2" class="pilcrow">¶</a></p>
<div id="section-7.5.1-3">
<pre class="sourcecode">
int size_bits = ReadBits(3) + 2;
int block_width = (1 &lt;&lt; size_bits);
int block_height = (1 &lt;&lt; size_bits);
#define DIV_ROUND_UP(num, den) ((num) + (den) - 1) / (den))
int block_xsize = DIV_ROUND_UP(image_width, 1 &lt;&lt; size_bits);
</pre><a href="#section-7.5.1-3" class="pilcrow">¶</a>
</div>
<p id="section-7.5.1-4">The transform data contains the prediction mode for each block of
           the image. All the <code>block_width * block_height</code> pixels of a
             block use same prediction mode. The prediction modes are treated
             as pixels of an image and encoded using the same techniques
             described in <a href="#image-data" class="xref">Section 7.6</a>.<a href="#section-7.5.1-4" class="pilcrow">¶</a></p>
<p id="section-7.5.1-5">For a pixel <em>x, y</em>, one can compute the respective filter
           block address by:<a href="#section-7.5.1-5" class="pilcrow">¶</a></p>
<div id="section-7.5.1-6">
<pre class="sourcecode">
int block_index = (y &gt;&gt; size_bits) * block_xsize +
                  (x &gt;&gt; size_bits);
</pre><a href="#section-7.5.1-6" class="pilcrow">¶</a>
</div>
<p id="section-7.5.1-7">There are 14 different prediction modes. In each prediction mode,
           the current pixel value is predicted from one or more neighboring
           pixels whose values are already known.<a href="#section-7.5.1-7" class="pilcrow">¶</a></p>
<p id="section-7.5.1-8">We choose the neighboring pixels (TL, T, TR, and L) of the current
           pixel (P) as follows:<a href="#section-7.5.1-8" class="pilcrow">¶</a></p>
<div class="alignLeft art-ascii-art art-text artwork" id="section-7.5.1-9">
<pre>
O    O    O    O    O    O    O    O    O    O    O
O    O    O    O    O    O    O    O    O    O    O
O    O    O    O    TL   T    TR   O    O    O    O
O    O    O    O    L    P    X    X    X    X    X
X    X    X    X    X    X    X    X    X    X    X
X    X    X    X    X    X    X    X    X    X    X
</pre><a href="#section-7.5.1-9" class="pilcrow">¶</a>
</div>
<p id="section-7.5.1-10">where TL means top-left, T top, TR top-right, L left pixel. At the
           time of predicting a value for P, all pixels O, TL, T, TR and L have
           been already processed, and pixel P and all pixels X are
           unknown.<a href="#section-7.5.1-10" class="pilcrow">¶</a></p>
<p id="section-7.5.1-11">Given the above neighboring pixels, the different prediction modes
           are defined as follows.<a href="#section-7.5.1-11" class="pilcrow">¶</a></p>
<div class="alignLeft art-ascii-art art-text artwork" id="section-7.5.1-12">
<pre>
| Mode   | Predicted value of each channel of the current pixel    |
| ------ | ------------------------------------------------------- |
|  0     | 0xff000000 (represents solid black color in ARGB)       |
|  1     | L                                                       |
|  2     | T                                                       |
|  3     | TR                                                      |
|  4     | TL                                                      |
|  5     | Average2(Average2(L, TR), T)                            |
|  6     | Average2(L, TL)                                         |
|  7     | Average2(L, T)                                          |
|  8     | Average2(TL, T)                                         |
|  9     | Average2(T, TR)                                         |
| 10     | Average2(Average2(L, TL), Average2(T, TR))              |
| 11     | Select(L, T, TL)                                        |
| 12     | ClampAddSubtractFull(L, T, TL)                          |
| 13     | ClampAddSubtractHalf(Average2(L, T), TL)                |
</pre><a href="#section-7.5.1-12" class="pilcrow">¶</a>
</div>
<p id="section-7.5.1-13"><code>Average2</code> is defined as follows for each ARGB
           component:<a href="#section-7.5.1-13" class="pilcrow">¶</a></p>
<div id="section-7.5.1-14">
<pre class="sourcecode">
uint8 Average2(uint8 a, uint8 b) {
  return (a + b) / 2;
}
</pre><a href="#section-7.5.1-14" class="pilcrow">¶</a>
</div>
<p id="section-7.5.1-15">The Select predictor is defined as follows:<a href="#section-7.5.1-15" class="pilcrow">¶</a></p>
<div id="section-7.5.1-16">
<pre class="sourcecode">
uint32 Select(uint32 L, uint32 T, uint32 TL) {
  // L = left pixel, T = top pixel, TL = top left pixel.

  // ARGB component estimates for prediction.
  int pAlpha = ALPHA(L) + ALPHA(T) - ALPHA(TL);
  int pRed = RED(L) + RED(T) - RED(TL);
  int pGreen = GREEN(L) + GREEN(T) - GREEN(TL);
  int pBlue = BLUE(L) + BLUE(T) - BLUE(TL);

  // Manhattan distances to estimates for left and top pixels.
  int pL = abs(pAlpha - ALPHA(L)) + abs(pRed - RED(L)) +
           abs(pGreen - GREEN(L)) + abs(pBlue - BLUE(L));
  int pT = abs(pAlpha - ALPHA(T)) + abs(pRed - RED(T)) +
           abs(pGreen - GREEN(T)) + abs(pBlue - BLUE(T));

  // Return either left or top, the one closer to the prediction.
  if (pL &lt; pT) {
    return L;
  } else {
    return T;
  }
}
</pre><a href="#section-7.5.1-16" class="pilcrow">¶</a>
</div>
<p id="section-7.5.1-17">The functions <code>ClampAddSubtractFull</code> and
           <code>ClampAddSubtractHalf</code> are performed for each ARGB component
           as follows:<a href="#section-7.5.1-17" class="pilcrow">¶</a></p>
<div id="section-7.5.1-18">
<pre class="sourcecode">
// Clamp the input value between 0 and 255.
int Clamp(int a) {
  return (a &lt; 0) ? 0 : (a &gt; 255) ?  255 : a;
}

int ClampAddSubtractFull(int a, int b, int c) {
  return Clamp(a + b - c);
}

int ClampAddSubtractHalf(int a, int b) {
  return Clamp(a + (a - b) / 2);
}
</pre><a href="#section-7.5.1-18" class="pilcrow">¶</a>
</div>
<p id="section-7.5.1-19">There are special handling rules for some border pixels. If there
           is a prediction transform, regardless of the mode [0..13] for these
           pixels, the predicted value for the left-topmost pixel of the image
           is 0xff000000, L-pixel for all pixels on the top row, and T-pixel
           for all pixels on the leftmost column.<a href="#section-7.5.1-19" class="pilcrow">¶</a></p>
<p id="section-7.5.1-20">Addressing the TR-pixel for pixels on the rightmost column is
           exceptional. The pixels on the rightmost column are predicted by
           using the modes [0..13] just like pixels not on border, but by using
           the leftmost pixel on the same row as the current TR-pixel. The
           TR-pixel offset in memory is the same for border and non-border
           pixels.<a href="#section-7.5.1-20" class="pilcrow">¶</a></p>
</section>
</div>
<div id="color-transform">
<section id="section-7.5.2">
          <h4 id="name-color-transform">
<a href="#section-7.5.2" class="section-number selfRef">7.5.2. </a><a href="#name-color-transform" class="section-name selfRef">Color Transform</a>
          </h4>
<p id="section-7.5.2-1">The goal of the color transform is to decorrelate the R, G and B
           values of each pixel. Color transform keeps the green (G) value as
           it is, transforms red (R) based on green and transforms blue (B)
           based on green and then based on red.<a href="#section-7.5.2-1" class="pilcrow">¶</a></p>
<p id="section-7.5.2-2">As is the case for the predictor transform, first the image is
           divided into blocks and the same transform mode is used for all the
           pixels in a block. For each block there are three types of color
           transform elements.<a href="#section-7.5.2-2" class="pilcrow">¶</a></p>
<div id="section-7.5.2-3">
<pre class="sourcecode">
typedef struct {
  uint8 green_to_red;
  uint8 green_to_blue;
  uint8 red_to_blue;
} ColorTransformElement;
</pre><a href="#section-7.5.2-3" class="pilcrow">¶</a>
</div>
<p id="section-7.5.2-4">The actual color transformation is done by defining a color
           transform delta. The color transform delta depends on the
           <code>ColorTransformElement</code>, which is the same for all the pixels
           in a particular block. The delta is added during color transform.
           The inverse color transform then is just subtracting those
           deltas.<a href="#section-7.5.2-4" class="pilcrow">¶</a></p>
<p id="section-7.5.2-5">The color transform function is defined as follows:<a href="#section-7.5.2-5" class="pilcrow">¶</a></p>
<div id="section-7.5.2-6">
<pre class="sourcecode">
void ColorTransform(uint8 red, uint8 blue, uint8 green,
                    ColorTransformElement *trans,
                    uint8 *new_red, uint8 *new_blue) {
  // Transformed values of red and blue components
  uint32 tmp_red = red;
  uint32 tmp_blue = blue;

  // Applying transform is just adding the transform deltas
  tmp_red  += ColorTransformDelta(trans-&gt;green_to_red, green);
  tmp_blue += ColorTransformDelta(trans-&gt;green_to_blue, green);
  tmp_blue += ColorTransformDelta(trans-&gt;red_to_blue, red);

  *new_red = tmp_red &amp; 0xff;
  *new_blue = tmp_blue &amp; 0xff;
}
</pre><a href="#section-7.5.2-6" class="pilcrow">¶</a>
</div>
<p id="section-7.5.2-7"><code>ColorTransformDelta</code> is computed using a signed 8-bit
           integer representing a 3.5-fixed-point number, and a signed 8-bit
           RGB color channel (c) [-128..127] and is defined as follows:<a href="#section-7.5.2-7" class="pilcrow">¶</a></p>
<div id="section-7.5.2-8">
<pre class="sourcecode">
int8 ColorTransformDelta(int8 t, int8 c) {
  return (t * c) &gt;&gt; 5;
}
</pre><a href="#section-7.5.2-8" class="pilcrow">¶</a>
</div>
<p id="section-7.5.2-9">A conversion from the 8-bit unsigned representation
           (<code>uint8</code>) to the 8-bit signed one (<code>int8</code>) is required
             before calling ColorTransformDelta(). It should be performed using
             8-bit two's complement (that is: uint8 range [128-255] is mapped
             to the [-128, -1] range of its converted int8 value).<a href="#section-7.5.2-9" class="pilcrow">¶</a></p>
<p id="section-7.5.2-10">The multiplication is to be done using more precision (with at
           least 16-bit dynamics). The sign extension property of the shift
           operation does not matter here: only the lowest 8 bits are used from
           the result, and there the sign extension shifting and unsigned
           shifting are consistent with each other.<a href="#section-7.5.2-10" class="pilcrow">¶</a></p>
<p id="section-7.5.2-11">Now we describe the contents of color transform data so that
           decoding can apply the inverse color transform and recover the
           original red and blue values. The first 3 bits of the color
           transform data contain the width and height of the image block in
           number of bits, just like the predictor transform:<a href="#section-7.5.2-11" class="pilcrow">¶</a></p>
<div id="section-7.5.2-12">
<pre class="sourcecode">
int size_bits = ReadBits(3) + 2;
int block_width = 1 &lt;&lt; size_bits;
int block_height = 1 &lt;&lt; size_bits;
</pre><a href="#section-7.5.2-12" class="pilcrow">¶</a>
</div>
<p id="section-7.5.2-13">The remaining part of the color transform data contains
           <code>ColorTransformElement</code> instances corresponding to each block
           of the image. <code>ColorTransformElement</code> instances are treated
           as pixels of an image and encoded using the methods described in
           <a href="#image-data" class="xref">Section 7.6</a>.<a href="#section-7.5.2-13" class="pilcrow">¶</a></p>
<p id="section-7.5.2-14">During decoding, <code>ColorTransformElement</code> instances of the
           blocks are decoded and the inverse color transform is applied on the
           ARGB values of the pixels. As mentioned earlier, that inverse color
           transform is just subtracting <code>ColorTransformElement</code> values
             from the red and blue channels.<a href="#section-7.5.2-14" class="pilcrow">¶</a></p>
<div id="section-7.5.2-15">
<pre class="sourcecode">
void InverseTransform(uint8 red, uint8 green, uint8 blue,
                      ColorTransformElement *p,
                      uint8 *new_red, uint8 *new_blue) {
  // Applying inverse transform is just subtracting the
  // color transform deltas
  red  -= ColorTransformDelta(p-&gt;green_to_red_,  green);
  blue -= ColorTransformDelta(p-&gt;green_to_blue_, green);
  blue -= ColorTransformDelta(p-&gt;red_to_blue_, red &amp; 0xff);

  *new_red = red &amp; 0xff;
  *new_blue = blue &amp; 0xff;
}
</pre><a href="#section-7.5.2-15" class="pilcrow">¶</a>
</div>
</section>
</div>
<section id="section-7.5.3">
          <h4 id="name-subtract-green-transform">
<a href="#section-7.5.3" class="section-number selfRef">7.5.3. </a><a href="#name-subtract-green-transform" class="section-name selfRef">Subtract Green Transform</a>
          </h4>
<p id="section-7.5.3-1">The subtract green transform subtracts green values from red and
           blue values of each pixel. When this transform is present, the
           decoder needs to add the green value to both red and blue. There is
           no data associated with this transform. The decoder applies the
           inverse transform as follows:<a href="#section-7.5.3-1" class="pilcrow">¶</a></p>
<div id="section-7.5.3-2">
<pre class="sourcecode">
void AddGreenToBlueAndRed(uint8 green, uint8 *red, uint8 *blue) {
  *red  = (*red  + green) &amp; 0xff;
  *blue = (*blue + green) &amp; 0xff;
}
</pre><a href="#section-7.5.3-2" class="pilcrow">¶</a>
</div>
<p id="section-7.5.3-3">This transform is redundant as it can be modeled using the color
           transform, but it is still often useful. Since it can extend the
           dynamics of the color transform and there is no additional data
           here, the subtract green transform can be coded using fewer bits
           than a full-blown color transform.<a href="#section-7.5.3-3" class="pilcrow">¶</a></p>
</section>
<div id="color-indexing-transform">
<section id="section-7.5.4">
          <h4 id="name-color-indexing-transform">
<a href="#section-7.5.4" class="section-number selfRef">7.5.4. </a><a href="#name-color-indexing-transform" class="section-name selfRef">Color Indexing Transform</a>
          </h4>
<p id="section-7.5.4-1">If there are not many unique pixel values, it may be more efficient
           to create a color index array and replace the pixel values by the
           array's indices. The color indexing transform achieves this. (In the
           context of WebP lossless, we specifically do not call this a palette
           transform because a similar but more dynamic concept exists in WebP
           lossless encoding: color cache.)<a href="#section-7.5.4-1" class="pilcrow">¶</a></p>
<p id="section-7.5.4-2">The color indexing transform checks for the number of unique ARGB
           values in the image. If that number is below a threshold (256), it
           creates an array of those ARGB values, which is then used to replace
           the pixel values with the corresponding index: the green channel of
           the pixels are replaced with the index; all alpha values are set to
           255; all red and blue values to 0.<a href="#section-7.5.4-2" class="pilcrow">¶</a></p>
<p id="section-7.5.4-3">The transform data contains color table size and the entries in the
           color table. The decoder reads the color indexing transform data as
           follows:<a href="#section-7.5.4-3" class="pilcrow">¶</a></p>
<div id="section-7.5.4-4">
<pre class="sourcecode">
// 8 bit value for color table size
int color_table_size = ReadBits(8) + 1;
</pre><a href="#section-7.5.4-4" class="pilcrow">¶</a>
</div>
<p id="section-7.5.4-5">The color table is stored using the image storage format itself.
           The color table can be obtained by reading an image, without the
           RIFF header, image size, and transforms, assuming a height of one
           pixel and a width of <code>color_table_size</code>. The color table is
             always subtraction-coded to reduce image entropy. The deltas of
             palette colors contain typically much less entropy than the colors
             themselves, leading to significant savings for smaller images. In
             decoding, every final color in the color table can be obtained by
             adding the previous color component values by each ARGB component
             separately, and storing the least significant 8 bits of the
             result.<a href="#section-7.5.4-5" class="pilcrow">¶</a></p>
<p id="section-7.5.4-6">The inverse transform for the image is simply replacing the pixel
           values (which are indices to the color table) with the actual color
           table values. The indexing is done based on the green component of
           the ARGB color.<a href="#section-7.5.4-6" class="pilcrow">¶</a></p>
<div id="section-7.5.4-7">
<pre class="sourcecode">
// Inverse transform
argb = color_table[GREEN(argb)];
</pre><a href="#section-7.5.4-7" class="pilcrow">¶</a>
</div>
<p id="section-7.5.4-8">If the index is equal or larger than color_table_size, the argb
           color value should be set to 0x00000000 (transparent black).<a href="#section-7.5.4-8" class="pilcrow">¶</a></p>
<p id="section-7.5.4-9">When the color table is small (equal to or less than 16 colors),
           several pixels are bundled into a single pixel. The pixel bundling
           packs several (2, 4, or 8) pixels into a single pixel, reducing the
           image width respectively. Pixel bundling allows for a more efficient
           joint distribution entropy coding of neighboring pixels, and gives
           some arithmetic coding-like benefits to the entropy code, but it can
           only be used when there are a small number of unique values.<a href="#section-7.5.4-9" class="pilcrow">¶</a></p>
<p id="section-7.5.4-10"><code>color_table_size</code> specifies how many pixels are combined
           together:<a href="#section-7.5.4-10" class="pilcrow">¶</a></p>
<div id="section-7.5.4-11">
<pre class="sourcecode">
int width_bits;
if (color_table_size &lt;= 2) {
  width_bits = 3;
} else if (color_table_size &lt;= 4) {
  width_bits = 2;
} else if (color_table_size &lt;= 16) {
  width_bits = 1;
} else {
  width_bits = 0;
}
</pre><a href="#section-7.5.4-11" class="pilcrow">¶</a>
</div>
<p id="section-7.5.4-12"><code>width_bits</code> has a value of 0, 1, 2 or 3. A value of 0
           indicates no pixel bundling to be done for the image. A value of 1
           indicates that two pixels are combined together, and each pixel has
           a range of [0..15]. A value of 2 indicates that four pixels are
           combined together, and each pixel has a range of [0..3]. A value
           of 3 indicates that eight pixels are combined together and each
           pixel has a range of [0..1], i.e., a binary value.<a href="#section-7.5.4-12" class="pilcrow">¶</a></p>
<p id="section-7.5.4-13">The values are packed into the green component as follows:<a href="#section-7.5.4-13" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.5.4-14.1">
              <code>width_bits</code> = 1: for every x value where x = 2k + 0, a
             green value at x is positioned into the 4 least-significant bits
             of the green value at x / 2, a green value at x + 1 is positioned
             into the 4 most-significant bits of the green value at x / 2.<a href="#section-7.5.4-14.1" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.5.4-14.2">
              <code>width_bits</code> = 2: for every x value where x = 4k + 0, a
             green value at x is positioned into the 2 least-significant bits
             of the green value at x / 4, green values at x + 1 to x + 3 in
             order to the more significant bits of the green value at x /
             4.<a href="#section-7.5.4-14.2" class="pilcrow">¶</a>
</li>
            <li class="normal" id="section-7.5.4-14.3">
              <code>width_bits</code> = 3: for every x value where x = 8k + 0, a
             green value at x is positioned into the least-significant bit of
             the green value at x / 8, green values at x + 1 to x + 7 in order
             to the more significant bits of the green value at x / 8.<a href="#section-7.5.4-14.3" class="pilcrow">¶</a>
</li>
          </ul>
</section>
</div>
</section>
<div id="image-data">
<section id="section-7.6">
        <h3 id="name-image-data">
<a href="#section-7.6" class="section-number selfRef">7.6. </a><a href="#name-image-data" class="section-name selfRef">Image Data</a>
        </h3>
<p id="section-7.6-1">Image data is an array of pixel values in scan-line order.<a href="#section-7.6-1" class="pilcrow">¶</a></p>
<div id="roles-of-image-data">
<section id="section-7.6.1">
          <h4 id="name-roles-of-image-data">
<a href="#section-7.6.1" class="section-number selfRef">7.6.1. </a><a href="#name-roles-of-image-data" class="section-name selfRef">Roles of Image Data</a>
          </h4>
<p id="section-7.6.1-1">We use image data in five different roles:<a href="#section-7.6.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.6.1-2">
           <li id="section-7.6.1-2.1">ARGB image: Stores the actual pixels of the image.<a href="#section-7.6.1-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-7.6.1-2.2">Entropy image: Stores the <span><a href="#decoding-of-meta-huffman-codes" class="xref">meta Huffman codes</a> (<a href="#decoding-of-meta-huffman-codes" class="xref">Section 7.7.2.1</a>)</span>.
               The red and green components of a pixel define the meta Huffman
               code used in a particular block of the ARGB image.<a href="#section-7.6.1-2.2" class="pilcrow">¶</a>
</li>
            <li id="section-7.6.1-2.3">Predictor image: Stores the metadata for <span><a href="#predictor-transform" class="xref">Predictor Transform</a> (<a href="#predictor-transform" class="xref">Section 7.5.1</a>)</span>. The green
               component of a pixel defines which of the 14 predictors is used
               within a particular block of the ARGB image.<a href="#section-7.6.1-2.3" class="pilcrow">¶</a>
</li>
            <li id="section-7.6.1-2.4">Color transform image. It is created by
             <code>ColorTransformElement</code> values (defined in <span><a href="#color-transform" class="xref">Color Transform</a> (<a href="#color-transform" class="xref">Section 7.5.2</a>)</span> for different
               blocks of the image. Each <code>ColorTransformElement</code>
              <code>'cte'</code> is treated as a pixel whose alpha component is
               <code>255</code>, red component is <code>cte.red_to_blue</code>, green
                 component is <code>cte.green_to_blue</code> and blue component is
                 <code>cte.green_to_red</code>.<a href="#section-7.6.1-2.4" class="pilcrow">¶</a>
</li>
            <li id="section-7.6.1-2.5">Color indexing image: An array of of size
               <code>color_table_size</code> (up to 256 ARGB values) storing the
               metadata for the <span><a href="#color-indexing-transform" class="xref">Color
                 Indexing Transform</a> (<a href="#color-indexing-transform" class="xref">Section 7.5.4</a>)</span>. This is stored as an image of width
                 <code>color_table_size</code> and height <code>1</code>.<a href="#section-7.6.1-2.5" class="pilcrow">¶</a>
</li>
          </ol>
</section>
</div>
<section id="section-7.6.2">
          <h4 id="name-encoding-of-image-data">
<a href="#section-7.6.2" class="section-number selfRef">7.6.2. </a><a href="#name-encoding-of-image-data" class="section-name selfRef">Encoding of Image data</a>
          </h4>
<p id="section-7.6.2-1">The encoding of image data is independent of its role.<a href="#section-7.6.2-1" class="pilcrow">¶</a></p>
<p id="section-7.6.2-2">The image is first divided into a set of fixed-size blocks
           (typically 16x16 blocks). Each of these blocks are modeled using
           their own entropy codes. Also, several blocks may share the same
           entropy codes.<a href="#section-7.6.2-2" class="pilcrow">¶</a></p>
<p id="section-7.6.2-3"><strong>Rationale:</strong> Storing an entropy code incurs a cost.
           This cost can be minimized if statistically similar blocks share an
           entropy code, thereby storing that code only once. For example, an
           encoder can find similar blocks by clustering them using their
           statistical properties, or by repeatedly joining a pair of randomly
           selected clusters when it reduces the overall amount of bits needed
           to encode the image.<a href="#section-7.6.2-3" class="pilcrow">¶</a></p>
<p id="section-7.6.2-4">Each pixel is encoded using one of the three possible methods:<a href="#section-7.6.2-4" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.6.2-5">
           <li id="section-7.6.2-5.1">Huffman coded literal: each channel (green, red, blue and alpha)
             is entropy-coded independently;<a href="#section-7.6.2-5.1" class="pilcrow">¶</a>
</li>
            <li id="section-7.6.2-5.2">LZ77 backward reference: a sequence of pixels are copied from
             elsewhere in the image; or<a href="#section-7.6.2-5.2" class="pilcrow">¶</a>
</li>
            <li id="section-7.6.2-5.3">Color cache code: using a short multiplicative hash code (color
             cache index) of a recently seen color.<a href="#section-7.6.2-5.3" class="pilcrow">¶</a>
</li>
          </ol>
<p id="section-7.6.2-6">The following sub-sections describe each of these in detail.<a href="#section-7.6.2-6" class="pilcrow">¶</a></p>
<div id="huffman-coded-literals">
<section id="section-7.6.2.1">
            <h5 id="name-huffman-coded-literals">
<a href="#section-7.6.2.1" class="section-number selfRef">7.6.2.1. </a><a href="#name-huffman-coded-literals" class="section-name selfRef">Huffman Coded Literals</a>
            </h5>
<p id="section-7.6.2.1-1">The pixel is stored as Huffman coded values of green, red, blue
             and alpha (in that order). See <a href="#decoding-entropy-coded-image-data" class="xref">Section 7.7.2.2</a> for details.<a href="#section-7.6.2.1-1" class="pilcrow">¶</a></p>
</section>
</div>
<div id="lz77-backward-reference">
<section id="section-7.6.2.2">
            <h5 id="name-lz77-backward-reference">
<a href="#section-7.6.2.2" class="section-number selfRef">7.6.2.2. </a><a href="#name-lz77-backward-reference" class="section-name selfRef">LZ77 Backward Reference</a>
            </h5>
<p id="section-7.6.2.2-1">Backward references are tuples of <em>length</em> and
            <em>distance code</em>:<a href="#section-7.6.2.2-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.6.2.2-2.1">Length indicates how many pixels in scan-line order are to be
               copied.<a href="#section-7.6.2.2-2.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.6.2.2-2.2">Distance code is a number indicating the position of a
               previously seen pixel, from which the pixels are to be copied.
               The exact mapping is described <span><a href="#distance-mapping" class="xref">below</a> (<a href="#distance-mapping" class="xref">Section 7.6.2.2, Paragraph 11</a>)</span>.<a href="#section-7.6.2.2-2.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-7.6.2.2-3">The length and distance values are stored using <strong>LZ77
             prefix coding</strong>.<a href="#section-7.6.2.2-3" class="pilcrow">¶</a></p>
<p id="section-7.6.2.2-4">LZ77 prefix coding divides large integer values into two parts:
             the <em>prefix code</em> and the <em>extra bits</em>: the prefix
               code is stored using an entropy code, while the extra bits are
               stored as they are (without an entropy code).<a href="#section-7.6.2.2-4" class="pilcrow">¶</a></p>
<p id="section-7.6.2.2-5"><strong>Rationale:</strong> This approach reduces the storage
             requirement for the entropy code. Also, large values are usually
             rare, and so extra bits would be used for very few values in the
             image. Thus, this approach results in a better compression
             overall.<a href="#section-7.6.2.2-5" class="pilcrow">¶</a></p>
<p id="section-7.6.2.2-6">The following table denotes the prefix codes and extra bits used
             for storing different range of values.<a href="#section-7.6.2.2-6" class="pilcrow">¶</a></p>
<p id="section-7.6.2.2-7">Note: The maximum backward reference length is limited to 4096.
             Hence, only the first 24 prefix codes (with the respective extra
             bits) are meaningful for length values. For distance values,
             however, all the 40 prefix codes are valid.<a href="#section-7.6.2.2-7" class="pilcrow">¶</a></p>
<div class="alignLeft art-ascii-art art-text artwork" id="section-7.6.2.2-8">
<pre>
| Value range     | Prefix code | Extra bits |
| --------------- | ----------- | ---------- |
| 1               | 0           | 0          |
| 2               | 1           | 0          |
| 3               | 2           | 0          |
| 4               | 3           | 0          |
| 5..6            | 4           | 1          |
| 7..8            | 5           | 1          |
| 9..12           | 6           | 2          |
| 13..16          | 7           | 2          |
| ...             | ...         | ...        |
| 3072..4096      | 23          | 10         |
| ...             | ...         | ...        |
| 524289..786432  | 38          | 18         |
| 786433..1048576 | 39          | 18         |
</pre><a href="#section-7.6.2.2-8" class="pilcrow">¶</a>
</div>
<p id="section-7.6.2.2-9">The pseudocode to obtain a (length or distance) value from the
             prefix code is as follows:<a href="#section-7.6.2.2-9" class="pilcrow">¶</a></p>
<div id="section-7.6.2.2-10">
<pre class="sourcecode">
if (prefix_code &lt; 4) {
  return prefix_code + 1;
}
int extra_bits = (prefix_code - 2) &gt;&gt; 1;
int offset = (2 + (prefix_code &amp; 1)) &lt;&lt; extra_bits;
return offset + ReadBits(extra_bits) + 1;
</pre><a href="#section-7.6.2.2-10" class="pilcrow">¶</a>
</div>
<div id="distance-mapping">
<p id="section-7.6.2.2-11"><strong>Distance Mapping:</strong><a href="#section-7.6.2.2-11" class="pilcrow">¶</a></p>
</div>
<p id="section-7.6.2.2-12">As noted previously, distance code is a number indicating the
             position of a previously seen pixel, from which the pixels are to
             be copied. This sub-section defines the mapping between a distance
             code and the position of a previous pixel.<a href="#section-7.6.2.2-12" class="pilcrow">¶</a></p>
<p id="section-7.6.2.2-13">The distance codes larger than 120 denote the pixel-distance in
             scan-line order, offset by 120.<a href="#section-7.6.2.2-13" class="pilcrow">¶</a></p>
<p id="section-7.6.2.2-14">The smallest distance codes [1..120] are special, and are
             reserved for a close neighborhood of the current pixel. This
             neighborhood consists of 120 pixels:<a href="#section-7.6.2.2-14" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.6.2.2-15.1">Pixels that are 1 to 7 rows above the current pixel, and are
               up to 8 columns to the left or up to 7 columns to the right of
               the current pixel. [Total such pixels = <code>7 * (8 + 1 + 7) =
               112</code>].<a href="#section-7.6.2.2-15.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.6.2.2-15.2">Pixels that are in same row as the current pixel, and are up
               to 8 columns to the left of the current pixel. [<code>8</code> such
               pixels].<a href="#section-7.6.2.2-15.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-7.6.2.2-16">The mapping between distance code <code>i</code> and the neighboring
             pixel offset <code>(xi, yi)</code> is as follows:<a href="#section-7.6.2.2-16" class="pilcrow">¶</a></p>
<div class="alignLeft art-ascii-art art-text artwork" id="section-7.6.2.2-17">
<pre>
(0, 1),  (1, 0),  (1, 1),  (-1, 1), (0, 2),  (2, 0),  (1, 2),  (-1, 2),
(2, 1),  (-2, 1), (2, 2),  (-2, 2), (0, 3),  (3, 0),  (1, 3),  (-1, 3),
(3, 1),  (-3, 1), (2, 3),  (-2, 3), (3, 2),  (-3, 2), (0, 4),  (4, 0),
(1, 4),  (-1, 4), (4, 1),  (-4, 1), (3, 3),  (-3, 3), (2, 4),  (-2, 4),
(4, 2),  (-4, 2), (0, 5),  (3, 4),  (-3, 4), (4, 3),  (-4, 3), (5, 0),
(1, 5),  (-1, 5), (5, 1),  (-5, 1), (2, 5),  (-2, 5), (5, 2),  (-5, 2),
(4, 4),  (-4, 4), (3, 5),  (-3, 5), (5, 3),  (-5, 3), (0, 6),  (6, 0),
(1, 6),  (-1, 6), (6, 1),  (-6, 1), (2, 6),  (-2, 6), (6, 2),  (-6, 2),
(4, 5),  (-4, 5), (5, 4),  (-5, 4), (3, 6),  (-3, 6), (6, 3),  (-6, 3),
(0, 7),  (7, 0),  (1, 7),  (-1, 7), (5, 5),  (-5, 5), (7, 1),  (-7, 1),
(4, 6),  (-4, 6), (6, 4),  (-6, 4), (2, 7),  (-2, 7), (7, 2),  (-7, 2),
(3, 7),  (-3, 7), (7, 3),  (-7, 3), (5, 6),  (-5, 6), (6, 5),  (-6, 5),
(8, 0),  (4, 7),  (-4, 7), (7, 4),  (-7, 4), (8, 1),  (8, 2),  (6, 6),
(-6, 6), (8, 3),  (5, 7),  (-5, 7), (7, 5),  (-7, 5), (8, 4),  (6, 7),
(-6, 7), (7, 6),  (-7, 6), (8, 5),  (7, 7),  (-7, 7), (8, 6),  (8, 7)
</pre><a href="#section-7.6.2.2-17" class="pilcrow">¶</a>
</div>
<p id="section-7.6.2.2-18">For example, distance code <code>1</code> indicates offset of <code>(0,
             1)</code> for the neighboring pixel, that is, the pixel above the
               current pixel (0-pixel difference in X-direction and 1 pixel
               difference in Y-direction). Similarly, distance code <code>3</code>
                 indicates left-top pixel.<a href="#section-7.6.2.2-18" class="pilcrow">¶</a></p>
<p id="section-7.6.2.2-19">The decoder can convert a distances code 'i' to a scan-line order
             distance 'dist' as follows:<a href="#section-7.6.2.2-19" class="pilcrow">¶</a></p>
<div id="section-7.6.2.2-20">
<pre class="sourcecode">
(xi, yi) = distance_map[i]
dist = x + y * xsize
if (dist &lt; 1) {
  dist = 1
}
</pre><a href="#section-7.6.2.2-20" class="pilcrow">¶</a>
</div>
<p id="section-7.6.2.2-21">where 'distance_map' is the mapping noted above and
             <code>xsize</code> is the width of the image in pixels.<a href="#section-7.6.2.2-21" class="pilcrow">¶</a></p>
</section>
</div>
<div id="color-cache-coding">
<section id="section-7.6.2.3">
            <h5 id="name-color-cache-coding">
<a href="#section-7.6.2.3" class="section-number selfRef">7.6.2.3. </a><a href="#name-color-cache-coding" class="section-name selfRef">Color Cache Coding</a>
            </h5>
<p id="section-7.6.2.3-1">Color cache stores a set of colors that have been recently used
             in the image.<a href="#section-7.6.2.3-1" class="pilcrow">¶</a></p>
<p id="section-7.6.2.3-2"><strong>Rationale:</strong> This way, the recently used colors
             can sometimes be referred to more efficiently than emitting them
             using other two methods (described in <a href="#huffman-coded-literals" class="xref">Section 7.6.2.1</a> and <a href="#lz77-backward-reference" class="xref">Section 7.6.2.2</a>).<a href="#section-7.6.2.3-2" class="pilcrow">¶</a></p>
<p id="section-7.6.2.3-3">Color cache codes are stored as follows. First, there is a 1-bit
             value that indicates if the color cache is used. If this bit is 0,
             no color cache codes exist, and they are not transmitted in the
             Huffman code that decodes the green symbols and the length prefix
             codes. However, if this bit is 1, the color cache size is read
             next:<a href="#section-7.6.2.3-3" class="pilcrow">¶</a></p>
<div id="section-7.6.2.3-4">
<pre class="sourcecode">
int color_cache_code_bits = ReadBits(4);
int color_cache_size = 1 &lt;&lt; color_cache_code_bits;
</pre><a href="#section-7.6.2.3-4" class="pilcrow">¶</a>
</div>
<p id="section-7.6.2.3-5"><code>color_cache_code_bits</code> defines the size of the
             color_cache by (1 &lt;&lt; <code>color_cache_code_bits</code>). The
               range of allowed values for <code>color_cache_code_bits</code> is
                 [1..11]. Compliant decoders must indicate a corrupted
                 bitstream for other values.<a href="#section-7.6.2.3-5" class="pilcrow">¶</a></p>
<p id="section-7.6.2.3-6">A color cache is an array of size <code>color_cache_size</code>. Each
             entry stores one ARGB color. Colors are looked up by indexing them
             by (0x1e35a7bd * <code>color</code>) &gt;&gt; (32 -
             <code>color_cache_code_bits</code>). Only one lookup is done in a
               color cache; there is no conflict resolution.<a href="#section-7.6.2.3-6" class="pilcrow">¶</a></p>
<p id="section-7.6.2.3-7">In the beginning of decoding or encoding of an image, all entries
             in all color cache values are set to zero. The color cache code is
             converted to this color at decoding time. The state of the color
             cache is maintained by inserting every pixel, be it produced by
             backward referencing or as literals, into the cache in the order
             they appear in the stream.<a href="#section-7.6.2.3-7" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</section>
</div>
<section id="section-7.7">
        <h3 id="name-entropy-code">
<a href="#section-7.7" class="section-number selfRef">7.7. </a><a href="#name-entropy-code" class="section-name selfRef">Entropy Code</a>
        </h3>
<section id="section-7.7.1">
          <h4 id="name-overview">
<a href="#section-7.7.1" class="section-number selfRef">7.7.1. </a><a href="#name-overview" class="section-name selfRef">Overview</a>
          </h4>
<p id="section-7.7.1-1">Most of the data is coded using <span><a href="#huffman" class="xref">canonical
           Huffman code</a> [<a href="#huffman" class="xref">huffman</a>]</span>. Hence, the codes are transmitted by sending the
           <em>Huffman code lengths</em>, as opposed to the actual <em>Huffman
             codes</em>.<a href="#section-7.7.1-1" class="pilcrow">¶</a></p>
<p id="section-7.7.1-2">In particular, the format uses <strong>spatially-variant Huffman
           coding</strong>. In other words, different blocks of the image can
             potentially use different entropy codes.<a href="#section-7.7.1-2" class="pilcrow">¶</a></p>
<p id="section-7.7.1-3"><strong>Rationale:</strong> Different areas of the image may have
           different characteristics. So, allowing them to use different
           entropy codes provides more flexibility and potentially a better
           compression.<a href="#section-7.7.1-3" class="pilcrow">¶</a></p>
</section>
<section id="section-7.7.2">
          <h4 id="name-details">
<a href="#section-7.7.2" class="section-number selfRef">7.7.2. </a><a href="#name-details" class="section-name selfRef">Details</a>
          </h4>
<p id="section-7.7.2-1">The encoded image data consists of two parts:<a href="#section-7.7.2-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.7.2-2">
           <li id="section-7.7.2-2.1">Meta Huffman codes<a href="#section-7.7.2-2.1" class="pilcrow">¶</a>
</li>
            <li id="section-7.7.2-2.2">Entropy-coded image data<a href="#section-7.7.2-2.2" class="pilcrow">¶</a>
</li>
          </ol>
<div id="decoding-of-meta-huffman-codes">
<section id="section-7.7.2.1">
            <h5 id="name-decoding-of-meta-huffman-co">
<a href="#section-7.7.2.1" class="section-number selfRef">7.7.2.1. </a><a href="#name-decoding-of-meta-huffman-co" class="section-name selfRef">Decoding of Meta Huffman Codes</a>
            </h5>
<p id="section-7.7.2.1-1">As noted earlier, the format allows the use of different Huffman
             codes for different blocks of the image. <em>Meta Huffman
               codes</em> are indexes identifying which Huffman codes to use in
                 different parts of the image.<a href="#section-7.7.2.1-1" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-2">Meta Huffman codes may be used <em>only</em> when the image is
             being used in the <span><a href="#roles-of-image-data" class="xref">role</a> (<a href="#roles-of-image-data" class="xref">Section 7.6.1</a>)</span>
               of an <em>ARGB image</em>.<a href="#section-7.7.2.1-2" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-3">There are two possibilities for the meta Huffman codes, indicated
             by a 1-bit value:<a href="#section-7.7.2.1-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7.2.1-4.1">If this bit is zero, there is only one meta Huffman code used
               everywhere in the image. No more data is stored.<a href="#section-7.7.2.1-4.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.7.2.1-4.2">If this bit is one, the image uses multiple meta Huffman
               codes. These meta Huffman codes are stored as an <em>entropy
                 image</em> (described below).<a href="#section-7.7.2.1-4.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-7.7.2.1-5"><strong>Entropy image:</strong><a href="#section-7.7.2.1-5" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-6">The entropy image defines which Huffman codes are used in
             different parts of the image, as described below.<a href="#section-7.7.2.1-6" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-7">The first 3-bits contain the <code>huffman_bits</code> value. The
             dimensions of the entropy image are derived from
             'huffman_bits'.<a href="#section-7.7.2.1-7" class="pilcrow">¶</a></p>
<div id="section-7.7.2.1-8">
<pre class="sourcecode">
int huffman_bits = ReadBits(3) + 2;
int huffman_xsize = DIV_ROUND_UP(xsize, 1 &lt;&lt; huffman_bits);
int huffman_ysize = DIV_ROUND_UP(ysize, 1 &lt;&lt; huffman_bits);
</pre><a href="#section-7.7.2.1-8" class="pilcrow">¶</a>
</div>
<p id="section-7.7.2.1-9">where <code>DIV_ROUND_UP</code> is as defined in <a href="#predictor-transform" class="xref">Section 7.5.1</a>.<a href="#section-7.7.2.1-9" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-10">Next bits contain an entropy image of width
             <code>huffman_xsize</code> and height <code>huffman_ysize</code>.<a href="#section-7.7.2.1-10" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-11"><strong>Interpretation of Meta Huffman Codes:</strong><a href="#section-7.7.2.1-11" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-12">For any given pixel (x, y), there is a set of five Huffman codes
             associated with it. These codes are (in bitstream order):<a href="#section-7.7.2.1-12" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7.2.1-13.1">
                <strong>Huffman code #1</strong>: used for green channel,
               backward-reference length and color cache<a href="#section-7.7.2.1-13.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.7.2.1-13.2">
                <strong>Huffman code #2, #3 and #4</strong>: used for red,
               blue and alpha channels respectively.<a href="#section-7.7.2.1-13.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.7.2.1-13.3">
                <strong>Huffman code #5</strong>: used for backward-reference
               distance.<a href="#section-7.7.2.1-13.3" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-7.7.2.1-14">From here on, we refer to this set as a <strong>Huffman code
             group</strong>.<a href="#section-7.7.2.1-14" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-15">The number of Huffman code groups in the ARGB image can be
             obtained by finding the <em>largest meta Huffman code</em> from
               the entropy image:<a href="#section-7.7.2.1-15" class="pilcrow">¶</a></p>
<div id="section-7.7.2.1-16">
<pre class="sourcecode">
int num_huff_groups = max(entropy image) + 1;
</pre><a href="#section-7.7.2.1-16" class="pilcrow">¶</a>
</div>
<p id="section-7.7.2.1-17">where <code>max(entropy image)</code> indicates the largest Huffman
             code stored in the entropy image.<a href="#section-7.7.2.1-17" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-18">As each Huffman code groups contains five Huffman codes, the
             total number of Huffman codes is:<a href="#section-7.7.2.1-18" class="pilcrow">¶</a></p>
<div id="section-7.7.2.1-19">
<pre class="sourcecode">
int num_huff_codes = 5 * num_huff_groups;
</pre><a href="#section-7.7.2.1-19" class="pilcrow">¶</a>
</div>
<p id="section-7.7.2.1-20">Given a pixel (x, y) in the ARGB image, we can obtain the
             corresponding Huffman codes to be used as follows:<a href="#section-7.7.2.1-20" class="pilcrow">¶</a></p>
<div id="section-7.7.2.1-21">
<pre class="sourcecode">
int position = (y &gt;&gt; huffman_bits) * huffman_xsize + (x &gt;&gt; huffman_bits);
int meta_huff_code = (entropy_image[pos] &gt;&gt; 8) &amp; 0xffff;
HuffmanCodeGroup huff_group = huffman_code_groups[meta_huff_code];
</pre><a href="#section-7.7.2.1-21" class="pilcrow">¶</a>
</div>
<p id="section-7.7.2.1-22">where, we have assumed the existence of <code>HuffmanCodeGroup</code>
             structure, which represents a set of five Huffman codes. Also,
             <code>huffman_code_groups</code> is an array of
             <code>HuffmanCodeGroup</code> (of size
             <code>num_huff_groups</code>).<a href="#section-7.7.2.1-22" class="pilcrow">¶</a></p>
<p id="section-7.7.2.1-23">The decoder then uses Huffman code group <code>huff_group</code> to
             decode the pixel (x, y) as explained in <a href="#decoding-entropy-coded-image-data" class="xref">Section 7.7.2.2</a>.<a href="#section-7.7.2.1-23" class="pilcrow">¶</a></p>
</section>
</div>
<div id="decoding-entropy-coded-image-data">
<section id="section-7.7.2.2">
            <h5 id="name-decoding-entropy-coded-imag">
<a href="#section-7.7.2.2" class="section-number selfRef">7.7.2.2. </a><a href="#name-decoding-entropy-coded-imag" class="section-name selfRef">Decoding Entropy-coded Image Data</a>
            </h5>
<p id="section-7.7.2.2-1">For the current position (x, y) in the image, the decoder first
             identifies the corresponding Huffman code group (as explained in
             the last section). Given the Huffman code group, the pixel is read
             and decoded as follows:<a href="#section-7.7.2.2-1" class="pilcrow">¶</a></p>
<p id="section-7.7.2.2-2">Read next symbol S from the bitstream using Huffman code #1. [See
             <a href="#decoding-the-code-lengths" class="xref">Section 7.7.2.2, Paragraph 5</a> for details on decoding
             the Huffman code lengths]. Note that S is any integer in the range
             <code>0</code> to <code>(256 + 24 + </code> <span><a href="#color-cache-coding" class="xref"><code>color_cache_size</code></a> (<a href="#color-cache-coding" class="xref">Section 7.6.2.3</a>)</span><code> -
               1)</code>.<a href="#section-7.7.2.2-2" class="pilcrow">¶</a></p>
<p id="section-7.7.2.2-3">The interpretation of S depends on its value:<a href="#section-7.7.2.2-3" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-7.7.2.2-4">
             <li id="section-7.7.2.2-4.1">
                <p id="section-7.7.2.2-4.1.1">if S &lt; 256<a href="#section-7.7.2.2-4.1.1" class="pilcrow">¶</a></p>
<ol start="1" type="i" class="normal type-i" id="section-7.7.2.2-4.1.2">
                 <li id="section-7.7.2.2-4.1.2.1">Use S as the green component<a href="#section-7.7.2.2-4.1.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.1.2.2">Read red from the bitstream using Huffman code #2<a href="#section-7.7.2.2-4.1.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.1.2.3">Read blue from the bitstream using Huffman code #3<a href="#section-7.7.2.2-4.1.2.3" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.1.2.4">Read alpha from the bitstream using Huffman code #4<a href="#section-7.7.2.2-4.1.2.4" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-7.7.2.2-4.2">
                <p id="section-7.7.2.2-4.2.1">if S &lt; 256 + 24<a href="#section-7.7.2.2-4.2.1" class="pilcrow">¶</a></p>
<ol start="1" type="i" class="normal type-i" id="section-7.7.2.2-4.2.2">
                 <li id="section-7.7.2.2-4.2.2.1">Use S - 256 as a length prefix code<a href="#section-7.7.2.2-4.2.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.2.2.2">Read extra bits for length from the bitstream<a href="#section-7.7.2.2-4.2.2.2" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.2.2.3">Determine backward-reference length L from length prefix
                   code and the extra bits read.<a href="#section-7.7.2.2-4.2.2.3" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.2.2.4">Read distance prefix code from the bitstream using Huffman
                   code #5<a href="#section-7.7.2.2-4.2.2.4" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.2.2.5">Read extra bits for distance from the bitstream<a href="#section-7.7.2.2-4.2.2.5" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.2.2.6">Determine backward-reference distance D from distance
                   prefix code and the extra bits read.<a href="#section-7.7.2.2-4.2.2.6" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.2.2.7">Copy the L pixels (in scan-line order) from the sequence of
                   pixels prior to them by D pixels.<a href="#section-7.7.2.2-4.2.2.7" class="pilcrow">¶</a>
</li>
                </ol>
</li>
              <li id="section-7.7.2.2-4.3">
                <p id="section-7.7.2.2-4.3.1">if S &gt;= 256 + 24<a href="#section-7.7.2.2-4.3.1" class="pilcrow">¶</a></p>
<ol start="1" type="i" class="normal type-i" id="section-7.7.2.2-4.3.2">
                 <li id="section-7.7.2.2-4.3.2.1">Use S - (256 + 24) as the index into the color cache.<a href="#section-7.7.2.2-4.3.2.1" class="pilcrow">¶</a>
</li>
                  <li id="section-7.7.2.2-4.3.2.2">Get ARGB color from the color cache at that index.<a href="#section-7.7.2.2-4.3.2.2" class="pilcrow">¶</a>
</li>
                </ol>
</li>
            </ol>
<div id="decoding-the-code-lengths">
<p id="section-7.7.2.2-5"><strong>Decoding the Code
             Lengths:</strong><a href="#section-7.7.2.2-5" class="pilcrow">¶</a></p>
</div>
<p id="section-7.7.2.2-6">This section describes the details about reading a symbol from
             the bitstream by decoding the Huffman code length.<a href="#section-7.7.2.2-6" class="pilcrow">¶</a></p>
<p id="section-7.7.2.2-7">The Huffman code lengths can be coded in two ways. The method
             used is specified by a 1-bit value.<a href="#section-7.7.2.2-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7.2.2-8.1">If this bit is 1, it is a <em>simple code length code</em>,
               and<a href="#section-7.7.2.2-8.1" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.7.2.2-8.2">If this bit is 0, it is a <em>normal code length
               code</em>.<a href="#section-7.7.2.2-8.2" class="pilcrow">¶</a>
</li>
            </ul>
<p id="section-7.7.2.2-9"><strong>(i) Simple Code Length Code:</strong><a href="#section-7.7.2.2-9" class="pilcrow">¶</a></p>
<p id="section-7.7.2.2-10">This variant is used in the special case when only 1 or 2 Huffman
             code lengths are non-zero, and are in the range of [0, 255]. All
             other Huffman code lengths are implicitly zeros.<a href="#section-7.7.2.2-10" class="pilcrow">¶</a></p>
<p id="section-7.7.2.2-11">The first bit indicates the number of non-zero code lengths:<a href="#section-7.7.2.2-11" class="pilcrow">¶</a></p>
<div id="section-7.7.2.2-12">
<pre class="sourcecode">
int num_code_lengths = ReadBits(1) + 1;
</pre><a href="#section-7.7.2.2-12" class="pilcrow">¶</a>
</div>
<p id="section-7.7.2.2-13">The first code length is stored either using a 1-bit code for
             values of 0 and 1, or using an 8-bit code for values in range [0,
             255]. The second code length, when present, is coded as an 8-bit
             code.<a href="#section-7.7.2.2-13" class="pilcrow">¶</a></p>
<div id="section-7.7.2.2-14">
<pre class="sourcecode">
int is_first_8bits = ReadBits(1);
code_lengths[0] = ReadBits(1 + 7 * is_first_8bits);
if (num_code_lengths == 2) {
  code_lengths[1] = ReadBits(8);
}
</pre><a href="#section-7.7.2.2-14" class="pilcrow">¶</a>
</div>
<p id="section-7.7.2.2-15"><strong>Note:</strong> Another special case is when <em>all</em>
             Huffman code lengths are <em>zeros</em> (an empty Huffman code).
               For example, a Huffman code for distance can be empty if there
               are no backward references. Similarly, Huffman codes for alpha,
               red, and blue can be empty if all pixels within the same meta
               Huffman code are produced using the color cache. However, this
               case doesn't need a special handling, as empty Huffman codes can
               be coded as those containing a single symbol <code>0</code>.<a href="#section-7.7.2.2-15" class="pilcrow">¶</a></p>
<p id="section-7.7.2.2-16"><strong>(ii) Normal Code Length Code:</strong><a href="#section-7.7.2.2-16" class="pilcrow">¶</a></p>
<p id="section-7.7.2.2-17">The code lengths of a Huffman code are read as follows:
             <code>num_code_lengths</code> specifies the number of code lengths; the
             rest of the code lengths (according to the order in
             <code>kCodeLengthCodeOrder</code>) are zeros.<a href="#section-7.7.2.2-17" class="pilcrow">¶</a></p>
<div id="section-7.7.2.2-18">
<pre class="sourcecode">
int kCodeLengthCodes = 19;
int kCodeLengthCodeOrder[kCodeLengthCodes] = {
  17, 18, 0, 1, 2, 3, 4, 5, 16, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15
};
int code_lengths[kCodeLengthCodes] = { 0 };  // All zeros.
int num_code_lengths = 4 + ReadBits(4);
for (i = 0; i &lt; num_code_lengths; ++i) {
  code_lengths[kCodeLengthCodeOrder[i]] = ReadBits(3);
}
</pre><a href="#section-7.7.2.2-18" class="pilcrow">¶</a>
</div>
<ul class="normal">
<li class="normal" id="section-7.7.2.2-19.1">
                <p id="section-7.7.2.2-19.1.1">Code length code [0..15] indicates literal code
               lengths.<a href="#section-7.7.2.2-19.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7.7.2.2-19.1.2.1">Value 0 means no symbols have been coded.<a href="#section-7.7.2.2-19.1.2.1" class="pilcrow">¶</a>
</li>
                  <li class="normal" id="section-7.7.2.2-19.1.2.2">Values [1..15] indicate the bit length of the respective
                   code.<a href="#section-7.7.2.2-19.1.2.2" class="pilcrow">¶</a>
</li>
                </ul>
</li>
              <li class="normal" id="section-7.7.2.2-19.2">Code 16 repeats the previous non-zero value [3..6] times,
               i.e., 3 + <code>ReadBits(2)</code> times.  If code 16 is used before
                 a non-zero value has been emitted, a value of 8 is
                 repeated.<a href="#section-7.7.2.2-19.2" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.7.2.2-19.3">Code 17 emits a streak of zeros [3..10], i.e., 3 +
               <code>ReadBits(3)</code> times.<a href="#section-7.7.2.2-19.3" class="pilcrow">¶</a>
</li>
              <li class="normal" id="section-7.7.2.2-19.4">Code 18 emits a streak of zeros of length [11..138], i.e., 11
               + <code>ReadBits(7)</code> times.<a href="#section-7.7.2.2-19.4" class="pilcrow">¶</a>
</li>
            </ul>
</section>
</div>
</section>
</section>
<section id="section-7.8">
        <h3 id="name-overall-structure-of-the-fo">
<a href="#section-7.8" class="section-number selfRef">7.8. </a><a href="#name-overall-structure-of-the-fo" class="section-name selfRef">Overall Structure of the Format</a>
        </h3>
<p id="section-7.8-1">Below is a view into the format in Backus-Naur form. It does not
         cover all details. End-of-image (EOI) is only implicitly coded into
         the number of pixels (xsize * ysize).<a href="#section-7.8-1" class="pilcrow">¶</a></p>
<section id="section-7.8.1">
          <h4 id="name-basic-structure">
<a href="#section-7.8.1" class="section-number selfRef">7.8.1. </a><a href="#name-basic-structure" class="section-name selfRef">Basic Structure</a>
          </h4>
<div id="section-7.8.1-1">
<pre class="sourcecode">
&lt;format&gt; ::= &lt;RIFF header&gt;&lt;image size&gt;&lt;image stream&gt;
&lt;image stream&gt; ::= &lt;optional-transform&gt;&lt;spatially-coded image&gt;
</pre><a href="#section-7.8.1-1" class="pilcrow">¶</a>
</div>
</section>
<section id="section-7.8.2">
          <h4 id="name-structure-of-transforms">
<a href="#section-7.8.2" class="section-number selfRef">7.8.2. </a><a href="#name-structure-of-transforms" class="section-name selfRef">Structure of Transforms</a>
          </h4>
<div id="section-7.8.2-1">
<pre class="sourcecode">
&lt;optional-transform&gt; ::= (1-bit value 1; &lt;transform&gt; &lt;optional-transform&gt;) |
                         1-bit value 0
&lt;transform&gt; ::= &lt;predictor-tx&gt; | &lt;color-tx&gt; | &lt;subtract-green-tx&gt; |
                &lt;color-indexing-tx&gt;
&lt;predictor-tx&gt; ::= 2-bit value 0; &lt;predictor image&gt;
&lt;predictor image&gt; ::= 3-bit sub-pixel code ; &lt;entropy-coded image&gt;
&lt;color-tx&gt; ::= 2-bit value 1; &lt;color image&gt;
&lt;color image&gt; ::= 3-bit sub-pixel code ; &lt;entropy-coded image&gt;
&lt;subtract-green-tx&gt; ::= 2-bit value 2
&lt;color-indexing-tx&gt; ::= 2-bit value 3; &lt;color-indexing image&gt;
&lt;color-indexing image&gt; ::= 8-bit color count; &lt;entropy-coded image&gt;
</pre><a href="#section-7.8.2-1" class="pilcrow">¶</a>
</div>
</section>
<section id="section-7.8.3">
          <h4 id="name-structure-of-the-image-data">
<a href="#section-7.8.3" class="section-number selfRef">7.8.3. </a><a href="#name-structure-of-the-image-data" class="section-name selfRef">Structure of the Image Data</a>
          </h4>
<div id="section-7.8.3-1">
<pre class="sourcecode">
&lt;spatially-coded image&gt; ::= &lt;meta huffman&gt;&lt;entropy-coded image&gt;
&lt;entropy-coded image&gt; ::= &lt;color cache info&gt;&lt;huffman codes&gt;&lt;lz77-coded image&gt;
&lt;meta huffman&gt; ::= 1-bit value 0 |
                   (1-bit value 1; &lt;entropy image&gt;)
&lt;entropy image&gt; ::= 3-bit subsample value; &lt;entropy-coded image&gt;
&lt;color cache info&gt; ::= 1 bit value 0 |
                       (1-bit value 1; 4-bit value for color cache size)
&lt;huffman codes&gt; ::= &lt;huffman code group&gt; | &lt;huffman code group&gt;&lt;huffman codes&gt;
&lt;huffman code group&gt; ::= &lt;huffman code&gt;&lt;huffman code&gt;&lt;huffman code&gt;
                         &lt;huffman code&gt;&lt;huffman code&gt;
                         See "Interpretation of Meta Huffman codes" to
                         understand what each of these five Huffman codes are
                         for.
&lt;huffman code&gt; ::= &lt;simple huffman code&gt; | &lt;normal huffman code&gt;
&lt;simple huffman code&gt; ::= see "Simple code length code" for details
&lt;normal huffman code&gt; ::= &lt;code length code&gt;; encoded code lengths
&lt;code length code&gt; ::= see section "Normal code length code"
&lt;lz77-coded image&gt; ::= ((&lt;argb-pixel&gt; | &lt;lz77-copy&gt; | &lt;color-cache-code&gt;)
                       &lt;lz77-coded image&gt;) | ""
</pre><a href="#section-7.8.3-1" class="pilcrow">¶</a>
</div>
<p id="section-7.8.3-2">A possible example sequence:<a href="#section-7.8.3-2" class="pilcrow">¶</a></p>
<div id="section-7.8.3-3">
<pre class="sourcecode">
&lt;RIFF header&gt;&lt;image size&gt;1-bit value 1&lt;subtract-green-tx&gt;
1-bit value 1&lt;predictor-tx&gt;1-bit value 0&lt;meta huffman&gt;
&lt;color cache info&gt;&lt;huffman codes&gt;
&lt;lz77-coded image&gt;
</pre><a href="#section-7.8.3-3" class="pilcrow">¶</a>
</div>
</section>
</section>
</section>
</div>
<section id="section-8">
      <h2 id="name-references">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<section id="section-8.1">
        <h3 id="name-normative-references">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="rec601">[rec601]</dt>
        <dd>
<span class="refAuthor">ITU</span>, <span class="refTitle">"BT.601: Studio encoding parameters of digital television for standard 4:3 and wide screen 16:9 aspect ratios"</span>, <time datetime="2011-03" class="refDate">March 2011</time>, <span>&lt;<a href="https://www.itu.int/rec/R-REC-BT.601/">https://www.itu.int/rec/R-REC-BT.601/</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC1166">[RFC1166]</dt>
        <dd>
<span class="refAuthor">Kirkpatrick, S.</span>, <span class="refAuthor">Stahl, M.</span>, and <span class="refAuthor">M. Recker</span>, <span class="refTitle">"Internet numbers"</span>, <span class="seriesInfo">RFC 1166</span>, <span class="seriesInfo">DOI 10.17487/RFC1166</span>, <time datetime="1990-07" class="refDate">July 1990</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc1166">https://www.rfc-editor.org/info/rfc1166</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2119">https://www.rfc-editor.org/info/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2781">[RFC2781]</dt>
        <dd>
<span class="refAuthor">Hoffman, P.</span> and <span class="refAuthor">F. Yergeau</span>, <span class="refTitle">"UTF-16, an encoding of ISO 10646"</span>, <span class="seriesInfo">RFC 2781</span>, <span class="seriesInfo">DOI 10.17487/RFC2781</span>, <time datetime="2000-02" class="refDate">February 2000</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2781">https://www.rfc-editor.org/info/rfc2781</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC4648">[RFC4648]</dt>
        <dd>
<span class="refAuthor">Josefsson, S.</span>, <span class="refTitle">"The Base16, Base32, and Base64 Data Encodings"</span>, <span class="seriesInfo">RFC 4648</span>, <span class="seriesInfo">DOI 10.17487/RFC4648</span>, <time datetime="2006-10" class="refDate">October 2006</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc4648">https://www.rfc-editor.org/info/rfc4648</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6386">[RFC6386]</dt>
        <dd>
<span class="refAuthor">Bankoski, J.</span>, <span class="refAuthor">Koleszar, J.</span>, <span class="refAuthor">Quillio, L.</span>, <span class="refAuthor">Salonen, J.</span>, <span class="refAuthor">Wilkins, P.</span>, and <span class="refAuthor">Y. Xu</span>, <span class="refTitle">"VP8 Data Format and Decoding Guide"</span>, <span class="seriesInfo">RFC 6386</span>, <span class="seriesInfo">DOI 10.17487/RFC6386</span>, <time datetime="2011-11" class="refDate">November 2011</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6386">https://www.rfc-editor.org/info/rfc6386</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6838">[RFC6838]</dt>
        <dd>
<span class="refAuthor">Freed, N.</span>, <span class="refAuthor">Klensin, J.</span>, and <span class="refAuthor">T. Hansen</span>, <span class="refTitle">"Media Type Specifications and Registration Procedures"</span>, <span class="seriesInfo">BCP 13</span>, <span class="seriesInfo">RFC 6838</span>, <span class="seriesInfo">DOI 10.17487/RFC6838</span>, <time datetime="2013-01" class="refDate">January 2013</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc6838">https://www.rfc-editor.org/info/rfc6838</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="webp-lossless-src">[webp-lossless-src]</dt>
        <dd>
<span class="refAuthor">Alakuijala, J.</span>, <span class="refTitle">"WebP Lossless Bitstream Specification"</span>, <time datetime="2014-09" class="refDate">September 2014</time>, <span>&lt;<a href="https://chromium.googlesource.com/webm/libwebp/+/refs/heads/main/doc/webp-lossless-bitstream-spec.txt">https://chromium.googlesource.com/webm/libwebp/+/refs/heads/main/doc/webp-lossless-bitstream-spec.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="webp-riff-src">[webp-riff-src]</dt>
      <dd>
<span class="refAuthor">Google LLC</span>, <span class="refTitle">"WebP RIFF Container"</span>, <time datetime="2018-04" class="refDate">April 2018</time>, <span>&lt;<a href="https://chromium.googlesource.com/webm/libwebp/+/refs/heads/main/doc/webp-container-spec.txt">https://chromium.googlesource.com/webm/libwebp/+/refs/heads/main/doc/webp-container-spec.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
<section id="section-8.2">
        <h3 id="name-informative-references">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="crbug-security">[crbug-security]</dt>
        <dd>
<span class="refTitle">"libwebp Security Issues"</span>, <span>&lt;<a href="https://bugs.chromium.org/p/webp/issues/list?q=label%3ASecurity">https://bugs.chromium.org/p/webp/issues/list?q=label%3ASecurity</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="cve.mitre.org-libwebp">[cve.mitre.org-libwebp]</dt>
        <dd>
<span class="refTitle">"libwebp CVE List"</span>, <span>&lt;<a href="https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=libwebp">https://cve.mitre.org/cgi-bin/cvekey.cgi?keyword=libwebp</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="Exif">[Exif]</dt>
        <dd>
<span class="refAuthor">Camera &amp; Imaging Products Association (CIPA), Japan Electronics and Information Technology Industries Association (JEITA)</span>, <span class="refTitle">"Exchangeable image file format for digital still cameras: Exif Version 2.3"</span>, <span>&lt;<a href="https://www.cipa.jp/std/documents/e/DC-008-2012_E.pdf">https://www.cipa.jp/std/documents/e/DC-008-2012_E.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="gif-spec">[gif-spec]</dt>
        <dd>
<span class="refTitle">"GIF89a Specification"</span>, <span>&lt;<a href="https://www.w3.org/Graphics/GIF/spec-gif89a.txt">https://www.w3.org/Graphics/GIF/spec-gif89a.txt</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="huffman">[huffman]</dt>
        <dd>
<span class="refAuthor">Huffman, D. A.</span>, <span class="refTitle">"A Method for the Construction of Minimum Redundancy Codes"</span>, <span class="seriesInfo">Proceedings of the Institute of Radio Engineers Number 9, pp. 1098-1101.</span>, <time datetime="1952-09" class="refDate">September 1952</time>. </dd>
<dd class="break"></dd>
<dt id="IANA-Media-Types">[IANA-Media-Types]</dt>
        <dd>
<span class="refAuthor">Internet Assigned Numbers Authority (IANA)</span>, <span class="refTitle">"Media Types"</span>, <span>&lt;<a href="https://www.iana.org/assignments/media-types/media-types.xhtml">https://www.iana.org/assignments/media-types/media-types.xhtml</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="ICC">[ICC]</dt>
        <dd>
<span class="refAuthor">International Color Consortium</span>, <span class="refTitle">"ICC Specification"</span>, <time datetime="2010-12" class="refDate">December 2010</time>, <span>&lt;<a href="https://www.color.org/specification/ICC1v43_2010-12.pdf">https://www.color.org/specification/ICC1v43_2010-12.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="jpeg-spec">[jpeg-spec]</dt>
        <dd>
<span class="refTitle">"JPEG Standard (JPEG ISO/IEC 10918-1 ITU-T Recommendation T.81)"</span>, <span>&lt;<a href="https://www.w3.org/Graphics/JPEG/itu-t81.pdf">https://www.w3.org/Graphics/JPEG/itu-t81.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="lz77">[lz77]</dt>
        <dd>
<span class="refAuthor">Ziv, J.</span> and <span class="refAuthor">A. Lempel</span>, <span class="refTitle">"A Universal Algorithm for Sequential Data Compression"</span>, <span class="seriesInfo">IEEE Transactions on Information Theory Vol. 23, No. 3, pp. 337-343.</span>, <time datetime="1977-05" class="refDate">May 1977</time>. </dd>
<dd class="break"></dd>
<dt id="mwg">[mwg]</dt>
        <dd>
<span class="refAuthor">Metadata Working Group</span>, <span class="refTitle">"Guidelines For Handling Image Metadata"</span>, <time datetime="2010-11" class="refDate">November 2010</time>, <span>&lt;<a href="https://web.archive.org/web/20180919181934/http://www.metadataworkinggroup.org/pdf/mwg_guidance.pdf">https://web.archive.org/web/20180919181934/http://www.metadataworkinggroup.org/pdf/mwg_guidance.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2083">[RFC2083]</dt>
        <dd>
<span class="refAuthor">Boutell, T.</span>, <span class="refTitle">"PNG (Portable Network Graphics) Specification Version 1.0"</span>, <span class="seriesInfo">RFC 2083</span>, <span class="seriesInfo">DOI 10.17487/RFC2083</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/info/rfc2083">https://www.rfc-editor.org/info/rfc2083</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="riff-spec">[riff-spec]</dt>
        <dd>
<span class="refTitle">"Multimedia Programming Interface and Data Specifications 1.0"</span>, <span>&lt;<a href="http://www-mmsp.ece.mcgill.ca/Documents/AudioFormats/WAVE/Docs/riffmci.pdf">http://www-mmsp.ece.mcgill.ca/Documents/AudioFormats/WAVE/Docs/riffmci.pdf</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="XMP">[XMP]</dt>
      <dd>
<span class="refAuthor">Adobe Inc.</span>, <span class="refTitle">"XMP Specification"</span>, <span>&lt;<a href="https://www.adobe.com/devnet/xmp.html">https://www.adobe.com/devnet/xmp.html</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</section>
<div id="authors-addresses">
<section id="appendix-A">
      <h2 id="name-authors-address">
<a href="#name-authors-address" class="section-name selfRef">Author's Address</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">James Zern</span></div>
<div dir="auto" class="left"><span class="org">Google LLC</span></div>
<div dir="auto" class="left"><span class="street-address">1600 Amphitheatre Parkway</span></div>
<div dir="auto" class="left">
<span class="locality">Mountain View</span>, <span class="region">CA</span> <span class="postal-code">94043</span>
</div>
<div dir="auto" class="left"><span class="country-name">United States of America</span></div>
<div class="tel">
<span>Phone:</span>
<a href="tel:+1%20650%20253-0000" class="tel">+1 650 253-0000</a>
</div>
<div class="email">
<span>Email:</span>
<a href="mailto:jzern@google.com" class="email">jzern@google.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
