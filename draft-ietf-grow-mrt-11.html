<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html lang="en"><head><title>MRT routing information export format</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="description" content="MRT routing information export format">
<meta name="keywords" content="MRT">
<meta name="generator" content="xml2rfc v1.35 (http://xml.resource.org/)">
<meta name="viewport" content="width=600;" />
<style type='text/css'><!--
        body {
                font-family: verdana, charcoal, helvetica, arial, sans-serif;
                font-size: 85%;
		max-width: 40em; 
		color: #000; background-color: #FFF;
                margin: 2em;
        }
        h1, h2, h3, h4, h5, h6 {
                font-family: helvetica, monaco, "MS Sans Serif", arial, sans-serif;
                font-weight: bold; font-style: normal;
        }
        h1 { color: #900; background-color: transparent; text-align: right; }
        h3 { color: #333; background-color: transparent; }

        td.RFCbug {
                font-size: x-small; text-decoration: none;
                width: 30px; height: 30px; padding-top: 2px;
                text-align: justify; vertical-align: middle;
                background-color: #000;
        }
        td.RFCbug span.RFC {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: bold; color: #666;
        }
        td.RFCbug span.hotText {
                font-family: charcoal, monaco, geneva, "MS Sans Serif", helvetica, verdana, sans-serif;
                font-weight: normal; text-align: center; color: #FFF;
        }

        table.TOCbug { width: 30px; height: 15px; }
        td.TOCbug {
                text-align: center; width: 30px; height: 15px;
                color: #FFF; background-color: #900;
        }
        td.TOCbug a {
                font-family: monaco, charcoal, geneva, "MS Sans Serif", helvetica, sans-serif;
                font-weight: bold; font-size: x-small; text-decoration: none;
                color: #FFF; background-color: transparent;
        }

        td.header {
                font-family: arial, helvetica, sans-serif; font-size: x-small;
                vertical-align: top; width: 33%;
                color: #FFF; background-color: #666;
        }
        td.author { font-weight: bold; font-size: x-small; margin-left: 4em; }
        td.author-text { font-size: x-small; }

        /* info code from SantaKlauss at http://www.madaboutstyle.com/tooltip2.html */
        a.info {
                /* This is the key. */
                position: relative;
                z-index: 24;
                text-decoration: none;
        }
        a.info:hover {
                z-index: 25;
                color: #FFF; background-color: #900;
        }
        a.info span { display: none; }
        a.info:hover span.info {
                /* The span will display just on :hover state. */
                display: block;
                position: absolute;
                font-size: smaller;
                top: 2em; left: -5em; width: 15em;
                padding: 2px; border: 1px solid #333;
                color: #900; background-color: #EEE;
                text-align: left;
        }

        a { font-weight: bold; }
        a:link    { color: #900; background-color: transparent; }
        a:visited { color: #633; background-color: transparent; }
        a:active  { color: #633; background-color: transparent; }

        p { margin-left: 2em; margin-right: 2em; }
        p.copyright { font-size: x-small; }
        p.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; margin-left: 3em; }
        table.toc { margin: 0 0 0 3em; padding: 0; border: 0; vertical-align: text-top; }
        td.toc { font-size: 85%;
		max-width: 40em; 
		font-weight: bold; vertical-align: text-top; }

        ol.text { margin-left: 2em; margin-right: 2em; }
        ul.text { margin-left: 2em; margin-right: 2em; }
        li      { margin-left: 3em; }

        /* RFC-2629 <spanx>s and <artwork>s. */
        em     { font-style: italic; }
        strong { font-weight: bold; }
        dfn    { font-weight: bold; font-style: normal; }
        cite   { font-weight: normal; font-style: normal; }
        tt     { color: #036; }
        tt, pre, pre dfn, pre em, pre cite, pre span {
                font-family: "Courier New", Courier, monospace; font-size: small;
        }
        pre {
                text-align: left; padding: 4px;
                color: #000; background-color: #CCC;
        }
        pre dfn  { color: #900; }
        pre em   { color: #66F; background-color: #FFC; font-weight: normal; }
        pre .key { color: #33C; font-weight: bold; }
        pre .id  { color: #900; }
        pre .str { color: #000; background-color: #CFF; }
        pre .val { color: #066; }
        pre .rep { color: #909; }
        pre .oth { color: #000; background-color: #FCF; }
        pre .err { background-color: #FCC; }

        /* RFC-2629 <texttable>s. */
        table.all, table.full, table.headers, table.none {
                font-size: 85%;
		max-width: 40em; 
		text-align: center; border-width: 2px;
                vertical-align: top; border-collapse: collapse;
        }
        table.all, table.full { border-style: solid; border-color: black; }
        table.headers, table.none { border-style: none; }
        th {
                font-weight: bold; border-color: black;
                border-width: 2px 2px 3px 2px;
        }
        table.all th, table.full th { border-style: solid; }
        table.headers th { border-style: none none solid none; }
        table.none th { border-style: none; }
        table.all td {
                border-style: solid; border-color: #333;
                border-width: 1px 2px;
        }
        table.full td, table.headers td, table.none td { border-style: none; }

        hr { height: 1px; }
        hr.insert {
                width: 80%; border-style: none; border-width: 0;
                color: #CCC; background-color: #CCC;
        }
--></style>
</head>
<body>
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<table summary="layout" width="66%" border="0" cellpadding="0" cellspacing="0"><tr><td><table summary="layout" width="100%" border="0" cellpadding="2" cellspacing="1">
<tr><td class="header">Network Working Group</td><td class="header">L. Blunk</td></tr>
<tr><td class="header">Internet-Draft</td><td class="header">M. Karir</td></tr>
<tr><td class="header">Intended status: Standards Track</td><td class="header">Merit Network</td></tr>
<tr><td class="header">Expires: September 9, 2010</td><td class="header">C. Labovitz</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">Arbor Networks</td></tr>
<tr><td class="header">&nbsp;</td><td class="header">March 08, 2010</td></tr>
</table></td></tr></table>
<h1><br />MRT routing information export format<br />draft-ietf-grow-mrt-11.txt</h1>

<h3>Abstract</h3>

<p>This document describes the MRT format for routing information export.
This format was developed in concert with the Multi-threaded Routing
Toolkit (MRT) from whence the format takes it name.
The format can be used to export routing protocol messages,
state changes, and routing information base contents.
</p>
<h3>Status of this Memo</h3>
<p>
This Internet-Draft is submitted to IETF in full
conformance with the provisions of BCP&nbsp;78 and BCP&nbsp;79.</p>
<p>
Internet-Drafts are working documents of the Internet Engineering
Task Force (IETF), its areas, and its working groups.
Note that other groups may also distribute working documents as
Internet-Drafts.</p>
<p>
Internet-Drafts are draft documents valid for a maximum of six months
and may be updated, replaced, or obsoleted by other documents at any time.
It is inappropriate to use Internet-Drafts as reference material or to cite
them other than as &ldquo;work in progress.&rdquo;</p>
<p>
The list of current Internet-Drafts can be accessed at
<a href='http://www.ietf.org/ietf/1id-abstracts.txt'>http://www.ietf.org/ietf/1id-abstracts.txt</a>.</p>
<p>
The list of Internet-Draft Shadow Directories can be accessed at
<a href='http://www.ietf.org/shadow.html'>http://www.ietf.org/shadow.html</a>.</p>
<p>
This Internet-Draft will expire on September 9, 2010.</p>

<h3>Copyright Notice</h3>
<p>
Copyright (c) 2010 IETF Trust and the persons identified as the
document authors.  All rights reserved.</p>
<p>
This document is subject to BCP 78 and the IETF Trust's Legal
Provisions Relating to IETF Documents
(http://trustee.ietf.org/license-info) in effect on the date of
publication of this document.  Please review these documents
carefully, as they describe your rights and restrictions with respect
to this document. Code Components extracted from this document must
include Simplified BSD License text as described in Section 4.e of
the Trust Legal Provisions and are provided without warranty as
described in the BSD License.</p>
<a name="toc"></a><br /><hr />
<h3>Table of Contents</h3>
<p class="toc">
<a href="#anchor1">1.</a>&nbsp;
Requirements notation<br />
<a href="#intro">2.</a>&nbsp;
Introduction<br />
<a href="#anchor2">3.</a>&nbsp;
Basic MRT Format<br />
<a href="#anchor3">4.</a>&nbsp;
MRT Informational Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor4">4.1.</a>&nbsp;
START Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor5">4.2.</a>&nbsp;
I_AM_DEAD Type<br />
<a href="#anchor6">5.</a>&nbsp;
MRT Routing Information Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor7">5.1.</a>&nbsp;
OSPF Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor8">5.2.</a>&nbsp;
TABLE_DUMP Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor9">5.3.</a>&nbsp;
TABLE_DUMP_V2 Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor10">5.4.</a>&nbsp;
BGP4MP Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor11">5.4.1.</a>&nbsp;
BGP4MP_STATE_CHANGE Subtype<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor12">5.4.2.</a>&nbsp;
BGP4MP_MESSAGE Subtype<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor13">5.4.3.</a>&nbsp;
BGP4MP_MESSAGE_AS4 Subtype<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor14">5.4.4.</a>&nbsp;
BGP4MP_STATE_CHANGE_AS4 Subtype<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor15">5.4.5.</a>&nbsp;
BGP4MP_MESSAGE_LOCAL Subtype<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor16">5.4.6.</a>&nbsp;
BGP4MP_MESSAGE_AS4_LOCAL Subtype<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor17">5.5.</a>&nbsp;
BGP4MP_ET Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor18">5.6.</a>&nbsp;
ISIS Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor19">5.7.</a>&nbsp;
ISIS_ET Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor20">5.8.</a>&nbsp;
OSPFv3 Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor21">5.9.</a>&nbsp;
OSPFv3_ET Type<br />
<a href="#anchor22">6.</a>&nbsp;
IANA Considerations<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor23">6.1.</a>&nbsp;
Type Codes<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor24">6.2.</a>&nbsp;
Subtype Codes<br />
<a href="#anchor25">7.</a>&nbsp;
Security Considerations<br />
<a href="#rfc.references1">8.</a>&nbsp;
References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references1">8.1.</a>&nbsp;
Normative References<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#rfc.references2">8.2.</a>&nbsp;
Informative References<br />
<a href="#app-deprecated">Appendix&nbsp;A.</a>&nbsp;
Deprecated MRT types<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor28">A.1.</a>&nbsp;
Deprecated MRT Informational Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor29">A.1.1.</a>&nbsp;
NULL Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor30">A.1.2.</a>&nbsp;
DIE Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor31">A.1.3.</a>&nbsp;
PEER_DOWN Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor32">A.2.</a>&nbsp;
Deprecated MRT Routing Information Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor33">A.2.1.</a>&nbsp;
BGP Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor42">A.2.2.</a>&nbsp;
RIP Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor43">A.2.3.</a>&nbsp;
IDRP Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor44">A.2.4.</a>&nbsp;
RIPNG Type<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor45">A.2.5.</a>&nbsp;
BGP4PLUS and BGP4PLUS_01 Types<br />
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#anchor46">A.2.6.</a>&nbsp;
Deprecated BGP4MP Subtypes<br />
<a href="#rfc.authors">&#167;</a>&nbsp;
Authors' Addresses<br />
</p>
<br clear="all" />

<a name="anchor1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.1"></a><h3>1.&nbsp;
Requirements notation</h3>

<p>The key words "MUST", "MUST NOT", "REQUIRED", "SHALL",
  "SHALL NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY",
  and "OPTIONAL" in this document are to be interpreted as
  described in <a class='info' href='#RFC2119'>[RFC2119]<span> (</span><span class='info'>Bradner, S., &ldquo;Key words for use in RFCs to Indicate Requirement Levels,&rdquo; March&nbsp;1997.</span><span>)</span></a>.
</p>
<a name="intro"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.2"></a><h3>2.&nbsp;
Introduction</h3>

<p>Researchers and engineers often wish to analyze network behavior
by studying routing protocol transactions and routing information
base snapshots.  To this end, the MRT format was developed to
encapsulate, export, and archive this information in a standardized
data representation.
The BGP routing protocol, in particular, has been the subject of
extensive study and analysis which has been significantly aided
by the availability of the MRT format.
The MRT format was initially defined in
the <a class='info' href='#MRT PROG GUIDE'>MRT Programmer's Guide<span> (</span><span class='info'>Labovitz, C., &ldquo;MRT Programmer's Guide,&rdquo; November&nbsp;1999.</span><span>)</span></a> [MRT PROG GUIDE].

</p>
<p>
This memo serves to document the MRT format as currently implemented
in publicly available software.  The format has been extended since
it's original introduction in the MRT toolset and these
extensions are also included in this memo.
Further extensions may
be introduced at a later date through additional definitions of the
MRT Type field and Subtype fields.
</p>
<p>A number of MRT message types have been documented
in some references but are not known to have been implemented.
Further, several types were employed in early MRT implementations, but
are no longer actively being used.
These types are considered to be deprecated
and are documented in a separate
appendix at the end of this document.  Some of the deprecated types
may of interest to researchers examining historical MRT archives.

</p>
<p>Fields which contain multi-octet numeric values are encoded in
network octet order from most significant octet to least significant octet.
Fields which contain routing message fields are encoded in the same
order as they appear in the packet contents.

</p>
<a name="anchor2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.3"></a><h3>3.&nbsp;
Basic MRT Format</h3>

<p>
All MRT format messages have a common header which includes a timestamp,
Type, Subtype, and length field.  The header is followed by a message
field.  The MRT common header is illustrated below.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Timestamp                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |             Type              |            Subtype            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                             Length                            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Message... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>Header Field Descriptions:
</p>
<blockquote class="text">
<p><br />

Timestamp:
</p>
<blockquote class="text">
<p>Time in seconds since 1 January 1970 00:00:00 UTC
</p>
</blockquote>

<p><br />

Type:
</p>
<blockquote class="text">
<p>A 2-octet field that indicates the Type of information contained
in the message field.  Types 0 through 4 are informational
messages pertaining to the state of an MRT collector,
while Types 5 and higher are used to convey routing information.
</p>
</blockquote>

<p><br />

Subtype:
</p>
<blockquote class="text">
<p>A 2-octet field that is used to further distinguish message information within a particular message Type.
</p>
</blockquote>

<p><br />

Length:
</p>
<blockquote class="text">
<p>A 4-octet message length field.  The length field contains the number of octets within the message.  The length field does not include the length of the MRT common header.
</p>
</blockquote>

<p><br />

Message:
</p>
<blockquote class="text">
<p>A variable length message.  The contents of this field are context
dependent upon the Type and Subtype fields.
</p>
</blockquote>

</blockquote><p>

</p>
<a name="anchor3"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4"></a><h3>4.&nbsp;
MRT Informational Types</h3>

<p>The MRT format defines five Informational Type messages.  These messages
are intended to signal the state of an MRT data collector
and do not contain routing information.  These messages are
OPTIONAL and were largely intended for use when MRT messages are
sent over a network to a remote repository store.
However, MRT message repository stores have traditionally resided on the same
device as the collector and these Informational Types have seen limited
implementation.  Further, transport mechanisms for MRT messages are
considered to be outside the scope of this document.
</p>
<p>The START and I_AM_DEAD messages MAY be used to provide a time reference
when a data collector begins and ends the collection process.  The time reference is obtained from the Timestamp field in the MRT message header.
</p>
<p>The message field MAY contain an OPTIONAL message string for diagnostic
purposes. The message string encoding MUST follow the UTF-8 transformation
format.  The Subtype field is unused for these Types and SHOULD be set to 0.
</p>
<p>The MRT Informational Types are defined below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    1    START
    3    I_AM_DEAD
</pre></div>
<a name="anchor4"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.1"></a><h3>4.1.&nbsp;
START Type</h3>

<p>The START Type indicates a collector is about to begin generating MRT
messages.
</p>
<a name="anchor5"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.4.2"></a><h3>4.2.&nbsp;
I_AM_DEAD Type</h3>

<p>An I_AM_DEAD MRT message indicates that a collector has shut down
and has stopped generating MRT messages.
</p>
<a name="anchor6"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5"></a><h3>5.&nbsp;
MRT Routing Information Types</h3>

<p>The following Types are currently defined for the MRT format.  Types
11 and 12 were defined in the MRT Toolkit package.  The BGP4MP
Type, number 16, was initially defined in the Zebra routing software package.
The BGP4MP_ET, ISIS, and ISIS_ET Types were initially defined in the
Sprint Labs Python Routing Toolkit (PyRT).  The OSPFv3 and OSPFv3_ET Types
are newly defined types created for the OSPFv3 routing protocol.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    11   OSPF
    12   TABLE_DUMP
    13   TABLE_DUMP_V2
    16   BGP4MP
    17   BGP4MP_ET
    32   ISIS
    33   ISIS_ET
    48   OSPFv3
    49   OSPFv3_ET
</pre></div>
<a name="anchor7"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.1"></a><h3>5.1.&nbsp;
OSPF Type</h3>

<p>This Type supports the OSPF Protocol as defined in
<a class='info' href='#RFC2328'>RFC 2328<span> (</span><span class='info'>Moy, J., &ldquo;OSPF Version 2,&rdquo; April&nbsp;1998.</span><span>)</span></a> [RFC2328].  The Subtype field may
contain two possible values:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0    OSPF_STATE_CHANGE
    1    OSPF_LSA_UPDATE
</pre></div>
<p>The format of the MRT Message field for the OSPF Type is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Remote IP address                     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Local IP address                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                  OSPF Message Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>
</p>
<a name="anchor8"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.2"></a><h3>5.2.&nbsp;
TABLE_DUMP Type</h3>

<p>The TABLE_DUMP Type is used to encode the contents of a
BGP Routing Information Base (RIB). Each RIB entry is encoded in
a distinct sequential MRT record.  The
Subtype field is used to encode whether the RIB entry contains IPv4 or
IPv6 addresses.  There are two possible values for the Subtype
as shown below.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    1    AFI_IPv4
    2    AFI_IPv6
</pre></div>
<p>The format of the TABLE_DUMP Type is illustrated below.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |           View #              |       Sequence number         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Prefix (variable)                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Prefix Length |    Status     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Originated Time                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    Peer IP address (variable)                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |           Peer AS             |       Attribute Length        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                   BGP Attribute... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>The View field is normally 0 and is intended for cases where an
implementation may have multiple RIB views (such as a route server).
In cases where multiple RIB views are present, an implementation
may use the the view field to distinguish entries from each view.
The Sequence field is a simple incremental counter for each
RIB entry.   A typical RIB dump will exceed the 16-bit bounds of this
counter and implementation should simply wrap back to zero and continue
incrementing the counter in such cases.
</p>
<p>The Prefix field contains the IP address of a particular
RIB entry.  The size of this field is dependent on the value of
the Subtype for this message.  For AFI_IPv4, this field is 4 octets,
for AFI_IPv6, it is 16 octets in length.  The Prefix Length field
indicates the length in bits of the prefix mask for the preceding
Prefix field.
</p>
<p>The Status octet is not used in the TABLE_DUMP Type and SHOULD be set
to 1.
</p>
<p>The Originated Time contains the 4-octet time at which this prefix
was heard.  The value represents the time in seconds since
1 January 1970 00:00:00 UTC.
</p>
<p>The Peer IP field is the IP address of the peer which provided
the update for this RIB entry.  As with the Prefix field, the
size of this field is dependent on the Subtype.  AFI_IPv4 indicates
a 4 octet field and an IPv4 address, while a Subtype of AFI_IPv6 requires
a 16 octet field and an IPv6 address.  The Peer AS field contains
the AS number of the peer.
</p>
<p>Attribute length is the length of Attribute field and is 2-octets.
The Attribute field contains the attribute information for the RIB
entry.
</p>
<a name="anchor9"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.3"></a><h3>5.3.&nbsp;
TABLE_DUMP_V2 Type</h3>

<p>The TABLE_DUMP_V2 Type updates the TABLE_DUMP Type to include 4-Byte
ASN support and full support for BGP Multiprotocol extensions.  It also
improves upon the space efficiency of the TABLE_DUMP Type by employing
an index table for peers and permitting a single MRT record per NLRI entry.
The following subtypes are used with the TABLE_DUMP_V2 Type.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    1    PEER_INDEX_TABLE
    2    RIB_IPV4_UNICAST
    3    RIB_IPV4_MULTICAST
    4    RIB_IPV6_UNICAST
    5    RIB_IPV6_MULTICAST
    6    RIB_GENERIC
</pre></div>
<p>An initial PEER_INDEX_TABLE MRT record provides the BGP ID of the
collector, an optional view name, and a list of indexed peers.
Following the PEER_INDEX_TABLE MRT record, a series of MRT records
are used to encode RIB table entries.  This series of MRT records
use subtypes 2-6 and are separate from the PEER_INDEX_TABLE MRT
record itself and include full MRT record headers.  The header of the
PEER_INDEX_TABLE Subtype is shown below.   The View Name is optional
and, if not present, the View Name Length MUST be set to 0. The
View Name encoding MUST follow the UTF-8 transformation format.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Collector BGP ID                         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       View Name Length        |     View Name (variable)      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |          Peer Count           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>The format of the peer entries is shown below.  The PEER_INDEX_TABLE
record contains Peer Count peer entries.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |   Peer Type   |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer BGP ID                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                   Peer IP address (variable)                  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Peer AS (variable)                     |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>The Peer Type, Peer BGP ID, Peer IP, and Peer AS fields are repeated
as indicated by the Peer Count field.  The position of the Peer in
the PEER_INDEX_TABLE is used as an index in the subsequent TABLE_DUMP_V2
MRT records.  The index number begins with 0.
</p>
<p> The Peer Type field is a bit field
which encodes the type of the AS and IP address as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    Bit 0 - unset for IPv4 Peer IP address, set for IPv6
    Bit 1 - unset when Peer AS is 16 bits, set when it's 32 bits
</pre></div>
<p>The records which follow the PEER_INDEX_TABLE record constitute the RIB
entries and include a header which specifies a sequence number, NLRI,
and a count of the number of RIB entries which follow.
</p>
<p>The format for the RIB_IPV4_UNICAST, RIB_IPV4_MULTICAST, RIB_IPV6_UNICAST,
and RIB_IPV6_MULTICAST headers are shown below.  The Prefix Length
and Prefix fields are encoded in the same manner as the BGP
NLRI encoding for IPV4 and IPV6 prefixes.
Namely, the Prefix field contains address prefixes followed by enough
trailing bits to make the end of the field fall on an octet
boundary.  Note that the value of trailing bits is irrelevant.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Sequence number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Prefix Length |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Prefix (variable)                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Entry Count           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>The RIB_GENERIC header is shown below.  It includes Address
Family Identifier (AFI), Subsequent AFI and a single NLRI entry.
The NLRI information is specific to the AFI and SAFI values.
An implementation which does not recognize particular AFI and SAFI
values SHOULD discard the remainder of the MRT record.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Sequence number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |    Address Family Identifier  |Subsequent AFI |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |     Network Layer Reachability Information (variable)         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Entry Count           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>The RIB entry headers are followed
by a series of RIB entries which are repeated Entry Count times.
These entries share a common format as shown below.  They include a
Peer Index from the PEER_INDEX_TABLE MRT record, an originated time for
the RIB entry, and the BGP path attribute length and attributes
encoded as provided in a BGP Update message.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer Index            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Originated Time                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |      Attribute Length         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP Attributes... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>There is one exception to the encoding of BGP attributes for the BGP
MP_REACH_NLRI attribute (BGP Type Code 14) [RFC 4760].  Since the AFI,
SAFI, and NLRI information is already encoded in the MULTIPROTOCOL
header, only the Next Hop Address Length and Next Hop Address fields
are included.  The Reserved field is omitted.  The attribute length is
also adjusted to reflect only the length of the Next Hop Address Length
and Next Hop Address fields.
</p>
<a name="anchor10"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4"></a><h3>5.4.&nbsp;
BGP4MP Type</h3>

<p>This Type was initially defined in the Zebra software package for
the BGP protocol with multiprotocol extension support as defined by
<a class='info' href='#RFC4760'>RFC 4760<span> (</span><span class='info'>Bates, T., Chandra, R., Katz, D., and Y. Rekhter, &ldquo;Multiprotocol Extensions for BGP-4,&rdquo; January&nbsp;2007.</span><span>)</span></a> [RFC4760].  It supersedes the
BGP, BGP4PLUS, BGP4PLUS_01 Types.  The BGP4MP Type has
six Subtypes which are defined as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0    BGP4MP_STATE_CHANGE
    1    BGP4MP_MESSAGE
    4    BGP4MP_MESSAGE_AS4
    5    BGP4MP_STATE_CHANGE_AS4
    6    BGP4MP_MESSAGE_LOCAL
    7    BGP4MP_MESSAGE_AS4_LOCAL
</pre></div>
<a name="anchor11"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.1"></a><h3>5.4.1.&nbsp;
BGP4MP_STATE_CHANGE Subtype</h3>

<p>This record is used to encode state changes in the BGP finite state machine.
The BGP FSM states are encoded in the Old State and New State fields to
indicate the previous and current state.  In some cases, the Peer AS number
may be undefined.  In such cases, the value of this field may be set to zero.
The format is illustrated below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |        Local AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Old State          |          New State            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>
The FSM states are
defined in <a class='info' href='#RFC4271'>RFC 4271<span> (</span><span class='info'>Rekhter, Y., Li, T., and S. Hares, &ldquo;A Border Gateway Protocol 4 (BGP-4),&rdquo; January&nbsp;2006.</span><span>)</span></a> [RFC4271], Section 8.2.2.
Both the old state value and the new state value are encoded as 2-octet
numbers.  The state values are defined numerically as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    1    Idle
    2    Connect
    3    Active
    4    OpenSent
    5    OpenConfirm
    6    Established
</pre></div>
<p>The BGP4MP_STATE_CHANGE message also includes interface index
and Address Family fields.
The interface index provides the interface number of the peering session.
The index value is OPTIONAL and MAY be zero if unknown or unsupported.
The Address Family indicates what types of addresses are in the
the address fields.  At present, the following AFI Types are supported:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    1    AFI_IPv4
    2    AFI_IPv6
</pre></div>
<a name="anchor12"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.2"></a><h3>5.4.2.&nbsp;
BGP4MP_MESSAGE Subtype</h3>

<p>This Subtype is used to encode BGP Messages.  It can be used to encode any
Type of BGP message.  The entire BGP message is encapsulated in
the BGP Message field, including the 16-octet marker, the 2-octet length, and the 1-octet type fields.  Note that the BGP4MP_MESSAGE Subtype does not
support 4-Byte AS numbers.  Further, the AS_PATH contained in these
messages MUST only consist of 2-Byte AS numbers.  The BGP4MP_MESSAGE_AS4
Subtype updates the BGP4MP_MESSAGE Subtype in order to support 4-Byte
AS numbers. The BGP4MP_MESSAGE fields are shown below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |        Local AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP Message... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>The interface index provides the interface number of the peering session.
The index value is OPTIONAL and MAY be zero if unknown or unsupported.
The Address Family indicates what types of addresses are in the
the subsequent address fields.  At present, the following AFI Types
are supported:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    1    AFI_IPv4
    2    AFI_IPv6
</pre></div>
<p>Note that the Address Family value only applies to the IP addresses
contained in the MRT header.  The BGP4MP_MESSAGE Subtype is otherwise
transparent to the contents of the actual message which may contain
any valid AFI/SAFI values.  Only one BGP message may be encoded in
the BGP4MP_MESSAGE Subtype.
</p>
<a name="anchor13"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.3"></a><h3>5.4.3.&nbsp;
BGP4MP_MESSAGE_AS4 Subtype</h3>

<p>This Subtype updates the BGP4MP_MESSAGE Subtype to support 4-Byte Autonomous
System numbers.  The BGP4MP_MESSAGE_AS4 Subtype is otherwise identical
to the BGP4MP_MESSAGE Subtype.  The AS_PATH in these messages MUST only
consist of 4-Byte AS numbers.  The BGP4MP_MESSAGE_AS4 fields are
shown below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer AS number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Local AS number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP Message... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<a name="anchor14"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.4"></a><h3>5.4.4.&nbsp;
BGP4MP_STATE_CHANGE_AS4 Subtype</h3>

<p>This Subtype updates the BGP4MP_STATE_CHANGE Subtype to support 4-Byte
Autonomous System numbers.  As with the BGP4MP_STATE_CHANGE Subtype,
the BGP FSM states are encoded in the Old State and New State fields
to indicate the previous and current state.  Aside from the extension
of the peer and local AS fields to 4-Bytes, this subtype is
otherwise identical to the BGP4MP_STATE_CHANGE Subtype.
The BGP4MP_STATE_CHANGE_AS4 fields are shown below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer AS number                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Local AS number                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Old State          |          New State            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<a name="anchor15"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.5"></a><h3>5.4.5.&nbsp;
BGP4MP_MESSAGE_LOCAL Subtype</h3>

<p>Implementations of MRT have largely focused on collecting
remotely generated BGP messages in a passive route collector role.
However, for active BGP implementations, it can be useful to
archive locally generated BGP messages in addition to remote
messages.   This subtype is added to indicated a locally generated
BGP message.   The fields remain identical to the BGP4MP_MESSAGE
type including the Peer and Local IP and AS fields.   The Local fields
continue to refer to the local IP and AS number of the collector which
generated the message and the Peer IP and AS fields refer to the receipient
of the generated BGP messages.
</p>
<a name="anchor16"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.4.6"></a><h3>5.4.6.&nbsp;
BGP4MP_MESSAGE_AS4_LOCAL Subtype</h3>

<p>As with the BGP4MP_MESSAGE_LOCAL type, this type indicate locally
generated messages.  The fields are identical to the BGP4MP_MESSAGE_AS4
message type.

</p>
<a name="anchor17"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.5"></a><h3>5.5.&nbsp;
BGP4MP_ET Type</h3>

<p>This Type was initially defined in the Sprint Labs Python Routing
Toolkit (PyRT).  It extends the MRT common header field to
include a 32BIT microsecond timestamp field.  The type and subtype field
definitions remain as defined for the BGP4MP Type.  The 32BIT microsecond
timestamp immediately follows the length field in the MRT common header
and precedes all other fields in the message.  The 32BIT microsecond
field is included in the computation of the length field value.  The
MRT common header modification is illustrated below.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                           Timestamp                           |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |             Type              |            Subtype            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                             Length                            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      microsecond timestamp                    |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Message... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<a name="anchor18"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.6"></a><h3>5.6.&nbsp;
ISIS Type</h3>

<p>This Type was initially defined in the Sprint Labs Python Routing and
supports the IS-IS routing protocol as defined in
<a class='info' href='#RFC1195'>RFC 1195<span> (</span><span class='info'>Callon, R., &ldquo;Use of OSI IS-IS for routing in TCP/IP and dual environments,&rdquo; December&nbsp;1990.</span><span>)</span></a> [RFC1195].
There is no Type specific header for the ISIS Type.  The Subtype code
for this Type is undefined.  The ISIS PDU directly follows the MRT common
header fields.
</p>
<a name="anchor19"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.7"></a><h3>5.7.&nbsp;
ISIS_ET Type</h3>

<p>The ISIS_ET Type extends the ISIS Type to support microsecond
timestamps.  As with the BGP4MP_ET Type, a 32BIT microsecond timestamp
field is appended to the MRT common header after the length field.  The
ISIS_ET Type is otherwise identical to the ISIS Type.
</p>
<a name="anchor20"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.8"></a><h3>5.8.&nbsp;
OSPFv3 Type</h3>

<p>The OSPFv3 Type
extends the original OSPF Type to support IPv6 addresses for the
OSPFv3 protocol as defined in <a class='info' href='#RFC5340'>RFC 5340<span> (</span><span class='info'>Coltun, R., Ferguson, D., Moy, J., and A. Lindem, &ldquo;OSPF for IPv6,&rdquo; July&nbsp;2008.</span><span>)</span></a> [RFC5340].
The format of the MRT Message field for the OSPFv3 Type is as follows:
</p>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                     Remote IP address (variable)              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                  OSPF Message Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div><p>


</p>
<a name="anchor21"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.5.9"></a><h3>5.9.&nbsp;
OSPFv3_ET Type</h3>

<p>The OSPFv3_ET Type extends the OSPFv3 Type to support microsecond
timestamps.  As with the BGP4MP_ET Type, a 32BIT microsecond timestamp
field is appended to the MRT common header after the length field and its
length is included in the calculation of the length field value.  The
OSPFv3_ET Type is otherwise identical to the OSPFv3 Type.
</p>
<a name="anchor22"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6"></a><h3>6.&nbsp;
IANA Considerations</h3>

<p>This section provides guidance to the Internet Assigned Numbers
Authority (IANA) regarding registration of values related to the MRT
specification, in accordance with BCP 26, <a class='info' href='#RFC5226'>RFC 5226<span> (</span><span class='info'>Narten, T. and H. Alvestrand, &ldquo;Guidelines for Writing an IANA Considerations Section in RFCs,&rdquo; May&nbsp;2008.</span><span>)</span></a> [RFC5226].
</p>
<p>There are two name spaces in MRT that require registration: Type
Codes and Subtype Codes.
</p>
<p>MRT is not intended as a general-purpose specification for protocol
information export, and allocations
should not be made for purposes unrelated to routing protocol information
export.
</p>
<p>The following policies are used here with the meanings defined in BCP
26: "Specification Required", "IETF Consensus", "Experimental Use", "First Come First Served".
</p>
<a name="anchor23"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.1"></a><h3>6.1.&nbsp;
Type Codes</h3>

<p>Type Codes have a range from 0 to 65535, of which 1-64 have been
allocated.  New Type Codes MUST be allocated starting at 65.  Type
Codes 65 - 511 are to be assigned by IETF Review.  Type
Codes 512 - 2047 are assigned based on Specification Required. Type
Codes 2048 - 64511 are available on a First Come First Served policy.
Type Codes 64512 - 65534 are available for Experimental Use.  The Type
Code Values of 0 and 65535 are reserved.
</p>
<a name="anchor24"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.6.2"></a><h3>6.2.&nbsp;
Subtype Codes</h3>

<p>Subtype Codes have a range from 0 to 65535.  Subtype definitions
are specific to a particular Type Code definition.  New Subtype Code
definition must reference an existing Type Code to which the Subtype
belongs.  Subtype assignmnents to Type Codes 0 - 511 are to be assigned
by IETF Review.  Subtype assignments for the remaning Type Codes
follow the assignment rules for the Type Codes to which they belong.

</p>
<a name="anchor25"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.7"></a><h3>7.&nbsp;
Security Considerations</h3>

<p>The MRT Format utilizes a structure which can store routing protocol
information data.  The fields defined in the MRT specification are of
a descriptive nature and provide information that is useful to facilitate
the analysis of routing data.  As such, the fields currently defined in the
MRT specification do not in themselves create additional security risks,
since the fields are not used to induce any particular behavior by the
recipient application.

</p>
<a name="rfc.references"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.8"></a><h3>8.&nbsp;
References</h3>

<a name="rfc.references1"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.1.&nbsp;Normative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="RFC1058">[RFC1058]</a></td>
<td class="author-text">Hedrick, C., &ldquo;<a href="http://tools.ietf.org/html/rfc1058">Routing Information Protocol</a>,&rdquo; RFC&nbsp;1058, June&nbsp;1988 (<a href="http://www.rfc-editor.org/rfc/rfc1058.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC1195">[RFC1195]</a></td>
<td class="author-text">Callon, R., &ldquo;<a href="http://tools.ietf.org/html/rfc1195">Use of OSI IS-IS for routing in TCP/IP and dual environments</a>,&rdquo; RFC&nbsp;1195, December&nbsp;1990 (<a href="http://www.rfc-editor.org/rfc/rfc1195.txt">TXT</a>, <a href="http://www.rfc-editor.org/rfc/rfc1195.ps">PS</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2080">[RFC2080]</a></td>
<td class="author-text"><a href="mailto:gmalkin@Xylogics.COM">Malkin, G.</a> and <a href="mailto:minnear@ipsilon.com">R. Minnear</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2080">RIPng for IPv6</a>,&rdquo; RFC&nbsp;2080, January&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2080.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2119">[RFC2119]</a></td>
<td class="author-text"><a href="mailto:sob@harvard.edu">Bradner, S.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>,&rdquo; BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997 (<a href="http://www.rfc-editor.org/rfc/rfc2119.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2119.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2119.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC2328">[RFC2328]</a></td>
<td class="author-text"><a href="mailto:jmoy@casc.com">Moy, J.</a>, &ldquo;<a href="http://tools.ietf.org/html/rfc2328">OSPF Version 2</a>,&rdquo; STD&nbsp;54, RFC&nbsp;2328, April&nbsp;1998 (<a href="http://www.rfc-editor.org/rfc/rfc2328.txt">TXT</a>, <a href="http://xml.resource.org/public/rfc/html/rfc2328.html">HTML</a>, <a href="http://xml.resource.org/public/rfc/xml/rfc2328.xml">XML</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4271">[RFC4271]</a></td>
<td class="author-text">Rekhter, Y., Li, T., and S. Hares, &ldquo;<a href="http://tools.ietf.org/html/rfc4271">A Border Gateway Protocol 4 (BGP-4)</a>,&rdquo; RFC&nbsp;4271, January&nbsp;2006 (<a href="http://www.rfc-editor.org/rfc/rfc4271.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC4760">[RFC4760]</a></td>
<td class="author-text">Bates, T., Chandra, R., Katz, D., and Y. Rekhter, &ldquo;<a href="http://tools.ietf.org/html/rfc4760">Multiprotocol Extensions for BGP-4</a>,&rdquo; RFC&nbsp;4760, January&nbsp;2007 (<a href="http://www.rfc-editor.org/rfc/rfc4760.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5226">[RFC5226]</a></td>
<td class="author-text">Narten, T. and H. Alvestrand, &ldquo;<a href="http://tools.ietf.org/html/rfc5226">Guidelines for Writing an IANA Considerations Section in RFCs</a>,&rdquo; BCP&nbsp;26, RFC&nbsp;5226, May&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5226.txt">TXT</a>).</td></tr>
<tr><td class="author-text" valign="top"><a name="RFC5340">[RFC5340]</a></td>
<td class="author-text">Coltun, R., Ferguson, D., Moy, J., and A. Lindem, &ldquo;<a href="http://tools.ietf.org/html/rfc5340">OSPF for IPv6</a>,&rdquo; RFC&nbsp;5340, July&nbsp;2008 (<a href="http://www.rfc-editor.org/rfc/rfc5340.txt">TXT</a>).</td></tr>
</table>

<a name="rfc.references2"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>8.2.&nbsp;Informative References</h3>
<table width="99%" border="0">
<tr><td class="author-text" valign="top"><a name="MRT PROG GUIDE">[MRT PROG GUIDE]</a></td>
<td class="author-text"><a href="mailto:labovit@arbor.net">Labovitz, C.</a>, &ldquo;<a href="http://www.merit.edu/networkresearch/mrtprogrammer.pdf">MRT Programmer's Guide</a>,&rdquo; November&nbsp;1999 (<a href="http://www.merit.edu/networkresearch/mrtprogrammer.pdf">HTML</a>).</td></tr>
</table>

<a name="app-deprecated"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A"></a><h3>Appendix A.&nbsp;
Deprecated MRT types</h3>

<p>This Appendix lists deprecated MRT types.  These types are
documented for informational purposes only.  While documented
in some references, they are not known to have been generally
implemented.
</p>
<a name="anchor28"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1"></a><h3>A.1.&nbsp;
Deprecated MRT Informational Types</h3>

<p>The deprecated MRT Informational Types are defined below:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0    NULL
    2    DIE
    4    PEER_DOWN
</pre></div>
<a name="anchor29"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.1"></a><h3>A.1.1.&nbsp;
NULL Type</h3>

<p>The NULL Type message causes no operation.
</p>
<a name="anchor30"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.2"></a><h3>A.1.2.&nbsp;
DIE Type</h3>

<p>The DIE Type signals a remote MRT repository it should stop accepting
 messages.
</p>
<a name="anchor31"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.1.3"></a><h3>A.1.3.&nbsp;
PEER_DOWN Type</h3>

<p>The PEER_DOWN message was intended to indicate that a collector
had lost association with a BGP peer.  However, the MRT format provides
BGP state change message types which duplicate this functionality.
</p>
<a name="anchor32"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2"></a><h3>A.2.&nbsp;
Deprecated MRT Routing Information Types</h3>
<div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    5    BGP
    6    RIP
    7    IDRP
    8    RIPNG
    9    BGP4PLUS
    10   BGP4PLUS_01
</pre></div>
<a name="anchor33"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1"></a><h3>A.2.1.&nbsp;
BGP Type</h3>

<p>The BGP Type indicates the Message field contains BGP routing information.
The BGP routing protocol is defined in <a class='info' href='#RFC4271'>RFC 4271<span> (</span><span class='info'>Rekhter, Y., Li, T., and S. Hares, &ldquo;A Border Gateway Protocol 4 (BGP-4),&rdquo; January&nbsp;2006.</span><span>)</span></a> [RFC4271].
The information in the message is dependent on the Subtype value.  The
BGP Type and all associated Subtypes below are considered to be
deprecated by the BGP4MP Type.
</p>
<p>The following BGP Subtypes are defined for the MRT BGP Type.  As with
the BGP Type itself, they are all considered to be deprecated.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    0    BGP_NULL
    1    BGP_UPDATE
    2    BGP_PREF_UPDATE
    3    BGP_STATE_CHANGE
    4    BGP_SYNC
    5    BGP_OPEN
    6    BGP_NOTIFY
    7    BGP_KEEPALIVE
</pre></div>
<a name="anchor34"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.1"></a><h3>A.2.1.1.&nbsp;
BGP_NULL Subtype</h3>

<p>The BGP_NULL Subtype is a reserved Subtype.
</p>
<a name="anchor35"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.2"></a><h3>A.2.1.2.&nbsp;
BGP_UPDATE Subtype</h3>

<p>The BGP_UPDATE Subtype is used to encode BGP UPDATE messages. The format of the MRT Message field for this Subtype is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer IP address                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Local AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Local IP address                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP UPDATE Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>The BGP UPDATE Contents include the entire BGP UPDATE message
which follows the BGP Message Header.  The BGP Message Header itself
is not included.  The Peer AS number and IP address fields contain the AS number
and IP address of the remote system which are generating the BGP
UPDATE messages.  The Local AS number and IP address fields contain the AS
number and IP address of the local collector system which is archiving
the messages.

</p>
<a name="anchor36"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.3"></a><h3>A.2.1.3.&nbsp;
BGP_PREF_UPDATE Subtype</h3>

<p>The BGP_PREF_UPDATE Subtype is not defined.
</p>
<a name="anchor37"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.4"></a><h3>A.2.1.4.&nbsp;
BGP_STATE_CHANGE Subtype</h3>

<p>The BGP_STATE_CHANGE Subtype is used to record changes in the BGP
finite state machine.  These FSM states
are defined in <a class='info' href='#RFC4271'>RFC 4271<span> (</span><span class='info'>Rekhter, Y., Li, T., and S. Hares, &ldquo;A Border Gateway Protocol 4 (BGP-4),&rdquo; January&nbsp;2006.</span><span>)</span></a> [RFC4271], Section 8.2.2.
Both the old state value and the new state value are encoded as 2-octet
numbers.  The state values are defined numerically as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    1    Idle
    2    Connect
    3    Active
    4    OpenSent
    5    OpenConfirm
    6    Established
</pre></div>
<p> The format of the MRT Message field is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Peer IP address                        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            Old State          |          New State            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<a name="anchor38"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.5"></a><h3>A.2.1.5.&nbsp;
BGP_SYNC Subtype</h3>

<p>The BGP_SYNC Subtype was intended to convey a system file name where
BGP Table Dump messages should be recorded.  The View # was to correspond to
the View # provided in the TABLE_DUMP Type messages.  There are no known
implementations of this subtype and it SHOULD be ignored.
The following format applies to this Subtype:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        View #                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            File Name... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<p>The File Name is terminated with a NULL (0) character.
</p>
<a name="anchor39"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.6"></a><h3>A.2.1.6.&nbsp;
BGP_OPEN Subtype</h3>

<p>The BGP_OPEN Subtype is used to encode BGP OPEN messages. The format of
the MRT Message field for this Subtype is the same as the BGP_UPDATE,
however, the last field contains the contents of the BGP OPEN message.

</p>
<a name="anchor40"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.7"></a><h3>A.2.1.7.&nbsp;
BGP_NOTIFY Subtype</h3>

<p>The BGP_NOTIFY Subtype is used to encode BGP NOTIFICATION messages. The
format of the MRT Message field for this Subtype is the same as the BGP_UPDATE,
however, the last field contains the contents of the BGP NOTIFICATION message.

</p>
<a name="anchor41"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.1.8"></a><h3>A.2.1.8.&nbsp;
BGP_KEEPALIVE Subtype</h3>

<p>The BGP_KEEPALIVE Subtype is used to encode BGP KEEPALIVE messages.
The format of the MRT Message field for this Subtype is the same as
the BGP_UPDATE, however, the last field contains no information.
</p>
<a name="anchor42"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.2"></a><h3>A.2.2.&nbsp;
RIP Type</h3>

<p>The RIP Type is used to export RIP protocol packets as defined in 
<a class='info' href='#RFC1058'>RFC 1058<span> (</span><span class='info'>Hedrick, C., &ldquo;Routing Information Protocol,&rdquo; June&nbsp;1988.</span><span>)</span></a> [RFC1058].
The Subtype field is currently reserved for this Type and SHOULD be set to 0.
</p>
<p>The format of the MRT Message field for the RIP Type is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Peer IP address                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                         Local IP address                      |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    RIP Message Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<a name="anchor43"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.3"></a><h3>A.2.3.&nbsp;
IDRP Type</h3>

<p>The IDRP Type is used to export Inter-Domain-Routing Protocol (IDRP) protocol
information as defined in the ISO/IEC 10747 standard.  The Subtype field
is unused.  This Type is deprecated due to lack of deployment of IDRP.
</p>
<a name="anchor44"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.4"></a><h3>A.2.4.&nbsp;
RIPNG Type</h3>

<p>The RIPNG Type is used to export RIPNG protocol packets as defined in
<a class='info' href='#RFC2080'>RFC 2080<span> (</span><span class='info'>Malkin, G. and R. Minnear, &ldquo;RIPng for IPv6,&rdquo; January&nbsp;1997.</span><span>)</span></a> [RFC2080].  The RIPNG protocol updates the RIP
protocol to support IPv6.   The Subtype field is currently
reserved for this Type and SHOULD be set to 0.
</p>
<p>The format of the MRT Message field for the RIPNG Type is as follows:
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    ~                        Peer IPv6 address                      ~
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                                                               |
    ~                        Local IPv6 address                     ~
    |                                                               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                  RIPNG Message Contents (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<a name="anchor45"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.5"></a><h3>A.2.5.&nbsp;
BGP4PLUS and BGP4PLUS_01 Types</h3>

<p>The BGP4PLUS and BGP4PLUS_01 Types were defined to support IPv6 BGP
routing information.  The BGP4PLUS Type
was specified based on the initial Internet Draft for Multiprotocol
Extensions to BGP-4.  The BGP4PLUS_01 Type was specified to correspond to
the -01 revision of this Internet Draft.  The two Types share the
same definitions in terms of their MRT format specifications.
</p>
<p>The Subtype field definitions are shared with the BGP Type, however, the
address fields in the BGP_UPDATE, BGP_OPEN, BGP_NOTIFY, BGP_KEEPALIVE,
and BGP_STATE_CHANGE Subtype messages
are extended to 16 octets for IPv6 addresses.  As with the BGP Type,
the BGP4PLUS and BGP4PLUS_01 Types are deprecated as they superseded
by the BGP4MP Type.
</p>
<a name="anchor46"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.6"></a><h3>A.2.6.&nbsp;
Deprecated BGP4MP Subtypes</h3>

<p>The following two subtypes of the BGP4MP Type are considered
to be deprecated.
</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
    2    BGP4MP_ENTRY
    3    BGP4MP_SNAPSHOT
</pre></div>
<a name="anchor47"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.6.1"></a><h3>A.2.6.1.&nbsp;
BGP4MP_ENTRY Subtype</h3>

<p>This Subtype is similar to
the TABLE_DUMP Type and is used to record RIB table entries. It extends
the TABLE_DUMP Type to include true multiprotocol support.  However, this
Type does not support 4-Byte AS numbers and has not been widely implemented.
This Type is deprecated in favor of the TABLE_DUMP_V2 which includes 4-Byte
AS number support and a more compact format.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |         Peer AS number        |        Local AS number        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Interface Index        |        Address Family         |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Peer IP address (variable)               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                      Local IP address (variable)              |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |           View #              |             Status            |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                        Time last change                       |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        Address Family         |    SAFI       | Next-Hop-Len  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                     Next Hop Address (variable)               |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    | Prefix Length  |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                     Address Prefix (variable)                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |       Attribute Length        |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |                    BGP Attribute... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<a name="anchor48"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<a name="rfc.section.A.2.6.2"></a><h3>A.2.6.2.&nbsp;
BGP4MP_SNAPSHOT Subtype</h3>

<p>This Subtype was intended to convey a system file name where
BGP4MP_ENTRY messages should be recorded.
It is similar to the BGP_SYNC message Subtype and is deprecated.

</p><div style='display: table; width: 0; margin-left: 3em; margin-right: auto'><pre>
     0                   1                   2                   3
     0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |        View #                 |
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
    |            File Name... (variable)
    +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre></div>
<a name="rfc.authors"></a><br /><hr />
<table summary="layout" cellpadding="0" cellspacing="2" class="TOCbug" align="right"><tr><td class="TOCbug"><a href="#toc">&nbsp;TOC&nbsp;</a></td></tr></table>
<h3>Authors' Addresses</h3>
<table width="99%" border="0" cellpadding="0" cellspacing="0">
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Larry Blunk</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Merit Network</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:ljb@merit.edu">ljb@merit.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Manish Karir</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Merit Network</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:mkarir@merit.edu">mkarir@merit.edu</a></td></tr>
<tr cellpadding="3"><td>&nbsp;</td><td>&nbsp;</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Craig Labovitz</td></tr>
<tr><td class="author-text">&nbsp;</td>
<td class="author-text">Arbor Networks</td></tr>
<tr><td class="author" align="right">Email:&nbsp;</td>
<td class="author-text"><a href="mailto:labovit@arbor.net">labovit@arbor.net</a></td></tr>
</table>
</body></html>
